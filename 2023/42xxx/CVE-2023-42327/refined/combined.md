=== Content from rules.sonarsource.com_0b4945ea_20250115_204921.html ===
[![SonarSource Rules](/images/sonar-rules_logo.png)](/)

* Products
  ### In-IDE

  ![Code Quality and Security in your IDE with SonarQube Ide](/images/logos/discover/sonarqube-for-ide-logo.svg "Code Quality and Security in your IDE with SonarQube Ide")

  IDE extension that lets you fix coding issues before they exist!

  [Discover SonarQube for IDE](https://www.sonarsource.com/products/sonarlint/)
  ### SaaS

  ![Code Quality and Security in the cloud with SonarQube Cloud](/images/logos/discover/sonarqube-cloud-logo.svg "Code Quality and Security in the cloud with SonarQube Cloud")

  Setup is effortless and analysis is automatic for most languages

  [Discover SonarQube Cloud](https://www.sonarsource.com/products/sonarcloud/)
  ### Self-Hosted

  ![Code Quality and Security Self-Hosted with SonarQube Server](/images/logos/discover/sonarqube-server-logo.svg "Code Quality and Security Self-Hosted with SonarQube Server")

  Fast, accurate analysis; enterprise scalability

  [Discover SonarQube Server](https://www.sonarsource.com/products/sonarqube/)

* [![Secrets](/images/language-logos/secrets.svg)Secrets](/secrets/)
* [![ABAP](/images/language-logos/abap.svg)ABAP](/abap/)
* [![Ansible](/images/language-logos/ansible.svg)Ansible](/ansible/)
* [![Apex](/images/language-logos/apex.svg)Apex](/apex/)
* [![AzureResourceManager](/images/language-logos/azureresourcemanager.svg)AzureResourceManager](/azureresourcemanager/)
* [![C](/images/language-logos/c.svg)C](/c/)
* [![C#](/images/language-logos/csharp.svg)C#](/csharp/)
* [![C++](/images/language-logos/cpp.svg)C++](/cpp/)
* [![CloudFormation](/images/language-logos/cloudformation.svg)CloudFormation](/cloudformation/)
* [![COBOL](/images/language-logos/cobol.svg)COBOL](/cobol/)
* [![CSS](/images/language-logos/css.svg)CSS](/css/)
* [![Dart](/images/language-logos/dart.svg)Dart](/dart/)
* [![Docker](/images/language-logos/docker.svg)Docker](/docker/)
* [![Flex](/images/language-logos/flex.svg)Flex](/flex/)
* [![Go](/images/language-logos/go.svg)Go](/go/)
* [![HTML](/images/language-logos/html.svg)HTML](/html/)
* [![Java](/images/language-logos/java.svg)Java](/java/)
* [![JavaScript](/images/language-logos/javascript.svg)JavaScript](/javascript/)
* [![JCL](/images/language-logos/jcl.svg)JCL](/jcl/)
* [![Kotlin](/images/language-logos/kotlin.svg)Kotlin](/kotlin/)
* [![Kubernetes](/images/language-logos/kubernetes.svg)Kubernetes](/kubernetes/)
* [![Objective C](/images/language-logos/objective-c.svg)Objective C](/objective-c/)
* ![PHP](/images/language-logos/php.svg)PHP
* [![PL/I](/images/language-logos/pli.svg)PL/I](/pli/)
* [![PL/SQL](/images/language-logos/plsql.svg)PL/SQL](/plsql/)
* [![Python](/images/language-logos/python.svg)Python](/python/)
* [![RPG](/images/language-logos/rpg.svg)RPG](/rpg/)
* [![Ruby](/images/language-logos/ruby.svg)Ruby](/ruby/)
* [![Scala](/images/language-logos/scala.svg)Scala](/scala/)
* [![Swift](/images/language-logos/swift.svg)Swift](/swift/)
* [![Terraform](/images/language-logos/terraform.svg)Terraform](/terraform/)
* [![Text](/images/language-logos/text.svg)Text](/text/)
* [![TypeScript](/images/language-logos/typescript.svg)TypeScript](/typescript/)
* [![T-SQL](/images/language-logos/tsql.svg)T-SQL](/tsql/)
* [![VB.NET](/images/language-logos/vbnet.svg)VB.NET](/vbnet/)
* [![VB6](/images/language-logos/vb6.svg)VB6](/vb6/)
* [![XML](/images/language-logos/xml.svg)XML](/xml/)
![PHP](/images/language-logos/color/php.svg)
## PHP static code analysis

### Unique rules to find Bugs, Vulnerabilities, Security Hotspots, and Code Smells in your PHP code

[* All rules 273](/php/)[* Vulnerability42](/php/type/Vulnerability/)[* Bug51](/php/type/Bug/)[* Security Hotspot34](/php/type/Security%20Hotspot/)[* Code Smell146](/php/type/Code%20Smell/) Tags

Impact

Clean code attribute

1. [### Credentials should not be hard-coded

    Vulnerability](/php/type/Vulnerability/RSPEC-6437/)
2. [### Include expressions should not be vulnerable to injection attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-5335/)
3. [### Dynamic code execution should not be vulnerable to injection attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-5334/)
4. [### HTTP request redirections should not be open to forging attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-5146/)
5. [### Deserialization should not be vulnerable to injection attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-5135/)
6. [### Endpoints should not be vulnerable to reflected cross-site scripting (XSS) attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-5131/)
7. [### Database queries should not be vulnerable to injection attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-3649/)
8. [### XML parsers should not be vulnerable to XXE attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-2755/)
9. [### A secure password should be used when connecting to a database

    Vulnerability](/php/type/Vulnerability/RSPEC-2115/)
10. [### XPath expressions should not be vulnerable to injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-2091/)
11. [### I/O function calls should not be vulnerable to path injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-2083/)
12. [### LDAP queries should not be vulnerable to injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-2078/)
13. [### OS commands should not be vulnerable to command injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-2076/)
14. [### A new session should be created during user authentication

     Vulnerability](/php/type/Vulnerability/RSPEC-5876/)
15. [### Cipher algorithms should be robust

     Vulnerability](/php/type/Vulnerability/RSPEC-5547/)
16. [### Encryption algorithms should be used with secure mode and padding scheme

     Vulnerability](/php/type/Vulnerability/RSPEC-5542/)
17. [### Server hostnames should be verified during SSL/TLS connections

     Vulnerability](/php/type/Vulnerability/RSPEC-5527/)
18. [### Server certificates should be verified during SSL/TLS connections

     Vulnerability](/php/type/Vulnerability/RSPEC-4830/)
19. [### LDAP connections should be authenticated

     Vulnerability](/php/type/Vulnerability/RSPEC-4433/)
20. [### Cryptographic keys should be robust

     Vulnerability](/php/type/Vulnerability/RSPEC-4426/)
21. [### Weak SSL/TLS protocols should not be used

     Vulnerability](/php/type/Vulnerability/RSPEC-4423/)
22. [### Regular expressions should not be vulnerable to Denial of Service attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-2631/)
23. [### Password hashing functions should use an unpredictable salt

     Vulnerability](/php/type/Vulnerability/RSPEC-2053/)
24. [### Server-side requests should not be vulnerable to traversing attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-7044/)
25. [### Applications should not create session cookies from untrusted input

     Vulnerability](/php/type/Vulnerability/RSPEC-6287/)
26. [### Reflection should not be vulnerable to injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-6173/)
27. [### Authorizations should be based on strong decisions

     Vulnerability](/php/type/Vulnerability/RSPEC-5808/)
28. [### Server-side requests should not be vulnerable to forging attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-5144/)
29. [### OS commands should not be vulnerable to argument injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-5883/)
30. [### Logging should not be vulnerable to injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-5145/)
31. [### "file\_uploads" should be disabled

     Vulnerability](/php/type/Vulnerability/RSPEC-3338/)
32. [### "enable\_dl" should be disabled

     Vulnerability](/php/type/Vulnerability/RSPEC-3337/)
33. [### "session.use\_trans\_sid" should not be enabled

     Vulnerability](/php/type/Vulnerability/RSPEC-3336/)
34. [### "allow\_url\_fopen" and "allow\_url\_include" should be disabled

     Vulnerability](/php/type/Vulnerability/RSPEC-3334/)
35. [### "open\_basedir" should limit file access

     Vulnerability](/php/type/Vulnerability/RSPEC-3333/)
36. [### Neither DES (Data Encryption Standard) nor DESede (3DES) should be used

     Vulnerability](/php/type/Vulnerability/RSPEC-2278/)
37. [### Session-management cookies should not be persistent

     Vulnerability](/php/type/Vulnerability/RSPEC-3332/)
38. [### Cryptographic RSA algorithms should always incorporate OAEP (Optimal Asymmetric Encryption Padding)

     Vulnerability](/php/type/Vulnerability/RSPEC-2277/)
39. [### SHA-1 and Message-Digest hash algorithms should not be used in secure contexts

     Vulnerability](/php/type/Vulnerability/RSPEC-2070/)
40. [### Secret keys and salt values should be robust

     Vulnerability](/php/type/Vulnerability/RSPEC-6339/)
41. [### "cgi.force\_redirect" should be enabled

     Vulnerability](/php/type/Vulnerability/RSPEC-3335/)
42. [### "sleep" should not be called

     Vulnerability](/php/type/Vulnerability/RSPEC-2964/)

# OS commands should not be vulnerable to command injection attacks

Analyze your codeintentionality - completesecurity Vulnerability Blocker[SonarSource default severity
click to learn more](https://blog.sonarsource.com/we-are-adjusting-rules-severities)

* [injection](/php/tag/injection/RSPEC-2076/)
* [cwe](/php/tag/cwe/RSPEC-2076/)
## Why is this an issue?

## How can I fix it?

## More Info

OS command injections occur when applications build command lines from untrusted data before executing them with a system shell.
 In that case,
an attacker can tamper with the command line construction and force the execution of unexpected commands. This can lead to the compromise of the
underlying operating system.

### What is the potential impact?

An attacker exploiting an OS command injection vulnerability will be able to execute arbitrary commands on the underlying operating system.

The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,
and therefore any OS commands or programs may be affected.

Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.

#### Denial of service and data leaks

In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.

An attacker could, for example:

* download the internal server’s data, most likely to sell it
* modify data, send malware
* stop services or exhaust resources (with fork bombs for example)

This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).

#### Root privilege escalation and pivot

In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate
their privileges to an administrative level and attacks other servers.

Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised
by a combination of OS injections and **misconfiguration** of:

* Docker or Kubernetes clusters
* cloud services
* network firewalls and routing
* OS access control

Available In:* [![SonarQube Cloud](/images/logos/sonarqube-cloud-logo.svg)Detect issues in your GitHub, Azure DevOps Services, Bitbucket Cloud, GitLab repositories](https://www.sonarsource.com/products/sonarcloud/)
* [![SonarQube Server](/images/logos/sonarqube-server-logo.svg)Developer](https://www.sonarsource.com/plans-and-pricing/developer/)

© 2008-2024 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.

Sonar helps developers write [Clean Code](https://www.sonarsource.com/solutions/clean-code/).
[Privacy Policy](https://www.sonarsource.com/company/privacy/) | [Cookie Policy](https://www.sonarsource.com/company/cookie-policy/)



=== Content from docs.netgate.com_00a7039b_20250114_231824.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
pfSense-SA-23\_08.webgui Security Advisory
pfSense
Topic: XSS vulnerability in the WebGUI
Category: pfSense Base System
Module: webgui
Announced: 2023-10-31
Credits: Oskar Zeino-Mahmalat (Sonar)
CVE ID: CVE-2023-42327
Affects: pfSense Plus software versions <= 23.05.1
pfSense CE software versions <= 2.7.0
Corrected: 2023-07-05 17:43:56 UTC (pfSense Plus master, 23.09)
2023-07-05 17:43:56 UTC (pfSense CE master, 2.7.1)
0. Revision History
v1.1 2023-11-16 Updated with CE 2.7.1 release information
v1.0 2023-10-31 Initial SA draft
I. Background
pfSense® software is a free network firewall distribution based on the
FreeBSD operating system. The pfSense software distribution includes third-
party free software packages for additional functionality, and provides most of
the functionality of common commercial firewalls.
pfSense® Plus is the productized version of pfSense software from Netgate®,
previously referred to as pfSense Factory Edition (FE). It is available to
Netgate appliance and CSP customers.
The majority of users of pfSense software have never installed or used a stock
FreeBSD system. Unlike similar GNU/Linux-based firewall distributions, there
is no need for any UNIX knowledge. The command line is never used, and there
is no need to ever manually edit any rule sets. Instead, pfSense software
includes a web interface for the configuration of all included components.
Users familiar with commercial firewalls will quickly understand the web
interface, while those unfamiliar with commercial-grade firewalls may encounter
a short learning curve.
II. Problem Description
A potential Cross-Site Scripting (XSS) vulnerability was found in
getserviceproviders.php, a component of the pfSense Plus and pfSense CE software
GUI.
The page does not always validate or sanitize the value of the "connection"
variable from user input, which then may be displayed without encoding.
This problem is present on pfSense Plus version 23.05.1, pfSense CE version
2.7.0, and earlier versions of both.
III. Impact
Due to the lack of proper encoding on the affected parameters susceptible to
XSS, arbitrary JavaScript could be executed in the user's browser. The user's
session cookie or other information from the session may be compromised.
The user must be logged in and have sufficient privileges to access
getserviceproviders.php. The affected case requires a provider to only have one
plan.
IV. Workaround
To help mitigate the problem on older releases, use one or more of the
following:
\* Limit access to the affected pages to trusted administrators only.
\* Do not log into the firewall with the same browser used for non-
administrative web browsing.
V. Solution
Users can upgrade to pfSense Plus software version 23.09 or later, or pfSense CE
software version 2.7.1 or later. This upgrade may be performed in the web
interface or from the console.
See https://docs.netgate.com/pfsense/en/latest/install/upgrade-guide.html
Users on pfSense Plus version 23.05.1 and pfSense CE version 2.7.0 may apply the
fix from the recommended patches list in the System Patches package.
Users may also manually apply the relevant revisions below using the System
Patches package on earlier versions, or by manually making similar changes to
the affected files if the patches do not apply directly.
See https://docs.netgate.com/pfsense/en/latest/development/system-patches.html
VI. Correction details
The following list contains the correction revision commit ID for each
affected item.
Branch/path Revision
- - -------------------------------------------------------------------------
plus/plus-master 543dc9253d6ab0e755ee043da2217d996a28ab5e
pfSense/master 543dc9253d6ab0e755ee043da2217d996a28ab5e
- - -------------------------------------------------------------------------
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE40XvjEU56XSUPIMdE7mH/ZIU+NoFAmVWgmoACgkQE7mH/ZIU
+Nrw5A/8Dy+/K0j2buWgphcMPL8YNEEqmgKIykzUNI35EjeTY2eCrMJ319wrvGEL
Ei6wHbQX8j2Nwr272OHX97KWgfdI2HTix/Bfxlxta7YrokGgS163uZUez93pFxo+
nst4UVH4uldu5C8mEH0+1f2MGxiz8cQPLs635cfuIaeYwBlvB2XHg5JExSNo2RSw
ot+haw/J2B4NqB6JCD/+HVB7k+lMcnLqT088xZEgot0zzdjhCfWQvaEhLofo0RAu
efcb0kfwuhsBYf3+FC4cl6WofzUNv0Z8H7bG9XzOWdpmqY1s+qvLHsKUD54h9+N/
PDtRj25AuPn+Q+BDEseLRZMzXX+l+XYeOx0QL7TQdQH9EJkIBE7wC+pcWKNdABba
wr0TW5GYE++qYBQa1JA61jzOpHOMzX+lLvwx3UfhrxM6xJ/4FeJkuqQSMQY3uVNF
oLyejMiEUEd+tpgVE3nx53el5B4d8jK6UGFIbuEsYCN705EDqLV6actO2b36WQ6R
A8CHWB7OfY/nmXnkenh8ciaCYvXMpoEzoob+n9O5j6oRpcciZytl/KxUTIqGg2tn
DOear93UW22LaHQnrCF2YsIORKy7hXl/VHWyx6/EsM4fZ3fTXNfqskgGY3BVNX2s
jPjR0NfseEiiM+MPMVeXUpH7wI+ovMTcdxPmZNoyV4vB9AxN0jk=
=80xM
-----END PGP SIGNATURE-----


=== Content from www.sonarsource.com_246595af_20250114_231826.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# pfSense Security: Sensing Code Vulnerabilities with SonarQube Cloud

![](data:image/svg+xml;charset=utf-8...)![Oskar Zeino-Mahmalat photo]()![Oskar Zeino-Mahmalat photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/5f1b57ad-cced-4cc8-97e9-eff0ddc3f2a0/Oskar_grayscale.jpg?w=1584&h=1584&auto=format&fit=crop)

Oskar Zeino-Mahmalat

Vulnerability Researcher

December 11, 2023

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bf453bc7-6980-489e-9b4d-09ff939c983d/pfsense_code_vulnerabilities_blog_index.webp?w=2400&h=1254&auto=format&fit=crop)![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bf453bc7-6980-489e-9b4d-09ff939c983d/pfsense_code_vulnerabilities_blog_index.webp?w=2400&h=1254&auto=format&fit=crop)

pfSense is a popular open-source firewall solution by Netgate. It is sold as pfSense Plus installed on ready-made firewall appliances to protect and manage office networks and also distributed for free as the pfSense Community Edition (CE). The [r/PFSENSE](https://www.reddit.com/r/PFSENSE/ "r/PFSENSE") subreddit has a large community with over 100 thousand members, lending credibility to [pfSense's tagline](https://www.pfsense.org/ "pfSense's tagline") "world's most trusted open source network security solution".

As part of our ongoing commitment to open-source security and to enhance our Clean Code technology, we routinely perform scans on open-source projects using SonarCloud and assess the results. Importantly, anyone can do this for free! [SonarCloud](https://sonarcloud.io "SonarCloud") is available at no cost for open-source projects, regardless of their language or size.

During these scans, SonarCloud discovered two Cross-Site Scripting (XSS) vulnerabilities and a Command Injection vulnerability in pfSense CE. In combination, these security vulnerabilities allowed an attacker to execute arbitrary commands on a pfSense appliance. Security inside a local network is often more lax as network administrators trust their firewalls to protect them from remote attacks. Potential attackers could have used the discovered vulnerabilities to spy on traffic or attack services inside the local network.

In this article, we will cover two of the three security vulnerabilities in detail. We show how SonarCloud found these vulnerabilities using [taint analysis](https://www.sonarsource.com/blog/what-is-taint-analysis/ "taint analysis"), how they could have been exploited, and what the patch from Netgate looks like.

## pfSense Vulnerabilities Impact

**pfSense CE 2.7.0 and below, pfSense Plus 23.05.1 and below** are vulnerable to **two** [**XSS**](https://rules.sonarsource.com/php/type/Vulnerability/RSPEC-5131/ "XSS") vulnerabilities and **a** [**Command Injection**](https://rules.sonarsource.com/php/type/Vulnerability/RSPEC-2076/ "Command Injection") vulnerability ([CVE-2023-42325](https://nvd.nist.gov/vuln/detail/CVE-2023-42325 "CVE-2023-42325"), [CVE-2023-42327](https://nvd.nist.gov/vuln/detail/CVE-2023-42327 "CVE-2023-42327"), [CVE-2023-42326](https://nvd.nist.gov/vuln/detail/CVE-2023-42326 "CVE-2023-42326")). The security vulnerabilities are fixed in pfSense CE 2.7.1 and pfSense Plus 23.09. Attackers can combine the vulnerabilities to **execute arbitrary code** on the pfSense appliance remotely. An attacker can trick an authenticated pfSense user into clicking on a maliciously crafted link containing an XSS payload that exploits the command injection vulnerability.

The victim user needs to be an admin user or at least have access to specific subsections of the pfSense WebGui. pfSense admins can check the user manager for non-admin users with these permissions:

* Reflected XSS ([CVE-2023-42325](https://nvd.nist.gov/vuln/detail/CVE-2023-42325 "CVE-2023-42325")):
  + WebCfg - Status: System Logs: Firewall (Dynamic View)
  + WebCfg - Status: Logs: Settings
* Reflected XSS ([CVE-2023-42327](https://nvd.nist.gov/vuln/detail/CVE-2023-42327 "CVE-2023-42327")):
  + WebCfg - AJAX: Get Service Providers
* Command injection ([CVE-2023-42326](https://nvd.nist.gov/vuln/detail/CVE-2023-42326 "CVE-2023-42326")):
  + WebCfg - Interfaces: GIF: Edit
  + WebCfg - Interfaces: GRE: Edit

## pfSense Security Vulnerabilities Technical Details

In this section, we first give a quick refresher on taint analysis, the technology that SonarCloud used to discover all three vulnerabilities. Then we explain the details and the taint flow for two of the three vulnerabilities:

* Reflected XSS ([CVE-2023-42325](https://nvd.nist.gov/vuln/detail/CVE-2023-42325 "CVE-2023-42325")): An unencoded filter string is reflected into a script tag.
* Command Injection ([CVE-2023-42326](https://nvd.nist.gov/vuln/detail/CVE-2023-42326 "CVE-2023-42326")): Unescaped user input is used inside a management shell command.
* The second Reflected XSS vulnerability ([CVE-2023-42327](https://nvd.nist.gov/vuln/detail/CVE-2023-42327 "CVE-2023-42327")) is similar to the first one, so we won't cover it in this post.

### Taint analysis

SonarCloud found the vulnerability using taint analysis. This type of static analysis tracks data flow from user-controllable data sources to dangerous sinks.

In the case of PHP, the sources include all data from a web request like URL parameters, the request body, cookies, and other headers. The taint flow from these sources is tracked through variables in the code, across several files. If the user-controllable data is validated, properly sanitized, or encoded during the flow, the flow is no longer tracked to ensure fewer false positive findings. Dangerous sinks include functions that invoke system commands, the reflection of data into the HTML page returned by the server, or other sensitive functions.

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/4e3fb1ea-1942-4ee8-bc85-257db6467bb2/Taint%20analysis.png?w=1749&h=983&auto=format&fit=crop)

If SonarCloud finds a taint flow from source to sink, an issue is raised. The SonarCloud UI displays the discovered taint so that developers can easily understand and fix the issue. These features also helped us to quickly discover and verify the three reported vulnerabilities in pfSense.

### Reflected XSS (CVE-2023-42325)

One of the vulnerabilities discovered by SonarCloud was an XSS vulnerability on the `status_logs_filter_dynamic.php` page of the pfSense web GUI. This page provides a filterable live view of the firewall logs of pfSense. The filter selected by the user is sent as part of the URL query string to the pfSense server. To make the logs live, some JavaScript code in the page requests the newest filtered log entries every 30 seconds. These requests have to use the same filter as the original request. So the corresponding query string is constructed by server-side PHP code and reflected in the script tag.

The SonarCloud analysis found that there is a taint flow where parts of the reflected query string are user-controllable. Let's look into that flow to confirm this potential vulnerability. The numbered steps of the taint flow are marked in brackets.

[**View pfSense XSS issue on SonarCloud**](https://sonarcloud.io/project/issues?resolved=false&id=SonarSourceResearch_pfsense-blogpost&open=AYtcW5T0YkAG6r383NYb "pfSense XSS issue on SonarCloud")

First, a URL query parameter is returned by the utility function `getGETPOSTsettingvalue` in `guiconfig.inc`. SonarCloud detects the source array `$_GET` as tainted because the URL query parameters are user-controllable [1-3]. From here on, operation results containing the tainted return value of the function are also tainted.

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/6751b6ea-bb6d-46a4-8853-a88c78344d8a/XSS%201%20Source.png?w=1372&h=960&auto=format&fit=crop)

The `getGETPOSTsettingvalue` function is used to set the `$interfacefilter` global variable [4-5]. This variable usually contains a filter string to filter the firewall logs. But the taint flow going through here shows that it can also contain attacker-controlled malicious values.

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/31d0edd5-b2f1-4fd4-84da-53393481cb17/XSS%202.png?w=1218&h=319&auto=format&fit=crop)

Following the taint flow to the end, we see that the value of `$interfacefilter` is concatenated without encoding into `$filter_query_string`. `$filter_query_string` in turn is reflected on the page inside a script block as a JavaScript string, leading to the XSS vulnerability. SonarCloud correctly reports this taint flow as vulnerable, as no encoding or sanitization was used that would make the reflection harmless. Note that another variable `$filtertext` is also concatenated and encoded using `json_encode()` [8], suggesting that encoding for `$interfacefilter` was simply forgotten.

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bb69d19f-2d82-409c-bc4d-109f2a8f2534/XSS%203%20Sink.png?w=1603&h=926&auto=format&fit=crop)

An attacker could exploit this reflected XSS vulnerability by terminating the JS string and inserting their own code afterward. Leftover parts of the string after the injection point of the `interface` query parameter can be commented out.

```
/status_logs_filter_dynamic.php?filtersubmit=1&interface=foo";alert(origin)//

var filter_query_string = "<?= $filter_query_string . '&logfile=' . $logfile_path . '&nentries=' . $nentries?>";

var filter_query_string = "type=raw&filter=&interfacefilter=foo";alert(origin) //&logfile=/var/log/filter.log&nentries=500";"
```

The attacker could then send a link with this crafted query parameter to an authenticated user of pfSense. After the victim clicks on the link, the JavaScript payload gets executed in the victim's browser and can perform actions in the pfSense firewall with the victim's permissions.

If the victim is an administrator of pfSense, the attacker can use that privilege to access the `diag_command.php` page. This page allows pfSense admins to execute arbitrary system commands on the pfSense firewall appliance.

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/e6dab81e-26b3-46f3-97b6-9a28d59d47af/pfsense%20command%20execution.png?w=970&h=913&auto=format&fit=crop)

So if an administrator user is targeted, the attacker could gain remote code execution (RCE) capabilities as root on the appliance. With RCE capabilities, the attacker can manipulate the firewall, spy on local network traffic, or attack services inside the local network.

But what if the victim of the XSS attack does not use the administrator account, out of caution or in a multi-user scenario? Is the RCE attack thwarted in that scenario? Unfortunately no, as we discovered a Command Injection vulnerability that also gives an attacker remote code execution capabilities while targeting a low-privilege pfSense user.

### Command Injection (CVE-2023-42326)

A key feature of the pfSense web UI is the network interfaces’ configuration of the server. The pfSense server code implements this by constructing shell command strings to call standard Linux binaries like `ifconfig`. The arguments in these shell commands are often taken from the configuration provided by the user, for example, the name of a network interface. This approach is vulnerable to Command Injection if the inserted arguments are not correctly validated or escaped.

SonarCloud found two similar vulnerable taint flows on the `interfaces_gif_edit.php` and `interfaces_gre_edit.php` pages. These flows started with user-controllable HTTP POST request data and ended in the `exec()` function, which executes shell commands without any validation or escaping of the data in between. We'll describe the first of the two taint flows, as they are almost identical.

[**View pfSense Command Injection issue on SonarCloud**](https://sonarcloud.io/project/issues?resolved=false&id=SonarSourceResearch_pfsense-blogpost&open=AYtcW5TLYkAG6r383NWA "View pfSense Command Injection issue on SonarCloud")

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/666ecd5d-dd3f-4362-85fb-e37aa3de27c8/Command%20Injection.png?w=1288&h=892&auto=format&fit=crop)

On the `interfaces_gif_edit.php` page, a new [Generic tunneling InterFace (GIF)](https://docs.netgate.com/pfsense/en/latest/interfaces/gif.html "Generic tunneling InterFace (GIF)") can be created or an existing one edited. When a user creates a new GIF, all submitted form parameters like IP addresses (`remote-addr`) and the used network interface (`if`) are validated to contain expected, safe values. When editing an existing GIF, a hidden input element is inserted into the HTML form that holds the `gifif` form parameter. This parameter contains the name of the edited GIF. In both cases, all form parameters are passed as an array to the `interface_gif_configure()` function. Note that the `gifif` parameter was not validated at this point.

```
if (!$input_errors) {
    $gif = array();
    list($gif['if'], $gif['ipaddr']) = explode("|", $_POST['if']);
    // ...
    $gif['remote-addr'] = $_POST['remote-addr'];
    // ...
    $gif['gifif'] = $_POST['gifif'];
    $gif['gifif'] = interface_gif_configure($gif); // <--- HERE
```

The function `interface_gif_configure()` in the `interfaces.inc` file creates a new GIF or recreates the specified GIF using the supplied `$gif` array parameter. This is achieved by calling `ifconfig` and other shell commands with the `mwexec()` util function, which is just a thin wrapper around `exec()`. `escapeshellarg()` is used in an attempt to securely construct the shell command, but the function is only used on variables that are believed to be user-controllable, like `$gif[`'`remote-addr']`. The `$gif['gifif']` variable should contain the name of an already existing GIF that is recreated. So it is assumed that the value is safe and does not need to be escaped. But this assumption is wrong, as shown by the taint flow. `$gif['gifif']` is completely user-controllable, leading to a Command Injection vulnerability.

```
if (platform_booting() || !(empty($gif['gifif']))) {
    pfSense_interface_destroy($gif['gifif']);
    pfSense_interface_create2($gif['gifif']);
    $gifif = $gif['gifif'];
} else {
    $gifif = pfSense_interface_create2("gif");
}
// ...
mwexec("/sbin/ifconfig {$gifif} tunnel {$realifip} " .  escapeshellarg($gif['remote-addr']));
```

An attacker could exploit this vulnerability by inserting a semicolon to start a new shell command and commenting out the unwanted rest of the original command with a hashtag. Because the pfSense process runs as root to be able to change networking settings, the attacker can execute arbitrary system commands as root using this attack. The attacker needs access to a user account with permission to access the `interface_gif_edit.php/interface_gre_edit.php` page, which can be done with the previously shown XSS vulnerability.

```
; whoami #

mwexec("/sbin/ifconfig {$gifif} tunnel {$realifip} " .  escapeshellarg($gif['remote-addr']));

/sbin/ifconfig ; whoami # tunnel 192.168.0.3 1.2.3.4
```
### pfSense Vulnerabilities Patches

Reflected XSS and Command Injection are both Injection vulnerabilities. To patch Injection vulnerabilities, it is necessary to encode/escape all inserted data for the context it is inserted into. We thank the Netgate team, who swiftly responded with patch commits:

In the Reflected XSS case on the `status_logs_filter_dynamic.php` page, the injection context is a JavaScript string. The pfSense maintainers at Netgate [patched](https://github.com/pfsense/pfsense/commit/f387c974a9a597bf01ab86ec049cca186a1e050c "pfsense/pfsense: f387c97") the security vulnerability by using the `json_encode()` and `urlencode()` functions, which were already used on neighboring variables.

```
if ($filtersubmit) {	# Raw mode.
-  $filter_query_string = "type=raw&filter=" . urlencode(json_encode($filtertext )) . "&interfacefilter=" . $interfacefilter;
+  $filter_query_string = "type=raw&filter=" . urlencode(json_encode($filtertext)) . "&interfacefilter=" . urlencode(json_encode($interfacefilter));
}
...
?>
var filter_query_string = "<?=$filter_query_string . '&logfile=' . $logfile_path . '&nentries=' . $nentries?>";
```

While `json_encode()` eliminates all ways for injected values to escape the string context here, the function is intended for encoding JSON, which is different from a JavaScript string inside a script block. In general, injections can still be possible if the wrong encoding function is used. To aid developers in choosing the right fix, each SonarCloud issue has a "How to fix it?" tab. Looking at [the tab for this issue](https://sonarcloud.io/project/issues?resolved=false&types=VULNERABILITY&id=SonarSourceResearch_pfsense-blogpost&open=AYtcW5T0YkAG6r383NYb&tab=how_to_fix "the tab for this issue"), we see that the recommendation for reflected contents inside a script block is to use a data attribute. With an attribute, the context is HTML, and the `htmlentities()` function can be used safely. Unfortunately, there is no PHP function that makes reflecting user input inside script blocks completely safe in all cases, so this approach should be used instead.

```
<script data-filter="<?= htmlentities($interfacefilter) ?>">
  const filter = document.querySelector("[data-filter]").dataset.filter;
</script>
```

For the Command Injection vulnerability, the injection context is a shell command. The maintainers used the `escapeshellarg()` function to [patch](https://github.com/pfsense/pfsense/commit/d69d6c8424ab4299234fb5ec6964682e2e6cbcdd "pfsense/pfsense: d69d6c8") the security vulnerability, which was also already used on neighboring variables. The function wraps its input argument in single quotes and escapes single quotes already present in the input. The shell will take everything wrapped in single quotes as a singular string argument to the current command, which prevents injected values from executing additional malicious commands.

```
- mwexec("/sbin/ifconfig {$gifif} tunnel {$realifip} " . escapeshellarg($gif['remote-addr']));
+ mwexec("/sbin/ifconfig " . escapeshellarg($gifif) . " tunnel " . escapeshellarg($realifip) . " " . escapeshellarg($gif['remote-addr']));
```

Additionally, the [patch](https://github.com/pfsense/pfsense/commit/d69d6c8424ab4299234fb5ec6964682e2e6cbcdd "pfsense/pfsense: d69d6c8") checks if the user input starts with a safe prefix to avoid an [Argument Injection vulnerability](https://sonarsource.github.io/argument-injection-vectors/explained/ "Argument Injection vulnerability"). If the input starts with a dash or two dashes and is used as an argument in the shell command, most programs would parse that as an option. This can have a serious impact as we have shown in [past publications](https://www.sonarsource.com/blog/securing-developer-tools-a-new-supply-chain-attack-on-php/ "past publications").

```
+ if (empty($_POST['gifif']) ||
+   preg_match("/^gif[0-9]+$/", $_POST['gifif'])) {
+     /* Attempt initial configuration of the GIF if the
+     * submitted interface is empty or looks like a GIF
+     * interface. */
+     $gif['gifif'] = $_POST['gifif'];
+     $gif['gifif'] = interface_gif_configure($gif);
+ } else {
+     $input_errors[] = gettext("Invalid GIF interface.");
+ }
```

In both cases, encoding/escaping was already used, just not on every variable interpolated into a dangerous context. The wrong assumptions about which variables are user-controllable then lead to the shown vulnerabilities. That is why we recommend encoding/escaping all variables regardless of source, as there is usually no harm in doing so. This approach also hardens your code against future changes or bugs elsewhere in the codebase, contributing to a Clean Code state.

## Timeline

| **Date** | **Action** |
| --- | --- |
| 2023-07-03 | We report all issues to Netgate |
| 2023-07-05 | Netgate acknowledges all issues and publishes patch commits |
| 2023-10-31 | Netgate publishes [advisories](https://docs.netgate.com/advisories/index.html) for all issues |
| 2023-11-06 | Netgate releases patched version pfSense Plus 23.09 |
| 2023-11-16 | Netgate releases patched version pfSense CE 2.7.1 |

## pfSense Vulnerabilities Summary

This blog post showcased two of the three security vulnerabilities SonarCloud discovered in pfSense. The vulnerable code samples highlighted that it is not easy for developers to remember encoding every user-controllable value in sensitive contexts, especially in large codebases. SonarCloud can help developers keep their code clean by finding injection and other vulnerabilities, all before the vulnerabilities make it into production.

## Related Blog Posts

* [Unzipping Dangers: OpenRefine Zip Slip Vulnerability](https://www.sonarsource.com/blog/openrefine-zip-slip/ "Unzipping Dangers: OpenRefine Zip Slip Vulnerability")
* [Pimcore: One click, two security vulnerabilities](https://www.sonarsource.com/blog/pimcore-one-click-two-security-vulnerabilities/ "Pimcore: One click, two security vulnerabilities")
* [OpenEMR - Remote Code Execution in your Healthcare System](https://www.sonarsource.com/blog/openemr-remote-code-execution-in-your-healthcare-system/ "OpenEMR - Remote Code Execution in your Healthcare System")
* [Cacti: Unauthenticated Remote Code Execution](https://www.sonarsource.com/blog/cacti-unauthenticated-remote-code-execution/ "Cacti: Unauthenticated Remote Code Execution")

#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail
## Get new blogs delivered directly to your inbox!

Stay up-to-date with the latest Sonar content. Subscribe now to receive the latest blog articles.

Email\*cheqSign up

By submitting this form, you agree to the [Privacy Policy](/company/privacy/ "Privacy Policy") and [Cookie Policy](/company/cookie-policy/ "Cookie Policy").

This site is protected by reCAPTCHA and the Google [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms) apply.

[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.



=== Content from rules.sonarsource.com_100cc1b0_20250115_130414.html ===
[![SonarSource Rules](/images/sonar-rules_logo.png)](/)

* Products
  ### In-IDE

  ![Code Quality and Security in your IDE with SonarQube Ide](/images/logos/discover/sonarqube-for-ide-logo.svg "Code Quality and Security in your IDE with SonarQube Ide")

  IDE extension that lets you fix coding issues before they exist!

  [Discover SonarQube for IDE](https://www.sonarsource.com/products/sonarlint/)
  ### SaaS

  ![Code Quality and Security in the cloud with SonarQube Cloud](/images/logos/discover/sonarqube-cloud-logo.svg "Code Quality and Security in the cloud with SonarQube Cloud")

  Setup is effortless and analysis is automatic for most languages

  [Discover SonarQube Cloud](https://www.sonarsource.com/products/sonarcloud/)
  ### Self-Hosted

  ![Code Quality and Security Self-Hosted with SonarQube Server](/images/logos/discover/sonarqube-server-logo.svg "Code Quality and Security Self-Hosted with SonarQube Server")

  Fast, accurate analysis; enterprise scalability

  [Discover SonarQube Server](https://www.sonarsource.com/products/sonarqube/)

* [![Secrets](/images/language-logos/secrets.svg)Secrets](/secrets/)
* [![ABAP](/images/language-logos/abap.svg)ABAP](/abap/)
* [![Ansible](/images/language-logos/ansible.svg)Ansible](/ansible/)
* [![Apex](/images/language-logos/apex.svg)Apex](/apex/)
* [![AzureResourceManager](/images/language-logos/azureresourcemanager.svg)AzureResourceManager](/azureresourcemanager/)
* [![C](/images/language-logos/c.svg)C](/c/)
* [![C#](/images/language-logos/csharp.svg)C#](/csharp/)
* [![C++](/images/language-logos/cpp.svg)C++](/cpp/)
* [![CloudFormation](/images/language-logos/cloudformation.svg)CloudFormation](/cloudformation/)
* [![COBOL](/images/language-logos/cobol.svg)COBOL](/cobol/)
* [![CSS](/images/language-logos/css.svg)CSS](/css/)
* [![Dart](/images/language-logos/dart.svg)Dart](/dart/)
* [![Docker](/images/language-logos/docker.svg)Docker](/docker/)
* [![Flex](/images/language-logos/flex.svg)Flex](/flex/)
* [![Go](/images/language-logos/go.svg)Go](/go/)
* [![HTML](/images/language-logos/html.svg)HTML](/html/)
* [![Java](/images/language-logos/java.svg)Java](/java/)
* [![JavaScript](/images/language-logos/javascript.svg)JavaScript](/javascript/)
* [![JCL](/images/language-logos/jcl.svg)JCL](/jcl/)
* [![Kotlin](/images/language-logos/kotlin.svg)Kotlin](/kotlin/)
* [![Kubernetes](/images/language-logos/kubernetes.svg)Kubernetes](/kubernetes/)
* [![Objective C](/images/language-logos/objective-c.svg)Objective C](/objective-c/)
* ![PHP](/images/language-logos/php.svg)PHP
* [![PL/I](/images/language-logos/pli.svg)PL/I](/pli/)
* [![PL/SQL](/images/language-logos/plsql.svg)PL/SQL](/plsql/)
* [![Python](/images/language-logos/python.svg)Python](/python/)
* [![RPG](/images/language-logos/rpg.svg)RPG](/rpg/)
* [![Ruby](/images/language-logos/ruby.svg)Ruby](/ruby/)
* [![Scala](/images/language-logos/scala.svg)Scala](/scala/)
* [![Swift](/images/language-logos/swift.svg)Swift](/swift/)
* [![Terraform](/images/language-logos/terraform.svg)Terraform](/terraform/)
* [![Text](/images/language-logos/text.svg)Text](/text/)
* [![TypeScript](/images/language-logos/typescript.svg)TypeScript](/typescript/)
* [![T-SQL](/images/language-logos/tsql.svg)T-SQL](/tsql/)
* [![VB.NET](/images/language-logos/vbnet.svg)VB.NET](/vbnet/)
* [![VB6](/images/language-logos/vb6.svg)VB6](/vb6/)
* [![XML](/images/language-logos/xml.svg)XML](/xml/)
![PHP](/images/language-logos/color/php.svg)
## PHP static code analysis

### Unique rules to find Bugs, Vulnerabilities, Security Hotspots, and Code Smells in your PHP code

[* All rules 273](/php/)[* Vulnerability42](/php/type/Vulnerability/)[* Bug51](/php/type/Bug/)[* Security Hotspot34](/php/type/Security%20Hotspot/)[* Code Smell146](/php/type/Code%20Smell/) Tags

Impact

Clean code attribute

1. [### Credentials should not be hard-coded

    Vulnerability](/php/type/Vulnerability/RSPEC-6437/)
2. [### Include expressions should not be vulnerable to injection attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-5335/)
3. [### Dynamic code execution should not be vulnerable to injection attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-5334/)
4. [### HTTP request redirections should not be open to forging attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-5146/)
5. [### Deserialization should not be vulnerable to injection attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-5135/)
6. [### Endpoints should not be vulnerable to reflected cross-site scripting (XSS) attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-5131/)
7. [### Database queries should not be vulnerable to injection attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-3649/)
8. [### XML parsers should not be vulnerable to XXE attacks

    Vulnerability](/php/type/Vulnerability/RSPEC-2755/)
9. [### A secure password should be used when connecting to a database

    Vulnerability](/php/type/Vulnerability/RSPEC-2115/)
10. [### XPath expressions should not be vulnerable to injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-2091/)
11. [### I/O function calls should not be vulnerable to path injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-2083/)
12. [### LDAP queries should not be vulnerable to injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-2078/)
13. [### OS commands should not be vulnerable to command injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-2076/)
14. [### A new session should be created during user authentication

     Vulnerability](/php/type/Vulnerability/RSPEC-5876/)
15. [### Cipher algorithms should be robust

     Vulnerability](/php/type/Vulnerability/RSPEC-5547/)
16. [### Encryption algorithms should be used with secure mode and padding scheme

     Vulnerability](/php/type/Vulnerability/RSPEC-5542/)
17. [### Server hostnames should be verified during SSL/TLS connections

     Vulnerability](/php/type/Vulnerability/RSPEC-5527/)
18. [### Server certificates should be verified during SSL/TLS connections

     Vulnerability](/php/type/Vulnerability/RSPEC-4830/)
19. [### LDAP connections should be authenticated

     Vulnerability](/php/type/Vulnerability/RSPEC-4433/)
20. [### Cryptographic keys should be robust

     Vulnerability](/php/type/Vulnerability/RSPEC-4426/)
21. [### Weak SSL/TLS protocols should not be used

     Vulnerability](/php/type/Vulnerability/RSPEC-4423/)
22. [### Regular expressions should not be vulnerable to Denial of Service attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-2631/)
23. [### Password hashing functions should use an unpredictable salt

     Vulnerability](/php/type/Vulnerability/RSPEC-2053/)
24. [### Server-side requests should not be vulnerable to traversing attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-7044/)
25. [### Applications should not create session cookies from untrusted input

     Vulnerability](/php/type/Vulnerability/RSPEC-6287/)
26. [### Reflection should not be vulnerable to injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-6173/)
27. [### Authorizations should be based on strong decisions

     Vulnerability](/php/type/Vulnerability/RSPEC-5808/)
28. [### Server-side requests should not be vulnerable to forging attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-5144/)
29. [### OS commands should not be vulnerable to argument injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-5883/)
30. [### Logging should not be vulnerable to injection attacks

     Vulnerability](/php/type/Vulnerability/RSPEC-5145/)
31. [### "file\_uploads" should be disabled

     Vulnerability](/php/type/Vulnerability/RSPEC-3338/)
32. [### "enable\_dl" should be disabled

     Vulnerability](/php/type/Vulnerability/RSPEC-3337/)
33. [### "session.use\_trans\_sid" should not be enabled

     Vulnerability](/php/type/Vulnerability/RSPEC-3336/)
34. [### "allow\_url\_fopen" and "allow\_url\_include" should be disabled

     Vulnerability](/php/type/Vulnerability/RSPEC-3334/)
35. [### "open\_basedir" should limit file access

     Vulnerability](/php/type/Vulnerability/RSPEC-3333/)
36. [### Neither DES (Data Encryption Standard) nor DESede (3DES) should be used

     Vulnerability](/php/type/Vulnerability/RSPEC-2278/)
37. [### Session-management cookies should not be persistent

     Vulnerability](/php/type/Vulnerability/RSPEC-3332/)
38. [### Cryptographic RSA algorithms should always incorporate OAEP (Optimal Asymmetric Encryption Padding)

     Vulnerability](/php/type/Vulnerability/RSPEC-2277/)
39. [### SHA-1 and Message-Digest hash algorithms should not be used in secure contexts

     Vulnerability](/php/type/Vulnerability/RSPEC-2070/)
40. [### Secret keys and salt values should be robust

     Vulnerability](/php/type/Vulnerability/RSPEC-6339/)
41. [### "cgi.force\_redirect" should be enabled

     Vulnerability](/php/type/Vulnerability/RSPEC-3335/)
42. [### "sleep" should not be called

     Vulnerability](/php/type/Vulnerability/RSPEC-2964/)

# Endpoints should not be vulnerable to reflected cross-site scripting (XSS) attacks

Analyze your codeintentionality - completesecurity Vulnerability Blocker[SonarSource default severity
click to learn more](https://blog.sonarsource.com/we-are-adjusting-rules-severities)

* [injection](/php/tag/injection/RSPEC-5131/)
* [cwe](/php/tag/cwe/RSPEC-5131/)

This vulnerability makes it possible to temporarily execute JavaScript code in the context of the application, granting access to the session of
the victim. This is possible because user-provided data, such as URL parameters, are copied into the HTML body of the HTTP response that is sent back
to the user.

## Why is this an issue?

## How can I fix it?

## More Info

Reflected cross-site scripting (XSS) occurs in a web application when the application retrieves data like parameters or headers from an incoming
HTTP request and inserts it into its HTTP response without first sanitizing it. The most common cause is the insertion of GET parameters.

When well-intentioned users open a link to a page that is vulnerable to reflected XSS, they are exposed to attacks that target their own
browser.

A user with malicious intent carefully crafts the link beforehand.

After creating this link, the attacker must use phishing techniques to ensure that his target users click on the link.

### What is the potential impact?

A well-intentioned user opens a malicious link that injects data into the web application. This data can be text, but it can also be arbitrary code
that can be interpreted by the target user’s browser, such as HTML, CSS, or JavaScript.

Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.

#### Vandalism on the front-end website

The malicious link defaces the target web application from the perspective of the user who is the victim. This may result in loss of integrity and
theft of the benevolent user’s data.

#### Identity spoofing

The forged link injects malicious code into the web application. The code enables identity spoofing thanks to cookie theft.

#### Record user activity

The forged link injects malicious code into the web application. To leak confidential information, attackers can inject code that records keyboard
activity (keylogger) and even requests access to other devices, such as the camera or microphone.

#### Chaining XSS with other vulnerabilities

In many cases, bug hunters and attackers chain cross-site scripting vulnerabilities with other vulnerabilities to maximize their impact.
 For
example, an XSS can be used as the first step to exploit more dangerous vulnerabilities or features that require higher privileges, such as a code
injection vulnerability in the admin control panel of a web application.

Available In:* [![SonarQube Cloud](/images/logos/sonarqube-cloud-logo.svg)Detect issues in your GitHub, Azure DevOps Services, Bitbucket Cloud, GitLab repositories](https://www.sonarsource.com/products/sonarcloud/)
* [![SonarQube Server](/images/logos/sonarqube-server-logo.svg)Developer](https://www.sonarsource.com/plans-and-pricing/developer/)

© 2008-2024 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.

Sonar helps developers write [Clean Code](https://www.sonarsource.com/solutions/clean-code/).
[Privacy Policy](https://www.sonarsource.com/company/privacy/) | [Cookie Policy](https://www.sonarsource.com/company/cookie-policy/)


