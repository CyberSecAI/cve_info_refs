=== Content from bugzilla.redhat.com_ac62a0e3_20250115_213305.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2255569)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2255569)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2255569)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 2255569

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 2255569**](show_bug.cgi?id=2255569)
- TRIAGE [CVE-2023-42465](https://access.redhat.com/security/cve/CVE-2023-42465) sudo: Targeted Corruption of Register and Stack Variables [fedora-all]

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
TRIAGE CVE-2023-42465 sudo: Targeted Corruption of Register and Stack Variabl...

| | [Keywords](describekeywords.cgi): | Security  SecurityTracking | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | sudo | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 39 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Radovan Sroka | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [CVE-2023-42465, mayhem](show_bug.cgi?id=2255568 "NEW - CVE-2023-42465 sudo: Targeted Corruption of Register and Stack Variables") | | TreeView+ | [depends on](buglist.cgi?bug_id=2255569&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2255569&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2023-12-21 23:04 UTC by Nick Tait | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2024-02-18 01:49 UTC ([History](show_activity.cgi?id=2255569)) | | [CC List:](page.cgi?id=fields.html#cclist) | 5 users (show)  alakatos kzak mattdm rsroka zfridric | | Fixed In Version: | sudo-1.9.15-1.p5.fc40 sudo-1.9.15-1.p5.fc39 sudo-1.9.15-1.p5.fc38 | | | Doc Type: | No Doc Update | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2024-01-24 23:00:17 UTC | | | Type: | --- | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2255569#c0)  Nick Tait    2023-12-21 23:04:21 UTC  ```  More information about this security flaw is available in the following bug:  <http://bugzilla.redhat.com/show_bug.cgi?id=2255568>  Disclaimer: Community trackers are created by Red Hat Product Security team on a best effort basis. Package maintainers are required to ascertain if the flaw indeed affects their package, before starting the update process.   ```  [Comment 1](show_bug.cgi?id=2255569#c1)  Nick Tait    2023-12-21 23:04:24 UTC  ``` Use the following template to for the 'fedpkg update' request to submit an update for this issue as it contains the top-level parent bug(s) as well as this tracking bug.  This will ensure that all associated bugs get updated when new packages are pushed to stable.  =====  # bugfix, security, enhancement, newpackage (required) type=security  # low, medium, high, urgent (required) severity=medium  # testing, stable request=testing  # Bug numbers: 1234,9876 bugs=2255568,2255569  # Description of your update notes=Security fix for [PUT CVEs HERE]  # Enable request automation based on the stable/unstable karma thresholds autokarma=True stable_karma=3 unstable_karma=-3  # Automatically close bugs when this marked as stable close_bugs=True  # Suggest that users restart after update suggest_reboot=False  ======  Additionally, you may opt to use the bodhi web interface to submit updates:  <https://bodhi.fedoraproject.org/updates/new>   ```  [Comment 2](show_bug.cgi?id=2255569#c2)  Fedora Update System    2024-01-24 10:21:10 UTC  ``` FEDORA-2024-57eebd0963 has been submitted as an update to Fedora 40. <https://bodhi.fedoraproject.org/updates/FEDORA-2024-57eebd0963>   ```  [Comment 3](show_bug.cgi?id=2255569#c3)  Fedora Update System    2024-01-24 10:48:50 UTC  ``` FEDORA-2024-cdccda4f62 has been submitted as an update to Fedora 39. <https://bodhi.fedoraproject.org/updates/FEDORA-2024-cdccda4f62>   ```  [Comment 4](show_bug.cgi?id=2255569#c4)  Fedora Update System    2024-01-24 10:50:16 UTC  ``` FEDORA-2024-6fa5af9ea8 has been submitted as an update to Fedora 38. <https://bodhi.fedoraproject.org/updates/FEDORA-2024-6fa5af9ea8>   ```  [Comment 5](show_bug.cgi?id=2255569#c5)  Fedora Update System    2024-01-24 23:00:17 UTC  ``` FEDORA-2024-57eebd0963 has been pushed to the Fedora 40 stable repository. If problem still persists, please make note of it in this bug report.   ```  [Comment 6](show_bug.cgi?id=2255569#c6)  Fedora Update System    2024-01-25 01:11:48 UTC  ``` FEDORA-2024-6fa5af9ea8 has been pushed to the Fedora 38 testing repository. Soon you'll be able to install the update with the following command: `sudo dnf upgrade --enablerepo=updates-testing --refresh --advisory=FEDORA-2024-6fa5af9ea8` You can provide feedback for this update here: <https://bodhi.fedoraproject.org/updates/FEDORA-2024-6fa5af9ea8>  See also [https://fedoraproject.org/wiki/QA:Updates_Testing](https://fedoraproject.org/wiki/QA%3AUpdates_Testing) for more information on how to test updates.   ```  [Comment 7](show_bug.cgi?id=2255569#c7)  Fedora Update System    2024-01-25 01:12:01 UTC  ``` FEDORA-2024-cdccda4f62 has been pushed to the Fedora 39 testing repository. Soon you'll be able to install the update with the following command: `sudo dnf upgrade --enablerepo=updates-testing --refresh --advisory=FEDORA-2024-cdccda4f62` You can provide feedback for this update here: <https://bodhi.fedoraproject.org/updates/FEDORA-2024-cdccda4f62>  See also [https://fedoraproject.org/wiki/QA:Updates_Testing](https://fedoraproject.org/wiki/QA%3AUpdates_Testing) for more information on how to test updates.   ```  [Comment 8](show_bug.cgi?id=2255569#c8)  Fedora Update System    2024-01-28 03:08:46 UTC  ``` FEDORA-2024-cdccda4f62 has been pushed to the Fedora 39 stable repository. If problem still persists, please make note of it in this bug report.   ```  [Comment 9](show_bug.cgi?id=2255569#c9)  Fedora Update System    2024-02-18 01:49:36 UTC  ``` FEDORA-2024-6fa5af9ea8 (sudo-1.9.15-1.p5.fc38) has been pushed to the Fedora 38 stable repository. If problem still persists, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2255569&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from github.com_955e6d87_20250115_213229.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsudo-project%2Fsudo%2Fcommit%2F7873f8334c8d31031f8cfa83bd97ac6029309e4f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsudo-project%2Fsudo%2Fcommit%2F7873f8334c8d31031f8cfa83bd97ac6029309e4f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=sudo-project%2Fsudo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sudo-project](/sudo-project)
/
**[sudo](/sudo-project/sudo)**
Public

* [Notifications](/login?return_to=%2Fsudo-project%2Fsudo) You must be signed in to change notification settings
* [Fork
  227](/login?return_to=%2Fsudo-project%2Fsudo)
* [Star
   1.2k](/login?return_to=%2Fsudo-project%2Fsudo)

* [Code](/sudo-project/sudo)
* [Issues
  25](/sudo-project/sudo/issues)
* [Pull requests
  3](/sudo-project/sudo/pulls)
* [Actions](/sudo-project/sudo/actions)
* [Projects
  0](/sudo-project/sudo/projects)
* [Security](/sudo-project/sudo/security)
* [Insights](/sudo-project/sudo/pulse)

Additional navigation options

* [Code](/sudo-project/sudo)
* [Issues](/sudo-project/sudo/issues)
* [Pull requests](/sudo-project/sudo/pulls)
* [Actions](/sudo-project/sudo/actions)
* [Projects](/sudo-project/sudo/projects)
* [Security](/sudo-project/sudo/security)
* [Insights](/sudo-project/sudo/pulse)

## Commit

[Permalink](/sudo-project/sudo/commit/7873f8334c8d31031f8cfa83bd97ac6029309e4f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Try to make sudo less vulnerable to ROWHAMMER attacks.

[Browse files](/sudo-project/sudo/tree/7873f8334c8d31031f8cfa83bd97ac6029309e4f)
Browse the repository at this point in the history

```
We now use ROWHAMMER-resistent values for ALLOW, DENY, AUTH_SUCCESS,
AUTH_FAILURE, AUTH_ERROR and AUTH_NONINTERACTIVE.  In addition, we
explicitly test for expected values instead of using a negated test
against an error value.  In the parser match functions this means
explicitly checking for ALLOW or DENY instead of accepting anything
that is not set to UNSPEC.

Thanks to Andrew J. Adiletta, M. Caner Tol, Yarkin Doroz, and Berk
Sunar, all affiliated with the Vernam Applied Cryptography and
Cybersecurity Lab at Worcester Polytechnic Institute, for the report.
Paper preprint: <https://arxiv.org/abs/2309.02545>
```

* Loading branch information

[![@millert](https://avatars.githubusercontent.com/u/348203?s=40&v=4)](/millert)

[millert](/sudo-project/sudo/commits?author=millert "View all commits by millert")
committed
Sep 9, 2023

1 parent
[525803d](/sudo-project/sudo/commit/525803db23d8d52b876f4427d4e241b22ba5dda6)

commit 7873f83

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**96 additions**
and
**54 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* plugins/sudoers

  + auth

    - plugins/sudoers/auth/passwd.c
      [passwd.c](#diff-56fef60dcb3651b02ad3c52fab8bca3319b1aa5ad153479ddbe7d47d1e4f6786)
    - plugins/sudoers/auth/sudo\_auth.c
      [sudo\_auth.c](#diff-2c34ab9cb5b6c669af09185e8e63b8b2ac6cde95d8fde418b409237379e8f7ca)
    - plugins/sudoers/auth/sudo\_auth.h
      [sudo\_auth.h](#diff-b8ac7ab4c3c4a75aed0bb5f7c5fd38b9ea6c81b7557f775e46c6f8aa115e02cd)
  + plugins/sudoers/lookup.c
    [lookup.c](#diff-0aa64178b1ae67d7699d2046906080959aed51789e702376d8871342607aab4c)
  + plugins/sudoers/match.c
    [match.c](#diff-278af94c080c16e046fb62874556f77e5bb897c8430b7cbb5da6378ec6db383f)
  + plugins/sudoers/parse.h
    [parse.h](#diff-bc39bcb6f7119485e73eb37357a3e3ae1123fe09ac06b040f090b3218f186cb1)

## There are no files selected for viewing

27 changes: 17 additions & 10 deletions

27
[plugins/sudoers/auth/passwd.c](#diff-56fef60dcb3651b02ad3c52fab8bca3319b1aa5ad153479ddbe7d47d1e4f6786 "plugins/sudoers/auth/passwd.c")

Show comments

[View file](/sudo-project/sudo/blob/7873f8334c8d31031f8cfa83bd97ac6029309e4f/plugins/sudoers/auth/passwd.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -68,7 +68,7 @@ sudo\_passwd\_verify(const struct sudoers\_context \*ctx, struct passwd \*pw, |
|  |  | char des\_pass[9], \*epass; |
|  |  | char \*pw\_epasswd = auth->data; |
|  |  | size\_t pw\_len; |
|  |  | int matched = 0; |
|  |  | int ret; |
|  |  | debug\_decl(sudo\_passwd\_verify, SUDOERS\_DEBUG\_AUTH); |
|  |  |  |
|  |  | /\* An empty plain-text password must match an empty encrypted password. \*/ |
| Expand All | | @@ -80,7 +80,7 @@ sudo\_passwd\_verify(const struct sudoers\_context \*ctx, struct passwd \*pw, |
|  |  | \*/ |
|  |  | pw\_len = strlen(pw\_epasswd); |
|  |  | if (pw\_len == DESLEN || HAS\_AGEINFO(pw\_epasswd, pw\_len)) { |
|  |  | strlcpy(des\_pass, pass, sizeof(des\_pass)); |
|  |  | (void)strlcpy(des\_pass, pass, sizeof(des\_pass)); |
|  |  | pass = des\_pass; |
|  |  | } |
|  |  |  |
| Expand All | | @@ -90,30 +90,37 @@ sudo\_passwd\_verify(const struct sudoers\_context \*ctx, struct passwd \*pw, |
|  |  | \* only compare the first DESLEN characters in that case. |
|  |  | \*/ |
|  |  | epass = (char \*) crypt(pass, pw\_epasswd); |
|  |  | ret = AUTH\_FAILURE; |
|  |  | if (epass != NULL) { |
|  |  | if (HAS\_AGEINFO(pw\_epasswd, pw\_len) && strlen(epass) == DESLEN) |
|  |  | matched = !strncmp(pw\_epasswd, epass, DESLEN); |
|  |  | else |
|  |  | matched = !strcmp(pw\_epasswd, epass); |
|  |  | if (HAS\_AGEINFO(pw\_epasswd, pw\_len) && strlen(epass) == DESLEN) { |
|  |  | if (strncmp(pw\_epasswd, epass, DESLEN) == 0) |
|  |  | ret = AUTH\_SUCCESS; |
|  |  | } else { |
|  |  | if (strcmp(pw\_epasswd, epass) == 0) |
|  |  | ret = AUTH\_SUCCESS; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | explicit\_bzero(des\_pass, sizeof(des\_pass)); |
|  |  |  |
|  |  | debug\_return\_int(matched ? AUTH\_SUCCESS : AUTH\_FAILURE); |
|  |  | debug\_return\_int(ret); |
|  |  | } |
|  |  | #else |
|  |  | int |
|  |  | sudo\_passwd\_verify(const struct sudoers\_context \*ctx, struct passwd \*pw, |
|  |  | const char \*pass, sudo\_auth \*auth, struct sudo\_conv\_callback \*callback) |
|  |  | { |
|  |  | char \*pw\_passwd = auth->data; |
|  |  | int matched; |
|  |  | int ret; |
|  |  | debug\_decl(sudo\_passwd\_verify, SUDOERS\_DEBUG\_AUTH); |
|  |  |  |
|  |  | /\* Simple string compare for systems without crypt(). \*/ |
|  |  | matched = !strcmp(pass, pw\_passwd); |
|  |  | if (strcmp(pass, pw\_passwd) == 0) |
|  |  | ret = AUTH\_SUCCESS; |
|  |  | else |
|  |  | ret = AUTH\_FAILURE; |
|  |  |  |
|  |  | debug\_return\_int(matched ? AUTH\_SUCCESS : AUTH\_FAILURE); |
|  |  | debug\_return\_int(ret); |
|  |  | } |
|  |  | #endif |
|  |  |  |
| Expand Down | |  |

51 changes: 36 additions & 15 deletions

51
[plugins/sudoers/auth/sudo\_auth.c](#diff-2c34ab9cb5b6c669af09185e8e63b8b2ac6cde95d8fde418b409237379e8f7ca "plugins/sudoers/auth/sudo_auth.c")

Show comments

[View file](/sudo-project/sudo/blob/7873f8334c8d31031f8cfa83bd97ac6029309e4f/plugins/sudoers/auth/sudo_auth.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -116,10 +116,16 @@ sudo\_auth\_init(const struct sudoers\_context \*ctx, struct passwd \*pw, |
|  |  | if (auth->init && !IS\_DISABLED(auth)) { |
|  |  | /\* Disable if it failed to init unless there was a fatal error. \*/ |
|  |  | status = (auth->init)(ctx, pw, auth); |
|  |  | if (status == AUTH\_FAILURE) |
|  |  | switch (status) { |
|  |  | case AUTH\_SUCCESS: |
|  |  | break; |
|  |  | case AUTH\_FAILURE: |
|  |  | SET(auth->flags, FLAG\_DISABLED); |
|  |  | else if (status == AUTH\_ERROR) |
|  |  | break; /\* assume error msg already printed \*/ |
|  |  | break; |
|  |  | default: |
|  |  | /\* Assume error msg already printed. \*/ |
|  |  | debug\_return\_int(-1); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -166,7 +172,7 @@ sudo\_auth\_init(const struct sudoers\_context \*ctx, struct passwd \*pw, |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | debug\_return\_int(status == AUTH\_ERROR ? -1 : 0); |
|  |  | debug\_return\_int(0); |
|  |  | } |
|  |  |  |
|  |  | /\* |
| Expand Down  Expand Up | | @@ -209,7 +215,7 @@ sudo\_auth\_cleanup(const struct sudoers\_context \*ctx, struct passwd \*pw, |
|  |  | for (auth = auth\_switch; auth->name; auth++) { |
|  |  | if (auth->cleanup && !IS\_DISABLED(auth)) { |
|  |  | int status = (auth->cleanup)(ctx, pw, auth, force); |
|  |  | if (status == AUTH\_ERROR) { |
|  |  | if (status != AUTH\_SUCCESS) { |
|  |  | /\* Assume error msg already printed. \*/ |
|  |  | debug\_return\_int(-1); |
|  |  | } |
| Expand Down  Expand Up | | @@ -306,7 +312,7 @@ verify\_user(const struct sudoers\_context \*ctx, struct passwd \*pw, char \*prompt, |
|  |  | SET(auth->flags, FLAG\_DISABLED); |
|  |  | else if (status == AUTH\_NONINTERACTIVE) |
|  |  | goto done; |
|  |  | else if (status == AUTH\_ERROR || user\_interrupted()) |
|  |  | else if (status != AUTH\_SUCCESS || user\_interrupted()) |
|  |  | goto done; /\* assume error msg already printed \*/ |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -365,7 +371,6 @@ verify\_user(const struct sudoers\_context \*ctx, struct passwd \*pw, char \*prompt, |
|  |  | case AUTH\_NONINTERACTIVE: |
|  |  | SET(validated, FLAG\_NO\_USER\_INPUT); |
|  |  | FALLTHROUGH; |
|  |  | case AUTH\_ERROR: |
|  |  | default: |
|  |  | log\_auth\_failure(ctx, validated, 0); |
|  |  | ret = -1; |
| Expand All | | @@ -377,25 +382,33 @@ verify\_user(const struct sudoers\_context \*ctx, struct passwd \*pw, char \*prompt, |
|  |  |  |
|  |  | /\* |
|  |  | \* Call authentication method begin session hooks. |
|  |  | \* Returns 1 on success and -1 on error. |
|  |  | \* Returns true on success, false on failure and -1 on error. |
|  |  | \*/ |
|  |  | int |
|  |  | sudo\_auth\_begin\_session(const struct sudoers\_context \*ctx, struct passwd \*pw, |
|  |  | char \*\*user\_env[]) |
|  |  | { |
|  |  | sudo\_auth \*auth; |
|  |  | int ret = true; |
|  |  | debug\_decl(sudo\_auth\_begin\_session, SUDOERS\_DEBUG\_AUTH); |
|  |  |  |
|  |  | for (auth = auth\_switch; auth->name; auth++) { |
|  |  | if (auth->begin\_session && !IS\_DISABLED(auth)) { |
|  |  | int status = (auth->begin\_session)(ctx, pw, user\_env, auth); |
|  |  | if (status != AUTH\_SUCCESS) { |
|  |  | switch (status) { |
|  |  | case AUTH\_SUCCESS: |
|  |  | break; |
|  |  | case AUTH\_FAILURE: |
|  |  | ret = false; |
|  |  | break; |
|  |  | default: |
|  |  | /\* Assume error msg already printed. \*/ |
|  |  | debug\_return\_int(-1); |
|  |  | ret = -1; |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | debug\_return\_int(1); |
|  |  | debug\_return\_int(ret); |
|  |  | } |
|  |  |  |
|  |  | bool |
| Expand All | | @@ -416,25 +429,33 @@ sudo\_auth\_needs\_end\_session(void) |
|  |  |  |
|  |  | /\* |
|  |  | \* Call authentication method end session hooks. |
|  |  | \* Returns 1 on success and -1 on error. |
|  |  | \* Returns true on success, false on failure and -1 on error. |
|  |  | \*/ |
|  |  | int |
|  |  | sudo\_auth\_end\_session(void) |
|  |  | { |
|  |  | sudo\_auth \*auth; |
|  |  | int ret = true; |
|  |  | int status; |
|  |  | debug\_decl(sudo\_auth\_end\_session, SUDOERS\_DEBUG\_AUTH); |
|  |  |  |
|  |  | for (auth = auth\_switch; auth->name; auth++) { |
|  |  | if (auth->end\_session && !IS\_DISABLED(auth)) { |
|  |  | status = (auth->end\_session)(auth); |
|  |  | if (status == AUTH\_ERROR) { |
|  |  | switch (status) { |
|  |  | case AUTH\_SUCCESS: |
|  |  | break; |
|  |  | case AUTH\_FAILURE: |
|  |  | ret = false; |
|  |  | break; |
|  |  | default: |
|  |  | /\* Assume error msg already printed. \*/ |
|  |  | debug\_return\_int(-1); |
|  |  | ret = -1; |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | debug\_return\_int(1); |
|  |  | debug\_return\_int(ret); |
|  |  | } |
|  |  |  |
|  |  | /\* |
| Expand Down | |  |

12 changes: 6 additions & 6 deletions

12
[plugins/sudoers/auth/sudo\_auth.h](#diff-b8ac7ab4c3c4a75aed0bb5f7c5fd38b9ea6c81b7557f775e46c6f8aa115e02cd "plugins/sudoers/auth/sudo_auth.h")

Show comments

[View file](/sudo-project/sudo/blob/7873f8334c8d31031f8cfa83bd97ac6029309e4f/plugins/sudoers/auth/sudo_auth.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,12 +19,12 @@ |
|  |  | #ifndef SUDO\_AUTH\_H |
|  |  | #define SUDO\_AUTH\_H |
|  |  |  |
|  |  | /\* Auth function return values. \*/ |
|  |  | #define AUTH\_SUCCESS 0 |
|  |  | #define AUTH\_FAILURE 1 |
|  |  | #define AUTH\_INTR 2 |
|  |  | #define AUTH\_ERROR 3 |
|  |  | #define AUTH\_NONINTERACTIVE 4 |
|  |  | /\* Auth function return values (rowhammer resistent). \*/ |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fsudo-project%2Fsudo%2Fcommit%2F7873f8334c8d31031f8cfa83bd97ac6029309e4f)       Sorry, something went wrong.           Copy link    Quote reply     @pavlinux **[pavlinux](/pavlinux)** [Dec 25, 2023](#r135689044) • edited      Loading       Makefile:  ``` gcc -DRND1=0x$(openssl rand -hex 4) \        -DRND2=0x$(openssl rand -hex 4) \        -DRND3=0x$(openssl rand -hex 4) \        -DRND4=0x$(openssl rand -hex 4) \        -DRND5=0x$(openssl rand -hex 4)  ...  ```  sudo\_auth.h  ``` #define AUTH_SUCCESS RND1 /* х.з. */ #define AUTH_FAILURE RND2 /* х.з. */ #define AUTH_INTR RND3 /* х.з. */ #define AUTH_ERROR RND4 /* х.з. */ #define AUTH_NONINTERACTIVE RND5 /* х.з. */  ```     😄 4  pavlinux, finwarman, hedger, and TimeToogo reacted with laugh emoji   All reactions  * 😄   4 reactions         This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fsudo-project%2Fsudo%2Fcommit%2F7873f8334c8d31031f8cfa83bd97ac6029309e4f)       Sorry, something went wrong.           Copy link    Quote reply     @millert **[millert](/millert)** [Dec 26, 2023](#r135711595) Author  Collaborator   The values used were chosen such that it takes a large number of bit flips to change from allowed to denied. Using random values doesn't really protect against this attack.     👍 4  henry701, colejohnson66, Swyter, and pavlinux reacted with thumbs up emoji  🎉 1  jakiestfu reacted with hooray emoji  🚀 2  danodonovan and jakiestfu reacted with rocket emoji   All reactions  * 👍   4 reactions * 🎉   1 reaction * 🚀   2 reactions | | |
|  |  | #define AUTH\_SUCCESS 0x52a2925 /\* 0101001010100010100100100101 \*/ |
|  |  | #define AUTH\_FAILURE 0xad5d6da /\* 1010110101011101011011011010 \*/ |
|  |  | #define AUTH\_INTR 0x69d61fc8 /\* 1101001110101100001111111001000 \*/ |
|  |  | #define AUTH\_ERROR 0x1629e037 /\* 0010110001010011110000000110111 \*/ |
|  |  | #define AUTH\_NONINTERACTIVE 0x1fc8d3ac /\* 11111110010001101001110101100 \*/ |
|  |  |  |
|  |  | typedef struct sudo\_auth { |
|  |  | unsigned int flags; /\* various flags, see below \*/ |
| Expand Down | |  |

12 changes: 6 additions & 6 deletions

12
[plugins/sudoers/lookup.c](#diff-0aa64178b1ae67d7699d2046906080959aed51789e702376d8871342607aab4c "plugins/sudoers/lookup.c")

Show comments

[View file](/sudo-project/sudo/blob/7873f8334c8d31031f8cfa83bd97ac6029309e4f/plugins/sudoers/lookup.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -100,7 +100,7 @@ sudoers\_lookup\_pseudo(struct sudo\_nss\_list \*snl, struct sudoers\_context \*ctx, |
|  |  | int user\_match = userlist\_matches(nss->parse\_tree, ctx->user.pw, |
|  |  | &us->users); |
|  |  | if (user\_match != ALLOW) { |
|  |  | if (callback != NULL && user\_match != UNSPEC) { |
|  |  | if (callback != NULL && user\_match == DENY) { |
|  |  | callback(nss->parse\_tree, us, user\_match, NULL, UNSPEC, |
|  |  | NULL, UNSPEC, UNSPEC, UNSPEC, cb\_data); |
|  |  | } |
| Expand Down  Expand Up | | @@ -189,7 +189,7 @@ sudoers\_lookup\_pseudo(struct sudo\_nss\_list \*snl, struct sudoers\_context \*ctx, |
|  |  | host\_match, cs, date\_match, runas\_match, |
|  |  | cmnd\_match, cb\_data); |
|  |  | } |
|  |  | if (cmnd\_match != UNSPEC) { |
|  |  | if (SPECIFIED(cmnd\_match)) { |
|  |  | /\* |
|  |  | \* We take the last match but must process |
|  |  | \* the entire policy for pwcheck == all. |
| Expand Down  Expand Up | | @@ -245,7 +245,7 @@ sudoers\_lookup\_check(struct sudo\_nss \*nss, struct sudoers\_context \*ctx, |
|  |  | TAILQ\_FOREACH\_REVERSE(us, &nss->parse\_tree->userspecs, userspec\_list, entries) { |
|  |  | int user\_match = userlist\_matches(nss->parse\_tree, ctx->user.pw, &us->users); |
|  |  | if (user\_match != ALLOW) { |
|  |  | if (callback != NULL && user\_match != UNSPEC) { |
|  |  | if (callback != NULL && user\_match == DENY) { |
|  |  | callback(nss->parse\_tree, us, user\_match, NULL, UNSPEC, NULL, |
|  |  | UNSPEC, UNSPEC, UNSPEC, cb\_data); |
|  |  | } |
| Expand Down  Expand Up | | @@ -290,7 +290,7 @@ sudoers\_lookup\_check(struct sudo\_nss \*nss, struct sudoers\_context \*ctx, |
|  |  | cs, date\_match, runas\_match, cmnd\_match, cb\_data); |
|  |  | } |
|  |  |  |
|  |  | if (cmnd\_match != UNSPEC) { |
|  |  | if (SPECIFIED(cmnd\_match)) { |
|  |  | /\* |
|  |  | \* If user is running command as themselves, |
|  |  | \* set ctx->runas.pw = ctx->user.pw. |
| Expand Down  Expand Up | | @@ -542,15 +542,15 @@ sudoers\_lookup(struct sudo\_nss\_list \*snl, struct sudoers\_context \*ctx, |
|  |  |  |
|  |  | m = sudoers\_lookup\_check(nss, ctx, &validated, &info, now, callback, |
|  |  | cb\_data, &cs, &defs); |
|  |  | if (m != UNSPEC) { |
|  |  | if (SPECIFIED(m)) { |
|  |  | match = m; |
|  |  | parse\_tree = nss->parse\_tree; |
|  |  | } |
|  |  |  |
|  |  | if (!sudo\_nss\_can\_continue(nss, m)) |
|  |  | break; |
|  |  | } |
|  |  | if (match != UNSPEC) { |
|  |  | if (SPECIFIED(match)) { |
|  |  | if (info.cmnd\_path != NULL) { |
|  |  | /\* Update cmnd, cmnd\_stat, cmnd\_status from matching entry. \*/ |
|  |  | free(ctx->user.cmnd); |
| Expand Down | |  |

25 changes: 13 additions & 12 deletions

25
[plugins/sudoers/match.c](#diff-278af94c080c16e046fb62874556f77e5bb897c8430b7cbb5da6378ec6db383f "plugins/sudoers/match.c")

Show comments

[View file](/sudo-project/sudo/blob/7873f8334c8d31031f8cfa83bd97ac6029309e4f/plugins/sudoers/match.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -91,7 +91,7 @@ user\_matches(const struct sudoers\_parse\_tree \*parse\_tree, |
|  |  | if ((a = alias\_get(parse\_tree, m->name, USERALIAS)) != NULL) { |
|  |  | /\* XXX \*/ |
|  |  | const int rc = userlist\_matches(parse\_tree, pw, &a->members); |
|  |  | if (rc != UNSPEC) { |
|  |  | if (SPECIFIED(rc)) { |
|  |  | if (m->negated) { |
|  |  | matched = rc == ALLOW ? DENY : ALLOW; |
|  |  | } else { |
| Expand Down  Expand Up | | @@ -123,7 +123,8 @@ userlist\_matches(const struct sudoers\_parse\_tree \*parse\_tree, |
|  |  | debug\_decl(userlist\_matches, SUDOERS\_DEBUG\_MATCH); |
|  |  |  |
|  |  | TAILQ\_FOREACH\_REVERSE(m, list, member\_list, entries) { |
|  |  | if ((matched = user\_matches(parse\_tree, pw, m)) != UNSPEC) |
|  |  | matched = user\_matches(parse\_tree, pw, m); |
|  |  | if (SPECIFIED(matched)) |
|  |  | break; |
|  |  | } |
|  |  | debug\_return\_int(matched); |
| Expand Down  Expand Up | | @@ -184,7 +185,7 @@ runas\_userlist\_matches(const struct sudoers\_parse\_tree \*parse\_tree, |
|  |  | if (a != NULL) { |
|  |  | const int rc = runas\_userlist\_matches(parse\_tree, |
|  |  | &a->members, matching\_user); |
|  |  | if (rc != UNSPEC) { |
|  |  | if (SPECIFIED(rc)) { |
|  |  | if (m->negated) { |
|  |  | user\_matched = rc == ALLOW ? DENY : ALLOW; |
|  |  | } else { |
| Expand All | | @@ -211,7 +212,7 @@ runas\_userlist\_matches(const struct sudoers\_parse\_tree \*parse\_tree, |
|  |  | user\_matched = m->negated ? DENY : ALLOW; |
|  |  | break; |
|  |  | } |
|  |  | if (user\_matched != UNSPEC) { |
|  |  | if (SPECIFIED(user\_matched)) { |
|  |  | if (matching\_user != NULL && m->type != ALIAS) |
|  |  | \*matching\_user = m; |
|  |  | break; |
| Expand Down  Expand Up | | @@ -246,7 +247,7 @@ runas\_grouplist\_matches(const struct sudoers\_parse\_tree \*parse\_tree, |
|  |  | if (a != NULL) { |
|  |  | const int rc = runas\_grouplist\_matches(parse\_tree, |
|  |  | &a->members, matching\_group); |
|  |  | if (rc != UNSPEC) { |
|  |  | if (SPECIFIED(rc)) { |
|  |  | if (m->negated) { |
|  |  | group\_matched = rc == ALLOW ? DENY : ALLOW; |
|  |  | } else { |
| Expand All | | @@ -262,14 +263,14 @@ runas\_grouplist\_matches(const struct sudoers\_parse\_tree \*parse\_tree, |
|  |  | group\_matched = m->negated ? DENY : ALLOW; |
|  |  | break; |
|  |  | } |
|  |  | if (group\_matched != UNSPEC) { |
|  |  | if (SPECIFIED(group\_matched)) { |
|  |  | if (matching\_group != NULL && m->type != ALIAS) |
|  |  | \*matching\_group = m; |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | if (group\_matched == UNSPEC) { |
|  |  | if (!SPECIFIED(group\_matched)) { |
|  |  | struct gid\_list \*runas\_groups; |
|  |  | /\* |
|  |  | \* The runas group was not explicitly allowed by sudoers. |
| Expand Down  Expand Up | | @@ -349,7 +350,7 @@ hostlist\_matches\_int(const struct sudoers\_parse\_tree \*parse\_tree, |
|  |  |  |
|  |  | TAILQ\_FOREACH\_REVERSE(m, list, member\_list, entries) { |
|  |  | matched = host\_matches(parse\_tree, pw, lhost, shost, m); |
|  |  | if (matched != UNSPEC) |
|  |  | if (SPECIFIED(matched)) |
|  |  | break; |
|  |  | } |
|  |  | debug\_return\_int(matched); |
| Expand Down  Expand Up | | @@ -402,7 +403,7 @@ host\_matches(const struct sudoers\_parse\_tree \*parse\_tree, |
|  |  | /\* XXX \*/ |
|  |  | const int rc = hostlist\_matches\_int(parse\_tree, pw, lhost, |
|  |  | shost, &a->members); |
|  |  | if (rc != UNSPEC) { |
|  |  | if (SPECIFIED(rc)) { |
|  |  | if (m->negated) { |
|  |  | matched = rc == ALLOW ? DENY : ALLOW; |
|  |  | } else { |
| Expand Down  Expand Up | | @@ -440,7 +441,7 @@ cmndlist\_matches(const struct sudoers\_parse\_tree \*parse\_tree, |
|  |  |  |
|  |  | TAILQ\_FOREACH\_REVERSE(m, list, member\_list, entries) { |
|  |  | matched = cmnd\_matches(parse\_tree, m, runchroot, info); |
|  |  | if (matched != UNSPEC) |
|  |  | if (SPECIFIED(matched)) |
|  |  | break; |
|  |  | } |
|  |  | debug\_return\_int(matched); |
| Expand Down  Expand Up | | @@ -471,7 +472,7 @@ cmnd\_matches(const struct sudoers\_parse\_tree \*parse\_tree, |
|  |  | a = alias\_get(parse\_tree, m->name, CMNDALIAS); |
|  |  | if (a != NULL) { |
|  |  | rc = cmndlist\_matches(parse\_tree, &a->members, runchroot, info); |
|  |  | if (rc != UNSPEC) { |
|  |  | if (SPECIFIED(rc)) { |
|  |  | if (m->negated) { |
|  |  | matched = rc == ALLOW ? DENY : ALLOW; |
|  |  | } else { |
| Expand Down  Expand Up | | @@ -511,7 +512,7 @@ cmnd\_matches\_all(const struct sudoers\_parse\_tree \*parse\_tree, |
|  |  | if (a != NULL) { |
|  |  | TAILQ\_FOREACH\_REVERSE(m, &a->members, member\_list, entries) { |
|  |  | matched = cmnd\_matches\_all(parse\_tree, m, runchroot, info); |
|  |  | if (matched != UNSPEC) { |
|  |  | if (SPECIFIED(matched)) { |
|  |  | if (negated) |
|  |  | matched = matched == ALLOW ? DENY : ALLOW; |
|  |  | break; |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7873f83`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsudo-project%2Fsudo%2Fcommit%2F7873f8334c8d31031f8cfa83bd97ac6029309e4f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.netapp.com_3c97cd24_20250115_213254.html ===


* Sign in

  Welcome!

  An account will enable you to access:

  + NetApp support's essential features
  + NetApp communities
  + NetApp training
  + [Sign in to my dashboard](/LoginEntity/SignIn "Sign in")
  + [Create an account](https://mysupport.netapp.com/site/user/registration "Create an account")

  NetApp account
  + [NetApp dashboard](/account/)
  + [Sign out](/LoginEntity/SignOut)
* * English

    Language
    + [English](/esg/trust-center/compliance/)
    + [Deutsch](/de/esg/trust-center/compliance/)
    + [Español](/es/esg/trust-center/compliance/)
    + [Français](/fr/esg/trust-center/compliance/)
    + [Italiano](/it/esg/trust-center/compliance/)
    + [Português](/pt/esg/trust-center/compliance/)
    + [日本語](/ja/esg/trust-center/compliance/)
    + [한국어](/ko/esg/trust-center/compliance/)
    + [简体中文](/zh-hans/esg/trust-center/compliance/)
    + [繁體中文](/zh-hant/esg/trust-center/compliance/)
     [See your global contacts](/company/contact-us/)
* All NetApp

  + [NetApp.com](https://www.netapp.com/)
  + [BlueXP](https://bluexp.netapp.com/)
  + [Instaclustr](https://www.instaclustr.com/)
  + [Spot](https://spot.io/)
  Learn
  + [Support](https://mysupport.netapp.com/)
  + [Documentation](/support-and-training/documentation/)
  + [Knowledge Base](https://kb.netapp.com/)
  + [Learning Services](/support-and-training/netapp-learning-services/)
  Browse
  + [Community](https://community.netapp.com/)
  + [Hardware Universe](https://hwu.netapp.com/)
  + [Partner Hub](https://partnerhub.netapp.com)

* Solutions & Products
  Solutions & Products

  Data Storage
  + [Unified Data Storage

    Store any data for any workload anywhere](/unified-storage/ "Unified Data Storage")
  + [Storage Systems

    Modernize and simplify your storage environment](/data-storage/ "Storage Systems")
  + [Storage as a Service

    Flexible pay-as-you-go consumption models](/services/keystone/ "Storage as a Service")
  + [Public Clouds

    Simplify your cloud management landscape](/cloud-services/ "Public Clouds")
  + [AWS](/aws/ "AWS")
  + [Google Cloud](/google-cloud/ "Google Cloud")
  + [Microsoft Azure](/azure/ "Microsoft Azure")
  Data Management
  + [Intelligent Services

    Manage any storage, any cloud, anywhere](/intelligent-services/ "Intelligent Services")
  + [Artificial Intelligence

    Enable efficient data collection and workloads](/artificial-intelligence/ "Artificial Intelligence")
  + [Cyber Resilience

    Protect and secure your sensitive company data](/cyber-resilience/ "Cyber Resilience")
  + [Data Services

    Maintain complete control over your data](/data-management/ "Data Services")
  + [DevOps

    Reduce friction, accelerate development and productivity](/devops-solutions/ "DevOps")
  + [Enterprise Applications

    Modernize and migrate apps, improve quality, reduce risk](/enterprise-applications/ "Enterprise Applications")
  + [Infrastructure and Workload Services

    Optimize performance, efficiency, and availability](/infrastructure-workload-services/ "Infrastructure and Workload Services")

  + [BlueXP](/bluexp/ "BlueXP")
  + [View solutions](/storage-solutions/ "View solutions")
  + [View services](/services/ "View services")
  + [View products A-Z](/products-a-z/ "View products A-Z")
  + [Product updates](/product-updates/ "Product updates")
* Explore NetApp
  Explore NetApp
  [![](data:image/gif;base64...)
  The intelligent data infrastructure company

  Explore innovative solutions that transform how businesses harness the power of data.](/intelligent-data-infrastructure/ "The intelligent data infrastructure company")

  Built for you
  + [Industries we serve](/industries/ "Industries we serve")
  + [Customer experience](/customer-experience/ "Customer experience")
  + [NetApp Intelligence](/netapp-intelligence/ "NetApp Intelligence")
  + [Success stories](/customers/#t=CustomerStories&sort=relevancy&f:@facet_language_mktg=[English] "Success stories")About NetApp
  + [Company story](/company/ "Company story")
  + [Become a partner](/partners/become-a-partner/ "Become a partner")
  + [Contact NetApp](/company/contact-us/ "Contact NetApp")
* How to Buy
  How to Buy
  [![](data:image/gif;base64...)
  Storage as a service

  NetApp Keystone gives you flexible pay-as-you-go cloud consumption models whether you’re on-premises or in the cloud.](/services/keystone/ "Storage as a service")

  Ready to Try?
  + [Test drive a product](/test-drives/ "Test drive a product")
  + [Start a free trial](/how-to-buy/trials-test-drives/ "Start a free trial")Ready to buy?
  + [Contact sales](/forms/sales-contact/ "Contact sales")
  + [Connect with a partner](/partners/partner-connect/#t=Partners&sort=%40partnerweight%20descending&layout=card&f:@facet_language_mktg=[English] "Connect with a partner")
  + [Sales and Services Ts & Cs](/how-to-buy/sales-terms-and-conditions/ "Sales and Services Ts & Cs")
* Support & Training
  Support & Training
  [![](data:image/gif;base64...)
  Join our community

  Get involved with the best community around. NetApp and customers helping each other find answers through discussion threads.](https://community.netapp.com/ "Join our community")

  Get Help
  + [Technical support](https://mysupport.netapp.com/ "Technical support")
  + [Support services](/services/support/ "Support services")
  + [Keystone support](https://netappgssc.service-now.com/csm/ "Keystone support")
  + [Knowledge base](https://kb.netapp.com/ "Knowledge base")
  + [Downloads](https://mysupport.netapp.com/site/downloads/ "Downloads")Education & Training
  + [Training & certifications](/support-and-training/netapp-learning-services/ "Training & certifications")
  + [Product documentation](/support-and-training/documentation/ "Product documentation")
  + [NetApp Developer](/developer/ "NetApp Developer")

[Sign in to my dashboard](/account "Sign in")
[Create an account](https://mysupport.netapp.com/site/user/registration "Create an account")

English

Menu

[Trust Center](/esg/trust-center/)

![Magnify glass on gray background ](/media/magnify-title-web2x_tcm19-31734.jpg?v=160709)

# Compliance: Data security and data privacy

Contents

* [Overview: NetApp compliance offerings](#prose 1 "Overview: NetApp compliance offerings")
* [California Consumer Privacy Act (CCPA) & California Privacy Rights Act (CPRA)](#prose 2 "California Consumer Privacy Act (CCPA) & California Privacy Rights Act (CPRA)")
* [Commercial Solutions for Classified (CSfC) Program](#proseCSfC "Commercial Solutions for Classified (CSfC) Program")
* [Common Criteria](#prose 3 "Common Criteria")
* [DoDIN APL](#prose 4 "DoDIN APL")
* [DoD Cloud Computing Security Requirements Guide (CC SRG)](#prose4-2 "DoD Cloud Computing Security Requirements Guide (CC SRG)")
* [FedRAMP](#prose 5 "FedRAMP")
* [FIPS 140](#prose 6 "FIPS 140")
* [General Data Protection Regulation (GDPR)](#prose 7 "General Data Protection Regulation (GDPR)")
* [Health Insurance Portability and Accountability Act (HIPAA)](#prose 8 "Health Insurance Portability and Accountability Act (HIPAA)")
* [ISO/IEC 27001](#prose 9 "ISO/IEC 27001")
* [NF203](#NF203 "NF203")
* [Payment Card Industry Data Security Standard (PCI DSS)](#prose11 "Payment Card Industry Data Security Standard (PCI DSS)")
* [SOC 2 Reports](#prose 12 "SOC 2 Reports")

#### Share this page

August 2023

NetApp has a long-held and ongoing commitment to compliance with the ever-evolving set of global, regional, and data security and privacy standards and regulations. We uphold this commitment through self-assessments and rigorous audits by independent accredited third parties. These audits validate the adherence of our products and services to the requirements of such standards as ISO/IEC 27001, the GDPR, and the Common Criteria. These assessments help demonstrate NetApp’s integration of internationally recognized processes and best practices in our business, enabling customers to use our products and services regardless of their compliance needs.

NetApp supplies information for each compliance offering (listed at left) that includes a list of in-scope software and hardware and links to the relevant certificates and auditor’s reports.

> ### Starting on a foundation of globally recognized standards means that digital transformation can follow a known roadmap of security and privacy compliance.
>
>
> Biren Fondekar,
>
> Chief Transformation Officer,
>
> NetApp

## Overview: NetApp compliance offerings

Get a complete list of all NetApp services, hardware, and software that comply with global, regional, and industry-specific data security, engineering, and privacy regulations and standards governing the collection and use of data.

* [Learn more](/esg/trust-center/compliance/netapp-compliance-offerings/ "Learn more ")

## California Consumer Privacy Act (CCPA) & California Privacy Rights Act (CPRA)

NetApp is committed to respecting consumers’ privacy rights and operating in compliance with global data privacy laws, including the California Consumer Privacy Act (CCPA) and its expansion, the California Privacy Rights Act (CPRA). Our contractual commitments to legal compliance, include our Privacy Policy and customer contracts. These are based on whether we are collecting customers’ personal data or acting as a service provider to customers who are collecting personal data. We back these contractual commitments with processes and policies designed to comply with the CCPA and CPRA.

* [Learn more](/esg/trust-center/privacy/CCPA-california-consumer-privacy-act/ "Learn more")

## Commercial Solutions for Classified (CSfC) Program

NetApp ONTAP data management software is the first enterprise-class storage solution validated by the Commercial Solutions for Classified (CSfC) Program. It enables enhanced security protection for data at rest at both the hardware and software layers. The CSfC Program is a key component of the U.S. National Security Agency (NSA) commercial cybersecurity strategy. It validates commercial products that meet the rigorous security requirements for protecting classified secret and top-secret data.

* [Learn more](/esg/trust-center/compliance/CSfC-Program/ "Learn more ")

## Common Criteria

Continuing a certification tradition dating back to 2005, when NetApp Data ONTAP was first certified, NetApp has achieved Common Criteria (ISO/IEC 15408-1:2009) certification for its storage software and hardware products. Independent accredited testing laboratories audited NetApp products and certified their compliance with Common Criteria. NetApp government and government contractor customers can rely on our Common Criteria certification for their purchasing requirements.

* [Learn more](/esg/trust-center/compliance/common-criteria/ "Learn more")

## DoDIN APL

NetApp ONTAP was first certified in 2005 by the U.S. Defense Information Systems Agency (DISA). DISA placed in-scope NetApp products on the U.S. Department of Defense Information Network Approved Products List (DoDIN APL). Certification of NetApp products to the DoDIN APL enables U.S. defense agencies and organizations supporting the defense industrial base to use them with confidence.

* [Learn more](/esg/trust-center/compliance/dodin-apl/ "Learn more")

## DoD Cloud Computing Security Requirements Guide (CC SRG)

Amazon FSx for NetApp ONTAP is authorized for U.S. Department of Defense (DoD) Cloud Computing Security Requirements Guide (CC SRG) Impact Levels 2, 4, and 5 in the Amazon Web Services (AWS) GovCloud (US) Regions and Impact Level 2 in AWS US Regions.

* [Learn more](/esg/trust-center/compliance/dod-cc-srg/ "Learn more")

## FedRAMP

Both Amazon FSx for NetApp ONTAP (through Amazon Web Services) and Azure NetApp Files® (through Microsoft Azure and Microsoft Azure Government) have obtained a P-ATO from the Joint Authorization Board (JAB), the primary governance body for FedRAMP.

Amazon FSx for NetApp ONTAP has FedRAMP authorization at the High and Moderate Impact Levels for AWS US Regions and the High Impact Level for AWS GovCloud (US) Regions. Azure NetApp Files® has FedRAMP authorization at both High and Medium Impact Levels for Azure commercial cloud services and a High Impact Level for Azure Government cloud services.

* [Learn more](/esg/trust-center/compliance/FedRAMP/ "Learn more")

## FIPS 140

FIPS 140 is a U.S. government standard that sets security requirements for cryptographic modules in hardware, software, and firmware, and NetApp offers cryptographic modules that have achieved FIPS 140 validation. NetApp offers a variety of hardware, software, and services and therefore takes a variety of approaches to FIPS 140 compliance. For example, for covered software, NetApp includes cryptographic modules that have achieved level 1 validation for the encryption of data in transit and at rest.

* [Learn more](/esg/trust-center/compliance/fips-140/ "Learn more")

## General Data Protection Regulation (GDPR)

NetApp maintains a comprehensive strategy for compliance with data privacy laws, including the EU General Data Protection Regulation (GDPR). We back our commitments through organizational and engineering measures designed to respect the rights of data subjects and securely process personal information in compliance with the GDPR and our European regulators. Whether your enterprise is a data controller or data processor, NetApp products and services offer the tools necessary to implement programs that support your compliance with the GDPR. We back these commitments with a number of customer contracts.

* [Learn more](/esg/trust-center/privacy/gdpr-compliance/ "Learn more")

## Health Insurance Portability and Accountability Act (HIPAA)

Customers managing data regulated under the Health Insurance Portability and Accountability Act (HIPAA) can take advantage of a variety of NetApp products and services for storage management.

To support the HIPAA compliance of NetApp services , Net App relies on our SOC 2 Type 2 certifications by an independent third party. SOC 2 reports offer assurance to customers that NetApp controls reasonably protect the confidentiality and privacy of user information processed by NetApp systems. NetApp solutions with SOC 2 Type 2 reports may also be available to covered entities or business associates for their management of protected health information.

* [Learn more](/esg/trust-center/compliance/HIPAA/ "Learn more")

## ISO/IEC 27001

Annually, NetApp engages an accredited certification body, which has certified that the NetApp Information Security Management System demonstrates conformance to the ISO 27001 standard. Our auditor has verified that NetApp policies, procedures, and controls maintain the privacy, security, integrity, and availability of information.

* [Learn more](/esg/trust-center/compliance/iso-27001/ "Learn more")

## NF203

After an extensive audit, the accredited certifying body INFOCERT has renewed the certification of NetApp® StorageGRID® to the French accounting standard NF Logiciel (NF203). This renewal includes certification to the international standard for how products are developed, tested, and validated, ISO/IEC 25051.

* [Learn more](/esg/trust-center/compliance/nf203/ "Learn more")

## Payment Card Industry Data Security Standard (PCI DSS)

Compliance with the Payment Card Industry Data Security Standard (PCI DSS) is required of all companies that process, store, or transmit credit card information through the five major payment card brands. Instaclustr™ by NetApp® has been certified as compliant with the PCI DSS at Level 1—the highest level of transactions.

* [Learn more](/esg/trust-center/compliance/pci-dss/ "Learn more")

## SOC 2 Reports

NetApp products and services are audited regularly against the SOC 2 (AT Section 101) standard by an independent certified public accountant firm and services auditor. They examined NetApp in-scope cloud and managed services, and affirmed that they have achieved SOC 2 reports based on the applicable Trust Services Criteria.

* [Learn more](/esg/trust-center/compliance/soc-2/ "Learn more")

Back To Top

Website

* [Industries](/industries/)
* [Customer stories](/customers/)
* [How to buy](/how-to-buy/)
* [Spot by NetApp](https://spot.io/)
* [Products A-Z](/products-a-z/)
* [Product Updates](/product-updates/#t=ProductUpdates&sort=%40publish_date_mktg%20descending)

Support

* [Support & training](/support-and-training/)
* [Knowledge base](https://kb.netapp.com/)
* [Knowledge center](/knowledge-center/)
* [Documentation](/support-and-training/documentation/)
* [Community](https://community.netapp.com/)

NetApp

* [Company](/company/)
* [Partners](/partners/)
* [Careers](https://careers.netapp.com/)
* [Investors](https://investors.netapp.com/)
* [Trust Center](/esg/trust-center/)
* [Quality certifications](/company/quality-certifications/)
* [Environmental, social & governance](/esg/)

Resources

* [Newsroom](/newsroom/)
* [Events](/company/events/)
* [Blog](/blog/)
* [Executive briefing](/company/executive-briefing-center/)

Engage

* [Contact us](/company/contact-us/)
* [Site feedback](https://listening.netapp.com/jfe/form/SV_dcilAAaRGF9r95A)
* [Accessibility](https://www.netapp.com/company/legal/accessibility/)
* [Email subscriptions](/utility/subscribe/)

* © 2025 NetApp

* [Terms of use](/company/legal/terms-of-use/)
* [Privacy policy](/company/legal/privacy-policy/)
* [Cookie policy](/company/legal/cookie-policy/)
* Cookie Settings
* [Modern Slavery Statement](/pdf.html?item=/media/107863-netapp-slavery-and-human-trafficking-statement.pdf)
* [Legal](/company/legal/)

Follow Us

Follow Us

* [Facebook](https://www.facebook.com/NetApp)
* [Instagram](https://www.instagram.com/netapp/)
* [LinkedIn](https://www.linkedin.com/company/netapp)
* [Twitter](https://twitter.com/netapp)

![Drift chat loading](https://www.netapp.com/media/drift-icon-shadow_tcm19-70572.png)



=== Content from www.openwall.com_5ae0e912_20250115_082322.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID:
 <MN0PR01MB76576CBDD822AEB3A2292F23D497A@MN0PR01MB7657.prod.exchangelabs.com>
Date: Thu, 21 Dec 2023 18:54:57 +0000
From: "Tol, Caner" <mtol@....edu>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
CC: "Adiletta, Andrew" <ajadiletta@....edu>, "Sunar, Berk" <sunar@....edu>,
	"Doroz, Yarkin" <ydoroz@....edu>
Subject: Mayhem: Targeted Corruption of Register and Stack Variables

Our recent paper<<https://arxiv.org/pdf/2309.02545.pdf>> [AsiaCCS'24] describes a potential vulnerability where stack/register variables can be flipped via fault injection, affecting execution flow in security-sensitive code. There are mitigation strategies you may be interested in incorporating into your code:

 Take this vulnerable code, for example:

int auth = 0;

//password check code that sets auth variable

if(auth != 0)

return AUTH_SUCCESS;

else

return AUTH_FAILURE;

The idea is that any bit can be flipped in auth, and it will result in a mis-authentication. We prove this is a potential vulnerability in OpenSSH, OpenSSL, MySQL, and SUDO. To mitigate this, it is important to have tight logic such that a single-bit flip will not result in unintended execution. For example:

int auth = 0xbe405d1a;

// password check code that sets auth variable to 0x23ab9701 is successful

If(auth == 0x23ab9701)

               return AUTH_SUCCESS;

else

               return AUTH_FAILURE;

In this case, the auth variable must be corrupted into the exact authentication pattern, which is fairly improbable.

We issued CVE-2023-42465 for SUDO for this vulnerability.

Here is the patch implemented in v1.9.15.

<https://github.com/sudo-project/sudo/commit/7873f8334c8d31031f8cfa83bd97ac6029309e4f>

Paper link: <https://arxiv.org/abs/2309.02545>

Caner Tol
___________________________
Worcester Polytechnic Institute
<https://vernamlab.org><<https://vernamlab.org/>>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.netapp.com_08b9ffa9_20250115_213255.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2023-42465 Sudo Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20240208-0002)

## CVE-2023-42465 Sudo Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20240208-0002 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240208-0002 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20240208-0002 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240208-0002 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240208-0002
**Version:**
3.0

**Last updated:**
06/10/2024

**Status:**
Interim.

**CVEs:** CVE-2023-42465

Overview
#### Summary

Multiple NetApp products incorporate Sudo. Sudo versions prior to 1.9.15 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2023-42465](https://nvd.nist.gov/vuln/detail/CVE-2023-42465) | 7.0 (HIGH) | CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://www.sudo.ws/releases/changelog/>
* <https://github.com/sudo-project/sudo/releases/tag/SUDO_1_9_15>

Affected Products
#### Affected Products

None.

#### Products Under Investigation

* NetApp HCI Compute Node (Bootstrap OS)

#### Products Not Affected

* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 10
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x
* Terraform Provider for ONTAP

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240208-0002>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240208 | Initial Public Release |
| 2.0 | 20240222 | NetApp SolidFire & HCI Management Node and NetApp SolidFire & HCI Storage Node (Element Software) moved to Products Not Affected |
| 3.0 | 20240610 | ONTAP tools for VMware vSphere 10 moved to Products Not Affected |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from security.netapp.com_eaf46361_20250115_213252.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)

## Security Advisories

NetAppâs available Security Advisories are listed below.

To receive notifications when new information is available for the latest 400 advisories, subscribe to the [RSS 2.0 feed](index.xml) using your preferred RSS reader.

Subscribe to receive email updates

close ×
#### Subscribe to all advisory updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to all advisory update alerts

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×
#### Unsubscribe from all advisory updates

Email

Unsubscribe

#### Unsubscribe from all advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

| ID | Title | Last Updated |
| --- | --- | --- |
| [**NTAP-20250110-0004**](https://security.netapp.com/advisory/ntap-20250110-0004/) | CVE-2024-10005 HashiCorp Consul Vulnerability in NetApp Products | 2025-01-10 |
| [**NTAP-20250110-0005**](https://security.netapp.com/advisory/ntap-20250110-0005/) | CVE-2024-10006 HashiCorp Consul Vulnerability in NetApp Products | 2025-01-10 |
| [**NTAP-20250110-0006**](https://security.netapp.com/advisory/ntap-20250110-0006/) | CVE-2024-10086 HashiCorp Consul Vulnerability in NetApp Products | 2025-01-10 |
| [**NTAP-20250110-0003**](https://security.netapp.com/advisory/ntap-20250110-0003/) | CVE-2024-10979 PostgreSQL Vulnerability in NetApp Products | 2025-01-10 |
| [**NTAP-20250110-0010**](https://security.netapp.com/advisory/ntap-20250110-0010/) | CVE-2024-38819 Spring Framework Vulnerability in NetApp Products | 2025-01-10 |
| [**NTAP-20250110-0002**](https://security.netapp.com/advisory/ntap-20250110-0002/) | CVE-2024-39281 FreeBSD Vulnerability in NetApp Products | 2025-01-10 |
| [**NTAP-20250110-0001**](https://security.netapp.com/advisory/ntap-20250110-0001/) | CVE-2024-45289 FreeBSD Vulnerability in NetApp Products | 2025-01-10 |
| [**NTAP-20250110-0007**](https://security.netapp.com/advisory/ntap-20250110-0007/) | CVE-2024-7594 HashiCorp Vault Vulnerability in NetApp Products | 2025-01-10 |
| [**NTAP-20250110-0008**](https://security.netapp.com/advisory/ntap-20250110-0008/) | CVE-2024-8929 PHP Vulnerability in NetApp Products | 2025-01-10 |
| [**NTAP-20250110-0009**](https://security.netapp.com/advisory/ntap-20250110-0009/) | CVE-2024-8932 PHP Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20250103-0008**](https://security.netapp.com/advisory/ntap-20250103-0008/) | CVE-2016-10229 Linux Kernel Vulnerability in NetApp Products | 2025-01-03 |
| [**NTAP-20250103-0010**](https://security.netapp.com/advisory/ntap-20250103-0010/) | CVE-2017-18017 Linux Kernel Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20250103-0009**](https://security.netapp.com/advisory/ntap-20250103-0009/) | CVE-2023-38429 Linux Kernel Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20250103-0006**](https://security.netapp.com/advisory/ntap-20250103-0006/) | CVE-2024-43398 Ruby Vulnerability in NetApp Products | 2025-01-03 |
| [**NTAP-20250103-0004**](https://security.netapp.com/advisory/ntap-20250103-0004/) | CVE-2024-45802 Squid Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20250103-0007**](https://security.netapp.com/advisory/ntap-20250103-0007/) | CVE-2024-49767 Werkzeug Vulnerability in NetApp Products | 2025-01-03 |
| [**NTAP-20250103-0003**](https://security.netapp.com/advisory/ntap-20250103-0003/) | CVE-2024-50379 Apache Tomcat Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20250103-0001**](https://security.netapp.com/advisory/ntap-20250103-0001/) | CVE-2024-52046 Apache MINA Vulnerability in NetApp Products | 2025-01-03 |
| [**NTAP-20250103-0005**](https://security.netapp.com/advisory/ntap-20250103-0005/) | CVE-2024-53677 Apache Struts Vulnerability in NetApp Products | 2025-01-03 |
| [**NTAP-20250103-0002**](https://security.netapp.com/advisory/ntap-20250103-0002/) | CVE-2024-56337 Apache Tomcat Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241227-0009**](https://security.netapp.com/advisory/ntap-20241227-0009/) | CVE-2017-12588 Rsyslog Vulnerability in NetApp Products | 2024-12-27 |
| [**NTAP-20241227-0007**](https://security.netapp.com/advisory/ntap-20241227-0007/) | CVE-2017-8923 PHP Vulnerability in NetApp Products | 2024-12-27 |
| [**NTAP-20241227-0008**](https://security.netapp.com/advisory/ntap-20241227-0008/) | CVE-2018-12121 Node.js Vulnerability in NetApp Products | 2024-12-27 |
| [**NTAP-20241227-0010**](https://security.netapp.com/advisory/ntap-20241227-0010/) | CVE-2018-20060 urllib3 Vulnerability in NetApp Products | 2024-12-27 |
| [**NTAP-20241227-0006**](https://security.netapp.com/advisory/ntap-20241227-0006/) | CVE-2023-52439 Linux Kernel Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241227-0002**](https://security.netapp.com/advisory/ntap-20241227-0002/) | CVE-2024-3056 Podman Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241227-0001**](https://security.netapp.com/advisory/ntap-20241227-0001/) | CVE-2024-38816 Spring Framework Vulnerability in NetApp Products | 2024-12-27 |
| [**NTAP-20241227-0005**](https://security.netapp.com/advisory/ntap-20241227-0005/) | CVE-2024-41123 Ruby Vulnerability in NetApp Products | 2024-12-27 |
| [**NTAP-20241227-0003**](https://security.netapp.com/advisory/ntap-20241227-0003/) | CVE-2024-48949 Node.js Vulnerability in NetApp Products | 2024-12-27 |
| [**NTAP-20241227-0004**](https://security.netapp.com/advisory/ntap-20241227-0004/) | CVE-2024-49761 Ruby Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241220-0007**](https://security.netapp.com/advisory/ntap-20241220-0007/) | CVE-2019-17546 LibTIFF Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241220-0006**](https://security.netapp.com/advisory/ntap-20241220-0006/) | CVE-2020-21583 Util-linux Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241220-0009**](https://security.netapp.com/advisory/ntap-20241220-0009/) | CVE-2023-29403 Golang Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241220-0005**](https://security.netapp.com/advisory/ntap-20241220-0005/) | CVE-2024-0985 PostgreSQL Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241220-0001**](https://security.netapp.com/advisory/ntap-20241220-0001/) | CVE-2024-26633 Linux Kernel Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241220-0002**](https://security.netapp.com/advisory/ntap-20241220-0002/) | CVE-2024-26882 Linux Kernel Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241220-0003**](https://security.netapp.com/advisory/ntap-20241220-0003/) | CVE-2024-45663 IBM Db2 Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241220-0004**](https://security.netapp.com/advisory/ntap-20241220-0004/) | CVE-2024-48948 Node.js Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241220-0010**](https://security.netapp.com/advisory/ntap-20241220-0010/) | CVE-2024-9407 Podman Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241220-0008**](https://security.netapp.com/advisory/ntap-20241220-0008/) | November 2024 PHP Vulnerabilities in NetApp Products | 2024-12-20 |
| [**NTAP-20241213-0003**](https://security.netapp.com/advisory/ntap-20241213-0003/) | CVE-2017-9217 Systemd Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241213-0009**](https://security.netapp.com/advisory/ntap-20241213-0009/) | CVE-2018-12122 Node.js Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241213-0008**](https://security.netapp.com/advisory/ntap-20241213-0008/) | CVE-2018-12123 Node.js Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241213-0002**](https://security.netapp.com/advisory/ntap-20241213-0002/) | CVE-2018-7738 Util-linux Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241213-0005**](https://security.netapp.com/advisory/ntap-20241213-0005/) | CVE-2023-29400 Golang Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241213-0004**](https://security.netapp.com/advisory/ntap-20241213-0004/) | CVE-2023-29402 Golang Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241213-0007**](https://security.netapp.com/advisory/ntap-20241213-0007/) | CVE-2023-43804 urllib3 Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241213-0001**](https://security.netapp.com/advisory/ntap-20241213-0001/) | CVE-2024-29131 Apache Commons Configuration Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241213-0010**](https://security.netapp.com/advisory/ntap-20241213-0010/) | CVE-2024-7254 Protobuf-java Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241213-0006**](https://security.netapp.com/advisory/ntap-20241213-0006/) | CVE-2024-9681 curl Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241206-0010**](https://security.netapp.com/advisory/ntap-20241206-0010/) | CVE-2019-12749 D-Bus Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241206-0004**](https://security.netapp.com/advisory/ntap-20241206-0004/) | CVE-2023-27561 runc Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20241206-0005**](https://security.netapp.com/advisory/ntap-20241206-0005/) | CVE-2023-28642 runc Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241206-0003**](https://security.netapp.com/advisory/ntap-20241206-0003/) | CVE-2023-29405 Golang Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241206-0007**](https://security.netapp.com/advisory/ntap-20241206-0007/) | CVE-2023-42366 Busybox Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241206-0002**](https://security.netapp.com/advisory/ntap-20241206-0002/) | CVE-2024-28103 Ruby on Rails Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20241206-0008**](https://security.netapp.com/advisory/ntap-20241206-0008/) | CVE-2024-29857 Bouncy Castle Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20241206-0006**](https://security.netapp.com/advisory/ntap-20241206-0006/) | CVE-2024-38796 Tianocore EDK2 Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20241206-0001**](https://security.netapp.com/advisory/ntap-20241206-0001/) | CVE-2024-39689 Certifi Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241206-0009**](https://security.netapp.com/advisory/ntap-20241206-0009/) | CVE-2024-52533 Gnome Glib Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241129-0002**](https://security.netapp.com/advisory/ntap-20241129-0002/) | CVE-2022-2795 ISC BIND Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241129-0001**](https://security.netapp.com/advisory/ntap-20241129-0001/) | CVE-2022-48174 Busybox Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20241129-0004**](https://security.netapp.com/advisory/ntap-20241129-0004/) | CVE-2023-24537 Golang Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241129-0005**](https://security.netapp.com/advisory/ntap-20241129-0005/) | CVE-2023-24539 Golang Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241129-0006**](https://security.netapp.com/advisory/ntap-20241129-0006/) | CVE-2023-2610 Vim Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241129-0011**](https://security.netapp.com/advisory/ntap-20241129-0011/) | CVE-2023-31486 Perl Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241129-0010**](https://security.netapp.com/advisory/ntap-20241129-0010/) | CVE-2023-34042 Spring Security Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241129-0012**](https://security.netapp.com/advisory/ntap-20241129-0012/) | CVE-2023-6378 Logback Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241129-0003**](https://security.netapp.com/advisory/ntap-20241129-0003/) | CVE-2024-38820 Spring Framework Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241129-0007**](https://security.netapp.com/advisory/ntap-20241129-0007/) | CVE-2024-41957 Vim Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241129-0009**](https://security.netapp.com/advisory/ntap-20241129-0009/) | CVE-2024-6162 Undertow Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241129-0008**](https://security.netapp.com/advisory/ntap-20241129-0008/) | CVE-2024-6197 curl Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241122-0010**](https://security.netapp.com/advisory/ntap-20241122-0010/) | CVE-2022-1304 E2fsprogs Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241122-0004**](https://security.netapp.com/advisory/ntap-20241122-0004/) | CVE-2023-7008 Systemd Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241122-0007**](https://security.netapp.com/advisory/ntap-20241122-0007/) | CVE-2024-1442 Grafana Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20241122-0008**](https://security.netapp.com/advisory/ntap-20241122-0008/) | CVE-2024-1459 Undertow Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20241122-0006**](https://security.netapp.com/advisory/ntap-20241122-0006/) | CVE-2024-22020 Node.js Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20241122-0009**](https://security.netapp.com/advisory/ntap-20241122-0009/) | CVE-2024-28835 GNU TLS Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241122-0001**](https://security.netapp.com/advisory/ntap-20241122-0001/) | CVE-2024-30045 .NET Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20241122-0005**](https://security.netapp.com/advisory/ntap-20241122-0005/) | CVE-2024-36137 Node.js Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20241122-0002**](https://security.netapp.com/advisory/ntap-20241122-0002/) | CVE-2024-8372 AngularJS Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241122-0003**](https://security.netapp.com/advisory/ntap-20241122-0003/) | CVE-2024-8373 AngularJS Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241122-0011**](https://security.netapp.com/advisory/ntap-20241122-0011/) | July 2024 7-Zip Vulnerabilities in NetApp Products | 2024-12-06 |
| [**NTAP-20241115-0004**](https://security.netapp.com/advisory/ntap-20241115-0004/) | CVE-2022-0318 Vim Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241115-0010**](https://security.netapp.com/advisory/ntap-20241115-0010/) | CVE-2022-3520 Vim Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241115-0007**](https://security.netapp.com/advisory/ntap-20241115-0007/) | CVE-2023-24538 Golang Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241115-0008**](https://security.netapp.com/advisory/ntap-20241115-0008/) | CVE-2023-24540 Golang Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241115-0009**](https://security.netapp.com/advisory/ntap-20241115-0009/) | CVE-2023-29404 Golang Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241115-0006**](https://security.netapp.com/advisory/ntap-20241115-0006/) | CVE-2024-25744 Linux Kernel Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20241115-0003**](https://security.netapp.com/advisory/ntap-20241115-0003/) | CVE-2024-29736 Apache CXF Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20241115-0005**](https://security.netapp.com/advisory/ntap-20241115-0005/) | CVE-2024-38428 GNU Wget Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241115-0002**](https://security.netapp.com/advisory/ntap-20241115-0002/) | CVE-2024-41965 Vim Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20241115-0001**](https://security.netapp.com/advisory/ntap-20241115-0001/) | CVE-2024-6384 MongoDB Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241108-0005**](https://security.netapp.com/advisory/ntap-20241108-0005/) | CVE-2023-30584 Node.js Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20241108-0004**](https://security.netapp.com/advisory/ntap-20241108-0004/) | CVE-2023-30587 Node.js Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20241108-0001**](https://security.netapp.com/advisory/ntap-20241108-0001/) | CVE-2024-21994 Denial of Service Vulnerability in StorageGRID (formerly StorageGRID Webscale) | 2024-11-08 |
| [**NTAP-20241108-0008**](https://security.netapp.com/advisory/ntap-20241108-0008/) | CVE-2024-26641 Linux Kernel Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241108-0010**](https://security.netapp.com/advisory/ntap-20241108-0010/) | CVE-2024-36138 Node.js Vulnerability in NetApp Products | 2024-11-08 |
| [**NTAP-20241108-0007**](https://security.netapp.com/advisory/ntap-20241108-0007/) | CVE-2024-37370 MIT Kerberos 5 Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20241108-0009**](https://security.netapp.com/advisory/ntap-20241108-0009/) | CVE-2024-37371 MIT Kerberos 5 Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20241108-0006**](https://security.netapp.com/advisory/ntap-20241108-0006/) | CVE-2024-8612 QEMU Vulnerability in NetApp Products | 2024-11-08 |
| [**NTAP-20241108-0003**](https://security.netapp.com/advisory/ntap-20241108-0003/) | Intel SA-00999 CSME Vulnerabilities in NetApp Products | 2024-11-08 |
| [**NTAP-20241108-0002**](https://security.netapp.com/advisory/ntap-20241108-0002/) | June 2024 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2024-11-08 |
| [**NTAP-20241101-0004**](https://security.netapp.com/advisory/ntap-20241101-0004/) | CVE-2023-49582 Apache Portable Runtime (APR) Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20241101-0007**](https://security.netapp.com/advisory/ntap-20241101-0007/) | CVE-2024-21200 MySQL Server Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20241101-0009**](https://security.netapp.com/advisory/ntap-20241101-0009/) | CVE-2024-21204 MySQL Server Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20241101-0005**](https://security.netapp.com/advisory/ntap-20241101-0005/) | CVE-2024-21209 MySQL Client Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20241101-0006**](https://security.netapp.com/advisory/ntap-20241101-0006/) | CVE-2024-21247 MySQL Client Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20241101-0002**](https://security.netapp.com/advisory/ntap-20241101-0002/) | CVE-2024-23454 Apache Hadoop Vulnerability in NetApp Products | 2024-11-01 |
| [**NTAP-20241101-0013**](https://security.netapp.com/advisory/ntap-20241101-0013/) | CVE-2024-26733 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20241101-0012**](https://security.netapp.com/advisory/ntap-20241101-0012/) | CVE-2024-26735 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20241101-0010**](https://security.netapp.com/advisory/ntap-20241101-0010/) | CVE-2024-38286 Apache Tomcat Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241101-0001**](https://security.netapp.com/advisory/ntap-20241101-0001/) | CVE-2024-9143 OpenSSL Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20241101-0011**](https://security.netapp.com/advisory/ntap-20241101-0011/) | June 2023 Node.js Vulnerabilities in NetApp Products | 2024-11-01 |
| [**NTAP-20241101-0008**](https://security.netapp.com/advisory/ntap-20241101-0008/) | October 2024 MySQL Server 8.4.2 and 9.0.1 Vulnerabilities in NetApp Products | 2024-12-06 |
| [**NTAP-20241101-0003**](https://security.netapp.com/advisory/ntap-20241101-0003/) | October 2024 PHP Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20241025-0004**](https://security.netapp.com/advisory/ntap-20241025-0004/) | CVE-2022-25883 Node.js Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20241025-0003**](https://security.netapp.com/advisory/ntap-20241025-0003/) | CVE-2023-32558 Node.js Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20241025-0002**](https://security.netapp.com/advisory/ntap-20241025-0002/) | CVE-2023-4237 Ansible Vulnerability in NetApp Products | 2024-10-25 |
| [**NTAP-20241025-0001**](https://security.netapp.com/advisory/ntap-20241025-0001/) | CVE-2023-5764 Ansible Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241025-0007**](https://security.netapp.com/advisory/ntap-20241025-0007/) | CVE-2024-21207 MySQL Server Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20241025-0008**](https://security.netapp.com/advisory/ntap-20241025-0008/) | CVE-2024-21212 MySQL Server Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20241025-0009**](https://security.netapp.com/advisory/ntap-20241025-0009/) | CVE-2024-21238 MySQL Server Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20241025-0005**](https://security.netapp.com/advisory/ntap-20241025-0005/) | October 2024 MySQL Connector/ODBC Vulnerabilities in NetApp Products | 2024-10-25 |
| [**NTAP-20241025-0010**](https://security.netapp.com/advisory/ntap-20241025-0010/) | October 2024 MySQL Enterprise Backup Vulnerabilities in NetApp Products | 2024-12-06 |
| [**NTAP-20241025-0006**](https://security.netapp.com/advisory/ntap-20241025-0006/) | October 2024 MySQL Server 8.0.39, 8.4.2, 9.0.1 Vulnerabilities in NetApp Products | 2024-12-06 |
| [**NTAP-20241018-0008**](https://security.netapp.com/advisory/ntap-20241018-0008/) | CVE-2024-21211 Java Platform Standard Edition Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20241018-0001**](https://security.netapp.com/advisory/ntap-20241018-0001/) | CVE-2024-36883 Linux Kernel Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241018-0002**](https://security.netapp.com/advisory/ntap-20241018-0002/) | CVE-2024-36886 Linux Kernel Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241018-0004**](https://security.netapp.com/advisory/ntap-20241018-0004/) | CVE-2024-45490 libexpat Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241018-0003**](https://security.netapp.com/advisory/ntap-20241018-0003/) | CVE-2024-45491 libexpat Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241018-0005**](https://security.netapp.com/advisory/ntap-20241018-0005/) | CVE-2024-45492 libexpat Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241018-0007**](https://security.netapp.com/advisory/ntap-20241018-0007/) | CVE-2024-6232 Python Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241018-0006**](https://security.netapp.com/advisory/ntap-20241018-0006/) | CVE-2024-7592 Python Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241018-0009**](https://security.netapp.com/advisory/ntap-20241018-0009/) | October 2024 Java Platform Standard Edition 8u421 Vulnerabilities in NetApp Products | 2024-10-30 |
| [**NTAP-20241018-0010**](https://security.netapp.com/advisory/ntap-20241018-0010/) | October 2024 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2024-12-04 |
| [**NTAP-20241011-0007**](https://security.netapp.com/advisory/ntap-20241011-0007/) | CVE-2024-27282 Ruby Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241011-0006**](https://security.netapp.com/advisory/ntap-20241011-0006/) | CVE-2024-41909 Apache MINA SSHD Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20241011-0003**](https://security.netapp.com/advisory/ntap-20241011-0003/) | CVE-2024-47561 Apache Avro Vulnerability in NetApp Products | 2024-10-24 |
| [**NTAP-20241011-0002**](https://security.netapp.com/advisory/ntap-20241011-0002/) | CVE-2024-47850 CUPS Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20241011-0004**](https://security.netapp.com/advisory/ntap-20241011-0004/) | CVE-2024-7885 Undertow Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20241011-0010**](https://security.netapp.com/advisory/ntap-20241011-0010/) | CVE-2024-8088 Python Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20241011-0005**](https://security.netapp.com/advisory/ntap-20241011-0005/) | CVE-2024-8096 curl Vulnerability in NetApp Products | 2024-10-24 |
| [**NTAP-20241011-0008**](https://security.netapp.com/advisory/ntap-20241011-0008/) | CVE-2024-8354 QEMU Vulnerability in NetApp Products | 2024-10-24 |
| [**NTAP-20241011-0009**](https://security.netapp.com/advisory/ntap-20241011-0009/) | Intel SA-01071 UEFI Vulnerabilities in NetApp Products | 2024-10-11 |
| [**NTAP-20241011-0001**](https://security.netapp.com/advisory/ntap-20241011-0001/) | September 2024 CUPS Vulnerabilities in NetApp Products | 2024-12-06 |
| [**NTAP-20241004-0005**](https://security.netapp.com/advisory/ntap-20241004-0005/) | August 2024 Node.js Elliptic Vulnerabilities in NetApp Products | 2024-10-07 |
| [**NTAP-20241004-0006**](https://security.netapp.com/advisory/ntap-20241004-0006/) | CVE-2023-39333 Node.js Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20241004-0004**](https://security.netapp.com/advisory/ntap-20241004-0004/) | CVE-2024-24791 Golang Vulnerability in NetApp Products | 2024-10-14 |
| [**NTAP-20241004-0003**](https://security.netapp.com/advisory/ntap-20241004-0003/) | CVE-2024-34158 Golang Vulnerability in NetApp Products | 2024-10-14 |
| [**NTAP-20241004-0002**](https://security.netapp.com/advisory/ntap-20241004-0002/) | CVE-2024-36946 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20241004-0008**](https://security.netapp.com/advisory/ntap-20241004-0008/) | CVE-2024-43802 Vim Vulnerability in NetApp Products | 2024-10-14 |
| [**NTAP-20241004-0007**](https://security.netapp.com/advisory/ntap-20241004-0007/) | CVE-2024-45306 Vim Vulnerability in NetApp Products | 2024-10-14 |
| [**NTAP-20241004-0001**](https://security.netapp.com/advisory/ntap-20241004-0001/) | CVE-2024-6383 MongoDB Vulnerability in NetApp Products | 2024-10-04 |
| [**NTAP-20240926-0007**](https://security.netapp.com/advisory/ntap-20240926-0007/) | CVE-2023-30582 Node.js Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240926-0006**](https://security.netapp.com/advisory/ntap-20240926-0006/) | CVE-2023-30583 Node.js Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240926-0001**](https://security.netapp.com/advisory/ntap-20240926-0001/) | CVE-2024-27399 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240926-0005**](https://security.netapp.com/advisory/ntap-20240926-0005/) | CVE-2024-34155 Golang Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240926-0004**](https://security.netapp.com/advisory/ntap-20240926-0004/) | CVE-2024-34156 Golang Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20240926-0002**](https://security.netapp.com/advisory/ntap-20240926-0002/) | CVE-2024-36902 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240926-0009**](https://security.netapp.com/advisory/ntap-20240926-0009/) | CVE-2024-41721 FreeBSD Vulnerability in NetApp Products | 2024-09-26 |
| [**NTAP-20240926-0010**](https://security.netapp.com/advisory/ntap-20240926-0010/) | CVE-2024-45287 FreeBSD Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20240926-0008**](https://security.netapp.com/advisory/ntap-20240926-0008/) | CVE-2024-45409 Ruby SAML Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240926-0003**](https://security.netapp.com/advisory/ntap-20240926-0003/) | CVE-2024-6923 Python Vulnerability in NetApp Products | 2024-11-29 |
| [**NTAP-20240920-0007**](https://security.netapp.com/advisory/ntap-20240920-0007/) | CVE-2024-32668 FreeBSD Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240920-0002**](https://security.netapp.com/advisory/ntap-20240920-0002/) | CVE-2024-38808 Spring Framework Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20240920-0003**](https://security.netapp.com/advisory/ntap-20240920-0003/) | CVE-2024-38809 Spring Framework Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20240920-0009**](https://security.netapp.com/advisory/ntap-20240920-0009/) | CVE-2024-41928 FreeBSD Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240920-0004**](https://security.netapp.com/advisory/ntap-20240920-0004/) | CVE-2024-43374 Vim Vulnerability in NetApp Products | 2024-10-14 |
| [**NTAP-20240920-0005**](https://security.netapp.com/advisory/ntap-20240920-0005/) | CVE-2024-43790 Vim Vulnerability in NetApp Products | 2024-10-14 |
| [**NTAP-20240920-0008**](https://security.netapp.com/advisory/ntap-20240920-0008/) | CVE-2024-45288 FreeBSD Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20240920-0001**](https://security.netapp.com/advisory/ntap-20240920-0001/) | CVE-2024-7006 LibTIFF Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240920-0006**](https://security.netapp.com/advisory/ntap-20240920-0006/) | CVE-2024-8235 Libvirt Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240920-0010**](https://security.netapp.com/advisory/ntap-20240920-0010/) | September 2024 FreeBSD ctl Vulnerabilities in NetApp Products | 2024-09-20 |
| [**NTAP-20240916-0001**](https://security.netapp.com/advisory/ntap-20240916-0001/) | CVE-2024-43102 FreeBSD Vulnerability in NetApp Products | 2024-09-24 |
| [**NTAP-20240912-0003**](https://security.netapp.com/advisory/ntap-20240912-0003/) | August 2024 IBM DB2 Vulnerabilities in NetApp Products | 2024-09-12 |
| [**NTAP-20240912-0008**](https://security.netapp.com/advisory/ntap-20240912-0008/) | CVE-2022-48655 Linux Kernel Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20240912-0002**](https://security.netapp.com/advisory/ntap-20240912-0002/) | CVE-2023-37920 Certifi Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240912-0009**](https://security.netapp.com/advisory/ntap-20240912-0009/) | CVE-2023-52585 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240912-0010**](https://security.netapp.com/advisory/ntap-20240912-0010/) | CVE-2023-52882 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240912-0011**](https://security.netapp.com/advisory/ntap-20240912-0011/) | CVE-2024-26900 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240912-0012**](https://security.netapp.com/advisory/ntap-20240912-0012/) | CVE-2024-27398 Linux Kernel Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20240912-0006**](https://security.netapp.com/advisory/ntap-20240912-0006/) | CVE-2024-36933 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240912-0007**](https://security.netapp.com/advisory/ntap-20240912-0007/) | CVE-2024-36934 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240912-0001**](https://security.netapp.com/advisory/ntap-20240912-0001/) | CVE-2024-6119 OpenSSL Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240912-0004**](https://security.netapp.com/advisory/ntap-20240912-0004/) | Intel SA-00923 CSME Vulnerabilities in NetApp Products | 2024-09-12 |
| [**NTAP-20240912-0005**](https://security.netapp.com/advisory/ntap-20240912-0005/) | June 2024 IBM DB2 Vulnerabilities in NetApp Products | 2024-09-12 |
| [**NTAP-20240905-0008**](https://security.netapp.com/advisory/ntap-20240905-0008/) | April 2024 Node.js Vulnerabilities in NetApp Products | 2024-11-22 |
| [**NTAP-20240905-0007**](https://security.netapp.com/advisory/ntap-20240905-0007/) | August 2024 Django Vulnerabilities in NetApp Products | 2024-09-05 |
| [**NTAP-20240905-0002**](https://security.netapp.com/advisory/ntap-20240905-0002/) | CVE-2024-24790 Golang Vulnerability in NetApp Products | 2024-09-26 |
| [**NTAP-20240905-0004**](https://security.netapp.com/advisory/ntap-20240905-0004/) | CVE-2024-36904 Linux Kernel Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20240905-0005**](https://security.netapp.com/advisory/ntap-20240905-0005/) | CVE-2024-36905 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240905-0006**](https://security.netapp.com/advisory/ntap-20240905-0006/) | CVE-2024-36916 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240905-0009**](https://security.netapp.com/advisory/ntap-20240905-0009/) | CVE-2024-36919 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240905-0010**](https://security.netapp.com/advisory/ntap-20240905-0010/) | CVE-2024-36929 Linux Kernel Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240905-0001**](https://security.netapp.com/advisory/ntap-20240905-0001/) | CVE-2024-38517 RapidJSON Vulnerability in NetApp Products | 2024-09-30 |
| [**NTAP-20240905-0003**](https://security.netapp.com/advisory/ntap-20240905-0003/) | CVE-2024-39684 RapidJSON Vulnerability in NetApp Products | 2024-09-05 |
| [**NTAP-20240828-0004**](https://security.netapp.com/advisory/ntap-20240828-0004/) | CVE-2023-29267 IBM Db2 Vulnerability in NetApp Products | 2024-08-28 |
| [**NTAP-20240828-0005**](https://security.netapp.com/advisory/ntap-20240828-0005/) | CVE-2023-43491 QEMU Vulnerability in NetApp Products | 2024-08-28 |
| [**NTAP-20240828-0006**](https://security.netapp.com/advisory/ntap-20240828-0006/) | CVE-2023-45744 QEMU Vulnerability in NetApp Products | 2024-08-28 |
| [**NTAP-20240828-0003**](https://security.netapp.com/advisory/ntap-20240828-0003/) | CVE-2023-52433 Linux Kernel Vulnerability in NetApp Products | 2024-11-05 |
| [**NTAP-20240828-0002**](https://security.netapp.com/advisory/ntap-20240828-0002/) | CVE-2024-3653 Undertow Vulnerability in NetApp Products | 2024-09-26 |
| [**NTAP-20240828-0009**](https://security.netapp.com/advisory/ntap-20240828-0009/) | CVE-2024-38372 Node.js Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240828-0010**](https://security.netapp.com/advisory/ntap-20240828-0010/) | CVE-2024-42154 Linux Kernel Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20240828-0007**](https://security.netapp.com/advisory/ntap-20240828-0007/) | CVE-2024-4693 QEMU Vulnerability in NetApp Products | 2024-08-28 |
| [**NTAP-20240828-0001**](https://security.netapp.com/advisory/ntap-20240828-0001/) | CVE-2024-5971 Undertow Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20240828-0008**](https://security.netapp.com/advisory/ntap-20240828-0008/) | CVE-2024-7264 curl Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20240822-0008**](https://security.netapp.com/advisory/ntap-20240822-0008/) | CVE-2023-40146 QEMU Vulnerability in NetApp Products | 2024-08-22 |
| [**NTAP-20240822-0009**](https://security.netapp.com/advisory/ntap-20240822-0009/) | CVE-2024-29953 Brocade Fabric OS Information Disclosure Vulnerability | 2024-08-22 |
| [**NTAP-20240822-0010**](https://security.netapp.com/advisory/ntap-20240822-0010/) | CVE-2024-29954 Brocade Fabric OS Information Disclosure Vulnerability | 2024-08-22 |
| [**NTAP-20240822-0006**](https://security.netapp.com/advisory/ntap-20240822-0006/) | CVE-2024-31870 IBM Db2 Vulnerability in NetApp Products | 2024-08-22 |
| [**NTAP-20240822-0007**](https://security.netapp.com/advisory/ntap-20240822-0007/) | CVE-2024-3567 QEMU Vulnerability in NetApp Products | 2024-08-22 |
| [**NTAP-20240822-0001**](https://security.netapp.com/advisory/ntap-20240822-0001/) | CVE-2024-3596 RADIUS Protocol Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240822-0003**](https://security.netapp.com/advisory/ntap-20240822-0003/) | CVE-2024-37891 urllib3 Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240822-0005**](https://security.netapp.com/advisory/ntap-20240822-0005/) | CVE-2024-4467 QEMU Vulnerability in NetApp Products | 2024-08-22 |
| [**NTAP-20240822-0004**](https://security.netapp.com/advisory/ntap-20240822-0004/) | CVE-2024-6874 curl Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240822-0002**](https://security.netapp.com/advisory/ntap-20240822-0002/) | CVE-2024-7348 PostgreSQL Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20240816-0001**](https://security.netapp.com/advisory/ntap-20240816-0001/) | CVE-2018-19788 PolicyKit Vulnerability in NetApp Products | 2024-09-12 |
| [**NTAP-20240816-0005**](https://security.netapp.com/advisory/ntap-20240816-0005/) | CVE-2023-52340 Linux Kernel Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240816-0007**](https://security.netapp.com/advisory/ntap-20240816-0007/) | CVE-2024-22018 Node.js Vulnerability in NetApp Products | 2024-08-16 |
| [**NTAP-20240816-0004**](https://security.netapp.com/advisory/ntap-20240816-0004/) | CVE-2024-34750 Apache Tomcat Vulnerability in NetApp Products | 2024-11-05 |
| [**NTAP-20240816-0003**](https://security.netapp.com/advisory/ntap-20240816-0003/) | CVE-2024-37280 Elasticsearch Vulnerability in NetApp Products | 2024-08-16 |
| [**NTAP-20240816-0006**](https://security.netapp.com/advisory/ntap-20240816-0006/) | CVE-2024-6505 QEMU Vulnerability in NetApp Products | 2024-08-16 |
| [**NTAP-20240816-0008**](https://security.netapp.com/advisory/ntap-20240816-0008/) | CVE-2024-6640 FreeBSD Vulnerability in NetApp Products | 2024-09-12 |
| [**NTAP-20240816-0009**](https://security.netapp.com/advisory/ntap-20240816-0009/) | CVE-2024-6759 FreeBSD Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20240816-0010**](https://security.netapp.com/advisory/ntap-20240816-0010/) | CVE-2024-6760 FreeBSD Vulnerability in NetApp Products | 2024-10-14 |
| [**NTAP-20240816-0002**](https://security.netapp.com/advisory/ntap-20240816-0002/) | CVE-2024-7589 FreeBSD Vulnerability in NetApp Products | 2024-08-26 |
| [**NTAP-20240812-0001**](https://security.netapp.com/advisory/ntap-20240812-0001/) | CVE-2020-15999 Freetype Vulnerability in NetApp Products | 2024-08-12 |
| [**NTAP-20240808-0003**](https://security.netapp.com/advisory/ntap-20240808-0003/) | CVE-2021-23358 Node.js Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240808-0004**](https://security.netapp.com/advisory/ntap-20240808-0004/) | CVE-2023-39333 Node.js Vulnerability in NetApp Products | 2024-08-08 |
| [**NTAP-20240808-0002**](https://security.netapp.com/advisory/ntap-20240808-0002/) | CVE-2023-46750 Apache Shiro Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240808-0001**](https://security.netapp.com/advisory/ntap-20240808-0001/) | CVE-2024-0684 GNU Coreutils Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240808-0009**](https://security.netapp.com/advisory/ntap-20240808-0009/) | CVE-2024-32007 Apache CXF Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240808-0007**](https://security.netapp.com/advisory/ntap-20240808-0007/) | CVE-2024-40725 Apache HTTP Server Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20240808-0006**](https://security.netapp.com/advisory/ntap-20240808-0006/) | CVE-2024-40898 Apache HTTP Server Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20240808-0008**](https://security.netapp.com/advisory/ntap-20240808-0008/) | CVE-2024-41172 Apache CXF Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240808-0010**](https://security.netapp.com/advisory/ntap-20240808-0010/) | CVE-2024-6716 LibTIFF Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240808-0005**](https://security.netapp.com/advisory/ntap-20240808-0005/) | July 2024 Django Vulnerabilities in NetApp Products | 2024-08-08 |
| [**NTAP-20240802-0001**](https://security.netapp.com/advisory/ntap-20240802-0001/) | CVE-2024-41110 Docker Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240801-0002**](https://security.netapp.com/advisory/ntap-20240801-0002/) | July 2024 MySQL Server 8.0.36 and 8.3.0 Vulnerabilities in NetApp Products | 2024-12-06 |
| [**NTAP-20240801-0001**](https://security.netapp.com/advisory/ntap-20240801-0001/) | July 2024 MySQL Server 8.0.37 and 8.4.0 Vulnerabilities in NetApp Products | 2024-12-06 |
| [**NTAP-20240731-0004**](https://security.netapp.com/advisory/ntap-20240731-0004/) | CVE-2024-0760 ISC BIND Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240731-0003**](https://security.netapp.com/advisory/ntap-20240731-0003/) | CVE-2024-1737 ISC BIND Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240731-0002**](https://security.netapp.com/advisory/ntap-20240731-0002/) | CVE-2024-1975 ISC BIND Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240731-0009**](https://security.netapp.com/advisory/ntap-20240731-0009/) | CVE-2024-21137 MySQL Server Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20240731-0008**](https://security.netapp.com/advisory/ntap-20240731-0008/) | CVE-2024-21157 MySQL Server Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20240731-0007**](https://security.netapp.com/advisory/ntap-20240731-0007/) | CVE-2024-21165 MySQL Server Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20240731-0006**](https://security.netapp.com/advisory/ntap-20240731-0006/) | CVE-2024-21176 MySQL Server Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20240731-0005**](https://security.netapp.com/advisory/ntap-20240731-0005/) | CVE-2024-21185 MySQL Server Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20240731-0001**](https://security.netapp.com/advisory/ntap-20240731-0001/) | CVE-2024-4076 ISC BIND Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240726-0003**](https://security.netapp.com/advisory/ntap-20240726-0003/) | CVE-2018-14335 H2 Database Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240726-0004**](https://security.netapp.com/advisory/ntap-20240726-0004/) | CVE-2024-4032 Python Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240726-0001**](https://security.netapp.com/advisory/ntap-20240726-0001/) | CVE-2024-5458 PHP Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240726-0002**](https://security.netapp.com/advisory/ntap-20240726-0002/) | CVE-2024-5585 PHP Vulnerability in NetApp Products | 2024-08-01 |
| [**NTAP-20240726-0005**](https://security.netapp.com/advisory/ntap-20240726-0005/) | CVE-2024-5642 Python Vulnerability in NetApp Products | 2024-09-30 |
| [**NTAP-20240719-0002**](https://security.netapp.com/advisory/ntap-20240719-0002/) | CVE-2014-9515 Dozer Vulnerability in NetApp Products | 2024-09-12 |
| [**NTAP-20240719-0005**](https://security.netapp.com/advisory/ntap-20240719-0005/) | CVE-2015-0973 Libpng Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240719-0004**](https://security.netapp.com/advisory/ntap-20240719-0004/) | CVE-2016-3751 Libpng Vulnerability in NetApp Products | 2024-09-26 |
| [**NTAP-20240719-0003**](https://security.netapp.com/advisory/ntap-20240719-0003/) | CVE-2018-10054 H2 Database Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240719-0006**](https://security.netapp.com/advisory/ntap-20240719-0006/) | CVE-2019-17626 ReportLab Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240719-0007**](https://security.netapp.com/advisory/ntap-20240719-0007/) | CVE-2024-21144 Java Platform Standard Edition Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20240719-0001**](https://security.netapp.com/advisory/ntap-20240719-0001/) | CVE-2024-37894 Squid Vulnerability in NetApp Products | 2024-08-01 |
| [**NTAP-20240719-0008**](https://security.netapp.com/advisory/ntap-20240719-0008/) | July 2024 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2024-12-06 |
| [**NTAP-20240712-0002**](https://security.netapp.com/advisory/ntap-20240712-0002/) | CVE-2024-39884 Apache HTTP Server Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20240712-0004**](https://security.netapp.com/advisory/ntap-20240712-0004/) | CVE-2024-39894 OpenSSH Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240712-0005**](https://security.netapp.com/advisory/ntap-20240712-0005/) | CVE-2024-5535 OpenSSL Vulnerability in NetApp Products | 2024-11-29 |
| [**NTAP-20240712-0003**](https://security.netapp.com/advisory/ntap-20240712-0003/) | CVE-2024-6409 OpenSSH Vulnerability in NetApp Products | 2025-01-06 |
| [**NTAP-20240712-0001**](https://security.netapp.com/advisory/ntap-20240712-0001/) | July 2024 Apache HTTP Server Vulnerabilities in NetApp Products | 2024-12-20 |
| [**NTAP-20240705-0001**](https://security.netapp.com/advisory/ntap-20240705-0001/) | CVE-2022-1941 Protobuf-cpp & Protobuf-python Vulnerability in NetApp Products | 2024-07-05 |
| [**NTAP-20240705-0006**](https://security.netapp.com/advisory/ntap-20240705-0006/) | CVE-2024-1931 Unbound Vulnerability in NetApp Products | 2024-07-05 |
| [**NTAP-20240705-0007**](https://security.netapp.com/advisory/ntap-20240705-0007/) | CVE-2024-21993 Information Disclosure Vulnerability in SnapCenter | 2024-07-05 |
| [**NTAP-20240705-0002**](https://security.netapp.com/advisory/ntap-20240705-0002/) | CVE-2024-27309 Apache Kafka Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240705-0003**](https://security.netapp.com/advisory/ntap-20240705-0003/) | CVE-2024-32962 Node.js Vulnerability in NetApp Products | 2024-08-01 |
| [**NTAP-20240705-0004**](https://security.netapp.com/advisory/ntap-20240705-0004/) | CVE-2024-37051 JetBrains IDE Vulnerability | 2024-09-20 |
| [**NTAP-20240705-0005**](https://security.netapp.com/advisory/ntap-20240705-0005/) | CVE-2024-4030 Python Vulnerability in NetApp Products | 2024-10-24 |
| [**NTAP-20240701-0001**](https://security.netapp.com/advisory/ntap-20240701-0001/) | CVE-2024-6387 OpenSSH Vulnerability in NetApp Products | 2024-11-14 |
| [**NTAP-20240628-0001**](https://security.netapp.com/advisory/ntap-20240628-0001/) | CVE-2022-1227 Podman Vulnerability in NetApp Products | 2024-06-28 |
| [**NTAP-20240628-0004**](https://security.netapp.com/advisory/ntap-20240628-0004/) | CVE-2023-3454 Brocade Fabric OS Remote Code Execution Vulnerability | 2024-06-28 |
| [**NTAP-20240628-0006**](https://security.netapp.com/advisory/ntap-20240628-0006/) | CVE-2023-36665 Protobuf.js Vulnerability in NetApp Products | 2024-08-07 |
| [**NTAP-20240628-0005**](https://security.netapp.com/advisory/ntap-20240628-0005/) | CVE-2023-5973 Brocade Fabric OS Truncated Port Name Vulnerability | 2024-06-28 |
| [**NTAP-20240628-0002**](https://security.netapp.com/advisory/ntap-20240628-0002/) | CVE-2023-6240 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240628-0003**](https://security.netapp.com/advisory/ntap-20240628-0003/) | CVE-2024-2859 Brocade SANnav Root User Login Enabled Vulnerability | 2024-06-28 |
| [**NTAP-20240621-0002**](https://security.netapp.com/advisory/ntap-20240621-0002/) | CVE-2022-3080 ISC BIND Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240621-0008**](https://security.netapp.com/advisory/ntap-20240621-0008/) | CVE-2024-4577 PHP Vulnerability in NetApp Products | 2024-07-01 |
| [**NTAP-20240621-0001**](https://security.netapp.com/advisory/ntap-20240621-0001/) | CVE-2024-4603 OpenSSL Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20240621-0004**](https://security.netapp.com/advisory/ntap-20240621-0004/) | CVE-2024-4741 OpenSSL Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240621-0006**](https://security.netapp.com/advisory/ntap-20240621-0006/) | February 2024 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2024-09-20 |
| [**NTAP-20240621-0003**](https://security.netapp.com/advisory/ntap-20240621-0003/) | Intel SA-01036 Intel Trust Domain Extensions (TDX) Vulnerabilities in NetApp Products | 2024-07-26 |
| [**NTAP-20240621-0007**](https://security.netapp.com/advisory/ntap-20240621-0007/) | May 2024 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2024-09-20 |
| [**NTAP-20240621-0005**](https://security.netapp.com/advisory/ntap-20240621-0005/) | September 2023 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2024-09-20 |
| [**NTAP-20240614-0006**](https://security.netapp.com/advisory/ntap-20240614-0006/) | CVE-2022-4967 strongSwan Vulnerability in NetApp Products | 2024-07-02 |
| [**NTAP-20240614-0003**](https://security.netapp.com/advisory/ntap-20240614-0003/) | CVE-2023-52425 libexpat Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240614-0009**](https://security.netapp.com/advisory/ntap-20240614-0009/) | CVE-2024-1086 Linux Kernel Vulnerability in NetApp Products | 2024-10-24 |
| [**NTAP-20240614-0010**](https://security.netapp.com/advisory/ntap-20240614-0010/) | CVE-2024-21988 SSH Cryptographic Implementation Vulnerability in StorageGRID (formerly StorageGRID Webscale) | 2024-06-14 |
| [**NTAP-20240614-0005**](https://security.netapp.com/advisory/ntap-20240614-0005/) | CVE-2024-22233 Spring Framework Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240614-0002**](https://security.netapp.com/advisory/ntap-20240614-0002/) | CVE-2024-2877 HashiCorp Vault Vulnerability in NetApp Products | 2024-06-14 |
| [**NTAP-20240614-0008**](https://security.netapp.com/advisory/ntap-20240614-0008/) | CVE-2024-30171 Bouncy Castle Vulnerability in NetApp Products | 2024-08-21 |
| [**NTAP-20240614-0004**](https://security.netapp.com/advisory/ntap-20240614-0004/) | CVE-2024-34069 Werkzeug Vulnerability in NetApp Products | 2024-08-14 |
| [**NTAP-20240614-0007**](https://security.netapp.com/advisory/ntap-20240614-0007/) | May 2024 Bouncy Castle Vulnerabilities in NetApp Products | 2024-12-13 |
| [**NTAP-20240605-0010**](https://security.netapp.com/advisory/ntap-20240605-0010/) | CVE-2022-48624 less Vulnerability in NetApp Products | 2024-09-26 |
| [**NTAP-20240605-0006**](https://security.netapp.com/advisory/ntap-20240605-0006/) | CVE-2023-20569 Debian Vulnerability in NetApp Products | 2024-08-01 |
| [**NTAP-20240605-0007**](https://security.netapp.com/advisory/ntap-20240605-0007/) | CVE-2023-23913 Ruby on Rails Vulnerability in NetApp Products | 2024-06-05 |
| [**NTAP-20240605-0005**](https://security.netapp.com/advisory/ntap-20240605-0005/) | CVE-2023-31130 c-ares Vulnerability in NetApp Products | 2024-09-12 |
| [**NTAP-20240605-0004**](https://security.netapp.com/advisory/ntap-20240605-0004/) | CVE-2023-32067 c-ares Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240605-0002**](https://security.netapp.com/advisory/ntap-20240605-0002/) | CVE-2024-24788 Golang Vulnerability in NetApp Products | 2024-07-19 |
| [**NTAP-20240605-0008**](https://security.netapp.com/advisory/ntap-20240605-0008/) | CVE-2024-24806 libuv Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20240605-0001**](https://security.netapp.com/advisory/ntap-20240605-0001/) | CVE-2024-25111 Squid Vulnerability in NetApp Products | 2024-12-06 |
| [**NTAP-20240605-0009**](https://security.netapp.com/advisory/ntap-20240605-0009/) | CVE-2024-32487 less Vulnerability in NetApp Products | 2024-09-26 |
| [**NTAP-20240605-0003**](https://security.netapp.com/advisory/ntap-20240605-0003/) | CVE-2024-33883 Node.js Vulnerability in NetApp Products | 2024-08-01 |
| [**NTAP-20240531-0005**](https://security.netapp.com/advisory/ntap-20240531-0005/) | CVE-2023-20588 Debian Vulnerability in NetApp Products | 2024-05-31 |
| [**NTAP-20240531-0004**](https://security.netapp.com/advisory/ntap-20240531-0004/) | CVE-2023-20593 Debian Vulnerability in NetApp Products | 2024-05-31 |
| [**NTAP-20240531-0007**](https://security.netapp.com/advisory/ntap-20240531-0007/) | CVE-2023-6237 OpenSSL Vulnerability in NetApp Products | 2024-11-29 |
| [**NTAP-20240531-0001**](https://security.netapp.com/advisory/ntap-20240531-0001/) | CVE-2024-2379 curl Vulnerability in NetApp Products | 2024-10-24 |
| [**NTAP-20240531-0006**](https://security.netapp.com/advisory/ntap-20240531-0006/) | CVE-2024-24787 Golang Vulnerability in NetApp Products | 2024-06-21 |
| [**NTAP-20240531-0003**](https://security.netapp.com/advisory/ntap-20240531-0003/) | CVE-2024-28085 Util-linux Vulnerability in NetApp Products | 2024-06-21 |
| [**NTAP-20240531-0002**](https://security.netapp.com/advisory/ntap-20240531-0002/) | CVE-2024-2961 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-11-05 |
| [**NTAP-20240531-0008**](https://security.netapp.com/advisory/ntap-20240531-0008/) | CVE-2024-34397 Gnome Glib Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240524-0015**](https://security.netapp.com/advisory/ntap-20240524-0015/) | CVE-2023-20863 Spring Security Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240524-0008**](https://security.netapp.com/advisory/ntap-20240524-0008/) | CVE-2024-1313 Grafana Vulnerability in NetApp Products | 2024-05-24 |
| [**NTAP-20240524-0010**](https://security.netapp.com/advisory/ntap-20240524-0010/) | CVE-2024-1351 MongoDB Vulnerability in NetApp Products | 2024-06-18 |
| [**NTAP-20240524-0006**](https://security.netapp.com/advisory/ntap-20240524-0006/) | CVE-2024-2004 curl Vulnerability in NetApp Products | 2024-10-24 |
| [**NTAP-20240524-0009**](https://security.netapp.com/advisory/ntap-20240524-0009/) | CVE-2024-2048 HashiCorp Vault Vulnerability in NetApp Products | 2024-05-24 |
| [**NTAP-20240524-0001**](https://security.netapp.com/advisory/ntap-20240524-0001/) | CVE-2024-22243 Spring Framework Vulnerability in NetApp Products | 2024-08-23 |
| [**NTAP-20240524-0002**](https://security.netapp.com/advisory/ntap-20240524-0002/) | CVE-2024-22259 Spring Framework Vulnerability in NetApp Products | 2024-08-23 |
| [**NTAP-20240524-0003**](https://security.netapp.com/advisory/ntap-20240524-0003/) | CVE-2024-22262 Spring Framework Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240524-0007**](https://security.netapp.com/advisory/ntap-20240524-0007/) | CVE-2024-2660 HashiCorp Vault Vulnerability in NetApp Products | 2024-05-24 |
| [**NTAP-20240524-0004**](https://security.netapp.com/advisory/ntap-20240524-0004/) | CVE-2024-28834 GNU TLS Vulnerability in NetApp Products | 2024-09-30 |
| [**NTAP-20240524-0005**](https://security.netapp.com/advisory/ntap-20240524-0005/) | CVE-2024-28863 Node.js Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240524-0011**](https://security.netapp.com/advisory/ntap-20240524-0011/) | CVE-2024-33599 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240524-0013**](https://security.netapp.com/advisory/ntap-20240524-0013/) | CVE-2024-33600 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-10-24 |
| [**NTAP-20240524-0014**](https://security.netapp.com/advisory/ntap-20240524-0014/) | CVE-2024-33601 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-10-24 |
| [**NTAP-20240524-0012**](https://security.netapp.com/advisory/ntap-20240524-0012/) | CVE-2024-33602 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-10-24 |
| [**NTAP-20240517-0004**](https://security.netapp.com/advisory/ntap-20240517-0004/) | April 2024 IBM DB2 10.5, 11.1, and 11.5 Vulnerabilities in NetApp Products | 2024-05-17 |
| [**NTAP-20240517-0003**](https://security.netapp.com/advisory/ntap-20240517-0003/) | April 2024 IBM DB2 11.5 Vulnerabilities in NetApp Products | 2024-05-17 |
| [**NTAP-20240517-0007**](https://security.netapp.com/advisory/ntap-20240517-0007/) | CVE-2024-22017 Node.js Vulnerability in NetApp Products | 2024-08-23 |
| [**NTAP-20240517-0008**](https://security.netapp.com/advisory/ntap-20240517-0008/) | CVE-2024-22025 Node.js Vulnerability in NetApp Products | 2024-08-23 |
| [**NTAP-20240517-0010**](https://security.netapp.com/advisory/ntap-20240517-0010/) | CVE-2024-23450 Elasticsearch Vulnerability in NetApp Products | 2024-08-01 |
| [**NTAP-20240517-0002**](https://security.netapp.com/advisory/ntap-20240517-0002/) | CVE-2024-24786 Golang Vulnerability in NetApp Products | 2024-05-17 |
| [**NTAP-20240517-0009**](https://security.netapp.com/advisory/ntap-20240517-0009/) | CVE-2024-2494 Libvirt Vulnerability in NetApp Products | 2024-05-17 |
| [**NTAP-20240517-0006**](https://security.netapp.com/advisory/ntap-20240517-0006/) | CVE-2024-25030 IBM Db2 Vulnerability in NetApp Products | 2024-05-17 |
| [**NTAP-20240517-0005**](https://security.netapp.com/advisory/ntap-20240517-0005/) | CVE-2024-25046 IBM Db2 Vulnerability in NetApp Products | 2024-05-17 |
| [**NTAP-20240517-0001**](https://security.netapp.com/advisory/ntap-20240517-0001/) | CVE-2024-28752 Apache CXF Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20240510-0001**](https://security.netapp.com/advisory/ntap-20240510-0001/) | CVE-2023-29483 Dnspython Vulnerability in NetApp Products | 2024-05-17 |
| [**NTAP-20240510-0009**](https://security.netapp.com/advisory/ntap-20240510-0009/) | CVE-2024-1874 PHP Vulnerability in NetApp Products | 2024-05-15 |
| [**NTAP-20240510-0012**](https://security.netapp.com/advisory/ntap-20240510-0012/) | CVE-2024-24474 QEMU Vulnerability in NetApp Products | 2024-05-10 |
| [**NTAP-20240510-0005**](https://security.netapp.com/advisory/ntap-20240510-0005/) | CVE-2024-25126 Rack Vulnerability in NetApp Products | 2024-05-10 |
| [**NTAP-20240510-0003**](https://security.netapp.com/advisory/ntap-20240510-0003/) | CVE-2024-25941 FreeBSD Vulnerability in NetApp Products | 2024-05-10 |
| [**NTAP-20240510-0007**](https://security.netapp.com/advisory/ntap-20240510-0007/) | CVE-2024-26141 Rack Vulnerability in NetApp Products | 2024-05-10 |
| [**NTAP-20240510-0004**](https://security.netapp.com/advisory/ntap-20240510-0004/) | CVE-2024-26143 Ruby on Rails Vulnerability in NetApp Products | 2024-05-10 |
| [**NTAP-20240510-0013**](https://security.netapp.com/advisory/ntap-20240510-0013/) | CVE-2024-26144 Ruby on Rails Vulnerability in NetApp Products | 2024-05-10 |
| [**NTAP-20240510-0006**](https://security.netapp.com/advisory/ntap-20240510-0006/) | CVE-2024-26146 Rack Vulnerability in NetApp Products | 2024-05-10 |
| [**NTAP-20240510-0008**](https://security.netapp.com/advisory/ntap-20240510-0008/) | CVE-2024-2756 PHP Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240510-0011**](https://security.netapp.com/advisory/ntap-20240510-0011/) | CVE-2024-2757 PHP Vulnerability in NetApp Products | 2024-05-10 |
| [**NTAP-20240510-0002**](https://security.netapp.com/advisory/ntap-20240510-0002/) | CVE-2024-27983 Node.js Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240510-0010**](https://security.netapp.com/advisory/ntap-20240510-0010/) | CVE-2024-3096 PHP Vulnerability in NetApp Products | 2024-05-15 |
| [**NTAP-20240503-0001**](https://security.netapp.com/advisory/ntap-20240503-0001/) | CVE-2023-3010 Grafana Vulnerability in NetApp Products | 2024-05-03 |
| [**NTAP-20240503-0002**](https://security.netapp.com/advisory/ntap-20240503-0002/) | CVE-2023-5122 Grafana Vulnerability in NetApp Products | 2024-05-03 |
| [**NTAP-20240503-0007**](https://security.netapp.com/advisory/ntap-20240503-0007/) | CVE-2023-5123 Grafana Vulnerability in NetApp Products | 2024-05-03 |
| [**NTAP-20240503-0006**](https://security.netapp.com/advisory/ntap-20240503-0006/) | CVE-2023-5517 ISC BIND Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240503-0005**](https://security.netapp.com/advisory/ntap-20240503-0005/) | CVE-2023-5680 ISC BIND Vulnerability in NetApp Products | 2024-07-19 |
| [**NTAP-20240503-0011**](https://security.netapp.com/advisory/ntap-20240503-0011/) | CVE-2023-6129 MySQL Enterprise Backup Vulnerability in NetApp Products | 2024-05-08 |
| [**NTAP-20240503-0008**](https://security.netapp.com/advisory/ntap-20240503-0008/) | CVE-2023-6516 ISC BIND Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240503-0012**](https://security.netapp.com/advisory/ntap-20240503-0012/) | CVE-2024-0853 MySQL Enterprise Backup Vulnerability in NetApp Products | 2024-05-08 |
| [**NTAP-20240503-0004**](https://security.netapp.com/advisory/ntap-20240503-0004/) | CVE-2024-21885 X.Org X Vulnerability in NetApp Products | 2024-06-10 |
| [**NTAP-20240503-0009**](https://security.netapp.com/advisory/ntap-20240503-0009/) | CVE-2024-2398 curl Vulnerability in NetApp Products | 2024-11-05 |
| [**NTAP-20240503-0010**](https://security.netapp.com/advisory/ntap-20240503-0010/) | CVE-2024-2466 curl Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240503-0013**](https://security.netapp.com/advisory/ntap-20240503-0013/) | CVE-2024-2511 OpenSSL Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240503-0003**](https://security.netapp.com/advisory/ntap-20240503-0003/) | CVE-2024-26142 Ruby on Rails Vulnerability in NetApp Products | 2024-05-03 |
| [**NTAP-20240426-0004**](https://security.netapp.com/advisory/ntap-20240426-0004/) | April 2024 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20240426-0015**](https://security.netapp.com/advisory/ntap-20240426-0015/) | April 2024 MySQL Cluster Vulnerabilities in NetApp Products | 2024-09-12 |
| [**NTAP-20240426-0012**](https://security.netapp.com/advisory/ntap-20240426-0012/) | April 2024 MySQL Server 8.0.34 Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20240426-0014**](https://security.netapp.com/advisory/ntap-20240426-0014/) | April 2024 MySQL Server 8.0.35 and 8.2.0 Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20240426-0011**](https://security.netapp.com/advisory/ntap-20240426-0011/) | April 2024 MySQL Server 8.0.35 Vulnerabilities in NetApp Products | 2024-12-06 |
| [**NTAP-20240426-0013**](https://security.netapp.com/advisory/ntap-20240426-0013/) | April 2024 MySQL Server 8.0.36 and 8.3.0 Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20240426-0005**](https://security.netapp.com/advisory/ntap-20240426-0005/) | CVE-2023-32643 Gnome Glib Vulnerability in NetApp Products | 2024-11-05 |
| [**NTAP-20240426-0006**](https://security.netapp.com/advisory/ntap-20240426-0006/) | CVE-2023-32665 Gnome Glib Vulnerability in NetApp Products | 2024-09-05 |
| [**NTAP-20240426-0001**](https://security.netapp.com/advisory/ntap-20240426-0001/) | CVE-2023-4408 ISC BIND Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240426-0007**](https://security.netapp.com/advisory/ntap-20240426-0007/) | CVE-2023-44487 MySQL Cluster Vulnerability in NetApp Products | 2024-08-07 |
| [**NTAP-20240426-0002**](https://security.netapp.com/advisory/ntap-20240426-0002/) | CVE-2023-5679 ISC BIND Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240426-0008**](https://security.netapp.com/advisory/ntap-20240426-0008/) | CVE-2023-6129 MySQL Connector/ODBC Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240426-0009**](https://security.netapp.com/advisory/ntap-20240426-0009/) | CVE-2024-0853 MySQL Cluster Vulnerability in NetApp Products | 2024-09-12 |
| [**NTAP-20240426-0010**](https://security.netapp.com/advisory/ntap-20240426-0010/) | CVE-2024-21015 MySQL Server Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20240426-0003**](https://security.netapp.com/advisory/ntap-20240426-0003/) | CVE-2024-2312 Grub2 Vulnerability in NetApp Products | 2024-05-24 |
| [**NTAP-20240419-0003**](https://security.netapp.com/advisory/ntap-20240419-0003/) | CVE-2022-23084 FreeBSD Vulnerability in NetApp Products | 2024-04-19 |
| [**NTAP-20240419-0002**](https://security.netapp.com/advisory/ntap-20240419-0002/) | CVE-2022-23086 FreeBSD Vulnerability in NetApp Products | 2024-04-19 |
| [**NTAP-20240419-0009**](https://security.netapp.com/advisory/ntap-20240419-0009/) | CVE-2023-45288 Golang Vulnerability in NetApp Products | 2024-08-07 |
| [**NTAP-20240419-0001**](https://security.netapp.com/advisory/ntap-20240419-0001/) | CVE-2023-51780 Linux Kernel Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20240419-0008**](https://security.netapp.com/advisory/ntap-20240419-0008/) | CVE-2024-1597 PostgreSQL Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240419-0005**](https://security.netapp.com/advisory/ntap-20240419-0005/) | CVE-2024-22257 Spring Security Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240419-0006**](https://security.netapp.com/advisory/ntap-20240419-0006/) | CVE-2024-24750 Node.js Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240419-0007**](https://security.netapp.com/advisory/ntap-20240419-0007/) | CVE-2024-24758 Node.js Vulnerability in NetApp Products | 2024-08-23 |
| [**NTAP-20240419-0004**](https://security.netapp.com/advisory/ntap-20240419-0004/) | CVE-2024-25940 FreeBSD Vulnerability in NetApp Products | 2024-04-19 |
| [**NTAP-20240419-0010**](https://security.netapp.com/advisory/ntap-20240419-0010/) | February 2024 QEMU Vulnerabilities in NetApp Products | 2024-04-19 |
| [**NTAP-20240415-0013**](https://security.netapp.com/advisory/ntap-20240415-0013/) | April 2024 Apache HTTP Server Vulnerabilities in NetApp Products | 2024-12-13 |
| [**NTAP-20240415-0005**](https://security.netapp.com/advisory/ntap-20240415-0005/) | CVE-2022-23087 FreeBSD Vulnerability in NetApp Products | 2024-04-15 |
| [**NTAP-20240415-0006**](https://security.netapp.com/advisory/ntap-20240415-0006/) | CVE-2022-23089 FreeBSD Vulnerability in NetApp Products | 2024-04-15 |
| [**NTAP-20240415-0007**](https://security.netapp.com/advisory/ntap-20240415-0007/) | CVE-2022-23090 FreeBSD Vulnerability in NetApp Products | 2024-04-15 |
| [**NTAP-20240415-0008**](https://security.netapp.com/advisory/ntap-20240415-0008/) | CVE-2022-23091 FreeBSD Vulnerability in NetApp Products | 2024-04-15 |
| [**NTAP-20240415-0009**](https://security.netapp.com/advisory/ntap-20240415-0009/) | CVE-2022-23092 FreeBSD Vulnerability in NetApp Products | 2024-04-15 |
| [**NTAP-20240415-0004**](https://security.netapp.com/advisory/ntap-20240415-0004/) | CVE-2022-4289 GitLab Vulnerability in NetApp Products | 2024-04-15 |
| [**NTAP-20240415-0002**](https://security.netapp.com/advisory/ntap-20240415-0002/) | CVE-2023-6356 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240415-0003**](https://security.netapp.com/advisory/ntap-20240415-0003/) | CVE-2023-6535 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240415-0001**](https://security.netapp.com/advisory/ntap-20240415-0001/) | CVE-2023-6536 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240415-0010**](https://security.netapp.com/advisory/ntap-20240415-0010/) | CVE-2024-26458 MIT Kerberos 5 Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240415-0011**](https://security.netapp.com/advisory/ntap-20240415-0011/) | CVE-2024-26461 MIT Kerberos 5 Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240415-0012**](https://security.netapp.com/advisory/ntap-20240415-0012/) | CVE-2024-26462 MIT Kerberos 5 Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240411-0001**](https://security.netapp.com/advisory/ntap-20240411-0001/) | CVE-2024-21989 Privilege Escalation Vulnerability in ONTAP Select Deploy administration utility | 2024-04-11 |
| [**NTAP-20240411-0002**](https://security.netapp.com/advisory/ntap-20240411-0002/) | CVE-2024-21990 Default Privileged Account Credentials Vulnerability in ONTAP Select Deploy administration utility | 2024-04-11 |
| [**NTAP-20240405-0001**](https://security.netapp.com/advisory/ntap-20240405-0001/) | CVE-2022-34357 IBM Cognos Analytics Mobile Server Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240405-0006**](https://security.netapp.com/advisory/ntap-20240405-0006/) | CVE-2023-22655 Intel Xeon Processors Vulnerability in NetApp Products | 2024-04-11 |
| [**NTAP-20240405-0004**](https://security.netapp.com/advisory/ntap-20240405-0004/) | CVE-2023-30996 IBM Cognos Analytics Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240405-0002**](https://security.netapp.com/advisory/ntap-20240405-0002/) | CVE-2023-32344 IBM Cognos Analytics Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240405-0010**](https://security.netapp.com/advisory/ntap-20240405-0010/) | CVE-2023-32666 Intel Xeon Processors Vulnerability in NetApp Products | 2024-04-11 |
| [**NTAP-20240405-0005**](https://security.netapp.com/advisory/ntap-20240405-0005/) | CVE-2023-35191 Intel SPS Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20240405-0003**](https://security.netapp.com/advisory/ntap-20240405-0003/) | CVE-2023-38359 IBM Cognos Analytics Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240405-0008**](https://security.netapp.com/advisory/ntap-20240405-0008/) | CVE-2023-38575 Intel Processors Vulnerability in NetApp Products | 2024-04-11 |
| [**NTAP-20240405-0007**](https://security.netapp.com/advisory/ntap-20240405-0007/) | CVE-2023-39368 Intel Processors Vulnerability in NetApp Products | 2024-04-11 |
| [**NTAP-20240405-0009**](https://security.netapp.com/advisory/ntap-20240405-0009/) | CVE-2023-43490 Intel Xeon D Processors Vulnerability in NetApp Products | 2024-04-15 |
| [**NTAP-20240402-0001**](https://security.netapp.com/advisory/ntap-20240402-0001/) | CVE-2024-3094 XZ Utils Vulnerability in NetApp Products | 2024-06-03 |
| [**NTAP-20240402-0002**](https://security.netapp.com/advisory/ntap-20240402-0002/) | March 2024 Apache Tomcat Vulnerabilities in NetApp Products | 2024-12-13 |
| [**NTAP-20240329-0003**](https://security.netapp.com/advisory/ntap-20240329-0003/) | CVE-2022-41946 PostgreSQL Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240329-0006**](https://security.netapp.com/advisory/ntap-20240329-0006/) | CVE-2023-45289 Golang Vulnerability in NetApp Products | 2024-07-11 |
| [**NTAP-20240329-0004**](https://security.netapp.com/advisory/ntap-20240329-0004/) | CVE-2023-45290 Golang Vulnerability in NetApp Products | 2024-04-15 |
| [**NTAP-20240329-0002**](https://security.netapp.com/advisory/ntap-20240329-0002/) | CVE-2024-21896 Node.js Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240329-0001**](https://security.netapp.com/advisory/ntap-20240329-0001/) | CVE-2024-22201 Eclipse Jetty Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240329-0005**](https://security.netapp.com/advisory/ntap-20240329-0005/) | CVE-2024-24783 Golang Vulnerability in NetApp Products | 2024-08-08 |
| [**NTAP-20240329-0007**](https://security.netapp.com/advisory/ntap-20240329-0007/) | CVE-2024-24784 Golang Vulnerability in NetApp Products | 2024-04-15 |
| [**NTAP-20240329-0008**](https://security.netapp.com/advisory/ntap-20240329-0008/) | CVE-2024-24785 Golang Vulnerability in NetApp Products | 2024-05-08 |
| [**NTAP-20240322-0004**](https://security.netapp.com/advisory/ntap-20240322-0004/) | CVE-2022-23085 FreeBSD Vulnerability in NetApp Products | 2024-04-05 |
| [**NTAP-20240322-0005**](https://security.netapp.com/advisory/ntap-20240322-0005/) | CVE-2023-29153 Intel SPS Vulnerability in NetApp Products | 2024-09-05 |
| [**NTAP-20240322-0008**](https://security.netapp.com/advisory/ntap-20240322-0008/) | CVE-2023-43051 IBM Cognos Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240322-0002**](https://security.netapp.com/advisory/ntap-20240322-0002/) | CVE-2023-6660 FreeBSD Vulnerability in NetApp Products | 2024-04-05 |
| [**NTAP-20240322-0007**](https://security.netapp.com/advisory/ntap-20240322-0007/) | CVE-2024-1635 Undertow Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20240322-0003**](https://security.netapp.com/advisory/ntap-20240322-0003/) | CVE-2024-21892 Node.js Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240322-0006**](https://security.netapp.com/advisory/ntap-20240322-0006/) | CVE-2024-25617 Squid Vulnerability in NetApp Products | 2024-04-15 |
| [**NTAP-20240322-0001**](https://security.netapp.com/advisory/ntap-20240322-0001/) | CVE-2024-28757 libexpat Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240315-0001**](https://security.netapp.com/advisory/ntap-20240315-0001/) | CVE-2022-25147 Apache Portable Runtime (APR) Vulnerability in NetApp Products | 2024-05-15 |
| [**NTAP-20240315-0008**](https://security.netapp.com/advisory/ntap-20240315-0008/) | CVE-2023-42282 NPM Vulnerability in NetApp Products | 2024-05-08 |
| [**NTAP-20240315-0006**](https://security.netapp.com/advisory/ntap-20240315-0006/) | CVE-2023-45918 GNU Ncurses Vulnerability in NetApp Products | 2024-10-03 |
| [**NTAP-20240315-0007**](https://security.netapp.com/advisory/ntap-20240315-0007/) | CVE-2024-0232 SQLite Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240315-0002**](https://security.netapp.com/advisory/ntap-20240315-0002/) | CVE-2024-21890 Node.js Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240315-0005**](https://security.netapp.com/advisory/ntap-20240315-0005/) | CVE-2024-21891 Node.js Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240315-0004**](https://security.netapp.com/advisory/ntap-20240315-0004/) | CVE-2024-22019 Node.js Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240315-0003**](https://security.netapp.com/advisory/ntap-20240315-0003/) | CVE-2024-22234 Spring Security Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240315-0010**](https://security.netapp.com/advisory/ntap-20240315-0010/) | SnakeYAML 1.31 Vulnerabilities in NetApp Products | 2024-06-03 |
| [**NTAP-20240315-0009**](https://security.netapp.com/advisory/ntap-20240315-0009/) | SnakeYAML 1.32 Vulnerabilities in NetApp Products | 2024-06-03 |
| [**NTAP-20240307-0013**](https://security.netapp.com/advisory/ntap-20240307-0013/) | CVE-2022-4886 Ingress nginx Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20240307-0007**](https://security.netapp.com/advisory/ntap-20240307-0007/) | CVE-2023-50387 ISC BIND Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240307-0008**](https://security.netapp.com/advisory/ntap-20240307-0008/) | CVE-2023-50868 ISC BIND Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20240307-0005**](https://security.netapp.com/advisory/ntap-20240307-0005/) | CVE-2023-52426 libexpat Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240307-0004**](https://security.netapp.com/advisory/ntap-20240307-0004/) | CVE-2024-0853 curl Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20240307-0010**](https://security.netapp.com/advisory/ntap-20240307-0010/) | CVE-2024-25710 Apache Commons Compress Vulnerability in NetApp Products | 2024-07-11 |
| [**NTAP-20240307-0009**](https://security.netapp.com/advisory/ntap-20240307-0009/) | CVE-2024-26308 Apache Commons Compress Vulnerability in NetApp Products | 2024-07-11 |
| [**NTAP-20240307-0002**](https://security.netapp.com/advisory/ntap-20240307-0002/) | January 2024 IBM DB2 10.1, 10.5, 11.1 Vulnerabilities in NetApp Products | 2024-03-07 |
| [**NTAP-20240307-0003**](https://security.netapp.com/advisory/ntap-20240307-0003/) | January 2024 IBM DB2 10.5, 11.1, 11.5 Vulnerabilities in NetApp Products | 2024-03-07 |
| [**NTAP-20240307-0001**](https://security.netapp.com/advisory/ntap-20240307-0001/) | January 2024 IBM DB2 11.5 Vulnerabilities in NetApp Products | 2024-03-07 |
| [**NTAP-20240307-0011**](https://security.netapp.com/advisory/ntap-20240307-0011/) | January 2024 Tianocore EDK2 Vulnerabilities in NetApp Products | 2024-03-07 |
| [**NTAP-20240307-0006**](https://security.netapp.com/advisory/ntap-20240307-0006/) | January 2024 X.Org X Server 21.1.11 Vulnerabilities in NetApp Products | 2024-05-08 |
| [**NTAP-20240307-0012**](https://security.netapp.com/advisory/ntap-20240307-0012/) | October 2023 Ingress nginx Vulnerabilities in NetApp Products | 2024-03-07 |
| [**NTAP-20240229-0005**](https://security.netapp.com/advisory/ntap-20240229-0005/) | CVE-2022-43937 Brocade SANnav Information Disclosure Vulnerability | 2024-02-29 |
| [**NTAP-20240229-0002**](https://security.netapp.com/advisory/ntap-20240229-0002/) | CVE-2023-2861 QEMU Vulnerability in NetApp Products | 2024-02-29 |
| [**NTAP-20240229-0003**](https://security.netapp.com/advisory/ntap-20240229-0003/) | CVE-2023-31423 Brocade SANnav Information Disclosure Vulnerability | 2024-02-29 |
| [**NTAP-20240229-0004**](https://security.netapp.com/advisory/ntap-20240229-0004/) | CVE-2023-31424 Brocade SANnav Authentication Bypass Vulnerability | 2024-02-29 |
| [**NTAP-20240229-0001**](https://security.netapp.com/advisory/ntap-20240229-0001/) | CVE-2023-46672 Logstash Vulnerability in NetApp Products | 2024-02-29 |
| [**NTAP-20240223-0003**](https://security.netapp.com/advisory/ntap-20240223-0003/) | CVE-2023-41056 Redis Vulnerability in NetApp Products | 2024-05-20 |
| [**NTAP-20240223-0004**](https://security.netapp.com/advisory/ntap-20240223-0004/) | CVE-2023-6004 libssh Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20240223-0001**](https://security.netapp.com/advisory/ntap-20240223-0001/) | CVE-2023-6683 QEMU Vulnerability in NetApp Products | 2024-02-23 |
| [**NTAP-20240223-0006**](https://security.netapp.com/advisory/ntap-20240223-0006/) | CVE-2023-6779 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240223-0002**](https://security.netapp.com/advisory/ntap-20240223-0002/) | CVE-2024-0565 Linux Kernel Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240223-0005**](https://security.netapp.com/advisory/ntap-20240223-0005/) | CVE-2024-0831 HashiCorp Vault Vulnerability in NetApp Products | 2024-02-23 |
| [**NTAP-20240223-0007**](https://security.netapp.com/advisory/ntap-20240223-0007/) | CVE-2024-1048 Grub2 Vulnerability in NetApp Products | 2024-05-24 |
| [**NTAP-20240223-0008**](https://security.netapp.com/advisory/ntap-20240223-0008/) | CVE-2024-22667 Vim Vulnerability in NetApp Products | 2024-09-26 |
| [**NTAP-20240216-0010**](https://security.netapp.com/advisory/ntap-20240216-0010/) | CVE-2015-7501 Redhat JBoss Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20240216-0011**](https://security.netapp.com/advisory/ntap-20240216-0011/) | CVE-2020-1745 Undertow Vulnerability in NetApp Products | 2024-02-22 |
| [**NTAP-20240216-0004**](https://security.netapp.com/advisory/ntap-20240216-0004/) | CVE-2022-41678 Apache ActiveMQ Vulnerability in NetApp Products | 2024-07-11 |
| [**NTAP-20240216-0008**](https://security.netapp.com/advisory/ntap-20240216-0008/) | CVE-2022-45047 Apache MINA SSHD Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20240216-0006**](https://security.netapp.com/advisory/ntap-20240216-0006/) | CVE-2023-4001 Grub2 Vulnerability in NetApp Products | 2024-06-03 |
| [**NTAP-20240216-0003**](https://security.netapp.com/advisory/ntap-20240216-0003/) | CVE-2023-49238 Gradle Vulnerability in NetApp Products | 2024-05-08 |
| [**NTAP-20240216-0009**](https://security.netapp.com/advisory/ntap-20240216-0009/) | CVE-2023-6129 OpenSSL Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20240216-0007**](https://security.netapp.com/advisory/ntap-20240216-0007/) | CVE-2023-6246 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240216-0005**](https://security.netapp.com/advisory/ntap-20240216-0005/) | CVE-2024-21733 Apache Tomcat Vulnerability in NetApp Products | 2024-07-01 |
| [**NTAP-20240216-0012**](https://security.netapp.com/advisory/ntap-20240216-0012/) | CVE-2024-21983 Denial of Service Vulnerability in StorageGRID (formerly StorageGRID Webscale) | 2024-03-22 |
| [**NTAP-20240216-0013**](https://security.netapp.com/advisory/ntap-20240216-0013/) | CVE-2024-21984 Reflected Cross-Site Scripting Vulnerability in StorageGRID (formerly StorageGRID Webscale) | 2024-03-22 |
| [**NTAP-20240216-0001**](https://security.netapp.com/advisory/ntap-20240216-0001/) | CVE-2024-21987 Improper Authorization Vulnerability in SnapCenter | 2024-02-16 |
| [**NTAP-20240216-0002**](https://security.netapp.com/advisory/ntap-20240216-0002/) | CVE-2024-22207 Node.js Vulnerability in NetApp Products | 2024-10-30 |
| [**NTAP-20240208-0009**](https://security.netapp.com/advisory/ntap-20240208-0009/) | CVE-2014-125087 java-xmlbuilder Vulnerability in NetApp Products | 2024-05-17 |
| [**NTAP-20240208-0003**](https://security.netapp.com/advisory/ntap-20240208-0003/) | CVE-2021-44528 Ruby on Rails Vulnerability in NetApp Products | 2024-02-08 |
| [**NTAP-20240208-0002**](https://security.netapp.com/advisory/ntap-20240208-0002/) | CVE-2023-42465 Sudo Vulnerability in NetApp Products | 2024-06-10 |
| [**NTAP-20240208-0005**](https://security.netapp.com/advisory/ntap-20240208-0005/) | CVE-2023-47039 Perl Vulnerability in NetApp Products | 2024-09-26 |
| [**NTAP-20240208-0004**](https://security.netapp.com/advisory/ntap-20240208-0004/) | CVE-2023-6693 QEMU Vulnerability in NetApp Products | 2024-02-08 |
| [**NTAP-20240208-0001**](https://security.netapp.com/advisory/ntap-20240208-0001/) | CVE-2023-7090 Sudo Vulnerability in NetApp Products | 2024-09-26 |
| [**NTAP-20240208-0007**](https://security.netapp.com/advisory/ntap-20240208-0007/) | CVE-2024-0057 .NET Vulnerability in NetApp Products | 2024-06-03 |
| [**NTAP-20240208-0006**](https://security.netapp.com/advisory/ntap-20240208-0006/) | CVE-2024-0727 OpenSSL Vulnerability in NetApp Products | 2024-11-29 |
| [**NTAP-20240208-0008**](https://security.netapp.com/advisory/ntap-20240208-0008/) | CVE-2024-21312 .NET Framework Vulnerability in NetApp Products | 2024-06-21 |
| [**NTAP-20240208-0010**](https://security.netapp.com/advisory/ntap-20240208-0010/) | CVE-2024-23638 Squid Vulnerability in NetApp Products | 2024-03-21 |
| [**NTAP-20240202-0005**](https://security.netapp.com/advisory/ntap-20240202-0005/) | CVE-2021-22942 Ruby on Rails Vulnerability in NetApp Products | 2024-02-06 |
| [**NTAP-20240202-0004**](https://security.netapp.com/advisory/ntap-20240202-0004/) | CVE-2023-2002 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240202-0007**](https://security.netapp.com/advisory/ntap-20240202-0007/) | CVE-2023-22792 Ruby on Rails Vulnerability in NetApp Products | 2024-02-06 |
| [**NTAP-20240202-0008**](https://security.netapp.com/advisory/ntap-20240202-0008/) | CVE-2023-22794 Ruby on Rails Vulnerability in NetApp Products | 2024-02-06 |
| [**NTAP-20240202-0010**](https://security.netapp.com/advisory/ntap-20240202-0010/) | CVE-2023-22795 Ruby on Rails Vulnerability in NetApp Products | 2024-02-06 |
| [**NTAP-20240202-0009**](https://security.netapp.com/advisory/ntap-20240202-0009/) | CVE-2023-22796 Ruby on Rails Vulnerability in NetApp Products | 2024-02-06 |
| [**NTAP-20240202-0012**](https://security.netapp.com/advisory/ntap-20240202-0012/) | CVE-2023-27318 Denial of Service Vulnerability in StorageGRID (formerly StorageGRID Webscale) | 2024-02-02 |
| [**NTAP-20240202-0006**](https://security.netapp.com/advisory/ntap-20240202-0006/) | CVE-2023-28120 Ruby on Rails Vulnerability in NetApp Products | 2024-02-06 |
| [**NTAP-20240202-0001**](https://security.netapp.com/advisory/ntap-20240202-0001/) | CVE-2023-34319 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240202-0003**](https://security.netapp.com/advisory/ntap-20240202-0003/) | CVE-2023-3776 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240202-0002**](https://security.netapp.com/advisory/ntap-20240202-0002/) | CVE-2023-3863 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240202-0011**](https://security.netapp.com/advisory/ntap-20240202-0011/) | January 2024 GnuTLS Vulnerabilities in NetApp Products | 2024-06-03 |
| [**NTAP-20240201-0001**](https://security.netapp.com/advisory/ntap-20240201-0001/) | CVE-2023-31248 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240201-0004**](https://security.netapp.com/advisory/ntap-20240201-0004/) | CVE-2023-5363 MySQL Connector/ODBC Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240201-0006**](https://security.netapp.com/advisory/ntap-20240201-0006/) | CVE-2024-20965 MySQL Cluster Vulnerability in NetApp Products | 2024-05-23 |
| [**NTAP-20240201-0007**](https://security.netapp.com/advisory/ntap-20240201-0007/) | CVE-2024-20975 MySQL Server Vulnerability in NetApp Products | 2024-09-20 |
| [**NTAP-20240201-0009**](https://security.netapp.com/advisory/ntap-20240201-0009/) | CVE-2024-20983 MySQL Server Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20240201-0002**](https://security.netapp.com/advisory/ntap-20240201-0002/) | January 2024 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2025-01-06 |
| [**NTAP-20240201-0005**](https://security.netapp.com/advisory/ntap-20240201-0005/) | January 2024 MySQL Cluster Vulnerabilities in NetApp Products | 2024-05-23 |
| [**NTAP-20240201-0008**](https://security.netapp.com/advisory/ntap-20240201-0008/) | January 2024 MySQL Server 8.0.34 Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20240201-0003**](https://security.netapp.com/advisory/ntap-20240201-0003/) | January 2024 MySQL Server 8.0.35 Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20240126-0001**](https://security.netapp.com/advisory/ntap-20240126-0001/) | CVE-2024-21985 Privilege Escalation Vulnerability in ONTAP 9 | 2024-01-26 |
| [**NTAP-20240125-0005**](https://security.netapp.com/advisory/ntap-20240125-0005/) | CVE-2023-2861 QEMU Vulnerability in NetApp Products | 2024-01-25 |
| [**NTAP-20240125-0001**](https://security.netapp.com/advisory/ntap-20240125-0001/) | CVE-2023-33202 Bouncy Castle Vulnerability in NetApp Products | 2024-07-19 |
| [**NTAP-20240125-0007**](https://security.netapp.com/advisory/ntap-20240125-0007/) | CVE-2023-46218 curl Vulnerability in NetApp Products | 2024-11-05 |
| [**NTAP-20240125-0002**](https://security.netapp.com/advisory/ntap-20240125-0002/) | CVE-2023-46672 Logstash Vulnerability in NetApp Products | 2024-01-25 |
| [**NTAP-20240125-0008**](https://security.netapp.com/advisory/ntap-20240125-0008/) | CVE-2023-4806 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240125-0006**](https://security.netapp.com/advisory/ntap-20240125-0006/) | CVE-2023-51767 OpenSSH Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240125-0004**](https://security.netapp.com/advisory/ntap-20240125-0004/) | December 2023 Infinispan Vulnerabilities in NetApp Products | 2024-01-25 |
| [**NTAP-20240125-0003**](https://security.netapp.com/advisory/ntap-20240125-0003/) | December 2023 X.Org X Server Vulnerabilities in NetApp Products | 2024-06-10 |
| [**NTAP-20240119-0013**](https://security.netapp.com/advisory/ntap-20240119-0013/) | CVE-2022-23633 Ruby on Rails Vulnerability in NetApp Products | 2024-01-19 |
| [**NTAP-20240119-0011**](https://security.netapp.com/advisory/ntap-20240119-0011/) | CVE-2023-2007 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240119-0010**](https://security.netapp.com/advisory/ntap-20240119-0010/) | CVE-2023-21255 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240119-0012**](https://security.netapp.com/advisory/ntap-20240119-0012/) | CVE-2023-21400 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20240119-0007**](https://security.netapp.com/advisory/ntap-20240119-0007/) | CVE-2023-46219 curl Vulnerability in NetApp Products | 2024-11-05 |
| [**NTAP-20240119-0006**](https://security.netapp.com/advisory/ntap-20240119-0006/) | CVE-2023-49288 Squid Vulnerability in NetApp Products | 2024-01-19 |
| [**NTAP-20240119-0005**](https://security.netapp.com/advisory/ntap-20240119-0005/) | CVE-2023-50269 Squid Vulnerability in NetApp Products | 2024-01-19 |
| [**NTAP-20240119-0008**](https://security.netapp.com/advisory/ntap-20240119-0008/) | CVE-2023-50495 GNU Ncurses Vulnerability in NetApp Products | 2024-06-03 |
| [**NTAP-20240119-0009**](https://security.netapp.com/advisory/ntap-20240119-0009/) | CVE-2023-5528 Kubernetes Vulnerability in NetApp Products | 2024-09-26 |
| [**NTAP-20240119-0002**](https://security.netapp.com/advisory/ntap-20240119-0002/) | CVE-2023-6277 LibTIFF Vulnerability in NetApp Products | 2024-02-12 |
| [**NTAP-20240119-0001**](https://security.netapp.com/advisory/ntap-20240119-0001/) | December 2023 IBM DB2 Vulnerabilities in NetApp Products | 2024-01-19 |
| [**NTAP-20240119-0003**](https://security.netapp.com/advisory/ntap-20240119-0003/) | December 2023 PostgreSQL Vulnerabilities in NetApp Products | 2024-08-23 |
| [**NTAP-20240119-0004**](https://security.netapp.com/advisory/ntap-20240119-0004/) | December 2023 Squid Vulnerabilities in NetApp Products | 2024-10-22 |
| [**NTAP-20240112-0001**](https://security.netapp.com/advisory/ntap-20240112-0001/) | CVE-2023-26031 Apache Hadoop Vulnerability in NetApp Products | 2024-01-12 |
| [**NTAP-20240112-0002**](https://security.netapp.com/advisory/ntap-20240112-0002/) | CVE-2023-29258 IBM Db2 Vulnerability in NetApp Products | 2024-01-12 |
| [**NTAP-20240112-0004**](https://security.netapp.com/advisory/ntap-20240112-0004/) | CVE-2023-45178 IBM Db2 Vulnerability in NetApp Products | 2024-01-12 |
| [**NTAP-20240112-0005**](https://security.netapp.com/advisory/ntap-20240112-0005/) | CVE-2023-45287 Golang Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20240112-0003**](https://security.netapp.com/advisory/ntap-20240112-0003/) | CVE-2023-46167 IBM Db2 Vulnerability in NetApp Products | 2024-01-12 |
| [**NTAP-20240112-0006**](https://security.netapp.com/advisory/ntap-20240112-0006/) | CVE-2023-6337 HashiCorp Vault Vulnerability in NetApp Products | 2024-01-12 |
| [**NTAP-20240112-0007**](https://security.netapp.com/advisory/ntap-20240112-0007/) | CVE-2023-6534 FreeBSD Vulnerability in NetApp Products | 2024-01-16 |
| [**NTAP-20240112-0008**](https://security.netapp.com/advisory/ntap-20240112-0008/) | CVE-2023-7104 SQLite Vulnerability in NetApp Products | 2024-02-12 |
| [**NTAP-20240111-0001**](https://security.netapp.com/advisory/ntap-20240111-0001/) | CVE-2024-21982 Information Disclosure Vulnerability in ONTAP 9 | 2024-01-11 |
| [**NTAP-20240105-0003**](https://security.netapp.com/advisory/ntap-20240105-0003/) | AMI AptioV SA-2023009 Vulnerabilities in NetApp Products | 2024-03-21 |
| [**NTAP-20240105-0002**](https://security.netapp.com/advisory/ntap-20240105-0002/) | CVE-2023-40238 InsydeH2O Vulnerability in NetApp Products | 2024-03-21 |
| [**NTAP-20240105-0001**](https://security.netapp.com/advisory/ntap-20240105-0001/) | CVE-2023-48706 Vim Vulnerability in NetApp Products | 2024-02-06 |
| [**NTAP-20240105-0004**](https://security.netapp.com/advisory/ntap-20240105-0004/) | CVE-2023-48795 SSH Protocol Vulnerability in NetApp Products | 2024-11-14 |
| [**NTAP-20240105-0005**](https://security.netapp.com/advisory/ntap-20240105-0005/) | January 2024 OpenSSH Vulnerabilities in NetApp Products | 2024-11-22 |
| [**NTAP-20231227-0010**](https://security.netapp.com/advisory/ntap-20231227-0010/) | CVE-2018-8088 SLF4j Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20231227-0009**](https://security.netapp.com/advisory/ntap-20231227-0009/) | CVE-2019-10158 Infinispan Vulnerability in NetApp Products | 2023-12-27 |
| [**NTAP-20231227-0011**](https://security.netapp.com/advisory/ntap-20231227-0011/) | CVE-2019-3773 Spring Web Services Vulnerability in NetApp Products | 2023-12-27 |
| [**NTAP-20231227-0008**](https://security.netapp.com/advisory/ntap-20231227-0008/) | CVE-2023-48231 Vim Vulnerability in NetApp Products | 2024-02-22 |
| [**NTAP-20231227-0006**](https://security.netapp.com/advisory/ntap-20231227-0006/) | CVE-2023-48232 Vim Vulnerability in NetApp Products | 2024-05-27 |
| [**NTAP-20231227-0003**](https://security.netapp.com/advisory/ntap-20231227-0003/) | CVE-2023-48233 Vim Vulnerability in NetApp Products | 2024-04-11 |
| [**NTAP-20231227-0004**](https://security.netapp.com/advisory/ntap-20231227-0004/) | CVE-2023-48234 Vim Vulnerability in NetApp Products | 2024-02-12 |
| [**NTAP-20231227-0007**](https://security.netapp.com/advisory/ntap-20231227-0007/) | CVE-2023-48235 Vim Vulnerability in NetApp Products | 2024-05-27 |
| [**NTAP-20231227-0002**](https://security.netapp.com/advisory/ntap-20231227-0002/) | CVE-2023-48236 Vim Vulnerability in NetApp Products | 2024-02-06 |
| [**NTAP-20231227-0005**](https://security.netapp.com/advisory/ntap-20231227-0005/) | CVE-2023-48237 Vim Vulnerability in NetApp Products | 2024-02-12 |
| [**NTAP-20231227-0001**](https://security.netapp.com/advisory/ntap-20231227-0001/) | CVE-2023-5954 HashiCorp Vault Vulnerability in NetApp Products | 2023-12-27 |
| [**NTAP-20231222-0001**](https://security.netapp.com/advisory/ntap-20231222-0001/) | November 2023 AsyncSSH Vulnerabilities in NetApp Products | 2023-12-22 |
| [**NTAP-20231221-0003**](https://security.netapp.com/advisory/ntap-20231221-0003/) | CVE-2021-25736 Kubernetes Vulnerability in NetApp Products | 2024-01-01 |
| [**NTAP-20231221-0005**](https://security.netapp.com/advisory/ntap-20231221-0005/) | CVE-2022-3172 Kubernetes Vulnerability in NetApp Products | 2024-01-01 |
| [**NTAP-20231221-0006**](https://security.netapp.com/advisory/ntap-20231221-0006/) | CVE-2023-1194 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231221-0011**](https://security.netapp.com/advisory/ntap-20231221-0011/) | CVE-2023-27319 Information Disclosure Vulnerability in ONTAP Mediator | 2023-12-21 |
| [**NTAP-20231221-0007**](https://security.netapp.com/advisory/ntap-20231221-0007/) | CVE-2023-28376 Intel Ethernet Controller Vulnerability in NetApp Products | 2023-12-21 |
| [**NTAP-20231221-0010**](https://security.netapp.com/advisory/ntap-20231221-0010/) | CVE-2023-34055 Spring Boot Vulnerability in NetApp Products | 2024-02-12 |
| [**NTAP-20231221-0004**](https://security.netapp.com/advisory/ntap-20231221-0004/) | CVE-2023-3893 Kubernetes Vulnerability in NetApp Products | 2024-03-15 |
| [**NTAP-20231221-0002**](https://security.netapp.com/advisory/ntap-20231221-0002/) | CVE-2023-3955 Kubernetes Vulnerability in NetApp Products | 2024-03-15 |
| [**NTAP-20231221-0001**](https://security.netapp.com/advisory/ntap-20231221-0001/) | CVE-2023-43665 Django Vulnerability in NetApp Products | 2023-12-21 |
| [**NTAP-20231221-0009**](https://security.netapp.com/advisory/ntap-20231221-0009/) | CVE-2023-4809 FreeBSD Vulnerability in NetApp Products | 2023-12-21 |
| [**NTAP-20231221-0008**](https://security.netapp.com/advisory/ntap-20231221-0008/) | Intel SA-00924 BIOS Firmware Vulnerabilities in NetApp Products | 2023-12-21 |
| [**NTAP-20231215-0001**](https://security.netapp.com/advisory/ntap-20231215-0001/) | CVE-2023-27317 Information Disclosure Vulnerability in ONTAP 9 | 2023-12-15 |
| [**NTAP-20231214-0007**](https://security.netapp.com/advisory/ntap-20231214-0007/) | CVE-2023-34053 Spring Framework Vulnerability in NetApp Products | 2024-02-12 |
| [**NTAP-20231214-0002**](https://security.netapp.com/advisory/ntap-20231214-0002/) | CVE-2023-41164 Django Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231214-0008**](https://security.netapp.com/advisory/ntap-20231214-0008/) | CVE-2023-45283 Golang Vulnerability in NetApp Products | 2024-05-17 |
| [**NTAP-20231214-0009**](https://security.netapp.com/advisory/ntap-20231214-0009/) | CVE-2023-46589 Apache Tomcat Vulnerability in NetApp Products | 2023-12-20 |
| [**NTAP-20231214-0001**](https://security.netapp.com/advisory/ntap-20231214-0001/) | CVE-2023-46695 Django Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231214-0006**](https://security.netapp.com/advisory/ntap-20231214-0006/) | CVE-2023-46728 Squid Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231214-0005**](https://security.netapp.com/advisory/ntap-20231214-0005/) | CVE-2023-46848 Squid Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231214-0010**](https://security.netapp.com/advisory/ntap-20231214-0010/) | CVE-2023-50164 Apache Struts Vulnerability in NetApp Products | 2023-12-20 |
| [**NTAP-20231214-0004**](https://security.netapp.com/advisory/ntap-20231214-0004/) | CVE-2023-5941 FreeBSD Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231214-0003**](https://security.netapp.com/advisory/ntap-20231214-0003/) | CVE-2023-5978 FreeBSD Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231208-0012**](https://security.netapp.com/advisory/ntap-20231208-0012/) | CVE-2022-30122 Rack Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20231208-0011**](https://security.netapp.com/advisory/ntap-20231208-0011/) | CVE-2022-30123 Rack Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20231208-0010**](https://security.netapp.com/advisory/ntap-20231208-0010/) | CVE-2022-44570 Rack Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20231208-0013**](https://security.netapp.com/advisory/ntap-20231208-0013/) | CVE-2022-44571 Rack Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20231208-0014**](https://security.netapp.com/advisory/ntap-20231208-0014/) | CVE-2022-44572 Rack Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20231208-0015**](https://security.netapp.com/advisory/ntap-20231208-0015/) | CVE-2023-27530 Rack Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20231208-0016**](https://security.netapp.com/advisory/ntap-20231208-0016/) | CVE-2023-27539 Rack Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20231208-0008**](https://security.netapp.com/advisory/ntap-20231208-0008/) | CVE-2023-3138 libX11 Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20231208-0007**](https://security.netapp.com/advisory/ntap-20231208-0007/) | CVE-2023-34969 D-Bus Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20231208-0003**](https://security.netapp.com/advisory/ntap-20231208-0003/) | CVE-2023-4399 Grafana Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20231208-0006**](https://security.netapp.com/advisory/ntap-20231208-0006/) | CVE-2023-46246 Vim Vulnerability in NetApp Products | 2023-12-20 |
| [**NTAP-20231208-0001**](https://security.netapp.com/advisory/ntap-20231208-0001/) | CVE-2023-46724 Squid Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20231208-0005**](https://security.netapp.com/advisory/ntap-20231208-0005/) | CVE-2023-5088 QEMU Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20231208-0004**](https://security.netapp.com/advisory/ntap-20231208-0004/) | CVE-2023-5178 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231208-0002**](https://security.netapp.com/advisory/ntap-20231208-0002/) | October 2023 Grub Vulnerabilities in NetApp Products | 2023-12-20 |
| [**NTAP-20231208-0009**](https://security.netapp.com/advisory/ntap-20231208-0009/) | October 2023 Supermicro BMC Vulnerabilities in NetApp Products | 2023-12-20 |
| [**NTAP-20231130-0008**](https://security.netapp.com/advisory/ntap-20231130-0008/) | CVE-2022-4900 PHP Vulnerability in NetApp Products | 2023-11-30 |
| [**NTAP-20231130-0006**](https://security.netapp.com/advisory/ntap-20231130-0006/) | CVE-2023-31417 Elasticsearch Vulnerability in NetApp Products | 2024-01-16 |
| [**NTAP-20231130-0005**](https://security.netapp.com/advisory/ntap-20231130-0005/) | CVE-2023-31418 Elasticsearch Vulnerability in NetApp Products | 2024-01-16 |
| [**NTAP-20231130-0007**](https://security.netapp.com/advisory/ntap-20231130-0007/) | CVE-2023-3676 Kubernetes Vulnerability in NetApp Products | 2024-01-01 |
| [**NTAP-20231130-0001**](https://security.netapp.com/advisory/ntap-20231130-0001/) | CVE-2023-4163 Brocade Fabric OS Vulnerability | 2023-11-30 |
| [**NTAP-20231130-0009**](https://security.netapp.com/advisory/ntap-20231130-0009/) | CVE-2023-45853 Zlib Vulnerability in NetApp Products | 2024-10-14 |
| [**NTAP-20231130-0010**](https://security.netapp.com/advisory/ntap-20231130-0010/) | CVE-2023-5678 OpenSSL Vulnerability in NetApp Products | 2024-11-29 |
| [**NTAP-20231130-0003**](https://security.netapp.com/advisory/ntap-20231130-0003/) | CVE-2023-5824 Squid Vulnerability in NetApp Products | 2023-12-21 |
| [**NTAP-20231130-0002**](https://security.netapp.com/advisory/ntap-20231130-0002/) | November 2023 Squid Vulnerabilities in NetApp Products | 2023-11-30 |
| [**NTAP-20231130-0004**](https://security.netapp.com/advisory/ntap-20231130-0004/) | October 2023 X.Org X Server Vulnerabilities in NetApp Products | 2023-11-30 |
| [**NTAP-20231124-0006**](https://security.netapp.com/advisory/ntap-20231124-0006/) | CVE-2022-38087 Intel BIOS Firmware Vulnerability in NetApp Products | 2023-11-24 |
| [**NTAP-20231124-0001**](https://security.netapp.com/advisory/ntap-20231124-0001/) | CVE-2023-32252 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231124-0003**](https://security.netapp.com/advisory/ntap-20231124-0003/) | CVE-2023-3489 Brocade Fabric OS Vulnerability | 2023-11-24 |
| [**NTAP-20231124-0010**](https://security.netapp.com/advisory/ntap-20231124-0010/) | CVE-2023-4162 Brocade Fabric OS Vulnerability | 2023-11-24 |
| [**NTAP-20231124-0008**](https://security.netapp.com/advisory/ntap-20231124-0008/) | CVE-2023-46136 Werkzeug Vulnerability in NetApp Products | 2023-11-30 |
| [**NTAP-20231124-0004**](https://security.netapp.com/advisory/ntap-20231124-0004/) | CVE-2023-5368 FreeBSD Vulnerability in NetApp Products | 2023-11-24 |
| [**NTAP-20231124-0009**](https://security.netapp.com/advisory/ntap-20231124-0009/) | CVE-2023-5369 FreeBSD Vulnerability in NetApp Products | 2023-11-24 |
| [**NTAP-20231124-0005**](https://security.netapp.com/advisory/ntap-20231124-0005/) | CVE-2023-5370 FreeBSD Vulnerability in NetApp Products | 2023-11-24 |
| [**NTAP-20231124-0007**](https://security.netapp.com/advisory/ntap-20231124-0007/) | CVE-2023-5568 Samba Vulnerability in NetApp Products | 2023-11-30 |
| [**NTAP-20231124-0002**](https://security.netapp.com/advisory/ntap-20231124-0002/) | October 2023 Samba Vulnerabilities in NetApp Products | 2024-05-20 |
| [**NTAP-20231116-0002**](https://security.netapp.com/advisory/ntap-20231116-0002/) | CVE-2022-48554 File Vulnerability in NetApp Products | 2023-11-16 |
| [**NTAP-20231116-0015**](https://security.netapp.com/advisory/ntap-20231116-0015/) | CVE-2023-23583 Intel Processor Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20231116-0001**](https://security.netapp.com/advisory/ntap-20231116-0001/) | CVE-2023-2680 QEMU Vulnerability in NetApp Products | 2023-11-16 |
| [**NTAP-20231116-0010**](https://security.netapp.com/advisory/ntap-20231116-0010/) | CVE-2023-31419 Elasticsearch Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231116-0011**](https://security.netapp.com/advisory/ntap-20231116-0011/) | CVE-2023-36478 Eclipse Jetty Vulnerability in NetApp Products | 2024-06-21 |
| [**NTAP-20231116-0013**](https://security.netapp.com/advisory/ntap-20231116-0013/) | CVE-2023-38552 Node.js Vulnerability in NetApp Products | 2024-07-26 |
| [**NTAP-20231116-0008**](https://security.netapp.com/advisory/ntap-20231116-0008/) | CVE-2023-38719 IBM Db2 Vulnerability in NetApp Products | 2023-11-16 |
| [**NTAP-20231116-0003**](https://security.netapp.com/advisory/ntap-20231116-0003/) | CVE-2023-44466 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231116-0014**](https://security.netapp.com/advisory/ntap-20231116-0014/) | CVE-2023-45145 Redis Vulnerability in NetApp Products | 2024-05-20 |
| [**NTAP-20231116-0012**](https://security.netapp.com/advisory/ntap-20231116-0012/) | CVE-2023-4527 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231116-0004**](https://security.netapp.com/advisory/ntap-20231116-0004/) | CVE-2023-45862 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231116-0006**](https://security.netapp.com/advisory/ntap-20231116-0006/) | October 2023 IBM DB2 10.5.0.x, 11.1.4.x, and 11.5.x Vulnerabilities in NetApp Products | 2023-11-16 |
| [**NTAP-20231116-0005**](https://security.netapp.com/advisory/ntap-20231116-0005/) | October 2023 IBM DB2 11.1.4.x and 11.5.x Vulnerabilities in NetApp Products | 2023-11-16 |
| [**NTAP-20231116-0007**](https://security.netapp.com/advisory/ntap-20231116-0007/) | October 2023 IBM DB2 11.5.x Vulnerabilities in NetApp Products | 2023-11-16 |
| [**NTAP-20231116-0009**](https://security.netapp.com/advisory/ntap-20231116-0009/) | October 2023 Node.js Vulnerabilities in NetApp Products | 2023-12-14 |
| [**NTAP-20231110-0002**](https://security.netapp.com/advisory/ntap-20231110-0002/) | CVE-2023-32636 Gnome Glib Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231110-0008**](https://security.netapp.com/advisory/ntap-20231110-0008/) | CVE-2023-39325 Golang Vulnerability in NetApp Products | 2024-01-16 |
| [**NTAP-20231110-0005**](https://security.netapp.com/advisory/ntap-20231110-0005/) | CVE-2023-40745 LibTIFF Vulnerability in NetApp Products | 2023-11-17 |
| [**NTAP-20231110-0009**](https://security.netapp.com/advisory/ntap-20231110-0009/) | CVE-2023-40791 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231110-0004**](https://security.netapp.com/advisory/ntap-20231110-0004/) | CVE-2023-41900 Eclipse Jetty Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231110-0001**](https://security.netapp.com/advisory/ntap-20231110-0001/) | CVE-2023-45871 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231110-0010**](https://security.netapp.com/advisory/ntap-20231110-0010/) | CVE-2023-46604 Apache ActiveMQ Vulnerability in NetApp Products | 2024-07-11 |
| [**NTAP-20231110-0003**](https://security.netapp.com/advisory/ntap-20231110-0003/) | CVE-2023-4813 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231110-0007**](https://security.netapp.com/advisory/ntap-20231110-0007/) | October 2023 7-Zip Vulnerabilities in NetApp Products | 2024-05-20 |
| [**NTAP-20231110-0006**](https://security.netapp.com/advisory/ntap-20231110-0006/) | October 2023 Gradle Vulnerabilities in NetApp Products | 2023-11-10 |
| [**NTAP-20231103-0002**](https://security.netapp.com/advisory/ntap-20231103-0002/) | CVE-2023-25584 GNU Binutils Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20231103-0001**](https://security.netapp.com/advisory/ntap-20231103-0001/) | CVE-2023-29499 Gnome Glib Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231103-0004**](https://security.netapp.com/advisory/ntap-20231103-0004/) | CVE-2023-32005 Node.js Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231103-0005**](https://security.netapp.com/advisory/ntap-20231103-0005/) | CVE-2023-42467 QEMU Vulnerability in NetApp Products | 2023-11-03 |
| [**NTAP-20231103-0008**](https://security.netapp.com/advisory/ntap-20231103-0008/) | CVE-2023-4822 Grafana Vulnerability in NetApp Products | 2023-11-03 |
| [**NTAP-20231103-0007**](https://security.netapp.com/advisory/ntap-20231103-0007/) | October 2023 Apache Tomcat Vulnerabilities in NetApp Products | 2023-12-20 |
| [**NTAP-20231103-0006**](https://security.netapp.com/advisory/ntap-20231103-0006/) | October 2023 libX11 Vulnerabilities in NetApp Products | 2023-11-17 |
| [**NTAP-20231103-0003**](https://security.netapp.com/advisory/ntap-20231103-0003/) | September 2023 GNU Binutils 2.40 Vulnerabilities in NetApp Products | 2024-11-05 |
| [**NTAP-20231027-0002**](https://security.netapp.com/advisory/ntap-20231027-0002/) | August 2023 Linux Kernel 6.5-rc5 Vulnerabilities in NetApp Products | 2024-10-22 |
| [**NTAP-20231027-0003**](https://security.netapp.com/advisory/ntap-20231027-0003/) | CVE-2014-3577 Apache HttpComponents HttpClient Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231027-0007**](https://security.netapp.com/advisory/ntap-20231027-0007/) | CVE-2023-22102 MySQL Connector/J Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20231027-0004**](https://security.netapp.com/advisory/ntap-20231027-0004/) | CVE-2023-3223 Undertow Vulnerability in NetApp Products | 2023-11-15 |
| [**NTAP-20231027-0005**](https://security.netapp.com/advisory/ntap-20231027-0005/) | CVE-2023-32611 Gnome Glib Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20231027-0008**](https://security.netapp.com/advisory/ntap-20231027-0008/) | CVE-2023-3817 MySQL Connector/ODBC Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20231027-0001**](https://security.netapp.com/advisory/ntap-20231027-0001/) | CVE-2023-4004 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231027-0010**](https://security.netapp.com/advisory/ntap-20231027-0010/) | CVE-2023-5363 OpenSSL Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20231027-0011**](https://security.netapp.com/advisory/ntap-20231027-0011/) | October 2023 Apache HTTP Server Vulnerabilities in NetApp Products | 2024-04-11 |
| [**NTAP-20231027-0006**](https://security.netapp.com/advisory/ntap-20231027-0006/) | October 2023 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20231027-0009**](https://security.netapp.com/advisory/ntap-20231027-0009/) | October 2023 MySQL Server Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20231020-0002**](https://security.netapp.com/advisory/ntap-20231020-0002/) | CVE-2023-1108 Undertow Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20231020-0010**](https://security.netapp.com/advisory/ntap-20231020-0010/) | CVE-2023-1260 Kubernetes Vulnerability in NetApp Products | 2023-10-20 |
| [**NTAP-20231020-0001**](https://security.netapp.com/advisory/ntap-20231020-0001/) | CVE-2023-39323 Golang Vulnerability in NetApp Products | 2023-11-15 |
| [**NTAP-20231020-0007**](https://security.netapp.com/advisory/ntap-20231020-0007/) | CVE-2023-40283 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231020-0005**](https://security.netapp.com/advisory/ntap-20231020-0005/) | CVE-2023-4132 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231020-0006**](https://security.netapp.com/advisory/ntap-20231020-0006/) | CVE-2023-4147 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231020-0003**](https://security.netapp.com/advisory/ntap-20231020-0003/) | CVE-2023-42503 Apache Commons Compress Vulnerability in NetApp Products | 2023-11-30 |
| [**NTAP-20231020-0004**](https://security.netapp.com/advisory/ntap-20231020-0004/) | September 2023 Golang 1.21.0 Vulnerabilities in NetApp Products | 2023-11-15 |
| [**NTAP-20231020-0009**](https://security.netapp.com/advisory/ntap-20231020-0009/) | September 2023 Golang Vulnerabilities in NetApp Products | 2023-11-15 |
| [**NTAP-20231020-0008**](https://security.netapp.com/advisory/ntap-20231020-0008/) | September 2023 QEMU Vulnerabilities in NetApp Products | 2023-10-20 |
| [**NTAP-20231016-0001**](https://security.netapp.com/advisory/ntap-20231016-0001/) | CVE-2023-44487 HTTP/2 Vulnerability in NetApp Products | 2024-12-13 |
| [**NTAP-20231013-0002**](https://security.netapp.com/advisory/ntap-20231013-0002/) | CVE-2023-20900 VMware Tools Vulnerability in NetApp Products | 2024-11-05 |
| [**NTAP-20231013-0003**](https://security.netapp.com/advisory/ntap-20231013-0003/) | CVE-2023-3341 ISC BIND Vulnerability in NetApp Products | 2024-05-20 |
| [**NTAP-20231013-0005**](https://security.netapp.com/advisory/ntap-20231013-0005/) | CVE-2023-38039 curl Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231013-0001**](https://security.netapp.com/advisory/ntap-20231013-0001/) | CVE-2023-41835 Apache Struts Vulnerability in NetApp Products | 2024-04-05 |
| [**NTAP-20231013-0004**](https://security.netapp.com/advisory/ntap-20231013-0004/) | CVE-2023-4236 ISC BIND Vulnerability in NetApp Products | 2023-11-07 |
| [**NTAP-20231013-0006**](https://security.netapp.com/advisory/ntap-20231013-0006/) | CVE-2023-4911 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20231012-0001**](https://security.netapp.com/advisory/ntap-20231012-0001/) | CVE-2023-27316 Privilege Escalation Vulnerability in SnapCenter | 2023-10-12 |
| [**NTAP-20231011-0001**](https://security.netapp.com/advisory/ntap-20231011-0001/) | October 2023 curl Vulnerabilities in NetApp Products | 2024-11-05 |
| [**NTAP-20231009-0001**](https://security.netapp.com/advisory/ntap-20231009-0001/) | CVE-2023-27314 Denial of Service Vulnerability in ONTAP 9 | 2023-10-09 |
| [**NTAP-20231009-0002**](https://security.netapp.com/advisory/ntap-20231009-0002/) | CVE-2023-27315 Information Disclosure Vulnerability in SnapGathers | 2023-10-09 |
| [**NTAP-20231006-0008**](https://security.netapp.com/advisory/ntap-20231006-0008/) | August 2023 GNU Binutils Vulnerabilities in NetApp Products | 2024-11-05 |
| [**NTAP-20231006-0005**](https://security.netapp.com/advisory/ntap-20231006-0005/) | August 2023 GNU Ncurses Vulnerabilities in NetApp Products | 2023-12-14 |
| [**NTAP-20231006-0011**](https://security.netapp.com/advisory/ntap-20231006-0011/) | CVE-2016-1000338 Bouncy Castle Vulnerability in NetApp Products | 2023-11-01 |
| [**NTAP-20231006-0002**](https://security.netapp.com/advisory/ntap-20231006-0002/) | CVE-2020-22218 Libssh2 Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20231006-0012**](https://security.netapp.com/advisory/ntap-20231006-0012/) | CVE-2020-24165 QEMU Vulnerability in NetApp Products | 2023-10-06 |
| [**NTAP-20231006-0009**](https://security.netapp.com/advisory/ntap-20231006-0009/) | CVE-2020-35342 GNU Binutils Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20231006-0001**](https://security.netapp.com/advisory/ntap-20231006-0001/) | CVE-2021-32050 MongoDB Drivers Vulnerability in NetApp Products | 2023-10-06 |
| [**NTAP-20231006-0010**](https://security.netapp.com/advisory/ntap-20231006-0010/) | CVE-2022-35205 GNU Binutils Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20231006-0004**](https://security.netapp.com/advisory/ntap-20231006-0004/) | CVE-2022-36648 QEMU Vulnerability in NetApp Products | 2023-10-06 |
| [**NTAP-20231006-0003**](https://security.netapp.com/advisory/ntap-20231006-0003/) | CVE-2022-45703 GNU Binutils Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20231006-0007**](https://security.netapp.com/advisory/ntap-20231006-0007/) | CVE-2022-48565 Python Vulnerability in NetApp Products | 2023-10-06 |
| [**NTAP-20231006-0013**](https://security.netapp.com/advisory/ntap-20231006-0013/) | CVE-2022-48566 Python Vulnerability in NetApp Products | 2024-03-15 |
| [**NTAP-20231006-0006**](https://security.netapp.com/advisory/ntap-20231006-0006/) | CVE-2023-32559 Node.js Vulnerability in NetApp Products | 2023-10-10 |
| [**NTAP-20231006-0014**](https://security.netapp.com/advisory/ntap-20231006-0014/) | CVE-2023-40217 Python Vulnerability in NetApp Products | 2024-05-20 |
| [**NTAP-20231006-0015**](https://security.netapp.com/advisory/ntap-20231006-0015/) | CVE-2023-41105 Python Vulnerability in NetApp Products | 2023-11-07 |
| [**NTAP-20230929-0003**](https://security.netapp.com/advisory/ntap-20230929-0003/) | April 2023 Linux Kernel 6.2 Vulnerabilities in NetApp Products | 2023-09-29 |
| [**NTAP-20230929-0007**](https://security.netapp.com/advisory/ntap-20230929-0007/) | CVE-2020-21490 GNU Binutils Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20230929-0010**](https://security.netapp.com/advisory/ntap-20230929-0010/) | CVE-2021-32292 JSON-C Vulnerability in NetApp Products | 2024-05-20 |
| [**NTAP-20230929-0001**](https://security.netapp.com/advisory/ntap-20230929-0001/) | CVE-2022-4269 Linux Kernel Vulnerability in NetApp Products | 2023-09-29 |
| [**NTAP-20230929-0008**](https://security.netapp.com/advisory/ntap-20230929-0008/) | CVE-2022-48560 Python Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20230929-0009**](https://security.netapp.com/advisory/ntap-20230929-0009/) | CVE-2022-48564 Python Vulnerability in NetApp Products | 2023-10-04 |
| [**NTAP-20230929-0006**](https://security.netapp.com/advisory/ntap-20230929-0006/) | CVE-2023-1206 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230929-0004**](https://security.netapp.com/advisory/ntap-20230929-0004/) | CVE-2023-2269 Linux Kernel Vulnerability in NetApp Products | 2023-09-29 |
| [**NTAP-20230929-0002**](https://security.netapp.com/advisory/ntap-20230929-0002/) | CVE-2023-2898 Linux Kernel Vulnerability in NetApp Products | 2024-10-14 |
| [**NTAP-20230929-0005**](https://security.netapp.com/advisory/ntap-20230929-0005/) | CVE-2023-3212 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230929-0011**](https://security.netapp.com/advisory/ntap-20230929-0011/) | CVE-2023-4863 Libwebp Vulnerability in NetApp Products | 2023-11-02 |
| [**NTAP-20230921-0004**](https://security.netapp.com/advisory/ntap-20230921-0004/) | CVE-2022-22483 IBM Db2 Vulnerability in NetApp Products | 2023-09-21 |
| [**NTAP-20230921-0002**](https://security.netapp.com/advisory/ntap-20230921-0002/) | CVE-2022-33894 Intel BIOS Firmware Vulnerability in NetApp Products | 2023-09-21 |
| [**NTAP-20230921-0003**](https://security.netapp.com/advisory/ntap-20230921-0003/) | CVE-2022-35637 IBM Db2 Vulnerability in NetApp Products | 2023-09-21 |
| [**NTAP-20230921-0007**](https://security.netapp.com/advisory/ntap-20230921-0007/) | CVE-2023-1409 MongoDB Vulnerability in NetApp Products | 2023-10-04 |
| [**NTAP-20230921-0005**](https://security.netapp.com/advisory/ntap-20230921-0005/) | CVE-2023-35011 IBM Cognos Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20230921-0006**](https://security.netapp.com/advisory/ntap-20230921-0006/) | CVE-2023-41080 Apache Tomcat Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20230921-0001**](https://security.netapp.com/advisory/ntap-20230921-0001/) | CVE-2023-4807 OpenSSL Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20230915-0009**](https://security.netapp.com/advisory/ntap-20230915-0009/) | August 2023 Node.js Vulnerabilities in NetApp Products | 2023-09-15 |
| [**NTAP-20230915-0002**](https://security.netapp.com/advisory/ntap-20230915-0002/) | August 2023 PostgreSQL Vulnerabilities in NetApp Products | 2024-02-12 |
| [**NTAP-20230915-0001**](https://security.netapp.com/advisory/ntap-20230915-0001/) | CVE-2021-3236 Vim Vulnerability in NetApp Products | 2023-10-04 |
| [**NTAP-20230915-0003**](https://security.netapp.com/advisory/ntap-20230915-0003/) | CVE-2022-41804 Intel Processor Vulnerability in NetApp Products | 2023-10-03 |
| [**NTAP-20230915-0008**](https://security.netapp.com/advisory/ntap-20230915-0008/) | CVE-2022-48522 Perl Vulnerability in NetApp Products | 2024-02-21 |
| [**NTAP-20230915-0007**](https://security.netapp.com/advisory/ntap-20230915-0007/) | CVE-2023-22276 Intel Ethernet Controller Vulnerability in NetApp Products | 2023-09-15 |
| [**NTAP-20230915-0013**](https://security.netapp.com/advisory/ntap-20230915-0013/) | CVE-2023-25775 Intel Ethernet Controller Vulnerability in NetApp Products | 2023-09-15 |
| [**NTAP-20230915-0006**](https://security.netapp.com/advisory/ntap-20230915-0006/) | CVE-2023-32248 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20230915-0005**](https://security.netapp.com/advisory/ntap-20230915-0005/) | CVE-2023-34478 Apache Shiro Vulnerability in NetApp Products | 2024-06-13 |
| [**NTAP-20230915-0010**](https://security.netapp.com/advisory/ntap-20230915-0010/) | CVE-2023-38426 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20230915-0014**](https://security.netapp.com/advisory/ntap-20230915-0014/) | CVE-2023-39975 MIT Kerberos 5 Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20230915-0004**](https://security.netapp.com/advisory/ntap-20230915-0004/) | CVE-2023-40360 QEMU Vulnerability in NetApp Products | 2023-09-15 |
| [**NTAP-20230915-0012**](https://security.netapp.com/advisory/ntap-20230915-0012/) | CVE-2023-4135 QEMU Vulnerability in NetApp Products | 2023-09-15 |
| [**NTAP-20230915-0011**](https://security.netapp.com/advisory/ntap-20230915-0011/) | July 2023 Linux Kernel 6.3.9 Vulnerabilities in NetApp Products | 2024-10-22 |
| [**NTAP-20230908-0007**](https://security.netapp.com/advisory/ntap-20230908-0007/) | August 2023 Brocade Fabric OS Vulnerabilities | 2023-09-08 |
| [**NTAP-20230908-0003**](https://security.netapp.com/advisory/ntap-20230908-0003/) | CVE-2020-26708 requests-xml Vulnerability in NetApp Products | 2023-12-20 |
| [**NTAP-20230908-0008**](https://security.netapp.com/advisory/ntap-20230908-0008/) | CVE-2022-24963 Apache Portable Runtime (APR) Vulnerability in NetApp Products | 2024-01-24 |
| [**NTAP-20230908-0005**](https://security.netapp.com/advisory/ntap-20230908-0005/) | CVE-2022-24999 Node.js Vulnerability in NetApp Products | 2023-09-08 |
| [**NTAP-20230908-0006**](https://security.netapp.com/advisory/ntap-20230908-0006/) | CVE-2023-1255 OpenSSL Vulnerability in NetApp Products | 2024-11-14 |
| [**NTAP-20230908-0001**](https://security.netapp.com/advisory/ntap-20230908-0001/) | CVE-2023-3269 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20230908-0004**](https://security.netapp.com/advisory/ntap-20230908-0004/) | CVE-2023-36054 MIT Kerberos 5 Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20230908-0002**](https://security.netapp.com/advisory/ntap-20230908-0002/) | CVE-2023-3611 Linux Kernel Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20230831-0009**](https://security.netapp.com/advisory/ntap-20230831-0009/) | August 2023 Golang Vulnerabilities in NetApp Products | 2023-10-04 |
| [**NTAP-20230831-0004**](https://security.netapp.com/advisory/ntap-20230831-0004/) | CVE-2023-26045 Node.js Vulnerability in NetApp Products | 2024-01-24 |
| [**NTAP-20230831-0010**](https://security.netapp.com/advisory/ntap-20230831-0010/) | CVE-2023-29409 Golang Vulnerability in NetApp Products | 2024-01-16 |
| [**NTAP-20230831-0008**](https://security.netapp.com/advisory/ntap-20230831-0008/) | CVE-2023-3180 QEMU Vulnerability in NetApp Products | 2023-08-31 |
| [**NTAP-20230831-0006**](https://security.netapp.com/advisory/ntap-20230831-0006/) | CVE-2023-3494 FreeBSD Vulnerability in NetApp Products | 2023-08-31 |
| [**NTAP-20230831-0014**](https://security.netapp.com/advisory/ntap-20230831-0014/) | CVE-2023-35009 IBM Cognos Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20230831-0001**](https://security.netapp.com/advisory/ntap-20230831-0001/) | CVE-2023-38428 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230831-0003**](https://security.netapp.com/advisory/ntap-20230831-0003/) | CVE-2023-38430 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230831-0002**](https://security.netapp.com/advisory/ntap-20230831-0002/) | CVE-2023-38432 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230831-0011**](https://security.netapp.com/advisory/ntap-20230831-0011/) | CVE-2023-38633 GNOME Librsvg Vulnerability in NetApp Products | 2023-08-31 |
| [**NTAP-20230831-0012**](https://security.netapp.com/advisory/ntap-20230831-0012/) | CVE-2023-3896 Vim Vulnerability in NetApp Products | 2025-01-14 |
| [**NTAP-20230831-0013**](https://security.netapp.com/advisory/ntap-20230831-0013/) | CVE-2023-4009 MongoDB Vulnerability in NetApp Products | 2023-10-04 |
| [**NTAP-20230831-0007**](https://security.netapp.com/advisory/ntap-20230831-0007/) | July 2023 Node.js Vulnerabilities in NetApp Products | 2023-11-01 |
| [**NTAP-20230831-0005**](https://security.netapp.com/advisory/ntap-20230831-0005/) | July 2023 QEMU Vulnerabilities in NetApp Products | 2023-08-31 |
| [**NTAP-20230825-0001**](https://security.netapp.com/advisory/ntap-20230825-0001/) | August 2023 PHP Vulnerabilities in NetApp Products | 2023-09-11 |
| [**NTAP-20230825-0002**](https://security.netapp.com/advisory/ntap-20230825-0002/) | July 2023 Grub Vulnerabilities in NetApp Products | 2024-12-20 |
| [**NTAP-20230824-0013**](https://security.netapp.com/advisory/ntap-20230824-0013/) | CVE-2021-32256 GNU Binutils Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20230824-0009**](https://security.netapp.com/advisory/ntap-20230824-0009/) | CVE-2022-31693 VMware Tools Vulnerability in NetApp Products | 2023-08-24 |
| [**NTAP-20230824-0003**](https://security.netapp.com/advisory/ntap-20230824-0003/) | CVE-2023-23908 Intel Processor Vulnerability in NetApp Products | 2023-09-04 |
| [**NTAP-20230824-0006**](https://security.netapp.com/advisory/ntap-20230824-0006/) | CVE-2023-3268 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230824-0008**](https://security.netapp.com/advisory/ntap-20230824-0008/) | CVE-2023-33201 Bouncy Castle Vulnerability in NetApp Products | 2023-11-01 |
| [**NTAP-20230824-0005**](https://security.netapp.com/advisory/ntap-20230824-0005/) | CVE-2023-3338 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230824-0007**](https://security.netapp.com/advisory/ntap-20230824-0007/) | CVE-2023-35001 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230824-0012**](https://security.netapp.com/advisory/ntap-20230824-0012/) | CVE-2023-3618 LibTIFF Vulnerability in NetApp Products | 2023-08-24 |
| [**NTAP-20230824-0010**](https://security.netapp.com/advisory/ntap-20230824-0010/) | CVE-2023-38325 Python Vulnerability in NetApp Products | 2023-12-20 |
| [**NTAP-20230824-0002**](https://security.netapp.com/advisory/ntap-20230824-0002/) | Intel SA-00783 CSME Vulnerabilities in NetApp Products | 2023-08-24 |
| [**NTAP-20230824-0001**](https://security.netapp.com/advisory/ntap-20230824-0001/) | Intel SA-00813 BIOS Firmware Vulnerabilities in NetApp Products | 2023-08-24 |
| [**NTAP-20230824-0011**](https://security.netapp.com/advisory/ntap-20230824-0011/) | July 2023 Linux Kernel 6.3.7 Vulnerabilities in NetApp Products | 2024-10-18 |
| [**NTAP-20230824-0004**](https://security.netapp.com/advisory/ntap-20230824-0004/) | July 2023 Linux Kernel 6.4 Vulnerabilities in NetApp Products | 2024-10-18 |
| [**NTAP-20230818-0001**](https://security.netapp.com/advisory/ntap-20230818-0001/) | CVE-2019-12402 Apache Commons Compress Vulnerability in NetApp Products | 2023-08-18 |
| [**NTAP-20230818-0007**](https://security.netapp.com/advisory/ntap-20230818-0007/) | CVE-2020-10650 FasterXML jackson-databind Vulnerability in NetApp Products | 2024-01-24 |
| [**NTAP-20230818-0010**](https://security.netapp.com/advisory/ntap-20230818-0010/) | CVE-2021-23463 H2 Database Vulnerability in NetApp Products | 2023-11-15 |
| [**NTAP-20230818-0002**](https://security.netapp.com/advisory/ntap-20230818-0002/) | CVE-2021-40690 Apache XML Security for Java Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20230818-0015**](https://security.netapp.com/advisory/ntap-20230818-0015/) | CVE-2022-1471 SnakeYAML Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20230818-0011**](https://security.netapp.com/advisory/ntap-20230818-0011/) | CVE-2022-23221 H2 Database Vulnerability in NetApp Products | 2023-11-01 |
| [**NTAP-20230818-0017**](https://security.netapp.com/advisory/ntap-20230818-0017/) | CVE-2023-27558 IBM Db2 Vulnerability in NetApp Products | 2023-08-22 |
| [**NTAP-20230818-0008**](https://security.netapp.com/advisory/ntap-20230818-0008/) | CVE-2023-2976 Guava Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20230818-0006**](https://security.netapp.com/advisory/ntap-20230818-0006/) | CVE-2023-30861 Flask Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20230818-0004**](https://security.netapp.com/advisory/ntap-20230818-0004/) | CVE-2023-3390 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230818-0009**](https://security.netapp.com/advisory/ntap-20230818-0009/) | CVE-2023-34455 Apache Kafka Vulnerability in NetApp Products | 2024-11-22 |
| [**NTAP-20230818-0013**](https://security.netapp.com/advisory/ntap-20230818-0013/) | CVE-2023-35012 IBM Db2 Vulnerability in NetApp Products | 2023-08-22 |
| [**NTAP-20230818-0014**](https://security.netapp.com/advisory/ntap-20230818-0014/) | CVE-2023-3817 OpenSSL Vulnerability in NetApp Products | 2024-12-20 |
| [**NTAP-20230818-0016**](https://security.netapp.com/advisory/ntap-20230818-0016/) | CVE-2023-38403 iperf3 Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20230818-0003**](https://security.netapp.com/advisory/ntap-20230818-0003/) | February 2023 Werkzeug Vulnerabilities in NetApp Products | 2023-08-18 |
| [**NTAP-20230818-0012**](https://security.netapp.com/advisory/ntap-20230818-0012/) | July 2023 JetBrains Kotlin Vulnerabilities in NetApp Products | 2023-11-15 |
| [**NTAP-20230818-0005**](https://security.netapp.com/advisory/ntap-20230818-0005/) | July 2023 Linux Kernel 6.3 Vulnerabilities in NetApp Products | 2024-10-22 |
| [**NTAP-20230814-0007**](https://security.netapp.com/advisory/ntap-20230814-0007/) | CVE-2021-31294 Redis Vulnerability in NetApp Products | 2023-11-07 |
| [**NTAP-20230814-0006**](https://security.netapp.com/advisory/ntap-20230814-0006/) | CVE-2022-24834 Redis Vulnerability in NetApp Products | 2023-10-09 |
| [**NTAP-20230814-0003**](https://security.netapp.com/advisory/ntap-20230814-0003/) | CVE-2023-2878 Kubernetes Vulnerability in NetApp Products | 2023-10-04 |
| [**NTAP-20230814-0001**](https://security.netapp.com/advisory/ntap-20230814-0001/) | CVE-2023-28953 IBM Cognos Vulnerability in NetApp Products | 2023-08-14 |
| [**NTAP-20230814-0002**](https://security.netapp.com/advisory/ntap-20230814-0002/) | CVE-2023-29406 Golang Vulnerability in NetApp Products | 2024-01-16 |
| [**NTAP-20230814-0008**](https://security.netapp.com/advisory/ntap-20230814-0008/) | CVE-2023-34034 Spring Security Vulnerability in NetApp Products | 2023-10-03 |
| [**NTAP-20230814-0009**](https://security.netapp.com/advisory/ntap-20230814-0009/) | CVE-2023-36824 Redis Vulnerability in NetApp Products | 2023-10-10 |
| [**NTAP-20230814-0005**](https://security.netapp.com/advisory/ntap-20230814-0005/) | July 2023 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2024-03-11 |
| [**NTAP-20230814-0004**](https://security.netapp.com/advisory/ntap-20230814-0004/) | July 2023 MegaRAC BMC Firmware Vulnerabilities in NetApp Products | 2024-10-18 |
| [**NTAP-20230811-0001**](https://security.netapp.com/advisory/ntap-20230811-0001/) | CVE-2022-40982 Intel Processor Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20230804-0001**](https://security.netapp.com/advisory/ntap-20230804-0001/) | CVE-2023-3107 FreeBSD Vulnerability in NetApp Products | 2023-09-11 |
| [**NTAP-20230803-0008**](https://security.netapp.com/advisory/ntap-20230803-0008/) | CVE-2023-30586 Node.js Vulnerability in NetApp Products | 2024-01-24 |
| [**NTAP-20230803-0009**](https://security.netapp.com/advisory/ntap-20230803-0009/) | CVE-2023-30589 Node.js Vulnerability in NetApp Products | 2024-01-24 |
| [**NTAP-20230803-0005**](https://security.netapp.com/advisory/ntap-20230803-0005/) | CVE-2023-34457 Python Vulnerability in NetApp Products | 2023-11-15 |
| [**NTAP-20230803-0011**](https://security.netapp.com/advisory/ntap-20230803-0011/) | CVE-2023-3446 OpenSSL Vulnerability in NetApp Products | 2024-11-14 |
| [**NTAP-20230803-0001**](https://security.netapp.com/advisory/ntap-20230803-0001/) | CVE-2023-34462 Apache Netty Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20230803-0003**](https://security.netapp.com/advisory/ntap-20230803-0003/) | CVE-2023-35827 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230803-0007**](https://security.netapp.com/advisory/ntap-20230803-0007/) | CVE-2023-35947 Gradle Vulnerability in NetApp Products | 2023-11-15 |
| [**NTAP-20230803-0010**](https://security.netapp.com/advisory/ntap-20230803-0010/) | CVE-2023-38408 OpenSSH Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230803-0006**](https://security.netapp.com/advisory/ntap-20230803-0006/) | July 2023 IBM DB2 JDBC Driver Vulnerabilities in NetApp Products | 2023-08-03 |
| [**NTAP-20230803-0004**](https://security.netapp.com/advisory/ntap-20230803-0004/) | July 2023 Kubernetes Vulnerabilities in NetApp Products | 2023-10-04 |
| [**NTAP-20230803-0002**](https://security.netapp.com/advisory/ntap-20230803-0002/) | June 2023 Linux Kernel Vulnerabilities in NetApp Products | 2024-10-18 |
| [**NTAP-20230731-0009**](https://security.netapp.com/advisory/ntap-20230731-0009/) | CVE-2015-20109 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230731-0006**](https://security.netapp.com/advisory/ntap-20230731-0006/) | CVE-2023-1295 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230731-0004**](https://security.netapp.com/advisory/ntap-20230731-0004/) | CVE-2023-2908 LibTIFF Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20230731-0002**](https://security.netapp.com/advisory/ntap-20230731-0002/) | CVE-2023-3090 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230731-0005**](https://security.netapp.com/advisory/ntap-20230731-0005/) | CVE-2023-3312 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230731-0001**](https://security.netapp.com/advisory/ntap-20230731-0001/) | CVE-2023-3389 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230731-0003**](https://security.netapp.com/advisory/ntap-20230731-0003/) | CVE-2023-35946 Gradle Vulnerability in NetApp Products | 2024-02-08 |
| [**NTAP-20230731-0008**](https://security.netapp.com/advisory/ntap-20230731-0008/) | January 2023 MegaRAC BMC Firmware Vulnerabilities in NetApp Products | 2024-10-18 |
| [**NTAP-20230731-0007**](https://security.netapp.com/advisory/ntap-20230731-0007/) | July 2023 IBM DB2 Vulnerabilities in NetApp Products | 2023-08-03 |
| [**NTAP-20230731-0010**](https://security.netapp.com/advisory/ntap-20230731-0010/) | July 2023 Samba Vulnerabilities in NetApp Products | 2023-07-31 |
| [**NTAP-20230725-0003**](https://security.netapp.com/advisory/ntap-20230725-0003/) | CVE-2020-23064 jQuery Vulnerability in NetApp Products | 2024-01-16 |
| [**NTAP-20230725-0001**](https://security.netapp.com/advisory/ntap-20230725-0001/) | CVE-2023-20867 VMware Tools Vulnerability in NetApp Products | 2023-08-02 |
| [**NTAP-20230725-0004**](https://security.netapp.com/advisory/ntap-20230725-0004/) | CVE-2023-2975 OpenSSL Vulnerability in NetApp Products | 2024-11-05 |
| [**NTAP-20230725-0002**](https://security.netapp.com/advisory/ntap-20230725-0002/) | CVE-2023-36617 Ruby Vulnerability in NetApp Products | 2023-07-25 |
| [**NTAP-20230725-0006**](https://security.netapp.com/advisory/ntap-20230725-0006/) | July 2023 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20230725-0005**](https://security.netapp.com/advisory/ntap-20230725-0005/) | July 2023 MySQL Server Vulnerabilities in NetApp Products | 2024-05-17 |
| [**NTAP-20230714-0001**](https://security.netapp.com/advisory/ntap-20230714-0001/) | CVE-2023-0045 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230714-0004**](https://security.netapp.com/advisory/ntap-20230714-0004/) | CVE-2023-3128 Grafana Vulnerability in NetApp Products | 2023-07-14 |
| [**NTAP-20230714-0005**](https://security.netapp.com/advisory/ntap-20230714-0005/) | CVE-2023-3326 FreeBSD Vulnerability in NetApp Products | 2023-07-14 |
| [**NTAP-20230714-0003**](https://security.netapp.com/advisory/ntap-20230714-0003/) | CVE-2023-34981 Apache Tomcat Vulnerability in NetApp Products | 2023-07-14 |
| [**NTAP-20230714-0002**](https://security.netapp.com/advisory/ntap-20230714-0002/) | CVE-2023-35788 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230713-0001**](https://security.netapp.com/advisory/ntap-20230713-0001/) | CVE-2023-27312 Privilege Escalation Vulnerability in SnapCenter Plugin for VMware vSphere | 2023-07-13 |
| [**NTAP-20230713-0002**](https://security.netapp.com/advisory/ntap-20230713-0002/) | CVE-2023-27313 Privilege Escalation Vulnerability in SnapCenter | 2023-07-13 |
| [**NTAP-20230706-0007**](https://security.netapp.com/advisory/ntap-20230706-0007/) | CVE-2020-35525 SQLite Vulnerability in NetApp Products | 2024-01-24 |
| [**NTAP-20230706-0003**](https://security.netapp.com/advisory/ntap-20230706-0003/) | CVE-2020-36732 Node.js Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20230706-0008**](https://security.netapp.com/advisory/ntap-20230706-0008/) | CVE-2022-3515 Libksba Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20230706-0009**](https://security.netapp.com/advisory/ntap-20230706-0009/) | CVE-2023-26965 LibTIFF Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20230706-0001**](https://security.netapp.com/advisory/ntap-20230706-0001/) | CVE-2023-2700 Libvirt Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20230706-0004**](https://security.netapp.com/advisory/ntap-20230706-0004/) | CVE-2023-3141 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230706-0005**](https://security.netapp.com/advisory/ntap-20230706-0005/) | June 2023 Apache Struts Vulnerabilities in NetApp Products | 2023-07-07 |
| [**NTAP-20230706-0002**](https://security.netapp.com/advisory/ntap-20230706-0002/) | June 2023 Grafana Vulnerabilities in NetApp Products | 2023-07-06 |
| [**NTAP-20230706-0006**](https://security.netapp.com/advisory/ntap-20230706-0006/) | June 2023 PostgreSQL Vulnerabilities in NetApp Products | 2024-08-01 |
| [**NTAP-20230703-0003**](https://security.netapp.com/advisory/ntap-20230703-0003/) | CVE-2015-20108 Ruby Vulnerability in NetApp Products | 2023-10-03 |
| [**NTAP-20230703-0004**](https://security.netapp.com/advisory/ntap-20230703-0004/) | CVE-2022-48502 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230703-0008**](https://security.netapp.com/advisory/ntap-20230703-0008/) | CVE-2023-20883 Spring Boot Vulnerability in NetApp Products | 2023-08-08 |
| [**NTAP-20230703-0006**](https://security.netapp.com/advisory/ntap-20230703-0006/) | CVE-2023-2598 Linux Kernel Vulnerability in NetApp Products | 2024-10-18 |
| [**NTAP-20230703-0001**](https://security.netapp.com/advisory/ntap-20230703-0001/) | CVE-2023-2650 OpenSSL Vulnerability in NetApp Products | 2024-11-05 |
| [**NTAP-20230703-0009**](https://security.netapp.com/advisory/ntap-20230703-0009/) | CVE-2023-2731 Libtiff Vulnerability in NetApp Products | 2023-07-03 |
| [**NTAP-20230703-0005**](https://security.netapp.com/advisory/ntap-20230703-0005/) | CVE-2023-2953 OpenLDAP Vulnerability in NetApp Products | 2024-07-01 |
| [**NTAP-20230703-0007**](https://security.netapp.com/advisory/ntap-20230703-0007/) | CVE-2023-3111 Linux Kernel Vulnerability in NetApp Products | 2024-10-14 |
| [**NTAP-20230703-0010**](https://security.netapp.com/advisory/ntap-20230703-0010/) | June 2023 ISC BIND Vulnerabilities in NetApp Products | 2023-11-30 |
| [**NTAP-20230703-0002**](https://security.netapp.com/advisory/ntap-20230703-0002/) | May 2023 Libtiff Vulnerability in NetApp Products | 2023-07-03 |
| [**NTAP-20230622-0009**](https://security.netapp.com/advisory/ntap-20230622-0009/) | CVE-2018-3745 Node.js Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20230622-0005**](https://security.netapp.com/advisory/ntap-20230622-0005/) | CVE-2020-36694 Linux Kernel Vulnerability in NetApp Products | 2023-09-18 |
| [**NTAP-20230622-0003**](https://security.netapp.com/advisory/ntap-20230622-0003/) | CVE-2021-39036 IBM Cognos Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20230622-0008**](https://security.netapp.com/advisory/ntap-20230622-0008/) | CVE-2022-25881 HTTP-Cache-Semantics Vulnerability in NetApp Products | 2024-05-20 |
| [**NTAP-20230622-0010**](https://security.netapp.com/advisory/ntap-20230622-0010/) | CVE-2023-2124 Linux Kernel Vulnerability in NetApp Products | 2023-09-18 |
| [**NTAP-20230622-0001**](https://security.netapp.com/advisory/ntap-20230622-0001/) | CVE-2023-2156 Linux Kernel Vulnerability in NetApp Products | 2024-05-20 |
| [**NTAP-20230622-0004**](https://security.netapp.com/advisory/ntap-20230622-0004/) | CVE-2023-28410 Intel Graphics Drivers Vulnerability in NetApp Products | 2023-06-22 |
| [**NTAP-20230622-0002**](https://security.netapp.com/advisory/ntap-20230622-0002/) | CVE-2023-31125 Node.js Vulnerability in NetApp Products | 2023-06-22 |
| [**NTAP-20230622-0006**](https://security.netapp.com/advisory/ntap-20230622-0006/) | CVE-2023-33250 Linux Kernel Vulnerability in NetApp Products | 2023-07-03 |
| [**NTAP-20230622-0007**](https://security.netapp.com/advisory/ntap-20230622-0007/) | May 2023 Node.js Vulnerabilities in NetApp Products | 2023-07-12 |
| [**NTAP-20230616-0001**](https://security.netapp.com/advisory/ntap-20230616-0001/) | CVE-2022-40540 Linux Kernel Vulnerability in NetApp Products | 2023-07-07 |
| [**NTAP-20230616-0004**](https://security.netapp.com/advisory/ntap-20230616-0004/) | CVE-2023-28709 Apache Tomcat Vulnerability in NetApp Products | 2023-10-03 |
| [**NTAP-20230616-0003**](https://security.netapp.com/advisory/ntap-20230616-0003/) | CVE-2023-30086 Libtiff Vulnerability in NetApp Products | 2023-06-16 |
| [**NTAP-20230616-0005**](https://security.netapp.com/advisory/ntap-20230616-0005/) | CVE-2023-31655 Redis Vulnerability in NetApp Products | 2023-12-21 |
| [**NTAP-20230616-0002**](https://security.netapp.com/advisory/ntap-20230616-0002/) | CVE-2023-32233 Linux Kernel Vulnerability in NetApp Products | 2023-06-28 |
| [**NTAP-20230616-0006**](https://security.netapp.com/advisory/ntap-20230616-0006/) | CVE-2023-32305 PostgreSQL Vulnerability in NetApp Products | 2023-06-16 |
| [**NTAP-20230609-0010**](https://security.netapp.com/advisory/ntap-20230609-0010/) | CVE-2021-31239 SQLite Vulnerability in NetApp Products | 2023-12-20 |
| [**NTAP-20230609-0003**](https://security.netapp.com/advisory/ntap-20230609-0003/) | CVE-2023-1387 Grafana Vulnerability in NetApp Products | 2023-06-09 |
| [**NTAP-20230609-0004**](https://security.netapp.com/advisory/ntap-20230609-0004/) | CVE-2023-2006 Linux Kernel Vulnerability in NetApp Products | 2023-11-01 |
| [**NTAP-20230609-0005**](https://security.netapp.com/advisory/ntap-20230609-0005/) | CVE-2023-2176 Linux Kernel Vulnerability in NetApp Products | 2023-09-18 |
| [**NTAP-20230609-0007**](https://security.netapp.com/advisory/ntap-20230609-0007/) | CVE-2023-2197 HashiCorp Vault Vulnerability in NetApp Products | 2023-06-09 |
| [**NTAP-20230609-0002**](https://security.netapp.com/advisory/ntap-20230609-0002/) | CVE-2023-2235 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20230609-0008**](https://security.netapp.com/advisory/ntap-20230609-0008/) | CVE-2023-31047 Django Vulnerability in NetApp Products | 2023-06-09 |
| [**NTAP-20230609-0001**](https://security.netapp.com/advisory/ntap-20230609-0001/) | CVE-2023-31436 Linux Kernel Vulnerability in NetApp Products | 2023-09-18 |
| [**NTAP-20230609-0009**](https://security.netapp.com/advisory/ntap-20230609-0009/) | May 2023 cURL/libcURL Vulnerabilities in NetApp Products | 2024-06-03 |
| [**NTAP-20230609-0006**](https://security.netapp.com/advisory/ntap-20230609-0006/) | May 2023 NGINX Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20230601-0006**](https://security.netapp.com/advisory/ntap-20230601-0006/) | April 2023 Libxml2 Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20230601-0005**](https://security.netapp.com/advisory/ntap-20230601-0005/) | CVE-2022-21216 Intel Processor Vulnerability in NetApp Products | 2024-02-07 |
| [**NTAP-20230601-0001**](https://security.netapp.com/advisory/ntap-20230601-0001/) | CVE-2023-1829 Linux Kernel Vulnerability in NetApp Products | 2023-06-06 |
| [**NTAP-20230601-0002**](https://security.netapp.com/advisory/ntap-20230601-0002/) | CVE-2023-1872 Linux Kernel Vulnerability in NetApp Products | 2023-06-06 |
| [**NTAP-20230601-0004**](https://security.netapp.com/advisory/ntap-20230601-0004/) | CVE-2023-1989 Linux Kernel Vulnerability in NetApp Products | 2023-08-01 |
| [**NTAP-20230601-0009**](https://security.netapp.com/advisory/ntap-20230601-0009/) | CVE-2023-20873 Spring Boot Vulnerability in NetApp Products | 2023-11-01 |
| [**NTAP-20230601-0010**](https://security.netapp.com/advisory/ntap-20230601-0010/) | CVE-2023-2236 Linux Kernel Vulnerability in NetApp Products | 2023-09-18 |
| [**NTAP-20230601-0003**](https://security.netapp.com/advisory/ntap-20230601-0003/) | CVE-2023-27043 Python Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20230601-0007**](https://security.netapp.com/advisory/ntap-20230601-0007/) | CVE-2023-28856 Redis Vulnerability in NetApp Products | 2023-10-09 |
| [**NTAP-20230601-0008**](https://security.netapp.com/advisory/ntap-20230601-0008/) | CVE-2023-30846 Node.js Vulnerability in NetApp Products | 2023-09-18 |
| [**NTAP-20230526-0001**](https://security.netapp.com/advisory/ntap-20230526-0001/) | April 2023 Eclipse Jetty Vulnerabilities in NetApp Products | 2024-07-19 |
| [**NTAP-20230526-0007**](https://security.netapp.com/advisory/ntap-20230526-0007/) | April 2023 Golang Vulnerabilities in NetApp Products | 2024-01-16 |
| [**NTAP-20230526-0005**](https://security.netapp.com/advisory/ntap-20230526-0005/) | CVE-2020-24736 SQLite Vulnerability in NetApp Products | 2023-06-06 |
| [**NTAP-20230526-0009**](https://security.netapp.com/advisory/ntap-20230526-0009/) | CVE-2022-4744 Linux Kernel Vulnerability in NetApp Products | 2023-09-18 |
| [**NTAP-20230526-0010**](https://security.netapp.com/advisory/ntap-20230526-0010/) | CVE-2023-1670 Linux Kernel Vulnerability in NetApp Products | 2023-09-18 |
| [**NTAP-20230526-0002**](https://security.netapp.com/advisory/ntap-20230526-0002/) | CVE-2023-20862 Spring Security Vulnerability in NetApp Products | 2023-11-01 |
| [**NTAP-20230526-0003**](https://security.netapp.com/advisory/ntap-20230526-0003/) | CVE-2023-28755 Ruby Vulnerability in NetApp Products | 2023-11-15 |
| [**NTAP-20230526-0004**](https://security.netapp.com/advisory/ntap-20230526-0004/) | CVE-2023-28756 Ruby Vulnerability in NetApp Products | 2023-11-15 |
| [**NTAP-20230526-0006**](https://security.netapp.com/advisory/ntap-20230526-0006/) | CVE-2023-29323 OpenBSD Vulnerability in NetApp Products | 2023-05-26 |
| [**NTAP-20230526-0008**](https://security.netapp.com/advisory/ntap-20230526-0008/) | March 2023 Hashicorp Vault Vulnerabilities in NetApp Products | 2023-05-26 |
| [**NTAP-20230525-0001**](https://security.netapp.com/advisory/ntap-20230525-0001/) | CVE-2023-27311 Information Disclosure Vulnerability in NetApp BlueXP Connector | 2023-05-25 |
| [**NTAP-20230517-0006**](https://security.netapp.com/advisory/ntap-20230517-0006/) | CVE-2021-46880 LibreSSL Vulnerability in NetApp Products | 2023-09-11 |
| [**NTAP-20230517-0002**](https://security.netapp.com/advisory/ntap-20230517-0002/) | CVE-2023-0210 Linux Kernel Vulnerability in NetApp Products | 2023-06-06 |
| [**NTAP-20230517-0005**](https://security.netapp.com/advisory/ntap-20230517-0005/) | CVE-2023-0664 QEMU Vulnerability in NetApp Products | 2023-05-17 |
| [**NTAP-20230517-0003**](https://security.netapp.com/advisory/ntap-20230517-0003/) | CVE-2023-1838 Linux Kernel Vulnerability in NetApp Products | 2023-06-06 |
| [**NTAP-20230517-0007**](https://security.netapp.com/advisory/ntap-20230517-0007/) | CVE-2023-2008 Linux Kernel Vulnerability in NetApp Products | 2023-08-01 |
| [**NTAP-20230517-0010**](https://security.netapp.com/advisory/ntap-20230517-0010/) | CVE-2023-26463 strongSwan Vulnerability in NetApp Products | 2023-05-17 |
| [**NTAP-20230517-0004**](https://security.netapp.com/advisory/ntap-20230517-0004/) | CVE-2023-28464 Linux Kernel Vulnerability in NetApp Products | 2023-06-06 |
| [**NTAP-20230517-0008**](https://security.netapp.com/advisory/ntap-20230517-0008/) | CVE-2023-29013 Golang Vulnerability in NetApp Products | 2024-01-16 |
| [**NTAP-20230517-0009**](https://security.netapp.com/advisory/ntap-20230517-0009/) | CVE-2023-29491 GNU Ncurses Vulnerability in NetApp Products | 2023-11-15 |
| [**NTAP-20230517-0001**](https://security.netapp.com/advisory/ntap-20230517-0001/) | February 2023 PHP Vulnerabilities in NetApp Products | 2023-09-05 |
| [**NTAP-20230511-0010**](https://security.netapp.com/advisory/ntap-20230511-0010/) | April 2023 IBM DB2 Vulnerabilities in NetApp Products | 2023-05-11 |
| [**NTAP-20230511-0004**](https://security.netapp.com/advisory/ntap-20230511-0004/) | CVE-2022-3162 Kubernetes Vulnerability in NetApp Products | 2024-03-15 |
| [**NTAP-20230511-0003**](https://security.netapp.com/advisory/ntap-20230511-0003/) | CVE-2023-0179 Linux Kernel Vulnerability in NetApp Products | 2023-05-16 |
| [**NTAP-20230511-0002**](https://security.netapp.com/advisory/ntap-20230511-0002/) | CVE-2023-1077 Linux Kernel Vulnerability in NetApp Products | 2024-09-05 |
| [**NTAP-20230511-0011**](https://security.netapp.com/advisory/ntap-20230511-0011/) | CVE-2023-1096 Authentication Bypass Vulnerability in SnapCenter | 2023-05-11 |
| [**NTAP-20230511-0001**](https://security.netapp.com/advisory/ntap-20230511-0001/) | CVE-2023-1380 Linux Kernel Vulnerability in NetApp Products | 2023-05-11 |
| [**NTAP-20230511-0005**](https://security.netapp.com/advisory/ntap-20230511-0005/) | CVE-2023-1544 QEMU Vulnerability in NetApp Products | 2023-05-11 |
| [**NTAP-20230511-0008**](https://security.netapp.com/advisory/ntap-20230511-0008/) | CVE-2023-1550 NGINX Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20230511-0009**](https://security.netapp.com/advisory/ntap-20230511-0009/) | CVE-2023-1579 GNU Binutils Vulnerability in NetApp Products | 2024-04-05 |
| [**NTAP-20230511-0006**](https://security.netapp.com/advisory/ntap-20230511-0006/) | CVE-2023-1652 Linux Kernel Vulnerability in NetApp Products | 2023-06-06 |
| [**NTAP-20230511-0007**](https://security.netapp.com/advisory/ntap-20230511-0007/) | CVE-2023-30456 Linux Kernel Vulnerability in NetApp Products | 2023-06-06 |
| [**NTAP-20230505-0010**](https://security.netapp.com/advisory/ntap-20230505-0010/) | CVE-2022-3116 Heimdal Vulnerability in NetApp Products | 2024-01-16 |
| [**NTAP-20230505-0007**](https://security.netapp.com/advisory/ntap-20230505-0007/) | CVE-2022-3294 Kubernetes Vulnerability in NetApp Products | 2023-05-05 |
| [**NTAP-20230505-0003**](https://security.netapp.com/advisory/ntap-20230505-0003/) | CVE-2022-48423 Linux Kernel Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230505-0002**](https://security.netapp.com/advisory/ntap-20230505-0002/) | CVE-2022-48424 Linux Kernel Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230505-0004**](https://security.netapp.com/advisory/ntap-20230505-0004/) | CVE-2023-1078 Linux Kernel Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230505-0005**](https://security.netapp.com/advisory/ntap-20230505-0005/) | CVE-2023-1252 Linux Kernel Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230505-0006**](https://security.netapp.com/advisory/ntap-20230505-0006/) | CVE-2023-20860 Spring Framework Vulnerability in NetApp Products | 2023-11-01 |
| [**NTAP-20230505-0001**](https://security.netapp.com/advisory/ntap-20230505-0001/) | CVE-2023-24999 HashiCorp Vault Vulnerability in NetApp Products | 2023-05-05 |
| [**NTAP-20230505-0008**](https://security.netapp.com/advisory/ntap-20230505-0008/) | CVE-2023-26464 Apache Log4j Vulnerability in NetApp Products | 2023-05-26 |
| [**NTAP-20230505-0009**](https://security.netapp.com/advisory/ntap-20230505-0009/) | CVE-2023-26604 Systemd Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20230427-0008**](https://security.netapp.com/advisory/ntap-20230427-0008/) | April 2023 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2024-12-06 |
| [**NTAP-20230427-0007**](https://security.netapp.com/advisory/ntap-20230427-0007/) | April 2023 MySQL Server Vulnerabilities in NetApp Products | 2024-05-17 |
| [**NTAP-20230427-0012**](https://security.netapp.com/advisory/ntap-20230427-0012/) | CVE-2021-39537 GNU Ncurses Vulnerability in NetApp Products | 2024-02-23 |
| [**NTAP-20230427-0011**](https://security.netapp.com/advisory/ntap-20230427-0011/) | CVE-2022-0812 Linux Kernel Vulnerability in NetApp Products | 2023-08-08 |
| [**NTAP-20230427-0002**](https://security.netapp.com/advisory/ntap-20230427-0002/) | CVE-2022-41862 PostgreSQL Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230427-0009**](https://security.netapp.com/advisory/ntap-20230427-0009/) | CVE-2023-0215 MySQL Connector/ODBC Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20230427-0001**](https://security.netapp.com/advisory/ntap-20230427-0001/) | CVE-2023-0482 RESTEasy Vulnerability in NetApp Products | 2023-05-16 |
| [**NTAP-20230427-0004**](https://security.netapp.com/advisory/ntap-20230427-0004/) | CVE-2023-1281 Linux Kernel Vulnerability in NetApp Products | 2023-05-16 |
| [**NTAP-20230427-0010**](https://security.netapp.com/advisory/ntap-20230427-0010/) | CVE-2023-21971 MySQL Connector/J Vulnerability in NetApp Products | 2024-05-20 |
| [**NTAP-20230427-0003**](https://security.netapp.com/advisory/ntap-20230427-0003/) | CVE-2023-27475 Golang Vulnerability in NetApp Products | 2023-05-12 |
| [**NTAP-20230427-0006**](https://security.netapp.com/advisory/ntap-20230427-0006/) | CVE-2023-28466 Linux Kernel Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230427-0005**](https://security.netapp.com/advisory/ntap-20230427-0005/) | CVE-2023-28772 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20230426-0001**](https://security.netapp.com/advisory/ntap-20230426-0001/) | CVE-2023-29552 Service Location Protocol Vulnerability in NetApp Products | 2023-04-27 |
| [**NTAP-20230420-0009**](https://security.netapp.com/advisory/ntap-20230420-0009/) | CVE-2016-1000027 Spring Framework Vulnerability in NetApp Products | 2023-11-01 |
| [**NTAP-20230420-0008**](https://security.netapp.com/advisory/ntap-20230420-0008/) | CVE-2022-2097 MySQL Server Vulnerability in NetApp Products | 2024-02-21 |
| [**NTAP-20230420-0005**](https://security.netapp.com/advisory/ntap-20230420-0005/) | CVE-2022-4095 Linux Kernel Vulnerability in NetApp Products | 2023-05-05 |
| [**NTAP-20230420-0004**](https://security.netapp.com/advisory/ntap-20230420-0004/) | CVE-2023-0386 Linux Kernel Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230420-0001**](https://security.netapp.com/advisory/ntap-20230420-0001/) | CVE-2023-1390 Linux Kernel Vulnerability in NetApp Products | 2023-05-26 |
| [**NTAP-20230420-0003**](https://security.netapp.com/advisory/ntap-20230420-0003/) | CVE-2023-1410 Grafana Vulnerability in NetApp Products | 2023-04-20 |
| [**NTAP-20230420-0007**](https://security.netapp.com/advisory/ntap-20230420-0007/) | CVE-2023-20861 Spring Framework Vulnerability in NetApp Products | 2023-12-08 |
| [**NTAP-20230420-0006**](https://security.netapp.com/advisory/ntap-20230420-0006/) | CVE-2023-27490 Node.js Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230420-0011**](https://security.netapp.com/advisory/ntap-20230420-0011/) | CVE-2023-27533 cURL/libcURL Vulnerability in NetApp Products | 2024-05-20 |
| [**NTAP-20230420-0012**](https://security.netapp.com/advisory/ntap-20230420-0012/) | CVE-2023-27534 cURL/libcURL Vulnerability in NetApp Products | 2024-05-20 |
| [**NTAP-20230420-0010**](https://security.netapp.com/advisory/ntap-20230420-0010/) | March 2023 cURL/libcURL Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20230420-0002**](https://security.netapp.com/advisory/ntap-20230420-0002/) | March 2023 Sudo Vulnerabilities in NetApp Products | 2023-05-22 |
| [**NTAP-20230414-0001**](https://security.netapp.com/advisory/ntap-20230414-0001/) | March 2023 OpenSSL Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20230413-0006**](https://security.netapp.com/advisory/ntap-20230413-0006/) | CVE-2022-48425 Linux Kernel Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230413-0010**](https://security.netapp.com/advisory/ntap-20230413-0010/) | CVE-2023-0030 Linux Kernel Vulnerability in NetApp Products | 2023-05-16 |
| [**NTAP-20230413-0001**](https://security.netapp.com/advisory/ntap-20230413-0001/) | CVE-2023-0507 Grafana Vulnerability in NetApp Products | 2023-04-13 |
| [**NTAP-20230413-0003**](https://security.netapp.com/advisory/ntap-20230413-0003/) | CVE-2023-1118 Linux Kernel Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230413-0004**](https://security.netapp.com/advisory/ntap-20230413-0004/) | CVE-2023-22462 Grafana Vulnerability in NetApp Products | 2023-04-13 |
| [**NTAP-20230413-0002**](https://security.netapp.com/advisory/ntap-20230413-0002/) | CVE-2023-26053 Gradle Vulnerability in NetApp Products | 2023-10-03 |
| [**NTAP-20230413-0009**](https://security.netapp.com/advisory/ntap-20230413-0009/) | CVE-2023-27320 Sudo Vulnerability in NetApp Products | 2023-08-22 |
| [**NTAP-20230413-0007**](https://security.netapp.com/advisory/ntap-20230413-0007/) | CVE-2023-28155 Node.js Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230413-0005**](https://security.netapp.com/advisory/ntap-20230413-0005/) | CVE-2023-28425 Redis Vulnerability in NetApp Products | 2023-05-16 |
| [**NTAP-20230413-0008**](https://security.netapp.com/advisory/ntap-20230413-0008/) | CVE-2023-28531 OpenSSH Vulnerability in NetApp Products | 2023-05-16 |
| [**NTAP-20230406-0003**](https://security.netapp.com/advisory/ntap-20230406-0003/) | CVE-2021-36713 jQuery Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20230406-0005**](https://security.netapp.com/advisory/ntap-20230406-0005/) | CVE-2022-3424 Linux Kernel Vulnerabilities in NetApp Products | 2023-04-20 |
| [**NTAP-20230406-0004**](https://security.netapp.com/advisory/ntap-20230406-0004/) | CVE-2022-3857 Libpng Vulnerability in NetApp Products | 2023-05-16 |
| [**NTAP-20230406-0006**](https://security.netapp.com/advisory/ntap-20230406-0006/) | CVE-2023-0464 OpenSSL Vulnerability in NetApp Products | 2024-11-05 |
| [**NTAP-20230406-0002**](https://security.netapp.com/advisory/ntap-20230406-0002/) | CVE-2023-26242 Linux Kernel Vulnerability in NetApp Products | 2023-04-20 |
| [**NTAP-20230406-0001**](https://security.netapp.com/advisory/ntap-20230406-0001/) | CVE-2023-27567 OpenBSD Vulnerability in NetApp Products | 2023-07-07 |
| [**NTAP-20230406-0007**](https://security.netapp.com/advisory/ntap-20230406-0007/) | March 2023 Samba Vulnerabilities in NetApp Products | 2023-04-06 |
| [**NTAP-20230331-0005**](https://security.netapp.com/advisory/ntap-20230331-0005/) | CVE-2021-20251 Samba Vulnerability in NetApp Products | 2023-03-31 |
| [**NTAP-20230331-0010**](https://security.netapp.com/advisory/ntap-20230331-0010/) | CVE-2022-41723 Golang Vulnerability in NetApp Products | 2024-01-24 |
| [**NTAP-20230331-0001**](https://security.netapp.com/advisory/ntap-20230331-0001/) | CVE-2022-4645 LibTIFF Vulnerability in NetApp Products | 2023-03-31 |
| [**NTAP-20230331-0006**](https://security.netapp.com/advisory/ntap-20230331-0006/) | CVE-2023-0461 Linux Kernel Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230331-0008**](https://security.netapp.com/advisory/ntap-20230331-0008/) | CVE-2023-0567 PHP Vulnerabilities in NetApp Products | 2023-05-18 |
| [**NTAP-20230331-0007**](https://security.netapp.com/advisory/ntap-20230331-0007/) | CVE-2023-0594 Grafana Vulnerability in NetApp Products | 2023-03-31 |
| [**NTAP-20230331-0003**](https://security.netapp.com/advisory/ntap-20230331-0003/) | CVE-2023-23003 Linux Kernel Vulnerability in NetApp Products | 2023-10-04 |
| [**NTAP-20230331-0011**](https://security.netapp.com/advisory/ntap-20230331-0011/) | CVE-2023-24532 Golang Vulnerability in NetApp Products | 2024-01-24 |
| [**NTAP-20230331-0012**](https://security.netapp.com/advisory/ntap-20230331-0012/) | CVE-2023-28708 Apache Tomcat Vulnerability in NetApp Products | 2023-06-27 |
| [**NTAP-20230331-0009**](https://security.netapp.com/advisory/ntap-20230331-0009/) | February 2023 Golang Vulnerabilities in NetApp Products | 2023-12-20 |
| [**NTAP-20230331-0004**](https://security.netapp.com/advisory/ntap-20230331-0004/) | Februray 2023 Linux Kernel 5.16 Vulnerabilities in NetApp Products | 2023-05-16 |
| [**NTAP-20230331-0002**](https://security.netapp.com/advisory/ntap-20230331-0002/) | March 2023 Redis Vulnerabilities in NetApp Products | 2023-04-04 |
| [**NTAP-20230324-0006**](https://security.netapp.com/advisory/ntap-20230324-0006/) | CVE-2020-12403 Libnss Vulnerability in NetApp Products | 2023-03-24 |
| [**NTAP-20230324-0001**](https://security.netapp.com/advisory/ntap-20230324-0001/) | CVE-2022-3219 GnuPG Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20230324-0002**](https://security.netapp.com/advisory/ntap-20230324-0002/) | CVE-2022-4492 Undertow Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20230324-0003**](https://security.netapp.com/advisory/ntap-20230324-0003/) | CVE-2022-48282 MongoDB Vulnerability in NetApp Products | 2023-03-24 |
| [**NTAP-20230324-0005**](https://security.netapp.com/advisory/ntap-20230324-0005/) | CVE-2023-0361 GNU TLS Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20230324-0008**](https://security.netapp.com/advisory/ntap-20230324-0008/) | CVE-2023-0767 Libnss Vulnerability in NetApp Products | 2023-11-30 |
| [**NTAP-20230324-0009**](https://security.netapp.com/advisory/ntap-20230324-0009/) | CVE-2023-0804 LibTIFF Vulnerabilities in NetApp Products | 2023-03-28 |
| [**NTAP-20230324-0007**](https://security.netapp.com/advisory/ntap-20230324-0007/) | CVE-2023-23931 Cryptography Project Vulnerability in NetApp Products | 2023-12-14 |
| [**NTAP-20230324-0004**](https://security.netapp.com/advisory/ntap-20230324-0004/) | CVE-2023-24329 Python Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20230324-0010**](https://security.netapp.com/advisory/ntap-20230324-0010/) | CVE-2023-24807 Node.js Vulnerability in NetApp Products | 2023-04-20 |
| [**NTAP-20230316-0005**](https://security.netapp.com/advisory/ntap-20230316-0005/) | CVE-2006-20001 Apache HTTP Server Vulnerability in NetApp Products | 2023-04-20 |
| [**NTAP-20230316-0011**](https://security.netapp.com/advisory/ntap-20230316-0011/) | CVE-2022-47629 Libksba Vulnerability in NetApp Products | 2024-05-15 |
| [**NTAP-20230316-0001**](https://security.netapp.com/advisory/ntap-20230316-0001/) | CVE-2023-0240 Linux Kernel Vulnerability in NetApp Products | 2023-04-20 |
| [**NTAP-20230316-0004**](https://security.netapp.com/advisory/ntap-20230316-0004/) | CVE-2023-0751 FreeBSD Vulnerability in NetApp Products | 2023-03-16 |
| [**NTAP-20230316-0006**](https://security.netapp.com/advisory/ntap-20230316-0006/) | CVE-2023-24580 Django Vulnerability in NetApp Products | 2023-03-16 |
| [**NTAP-20230316-0009**](https://security.netapp.com/advisory/ntap-20230316-0009/) | CVE-2023-26545 Linux Kernel Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20230316-0002**](https://security.netapp.com/advisory/ntap-20230316-0002/) | February 2023 LibTIFF Vulnerabilities in NetApp Products | 2023-03-16 |
| [**NTAP-20230316-0010**](https://security.netapp.com/advisory/ntap-20230316-0010/) | February 2023 Linux Kernel 6.0.8 Vulnerabilities in NetApp Products | 2023-05-16 |
| [**NTAP-20230316-0008**](https://security.netapp.com/advisory/ntap-20230316-0008/) | February 2023 Node.js Vulnerabilities in NetApp Products | 2023-05-19 |
| [**NTAP-20230316-0007**](https://security.netapp.com/advisory/ntap-20230316-0007/) | March 2023 Apache HTTP Server Vulnerabilities in NetApp Products | 2023-09-19 |
| [**NTAP-20230316-0003**](https://security.netapp.com/advisory/ntap-20230316-0003/) | March 2023 LibTIFF Vulnerabilities in NetApp Products | 2023-03-16 |
| [**NTAP-20230314-0001**](https://security.netapp.com/advisory/ntap-20230314-0001/) | March 2023 Trusted Platform Module 2.0 Vulnerabilities in NetApp Products | 2023-03-14 |
| [**NTAP-20230309-0002**](https://security.netapp.com/advisory/ntap-20230309-0002/) | CVE-2018-1000802 Python Vulnerability in NetApp Products | 2023-09-11 |
| [**NTAP-20230309-0007**](https://security.netapp.com/advisory/ntap-20230309-0007/) | CVE-2022-23498 Grafana Vulnerability in NetApp Products | 2023-03-09 |
| [**NTAP-20230309-0001**](https://security.netapp.com/advisory/ntap-20230309-0001/) | CVE-2022-27536 Golang Vulnerability in NetApp Products | 2023-05-12 |
| [**NTAP-20230309-0008**](https://security.netapp.com/advisory/ntap-20230309-0008/) | CVE-2022-37708 Docker Vulnerability in NetApp Products | 2023-05-24 |
| [**NTAP-20230309-0010**](https://security.netapp.com/advisory/ntap-20230309-0010/) | CVE-2022-39324 Grafana Vulnerability in NetApp Products | 2023-03-09 |
| [**NTAP-20230309-0004**](https://security.netapp.com/advisory/ntap-20230309-0004/) | CVE-2022-4139 Linux Kernel Vulnerability in NetApp Products | 2023-05-16 |
| [**NTAP-20230309-0009**](https://security.netapp.com/advisory/ntap-20230309-0009/) | CVE-2022-47015 MariaDB Vulnerability in NetApp Products | 2023-03-09 |
| [**NTAP-20230309-0005**](https://security.netapp.com/advisory/ntap-20230309-0005/) | CVE-2023-22474 Node.js Vulnerability in NetApp Products | 2023-03-14 |
| [**NTAP-20230309-0003**](https://security.netapp.com/advisory/ntap-20230309-0003/) | CVE-2023-25136 OpenSSH Vulnerability in NetApp Products | 2024-11-05 |
| [**NTAP-20230309-0006**](https://security.netapp.com/advisory/ntap-20230309-0006/) | February 2023 cURL/libcURL Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20230302-0008**](https://security.netapp.com/advisory/ntap-20230302-0008/) | CVE-2022-23552 Grafana Vulnerability in NetApp Products | 2023-03-02 |
| [**NTAP-20230302-0012**](https://security.netapp.com/advisory/ntap-20230302-0012/) | CVE-2022-33972 Intel Processor Vulnerability in NetApp Products | 2024-01-16 |
| [**NTAP-20230302-0004**](https://security.netapp.com/advisory/ntap-20230302-0004/) | CVE-2022-48281 LibTIFF Vulnerability in NetApp Products | 2023-03-02 |
| [**NTAP-20230302-0002**](https://security.netapp.com/advisory/ntap-20230302-0002/) | CVE-2023-0122 Linux Kernel Vulnerability in NetApp Products | 2023-03-13 |
| [**NTAP-20230302-0001**](https://security.netapp.com/advisory/ntap-20230302-0001/) | CVE-2023-22602 Apache Shiro Vulnerability in NetApp Products | 2023-03-02 |
| [**NTAP-20230302-0003**](https://security.netapp.com/advisory/ntap-20230302-0003/) | CVE-2023-23559 Linux Kernel Vulnerability in NetApp Products | 2023-03-13 |
| [**NTAP-20230302-0007**](https://security.netapp.com/advisory/ntap-20230302-0007/) | CVE-2023-23969 Django Vulnerability in NetApp Products | 2023-03-02 |
| [**NTAP-20230302-0013**](https://security.netapp.com/advisory/ntap-20230302-0013/) | CVE-2023-24998 Apache Commons FileUpload Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20230302-0010**](https://security.netapp.com/advisory/ntap-20230302-0010/) | CVE-2023-25139 GNU C Library (glibc) Vulnerability in NetApp Products | 2023-10-24 |
| [**NTAP-20230302-0009**](https://security.netapp.com/advisory/ntap-20230302-0009/) | February 2023 IBM DB2 Vulnerabilities in NetApp Products | 2023-03-13 |
| [**NTAP-20230302-0011**](https://security.netapp.com/advisory/ntap-20230302-0011/) | Intel SA-00717 BIOS Firmware Vulnerabilities in NetApp Products | 2024-01-16 |
| [**NTAP-20230302-0005**](https://security.netapp.com/advisory/ntap-20230302-0005/) | January 2023 Linux Kernel 6.1 Vulnerabilities in NetApp Products | 2024-07-30 |
| [**NTAP-20230302-0006**](https://security.netapp.com/advisory/ntap-20230302-0006/) | January 2023 Redis Vulnerabilities in NetApp Products | 2023-03-28 |
| [**NTAP-20230228-0001**](https://security.netapp.com/advisory/ntap-20230228-0001/) | CVE-2022-38734 Denial of Service Vulnerability in StorageGRID (formerly StorageGRID Webscale) | 2023-02-28 |
| [**NTAP-20230223-0008**](https://security.netapp.com/advisory/ntap-20230223-0008/) | CVE-2018-14628 Samba Vulnerability in NetApp Products | 2024-05-20 |
| [**NTAP-20230223-0002**](https://security.netapp.com/advisory/ntap-20230223-0002/) | CVE-2022-2196 Linux Kernel Vulnerability in NetApp Products | 2023-03-13 |
| [**NTAP-20230223-0010**](https://security.netapp.com/advisory/ntap-20230223-0010/) | CVE-2022-23491 Python-Certifi Vulnerability in NetApp Products | 2024-01-16 |
| [**NTAP-20230223-0007**](https://security.netapp.com/advisory/ntap-20230223-0007/) | CVE-2022-31631 PHP Vulnerability in NetApp Products | 2023-02-23 |
| [**NTAP-20230223-0005**](https://security.netapp.com/advisory/ntap-20230223-0005/) | CVE-2022-3977 Linux Kernel Vulnerability in NetApp Products | 2023-03-14 |
| [**NTAP-20230223-0006**](https://security.netapp.com/advisory/ntap-20230223-0006/) | CVE-2022-41858 Linux Kernel Vulnerability in NetApp Products | 2023-03-14 |
| [**NTAP-20230223-0001**](https://security.netapp.com/advisory/ntap-20230223-0001/) | CVE-2022-42898 MIT Kerberos 5 Vulnerability in NetApp Products | 2024-08-30 |
| [**NTAP-20230223-0004**](https://security.netapp.com/advisory/ntap-20230223-0004/) | CVE-2022-4379 Linux Kernel Vulnerability in NetApp Products | 2024-05-20 |
| [**NTAP-20230223-0003**](https://security.netapp.com/advisory/ntap-20230223-0003/) | CVE-2022-4696 Linux Kernel Vulnerability in NetApp Products | 2023-03-14 |
| [**NTAP-20230223-0009**](https://security.netapp.com/advisory/ntap-20230223-0009/) | January 2023 ISC BIND Vulnerabilities in NetApp Products | 2023-11-22 |
| [**NTAP-20230223-0011**](https://security.netapp.com/advisory/ntap-20230223-0011/) | November 2022 Net-SNMP Vulnerabilities in NetApp Products | 2023-08-21 |
| [**NTAP-20230216-0001**](https://security.netapp.com/advisory/ntap-20230216-0001/) | CVE-2017-1000158 Python Vulnerability in NetApp Products | 2023-04-20 |
| [**NTAP-20230216-0003**](https://security.netapp.com/advisory/ntap-20230216-0003/) | CVE-2022-3176 Linux Kernel Vulnerability in NetApp Products | 2023-03-14 |
| [**NTAP-20230216-0005**](https://security.netapp.com/advisory/ntap-20230216-0005/) | CVE-2022-41966 XStream Vulnerability in NetApp Products | 2023-02-16 |
| [**NTAP-20230216-0010**](https://security.netapp.com/advisory/ntap-20230216-0010/) | CVE-2022-4415 Systemd Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20230216-0009**](https://security.netapp.com/advisory/ntap-20230216-0009/) | CVE-2022-45143 Apache Tomcat Vulnerability in NetApp Products | 2023-05-22 |
| [**NTAP-20230216-0006**](https://security.netapp.com/advisory/ntap-20230216-0006/) | CVE-2022-47943 Linux Kernel Vulnerability in NetApp Products | 2023-03-14 |
| [**NTAP-20230216-0002**](https://security.netapp.com/advisory/ntap-20230216-0002/) | December 2015 PCRE Vulnerabilities in NetApp Products | 2023-05-01 |
| [**NTAP-20230216-0008**](https://security.netapp.com/advisory/ntap-20230216-0008/) | December 2022 Heimdal Vulnerabilities in NetApp Products | 2024-01-24 |
| [**NTAP-20230216-0004**](https://security.netapp.com/advisory/ntap-20230216-0004/) | December 2022 Squid Vulnerabilities in NetApp Products | 2023-02-16 |
| [**NTAP-20230216-0007**](https://security.netapp.com/advisory/ntap-20230216-0007/) | January 2023 Apache HTTP Server Vulnerabilities in NetApp Products | 2023-03-14 |
| [**NTAP-20230214-0003**](https://security.netapp.com/advisory/ntap-20230214-0003/) | August 2022 Linux Kernel 5.17 Vulnerabilities in NetApp Products | 2024-05-01 |
| [**NTAP-20230214-0005**](https://security.netapp.com/advisory/ntap-20230214-0005/) | August 2022 Linux Kernel 5.18 Vulnerabilities in NetApp Products | 2023-03-14 |
| [**NTAP-20230214-0004**](https://security.netapp.com/advisory/ntap-20230214-0004/) | August 2022 Linux Kernel 5.19 Vulnerabilities in NetApp Products | 2023-03-14 |
| [**NTAP-20230214-0010**](https://security.netapp.com/advisory/ntap-20230214-0010/) | CVE-2021-35065 Node.js Vulnerability in NetApp Products | 2023-03-14 |
| [**NTAP-20230214-0009**](https://security.netapp.com/advisory/ntap-20230214-0009/) | CVE-2022-3649 Linux Kernel Vulnerability in NetApp Products | 2023-03-08 |
| [**NTAP-20230214-0007**](https://security.netapp.com/advisory/ntap-20230214-0007/) | CVE-2022-39189 Linux Kernel Vulnerability in NetApp Products | 2023-03-13 |
| [**NTAP-20230214-0001**](https://security.netapp.com/advisory/ntap-20230214-0001/) | CVE-2022-40897 Python Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20230214-0008**](https://security.netapp.com/advisory/ntap-20230214-0008/) | CVE-2022-41222 Linux Kernel Vulnerability in NetApp Products | 2023-03-14 |
| [**NTAP-20230214-0002**](https://security.netapp.com/advisory/ntap-20230214-0002/) | December 2022 cURL/libcURL Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20230214-0011**](https://security.netapp.com/advisory/ntap-20230214-0011/) | February 2023 OpenSSL Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20230214-0006**](https://security.netapp.com/advisory/ntap-20230214-0006/) | September 2022 Linux Kernel 5.17 Vulnerabilities in NetApp Products | 2023-03-14 |
| [**NTAP-20230208-0001**](https://security.netapp.com/advisory/ntap-20230208-0001/) | January 2023 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2024-04-05 |
| [**NTAP-20230208-0002**](https://security.netapp.com/advisory/ntap-20230208-0002/) | January 2023 MySQL Server Vulnerabilities in NetApp Products | 2024-07-19 |
| [**NTAP-20230203-0009**](https://security.netapp.com/advisory/ntap-20230203-0009/) | CVE-2022-2327 Linux Kernel Vulnerability in NetApp Products | 2023-03-14 |
| [**NTAP-20230203-0004**](https://security.netapp.com/advisory/ntap-20230203-0004/) | CVE-2022-2601 Grub2 Vulnerability in NetApp Products | 2023-11-22 |
| [**NTAP-20230203-0006**](https://security.netapp.com/advisory/ntap-20230203-0006/) | CVE-2022-32149 Golang Text Vulnerability in NetApp Products | 2023-02-10 |
| [**NTAP-20230203-0002**](https://security.netapp.com/advisory/ntap-20230203-0002/) | CVE-2022-3570 LibTIFF Vulnerability in NetApp Products | 2023-02-03 |
| [**NTAP-20230203-0001**](https://security.netapp.com/advisory/ntap-20230203-0001/) | CVE-2022-37454 Keccak XKCP Vulnerability in NetApp Products | 2023-03-28 |
| [**NTAP-20230203-0003**](https://security.netapp.com/advisory/ntap-20230203-0003/) | CVE-2022-3996 OpenSSL Vulnerability in NetApp Products | 2024-11-14 |
| [**NTAP-20230203-0007**](https://security.netapp.com/advisory/ntap-20230203-0007/) | CVE-2022-4293 Vim Vulnerability in NetApp Products | 2023-02-03 |
| [**NTAP-20230203-0005**](https://security.netapp.com/advisory/ntap-20230203-0005/) | CVE-2022-46908 SQLite Vulnerability in NetApp Products | 2023-08-22 |
| [**NTAP-20230203-0008**](https://security.netapp.com/advisory/ntap-20230203-0008/) | October 2022 Linux Kernel 5.19.15 Vulnerabilities in NetApp Products | 2023-02-08 |
| [**NTAP-20230127-0014**](https://security.netapp.com/advisory/ntap-20230127-0014/) | April 2022 OWASP Enterprise Security API Vulnerabilities in NetApp Products | 2024-10-22 |
| [**NTAP-20230127-0001**](https://security.netapp.com/advisory/ntap-20230127-0001/) | CVE-2022-28169 Brocade Fabric OS Vulnerability | 2023-01-27 |
| [**NTAP-20230127-0002**](https://security.netapp.com/advisory/ntap-20230127-0002/) | CVE-2022-28170 Brocade Fabric OS Vulnerability | 2023-01-27 |
| [**NTAP-20230127-0003**](https://security.netapp.com/advisory/ntap-20230127-0003/) | CVE-2022-33178 Brocade Fabric OS Vulnerability | 2023-01-27 |
| [**NTAP-20230127-0004**](https://security.netapp.com/advisory/ntap-20230127-0004/) | CVE-2022-33179 Brocade Fabric OS Vulnerability | 2023-01-27 |
| [**NTAP-20230127-0005**](https://security.netapp.com/advisory/ntap-20230127-0005/) | CVE-2022-33180 Brocade Fabric OS Vulnerability | 2023-01-27 |
| [**NTAP-20230127-0006**](https://security.netapp.com/advisory/ntap-20230127-0006/) | CVE-2022-33181 Brocade Fabric OS Vulnerability | 2023-01-27 |
| [**NTAP-20230127-0007**](https://security.netapp.com/advisory/ntap-20230127-0007/) | CVE-2022-33182 Brocade Fabric OS Vulnerability | 2023-01-27 |
| [**NTAP-20230127-0008**](https://security.netapp.com/advisory/ntap-20230127-0008/) | CVE-2022-33183 Brocade Fabric OS Vulnerability | 2023-01-27 |
| [**NTAP-20230127-0009**](https://security.netapp.com/advisory/ntap-20230127-0009/) | CVE-2022-33184 Brocade Fabric OS Vulnerability | 2023-01-27 |
| [**NTAP-20230127-0010**](https://security.netapp.com/advisory/ntap-20230127-0010/) | CVE-2022-33185 Brocade Fabric OS Vulnerability | 2023-01-27 |
| [**NTAP-20230127-0012**](https://security.netapp.com/advisory/ntap-20230127-0012/) | CVE-2022-4144 QEMU Vulnerability in NetApp Products | 2023-01-27 |
| [**NTAP-20230127-0013**](https://security.netapp.com/advisory/ntap-20230127-0013/) | CVE-2022-4172 QEMU Vulnerability in NetApp Products | 2023-01-27 |
| [**NTAP-20230127-0015**](https://security.netapp.com/advisory/ntap-20230127-0015/) | CVE-2023-22809 Sudo Vulnerability in NetApp Products | 2023-10-17 |
| [**NTAP-20230127-0011**](https://security.netapp.com/advisory/ntap-20230127-0011/) | December 2022 X.Org X Server Vulnerabilities in NetApp Products | 2023-01-27 |
| [**NTAP-20230120-0003**](https://security.netapp.com/advisory/ntap-20230120-0003/) | CVE-2022-41296 IBM Db2 Vulnerability in NetApp Products | 2023-01-20 |
| [**NTAP-20230120-0007**](https://security.netapp.com/advisory/ntap-20230120-0007/) | CVE-2022-41716 Golang Vulnerability in NetApp Products | 2023-05-05 |
| [**NTAP-20230120-0008**](https://security.netapp.com/advisory/ntap-20230120-0008/) | CVE-2022-41717 Golang Vulnerability in NetApp Products | 2023-11-15 |
| [**NTAP-20230120-0004**](https://security.netapp.com/advisory/ntap-20230120-0004/) | CVE-2022-43548 Node.js Vulnerability in NetApp Products | 2023-01-23 |
| [**NTAP-20230120-0002**](https://security.netapp.com/advisory/ntap-20230120-0002/) | December 2022 Apache CXF Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20230120-0009**](https://security.netapp.com/advisory/ntap-20230120-0009/) | December 2022 JsonWebToken Vulnerabilities in NetApp Products | 2023-04-20 |
| [**NTAP-20230120-0001**](https://security.netapp.com/advisory/ntap-20230120-0001/) | Linux Kernel 5.18 Vulnerabilities in NetApp Products | 2023-02-16 |
| [**NTAP-20230120-0006**](https://security.netapp.com/advisory/ntap-20230120-0006/) | October 2022 Golang Vulnerabilities in NetApp Products | 2023-05-05 |
| [**NTAP-20230120-0005**](https://security.netapp.com/advisory/ntap-20230120-0005/) | October 2022 NGINX Vulnerabilities in NetApp Products | 2024-01-02 |
| [**NTAP-20230113-0001**](https://security.netapp.com/advisory/ntap-20230113-0001/) | CVE-2022-2964 Linux Kernel Vulnerability in NetApp Products | 2023-01-13 |
| [**NTAP-20230113-0002**](https://security.netapp.com/advisory/ntap-20230113-0002/) | CVE-2022-35255 Node.js Vulnerability in NetApp Products | 2023-01-23 |
| [**NTAP-20230113-0005**](https://security.netapp.com/advisory/ntap-20230113-0005/) | CVE-2022-4292 Vim Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20230113-0004**](https://security.netapp.com/advisory/ntap-20230113-0004/) | December 2022 Apache Netty Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20230113-0003**](https://security.netapp.com/advisory/ntap-20230113-0003/) | December 2022 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2024-03-11 |
| [**NTAP-20230113-0007**](https://security.netapp.com/advisory/ntap-20230113-0007/) | December 2022 Linux Kernel 6.0.11 Vulnerabilities in NetApp Products | 2023-02-16 |
| [**NTAP-20230113-0008**](https://security.netapp.com/advisory/ntap-20230113-0008/) | November 2022 Linux Kernel 6.0.10 Vulnerabilities in NetApp Products | 2023-02-16 |
| [**NTAP-20230113-0006**](https://security.netapp.com/advisory/ntap-20230113-0006/) | November 2022 Linux Kernel 6.0.9 Vulnerabilities in NetApp Products | 2023-02-16 |
| [**NTAP-20230110-0002**](https://security.netapp.com/advisory/ntap-20230110-0002/) | CVE-2021-22600 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20230110-0006**](https://security.netapp.com/advisory/ntap-20230110-0006/) | December 2022 cURL/libcURL Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20230110-0003**](https://security.netapp.com/advisory/ntap-20230110-0003/) | December 2022 Samba Vulnerabilities in NetApp Products | 2023-04-04 |
| [**NTAP-20230110-0005**](https://security.netapp.com/advisory/ntap-20230110-0005/) | Linux Kernel prior to 5.19.2 Vulnerabilities in NetApp Products | 2023-04-07 |
| [**NTAP-20230110-0004**](https://security.netapp.com/advisory/ntap-20230110-0004/) | Linux Kernel through 5.19.1 Vulnerabilities in NetApp Products | 2023-04-07 |
| [**NTAP-20230110-0001**](https://security.netapp.com/advisory/ntap-20230110-0001/) | October 2022 LibTIFF Vulnerabilities in NetApp Products | 2023-02-07 |
| [**NTAP-20221228-0008**](https://security.netapp.com/advisory/ntap-20221228-0008/) | April 2022 LibTIFF Vulnerabilities in NetApp Products | 2023-02-07 |
| [**NTAP-20221228-0005**](https://security.netapp.com/advisory/ntap-20221228-0005/) | CVE-2016-2338 Ruby Vulnerability in NetApp Products | 2022-12-28 |
| [**NTAP-20221228-0004**](https://security.netapp.com/advisory/ntap-20221228-0004/) | CVE-2021-33621 Ruby Vulnerability in NetApp Products | 2022-12-28 |
| [**NTAP-20221228-0002**](https://security.netapp.com/advisory/ntap-20221228-0002/) | CVE-2021-4028 Linux Kernel Vulnerability in NetApp Products | 2023-01-13 |
| [**NTAP-20221228-0003**](https://security.netapp.com/advisory/ntap-20221228-0003/) | CVE-2021-4204 Linux Kernel Vulnerability in NetApp Products | 2023-01-23 |
| [**NTAP-20221228-0006**](https://security.netapp.com/advisory/ntap-20221228-0006/) | CVE-2022-1199 Linux Kernel Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20221228-0007**](https://security.netapp.com/advisory/ntap-20221228-0007/) | CVE-2022-3202 Linux Kernel Vulnerability in NetApp Products | 2023-01-23 |
| [**NTAP-20221228-0001**](https://security.netapp.com/advisory/ntap-20221228-0001/) | CVE-2022-3541 Linux Kernel Vulnerability in NetApp Products | 2023-01-13 |
| [**NTAP-20221228-0010**](https://security.netapp.com/advisory/ntap-20221228-0010/) | CVE-2022-38177 ISC BIND Vulnerability in NetApp Products | 2023-11-22 |
| [**NTAP-20221228-0009**](https://security.netapp.com/advisory/ntap-20221228-0009/) | CVE-2022-38178 ISC BIND Vulnerability in NetApp Products | 2023-11-22 |
| [**NTAP-20221223-0009**](https://security.netapp.com/advisory/ntap-20221223-0009/) | CVE-2021-31693 VMware Tools Vulnerability in NetApp Products | 2022-12-23 |
| [**NTAP-20221223-0007**](https://security.netapp.com/advisory/ntap-20221223-0007/) | CVE-2021-46784 Squid Vulnerability in NetApp Products | 2023-01-06 |
| [**NTAP-20221223-0002**](https://security.netapp.com/advisory/ntap-20221223-0002/) | CVE-2022-2938 Linux Kernel Vulnerability in NetApp Products | 2023-01-23 |
| [**NTAP-20221223-0008**](https://security.netapp.com/advisory/ntap-20221223-0008/) | CVE-2022-31630 PHP Vulnerability in NetApp Products | 2022-12-23 |
| [**NTAP-20221223-0006**](https://security.netapp.com/advisory/ntap-20221223-0006/) | CVE-2022-3165 QEMU Vulnerability in NetApp Products | 2022-12-23 |
| [**NTAP-20221223-0003**](https://security.netapp.com/advisory/ntap-20221223-0003/) | CVE-2022-3545 Linux Kernel Vulnerability in NetApp Products | 2023-01-23 |
| [**NTAP-20221223-0001**](https://security.netapp.com/advisory/ntap-20221223-0001/) | CVE-2022-3564 Linux Kernel Vulnerability in NetApp Products | 2023-01-23 |
| [**NTAP-20221223-0004**](https://security.netapp.com/advisory/ntap-20221223-0004/) | CVE-2022-3705 Vim Vulnerability in NetApp Products | 2022-12-23 |
| [**NTAP-20221223-0010**](https://security.netapp.com/advisory/ntap-20221223-0010/) | CVE-2022-3920 HashiCorp Consul Vulnerability Vulnerability in NetApp Products | 2022-12-23 |
| [**NTAP-20221223-0005**](https://security.netapp.com/advisory/ntap-20221223-0005/) | CVE-2022-42252 Apache Tomcat Vulnerability in NetApp Products | 2022-12-23 |
| [**NTAP-20221220-0001**](https://security.netapp.com/advisory/ntap-20221220-0001/) | CVE-2022-38733 Authentication Bypass Vulnerability in OnCommand Insight | 2022-12-20 |
| [**NTAP-20221215-0008**](https://security.netapp.com/advisory/ntap-20221215-0008/) | CVE-2014-0144 QEMU Vulnerability in NetApp Products | 2022-12-15 |
| [**NTAP-20221215-0002**](https://security.netapp.com/advisory/ntap-20221215-0002/) | CVE-2021-3671 Samba Vulnerability in NetApp Products | 2022-12-15 |
| [**NTAP-20221215-0005**](https://security.netapp.com/advisory/ntap-20221215-0005/) | CVE-2022-3872 QEMU Vulnerability in NetApp Products | 2022-12-15 |
| [**NTAP-20221215-0003**](https://security.netapp.com/advisory/ntap-20221215-0003/) | CVE-2022-39328 Grafana Vulnerability in NetApp Products | 2023-01-13 |
| [**NTAP-20221215-0009**](https://security.netapp.com/advisory/ntap-20221215-0009/) | CVE-2022-3970 LibTIFF Vulnerability in NetApp Products | 2024-05-15 |
| [**NTAP-20221215-0006**](https://security.netapp.com/advisory/ntap-20221215-0006/) | CVE-2022-43945 Linux Kernel Vulnerability in NetApp Products | 2023-01-23 |
| [**NTAP-20221215-0007**](https://security.netapp.com/advisory/ntap-20221215-0007/) | December 2022 MegaRAC BMC Firmware Vulnerabilities in NetApp Products | 2022-12-30 |
| [**NTAP-20221215-0004**](https://security.netapp.com/advisory/ntap-20221215-0004/) | November 2022 Grafana Vulnerabilities in NetApp Products | 2023-03-07 |
| [**NTAP-20221215-0010**](https://security.netapp.com/advisory/ntap-20221215-0010/) | October 2022 Spring Security Vulnerabilities in NetApp Products | 2024-05-15 |
| [**NTAP-20221215-0001**](https://security.netapp.com/advisory/ntap-20221215-0001/) | September 2022 Grafana Vulnerabilities in NetApp Products | 2022-12-15 |
| [**NTAP-20221209-0002**](https://security.netapp.com/advisory/ntap-20221209-0002/) | August 2022 Util-linux Vulnerabilities in NetApp Products | 2022-12-09 |
| [**NTAP-20221209-0008**](https://security.netapp.com/advisory/ntap-20221209-0008/) | CVE-2012-4244 ISC BIND Vulnerability in NetApp Products | 2022-12-23 |
| [**NTAP-20221209-0009**](https://security.netapp.com/advisory/ntap-20221209-0009/) | CVE-2022-23093 FreeBSD Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20221209-0004**](https://security.netapp.com/advisory/ntap-20221209-0004/) | CVE-2022-31176 Grafana Vulnerability in NetApp Products | 2022-12-09 |
| [**NTAP-20221209-0005**](https://security.netapp.com/advisory/ntap-20221209-0005/) | CVE-2022-35278 Apache ActiveMQ Artemis Vulnerability in NetApp Products | 2022-12-09 |
| [**NTAP-20221209-0006**](https://security.netapp.com/advisory/ntap-20221209-0006/) | CVE-2022-42919 Python Vulnerability in NetApp Products | 2023-01-17 |
| [**NTAP-20221209-0007**](https://security.netapp.com/advisory/ntap-20221209-0007/) | CVE-2022-45061 Python Vulnerability in NetApp Products | 2024-05-15 |
| [**NTAP-20221209-0003**](https://security.netapp.com/advisory/ntap-20221209-0003/) | November 2022 Libxml2 Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20221209-0010**](https://security.netapp.com/advisory/ntap-20221209-0010/) | October 2022 cURL/libcURL Vulnerabilities in NetApp Products | 2023-05-10 |
| [**NTAP-20221209-0001**](https://security.netapp.com/advisory/ntap-20221209-0001/) | September 2022 PHP Vulnerabilities in NetApp Products | 2022-12-21 |
| [**NTAP-20221201-0003**](https://security.netapp.com/advisory/ntap-20221201-0003/) | CVE-2021-25642 Apache Hadoop Vulnerability in NetApp Products | 2022-12-01 |
| [**NTAP-20221201-0004**](https://security.netapp.com/advisory/ntap-20221201-0004/) | CVE-2021-3859 Undertow Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20221201-0002**](https://security.netapp.com/advisory/ntap-20221201-0002/) | CVE-2021-3975 Libvirt Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20221201-0001**](https://security.netapp.com/advisory/ntap-20221201-0001/) | CVE-2022-41316 HashiCorp Vault Vulnerability in NetApp Products | 2022-12-01 |
| [**NTAP-20221128-0002**](https://security.netapp.com/advisory/ntap-20221128-0002/) | CVE-2022-33187 Brocade SANnav Vulnerability | 2022-11-28 |
| [**NTAP-20221128-0001**](https://security.netapp.com/advisory/ntap-20221128-0001/) | CVE-2022-42898 Samba Vulnerability in NetApp Products | 2022-12-01 |
| [**NTAP-20221128-0003**](https://security.netapp.com/advisory/ntap-20221128-0003/) | CVE-2022-43933 Brocade SANnav Vulnerability | 2022-11-28 |
| [**NTAP-20221128-0004**](https://security.netapp.com/advisory/ntap-20221128-0004/) | CVE-2022-43934 Brocade SANnav Vulnerability | 2022-11-28 |
| [**NTAP-20221128-0005**](https://security.netapp.com/advisory/ntap-20221128-0005/) | CVE-2022-43935 Brocade SANnav Vulnerability | 2022-11-28 |
| [**NTAP-20221128-0006**](https://security.netapp.com/advisory/ntap-20221128-0006/) | CVE-2022-43936 Brocade SANnav Vulnerability | 2022-11-28 |
| [**NTAP-20221124-0003**](https://security.netapp.com/advisory/ntap-20221124-0003/) | CVE-2021-3770 Vim Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20221124-0002**](https://security.netapp.com/advisory/ntap-20221124-0002/) | CVE-2022-31123 Grafana Vulnerability in NetApp Products | 2023-03-07 |
| [**NTAP-20221124-0001**](https://security.netapp.com/advisory/ntap-20221124-0001/) | CVE-2022-41323 Django Vulnerability in NetApp Products | 2022-11-24 |
| [**NTAP-20221124-0004**](https://security.netapp.com/advisory/ntap-20221124-0004/) | CVE-2022-42003 FasterXML Jackson Databind Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20221118-0003**](https://security.netapp.com/advisory/ntap-20221118-0003/) | CVE-2021-3778 Vim Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20221118-0004**](https://security.netapp.com/advisory/ntap-20221118-0004/) | CVE-2021-3796 Vim Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20221118-0006**](https://security.netapp.com/advisory/ntap-20221118-0006/) | CVE-2021-46848 GNU Libtasn1 Vulnerability in NetApp Products | 2022-12-01 |
| [**NTAP-20221118-0001**](https://security.netapp.com/advisory/ntap-20221118-0001/) | CVE-2022-21831 Ruby Vulnerability in NetApp Products | 2022-11-18 |
| [**NTAP-20221118-0002**](https://security.netapp.com/advisory/ntap-20221118-0002/) | CVE-2022-22577 Ruby Vulnerability in NetApp Products | 2022-11-18 |
| [**NTAP-20221118-0005**](https://security.netapp.com/advisory/ntap-20221118-0005/) | CVE-2022-40664 Apache Shiro Vulnerability in NetApp Products | 2024-02-29 |
| [**NTAP-20221118-0008**](https://security.netapp.com/advisory/ntap-20221118-0008/) | CVE-2022-42004 FasterXML Jackson Databind Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20221118-0007**](https://security.netapp.com/advisory/ntap-20221118-0007/) | CVE-2022-43680 libexpat Vulnerability in NetApp Products | 2023-03-07 |
| [**NTAP-20221111-0004**](https://security.netapp.com/advisory/ntap-20221111-0004/) | CVE-2019-20446 GNOME Librsvg Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20221111-0007**](https://security.netapp.com/advisory/ntap-20221111-0007/) | CVE-2020-35527 SQLite Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20221111-0003**](https://security.netapp.com/advisory/ntap-20221111-0003/) | CVE-2021-4203 Linux Kernel Vulnerability in NetApp Products | 2024-05-08 |
| [**NTAP-20221111-0001**](https://security.netapp.com/advisory/ntap-20221111-0001/) | CVE-2021-43618 GMP Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20221111-0002**](https://security.netapp.com/advisory/ntap-20221111-0002/) | CVE-2022-24903 Rsyslog Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20221111-0005**](https://security.netapp.com/advisory/ntap-20221111-0005/) | CVE-2022-2526 Systemd Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20221111-0009**](https://security.netapp.com/advisory/ntap-20221111-0009/) | CVE-2022-28131 Golang Vulnerability in NetApp Products | 2023-01-13 |
| [**NTAP-20221111-0008**](https://security.netapp.com/advisory/ntap-20221111-0008/) | CVE-2022-40186 HashiCorp Vault Vulnerability in NetApp Products | 2022-11-11 |
| [**NTAP-20221111-0006**](https://security.netapp.com/advisory/ntap-20221111-0006/) | Intel SA-00688 BIOS Firmware Vulnerabilities in NetApp Products | 2022-11-11 |
| [**NTAP-20221110-0001**](https://security.netapp.com/advisory/ntap-20221110-0001/) | CVE-2022-33186 Brocade Fabric Operating System Firmware Vulnerability | 2022-11-10 |
| [**NTAP-20221104-0001**](https://security.netapp.com/advisory/ntap-20221104-0001/) | CVE-2021-3999 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-11-14 |
| [**NTAP-20221104-0004**](https://security.netapp.com/advisory/ntap-20221104-0004/) | CVE-2021-4189 Python Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20221104-0005**](https://security.netapp.com/advisory/ntap-20221104-0005/) | CVE-2022-1552 PostgreSQL Vulnerability in NetApp Products | 2022-12-01 |
| [**NTAP-20221104-0006**](https://security.netapp.com/advisory/ntap-20221104-0006/) | CVE-2022-36033 jsoup Vulnerability in NetApp Products | 2022-11-04 |
| [**NTAP-20221104-0007**](https://security.netapp.com/advisory/ntap-20221104-0007/) | CVE-2022-38533 GNU Binutils Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20221104-0008**](https://security.netapp.com/advisory/ntap-20221104-0008/) | CVE-2022-38791 MariaDB Vulnerability in NetApp Products | 2022-11-04 |
| [**NTAP-20221104-0002**](https://security.netapp.com/advisory/ntap-20221104-0002/) | CVE-2022-39046 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20221104-0003**](https://security.netapp.com/advisory/ntap-20221104-0003/) | September 2022 X.Org X Server Vulnerabilities in NetApp Products | 2022-11-04 |
| [**NTAP-20221102-0001**](https://security.netapp.com/advisory/ntap-20221102-0001/) | November 2022 OpenSSL Vulnerabilities in NetApp Products | 2024-10-14 |
| [**NTAP-20221028-0001**](https://security.netapp.com/advisory/ntap-20221028-0001/) | CVE-2018-14550 libpng Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20221028-0002**](https://security.netapp.com/advisory/ntap-20221028-0002/) | CVE-2019-13990 Quartz Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20221028-0010**](https://security.netapp.com/advisory/ntap-20221028-0010/) | CVE-2020-14155 PCRE Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20221028-0003**](https://security.netapp.com/advisory/ntap-20221028-0003/) | CVE-2021-3753 Linux Kernel Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20221028-0004**](https://security.netapp.com/advisory/ntap-20221028-0004/) | CVE-2021-3800 GNOME GLib Vulnerability in NetApp Products | 2023-03-08 |
| [**NTAP-20221028-0005**](https://security.netapp.com/advisory/ntap-20221028-0005/) | CVE-2022-23437 Apache XercesJ Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20221028-0007**](https://security.netapp.com/advisory/ntap-20221028-0007/) | CVE-2022-25258 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20221028-0006**](https://security.netapp.com/advisory/ntap-20221028-0006/) | CVE-2022-26336 Apache POI Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20221028-0014**](https://security.netapp.com/advisory/ntap-20221028-0014/) | CVE-2022-3358 OpenSSL Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20221028-0015**](https://security.netapp.com/advisory/ntap-20221028-0015/) | CVE-2022-33980 Apache Commons Configuration Vulnerability in NetApp Products | 2022-10-28 |
| [**NTAP-20221028-0016**](https://security.netapp.com/advisory/ntap-20221028-0016/) | CVE-2022-34339 IBM Cognos Analytics Vulnerability in NetApp Products | 2022-10-28 |
| [**NTAP-20221028-0008**](https://security.netapp.com/advisory/ntap-20221028-0008/) | CVE-2022-40674 libexpat Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20221028-0009**](https://security.netapp.com/advisory/ntap-20221028-0009/) | June 2022 PCRE Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20221028-0012**](https://security.netapp.com/advisory/ntap-20221028-0012/) | October 2022 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20221028-0013**](https://security.netapp.com/advisory/ntap-20221028-0013/) | October 2022 MySQL Server Vulnerabilities in NetApp Products | 2024-03-11 |
| [**NTAP-20221028-0011**](https://security.netapp.com/advisory/ntap-20221028-0011/) | October 2022 Samba Vulnerabilities in NetApp Products | 2023-09-15 |
| [**NTAP-20221020-0003**](https://security.netapp.com/advisory/ntap-20221020-0003/) | CVE-2021-3998 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20221020-0001**](https://security.netapp.com/advisory/ntap-20221020-0001/) | CVE-2021-4214 Libpng Vulnerability in NetApp Products | 2023-11-02 |
| [**NTAP-20221020-0006**](https://security.netapp.com/advisory/ntap-20221020-0006/) | CVE-2022-1012 Linux Kernel Vulnerability in NetApp Products | 2023-05-05 |
| [**NTAP-20221020-0005**](https://security.netapp.com/advisory/ntap-20221020-0005/) | CVE-2022-35951 Redis Vulnerability in NetApp Products | 2022-11-21 |
| [**NTAP-20221020-0004**](https://security.netapp.com/advisory/ntap-20221020-0004/) | CVE-2022-42889 Apache Commons Text Vulnerability in NetApp Products | 2022-11-21 |
| [**NTAP-20221020-0002**](https://security.netapp.com/advisory/ntap-20221020-0002/) | September 2022 BlueZ Vulnerabilities in NetApp Products | 2022-10-20 |
| [**NTAP-20221017-0001**](https://security.netapp.com/advisory/ntap-20221017-0001/) | CVE-2022-23241 Arbitrary WORM Data Modification Vulnerability in ONTAP 9.11.1 | 2022-10-17 |
| [**NTAP-20221017-0003**](https://security.netapp.com/advisory/ntap-20221017-0003/) | CVE-2022-31676 VMware Tools Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20221017-0002**](https://security.netapp.com/advisory/ntap-20221017-0002/) | CVE-2022-36067 NPM Vulnerability in NetApp Products | 2022-10-17 |
| [**NTAP-20221014-0005**](https://security.netapp.com/advisory/ntap-20221014-0005/) | August 2022 IBM Cognos Analytics Vulnerabilities | 2022-10-28 |
| [**NTAP-20221014-0007**](https://security.netapp.com/advisory/ntap-20221014-0007/) | August 2022 LibTIFF Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20221014-0006**](https://security.netapp.com/advisory/ntap-20221014-0006/) | August 2022 Undertow Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20221014-0002**](https://security.netapp.com/advisory/ntap-20221014-0002/) | CVE-2021-3807 Node.js Vulnerability in NetApp Products | 2022-12-01 |
| [**NTAP-20221014-0001**](https://security.netapp.com/advisory/ntap-20221014-0001/) | CVE-2021-43466 Thymeleaf Vulnerability in NetApp Products | 2022-10-14 |
| [**NTAP-20221014-0008**](https://security.netapp.com/advisory/ntap-20221014-0008/) | CVE-2022-2953 LibTIFF Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20221014-0003**](https://security.netapp.com/advisory/ntap-20221014-0003/) | CVE-2022-31129 Node.js Vulnerability in NetApp Products | 2022-11-21 |
| [**NTAP-20221014-0004**](https://security.netapp.com/advisory/ntap-20221014-0004/) | Intel SA-00709 AMT Vulnerabilities in NetApp Products | 2022-11-10 |
| [**NTAP-20221007-0001**](https://security.netapp.com/advisory/ntap-20221007-0001/) | CVE-2021-3772 Linux Kernel Vulnerability in NetApp Products | 2022-10-07 |
| [**NTAP-20221007-0004**](https://security.netapp.com/advisory/ntap-20221007-0004/) | CVE-2021-46828 libtirpc Vulnerability in NetApp Products | 2022-10-07 |
| [**NTAP-20221007-0008**](https://security.netapp.com/advisory/ntap-20221007-0008/) | CVE-2022-0358 QEMU Vulnerability in NetApp Products | 2022-10-07 |
| [**NTAP-20221007-0002**](https://security.netapp.com/advisory/ntap-20221007-0002/) | CVE-2022-1664 Dpkg Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20221007-0003**](https://security.netapp.com/advisory/ntap-20221007-0003/) | CVE-2022-24407 Cyrus SASL Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20221007-0005**](https://security.netapp.com/advisory/ntap-20221007-0005/) | CVE-2022-26373 Intel Processor Vulnerability in NetApp Products | 2022-10-07 |
| [**NTAP-20221007-0006**](https://security.netapp.com/advisory/ntap-20221007-0006/) | CVE-2022-28693 Intel Processor Vulnerability in NetApp Products | 2022-10-07 |
| [**NTAP-20221007-0007**](https://security.netapp.com/advisory/ntap-20221007-0007/) | CVE-2022-29901 Intel Processor Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20220930-0004**](https://security.netapp.com/advisory/ntap-20220930-0004/) | CVE-2021-33060 Intel BIOS Firmware Vulnerability in NetApp Products | 2023-12-20 |
| [**NTAP-20220930-0006**](https://security.netapp.com/advisory/ntap-20220930-0006/) | CVE-2022-1271 GNU Gzip Vulnerability in NetApp Products | 2022-10-17 |
| [**NTAP-20220930-0007**](https://security.netapp.com/advisory/ntap-20220930-0007/) | CVE-2022-1619 Vim Vulnerability in NetApp Products | 2022-10-07 |
| [**NTAP-20220930-0003**](https://security.netapp.com/advisory/ntap-20220930-0003/) | CVE-2022-26074 Intel SPS Vulnerability in NetApp Products | 2022-09-30 |
| [**NTAP-20220930-0002**](https://security.netapp.com/advisory/ntap-20220930-0002/) | CVE-2022-34526 LibTIFF Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20220930-0005**](https://security.netapp.com/advisory/ntap-20220930-0005/) | CVE-2022-35252 cURL/libcURL Vulnerability in NetApp Products | 2023-08-02 |
| [**NTAP-20220930-0001**](https://security.netapp.com/advisory/ntap-20220930-0001/) | July 2022 Grub Vulnerabilities in NetApp Products | 2022-10-28 |
| [**NTAP-20220926-0001**](https://security.netapp.com/advisory/ntap-20220926-0001/) | CVE-2022-38732 Missing Content Security Policy in SnapCenter | 2022-09-28 |
| [**NTAP-20220923-0005**](https://security.netapp.com/advisory/ntap-20220923-0005/) | CVE-2022-1996 go-restful Vulnerability in NetApp Products | 2022-10-07 |
| [**NTAP-20220923-0001**](https://security.netapp.com/advisory/ntap-20220923-0001/) | CVE-2022-20824 Cisco Discovery Protocol Denial of Service and Arbitrary Code Execution Vulnerability | 2022-09-23 |
| [**NTAP-20220923-0002**](https://security.netapp.com/advisory/ntap-20220923-0002/) | CVE-2022-21233 Intel Processor Vulnerability in NetApp Products | 2022-09-23 |
| [**NTAP-20220923-0004**](https://security.netapp.com/advisory/ntap-20220923-0004/) | CVE-2022-27664 Golang Vulnerability in NetApp Products | 2023-03-07 |
| [**NTAP-20220923-0006**](https://security.netapp.com/advisory/ntap-20220923-0006/) | CVE-2022-28948 Go-Yaml Vulnerability in NetApp Products | 2022-11-15 |
| [**NTAP-20220923-0003**](https://security.netapp.com/advisory/ntap-20220923-0003/) | CVE-2022-32189 Golang Vulnerability in NetApp Products | 2022-10-12 |
| [**NTAP-20220915-0010**](https://security.netapp.com/advisory/ntap-20220915-0010/) | April 2022 Golang Vulnerabilities in NetApp Products | 2022-10-11 |
| [**NTAP-20220915-0005**](https://security.netapp.com/advisory/ntap-20220915-0005/) | CVE-2021-4209 GnuTLS Vulnerability in NetApp Products | 2023-03-07 |
| [**NTAP-20220915-0006**](https://security.netapp.com/advisory/ntap-20220915-0006/) | CVE-2022-2309 lxml Vulnerability in NetApp Products | 2022-12-01 |
| [**NTAP-20220915-0007**](https://security.netapp.com/advisory/ntap-20220915-0007/) | CVE-2022-25168 Apache Hadoop Vulnerability in NetApp Products | 2022-09-15 |
| [**NTAP-20220915-0002**](https://security.netapp.com/advisory/ntap-20220915-0002/) | CVE-2022-31150 Node.js Vulnerability in NetApp Products | 2022-12-12 |
| [**NTAP-20220915-0009**](https://security.netapp.com/advisory/ntap-20220915-0009/) | CVE-2022-35737 SQLite Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220915-0008**](https://security.netapp.com/advisory/ntap-20220915-0008/) | CVE-2022-36359 Django Vulnerability in NetApp Products | 2022-10-17 |
| [**NTAP-20220915-0004**](https://security.netapp.com/advisory/ntap-20220915-0004/) | July 2022 Golang Vulnerabilities in NetApp Products | 2023-01-13 |
| [**NTAP-20220915-0003**](https://security.netapp.com/advisory/ntap-20220915-0003/) | July 2022 Libcurl Vulnerabilities in NetApp Products | 2023-05-10 |
| [**NTAP-20220915-0001**](https://security.netapp.com/advisory/ntap-20220915-0001/) | July 2022 Node.js Vulnerabilities in NetApp Products | 2022-11-21 |
| [**NTAP-20220909-0001**](https://security.netapp.com/advisory/ntap-20220909-0001/) | CVE-2018-1285 Apache Log4net Vulnerability in NetApp Products | 2022-09-09 |
| [**NTAP-20220909-0004**](https://security.netapp.com/advisory/ntap-20220909-0004/) | CVE-2019-17498 Libssh2 Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220909-0003**](https://security.netapp.com/advisory/ntap-20220909-0003/) | CVE-2022-2191 Eclipse Jetty Vulnerability in NetApp Products | 2022-09-13 |
| [**NTAP-20220909-0002**](https://security.netapp.com/advisory/ntap-20220909-0002/) | CVE-2022-31144 Redis Vulnerability in NetApp Products | 2022-12-01 |
| [**NTAP-20220909-0006**](https://security.netapp.com/advisory/ntap-20220909-0006/) | CVE-2022-31151 Node.js Vulnerability in NetApp Products | 2022-12-01 |
| [**NTAP-20220909-0007**](https://security.netapp.com/advisory/ntap-20220909-0007/) | CVE-2022-31160 jQuery Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20220909-0005**](https://security.netapp.com/advisory/ntap-20220909-0005/) | CVE-2022-36313 Node.js Vulnerability in NetApp Products | 2022-11-21 |
| [**NTAP-20220901-0006**](https://security.netapp.com/advisory/ntap-20220901-0006/) | August 2022 Eclipse Jetty Vulnerabilities in NetApp Products | 2023-02-16 |
| [**NTAP-20220901-0012**](https://security.netapp.com/advisory/ntap-20220901-0012/) | CVE-2020-28445 Node.js Vulnerability in NetApp Products | 2022-12-12 |
| [**NTAP-20220901-0008**](https://security.netapp.com/advisory/ntap-20220901-0008/) | CVE-2022-1651 Linux Kernel Vulnerability in NetApp Products | 2022-09-30 |
| [**NTAP-20220901-0004**](https://security.netapp.com/advisory/ntap-20220901-0004/) | CVE-2022-1671 Linux Kernel Vulnerability in NetApp Products | 2022-09-26 |
| [**NTAP-20220901-0001**](https://security.netapp.com/advisory/ntap-20220901-0001/) | CVE-2022-23239 Stored Cross-Site Scripting Vulnerability in Active IQ Unified Manager | 2022-09-01 |
| [**NTAP-20220901-0002**](https://security.netapp.com/advisory/ntap-20220901-0002/) | CVE-2022-23240 Improper Authorization Vulnerability in Active IQ Unified Manager | 2022-09-01 |
| [**NTAP-20220901-0009**](https://security.netapp.com/advisory/ntap-20220901-0009/) | CVE-2022-25647 Google Gson Vulnerability in NetApp Products | 2024-02-29 |
| [**NTAP-20220901-0003**](https://security.netapp.com/advisory/ntap-20220901-0003/) | CVE-2022-36123 Linux Kernel Vulnerability in NetApp Products | 2022-09-26 |
| [**NTAP-20220901-0011**](https://security.netapp.com/advisory/ntap-20220901-0011/) | CVE-2022-36129 HashiCorp Vulnerability in NetApp Products | 2022-09-01 |
| [**NTAP-20220901-0005**](https://security.netapp.com/advisory/ntap-20220901-0005/) | CVE-2022-37434 Zlib Vulnerability in NetApp Products | 2024-04-05 |
| [**NTAP-20220901-0010**](https://security.netapp.com/advisory/ntap-20220901-0010/) | July 2022 Grafana Vulnerabilities in NetApp Products | 2023-03-07 |
| [**NTAP-20220901-0007**](https://security.netapp.com/advisory/ntap-20220901-0007/) | July 2022 Linux Kernel Vulnerabilities in NetApp Products | 2024-02-23 |
| [**NTAP-20220826-0002**](https://security.netapp.com/advisory/ntap-20220826-0002/) | CVE-2021-40663 Node.js Vulnerability in NetApp Products | 2022-08-31 |
| [**NTAP-20220826-0003**](https://security.netapp.com/advisory/ntap-20220826-0003/) | CVE-2022-21151 Intel Processor Vulnerability in NetApp Products | 2022-12-12 |
| [**NTAP-20220826-0008**](https://security.netapp.com/advisory/ntap-20220826-0008/) | CVE-2022-31627 PHP Vulnerability in NetApp Products | 2022-08-26 |
| [**NTAP-20220826-0006**](https://security.netapp.com/advisory/ntap-20220826-0006/) | CVE-2022-32083 MariaDB Vulnerability in NetApp Products | 2022-08-26 |
| [**NTAP-20220826-0007**](https://security.netapp.com/advisory/ntap-20220826-0007/) | CVE-2022-32086 MariaDB Vulnerability in NetApp Products | 2022-08-26 |
| [**NTAP-20220826-0005**](https://security.netapp.com/advisory/ntap-20220826-0005/) | CVE-2022-34903 GnuPG Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20220826-0004**](https://security.netapp.com/advisory/ntap-20220826-0004/) | CVE-2022-34918 Linux Kernel Vulnerability in NetApp Products | 2022-08-26 |
| [**NTAP-20220826-0001**](https://security.netapp.com/advisory/ntap-20220826-0001/) | June 2022 LibTIFF Vulnerabilities in NetApp Products | 2023-04-20 |
| [**NTAP-20220818-0001**](https://security.netapp.com/advisory/ntap-20220818-0001/) | CVE-2021-33117 Intel BIOS Firmware Vulnerability in NetApp Products | 2023-01-13 |
| [**NTAP-20220818-0002**](https://security.netapp.com/advisory/ntap-20220818-0002/) | CVE-2021-33149 Intel Processor Vulnerability in NetApp Products | 2023-01-13 |
| [**NTAP-20220818-0006**](https://security.netapp.com/advisory/ntap-20220818-0006/) | CVE-2022-34265 Django Vulnerability in NetApp Products | 2022-08-18 |
| [**NTAP-20220818-0004**](https://security.netapp.com/advisory/ntap-20220818-0004/) | Intel SA-00598 Processor Vulnerabilities in NetApp Products | 2022-12-12 |
| [**NTAP-20220818-0003**](https://security.netapp.com/advisory/ntap-20220818-0003/) | Intel SA-00601 BIOS Firmware Vulnerabilities in NetApp Products | 2022-08-18 |
| [**NTAP-20220818-0005**](https://security.netapp.com/advisory/ntap-20220818-0005/) | July 2022 MariaDB Vulnerabilities in NetApp Products | 2022-08-18 |
| [**NTAP-20220812-0001**](https://security.netapp.com/advisory/ntap-20220812-0001/) | CVE-2021-23055 NGINX Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20220812-0003**](https://security.netapp.com/advisory/ntap-20220812-0003/) | CVE-2022-26477 Systemd Vulnerability in NetApp Products | 2022-08-12 |
| [**NTAP-20220812-0006**](https://security.netapp.com/advisory/ntap-20220812-0006/) | CVE-2022-29582 Linux Kernel Vulnerability in NetApp Products | 2022-08-19 |
| [**NTAP-20220812-0002**](https://security.netapp.com/advisory/ntap-20220812-0002/) | CVE-2022-32532 Apache Shiro Vulnerability in NetApp Products | 2022-08-12 |
| [**NTAP-20220812-0004**](https://security.netapp.com/advisory/ntap-20220812-0004/) | CVE-2022-33879 Apache Tika Vulnerability in NetApp Products | 2022-08-12 |
| [**NTAP-20220812-0005**](https://security.netapp.com/advisory/ntap-20220812-0005/) | CVE-2022-35912 Grails Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20220808-0001**](https://security.netapp.com/advisory/ntap-20220808-0001/) | CVE-2022-23238 Firewall Vulnerability in StorageGRID (formerly StorageGRID Webscale) | 2022-08-08 |
| [**NTAP-20220804-0005**](https://security.netapp.com/advisory/ntap-20220804-0005/) | CVE-2017-20052 Python Vulnerability in NetApp Products | 2023-01-17 |
| [**NTAP-20220804-0003**](https://security.netapp.com/advisory/ntap-20220804-0003/) | CVE-2021-3597 Undertow Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20220804-0002**](https://security.netapp.com/advisory/ntap-20220804-0002/) | CVE-2021-3717 Wildfly Vulnerability in NetApp Products | 2022-08-26 |
| [**NTAP-20220804-0004**](https://security.netapp.com/advisory/ntap-20220804-0004/) | CVE-2022-25169 Apache Tika Vulnerability in NetApp Products | 2022-08-10 |
| [**NTAP-20220804-0001**](https://security.netapp.com/advisory/ntap-20220804-0001/) | CVE-2022-29078 Node.js Vulnerability in NetApp Products | 2022-08-31 |
| [**NTAP-20220729-0008**](https://security.netapp.com/advisory/ntap-20220729-0008/) | CVE-2021-3629 Undertow Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20220729-0003**](https://security.netapp.com/advisory/ntap-20220729-0003/) | CVE-2022-23708 Elasticsearch Vulnerability in NetApp Products | 2022-08-01 |
| [**NTAP-20220729-0001**](https://security.netapp.com/advisory/ntap-20220729-0001/) | CVE-2022-29526 Golang Vulnerability in NetApp Products | 2023-03-07 |
| [**NTAP-20220729-0005**](https://security.netapp.com/advisory/ntap-20220729-0005/) | CVE-2022-33105 Redis Vulnerability in NetApp Products | 2022-08-04 |
| [**NTAP-20220729-0006**](https://security.netapp.com/advisory/ntap-20220729-0006/) | CVE-2022-34305 Apache Tomcat Vulnerability in NetApp Products | 2022-08-26 |
| [**NTAP-20220729-0009**](https://security.netapp.com/advisory/ntap-20220729-0009/) | July 2022 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20220729-0004**](https://security.netapp.com/advisory/ntap-20220729-0004/) | July 2022 MySQL Server Vulnerabilities in NetApp Products | 2024-03-11 |
| [**NTAP-20220729-0010**](https://security.netapp.com/advisory/ntap-20220729-0010/) | July 2022 Samba Vulnerabilities in NetApp Products | 2022-07-29 |
| [**NTAP-20220729-0002**](https://security.netapp.com/advisory/ntap-20220729-0002/) | June 2022 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2022-07-29 |
| [**NTAP-20220729-0007**](https://security.netapp.com/advisory/ntap-20220729-0007/) | June 2022 IBM DB2 Vulnerabilities in NetApp Products | 2022-08-04 |
| [**NTAP-20220722-0003**](https://security.netapp.com/advisory/ntap-20220722-0003/) | CVE-2021-33036 Apache Hadoop Vulnerability in NetApp Products | 2022-07-22 |
| [**NTAP-20220722-0002**](https://security.netapp.com/advisory/ntap-20220722-0002/) | CVE-2022-1652 Linux Kernel Vulnerability in NetApp Products | 2022-08-11 |
| [**NTAP-20220722-0001**](https://security.netapp.com/advisory/ntap-20220722-0001/) | CVE-2022-1786 Linux Kernel Vulnerability in NetApp Products | 2022-08-11 |
| [**NTAP-20220722-0007**](https://security.netapp.com/advisory/ntap-20220722-0007/) | CVE-2022-29244 NPM Vulnerability in NetApp Products | 2023-11-07 |
| [**NTAP-20220722-0004**](https://security.netapp.com/advisory/ntap-20220722-0004/) | CVE-2022-30973 Apache Tika Vulnerability in NetApp Products | 2022-07-22 |
| [**NTAP-20220722-0006**](https://security.netapp.com/advisory/ntap-20220722-0006/) | CVE-2022-32981 Linux Kernel Vulnerability in NetApp Products | 2022-08-19 |
| [**NTAP-20220722-0005**](https://security.netapp.com/advisory/ntap-20220722-0005/) | July 2022 PHP Vulnerabilities in NetApp Products | 2022-08-03 |
| [**NTAP-20220715-0004**](https://security.netapp.com/advisory/ntap-20220715-0004/) | CVE-2021-33473 Ruby Gem Vulnerability in NetApp Products | 2022-07-21 |
| [**NTAP-20220715-0007**](https://security.netapp.com/advisory/ntap-20220715-0007/) | CVE-2021-37404 Apache Hadoop Vulnerability in NetApp Products | 2022-07-15 |
| [**NTAP-20220715-0001**](https://security.netapp.com/advisory/ntap-20220715-0001/) | CVE-2022-1678 Linux Kernel Vulnerability in NetApp Products | 2023-05-19 |
| [**NTAP-20220715-0002**](https://security.netapp.com/advisory/ntap-20220715-0002/) | CVE-2022-1882 Linux Kernel Vulnerability in NetApp Products | 2022-07-15 |
| [**NTAP-20220715-0011**](https://security.netapp.com/advisory/ntap-20220715-0011/) | CVE-2022-2097 OpenSSL Vulnerability in NetApp Products | 2024-02-29 |
| [**NTAP-20220715-0010**](https://security.netapp.com/advisory/ntap-20220715-0010/) | CVE-2022-2274 OpenSSL Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20220715-0006**](https://security.netapp.com/advisory/ntap-20220715-0006/) | CVE-2022-29824 Libxml2 Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20220715-0009**](https://security.netapp.com/advisory/ntap-20220715-0009/) | CVE-2022-29968 Linux Kernel Vulnerability in NetApp Products | 2022-08-31 |
| [**NTAP-20220715-0005**](https://security.netapp.com/advisory/ntap-20220715-0005/) | CVE-2022-32250 Linux Kernel Vulnerability in NetApp Products | 2022-08-11 |
| [**NTAP-20220715-0008**](https://security.netapp.com/advisory/ntap-20220715-0008/) | CVE-2022-32275 Grafana Vulnerability in NetApp Products | 2022-07-21 |
| [**NTAP-20220715-0003**](https://security.netapp.com/advisory/ntap-20220715-0003/) | June 2022 Redis Vulnerabilities in NetApp Products | 2022-11-04 |
| [**NTAP-20220707-0002**](https://security.netapp.com/advisory/ntap-20220707-0002/) | CVE-2022-1183 ISC BIND Vulnerability in NetApp Products | 2022-07-13 |
| [**NTAP-20220707-0007**](https://security.netapp.com/advisory/ntap-20220707-0007/) | CVE-2022-1734 Linux Kernel Vulnerability in NetApp Products | 2022-07-21 |
| [**NTAP-20220707-0009**](https://security.netapp.com/advisory/ntap-20220707-0009/) | CVE-2022-1998 Linux Kernel Vulnerability in NetApp Products | 2022-08-10 |
| [**NTAP-20220707-0008**](https://security.netapp.com/advisory/ntap-20220707-0008/) | CVE-2022-2068 OpenSSL Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220707-0010**](https://security.netapp.com/advisory/ntap-20220707-0010/) | CVE-2022-23712 Elasticsearch Vulnerability in NetApp Products | 2022-10-28 |
| [**NTAP-20220707-0004**](https://security.netapp.com/advisory/ntap-20220707-0004/) | CVE-2022-28660 Grafana Vulnerability in NetApp Products | 2022-07-07 |
| [**NTAP-20220707-0005**](https://security.netapp.com/advisory/ntap-20220707-0005/) | CVE-2022-29170 Grafana Vulnerability in NetApp Products | 2022-07-07 |
| [**NTAP-20220707-0001**](https://security.netapp.com/advisory/ntap-20220707-0001/) | CVE-2022-30594 Linux Kernel Vulnerability in NetApp Products | 2023-10-03 |
| [**NTAP-20220707-0006**](https://security.netapp.com/advisory/ntap-20220707-0006/) | June 2022 MariaDB Vulnerabilities in NetApp Products | 2022-07-07 |
| [**NTAP-20220707-0003**](https://security.netapp.com/advisory/ntap-20220707-0003/) | May 2022 Spring Security Vulnerabilities in NetApp Products | 2022-09-01 |
| [**NTAP-20220629-0008**](https://security.netapp.com/advisory/ntap-20220629-0008/) | CVE-2018-10237 Guava Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20220629-0004**](https://security.netapp.com/advisory/ntap-20220629-0004/) | CVE-2022-1116 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220629-0007**](https://security.netapp.com/advisory/ntap-20220629-0007/) | CVE-2022-1679 Linux Kernel Vulnerability in NetApp Products | 2022-06-30 |
| [**NTAP-20220629-0003**](https://security.netapp.com/advisory/ntap-20220629-0003/) | CVE-2022-25762 Apache Tomcat Vulnerability in NetApp Products | 2022-06-29 |
| [**NTAP-20220629-0009**](https://security.netapp.com/advisory/ntap-20220629-0009/) | CVE-2022-25844 AngularJS Vulnerability in NetApp Products | 2023-12-20 |
| [**NTAP-20220629-0010**](https://security.netapp.com/advisory/ntap-20220629-0010/) | CVE-2022-29218 RubyGems Vulnerability in NetApp Products | 2022-06-29 |
| [**NTAP-20220629-0005**](https://security.netapp.com/advisory/ntap-20220629-0005/) | CVE-2022-29581 Linux Kernel Vulnerability in NetApp Products | 2022-06-29 |
| [**NTAP-20220629-0002**](https://security.netapp.com/advisory/ntap-20220629-0002/) | CVE-2022-29885 Apache Tomcat Vulnerability in NetApp Products | 2022-06-29 |
| [**NTAP-20220629-0006**](https://security.netapp.com/advisory/ntap-20220629-0006/) | CVE-2022-30689 HashiCorp Vulnerability in NetApp Products | 2022-06-29 |
| [**NTAP-20220629-0001**](https://security.netapp.com/advisory/ntap-20220629-0001/) | May 2022 Linux Kernel Vulnerabilities in NetApp Products | 2022-07-21 |
| [**NTAP-20220627-0001**](https://security.netapp.com/advisory/ntap-20220627-0001/) | CVE-2022-28166 Brocade SANnav Vulnerability | 2022-06-27 |
| [**NTAP-20220627-0002**](https://security.netapp.com/advisory/ntap-20220627-0002/) | CVE-2022-28167 Brocade SANnav Vulnerability | 2022-06-27 |
| [**NTAP-20220627-0003**](https://security.netapp.com/advisory/ntap-20220627-0003/) | CVE-2022-28168 Brocade SANnav Vulnerability | 2022-06-27 |
| [**NTAP-20220624-0001**](https://security.netapp.com/advisory/ntap-20220624-0001/) | CVE-2021-3611 QEMU Vulnerability in NetApp Products | 2022-06-24 |
| [**NTAP-20220624-0003**](https://security.netapp.com/advisory/ntap-20220624-0003/) | CVE-2021-3750 QEMU Vulnerability in NetApp Products | 2022-06-24 |
| [**NTAP-20220624-0006**](https://security.netapp.com/advisory/ntap-20220624-0006/) | CVE-2022-21180 Intel Processor Vulnerability in NetApp Products | 2022-12-12 |
| [**NTAP-20220624-0007**](https://security.netapp.com/advisory/ntap-20220624-0007/) | CVE-2022-24436 Intel Processor Vulnerability in NetApp Products | 2023-01-13 |
| [**NTAP-20220624-0004**](https://security.netapp.com/advisory/ntap-20220624-0004/) | CVE-2022-30126 Apache Tika Vulnerability in NetApp Products | 2022-06-24 |
| [**NTAP-20220624-0008**](https://security.netapp.com/advisory/ntap-20220624-0008/) | Intel SA-00615 Intel Processor Vulnerabilities in NetApp Products | 2022-12-12 |
| [**NTAP-20220624-0005**](https://security.netapp.com/advisory/ntap-20220624-0005/) | June 2022 Apache HTTP Server Vulnerabilities in NetApp Products | 2023-05-22 |
| [**NTAP-20220624-0002**](https://security.netapp.com/advisory/ntap-20220624-0002/) | May 2022 Ruby Vulnerabilities in NetApp Products | 2022-06-24 |
| [**NTAP-20220616-0001**](https://security.netapp.com/advisory/ntap-20220616-0001/) | CVE-2015-20107 Python Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220616-0006**](https://security.netapp.com/advisory/ntap-20220616-0006/) | CVE-2022-22970 Spring Framework Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20220616-0003**](https://security.netapp.com/advisory/ntap-20220616-0003/) | CVE-2022-22971 Spring Framework Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20220616-0004**](https://security.netapp.com/advisory/ntap-20220616-0004/) | CVE-2022-24823 Apache Netty Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20220616-0002**](https://security.netapp.com/advisory/ntap-20220616-0002/) | CVE-2022-29176 Ruby Vulnerability in NetApp Products | 2022-06-16 |
| [**NTAP-20220616-0005**](https://security.netapp.com/advisory/ntap-20220616-0005/) | May 2022 LibTIFF Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20220609-0005**](https://security.netapp.com/advisory/ntap-20220609-0005/) | CVE-2021-32040 MongoDB Vulnerability in NetApp Products | 2022-06-09 |
| [**NTAP-20220609-0004**](https://security.netapp.com/advisory/ntap-20220609-0004/) | CVE-2021-3503 WildFly Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20220609-0001**](https://security.netapp.com/advisory/ntap-20220609-0001/) | CVE-2021-41303 Apache Shiro Vulnerability in NetApp Products | 2022-06-09 |
| [**NTAP-20220609-0003**](https://security.netapp.com/advisory/ntap-20220609-0003/) | CVE-2022-24857 Django Vulnerability in NetApp Products | 2022-06-09 |
| [**NTAP-20220609-0002**](https://security.netapp.com/advisory/ntap-20220609-0002/) | CVE-2022-28346 Django Vulnerability in NetApp Products | 2022-06-09 |
| [**NTAP-20220609-0007**](https://security.netapp.com/advisory/ntap-20220609-0007/) | CVE-2022-29155 OpenLDAP Vulnerability in NetApp Products | 2022-10-28 |
| [**NTAP-20220609-0009**](https://security.netapp.com/advisory/ntap-20220609-0009/) | June 2022 Libcurl Vulnerabilities in NetApp Products | 2023-01-26 |
| [**NTAP-20220609-0006**](https://security.netapp.com/advisory/ntap-20220609-0006/) | May 2022 Kubernetes Vulnerabilities in NetApp Products | 2022-06-09 |
| [**NTAP-20220609-0008**](https://security.netapp.com/advisory/ntap-20220609-0008/) | May 2022 Libcurl Vulnerabilities in NetApp Products | 2023-08-02 |
| [**NTAP-20220602-0007**](https://security.netapp.com/advisory/ntap-20220602-0007/) | CVE-2021-4157 Linux Kernel Vulnerability in NetApp Products | 2022-09-19 |
| [**NTAP-20220602-0006**](https://security.netapp.com/advisory/ntap-20220602-0006/) | CVE-2021-4197 Linux Kernel Vulnerability in NetApp Products | 2023-05-22 |
| [**NTAP-20220602-0001**](https://security.netapp.com/advisory/ntap-20220602-0001/) | CVE-2022-0435 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220602-0004**](https://security.netapp.com/advisory/ntap-20220602-0004/) | CVE-2022-22968 Spring Framework Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20220602-0005**](https://security.netapp.com/advisory/ntap-20220602-0005/) | CVE-2022-29153 HashiCorp Consul Vulnerability in NetApp Products | 2022-06-02 |
| [**NTAP-20220602-0002**](https://security.netapp.com/advisory/ntap-20220602-0002/) | CVE-2022-29156 Linux Kernel Vulnerability in NetApp Products | 2022-06-09 |
| [**NTAP-20220602-0003**](https://security.netapp.com/advisory/ntap-20220602-0003/) | March 2022 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2022-06-27 |
| [**NTAP-20220602-0009**](https://security.netapp.com/advisory/ntap-20220602-0009/) | May 2022 OpenSSL Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20220602-0008**](https://security.netapp.com/advisory/ntap-20220602-0008/) | May 2022 Systemd Vulnerabilities in NetApp Products | 2022-06-02 |
| [**NTAP-20220527-0001**](https://security.netapp.com/advisory/ntap-20220527-0001/) | CVE-2022-23236 Information Disclosure Vulnerability in E-Series SANtricity OS Controller Software 11.x | 2022-05-27 |
| [**NTAP-20220527-0002**](https://security.netapp.com/advisory/ntap-20220527-0002/) | CVE-2022-23237 Host Header Injection Vulnerability in E-Series SANtricity OS Controller Software 11.x | 2022-05-27 |
| [**NTAP-20220526-0007**](https://security.netapp.com/advisory/ntap-20220526-0007/) | April 2022 MariaDB v10.6.3 Vulnerabilities in NetApp Products | 2022-05-26 |
| [**NTAP-20220526-0004**](https://security.netapp.com/advisory/ntap-20220526-0004/) | April 2022 MariaDB Vulnerabilities in NetApp Products | 2022-05-26 |
| [**NTAP-20220526-0009**](https://security.netapp.com/advisory/ntap-20220526-0009/) | CVE-2018-25032 Zlib Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220526-0003**](https://security.netapp.com/advisory/ntap-20220526-0003/) | CVE-2021-29752 IBM DB2 Vulnerability in NetApp Products | 2022-05-26 |
| [**NTAP-20220526-0001**](https://security.netapp.com/advisory/ntap-20220526-0001/) | CVE-2022-0330 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220526-0005**](https://security.netapp.com/advisory/ntap-20220526-0005/) | CVE-2022-27379 MariaDB Vulnerability in NetApp Products | 2022-05-26 |
| [**NTAP-20220526-0008**](https://security.netapp.com/advisory/ntap-20220526-0008/) | CVE-2022-27385 MariaDB Vulnerability in NetApp Products | 2022-05-26 |
| [**NTAP-20220526-0002**](https://security.netapp.com/advisory/ntap-20220526-0002/) | CVE-2022-28893 Linux Kernel Vulnerability in NetApp Products | 2022-06-09 |
| [**NTAP-20220526-0006**](https://security.netapp.com/advisory/ntap-20220526-0006/) | May 2022 MariaDB Vulnerabilities in NetApp Products | 2022-05-26 |
| [**NTAP-20220519-0008**](https://security.netapp.com/advisory/ntap-20220519-0008/) | April 2022 NGINX Vulnerabilities in NetApp Products | 2024-05-09 |
| [**NTAP-20220519-0003**](https://security.netapp.com/advisory/ntap-20220519-0003/) | CVE-2021-20295 QEMU Vulnerability in NetApp Products | 2022-05-19 |
| [**NTAP-20220519-0001**](https://security.netapp.com/advisory/ntap-20220519-0001/) | CVE-2022-0500 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220519-0002**](https://security.netapp.com/advisory/ntap-20220519-0002/) | CVE-2022-0897 Libvirt Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20220519-0005**](https://security.netapp.com/advisory/ntap-20220519-0005/) | CVE-2022-24812 Grafana Vulnerability in NetApp Products | 2022-05-19 |
| [**NTAP-20220519-0004**](https://security.netapp.com/advisory/ntap-20220519-0004/) | CVE-2022-26612 Apache Hadoop Vulnerability in NetApp Products | 2022-05-19 |
| [**NTAP-20220519-0007**](https://security.netapp.com/advisory/ntap-20220519-0007/) | CVE-2022-27376 MariaDB Vulnerability in NetApp Products | 2022-05-19 |
| [**NTAP-20220519-0006**](https://security.netapp.com/advisory/ntap-20220519-0006/) | March 2022 MariaDB Vulnerabilities in NetApp Products | 2022-05-19 |
| [**NTAP-20220513-0001**](https://security.netapp.com/advisory/ntap-20220513-0001/) | April 2022 Linux Kernel 5.17.1 Vulnerabilities in NetApp Products | 2024-05-09 |
| [**NTAP-20220513-0004**](https://security.netapp.com/advisory/ntap-20220513-0004/) | CVE-2021-4147 Libvirt Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20220513-0002**](https://security.netapp.com/advisory/ntap-20220513-0002/) | CVE-2021-4202 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220513-0003**](https://security.netapp.com/advisory/ntap-20220513-0003/) | CVE-2022-0998 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220513-0005**](https://security.netapp.com/advisory/ntap-20220513-0005/) | CVE-2022-1210 LibTIFF Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20220513-0006**](https://security.netapp.com/advisory/ntap-20220513-0006/) | CVE-2022-24785 NPM Vulnerability in NetApp Products | 2022-07-01 |
| [**NTAP-20220506-0006**](https://security.netapp.com/advisory/ntap-20220506-0006/) | April 2022 Linux Kernel Vulnerabilities in NetApp Products | 2023-02-07 |
| [**NTAP-20220506-0005**](https://security.netapp.com/advisory/ntap-20220506-0005/) | April 2022 OpenBSD Vulnerabilities in NetApp Products | 2022-05-16 |
| [**NTAP-20220506-0003**](https://security.netapp.com/advisory/ntap-20220506-0003/) | CVE-2017-12652 Libpng Vulnerability in NetApp Products | 2022-07-01 |
| [**NTAP-20220506-0001**](https://security.netapp.com/advisory/ntap-20220506-0001/) | CVE-2019-5188 E2fsprogs Vulnerability in NetApp Products | 2022-05-06 |
| [**NTAP-20220506-0004**](https://security.netapp.com/advisory/ntap-20220506-0004/) | CVE-2020-36518 FasterXML Jackson Databind Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20220506-0007**](https://security.netapp.com/advisory/ntap-20220506-0007/) | CVE-2022-1055 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220506-0002**](https://security.netapp.com/advisory/ntap-20220506-0002/) | March 2022 LibTIFF Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20220429-0006**](https://security.netapp.com/advisory/ntap-20220429-0006/) | April 2022 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20220429-0005**](https://security.netapp.com/advisory/ntap-20220429-0005/) | April 2022 MySQL Server Vulnerabilities in NetApp Products | 2023-02-07 |
| [**NTAP-20220429-0003**](https://security.netapp.com/advisory/ntap-20220429-0003/) | CVE-2021-3582 QEMU Vulnerability in NetApp Products | 2022-04-29 |
| [**NTAP-20220429-0004**](https://security.netapp.com/advisory/ntap-20220429-0004/) | CVE-2022-26490 Linux Kernel Vulnerability in NetApp Products | 2022-04-29 |
| [**NTAP-20220429-0002**](https://security.netapp.com/advisory/ntap-20220429-0002/) | CVE-2022-27191 Golang Vulnerability in NetApp Products | 2022-04-29 |
| [**NTAP-20220429-0001**](https://security.netapp.com/advisory/ntap-20220429-0001/) | March 2022 Linux Kernel Vulnerabilities in NetApp Products | 2024-05-09 |
| [**NTAP-20220425-0004**](https://security.netapp.com/advisory/ntap-20220425-0004/) | CVE-2021-3748 QEMU Vulnerability in NetApp Products | 2022-04-25 |
| [**NTAP-20220425-0001**](https://security.netapp.com/advisory/ntap-20220425-0001/) | CVE-2022-0742 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220425-0002**](https://security.netapp.com/advisory/ntap-20220425-0002/) | CVE-2022-1011 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220425-0005**](https://security.netapp.com/advisory/ntap-20220425-0005/) | CVE-2022-26148 Grafana Vulnerability in NetApp Products | 2022-04-25 |
| [**NTAP-20220425-0003**](https://security.netapp.com/advisory/ntap-20220425-0003/) | March 2022 QEMU Vulnerabilities in NetApp Products | 2022-04-25 |
| [**NTAP-20220420-0001**](https://security.netapp.com/advisory/ntap-20220420-0001/) | CVE-2021-31805 Apache Struts Vulnerability in NetApp Products | 2022-04-20 |
| [**NTAP-20220419-0004**](https://security.netapp.com/advisory/ntap-20220419-0004/) | CVE-2021-3609 Linux Kernel Vulnerability in NetApp Products | 2022-05-31 |
| [**NTAP-20220419-0002**](https://security.netapp.com/advisory/ntap-20220419-0002/) | CVE-2022-0492 Linux Kernel Vulnerability in NetApp Products | 2022-06-09 |
| [**NTAP-20220419-0005**](https://security.netapp.com/advisory/ntap-20220419-0005/) | CVE-2022-26488 Python Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220419-0003**](https://security.netapp.com/advisory/ntap-20220419-0003/) | February 2022 Linux Kernel 5.15.2 Vulnerabilities in NetApp Products | 2024-05-09 |
| [**NTAP-20220419-0001**](https://security.netapp.com/advisory/ntap-20220419-0001/) | February 2022 Linux Kernel Vulnerabilities in NetApp Products | 2024-05-09 |
| [**NTAP-20220408-0001**](https://security.netapp.com/advisory/ntap-20220408-0001/) | March 2022 ISC BIND Vulnerabilities in NetApp Products | 2022-04-19 |
| [**NTAP-20220407-0003**](https://security.netapp.com/advisory/ntap-20220407-0003/) | CVE-2021-3638 QEMU Vulnerability in NetApp Products | 2022-04-07 |
| [**NTAP-20220407-0002**](https://security.netapp.com/advisory/ntap-20220407-0002/) | CVE-2021-3658 BlueZ Vulnerability in NetApp Products | 2022-04-07 |
| [**NTAP-20220407-0008**](https://security.netapp.com/advisory/ntap-20220407-0008/) | CVE-2021-3677 Postgresql Vulnerability in NetApp Products | 2022-05-04 |
| [**NTAP-20220407-0001**](https://security.netapp.com/advisory/ntap-20220407-0001/) | CVE-2021-3733 Python Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20220407-0009**](https://security.netapp.com/advisory/ntap-20220407-0009/) | CVE-2021-3737 Python Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220407-0006**](https://security.netapp.com/advisory/ntap-20220407-0006/) | CVE-2021-3739 Linux Kernel Vulnerability in NetApp Products | 2022-04-20 |
| [**NTAP-20220407-0007**](https://security.netapp.com/advisory/ntap-20220407-0007/) | CVE-2021-3743 Linux Kernel Vulnerability in NetApp Products | 2022-04-20 |
| [**NTAP-20220407-0005**](https://security.netapp.com/advisory/ntap-20220407-0005/) | CVE-2022-23812 NPM Vulnerability in NetApp Products | 2022-04-07 |
| [**NTAP-20220407-0004**](https://security.netapp.com/advisory/ntap-20220407-0004/) | February 2022 Node.js Vulnerabilities in NetApp Products | 2024-05-09 |
| [**NTAP-20220401-0001**](https://security.netapp.com/advisory/ntap-20220401-0001/) | CVE-2022-22950 Spring Framework Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20220331-0003**](https://security.netapp.com/advisory/ntap-20220331-0003/) | CVE-2020-36516 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220331-0010**](https://security.netapp.com/advisory/ntap-20220331-0010/) | CVE-2021-3631 Libvirt Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220331-0005**](https://security.netapp.com/advisory/ntap-20220331-0005/) | CVE-2021-3667 Libvirt Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220331-0009**](https://security.netapp.com/advisory/ntap-20220331-0009/) | CVE-2022-0516 Linux Kernel Vulnerability in NetApp Products | 2022-04-20 |
| [**NTAP-20220331-0004**](https://security.netapp.com/advisory/ntap-20220331-0004/) | CVE-2022-0543 Redis Vulnerability in NetApp Products | 2022-04-19 |
| [**NTAP-20220331-0002**](https://security.netapp.com/advisory/ntap-20220331-0002/) | CVE-2022-0563 Util-linux Vulnerability in NetApp Products | 2024-07-19 |
| [**NTAP-20220331-0011**](https://security.netapp.com/advisory/ntap-20220331-0011/) | CVE-2022-22965 Spring Framework Vulnerability in NetApp Products | 2022-04-18 |
| [**NTAP-20220331-0008**](https://security.netapp.com/advisory/ntap-20220331-0008/) | CVE-2022-23308 Libxml2 Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220331-0007**](https://security.netapp.com/advisory/ntap-20220331-0007/) | CVE-2022-24685 HashiCorp Nomad Vulnerability in NetApp Products | 2022-03-31 |
| [**NTAP-20220331-0006**](https://security.netapp.com/advisory/ntap-20220331-0006/) | CVE-2022-24687 HashiCorp Consul Vulnerability in NetApp Products | 2022-03-31 |
| [**NTAP-20220331-0001**](https://security.netapp.com/advisory/ntap-20220331-0001/) | CVE-2022-25365 Docker Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220325-0003**](https://security.netapp.com/advisory/ntap-20220325-0003/) | CVE-2019-14844 MIT Kerberos 5 Vulnerability in NetApp Products | 2022-06-13 |
| [**NTAP-20220325-0004**](https://security.netapp.com/advisory/ntap-20220325-0004/) | CVE-2021-21708 PHP Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220325-0011**](https://security.netapp.com/advisory/ntap-20220325-0011/) | CVE-2021-25217 ISC DHCP Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20220325-0005**](https://security.netapp.com/advisory/ntap-20220325-0005/) | CVE-2022-0847 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220325-0008**](https://security.netapp.com/advisory/ntap-20220325-0008/) | CVE-2022-23395 Node.js Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220325-0009**](https://security.netapp.com/advisory/ntap-20220325-0009/) | CVE-2022-23710 Elasticsearch Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220325-0010**](https://security.netapp.com/advisory/ntap-20220325-0010/) | CVE-2022-24921 Golang Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220325-0002**](https://security.netapp.com/advisory/ntap-20220325-0002/) | CVE-2022-25636 Linux Kernel Vulnerability in NetApp Products | 2023-07-26 |
| [**NTAP-20220325-0001**](https://security.netapp.com/advisory/ntap-20220325-0001/) | March 2021 Grub2 Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20220325-0007**](https://security.netapp.com/advisory/ntap-20220325-0007/) | March 2022 Node.js Vulnerabilities in NetApp Products | 2022-06-13 |
| [**NTAP-20220325-0006**](https://security.netapp.com/advisory/ntap-20220325-0006/) | March 2022 NPM Vulnerabilities in NetApp Products | 2022-06-13 |
| [**NTAP-20220324-0001**](https://security.netapp.com/advisory/ntap-20220324-0001/) | CVE-2022-23235 Information Disclosure Vulnerability in Active IQ Unified Manager | 2022-03-24 |
| [**NTAP-20220321-0002**](https://security.netapp.com/advisory/ntap-20220321-0002/) | CVE-2022-0778 OpenSSL Vulnerability in NetApp Products | 2024-10-07 |
| [**NTAP-20220321-0001**](https://security.netapp.com/advisory/ntap-20220321-0001/) | March 2022 Apache HTTP Server Vulnerabilities in NetApp Products | 2022-04-19 |
| [**NTAP-20220318-0009**](https://security.netapp.com/advisory/ntap-20220318-0009/) | CVE-2021-3752 Linux Kernel Vulnerability in NetApp Products | 2022-06-13 |
| [**NTAP-20220318-0007**](https://security.netapp.com/advisory/ntap-20220318-0007/) | CVE-2021-3760 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220318-0003**](https://security.netapp.com/advisory/ntap-20220318-0003/) | CVE-2021-3947 QEMU Vulnerability in NetApp Products | 2022-03-18 |
| [**NTAP-20220318-0010**](https://security.netapp.com/advisory/ntap-20220318-0010/) | CVE-2021-4090 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220318-0006**](https://security.netapp.com/advisory/ntap-20220318-0006/) | CVE-2022-0646 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20220318-0005**](https://security.netapp.com/advisory/ntap-20220318-0005/) | CVE-2022-25265 Linux Kernel Vulnerability in NetApp Products | 2022-04-18 |
| [**NTAP-20220318-0008**](https://security.netapp.com/advisory/ntap-20220318-0008/) | February 2022 HashiCorp Vulnerabilities in NetApp Products | 2022-03-18 |
| [**NTAP-20220318-0001**](https://security.netapp.com/advisory/ntap-20220318-0001/) | February 2022 LibTIFF Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20220318-0004**](https://security.netapp.com/advisory/ntap-20220318-0004/) | February 2022 MariaDB Vulnerabilities in NetApp Products | 2022-03-18 |
| [**NTAP-20220318-0002**](https://security.netapp.com/advisory/ntap-20220318-0002/) | February 2022 QEMU Vulnerabilities in NetApp Products | 2022-03-18 |
| [**NTAP-20220311-0001**](https://security.netapp.com/advisory/ntap-20220311-0001/) | CVE-2021-33150 Intel Trace Hub Vulnerability in NetApp Products | 2022-05-16 |
| [**NTAP-20220311-0004**](https://security.netapp.com/advisory/ntap-20220311-0004/) | CVE-2021-4145 QEMU Vulnerability in NetApp Products | 2022-03-11 |
| [**NTAP-20220311-0003**](https://security.netapp.com/advisory/ntap-20220311-0003/) | CVE-2021-46659 MariaDB Vulnerability in NetApp Products | 2022-03-11 |
| [**NTAP-20220311-0005**](https://security.netapp.com/advisory/ntap-20220311-0005/) | CVE-2022-21724 PostgreSQL JDBC Driver Vulnerability in NetApp Products | 2022-03-11 |
| [**NTAP-20220311-0002**](https://security.netapp.com/advisory/ntap-20220311-0002/) | CVE-2022-22844 LibTIFF Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220303-0002**](https://security.netapp.com/advisory/ntap-20220303-0002/) | CVE-2021-20322 Linux Kernel Vulnerability in NetApp Products | 2024-04-25 |
| [**NTAP-20220303-0006**](https://security.netapp.com/advisory/ntap-20220303-0006/) | CVE-2021-41816 Ruby Vulnerability in NetApp Products | 2022-03-07 |
| [**NTAP-20220303-0001**](https://security.netapp.com/advisory/ntap-20220303-0001/) | CVE-2021-45346 SQLite Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220303-0004**](https://security.netapp.com/advisory/ntap-20220303-0004/) | CVE-2022-21673 Grafana Vulnerability in NetApp Products | 2022-03-03 |
| [**NTAP-20220303-0009**](https://security.netapp.com/advisory/ntap-20220303-0009/) | CVE-2022-23232 Access Bypass Vulnerability in StorageGRID (formerly StorageGRID Webscale) | 2022-03-03 |
| [**NTAP-20220303-0010**](https://security.netapp.com/advisory/ntap-20220303-0010/) | CVE-2022-23233 Denial of Service Vulnerability in StorageGRID (formerly StorageGRID Webscale) | 2022-03-03 |
| [**NTAP-20220303-0003**](https://security.netapp.com/advisory/ntap-20220303-0003/) | CVE-2022-23913 Apache ActiveMQ Artemis Vulnerability in NetApp Products | 2023-03-07 |
| [**NTAP-20220303-0008**](https://security.netapp.com/advisory/ntap-20220303-0008/) | February 2022 Expat Vulnerabilities in NetApp Products | 2022-08-29 |
| [**NTAP-20220303-0005**](https://security.netapp.com/advisory/ntap-20220303-0005/) | February 2022 Grafana Vulnerabilities in NetApp Products | 2022-03-07 |
| [**NTAP-20220303-0007**](https://security.netapp.com/advisory/ntap-20220303-0007/) | February 2022 NGINX Vulnerabilities in NetApp Products | 2024-01-02 |
| [**NTAP-20220228-0001**](https://security.netapp.com/advisory/ntap-20220228-0001/) | CVE-2022-23234 Information Disclosure Vulnerability in SnapCenter | 2022-02-28 |
| [**NTAP-20220225-0002**](https://security.netapp.com/advisory/ntap-20220225-0002/) | CVE-2020-8562 Kubernetes Vulnerability in NetApp Products | 2022-04-28 |
| [**NTAP-20220225-0005**](https://security.netapp.com/advisory/ntap-20220225-0005/) | CVE-2021-20373 IBM DB2 Vulnerability in NetApp Products | 2022-02-25 |
| [**NTAP-20220225-0007**](https://security.netapp.com/advisory/ntap-20220225-0007/) | CVE-2021-3930 QEMU Vulnerability in NetApp Products | 2022-02-25 |
| [**NTAP-20220225-0004**](https://security.netapp.com/advisory/ntap-20220225-0004/) | CVE-2021-4154 Linux Kernel Vulnerability in NetApp Products | 2023-05-22 |
| [**NTAP-20220225-0001**](https://security.netapp.com/advisory/ntap-20220225-0001/) | CVE-2021-44521 Apache Cassandra Vulnerability in NetApp Products | 2022-02-25 |
| [**NTAP-20220225-0003**](https://security.netapp.com/advisory/ntap-20220225-0003/) | CVE-2022-0185 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220225-0009**](https://security.netapp.com/advisory/ntap-20220225-0009/) | CVE-2022-0391 Python Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220225-0008**](https://security.netapp.com/advisory/ntap-20220225-0008/) | CVE-2022-24958 Linux Kernel Vulnerability in NetApp Products | 2022-04-14 |
| [**NTAP-20220225-0006**](https://security.netapp.com/advisory/ntap-20220225-0006/) | February 2022 Golang Vulnerabilities in NetApp Products | 2023-03-07 |
| [**NTAP-20220223-0004**](https://security.netapp.com/advisory/ntap-20220223-0004/) | CVE-2019-12532 InsydeH2O Vulnerability in NetApp Products | 2022-02-23 |
| [**NTAP-20220223-0003**](https://security.netapp.com/advisory/ntap-20220223-0003/) | CVE-2020-5955 InsydeH2O Vulnerability in NetApp Products | 2022-02-23 |
| [**NTAP-20220223-0001**](https://security.netapp.com/advisory/ntap-20220223-0001/) | CVE-2020-5956 InsydeH2O Vulnerability in NetApp Products | 2022-02-23 |
| [**NTAP-20220223-0002**](https://security.netapp.com/advisory/ntap-20220223-0002/) | CVE-2021-41842 InsydeH2O Vulnerability in NetApp Products | 2023-09-15 |
| [**NTAP-20220222-0005**](https://security.netapp.com/advisory/ntap-20220222-0005/) | CVE-2020-5953 InsydeH20 Vulnerability in NetApp Products | 2022-02-22 |
| [**NTAP-20220222-0004**](https://security.netapp.com/advisory/ntap-20220222-0004/) | CVE-2021-33625 InsydeH20 Vulnerability in NetApp Products | 2022-08-24 |
| [**NTAP-20220222-0002**](https://security.netapp.com/advisory/ntap-20220222-0002/) | CVE-2021-33627 InsydeH20 Vulnerability in NetApp Products | 2023-01-17 |
| [**NTAP-20220222-0003**](https://security.netapp.com/advisory/ntap-20220222-0003/) | CVE-2021-41837 InsydeH20 Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20220222-0001**](https://security.netapp.com/advisory/ntap-20220222-0001/) | CVE-2021-41838 InsydeH20 Vulnerability in NetApp Products | 2022-11-21 |
| [**NTAP-20220221-0004**](https://security.netapp.com/advisory/ntap-20220221-0004/) | CVE-2019-16884 Docker Vulnerability in NetApp Products | 2022-04-28 |
| [**NTAP-20220221-0001**](https://security.netapp.com/advisory/ntap-20220221-0001/) | CVE-2022-24122 Linux Kernel Vulnerability in NetApp Products | 2023-07-26 |
| [**NTAP-20220221-0003**](https://security.netapp.com/advisory/ntap-20220221-0003/) | February 2022 Django Vulnerabilities in NetApp Products | 2022-04-21 |
| [**NTAP-20220221-0002**](https://security.netapp.com/advisory/ntap-20220221-0002/) | January 2022 MariaDB Vulnerabilities in NetApp Products | 2022-02-21 |
| [**NTAP-20220217-0003**](https://security.netapp.com/advisory/ntap-20220217-0003/) | CVE-2021-25743 Kubernetes Vulnerability in NetApp Products | 2022-02-17 |
| [**NTAP-20220217-0011**](https://security.netapp.com/advisory/ntap-20220217-0011/) | CVE-2021-27796 Brocade Fabric Operating System Firmware Vulnerability | 2022-02-17 |
| [**NTAP-20220217-0004**](https://security.netapp.com/advisory/ntap-20220217-0004/) | CVE-2021-29632 FreeBSD Vulnerability in NetApp Products | 2022-02-17 |
| [**NTAP-20220217-0008**](https://security.netapp.com/advisory/ntap-20220217-0008/) | CVE-2021-34866 Linux Kernel Vulnerability in NetApp Products | 2022-03-11 |
| [**NTAP-20220217-0009**](https://security.netapp.com/advisory/ntap-20220217-0009/) | CVE-2021-39293 Golang Vulnerability in NetApp Products | 2022-04-20 |
| [**NTAP-20220217-0005**](https://security.netapp.com/advisory/ntap-20220217-0005/) | CVE-2021-4083 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220217-0016**](https://security.netapp.com/advisory/ntap-20220217-0016/) | CVE-2021-41839 InsydeH20 Vulnerability in NetApp Products | 2022-11-21 |
| [**NTAP-20220217-0014**](https://security.netapp.com/advisory/ntap-20220217-0014/) | CVE-2021-41840 InsydeH20 Vulnerability in NetApp Products | 2022-02-17 |
| [**NTAP-20220217-0012**](https://security.netapp.com/advisory/ntap-20220217-0012/) | CVE-2021-41841 InsydeH20 Vulnerability in NetApp Products | 2023-01-13 |
| [**NTAP-20220217-0015**](https://security.netapp.com/advisory/ntap-20220217-0015/) | CVE-2021-42060 InsydeH20 Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20220217-0013**](https://security.netapp.com/advisory/ntap-20220217-0013/) | CVE-2021-43323 InsydeH20 Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20220217-0010**](https://security.netapp.com/advisory/ntap-20220217-0010/) | CVE-2022-23181 Apache Tomcat Vulnerability in NetApp Products | 2023-07-26 |
| [**NTAP-20220217-0002**](https://security.netapp.com/advisory/ntap-20220217-0002/) | CVE-2022-23222 Linux Kernel Vulnerability in NetApp Products | 2022-03-11 |
| [**NTAP-20220217-0006**](https://security.netapp.com/advisory/ntap-20220217-0006/) | CVE-2022-23302 Apache Log4j Vulnerability in NetApp Products | 2022-06-06 |
| [**NTAP-20220217-0007**](https://security.netapp.com/advisory/ntap-20220217-0007/) | CVE-2022-23305 Apache Log4j Vulnerability in NetApp Products | 2022-06-06 |
| [**NTAP-20220217-0001**](https://security.netapp.com/advisory/ntap-20220217-0001/) | CVE-2022-23852 Expat Vulnerability in NetApp Products | 2023-10-04 |
| [**NTAP-20220216-0005**](https://security.netapp.com/advisory/ntap-20220216-0005/) | CVE-2020-27339 InsydeH2O Vulnerability in NetApp Products | 2022-02-17 |
| [**NTAP-20220216-0001**](https://security.netapp.com/advisory/ntap-20220216-0001/) | CVE-2021-27797 Brocade Fabric Operating System Firmware Vulnerability | 2022-02-16 |
| [**NTAP-20220216-0006**](https://security.netapp.com/advisory/ntap-20220216-0006/) | CVE-2021-33626 InsydeH2O Vulnerability in NetApp Products | 2022-11-21 |
| [**NTAP-20220216-0008**](https://security.netapp.com/advisory/ntap-20220216-0008/) | CVE-2021-42059 InsydeH20 Vulnerability in NetApp Products | 2022-02-17 |
| [**NTAP-20220216-0012**](https://security.netapp.com/advisory/ntap-20220216-0012/) | CVE-2021-42113 InsydeH20 Vulnerability in NetApp Products | 2022-02-17 |
| [**NTAP-20220216-0007**](https://security.netapp.com/advisory/ntap-20220216-0007/) | CVE-2021-42554 InsydeH2O Vulnerability in NetApp Products | 2023-01-13 |
| [**NTAP-20220216-0003**](https://security.netapp.com/advisory/ntap-20220216-0003/) | CVE-2021-43522 InsydeH20 Vulnerability in NetApp Products | 2022-02-17 |
| [**NTAP-20220216-0010**](https://security.netapp.com/advisory/ntap-20220216-0010/) | CVE-2021-43615 InsydeH20 Vulnerability in NetApp Products | 2022-02-17 |
| [**NTAP-20220216-0011**](https://security.netapp.com/advisory/ntap-20220216-0011/) | CVE-2022-24030 InsydeH20 Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20220216-0009**](https://security.netapp.com/advisory/ntap-20220216-0009/) | CVE-2022-24031 InsydeH20 Vulnerability in NetApp Products | 2022-11-21 |
| [**NTAP-20220216-0002**](https://security.netapp.com/advisory/ntap-20220216-0002/) | CVE-2022-24069 InsydeH20 Vulnerability in NetApp Products | 2024-12-04 |
| [**NTAP-20220216-0004**](https://security.netapp.com/advisory/ntap-20220216-0004/) | January 2022 InsydeH2O Vulnerabilities in NetApp Products | 2022-11-21 |
| [**NTAP-20220211-0001**](https://security.netapp.com/advisory/ntap-20220211-0001/) | CVE-2019-14888 Undertow Vulnerability in NetApp Products | 2022-05-20 |
| [**NTAP-20220211-0002**](https://security.netapp.com/advisory/ntap-20220211-0002/) | CVE-2019-19343 Undertow Vulnerability in NetApp Products | 2022-05-20 |
| [**NTAP-20220210-0018**](https://security.netapp.com/advisory/ntap-20220210-0018/) | CVE-2019-10174 Infinispan Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20220210-0016**](https://security.netapp.com/advisory/ntap-20220210-0016/) | CVE-2019-10184 Undertow Vulnerability in NetApp Products | 2022-05-20 |
| [**NTAP-20220210-0017**](https://security.netapp.com/advisory/ntap-20220210-0017/) | CVE-2019-10212 Undertow Vulnerability in NetApp Products | 2022-05-20 |
| [**NTAP-20220210-0024**](https://security.netapp.com/advisory/ntap-20220210-0024/) | CVE-2019-10219 Hibernate Vulnerability in NetApp Products | 2023-08-08 |
| [**NTAP-20220210-0020**](https://security.netapp.com/advisory/ntap-20220210-0020/) | CVE-2019-14900 Hibernate ORM Vulnerability in NetApp Products | 2024-05-15 |
| [**NTAP-20220210-0019**](https://security.netapp.com/advisory/ntap-20220210-0019/) | CVE-2019-3888 Undertow Vulnerability in NetApp Products | 2022-05-20 |
| [**NTAP-20220210-0015**](https://security.netapp.com/advisory/ntap-20220210-0015/) | CVE-2020-10687 Undertow Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20220210-0002**](https://security.netapp.com/advisory/ntap-20220210-0002/) | CVE-2020-13956 Apache HttpClient Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20220210-0001**](https://security.netapp.com/advisory/ntap-20220210-0001/) | CVE-2020-1954 Apache CXF Vulnerability in NetApp Products | 2022-04-19 |
| [**NTAP-20220210-0023**](https://security.netapp.com/advisory/ntap-20220210-0023/) | CVE-2020-25711 Infinispan Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20220210-0003**](https://security.netapp.com/advisory/ntap-20220210-0003/) | CVE-2020-8908 Guava Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20220210-0005**](https://security.netapp.com/advisory/ntap-20220210-0005/) | CVE-2021-0060 Intel SPS Vulnerability in NetApp Products | 2022-10-11 |
| [**NTAP-20220210-0008**](https://security.netapp.com/advisory/ntap-20220210-0008/) | CVE-2021-0127 Intel Processor Vulnerability in NetApp Products | 2023-01-06 |
| [**NTAP-20220210-0009**](https://security.netapp.com/advisory/ntap-20220210-0009/) | CVE-2021-0145 Intel Processor Vulnerability in NetApp Products | 2022-08-11 |
| [**NTAP-20220210-0013**](https://security.netapp.com/advisory/ntap-20220210-0013/) | CVE-2021-20220 Undertow Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20220210-0011**](https://security.netapp.com/advisory/ntap-20220210-0011/) | CVE-2021-21290 Apache Netty Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20220210-0004**](https://security.netapp.com/advisory/ntap-20220210-0004/) | CVE-2021-29425 Apache Commons IO Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20220210-0006**](https://security.netapp.com/advisory/ntap-20220210-0006/) | CVE-2021-33068 Intel AMT Vulnerability in NetApp Products | 2022-08-10 |
| [**NTAP-20220210-0021**](https://security.netapp.com/advisory/ntap-20220210-0021/) | CVE-2021-3690 Undertow Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20220210-0022**](https://security.netapp.com/advisory/ntap-20220210-0022/) | CVE-2021-37714 jsoup Vulnerability in NetApp Products | 2022-11-04 |
| [**NTAP-20220210-0012**](https://security.netapp.com/advisory/ntap-20220210-0012/) | February 2022 Apache Netty Vulnerabilities in NetApp Products | 2024-03-11 |
| [**NTAP-20220210-0014**](https://security.netapp.com/advisory/ntap-20220210-0014/) | February 2022 Undertow Vulnerabilities in NetApp Products | 2024-11-11 |
| [**NTAP-20220210-0007**](https://security.netapp.com/advisory/ntap-20220210-0007/) | Intel SA-00527 BIOS Firmware Vulnerabilities in NetApp Products | 2022-09-07 |
| [**NTAP-20220210-0010**](https://security.netapp.com/advisory/ntap-20220210-0010/) | Intel SA-00571 Ethernet Controller Vulnerabilities in NetApp Products | 2022-02-18 |
| [**NTAP-20220209-0002**](https://security.netapp.com/advisory/ntap-20220209-0002/) | CVE-2022-21676 NPM Vulnerability in NetApp Products | 2022-06-13 |
| [**NTAP-20220204-0003**](https://security.netapp.com/advisory/ntap-20220204-0003/) | CVE-2020-25638 Hibernate ORM Vulnerability in NetApp Products | 2022-08-03 |
| [**NTAP-20220204-0002**](https://security.netapp.com/advisory/ntap-20220204-0002/) | CVE-2021-22696 Apache CXF Vulnerability in NetApp Products | 2022-02-04 |
| [**NTAP-20220204-0005**](https://security.netapp.com/advisory/ntap-20220204-0005/) | CVE-2021-4160 OpenSSL Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220204-0004**](https://security.netapp.com/advisory/ntap-20220204-0004/) | CVE-2022-23307 Apache Log4j Vulnerability in NetApp Products | 2022-07-26 |
| [**NTAP-20220204-0006**](https://security.netapp.com/advisory/ntap-20220204-0006/) | CVE-2022-23990 Expat Vulnerability in NetApp Products | 2023-02-10 |
| [**NTAP-20220204-0001**](https://security.netapp.com/advisory/ntap-20220204-0001/) | March 2020 Apache Netty Vulnerabilities in NetApp Products | 2022-02-04 |
| [**NTAP-20220201-0001**](https://security.netapp.com/advisory/ntap-20220201-0001/) | CVE-2021-44141 Samba Vulnerability in NetApp Products | 2022-02-01 |
| [**NTAP-20220201-0002**](https://security.netapp.com/advisory/ntap-20220201-0002/) | CVE-2021-44142 Samba Vulnerability in NetApp Products | 2022-02-01 |
| [**NTAP-20220201-0003**](https://security.netapp.com/advisory/ntap-20220201-0003/) | CVE-2022-0336 Samba Vulnerability in NetApp Products | 2022-02-01 |
| [**NTAP-20220131-0001**](https://security.netapp.com/advisory/ntap-20220131-0001/) | CVE-2021-22060 Spring Framework Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20220131-0002**](https://security.netapp.com/advisory/ntap-20220131-0002/) | CVE-2021-41817 Ruby Vulnerability in NetApp Products | 2022-03-07 |
| [**NTAP-20220131-0005**](https://security.netapp.com/advisory/ntap-20220131-0005/) | CVE-2022-22846 Python Vulnerability in NetApp Products | 2022-04-25 |
| [**NTAP-20220131-0004**](https://security.netapp.com/advisory/ntap-20220131-0004/) | January 2022 Expat Vulnerabilities in NetApp Products | 2022-09-26 |
| [**NTAP-20220131-0003**](https://security.netapp.com/advisory/ntap-20220131-0003/) | January 2022 GNU C Library Vulnerabilities in NetApp Products | 2023-05-22 |
| [**NTAP-20220128-0001**](https://security.netapp.com/advisory/ntap-20220128-0001/) | CVE-2021-4034 PolicyKit Privilege Escalation Vulnerability in NetApp Products | 2022-01-28 |
| [**NTAP-20220121-0003**](https://security.netapp.com/advisory/ntap-20220121-0003/) | CVE-2021-41819 Ruby Vulnerability in NetApp Products | 2022-02-01 |
| [**NTAP-20220121-0002**](https://security.netapp.com/advisory/ntap-20220121-0002/) | CVE-2021-44716 Golang Vulnerability in NetApp Products | 2022-05-12 |
| [**NTAP-20220121-0001**](https://security.netapp.com/advisory/ntap-20220121-0001/) | CVE-2021-45485 Linux Kernel Vulnerability in NetApp Products | 2023-05-22 |
| [**NTAP-20220121-0004**](https://security.netapp.com/advisory/ntap-20220121-0004/) | CVE-2021-45960 Expat Vulnerability in NetApp Products | 2022-08-29 |
| [**NTAP-20220121-0006**](https://security.netapp.com/advisory/ntap-20220121-0006/) | CVE-2021-46143 Expat Vulnerability in NetApp Products | 2023-02-10 |
| [**NTAP-20220121-0005**](https://security.netapp.com/advisory/ntap-20220121-0005/) | January 2022 Django Vulnerabilities in NetApp Products | 2022-01-25 |
| [**NTAP-20220121-0007**](https://security.netapp.com/advisory/ntap-20220121-0007/) | January 2022 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2024-02-29 |
| [**NTAP-20220121-0008**](https://security.netapp.com/advisory/ntap-20220121-0008/) | January 2022 MySQL Server Vulnerabilities in NetApp Products | 2022-09-01 |
| [**NTAP-20220119-0001**](https://security.netapp.com/advisory/ntap-20220119-0001/) | CVE-2021-42392 H2 Database Vulnerability in NetApp Products | 2022-01-19 |
| [**NTAP-20220114-0001**](https://security.netapp.com/advisory/ntap-20220114-0001/) | CVE-2021-38931 IBM DB2 Vulnerability in NetApp Products | 2022-01-14 |
| [**NTAP-20220114-0005**](https://security.netapp.com/advisory/ntap-20220114-0005/) | CVE-2021-44548 Apache Solr Vulnerability in NetApp Products | 2022-01-14 |
| [**NTAP-20220114-0002**](https://security.netapp.com/advisory/ntap-20220114-0002/) | December 2021 IBM DB2 Vulnerabilities in NetApp Products | 2022-06-27 |
| [**NTAP-20220114-0003**](https://security.netapp.com/advisory/ntap-20220114-0003/) | January 2022 Linux Kernel Vulnerabilities in NetApp Products | 2022-06-09 |
| [**NTAP-20220114-0004**](https://security.netapp.com/advisory/ntap-20220114-0004/) | January 2022 X.Org X Server Vulnerabilities in NetApp Products | 2022-01-21 |
| [**NTAP-20220110-0002**](https://security.netapp.com/advisory/ntap-20220110-0002/) | CVE-2021-20316 Samba Vulnerability in NetApp Products | 2022-01-10 |
| [**NTAP-20220110-0001**](https://security.netapp.com/advisory/ntap-20220110-0001/) | CVE-2021-43566 Samba Vulnerability in NetApp Products | 2022-01-10 |
| [**NTAP-20220107-0003**](https://security.netapp.com/advisory/ntap-20220107-0003/) | CVE-2021-43797 Apache Netty Vulnerability in NetApp Products | 2022-09-01 |
| [**NTAP-20220107-0005**](https://security.netapp.com/advisory/ntap-20220107-0005/) | CVE-2021-43818 lxml Vulnerability in NetApp Products | 2022-06-02 |
| [**NTAP-20220107-0002**](https://security.netapp.com/advisory/ntap-20220107-0002/) | CVE-2021-45078 GNU Binutils Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20220107-0001**](https://security.netapp.com/advisory/ntap-20220107-0001/) | CVE-2021-45100 Linux Kernel Vulnerability in NetApp Products | 2022-02-16 |
| [**NTAP-20220107-0004**](https://security.netapp.com/advisory/ntap-20220107-0004/) | CVE-2021-45459 Node.js Vulnerability in NetApp Products | 2022-02-02 |
| [**NTAP-20220107-0006**](https://security.netapp.com/advisory/ntap-20220107-0006/) | January 2022 Grafana Vulnerabilities in NetApp Products | 2022-01-27 |
| [**NTAP-20220104-0001**](https://security.netapp.com/advisory/ntap-20220104-0001/) | CVE-2021-44832 Apache Log4j Vulnerability in NetApp Products | 2022-01-31 |
| [**NTAP-20211229-0005**](https://security.netapp.com/advisory/ntap-20211229-0005/) | CVE-2018-25020 Linux Kernel Vulnerability in NetApp Products | 2022-02-16 |
| [**NTAP-20211229-0003**](https://security.netapp.com/advisory/ntap-20211229-0003/) | CVE-2021-4044 OpenSSL Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20211229-0007**](https://security.netapp.com/advisory/ntap-20211229-0007/) | CVE-2021-41805 HashiCorp Consul Vulnerability in NetApp Products | 2021-12-29 |
| [**NTAP-20211229-0001**](https://security.netapp.com/advisory/ntap-20211229-0001/) | CVE-2021-42550 Logback Vulnerability in NetApp Products | 2022-12-23 |
| [**NTAP-20211229-0002**](https://security.netapp.com/advisory/ntap-20211229-0002/) | CVE-2021-43527 Libnss Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20211229-0006**](https://security.netapp.com/advisory/ntap-20211229-0006/) | CVE-2021-44420 Django Vulnerability in NetApp Products | 2022-01-25 |
| [**NTAP-20211229-0004**](https://security.netapp.com/advisory/ntap-20211229-0004/) | December 2021 Grafana Vulnerabilities in NetApp Products | 2022-01-05 |
| [**NTAP-20211224-0001**](https://security.netapp.com/advisory/ntap-20211224-0001/) | December 2021 Apache HTTP Server Vulnerabilities in NetApp Products | 2022-01-28 |
| [**NTAP-20211223-0003**](https://security.netapp.com/advisory/ntap-20211223-0003/) | CVE-2017-5123 Linux Kernel Vulnerability in NetApp Products | 2022-01-07 |
| [**NTAP-20211223-0005**](https://security.netapp.com/advisory/ntap-20211223-0005/) | CVE-2021-21707 PHP Vulnerability in NetApp Products | 2022-06-07 |
| [**NTAP-20211223-0004**](https://security.netapp.com/advisory/ntap-20211223-0004/) | CVE-2021-23732 Node.js Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20211223-0008**](https://security.netapp.com/advisory/ntap-20211223-0008/) | CVE-2021-27007 Remote Code Execution Vulnerability in NetApp Virtual Desktop Service (VDS) | 2021-12-23 |
| [**NTAP-20211223-0007**](https://security.netapp.com/advisory/ntap-20211223-0007/) | CVE-2021-4104 Apache Log4j Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211223-0001**](https://security.netapp.com/advisory/ntap-20211223-0001/) | CVE-2021-41244 Grafana Vulnerability in NetApp Products | 2021-12-23 |
| [**NTAP-20211223-0002**](https://security.netapp.com/advisory/ntap-20211223-0002/) | November 2021 BusyBox Vulnerabilities in NetApp Products | 2022-02-16 |
| [**NTAP-20211223-0006**](https://security.netapp.com/advisory/ntap-20211223-0006/) | November 2021 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2022-04-01 |
| [**NTAP-20211221-0001**](https://security.netapp.com/advisory/ntap-20211221-0001/) | CVE-2021-27006 Privilege Escalation Vulnerability in StorageGRID (formerly StorageGRID Webscale) | 2021-12-21 |
| [**NTAP-20211218-0001**](https://security.netapp.com/advisory/ntap-20211218-0001/) | CVE-2021-45105 Apache Log4j Vulnerability in NetApp Products | 2022-06-21 |
| [**NTAP-20211215-0001**](https://security.netapp.com/advisory/ntap-20211215-0001/) | CVE-2021-45046 Apache Log4j Vulnerability in NetApp Products | 2022-06-21 |
| [**NTAP-20211210-0002**](https://security.netapp.com/advisory/ntap-20211210-0002/) | CVE-2021-43616 NPM Vulnerability in NetApp Products | 2022-03-15 |
| [**NTAP-20211210-0007**](https://security.netapp.com/advisory/ntap-20211210-0007/) | CVE-2021-44228 Apache Log4j Vulnerability in NetApp Products | 2022-06-21 |
| [**NTAP-20211210-0006**](https://security.netapp.com/advisory/ntap-20211210-0006/) | Intel SA-00528 Intel Processor Vulnerability in NetApp Products | 2022-01-25 |
| [**NTAP-20211210-0004**](https://security.netapp.com/advisory/ntap-20211210-0004/) | Intel SA-00554 Ethernet Controller Vulnerabilities in NetApp Products | 2021-12-11 |
| [**NTAP-20211210-0005**](https://security.netapp.com/advisory/ntap-20211210-0005/) | Intel SA-00555 Ethernet Controller Vulnerabilities in NetApp Products | 2021-12-11 |
| [**NTAP-20211210-0003**](https://security.netapp.com/advisory/ntap-20211210-0003/) | November 2021 Golang Vulnerabilities in NetApp Products | 2022-02-02 |
| [**NTAP-20211210-0001**](https://security.netapp.com/advisory/ntap-20211210-0001/) | November 2021 Linux Kernel Vulnerabilities in NetApp Products | 2022-02-16 |
| [**NTAP-20211206-0001**](https://security.netapp.com/advisory/ntap-20211206-0001/) | November 2021 Samba Vulnerabilities in NetApp Products | 2021-12-06 |
| [**NTAP-20211203-0005**](https://security.netapp.com/advisory/ntap-20211203-0005/) | CVE-2021-23718 Node.js Vulnerability in NetApp Products | 2022-01-07 |
| [**NTAP-20211203-0001**](https://security.netapp.com/advisory/ntap-20211203-0001/) | CVE-2021-25742 Kubernetes Vulnerability in NetApp Products | 2022-02-02 |
| [**NTAP-20211203-0003**](https://security.netapp.com/advisory/ntap-20211203-0003/) | CVE-2021-3715 Linux Kernel Vulnerability in NetApp Products | 2022-04-19 |
| [**NTAP-20211203-0004**](https://security.netapp.com/advisory/ntap-20211203-0004/) | CVE-2021-41229 BlueZ Vulnerability in NetApp Products | 2021-12-03 |
| [**NTAP-20211203-0002**](https://security.netapp.com/advisory/ntap-20211203-0002/) | November 2021 BlueZ Vulnerabilities in NetApp Products | 2021-12-03 |
| [**NTAP-20211125-0004**](https://security.netapp.com/advisory/ntap-20211125-0004/) | CVE-2011-1075 FreeBSD Vulnerability in NetApp Products | 2022-01-21 |
| [**NTAP-20211125-0005**](https://security.netapp.com/advisory/ntap-20211125-0005/) | CVE-2021-22096 Spring Framework Vulnerability in NetApp Products | 2022-12-23 |
| [**NTAP-20211125-0003**](https://security.netapp.com/advisory/ntap-20211125-0003/) | CVE-2021-41174 Grafana Vulnerability in NetApp Products | 2021-12-08 |
| [**NTAP-20211125-0001**](https://security.netapp.com/advisory/ntap-20211125-0001/) | CVE-2021-43057 Linux Kernel Vulnerability in NetApp Products | 2022-04-19 |
| [**NTAP-20211125-0002**](https://security.netapp.com/advisory/ntap-20211125-0002/) | CVE-2021-43267 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211118-0003**](https://security.netapp.com/advisory/ntap-20211118-0003/) | CVE-2021-21703 PHP Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211118-0002**](https://security.netapp.com/advisory/ntap-20211118-0002/) | CVE-2021-25219 ISC BIND Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20211118-0006**](https://security.netapp.com/advisory/ntap-20211118-0006/) | CVE-2021-38297 Golang Vulnerability in NetApp Products | 2022-02-02 |
| [**NTAP-20211118-0005**](https://security.netapp.com/advisory/ntap-20211118-0005/) | CVE-2021-42327 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211118-0001**](https://security.netapp.com/advisory/ntap-20211118-0001/) | CVE-2021-42739 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211118-0004**](https://security.netapp.com/advisory/ntap-20211118-0004/) | October 2021 jQuery Vulnerabilities in NetApp Products | 2024-01-02 |
| [**NTAP-20211112-0002**](https://security.netapp.com/advisory/ntap-20211112-0002/) | CVE-2021-22930 Node.js Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211112-0006**](https://security.netapp.com/advisory/ntap-20211112-0006/) | CVE-2021-42252 Linux Kernel Vulnerability in NetApp Products | 2022-02-21 |
| [**NTAP-20211112-0004**](https://security.netapp.com/advisory/ntap-20211112-0004/) | Intel SA-00562 BIOS Firmware Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20211112-0001**](https://security.netapp.com/advisory/ntap-20211112-0001/) | May 2021 Libwebp Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20211112-0005**](https://security.netapp.com/advisory/ntap-20211112-0005/) | October 2021 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2022-04-01 |
| [**NTAP-20211112-0003**](https://security.netapp.com/advisory/ntap-20211112-0003/) | October 2021 PostgreSQL Vulnerabilities in NetApp Products | 2021-11-12 |
| [**NTAP-20211104-0008**](https://security.netapp.com/advisory/ntap-20211104-0008/) | CVE-2021-33910 Systemd Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20211104-0005**](https://security.netapp.com/advisory/ntap-20211104-0005/) | CVE-2021-3520 lz4 Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211104-0006**](https://security.netapp.com/advisory/ntap-20211104-0006/) | CVE-2021-3580 Nettle Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211104-0007**](https://security.netapp.com/advisory/ntap-20211104-0007/) | CVE-2021-36222 MIT Kerberos 5 Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20211104-0002**](https://security.netapp.com/advisory/ntap-20211104-0002/) | CVE-2021-42008 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211104-0001**](https://security.netapp.com/advisory/ntap-20211104-0001/) | CVE-2021-42340 Apache Tomcat Vulnerability in NetApp Products | 2022-09-09 |
| [**NTAP-20211104-0004**](https://security.netapp.com/advisory/ntap-20211104-0004/) | October 2021 Libwebp Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20211104-0003**](https://security.netapp.com/advisory/ntap-20211104-0003/) | October 2021 Redis Vulnerabilities in NetApp Products | 2021-11-04 |
| [**NTAP-20211029-0007**](https://security.netapp.com/advisory/ntap-20211029-0007/) | CVE-2021-21706 PHP Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211029-0010**](https://security.netapp.com/advisory/ntap-20211029-0010/) | CVE-2021-23449 NPM Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211029-0001**](https://security.netapp.com/advisory/ntap-20211029-0001/) | CVE-2021-27004 Sensitive Information Disclosure Vulnerability in System Manager 9.x | 2021-10-29 |
| [**NTAP-20211029-0002**](https://security.netapp.com/advisory/ntap-20211029-0002/) | CVE-2021-27005 Denial of Service Vulnerability in Clustered Data ONTAP | 2021-10-29 |
| [**NTAP-20211029-0008**](https://security.netapp.com/advisory/ntap-20211029-0008/) | CVE-2021-39226 Grafana Vulnerability in NetApp Products | 2021-10-29 |
| [**NTAP-20211029-0004**](https://security.netapp.com/advisory/ntap-20211029-0004/) | CVE-2021-41864 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20211029-0009**](https://security.netapp.com/advisory/ntap-20211029-0009/) | October 2021 Apache HTTP Server Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20211029-0003**](https://security.netapp.com/advisory/ntap-20211029-0003/) | September 2021 cURL/libcURL Vulnerabilities in NetApp Products | 2022-02-01 |
| [**NTAP-20211029-0005**](https://security.netapp.com/advisory/ntap-20211029-0005/) | September 2021 IBM Db2 Vulnerabilities in NetApp Products | 2021-10-29 |
| [**NTAP-20211029-0006**](https://security.netapp.com/advisory/ntap-20211029-0006/) | September 2021 PHP Vulnerabilities in NetApp Products | 2024-05-09 |
| [**NTAP-20211022-0002**](https://security.netapp.com/advisory/ntap-20211022-0002/) | CVE-2021-20305 Nettle Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20211022-0005**](https://security.netapp.com/advisory/ntap-20211022-0005/) | CVE-2021-35597 MySQL Client Vulnerability in NetApp Products | 2024-05-15 |
| [**NTAP-20211022-0001**](https://security.netapp.com/advisory/ntap-20211022-0001/) | July 2021 Apache Commons Compress Vulnerabilities in NetApp Products | 2022-08-03 |
| [**NTAP-20211022-0004**](https://security.netapp.com/advisory/ntap-20211022-0004/) | October 2021 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2022-11-21 |
| [**NTAP-20211022-0003**](https://security.netapp.com/advisory/ntap-20211022-0003/) | October 2021 MySQL Server Vulnerabilities in NetApp Products | 2022-08-29 |
| [**NTAP-20211018-0001**](https://security.netapp.com/advisory/ntap-20211018-0001/) | CVE-2021-27001 Arbitrary Data Modification Vulnerability in Clustered Data ONTAP | 2021-10-19 |
| [**NTAP-20211014-0005**](https://security.netapp.com/advisory/ntap-20211014-0005/) | CVE-2016-20012 OpenSSH Vulnerability in NetApp Products | 2022-05-04 |
| [**NTAP-20211014-0002**](https://security.netapp.com/advisory/ntap-20211014-0002/) | CVE-2020-8561 Kubernetes Vulnerability in NetApp Products | 2021-10-14 |
| [**NTAP-20211014-0001**](https://security.netapp.com/advisory/ntap-20211014-0001/) | CVE-2021-25740 Kubernetes Vulnerability in NetApp Products | 2021-10-14 |
| [**NTAP-20211014-0003**](https://security.netapp.com/advisory/ntap-20211014-0003/) | CVE-2021-41073 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211014-0004**](https://security.netapp.com/advisory/ntap-20211014-0004/) | CVE-2021-41617 OpenSSH Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20211012-0001**](https://security.netapp.com/advisory/ntap-20211012-0001/) | CVE-2021-27003 X-Frame-Options Header Vulnerability in Clustered Data ONTAP | 2021-10-12 |
| [**NTAP-20211011-0001**](https://security.netapp.com/advisory/ntap-20211011-0001/) | CVE-2021-27002 Sensitive Information Disclosure Vulnerability in NetApp Cloud Manager | 2021-10-11 |
| [**NTAP-20211008-0002**](https://security.netapp.com/advisory/ntap-20211008-0002/) | CVE-2021-22147 Elasticsearch Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211008-0006**](https://security.netapp.com/advisory/ntap-20211008-0006/) | CVE-2021-25741 Kubernetes Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211008-0003**](https://security.netapp.com/advisory/ntap-20211008-0003/) | CVE-2021-38300 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211008-0001**](https://security.netapp.com/advisory/ntap-20211008-0001/) | CVE-2021-40839 Python Vulnerability in NetApp Products | 2023-01-17 |
| [**NTAP-20211008-0005**](https://security.netapp.com/advisory/ntap-20211008-0005/) | CVE-2021-41079 Apache Tomcat Vulnerability in NetApp Products | 2022-01-05 |
| [**NTAP-20211008-0004**](https://security.netapp.com/advisory/ntap-20211008-0004/) | September 2021 Apache HTTP Server Vulnerabilities in NetApp Products | 2022-11-28 |
| [**NTAP-20211004-0002**](https://security.netapp.com/advisory/ntap-20211004-0002/) | CVE-2018-16871 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211004-0004**](https://security.netapp.com/advisory/ntap-20211004-0004/) | CVE-2021-25737 Kubernetes Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20211004-0003**](https://security.netapp.com/advisory/ntap-20211004-0003/) | CVE-2021-3634 libssh Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20211004-0001**](https://security.netapp.com/advisory/ntap-20211004-0001/) | CVE-2021-40490 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20211004-0005**](https://security.netapp.com/advisory/ntap-20211004-0005/) | September 2021 LibTIFF Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20210923-0001**](https://security.netapp.com/advisory/ntap-20210923-0001/) | August 2021 Node.js Vulnerabilities in NetApp Products | 2024-05-09 |
| [**NTAP-20210923-0003**](https://security.netapp.com/advisory/ntap-20210923-0003/) | August 2021 XStream Vulnerabilities in NetApp Products | 2021-10-08 |
| [**NTAP-20210923-0005**](https://security.netapp.com/advisory/ntap-20210923-0005/) | CVE-2021-29630 FreeBSD Vulnerability in NetApp Products | 2022-01-21 |
| [**NTAP-20210923-0004**](https://security.netapp.com/advisory/ntap-20210923-0004/) | CVE-2021-29631 FreeBSD Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210923-0006**](https://security.netapp.com/advisory/ntap-20210923-0006/) | CVE-2021-3713 QEMU Vulnerability in NetApp Products | 2021-09-23 |
| [**NTAP-20210923-0002**](https://security.netapp.com/advisory/ntap-20210923-0002/) | CVE-2021-37750 MIT Kerberos 5 Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210917-0006**](https://security.netapp.com/advisory/ntap-20210917-0006/) | CVE-2020-5398 Spring Framework Vulnerability in NetApp Products | 2021-09-17 |
| [**NTAP-20210917-0003**](https://security.netapp.com/advisory/ntap-20210917-0003/) | CVE-2021-22939 Node.js Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210917-0002**](https://security.netapp.com/advisory/ntap-20210917-0002/) | CVE-2021-30468 Apache CXF Vulnerability in NetApp Products | 2022-07-01 |
| [**NTAP-20210917-0001**](https://security.netapp.com/advisory/ntap-20210917-0001/) | CVE-2021-31810 Ruby Vulnerability in NetApp Products | 2021-10-13 |
| [**NTAP-20210917-0004**](https://security.netapp.com/advisory/ntap-20210917-0004/) | CVE-2021-33193 Apache HTTP Server Vulnerability in NetApp Products | 2023-05-22 |
| [**NTAP-20210917-0005**](https://security.netapp.com/advisory/ntap-20210917-0005/) | CVE-2021-37576 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20210909-0004**](https://security.netapp.com/advisory/ntap-20210909-0004/) | CVE-2020-22403 Node.js Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20210909-0002**](https://security.netapp.com/advisory/ntap-20210909-0002/) | CVE-2021-25218 ISC BIND Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210909-0003**](https://security.netapp.com/advisory/ntap-20210909-0003/) | CVE-2021-36770 Perl Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20210909-0001**](https://security.netapp.com/advisory/ntap-20210909-0001/) | CVE-2021-38166 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210909-0005**](https://security.netapp.com/advisory/ntap-20210909-0005/) | CVE-2021-38604 GNU C Library (glibc) Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210902-0003**](https://security.netapp.com/advisory/ntap-20210902-0003/) | August 2021 cURL/libcURL Vulnerabilities in NetApp Products | 2022-06-29 |
| [**NTAP-20210902-0010**](https://security.netapp.com/advisory/ntap-20210902-0010/) | August 2021 Linux Kernel 5.13.4 Vulnerabilities in NetApp Products | 2022-05-12 |
| [**NTAP-20210902-0004**](https://security.netapp.com/advisory/ntap-20210902-0004/) | August 2021 Ruby Vulnerabilities in NetApp Products | 2021-09-02 |
| [**NTAP-20210902-0009**](https://security.netapp.com/advisory/ntap-20210902-0009/) | CVE-2012-2666 Golang Vulnerability in NetApp Products | 2021-09-02 |
| [**NTAP-20210902-0008**](https://security.netapp.com/advisory/ntap-20210902-0008/) | CVE-2021-29657 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210902-0005**](https://security.netapp.com/advisory/ntap-20210902-0005/) | CVE-2021-33195 Golang Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210902-0006**](https://security.netapp.com/advisory/ntap-20210902-0006/) | CVE-2021-3682 QEMU Vulnerability in NetApp Products | 2021-09-02 |
| [**NTAP-20210902-0002**](https://security.netapp.com/advisory/ntap-20210902-0002/) | CVE-2021-37600 Util-linux Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210902-0007**](https://security.netapp.com/advisory/ntap-20210902-0007/) | CVE-2021-38207 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210902-0001**](https://security.netapp.com/advisory/ntap-20210902-0001/) | July 2021 Apache HTTP Server Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20210827-0010**](https://security.netapp.com/advisory/ntap-20210827-0010/) | August 2021 OpenSSL Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20210827-0001**](https://security.netapp.com/advisory/ntap-20210827-0001/) | CVE-2020-10727 Apache ActiveMQ Artemis Vulnerability in NetApp Products | 2021-08-27 |
| [**NTAP-20210827-0003**](https://security.netapp.com/advisory/ntap-20210827-0003/) | CVE-2020-10771 Infinispan Vulnerability in NetApp Products | 2021-08-27 |
| [**NTAP-20210827-0002**](https://security.netapp.com/advisory/ntap-20210827-0002/) | CVE-2021-26118 Apache ActiveMQ Artemis Vulnerability in NetApp Products | 2021-08-27 |
| [**NTAP-20210827-0004**](https://security.netapp.com/advisory/ntap-20210827-0004/) | CVE-2021-32761 Redis Vulnerability in NetApp Products | 2021-10-22 |
| [**NTAP-20210827-0005**](https://security.netapp.com/advisory/ntap-20210827-0005/) | CVE-2021-35942 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20210827-0009**](https://security.netapp.com/advisory/ntap-20210827-0009/) | Intel SA-00479 Ethernet Controller Vulnerabilities in NetApp Products | 2021-08-27 |
| [**NTAP-20210827-0008**](https://security.netapp.com/advisory/ntap-20210827-0008/) | Intel SA-00515 Ethernet Controller Vulnerabilities in NetApp Products | 2021-08-30 |
| [**NTAP-20210827-0007**](https://security.netapp.com/advisory/ntap-20210827-0007/) | July 2021 Apache Tomcat Vulnerabilities in NetApp Products | 2021-10-22 |
| [**NTAP-20210827-0006**](https://security.netapp.com/advisory/ntap-20210827-0006/) | July 2021 Elasticsearch Vulnerabilities in NetApp Products | 2024-05-01 |
| [**NTAP-20210819-0005**](https://security.netapp.com/advisory/ntap-20210819-0005/) | CVE-2021-22146 Elasticsearch Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210819-0004**](https://security.netapp.com/advisory/ntap-20210819-0004/) | CVE-2021-33909 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20210819-0006**](https://security.netapp.com/advisory/ntap-20210819-0006/) | CVE-2021-34429 Eclipse Jetty Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210819-0003**](https://security.netapp.com/advisory/ntap-20210819-0003/) | CVE-2021-37159 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210819-0007**](https://security.netapp.com/advisory/ntap-20210819-0007/) | July 2021 Apache Ant Vulnerabilities in NetApp Products | 2022-08-03 |
| [**NTAP-20210819-0001**](https://security.netapp.com/advisory/ntap-20210819-0001/) | July 2021 Brocade Fabric OS Vulnerabilities in NetApp Products | 2021-08-19 |
| [**NTAP-20210819-0002**](https://security.netapp.com/advisory/ntap-20210819-0002/) | May 2021 Brocade Fabric OS Vulnerabilities in NetApp Products | 2021-08-19 |
| [**NTAP-20210813-0001**](https://security.netapp.com/advisory/ntap-20210813-0001/) | CVE-2021-31535 X.Org X Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210813-0002**](https://security.netapp.com/advisory/ntap-20210813-0002/) | CVE-2021-32078 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210813-0003**](https://security.netapp.com/advisory/ntap-20210813-0003/) | CVE-2021-34428 Eclipse Jetty Vulnerability in NetApp Products | 2022-11-09 |
| [**NTAP-20210813-0005**](https://security.netapp.com/advisory/ntap-20210813-0005/) | CVE-2021-34558 Golang Vulnerability in NetApp Products | 2022-03-03 |
| [**NTAP-20210813-0004**](https://security.netapp.com/advisory/ntap-20210813-0004/) | CVE-2021-35039 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210805-0006**](https://security.netapp.com/advisory/ntap-20210805-0006/) | CVE-2017-20005 NGINX Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210805-0001**](https://security.netapp.com/advisory/ntap-20210805-0001/) | CVE-2020-28097 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210805-0010**](https://security.netapp.com/advisory/ntap-20210805-0010/) | CVE-2021-22555 Linux Kernel Vulnerability in NetApp Products | 2023-08-03 |
| [**NTAP-20210805-0011**](https://security.netapp.com/advisory/ntap-20210805-0011/) | CVE-2021-26998 Sensitive Information Disclosure Vulnerability in NetApp Cloud Manager | 2021-08-05 |
| [**NTAP-20210805-0012**](https://security.netapp.com/advisory/ntap-20210805-0012/) | CVE-2021-26999 Sensitive Information Disclosure Vulnerability in NetApp Cloud Manager | 2021-08-05 |
| [**NTAP-20210805-0002**](https://security.netapp.com/advisory/ntap-20210805-0002/) | CVE-2021-28691 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210805-0008**](https://security.netapp.com/advisory/ntap-20210805-0008/) | CVE-2021-35042 Django Vulnerability in NetApp Products | 2021-08-05 |
| [**NTAP-20210805-0007**](https://security.netapp.com/advisory/ntap-20210805-0007/) | CVE-2021-3541 Libxml2 Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20210805-0005**](https://security.netapp.com/advisory/ntap-20210805-0005/) | CVE-2021-3612 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210805-0003**](https://security.netapp.com/advisory/ntap-20210805-0003/) | July 2021 Node.js Vulnerabilities in NetApp Products | 2021-11-17 |
| [**NTAP-20210805-0004**](https://security.netapp.com/advisory/ntap-20210805-0004/) | July 2021 QEMU Vulnerabilities in NetApp Products | 2021-08-05 |
| [**NTAP-20210805-0009**](https://security.netapp.com/advisory/ntap-20210805-0009/) | June 2021 Ruby Vulnerabilities in NetApp Products | 2021-08-05 |
| [**NTAP-20210727-0003**](https://security.netapp.com/advisory/ntap-20210727-0003/) | CVE-2002-2438 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210727-0002**](https://security.netapp.com/advisory/ntap-20210727-0002/) | CVE-2013-4536 QEMU Vulnerability in NetApp Products | 2021-07-27 |
| [**NTAP-20210727-0001**](https://security.netapp.com/advisory/ntap-20210727-0001/) | CVE-2019-12067 QEMU Vulnerability in NetApp Products | 2021-07-27 |
| [**NTAP-20210727-0010**](https://security.netapp.com/advisory/ntap-20210727-0010/) | CVE-2020-25097 Squid Vulnerability in NetApp Products | 2021-09-27 |
| [**NTAP-20210727-0006**](https://security.netapp.com/advisory/ntap-20210727-0006/) | CVE-2020-36387 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210727-0005**](https://security.netapp.com/advisory/ntap-20210727-0005/) | CVE-2021-20293 RESTEasy Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20210727-0009**](https://security.netapp.com/advisory/ntap-20210727-0009/) | CVE-2021-28169 Eclipse Jetty Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210727-0008**](https://security.netapp.com/advisory/ntap-20210727-0008/) | CVE-2021-31618 Apache HTTP Server Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210727-0007**](https://security.netapp.com/advisory/ntap-20210727-0007/) | June 2021 cURL/libcURL Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20210727-0004**](https://security.netapp.com/advisory/ntap-20210727-0004/) | June 2021 Django Vulnerabilities in NetApp Products | 2021-07-27 |
| [**NTAP-20210723-0002**](https://security.netapp.com/advisory/ntap-20210723-0002/) | July 2021 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2022-11-21 |
| [**NTAP-20210723-0001**](https://security.netapp.com/advisory/ntap-20210723-0001/) | July 2021 MySQL Vulnerabilities in NetApp Products | 2024-05-01 |
| [**NTAP-20210720-0002**](https://security.netapp.com/advisory/ntap-20210720-0002/) | CVE-2018-25015 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210720-0003**](https://security.netapp.com/advisory/ntap-20210720-0003/) | CVE-2019-25045 Linux Kernel Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20210720-0010**](https://security.netapp.com/advisory/ntap-20210720-0010/) | CVE-2020-27661 QEMU Vulnerability in NetApp Products | 2021-07-20 |
| [**NTAP-20210720-0004**](https://security.netapp.com/advisory/ntap-20210720-0004/) | CVE-2020-36385 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210720-0001**](https://security.netapp.com/advisory/ntap-20210720-0001/) | CVE-2020-7469 FreeBSD Vulnerability in NetApp Products | 2022-03-22 |
| [**NTAP-20210720-0009**](https://security.netapp.com/advisory/ntap-20210720-0009/) | CVE-2021-20181 QEMU Vulnerability in NetApp Products | 2021-07-20 |
| [**NTAP-20210720-0007**](https://security.netapp.com/advisory/ntap-20210720-0007/) | CVE-2021-20461 IBM Cognos Analytics Vulnerability in NetApp Products | 2022-04-01 |
| [**NTAP-20210720-0005**](https://security.netapp.com/advisory/ntap-20210720-0005/) | CVE-2021-29702 IBM DB2 Vulnerability in NetApp Products | 2021-07-20 |
| [**NTAP-20210720-0006**](https://security.netapp.com/advisory/ntap-20210720-0006/) | July 2021 IBM DB2 Vulnerabilities in NetApp Products | 2021-07-20 |
| [**NTAP-20210720-0008**](https://security.netapp.com/advisory/ntap-20210720-0008/) | June 2021 QEMU Vulnerabilities in NetApp Products | 2021-07-20 |
| [**NTAP-20210716-0001**](https://security.netapp.com/advisory/ntap-20210716-0001/) | CVE-2021-0051 Intel SPS Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210716-0002**](https://security.netapp.com/advisory/ntap-20210716-0002/) | CVE-2021-0129 Intel BlueZ Vulnerability in NetApp Products | 2021-07-16 |
| [**NTAP-20210716-0008**](https://security.netapp.com/advisory/ntap-20210716-0008/) | CVE-2021-26707 Node.js Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210716-0005**](https://security.netapp.com/advisory/ntap-20210716-0005/) | CVE-2021-3516 Libxml2 Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20210716-0006**](https://security.netapp.com/advisory/ntap-20210716-0006/) | CVE-2021-3530 GNU Binutils Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20210716-0004**](https://security.netapp.com/advisory/ntap-20210716-0004/) | June 2021 Linux Kernel 5.12.4 Vulnerabilities in NetApp Products | 2024-05-01 |
| [**NTAP-20210716-0003**](https://security.netapp.com/advisory/ntap-20210716-0003/) | June 2021 OpenLDAP Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20210716-0007**](https://security.netapp.com/advisory/ntap-20210716-0007/) | June 2021 Squid Vulnerabilities in NetApp Products | 2021-09-27 |
| [**NTAP-20210713-0001**](https://security.netapp.com/advisory/ntap-20210713-0001/) | CVE-2020-14326 RESTEasy Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20210713-0005**](https://security.netapp.com/advisory/ntap-20210713-0005/) | CVE-2021-22118 Spring Framework Vulnerability in NetApp Products | 2021-10-25 |
| [**NTAP-20210713-0002**](https://security.netapp.com/advisory/ntap-20210713-0002/) | CVE-2021-29628 FreeBSD Vulnerability in NetApp Products | 2021-07-13 |
| [**NTAP-20210713-0003**](https://security.netapp.com/advisory/ntap-20210713-0003/) | CVE-2021-29629 FreeBSD Vulnerability in NetApp Products | 2021-07-13 |
| [**NTAP-20210713-0004**](https://security.netapp.com/advisory/ntap-20210713-0004/) | CVE-2021-32027 PostgreSQL Vulnerability in NetApp Products | 2021-08-05 |
| [**NTAP-20210713-0006**](https://security.netapp.com/advisory/ntap-20210713-0006/) | May 2021 QEMU Vulnerabilities in NetApp Products | 2021-07-13 |
| [**NTAP-20210708-0001**](https://security.netapp.com/advisory/ntap-20210708-0001/) | CVE-2020-10701 Libvirt Vulnerability in NetApp Products | 2021-07-08 |
| [**NTAP-20210708-0004**](https://security.netapp.com/advisory/ntap-20210708-0004/) | CVE-2021-20196 QEMU Vulnerability in NetApp Products | 2021-07-08 |
| [**NTAP-20210708-0005**](https://security.netapp.com/advisory/ntap-20210708-0005/) | CVE-2021-20221 QEMU Vulnerability in NetApp Products | 2021-07-08 |
| [**NTAP-20210708-0002**](https://security.netapp.com/advisory/ntap-20210708-0002/) | CVE-2021-22543 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210708-0006**](https://security.netapp.com/advisory/ntap-20210708-0006/) | CVE-2021-23017 NGINX Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20210708-0007**](https://security.netapp.com/advisory/ntap-20210708-0007/) | CVE-2021-29505 XStream Vulnerability in NetApp Products | 2022-09-15 |
| [**NTAP-20210708-0003**](https://security.netapp.com/advisory/ntap-20210708-0003/) | CVE-2021-30465 Opencontainers-runc Vulnerability in NetApp Products | 2021-07-08 |
| [**NTAP-20210708-0008**](https://security.netapp.com/advisory/ntap-20210708-0008/) | CVE-2021-3527 QEMU Vulnerability in NetApp Products | 2021-07-08 |
| [**NTAP-20210706-0008**](https://security.netapp.com/advisory/ntap-20210706-0008/) | CVE-2020-10688 RESTEasy Vulnerability in NetApp Products | 2021-07-06 |
| [**NTAP-20210706-0003**](https://security.netapp.com/advisory/ntap-20210706-0003/) | CVE-2021-31440 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210706-0005**](https://security.netapp.com/advisory/ntap-20210706-0005/) | CVE-2021-32640 Node.js Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210706-0004**](https://security.netapp.com/advisory/ntap-20210706-0004/) | CVE-2021-33200 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210706-0001**](https://security.netapp.com/advisory/ntap-20210706-0001/) | CVE-2021-33502 Node.js Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210706-0007**](https://security.netapp.com/advisory/ntap-20210706-0007/) | CVE-2021-33587 Node.js Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210706-0006**](https://security.netapp.com/advisory/ntap-20210706-0006/) | CVE-2021-3559 Libvirt Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210702-0005**](https://security.netapp.com/advisory/ntap-20210702-0005/) | CVE-2020-25668 Linux Kernel Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20210702-0006**](https://security.netapp.com/advisory/ntap-20210702-0006/) | CVE-2020-25669 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210702-0003**](https://security.netapp.com/advisory/ntap-20210702-0003/) | CVE-2020-25724 RESTEasy Vulnerability in NetApp Products | 2021-11-24 |
| [**NTAP-20210702-0004**](https://security.netapp.com/advisory/ntap-20210702-0004/) | CVE-2020-27815 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210702-0007**](https://security.netapp.com/advisory/ntap-20210702-0007/) | CVE-2021-33623 Node.js Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210702-0002**](https://security.netapp.com/advisory/ntap-20210702-0002/) | Intel SA-00463 BIOS Firmware Vulnerabilities in NetApp Products | 2022-09-07 |
| [**NTAP-20210702-0001**](https://security.netapp.com/advisory/ntap-20210702-0001/) | June 2021 Apache HTTP Server Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20210702-0008**](https://security.netapp.com/advisory/ntap-20210702-0008/) | June 2021 Linux Kernel Vulnerabilities in NetApp Products | 2024-05-01 |
| [**NTAP-20210629-0006**](https://security.netapp.com/advisory/ntap-20210629-0006/) | CVE-2019-25044 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210629-0004**](https://security.netapp.com/advisory/ntap-20210629-0004/) | CVE-2019-4588 IBM DB2 Vulnerability in NetApp Products | 2021-06-29 |
| [**NTAP-20210629-0007**](https://security.netapp.com/advisory/ntap-20210629-0007/) | CVE-2020-14301 Libvirt Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210629-0001**](https://security.netapp.com/advisory/ntap-20210629-0001/) | CVE-2021-22138 Logstash Vulnerability in NetApp Products | 2021-06-29 |
| [**NTAP-20210629-0005**](https://security.netapp.com/advisory/ntap-20210629-0005/) | CVE-2021-33574 GNU C Library (glibc) Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210629-0003**](https://security.netapp.com/advisory/ntap-20210629-0003/) | CVE-2021-3426 Python Vulnerability in NetApp Products | 2024-03-04 |
| [**NTAP-20210629-0002**](https://security.netapp.com/advisory/ntap-20210629-0002/) | CVE-2021-3483 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210625-0005**](https://security.netapp.com/advisory/ntap-20210625-0005/) | CVE-2020-13529 Systemd Vulnerability in NetApp Products | 2022-06-29 |
| [**NTAP-20210625-0008**](https://security.netapp.com/advisory/ntap-20210625-0008/) | CVE-2020-24516 Intel CSME Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210625-0004**](https://security.netapp.com/advisory/ntap-20210625-0004/) | CVE-2020-27830 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210625-0009**](https://security.netapp.com/advisory/ntap-20210625-0009/) | CVE-2021-0095 Intel Processor Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20210625-0007**](https://security.netapp.com/advisory/ntap-20210625-0007/) | CVE-2021-23134 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210625-0001**](https://security.netapp.com/advisory/ntap-20210625-0001/) | CVE-2021-32606 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210625-0006**](https://security.netapp.com/advisory/ntap-20210625-0006/) | CVE-2021-33204 PostgreSQL Vulnerability in NetApp Products | 2021-08-12 |
| [**NTAP-20210625-0003**](https://security.netapp.com/advisory/ntap-20210625-0003/) | May 2021 Elasticsearch Vulnerabilities in NetApp Products | 2021-06-25 |
| [**NTAP-20210625-0002**](https://security.netapp.com/advisory/ntap-20210625-0002/) | May 2021 Libxml2 Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20210622-0007**](https://security.netapp.com/advisory/ntap-20210622-0007/) | CVE-2020-15522 Bouncy Castle Vulnerability in NetApp Products | 2024-10-22 |
| [**NTAP-20210622-0005**](https://security.netapp.com/advisory/ntap-20210622-0005/) | CVE-2021-29489 Highcharts Vulnerability in NetApp Products | 2022-06-27 |
| [**NTAP-20210622-0002**](https://security.netapp.com/advisory/ntap-20210622-0002/) | CVE-2021-29491 Node.js Vulnerability in NetApp Products | 2021-06-22 |
| [**NTAP-20210622-0003**](https://security.netapp.com/advisory/ntap-20210622-0003/) | CVE-2021-29921 Python Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210622-0006**](https://security.netapp.com/advisory/ntap-20210622-0006/) | CVE-2021-32399 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210622-0001**](https://security.netapp.com/advisory/ntap-20210622-0001/) | February 2021 MySQL Client Vulnerabilities in NetApp Products | 2022-08-29 |
| [**NTAP-20210622-0004**](https://security.netapp.com/advisory/ntap-20210622-0004/) | June 2021 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2021-06-22 |
| [**NTAP-20210618-0009**](https://security.netapp.com/advisory/ntap-20210618-0009/) | CVE-2020-35519 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210618-0003**](https://security.netapp.com/advisory/ntap-20210618-0003/) | CVE-2021-21414 Node.js Vulnerability in NetApp Products | 2021-06-18 |
| [**NTAP-20210618-0007**](https://security.netapp.com/advisory/ntap-20210618-0007/) | CVE-2021-23383 Node.js Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210618-0005**](https://security.netapp.com/advisory/ntap-20210618-0005/) | CVE-2021-28860 Node.js Vulnerability in NetApp Products | 2021-06-18 |
| [**NTAP-20210618-0006**](https://security.netapp.com/advisory/ntap-20210618-0006/) | CVE-2021-29484 Node.js Vulnerability in NetApp Products | 2021-06-18 |
| [**NTAP-20210618-0001**](https://security.netapp.com/advisory/ntap-20210618-0001/) | CVE-2021-31542 Django Vulnerability in NetApp Products | 2021-06-18 |
| [**NTAP-20210618-0010**](https://security.netapp.com/advisory/ntap-20210618-0010/) | CVE-2021-31542 Django Vulnerability in NetApp Products | 2021-06-18 |
| [**NTAP-20210618-0004**](https://security.netapp.com/advisory/ntap-20210618-0004/) | CVE-2021-31597 Node.js Vulnerability in NetApp Products | 2021-06-18 |
| [**NTAP-20210618-0002**](https://security.netapp.com/advisory/ntap-20210618-0002/) | CVE-2021-31879 GNU Wget Vulnerability in NetApp Products | 2024-11-14 |
| [**NTAP-20210618-0008**](https://security.netapp.com/advisory/ntap-20210618-0008/) | CVE-2021-3501 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210611-0006**](https://security.netapp.com/advisory/ntap-20210611-0006/) | April 2021 Eclipse Jetty Vulnerabilities in NetApp Products | 2024-05-01 |
| [**NTAP-20210611-0003**](https://security.netapp.com/advisory/ntap-20210611-0003/) | CVE-2020-24509 Intel SPS Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210611-0008**](https://security.netapp.com/advisory/ntap-20210611-0008/) | CVE-2021-23133 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210611-0009**](https://security.netapp.com/advisory/ntap-20210611-0009/) | CVE-2021-27905 Apache Solr Vulnerability in NetApp Products | 2021-06-11 |
| [**NTAP-20210611-0010**](https://security.netapp.com/advisory/ntap-20210611-0010/) | CVE-2021-29469 Node.js Vulnerability in NetApp Products | 2021-06-11 |
| [**NTAP-20210611-0001**](https://security.netapp.com/advisory/ntap-20210611-0001/) | CVE-2021-31231 Grafana Vulnerability in NetApp Products | 2021-06-11 |
| [**NTAP-20210611-0002**](https://security.netapp.com/advisory/ntap-20210611-0002/) | CVE-2021-32052 Django Vulnerability in NetApp Products | 2021-06-11 |
| [**NTAP-20210611-0007**](https://security.netapp.com/advisory/ntap-20210611-0007/) | CVE-2021-3506 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210611-0004**](https://security.netapp.com/advisory/ntap-20210611-0004/) | Intel SA-00459 CSME Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20210611-0005**](https://security.netapp.com/advisory/ntap-20210611-0005/) | Intel SA-00464 Intel Processor Vulnerabilities in NetApp Products | 2022-09-07 |
| [**NTAP-20210610-0001**](https://security.netapp.com/advisory/ntap-20210610-0001/) | CVE-2021-26993 Denial of Service Vulnerability in E-Series SANtricity OS Controller Software 11.x | 2021-06-10 |
| [**NTAP-20210610-0002**](https://security.netapp.com/advisory/ntap-20210610-0002/) | CVE-2021-26995 Remote Code Execution Vulnerability in E-Series SANtricity OS Controller Software 11.x | 2021-06-10 |
| [**NTAP-20210610-0003**](https://security.netapp.com/advisory/ntap-20210610-0003/) | CVE-2021-26996 Information Disclosure Vulnerability in E-Series SANtricity OS Controller Software 11.x | 2021-06-10 |
| [**NTAP-20210610-0004**](https://security.netapp.com/advisory/ntap-20210610-0004/) | CVE-2021-26997 Information Disclosure in E-Series SANtricity OS Controller Software 11.x | 2021-06-10 |
| [**NTAP-20210604-0009**](https://security.netapp.com/advisory/ntap-20210604-0009/) | April 2021 Apache Solr Vulnerabilities in NetApp Products | 2021-06-04 |
| [**NTAP-20210604-0010**](https://security.netapp.com/advisory/ntap-20210604-0010/) | CVE-2020-15225 Django Vulnerability in NetApp Products | 2021-06-04 |
| [**NTAP-20210604-0005**](https://security.netapp.com/advisory/ntap-20210604-0005/) | CVE-2020-36313 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210604-0008**](https://security.netapp.com/advisory/ntap-20210604-0008/) | CVE-2021-23369 Node.js Vulnerability in NetApp Products | 2021-06-04 |
| [**NTAP-20210604-0004**](https://security.netapp.com/advisory/ntap-20210604-0004/) | CVE-2021-26073 Node.JS Vulnerability in NetApp Products | 2021-06-04 |
| [**NTAP-20210604-0006**](https://security.netapp.com/advisory/ntap-20210604-0006/) | CVE-2021-29154 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210604-0001**](https://security.netapp.com/advisory/ntap-20210604-0001/) | CVE-2021-29418 Node.js Vulnerability in NetApp Products | 2021-06-04 |
| [**NTAP-20210604-0007**](https://security.netapp.com/advisory/ntap-20210604-0007/) | CVE-2021-29424 Perl Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210604-0002**](https://security.netapp.com/advisory/ntap-20210604-0002/) | CVE-2021-29662 Perl Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210604-0003**](https://security.netapp.com/advisory/ntap-20210604-0003/) | March 2021 Apache Netty Vulnerabilities in NetApp Products | 2022-08-29 |
| [**NTAP-20210601-0001**](https://security.netapp.com/advisory/ntap-20210601-0001/) | CVE-2021-26994 Denial of Service Vulnerability in Clustered Data ONTAP | 2021-06-01 |
| [**NTAP-20210528-0009**](https://security.netapp.com/advisory/ntap-20210528-0009/) | CVE-2021-20197 GNU Binutils Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210528-0008**](https://security.netapp.com/advisory/ntap-20210528-0008/) | CVE-2021-20289 RESTEasy Vulnerability in NetApp Products | 2024-03-11 |
| [**NTAP-20210528-0006**](https://security.netapp.com/advisory/ntap-20210528-0006/) | CVE-2021-21267 Node.js Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210528-0007**](https://security.netapp.com/advisory/ntap-20210528-0007/) | CVE-2021-26296 Apache MyFaces Vulnerability in NetApp Products | 2021-06-18 |
| [**NTAP-20210528-0002**](https://security.netapp.com/advisory/ntap-20210528-0002/) | CVE-2021-27850 Apache Tapestry Vulnerability in NetApp Products | 2021-05-28 |
| [**NTAP-20210528-0001**](https://security.netapp.com/advisory/ntap-20210528-0001/) | CVE-2021-28658 Django Vulnerability in NetApp Products | 2021-05-28 |
| [**NTAP-20210528-0010**](https://security.netapp.com/advisory/ntap-20210528-0010/) | CVE-2021-28918 Node.js Vulnerability in NetApp Products | 2021-05-28 |
| [**NTAP-20210528-0003**](https://security.netapp.com/advisory/ntap-20210528-0003/) | CVE-2021-28965 Ruby Vulnerability in NetApp Products | 2021-05-28 |
| [**NTAP-20210528-0004**](https://security.netapp.com/advisory/ntap-20210528-0004/) | CVE-2021-30638 Apache Tapestry Vulnerability in NetApp Products | 2021-05-28 |
| [**NTAP-20210528-0005**](https://security.netapp.com/advisory/ntap-20210528-0005/) | CVE-2021-3507 QEMU Vulnerability in NetApp Products | 2021-05-28 |
| [**NTAP-20210521-0007**](https://security.netapp.com/advisory/ntap-20210521-0007/) | April 2021 cURL/libcURL Vulnerabilities in NetApp Products | 2022-05-06 |
| [**NTAP-20210521-0006**](https://security.netapp.com/advisory/ntap-20210521-0006/) | April 2021 ISC BIND Vulnerabilities in NetApp Products | 2023-07-07 |
| [**NTAP-20210521-0001**](https://security.netapp.com/advisory/ntap-20210521-0001/) | CVE-2020-12762 JSON-C Vulnerability in NetApp Products | 2021-05-21 |
| [**NTAP-20210521-0005**](https://security.netapp.com/advisory/ntap-20210521-0005/) | CVE-2020-13946 Apache Cassandra Vulnerability in NetApp Products | 2021-05-21 |
| [**NTAP-20210521-0002**](https://security.netapp.com/advisory/ntap-20210521-0002/) | CVE-2020-17516 Apache Cassandra Vulnerability in NetApp Products | 2021-05-21 |
| [**NTAP-20210521-0003**](https://security.netapp.com/advisory/ntap-20210521-0003/) | CVE-2020-27783 lxml Vulnerability in NetApp Products | 2021-07-01 |
| [**NTAP-20210521-0008**](https://security.netapp.com/advisory/ntap-20210521-0008/) | CVE-2020-27825 Linux Kernel Vulnerability in NetApp Products | 2024-05-09 |
| [**NTAP-20210521-0010**](https://security.netapp.com/advisory/ntap-20210521-0010/) | CVE-2021-20284 GNU Binutils Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210521-0004**](https://security.netapp.com/advisory/ntap-20210521-0004/) | CVE-2021-28957 lxml Vulnerability in NetApp Products | 2021-06-29 |
| [**NTAP-20210521-0009**](https://security.netapp.com/advisory/ntap-20210521-0009/) | March 2021 LibTIFF Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20210513-0001**](https://security.netapp.com/advisory/ntap-20210513-0001/) | April 2021 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2022-11-21 |
| [**NTAP-20210513-0002**](https://security.netapp.com/advisory/ntap-20210513-0002/) | April 2021 MySQL Vulnerabilities in NetApp Products | 2024-05-01 |
| [**NTAP-20210513-0010**](https://security.netapp.com/advisory/ntap-20210513-0010/) | CVE-2020-13954 Apache CXF Vulnerability in NetApp Products | 2021-07-14 |
| [**NTAP-20210513-0006**](https://security.netapp.com/advisory/ntap-20210513-0006/) | CVE-2020-35508 Linux Kernel Vulnerability in NetApp Products | 2023-03-21 |
| [**NTAP-20210513-0009**](https://security.netapp.com/advisory/ntap-20210513-0009/) | CVE-2020-5421 Spring Framework Vulnerability in NetApp Products | 2021-07-13 |
| [**NTAP-20210513-0003**](https://security.netapp.com/advisory/ntap-20210513-0003/) | CVE-2021-23901 Apache Nutch Vulnerability in NetApp Products | 2021-05-13 |
| [**NTAP-20210513-0004**](https://security.netapp.com/advisory/ntap-20210513-0004/) | CVE-2021-23926 Apache XMLBeans Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210513-0007**](https://security.netapp.com/advisory/ntap-20210513-0007/) | CVE-2021-27358 Grafana Vulnerability in NetApp Products | 2022-03-07 |
| [**NTAP-20210513-0008**](https://security.netapp.com/advisory/ntap-20210513-0008/) | CVE-2021-28092 Node.js Vulnerability in NetApp Products | 2021-05-13 |
| [**NTAP-20210513-0005**](https://security.netapp.com/advisory/ntap-20210513-0005/) | CVE-2021-29266 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210507-0002**](https://security.netapp.com/advisory/ntap-20210507-0002/) | April 2021 QEMU Vulnerabilities in NetApp Products | 2021-05-07 |
| [**NTAP-20210507-0007**](https://security.netapp.com/advisory/ntap-20210507-0007/) | April 2021 Unbound Vulnerabilities in NetApp Products | 2021-05-07 |
| [**NTAP-20210507-0005**](https://security.netapp.com/advisory/ntap-20210507-0005/) | CVE-2020-36309 OpenResty Vulnerability in NetApp Products | 2021-05-07 |
| [**NTAP-20210507-0003**](https://security.netapp.com/advisory/ntap-20210507-0003/) | CVE-2021-20255 QEMU Vulnerability in NetApp Products | 2021-05-07 |
| [**NTAP-20210507-0004**](https://security.netapp.com/advisory/ntap-20210507-0004/) | CVE-2021-28657 Apache Tika Vulnerability in NetApp Products | 2021-05-07 |
| [**NTAP-20210507-0008**](https://security.netapp.com/advisory/ntap-20210507-0008/) | CVE-2021-28660 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210507-0006**](https://security.netapp.com/advisory/ntap-20210507-0006/) | CVE-2021-3393 PostgreSQL Vulnerability in NetApp Products | 2021-05-07 |
| [**NTAP-20210507-0001**](https://security.netapp.com/advisory/ntap-20210507-0001/) | March 2021 QEMU Vulnerabilities in NetApp Products | 2021-05-07 |
| [**NTAP-20210430-0001**](https://security.netapp.com/advisory/ntap-20210430-0001/) | CVE-2021-20254 Samba Vulnerability in NetApp Products | 2021-04-30 |
| [**NTAP-20210430-0006**](https://security.netapp.com/advisory/ntap-20210430-0006/) | CVE-2021-22134 Elasticsearch Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210430-0005**](https://security.netapp.com/advisory/ntap-20210430-0005/) | March 2021 Grafana Vulnerabilities in NetApp Products | 2021-04-30 |
| [**NTAP-20210430-0003**](https://security.netapp.com/advisory/ntap-20210430-0003/) | March 2021 Linux Kernel 5.11.8 Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20210430-0004**](https://security.netapp.com/advisory/ntap-20210430-0004/) | March 2021 PostgreSQL Vulnerabilities in NetApp Products | 2021-04-30 |
| [**NTAP-20210430-0002**](https://security.netapp.com/advisory/ntap-20210430-0002/) | March 2021 XStream Vulnerabilities in NetApp Products | 2022-06-27 |
| [**NTAP-20210423-0002**](https://security.netapp.com/advisory/ntap-20210423-0002/) | April 2021 FreeBSD Vulnerabilities in NetApp Products | 2021-04-23 |
| [**NTAP-20210423-0001**](https://security.netapp.com/advisory/ntap-20210423-0001/) | CVE-2020-25577 FreeBSD Vulnerability in NetApp Products | 2021-04-23 |
| [**NTAP-20210423-0005**](https://security.netapp.com/advisory/ntap-20210423-0005/) | CVE-2020-25580 FreeBSD Vulnerability in NetApp Products | 2021-04-23 |
| [**NTAP-20210423-0006**](https://security.netapp.com/advisory/ntap-20210423-0006/) | CVE-2020-25581 FreeBSD Vulnerability in NetApp Products | 2021-04-23 |
| [**NTAP-20210423-0003**](https://security.netapp.com/advisory/ntap-20210423-0003/) | CVE-2020-25582 FreeBSD Vulnerability in NetApp Products | 2021-04-23 |
| [**NTAP-20210423-0004**](https://security.netapp.com/advisory/ntap-20210423-0004/) | CVE-2020-25583 FreeBSD Vulnerability in NetApp Products | 2021-04-23 |
| [**NTAP-20210423-0009**](https://security.netapp.com/advisory/ntap-20210423-0009/) | CVE-2020-25584 FreeBSD Vulnerability in NetApp Products | 2021-04-23 |
| [**NTAP-20210423-0010**](https://security.netapp.com/advisory/ntap-20210423-0010/) | CVE-2021-20227 SQLite Vulnerability in NetApp Products | 2021-04-23 |
| [**NTAP-20210423-0008**](https://security.netapp.com/advisory/ntap-20210423-0008/) | CVE-2021-29626 FreeBSD Vulnerability in NetApp Products | 2021-04-23 |
| [**NTAP-20210423-0007**](https://security.netapp.com/advisory/ntap-20210423-0007/) | CVE-2021-29627 FreeBSD Vulnerability in NetApp Products | 2021-04-23 |
| [**NTAP-20210416-0004**](https://security.netapp.com/advisory/ntap-20210416-0004/) | CVE-2020-14372 Grub2 Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210416-0002**](https://security.netapp.com/advisory/ntap-20210416-0002/) | CVE-2021-28041 OpenSSH Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210416-0003**](https://security.netapp.com/advisory/ntap-20210416-0003/) | CVE-2021-28153 GNOME GLib Vulnerability in NetApp Products | 2022-05-06 |
| [**NTAP-20210416-0006**](https://security.netapp.com/advisory/ntap-20210416-0006/) | CVE-2021-3444 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210416-0005**](https://security.netapp.com/advisory/ntap-20210416-0005/) | March 2021 GnuTLS Vulnerabilities in NetApp Products | 2022-03-07 |
| [**NTAP-20210416-0001**](https://security.netapp.com/advisory/ntap-20210416-0001/) | March 2021 Node.js Vulnerabilities in NetApp Products | 2024-05-01 |
| [**NTAP-20210409-0004**](https://security.netapp.com/advisory/ntap-20210409-0004/) | CVE-2020-26217 XStream Vulnerability in NetApp Products | 2021-05-08 |
| [**NTAP-20210409-0006**](https://security.netapp.com/advisory/ntap-20210409-0006/) | CVE-2021-20268 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210409-0005**](https://security.netapp.com/advisory/ntap-20210409-0005/) | December 2020 XStream Vulnerabilities in NetApp Products | 2021-04-09 |
| [**NTAP-20210409-0002**](https://security.netapp.com/advisory/ntap-20210409-0002/) | March 2021 Apache Tomcat Vulnerabilities in NetApp Products | 2021-06-08 |
| [**NTAP-20210409-0003**](https://security.netapp.com/advisory/ntap-20210409-0003/) | March 2021 IBM DB2 Vulnerabilities in NetApp Products | 2021-06-18 |
| [**NTAP-20210409-0001**](https://security.netapp.com/advisory/ntap-20210409-0001/) | March 2021 Linux Kernel 5.11.3 Vulnerabilities in NetApp Products | 2024-05-01 |
| [**NTAP-20210401-0005**](https://security.netapp.com/advisory/ntap-20210401-0005/) | CVE-2020-27223 Eclipse Jetty Vulnerability in NetApp Products | 2024-07-11 |
| [**NTAP-20210401-0002**](https://security.netapp.com/advisory/ntap-20210401-0002/) | CVE-2020-27543 Node.js Vulnerability in NetApp Products | 2021-04-27 |
| [**NTAP-20210401-0006**](https://security.netapp.com/advisory/ntap-20210401-0006/) | CVE-2020-27618 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210401-0001**](https://security.netapp.com/advisory/ntap-20210401-0001/) | CVE-2021-20226 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210401-0003**](https://security.netapp.com/advisory/ntap-20210401-0003/) | CVE-2021-28375 Linux Kernel Vulnerability in NetApp Products | 2024-10-07 |
| [**NTAP-20210401-0004**](https://security.netapp.com/advisory/ntap-20210401-0004/) | CVE-2021-3189 Node.js Vulnerability in NetApp Products | 2021-04-27 |
| [**NTAP-20210326-0003**](https://security.netapp.com/advisory/ntap-20210326-0003/) | CVE-2021-20194 Linux Kernel Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210326-0005**](https://security.netapp.com/advisory/ntap-20210326-0005/) | CVE-2021-20229 PostgreSQL Vulnerability in NetApp Products | 2021-03-26 |
| [**NTAP-20210326-0004**](https://security.netapp.com/advisory/ntap-20210326-0004/) | CVE-2021-23336 Python Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210326-0002**](https://security.netapp.com/advisory/ntap-20210326-0002/) | CVE-2021-27405 Node.js Vulnerability in NetApp Products | 2021-04-27 |
| [**NTAP-20210326-0001**](https://security.netapp.com/advisory/ntap-20210326-0001/) | February 2021 Linux Kernel Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20210326-0006**](https://security.netapp.com/advisory/ntap-20210326-0006/) | March 2021 OpenSSL Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20210326-0007**](https://security.netapp.com/advisory/ntap-20210326-0007/) | March 2021 Samba Vulnerabilities in NetApp Products | 2021-03-26 |
| [**NTAP-20210319-0003**](https://security.netapp.com/advisory/ntap-20210319-0003/) | CVE-2020-7021 Elasticsearch Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210319-0001**](https://security.netapp.com/advisory/ntap-20210319-0001/) | CVE-2020-8625 ISC BIND Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210319-0005**](https://security.netapp.com/advisory/ntap-20210319-0005/) | CVE-2021-27212 OpenLDAP Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210319-0004**](https://security.netapp.com/advisory/ntap-20210319-0004/) | February 2021 GNOME GLib Vulnerabilities in NetApp Products | 2022-05-06 |
| [**NTAP-20210319-0002**](https://security.netapp.com/advisory/ntap-20210319-0002/) | February 2021 Node.js Vulnerabilities in NetApp Products | 2021-03-19 |
| [**NTAP-20210318-0001**](https://security.netapp.com/advisory/ntap-20210318-0001/) | CVE-2021-26990 Arbitrary File Overwrite Vulnerability in Cloud Manager | 2021-03-18 |
| [**NTAP-20210318-0002**](https://security.netapp.com/advisory/ntap-20210318-0002/) | CVE-2021-26991 Cross-Origin Resource Sharing (CORS) Vulnerability in Cloud Manager | 2021-03-18 |
| [**NTAP-20210318-0003**](https://security.netapp.com/advisory/ntap-20210318-0003/) | CVE-2021-26992 Denial of Service Vulnerability in Cloud Manager | 2021-03-18 |
| [**NTAP-20210315-0001**](https://security.netapp.com/advisory/ntap-20210315-0001/) | CVE-2021-26987 SpringBoot Framework Remote Code Execution Vulnerability in Management Software for Element Software and NetApp HCI | 2022-06-29 |
| [**NTAP-20210312-0004**](https://security.netapp.com/advisory/ntap-20210312-0004/) | CVE-2020-15523 Python Vulnerability in NetApp Products | 2021-06-29 |
| [**NTAP-20210312-0003**](https://security.netapp.com/advisory/ntap-20210312-0003/) | CVE-2020-17380 QEMU Vulnerability in NetApp Products | 2021-03-12 |
| [**NTAP-20210312-0002**](https://security.netapp.com/advisory/ntap-20210312-0002/) | CVE-2020-35517 QEMU Vulnerability in NetApp Products | 2021-03-12 |
| [**NTAP-20210312-0007**](https://security.netapp.com/advisory/ntap-20210312-0007/) | CVE-2021-21315 Node.JS Vulnerability in NetApp Products | 2021-04-27 |
| [**NTAP-20210312-0008**](https://security.netapp.com/advisory/ntap-20210312-0008/) | CVE-2021-26708 Linux Kernel Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20210312-0006**](https://security.netapp.com/advisory/ntap-20210312-0006/) | February 2021 Lodash Vulnerabilities in NetApp Products | 2022-08-03 |
| [**NTAP-20210312-0005**](https://security.netapp.com/advisory/ntap-20210312-0005/) | February 2021 PHP Vulnerabilities in NetApp Products | 2021-10-18 |
| [**NTAP-20210312-0001**](https://security.netapp.com/advisory/ntap-20210312-0001/) | June 2020 Squid Vulnerabilities in NetApp Products | 2021-09-27 |
| [**NTAP-20210304-0004**](https://security.netapp.com/advisory/ntap-20210304-0004/) | CVE-2020-11945 Squid Vulnerability in NetApp Products | 2021-09-27 |
| [**NTAP-20210304-0006**](https://security.netapp.com/advisory/ntap-20210304-0006/) | CVE-2020-16119 Linux Kernel Vulnerability in NetApp Products | 2023-03-21 |
| [**NTAP-20210304-0003**](https://security.netapp.com/advisory/ntap-20210304-0003/) | CVE-2020-29443 QEMU Vulnerability in NetApp Products | 2021-03-04 |
| [**NTAP-20210304-0001**](https://security.netapp.com/advisory/ntap-20210304-0001/) | CVE-2020-9492 Apache Hadoop Vulnerability in NetApp Products | 2021-03-04 |
| [**NTAP-20210304-0008**](https://security.netapp.com/advisory/ntap-20210304-0008/) | CVE-2021-26117 Apache ActiveMQ Vulnerability in NetApp Products | 2021-08-24 |
| [**NTAP-20210304-0007**](https://security.netapp.com/advisory/ntap-20210304-0007/) | CVE-2021-3326 GNU C Library (glibc) Vulnerability in NetApp Products | 2024-05-01 |
| [**NTAP-20210304-0005**](https://security.netapp.com/advisory/ntap-20210304-0005/) | CVE-2021-3347 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20210304-0002**](https://security.netapp.com/advisory/ntap-20210304-0002/) | February 2020 Squid Vulnerabilities in NetApp Products | 2021-09-27 |
| [**NTAP-20210303-0001**](https://security.netapp.com/advisory/ntap-20210303-0001/) | CVE-2021-26988 Sensitive Information Disclosure Vulnerability in Clustered Data ONTAP | 2021-03-03 |
| [**NTAP-20210303-0002**](https://security.netapp.com/advisory/ntap-20210303-0002/) | CVE-2021-26989 Denial of Service Vulnerability in Clustered Data ONTAP | 2021-03-03 |
| [**NTAP-20210226-0006**](https://security.netapp.com/advisory/ntap-20210226-0006/) | August 2020 Squid Vulnerabilities in NetApp Products | 2021-09-27 |
| [**NTAP-20210226-0001**](https://security.netapp.com/advisory/ntap-20210226-0001/) | CVE-2020-28488 jQuery Vulnerability in NetApp Products | 2021-03-04 |
| [**NTAP-20210226-0003**](https://security.netapp.com/advisory/ntap-20210226-0003/) | CVE-2021-3177 Python Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20210226-0004**](https://security.netapp.com/advisory/ntap-20210226-0004/) | CVE-2021-3281 Django Vulnerability in NetApp Products | 2021-06-29 |
| [**NTAP-20210226-0005**](https://security.netapp.com/advisory/ntap-20210226-0005/) | February 2021 Docker Vulnerabilities in NetApp Products | 2024-05-01 |
| [**NTAP-20210226-0002**](https://security.netapp.com/advisory/ntap-20210226-0002/) | February 2021 OpenLDAP Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20210219-0002**](https://security.netapp.com/advisory/ntap-20210219-0002/) | CVE-2020-28374 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210219-0008**](https://security.netapp.com/advisory/ntap-20210219-0008/) | CVE-2021-20190 FasterXML Jackson Databind Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210219-0005**](https://security.netapp.com/advisory/ntap-20210219-0005/) | CVE-2021-21252 jQuery Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20210219-0004**](https://security.netapp.com/advisory/ntap-20210219-0004/) | CVE-2021-22132 Elasticsearch Vulnerability in NetApp Products | 2021-04-28 |
| [**NTAP-20210219-0006**](https://security.netapp.com/advisory/ntap-20210219-0006/) | CVE-2021-3121 GoGo Protobuf Vulnerability in NetApp Products | 2021-02-19 |
| [**NTAP-20210219-0001**](https://security.netapp.com/advisory/ntap-20210219-0001/) | February 2021 Golang Vulnerabilities in NetApp Products | 2021-06-25 |
| [**NTAP-20210219-0009**](https://security.netapp.com/advisory/ntap-20210219-0009/) | February 2021 OpenSSL Vulnerabilities in NetApp Products | 2024-01-02 |
| [**NTAP-20210219-0003**](https://security.netapp.com/advisory/ntap-20210219-0003/) | January 2021 MySQL Vulnerabilities in NetApp Products | 2022-02-02 |
| [**NTAP-20210219-0007**](https://security.netapp.com/advisory/ntap-20210219-0007/) | September 2020 Squid Vulnerabilities in NetApp Products | 2021-09-27 |
| [**NTAP-20210212-0001**](https://security.netapp.com/advisory/ntap-20210212-0001/) | CVE-2020-11947 QEMU Vulnerability in NetApp Products | 2021-02-12 |
| [**NTAP-20210212-0002**](https://security.netapp.com/advisory/ntap-20210212-0002/) | CVE-2020-36158 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210212-0008**](https://security.netapp.com/advisory/ntap-20210212-0008/) | CVE-2021-24122 Apache Tomcat Vulnerability in NetApp Products | 2021-06-08 |
| [**NTAP-20210212-0006**](https://security.netapp.com/advisory/ntap-20210212-0006/) | Intel SA-00438 Graphics Drivers Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20210212-0005**](https://security.netapp.com/advisory/ntap-20210212-0005/) | Intel SA-00456 Ethernet Controller Vulnerabilities in NetApp Products | 2021-02-12 |
| [**NTAP-20210212-0007**](https://security.netapp.com/advisory/ntap-20210212-0007/) | January 2021 GNU Binutils Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20210212-0004**](https://security.netapp.com/advisory/ntap-20210212-0004/) | January 2021 Golang Vulnerabilities in NetApp Products | 2021-02-12 |
| [**NTAP-20210212-0003**](https://security.netapp.com/advisory/ntap-20210212-0003/) | January 2021 Node.js Vulnerabilities in NetApp Products | 2021-03-04 |
| [**NTAP-20210208-0002**](https://security.netapp.com/advisory/ntap-20210208-0002/) | CVE-2020-8578 Information Disclosure Vulnerability in Clustered Data ONTAP | 2021-02-08 |
| [**NTAP-20210208-0001**](https://security.netapp.com/advisory/ntap-20210208-0001/) | CVE-2020-8587 Sensitive Information Disclosure Vulnerability in OnCommand System Manager 9.x | 2021-02-08 |
| [**NTAP-20210208-0003**](https://security.netapp.com/advisory/ntap-20210208-0003/) | CVE-2020-8590 Information Disclosure Vulnerability in Clustered Data ONTAP | 2021-02-08 |
| [**NTAP-20210205-0003**](https://security.netapp.com/advisory/ntap-20210205-0003/) | CVE-2019-20808 QEMU Vulnerability in NetApp Products | 2021-02-05 |
| [**NTAP-20210205-0004**](https://security.netapp.com/advisory/ntap-20210205-0004/) | CVE-2019-25013 GNU C (glibc) Vulnerability in NetApp Products | 2024-11-11 |
| [**NTAP-20210205-0002**](https://security.netapp.com/advisory/ntap-20210205-0002/) | CVE-2020-27846 Grafana Vulnerability in NetApp Products | 2021-02-05 |
| [**NTAP-20210205-0001**](https://security.netapp.com/advisory/ntap-20210205-0001/) | CVE-2020-29569 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210205-0005**](https://security.netapp.com/advisory/ntap-20210205-0005/) | January 2021 FasterXML jackson-databind Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20210205-0006**](https://security.netapp.com/advisory/ntap-20210205-0006/) | January 2021 Squid Vulnerabilities in NetApp Products | 2021-09-27 |
| [**NTAP-20210201-0001**](https://security.netapp.com/advisory/ntap-20210201-0001/) | CVE-2020-8588 Sensitive Information Disclosure Vulnerability in Clustered Data ONTAP | 2021-02-01 |
| [**NTAP-20210201-0002**](https://security.netapp.com/advisory/ntap-20210201-0002/) | CVE-2020-8589 Sensitive Information Disclosure Vulnerability in Clustered Data ONTAP | 2021-02-01 |
| [**NTAP-20210201-0003**](https://security.netapp.com/advisory/ntap-20210201-0003/) | January 2021 Treck TCP/IP Library Vulnerabilities in NetApp Products | 2021-02-01 |
| [**NTAP-20210129-0001**](https://security.netapp.com/advisory/ntap-20210129-0001/) | CVE-2019-17006 Libnss Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20210129-0004**](https://security.netapp.com/advisory/ntap-20210129-0004/) | CVE-2019-19462 Linux Kernel Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20210129-0003**](https://security.netapp.com/advisory/ntap-20210129-0003/) | CVE-2020-10663 Ruby JSON gem Unsafe Object Creation Vulnerability in NetApp Products | 2021-01-29 |
| [**NTAP-20210129-0005**](https://security.netapp.com/advisory/ntap-20210129-0005/) | CVE-2020-10732 Linux Kernel Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20210129-0002**](https://security.netapp.com/advisory/ntap-20210129-0002/) | CVE-2020-11724 OpenResty Vulnerability in NetApp Products | 2021-01-29 |
| [**NTAP-20210129-0008**](https://security.netapp.com/advisory/ntap-20210129-0008/) | CVE-2020-35448 GNU Binutils Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20210129-0007**](https://security.netapp.com/advisory/ntap-20210129-0007/) | CVE-2020-35728 FasterXML Jackson Databind Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210129-0009**](https://security.netapp.com/advisory/ntap-20210129-0009/) | CVE-2020-4642 IBM DB2 Vulnerability in NetApp Products | 2021-01-29 |
| [**NTAP-20210129-0006**](https://security.netapp.com/advisory/ntap-20210129-0006/) | December 2020 Golang Vulnerabilities in NetApp Products | 2021-10-29 |
| [**NTAP-20210129-0010**](https://security.netapp.com/advisory/ntap-20210129-0010/) | January 2021 Sudo Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20210128-0001**](https://security.netapp.com/advisory/ntap-20210128-0001/) | CVE-2020-8585 Sensitive Information Disclosure Vulnerability in OnCommand Unified Manager Core Package | 2021-01-28 |
| [**NTAP-20210128-0002**](https://security.netapp.com/advisory/ntap-20210128-0002/) | CVE-2021-3156 Sudo Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20210122-0002**](https://security.netapp.com/advisory/ntap-20210122-0002/) | CVE-2020-27786 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210122-0007**](https://security.netapp.com/advisory/ntap-20210122-0007/) | December 2020 cURL/libcURL Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20210122-0005**](https://security.netapp.com/advisory/ntap-20210122-0005/) | December 2020 FasterXML jackson-databind Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20210122-0003**](https://security.netapp.com/advisory/ntap-20210122-0003/) | December 2020 GNU Binutils Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20210122-0004**](https://security.netapp.com/advisory/ntap-20210122-0004/) | December 2020 GNU C Library Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20210122-0006**](https://security.netapp.com/advisory/ntap-20210122-0006/) | December 2020 Kubernetes Vulnerabilities in NetApp Products | 2021-01-22 |
| [**NTAP-20210122-0001**](https://security.netapp.com/advisory/ntap-20210122-0001/) | December 2020 Linux Kernel Vulnerabilities in NetApp Products | 2022-06-09 |
| [**NTAP-20210122-0008**](https://security.netapp.com/advisory/ntap-20210122-0008/) | Intel SA-00390 BIOS Firmware Vulnerabilities in NetApp Products | 2022-02-23 |
| [**NTAP-20210119-0001**](https://security.netapp.com/advisory/ntap-20210119-0001/) | CVE-2020-8581 Unauthorized Modification Vulnerability in Clustered Data ONTAP | 2021-01-19 |
| [**NTAP-20210115-0005**](https://security.netapp.com/advisory/ntap-20210115-0005/) | CVE-2020-17530 Apache Struts Vulnerability in NetApp Products | 2021-01-15 |
| [**NTAP-20210115-0007**](https://security.netapp.com/advisory/ntap-20210115-0007/) | CVE-2020-17531 Apache Tapestry Vulnerability in NetApp Products | 2021-01-15 |
| [**NTAP-20210115-0008**](https://security.netapp.com/advisory/ntap-20210115-0008/) | CVE-2020-25613 Ruby Vulnerability in NetApp Products | 2021-01-15 |
| [**NTAP-20210115-0004**](https://security.netapp.com/advisory/ntap-20210115-0004/) | CVE-2020-27730 NGINX Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20210115-0006**](https://security.netapp.com/advisory/ntap-20210115-0006/) | CVE-2020-27821 QEMU Vulnerability in NetApp Products | 2021-01-15 |
| [**NTAP-20210115-0001**](https://security.netapp.com/advisory/ntap-20210115-0001/) | CVE-2020-29369 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210115-0002**](https://security.netapp.com/advisory/ntap-20210115-0002/) | CVE-2020-29374 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210115-0003**](https://security.netapp.com/advisory/ntap-20210115-0003/) | December 2020 GNU Binutils Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20210108-0004**](https://security.netapp.com/advisory/ntap-20210108-0004/) | CVE-2015-9251 jQuery Vulnerability in NetApp Products | 2021-06-08 |
| [**NTAP-20210108-0007**](https://security.netapp.com/advisory/ntap-20210108-0007/) | CVE-2020-25649 FasterXML Jackson Databind Vulnerability in NetApp Products | 2021-08-24 |
| [**NTAP-20210108-0006**](https://security.netapp.com/advisory/ntap-20210108-0006/) | CVE-2020-25692 OpenLDAP Vulnerability in NetApp Products | 2022-08-01 |
| [**NTAP-20210108-0005**](https://security.netapp.com/advisory/ntap-20210108-0005/) | CVE-2020-27350 APT Vulnerability in NetApp Products | 2021-11-01 |
| [**NTAP-20210108-0003**](https://security.netapp.com/advisory/ntap-20210108-0003/) | CVE-2020-28974 Linux Kernel Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20210108-0002**](https://security.netapp.com/advisory/ntap-20210108-0002/) | CVE-2020-29368 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20210108-0001**](https://security.netapp.com/advisory/ntap-20210108-0001/) | CVE-2020-4135 IBM DB2 Vulnerability in NetApp Products | 2021-01-08 |
| [**NTAP-20210108-0008**](https://security.netapp.com/advisory/ntap-20210108-0008/) | CVE-2020-8584 Arbitrary Code Execution Vulnerability in Element OS | 2021-01-08 |
| [**NTAP-20201223-0002**](https://security.netapp.com/advisory/ntap-20201223-0002/) | CVE-2020-10714 WildFly Vulnerability in NetApp Products | 2021-01-07 |
| [**NTAP-20201223-0001**](https://security.netapp.com/advisory/ntap-20201223-0001/) | CVE-2020-11612 Apache Netty Vulnerability in NetApp Products | 2021-03-02 |
| [**NTAP-20201222-0001**](https://security.netapp.com/advisory/ntap-20201222-0001/) | CVE-2020-1749 Linux Kernel Vulnerability in NetApp Products | 2023-08-02 |
| [**NTAP-20201218-0002**](https://security.netapp.com/advisory/ntap-20201218-0002/) | CVE-2020-15436 Linux Kernel Vulnerability in NetApp Products | 2022-07-01 |
| [**NTAP-20201218-0006**](https://security.netapp.com/advisory/ntap-20201218-0006/) | CVE-2020-17521 Apache Groovy Vulnerability in NetApp Products | 2021-06-29 |
| [**NTAP-20201218-0005**](https://security.netapp.com/advisory/ntap-20201218-0005/) | CVE-2020-1971 OpenSSL Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20201218-0004**](https://security.netapp.com/advisory/ntap-20201218-0004/) | CVE-2020-25723 QEMU Vulnerability in NetApp Products | 2020-12-18 |
| [**NTAP-20201218-0003**](https://security.netapp.com/advisory/ntap-20201218-0003/) | CVE-2020-27218 Eclipse Jetty Vulnerability in NetApp Products | 2021-05-08 |
| [**NTAP-20201218-0001**](https://security.netapp.com/advisory/ntap-20201218-0001/) | CVE-2020-29370 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20201210-0004**](https://security.netapp.com/advisory/ntap-20201210-0004/) | CVE-2020-14305 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20201210-0003**](https://security.netapp.com/advisory/ntap-20201210-0003/) | CVE-2020-17527 Apache Tomcat Vulnerability in NetApp Products | 2021-06-08 |
| [**NTAP-20201210-0005**](https://security.netapp.com/advisory/ntap-20201210-0005/) | CVE-2020-25624 QEMU Vulnerability in NetApp Products | 2020-12-10 |
| [**NTAP-20201210-0001**](https://security.netapp.com/advisory/ntap-20201210-0001/) | CVE-2020-25640 WildFly Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20201210-0002**](https://security.netapp.com/advisory/ntap-20201210-0002/) | CVE-2020-25705 Linux Kernel Vulnerability in NetApp Products | 2023-11-01 |
| [**NTAP-20201202-0005**](https://security.netapp.com/advisory/ntap-20201202-0005/) | CVE-2020-26939 Bouncy Castle Vulnerability in NetApp Products | 2021-07-13 |
| [**NTAP-20201202-0001**](https://security.netapp.com/advisory/ntap-20201202-0001/) | CVE-2020-28196 MIT Kerberos 5 Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20201202-0004**](https://security.netapp.com/advisory/ntap-20201202-0004/) | November 2020 Golang Vulnerabilities in NetApp Products | 2021-03-04 |
| [**NTAP-20201202-0003**](https://security.netapp.com/advisory/ntap-20201202-0003/) | November 2020 PostgreSQL Vulnerabilities in NetApp Products | 2021-03-24 |
| [**NTAP-20201202-0002**](https://security.netapp.com/advisory/ntap-20201202-0002/) | November 2020 QEMU Vulnerabilities in NetApp Products | 2021-02-03 |
| [**NTAP-20201123-0007**](https://security.netapp.com/advisory/ntap-20201123-0007/) | CVE-2020-15376 Brocade Fabric Operating System Firmware Vulnerability | 2020-11-23 |
| [**NTAP-20201123-0002**](https://security.netapp.com/advisory/ntap-20201123-0002/) | CVE-2020-24303 Grafana Vulnerability in NetApp Products | 2021-02-05 |
| [**NTAP-20201123-0003**](https://security.netapp.com/advisory/ntap-20201123-0003/) | CVE-2020-24352 QEMU Vulnerability in NetApp Products | 2020-11-23 |
| [**NTAP-20201123-0006**](https://security.netapp.com/advisory/ntap-20201123-0006/) | CVE-2020-25689 WildFly Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20201123-0005**](https://security.netapp.com/advisory/ntap-20201123-0005/) | CVE-2020-27216 Eclipse Jetty Vulnerability in NetApp Products | 2021-07-14 |
| [**NTAP-20201123-0004**](https://security.netapp.com/advisory/ntap-20201123-0004/) | CVE-2020-27619 Python Vulnerability in NetApp Products | 2021-05-19 |
| [**NTAP-20201123-0001**](https://security.netapp.com/advisory/ntap-20201123-0001/) | CVE-2020-7020 Elasticsearch Vulnerability in NetApp Products | 2021-03-03 |
| [**NTAP-20201113-0007**](https://security.netapp.com/advisory/ntap-20201113-0007/) | CVE-2020-8582 Sensitive Information Disclosure Vulnerability in NetApp SolidFire & HCI Storage Node (Element Software) | 2020-11-13 |
| [**NTAP-20201113-0008**](https://security.netapp.com/advisory/ntap-20201113-0008/) | CVE-2020-8583 Sensitive Information Disclosure Vulnerability in NetApp SolidFire & HCI Storage Node (Element Software) | 2020-11-13 |
| [**NTAP-20201113-0001**](https://security.netapp.com/advisory/ntap-20201113-0001/) | Intel SA-00358 BIOS Firmware Vulnerabilities in NetApp Products | 2022-01-24 |
| [**NTAP-20201113-0006**](https://security.netapp.com/advisory/ntap-20201113-0006/) | Intel SA-00381 Processor Vulnerabilities in NetApp Products | 2022-02-23 |
| [**NTAP-20201113-0003**](https://security.netapp.com/advisory/ntap-20201113-0003/) | Intel SA-00391 AMT Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20201113-0002**](https://security.netapp.com/advisory/ntap-20201113-0002/) | Intel SA-00391 CSME Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20201113-0005**](https://security.netapp.com/advisory/ntap-20201113-0005/) | Intel SA-00391 Intel TXE Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20201113-0004**](https://security.netapp.com/advisory/ntap-20201113-0004/) | Intel SA-00391 SPS Vulnerabilities in NetApp Products | 2022-04-28 |
| [**NTAP-20201105-0001**](https://security.netapp.com/advisory/ntap-20201105-0001/) | CVE-2020-8577 Sensitive Information Disclosure Vulnerability in SANtricity OS Controller Software 11.50.1 and higher | 2020-11-24 |
| [**NTAP-20201105-0002**](https://security.netapp.com/advisory/ntap-20201105-0002/) | CVE-2020-8580 Denial of Service Vulnerability in SANtricity OS Controller Software 11.30 and higher | 2020-11-05 |
| [**NTAP-20201103-0003**](https://security.netapp.com/advisory/ntap-20201103-0003/) | CVE-2018-11764 Apache Hadoop Vulnerability in NetApp Products | 2020-11-03 |
| [**NTAP-20201103-0002**](https://security.netapp.com/advisory/ntap-20201103-0002/) | CVE-2020-25643 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20201103-0004**](https://security.netapp.com/advisory/ntap-20201103-0004/) | CVE-2020-25645 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20201103-0001**](https://security.netapp.com/advisory/ntap-20201103-0001/) | October 2020 Samba Vulnerabilities in NetApp Products | 2020-11-03 |
| [**NTAP-20201026-0001**](https://security.netapp.com/advisory/ntap-20201026-0001/) | CVE-2020-8579 Denial of Service Vulnerability in clustered Data ONTAP 9.7.x | 2020-10-26 |
| [**NTAP-20201023-0002**](https://security.netapp.com/advisory/ntap-20201023-0002/) | CVE-2020-13957 Apache Solr Vulnerability in NetApp Products | 2020-10-23 |
| [**NTAP-20201023-0001**](https://security.netapp.com/advisory/ntap-20201023-0001/) | CVE-2020-26116 Python Vulnerability in NetApp Products | 2021-05-19 |
| [**NTAP-20201023-0004**](https://security.netapp.com/advisory/ntap-20201023-0004/) | October 2020 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2022-11-21 |
| [**NTAP-20201023-0003**](https://security.netapp.com/advisory/ntap-20201023-0003/) | October 2020 MySQL Vulnerabilities in NetApp Products | 2022-01-21 |
| [**NTAP-20201016-0005**](https://security.netapp.com/advisory/ntap-20201016-0005/) | CVE-2018-11765 Apache Hadoop Vulnerability in NetApp Products | 2020-10-16 |
| [**NTAP-20201016-0007**](https://security.netapp.com/advisory/ntap-20201016-0007/) | CVE-2020-13943 Apache Tomcat Vulnerability in NetApp Products | 2021-01-04 |
| [**NTAP-20201016-0003**](https://security.netapp.com/advisory/ntap-20201016-0003/) | CVE-2020-25626 Django Vulnerability in NetApp Products | 2020-11-09 |
| [**NTAP-20201016-0004**](https://security.netapp.com/advisory/ntap-20201016-0004/) | CVE-2020-25644 WildFly Vulnerability in NetApp Products | 2021-08-24 |
| [**NTAP-20201016-0006**](https://security.netapp.com/advisory/ntap-20201016-0006/) | Intel SA-00435 BlueZ Vulnerabilities in NetApp Products | 2021-03-02 |
| [**NTAP-20201016-0002**](https://security.netapp.com/advisory/ntap-20201016-0002/) | October 2020 FreeBSD Vulnerabilities in NetApp Products | 2021-06-18 |
| [**NTAP-20201016-0001**](https://security.netapp.com/advisory/ntap-20201016-0001/) | October 2020 PHP Vulnerabilities in NetApp Products | 2021-10-12 |
| [**NTAP-20201009-0003**](https://security.netapp.com/advisory/ntap-20201009-0003/) | CVE-2020-24750 FasterXML jackson-databind Vulnerability in NetApp Products | 2021-07-13 |
| [**NTAP-20201009-0001**](https://security.netapp.com/advisory/ntap-20201009-0001/) | CVE-2020-25211 Linux Kernel Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20201009-0002**](https://security.netapp.com/advisory/ntap-20201009-0002/) | CVE-2020-25285 Linux Kernel Vulnerability in NetApp Products | 2023-11-01 |
| [**NTAP-20201009-0004**](https://security.netapp.com/advisory/ntap-20201009-0004/) | October 2020 Node.js Vulnerabilities in NetApp Products | 2021-03-04 |
| [**NTAP-20201009-0005**](https://security.netapp.com/advisory/ntap-20201009-0005/) | October 2020 QEMU Vulnerabilities in NetApp Products | 2020-11-17 |
| [**NTAP-20201001-0006**](https://security.netapp.com/advisory/ntap-20201001-0006/) | CVE-2020-10733 PostgreSQL Vulnerability in NetApp Products | 2021-03-03 |
| [**NTAP-20201001-0001**](https://security.netapp.com/advisory/ntap-20201001-0001/) | CVE-2020-10756 QEMU Vulnerability in NetApp Products | 2020-11-17 |
| [**NTAP-20201001-0005**](https://security.netapp.com/advisory/ntap-20201001-0005/) | CVE-2020-1748 WildFly Vulnerability in NetApp Products | 2020-11-24 |
| [**NTAP-20201001-0004**](https://security.netapp.com/advisory/ntap-20201001-0004/) | CVE-2020-25220 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20201001-0003**](https://security.netapp.com/advisory/ntap-20201001-0003/) | CVE-2020-25221 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20201001-0002**](https://security.netapp.com/advisory/ntap-20201001-0002/) | CVE-2020-8608 QEMU Vulnerability in NetApp Products | 2020-11-17 |
| [**NTAP-20200924-0005**](https://security.netapp.com/advisory/ntap-20200924-0005/) | CVE-2019-19543 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200924-0006**](https://security.netapp.com/advisory/ntap-20200924-0006/) | CVE-2020-14364 QEMU Vulnerability in NetApp Products | 2020-11-17 |
| [**NTAP-20200924-0002**](https://security.netapp.com/advisory/ntap-20200924-0002/) | CVE-2020-16845 Golang Vulnerability in NetApp Products | 2020-09-24 |
| [**NTAP-20200924-0003**](https://security.netapp.com/advisory/ntap-20200924-0003/) | CVE-2020-24553 Golang Vulnerability in NetApp Products | 2020-09-28 |
| [**NTAP-20200924-0001**](https://security.netapp.com/advisory/ntap-20200924-0001/) | CVE-2020-24977 Libxml2 Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200924-0004**](https://security.netapp.com/advisory/ntap-20200924-0004/) | CVE-2020-8648 Linux Kernel Vulnerability in NetApp Products | 2023-08-02 |
| [**NTAP-20200918-0001**](https://security.netapp.com/advisory/ntap-20200918-0001/) | August 2020 NGINX Vulnerabilities in NetApp Products | 2024-01-02 |
| [**NTAP-20200918-0002**](https://security.netapp.com/advisory/ntap-20200918-0002/) | August 2020 PostgreSQL Vulnerabilities in NetApp Products | 2021-03-03 |
| [**NTAP-20200918-0003**](https://security.netapp.com/advisory/ntap-20200918-0003/) | CVE-2019-19499 Grafana Vulnerability in NetApp Products | 2020-09-24 |
| [**NTAP-20200918-0005**](https://security.netapp.com/advisory/ntap-20200918-0005/) | CVE-2020-7068 PHP Vulnerability in NetApp Products | 2020-10-27 |
| [**NTAP-20200918-0004**](https://security.netapp.com/advisory/ntap-20200918-0004/) | September 2020 Django Vulnerabilities in NetApp Products | 2020-11-17 |
| [**NTAP-20200911-0004**](https://security.netapp.com/advisory/ntap-20200911-0004/) | CVE-2020-1968 OpenSSL Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20200911-0006**](https://security.netapp.com/advisory/ntap-20200911-0006/) | CVE-2020-24659 GnuTLS Vulnerability in NetApp Products | 2022-03-07 |
| [**NTAP-20200911-0002**](https://security.netapp.com/advisory/ntap-20200911-0002/) | CVE-2020-8169 cURL/libcURL Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200911-0001**](https://security.netapp.com/advisory/ntap-20200911-0001/) | CVE-2020-8177 cURL/libcURL Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200911-0003**](https://security.netapp.com/advisory/ntap-20200911-0003/) | CVE-2020-8231 cURL/libcURL Vulnerability in NetApp Products | 2022-08-01 |
| [**NTAP-20200911-0005**](https://security.netapp.com/advisory/ntap-20200911-0005/) | CVE-2020-8758 Intel AMT Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200904-0006**](https://security.netapp.com/advisory/ntap-20200904-0006/) | August 2020 FasterXML jackson-databind Vulnerabilities in NetApp Products | 2021-07-13 |
| [**NTAP-20200904-0001**](https://security.netapp.com/advisory/ntap-20200904-0001/) | August 2020 Net-SNMP Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20200904-0004**](https://security.netapp.com/advisory/ntap-20200904-0004/) | CVE-2018-1000873 FasterXML jackson-databind Vulnerability in NetApp Products | 2021-07-13 |
| [**NTAP-20200904-0005**](https://security.netapp.com/advisory/ntap-20200904-0005/) | CVE-2019-14892 FasterXML jackson-databind Vulnerability in NetApp Products | 2021-07-13 |
| [**NTAP-20200904-0002**](https://security.netapp.com/advisory/ntap-20200904-0002/) | CVE-2020-14356 Linux Kernel Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20200904-0003**](https://security.netapp.com/advisory/ntap-20200904-0003/) | CVE-2020-24394 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200902-0001**](https://security.netapp.com/advisory/ntap-20200902-0001/) | CVE-2020-8576 Sensitive Information Disclosure Vulnerability in Clustered Data ONTAP | 2020-09-02 |
| [**NTAP-20200827-0003**](https://security.netapp.com/advisory/ntap-20200827-0003/) | August 2020 ISC BIND Vulnerabilities in NetApp Products | 2021-01-05 |
| [**NTAP-20200827-0004**](https://security.netapp.com/advisory/ntap-20200827-0004/) | CVE-2018-15173 Nmap Vulnerability in NetApp Products | 2020-08-27 |
| [**NTAP-20200827-0002**](https://security.netapp.com/advisory/ntap-20200827-0002/) | CVE-2020-11985 Apache HTTP Server Vulnerability in NetApp Products | 2020-09-01 |
| [**NTAP-20200827-0001**](https://security.netapp.com/advisory/ntap-20200827-0001/) | CVE-2020-7019 Elasticsearch Vulnerability in NetApp Products | 2021-03-03 |
| [**NTAP-20200821-0004**](https://security.netapp.com/advisory/ntap-20200821-0004/) | August 2020 Apache Struts 2.x Vulnerabilities in NetApp Products | 2020-09-17 |
| [**NTAP-20200821-0005**](https://security.netapp.com/advisory/ntap-20200821-0005/) | August 2020 FreeBSD Vulnerabilities in NetApp Products | 2020-08-21 |
| [**NTAP-20200821-0006**](https://security.netapp.com/advisory/ntap-20200821-0006/) | CVE-2020-16092 QEMU Vulnerability in NetApp Products | 2020-11-17 |
| [**NTAP-20200821-0003**](https://security.netapp.com/advisory/ntap-20200821-0003/) | CVE-2020-7699 Nodejs Vulnerability in NetApp Products | 2021-04-05 |
| [**NTAP-20200821-0002**](https://security.netapp.com/advisory/ntap-20200821-0002/) | CVE-2020-8557 Kubernetes Vulnerability in NetApp Products | 2020-08-21 |
| [**NTAP-20200821-0001**](https://security.netapp.com/advisory/ntap-20200821-0001/) | CVE-2020-8558 Kubernetes Vulnerability in NetApp Products | 2020-08-21 |
| [**NTAP-20200814-0005**](https://security.netapp.com/advisory/ntap-20200814-0005/) | August 2020 Apache HTTP Server Vulnerabilities in NetApp Products | 2021-06-14 |
| [**NTAP-20200814-0004**](https://security.netapp.com/advisory/ntap-20200814-0004/) | CVE-2020-16166 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20200814-0001**](https://security.netapp.com/advisory/ntap-20200814-0001/) | Intel SA-00367 Server Board Firmware Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20200814-0002**](https://security.netapp.com/advisory/ntap-20200814-0002/) | Intel SA-00384 Server Boards, Systems and Compute Module Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20200814-0003**](https://security.netapp.com/advisory/ntap-20200814-0003/) | Intel SA-00386 Server Board Firmware Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20200810-0003**](https://security.netapp.com/advisory/ntap-20200810-0003/) | CVE-2019-11255 Kubernetes Vulnerability in NetApp Products | 2021-03-15 |
| [**NTAP-20200810-0002**](https://security.netapp.com/advisory/ntap-20200810-0002/) | CVE-2020-11110 Grafana Vulnerability in NetApp Products | 2022-03-07 |
| [**NTAP-20200810-0001**](https://security.netapp.com/advisory/ntap-20200810-0001/) | CVE-2020-15852 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200810-0004**](https://security.netapp.com/advisory/ntap-20200810-0004/) | CVE-2020-8559 Kubernetes Vulnerability in NetApp Products | 2020-08-10 |
| [**NTAP-20200803-0001**](https://security.netapp.com/advisory/ntap-20200803-0001/) | CVE-2020-8574 Unauthorized Code Execution Vulnerability in Active IQ Unified Manager for Linux 7.3 and above | 2020-08-03 |
| [**NTAP-20200803-0002**](https://security.netapp.com/advisory/ntap-20200803-0002/) | CVE-2020-8575 Denial of Service Vulnerability in Active IQ Unified Manager for VMware vSphere and Windows | 2020-08-03 |
| [**NTAP-20200731-0002**](https://security.netapp.com/advisory/ntap-20200731-0002/) | CVE-2019-20907 Python Vulnerability in NetApp Products | 2022-03-02 |
| [**NTAP-20200731-0001**](https://security.netapp.com/advisory/ntap-20200731-0001/) | CVE-2020-10761 QEMU Vulnerability in NetApp Products | 2020-07-31 |
| [**NTAP-20200731-0004**](https://security.netapp.com/advisory/ntap-20200731-0004/) | CVE-2020-14001 Ruby Vulnerability in NetApp Products | 2020-07-31 |
| [**NTAP-20200731-0006**](https://security.netapp.com/advisory/ntap-20200731-0006/) | CVE-2020-14725 MySQL Vulnerability in NetApp Products | 2021-01-19 |
| [**NTAP-20200731-0007**](https://security.netapp.com/advisory/ntap-20200731-0007/) | CVE-2020-15778 OpenSSH Vulnerability in NetApp Products | 2021-04-23 |
| [**NTAP-20200731-0003**](https://security.netapp.com/advisory/ntap-20200731-0003/) | CVE-2020-15801 Python Vulnerability in NetApp Products | 2021-05-19 |
| [**NTAP-20200731-0005**](https://security.netapp.com/advisory/ntap-20200731-0005/) | July 2020 Golang Vulnerabilities in NetApp Products | 2020-09-17 |
| [**NTAP-20200731-0008**](https://security.netapp.com/advisory/ntap-20200731-0008/) | July 2020 Grub2 Vulnerabilities in NetApp Products | 2022-02-28 |
| [**NTAP-20200724-0007**](https://security.netapp.com/advisory/ntap-20200724-0007/) | CVE-2020-10702 QEMU Vulnerability in NetApp Products | 2020-07-24 |
| [**NTAP-20200724-0004**](https://security.netapp.com/advisory/ntap-20200724-0004/) | CVE-2020-14422 Python Vulnerability in NetApp Products | 2021-05-19 |
| [**NTAP-20200724-0006**](https://security.netapp.com/advisory/ntap-20200724-0006/) | CVE-2020-8203 Lodash Vulnerability in NetApp Products | 2022-08-03 |
| [**NTAP-20200724-0005**](https://security.netapp.com/advisory/ntap-20200724-0005/) | CVE-2020-8555 Kubernetes Vulnerability in NetApp Products | 2020-11-17 |
| [**NTAP-20200724-0003**](https://security.netapp.com/advisory/ntap-20200724-0003/) | July 2020 Apache Tomcat Vulnerabilities in NetApp Products | 2021-01-04 |
| [**NTAP-20200724-0002**](https://security.netapp.com/advisory/ntap-20200724-0002/) | July 2020 FreeBSD Vulnerabilities in NetApp Products | 2020-07-24 |
| [**NTAP-20200724-0001**](https://security.netapp.com/advisory/ntap-20200724-0001/) | June 2020 Node.js Vulnerabilities in NetApp Products | 2021-04-05 |
| [**NTAP-20200717-0002**](https://security.netapp.com/advisory/ntap-20200717-0002/) | CVE-2020-13401 Docker Vulnerability in NetApp Products | 2021-06-22 |
| [**NTAP-20200717-0003**](https://security.netapp.com/advisory/ntap-20200717-0003/) | CVE-2020-14002 PuTTY Vulnerability in NetApp Products | 2021-02-12 |
| [**NTAP-20200717-0005**](https://security.netapp.com/advisory/ntap-20200717-0005/) | July 2020 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2022-11-21 |
| [**NTAP-20200717-0004**](https://security.netapp.com/advisory/ntap-20200717-0004/) | July 2020 MySQL Vulnerabilities in NetApp Products | 2021-06-23 |
| [**NTAP-20200717-0001**](https://security.netapp.com/advisory/ntap-20200717-0001/) | June 2020 QEMU Vulnerabilities in NetApp Products | 2020-07-17 |
| [**NTAP-20200709-0002**](https://security.netapp.com/advisory/ntap-20200709-0002/) | CVE-2020-11996 Apache Tomcat Vulnerability in NetApp Products | 2021-01-04 |
| [**NTAP-20200709-0004**](https://security.netapp.com/advisory/ntap-20200709-0004/) | CVE-2020-14145 OpenSSH Vulnerability in NetApp Products | 2023-11-17 |
| [**NTAP-20200709-0003**](https://security.netapp.com/advisory/ntap-20200709-0003/) | CVE-2020-14303 Samba Vulnerability in NetApp Products | 2020-07-09 |
| [**NTAP-20200709-0001**](https://security.netapp.com/advisory/ntap-20200709-0001/) | CVE-2020-15358 SQLite Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200702-0004**](https://security.netapp.com/advisory/ntap-20200702-0004/) | CVE-2020-10757 Linux Kernel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20200702-0006**](https://security.netapp.com/advisory/ntap-20200702-0006/) | CVE-2020-12662 Unbound Vulnerability in NetApp Products | 2020-07-02 |
| [**NTAP-20200702-0002**](https://security.netapp.com/advisory/ntap-20200702-0002/) | CVE-2020-15025 Network Time Protocol Daemon (ntpd) Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200702-0003**](https://security.netapp.com/advisory/ntap-20200702-0003/) | June 2020 FasterXML jackson-databind Vulnerabilities in NetApp Products | 2021-07-13 |
| [**NTAP-20200702-0005**](https://security.netapp.com/advisory/ntap-20200702-0005/) | June 2020 Libxml2 Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20200702-0001**](https://security.netapp.com/advisory/ntap-20200702-0001/) | June 2020 Samba Vulnerabilities in NetApp Products | 2020-07-02 |
| [**NTAP-20200626-0001**](https://security.netapp.com/advisory/ntap-20200626-0001/) | CVE-2020-8573 Default Account Vulnerability in the NetApp HCI Baseboard Management Controller (BMC) - H610C, H615C and H610S | 2020-10-01 |
| [**NTAP-20200625-0001**](https://security.netapp.com/advisory/ntap-20200625-0001/) | CVE-2020-10933 Ruby Vulnerability in NetApp Products | 2020-06-30 |
| [**NTAP-20200625-0004**](https://security.netapp.com/advisory/ntap-20200625-0004/) | CVE-2020-13817 NTP Vulnerability in NetApp Products | 2022-08-26 |
| [**NTAP-20200625-0005**](https://security.netapp.com/advisory/ntap-20200625-0005/) | CVE-2020-7456 FreeBSD Vulnerability in NetApp Products | 2021-11-25 |
| [**NTAP-20200625-0002**](https://security.netapp.com/advisory/ntap-20200625-0002/) | CVE-2020-8172 Nodejs Vulnerability in NetApp Products | 2021-04-05 |
| [**NTAP-20200625-0003**](https://security.netapp.com/advisory/ntap-20200625-0003/) | June 2020 ISC BIND Vulnerabilities in NetApp Products | 2021-01-05 |
| [**NTAP-20200625-0006**](https://security.netapp.com/advisory/ntap-20200625-0006/) | June 2020 Treck TCP/IP Library Vulnerabilities in NetApp Products | 2020-07-22 |
| [**NTAP-20200619-0001**](https://security.netapp.com/advisory/ntap-20200619-0001/) | CVE-2019-20806 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200619-0005**](https://security.netapp.com/advisory/ntap-20200619-0005/) | CVE-2020-13692 PostgreSQL Vulnerability in NetApp Products | 2021-03-03 |
| [**NTAP-20200619-0006**](https://security.netapp.com/advisory/ntap-20200619-0006/) | CVE-2020-13765 QEMU Vulnerability in NetApp Products | 2020-06-19 |
| [**NTAP-20200619-0004**](https://security.netapp.com/advisory/ntap-20200619-0004/) | CVE-2020-13777 GnuTLS Vulnerability in NetApp Products | 2020-07-17 |
| [**NTAP-20200619-0002**](https://security.netapp.com/advisory/ntap-20200619-0002/) | CVE-2020-13871 SQLite Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20200619-0003**](https://security.netapp.com/advisory/ntap-20200619-0003/) | CVE-2020-7014 Elasticsearch Vulnerability in NetApp Products | 2021-03-03 |
| [**NTAP-20200611-0003**](https://security.netapp.com/advisory/ntap-20200611-0003/) | CVE-2020-13776 Systemd Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20200611-0007**](https://security.netapp.com/advisory/ntap-20200611-0007/) | Intel SA-00295 AMT Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20200611-0006**](https://security.netapp.com/advisory/ntap-20200611-0006/) | Intel SA-00295 CSME Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20200611-0004**](https://security.netapp.com/advisory/ntap-20200611-0004/) | Intel SA-00295 SPS Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200611-0005**](https://security.netapp.com/advisory/ntap-20200611-0005/) | Intel SA-00295 TXE Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200611-0002**](https://security.netapp.com/advisory/ntap-20200611-0002/) | June 2020 Django Vulnerabilities in NetApp Products | 2021-12-10 |
| [**NTAP-20200611-0001**](https://security.netapp.com/advisory/ntap-20200611-0001/) | June 2020 Perl Vulnerabilities in NetApp Products | 2022-08-29 |
| [**NTAP-20200608-0005**](https://security.netapp.com/advisory/ntap-20200608-0005/) | CVE-2020-10703 Libvirt Vulnerability in NetApp Products | 2020-06-08 |
| [**NTAP-20200608-0006**](https://security.netapp.com/advisory/ntap-20200608-0006/) | CVE-2020-13379 Grafana Vulnerability in NetApp Products | 2020-06-18 |
| [**NTAP-20200608-0004**](https://security.netapp.com/advisory/ntap-20200608-0004/) | CVE-2020-13645 GNOME GLib Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200608-0008**](https://security.netapp.com/advisory/ntap-20200608-0008/) | June 2020 Grafana Vulnerabilities in NetApp Products | 2020-06-18 |
| [**NTAP-20200608-0003**](https://security.netapp.com/advisory/ntap-20200608-0003/) | June 2020 QEMU Vulnerabilities in NetApp Products | 2020-06-08 |
| [**NTAP-20200608-0007**](https://security.netapp.com/advisory/ntap-20200608-0007/) | June 2020 QEMU Vulnerabilities in NetApp Products | 2020-06-08 |
| [**NTAP-20200608-0002**](https://security.netapp.com/advisory/ntap-20200608-0002/) | June 2020 SQLite Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20200608-0001**](https://security.netapp.com/advisory/ntap-20200608-0001/) | May 2020 Linux Kernel Vulnerabilities in NetApp Products | 2023-02-07 |
| [**NTAP-20200528-0006**](https://security.netapp.com/advisory/ntap-20200528-0006/) | CVE-2019-11048 PHP Vulnerability in NetApp Products | 2020-06-18 |
| [**NTAP-20200528-0002**](https://security.netapp.com/advisory/ntap-20200528-0002/) | CVE-2020-13388 Python Vulnerability in NetApp Products | 2021-05-19 |
| [**NTAP-20200528-0003**](https://security.netapp.com/advisory/ntap-20200528-0003/) | CVE-2020-13430 Grafana Vulnerability in NetApp Products | 2020-06-16 |
| [**NTAP-20200528-0001**](https://security.netapp.com/advisory/ntap-20200528-0001/) | CVE-2020-7656 jQuery Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20200528-0005**](https://security.netapp.com/advisory/ntap-20200528-0005/) | CVE-2020-9484 Apache Tomcat Vulnerability in NetApp Products | 2021-01-04 |
| [**NTAP-20200528-0004**](https://security.netapp.com/advisory/ntap-20200528-0004/) | May 2020 SQLite Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20200522-0001**](https://security.netapp.com/advisory/ntap-20200522-0001/) | CVE-2020-5895 NGINX Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20200522-0002**](https://security.netapp.com/advisory/ntap-20200522-0002/) | May 2020 ISC BIND Vulnerabilities in NetApp Products | 2020-09-01 |
| [**NTAP-20200520-0001**](https://security.netapp.com/advisory/ntap-20200520-0001/) | CVE-2020-8572 Sensitive Information Disclosure Vulnerability in Element OS and Element HealthTools | 2020-05-20 |
| [**NTAP-20200518-0006**](https://security.netapp.com/advisory/ntap-20200518-0006/) | CVE-2018-8956 Network Time Protocol Daemon (ntpd) Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20200518-0007**](https://security.netapp.com/advisory/ntap-20200518-0007/) | CVE-2019-15878 FreeBSD Vulnerability in NetApp Products | 2020-05-22 |
| [**NTAP-20200518-0008**](https://security.netapp.com/advisory/ntap-20200518-0008/) | CVE-2019-15880 FreeBSD Vulnerability in NetApp Products | 2020-05-22 |
| [**NTAP-20200518-0002**](https://security.netapp.com/advisory/ntap-20200518-0002/) | CVE-2020-10683 Dom4j Vulnerability in NetApp Products | 2021-11-26 |
| [**NTAP-20200518-0003**](https://security.netapp.com/advisory/ntap-20200518-0003/) | CVE-2020-12430 Libvirt Vulnerability in NetApp Products | 2020-05-18 |
| [**NTAP-20200518-0001**](https://security.netapp.com/advisory/ntap-20200518-0001/) | CVE-2020-12458 Grafana Vulnerability in NetApp Products | 2020-05-18 |
| [**NTAP-20200518-0004**](https://security.netapp.com/advisory/ntap-20200518-0004/) | CVE-2020-12459 Grafana Vulnerability in NetApp Products | 2020-05-26 |
| [**NTAP-20200518-0005**](https://security.netapp.com/advisory/ntap-20200518-0005/) | May 2020 FreeBSD Vulnerabilities in NetApp Products | 2020-05-22 |
| [**NTAP-20200511-0008**](https://security.netapp.com/advisory/ntap-20200511-0008/) | CVE-2019-16203 Brocade Fabric Operating System Firmware Vulnerability | 2020-05-11 |
| [**NTAP-20200511-0007**](https://security.netapp.com/advisory/ntap-20200511-0007/) | CVE-2019-16204 Brocade Fabric Operating System Firmware Vulnerability | 2020-05-11 |
| [**NTAP-20200511-0003**](https://security.netapp.com/advisory/ntap-20200511-0003/) | CVE-2020-12243 OpenLDAP Vulnerability in NetApp Products | 2023-08-02 |
| [**NTAP-20200511-0005**](https://security.netapp.com/advisory/ntap-20200511-0005/) | CVE-2020-1752 GNU C Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20200511-0004**](https://security.netapp.com/advisory/ntap-20200511-0004/) | May 2020 FasterXML jackson-databind Vulnerabilities in NetApp Products | 2020-12-02 |
| [**NTAP-20200511-0002**](https://security.netapp.com/advisory/ntap-20200511-0002/) | May 2020 FreeBSD Vulnerabilities in NetApp Products | 2021-10-28 |
| [**NTAP-20200511-0001**](https://security.netapp.com/advisory/ntap-20200511-0001/) | May 2020 Grafana Vulnerabilities in NetApp Products | 2020-06-16 |
| [**NTAP-20200511-0006**](https://security.netapp.com/advisory/ntap-20200511-0006/) | May 2020 jQuery Vulnerabilities in NetApp Products | 2024-01-02 |
| [**NTAP-20200507-0001**](https://security.netapp.com/advisory/ntap-20200507-0001/) | CVE-2018-5493 Denial of Service (DoS) vulnerability in ATTO FibreBridge 7500N | 2020-05-07 |
| [**NTAP-20200504-0002**](https://security.netapp.com/advisory/ntap-20200504-0002/) | CVE-2019-4729 IBM Cognos Analytics Vulnerability in NetApp Products | 2020-12-11 |
| [**NTAP-20200504-0001**](https://security.netapp.com/advisory/ntap-20200504-0001/) | CVE-2020-7067 PHP Vulnerability in NetApp Products | 2020-05-04 |
| [**NTAP-20200504-0003**](https://security.netapp.com/advisory/ntap-20200504-0003/) | CVE-2020-9488 Apache Log4j Vulnerability in NetApp Products | 2021-07-13 |
| [**NTAP-20200430-0004**](https://security.netapp.com/advisory/ntap-20200430-0004/) | April 2020 Linux Kernel Vulnerabilities in NetApp Products | 2024-05-01 |
| [**NTAP-20200430-0005**](https://security.netapp.com/advisory/ntap-20200430-0005/) | April 2020 NGINX Vulnerabilities in NetApp Products | 2024-01-02 |
| [**NTAP-20200430-0003**](https://security.netapp.com/advisory/ntap-20200430-0003/) | CVE-2019-18276 GNU Bash Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20200430-0001**](https://security.netapp.com/advisory/ntap-20200430-0001/) | CVE-2020-11669 Linux Kernel Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200430-0002**](https://security.netapp.com/advisory/ntap-20200430-0002/) | CVE-2020-1751 GNU C Library (glibc) Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20200429-0001**](https://security.netapp.com/advisory/ntap-20200429-0001/) | April 2020 Samba Vulnerabilities in NetApp Products | 2020-04-29 |
| [**NTAP-20200424-0002**](https://security.netapp.com/advisory/ntap-20200424-0002/) | CVE-2020-11868 NTP Vulnerability in NetApp Products | 2022-08-26 |
| [**NTAP-20200424-0001**](https://security.netapp.com/advisory/ntap-20200424-0001/) | CVE-2020-1730 Libssh Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200424-0003**](https://security.netapp.com/advisory/ntap-20200424-0003/) | CVE-2020-1967 OpenSSL Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20200416-0004**](https://security.netapp.com/advisory/ntap-20200416-0004/) | April 2020 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2022-11-21 |
| [**NTAP-20200416-0003**](https://security.netapp.com/advisory/ntap-20200416-0003/) | April 2020 MySQL Vulnerabilities in NetApp Products | 2021-02-10 |
| [**NTAP-20200416-0001**](https://security.netapp.com/advisory/ntap-20200416-0001/) | April 2020 SQLite Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20200416-0002**](https://security.netapp.com/advisory/ntap-20200416-0002/) | CVE-2020-11501 GnuTLS Vulnerability in NetApp Products | 2020-06-25 |
| [**NTAP-20200413-0002**](https://security.netapp.com/advisory/ntap-20200413-0002/) | April 2020 Apache HTTP Server Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20200413-0003**](https://security.netapp.com/advisory/ntap-20200413-0003/) | April 2020 Kubernetes Vulnerabilities in NetApp Products | 2020-11-17 |
| [**NTAP-20200413-0001**](https://security.netapp.com/advisory/ntap-20200413-0001/) | March 2020 FreeBSD Vulnerabilities in NetApp Products | 2021-01-15 |
| [**NTAP-20200403-0002**](https://security.netapp.com/advisory/ntap-20200403-0002/) | April 2020 FasterXML jackson-databind Vulnerabilities in NetApp Products | 2020-12-08 |
| [**NTAP-20200403-0003**](https://security.netapp.com/advisory/ntap-20200403-0003/) | CVE-2020-10942 Linux Kernel Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20200403-0004**](https://security.netapp.com/advisory/ntap-20200403-0004/) | CVE-2020-7009 Elasticsearch Vulnerability in NetApp Products | 2020-04-06 |
| [**NTAP-20200403-0001**](https://security.netapp.com/advisory/ntap-20200403-0001/) | March 2020 PHP Vulnerabilities in NetApp Products | 2020-04-03 |
| [**NTAP-20200330-0001**](https://security.netapp.com/advisory/ntap-20200330-0001/) | CVE-2015-2992 Apache Struts Vulnerability in NetApp Products | 2020-09-17 |
| [**NTAP-20200327-0007**](https://security.netapp.com/advisory/ntap-20200327-0007/) | CVE-2019-14887 Wildfly Vulnerability in NetApp Products | 2020-05-26 |
| [**NTAP-20200327-0006**](https://security.netapp.com/advisory/ntap-20200327-0006/) | CVE-2019-14893 FasterXML jackson-databind Vulnerability in NetApp Products | 2020-11-27 |
| [**NTAP-20200327-0003**](https://security.netapp.com/advisory/ntap-20200327-0003/) | CVE-2020-10029 GNU C Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20200327-0001**](https://security.netapp.com/advisory/ntap-20200327-0001/) | CVE-2020-7919 Golang Vulnerability in NetApp Products | 2020-10-19 |
| [**NTAP-20200327-0002**](https://security.netapp.com/advisory/ntap-20200327-0002/) | CVE-2020-8840 FasterXML jackson-databind Vulnerability in NetApp Products | 2021-02-01 |
| [**NTAP-20200327-0004**](https://security.netapp.com/advisory/ntap-20200327-0004/) | CVE-2020-9402 Django Vulnerability in NetApp Products | 2020-09-01 |
| [**NTAP-20200327-0005**](https://security.netapp.com/advisory/ntap-20200327-0005/) | February 2020 Apache Tomcat Vulnerabilities in NetApp Products | 2021-01-04 |
| [**NTAP-20200323-0001**](https://security.netapp.com/advisory/ntap-20200323-0001/) | CVE-2019-17276 Cross-Site Scripting Vulnerability in OnCommand System Manager 9.x | 2020-03-23 |
| [**NTAP-20200320-0005**](https://security.netapp.com/advisory/ntap-20200320-0005/) | Intel SA-00242 Graphics Drivers Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20200320-0004**](https://security.netapp.com/advisory/ntap-20200320-0004/) | Intel SA-00260 Intel Graphics Drivers Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200320-0003**](https://security.netapp.com/advisory/ntap-20200320-0003/) | Intel SA-00315 Intel Graphics Drivers Vulnerabilities in NetApp Products | 2020-03-20 |
| [**NTAP-20200320-0001**](https://security.netapp.com/advisory/ntap-20200320-0001/) | Intel SA-00330 Intel Processor Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200320-0002**](https://security.netapp.com/advisory/ntap-20200320-0002/) | Intel SA-00334 Intel Processor Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200313-0001**](https://security.netapp.com/advisory/ntap-20200313-0001/) | CVE-2020-8441 JYaml Vulnerability in NetApp Products | 2021-11-26 |
| [**NTAP-20200313-0005**](https://security.netapp.com/advisory/ntap-20200313-0005/) | CVE-2020-8571 Denial of Service Vulnerability in StorageGRID (formerly StorageGRID Webscale) | 2020-03-13 |
| [**NTAP-20200313-0004**](https://security.netapp.com/advisory/ntap-20200313-0004/) | CVE-2020-8597 PPP Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200313-0002**](https://security.netapp.com/advisory/ntap-20200313-0002/) | CVE-2020-9327 SQLite Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200313-0003**](https://security.netapp.com/advisory/ntap-20200313-0003/) | February 2020 Linux Kernel Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20200226-0001**](https://security.netapp.com/advisory/ntap-20200226-0001/) | CVE-2019-17274 Default Privileged Account Vulnerability in the NetApp FAS 8300/8700 and AFF A400 Baseboard Management Controller | 2020-02-26 |
| [**NTAP-20200226-0003**](https://security.netapp.com/advisory/ntap-20200226-0003/) | CVE-2019-17275 Arbitrary Code Execution Vulnerability in OnCommand Cloud Manager | 2020-02-26 |
| [**NTAP-20200226-0002**](https://security.netapp.com/advisory/ntap-20200226-0002/) | CVE-2020-1938 Apache Tomcat Vulnerability in NetApp Products | 2021-01-04 |
| [**NTAP-20200221-0003**](https://security.netapp.com/advisory/ntap-20200221-0003/) | CVE-2019-9674 Python Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20200221-0006**](https://security.netapp.com/advisory/ntap-20200221-0006/) | CVE-2020-7471 Django Vulnerability in NetApp Products | 2020-09-01 |
| [**NTAP-20200221-0001**](https://security.netapp.com/advisory/ntap-20200221-0001/) | CVE-2020-8492 Python Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20200221-0004**](https://security.netapp.com/advisory/ntap-20200221-0004/) | February 2020 Node.js Vulnerabilities in NetApp Products | 2020-04-02 |
| [**NTAP-20200221-0002**](https://security.netapp.com/advisory/ntap-20200221-0002/) | February 2020 PHP Vulnerabilities in NetApp Products | 2020-02-21 |
| [**NTAP-20200221-0005**](https://security.netapp.com/advisory/ntap-20200221-0005/) | Intel SA-00307 Processor Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200210-0001**](https://security.netapp.com/advisory/ntap-20200210-0001/) | CVE-2019-18634 Sudo Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200210-0002**](https://security.netapp.com/advisory/ntap-20200210-0002/) | CVE-2019-20386 Systemd Vulnerability in NetApp Products | 2023-02-07 |
| [**NTAP-20200210-0003**](https://security.netapp.com/advisory/ntap-20200210-0003/) | February 2020 FreeBSD Vulnerabilities in NetApp Products | 2020-02-11 |
| [**NTAP-20200210-0004**](https://security.netapp.com/advisory/ntap-20200210-0004/) | Intel SA-00329 Processor Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20200204-0001**](https://security.netapp.com/advisory/ntap-20200204-0001/) | CVE-2019-19959 SQLite Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200204-0002**](https://security.netapp.com/advisory/ntap-20200204-0002/) | January 2020 Linux Kernel Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20200204-0003**](https://security.netapp.com/advisory/ntap-20200204-0003/) | January 2020 NTP Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20200129-0001**](https://security.netapp.com/advisory/ntap-20200129-0001/) | CVE-2019-17273 IPv6 Denial of Service Vulnerability in E-Series SANtricity OS Controller Software 11.60.0 | 2020-01-29 |
| [**NTAP-20200127-0002**](https://security.netapp.com/advisory/ntap-20200127-0002/) | CVE-2019-15601 cURL/libcURL Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200127-0004**](https://security.netapp.com/advisory/ntap-20200127-0004/) | CVE-2019-20330 FasterXML jackson-databind Vulnerability in NetApp Products | 2021-02-01 |
| [**NTAP-20200127-0003**](https://security.netapp.com/advisory/ntap-20200127-0003/) | CVE-2019-20372 NGINX vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20200127-0001**](https://security.netapp.com/advisory/ntap-20200127-0001/) | CVE-2020-6750 GNOME GLib Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200122-0003**](https://security.netapp.com/advisory/ntap-20200122-0003/) | January 2020 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2022-03-07 |
| [**NTAP-20200122-0002**](https://security.netapp.com/advisory/ntap-20200122-0002/) | January 2020 MySQL Vulnerabilities in NetApp Products | 2020-12-04 |
| [**NTAP-20200122-0001**](https://security.netapp.com/advisory/ntap-20200122-0001/) | January 2020 Samba Vulnerabilities in NetApp Products | 2020-01-22 |
| [**NTAP-20200120-0001**](https://security.netapp.com/advisory/ntap-20200120-0001/) | October 2019 Tcpdump Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20200115-0001**](https://security.netapp.com/advisory/ntap-20200115-0001/) | CVE-2019-18218 File Vulnerability in NetApp Products | 2020-03-16 |
| [**NTAP-20200115-0002**](https://security.netapp.com/advisory/ntap-20200115-0002/) | CVE-2019-5094 E2FSProgs Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20200114-0001**](https://security.netapp.com/advisory/ntap-20200114-0001/) | CVE-2019-19880 SQLite Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20200114-0002**](https://security.netapp.com/advisory/ntap-20200114-0002/) | CVE-2019-19956 Libxml2 Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20200114-0003**](https://security.netapp.com/advisory/ntap-20200114-0003/) | January 2020 SQLite Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20200110-0001**](https://security.netapp.com/advisory/ntap-20200110-0001/) | CVE-2019-17571 Apache Log4j Vulnerability in NetApp Products | 2021-05-19 |
| [**NTAP-20200110-0003**](https://security.netapp.com/advisory/ntap-20200110-0003/) | CVE-2019-19844 Django Vulnerability in NetApp Products | 2020-09-01 |
| [**NTAP-20200110-0002**](https://security.netapp.com/advisory/ntap-20200110-0002/) | CVE-2019-4343 IBM Cognos Analytics Vulnerability in NetApp Products | 2020-06-02 |
| [**NTAP-20200107-0001**](https://security.netapp.com/advisory/ntap-20200107-0001/) | January 2020 Apache Tomcat Vulnerabilities in NetApp Products | 2021-01-04 |
| [**NTAP-20200103-0003**](https://security.netapp.com/advisory/ntap-20200103-0003/) | December 2019 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2020-06-02 |
| [**NTAP-20200103-0001**](https://security.netapp.com/advisory/ntap-20200103-0001/) | December 2019 Linux Kernel Vulnerabilities in NetApp Products | 2022-06-09 |
| [**NTAP-20200103-0002**](https://security.netapp.com/advisory/ntap-20200103-0002/) | December 2019 PHP Vulnerabilities in NetApp Products | 2020-01-03 |
| [**NTAP-20200103-0004**](https://security.netapp.com/advisory/ntap-20200103-0004/) | December 2019 Sudo Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20191223-0001**](https://security.netapp.com/advisory/ntap-20191223-0001/) | December 2019 SQLite Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20191217-0001**](https://security.netapp.com/advisory/ntap-20191217-0001/) | CVE-2019-11157 Intel Processor Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20191217-0002**](https://security.netapp.com/advisory/ntap-20191217-0002/) | CVE-2019-14607 Intel Processor Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20191217-0003**](https://security.netapp.com/advisory/ntap-20191217-0003/) | CVE-2019-19118 Django Vulnerability in NetApp Products | 2020-09-01 |
| [**NTAP-20191213-0001**](https://security.netapp.com/advisory/ntap-20191213-0001/) | Intel SA-00241 CSME-SPS-TXE-AMT Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20191210-0001**](https://security.netapp.com/advisory/ntap-20191210-0001/) | CVE-2019-1551 OpenSSL Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20191210-0002**](https://security.netapp.com/advisory/ntap-20191210-0002/) | December 2019 Samba Vulnerabilities in NetApp Products | 2019-12-10 |
| [**NTAP-20191205-0001**](https://security.netapp.com/advisory/ntap-20191205-0001/) | November 2019 Linux Kernel Vulnerabilities in NetApp Products | 2023-05-19 |
| [**NTAP-20191127-0002**](https://security.netapp.com/advisory/ntap-20191127-0002/) | CVE-2019-17592 Nodejs Vulnerability in NetApp Products | 2020-07-09 |
| [**NTAP-20191127-0001**](https://security.netapp.com/advisory/ntap-20191127-0001/) | November 2019 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2020-06-02 |
| [**NTAP-20191127-0003**](https://security.netapp.com/advisory/ntap-20191127-0003/) | October 2019 PuTTY Vulnerabilities in NetApp Products | 2021-02-11 |
| [**NTAP-20191122-0002**](https://security.netapp.com/advisory/ntap-20191122-0002/) | CVE-2018-21029 Systemd Vulnerability in NetApp Products | 2019-12-20 |
| [**NTAP-20191122-0004**](https://security.netapp.com/advisory/ntap-20191122-0004/) | CVE-2019-16276 Golang Vulnerability in NetApp Products | 2019-11-22 |
| [**NTAP-20191122-0005**](https://security.netapp.com/advisory/ntap-20191122-0005/) | CVE-2019-17596 Golang Vulnerability in NetApp Products | 2019-11-22 |
| [**NTAP-20191122-0001**](https://security.netapp.com/advisory/ntap-20191122-0001/) | CVE-2019-6477 ISC BIND Vulnerability in NetApp Products | 2020-09-01 |
| [**NTAP-20191122-0003**](https://security.netapp.com/advisory/ntap-20191122-0003/) | November 2019 Ruby Vulnerabilities in NetApp Products | 2019-11-22 |
| [**NTAP-20191121-0002**](https://security.netapp.com/advisory/ntap-20191121-0002/) | CVE-2019-17272 Privilege Escalation Vulnerability in ONTAP Select Deploy administration utility | 2019-11-21 |
| [**NTAP-20191121-0001**](https://security.netapp.com/advisory/ntap-20191121-0001/) | CVE-2019-5509 Unauthenticated Remote Code Injection Vulnerability in ONTAP Select Deploy administration utility | 2019-11-21 |
| [**NTAP-20191113-0007**](https://security.netapp.com/advisory/ntap-20191113-0007/) | Intel SA-00164 Intel Processor Vulnerability in NetApp Products | 2020-04-22 |
| [**NTAP-20191113-0003**](https://security.netapp.com/advisory/ntap-20191113-0003/) | Intel SA-00210 Processor Vulnerability in NetApp Products | 2020-06-08 |
| [**NTAP-20191113-0006**](https://security.netapp.com/advisory/ntap-20191113-0006/) | Intel SA-00219 Intel Processor Vulnerability in NetApp Products | 2020-04-22 |
| [**NTAP-20191113-0002**](https://security.netapp.com/advisory/ntap-20191113-0002/) | Intel SA-00240 Processor Vulnerabilities in NetApp Products | 2020-06-08 |
| [**NTAP-20191113-0008**](https://security.netapp.com/advisory/ntap-20191113-0008/) | Intel SA-00254 Intel Processor Vulnerability in NetApp Products | 2020-04-20 |
| [**NTAP-20191113-0001**](https://security.netapp.com/advisory/ntap-20191113-0001/) | Intel SA-00255 Ethernet Controller Vulnerabilities in NetApp Products | 2020-08-07 |
| [**NTAP-20191113-0009**](https://security.netapp.com/advisory/ntap-20191113-0009/) | Intel SA-00270 Intel Processor Vulnerability in NetApp Products | 2021-04-08 |
| [**NTAP-20191113-0005**](https://security.netapp.com/advisory/ntap-20191113-0005/) | Intel SA-00271 Intel Processor Vulnerability in NetApp Products | 2022-10-24 |
| [**NTAP-20191113-0004**](https://security.netapp.com/advisory/ntap-20191113-0004/) | Intel SA-00280 Firmware Vulnerabilities in NetApp Products | 2020-04-21 |
| [**NTAP-20191107-0001**](https://security.netapp.com/advisory/ntap-20191107-0001/) | CVE-2004-1653 OpenSSH Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20191107-0003**](https://security.netapp.com/advisory/ntap-20191107-0003/) | CVE-2007-2243 OpenSSH Vulnerability in NetApp Products | 2022-01-14 |
| [**NTAP-20191107-0002**](https://security.netapp.com/advisory/ntap-20191107-0002/) | CVE-2007-2768 OpenSSH Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20191107-0005**](https://security.netapp.com/advisory/ntap-20191107-0005/) | CVE-2019-17514 Python Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20191107-0004**](https://security.netapp.com/advisory/ntap-20191107-0004/) | CVE-2019-18348 Python Vulnerability in NetApp Products | 2021-05-19 |
| [**NTAP-20191031-0003**](https://security.netapp.com/advisory/ntap-20191031-0003/) | CVE-2019-11043 PHP Vulnerability in NetApp Products | 2019-10-31 |
| [**NTAP-20191031-0006**](https://security.netapp.com/advisory/ntap-20191031-0006/) | CVE-2019-11253 Kubernetes Vulnerability in NetApp Products | 2020-11-17 |
| [**NTAP-20191031-0002**](https://security.netapp.com/advisory/ntap-20191031-0002/) | CVE-2019-14847 Samba Vulnerability in NetApp Products | 2019-10-31 |
| [**NTAP-20191031-0004**](https://security.netapp.com/advisory/ntap-20191031-0004/) | CVE-2019-18197 Libxslt Vulnerability in NetApp Products | 2021-11-29 |
| [**NTAP-20191031-0005**](https://security.netapp.com/advisory/ntap-20191031-0005/) | October 2019 Linux Kernel Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20191031-0001**](https://security.netapp.com/advisory/ntap-20191031-0001/) | October 2019 Samba Vulnerabilities in NetApp Products | 2019-10-31 |
| [**NTAP-20191024-0003**](https://security.netapp.com/advisory/ntap-20191024-0003/) | CVE-2019-16905 OpenSSH Pre-Auth Integer Overflow Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20191024-0006**](https://security.netapp.com/advisory/ntap-20191024-0006/) | CVE-2019-17359 Bouncy Castle Vulnerability in NetApp Products | 2021-01-27 |
| [**NTAP-20191024-0005**](https://security.netapp.com/advisory/ntap-20191024-0005/) | CVE-2019-17531 FasterXML jackson-databind Vulnerability in NetApp Products | 2021-01-28 |
| [**NTAP-20191024-0001**](https://security.netapp.com/advisory/ntap-20191024-0001/) | CVE-2019-5508 L2ping Denial of Service Vulnerability in Clustered Data ONTAP 9.2 and higher | 2019-12-03 |
| [**NTAP-20191024-0002**](https://security.netapp.com/advisory/ntap-20191024-0002/) | October 2019 GNU Binutils Vulnerabilities in NetApp Products | 2024-01-02 |
| [**NTAP-20191024-0004**](https://security.netapp.com/advisory/ntap-20191024-0004/) | October 2019 ISC BIND Vulnerabilities in NetApp Products | 2020-09-01 |
| [**NTAP-20191017-0003**](https://security.netapp.com/advisory/ntap-20191017-0003/) | CVE-2019-14287 Sudo Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20191017-0005**](https://security.netapp.com/advisory/ntap-20191017-0005/) | CVE-2019-15138 Nodejs Vulnerability in NetApp Products | 2020-07-09 |
| [**NTAP-20191017-0004**](https://security.netapp.com/advisory/ntap-20191017-0004/) | CVE-2019-16935 Python Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20191017-0006**](https://security.netapp.com/advisory/ntap-20191017-0006/) | October 2019 FasterXML jackson-databind Vulnerabilities in NetApp Products | 2021-03-24 |
| [**NTAP-20191017-0001**](https://security.netapp.com/advisory/ntap-20191017-0001/) | October 2019 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20191017-0002**](https://security.netapp.com/advisory/ntap-20191017-0002/) | October 2019 MySQL Vulnerabilities in NetApp Products | 2021-01-18 |
| [**NTAP-20191009-0002**](https://security.netapp.com/advisory/ntap-20191009-0002/) | CVE-2019-15635 Grafana Vulnerability in NetApp Products | 2019-10-09 |
| [**NTAP-20191009-0003**](https://security.netapp.com/advisory/ntap-20191009-0003/) | CVE-2019-5506 Hostname Verification Vulnerability in Clustered Data ONTAP 9.0 and higher | 2019-10-10 |
| [**NTAP-20191009-0004**](https://security.netapp.com/advisory/ntap-20191009-0004/) | CVE-2019-5507 Sensitive Information Disclosure Vulnerability in SnapManager for Oracle | 2019-10-09 |
| [**NTAP-20191009-0001**](https://security.netapp.com/advisory/ntap-20191009-0001/) | September 2019 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2019-12-16 |
| [**NTAP-20191004-0005**](https://security.netapp.com/advisory/ntap-20191004-0005/) | CVE-2019-10744 Lodash Vulnerability in NetApp Products | 2021-09-17 |
| [**NTAP-20191004-0004**](https://security.netapp.com/advisory/ntap-20191004-0004/) | CVE-2019-15043 Grafana Vulnerability in NetApp Products | 2020-05-28 |
| [**NTAP-20191004-0003**](https://security.netapp.com/advisory/ntap-20191004-0003/) | September 2019 curl/libcurl Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20191004-0006**](https://security.netapp.com/advisory/ntap-20191004-0006/) | September 2019 Dropbear SSH Vulnerabilities in NetApp Products | 2021-07-02 |
| [**NTAP-20191004-0002**](https://security.netapp.com/advisory/ntap-20191004-0002/) | September 2019 FasterXML jackson-databind Vulnerabilities in NetApp Products | 2021-02-09 |
| [**NTAP-20191004-0001**](https://security.netapp.com/advisory/ntap-20191004-0001/) | September 2019 Linux Kernel Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20190926-0002**](https://security.netapp.com/advisory/ntap-20190926-0002/) | CVE-2019-12401 Apache Solr Vulnerability in NetApp Products | 2019-09-26 |
| [**NTAP-20190926-0004**](https://security.netapp.com/advisory/ntap-20190926-0004/) | CVE-2019-15903 Expat Vulnerability in NetApp Products | 2021-11-01 |
| [**NTAP-20190926-0005**](https://security.netapp.com/advisory/ntap-20190926-0005/) | CVE-2019-16056 Python Vulnerability in NetApp Products | 2020-04-17 |
| [**NTAP-20190926-0003**](https://security.netapp.com/advisory/ntap-20190926-0003/) | CVE-2019-16168 SQLite Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20190926-0001**](https://security.netapp.com/advisory/ntap-20190926-0001/) | Intel SA-00290 Intel Processor Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20190923-0001**](https://security.netapp.com/advisory/ntap-20190923-0001/) | CVE-2019-5504 Unauthenticated Remote Command Execution Vulnerability in ONTAP Select Deploy administration utility | 2019-09-23 |
| [**NTAP-20190923-0002**](https://security.netapp.com/advisory/ntap-20190923-0002/) | CVE-2019-5505 Sensitive Information Disclosure Vulnerability in ONTAP Select Deploy administration utility | 2019-09-23 |
| [**NTAP-20190919-0005**](https://security.netapp.com/advisory/ntap-20190919-0005/) | CVE-2013-4786 IPMI RAKP Vulnerability in NetApp Products | 2023-06-09 |
| [**NTAP-20190919-0001**](https://security.netapp.com/advisory/ntap-20190919-0001/) | CVE-2019-11358 jQuery Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20190919-0003**](https://security.netapp.com/advisory/ntap-20190919-0003/) | September 2019 Kubernetes Vulnerabilities in NetApp Products | 2020-11-17 |
| [**NTAP-20190919-0004**](https://security.netapp.com/advisory/ntap-20190919-0004/) | September 2019 Lodash Vulnerabilities in NetApp Products | 2021-09-17 |
| [**NTAP-20190919-0002**](https://security.netapp.com/advisory/ntap-20190919-0002/) | September 2019 OpenSSL Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20190910-0004**](https://security.netapp.com/advisory/ntap-20190910-0004/) | CVE-2019-10071 Apache Tapestry Vulnerability in NetApp Products | 2020-05-18 |
| [**NTAP-20190910-0003**](https://security.netapp.com/advisory/ntap-20190910-0003/) | CVE-2019-12400 Apache Santuario Vulnerability in NetApp Products | 2020-09-14 |
| [**NTAP-20190910-0001**](https://security.netapp.com/advisory/ntap-20190910-0001/) | CVE-2019-13139 Docker Vulnerability in NetApp Products | 2019-09-10 |
| [**NTAP-20190910-0002**](https://security.netapp.com/advisory/ntap-20190910-0002/) | September 2019 FreeBSD Vulnerabilities in NetApp Products | 2020-01-24 |
| [**NTAP-20190909-0001**](https://security.netapp.com/advisory/ntap-20190909-0001/) | CVE-2019-5503 Missing HTTP Security Headers in OnCommand Workflow Automation | 2019-09-09 |
| [**NTAP-20190905-0002**](https://security.netapp.com/advisory/ntap-20190905-0002/) | August 2019 Linux Kernel Vulnerabilities in NetApp Products | 2024-05-01 |
| [**NTAP-20190905-0001**](https://security.netapp.com/advisory/ntap-20190905-0001/) | CVE-2019-8460 OpenBSD Vulnerability in NetApp Products | 2021-01-15 |
| [**NTAP-20190905-0003**](https://security.netapp.com/advisory/ntap-20190905-0003/) | September 2019 Apache HTTP Server Vulnerabilities in NetApp Products | 2020-12-16 |
| [**NTAP-20190903-0002**](https://security.netapp.com/advisory/ntap-20190903-0002/) | August 2019 IBM Informix Dynamic Server Vulnerabilities in NetApp Products | 2020-01-27 |
| [**NTAP-20190903-0003**](https://security.netapp.com/advisory/ntap-20190903-0003/) | CVE-2015-4620 ISC Bind Vulnerability in NetApp Products | 2019-09-03 |
| [**NTAP-20190903-0001**](https://security.netapp.com/advisory/ntap-20190903-0001/) | CVE-2019-10197 Samba Vulnerability in NetApp Products | 2019-09-03 |
| [**NTAP-20190830-0002**](https://security.netapp.com/advisory/ntap-20190830-0002/) | CVE-2018-5738 ISC BIND Vulnerability in NetApp Products | 2019-08-30 |
| [**NTAP-20190830-0001**](https://security.netapp.com/advisory/ntap-20190830-0001/) | CVE-2018-5741 ISC BIND Vulnerability in NetApp Products | 2019-08-30 |
| [**NTAP-20190830-0003**](https://security.netapp.com/advisory/ntap-20190830-0003/) | July 2017 ISC BIND Vulnerabilities in NetApp Products | 2019-08-30 |
| [**NTAP-20190828-0004**](https://security.netapp.com/advisory/ntap-20190828-0004/) | August 2019 Apache Tika Vulnerabilities in NetApp Products | 2019-08-28 |
| [**NTAP-20190828-0002**](https://security.netapp.com/advisory/ntap-20190828-0002/) | August 2019 Django Vulnerabilities in NetApp Products | 2020-01-09 |
| [**NTAP-20190828-0003**](https://security.netapp.com/advisory/ntap-20190828-0003/) | August 2019 Docker Vulnerabilities in NetApp Products | 2020-05-19 |
| [**NTAP-20190828-0001**](https://security.netapp.com/advisory/ntap-20190828-0001/) | August 2019 GNU patch Vulnerabilities in NetApp Products | 2019-11-19 |
| [**NTAP-20190823-0004**](https://security.netapp.com/advisory/ntap-20190823-0004/) | August 2019 Golang Vulnerabilities in NetApp Products | 2020-05-28 |
| [**NTAP-20190823-0001**](https://security.netapp.com/advisory/ntap-20190823-0001/) | August 2019 Kubernetes Vulnerabilities in NetApp Products | 2020-11-17 |
| [**NTAP-20190823-0002**](https://security.netapp.com/advisory/ntap-20190823-0002/) | August 2019 NGINX Vulnerabilities in NetApp Products | 2024-01-02 |
| [**NTAP-20190823-0005**](https://security.netapp.com/advisory/ntap-20190823-0005/) | August 2019 Node.js Vulnerabilities in NetApp Products | 2021-07-22 |
| [**NTAP-20190823-0006**](https://security.netapp.com/advisory/ntap-20190823-0006/) | CVE-2019-1552 OpenSSL Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20190823-0003**](https://security.netapp.com/advisory/ntap-20190823-0003/) | CVE-2019-9517 Apache HTTP Server Vulnerability in NetApp Products | 2019-09-09 |
| [**NTAP-20190822-0002**](https://security.netapp.com/advisory/ntap-20190822-0002/) | August 2019 GNU Binutils Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20190822-0003**](https://security.netapp.com/advisory/ntap-20190822-0003/) | August 2019 PHP Vulnerabilities in NetApp Products | 2019-08-22 |
| [**NTAP-20190822-0001**](https://security.netapp.com/advisory/ntap-20190822-0001/) | CVE-2019-1010204 GNU Binutils Vulnerability in NetApp Products | 2020-08-18 |
| [**NTAP-20190822-0004**](https://security.netapp.com/advisory/ntap-20190822-0004/) | CVE-2019-13057 OpenLDAP Vulnerability in NetApp Products | 2019-09-09 |
| [**NTAP-20190814-0001**](https://security.netapp.com/advisory/ntap-20190814-0001/) | August 2019 FasterXML jackson-databind Vulnerabilities in NetApp Products | 2020-12-18 |
| [**NTAP-20190814-0003**](https://security.netapp.com/advisory/ntap-20190814-0003/) | August 2019 FreeBSD Vulnerabilities in NetApp Products | 2019-08-14 |
| [**NTAP-20190814-0002**](https://security.netapp.com/advisory/ntap-20190814-0002/) | CVE-2019-13232 Info-ZIP UnZip Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20190814-0004**](https://security.netapp.com/advisory/ntap-20190814-0004/) | February 2019 ISC BIND Vulnerabilities in NetApp Products | 2019-08-14 |
| [**NTAP-20190809-0002**](https://security.netapp.com/advisory/ntap-20190809-0002/) | CVE-2019-1125 SWAPGS Speculative Execution Side Channel Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20190809-0001**](https://security.netapp.com/advisory/ntap-20190809-0001/) | CVE-2019-5498 Sensitive Information Disclosure Vulnerability in OnCommand Insight | 2019-08-09 |
| [**NTAP-20190806-0003**](https://security.netapp.com/advisory/ntap-20190806-0003/) | CVE-2019-13012 GNOME GLib Vulnerability in NetApp Products | 2019-08-06 |
| [**NTAP-20190806-0002**](https://security.netapp.com/advisory/ntap-20190806-0002/) | CVE-2019-13115 Libssh2 Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20190806-0004**](https://security.netapp.com/advisory/ntap-20190806-0004/) | July 2019 Libxslt Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20190806-0001**](https://security.netapp.com/advisory/ntap-20190806-0001/) | July 2019 Linux Kernel Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20190802-0001**](https://security.netapp.com/advisory/ntap-20190802-0001/) | August 2019 VxWorks TCP/IP Stack (IPNET) Vulnerabilities in NetApp Products | 2019-10-22 |
| [**NTAP-20190802-0003**](https://security.netapp.com/advisory/ntap-20190802-0003/) | CVE-2019-5500 Denial of Service (DoS) Vulnerability in the NetApp Service Processor and Baseboard Management Controller | 2019-11-05 |
| [**NTAP-20190802-0002**](https://security.netapp.com/advisory/ntap-20190802-0002/) | CVE-2019-5502 Insecure SMB Cryptography Vulnerability in Data ONTAP operating in 7-Mode | 2019-08-02 |
| [**NTAP-20190801-0002**](https://security.netapp.com/advisory/ntap-20190801-0002/) | CVE-2019-5493 Information Disclosure Vulnerability in Data ONTAP operating in 7-Mode | 2019-08-01 |
| [**NTAP-20190801-0001**](https://security.netapp.com/advisory/ntap-20190801-0001/) | CVE-2019-5501 Sensitive Information Disclosure Vulnerability in Data ONTAP operating in 7-Mode | 2019-08-01 |
| [**NTAP-20190731-0001**](https://security.netapp.com/advisory/ntap-20190731-0001/) | Intel SA-00063 Ethernet Controller Vulnerability in NetApp Products | 2021-01-05 |
| [**NTAP-20190730-0002**](https://security.netapp.com/advisory/ntap-20190730-0002/) | December 2014 ISC BIND Vulnerabilities in NetApp Products | 2019-07-30 |
| [**NTAP-20190730-0001**](https://security.netapp.com/advisory/ntap-20190730-0001/) | September 2015 ISC BIND Vulnerabilities in NetApp Products | 2019-07-30 |
| [**NTAP-20190719-0001**](https://security.netapp.com/advisory/ntap-20190719-0001/) | April 2018 Libxml2 Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20190719-0002**](https://security.netapp.com/advisory/ntap-20190719-0002/) | CVE-2018-14404 Libxml2 Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20190719-0005**](https://security.netapp.com/advisory/ntap-20190719-0005/) | July 2019 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20190719-0004**](https://security.netapp.com/advisory/ntap-20190719-0004/) | July 2019 MySQL Vulnerabilities in NetApp Products | 2021-01-19 |
| [**NTAP-20190719-0003**](https://security.netapp.com/advisory/ntap-20190719-0003/) | May 2019 Linux Kernel Vulnerabilities in NetApp Products | 2020-06-12 |
| [**NTAP-20190715-0001**](https://security.netapp.com/advisory/ntap-20190715-0001/) | CVE-2018-20801 Highcharts Vulnerability in NetApp Products | 2020-12-11 |
| [**NTAP-20190710-0001**](https://security.netapp.com/advisory/ntap-20190710-0001/) | CVE-2019-13068 Grafana Vulnerability in NetApp Products | 2020-05-28 |
| [**NTAP-20190710-0002**](https://security.netapp.com/advisory/ntap-20190710-0002/) | June 2019 Linux Kernel Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20190705-0002**](https://security.netapp.com/advisory/ntap-20190705-0002/) | CVE-2019-12781 Django Vulnerability in NetApp Products | 2019-07-16 |
| [**NTAP-20190705-0001**](https://security.netapp.com/advisory/ntap-20190705-0001/) | July 2019 Libvirt Vulnerabilities in NetApp Products | 2019-07-05 |
| [**NTAP-20190703-0001**](https://security.netapp.com/advisory/ntap-20190703-0001/) | CVE-2018-20843 Expat Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20190703-0002**](https://security.netapp.com/advisory/ntap-20190703-0002/) | CVE-2019-12384 FasterXML jackson-databind Vulnerability in NetApp Products | 2021-11-02 |
| [**NTAP-20190627-0001**](https://security.netapp.com/advisory/ntap-20190627-0001/) | CVE-2019-5497 Default Privileged Account Vulnerability in the NetApp AFF A700s Baseboard Management Controller | 2019-08-14 |
| [**NTAP-20190625-0007**](https://security.netapp.com/advisory/ntap-20190625-0007/) | CVE-2019-0220 Apache HTTP Server Vulnerability in NetApp Products | 2021-05-19 |
| [**NTAP-20190625-0002**](https://security.netapp.com/advisory/ntap-20190625-0002/) | CVE-2019-10072 Apache Tomcat Vulnerability in NetApp Products | 2020-04-23 |
| [**NTAP-20190625-0006**](https://security.netapp.com/advisory/ntap-20190625-0006/) | CVE-2019-12814 FasterXML jackson-databind Vulnerability in NetApp Products | 2021-07-13 |
| [**NTAP-20190625-0005**](https://security.netapp.com/advisory/ntap-20190625-0005/) | CVE-2019-12875 Alpine Linux Vulnerability in NetApp Products | 2019-07-10 |
| [**NTAP-20190625-0004**](https://security.netapp.com/advisory/ntap-20190625-0004/) | CVE-2019-5599 FreeBSD TCP SACK Vulnerability in NetApp Products | 2019-06-25 |
| [**NTAP-20190625-0003**](https://security.netapp.com/advisory/ntap-20190625-0003/) | CVE-2019-6471 ISC Bind Vulnerability in NetApp Products | 2019-07-15 |
| [**NTAP-20190625-0001**](https://security.netapp.com/advisory/ntap-20190625-0001/) | Linux Kernel TCP SACK Panic Vulnerabilities in NetApp Products | 2022-01-14 |
| [**NTAP-20190619-0003**](https://security.netapp.com/advisory/ntap-20190619-0003/) | CVE-2018-11802 Apache Solr Vulnerability in NetApp Products | 2019-06-19 |
| [**NTAP-20190619-0001**](https://security.netapp.com/advisory/ntap-20190619-0001/) | CVE-2019-0201 Apache ZooKeeper Vulnerability in NetApp Products | 2021-05-12 |
| [**NTAP-20190619-0004**](https://security.netapp.com/advisory/ntap-20190619-0004/) | CVE-2019-3829 GnuTLS Vulnerability in NetApp Products | 2020-09-14 |
| [**NTAP-20190619-0005**](https://security.netapp.com/advisory/ntap-20190619-0005/) | CVE-2019-9740 Python Vulnerability in NetApp Products | 2020-03-27 |
| [**NTAP-20190619-0006**](https://security.netapp.com/advisory/ntap-20190619-0006/) | June 2019 Samba Vulnerabilities in NetApp Products | 2019-06-19 |
| [**NTAP-20190619-0002**](https://security.netapp.com/advisory/ntap-20190619-0002/) | May 2019 Systemd Vulnerabilities in NetApp Products | 2020-08-18 |
| [**NTAP-20190617-0001**](https://security.netapp.com/advisory/ntap-20190617-0001/) | CVE-2018-8029 Apache Hadoop Vulnerability in NetApp Products | 2019-06-17 |
| [**NTAP-20190617-0003**](https://security.netapp.com/advisory/ntap-20190617-0003/) | CVE-2019-10160 Python Vulnerability in NetApp Products | 2022-12-19 |
| [**NTAP-20190617-0004**](https://security.netapp.com/advisory/ntap-20190617-0004/) | CVE-2019-4139 IBM Cognos Analytics Vulnerability in NetApp Products | 2019-08-09 |
| [**NTAP-20190617-0002**](https://security.netapp.com/advisory/ntap-20190617-0002/) | June 2019 Apache HTTP Server Vulnerabilities in NetApp Products | 2021-05-19 |
| [**NTAP-20190612-0001**](https://security.netapp.com/advisory/ntap-20190612-0001/) | Intel SA-00247 Processor Vulnerability in NetApp Products | 2020-05-07 |
| [**NTAP-20190611-0002**](https://security.netapp.com/advisory/ntap-20190611-0002/) | CVE-2018-10934 JBoss Enterprise Application Platform Vulnerability in NetApp Products | 2021-01-19 |
| [**NTAP-20190611-0003**](https://security.netapp.com/advisory/ntap-20190611-0003/) | CVE-2019-9628 XMLTooling Library Vulnerability in NetApp Products | 2019-06-11 |
| [**NTAP-20190611-0001**](https://security.netapp.com/advisory/ntap-20190611-0001/) | May 2019 FreeBSD Vulnerabilities in NetApp Products | 2019-06-11 |
| [**NTAP-20190606-0001**](https://security.netapp.com/advisory/ntap-20190606-0001/) | CVE-2019-0221 Apache Tomcat Vulnerability in NetApp Products | 2021-01-04 |
| [**NTAP-20190606-0003**](https://security.netapp.com/advisory/ntap-20190606-0003/) | CVE-2019-12450 GNOME GLib Vulnerability in NetApp Products | 2019-07-03 |
| [**NTAP-20190606-0002**](https://security.netapp.com/advisory/ntap-20190606-0002/) | CVE-2019-8457 SQLite Vulnerability in NetApp Products | 2020-10-07 |
| [**NTAP-20190606-0004**](https://security.netapp.com/advisory/ntap-20190606-0004/) | May 2019 curl/libcurl Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20190530-0001**](https://security.netapp.com/advisory/ntap-20190530-0001/) | CVE-2018-1000632 Dom4j Vulnerability in NetApp Products | 2021-08-16 |
| [**NTAP-20190530-0002**](https://security.netapp.com/advisory/ntap-20190530-0002/) | CVE-2018-20839 Systemd Vulnerability in NetApp Products | 2020-05-22 |
| [**NTAP-20190530-0003**](https://security.netapp.com/advisory/ntap-20190530-0003/) | May 2019 FasterXML jackson-databind Vulnerabilities in NetApp Products | 2021-01-18 |
| [**NTAP-20190521-0001**](https://security.netapp.com/advisory/ntap-20190521-0001/) | CVE-2019-5018 SQLite Vulnerability in NetApp Products | 2019-08-07 |
| [**NTAP-20190517-0003**](https://security.netapp.com/advisory/ntap-20190517-0003/) | CVE-2019-11036 PHP Vulnerability in NetApp Products | 2019-10-30 |
| [**NTAP-20190517-0001**](https://security.netapp.com/advisory/ntap-20190517-0001/) | CVE-2019-9636 Python Vulnerability in NetApp Products | 2020-03-27 |
| [**NTAP-20190517-0005**](https://security.netapp.com/advisory/ntap-20190517-0005/) | May 2019 Linux Kernel Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20190517-0004**](https://security.netapp.com/advisory/ntap-20190517-0004/) | May 2019 Wildfly Vulnerabilities in NetApp Products | 2019-06-12 |
| [**NTAP-20190517-0002**](https://security.netapp.com/advisory/ntap-20190517-0002/) | May 7th 2019 Linux Kernel Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20190516-0001**](https://security.netapp.com/advisory/ntap-20190516-0001/) | Intel SA-00223 UEFI Vulnerabilities in NetApp Products | 2019-05-21 |
| [**NTAP-20190515-0002**](https://security.netapp.com/advisory/ntap-20190515-0002/) | Intel SA-00213 Platform Firmware Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20190515-0001**](https://security.netapp.com/advisory/ntap-20190515-0001/) | Intel SA-00233 Processor Vulnerabilities in NetApp Products | 2022-01-14 |
| [**NTAP-20190514-0002**](https://security.netapp.com/advisory/ntap-20190514-0002/) | April 2019 ISC BIND Vulnerabilities in NetApp Products | 2019-05-14 |
| [**NTAP-20190514-0001**](https://security.netapp.com/advisory/ntap-20190514-0001/) | CVE-2018-16860 Samba Vulnerability in NetApp Products | 2019-05-14 |
| [**NTAP-20190510-0001**](https://security.netapp.com/advisory/ntap-20190510-0001/) | CVE-2019-5021 Alpine Linux Docker Image Vulnerability in NetApp Products | 2019-05-10 |
| [**NTAP-20190509-0003**](https://security.netapp.com/advisory/ntap-20190509-0003/) | April 2019 Eclipse Jetty Vulnerabilities in NetApp Products | 2021-06-08 |
| [**NTAP-20190509-0004**](https://security.netapp.com/advisory/ntap-20190509-0004/) | CVE-2019-4178 IBM Cognos Analytics Vulnerability in NetApp Products | 2019-08-09 |
| [**NTAP-20190509-0001**](https://security.netapp.com/advisory/ntap-20190509-0001/) | CVE-2019-5953 GNU Wget Vulnerability in NetApp Products | 2024-03-07 |
| [**NTAP-20190509-0002**](https://security.netapp.com/advisory/ntap-20190509-0002/) | May 2019 Kubernetes Vulnerabilities in NetApp Products | 2020-11-17 |
| [**NTAP-20190509-0005**](https://security.netapp.com/advisory/ntap-20190509-0005/) | Missing HTTP Security Headers in OnCommand Insight | 2019-05-09 |
| [**NTAP-20190509-0006**](https://security.netapp.com/advisory/ntap-20190509-0006/) | Missing HTTP Security Headers in OnCommand Unified Manager 7-Mode | 2019-05-09 |
| [**NTAP-20190509-0007**](https://security.netapp.com/advisory/ntap-20190509-0007/) | Missing HTTP Security Headers in OnCommand Unified Manager for VMware vSphere, Linux and Windows 7.3 and above | 2019-05-09 |
| [**NTAP-20190503-0001**](https://security.netapp.com/advisory/ntap-20190503-0001/) | CVE-2019-8936 Network Time Protocol Daemon (ntpd) Vulnerability in NetApp Products | 2019-05-03 |
| [**NTAP-20190502-0008**](https://security.netapp.com/advisory/ntap-20190502-0008/) | April 2019 Node.js Vulnerabilities in NetApp Products | 2019-05-02 |
| [**NTAP-20190502-0001**](https://security.netapp.com/advisory/ntap-20190502-0001/) | April 2019 PHP Vulnerabilities in NetApp Products | 2019-05-02 |
| [**NTAP-20190502-0004**](https://security.netapp.com/advisory/ntap-20190502-0004/) | April 2019 SQLite Vulnerabilities in NetApp Products | 2019-08-07 |
| [**NTAP-20190502-0009**](https://security.netapp.com/advisory/ntap-20190502-0009/) | CVE-2018-16984 Django Vulnerability in NetApp Products | 2020-09-01 |
| [**NTAP-20190502-0002**](https://security.netapp.com/advisory/ntap-20190502-0002/) | CVE-2018-20449 Linux Kernel Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20190502-0006**](https://security.netapp.com/advisory/ntap-20190502-0006/) | CVE-2019-0222 Apache ActiveMQ Vulnerability in NetApp Products | 2019-10-16 |
| [**NTAP-20190502-0005**](https://security.netapp.com/advisory/ntap-20190502-0005/) | CVE-2019-3836 GnuTLS Vulnerability in NetApp Products | 2019-05-02 |
| [**NTAP-20190502-0003**](https://security.netapp.com/advisory/ntap-20190502-0003/) | CVE-2019-9193 PostgreSQL in NetApp Products | 2019-05-06 |
| [**NTAP-20190502-0007**](https://security.netapp.com/advisory/ntap-20190502-0007/) | March 2019 PHP Vulnerabilities in NetApp Products | 2019-05-02 |
| [**NTAP-20190426-0001**](https://security.netapp.com/advisory/ntap-20190426-0001/) | CVE-2019-5492 Sensitive Information Disclosure Vulnerability in Element Plug-in for vCenter Server | 2019-04-26 |
| [**NTAP-20190423-0001**](https://security.netapp.com/advisory/ntap-20190423-0001/) | April 2019 Apache HTTP Server Vulnerabilities in NetApp Products | 2020-06-18 |
| [**NTAP-20190423-0003**](https://security.netapp.com/advisory/ntap-20190423-0003/) | April 2019 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2021-01-05 |
| [**NTAP-20190423-0002**](https://security.netapp.com/advisory/ntap-20190423-0002/) | April 2019 MySQL Vulnerabilities in NetApp Products | 2021-01-18 |
| [**NTAP-20190419-0001**](https://security.netapp.com/advisory/ntap-20190419-0001/) | April 2019 Apache Tomcat Vulnerabilities in NetApp Products | 2019-04-26 |
| [**NTAP-20190416-0002**](https://security.netapp.com/advisory/ntap-20190416-0002/) | April 2019 Kubernetes Vulnerabilities in NetApp Products | 2020-11-17 |
| [**NTAP-20190416-0008**](https://security.netapp.com/advisory/ntap-20190416-0008/) | CVE-2018-1002101 Kubernetes Vulnerability in NetApp Products | 2020-11-17 |
| [**NTAP-20190416-0001**](https://security.netapp.com/advisory/ntap-20190416-0001/) | CVE-2018-1002105 Kubernetes Privilege Escalation Vulnerability in NetApp Products | 2020-11-17 |
| [**NTAP-20190416-0009**](https://security.netapp.com/advisory/ntap-20190416-0009/) | CVE-2018-11767 Apache Hadoop Vulnerability in NetApp Products | 2019-04-16 |
| [**NTAP-20190416-0003**](https://security.netapp.com/advisory/ntap-20190416-0003/) | CVE-2018-18955 Linux Kernel Vulnerability in NetApp Products | 2019-07-31 |
| [**NTAP-20190416-0006**](https://security.netapp.com/advisory/ntap-20190416-0006/) | CVE-2018-20217 MIT Kerberos 5 Vulnerability in NetApp Products | 2019-04-16 |
| [**NTAP-20190416-0010**](https://security.netapp.com/advisory/ntap-20190416-0010/) | CVE-2018-20406 Python Vulnerability in NetApp Products | 2019-04-16 |
| [**NTAP-20190416-0004**](https://security.netapp.com/advisory/ntap-20190416-0004/) | December 2018 Grafana Vulnerabilities in NetApp Products | 2020-03-27 |
| [**NTAP-20190416-0005**](https://security.netapp.com/advisory/ntap-20190416-0005/) | March 2019 SQLite Vulnerabilities in NetApp Products | 2019-04-16 |
| [**NTAP-20190416-0007**](https://security.netapp.com/advisory/ntap-20190416-0007/) | September 2018 jQuery Vulnerabilities in NetApp Products | 2024-01-02 |
| [**NTAP-20190411-0003**](https://security.netapp.com/advisory/ntap-20190411-0003/) | April 2019 Linux Kernel Vulnerabilities in NetApp Products | 2020-05-22 |
| [**NTAP-20190411-0004**](https://security.netapp.com/advisory/ntap-20190411-0004/) | CVE-2019-3880 Samba Vulnerability in NetApp Products | 2019-04-11 |
| [**NTAP-20190411-0002**](https://security.netapp.com/advisory/ntap-20190411-0002/) | CVE-2019-7612 Logstash Vulnerability in NetApp Products | 2020-03-27 |
| [**NTAP-20190411-0001**](https://security.netapp.com/advisory/ntap-20190411-0001/) | CVE-2019-9924 GNU Bash Vulnerability in NetApp Products | 2020-05-22 |
| [**NTAP-20190411-0005**](https://security.netapp.com/advisory/ntap-20190411-0005/) | January 2019 Brocade Network Advisor Vulnerabilities in NetApp Products | 2019-04-11 |
| [**NTAP-20190411-0006**](https://security.netapp.com/advisory/ntap-20190411-0006/) | March 2019 QEMU Vulnerabilities in NetApp Products | 2019-04-11 |
| [**NTAP-20190408-0001**](https://security.netapp.com/advisory/ntap-20190408-0001/) | CVE-2019-3870 Samba Vulnerability in NetApp Products | 2019-04-08 |
| [**NTAP-20190404-0003**](https://security.netapp.com/advisory/ntap-20190404-0003/) | February 2018 GNU C Library Vulnerabilities in NetApp Products | 2022-07-01 |
| [**NTAP-20190404-0001**](https://security.netapp.com/advisory/ntap-20190404-0001/) | March 2019 PuTTY Vulnerabilities in NetApp Products | 2019-05-21 |
| [**NTAP-20190404-0004**](https://security.netapp.com/advisory/ntap-20190404-0004/) | March 2019 Python Vulnerabilities in NetApp Products | 2020-03-27 |
| [**NTAP-20190404-0002**](https://security.netapp.com/advisory/ntap-20190404-0002/) | March 27th 2019 Linux Kernel Vulnerabilities in NetApp Products | 2020-05-22 |
| [**NTAP-20190401-0002**](https://security.netapp.com/advisory/ntap-20190401-0002/) | CVE-2019-9898 PuTTY Vulnerability in NetApp Products | 2020-04-13 |
| [**NTAP-20190401-0003**](https://security.netapp.com/advisory/ntap-20190401-0003/) | December 2018 IBM Cognos Analytics Vulnerabilities in NetApp Products | 2019-04-01 |
| [**NTAP-20190401-0001**](https://security.netapp.com/advisory/ntap-20190401-0001/) | May 2018 GNU C Library Vulnerabilities in NetApp Products | 2022-07-01 |
| [**NTAP-20190327-0003**](https://security.netapp.com/advisory/ntap-20190327-0003/) | CVE-2017-3164 Apache Solr Vulnerability in NetApp Products | 2019-03-27 |
| [**NTAP-20190327-0004**](https://security.netapp.com/advisory/ntap-20190327-0004/) | CVE-2019-6454 systemd Vulnerability in NetApp Products | 2020-03-27 |
| [**NTAP-20190327-0001**](https://security.netapp.com/advisory/ntap-20190327-0001/) | Intel SA-00112 Active Management Technology Vulnerabilities in NetApp Products | 2019-03-27 |
| [**NTAP-20190327-0006**](https://security.netapp.com/advisory/ntap-20190327-0006/) | Intel SA-00118 Converged Security Management Engine Vulnerability in NetApp Products | 2019-03-27 |
| [**NTAP-20190327-0005**](https://security.netapp.com/advisory/ntap-20190327-0005/) | March 2019 Libssh2 Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20190327-0002**](https://security.netapp.com/advisory/ntap-20190327-0002/) | March 2019 Linux Kernel Vulnerabilities in NetApp Products | 2020-10-07 |
| [**NTAP-20190327-0007**](https://security.netapp.com/advisory/ntap-20190327-0007/) | October 2018 GNU Binutils Vulnerabilities in NetApp Products | 2019-10-01 |
| [**NTAP-20190321-0003**](https://security.netapp.com/advisory/ntap-20190321-0003/) | CVE-2018-19591 GNU C Library (glibc) Vulnerability in NetApp Products | 2022-07-01 |
| [**NTAP-20190321-0002**](https://security.netapp.com/advisory/ntap-20190321-0002/) | CVE-2018-20483 GNU Wget Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20190321-0001**](https://security.netapp.com/advisory/ntap-20190321-0001/) | February 2019 PHP Vulnerabilities in NetApp Products | 2019-03-21 |
| [**NTAP-20190318-0001**](https://security.netapp.com/advisory/ntap-20190318-0001/) | Intel SA-00185 CSME-SPS-TXE-AMT Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20190318-0002**](https://security.netapp.com/advisory/ntap-20190318-0002/) | Intel SA-00191 Firmware Vulnerabilities in NetApp Products | 2020-09-24 |
| [**NTAP-20190315-0003**](https://security.netapp.com/advisory/ntap-20190315-0003/) | CVE-2019-6977 PHP Vulnerability in NetApp Products | 2019-03-15 |
| [**NTAP-20190315-0001**](https://security.netapp.com/advisory/ntap-20190315-0001/) | February 2019 curl/libcurl Vulnerabilities in NetApp Products | 2019-07-16 |
| [**NTAP-20190315-0002**](https://security.netapp.com/advisory/ntap-20190315-0002/) | March 2019 GNU C Vulnerabilities in NetApp Products | 2024-04-25 |
| [**NTAP-20190314-0002**](https://security.netapp.com/advisory/ntap-20190314-0002/) | CVE-2019-1543 OpenSSL Vulnerability in NetApp Products | 2021-04-09 |
| [**NTAP-20190314-0001**](https://security.netapp.com/advisory/ntap-20190314-0001/) | CVE-2019-6260 ASPEED BMC Vulnerability in NetApp Products | 2021-11-01 |
| [**NTAP-20190314-0003**](https://security.netapp.com/advisory/ntap-20190314-0003/) | February 2019 GNU Binutils Vulnerabilities in NetApp Products | 2022-05-27 |
| [**NTAP-20190307-0004**](https://security.netapp.com/advisory/ntap-20190307-0004/) | CVE-2011-4461 Eclipse Jetty Vulnerability in NetApp Products | 2021-01-04 |
| [**NTAP-20190307-0005**](https://security.netapp.com/advisory/ntap-20190307-0005/) | CVE-2015-2080 Eclipse Jetty Vulnerability in NetApp Products | 2021-01-04 |
| [**NTAP-20190307-0006**](https://security.netapp.com/advisory/ntap-20190307-0006/) | CVE-2016-4800 Eclipse Jetty Vulnerability in NetApp Products | 2021-01-04 |
| [**NTAP-20190307-0007**](https://security.netapp.com/advisory/ntap-20190307-0007/) | CVE-2018-16888 Systemd Vulnerability in NetApp Products | 2020-08-18 |
| [**NTAP-20190307-0002**](https://security.netapp.com/advisory/ntap-20190307-0002/) | CVE-2018-8026 Apache Solr Vulnerability in NetApp Products | 2019-03-08 |
| [**NTAP-20190307-0001**](https://security.netapp.com/advisory/ntap-20190307-0001/) | CVE-2019-5489 Linux Kernel Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20190307-0008**](https://security.netapp.com/advisory/ntap-20190307-0008/) | CVE-2019-5736 Opencontainers-runc Vulnerability in NetApp Products | 2020-10-07 |
| [**NTAP-20190307-0003**](https://security.netapp.com/advisory/ntap-20190307-0003/) | November 2018 GNU Binutils Vulnerabilities in NetApp Products | 2019-09-20 |
| [**NTAP-20190305-0001**](https://security.netapp.com/advisory/ntap-20190305-0001/) | CVE-2019-5490 Default Privileged Account Vulnerability in the NetApp Service Processor | 2019-04-11 |
| [**NTAP-20190304-0002**](https://security.netapp.com/advisory/ntap-20190304-0002/) | CVE-2017-15515 Cross-Site Scripting Vulnerability in SnapCenter Server | 2019-03-04 |
| [**NTAP-20190304-0001**](https://security.netapp.com/advisory/ntap-20190304-0001/) | CVE-2018-5482 Secure Cookie Attribute Vulnerability in SnapCenter Server | 2019-03-04 |
| [**NTAP-20190301-0001**](https://security.netapp.com/advisory/ntap-20190301-0001/) | CVE-2019-1559 OpenSSL Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20190227-0001**](https://security.netapp.com/advisory/ntap-20190227-0001/) | CVE-2019-5491 SMB Information Disclosure Vulnerability in Clustered Data ONTAP 9.0 and higher | 2019-02-27 |
| [**NTAP-20190226-0001**](https://security.netapp.com/advisory/ntap-20190226-0001/) | CVE-2019-3824 Samba Vulnerability in NetApp Products | 2019-02-26 |
| [**NTAP-20190221-0001**](https://security.netapp.com/advisory/ntap-20190221-0001/) | CVE-2018-1000656 Flask Vulnerability in NetApp Products | 2020-03-27 |
| [**NTAP-20190221-0004**](https://security.netapp.com/advisory/ntap-20190221-0004/) | December 2018 GNU Binutils Vulnerabilities in NetApp Products | 2022-08-26 |
| [**NTAP-20190221-0003**](https://security.netapp.com/advisory/ntap-20190221-0003/) | December 2018 PERL Vulnerabilities in NetApp Products | 2021-04-26 |
| [**NTAP-20190221-0002**](https://security.netapp.com/advisory/ntap-20190221-0002/) | November 2018 Ruby Vulnerabilities in NetApp Products | 2019-02-28 |
| [**NTAP-20190215-0001**](https://security.netapp.com/advisory/ntap-20190215-0001/) | CVE-2018-20685 OpenSSH Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20190213-0001**](https://security.netapp.com/advisory/ntap-20190213-0001/) | January 2019 OpenSSH Vulnerabilities in NetApp Products | 2024-06-14 |
| [**NTAP-20190212-0001**](https://security.netapp.com/advisory/ntap-20190212-0001/) | November 2017 Apache Commons FileUpload Vulnerabilities in NetApp Products | 2019-08-20 |
| [**NTAP-20190206-0001**](https://security.netapp.com/advisory/ntap-20190206-0001/) | CVE-2016-6210 OpenSSH Vulnerability in NetApp Products | 2020-11-19 |
| [**NTAP-20190204-0004**](https://security.netapp.com/advisory/ntap-20190204-0004/) | CVE-2018-11763 Apache HTTP Server Vulnerability in NetApp Products | 2019-10-11 |
| [**NTAP-20190204-0002**](https://security.netapp.com/advisory/ntap-20190204-0002/) | CVE-2018-14634 Linux Kernel Integer Overflow Vulnerability in NetApp Products | 2020-05-15 |
| [**NTAP-20190204-0003**](https://security.netapp.com/advisory/ntap-20190204-0003/) | September 2018 Bouncy Castle Vulnerabilities in NetApp Products | 2020-11-24 |
| [**NTAP-20190204-0001**](https://security.netapp.com/advisory/ntap-20190204-0001/) | September 2018 Linux Kernel Vulnerabilities in NetApp Products | 2020-05-22 |
| [**NTAP-20190125-0003**](https://security.netapp.com/advisory/ntap-20190125-0003/) | CVE-2018-5499 Denial of Service Vulnerability in ATTO FibreBridge 7500N | 2019-02-12 |
| [**NTAP-20190125-0002**](https://security.netapp.com/advisory/ntap-20190125-0002/) | CVE-2019-3462 APT Vulnerability in NetApp Products | 2020-03-27 |
| [**NTAP-20190125-0001**](https://security.netapp.com/advisory/ntap-20190125-0001/) | January 2019 Apache HTTP Server Vulnerabilities in NetApp Products | 2019-07-30 |
| [**NTAP-20190118-0001**](https://security.netapp.com/advisory/ntap-20190118-0001/) | January 2019 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2021-01-05 |
| [**NTAP-20190118-0002**](https://security.netapp.com/advisory/ntap-20190118-0002/) | January 2019 MySQL Vulnerabilities in NetApp Products | 2021-01-28 |
| [**NTAP-20190117-0001**](https://security.netapp.com/advisory/ntap-20190117-0001/) | January 2019 Systemd-journald Vulnerabilities in NetApp Products | 2020-05-22 |
| [**NTAP-20190115-0001**](https://security.netapp.com/advisory/ntap-20190115-0001/) | CVE-2018-5498 Denial of Service Vulnerability in Clustered Data ONTAP 9.0 and higher | 2019-01-15 |
| [**NTAP-20190109-0001**](https://security.netapp.com/advisory/ntap-20190109-0001/) | CVE-2018-5497 Sensitive Information Disclosure Vulnerability in Clustered Data ONTAP 9.x | 2019-01-09 |
| [**NTAP-20190104-0001**](https://security.netapp.com/advisory/ntap-20190104-0001/) | CVE-2018-5481 Secure Cookie Attribute Vulnerability in OnCommand Unified Manager for 7-Mode (core package) | 2019-01-04 |
| [**NTAP-20181221-0006**](https://security.netapp.com/advisory/ntap-20181221-0006/) | CVE-2007-6750 Apache HTTP Server Vulnerability in NetApp Products | 2018-12-21 |
| [**NTAP-20181221-0002**](https://security.netapp.com/advisory/ntap-20181221-0002/) | CVE-2018-14627 Wildfly Vulnerability in NetApp Products | 2018-12-21 |
| [**NTAP-20181221-0001**](https://security.netapp.com/advisory/ntap-20181221-0001/) | CVE-2018-15919 OpenSSH Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20181221-0004**](https://security.netapp.com/advisory/ntap-20181221-0004/) | CVE-2018-19518 PHP Vulnerability in NetApp Products | 2018-12-21 |
| [**NTAP-20181221-0003**](https://security.netapp.com/advisory/ntap-20181221-0003/) | CVE-2018-19935 PHP Vulnerability in NetApp Products | 2019-10-11 |
| [**NTAP-20181221-0005**](https://security.netapp.com/advisory/ntap-20181221-0005/) | November 2018 PHP Vulnerabilities in NetApp Products | 2019-01-23 |
| [**NTAP-20181204-0001**](https://security.netapp.com/advisory/ntap-20181204-0001/) | CVE-2018-5496 Sensitive Information Disclosure Vulnerability in Data ONTAP operating in 7-Mode | 2018-12-04 |
| [**NTAP-20181127-0002**](https://security.netapp.com/advisory/ntap-20181127-0002/) | CVE-2016-7076 sudo Vulnerability in NetApp Products | 2018-11-29 |
| [**NTAP-20181127-0003**](https://security.netapp.com/advisory/ntap-20181127-0003/) | CVE-2017-7660 Apache Solr Vulnerability in NetApp Products | 2018-11-27 |
| [**NTAP-20181127-0004**](https://security.netapp.com/advisory/ntap-20181127-0004/) | June 2018 Bouncy Castle Vulnerabilities in NetApp Products | 2020-12-08 |
| [**NTAP-20181127-0001**](https://security.netapp.com/advisory/ntap-20181127-0001/) | November 2018 Samba Vulnerabilities in NetApp StorageGRID Products | 2018-11-27 |
| [**NTAP-20181126-0001**](https://security.netapp.com/advisory/ntap-20181126-0001/) | CVE-2018-5407 Simultaneous Multithreading Side-Channel Information Disclosure Vulnerability in NetApp Products | 2019-04-11 |
| [**NTAP-20181123-0001**](https://security.netapp.com/advisory/ntap-20181123-0001/) | CVE-2017-16642 PHP Vulnerability in NetApp Products | 2019-03-14 |
| [**NTAP-20181114-0001**](https://security.netapp.com/advisory/ntap-20181114-0001/) | CVE-2018-5495 Remote Code Execution Vulnerability in StorageGRID Webscale | 2018-11-14 |
| [**NTAP-20181112-0001**](https://security.netapp.com/advisory/ntap-20181112-0001/) | Self-Encrypting Solid State Drive Vulnerabilities in NetApp Products | 2020-11-18 |
| [**NTAP-20181109-0001**](https://security.netapp.com/advisory/ntap-20181109-0001/) | CVE-2018-12882 PHP Vulnerability in NetApp Products | 2019-03-08 |
| [**NTAP-20181107-0003**](https://security.netapp.com/advisory/ntap-20181107-0003/) | August 2018 PHP Vulnerabilities in NetApp Products | 2019-03-08 |
| [**NTAP-20181107-0002**](https://security.netapp.com/advisory/ntap-20181107-0002/) | CVE-2017-5645 Apache Log4j Vulnerability in NetApp Products | 2020-11-24 |
| [**NTAP-20181107-0001**](https://security.netapp.com/advisory/ntap-20181107-0001/) | October 2018 Net-SNMP Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20181105-0001**](https://security.netapp.com/advisory/ntap-20181105-0001/) | CVE-2018-0732 OpenSSL Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20181105-0002**](https://security.netapp.com/advisory/ntap-20181105-0002/) | October 2018 OpenSSL Vulnerabilities in NetApp Products | 2024-01-02 |
| [**NTAP-20181101-0001**](https://security.netapp.com/advisory/ntap-20181101-0001/) | CVE-2018-15473 OpenSSH Username Enumeration Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20181023-0001**](https://security.netapp.com/advisory/ntap-20181023-0001/) | CVE-2015-5352 OpenSSH Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20181018-0001**](https://security.netapp.com/advisory/ntap-20181018-0001/) | October 2018 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2021-01-05 |
| [**NTAP-20181018-0002**](https://security.netapp.com/advisory/ntap-20181018-0002/) | October 2018 MySQL Vulnerabilities in NetApp Products | 2021-01-18 |
| [**NTAP-20181016-0001**](https://security.netapp.com/advisory/ntap-20181016-0001/) | CVE-2018-3665 Lazy FPU State Restore Information Disclosure Vulnerability in NetApp Products | 2021-04-26 |
| [**NTAP-20181014-0002**](https://security.netapp.com/advisory/ntap-20181014-0002/) | CVE-2018-11784 Apache Tomcat Open Redirect Vulnerability in NetApp Products | 2019-04-12 |
| [**NTAP-20181014-0001**](https://security.netapp.com/advisory/ntap-20181014-0001/) | September 2018 Eclipse Jetty Vulnerabilities in NetApp Products | 2021-01-04 |
| [**NTAP-20181003-0002**](https://security.netapp.com/advisory/ntap-20181003-0002/) | CVE-2018-5391 Linux Kernel Denial of Service Vulnerability in NetApp Products | 2022-01-14 |
| [**NTAP-20181003-0001**](https://security.netapp.com/advisory/ntap-20181003-0001/) | CVE-2018-5492 Unauthenticated Remote Code Execution Vulnerability in E-Series SANtricity OS Controller Software 11.30.5 | 2018-10-03 |
| [**NTAP-20180927-0001**](https://security.netapp.com/advisory/ntap-20180927-0001/) | CVE-2018-12015 Perl Vulnerability in NetApp Products | 2020-01-09 |
| [**NTAP-20180927-0002**](https://security.netapp.com/advisory/ntap-20180927-0002/) | CVE-2018-8897 x86 Debug Exception Vulnerability in NetApp Products | 2022-06-14 |
| [**NTAP-20180926-0002**](https://security.netapp.com/advisory/ntap-20180926-0002/) | CVE-2016-2848 ISC BIND Vulnerability in NetApp Products | 2019-02-07 |
| [**NTAP-20180926-0006**](https://security.netapp.com/advisory/ntap-20180926-0006/) | CVE-2016-4975 Apache HTTP Server Vulnerability in NetApp Products | 2019-03-08 |
| [**NTAP-20180926-0003**](https://security.netapp.com/advisory/ntap-20180926-0003/) | CVE-2018-5740 ISC Bind Vulnerability in NetApp Products | 2020-09-01 |
| [**NTAP-20180926-0005**](https://security.netapp.com/advisory/ntap-20180926-0005/) | February 2018 ISC BIND Vulnerabilities in NetApp Products | 2020-09-01 |
| [**NTAP-20180926-0007**](https://security.netapp.com/advisory/ntap-20180926-0007/) | July 2018 Apache HTTP Server Vulnerabilities in NetApp Products | 2019-03-08 |
| [**NTAP-20180926-0001**](https://security.netapp.com/advisory/ntap-20180926-0001/) | June 2017 ISC BIND Vulnerabilities in NetApp Products | 2018-12-11 |
| [**NTAP-20180926-0004**](https://security.netapp.com/advisory/ntap-20180926-0004/) | May 2018 ISC BIND Vulnerabilities in NetApp Products | 2019-07-10 |
| [**NTAP-20180924-0004**](https://security.netapp.com/advisory/ntap-20180924-0004/) | CVE-2017-5703 Intel SPI Flash Denial of Service Vulnerability in NetApp Products | 2019-11-19 |
| [**NTAP-20180924-0001**](https://security.netapp.com/advisory/ntap-20180924-0001/) | CVE-2018-17082 PHP Vulnerability in NetApp Products | 2019-03-08 |
| [**NTAP-20180924-0002**](https://security.netapp.com/advisory/ntap-20180924-0002/) | CVE-2018-3643 Intel Processor Power Management Controller Vulnerability in NetApp Products | 2020-04-23 |
| [**NTAP-20180924-0003**](https://security.netapp.com/advisory/ntap-20180924-0003/) | September 2018 Intel Converged Security Management Engine Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20180823-0001**](https://security.netapp.com/advisory/ntap-20180823-0001/) | CVE-2018-3693 Processor Speculative Execution Branch Prediction Vulnerability in NetApp Products | 2022-05-27 |
| [**NTAP-20180822-0001**](https://security.netapp.com/advisory/ntap-20180822-0001/) | CVE-2018-11776 Apache Struts Vulnerability in NetApp Products | 2018-08-24 |
| [**NTAP-20180817-0001**](https://security.netapp.com/advisory/ntap-20180817-0001/) | July 2018 Apache Tomcat Vulnerabilities in NetApp Products | 2019-03-04 |
| [**NTAP-20180815-0003**](https://security.netapp.com/advisory/ntap-20180815-0003/) | CVE-2018-5390 Linux Kernel Denial of Service (DoS) Vulnerability in NetApp Products | 2021-10-19 |
| [**NTAP-20180815-0002**](https://security.netapp.com/advisory/ntap-20180815-0002/) | CVE-2018-6922 FreeBSD Denial of Service (DoS) Vulnerability in NetApp Products | 2018-11-09 |
| [**NTAP-20180815-0001**](https://security.netapp.com/advisory/ntap-20180815-0001/) | Intel SA-00161 L1 Terminal Fault Vulnerabilities in NetApp Products | 2018-09-26 |
| [**NTAP-20180814-0001**](https://security.netapp.com/advisory/ntap-20180814-0001/) | August 2018 Samba Vulnerabilities in NetApp Products | 2018-08-14 |
| [**NTAP-20180802-0002**](https://security.netapp.com/advisory/ntap-20180802-0002/) | April 2017 ISC BIND Vulnerabilities in NetApp Products | 2018-12-11 |
| [**NTAP-20180802-0001**](https://security.netapp.com/advisory/ntap-20180802-0001/) | CVE-2018-3652 Intel Processor Information Disclosure and Privilege Escalation Vulnerability in NetApp Products | 2019-02-21 |
| [**NTAP-20180731-0003**](https://security.netapp.com/advisory/ntap-20180731-0003/) | CVE-2015-5146 Network Time Protocol Daemon (ntpd) Denial of Service Vulnerability in NetApp Products | 2019-01-30 |
| [**NTAP-20180731-0001**](https://security.netapp.com/advisory/ntap-20180731-0001/) | CVE-2017-13652 Clickjacking Vulnerability in OnCommand Insight | 2018-07-31 |
| [**NTAP-20180731-0002**](https://security.netapp.com/advisory/ntap-20180731-0002/) | November 2017 Apache Tomcat Vulnerabilities in NetApp Products | 2018-07-31 |
| [**NTAP-20180726-0003**](https://security.netapp.com/advisory/ntap-20180726-0003/) | CVE-2018-0737 OpenSSL Vulnerability in NetApp Products | 2024-01-02 |
| [**NTAP-20180726-0001**](https://security.netapp.com/advisory/ntap-20180726-0001/) | July 2018 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2021-10-19 |
| [**NTAP-20180726-0002**](https://security.netapp.com/advisory/ntap-20180726-0002/) | July 2018 MySQL Vulnerabilities in NetApp Products | 2021-01-18 |
| [**NTAP-20180706-0001**](https://security.netapp.com/advisory/ntap-20180706-0001/) | February 2018 Apache Tomcat Vulnerabilities in NetApp Products | 2018-07-06 |
| [**NTAP-20180706-0002**](https://security.netapp.com/advisory/ntap-20180706-0002/) | July 2017 Apache Struts Vulnerabilities in NetApp Products | 2018-07-06 |
| [**NTAP-20180629-0006**](https://security.netapp.com/advisory/ntap-20180629-0006/) | April 2018 Apache Struts Vulnerabilities in NetApp Products | 2018-06-29 |
| [**NTAP-20180629-0002**](https://security.netapp.com/advisory/ntap-20180629-0002/) | CVE-2015-5209 Apache Struts Vulnerability in NetApp Products | 2018-06-29 |
| [**NTAP-20180629-0005**](https://security.netapp.com/advisory/ntap-20180629-0005/) | CVE-2016-3090 Apache Struts Vulnerability in NetApp Products | 2018-06-29 |
| [**NTAP-20180629-0004**](https://security.netapp.com/advisory/ntap-20180629-0004/) | CVE-2016-4461 Apache Struts Vulnerability in NetApp Products | 2018-06-29 |
| [**NTAP-20180629-0003**](https://security.netapp.com/advisory/ntap-20180629-0003/) | October 2017 Apache Struts Vulnerabilities in NetApp Products | 2018-06-29 |
| [**NTAP-20180629-0001**](https://security.netapp.com/advisory/ntap-20180629-0001/) | September 2017 Apache Struts Vulnerabilities in NetApp Products | 2018-06-29 |
| [**NTAP-20180628-0001**](https://security.netapp.com/advisory/ntap-20180628-0001/) | CVE-2015-8325 OpenSSH Vulnerability in NetApp Products | 2018-11-12 |
| [**NTAP-20180626-0002**](https://security.netapp.com/advisory/ntap-20180626-0002/) | CVE-2015-8960 TLS Vulnerability in NetApp Products | 2021-03-16 |
| [**NTAP-20180626-0001**](https://security.netapp.com/advisory/ntap-20180626-0001/) | March 2018 Network Time Protocol Daemon (ntpd) Vulnerabilities in NetApp Products | 2021-04-28 |
| [**NTAP-20180621-0001**](https://security.netapp.com/advisory/ntap-20180621-0001/) | CVE-2017-7568 Sensitive Information Disclosure vulnerability in OnCommand Unified Manager for 7-Mode (core package) | 2018-06-21 |
| [**NTAP-20180614-0002**](https://security.netapp.com/advisory/ntap-20180614-0002/) | CVE-2016-8747 Apache Tomcat Vulnerability in NetApp Products | 2018-06-14 |
| [**NTAP-20180614-0003**](https://security.netapp.com/advisory/ntap-20180614-0003/) | July 2017 Tomcat Vulnerabilities in NetApp Products | 2018-06-14 |
| [**NTAP-20180614-0001**](https://security.netapp.com/advisory/ntap-20180614-0001/) | March 2017 Apache Tomcat Vulnerabilities in NetApp Products | 2018-06-14 |
| [**NTAP-20180612-0001**](https://security.netapp.com/advisory/ntap-20180612-0001/) | CVE-2018-5488 Unauthenticated Remote Code Execution Vulnerability in SANtricity Products | 2018-06-12 |
| [**NTAP-20180607-0002**](https://security.netapp.com/advisory/ntap-20180607-0002/) | CVE-2016-8745 Apache Tomcat Vulnerability in NetApp Products | 2018-06-07 |
| [**NTAP-20180607-0003**](https://security.netapp.com/advisory/ntap-20180607-0003/) | May 2018 PHP Vulnerabilities in NetApp Products | 2019-03-08 |
| [**NTAP-20180607-0001**](https://security.netapp.com/advisory/ntap-20180607-0001/) | November 2016 Apache Tomcat Vulnerabilities in NetApp Products | 2018-09-07 |
| [**NTAP-20180605-0001**](https://security.netapp.com/advisory/ntap-20180605-0001/) | October 2016 Apache Tomcat Vulnerabilities in NetApp Products | 2018-06-05 |
| [**NTAP-20180601-0001**](https://security.netapp.com/advisory/ntap-20180601-0001/) | August 2016 Apache HTTP Server Vulnerabilities in NetApp Products | 2018-07-30 |
| [**NTAP-20180601-0005**](https://security.netapp.com/advisory/ntap-20180601-0005/) | CVE-2016-8612 Apache HTTP Server Vulnerability in NetApp Products | 2019-04-22 |
| [**NTAP-20180601-0003**](https://security.netapp.com/advisory/ntap-20180601-0003/) | CVE-2017-9798 Apache HTTP Server Vulnerability in NetApp Products | 2019-03-14 |
| [**NTAP-20180601-0002**](https://security.netapp.com/advisory/ntap-20180601-0002/) | June 2017 Apache HTTP Server Vulnerabilities in NetApp Products | 2019-03-14 |
| [**NTAP-20180601-0004**](https://security.netapp.com/advisory/ntap-20180601-0004/) | March 2018 Apache HTTP Server Vulnerabilities in NetApp Products | 2022-01-06 |
| [**NTAP-20180531-0001**](https://security.netapp.com/advisory/ntap-20180531-0001/) | February 2016 Apache Tomcat Vulnerabilities in NetApp Products | 2022-01-14 |
| [**NTAP-20180523-0002**](https://security.netapp.com/advisory/ntap-20180523-0002/) | CVE-2018-5485 Privilege Escalation Vulnerability in OnCommand Unified Manager for Windows 7.2 and above | 2018-05-23 |
| [**NTAP-20180523-0001**](https://security.netapp.com/advisory/ntap-20180523-0001/) | CVE-2018-5487 Unauthenticated Remote Code Execution Vulnerability in OnCommand Unified Manager for Linux and Windows 7.2 and above | 2018-11-30 |
| [**NTAP-20180521-0001**](https://security.netapp.com/advisory/ntap-20180521-0001/) | Speculative Execution Side Channel Vulnerabilities in NetApp Products | 2019-04-22 |
| [**NTAP-20180426-0001**](https://security.netapp.com/advisory/ntap-20180426-0001/) | October 2017 Perl Vulnerabilities in NetApp Products | 2019-06-12 |
| [**NTAP-20180425-0001**](https://security.netapp.com/advisory/ntap-20180425-0001/) | CVE-2018-5486 Java Debug Wire Protocol Local Code Execution Vulnerability in OnCommand Unified Manager for Linux 7.2 and above | 2018-05-23 |
| [**NTAP-20180423-0003**](https://security.netapp.com/advisory/ntap-20180423-0003/) | CVE-2016-10708 OpenSSH Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20180423-0004**](https://security.netapp.com/advisory/ntap-20180423-0004/) | CVE-2017-15906 OpenSSH Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20180423-0002**](https://security.netapp.com/advisory/ntap-20180423-0002/) | CVE-2018-5968 Jackson JSON Library Vulnerability in NetApp Products | 2020-12-08 |
| [**NTAP-20180423-0001**](https://security.netapp.com/advisory/ntap-20180423-0001/) | December 2016 Apache HTTP Server Vulnerabilities in Multiple NetApp Products | 2018-06-21 |
| [**NTAP-20180419-0001**](https://security.netapp.com/advisory/ntap-20180419-0001/) | April 2018 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2021-01-05 |
| [**NTAP-20180419-0002**](https://security.netapp.com/advisory/ntap-20180419-0002/) | April 2018 MySQL Vulnerabilities in NetApp Products | 2019-03-08 |
| [**NTAP-20180330-0001**](https://security.netapp.com/advisory/ntap-20180330-0001/) | CVE-2018-1327 Apache Struts Vulnerability in NetApp Products | 2018-06-27 |
| [**NTAP-20180330-0002**](https://security.netapp.com/advisory/ntap-20180330-0002/) | March 2018 OpenSSL Vulnerabilities in NetApp Products | 2021-04-09 |
| [**NTAP-20180328-0001**](https://security.netapp.com/advisory/ntap-20180328-0001/) | CVE-2018-7489 Jackson JSON Library Vulnerability in NetApp Products | 2020-09-14 |
| [**NTAP-20180313-0001**](https://security.netapp.com/advisory/ntap-20180313-0001/) | March 2018 Samba Vulnerabilities in NetApp Products | 2018-03-13 |
| [**NTAP-20180306-0001**](https://security.netapp.com/advisory/ntap-20180306-0001/) | CVE-2017-15519 Unauthenticated Remote Access Vulnerability in SnapCenter | 2018-03-06 |
| [**NTAP-20180223-0001**](https://security.netapp.com/advisory/ntap-20180223-0001/) | CVE-2017-15518 Information Disclosure Vulnerability in OnCommand API Services and NetApp Service Level Manager | 2018-02-23 |
| [**NTAP-20180215-0001**](https://security.netapp.com/advisory/ntap-20180215-0001/) | CVE-2016-0793 Wildfly Vulnerability in NetApp Products | 2018-02-15 |
| [**NTAP-20180213-0001**](https://security.netapp.com/advisory/ntap-20180213-0001/) | SMBLoris Vulnerability in NetApp Products | 2018-08-31 |
| [**NTAP-20180201-0002**](https://security.netapp.com/advisory/ntap-20180201-0002/) | CVE-2015-6563 OpenSSH Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20180201-0001**](https://security.netapp.com/advisory/ntap-20180201-0001/) | CVE-2016-8858 OpenSSH Vulnerability in NetApp Products | 2021-04-15 |
| [**NTAP-20180201-0003**](https://security.netapp.com/advisory/ntap-20180201-0003/) | CVE-2017-17485 Jackson JSON Library vulnerability in NetApp Products | 2020-11-24 |
| [**NTAP-20180117-0003**](https://security.netapp.com/advisory/ntap-20180117-0003/) | CVE-2017-3145 ISC BIND Vulnerability in NetApp Products | 2018-09-07 |
| [**NTAP-20180117-0001**](https://security.netapp.com/advisory/ntap-20180117-0001/) | January 2018 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2021-01-05 |
| [**NTAP-20180117-0002**](https://security.netapp.com/advisory/ntap-20180117-0002/) | January 2018 MySQL vulnerabilities in NetApp Products | 2019-03-08 |
| [**NTAP-20180112-0001**](https://security.netapp.com/advisory/ntap-20180112-0001/) | September 2017 PHP Vulnerabilities in NetApp Products | 2019-03-14 |
| [**NTAP-20180109-0001**](https://security.netapp.com/advisory/ntap-20180109-0001/) | CVE-2017-8779 rpcbind Vulnerability in NetApp Products | 2022-01-14 |
| [**NTAP-20180104-0001**](https://security.netapp.com/advisory/ntap-20180104-0001/) | Processor Speculated Execution Vulnerabilities in NetApp Products | 2020-06-12 |
| [**NTAP-20171222-0001**](https://security.netapp.com/advisory/ntap-20171222-0001/) | CVE-2017-13098 Bouncy Castle TLS Vulnerability in NetApp Products | 2018-07-30 |
| [**NTAP-20171215-0001**](https://security.netapp.com/advisory/ntap-20171215-0001/) | CVE-2017-14583 SMB Authentication Denial of Service (DoS) vulnerability in clustered Data ONTAP 9.x | 2017-12-15 |
| [**NTAP-20171214-0003**](https://security.netapp.com/advisory/ntap-20171214-0003/) | CVE-2017-15095 Jackson JSON Library vulnerability in NetApp Products | 2020-11-24 |
| [**NTAP-20171214-0001**](https://security.netapp.com/advisory/ntap-20171214-0001/) | CVE-2017-15707 Apache Struts Vulnerability in NetApp Products | 2018-06-27 |
| [**NTAP-20171214-0002**](https://security.netapp.com/advisory/ntap-20171214-0002/) | CVE-2017-7525 Jackson JSON Library Vulnerability in NetApp Products | 2020-11-24 |
| [**NTAP-20171208-0002**](https://security.netapp.com/advisory/ntap-20171208-0002/) | CVE-2016-6904 Plain Text Authentication vulnerability in VASA Provider for Clustered Data ONTAP | 2017-12-08 |
| [**NTAP-20171208-0001**](https://security.netapp.com/advisory/ntap-20171208-0001/) | December 2017 OpenSSL Vulnerabilities in NetApp Products | 2021-04-09 |
| [**NTAP-20171130-0003**](https://security.netapp.com/advisory/ntap-20171130-0003/) | CVE-2016-6515 OpenSSH Vulnerability in NetApp Products | 2022-01-06 |
| [**NTAP-20171130-0001**](https://security.netapp.com/advisory/ntap-20171130-0001/) | CVE-2016-8610 OpenSSL Vulnerability in NetApp Products | 2021-01-05 |
| [**NTAP-20171130-0002**](https://security.netapp.com/advisory/ntap-20171130-0002/) | January 2017 OpenSSH Vulnerabilities in NetApp Products | 2020-09-01 |
| [**NTAP-20171120-0001**](https://security.netapp.com/advisory/ntap-20171120-0001/) | Intel SA-00086 Management Engine Vulnerabilities in NetApp Products | 2017-11-20 |
| [**NTAP-20171116-0001**](https://security.netapp.com/advisory/ntap-20171116-0001/) | CVE-2017-15517 AltaVault OST Plug-in Sensitive Information Vulnerability | 2017-11-16 |
| [**NTAP-20171114-0001**](https://security.netapp.com/advisory/ntap-20171114-0001/) | CVE-2017-15516 Cross-Site Request Forgery Vulnerability in SnapCenter Server | 2017-11-14 |
| [**NTAP-20171107-0001**](https://security.netapp.com/advisory/ntap-20171107-0001/) | CVE-2017-11461 Clickjacking Vulnerability in OnCommand Unified Manager for 7-mode (core package) | 2017-11-07 |
| [**NTAP-20171107-0002**](https://security.netapp.com/advisory/ntap-20171107-0002/) | CVE-2017-3736 OpenSSL Vulnerability in NetApp Products | 2021-01-05 |
| [**NTAP-20171031-0001**](https://security.netapp.com/advisory/ntap-20171031-0001/) | January 2016 Network Time Protocol Daemon (ntpd) Vulnerabilities in NetApp Products | 2019-02-08 |
| [**NTAP-20171024-0001**](https://security.netapp.com/advisory/ntap-20171024-0001/) | CVE-2017-15361 Infineon RSA Library Vulnerability in NetApp Products | 2017-10-24 |
| [**NTAP-20171019-0001**](https://security.netapp.com/advisory/ntap-20171019-0001/) | October 2017 Java Platform Standard Edition Vulnerabilities in NetApp Products | 2021-01-05 |
| [**NTAP-20171019-0002**](https://security.netapp.com/advisory/ntap-20171019-0002/) | October 2017 MySQL Vulnerabilities in NetApp Products | 2019-03-14 |
| [**NTAP-20171018-0001**](https://security.netapp.com/advisory/ntap-20171018-0001/) | August 2017 Apache Tomcat Vulnerabilities in NetApp Products | 2018-07-30 |
| [**NTAP-20171018-0002**](https://security.netapp.com/advisory/ntap-20171018-0002/) | CVE-2017-12617 Apache Tomcat Vulnerability in NetApp Products | 2018-07-30 |
| [**NTAP-20171004-0002**](https://security.netapp.com/advisory/ntap-20171004-0002/) | April 2016 Network Time Protocol Daemon (ntpd) Vulnerabilities in Multiple NetApp Products | 2020-01-28 |
| [**NTAP-20171004-0001**](https://security.netapp.com/advisory/ntap-20171004-0001/) | October 2015 Network Time Protocol Daemon (ntpd) Vulnerabilities in Multiple NetApp Products | 2019-09-18 |
| [**NTAP-20170927-0001**](https://security.netapp.com/advisory/ntap-20170927-0001/) | CVE-2017-3735 OpenSSL Vulnerability in Multiple NetApp Products | 2021-01-05 |
| [**NTAP-20170921-0001**](https://security.netapp.com/advisory/ntap-20170921-0001/) | September 2017 Samba Vulnerabilities in NetApp StorageGRID Products | 2018-08-31 |
| [**NTAP-20170911-0001**](https://security.netapp.com/advisory/ntap-20170911-0001/) | CVE-2017-12611 Apache Struts Vulnerability in Multiple NetApp Products | 2018-01-19 |
| [**NTAP-20170911-0002**](https://security.netapp.com/advisory/ntap-20170911-0002/) | July 2017 Apache httpd Server Vulnerabilities in Multiple NetApp Products | 2019-03-14 |
| [**NTAP-20170907-0001**](https://security.netapp.com/advisory/ntap-20170907-0001/) | CVE-2017-9805 Apache Struts Vulnerability in Multiple NetApp Products | 2018-01-19 |
| [**NTAP-20170831-0003**](https://security.netapp.com/advisory/ntap-20170831-0003/) | CVE-2016-1895 Unsafe User Input String Vulnerability in Data ONTAP | 2017-08-31 |
| [**NTAP-20170831-0001**](https://security.netapp.com/advisory/ntap-20170831-0001/) | CVE-2017-14053 Session Cookie Vulnerability in OnCommand Unified Manager for Clustered Data ONTAP | 2017-08-31 |
| [**NTAP-20170831-0002**](https://security.netapp.com/advisory/ntap-20170831-0002/) | Unauthorized Read and Remote Code Execution Vulnerabilities in clustered Data ONTAP 8.3 | 2017-09-05 |
| [**NTAP-20170825-0001**](https://security.netapp.com/advisory/ntap-20170825-0001/) | CVE-2017-12422 Unauthorized Object Deletion Vulnerability in StorageGRID WebScale | 2017-08-25 |
| [**NTAP-20170815-0001**](https://security.netapp.com/advisory/ntap-20170815-0001/) | CVE-1999-0016 Denial of Service Vulnerability in Data ONTAP | 2017-08-15 |
| [**NTAP-20170815-0002**](https://security.netapp.com/advisory/ntap-20170815-0002/) | CVE-2017-12859 Denial of Service Vulnerability in Data ONTAP operating in 7-Mode | 2017-10-11 |
| [**NTAP-20170814-0001**](https://security.netapp.com/advisory/ntap-20170814-0001/) | CVE-2017-12420 Heap Overflow Vulnerability in clustered Data ONTAP | 2017-08-15 |
| [**NTAP-20170809-0001**](https://security.netapp.com/advisory/ntap-20170809-0001/) | CVE-2017-5201 Sensitive Information Disclosure Vulnerability in Clustered Data ONTAP | 2017-08-09 |
| [**NTAP-20170808-0001**](https://security.netapp.com/advisory/ntap-20170808-0001/) | Linux Memory Management Vulnerabilities in NetApp Products | 2019-05-31 |
| [**NTAP-20170803-0001**](https://security.netapp.com/advisory/ntap-20170803-0001/) | June 2017 sudo Vulnerabilities in NetApp Products | 2018-09-07 |
| [**NTAP-20170720-0001**](https://security.netapp.com/advisory/ntap-20170720-0001/) | July 2017 Java Platform Standard Edition Vulnerabilities in Multiple NetApp Products | 2021-01-05 |
| [**NTAP-20170720-0002**](https://security.netapp.com/advisory/ntap-20170720-0002/) | July 2017 MySQL Vulnerabilities in Multiple NetApp Products | 2018-08-25 |
| [**NTAP-20170718-0001**](https://security.netapp.com/advisory/ntap-20170718-0001/) | CVE-2017-8919 Information Disclosure Vulnerability in OnCommand API Services | 2017-07-18 |
| [**NTAP-20170630-0001**](https://security.netapp.com/advisory/ntap-20170630-0001/) | CVE-2017-7947 Information Disclosure Vulnerability in clustered Data ONTAP | 2017-07-14 |
| [**NTAP-20170526-0001**](https://security.netapp.com/advisory/ntap-20170526-0001/) | March 2017 Network Time Protocol Daemon (ntpd) Vulnerabilities in Multiple NetApp Products | 2018-12-11 |
| [**NTAP-20170524-0001**](https://security.netapp.com/advisory/ntap-20170524-0001/) | CVE-2017-7494 Samba Remote Code Execution Vulnerability in StorageGRID Products | 2018-08-31 |
| [**NTAP-20170517-0001**](https://security.netapp.com/advisory/ntap-20170517-0001/) | CVE-2017-7236: SQL Injection vulnerability in OnCommand Unified Manager Core Package (5.x) | 2017-05-17 |
| [**NTAP-20170517-0002**](https://security.netapp.com/advisory/ntap-20170517-0002/) | CVE-2017-7439: Information Disclosure vulnerability in OnCommand Unified Manager Core Package (5.x) | 2017-05-17 |
| [**NTAP-20170515-0001**](https://security.netapp.com/advisory/ntap-20170515-0001/) | NetApp Product Security Notice for WannaCrypt and Petya Ransomware | 2017-07-05 |
| [**NTAP-20170509-0001**](https://security.netapp.com/advisory/ntap-20170509-0001/) | CVE-2017-5689 Intel Management Engine Vulnerability in Multiple NetApp Products | 2017-05-10 |
| [**NTAP-20170420-0001**](https://security.netapp.com/advisory/ntap-20170420-0001/) | April 2017 Java Platform Standard Edition Vulnerabilities in Multiple NetApp Products | 2021-01-05 |
| [**NTAP-20170420-0002**](https://security.netapp.com/advisory/ntap-20170420-0002/) | April 2017 MySQL Vulnerabilities in Multiple NetApp Products | 2018-08-25 |
| [**NTAP-20170331-0001**](https://security.netapp.com/advisory/ntap-20170331-0001/) | CVE-2017-5988 Denial of Service Vulnerability in clustered Data ONTAP 8.1 and higher | 2017-05-25 |
| [**NTAP-20170331-0002**](https://security.netapp.com/advisory/ntap-20170331-0002/) | CVE-2017-7345 JMX RMI Information Disclosure Vulnerability in Multiple NetApp Products | 2017-03-31 |
| [**NTAP-20170323-0001**](https://security.netapp.com/advisory/ntap-20170323-0001/) | CVE-2016-5045 Cluster Peering Vulnerability in OnCommand System Manager 8.3.x | 2017-03-23 |
| [**NTAP-20170310-0001**](https://security.netapp.com/advisory/ntap-20170310-0001/) | CVE-2017-5638 Apache Struts Vulnerability in Multiple NetApp Products | 2017-03-10 |
| [**NTAP-20170310-0002**](https://security.netapp.com/advisory/ntap-20170310-0002/) | November 2016 Network Time Protocol Daemon (ntpd) Vulnerabilities in Multiple NetApp Products | 2018-12-11 |
| [**NTAP-20170228-0002**](https://security.netapp.com/advisory/ntap-20170228-0002/) | CVE-2016-5374 Missing SMB Authorization Check Vulnerability in ONTAP 9 | 2017-02-28 |
| [**NTAP-20170228-0001**](https://security.netapp.com/advisory/ntap-20170228-0001/) | CVE-2017-5995 ONTAP Select Deploy Sensitive Information Vulnerability | 2017-02-28 |
| [**NTAP-20170131-0001**](https://security.netapp.com/advisory/ntap-20170131-0001/) | CVE-2017-5600 Default Privileged Account Vulnerability in OnCommand Insight Data Warehouse | 2017-02-15 |
| [**NTAP-20170127-0001**](https://security.netapp.com/advisory/ntap-20170127-0001/) | January 2017 OpenSSL Vulnerabilities in Multiple NetApp Products | 2022-02-28 |
| [**NTAP-20170119-0001**](https://security.netapp.com/advisory/ntap-20170119-0001/) | January 2017 Java Platform Standard Edition Vulnerabilities in Multiple NetApp Products | 2019-02-07 |
| [**NTAP-20170119-0002**](https://security.netapp.com/advisory/ntap-20170119-0002/) | January 2017 MySQL Vulnerabilities in Multiple NetApp Products | 2018-08-25 |
| [**NTAP-20161220-0001**](https://security.netapp.com/advisory/ntap-20161220-0001/) | CVE-2016-7172 Sensitive Information Disclosure in Snap Creator Framework | 2016-12-20 |
| [**NTAP-20161219-0001**](https://security.netapp.com/advisory/ntap-20161219-0001/) | December 2016 Samba Vulnerabilities in Multiple NetApp Products | 2018-05-25 |
| [**NTAP-20161129-0001**](https://security.netapp.com/advisory/ntap-20161129-0001/) | CVE-2016-7171 Non-Unique Certificate Vulnerability in NetApp Plug-in for Symantec NetBackup | 2016-11-29 |
| [**NTAP-20161108-0001**](https://security.netapp.com/advisory/ntap-20161108-0001/) | CVE-2016-5711 Non-Unique Certificate Vulnerability in Virtual Storage Console | 2016-11-08 |
| [**NTAP-20161028-0001**](https://security.netapp.com/advisory/ntap-20161028-0001/) | CVE-2016-4341 SMB Share Information Disclosure Vulnerability in Clustered Data ONTAP | 2016-10-28 |
| [**NTAP-20161025-0001**](https://security.netapp.com/advisory/ntap-20161025-0001/) | CVE-2016-5195 Kernel Local Privilege Escalation Vulnerability in Multiple NetApp Products | 2019-05-31 |
| [**NTAP-20161019-0001**](https://security.netapp.com/advisory/ntap-20161019-0001/) | October 2016 Java Platform Standard Edition Vulnerabilities in Multiple NetApp Products | 2019-02-07 |
| [**NTAP-20161019-0002**](https://security.netapp.com/advisory/ntap-20161019-0002/) | October 2016 MySQL Vulnerabilities in Multiple NetApp Products | 2018-08-25 |
| [**NTAP-20161017-0001**](https://security.netapp.com/advisory/ntap-20161017-0001/) | CVE-2010-1871 JBoss Seam Vulnerability in Multiple NetApp Products | 2018-01-22 |
| [**NTAP-20161017-0002**](https://security.netapp.com/advisory/ntap-20161017-0002/) | CVE-2016-6667 Default Privileged Account Credentials Vulnerability in OnCommand Unified Manager for Clustered Data ONTAP | 2016-10-17 |
| [**NTAP-20160930-0001**](https://security.netapp.com/advisory/ntap-20160930-0001/) | CVE-2016-2776 ISC BIND Vulnerability in Multiple NetApp Products | 2018-12-11 |
| [**NTAP-20160929-0001**](https://security.netapp.com/advisory/ntap-20160929-0001/) | CVE-2016-6495 Information Disclosure Vulnerability in Data ONTAP operating in 7-Mode | 2016-09-29 |
| [**NTAP-20160928-0001**](https://security.netapp.com/advisory/ntap-20160928-0001/) | September 2016 OpenSSL Vulnerabilities in Multiple NetApp Products | 2019-07-24 |
| [**NTAP-20160915-0001**](https://security.netapp.com/advisory/ntap-20160915-0001/) | CVE-2016-2183 TLS Protocol 64-bit Cipher Vulnerability in Multiple NetApp Products | 2022-01-14 |
| [**NTAP-20160830-0002**](https://security.netapp.com/advisory/ntap-20160830-0002/) | CVE-2016-3064 Sensitive Information Disclosure Vulnerability in Clustered Data ONTAP | 2016-08-30 |
| [**NTAP-20160830-0001**](https://security.netapp.com/advisory/ntap-20160830-0001/) | CVE-2016-5047 Denial of Service Vulnerability in OnCommand System Manager 8.3.x | 2016-08-30 |
| [**NTAP-20160816-0001**](https://security.netapp.com/advisory/ntap-20160816-0001/) | CVE-2016-6820 Sensitive Information Disclosure in MetroCluster Tiebreaker for clustered Data ONTAP | 2016-08-16 |
| [**NTAP-20160802-0001**](https://security.netapp.com/advisory/ntap-20160802-0001/) | CVE-2015-8020 Default Privileged Account Credentials Vulnerability in in Clustered Data ONTAP | 2016-08-02 |
| [**NTAP-20160722-0002**](https://security.netapp.com/advisory/ntap-20160722-0002/) | CVE-2016-2775 ISC BIND Vulnerability in Multiple NetApp Products | 2017-03-08 |
| [**NTAP-20160722-0001**](https://security.netapp.com/advisory/ntap-20160722-0001/) | June 2016 Network Time Protocol Daemon (ntpd) Vulnerabilities in NetApp Products | 2018-01-22 |
| [**NTAP-20160721-0001**](https://security.netapp.com/advisory/ntap-20160721-0001/) | July 2016 Java Platform Standard Edition Vulnerabilities in Multiple NetApp Products | 2018-09-14 |
| [**NTAP-20160721-0002**](https://security.netapp.com/advisory/ntap-20160721-0002/) | July 2016 MySQL Vulnerabilities in Multiple NetApp Products | 2017-01-10 |
| [**NTAP-20160708-0001**](https://security.netapp.com/advisory/ntap-20160708-0001/) | CVE-2016-2119 Samba SMB Client Required Signing Downgrade Vulnerability | 2016-07-08 |
| [**NTAP-20160623-0001**](https://security.netapp.com/advisory/ntap-20160623-0001/) | CVE-2015-3253 Apache Groovy Vulnerability in OnCommand Insight | 2016-06-23 |
| [**NTAP-20160623-0004**](https://security.netapp.com/advisory/ntap-20160623-0004/) | Denial of Service Vulnerability in ATTO FibreBridge 7500N | 2016-07-03 |
| [**NTAP-20160623-0003**](https://security.netapp.com/advisory/ntap-20160623-0003/) | Multiple Elasticsearch Vulnerabilities in OnCommand Insight Anomaly Detection Engine | 2016-06-28 |
| [**NTAP-20160623-0002**](https://security.netapp.com/advisory/ntap-20160623-0002/) | Multiple Unauthenticated Remote Code Execution Vulnerabilities in OnCommand Insight | 2016-06-23 |
| [**NTAP-20160622-0001**](https://security.netapp.com/advisory/ntap-20160622-0001/) | CVE-2016-5372 Cross-Site Request Forgery Vulnerability in Snap Creator Framework | 2016-06-22 |
| [**NTAP-20160620-0001**](https://security.netapp.com/advisory/ntap-20160620-0001/) | CVE-2016-5710 Clickjacking Vulnerability in Snap Creator Framework | 2016-06-20 |
| [**NTAP-20160602-0001**](https://security.netapp.com/advisory/ntap-20160602-0001/) | OVA Build Inconsistencies Resulting in Vulnerability Regressions in Multiple NetApp Products | 2016-06-14 |
| [**NTAP-20160519-0001**](https://security.netapp.com/advisory/ntap-20160519-0001/) | May 2016 OpenSSH Vulnerabilities in Multiple NetApp Products | 2020-09-01 |
| [**NTAP-20160504-0001**](https://security.netapp.com/advisory/ntap-20160504-0001/) | May 2016 OpenSSL Vulnerabilities in Multiple NetApp Products | 2019-07-24 |
| [**NTAP-20160421-0001**](https://security.netapp.com/advisory/ntap-20160421-0001/) | April 2016 MySQL Vulnerabilities in Multiple NetApp Products | 2018-01-22 |
| [**NTAP-20160420-0001**](https://security.netapp.com/advisory/ntap-20160420-0001/) | April 2016 Java Platform Standard Edition Vulnerabilities in Multiple NetApp Products | 2018-09-14 |
| [**NTAP-20160412-0001**](https://security.netapp.com/advisory/ntap-20160412-0001/) | SMB Vulnerabilities in Multiple NetApp Products | 2019-12-20 |
| [**NTAP-20160330-0001**](https://security.netapp.com/advisory/ntap-20160330-0001/) | August 2015 OpenSSH Vulnerabilities in Multiple NetApp Products | 2018-01-22 |
| [**NTAP-20160328-0001**](https://security.netapp.com/advisory/ntap-20160328-0001/) | CVE-2016-0636 Java Platform Standard Edition Vulnerability in Multiple NetApp Products | 2018-07-30 |
| [**NTAP-20160324-0001**](https://security.netapp.com/advisory/ntap-20160324-0001/) | CVE-2015-3963 VxWorks Vulnerability impacting NetApp E-Series/EF-Series SANtricity OS Controller Firmware | 2016-04-26 |
| [**NTAP-20160322-0001**](https://security.netapp.com/advisory/ntap-20160322-0001/) | January 2016 ISC BIND Vulnerabilities in Multiple NetApp Products | 2018-08-22 |
| [**NTAP-20160322-0002**](https://security.netapp.com/advisory/ntap-20160322-0002/) | March 2016 ISC BIND Vulnerabilities in Multiple NetApp Products | 2018-11-02 |
| [**NTAP-20160321-0001**](https://security.netapp.com/advisory/ntap-20160321-0001/) | CVE-2016-2842 OpenSSL Vulnerability in Multiple NetApp Products | 2019-07-24 |
| [**NTAP-20160317-0001**](https://security.netapp.com/advisory/ntap-20160317-0001/) | December 2015 ISC BIND Vulnerabilities in Multiple NetApp Products | 2018-01-22 |
| [**NTAP-20160310-0003**](https://security.netapp.com/advisory/ntap-20160310-0003/) | CVE-2015-8322 Arbitrary Code Execution Vulnerability in OnCommand System Manager 8.3.x | 2016-08-11 |
| [**NTAP-20160310-0002**](https://security.netapp.com/advisory/ntap-20160310-0002/) | CVE-2016-1563 TLS Certificate Verification vulnerability in Clustered Data ONTAP | 2016-03-10 |
| [**NTAP-20160310-0001**](https://security.netapp.com/advisory/ntap-20160310-0001/) | CVE-2016-1894 Authentication Bypass Vulnerability in OnCommand Workflow Automation | 2016-03-11 |
| [**NTAP-20160310-0004**](https://security.netapp.com/advisory/ntap-20160310-0004/) | CVE-2016-3063 ZAPI Injection Vulnerability in OnCommand System Manager | 2016-08-11 |
| [**NTAP-20160303-0001**](https://security.netapp.com/advisory/ntap-20160303-0001/) | March 2016 OpenSSL Vulnerabilities in Multiple NetApp Products | 2019-07-24 |
| [**NTAP-20160301-0001**](https://security.netapp.com/advisory/ntap-20160301-0001/) | CVE-2016-0800 SSLv2 Vulnerability in Multiple NetApp Products | 2019-08-26 |
| [**NTAP-20160225-0001**](https://security.netapp.com/advisory/ntap-20160225-0001/) | CVE-2015-7575 TLS Vulnerability in Multiple NetApp Products | 2020-09-17 |
| [**NTAP-20160217-0002**](https://security.netapp.com/advisory/ntap-20160217-0002/) | CVE-2015-7547 GNU C Library (glibc) Vulnerability in Multiple NetApp Products | 2019-05-31 |
| [**NTAP-20160217-0001**](https://security.netapp.com/advisory/ntap-20160217-0001/) | CVE-2016-0603 Java Platform Standard Edition Vulnerability in Multiple NetApp Products | 2017-03-22 |
| [**NTAP-20160211-0001**](https://security.netapp.com/advisory/ntap-20160211-0001/) | CVE-2016-0728 Linux Kernel Privilege Escalation Vulnerability in NetApp Products | 2019-02-04 |
| [**NTAP-20160201-0001**](https://security.netapp.com/advisory/ntap-20160201-0001/) | January 2016 OpenSSL Vulnerabilities in Multiple NetApp Products | 2021-04-09 |
| [**NTAP-20160126-0001**](https://security.netapp.com/advisory/ntap-20160126-0001/) | January 2016 OpenSSH Vulnerabilities in Multiple NetApp Products | 2018-09-04 |
| [**NTAP-20160121-0001**](https://security.netapp.com/advisory/ntap-20160121-0001/) | January 2016 Java Platform Standard Edition Vulnerabilities in Multiple NetApp Products | 2018-09-07 |
| [**NTAP-20160121-0002**](https://security.netapp.com/advisory/ntap-20160121-0002/) | January 2016 MySQL Vulnerabilities in Multiple NetApp Products | 2017-01-10 |
| [**NTAP-20160114-0001**](https://security.netapp.com/advisory/ntap-20160114-0001/) | CVE-2015-5477 ISC BIND Vulnerability in Clustered Data ONTAP | 2016-01-14 |
| [**NTAP-20160114-0002**](https://security.netapp.com/advisory/ntap-20160114-0002/) | CVE-2015-7886 HTTPD Access Control Bypass Vulnerability in Data ONTAP operating in 7-Mode | 2016-01-14 |
| [**NTAP-20160111-0002**](https://security.netapp.com/advisory/ntap-20160111-0002/) | Authentication Bypass Vulnerability in SnapCenter Server 1.0 & 1.0P1 | 2016-01-11 |
| [**NTAP-20160111-0001**](https://security.netapp.com/advisory/ntap-20160111-0001/) | CVE-2015-8544 Sensitive Information Disclosure in SnapDrive for Windows | 2016-01-13 |
| [**NTAP-20151207-0001**](https://security.netapp.com/advisory/ntap-20151207-0001/) | December 2015 OpenSSL Vulnerabilities in Multiple NetApp Products | 2021-04-09 |
| [**NTAP-20151123-0001**](https://security.netapp.com/advisory/ntap-20151123-0001/) | Apache Commons Collection Java Deserialization Vulnerability in Multiple NetApp Products | 2024-03-05 |
| [**NTAP-20151112-0001**](https://security.netapp.com/advisory/ntap-20151112-0001/) | UTF-8 Volume Language Authentication Bypass Vulnerability in Data ONTAP operating in 7-Mode | 2021-01-05 |
| [**NTAP-20151106-0001**](https://security.netapp.com/advisory/ntap-20151106-0001/) | CVE-2015-5600 OpenSSH MaxAuthTries Bypass Vulnerability in NetApp Products | 2018-11-21 |
| [**NTAP-20151102-0001**](https://security.netapp.com/advisory/ntap-20151102-0001/) | Web Server Debugging Functions Vulnerability in OnCommand Workflow Automation | 2015-11-02 |
| [**NTAP-20151030-0001**](https://security.netapp.com/advisory/ntap-20151030-0001/) | October 2015 MySQL Vulnerabilities in Multiple NetApp Products | 2016-08-11 |
| [**NTAP-20151029-0001**](https://security.netapp.com/advisory/ntap-20151029-0001/) | CVE-2015-7599 VxWorks Vulnerability impacting NetApp E-Series products | 2016-01-19 |
| [**NTAP-20151028-0001**](https://security.netapp.com/advisory/ntap-20151028-0001/) | October 2015 Java Platform Standard Edition Vulnerabilities in Multiple NetApp Products | 2017-03-22 |
| [**NTAP-20151026-0001**](https://security.netapp.com/advisory/ntap-20151026-0001/) | CVE-2015-7887 Authentication Bypass Vulnerability in SnapCenter Server 1.0 | 2016-01-07 |
| [**NTAP-20150716-0001**](https://security.netapp.com/advisory/ntap-20150716-0001/) | July 2015 MySQL Vulnerabilities in Multiple NetApp Products | 2015-12-03 |
| [**NTAP-20150715-0001**](https://security.netapp.com/advisory/ntap-20150715-0001/) | July 2015 Java Platform Standard Edition Vulnerabilities in Multiple NetApp Products | 2017-03-22 |
| [**NTAP-20150709-0001**](https://security.netapp.com/advisory/ntap-20150709-0001/) | CVE-2015-1793 OpenSSL Vulnerability does not impact NetApp Products | 2015-07-09 |
| [**NTAP-20150619-0001**](https://security.netapp.com/advisory/ntap-20150619-0001/) | CVE-2015-4000 Diffie-Hellman Export Cipher Suite vulnerability in Multiple NetApp Products | 2022-02-21 |
| [**NTAP-20150616-0001**](https://security.netapp.com/advisory/ntap-20150616-0001/) | June 2015 OpenSSL Vulnerabilities in NetApp Products | 2019-07-24 |
| [**NTAP-20150528-0001**](https://security.netapp.com/advisory/ntap-20150528-0001/) | CVE-2015-3292 OnCommand Workflow Automation Remote Code Execution Vulnerability | 2015-05-28 |
| [**NTAP-20150417-0001**](https://security.netapp.com/advisory/ntap-20150417-0001/) | April 2015 Java Platform Standard Edition Vulnerabilities in Multiple NetApp Products | 2017-03-22 |
| [**NTAP-20150417-0002**](https://security.netapp.com/advisory/ntap-20150417-0002/) | April 2015 MySQL Vulnerabilities in Multiple NetApp Products | 2018-07-31 |
| [**NTAP-20150417-0003**](https://security.netapp.com/advisory/ntap-20150417-0003/) | CVE-2015-2575 MySQL Connector/J Vulnerability in Multiple NetApp Products | 2016-08-31 |
| [**NTAP-20150324-0001**](https://security.netapp.com/advisory/ntap-20150324-0001/) | Improper Handling of Export Policy Rules for SMBv2 and SMBv3 Clients Vulnerability in Clustered Data ONTAP 8.3 Release Candidates | 2017-02-07 |
| [**NTAP-20150323-0001**](https://security.netapp.com/advisory/ntap-20150323-0001/) | 7-Mode Transition Tool File Authorization Bypass Vulnerability | 2015-03-23 |
| [**NTAP-20150323-0002**](https://security.netapp.com/advisory/ntap-20150323-0002/) | March 2015 OpenSSL Vulnerabilities in Multiple NetApp Products | 2018-08-23 |
| [**NTAP-20150313-0001**](https://security.netapp.com/advisory/ntap-20150313-0001/) | Potential SMB services disruption after installation of Microsoft patch KB3002657-v1 on Windows 2003 Domain Controllers | 2015-03-31 |
| [**NTAP-20150304-0001**](https://security.netapp.com/advisory/ntap-20150304-0001/) | January 2015 MySQL Vulnerabilities in Multiple NetApp Products | 2018-07-31 |
| [**NTAP-20150209-0001**](https://security.netapp.com/advisory/ntap-20150209-0001/) | CVE-2003-1418 Apache ETag Inode Disclosure Vulnerability in Clustered Data ONTAP | 2015-02-09 |
| [**NTAP-20150205-0001**](https://security.netapp.com/advisory/ntap-20150205-0001/) | January 2015 OpenSSL Vulnerabilities in Multiple NetApp Products | 2016-08-31 |
| [**NTAP-20150127-0001**](https://security.netapp.com/advisory/ntap-20150127-0001/) | CVE-2015-0235 GNU C Library (glibc) Vulnerability in Multiple NetApp Products | 2018-03-20 |
| [**NTAP-20150126-0001**](https://security.netapp.com/advisory/ntap-20150126-0001/) | January 2015 Java Runtime Environment (JRE) Vulnerabilities in Multiple NetApp Products | 2017-03-22 |
| [**NTAP-20150122-0002**](https://security.netapp.com/advisory/ntap-20150122-0002/) | CVE-2003-0028 XDR Libraries Integer Overflow Vulnerability in Data ONTAP | 2017-08-24 |
| [**NTAP-20150122-0003**](https://security.netapp.com/advisory/ntap-20150122-0003/) | CVE-2014-4877 GNU Wget Vulnerability in Multiple NetApp Products | 2015-03-24 |
| [**NTAP-20150122-0001**](https://security.netapp.com/advisory/ntap-20150122-0001/) | RC4 Cipher Vulnerabilities in Multiple NetApp Products | 2022-02-02 |
| [**NTAP-20150115-0001**](https://security.netapp.com/advisory/ntap-20150115-0001/) | CVE-2014-9353 Default Privileged Account Credentials Vulnerability in OnCommand Balance | 2015-01-15 |
| [**NTAP-20150115-0002**](https://security.netapp.com/advisory/ntap-20150115-0002/) | CVE-2014-9354 Cleartext Storage of Sensitive Information in OnCommand Balance | 2015-01-23 |
| [**NTAP-20141222-0001**](https://security.netapp.com/advisory/ntap-20141222-0001/) | Network Time Protocol Daemon (ntpd) 4.2.7 Vulnerabilities in NetApp Products | 2015-01-05 |
| [**NTAP-20141125-0001**](https://security.netapp.com/advisory/ntap-20141125-0001/) | July 2014 Oracle MySQL vulnerabilities in Multiple NetApp Products | 2016-08-23 |
| [**NTAP-20141119-0001**](https://security.netapp.com/advisory/ntap-20141119-0001/) | October 2014 Oracle MySQL vulnerabilities in Multiple NetApp Products | 2018-07-31 |
| [**NTAP-20141030-0001**](https://security.netapp.com/advisory/ntap-20141030-0001/) | August 2014 OpenSSL CVE Bundle Security Vulnerabilities in Multiple NetApp Products | 2016-11-30 |
| [**NTAP-20141030-0002**](https://security.netapp.com/advisory/ntap-20141030-0002/) | CVE-2010-3613 BIND Vulnerability in Clustered Data ONTAP | 2014-12-02 |
| [**NTAP-20141030-0003**](https://security.netapp.com/advisory/ntap-20141030-0003/) | CVE-2012-1667 BIND Vulnerability in Clustered Data ONTAP | 2014-12-23 |
| [**NTAP-20141028-0002**](https://security.netapp.com/advisory/ntap-20141028-0002/) | GNUTLS Buffer Overflow vulnerabilities in Select NetApp Products | 2018-01-22 |
| [**NTAP-20141028-0001**](https://security.netapp.com/advisory/ntap-20141028-0001/) | July 2014 Java Runtime Environment (JRE) vulnerabilities in Multiple NetApp Products | 2017-03-22 |
| [**NTAP-20141024-0001**](https://security.netapp.com/advisory/ntap-20141024-0001/) | GNUTLS Certification Validation Bypass vulnerability in Select NetApp Products | 2018-01-22 |
| [**NTAP-20141023-0001**](https://security.netapp.com/advisory/ntap-20141023-0001/) | October 2014 Java Runtime Environment (JRE) Vulnerabilities in Multiple NetApp Products | 2017-03-22 |
| [**NTAP-20141015-0001**](https://security.netapp.com/advisory/ntap-20141015-0001/) | CVE-2014-3566 SSL v3.0 Nondeterministic CBC Padding Vulnerability in Multiple NetApp Products | 2019-10-21 |
| [**NTAP-20141015-0002**](https://security.netapp.com/advisory/ntap-20141015-0002/) | October 2014 OpenSSL Vulnerabilities in Multiple NetApp Products | 2016-12-13 |
| [**NTAP-20140924-0001**](https://security.netapp.com/advisory/ntap-20140924-0001/) | Bash Code Injection Vulnerability in Select NetApp Products | 2015-03-11 |
| [**NTAP-20140911-0001**](https://security.netapp.com/advisory/ntap-20140911-0001/) | CVE-2014-0114 Apache Commons BeanUtils Vulnerability in Multiple NetApp Products | 2021-07-05 |
| [**NTAP-20140609-0002**](https://security.netapp.com/advisory/ntap-20140609-0002/) | June 2014 OpenSSL DTLS Vulnerabilities in Multiple NetApp Products | 2015-03-27 |
| [**NTAP-20140609-0004**](https://security.netapp.com/advisory/ntap-20140609-0004/) | June 2014 OpenSSL Elliptic Curve Vulnerabilities in Multiple NetApp Products | 2016-08-23 |
| [**NTAP-20140609-0001**](https://security.netapp.com/advisory/ntap-20140609-0001/) | June 2014 OpenSSL TLS Handshake Vulnerability in Select NetApp Products | 2016-08-23 |
| [**NTAP-20140609-0003**](https://security.netapp.com/advisory/ntap-20140609-0003/) | OpenSSL SSL\_MODE\_RELEASE\_BUFFERS Vulnerabilities in NetApp Products | 2014-12-23 |
| [**NTAP-20140410-0001**](https://security.netapp.com/advisory/ntap-20140410-0001/) | OpenSSL Heartbeat Extension Vulnerability in Multiple NetApp Products | 2018-07-17 |

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from security.netapp.com_10191b2d_20250115_082321.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2023-42465 Sudo Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20240208-0002)

## CVE-2023-42465 Sudo Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20240208-0002 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240208-0002 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20240208-0002 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240208-0002 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240208-0002
**Version:**
3.0

**Last updated:**
06/10/2024

**Status:**
Interim.

**CVEs:** CVE-2023-42465

Overview
#### Summary

Multiple NetApp products incorporate Sudo. Sudo versions prior to 1.9.15 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2023-42465](https://nvd.nist.gov/vuln/detail/CVE-2023-42465) | 7.0 (HIGH) | CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://www.sudo.ws/releases/changelog/>
* <https://github.com/sudo-project/sudo/releases/tag/SUDO_1_9_15>

Affected Products
#### Affected Products

None.

#### Products Under Investigation

* NetApp HCI Compute Node (Bootstrap OS)

#### Products Not Affected

* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 10
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x
* Terraform Provider for ONTAP

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240208-0002>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240208 | Initial Public Release |
| 2.0 | 20240222 | NetApp SolidFire & HCI Management Node and NetApp SolidFire & HCI Storage Node (Element Software) moved to Products Not Affected |
| 3.0 | 20240610 | ONTAP tools for VMware vSphere 10 moved to Products Not Affected |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from security.gentoo.org_975088db_20250115_082320.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# sudo: Memory Manipulation — GLSA **202401-29**

A vulnerability has been discovered in sudo which can lead to execution manipulation through rowhammer-style memory manipulation.

### Affected packages

| Package | **app-admin/sudo** on all architectures |
| --- | --- |
| Affected versions | < **1.9.15\_p2** |
| Unaffected versions | >= **1.9.15\_p2** |

### Background

sudo allows a system administrator to give users the ability to run commands as other users.

### Description

Multiple vulnerabilities have been discovered in sudo. Please review the CVE identifiers referenced below for details.

### Impact

Stack/register variables can be flipped via fault injection, affecting execution flow in security-sensitive code.

### Workaround

There is no known workaround at this time.

### Resolution

All sudo users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-admin/sudo-1.9.15_p2"

```
### References

* [CVE-2023-42465](https://nvd.nist.gov/vuln/detail/CVE-2023-42465)

**Release date**

January 24, 2024

**Latest revision**

January 24, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [920510](https://bugs.gentoo.org/show_bug.cgi?id=920510)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from lists.fedoraproject.org_a5b20abc_20250115_082320.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/R4Q23NHCKCLFIHSNY6KJ27GM7FSCEVXM/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/R4Q23NHCKCLFIHSNY6KJ27GM7FSCEVXM/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/R4Q23NHCKCLFIHSNY6KJ27GM7FSCEVXM/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/R4Q23NHCKCLFIHSNY6KJ27GM7FSCEVXM/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-R4Q23NHCKCLFIHSNY6KJ27GM7FSCEVXM.mbox.gz?message=R4Q23NHCKCLFIHSNY6KJ27GM7FSCEVXM "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/R4Q23NHCKCLFIHSNY6KJ27GM7FSCEVXM/#R4Q23NHCKCLFIHSNY6KJ27GM7FSCEVXM)

# [SECURITY] Fedora 38 Update: sudo-1.9.15-1.p5.fc38

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

17 Feb
2024

17 Feb
'24

8:50 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-6fa5af9ea8
2024-02-18 01:49:27.343785
--------------------------------------------------------------------------------

Name : sudo
Product : Fedora 38
Version : 1.9.15
Release : 1.p5.fc38
URL : <https://www.sudo.ws>
Summary : Allows restricted root access for specified users
Description :
Sudo (superuser do) allows a system administrator to give certain
users (or groups of users) the ability to run some (or all) commands
as root while logging all commands and arguments. Sudo operates on a
per-command basis. It is not a replacement for the shell. Features
include: the ability to restrict what commands a user may run on a
per-host basis, copious logging of each command (providing a clear
audit trail of who did what), a configurable timeout of the sudo
command, and the ability to use the same configuration file (sudoers)
on many different machines.

--------------------------------------------------------------------------------
Update Information:

Rabase to 1.9.15p5
--------------------------------------------------------------------------------
ChangeLog:

\* Wed Jan 24 2024 Radovan Sroka rsroka@redhat.com - 1.9.15-1
- Rabase to 1.9.15p5
- sudo-1\_9\_15p5 is available Resolves: rhbz#2248505
- TRIAGE CVE-2023-42465 sudo: Targeted Corruption of Register and Stack
Variables Resolves: rhbz#2255569
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2248505 - sudo-1\_9\_15p5 is available
<https://bugzilla.redhat.com/show_bug.cgi?id=2248505>
[ 2 ] Bug #2255569 - TRIAGE CVE-2023-42465 sudo: Targeted Corruption of Register and Stack Variables [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2255569>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-6fa5af9ea8' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/R4Q23NHCKCLFIHSNY6KJ27GM7FSCEVXM/#R4Q23NHCKCLFIHSNY6KJ27GM7FSCEVXM)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from bugs.gentoo.org_be01b43b_20250115_213257.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 9
Courier-imap SSL support doesn't seem to be working
Last modified: 2002-01-07 17:46:31 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=9&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=9&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 9**](show_bug.cgi?id=9)
- Courier-imap SSL support doesn't seem to be working

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Courier-imap SSL support doesn't seem to be working

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Linux | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Linux "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | [OLD] Server ([show other bugs](buglist.cgi?component=%5BOLD%5D%20Server&product=Gentoo%20Linux&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High minor | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Grant Goodyear (RETIRED) | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2002-01-04 09:17 UTC by Grant Goodyear (RETIRED) | | --- | --- | | Modified: | 2002-01-07 17:46 UTC ([History](show_activity.cgi?id=9)) | | CC List: | 0 users | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=9&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=9&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Grant Goodyear (RETIRED)   gentoo-dev  2002-01-04 09:17:36 UTC  ``` Following the desktop guide I can get courier-imap working just fine, but neither Hallski nor I can seem to get courier-imap working w/ SSL. ```  [Comment 1](#c1)  Grant Goodyear (RETIRED)   gentoo-dev  2002-01-06 17:40:11 UTC  ``` Upgraded to the latest courier-imap (1.4.1); problem didn't go away.  ```  [Comment 2](#c2)  Grant Goodyear (RETIRED)   gentoo-dev  2002-01-07 17:02:57 UTC  ``` Found the problem. Workaround until I make a new ebuild:  edit /usr/lib/courier-imap/imapd-ssl.rc and change "Maildir" on line 44 to read ${MAILDIR} instead, then /etc/init.d/courier-imap-ssl restart.  Changed severity to minor now that there's a workaround. ```  [Comment 3](#c3)  Grant Goodyear (RETIRED)   gentoo-dev  2002-01-07 17:46:31 UTC  ``` New ebuild that fixes the problem. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=9)
* - [XML](show_bug.cgi?ctype=xml&id=9)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=9)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=9&product=Gentoo%20Linux)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=9&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=9&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugzilla.redhat.com_22c585bf_20250115_213304.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2248505)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2248505)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2248505)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 2248505

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 2248505**](show_bug.cgi?id=2248505)
- sudo-1\_9\_15p5 is available

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
sudo-1\_9\_15p5 is available

| | [Keywords](describekeywords.cgi): | FutureFeature  Triaged | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | sudo | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | rawhide | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Radovan Sroka | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=2248505&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2248505&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2023-11-07 12:42 UTC by Upstream Release Monitoring | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2024-02-18 01:49 UTC ([History](show_activity.cgi?id=2248505)) | | [CC List:](page.cgi?id=fields.html#cclist) | 5 users (show)  alakatos kzak mattdm rsroka zfridric | | Fixed In Version: | sudo-1.9.15-1.p5.fc40 sudo-1.9.15-1.p5.fc39 sudo-1.9.15-1.p5.fc38 | | | Doc Type: | --- | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2024-01-24 23:00:14 UTC | | | Type: | --- | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Update to 1\_9\_15 (#2248505)**](attachment.cgi?id=1997607 "View the content of the attachment") (645 bytes, patch)  [2023-11-07 12:42 UTC](#attach_1997607 "Go to the comment associated with the attachment"), Upstream Release Monitoring | *no flags* | [Details](attachment.cgi?id=1997607&action=edit) | [Diff](attachment.cgi?id=1997607&action=diff) | | [**Update to 1\_9\_15p2 (#2248505)**](attachment.cgi?id=1998475 "View the content of the attachment") (650 bytes, patch)  [2023-11-10 20:00 UTC](#attach_1998475 "Go to the comment associated with the attachment"), Upstream Release Monitoring | *no flags* | [Details](attachment.cgi?id=1998475&action=edit) | [Diff](attachment.cgi?id=1998475&action=diff) | | [**Update to 1\_9\_15p3 (#2248505)**](attachment.cgi?id=2004296 "View the content of the attachment") (650 bytes, patch)  [2023-12-14 13:52 UTC](#attach_2004296 "Go to the comment associated with the attachment"), Upstream Release Monitoring | *no flags* | [Details](attachment.cgi?id=2004296&action=edit) | [Diff](attachment.cgi?id=2004296&action=diff) | | [**Update to 1\_9\_15p4 (#2248505)**](attachment.cgi?id=2004563 "View the content of the attachment") (650 bytes, patch)  [2023-12-16 10:00 UTC](#attach_2004563 "Go to the comment associated with the attachment"), Upstream Release Monitoring | *no flags* | [Details](attachment.cgi?id=2004563&action=edit) | [Diff](attachment.cgi?id=2004563&action=diff) | | [**Update to 1\_9\_15p5 (#2248505)**](attachment.cgi?id=2006704 "View the content of the attachment") (650 bytes, patch)  [2023-12-31 23:19 UTC](#attach_2006704 "Go to the comment associated with the attachment"), Upstream Release Monitoring | *no flags* | [Details](attachment.cgi?id=2006704&action=edit) | [Diff](attachment.cgi?id=2006704&action=diff) | | [View All](attachment.cgi?bugid=2248505&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2248505#c0)  Upstream Release Monitoring    2023-11-07 12:42:11 UTC  ``` Releases retrieved: 1_9_15 Upstream release that is considered latest: 1_9_15 Current version/release in rawhide: 1.9.14-1.p3.fc39 URL: <https://www.sudo.ws>  Please consult the package updates policy before you issue an update to a stable branch: <https://docs.fedoraproject.org/en-US/fesco/Updates_Policy/>   More information about the service that created this bug can be found at: <https://docs.fedoraproject.org/en-US/package-maintainers/Upstream_Release_Monitoring>   Please keep in mind that with any upstream change, there may also be packaging changes that need to be made. Specifically, please remember that it is your responsibility to review the new version to ensure that the licensing is still correct and that no non-free or legally problematic items have been added upstream.   Based on the information from Anitya: <https://release-monitoring.org/project/4906/>   To change the monitoring settings for the project, please visit: <https://src.fedoraproject.org/rpms/sudo>   ```  [Comment 1](show_bug.cgi?id=2248505#c1)  Upstream Release Monitoring    2023-11-07 12:42:17 UTC  ``` Scratch build failed. Details below:  BuilderException: Build failed: Command '['rpmbuild', '-D', '_sourcedir .', '-D', '_topdir .', '-bs', '/var/tmp/thn-rcva7a72/sudo.spec']' returned non-zero exit status 1.  StdOut: setting SOURCE_DATE_EPOCH=1699315200 error: Bad file: ./sudo-1_9_15p3.tar.gz: No such file or directory  RPM build errors:     Bad file: ./sudo-1_9_15p3.tar.gz: No such file or directory   Traceback:   File "/usr/local/lib/python3.11/site-packages/hotness/use_cases/package_scratch_build_use_case.py", line 56, in build     result = self.builder.build(request.package, request.opts)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File "/usr/local/lib/python3.11/site-packages/hotness/builders/koji.py", line 229, in build     raise BuilderException(  If you think this issue is caused by some bug in the-new-hotness, please report it on the-new-hotness issue tracker: <https://github.com/fedora-infra/the-new-hotness/issues>   ```  [Comment 2](show_bug.cgi?id=2248505#c2)  Upstream Release Monitoring    2023-11-07 12:42:18 UTC  ``` Created [attachment 1997607](attachment.cgi?id=1997607&action=diff "Update to 1_9_15 (#2248505)") [[details]](attachment.cgi?id=1997607&action=edit "Update to 1_9_15 (#2248505)") Update to 1_9_15 (#2248505)   ```  [Comment 3](show_bug.cgi?id=2248505#c3)  Upstream Release Monitoring    2023-11-10 20:00:50 UTC  ``` Releases retrieved: 1_9_15p1, 1_9_15p2 Upstream release that is considered latest: 1_9_15p2 Current version/release in rawhide: 1.9.14-1.p3.fc39 URL: <https://www.sudo.ws>  Please consult the package updates policy before you issue an update to a stable branch: <https://docs.fedoraproject.org/en-US/fesco/Updates_Policy/>   More information about the service that created this bug can be found at: <https://docs.fedoraproject.org/en-US/package-maintainers/Upstream_Release_Monitoring>   Please keep in mind that with any upstream change, there may also be packaging changes that need to be made. Specifically, please remember that it is your responsibility to review the new version to ensure that the licensing is still correct and that no non-free or legally problematic items have been added upstream.   Based on the information from Anitya: <https://release-monitoring.org/project/4906/>   To change the monitoring settings for the project, please visit: <https://src.fedoraproject.org/rpms/sudo>   ```  [Comment 4](show_bug.cgi?id=2248505#c4)  Upstream Release Monitoring    2023-11-10 20:00:54 UTC  ``` Scratch build failed. Details below:  BuilderException: Build failed: Command '['rpmbuild', '-D', '_sourcedir .', '-D', '_topdir .', '-bs', '/var/tmp/thn-fdmypl_u/sudo.spec']' returned non-zero exit status 1.  StdOut: setting SOURCE_DATE_EPOCH=1699574400 error: Bad file: ./sudo-1_9_15p2p3.tar.gz: No such file or directory  RPM build errors:     Bad file: ./sudo-1_9_15p2p3.tar.gz: No such file or directory   Traceback:   File "/usr/local/lib/python3.11/site-packages/hotness/use_cases/package_scratch_build_use_case.py", line 56, in build     result = self.builder.build(request.package, request.opts)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File "/usr/local/lib/python3.11/site-packages/hotness/builders/koji.py", line 229, in build     raise BuilderException(  If you think this issue is caused by some bug in the-new-hotness, please report it on the-new-hotness issue tracker: <https://github.com/fedora-infra/the-new-hotness/issues>   ```  [Comment 5](show_bug.cgi?id=2248505#c5)  Upstream Release Monitoring    2023-11-10 20:00:55 UTC  ``` Created [attachment 1998475](attachment.cgi?id=1998475&action=diff "Update to 1_9_15p2 (#2248505)") [[details]](attachment.cgi?id=1998475&action=edit "Update to 1_9_15p2 (#2248505)") Update to 1_9_15p2 (#2248505)   ```  [Comment 6](show_bug.cgi?id=2248505#c6)  Upstream Release Monitoring    2023-12-14 13:52:28 UTC  ``` Releases retrieved: 1_9_15p3 Upstream release that is considered latest: 1_9_15p3 Current version/release in rawhide: 1.9.14-1.p3.fc39 URL: <https://www.sudo.ws>  Please consult the package updates policy before you issue an update to a stable branch: <https://docs.fedoraproject.org/en-US/fesco/Updates_Policy/>   More information about the service that created this bug can be found at: <https://docs.fedoraproject.org/en-US/package-maintainers/Upstream_Release_Monitoring>   Please keep in mind that with any upstream change, there may also be packaging changes that need to be made. Specifically, please remember that it is your responsibility to review the new version to ensure that the licensing is still correct and that no non-free or legally problematic items have been added upstream.   Based on the information from Anitya: <https://release-monitoring.org/project/4906/>   To change the monitoring settings for the project, please visit: <https://src.fedoraproject.org/rpms/sudo>   ```  [Comment 7](show_bug.cgi?id=2248505#c7)  Upstream Release Monitoring    2023-12-14 13:52:33 UTC  ``` Scratch build failed. Details below:  BuilderException: Build failed: Command '['rpmbuild', '-D', '_sourcedir .', '-D', '_topdir .', '-bs', '/var/tmp/thn-hav11dqy/sudo.spec']' returned non-zero exit status 1.  StdOut: setting SOURCE_DATE_EPOCH=1702512000 error: Bad file: ./sudo-1_9_15p3p3.tar.gz: No such file or directory  RPM build errors:     Bad file: ./sudo-1_9_15p3p3.tar.gz: No such file or directory   Traceback:   File "/usr/local/lib/python3.11/site-packages/hotness/use_cases/package_scratch_build_use_case.py", line 56, in build     result = self.builder.build(request.package, request.opts)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File "/usr/local/lib/python3.11/site-packages/hotness/builders/koji.py", line 229, in build     raise BuilderException(  If you think this issue is caused by some bug in the-new-hotness, please report it on the-new-hotness issue tracker: <https://github.com/fedora-infra/the-new-hotness/issues>   ```  [Comment 8](show_bug.cgi?id=2248505#c8)  Upstream Release Monitoring    2023-12-14 13:52:34 UTC  ``` Created [attachment 2004296](attachment.cgi?id=2004296&action=diff "Update to 1_9_15p3 (#2248505)") [[details]](attachment.cgi?id=2004296&action=edit "Update to 1_9_15p3 (#2248505)") Update to 1_9_15p3 (#2248505)   ```  [Comment 9](show_bug.cgi?id=2248505#c9)  Upstream Release Monitoring    2023-12-16 10:00:24 UTC  ``` Releases retrieved: 1_9_15p4 Upstream release that is considered latest: 1_9_15p4 Current version/release in rawhide: 1.9.14-1.p3.fc39 URL: <https://www.sudo.ws>  Please consult the package updates policy before you issue an update to a stable branch: <https://docs.fedoraproject.org/en-US/fesco/Updates_Policy/>   More information about the service that created this bug can be found at: <https://docs.fedoraproject.org/en-US/package-maintainers/Upstream_Release_Monitoring>   Please keep in mind that with any upstream change, there may also be packaging changes that need to be made. Specifically, please remember that it is your responsibility to review the new version to ensure that the licensing is still correct and that no non-free or legally problematic items have been added upstream.   Based on the information from Anitya: <https://release-monitoring.org/project/4906/>   To change the monitoring settings for the project, please visit: <https://src.fedoraproject.org/rpms/sudo>   ```  [Comment 10](show_bug.cgi?id=2248505#c10)  Upstream Release Monitoring    2023-12-16 10:00:29 UTC  ``` Scratch build failed. Details below:  BuilderException: Build failed: Command '['rpmbuild', '-D', '_sourcedir .', '-D', '_topdir .', '-bs', '/var/tmp/thn-2krjei6z/sudo.spec']' returned non-zero exit status 1.  StdOut: setting SOURCE_DATE_EPOCH=1702684800 error: Bad file: ./sudo-1_9_15p4p3.tar.gz: No such file or directory  RPM build errors:     Bad file: ./sudo-1_9_15p4p3.tar.gz: No such file or directory   Traceback:   File "/usr/local/lib/python3.11/site-packages/hotness/use_cases/package_scratch_build_use_case.py", line 56, in build     result = self.builder.build(request.package, request.opts)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File "/usr/local/lib/python3.11/site-packages/hotness/builders/koji.py", line 229, in build     raise BuilderException(  If you think this issue is caused by some bug in the-new-hotness, please report it on the-new-hotness issue tracker: <https://github.com/fedora-infra/the-new-hotness/issues>   ```  [Comment 11](show_bug.cgi?id=2248505#c11)  Upstream Release Monitoring    2023-12-16 10:00:30 UTC  ``` Created [attachment 2004563](attachment.cgi?id=2004563&action=diff "Update to 1_9_15p4 (#2248505)") [[details]](attachment.cgi?id=2004563&action=edit "Update to 1_9_15p4 (#2248505)") Update to 1_9_15p4 (#2248505)   ```  [Comment 12](show_bug.cgi?id=2248505#c12)  Upstream Release Monitoring    2023-12-31 23:18:58 UTC  ``` Releases retrieved: 1_9_15p5 Upstream release that is considered latest: 1_9_15p5 Current version/release in rawhide: 1.9.14-1.p3.fc39 URL: <https://www.sudo.ws>  Please consult the package updates policy before you issue an update to a stable branch: <https://docs.fedoraproject.org/en-US/fesco/Updates_Policy/>   More information about the service that created this bug can be found at: <https://docs.fedoraproject.org/en-US/package-maintainers/Upstream_Release_Monitoring>   Please keep in mind that with any upstream change, there may also be packaging changes that need to be made. Specifically, please remember that it is your responsibility to review the new version to ensure that the licensing is still correct and that no non-free or legally problematic items have been added upstream.   Based on the information from Anitya: <https://release-monitoring.org/project/4906/>   To change the monitoring settings for the project, please visit: <https://src.fedoraproject.org/rpms/sudo>   ```  [Comment 13](show_bug.cgi?id=2248505#c13)  Upstream Release Monitoring    2023-12-31 23:19:01 UTC  ``` Scratch build failed. Details below:  BuilderException: Build failed: Command '['rpmbuild', '-D', '_sourcedir .', '-D', '_topdir .', '-bs', '/var/tmp/thn-nxikhuh0/sudo.spec']' returned non-zero exit status 1.  StdOut: setting SOURCE_DATE_EPOCH=1703980800 error: Bad file: ./sudo-1_9_15p5p3.tar.gz: No such file or directory  RPM build errors:     Bad file: ./sudo-1_9_15p5p3.tar.gz: No such file or directory   Traceback:   File "/usr/local/lib/python3.11/site-packages/hotness/use_cases/package_scratch_build_use_case.py", line 56, in build     result = self.builder.build(request.package, request.opts)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File "/usr/local/lib/python3.11/site-packages/hotness/builders/koji.py", line 229, in build     raise BuilderException(  If you think this issue is caused by some bug in the-new-hotness, please report it on the-new-hotness issue tracker: <https://github.com/fedora-infra/the-new-hotness/issues>   ```  [Comment 14](show_bug.cgi?id=2248505#c14)  Upstream Release Monitoring    2023-12-31 23:19:03 UTC  ``` Created [attachment 2006704](attachment.cgi?id=2006704&action=diff "Update to 1_9_15p5 (#2248505)") [[details]](attachment.cgi?id=2006704&action=edit "Update to 1_9_15p5 (#2248505)") Update to 1_9_15p5 (#2248505)   ```  [Comment 15](show_bug.cgi?id=2248505#c15)  Fedora Update System    2024-01-24 10:21:07 UTC  ``` FEDORA-2024-57eebd0963 has been submitted as an update to Fedora 40. <https://bodhi.fedoraproject.org/updates/FEDORA-2024-57eebd0963>   ```  [Comment 16](show_bug.cgi?id=2248505#c16)  Fedora Update System    2024-01-24 10:48:47 UTC  ``` FEDORA-2024-cdccda4f62 has been submitted as an update to Fedora 39. <https://bodhi.fedoraproject.org/updates/FEDORA-2024-cdccda4f62>   ```  [Comment 17](show_bug.cgi?id=2248505#c17)  Fedora Update System    2024-01-24 10:50:13 UTC  ``` FEDORA-2024-6fa5af9ea8 has been submitted as an update to Fedora 38. <https://bodhi.fedoraproject.org/updates/FEDORA-2024-6fa5af9ea8>   ```  [Comment 18](show_bug.cgi?id=2248505#c18)  Fedora Update System    2024-01-24 23:00:14 UTC  ``` FEDORA-2024-57eebd0963 has been pushed to the Fedora 40 stable repository. If problem still persists, please make note of it in this bug report.   ```  [Comment 19](show_bug.cgi?id=2248505#c19)  Fedora Update System    2024-01-25 01:11:46 UTC  ``` FEDORA-2024-6fa5af9ea8 has been pushed to the Fedora 38 testing repository. Soon you'll be able to install the update with the following command: `sudo dnf upgrade --enablerepo=updates-testing --refresh --advisory=FEDORA-2024-6fa5af9ea8` You can provide feedback for this update here: <https://bodhi.fedoraproject.org/updates/FEDORA-2024-6fa5af9ea8>  See also [https://fedoraproject.org/wiki/QA:Updates_Testing](https://fedoraproject.org/wiki/QA%3AUpdates_Testing) for more information on how to test updates.   ```  [Comment 20](show_bug.cgi?id=2248505#c20)  Fedora Update System    2024-01-25 01:11:59 UTC  ``` FEDORA-2024-cdccda4f62 has been pushed to the Fedora 39 testing repository. Soon you'll be able to install the update with the following command: `sudo dnf upgrade --enablerepo=updates-testing --refresh --advisory=FEDORA-2024-cdccda4f62` You can provide feedback for this update here: <https://bodhi.fedoraproject.org/updates/FEDORA-2024-cdccda4f62>  See also [https://fedoraproject.org/wiki/QA:Updates_Testing](https://fedoraproject.org/wiki/QA%3AUpdates_Testing) for more information on how to test updates.   ```  [Comment 21](show_bug.cgi?id=2248505#c21)  Fedora Update System    2024-01-28 03:08:43 UTC  ``` FEDORA-2024-cdccda4f62 has been pushed to the Fedora 39 stable repository. If problem still persists, please make note of it in this bug report.   ```  [Comment 22](show_bug.cgi?id=2248505#c22)  Fedora Update System    2024-02-18 01:49:33 UTC  ``` FEDORA-2024-6fa5af9ea8 (sudo-1.9.15-1.p5.fc38) has been pushed to the Fedora 38 stable repository. If problem still persists, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2248505&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from github.com_8f39fea5_20250115_082318.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsudo-project%2Fsudo%2Freleases%2Ftag%2FSUDO_1_9_15)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsudo-project%2Fsudo%2Freleases%2Ftag%2FSUDO_1_9_15)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=sudo-project%2Fsudo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sudo-project](/sudo-project)
/
**[sudo](/sudo-project/sudo)**
Public

* [Notifications](/login?return_to=%2Fsudo-project%2Fsudo) You must be signed in to change notification settings
* [Fork
  226](/login?return_to=%2Fsudo-project%2Fsudo)
* [Star
   1.2k](/login?return_to=%2Fsudo-project%2Fsudo)

* [Code](/sudo-project/sudo/tree/SUDO_1_9_15)
* [Issues
  25](/sudo-project/sudo/issues)
* [Pull requests
  2](/sudo-project/sudo/pulls)
* [Actions](/sudo-project/sudo/actions)
* [Projects
  0](/sudo-project/sudo/projects)
* [Security](/sudo-project/sudo/security)
* [Insights](/sudo-project/sudo/pulse)

Additional navigation options

* [Code](/sudo-project/sudo/tree/SUDO_1_9_15)
* [Issues](/sudo-project/sudo/issues)
* [Pull requests](/sudo-project/sudo/pulls)
* [Actions](/sudo-project/sudo/actions)
* [Projects](/sudo-project/sudo/projects)
* [Security](/sudo-project/sudo/security)
* [Insights](/sudo-project/sudo/pulse)

1. [Releases](/sudo-project/sudo/releases)
2. [SUDO\_1\_9\_15](/sudo-project/sudo/releases/tag/SUDO_1_9_15)

# Sudo 1.9.15

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/sudo-project/sudo/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...SUDO_1_9_15)

 Loading

[View all tags](/sudo-project/sudo/tags)

![@millert](https://avatars.githubusercontent.com/u/348203?s=40&v=4)
[millert](/millert)
released this
06 Nov 17:52

·
[219 commits](/sudo-project/sudo/compare/SUDO_1_9_15...main)
to main
since this release

[SUDO\_1\_9\_15](/sudo-project/sudo/tree/SUDO_1_9_15)

[`f7ae17d`](/sudo-project/sudo/commit/f7ae17d3d3281514b673ebb33aa72b990049c378)

* Fixed an undefined symbol problem on older versions of macOS when *intercept* or *log\_subcmds* are enabled in sudoers. [GitHub issue #276](https://github.com/sudo-project/sudo/issues/276).
* Fixed `make check` failure related to **getpwent**(3) wrapping on NetBSD.
* Fixed the warning message for `sudo -l command` when the command is not permitted. There was a missing space between "list" and the actual command due to changes in sudo 1.9.14.
* Fixed a bug where output could go to the wrong terminal if *use\_pty* is enabled (the default) and the standard input, output or error is redirected to a different terminal. [Bug #1056](https://bugzilla.sudo.ws/show_bug.cgi?id=1056).
* The `visudo` utility will no longer create an empty file when the specified sudoers file does not exist and the user exits the editor without making any changes. [GitHub issue #294](https://github.com/sudo-project/sudo/issues/294).
* The AIX and Solaris sudo packages on [www.sudo.ws](http://www.sudo.ws) now support *log\_subcmds* and *intercept* with both 32-bit and 64-bit binaries. Previously, they only worked when running binaries with the same word size as the sudo binary. [GitHub issue #289](https://github.com/sudo-project/sudo/issues/289).
* The sudoers source is now logged in the JSON event log. This makes it possible to tell which rule resulted in a match.
* Running `sudo -ll command` now produces verbose output that includes matching rule as well as the path to the sudoers file the matching rule came from. For LDAP sudoers, the name of the matching sudoRole is printed instead.
* The embedded copy of zlib has been updated to version 1.3.
* The sudoers plugin has been modified to make it more resilient to ROWHAMMER attacks on authentication and policy matching. This addresses [CVE-2023-42465](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2023-42465).
* The sudoers plugin now constructs the user time stamp file path name using the user-ID instead of the user name. This avoids a potential problem with user names that contain a path separator ('/') being interpreted as part of the path name. A similar issue in sudo-rs has been assigned [CVE-2023-42456](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2023-42456).
* A path separator ('/') in a user, group or host name is now replaced with an underbar character ('\_') when expanding escapes in `@include` and `@includedir` directives as well as the *iolog\_file* and *iolog\_dir* sudoers Default settings.
* The *intercept\_verify* sudoers option is now only applied when the *intercept* option is set in sudoers. Previously, it was also applied when *log\_subcmds* was enabled. Sudo 1.9.14 contained an incorrect fix for this. [Bug #1058](https://bugzilla.sudo.ws/show_bug.cgi?id=1058).
* Changes to terminal settings are now performed atomically, where possible. If the command is being run in a pseudo-terminal and the user's terminal is already in raw mode, sudo will not change the user's terminal settings. This prevents concurrent sudo processes from restoring the terminal settings to the wrong values. [GitHub issue #312](https://github.com/sudo-project/sudo/issues/312).
* Reverted a change from sudo 1.9.4 that resulted in PAM session modules being called with the environment of the command to be run instead of the environment of the invoking user. GitHub issue [#318](https://github.com/sudo-project/sudo/issues/318).
* New Indonesian translation from [translationproject.org](https://translationproject.org).
* The `sudo_logsrvd` server will now raise its open file descriptor limit to the maximum allowed value when it starts up. Each connection can require up to nine open file descriptors so the default soft limit may be too low.
* Better log message when rejecting a command if the *intercept* option is enabled and the *intercept\_allow\_setid* option is disabled. Previously, "command not allowed" would be logged and the user had no way of knowing what the actual problem was.
* Sudo will now log the invoking user's environment as *submitenv* in the JSON logs. The command's environment (*runenv*) is no longer logged for commands rejected by the sudoers file or an approval plugin.

 Assets
121

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.sudo.ws_d3b7edf6_20250115_082418.html ===


Open Navigation

Close Navigation

[Sudo](https://www.sudo.ws/)

[GitHub](https://github.com/sudo-project/sudo%20%20%20%20%20%20%20%20%20%20%20%20)

[Blog](/posts/%20%20%20%20%20%20%20%20%20%20%20%20)

Toggle Dark/Light/Auto mode

Toggle Dark/Light/Auto mode

Toggle Dark/Light/Auto mode

[Back to homepage](https://www.sudo.ws/)

Close Menu Bar

Open Menu Bar

[![Sudo Logo](/images/sudo-sandwich-logo-65.png)](/)

* About Sudo
  + [A Short Introduction](/about/intro/)
  + [A Brief History of Sudo](/about/history/)
  + [Contributors](/about/contributors/)
  + [Translations](/about/translations/)
  + [Sudo Plugins](/about/plugins/)
  + [Sudo License](/about/license/)
  + [Sudo Logo](/about/logo/)
  + [Export Controls](/about/export/)
* Releases
  + [Stable Release](/releases/stable/)
  + [Legacy Release](/releases/legacy/)
  + [Development Release](/releases/devel/)
  + [ChangeLog](/releases/changelog/)
* Getting Sudo
  + [Source Repo](/getting/repo/)
  + [Source Distribution](/getting/source/)
  + [Prebuilt Packages](/getting/packages/)
  + [Download Mirrors](/getting/download_mirrors/)
  + [Mirroring Sudo](/getting/mirror/)
* Documentation
  + Manual Pages (latest)

    - [Cvtsudoers Manual](/docs/man/cvtsudoers.man/)
    - [Sudo Configuration Manual](/docs/man/sudo.conf.man/)
    - [Sudo Log Client Manual](/docs/man/sudo_sendlog.man/)
    - [Sudo Log Server Configuration Manual](/docs/man/sudo_logsrvd.conf.man/)
    - [Sudo Log Server Manual](/docs/man/sudo_logsrvd.man/)
    - [Sudo Log Server Protocol Manual](/docs/man/sudo_logsrv.proto.man/)
    - [Sudo Manual](/docs/man/sudo.man/)
    - [Sudo Plugin API](/docs/man/sudo_plugin.man/)
    - [Sudo Python Plugin API](/docs/man/sudo_plugin_python.man/)
    - [Sudoers LDAP Manual](/docs/man/sudoers.ldap.man/)
    - [Sudoers Manual](/docs/man/sudoers.man/)
    - [Sudoers Time Stamp Manual](/docs/man/sudoers_timestamp.man/)
    - [Sudoreplay Manual](/docs/man/sudoreplay.man/)
    - [Visudo Manual](/docs/man/visudo.man/)
  + [Manual Pages (all versions)](/docs/man_all/)
  + README Files

    - [README](/docs/readme/readme/)
    - [README.LDAP](/docs/readme/readme_ldap/)
  + [Sudo Installation Notes](/docs/install/)
  + [Sudo Upgrade Notes](/docs/upgrade/)
  + [Contributing to Sudo](/docs/contributing/)
  + [Troubleshooting FAQ](/docs/troubleshooting/)
  + [Building Sudo Packages](/docs/packaging/)
  + [Other Documentation](/docs/other/)
  + [Sudo Alternatives](/docs/alternatives/)
* Security
  + [Security Advisories](/security/advisories/)
  + [Security Policy](/security/policy/)
  + [Static Analysis](/security/static_analysis/)
  + [Fuzzing Sudo](/security/fuzzing/)
  + [Sanitizers and Sudo](/security/sanitizers/)

* [Blog](/posts)
* [Bug Tracker](https://bugzilla.sudo.ws)
* [News](/news)
* [Mailing Lists](/lists)
* [GitHub Repo](https://github.com/sudo-project/sudo)
* [Mercurial Repo](https://www.sudo.ws/repos/sudo)
* [Mastodon](https://fosstodon.org/%40sudoproject)
* [Sudo Mastery Book](https://mwl.io/nonfiction/tools#sudo2)

# ChangeLog

2025-01-05 Todd C. Miller

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c:

  Format T\_TIMESPEC as “%d.%d” instead of “%.1f”

  This fixes the display of the timeout values in the “sudo -V” output on
  systems without a C99-compliant snprintf(). The snprintf() replacement
  sudo ships with does not support floating point.
  [[01b1410d6]](https://git.sudo.ws/sudo/commit/?id=01b1410d6)

2024-12-22 vayers

* plugins/sudoers/sudoers.in:

  Replace tab with space

  A line in the sudoers file contains a tab where a space seems to be more
  appropriate.
  [[7c121ff83]](https://git.sudo.ws/sudo/commit/?id=7c121ff83)

2025-01-04 Todd C. Miller

* configure, configure.ac:

  Newer macOS deprecates -force\_flat\_namespace for -flat\_namespace

  The linker warns about -force-flat\_namespace and uses -flat\_namespace
  instead. Check for -flat\_namespace if -force-flat\_namespace is not
  found.
  [[103af8cb2]](https://git.sudo.ws/sudo/commit/?id=103af8cb2)

* scripts/build\_pkgs:

  build\_pkgs: adapt to work with a git repo
  [[46831d6ef]](https://git.sudo.ws/sudo/commit/?id=46831d6ef)

* scripts/log2cl.pl:

  Remove unused -b option
  [[b52ef1fbb]](https://git.sudo.ws/sudo/commit/?id=b52ef1fbb)

2025-01-03 Todd C. Miller

* aclocal.m4, configure, m4/libtool.m4, m4/ltoptions.m4, m4/ltsugar.m4,
  m4/ltversion.m4, m4/lt~obsolete.m4, scripts/ltmain.sh:

  Update to libtool 2.5.3
  [[355c82a1d]](https://git.sudo.ws/sudo/commit/?id=355c82a1d)

2025-01-01 Todd C. Miller

* scripts/log2cl.pl:

  Add markdown mode for use with the sudo web site.
  [[e13163ce0]](https://git.sudo.ws/sudo/commit/?id=e13163ce0)

2024-12-27 Todd C. Miller

* scripts/log2cl.pl:

  Use Text::Wrap::fill() for ChangeLog body, not wrap().
  [[a3c1cbd88]](https://git.sudo.ws/sudo/commit/?id=a3c1cbd88)

2024-12-20 Todd C. Miller

* docs/sudo\_sendlog.man.in, docs/sudo\_sendlog.mdoc.in:

  Sort entries in the “SEE ALSO” section.
  [[e670d2a85]](https://git.sudo.ws/sudo/commit/?id=e670d2a85)

* docs/sudo.man.in, docs/sudo.mdoc.in, src/tgetpass.c:

  If sudo is run without a tty via ssh, suggest using “ssh -t”

  The current warning message mentions using sudo’s -S option but this
  will cause the password to be echoed without a terminal. In most cases,
  the user just needs to run ssh with the -t option.
  [[516f72960]](https://git.sudo.ws/sudo/commit/?id=516f72960)

* plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y:

  The “ALL” command should not override a previous NOSETENV tag in a rule.

  Command tags are inherited from previous Cmnds in a Cmnd\_Spec\_List.
  There is a special case of the SETENV tag for the “ALL” command, where
  SETENV is implied if no explicit SETENV or NOSETENV tag is specified.
  The code to inherit the SETENV tag didn’t take into account that an
  implied value for SETENV should also be overridden by an explicit SETENV
  or NOSETENV tag in the previous Cmnd in the Cmnd\_Spec\_List.
  [[4dbb07c19]](https://git.sudo.ws/sudo/commit/?id=4dbb07c19)

2024-12-01 Todd C. Miller

* Makefile.in, lib/eventlog/Makefile.in, lib/fuzzstub/Makefile.in,
  lib/iolog/Makefile.in, lib/logsrv/Makefile.in,
  lib/protobuf-c/Makefile.in, lib/ssl\_compat/Makefile.in,
  lib/util/Makefile.in, logsrvd/Makefile.in,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/python/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_approval/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Don’t need to undef \_POSIX\_HOST\_NAME\_MAX, it is not used.
  [[de3b179a0]](https://git.sudo.ws/sudo/commit/?id=de3b179a0)

2024-11-29 Todd C. Miller

* etc/codespell.ignore, src/exec\_ptrace.h:

  Quiet codespell 2.3.0 complaints.
  [[3226c60e6]](https://git.sudo.ws/sudo/commit/?id=3226c60e6)

2024-11-28 Todd C. Miller

* include/sudo\_compat.h, lib/util/ttyname\_dev.c, plugins/sudoers/policy.c,
  plugins/sudoers/timestamp.c, src/regress/ttyname/check\_ttyname.c,
  src/sudo.c, src/ttyname.c:

  Use NODEV macro instead of explicit (dev\_t)-1.

  Also fix an assignment of dev\_t to -1 that should be NODEV. [Bug
  #1074](https://bugzilla.sudo.ws/show_bug.cgi?id=1074).
  [[d5028a00c]](https://git.sudo.ws/sudo/commit/?id=d5028a00c)

2024-11-25 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.16p2
  [[73cbe4e7e]](https://git.sudo.ws/sudo/commit/?id=73cbe4e7e)

2024-11-18 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Work around a bug in UBSan that is causing CI failures.

  <https://gcc.gnu.org/bugzilla/show_bug.cgi?id=116834>
  [[f8987fc0b]](https://git.sudo.ws/sudo/commit/?id=f8987fc0b)

2024-11-17 Todd C. Miller

* plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/pwutil\_impl.c:

  Avoid multiple calls to sysonf() via the MAX macro.

  The expansion of MAX would result in multiple calls to sysconf(). It is
  less error-prone to store the result of sysconf() in a long.
  [[da20ccec0]](https://git.sudo.ws/sudo/commit/?id=da20ccec0)

* lib/util/setgroups.c, plugins/sudoers/sudo\_printf.c, src/conversation.c:
  Add some casts to quiet -Wconversion
  [[3d85f2e98]](https://git.sudo.ws/sudo/commit/?id=3d85f2e98)

2024-11-16 Todd C. Miller

* include/sudo\_plugin.h, plugins/sudoers/policy.c, src/hooks.c:

  Cast hook functions to sudo\_hook\_fn\_t to fix C23 compile error.

  The sudo plugin API defines sudo\_hook\_fn\_t as a function with
  unspecified arguments. This is no longer supported in C23 so use a
  variadic function for sudo\_hook\_fn\_t instead. Moving to a union may be a
  better long-term fix. [GitHub issue
  #420](https://github.com/sudo-project/sudo/issues/420).
  [[9613ef944]](https://git.sudo.ws/sudo/commit/?id=9613ef944)

* lib/util/regress/parse\_gids/parse\_gids\_test.c:

  Use NULL, not false, in the terminating entry of test\_data[].
  [[4c99e29bb]](https://git.sudo.ws/sudo/commit/?id=4c99e29bb)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Pass NULL, not false, to sudoers\_format\_default\_line().
  [[9c63ff0e1]](https://git.sudo.ws/sudo/commit/?id=9c63ff0e1)

* lib/util/ttyname\_dev.c:

  sudo\_ttyname\_dev: On Linux try to use /proc/self/fd/{0,1,2} if possible.

  If one of std{in,out,err} matches the specified device, try to resolve
  it to a path by using /proc/self/fd/{0,1,2}. This avoids searching all
  of /dev and works in a chroot where /proc is mounted but /dev/pts is
  not. [GitHub issue
  #421](https://github.com/sudo-project/sudo/issues/421).
  [[b7efb8ab5]](https://git.sudo.ws/sudo/commit/?id=b7efb8ab5)

2024-11-15 Todd C. Miller

* src/sudo.c, src/ttyname.c:

  get\_process\_ttyname: always return the terminal device if we find one.

  If sudo cannot map the device number to a device file, set name to the
  empty string. The caller now checks for an empty name and only passes
  the tty path to the plugin if it is non-empty. This allows sudo to run
  without warnings in a chroot() jail where the terminal device files are
  not present. [GitHub issue
  #421](https://github.com/sudo-project/sudo/issues/421).
  [[7e8f00688]](https://git.sudo.ws/sudo/commit/?id=7e8f00688)

2024-11-12 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.16p1
  [[abc0baffc]](https://git.sudo.ws/sudo/commit/?id=abc0baffc)

2024-11-11 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  pam\_get\_item() takes a void \*\* arg, not const void \*\*, on Solaris
  [[0f41cd717]](https://git.sudo.ws/sudo/commit/?id=0f41cd717)

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Shell-style substitution is not supported in env\_file.

  Also document that comments are supported.
  [[8b5375716]](https://git.sudo.ws/sudo/commit/?id=8b5375716)

2024-10-29 Todd C. Miller

* plugins/sudoers/logging.c:

  Do not send mail for “sudo -nv” or “sudo -nl”

  This avoids sending mail for users running “sudo -nv” or “sudo -nl” even
  when mail\_badpass or mail\_always are enabled. We already avoid logging
  in that case but mailing was not disabled when that change was made.
  [Bug #1072](https://bugzilla.sudo.ws/show_bug.cgi?id=1072).
  [[116115229]](https://git.sudo.ws/sudo/commit/?id=116115229)

2024-10-28 Todd C. Miller

* NEWS, README.LDAP.md, docs/Makefile.in, docs/SECURITY.md,
  docs/TROUBLESHOOTING.md, docs/UPGRADE.md:

  Run igor on other docs too, not just man pages
  [[9d49f861c]](https://git.sudo.ws/sudo/commit/?id=9d49f861c)

* INSTALL.md, LICENSE.md, docs/CONTRIBUTING.md, docs/UPGRADE.md:

  Remove trailing whitespace
  [[5180dd802]](https://git.sudo.ws/sudo/commit/?id=5180dd802)

2024-10-28 Ikko Eltociear Ashimine

* NEWS:

  docs: update NEWS

  minor fix
  [[28df79a24]](https://git.sudo.ws/sudo/commit/?id=28df79a24)

2024-10-05 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  sudo\_pam\_verify: move PAM\_USER after getpass\_error check

  Move it into the PAM\_SUCCESS case of the switch \*pam\_status switch.
  [[17aa7688c]](https://git.sudo.ws/sudo/commit/?id=17aa7688c)

* plugins/sudoers/auth/pam.c:

  Fix indentation
  [[52c73b8f5]](https://git.sudo.ws/sudo/commit/?id=52c73b8f5)

2024-10-02 Marco Trevisan (TreviÃ±o)

* plugins/sudoers/auth/pam.c:

  plugins/pam: Check the user didn’t change during PAM transaction

  PAM modules can change the user during their execution, in such case,
  sudo would still use the user that has been provided giving potentially
  access to another user with the credentials of another one.

  So prevent this to happen, by ensuring that the final PAM user is
  matching the one which started the transaction
  [[a68e821ef]](https://git.sudo.ws/sudo/commit/?id=a68e821ef)

2024-09-28 CÃ©lestin Matte

* plugins/sudoers/sudoers.in:

  Fix typo in sudoer file comment
  [[05b5de538]](https://git.sudo.ws/sudo/commit/?id=05b5de538)

2024-09-21 Todd C. Miller

* INSTALL.md:

  Document “–with-secure-path-value=no”
  [[f6e1a87be]](https://git.sudo.ws/sudo/commit/?id=f6e1a87be)

2024-08-17 Rose

* plugins/sudoers/strvec\_join.c, plugins/sudoers/sudoers.h:

  Put restrict qualifers in strvec\_join function pointer
  [[77672d83c]](https://git.sudo.ws/sudo/commit/?id=77672d83c)

2024-09-17 Andy Fiddaman

* configure.ac, plugins/sudoers/sudoers.in:

  Allow –secure-path-value=no

  This adds support for –with-secure-path-value=no to allow packagers to
  ship the sudoers configuration file with the secure path line commented
  out if required.
  [[131e7e2de]](https://git.sudo.ws/sudo/commit/?id=131e7e2de)

2024-09-13 Todd C. Miller

* .github/workflows/main.yml:

  Update CIFuzz GitHub action
  [[ae5cf31a9]](https://git.sudo.ws/sudo/commit/?id=ae5cf31a9)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  alias\_error: display the file and line info for the duplicate alias

  Having the file and line of the previous alias definition should make it
  easier to fix duplicate alias errors.
  [[0cbddb693]](https://git.sudo.ws/sudo/commit/?id=0cbddb693)

2024-09-11 Todd C. Miller

* src/ttyname.c:

  On AIX, psinfo.pr\_ttydev is 0 when a process has no terminal. On most
  other systems, psinfo.pr\_ttydev is -1 for processes with no associated
  terminal. [GitHub issue
  #408](https://github.com/sudo-project/sudo/issues/408)
  [[d001abc8e]](https://git.sudo.ws/sudo/commit/?id=d001abc8e)

2024-09-10 Ferdinand Bachmann

* plugins/sudoers/sudoers.in:

  Add pam\_silent setting to sudoers example config
  [[ce36f01de]](https://git.sudo.ws/sudo/commit/?id=ce36f01de)

2024-09-09 Ferdinand Bachmann

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Fix version typo for pam\_silent option in sudoers man page
  [[915935ab6]](https://git.sudo.ws/sudo/commit/?id=915935ab6)

2024-09-06 Todd C. Miller

* lib/eventlog/eventlog.c, logsrvd/logsrvd\_local.c,
  plugins/sudoers/logging.c:

  Fix the date written used by the exit record in sudo-format log files

  The change to always get the current time when building a struct evlog
  in sudoers broke the data and time written for exit records. This only
  affected file-based logs, not syslog. [GitHub issue
  #405](https://github.com/sudo-project/sudo/issues/405).
  [[22b320645]](https://git.sudo.ws/sudo/commit/?id=22b320645)

2024-09-04 Arjen Lentz

* src/exec\_ptrace.c:

  Fixed typo in exec\_ptrace.c
  [[f47c88065]](https://git.sudo.ws/sudo/commit/?id=f47c88065)

2024-09-02 Todd C. Miller

* configure, configure.ac:

  Better test for cross-compiling when checking for C99 snprintf

  We want to avoid calling AX\_FUNC\_SNPRINTF entirely if cross-compiling
  since it is not possible to undo the setting of
  PREFER\_PORTABLE\_SNPRINTF. The previous attempt to do this failed to take
  into account that PREFER\_PORTABLE\_SNPRINTF would still be defined.
  [GitHub issue #969](https://github.com/sudo-project/sudo/issues/969)
  [[3e12cacc0]](https://git.sudo.ws/sudo/commit/?id=3e12cacc0)

2024-08-15 Todd C. Miller

* plugins/sudoers/policy.c:

  Make a ttydev parse error non-fatal for now

  This is new for sudo 1.9.16 so we don’t want to break sudo if there ends
  up being a bug in formatting dev\_t from the front-end.
  [[4751a4d2d]](https://git.sudo.ws/sudo/commit/?id=4751a4d2d)

2024-08-14 Todd C. Miller

* docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in:

  Document that ttydev is formatted as a long long.
  [[6a5a8f58e]](https://git.sudo.ws/sudo/commit/?id=6a5a8f58e)

* config.h.in, configure, configure.ac,
  src/regress/ttyname/check\_ttyname.c, src/sudo.c:

  Format ttydev as (signed) long long, not unsigned.

  Now that we parse ttydev as a long long it makes more sense to format it
  the same way. This completely avoids the sign extension issue on systems
  where dev\_t is signed.
  [[cc8c43c4d]](https://git.sudo.ws/sudo/commit/?id=cc8c43c4d)

2024-08-13 Todd C. Miller

* src/sudo.c:

  Fix sign compare warning

  Store the result of asprintf() in an int, not size\_t.
  [[6b90acbfb]](https://git.sudo.ws/sudo/commit/?id=6b90acbfb)

* config.h.in, configure, configure.ac,
  src/regress/ttyname/check\_ttyname.c, src/sudo.c:

  Fix formatting of ttydev on systems with signed 32-bit dev\_t

  If dev\_t is 32-bit and signed, formatting as an unsigned long long may
  result in a bogus value due to sign extension.
  [[46274e725]](https://git.sudo.ws/sudo/commit/?id=46274e725)

* src/regress/ttyname/check\_ttyname.c:

  get\_process\_ttyname() now returns a dev\_t, not a string.
  [[f3aa3f1f2]](https://git.sudo.ws/sudo/commit/?id=f3aa3f1f2)

2024-08-13 Rose

* include/compat/glob.h, lib/util/glob.c:

  Restrict-qualify glob and its functions

  glob is restrict-qualified in the standard
  [[e9e0096a1]](https://git.sudo.ws/sudo/commit/?id=e9e0096a1)

* include/sudo\_util.h, lib/util/hexchar.c:

  Restrict-qualify sudo\_hexchar\_v1

  sudo\_hexchar\_v1 requires an array of at least size-2, and is not
  aliased.
  [[82eac2b41]](https://git.sudo.ws/sudo/commit/?id=82eac2b41)

2024-08-13 Todd C. Miller

* plugins/sudoers/policy.c:

  Use sudo\_strtonum() instead of strtoull().

  Fixes building on systems that lack strtoull(). While dev\_t is unsigned
  on most systems, we can still use sudo\_strtonum() here as long as we
  allow the full range of values [LLONG\_MIN,LLONG\_MAX]. We don’t use
  strtoul() here since some 32-bit systems have 64-bit dev\_t.
  [[827fa8b76]](https://git.sudo.ws/sudo/commit/?id=827fa8b76)

2024-08-13 Rose

* include/sudo\_util.h, lib/util/uuid.c:

  Use static declaration for array sizes to uuid functions
  [[cba5d2a5c]](https://git.sudo.ws/sudo/commit/?id=cba5d2a5c)

2024-08-13 Todd C. Miller

* include/sudo\_compat.h:

  Include time.h if missing utimensat() or futimens().

  Now that we declare these as taking a timespec array we cannot get away
  with a simple forward declaration.
  [[6f8dfd968]](https://git.sudo.ws/sudo/commit/?id=6f8dfd968)

2024-08-13 Rose

* include/sudo\_util.h, lib/util/multiarch.c:

  Restrict-qualify stat\_multiarch
  [[e7483ae8e]](https://git.sudo.ws/sudo/commit/?id=e7483ae8e)

* src/load\_plugins.c:

  Replace sudo\_stat\_plugin with sudo\_qualify\_plugin, as sudo\_stat\_plugin
  does not exist

  sudo\_qualify\_plugin was probably meant instead.
  [[7269ee2be]](https://git.sudo.ws/sudo/commit/?id=7269ee2be)

2024-08-13 Todd C. Miller

* plugins/sudoers/regress/parser/check\_base64.c:

  Sync base64\_encode and base64\_decode prototypes with parse.h.
  [[e3fd614e7]](https://git.sudo.ws/sudo/commit/?id=e3fd614e7)

2024-08-12 Rose Silicon

* plugins/sudoers/parse.h:

  Restrict-qualify dst in base64\_decode

  Definition restrict qualifies but not declaration in header.
  [[60b6f3002]](https://git.sudo.ws/sudo/commit/?id=60b6f3002)

2024-08-12 Rose

* include/sudo\_compat.h, lib/util/fstatat.c, lib/util/gmtime\_r.c,
  lib/util/inet\_pton.c, lib/util/localtime\_r.c, lib/util/utimens.c:

  Use the full definition of the emulated function that is missing
  [[f96e6d134]](https://git.sudo.ws/sudo/commit/?id=f96e6d134)

* include/sudo\_util.h, lib/util/uuid.c:

  Use restrict to optimize sudo\_uuid\_to\_string\_v1
  [[787a64f51]](https://git.sudo.ws/sudo/commit/?id=787a64f51)

* plugins/sudoers/b64\_decode.c, plugins/sudoers/b64\_encode.c,
  plugins/sudoers/parse.h:

  Add restrict qualifiers to base64\_decode and base64\_encode
  [[818aae38c]](https://git.sudo.ws/sudo/commit/?id=818aae38c)

* include/sudo\_iolog.h, plugins/sudoers/iolog\_path\_escapes.c:

  Restrict-qualify iolog\_path\_escapes like we do with check\_iolog\_path

  Also add it to the function pointer definition to act as a hint to use
  restrict in the various copy functions.
  [[85d08e96b]](https://git.sudo.ws/sudo/commit/?id=85d08e96b)

* include/sudo\_util.h, lib/util/uuid.c:

  sudo\_uuid\_to\_string\_v1’s first argument should be const

  uuid is not modified.
  [[36cea6e5f]](https://git.sudo.ws/sudo/commit/?id=36cea6e5f)

2024-08-02 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Use FD\_CLOEXEC instead of just 1
  [[1381a69f5]](https://git.sudo.ws/sudo/commit/?id=1381a69f5)

2024-07-28 Todd C. Miller

* NEWS:

  Mention –with-secure-path-value configure option
  [[f6064b04c]](https://git.sudo.ws/sudo/commit/?id=f6064b04c)

* INSTALL.md, configure, configure.ac:

  Add –with-secure-path-value option

  This can be used by package maintainers to set the value of secure\_path
  that is substituted into the default sudoers file.
  [[e24737eac]](https://git.sudo.ws/sudo/commit/?id=e24737eac)

* configure, configure.ac, docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Rename secure\_path\_set -> secure\_path\_status
  [[986fdec53]](https://git.sudo.ws/sudo/commit/?id=986fdec53)

* docs/sudo\_logsrvd.man.in, docs/sudo\_sendlog.man.in, docs/sudoers.man.in:
  regen
  [[a5f5ceecf]](https://git.sudo.ws/sudo/commit/?id=a5f5ceecf)

2024-07-27 Todd C. Miller

* plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po, po/fr.mo, po/fr.po:

  Updated translations from translationproject.org
  [[cb2457410]](https://git.sudo.ws/sudo/commit/?id=cb2457410)

2024-07-14 Todd C. Miller

* docs/sudo\_logsrvd.mdoc.in, docs/sudo\_sendlog.mdoc.in,
  docs/sudoers.mdoc.in:

  Add sudo\_logsrv.proto manual cross-reference.
  [[200af679d]](https://git.sudo.ws/sudo/commit/?id=200af679d)

2024-07-07 Todd C. Miller

* NEWS:

  Late changes for 1.9.16
  [[9837fa141]](https://git.sudo.ws/sudo/commit/?id=9837fa141)

2024-07-02 Todd C. Miller

* configure, configure.ac:

  If cross-compiling with a C99 compiler, assume snprintf is compliant.

  This is a better default than assuming it is not compliant (the previous
  behavior) when cross-compiling. These days it is rare for sudo to be
  built on pre-C99 systems. [GitHub issue
  #969](https://github.com/sudo-project/sudo/issues/969)
  [[920710b18]](https://git.sudo.ws/sudo/commit/?id=920710b18)

2024-06-25 Todd C. Miller

* docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in:

  Reference schema.IBM\_LDAP.
  [[fc051ceff]](https://git.sudo.ws/sudo/commit/?id=fc051ceff)

* MANIFEST, plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/id.mo, plugins/sudoers/po/id.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/ro.mo, plugins/sudoers/po/ro.po,
  plugins/sudoers/po/ru.mo, plugins/sudoers/po/ru.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/cs.mo,
  po/cs.po, po/de.mo, po/de.po, po/eo.mo, po/eo.po, po/hr.mo, po/hr.po,
  po/id.mo, po/id.po, po/ja.mo, po/ja.po, po/ko.mo, po/ko.po, po/pl.mo,
  po/pl.po, po/ro.mo, po/ro.po, po/ru.mo, po/ru.po, po/sv.mo, po/sv.po,
  po/uk.mo, po/uk.po, po/zh\_CN.mo, po/zh\_CN.po:

  Updated translations from translationproject.org
  [[b2af245b3]](https://git.sudo.ws/sudo/commit/?id=b2af245b3)

* MANIFEST, README.LDAP.md, docs/schema.IBM\_LDAP:

  Add schema for IBM Directory Server in LDIF format.

  [GitHub issue #384](https://github.com/sudo-project/sudo/issues/384)
  [[e97060d2f]](https://git.sudo.ws/sudo/commit/?id=e97060d2f)

2024-06-16 Todd C. Miller

* NEWS:

  Remove an errant line that should have been removed.
  [[e92467723]](https://git.sudo.ws/sudo/commit/?id=e92467723)

2024-06-15 Todd C. Miller

* NEWS:

  Mention changes to the default sudoers file.
  [[e94feadff]](https://git.sudo.ws/sudo/commit/?id=e94feadff)

2024-06-11 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Improve the description of secure\_path.
  [[06799eddf]](https://git.sudo.ws/sudo/commit/?id=06799eddf)

2024-06-10 Todd C. Miller

* INSTALL.md, configure, configure.ac, docs/sudoers.mdoc.in,
  plugins/sudoers/sudoers.in:

  Enable secure\_path in default sudoers file.

  It is still disabled by default in the sudo binary.
  [[e0e24456b]](https://git.sudo.ws/sudo/commit/?id=e0e24456b)

* configure, configure.ac, plugins/sudoers/sudoers.in:

  Preserve SUDO\_EDITOR, EDITOR, and VISUAL for visudo.
  [[1db145355]](https://git.sudo.ws/sudo/commit/?id=1db145355)

2024-06-08 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update .pot files for 1.9.16
  [[14a8d9c09]](https://git.sudo.ws/sudo/commit/?id=14a8d9c09)

* NEWS, configure, configure.ac:

  Sudo 1.9.16
  [[eec523aab]](https://git.sudo.ws/sudo/commit/?id=eec523aab)

* INSTALL.md, configure, configure.ac:

  Compile in support for insults by default.

  Insults are still disabled by default but can be enabled in the sudoers
  file. To completely disable insult support, use the –without-insults
  configure option.
  [[50ae48a4b]](https://git.sudo.ws/sudo/commit/?id=50ae48a4b)

2024-06-07 Todd C. Miller

* plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/regress/cvtsudoers/test41.out.ok,
  plugins/sudoers/regress/cvtsudoers/test41.sh:

  Treat unresolvable User\_Alias/Host\_Alias as non-aliases in JSON output.

  This matches the behavior of the sudoers parser. There is no way to tell
  for sure if an upper case word is an alias or a user or host name. An
  unresolvable command alias is never a command since it doesn’t start
  with a ‘/’. [GitHub issue
  #381](https://github.com/sudo-project/sudo/issues/381)
  [[e9d65e67a]](https://git.sudo.ws/sudo/commit/?id=e9d65e67a)

* lib/util/json.c:

  Set need\_comma when closing an array or object.

  This fixes an issue where an empty array or object would not have a
  comma after it. [GitHub issue
  #381](https://github.com/sudo-project/sudo/issues/381)
  [[4e1c58753]](https://git.sudo.ws/sudo/commit/?id=4e1c58753)

2024-05-28 Todd C. Miller

* docs/Makefile.in:

  Add comment that the .mdoc files are generated from .mdoc.in
  [[648ce410f]](https://git.sudo.ws/sudo/commit/?id=648ce410f)

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in, docs/sudo.conf.man.in,
  docs/sudo.conf.mdoc.in, docs/sudo.man.in, docs/sudo.mdoc.in,
  docs/sudo\_logsrv.proto.man.in, docs/sudo\_logsrv.proto.mdoc.in,
  docs/sudo\_logsrvd.conf.man.in, docs/sudo\_logsrvd.conf.mdoc.in,
  docs/sudo\_logsrvd.man.in, docs/sudo\_logsrvd.mdoc.in,
  docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in,
  docs/sudo\_plugin\_python.man.in, docs/sudo\_plugin\_python.mdoc.in,
  docs/sudo\_sendlog.man.in, docs/sudo\_sendlog.mdoc.in,
  docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in,
  docs/sudoers.man.in, docs/sudoers.mdoc.in,
  docs/sudoers\_timestamp.man.in, docs/sudoers\_timestamp.mdoc.in,
  docs/sudoreplay.man.in, docs/sudoreplay.mdoc.in, docs/visudo.man.in,
  docs/visudo.mdoc.in:

  Sync BUGS section with the bugs section of README.md.

  Also mention how to report security issues based on SECURITY.md. [GitHub
  issue #377](https://github.com/sudo-project/sudo/issues/377).
  [[74d64bc89]](https://git.sudo.ws/sudo/commit/?id=74d64bc89)

2024-05-26 Todd C. Miller

* plugins/sudoers/regress/sudoers/test24.in,
  plugins/sudoers/regress/sudoers/test24.json.ok,
  plugins/sudoers/regress/sudoers/test24.ldif.ok,
  plugins/sudoers/regress/sudoers/test24.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test24.out.ok,
  plugins/sudoers/regress/sudoers/test24.toke.ok, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Allow the path in Chdir\_Spec | Chroot\_Spec to be double-quoted.

  The other values of an Option\_Spec could already be quoted but path
  names are treated specially.
  [[7c74a971d]](https://git.sudo.ws/sudo/commit/?id=7c74a971d)

2024-05-21 Todd C. Miller

* docs/cvtsudoers.man.in, docs/sudo.conf.man.in, docs/sudo.man.in,
  docs/sudo\_logsrv.proto.man.in, docs/sudo\_logsrvd.conf.man.in,
  docs/sudo\_logsrvd.man.in, docs/sudo\_plugin.man.in,
  docs/sudo\_plugin\_python.man.in, docs/sudo\_sendlog.man.in,
  docs/sudoers.ldap.man.in, docs/sudoers.man.in,
  docs/sudoers\_timestamp.man.in, docs/sudoreplay.man.in,
  docs/visudo.man.in:

  regen
  [[58fec2f0c]](https://git.sudo.ws/sudo/commit/?id=58fec2f0c)

* docs/Makefile.in:

  Include the name of the original .mdoc.in file in the .man.in file.

  This should make it more obvious which is the authoritative file.
  [[54ac175d3]](https://git.sudo.ws/sudo/commit/?id=54ac175d3)

2024-05-18 Todd C. Miller

* src/exec\_monitor.c, src/exec\_pty.c, src/sudo.h:

  When revoking the pty, kill the foreground process from the parent sudo.

  There’s no need to send messages back and forth to the monitor when the
  main process can just do it. [GitHub issue
  #367](https://github.com/sudo-project/sudo/issues/367).
  [[62e4d29f8]](https://git.sudo.ws/sudo/commit/?id=62e4d29f8)

* scripts/pp:

  Fix a syntax error in the systemd sudo-logsrvd.postinst script:
  sudo-logsrvd.postinst: 120: [: -eq: unexpected operator
  [[52772ae6e]](https://git.sudo.ws/sudo/commit/?id=52772ae6e)

* scripts/mkpkg:

  Fix check for libaudit package on Debian-based systems.

  Newer systems only have /usr/lib with /lib as a symbolic link.
  [[52586b0db]](https://git.sudo.ws/sudo/commit/?id=52586b0db)

2024-05-17 Todd C. Miller

* docs/schema.ActiveDirectory:

  Add double quotes around #schemaNamingContext in example.

  [GitHub issue #376](https://github.com/sudo-project/sudo/issues/376)
  [[ee56176b1]](https://git.sudo.ws/sudo/commit/?id=ee56176b1)

2024-05-15 Robert Manner

* logsrvd/logsrvd.c, logsrvd/tls\_client.c, plugins/sudoers/log\_client.c:

  logsrvd,plugins/sudoers: add debug log on TLS verification error
  [[ba29f54d9]](https://git.sudo.ws/sudo/commit/?id=ba29f54d9)

2024-05-06 Todd C. Miller

* plugins/sudoers/lookup.c:

  apply\_cmndspec: plug potential memory leak

  If apply\_cmndspec() is called where the cmndspec defines an apparmor
  profile or Solaris privileges, and then is called again with a cmndspec
  that does not have those set we would leak the original value.
  [[f2a979f40]](https://git.sudo.ws/sudo/commit/?id=f2a979f40)

* plugins/sudoers/policy.c, src/parse\_args.c, src/sudo.h:

  We do not pass apparmor\_profile from the front-end to the policy.

  There is no command line option to specify a profile, it is only passed
  from the policy to the front-end.
  [[43ffe34ab]](https://git.sudo.ws/sudo/commit/?id=43ffe34ab)

2024-05-03 Todd C. Miller

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.dict:

  Sync fuzz\_sudoers dictionary with def\_data.in.
  [[720a1450e]](https://git.sudo.ws/sudo/commit/?id=720a1450e)

* plugins/sudoers/lookup.c:

  apply\_cmndspec: plug apparmor\_profile leak

  Also override existing Solaris privs if specified.
  [[718df95e1]](https://git.sudo.ws/sudo/commit/?id=718df95e1)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  free\_cmndspec: plug apparmor\_profile leak
  [[07d6aa247]](https://git.sudo.ws/sudo/commit/?id=07d6aa247)

2024-05-02 Todd C. Miller

* plugins/python/regress/testhelpers.c:

  Python 3.12 backtraces use ‘~’ in addition to ‘^’ when underlining.
  [GitHub issue #374](https://github.com/sudo-project/sudo/issues/374)
  [[89918caf5]](https://git.sudo.ws/sudo/commit/?id=89918caf5)

2024-05-01 Todd C. Miller

* plugins/sudoers/regress/sudoers/test31.in,
  plugins/sudoers/regress/sudoers/test31.json.ok,
  plugins/sudoers/regress/sudoers/test31.ldif.ok,
  plugins/sudoers/regress/sudoers/test31.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test31.out.ok,
  plugins/sudoers/regress/sudoers/test31.toke.ok:

  Add test for parsing SELinux, AppArmor and Solaris privileges.
  [[2e6c90cde]](https://git.sudo.ws/sudo/commit/?id=2e6c90cde)

* plugins/sudoers/check.c, plugins/sudoers/cvtsudoers\_csv.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/cvtsudoers\_merge.c, plugins/sudoers/display.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/ldap\_util.c,
  plugins/sudoers/lookup.c, plugins/sudoers/parse.h,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoers\_ctx\_free.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Unifdef parser support for SELinux, AppArmor and Solaris privileges.
  [[389c8550c]](https://git.sudo.ws/sudo/commit/?id=389c8550c)

2024-04-30 Todd C. Miller

* plugins/sudoers/display.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/ldap\_util.c:

  Add some missing AppArmor bits.

  o Display ApparmorProfile in “long list” format. o Propagate
  apparmor\_profile setting to commands in a list. o Support
  apparmor\_profile in an LDAP sudoOption.
  [[38b98b417]](https://git.sudo.ws/sudo/commit/?id=38b98b417)

* src/exec\_monitor.c:

  Quiet compiler warning on Solaris 10
  [[ef52db46f]](https://git.sudo.ws/sudo/commit/?id=ef52db46f)

* configure, configure.ac, plugins/sudoers/regress/harness.in:

  Check JSON output with jq if present.
  [[4d47acf69]](https://git.sudo.ws/sudo/commit/?id=4d47acf69)

* plugins/sudoers/cvtsudoers\_json.c:

  Format SELinux, AppArmor and Solaris privileges as Options.

  Previously these were output as separate arrays without an enclosing
  object. [GitHub issue
  #373](https://github.com/sudo-project/sudo/issues/373)
  [[7c2204d34]](https://git.sudo.ws/sudo/commit/?id=7c2204d34)

2024-04-29 Todd C. Miller

* docs/sudo\_logsrvd.mdoc.in, docs/sudo\_plugin.mdoc.in,
  docs/sudoers.mdoc.in, docs/sudoers\_timestamp.mdoc.in,
  etc/codespell.exclude, lib/util/lbuf.c, logsrvd/logsrvd\_journal.c,
  plugins/sudoers/parse\_ldif.c, src/exec\_intercept.c:

  Pass “make spell” with updated codespell.
  [[27963e39f]](https://git.sudo.ws/sudo/commit/?id=27963e39f)

* src/exec\_monitor.c:

  mon\_handle\_revoke: only send SIGHUP to the foreground process group.

  There’s no need to signal both the foreground process group and the
  command itself (if different). This matches the behavior of the session
  leader exiting, which is what we want to simulate.
  [[195b7c2bc]](https://git.sudo.ws/sudo/commit/?id=195b7c2bc)

2024-04-28 Todd C. Miller

* src/exec\_monitor.c, src/exec\_pty.c, src/sudo.h:

  Avoid using ioctl(TIOCNOTTY) in the monitor.

  We don’t need to revoke the terminal in the monitor, just signal the
  foreground process group. This is more portable and has the same effect
  as ioctl(TIOCNOTTY) would on Linux. Since we now signal the command from
  the monitor, there is no reason to forward SIGHUP from the kernel.
  [GitHub issue #367](https://github.com/sudo-project/sudo/issues/367).
  [[a2d01a957]](https://git.sudo.ws/sudo/commit/?id=a2d01a957)

* plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/regress/sudoers/test24.json.ok:

  Fix copy and paste error in the fix for [GitHub issue
  #369](https://github.com/sudo-project/sudo/issues/369) Fixes GitHub
  issue #371
  [[e770c857f]](https://git.sudo.ws/sudo/commit/?id=e770c857f)

2024-04-27 Todd C. Miller

* src/exec\_monitor.c, src/exec\_pty.c, src/sudo.h:

  If user’s tty goes away, tell monitor to revoke the tty in its session.

  Previously, we would simply close the pty leader in the main sudo
  process. This had the effect of revoking the pty, but the foreground
  process would not necessarily receive SIGHUP. By using TIOCNOTTY in the
  monitor, the running command has a better chance of getting SIGHUP. Once
  the monitor has revoked the pty, the main sudo process will close the
  pty leader, invalidating the pty. [GitHub issue
  #367](https://github.com/sudo-project/sudo/issues/367).
  [[41978a56e]](https://git.sudo.ws/sudo/commit/?id=41978a56e)

2024-04-26 Todd C. Miller

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in:

  Commands with multiple digests of the same type are stored in an array.
  [[37f8a8453]](https://git.sudo.ws/sudo/commit/?id=37f8a8453)

2024-04-25 Todd C. Miller

* plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/regress/sudoers/test14.json.ok:

  Store mulitple command digests of the same type as an array.

  Otherwise, we end up with duplicated keys in the object. [GitHub issue
  #370](https://github.com/sudo-project/sudo/issues/370)
  [[c42922069]](https://git.sudo.ws/sudo/commit/?id=c42922069)

2024-04-22 Todd C. Miller

* plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/ins\_2001.h,
  plugins/sudoers/ins\_classic.h, plugins/sudoers/ins\_csops.h,
  plugins/sudoers/ins\_goons.h, plugins/sudoers/ins\_python.h:

  Call gettext() on insults when displayed, not when declared.
  [[78699a8f7]](https://git.sudo.ws/sudo/commit/?id=78699a8f7)

2024-04-01 alberic89

* plugins/sudoers/ins\_2001.h, plugins/sudoers/ins\_classic.h,
  plugins/sudoers/ins\_csops.h, plugins/sudoers/ins\_goons.h,
  plugins/sudoers/ins\_python.h:

  Make insults translatable
  [[8666c66ff]](https://git.sudo.ws/sudo/commit/?id=8666c66ff)

2024-04-19 Todd C. Miller

* plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/regress/sudoers/test24.json.ok:

  When converting CWD and CHROOT tags, store them as objects. Fixes
  [GitHub issue #369](https://github.com/sudo-project/sudo/issues/369)
  [[26ce75110]](https://git.sudo.ws/sudo/commit/?id=26ce75110)

2024-04-17 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in, plugins/sudoers/auth/pam.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c:

  Add pam\_silent sudoers option. Inspired by PR #368 [GitHub issue
  #216](https://github.com/sudo-project/sudo/issues/216)
  [[ecdf0c80f]](https://git.sudo.ws/sudo/commit/?id=ecdf0c80f)

2024-03-18 Todd C. Miller

* INSTALL.md, config.h.in, configure, configure.ac,
  plugins/sudoers/ins\_classic.h, plugins/sudoers/ins\_csops.h:

  Remove offensive insults that were disabled by default anyway. [Bug
  #1058](https://bugzilla.sudo.ws/show_bug.cgi?id=1058)
  [[f0823c70c]](https://git.sudo.ws/sudo/commit/?id=f0823c70c)

2024-03-09 Todd C. Miller

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  logsrvd/logsrvd\_conf.c, plugins/sudoers/logging.c,
  plugins/sudoers/sudoers.c:

  Remove EVLOG\_JSON, callers must use EVLOG\_JSON\_COMPACT or
  EVLOG\_JSON\_PRETTY
  [[b6175b78a]](https://git.sudo.ws/sudo/commit/?id=b6175b78a)

* docs/sudo\_logsrvd.conf.man.in, docs/sudo\_logsrvd.conf.mdoc.in,
  docs/sudoers.man.in, docs/sudoers.mdoc.in, include/sudo\_eventlog.h,
  lib/eventlog/eventlog.c, logsrvd/logsrvd\_conf.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/logging.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoers\_cb.c:

  Add “json\_pretty” log format, currently the same as “json”.

  In a future version, “json” will be an alias for “json\_compact” instead.
  [GitHub issue #357](https://github.com/sudo-project/sudo/issues/357).
  [[46e31a74d]](https://git.sudo.ws/sudo/commit/?id=46e31a74d)

2024-03-08 Todd C. Miller

* docs/sudo\_logsrvd.conf.man.in, docs/sudo\_logsrvd.conf.mdoc.in,
  docs/sudoers.man.in, docs/sudoers.mdoc.in, include/sudo\_eventlog.h,
  lib/eventlog/eventlog.c, logsrvd/logsrvd\_conf.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/logging.c,
  plugins/sudoers/sudoers\_cb.c:

  Add json\_compact log type for compact/minified JSON.

  The “json\_compact” log type logs one event per line in compact/minified
  JSON format. [GitHub issue
  #357](https://github.com/sudo-project/sudo/issues/357).
  [[1debad3be]](https://git.sudo.ws/sudo/commit/?id=1debad3be)

* plugins/sudoers/logging.c:

  Fix typo
  [[b3ade1c5f]](https://git.sudo.ws/sudo/commit/?id=b3ade1c5f)

* docs/sudo.man.in, docs/sudo.mdoc.in, plugins/sudoers/env.c:

  Set SUDO\_HOME to the invoking user’s home directory. [GitHub issue
  #358](https://github.com/sudo-project/sudo/issues/358)
  [[602a58e86]](https://git.sudo.ws/sudo/commit/?id=602a58e86)

2024-03-02 Martin

* etc/sudo-logsrvd.pp:

  sudo-logsrvd.pp: Remove syslog.target (non-existent upstream since 11~
  years ago)

  Remove syslog.target from service file, this target hasn’t existed for
  over a decade.

  <https://github.com/systemd/systemd/blob/6aa8d43ade72e24c9426e604f7fc4b75>
  82b9db7c/NEWS#L72-L73
  [[836d2b556]](https://git.sudo.ws/sudo/commit/?id=836d2b556)

2024-02-29 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Explicitly link check\_symbols with zlib.

  Fixes a test failure on some systems when using sudo’s built-in zlib.
  [[72cee2fa2]](https://git.sudo.ws/sudo/commit/?id=72cee2fa2)

2024-02-22 Fabrice Fontaine

* m4/openssl.m4:

  m4/openssl.m4: fix cross-compilation with wolfssl

  Do not append -I/usr/include/wolfssl when cross-compiling

  Signed-off-by: Fabrice Fontaine <fontaine.fabrice@…>
  [[f66ebfa0f]](https://git.sudo.ws/sudo/commit/?id=f66ebfa0f)

2024-02-21 Todd C. Miller

* lib/eventlog/Makefile.in, lib/fuzzstub/Makefile.in,
  lib/iolog/Makefile.in, lib/protobuf-c/Makefile.in,
  lib/ssl\_compat/Makefile.in, lib/util/Makefile.in, logsrvd/Makefile.in,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/python/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_approval/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Regenerate dependencies
  [[81acb2bd7]](https://git.sudo.ws/sudo/commit/?id=81acb2bd7)

* lib/eventlog/Makefile.in, lib/fuzzstub/Makefile.in,
  lib/iolog/Makefile.in, lib/logsrv/Makefile.in,
  lib/protobuf-c/Makefile.in, lib/ssl\_compat/Makefile.in,
  lib/util/Makefile.in, logsrvd/Makefile.in,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/python/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_approval/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Use $(CPP) instead if $(CC) -E when buiding .i files from .c.
  [[3944ab1fb]](https://git.sudo.ws/sudo/commit/?id=3944ab1fb)

* Makefile.in:

  Add missing subdirs to depend target.
  [[2a61e4b07]](https://git.sudo.ws/sudo/commit/?id=2a61e4b07)

* lib/util/Makefile.in, scripts/mkdep.pl:

  Using $< in a non-suffix rule context is a GNU make extension.
  [[9b073f312]](https://git.sudo.ws/sudo/commit/?id=9b073f312)

2024-02-17 Yann E. MORIN

* lib/util/Makefile.in:

  lib/utils: detect failure to generate signals list and names

  Currently, we generate the signal list and names by running cpp on our
  header, and piping the result into sed.

  However, when cpp fails [0], we do not catch that failure, as the error
  code of the LHS of a pipe is lost, with the pipe returning the RHS-most
  return code.

  Fix that by introducing two new intermediate rules, each to generate the
  preprocessed .i files, and use those as dependencies and input to the
  rule that generates the headers. Those two .i files will be cleaned up
  by the existing \*.i glob.

  [0] a failure happens on recent hosts, due to inconsistency with
  time64\_t and large-file support (lines elided and wrapped for
  readability):

  /usr/bin/cpp […] ./sys\_signame.h \ | /usr/bin/sed -e ‘1,/^int
  sudo\_end\_of\_headers;/d’ -e ‘/^#/d’ > mksigname.h In file included from
  /usr/include/features.h:394, from /usr/include/sys/types.h:25, from
  ./sys\_signame.h:4: /usr/include/features-time64.h:26:5: error: #error
  “\_TIME\_BITS=64 is allowed only with \_FILE\_OFFSET\_BITS=64” 26 | # error
  “\_TIME\_BITS=64 is allowed only with \_FILE\_OFFSET\_BITS=64” | ^~~~~
  /usr/bin/gcc […] ./mksigname.c -o mksigname In file included from
  /usr/include/features.h:394, from
  /usr/include/bits/libc-header-start.h:33, from /usr/include/stdlib.h:26,
  from ./mksigname.c:27: /usr/include/features-time64.h:26:5: error:
  #error “\_TIME\_BITS=64 is allowed only with \_FILE\_OFFSET\_BITS=64” 26 | #
  error “\_TIME\_BITS=64 is allowed only with \_FILE\_OFFSET\_BITS=64” | ^~~~~
  make[2]: \*\*\* [Makefile:263: mksigname] Error 1

  In that case, we were lucky that the subsequent gcc call also failed,
  and for the same reason. That time64\_t and lfs issue should be fixed (at
  least investigated), but that does not mean we should not be more robust
  when parsing the header either.

  Signed-off-by: Yann E. MORIN <yann.morin.1998@free.fr>
  [[6ec958f27]](https://git.sudo.ws/sudo/commit/?id=6ec958f27)

2024-02-18 Todd C. Miller

* configure:

  Regen with autoconf 2.72
  [[f3ebf31aa]](https://git.sudo.ws/sudo/commit/?id=f3ebf31aa)

* configure.ac:

  Check if ac\_cv\_sys\_file\_offset\_bits is “64”, not “yes”

  This is used for determining whether to set \_TIME\_BITS with autoconf
  versions before 2.72.
  [[bafdcc3d4]](https://git.sudo.ws/sudo/commit/?id=bafdcc3d4)

2024-02-17 Yann E. MORIN

* src/exec\_ptrace.c:

  src/exec\_ptrace: fix build without precess\_vm\_readv()

  Commit 32f4b98f6b4a (sudo frontend: silence most -Wconversion warnings.)
  broke the build on C libraries that miss process\_vm\_readv(), like
  uClibc-ng.

  Indeed, the ssize\_t nwritten is declared guarded by
  HAVE\_PROCESS\_VM\_READV, but is then re-assigned and used a few lines
  below, outside any guard.

  Fix that by always declaring the object, as it is always needed.

  Signed-off-by: Yann E. MORIN <yann.morin.1998@free.fr>
  [[5bbfaa8e6]](https://git.sudo.ws/sudo/commit/?id=5bbfaa8e6)

2024-01-31 Todd C. Miller

* docs/HISTORY.md:

  Quest no longer sponsors sudo development.
  [[f69031da2]](https://git.sudo.ws/sudo/commit/?id=f69031da2)

2024-01-23 Todd C. Miller

* src/exec\_pty.c:

  Correct a misleading debug message.
  [[0a39814e4]](https://git.sudo.ws/sudo/commit/?id=0a39814e4)

* LICENSE.md, lib/zlib/deflate.c, lib/zlib/deflate.h, lib/zlib/gzguts.h,
  lib/zlib/gzlib.c, lib/zlib/inflate.c, lib/zlib/inftrees.c,
  lib/zlib/inftrees.h, lib/zlib/trees.c, lib/zlib/zconf.h.in,
  lib/zlib/zlib.h, lib/zlib/zutil.h:

  Update embedded copy of zlib to version 1.3.1.
  [[eb4506f43]](https://git.sudo.ws/sudo/commit/?id=eb4506f43)

2024-01-18 Todd C. Miller

* etc/sudo-logsrvd.pp, etc/sudo-python.pp, etc/sudo.pp:

  Update copyright data in the package files.
  [[3899f2ef9]](https://git.sudo.ws/sudo/commit/?id=3899f2ef9)

2024-01-12 Rose

* lib/util/glob.c, plugins/sudoers/tsdump.c:

  Prefer putchar over fputc where possible

  putchar is easier to understand than fputc and printf and does less work
  than those two do.
  [[725d3fdc2]](https://git.sudo.ws/sudo/commit/?id=725d3fdc2)

2024-01-13 Rose

* plugins/sudoers/iolog\_path\_escapes.c:

  Add restrict qualifiers to strlcpy\_no\_slash

  It’s just strlcpy except it replaces ‘/’ with ‘\_’.
  [[7fc7d6953]](https://git.sudo.ws/sudo/commit/?id=7fc7d6953)

2024-01-10 Todd C. Miller

* plugins/sudoers/logging.c:

  Only log “a password is required” for “sudo -n” if a command is
  specified. This means that it is not logged for “sudo -nv” and “sudo
  -nl”. We only log this message when sudo’s -n flag is specified (and not
  when the user presses ^C at the password prompt) so that there is a
  record of failed non-interactive commands.
  [[67e328d6f]](https://git.sudo.ws/sudo/commit/?id=67e328d6f)

2024-01-08 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Document side-effects of enabling the use\_pty option.
  [[b39dc7c5f]](https://git.sudo.ws/sudo/commit/?id=b39dc7c5f)

* plugins/sudoers/sudoers.in:

  Update “!use\_pty” example to only disable it for non-root users.

  Also add a commented out entry for “exec\_background” which can also be
  used to prevent sudo from consuming tty input. Related to [GitHub issue
  #338](https://github.com/sudo-project/sudo/issues/338)
  [[ff3dbe60b]](https://git.sudo.ws/sudo/commit/?id=ff3dbe60b)

2024-01-01 Todd C. Miller

* lib/util/regress/mktemp/mktemp\_test.c:

  Add check for sysconf(\_SC\_PAGESIZE) failure.
  [[00452471b]](https://git.sudo.ws/sudo/commit/?id=00452471b)

* src/sudo\_edit.c:

  sudo\_edit\_mktemp: remove useless cast
  [[f52fa574c]](https://git.sudo.ws/sudo/commit/?id=f52fa574c)

2023-12-31 Todd C. Miller

* LICENSE.md:

  Welcome to 2024
  [[22b01501e]](https://git.sudo.ws/sudo/commit/?id=22b01501e)

* LICENSE.md:

  Bump zlib copyright date for version 1.3
  [[c15e0aeea]](https://git.sudo.ws/sudo/commit/?id=c15e0aeea)

2023-12-30 Todd C. Miller

* scripts/mkpkg:

  Restore the ability to override default configure settings.

  The user-specified options must go last…
  [[69a024304]](https://git.sudo.ws/sudo/commit/?id=69a024304)

2023-12-29 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.15p5
  [[00b2bd358]](https://git.sudo.ws/sudo/commit/?id=00b2bd358)

2023-12-28 Todd C. Miller

* scripts/mkpkg:

  Handle Debian GNU Hurd
  [[b5a3513fb]](https://git.sudo.ws/sudo/commit/?id=b5a3513fb)

* plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/pwutil\_impl.c:

  Properly handle sysconf(\_SC\_LOGIN\_NAME\_MAX) returning -1 on failure.

  The cast to size\_t needs to be outside the MAX() macro or the -1 will
  get cast to unsigned.
  [[e4057faca]](https://git.sudo.ws/sudo/commit/?id=e4057faca)

2023-12-22 Todd C. Miller

* config.h.in, configure, configure.ac, plugins/sudoers/timestamp.c:

  Automatically migrate lecture file path from name-based to uid-based.

  [GitHub issue #342](https://github.com/sudo-project/sudo/issues/342).
  [[ad4dc22d5]](https://git.sudo.ws/sudo/commit/?id=ad4dc22d5)

2023-12-21 Todd C. Miller

* lib/iolog/regress/iolog\_path/check\_iolog\_path.c:

  Add missing checks for strdup() failure.
  [[63f2c54b8]](https://git.sudo.ws/sudo/commit/?id=63f2c54b8)

2023-12-19 Todd C. Miller

* plugins/sudoers/ldap\_conf.c:

  Disable netgroup\_query when netgroup\_base is not set.

  The logic was inverted when support for netgroup\_query was added. This
  supercedes PR #341.
  [[5fbf7a362]](https://git.sudo.ws/sudo/commit/?id=5fbf7a362)

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  In the NOEXEC example make it clear that “shanty” is a host. [Bug
  #1064](https://bugzilla.sudo.ws/show_bug.cgi?id=1064)
  [[6d4ffe674]](https://git.sudo.ws/sudo/commit/?id=6d4ffe674)

2023-12-18 Todd C. Miller

* lib/eventlog/eventlog.c:

  closefrom\_nodebug: skip fds < 0

  This can only happen if lowfd < 0, which is never the case. Quiets a
  static analyzer warning.
  [[10fd66ac9]](https://git.sudo.ws/sudo/commit/?id=10fd66ac9)

2023-12-16 Todd C. Miller

* plugins/sudoers/defaults.c:

  Fix printing of warning when a Defaults setting is missing a value.

  This is a bug in parse\_default\_entry() introduced in sudo 1.8.19 when
  support for using the default syslog facility was added at the wrong
  place in a switch().
  [[701914816]](https://git.sudo.ws/sudo/commit/?id=701914816)

2023-12-15 Todd C. Miller

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h:

  Sprinkle some more const in defaults.c.
  [[f67a7e623]](https://git.sudo.ws/sudo/commit/?id=f67a7e623)

* plugins/sudoers/defaults.c:

  Fix evaluation of a tuple used in “true” boolean context.

  Previously, a tuple in boolean context was always treated as a negated
  entry, which doesn’t match the documentation. We assume that there are
  at least two tuple entries where the first maps to boolean false and the
  second maps to boolean true.
  [[2df637b26]](https://git.sudo.ws/sudo/commit/?id=2df637b26)

* NEWS, configure, configure.ac:

  Sudo 1.9.15p4
  [[680352b91]](https://git.sudo.ws/sudo/commit/?id=680352b91)

* plugins/sudoers/lookup.c:

  sudoers\_lookup\_pseudo: init match to UNSPEC for sudo\_nss\_can\_continue().

  Otherwise, processing will stop after the first sudoers nsswitch service
  specification where [SUCCESS=return] is present.
  [[fbc4c50d4]](https://git.sudo.ws/sudo/commit/?id=fbc4c50d4)

2023-12-13 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.15p3
  [[c9198ef4d]](https://git.sudo.ws/sudo/commit/?id=c9198ef4d)

2023-12-11 Todd C. Miller

* plugins/sudoers/policy.c:

  Pass back Solaris privs as “runas\_privs” and “runas\_limitprivs”.

  The “runas\_” prefix got inadvertantly removed in the big sudoers\_context
  refactor.
  [[de242c573]](https://git.sudo.ws/sudo/commit/?id=de242c573)

2023-12-09 Todd C. Miller

* include/sudo\_util.h, lib/util/term.c, lib/util/ttysize.c,
  lib/util/util.exp.in, src/sudo.h, src/ttyname.c:

  sudo\_term\_is\_raw: only try to lock the fd if it is a tty

  This moves sudo\_isatty() to libsudo\_util so sudo\_term\_is\_raw() can use
  it. Fixes [GitHub issue
  #335](https://github.com/sudo-project/sudo/issues/335)
  [[1e03cbd0b]](https://git.sudo.ws/sudo/commit/?id=1e03cbd0b)

2023-12-07 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  setup\_terminal: fix an editing error introduced in 1.9.15.
  [[d17e28ad6]](https://git.sudo.ws/sudo/commit/?id=d17e28ad6)

2023-12-06 Todd C. Miller

* plugins/sudoers/match\_command.c:

  command\_matches\_regex: retry with canonicalized path if possible

  If ctx->user.cmnd doesn’t match, use ctx->user.cmnd\_dir (if present)
  to construct a canonicalized path and match on that.
  [[0c2de39da]](https://git.sudo.ws/sudo/commit/?id=0c2de39da)

2023-12-04 Todd C. Miller

* plugins/sudoers/match\_command.c:

  command\_matches\_fnmatch: retry with canonicalized path if possible

  If ctx->user.cmnd doesn’t match, use ctx->user.cmnd\_dir (if present)
  to construct a canonicalized path and match on that.
  [[44f0908e7]](https://git.sudo.ws/sudo/commit/?id=44f0908e7)

* lib/util/gethostname.c:

  If sysconf(\_SC\_HOST\_NAME\_MAX) returns 0, just use 255.

  This should not actually be possible.
  [[24f443981]](https://git.sudo.ws/sudo/commit/?id=24f443981)

* plugins/sudoers/sethost.c:

  Fall back to “localhost” if gethostname() fails.

  [GitHub issue #332](https://github.com/sudo-project/sudo/issues/332)
  [[8faf43249]](https://git.sudo.ws/sudo/commit/?id=8faf43249)

* plugins/sudoers/match\_command.c:

  command\_matches\_glob: fix comparison of canonicalized parent directories

  [Bug #1062](https://bugzilla.sudo.ws/show_bug.cgi?id=1062)
  [[8dd296776]](https://git.sudo.ws/sudo/commit/?id=8dd296776)

2023-12-01 Todd C. Miller

* plugins/sudoers/cvtsudoers\_csv.c:

  Add missing print\_member\_list\_csv() return value check.
  [[9c3eb2fec]](https://git.sudo.ws/sudo/commit/?id=9c3eb2fec)

* plugins/sudoers/tsdump.c:

  Check sudoers\_debug\_register() return value.
  [[79ed29c4a]](https://git.sudo.ws/sudo/commit/?id=79ed29c4a)

2023-11-30 Todd C. Miller

* configure, scripts/config.guess, scripts/config.sub:

  Regenerate with the autoconf 2.72d snapshot.
  [[c3ac12297]](https://git.sudo.ws/sudo/commit/?id=c3ac12297)

2023-11-28 Todd C. Miller

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in:

  Add cmddenial\_message to def\_data.in
  [[77700a4b7]](https://git.sudo.ws/sudo/commit/?id=77700a4b7)

2023-11-28 THE-Spellchecker

* INSTALL.md, docs/UPGRADE.md, lib/util/event.c, lib/util/fatal.c,
  lib/util/fnmatch.c, lib/util/lbuf.c, lib/util/snprintf.c,
  lib/util/sudo\_dso.c, plugins/python/example\_io\_plugin.py,
  plugins/python/example\_policy\_plugin.py, plugins/sample/sample\_plugin.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.in, plugins/sudoers/ldap.c,
  plugins/sudoers/lookup.c, plugins/sudoers/parse.h,
  plugins/sudoers/parse\_ldif.c, plugins/sudoers/policy.c,
  plugins/sudoers/pwutil.h, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudoers.c, src/exec.c,
  src/exec\_monitor.c, src/exec\_ptrace.c, src/exec\_pty.c:

  Typographical and Grammatical fixes
  [[5eba4b48c]](https://git.sudo.ws/sudo/commit/?id=5eba4b48c)

2023-11-28 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Reword the description of cmddenial\_message.
  [[b4ae559c8]](https://git.sudo.ws/sudo/commit/?id=b4ae559c8)

* docs/sudoreplay.man.in:

  Regenerate from sudoreplay.mdoc.in
  [[6b6e0aed0]](https://git.sudo.ws/sudo/commit/?id=6b6e0aed0)

2023-11-20 Guillaume Destuynder

* docs/sudoers.man.in, docs/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/logging.c,
  plugins/sudoers/regress/sudoers/test26.in,
  plugins/sudoers/regress/sudoers/test26.json.ok,
  plugins/sudoers/regress/sudoers/test26.ldif.ok,
  plugins/sudoers/regress/sudoers/test26.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test26.out.ok,
  plugins/sudoers/regress/sudoers/test26.toke.ok:

  Add support for a custom message when the command execution is denied.
  [[a4cbfecda]](https://git.sudo.ws/sudo/commit/?id=a4cbfecda)

2023-11-26 Todd C. Miller

* lib/util/ttyname\_dev.c:

  No need to include sys/param.h here.
  [[55db82908]](https://git.sudo.ws/sudo/commit/?id=55db82908)

* plugins/sudoers/tsdump.c:

  tsdump: quiet compiler warnings on some platforms.

  Quiet a -Wshadow warning from gcc. Cast major() and minor() to unsigned
  int when printing.
  [[522f1b634]](https://git.sudo.ws/sudo/commit/?id=522f1b634)

* plugins/sudoers/tsdump.c:

  tsdump: display both the terminal path and device number.

  If no terminal device can be found, print “major, minor” device numbers
  instead.
  [[288593875]](https://git.sudo.ws/sudo/commit/?id=288593875)

* docs/sudoers\_timestamp.man.in, docs/sudoers\_timestamp.mdoc.in:

  Sync time stamp defines with sudoers timestamp.h

  The types and flags are now explicitly unsigned.
  [[7d7dfbfd4]](https://git.sudo.ws/sudo/commit/?id=7d7dfbfd4)

* docs/sudoers.man.in, docs/sudoers.mdoc.in,
  docs/sudoers\_timestamp.man.in, docs/sudoers\_timestamp.mdoc.in:

  Mention the tsdump utility
  [[0c958e185]](https://git.sudo.ws/sudo/commit/?id=0c958e185)

* plugins/sudoers/Makefile.in:

  Build tsdump by default so it does not suffer bit rot.
  [[66c9a636d]](https://git.sudo.ws/sudo/commit/?id=66c9a636d)

* include/sudo\_debug.h:

  Add sudo\_debug\_exit\_dev\_t stub for fuzzing.
  [[67ed8fbe5]](https://git.sudo.ws/sudo/commit/?id=67ed8fbe5)

* lib/util/chacha\_private.h, lib/util/inet\_pton.c:

  Avoid using the u\_int type, which is not portable.
  [[be911b77d]](https://git.sudo.ws/sudo/commit/?id=be911b77d)

* plugins/sudoers/tsdump.c:

  tsdump: update to use a uid-based path by default

  This matches the changes in sudo 1.9.15 to the sudoers policy module.
  [[5ff6f4965]](https://git.sudo.ws/sudo/commit/?id=5ff6f4965)

2023-11-25 Todd C. Miller

* plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stdout:

  Update for plugin version 1.22.
  [[ce74f50b4]](https://git.sudo.ws/sudo/commit/?id=ce74f50b4)

* docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h:

  Document ttydev and bump plugin version to 1.22
  [[61dbfe092]](https://git.sudo.ws/sudo/commit/?id=61dbfe092)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/timestamp.c:

  Add ttydev to sudoers\_user\_context and use for timestamp file.

  [GitHub issue #329](https://github.com/sudo-project/sudo/issues/329)
  [[a85494b5c]](https://git.sudo.ws/sudo/commit/?id=a85494b5c)

* include/sudo\_debug.h, src/sudo.c, src/sudo.h, src/ttyname.c:

  Pass tty device number from front-end to policy module.

  [GitHub issue #329](https://github.com/sudo-project/sudo/issues/329)
  [[3dfbf9316]](https://git.sudo.ws/sudo/commit/?id=3dfbf9316)

2023-11-23 Todd C. Miller

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  lib/eventlog/parse\_json.c, lib/iolog/iolog\_legacy.c,
  lib/iolog/iolog\_loginfo.c, logsrvd/iolog\_writer.c,
  logsrvd/logsrvd\_local.c, logsrvd/sendlog.c, plugins/sudoers/audit.c,
  plugins/sudoers/iolog.c, plugins/sudoers/logging.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudoreplay.c:

  Rename submit\_time -> event\_time in struct eventlog.
  [[b9275b7ea]](https://git.sudo.ws/sudo/commit/?id=b9275b7ea)

* plugins/sudoers/audit.c, plugins/sudoers/logging.c:

  We can use evlog.submit\_time in the call to eventlog\_alert().

  This is set to the current wallclock time by sudoers\_to\_eventlog().
  [[0e53d5fdd]](https://git.sudo.ws/sudo/commit/?id=0e53d5fdd)

* plugins/sudoers/logging.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h:

  Replace submit\_time in struct sudoers\_context with start\_time.

  We need to track the (monotonic) command start time to be able to
  generate an accurate run time. Instead of setting submit time when the
  policy initializes (and using that time for logging purposes), set
  evlog->submit\_time to the current wallclock time when we need to
  perform logging. This is more consistent with how sudo logging was
  performed in the past. Fixes GitHub issues #327.
  [[39ea3176c]](https://git.sudo.ws/sudo/commit/?id=39ea3176c)

* plugins/sudoers/audit.c, plugins/sudoers/iolog.c,
  plugins/sudoers/log\_client.c, plugins/sudoers/log\_client.h,
  plugins/sudoers/logging.c:

  log\_server\_open: always pass in awake time, not wallclock time.

  The timespec passed to log\_server\_open() should be from
  sudo\_gettime\_awake() since it is used to build the command run time.
  [[432b08555]](https://git.sudo.ws/sudo/commit/?id=432b08555)

* plugins/sudoers/log\_client.c, plugins/sudoers/log\_client.h,
  plugins/sudoers/logging.c:

  log\_server\_alert: use fmt\_alert\_message not fmt\_reject\_message

  Only affects intercepted commands.
  [[6965e1b0a]](https://git.sudo.ws/sudo/commit/?id=6965e1b0a)

* plugins/sudoers/audit.c, plugins/sudoers/log\_client.c,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h:

  log\_server\_alert: struct timespec argument was not actually used

  The struct timespec argument is used to initialize the command start
  time, which is not used for an alert message.
  [[13dec64f3]](https://git.sudo.ws/sudo/commit/?id=13dec64f3)

2023-11-11 Todd C. Miller

* plugins/sudoers/cvtsudoers\_csv.c:

  cvtsudoers\_csv.c: remove most sudo\_fatal() calls.

  Errors are now propagated up the call stack.
  [[47a43c540]](https://git.sudo.ws/sudo/commit/?id=47a43c540)

* plugins/sudoers/cvtsudoers\_ldif.c:

  No need for sudo\_fatalx() here, just pass back an error.
  [[dd5f7a450]](https://git.sudo.ws/sudo/commit/?id=dd5f7a450)

* plugins/sudoers/cvtsudoers\_ldif.c:

  cvtsudoers\_ldif: display warning on write error
  [[2c06aa321]](https://git.sudo.ws/sudo/commit/?id=2c06aa321)

* plugins/sudoers/cvtsudoers\_merge.c:

  cvtsudoers\_merge.c: remove sudo\_fatal() calls.

  Errors are now propagated up the call stack.
  [[7e4632691]](https://git.sudo.ws/sudo/commit/?id=7e4632691)

2023-11-10 Todd C. Miller

* plugins/sudoers/cvtsudoers\_merge.c:

  Make new\_member() return NULL on failure and adjust callers.
  [[8cfd4467f]](https://git.sudo.ws/sudo/commit/?id=8cfd4467f)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Pass return values back instead of using sudo\_fatal().
  [[564d8ac01]](https://git.sudo.ws/sudo/commit/?id=564d8ac01)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Add printf\_attribute\_ldif() to printf-format an LDIF attribute.

  This replaces multiple sequences of asprintf() and
  print\_attribute\_ldif().
  [[d28884b1c]](https://git.sudo.ws/sudo/commit/?id=d28884b1c)

2023-11-09 Todd C. Miller

* plugins/sudoers/cvtsudoers\_json.c:

  cvtsudoers\_json.c: check sudo\_json\_\* return values.

  Previously, we set memfatal to true in sudo\_json\_init() instead. This
  also gets rid of a number of sudo\_fatalx() calls.
  [[12e55dcd7]](https://git.sudo.ws/sudo/commit/?id=12e55dcd7)

* plugins/audit\_json/audit\_json.c:

  add\_timestamp: check sudo\_json\_\* return values.
  [[1a68935ae]](https://git.sudo.ws/sudo/commit/?id=1a68935ae)

* plugins/sudoers/alias.c, plugins/sudoers/check\_aliases.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_csv.c,
  plugins/sudoers/parse.h, plugins/sudoers/testsudoers.c:

  alias\_apply: change return type to bool

  We can use the rbapply() return value to detect failure.
  [[a2998a670]](https://git.sudo.ws/sudo/commit/?id=a2998a670)

* src/sudo.c:

  Always disable core dumps when sudo sends itself a fatal signal.

  When a command exits due to a fatal signal, sudo will re-send that
  signal to itself so the shell does not ignore keyboard-generated
  signals. However, now that sudo disables core dumps by default for the
  command, we cannot rely on WCOREDUMP() telling us whether or not the
  signal will lead to a core dump. It is safest to always disable core
  dumps before sending the signal to ourself.
  [[ab49adb92]](https://git.sudo.ws/sudo/commit/?id=ab49adb92)

2023-11-08 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.15p2
  [[62895ea44]](https://git.sudo.ws/sudo/commit/?id=62895ea44)

* scripts/pp:

  Update PolyPkg from upstream.
  [[0f40753d4]](https://git.sudo.ws/sudo/commit/?id=0f40753d4)

* lib/util/term.c:

  sudo\_term\_restore: don’t check c\_cflag on systems with TCSASOFT.

  If TCSASOFT is present, tcsetattr() will ignore c\_cflag. Fixes a bug
  where sudo\_term\_restore() would refuse to change the terminal settings
  back if the PARENB control flag was set. [GitHub issue
  #326](https://github.com/sudo-project/sudo/issues/326).
  [[a6ac589cc]](https://git.sudo.ws/sudo/commit/?id=a6ac589cc)

* scripts/mkpkg:

  Quote $osversion since it may include whitespace.
  [[0497bde98]](https://git.sudo.ws/sudo/commit/?id=0497bde98)

2023-11-07 Todd C. Miller

* plugins/sudoers/sudoers.h:

  Use C99 designated struct initializers.

  This is less error-prone and would have avoided [GitHub issue
  #325](https://github.com/sudo-project/sudo/issues/325).
  [[e0d912d1d]](https://git.sudo.ws/sudo/commit/?id=e0d912d1d)

* NEWS, configure, configure.ac:

  Sudo 1.9.15p1
  [[45aeeddcb]](https://git.sudo.ws/sudo/commit/?id=45aeeddcb)

* plugins/sudoers/sudoers.h:

  Correct the order of the strings in SUDOERS\_CONTEXT\_INITIALIZER.

  Fixes [GitHub issue
  #325](https://github.com/sudo-project/sudo/issues/325), a bug introduced
  in sudo 1.9.15.
  [[87c193f3f]](https://git.sudo.ws/sudo/commit/?id=87c193f3f)

2023-11-06 Todd C. Miller

* NEWS:

  In the sudo 1.9.14p3 section, “Python python” should be “Python plugin”.
  [[d45071af4]](https://git.sudo.ws/sudo/commit/?id=d45071af4)

* NEWS:

  Sudo now logs the submitenv in the JSON logs.
  [[747c34059]](https://git.sudo.ws/sudo/commit/?id=747c34059)

* docs/sudo.conf.man.in, docs/sudo.conf.mdoc.in, docs/sudoers.man.in,
  docs/sudoers.mdoc.in:

  Document special cases for AIX-style shared libraries.

  The shared object is a member of an archive file that is specified in
  parentheses.
  [[3686c9fdd]](https://git.sudo.ws/sudo/commit/?id=3686c9fdd)

2023-11-04 Todd C. Miller

* docs/sudo.conf.man.in, docs/sudo.conf.mdoc.in:

  Add sudoers plugin Debug example and x-ref sudoers man page for details.
  [[e77247927]](https://git.sudo.ws/sudo/commit/?id=e77247927)

* docs/sudo.conf.man.in, docs/sudo.conf.mdoc.in:

  The HP-UX getgrouplist() code has been disabled due to bugs.
  [[ec6906f63]](https://git.sudo.ws/sudo/commit/?id=ec6906f63)

2023-11-03 Todd C. Miller

* lib/util/sudo\_conf.c:

  sudo\_conf\_debug\_files: special handling of DSO members for AIX

  When matching debug files for AIX-style DSOs like sudoers.a(sudoers.so)
  we want to match on the full name, the name without the member and on
  the member itself. This makes it possible to use the existing examples
  in the sudo.conf fiile on AIX.
  [[097bec06b]](https://git.sudo.ws/sudo/commit/?id=097bec06b)

* plugins/sudoers/pwutil.c:

  sudo\_set\_grlist and sudo\_set\_gidlist: set auth registry based on
  username

  Previously we used the global registry but since we have the user’s
  passwd info we should use that when storing the group and gid lists.
  [[24351bdad]](https://git.sudo.ws/sudo/commit/?id=24351bdad)

2023-11-02 Todd C. Miller

* plugins/sudoers/parse\_ldif.c:

  role\_to\_sudoers: only try to reuse a privilege if one is present
  [[2ffcda8e1]](https://git.sudo.ws/sudo/commit/?id=2ffcda8e1)

* plugins/sudoers/defaults.c:

  store\_plugin: avoid potential NULL deref in boolean context

  Coverity CID 330466
  [[1a11be4d9]](https://git.sudo.ws/sudo/commit/?id=1a11be4d9)

* plugins/sudoers/sudoreplay.c, src/conversation.c:

  Avoid passing sudo\_term\_is\_raw() -1 for the fd.

  Coverity CID 330472 Coverity CID 330468
  [[4833ac0f0]](https://git.sudo.ws/sudo/commit/?id=4833ac0f0)

* logsrvd/sendlog.c:

  fmt\_info\_messages: bump info\_msgs\_size for submitenv
  [[3b891c136]](https://git.sudo.ws/sudo/commit/?id=3b891c136)

* NEWS:

  Better log message when rejecting a setid command in intercept mode.
  [[77c258290]](https://git.sudo.ws/sudo/commit/?id=77c258290)

* plugins/sudoers/logging.c, plugins/sudoers/lookup.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/parse.h,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Move the check for running setid commands in intercept mode to later.

  Checking for setid commands in intercept mode after command matching
  allows us to log a proper error message. Previously, we simply ignored
  setid commands when matching and the only indication of why was in the
  debug logs.
  [[886f1414e]](https://git.sudo.ws/sudo/commit/?id=886f1414e)

* plugins/sudoers/timestamp.c:

  timestamp\_open: add some debugging
  [[45e3c0dd1]](https://git.sudo.ws/sudo/commit/?id=45e3c0dd1)

2023-10-31 Todd C. Miller

* plugins/sudoers/auth/sia.c:

  sudo\_sia\_begin\_session: add missing struct sudoers\_context \* arg.
  [[3297ffa26]](https://git.sudo.ws/sudo/commit/?id=3297ffa26)

* plugins/sudoers/auth/kerb5.c:

  verify\_krb\_v5\_tgt: auth name must be const to match struct sudo\_auth.
  [[747114f33]](https://git.sudo.ws/sudo/commit/?id=747114f33)

* .circleci/config.yml:

  Disable PAM before enabling Kerberos V.
  [[9ef52151e]](https://git.sudo.ws/sudo/commit/?id=9ef52151e)

* .circleci/config.yml, docker/debian/latest/Dockerfile,
  docker/debian/testing/Dockerfile, docker/fedora/latest/Dockerfile,
  docker/fedora/rawhide/Dockerfile, docker/ubuntu/devel/Dockerfile,
  docker/ubuntu/latest/Dockerfile, docker/ubuntu/rolling/Dockerfile:

  Add Kerberos V build and test to CI.
  [[7ed7b4536]](https://git.sudo.ws/sudo/commit/?id=7ed7b4536)

2023-10-30 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po:

  Updated translations from translationproject.org
  [[145faa3fe]](https://git.sudo.ws/sudo/commit/?id=145faa3fe)

2023-10-31 Renato Botelho

* plugins/sudoers/auth/kerb5.c:

  Add missing sudoers\_context to verify\_krb\_v5\_tgt()

  Commit 244017495421 added ctx variable to log\_warningx() call but that
  variable was not declared in that context, breaking the build.
  [[75e829b74]](https://git.sudo.ws/sudo/commit/?id=75e829b74)

2023-10-23 Todd C. Miller

* NEWS:

  Mention new Indonesian translation and sudo\_logsrvd fd limit change.
  [[5f3a6b4f6]](https://git.sudo.ws/sudo/commit/?id=5f3a6b4f6)

2023-10-27 Todd C. Miller

* logsrvd/logsrvd.c:

  Set the open file descriptor limit to the maximum allowed value.

  Each connection can require up to 9 descriptors.
  [[31bcdec23]](https://git.sudo.ws/sudo/commit/?id=31bcdec23)

2023-10-23 Todd C. Miller

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/ro.mo, plugins/sudoers/po/ro.po,
  plugins/sudoers/po/ru.mo, plugins/sudoers/po/ru.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/hr.mo,
  po/hr.po, po/ja.mo, po/ja.po, po/sr.mo, po/sr.po, po/zh\_CN.mo,
  po/zh\_CN.po:

  Updated translations from translationproject.org
  [[bf722e18b]](https://git.sudo.ws/sudo/commit/?id=bf722e18b)

* docs/CONTRIBUTORS.md:

  Add Andika Triwidada
  [[86f1d52a0]](https://git.sudo.ws/sudo/commit/?id=86f1d52a0)

* MANIFEST, po/id.mo, po/id.po:

  New Indonesian translation from translationproject.org
  [[9a2a882d1]](https://git.sudo.ws/sudo/commit/?id=9a2a882d1)

2023-10-22 Todd C. Miller

* NEWS:

  Mention [GitHub issue
  #318](https://github.com/sudo-project/sudo/issues/318)
  [[0fbb17de5]](https://git.sudo.ws/sudo/commit/?id=0fbb17de5)

* plugins/sudoers/env.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Avoid a double-free in fuzz\_policy caused by the early env\_init(NULL).

  This adds an env\_free() function to explicitly free both the old and new
  copies of the environment. It is really only needed by fuzz\_policy,
  which calls the policy module multiple times.
  [[392ae0f03]](https://git.sudo.ws/sudo/commit/?id=392ae0f03)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  lib/eventlog/eventlog\_free.c, lib/eventlog/parse\_json.c,
  logsrvd/iolog\_writer.c, logsrvd/sendlog.c, plugins/sudoers/iolog.c,
  plugins/sudoers/log\_client.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h:

  Store submitenv in eventlog and pass it to sudo\_logsrvd.
  [[3bbc7c8f8]](https://git.sudo.ws/sudo/commit/?id=3bbc7c8f8)

2023-10-21 Todd C. Miller

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  lib/eventlog/eventlog\_free.c, lib/eventlog/parse\_json.c,
  lib/iolog/iolog\_loginfo.c, logsrvd/iolog\_writer.c, logsrvd/sendlog.c,
  plugins/sudoers/iolog.c, plugins/sudoers/log\_client.c,
  plugins/sudoers/logging.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoreplay.c:

  struct eventlog: rename argv/env to runargv/runenv.

  This matches the JSON logs.
  [[726b646b4]](https://git.sudo.ws/sudo/commit/?id=726b646b4)

* plugins/sudoers/logging.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  struct sudoers\_user\_context: rename env\_vars to env\_add
  [[c7a61a943]](https://git.sudo.ws/sudo/commit/?id=c7a61a943)

* plugins/sudoers/audit.c, plugins/sudoers/logging.c:

  Only log the run environment for commands that are allowed.

  It may not be available otherwise and unless the command is being run it
  has no real meaning.
  [[2b87749f8]](https://git.sudo.ws/sudo/commit/?id=2b87749f8)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c:

  Free the private copy of the environment in sudoers\_check\_cmnd().

  This reverts 5118eb5797fb, which had the side-effect of the PAM session
  code running with the run environment instead of the invoking user’s
  environment. Issue #318
  [[077826292]](https://git.sudo.ws/sudo/commit/?id=077826292)

2023-10-19 Todd C. Miller

* lib/iolog/iolog\_swapids.c:

  iolog\_swapids: short circuit if effective ids match iolog ids.
  [[8486976b9]](https://git.sudo.ws/sudo/commit/?id=8486976b9)

* lib/iolog/iolog\_mkdirs.c, logsrvd/iolog\_writer.c:

  logsrvd: display error string in message if iolog\_mkpath() fails
  [[09a426437]](https://git.sudo.ws/sudo/commit/?id=09a426437)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update .pot files for 1.9.15
  [[29f796742]](https://git.sudo.ws/sudo/commit/?id=29f796742)

2023-10-18 Todd C. Miller

* plugins/sudoers/sudoers.in:

  Add example for disabling intercept/log\_subcmds for certain commands.
  [[e3edd7a09]](https://git.sudo.ws/sudo/commit/?id=e3edd7a09)

* lib/util/mksiglist.c, lib/util/mksigname.c:

  Use NSIG instead of nitems(array) for the loop bound.

  This matches the sudo\_sys\_siglist[] and sudo\_sys\_signame[] declarations.
  [[78edde5ea]](https://git.sudo.ws/sudo/commit/?id=78edde5ea)

* plugins/sudoers/tsdump.c:

  tsdump: fix compiler warnings
  [[385d506d3]](https://git.sudo.ws/sudo/commit/?id=385d506d3)

2023-10-17 Todd C. Miller

* lib/eventlog/regress/logwrap/check\_wrap.c, lib/util/mksiglist.c,
  lib/util/mksigname.c, logsrvd/sendlog.c,
  plugins/python/regress/iohelpers.c, plugins/sudoers/tsdump.c:

  Avoid using %zu or %zd with printf() and fprintf().

  This prevents problems on systems where the system printf(3) is not
  C99-compliant. We use our own snprintf() on such systems so that is
  safe.
  [[14d514e5a]](https://git.sudo.ws/sudo/commit/?id=14d514e5a)

* plugins/sudoers/sudo\_printf.c, src/conversation.c:

  Use vsnprintf() instead of vfprintf() for sudo\_printf() to avoid
  problems on systems where the system printf(3) is not C99-compliant. We
  use our own snprintf() on such systems.
  [[58d6554a7]](https://git.sudo.ws/sudo/commit/?id=58d6554a7)

* include/sudo\_compat.h, lib/util/getdelim.c, lib/util/realpath.c,
  lib/util/regress/getdelim/getdelim\_test.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  strlcpy\_expand\_host, sudo\_getdelim, sudo\_realpath: add restrict
  qualifier
  [[cf9fc5317]](https://git.sudo.ws/sudo/commit/?id=cf9fc5317)

* NEWS:

  Fixed [GitHub issue
  #312](https://github.com/sudo-project/sudo/issues/312).
  [[29ddd2679]](https://git.sudo.ws/sudo/commit/?id=29ddd2679)

2023-10-16 Rose

* plugins/sudoers/prompt.c, plugins/sudoers/strlcpy\_unesc.c,
  plugins/sudoers/sudoers.h:

  Add restrict to strlcpy and expand\_prompt
  [[97f805242]](https://git.sudo.ws/sudo/commit/?id=97f805242)

2023-10-16 Todd C. Miller

* lib/util/term.c:

  Better handling of multiple sudo processes modifying terminal settings.
  1. Lock the terminal before tcgetattr/tcsetattr 2. Don’t restore
     terminal settings if changed by another process 3. Don’t set terminal to
     raw mode if it is already raw [GitHub issue
     #312](https://github.com/sudo-project/sudo/issues/312)
     [[fabb6264f]](https://git.sudo.ws/sudo/commit/?id=fabb6264f)

* src/exec\_pty.c:

  Add a little extra debugging info.
  [[2f80865e7]](https://git.sudo.ws/sudo/commit/?id=2f80865e7)

2023-05-05 Rose

* plugins/sudoers/sudoers\_hooks.c:

  Redundant cast removal in sudoers\_hooks

  def\_sudoers\_locale is already a char\*
  [[b2a44430b]](https://git.sudo.ws/sudo/commit/?id=b2a44430b)

2023-07-18 Rose

* lib/eventlog/regress/logwrap/check\_wrap.c, lib/util/glob.c,
  lib/util/mksiglist.c, lib/util/mksigname.c,
  lib/util/regress/glob/globtest.c, logsrvd/sendlog.c,
  plugins/group\_file/plugin\_test.c,
  plugins/python/regress/check\_python\_examples.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/tsdump.c:

  Prefer fputs over fprintf where possible

  fprintf does extra work and meant for formatting strings.
  [[e095069d2]](https://git.sudo.ws/sudo/commit/?id=e095069d2)

2023-10-15 Rose

* lib/util/regress/hexchar/hexchar\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c, lib/util/sudo\_conf.c:

  Swap calloc arguments to use them properly.
  [[a4cbd7fe7]](https://git.sudo.ws/sudo/commit/?id=a4cbd7fe7)

2023-10-13 Rose

* include/sudo\_util.h, src/exec\_ptrace.h:

  Specify 1U over 1 for bitmaps
  [[dd8426f9c]](https://git.sudo.ws/sudo/commit/?id=dd8426f9c)

2023-10-14 Todd C. Miller

* src/exec\_ptrace.c:

  ptrace\_intercept\_execve: make flags unsigned to match command\_details
  [[873e0de07]](https://git.sudo.ws/sudo/commit/?id=873e0de07)

2023-10-12 Todd C. Miller

* plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/parse.h,
  plugins/sudoers/sudoers.h:

  Fix spelling: resistent -> resistant
  [[2d437c793]](https://git.sudo.ws/sudo/commit/?id=2d437c793)

2023-10-05 Todd C. Miller

* .gitignore, .hgignore:

  Add plugins/sudoers/tsgetusershell.c to ignore files.
  [[98c2eeafd]](https://git.sudo.ws/sudo/commit/?id=98c2eeafd)

2023-10-02 Alexander F. RÃ¸dseth

* plugins/sudoers/visudo.c:

  Add Orbiton (“o”) to the list of editors that supports +lineno
  [[07426f8a1]](https://git.sudo.ws/sudo/commit/?id=07426f8a1)

* plugins/sudoers/visudo.c:

  Sort the list of editors that supports +lineno
  [[356ea96ef]](https://git.sudo.ws/sudo/commit/?id=356ea96ef)

2023-10-02 Todd C. Miller

* plugins/sudoers/mkdefaults:

  Fix compatibility with older versions of (new) awk.

  Do not rely on awk supporting “-f -” to read the program from stdin.
  Avoid using POSIX character classes in regular expressions.
  [[9a715b694]](https://git.sudo.ws/sudo/commit/?id=9a715b694)

2023-09-28 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Mention potential problems with log\_subcmds and intercept.
  [[3141f63b2]](https://git.sudo.ws/sudo/commit/?id=3141f63b2)

* src/sudo.c:

  Add more user info to the list of objects to be garbage-collected at
  exit.
  [[f6561bc97]](https://git.sudo.ws/sudo/commit/?id=f6561bc97)

2023-09-27 Todd C. Miller

* plugins/python/pyhelpers.c, plugins/python/pyhelpers.h:

  Use long, not long long, when getting/setting numeric attributes.

  We use int or long, not long long, in the Python plugin.
  [[344e0daec]](https://git.sudo.ws/sudo/commit/?id=344e0daec)

* lib/eventlog/parse\_json.c, lib/iolog/iolog\_legacy.c,
  lib/iolog/iolog\_timing.c, logsrvd/iolog\_writer.c,
  logsrvd/logsrvd\_conf.c, logsrvd/logsrvd\_journal.c,
  logsrvd/logsrvd\_local.c, logsrvd/sendlog.c, plugins/sudoers/defaults.c,
  plugins/sudoers/iolog.c, plugins/sudoers/log\_client.c:

  Add casts when storing values in a struct timespec.

  Fixes -Wconversion warnings on some 32-bit systems where time\_t is still
  32-bit.
  [[1398289fa]](https://git.sudo.ws/sudo/commit/?id=1398289fa)

* plugins/sudoers/file.c:

  sudo\_file\_open: initialize parser before calling open\_sudoers().

  Otherwise, the parser\_conf settings in the context passed to
  sudo\_file\_open() will not be honored by open\_sudoers(). Affected
  settings include ignore\_perms, sudoers mode, uid and gid.
  [[9cc57f493]](https://git.sudo.ws/sudo/commit/?id=9cc57f493)

2023-09-27 Rose

* lib/util/roundup.c:

  Use U, not UL, for 32-bit platforms

  size\_t is an unsigned int on 32-bit platforms, not an unsigned long.
  [[b2f8c5666]](https://git.sudo.ws/sudo/commit/?id=b2f8c5666)

2023-09-26 Todd C. Miller

* plugins/sudoers/match\_digest.c:

  digest\_matches: actually use fd2 in place of fd as needed.
  [[837f400ac]](https://git.sudo.ws/sudo/commit/?id=837f400ac)

* plugins/sudoers/match\_digest.c:

  digest\_matches: if fd argument is -1, try to open path before failing
  [[ff2d8464c]](https://git.sudo.ws/sudo/commit/?id=ff2d8464c)

* plugins/sudoers/regress/cvtsudoers/test31.sh,
  plugins/sudoers/regress/cvtsudoers/test32.sh,
  plugins/sudoers/regress/cvtsudoers/test35.sh,
  plugins/sudoers/regress/cvtsudoers/test36.sh,
  plugins/sudoers/regress/cvtsudoers/test39.sh,
  plugins/sudoers/regress/testsudoers/test20.sh,
  plugins/sudoers/regress/testsudoers/test21.sh,
  plugins/sudoers/regress/testsudoers/test22.sh,
  plugins/sudoers/regress/testsudoers/test23.sh,
  plugins/sudoers/regress/testsudoers/test24.sh,
  plugins/sudoers/regress/testsudoers/test25.sh,
  plugins/sudoers/regress/testsudoers/test26.sh,
  plugins/sudoers/regress/testsudoers/test27.sh,
  plugins/sudoers/regress/testsudoers/test28.sh,
  plugins/sudoers/regress/testsudoers/test29.sh,
  plugins/sudoers/regress/testsudoers/test30.sh,
  plugins/sudoers/regress/testsudoers/test31.sh:

  Add missing execute bit on some test scripts.
  [[4d4279d0c]](https://git.sudo.ws/sudo/commit/?id=4d4279d0c)

2023-09-25 Todd C. Miller

* plugins/sudoers/sudoers.h:

  max\_groups in sudoers\_plugin\_settings is no longer used.
  [[29feb41da]](https://git.sudo.ws/sudo/commit/?id=29feb41da)

* include/sudo\_conf.h, include/sudo\_debug.h, include/sudo\_event.h,
  include/sudo\_eventlog.h, include/sudo\_fatal.h, include/sudo\_json.h,
  include/sudo\_util.h, lib/eventlog/eventlog.c,
  lib/eventlog/eventlog\_conf.c, lib/eventlog/eventlog\_free.c,
  lib/eventlog/logwrap.c, lib/eventlog/parse\_json.c,
  lib/eventlog/parse\_json.h,
  lib/eventlog/regress/eventlog\_store/store\_json\_test.c,
  lib/eventlog/regress/eventlog\_store/store\_sudo\_test.c,
  lib/eventlog/regress/logwrap/check\_wrap.c,
  lib/eventlog/regress/parse\_json/check\_parse\_json.c,
  lib/fuzzstub/fuzzstub.c, lib/iolog/host\_port.c, lib/iolog/hostcheck.c,
  lib/iolog/iolog\_clearerr.c, lib/iolog/iolog\_close.c,
  lib/iolog/iolog\_conf.c, lib/iolog/iolog\_eof.c, lib/iolog/iolog\_filter.c,
  lib/iolog/iolog\_flush.c, lib/iolog/iolog\_gets.c, lib/iolog/iolog\_json.c,
  lib/iolog/iolog\_legacy.c, lib/iolog/iolog\_loginfo.c,
  lib/iolog/iolog\_mkdirs.c, lib/iolog/iolog\_mkdtemp.c,
  lib/iolog/iolog\_mkpath.c, lib/iolog/iolog\_nextid.c,
  lib/iolog/iolog\_open.c, lib/iolog/iolog\_openat.c,
  lib/iolog/iolog\_path.c, lib/iolog/iolog\_read.c, lib/iolog/iolog\_seek.c,
  lib/iolog/iolog\_swapids.c, lib/iolog/iolog\_timing.c,
  lib/iolog/iolog\_util.c, lib/iolog/iolog\_write.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c,
  lib/iolog/regress/host\_port/host\_port\_test.c,
  lib/iolog/regress/iolog\_filter/check\_iolog\_filter.c,
  lib/iolog/regress/iolog\_mkpath/check\_iolog\_mkpath.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c,
  lib/iolog/regress/iolog\_timing/check\_iolog\_timing.c,
  lib/logsrv/log\_server.pb-c.c, lib/protobuf-c/protobuf-c.c,
  lib/ssl\_compat/ssl\_compat.c, lib/util/aix.c, lib/util/arc4random.c,
  lib/util/arc4random\_buf.c, lib/util/arc4random\_uniform.c,
  lib/util/basename.c, lib/util/cfmakeraw.c, lib/util/closefrom.c,
  lib/util/digest.c, lib/util/digest\_gcrypt.c, lib/util/digest\_openssl.c,
  lib/util/dup3.c, lib/util/event.c, lib/util/event\_poll.c,
  lib/util/event\_select.c, lib/util/explicit\_bzero.c, lib/util/fatal.c,
  lib/util/fchmodat.c, lib/util/fchownat.c, lib/util/fnmatch.c,
  lib/util/freezero.c, lib/util/fstatat.c, lib/util/getaddrinfo.c,
  lib/util/getdelim.c, lib/util/getentropy.c, lib/util/getgrouplist.c,
  lib/util/gethostname.c, lib/util/getopt\_long.c, lib/util/gettime.c,
  lib/util/getusershell.c, lib/util/gidlist.c, lib/util/glob.c,
  lib/util/gmtime\_r.c, lib/util/hexchar.c, lib/util/inet\_ntop.c,
  lib/util/inet\_pton.c, lib/util/isblank.c, lib/util/json.c,
  lib/util/key\_val.c, lib/util/lbuf.c, lib/util/localtime\_r.c,
  lib/util/locking.c, lib/util/logfac.c, lib/util/logpri.c,
  lib/util/memrchr.c, lib/util/mkdir\_parents.c, lib/util/mkdirat.c,
  lib/util/mksiglist.c, lib/util/mksigname.c, lib/util/mktemp.c,
  lib/util/mmap\_alloc.c, lib/util/multiarch.c, lib/util/nanosleep.c,
  lib/util/openat.c, lib/util/parseln.c, lib/util/pipe2.c,
  lib/util/pread.c, lib/util/progname.c, lib/util/pw\_dup.c,
  lib/util/pwrite.c, lib/util/rcstr.c, lib/util/reallocarray.c,
  lib/util/regex.c, lib/util/regress/closefrom/closefrom\_test.c,
  lib/util/regress/digest/digest\_test.c,
  lib/util/regress/fnmatch/fnm\_test.c,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.c,
  lib/util/regress/getdelim/getdelim\_test.c,
  lib/util/regress/getgrouplist/getgids.c,
  lib/util/regress/getgrouplist/getgrouplist\_test.c,
  lib/util/regress/glob/globtest.c,
  lib/util/regress/hexchar/hexchar\_test.c,
  lib/util/regress/json/json\_test.c,
  lib/util/regress/mktemp/mktemp\_test.c,
  lib/util/regress/multiarch/multiarch\_test.c,
  lib/util/regress/open\_parent\_dir/open\_parent\_dir\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/regex/regex\_test.c,
  lib/util/regress/strsig/strsig\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/strtofoo/strtobool\_test.c,
  lib/util/regress/strtofoo/strtoid\_test.c,
  lib/util/regress/strtofoo/strtomode\_test.c,
  lib/util/regress/strtofoo/strtonum\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c, lib/util/regress/uuid/uuid\_test.c,
  lib/util/roundup.c, lib/util/secure\_path.c, lib/util/setgroups.c,
  lib/util/sha2.c, lib/util/sig2str.c, lib/util/snprintf.c,
  lib/util/str2sig.c, lib/util/strlcat.c, lib/util/strlcpy.c,
  lib/util/strndup.c, lib/util/strnlen.c, lib/util/strsignal.c,
  lib/util/strsplit.c, lib/util/strtobool.c, lib/util/strtoid.c,
  lib/util/strtomode.c, lib/util/strtonum.c, lib/util/sudo\_conf.c,
  lib/util/sudo\_debug.c, lib/util/sudo\_dso.c, lib/util/sys\_siglist.h,
  lib/util/sys\_signame.h, lib/util/term.c, lib/util/timegm.c,
  lib/util/ttyname\_dev.c, lib/util/ttysize.c, lib/util/unlinkat.c,
  lib/util/utimens.c, lib/util/uuid.c, logsrvd/iolog\_writer.c,
  logsrvd/logsrv\_util.c, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_conf.c, logsrvd/logsrvd\_journal.c,
  logsrvd/logsrvd\_local.c, logsrvd/logsrvd\_queue.c,
  logsrvd/logsrvd\_relay.c, logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c,
  logsrvd/regress/logsrvd\_conf/logsrvd\_conf\_test.c, logsrvd/sendlog.c,
  logsrvd/sendlog.h, logsrvd/tls\_client.c, logsrvd/tls\_common.h,
  logsrvd/tls\_init.c, plugins/audit\_json/audit\_json.c,
  plugins/group\_file/getgrent.c, plugins/group\_file/group\_file.c,
  plugins/group\_file/plugin\_test.c, plugins/python/pyhelpers.c,
  plugins/python/pyhelpers.h, plugins/python/python\_plugin\_common.c,
  plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/iohelpers.h,
  plugins/python/regress/testhelpers.h,
  plugins/python/sudo\_python\_debug.c, plugins/python/sudo\_python\_debug.h,
  plugins/sample/sample\_plugin.c,
  plugins/sample\_approval/sample\_approval.c, plugins/sudoers/alias.c,
  plugins/sudoers/audit.c, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/b64\_decode.c, plugins/sudoers/b64\_encode.c,
  plugins/sudoers/boottime.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/canon\_path.c, plugins/sudoers/check.c,
  plugins/sudoers/check\_aliases.c, plugins/sudoers/check\_util.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/cvtsudoers\_csv.c, plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/cvtsudoers\_merge.c,
  plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/defaults.c,
  plugins/sudoers/defaults.h, plugins/sudoers/digestname.c,
  plugins/sudoers/display.c, plugins/sudoers/editor.c,
  plugins/sudoers/env.c, plugins/sudoers/env\_pattern.c,
  plugins/sudoers/exptilde.c, plugins/sudoers/file.c,
  plugins/sudoers/filedigest.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/fmtsudoers\_cvt.c,
  plugins/sudoers/gc.c, plugins/sudoers/gentime.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/getspwuid.c, plugins/sudoers/goodpath.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/insults.h,
  plugins/sudoers/interfaces.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path\_escapes.c, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/ldap\_innetgr.c,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/locale.c, plugins/sudoers/log\_client.c,
  plugins/sudoers/log\_client.h, plugins/sudoers/logging.c,
  plugins/sudoers/lookup.c, plugins/sudoers/match.c,
  plugins/sudoers/match\_addr.c, plugins/sudoers/match\_command.c,
  plugins/sudoers/match\_digest.c, plugins/sudoers/parse.h,
  plugins/sudoers/parse\_ldif.c, plugins/sudoers/parser\_warnx.c,
  plugins/sudoers/pivot.c, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/redblack.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/editor/check\_editor.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/exptilde/check\_exptilde.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_stubs.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/serialize\_list/check\_serialize\_list.c,
  plugins/sudoers/regress/starttime/check\_starttime.c,
  plugins/sudoers/regress/unescape/check\_unesc.c,
  plugins/sudoers/resolve\_cmnd.c, plugins/sudoers/serialize\_list.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sethost.c,
  plugins/sudoers/solaris\_audit.c, plugins/sudoers/sssd.c,
  plugins/sudoers/starttime.c, plugins/sudoers/strlcpy\_unesc.c,
  plugins/sudoers/strlist.c, plugins/sudoers/strvec\_join.c,
  plugins/sudoers/stubs.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudo\_printf.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoers\_cb.c,
  plugins/sudoers/sudoers\_ctx\_free.c, plugins/sudoers/sudoers\_debug.c,
  plugins/sudoers/sudoers\_debug.h, plugins/sudoers/sudoers\_hooks.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/testsudoers\_pwutil.c,
  plugins/sudoers/testsudoers\_pwutil.h, plugins/sudoers/timeout.c,
  plugins/sudoers/timestamp.c, plugins/sudoers/timestr.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsdump.c,
  plugins/sudoers/tsgetgrpw.c, plugins/sudoers/unesc\_str.c,
  plugins/sudoers/visudo.c, plugins/sudoers/visudo\_cb.c,
  plugins/system\_group/system\_group.c, src/apparmor.c, src/conversation.c,
  src/copy\_file.c, src/edit\_open.c, src/env\_hooks.c, src/exec.c,
  src/exec\_common.c, src/exec\_intercept.c, src/exec\_iolog.c,
  src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_preload.c,
  src/exec\_ptrace.c, src/exec\_pty.c, src/get\_pty.c, src/hooks.c,
  src/intercept.pb-c.c, src/limits.c, src/load\_plugins.c, src/openbsd.c,
  src/parse\_args.c, src/preload.c, src/preserve\_fds.c,
  src/regress/net\_ifs/check\_net\_ifs.c, src/regress/noexec/check\_noexec.c,
  src/regress/ttyname/check\_ttyname.c, src/selinux.c, src/sesh.c,
  src/signal.c, src/solaris.c, src/sudo.c, src/sudo.h, src/sudo\_edit.c,
  src/sudo\_intercept.c, src/sudo\_intercept\_common.c, src/sudo\_noexec.c,
  src/suspend\_parent.c, src/tgetpass.c, src/ttyname.c, src/utmp.c:

  Use #include <foo.h> instead of #include “foo.h” in most cases.

  We rely on the include path to find many of these headers. It especially
  doesn’t make sense to use #include “foo.h” for headers in the top-level
  include directory.
  [[e343e0754]](https://git.sudo.ws/sudo/commit/?id=e343e0754)

* .circleci/config.yml:

  Bump xcode to 14.2.0
  [[884b02596]](https://git.sudo.ws/sudo/commit/?id=884b02596)

2023-09-24 Todd C. Miller

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/mkdefaults:

  Add support for “plugin” defaults type.
  [[1c13b8a62]](https://git.sudo.ws/sudo/commit/?id=1c13b8a62)

* plugins/sudoers/mkdefaults:

  Support multiple input files.
  [[c1708f0cf]](https://git.sudo.ws/sudo/commit/?id=c1708f0cf)

2023-09-22 Todd C. Miller

* src/exec\_monitor.c, src/exec\_pty.c:

  No need to loop reading from/writing to a blocking socketpair.

  This removes some infinite loops that can cause static analyzer
  warnings. The fds are not in non-blocking mode and we use restartable
  system calls so there is no need to loop.
  [[171abbe11]](https://git.sudo.ws/sudo/commit/?id=171abbe11)

* plugins/sudoers/check.c:

  check\_user: fix return value for intercept mode

  Also use early return on error to quiet a PVS-Studio warning.
  [[1c7d757b7]](https://git.sudo.ws/sudo/commit/?id=1c7d757b7)

2023-09-21 Todd C. Miller

* src/exec\_pty.c:

  Set ec->term\_raw to false even if sudo\_term\_restore() fails.

  Either the fd is not a terminal or we don’t have the controlling
  terminal. Either way, we can’t know the current status of the terminal
  and will need to set to raw mode again (if possible). Also make sure to
  set ec->term\_raw to false if sudo\_term\_raw() fails.
  [[988d7f60f]](https://git.sudo.ws/sudo/commit/?id=988d7f60f)

2023-09-20 Todd C. Miller

* pathnames.h.in, plugins/sudoers/env.c, plugins/sudoers/sudoers.c:

  Only define \_PATH\_ENVIRONMENT on systems where we use /etc/environment.
  [[f2d267bfb]](https://git.sudo.ws/sudo/commit/?id=f2d267bfb)

* config.h.in, configure, configure.ac:

  Sudo assumes that a uid\_t can be cast to unsigned int without problems.

  Add a configure check and error out if sizeof(uid\_t) > 4.
  [[0c6745692]](https://git.sudo.ws/sudo/commit/?id=0c6745692)

* docs/UPGRADE.md:

  Mention the time stamp and lecture file name changes in 1.9.15.
  [[f4acc4366]](https://git.sudo.ws/sudo/commit/?id=f4acc4366)

2023-08-24 Todd C. Miller

* NEWS, configure, configure.ac:

  sudo 1.9.15
  [[37ee2946a]](https://git.sudo.ws/sudo/commit/?id=37ee2946a)

2023-09-20 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in,
  plugins/sudoers/iolog\_path\_escapes.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Replace ‘/’ with ‘\_’ in paths using the user, group or host name.
  [[d9da92951]](https://git.sudo.ws/sudo/commit/?id=d9da92951)

2023-09-11 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in,
  docs/sudoers\_timestamp.man.in, docs/sudoers\_timestamp.mdoc.in,
  plugins/sudoers/check.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/timestamp.h:

  Use the user-ID instead of user-name for the timestamp and lecture file.

  This avoids problems if the user name itself contains a path separator.
  [[7363ad7b3]](https://git.sudo.ws/sudo/commit/?id=7363ad7b3)

2023-09-19 Todd C. Miller

* config.h.in, configure, configure.ac, m4/sudo.m4,
  plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/env.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/policy.c, src/sudo.c, src/sudo\_edit.c:

  Replace MAX\_UID\_T\_LEN with calls to STRLEN\_MAX\_UNSIGNED.
  [[94b80e3ad]](https://git.sudo.ws/sudo/commit/?id=94b80e3ad)

* include/sudo\_util.h, lib/eventlog/eventlog.c, lib/iolog/iolog\_timing.c,
  lib/util/json.c, lib/util/lbuf.c, lib/util/sudo\_debug.c,
  plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/display.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/logging.c,
  src/exec\_preload.c, src/limits.c:

  Add macros to determine the length of an integer type in string form.

  Adapted from answer #6 in:
  <https://stackoverflow.com/questions/10536207/ansi-c-maximum-number-of-ch>
  aracters-printing-a-decimal-int
  [[d53bbb54b]](https://git.sudo.ws/sudo/commit/?id=d53bbb54b)

2023-09-18 Todd C. Miller

* plugins/sudoers/visudo.c:

  visudo: use verbose and strict in parser\_conf

  Where the sudoers\_context is available we can use the values of verbose
  and strict instead of passing around quiet and strict flags.
  [[221a10340]](https://git.sudo.ws/sudo/commit/?id=221a10340)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/find\_path.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/resolve\_cmnd.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Add resolve\_cmnd(), a wrapper around find\_path().

  This is a convenience function that sets PERM\_RUNAS and calls
  find\_path(). If the command is not found it will retry with PERM\_USER
  instead.
  [[6e75f2311]](https://git.sudo.ws/sudo/commit/?id=6e75f2311)

* plugins/sudoers/sudoers.h, plugins/sudoers/visudo.c:

  Promote strict field in sudoers\_parser\_config from bool to int.

  This will be used by visudo to indicate when “visudo -s” is run.
  [[8fcb21b5c]](https://git.sudo.ws/sudo/commit/?id=8fcb21b5c)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/check\_aliases.c,
  plugins/sudoers/defaults.c, plugins/sudoers/parse.h,
  plugins/sudoers/parser\_warnx.c:

  Add parser\_warnx() and parser\_vwarnx() that displays file:line:col

  Used by defaults.c and check\_aliases.c.
  [[e28dc0f27]](https://git.sudo.ws/sudo/commit/?id=e28dc0f27)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/visudo.c,
  plugins/sudoers/visudo\_cb.c:

  Add a separate file for visudo callbacks.
  [[3a7731437]](https://git.sudo.ws/sudo/commit/?id=3a7731437)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoers\_cb.c:

  Rename callbacks.c -> sudoers\_cb.c.
  [[c277e55f4]](https://git.sudo.ws/sudo/commit/?id=c277e55f4)

* src/exec\_monitor.c:

  Wait on a socketpair for the parent to grant child the controlling tty.

  This upgrades the error pipe to a bi-directional socketpair that the
  parent will write to after it has granted the child process the
  controlling terminal. That fixes an issue where the child could end up
  in a tight CPU loop waiting on the parent which may not be scheduled
  immediately.
  [[0cb3e3344]](https://git.sudo.ws/sudo/commit/?id=0cb3e3344)

2023-09-15 Todd C. Miller

* plugins/sudoers/sudoers.h:

  Undefine AUTH\_{SUCCESS,FAILURE,ERROR} before defining them.

  Quiets a warning on AIX where usersec.h defines AUTH\_SUCCESS and
  AUTH\_FAILURE. We avoided this problem in the past because the old values
  for AUTH\_SUCCESS and AUTH\_FAILURE match what AIX defines.
  [[a127ddf6d]](https://git.sudo.ws/sudo/commit/?id=a127ddf6d)

* config.h.in, configure, configure.ac, lib/util/term.c, m4/sudo.m4,
  src/exec\_pty.c:

  Only cast TIOCSWINSZ to int on systems that might require it (AIX).

  Otherwise we end up with a -Wconversion warning on systems where the
  ioctl() request argument is unsigned long.
  [[49c7c1f4d]](https://git.sudo.ws/sudo/commit/?id=49c7c1f4d)

* plugins/sudoers/display.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Promote verbose flag to int for display\_privs and display\_cmnd.

  A negative verbosity will prevent non-error output from being displayed.
  [[51d6b0f42]](https://git.sudo.ws/sudo/commit/?id=51d6b0f42)

2023-09-13 Todd C. Miller

* plugins/sudoers/stubs.c:

  No need to include cvtsudoers.h here.
  [[a9ee97580]](https://git.sudo.ws/sudo/commit/?id=a9ee97580)

* plugins/sudoers/match\_command.c, plugins/sudoers/pivot.c,
  plugins/sudoers/pivot.h, plugins/sudoers/regress/fuzz/fuzz\_stubs.c,
  plugins/sudoers/stubs.c, plugins/sudoers/testsudoers.c:

  Remove pivot\_get\_root() and pivot\_get\_cwd().

  They are unnecessary since struct sudoers\_pivot is not opaque. The
  implementation details are private to match\_command.c.
  [[0011333f8]](https://git.sudo.ws/sudo/commit/?id=0011333f8)

* plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/parser/check\_fill.c:

  Quiet some -Wconversion warnings in the tests.
  [[2aae36f34]](https://git.sudo.ws/sudo/commit/?id=2aae36f34)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/editor.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/regress/editor/check\_editor.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.h:

  Make flag in union sudo\_defs\_val bool to match how it is used.

  Adjust find\_path()’s ignore\_dot function argument to match.
  [[b8f2680cf]](https://git.sudo.ws/sudo/commit/?id=b8f2680cf)

* plugins/sudoers/audit.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/bsm\_audit.h, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h:

  Parse euid and egid from sudo front-end.

  These are needed by bsm\_audit.c.
  [[a9801cc99]](https://git.sudo.ws/sudo/commit/?id=a9801cc99)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/timestamp.c:

  Parse pid and ppid from sudo front-end.

  We can now use the stored ppid in ts\_init\_key().
  [[38ddbb14f]](https://git.sudo.ws/sudo/commit/?id=38ddbb14f)

* plugins/sudoers/match\_command.c, plugins/sudoers/pivot.c,
  plugins/sudoers/pivot.h, plugins/sudoers/regress/fuzz/fuzz\_stubs.c,
  plugins/sudoers/stubs.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c:

  Use struct sudoers\_pivot instead of defining sudoers\_pivot\_t.

  We want to pass around a pointer, not the struct itself.
  [[34990c0e0]](https://git.sudo.ws/sudo/commit/?id=34990c0e0)

2023-09-11 Todd C. Miller

* MANIFEST, plugins/sudoers/pivot.h:

  Don’t expose the implementation of the pivot\_root state.
  [[15b3d786d]](https://git.sudo.ws/sudo/commit/?id=15b3d786d)

* plugins/sudoers/match\_command.c, plugins/sudoers/pivot.c,
  plugins/sudoers/regress/fuzz/fuzz\_stubs.c, plugins/sudoers/stubs.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c:

  Don’t expose the implementation of the pivot\_root state.
  [[0b52ffd1a]](https://git.sudo.ws/sudo/commit/?id=0b52ffd1a)

* src/exec\_ptrace.c:

  Only call ptrace\_verify\_post\_exec() for intercept, not log\_subcmds.

  This fixes a logic goof introduced in sudo 1.9.14.
  [[4117ad146]](https://git.sudo.ws/sudo/commit/?id=4117ad146)

2023-09-10 Todd C. Miller

* plugins/sudoers/Makefile.in:

  tsgetusershell.c: don’t rely on GNU sed extensions.
  [[c0553cd38]](https://git.sudo.ws/sudo/commit/?id=c0553cd38)

* plugins/sudoers/testsudoers.c:

  testsudoers: add -S option to specify /etc/shells path.
  [[0a8586928]](https://git.sudo.ws/sudo/commit/?id=0a8586928)

* Makefile.in, lib/util/getusershell.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/tsgetgrpw.h:

  Add testsudoers\_setshellfile() and use it in testsudoers.
  [[034b2f3bd]](https://git.sudo.ws/sudo/commit/?id=034b2f3bd)

* plugins/sudoers/Makefile.in:

  regen
  [[62b92c7fb]](https://git.sudo.ws/sudo/commit/?id=62b92c7fb)

* lib/util/Makefile.in, lib/util/getusershell.c:

  Remove unnecessary sudo\_gettext.h include and add missing const.
  [[166ef55aa]](https://git.sudo.ws/sudo/commit/?id=166ef55aa)

2023-09-09 Todd C. Miller

* plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/check.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/timestamp.h:

  Return AUTH\_\* flags from check\_user() instead of 1/0/-1.
  [[c54bdd799]](https://git.sudo.ws/sudo/commit/?id=c54bdd799)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil.h, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/testsudoers\_pwutil.h:

  Wrap valid\_shell and add to sudo\_pwutil\_set\_backend().

  This will make it possible to support a different getusershell()
  implementation for testsudoers in the future.
  [[2fdb4db33]](https://git.sudo.ws/sudo/commit/?id=2fdb4db33)

* plugins/sudoers/check\_util.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil.h, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c:

  Move check\_user\_shell() to pwutil.c as user\_shell\_valid()

  This will make it possible to support a different backend which may be
  used by testsudoers in the future.
  [[d18ee8e0e]](https://git.sudo.ws/sudo/commit/?id=d18ee8e0e)

* plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/check.c,
  plugins/sudoers/timestamp.h:

  Merge check\_user() and check\_user\_interactive(), move getpass callbacks.

  The getpass callbacks are now defined in sudo\_auth.c, which implements
  auth\_getpass(). As a result, struct getpass\_closure is now public and
  defined in timestamp.h.
  [[28a13501d]](https://git.sudo.ws/sudo/commit/?id=28a13501d)

* plugins/sudoers/Makefile.in, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/check.c,
  plugins/sudoers/timestamp.h:

  Make most sudo\_auth functions return AUTH\_{SUCCESS,FAILURE,FATAL}.
  [[0495afac5]](https://git.sudo.ws/sudo/commit/?id=0495afac5)

* plugins/sudoers/ldap.c, plugins/sudoers/lookup.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/match\_digest.c,
  plugins/sudoers/parse.h, plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/sssd.c:

  Make all match functions return ALLOW/DENY not true/false.
  [[2ef90231a]](https://git.sudo.ws/sudo/commit/?id=2ef90231a)

* plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/lookup.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.h:

  Try to make sudo less vulnerable to ROWHAMMER attacks.

  We now use ROWHAMMER-resistent values for ALLOW, DENY, AUTH\_SUCCESS,
  AUTH\_FAILURE, AUTH\_ERROR and AUTH\_NONINTERACTIVE. In addition, we
  explicitly test for expected values instead of using a negated test
  against an error value. In the parser match functions this means
  explicitly checking for ALLOW or DENY instead of accepting anything that
  is not set to UNSPEC.

  Thanks to Andrew J. Adiletta, M. Caner Tol, Yarkin Doroz, and Berk
  Sunar, all affiliated with the Vernam Applied Cryptography and
  Cybersecurity Lab at Worcester Polytechnic Institute, for the report.
  Paper preprint: <https://arxiv.org/abs/2309.02545>
  [[7873f8334]](https://git.sudo.ws/sudo/commit/?id=7873f8334)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l:

  Honor ignore\_perms plugin argument for @include and @includedir.
  [[525803db2]](https://git.sudo.ws/sudo/commit/?id=525803db2)

2023-09-06 Todd C. Miller

* plugins/sudoers/check.c:

  Don’t set on\_suspend and on\_resume twice.
  [[499121229]](https://git.sudo.ws/sudo/commit/?id=499121229)

2023-09-02 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers.h, plugins/sudoers/policy.c,
  plugins/sudoers/sethost.c, plugins/sudoers/stubs.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  sudoers\_sethost: refactor code to set host names in sudoers\_context.

  The sudoers\_sethost() function can be shared by the sudoers plugin,
  visudo, cvtsudoers and testsudoers.
  [[956de5cbb]](https://git.sudo.ws/sudo/commit/?id=956de5cbb)

2023-09-01 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  sudoers\_trace\_print: use debug\_decl\_vars instead of doing it by hand.
  [[0c9ca88f5]](https://git.sudo.ws/sudo/commit/?id=0c9ca88f5)

* include/sudo\_compat.h:

  sudo\_realpath() returns char \*, not void \*.
  [[080e08b0f]](https://git.sudo.ws/sudo/commit/?id=080e08b0f)

2023-08-31 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Only print “no valid sudoers sources found, quitting” for multiple
  sources.

  If there is only a single source (usually the sudoers file), the open
  function provide enough of an error message. Printing two error messages
  is just confusing.
  [[d898d073b]](https://git.sudo.ws/sudo/commit/?id=d898d073b)

2023-08-30 Todd C. Miller

* plugins/sudoers/pwutil.c:

  user\_in\_group: the user’s group vector already includes the primary
  group.

  There’s no need to look up the name of user’s primary group (pw\_gid), we
  always include the primary group ID in the group vector.
  [[f5b3f9909]](https://git.sudo.ws/sudo/commit/?id=f5b3f9909)

2023-08-29 Todd C. Miller

* plugins/sudoers/sudoers.h, plugins/sudoers/sudoers\_debug.h:

  Move sudoers\_debug.c prototypes to sudoers\_debug.h.
  [[05f823df2]](https://git.sudo.ws/sudo/commit/?id=05f823df2)

* plugins/sudoers/sudoers.h:

  sudo\_conv, sudo\_printf and plugin\_event\_alloc live in policy.c.
  [[35a7283dd]](https://git.sudo.ws/sudo/commit/?id=35a7283dd)

* include/sudo\_iolog.h, plugins/sudoers/defaults.c:

  Move default value for “iolog\_file” to sudo\_iolog.h.
  [[68a9e9186]](https://git.sudo.ws/sudo/commit/?id=68a9e9186)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/callbacks.c, plugins/sudoers/check.c,
  plugins/sudoers/policy.c, plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_stubs.c,
  plugins/sudoers/regress/starttime/check\_starttime.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/starttime.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/timestamp.c, plugins/sudoers/timestamp.h,
  plugins/sudoers/tsdump.c:

  Rename check.h -> timestamp.h and add remaining timestamp.c prototypes.
  [[75209e271]](https://git.sudo.ws/sudo/commit/?id=75209e271)

* plugins/sudoers/auth/API, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/auth/sudo\_auth.h:

  Restore AUTH\_INTR support, it is still needed.

  We still need AUTH\_INTR to know when to break out of the password prompt
  loop.
  [[8cd0d74fb]](https://git.sudo.ws/sudo/commit/?id=8cd0d74fb)

* docs/sudoers.man.in, docs/sudoers.mdoc.in, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Add ignore\_perms plugin argument to skip the sudoers file security
  checks.

  This is not intended to be used in a production environment.
  [[3c05e748a]](https://git.sudo.ws/sudo/commit/?id=3c05e748a)

2023-08-28 Todd C. Miller

* configure, m4/sudo.m4:

  Fix test for unsetenv() returning void with clang 16.

  Clang has dropped support for K&R function definitions so rewrite the
  test to require a unsetenv() prototype in stdlib.h. Fixes [GitHub issue
  #302](https://github.com/sudo-project/sudo/issues/302).
  [[1eb4392e1]](https://git.sudo.ws/sudo/commit/?id=1eb4392e1)

* plugins/sudoers/defaults.c:

  Disable fast\_glob and fdexec if SUDOERS\_NAME\_MATCH is defined.

  We use SUDOERS\_NAME\_MATCH for fuzzing when we want to avoid searching
  the file system for commands.
  [[07003d902]](https://git.sudo.ws/sudo/commit/?id=07003d902)

2023-08-26 Todd C. Miller

* plugins/sudoers/auth/API, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h:

  Rename AUTH\_FATAL -> AUTH\_ERROR.
  [[c858acc48]](https://git.sudo.ws/sudo/commit/?id=c858acc48)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/match.c:

  Do not rely on the definition of ALLOW/DENY being true/false.

  We now explicitly check for ALLOW and DENY when checking return values
  and negating values.
  [[cf00568d8]](https://git.sudo.ws/sudo/commit/?id=cf00568d8)

* plugins/sudoers/auth/API, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/auth/sudo\_auth.h:

  Replace AUTH\_INTR return with AUTH\_FAILURE.

  The two were treated identically by the caller.
  [[bae716642]](https://git.sudo.ws/sudo/commit/?id=bae716642)

2023-08-25 Todd C. Miller

* plugins/sudoers/audit.c:

  Call log\_allowed() even when “log\_allowed” is disabled.

  Otherwise, sudo will not send mail if “mail\_always” or “mail\_all\_cmnds”
  is set.
  [[b42cab112]](https://git.sudo.ws/sudo/commit/?id=b42cab112)

* plugins/sudoers/defaults.c:

  Don’t set defaults values for features that are not present.

  This means that lecture\_status\_dir and timestampdir are only set if
  \_PATH\_SUDO\_LECTURE\_DIR and \_PATH\_SUDO\_TIMEDIR respectively are set.
  Also, the log server defaults are only set when SUDOERS\_LOG\_CLIENT is
  defined.
  [[4cdee2e31]](https://git.sudo.ws/sudo/commit/?id=4cdee2e31)

* plugins/sudoers/callbacks.c:

  Only set I/O logging callbacks if SESSID\_MAX is defined.
  [[993ee338d]](https://git.sudo.ws/sudo/commit/?id=993ee338d)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Move tty\_present() into policy.c as sudoers\_tty\_present().

  This function is policy-dependent. For the modern sudo front-end it will
  simply check tcpgid and/or ttypath.
  [[30fc28829]](https://git.sudo.ws/sudo/commit/?id=30fc28829)

2023-08-23 Todd C. Miller

* lib/util/event\_poll.c, lib/util/getentropy.c, plugins/sudoers/ldap.c:

  Silence a few remaining -Wconversion warnings.
  [[df969d30b]](https://git.sudo.ws/sudo/commit/?id=df969d30b)

* plugins/sudoers/sudoers.c:

  No need to inclue auth/sudo\_auth.h
  [[522ac12f2]](https://git.sudo.ws/sudo/commit/?id=522ac12f2)

* configure, m4/sudo.m4:

  –enable-pvs-studio: check for license file in the default location
  [[18aba4984]](https://git.sudo.ws/sudo/commit/?id=18aba4984)

2023-08-23 ken

* plugins/sudoers/timestamp.c:

  modify ret type from int to bool (#298)

  + modify ret type from int to bool
  + change debug\_return\_int to debug\_return\_bool
  + modify ret type
    [[60e584201]](https://git.sudo.ws/sudo/commit/?id=60e584201)

2023-08-22 Todd C. Miller

* plugins/sudoers/callbacks.c, plugins/sudoers/check.h,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_stubs.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/timestamp.c:

  Move timestampowner sudoers callback to timestamp.c.
  [[091051125]](https://git.sudo.ws/sudo/commit/?id=091051125)

* plugins/sudoers/set\_perms.c:

  Quiet a PVS-Studio false positive about possible NULL dereference.

  set\_perms() is only called with a NULL ctx for PERM\_ROOT, PERM\_SUDOERS
  and PERM\_TIMESTAMP.
  [[593998cb6]](https://git.sudo.ws/sudo/commit/?id=593998cb6)

2023-08-21 Todd C. Miller

* plugins/sudoers/set\_perms.c:

  set\_perms: ctx may be NULL for PERM\_ROOT, PERM\_SUDOERS, PERM\_TIMESTAMP.
  [[821799d1f]](https://git.sudo.ws/sudo/commit/?id=821799d1f)

* plugins/sudoers/audit.c, plugins/sudoers/iolog\_path\_escapes.c,
  plugins/sudoers/logging.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoers\_ctx\_free.c:

  Move a few fields from sudoers\_user\_contect to sudoers\_context.

  They are not really specific to the user or user-specified.
  [[c7157ce0b]](https://git.sudo.ws/sudo/commit/?id=c7157ce0b)

* plugins/sudoers/policy.c:

  Remove dead code dealing with unknown user and MODE\_INVALIDATE.

  The timestamp unlink code does not need the user’s struct passwd
  pointer, just the user name (which we already have). Found by
  PVS-Studio.
  [[9aaba80a0]](https://git.sudo.ws/sudo/commit/?id=9aaba80a0)

* lib/iolog/iolog\_read.c, lib/iolog/iolog\_write.c, lib/util/sudo\_dso.c:

  Suppress some other PVS-Studio false positives.
  [[df730dec5]](https://git.sudo.ws/sudo/commit/?id=df730dec5)

* plugins/sudoers/set\_perms.c:

  Quiet a PVS-Studio false positive about possible NULL dereference.

  set\_perms() is only called with a NULL ctx for PERM\_ROOT, PERM\_SUDOERS
  and PERM\_TIMESTAMP.
  [[49cd7463c]](https://git.sudo.ws/sudo/commit/?id=49cd7463c)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.h:

  MODE\_KILL is never set in the sudoers plugin, remove it.
  [[816120544]](https://git.sudo.ws/sudo/commit/?id=816120544)

* plugins/sample/sample\_plugin.c, plugins/sudoers/editor.c,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoreplay.c, src/exec\_ptrace.c:

  Cast int to size\_t before adding instead of casting the result.

  Quiets PVS-Studio warning V1028.
  [[c6987aa26]](https://git.sudo.ws/sudo/commit/?id=c6987aa26)

* plugins/sudoers/audit.c:

  Fix log\_server\_accept() definition for –disable-log-client builds.
  [[9f05bfd29]](https://git.sudo.ws/sudo/commit/?id=9f05bfd29)

* src/exec\_pty.c:

  Use a global static struct exec\_closure for the cleanup hook.

  This is safer than storing a pointer to a stack variable in the cleanup
  function since we don’t need to worry about it ever going out of scope.
  Quiets a clang 15 analyzer warning.
  [[e933fc7ba]](https://git.sudo.ws/sudo/commit/?id=e933fc7ba)

* plugins/sudoers/logging.c:

  Plug memory leak if journal\_parse\_error() fails.

  Found by the clang 15 analyzer.
  [[6fa478653]](https://git.sudo.ws/sudo/commit/?id=6fa478653)

* lib/eventlog/eventlog.c, plugins/sudoers/testsudoers.c:

  Eliminate some clang analyzer false positives.
  [[46e6955ba]](https://git.sudo.ws/sudo/commit/?id=46e6955ba)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Move sudoedit\_nfiles into struct sudoers\_context.
  [[ff5914d7f]](https://git.sudo.ws/sudo/commit/?id=ff5914d7f)

* plugins/sudoers/audit.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/check.c, plugins/sudoers/env.c,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/lookup.c, plugins/sudoers/policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c:

  Move sudo\_mode into struct sudoers\_context.
  [[3473bf936]](https://git.sudo.ws/sudo/commit/?id=3473bf936)

* plugins/sudoers/audit.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoers\_ctx\_free.c:

  Move NewArgv, NewArgc and saved\_argv into struct sudoers\_context.
  [[837da1bef]](https://git.sudo.ws/sudo/commit/?id=837da1bef)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/file.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.h,
  plugins/sudoers/policy.c, plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Add struct sudoers\_conf to struct sudoers\_plugin\_context.

  There’s now no need to pass this directly to init\_parser() since we
  already pass in a pointer to a sudoers\_context struct.
  [[87571dab0]](https://git.sudo.ws/sudo/commit/?id=87571dab0)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/ldap.c, plugins/sudoers/ldap\_conf.c,
  plugins/sudoers/policy.c, plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c,
  plugins/sudoers/sudo\_ldap\_conf.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Store policy paths in struct sudoers\_context.

  This removes the need for the getters in policy.c.
  [[9e53d903e]](https://git.sudo.ws/sudo/commit/?id=9e53d903e)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/stubs.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoers\_ctx\_free.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Add sudoers\_ctx\_free() and use it for freeing struct sudoers context.

  This replaces sudoers\_user\_ctx\_free() and sudoers\_runas\_ctx\_free().
  [[bbaf29391]](https://git.sudo.ws/sudo/commit/?id=bbaf29391)

* plugins/sudoers/audit.c, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/callbacks.c,
  plugins/sudoers/check.c, plugins/sudoers/check.h,
  plugins/sudoers/check\_aliases.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers.h, plugins/sudoers/cvtsudoers\_pwutil.c,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/display.c, plugins/sudoers/env.c,
  plugins/sudoers/file.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path\_escapes.c, plugins/sudoers/ldap.c,
  plugins/sudoers/locale.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/lookup.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_command.c,
  plugins/sudoers/parse.h, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil.h, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/regress/exptilde/check\_exptilde.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_stubs.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/solaris\_audit.c,
  plugins/sudoers/solaris\_audit.h, plugins/sudoers/sssd.c,
  plugins/sudoers/stubs.c, plugins/sudoers/sudo\_nss.h,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/testsudoers\_pwutil.h,
  plugins/sudoers/timestamp.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/visudo.c:

  Make struct sudoers\_context private to sudoers.c.

  We now pass a pointer to the context where necessary. There are a few
  cases where we need to request the context from sudoers via
  sudoers\_get\_context() for the plugin API functions. If the plugin API
  was able to pass around a closure pointer this would not be necessary.
  [[244017495]](https://git.sudo.ws/sudo/commit/?id=244017495)

2023-08-20 Todd C. Miller

* plugins/sudoers/audit.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/callbacks.c,
  plugins/sudoers/check.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/defaults.c, plugins/sudoers/display.c,
  plugins/sudoers/env.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/iolog\_path\_escapes.c, plugins/sudoers/ldap.c,
  plugins/sudoers/logging.c, plugins/sudoers/lookup.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_command.c,
  plugins/sudoers/policy.c, plugins/sudoers/prompt.c,
  plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/regress/exptilde/check\_exptilde.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/solaris\_audit.c,
  plugins/sudoers/sssd.c, plugins/sudoers/stubs.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/visudo.c:

  Add a sudoers\_context struct that embeds the user and runas structs.
  [[2d2529a15]](https://git.sudo.ws/sudo/commit/?id=2d2529a15)

2023-08-18 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  free\_parse\_tree: clear the nss pointer when freeing.
  [[1b9fb405a]](https://git.sudo.ws/sudo/commit/?id=1b9fb405a)

* plugins/sudoers/parse\_ldif.c:

  sudoers\_parse\_ldif: do not free parse\_tree before using

  The user is expected to pass in an initialized and empty parse\_tree so
  there is no need to free it first.
  [[a712af5a2]](https://git.sudo.ws/sudo/commit/?id=a712af5a2)

* lib/zlib/adler32.c, lib/zlib/compress.c, lib/zlib/crc32.c,
  lib/zlib/deflate.c, lib/zlib/deflate.h, lib/zlib/gzclose.c,
  lib/zlib/gzguts.h, lib/zlib/gzlib.c, lib/zlib/gzread.c,
  lib/zlib/gzwrite.c, lib/zlib/infback.c, lib/zlib/inffast.c,
  lib/zlib/inffast.h, lib/zlib/inflate.c, lib/zlib/inftrees.c,
  lib/zlib/inftrees.h, lib/zlib/trees.c, lib/zlib/uncompr.c,
  lib/zlib/zconf.h.in, lib/zlib/zlib.h, lib/zlib/zutil.c,
  lib/zlib/zutil.h:

  Update embedded copy of zlib to version 1.3.
  [[902453a82]](https://git.sudo.ws/sudo/commit/?id=902453a82)

2023-08-15 Todd C. Miller

* plugins/sudoers/pwutil\_impl.c:

  We still need to clamp ngids if getgrouplist2() returns -1.

  Otherwise, we end up with ngids set to the number of gids the user
  belongs to which may be larger than what the front-end specified. Fixes
  a regression introduced in the last commit here.
  [[cb01b90a5]](https://git.sudo.ws/sudo/commit/?id=cb01b90a5)

2023-08-14 Todd C. Miller

* plugins/sudoers/policy.c:

  No need to clear errno when using sudo\_strtonum().
  [[f17aebe6a]](https://git.sudo.ws/sudo/commit/?id=f17aebe6a)

* plugins/sudoers/policy.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/sudoers.h:

  Move max\_groups out of sudoers\_user\_context and into pwutil.c.

  It is only used by the local password pwutil implementation.
  [[20baa3900]](https://git.sudo.ws/sudo/commit/?id=20baa3900)

* plugins/sudoers/check\_util.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c:

  Pass in directory to check\_user\_runchroot() and check\_user\_runcwd().

  This way we do not rely on the runas\_ctx global.
  [[737354390]](https://git.sudo.ws/sudo/commit/?id=737354390)

* plugins/sudoers/regress/exptilde/check\_exptilde.c:

  check\_exptilde: don’t need runas\_ctx here
  [[2e8648ea0]](https://git.sudo.ws/sudo/commit/?id=2e8648ea0)

* plugins/sudoers/match.c, plugins/sudoers/policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c:

  Move RUNAS\_{USER,GROUP}\_SPECIFIED flags into struct
  sudoers\_runas\_context.
  [[08afb5183]](https://git.sudo.ws/sudo/commit/?id=08afb5183)

2023-08-13 Todd C. Miller

* plugins/sudoers/group\_plugin.c, plugins/sudoers/policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c:

  Make path\_plugin\_dir private to policy.c and add getter.
  [[392f0d61c]](https://git.sudo.ws/sudo/commit/?id=392f0d61c)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/logging.c, plugins/sudoers/lookup.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Move list\_pw global into struct runas\_context.
  [[217b7b46f]](https://git.sudo.ws/sudo/commit/?id=217b7b46f)

2023-08-12 Todd C. Miller

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/callbacks.c,
  plugins/sudoers/check.c, plugins/sudoers/check\_util.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/display.c,
  plugins/sudoers/env.c, plugins/sudoers/iolog\_path\_escapes.c,
  plugins/sudoers/ldap.c, plugins/sudoers/logging.c,
  plugins/sudoers/lookup.c, plugins/sudoers/match.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c,
  plugins/sudoers/regress/exptilde/check\_exptilde.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sssd.c,
  plugins/sudoers/stubs.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Add struct sudoers\_runas\_context and move runas-specific bits into it.
  [[a321e6ced]](https://git.sudo.ws/sudo/commit/?id=a321e6ced)

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/callbacks.c, plugins/sudoers/check.c,
  plugins/sudoers/check\_util.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/display.c, plugins/sudoers/env.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/iolog\_path\_escapes.c,
  plugins/sudoers/ldap.c, plugins/sudoers/logging.c,
  plugins/sudoers/lookup.c, plugins/sudoers/match.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/solaris\_audit.c,
  plugins/sudoers/sssd.c, plugins/sudoers/stubs.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/visudo.c:

  Expand the user\_\* (and more) macros to user\_ctx.foo.
  [[d8b28dad9]](https://git.sudo.ws/sudo/commit/?id=d8b28dad9)

* plugins/sudoers/check.h, plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/timestamp.c:

  Pass explicit struct passwd \* to create\_admin\_success\_flag().
  [[930ca0025]](https://git.sudo.ws/sudo/commit/?id=930ca0025)

* plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Make sudoers\_user\_ctx\_free() private to sudoers.c
  [[30c49288f]](https://git.sudo.ws/sudo/commit/?id=30c49288f)

* plugins/sudoers/audit.c, plugins/sudoers/callbacks.c,
  plugins/sudoers/check.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/defaults.c, plugins/sudoers/display.c,
  plugins/sudoers/logging.c, plugins/sudoers/lookup.c,
  plugins/sudoers/match.c, plugins/sudoers/policy.c,
  plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/regress/exptilde/check\_exptilde.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestamp.c, plugins/sudoers/visudo.c:

  Rename struct sudo\_user -> struct sudo\_user\_context.

  Also rename the sudo\_user global to user\_ctx.
  [[bd8cccb5d]](https://git.sudo.ws/sudo/commit/?id=bd8cccb5d)

* src/exec.c:

  fd\_matches\_tty: only zero out fd\_sb if fstat(2) fails.

  We need to preserve the contents of the struct stat if the fd is some
  other type so the check for piped output works correctly. [Bug
  #1057](https://bugzilla.sudo.ws/show_bug.cgi?id=1057)
  [[d148e7d8f]](https://git.sudo.ws/sudo/commit/?id=d148e7d8f)

2023-08-10 Todd C. Miller

* plugins/sudoers/callbacks.c:

  Leave the I/O log callbacks in iolog.c

  Otherwise, check\_iolog\_plugin will not link.
  [[6f659e2de]](https://git.sudo.ws/sudo/commit/?id=6f659e2de)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/callbacks.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c:

  Move sudoers parser callbacks to callbacks.c.
  [[603148e7f]](https://git.sudo.ws/sudo/commit/?id=603148e7f)

2023-08-09 Todd C. Miller

* logsrvd/sendlog.c:

  Bump info\_msgs\_size to make room for the source.
  [[cc15f847a]](https://git.sudo.ws/sudo/commit/?id=cc15f847a)

* .circleci/config.yml:

  Update Xcode version from 13.2.1 to 13.4.1.
  [[ee5cab977]](https://git.sudo.ws/sudo/commit/?id=ee5cab977)

* include/sudo\_event.h, lib/util/event.c, lib/util/event\_poll.c,
  lib/util/event\_select.c, lib/util/util.exp.in:

  Use int, not short for events in the event API.

  This fixes some -Wconversion warnings and fixes an inconsistency between
  the libsudo\_util event API and the plugin event API. The actual struct
  internals still use shorts to avoid changing the ABI.
  [[811051d32]](https://git.sudo.ws/sudo/commit/?id=811051d32)

* plugins/sudoers/display.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/fmtsudoers\_cvt.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c:

  Use const pointers where possible in the display code.
  [[0f2e5dae9]](https://git.sudo.ws/sudo/commit/?id=0f2e5dae9)

* docs/sudo.man.in, docs/sudo.mdoc.in:

  Document “sudo -ll command” output.
  [[6842dd1bf]](https://git.sudo.ws/sudo/commit/?id=6842dd1bf)

* plugins/sudoers/display.c, plugins/sudoers/lookup.c,
  plugins/sudoers/parse.h, plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c:

  Add verbose version of “sudo -l command” by using an extra -l.

  The output of “sudo -ll command” consists of the matching sudoers rule
  (in long form) with the addition of a “Matched” entry that shows the
  fully-qualfied path along with any arguments.
  [[60eef27e6]](https://git.sudo.ws/sudo/commit/?id=60eef27e6)

* plugins/sudoers/display.c:

  Move code to display a cmndspec in long form to display\_cmndspec\_long().
  [[f6291bf83]](https://git.sudo.ws/sudo/commit/?id=f6291bf83)

* plugins/sudoers/display.c:

  sudo -ll: display the sudoers file the rule came from.
  [[5a1a3ff74]](https://git.sudo.ws/sudo/commit/?id=5a1a3ff74)

2023-08-08 Todd C. Miller

* plugins/sudoers/iolog.c, plugins/sudoers/log\_client.c,
  plugins/sudoers/logging.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Store the source of the matching rule and store in the event log.

  The JSON logs will store the matching rule source.
  [[e178b8582]](https://git.sudo.ws/sudo/commit/?id=e178b8582)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  lib/eventlog/eventlog\_free.c, lib/eventlog/parse\_json.c,
  lib/eventlog/regress/eventlog\_store/test1.json.in,
  lib/eventlog/regress/eventlog\_store/test1.json.out.ok,
  lib/eventlog/regress/eventlog\_store/test2.json.in,
  lib/eventlog/regress/eventlog\_store/test2.json.out.ok,
  lib/eventlog/regress/eventlog\_store/test3.json.in,
  lib/eventlog/regress/eventlog\_store/test3.json.out.ok,
  lib/eventlog/regress/eventlog\_store/test4.json.in,
  lib/eventlog/regress/eventlog\_store/test4.json.out.ok,
  logsrvd/iolog\_writer.c, logsrvd/sendlog.c:

  Log source in JSON logs

  This makes it possible to tell which rule resulted in a match.
  [[0b03511b8]](https://git.sudo.ws/sudo/commit/?id=0b03511b8)

2023-08-07 Todd C. Miller

* plugins/sudoers/lookup.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c:

  Use a single callback for sudoers\_lookup() and add a closure pointer.

  The single callback now receives all the match info (or UNSPEC if no
  match was attempted). This makes it possible to use the callback for
  more than just printing testsudoers output.
  [[f6a9bb2e2]](https://git.sudo.ws/sudo/commit/?id=f6a9bb2e2)

2023-08-08 Todd C. Miller

* lib/ssl\_compat/ssl\_compat.c, logsrvd/logsrvd.c, logsrvd/logsrvd\_relay.c,
  logsrvd/sendlog.c, plugins/sudoers/log\_client.c:

  Fix checking of SSL\_{read,write}\_ex() return value.

  These have a boolean-style return value. However, our emulated versions
  can return -1 on error, which we need to preserve for older versions of
  SSL\_get\_error() which expect it.
  [[1e6c5f3e7]](https://git.sudo.ws/sudo/commit/?id=1e6c5f3e7)

2023-08-07 Todd C. Miller

* lib/util/regress/digest/digest\_test.c:

  Fix printf format string mismatch now that ‘i’ is size\_t.
  [[5f2a0a70e]](https://git.sudo.ws/sudo/commit/?id=5f2a0a70e)

* include/sudo\_digest.h, lib/util/digest.c, lib/util/digest\_gcrypt.c,
  lib/util/digest\_openssl.c, lib/util/getentropy.c,
  lib/util/regress/digest/digest\_test.c, lib/util/util.exp.in,
  plugins/sudoers/filedigest.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  sudo\_digest\_getlen: return size\_t, and 0 on error instead of -1

  This is an API change, sudo\_digest\_getlen\_v1 remains for binary
  compatibility.
  [[77f94f291]](https://git.sudo.ws/sudo/commit/?id=77f94f291)

* logsrvd/logsrvd\_relay.c, logsrvd/sendlog.c,
  plugins/sudoers/log\_client.c:

  ERR\_get\_error() returns unsigned long, not int.
  [[184e03b4a]](https://git.sudo.ws/sudo/commit/?id=184e03b4a)

* plugins/sudoers/log\_client.c:

  We now must pass “err” SSL\_get\_error(), not “nread”.
  [[861ed2b7d]](https://git.sudo.ws/sudo/commit/?id=861ed2b7d)

2023-08-06 Todd C. Miller

* include/hostcheck.h, lib/iolog/hostcheck.c:

  Move compat definition of ASN1\_STRING\_get0\_data to hostcheck.c. It is
  not used anywhere else.
  [[e5f2354c8]](https://git.sudo.ws/sudo/commit/?id=e5f2354c8)

2023-08-05 Todd C. Miller

* include/hostcheck.h, include/sudo\_compat.h, include/sudo\_ssl\_compat.h:

  Move OpenSSL compat defines to sudo\_ssl\_compat.h
  [[fc7bfd504]](https://git.sudo.ws/sudo/commit/?id=fc7bfd504)

* MANIFEST, Makefile.in, configure, configure.ac,
  include/sudo\_ssl\_compat.h, lib/ssl\_compat/Makefile.in,
  lib/ssl\_compat/ssl\_compat.c, logsrvd/Makefile.in, logsrvd/tls\_common.h,
  m4/openssl.m4, plugins/sudoers/Makefile.in,
  plugins/sudoers/log\_client.h, src/Makefile.in:

  Add implementation of SSL\_read\_ex/SSL\_write\_ex for those without.
  [[d6d467b92]](https://git.sudo.ws/sudo/commit/?id=d6d467b92)

* config.h.in, configure, logsrvd/logsrvd.c, logsrvd/logsrvd\_relay.c,
  logsrvd/sendlog.c, m4/openssl.m4, plugins/sudoers/log\_client.c:

  Use SSL\_read\_ex() and SSL\_write\_ex() instead of SSL\_read() and
  SSL\_write().
  [[e6d14c95b]](https://git.sudo.ws/sudo/commit/?id=e6d14c95b)

2023-08-01 Todd C. Miller

* etc/sudo-logsrvd.pp, etc/sudo-python.pp, etc/sudo.pp:

  Don’t use sudo when building AIX packages

  PolyPkg uses “sudo installp -l” to list the built package by default but
  we may not have sudo privileges on the build host.
  [[d404f544f]](https://git.sudo.ws/sudo/commit/?id=d404f544f)

* scripts/mkpkg:

  Add –configure-only option to quit after the configure run.

  This will be used to avoid building the entire package when we just want
  the 32 or 64 bit sudo\_intercept.so and sudo\_noexec.so.
  [[002e22f84]](https://git.sudo.ws/sudo/commit/?id=002e22f84)

* scripts/mkpkg:

  Parse –disable-python in mkpkg and don’t override -m32 for Solaris.

  We want to be able to build without python and to specify the memory
  model when building 32-bit .so’s for Solaris.
  [[8e22ede2a]](https://git.sudo.ws/sudo/commit/?id=8e22ede2a)

2023-07-31 Todd C. Miller

* INSTALL.md, Makefile.in, configure, configure.ac:

  Add –enable-postinstall, an optional phase when building packages.

  This makes it possible to run an arbitrary script between “make install”
  and the polypkg run. This will be used to copy different word size
  versions of sudo\_intercept.so and sudo\_noexec.so.
  [[0a181849a]](https://git.sudo.ws/sudo/commit/?id=0a181849a)

* INSTALL.md, config.h.in, configure, configure.ac, docs/sudo.conf.man.in,
  docs/sudo.conf.mdoc.in, src/exec\_preload.c:

  Add basic support for 32-bit and 64-bit LD\_PRELOAD equivalents.

  The noexec and intercept DSO settings may now include both a 32-bit DSO
  and a 64-bit DSO specified by a colon. For example:
  /usr/libexec/sudo/sudo\_intercept.so:/usr/libexec/sudo/sudo\_intercept\_64.
  so.
  [[980e0216a]](https://git.sudo.ws/sudo/commit/?id=980e0216a)

* lib/util/term.c, src/exec\_pty.c:

  Cast TIOCSWINSZ to int to avoid overflow warning on 64-bit AIX.
  [[7cb1f7f3a]](https://git.sudo.ws/sudo/commit/?id=7cb1f7f3a)

2023-07-28 Todd C. Miller

* src/sudo\_intercept\_common.c:

  Read path section of sudo.conf for sudo\_conf\_intercept\_path().
  [[961f23af9]](https://git.sudo.ws/sudo/commit/?id=961f23af9)

2023-07-27 Todd C. Miller

* docs/visudo.man.in, docs/visudo.mdoc.in:

  visudo: document that a new file is only created if the editor writes
  it.

  If visudo is used to create a new file, the file will only be created if
  the user writes to the file via the editor. Simply running visudo and
  exiting the editor will no longer cause the file to be created. There is
  an exception for file created due to the addition of a @include
  directive, which need to be present for the sudoers file to parse
  properly. [GitHub issue
  #294](https://github.com/sudo-project/sudo/issues/294).
  [[bdde6dfa1]](https://git.sudo.ws/sudo/commit/?id=bdde6dfa1)

* plugins/sudoers/visudo.c:

  visudo: do not create a new file if the user made no changes

  This prevents visudo from creating a new zero-length sudoers file if the
  user exited the editor without making any changes. Files created via a
  @include directive are preserved, even if empty, to avoid a parse
  error. [GitHub issue
  #294](https://github.com/sudo-project/sudo/issues/294).
  [[4f3786f70]](https://git.sudo.ws/sudo/commit/?id=4f3786f70)

* README.md, docs/CONTRIBUTING.md:

  Make the sections on bug reporting consistent with each other.

  [GitHub issue #292](https://github.com/sudo-project/sudo/issues/292)
  [[50fde5d81]](https://git.sudo.ws/sudo/commit/?id=50fde5d81)

2023-07-26 Todd C. Miller

* src/exec.c:

  Remove unused variable introduced in last commit.
  [[857653f9f]](https://git.sudo.ws/sudo/commit/?id=857653f9f)

* src/exec.c, src/exec\_nopty.c, src/exec\_pty.c, src/sudo\_exec.h:

  Don’t assume that if std{in,out,err} is a tty, it is the user’s tty.

  Previously, sudo only checked that the fd was a terminal, not that it
  matched sudo’s idea of the user’s terminal. This matters when input or
  output is redirected to a different terminal. In that case we want to
  interpose the fd with a pipe even if it refers to a terminal. [Bug
  #1056](https://bugzilla.sudo.ws/show_bug.cgi?id=1056).
  [[760c9c110]](https://git.sudo.ws/sudo/commit/?id=760c9c110)

* MANIFEST, plugins/sudoers/regress/testsudoers/test29.out.ok,
  plugins/sudoers/regress/testsudoers/test29.sh,
  plugins/sudoers/regress/testsudoers/test30.out.ok,
  plugins/sudoers/regress/testsudoers/test30.sh,
  plugins/sudoers/regress/testsudoers/test31.out.ok,
  plugins/sudoers/regress/testsudoers/test31.sh:

  testsudoers: add -L, -l and -v tests
  [[14f1a12e2]](https://git.sudo.ws/sudo/commit/?id=14f1a12e2)

* plugins/sudoers/regress/testsudoers/test1.out.ok,
  plugins/sudoers/regress/testsudoers/test10.out.ok,
  plugins/sudoers/regress/testsudoers/test11.out.ok,
  plugins/sudoers/regress/testsudoers/test15.out.ok,
  plugins/sudoers/regress/testsudoers/test16.out.ok,
  plugins/sudoers/regress/testsudoers/test17.out.ok,
  plugins/sudoers/regress/testsudoers/test18.out.ok,
  plugins/sudoers/regress/testsudoers/test19.out.ok,
  plugins/sudoers/regress/testsudoers/test2.out.ok,
  plugins/sudoers/regress/testsudoers/test20.out.ok,
  plugins/sudoers/regress/testsudoers/test21.out.ok,
  plugins/sudoers/regress/testsudoers/test22.out.ok,
  plugins/sudoers/regress/testsudoers/test23.out.ok,
  plugins/sudoers/regress/testsudoers/test24.out.ok,
  plugins/sudoers/regress/testsudoers/test25.out.ok,
  plugins/sudoers/regress/testsudoers/test26.out.ok,
  plugins/sudoers/regress/testsudoers/test27.out.ok,
  plugins/sudoers/regress/testsudoers/test28.out.ok,
  plugins/sudoers/regress/testsudoers/test3.out.ok,
  plugins/sudoers/regress/testsudoers/test4.out.ok,
  plugins/sudoers/regress/testsudoers/test5.out.ok,
  plugins/sudoers/regress/testsudoers/test6.out.ok,
  plugins/sudoers/regress/testsudoers/test7.out.ok,
  plugins/sudoers/regress/testsudoers/test8.out.ok,
  plugins/sudoers/regress/testsudoers/test9.out.ok,
  plugins/sudoers/testsudoers.c:

  testsudoers: display when a password is required
  [[d62d704e5]](https://git.sudo.ws/sudo/commit/?id=d62d704e5)

* plugins/sudoers/testsudoers.c:

  testsudoers: add -L, -l and -v options.

  This makes it possible to test “sudo -l” and “sudo -v” using
  testsudoers.
  [[75256516b]](https://git.sudo.ws/sudo/commit/?id=75256516b)

2023-07-25 Todd C. Miller

* plugins/sudoers/lookup.c:

  sudoers\_lookup\_pseudo: sync with sudoers\_lookup\_check

  This makes sudoers\_lookup\_pseudo(), which is used for pseudo-command
  like “list” and “validate” a bit more like sudoers\_lookup\_check(). Time
  of day checks are performed, and callbacks are supported. We cannot use
  the same code for regular commands and pseudo-commands due to the
  “pwcheck == all” case.
  [[538be58ac]](https://git.sudo.ws/sudo/commit/?id=538be58ac)

* plugins/sudoers/logging.c:

  Fix user warning message for “sudo -l command” when not allowed.
  Reported by the sudo-rs project.

  There was a missing space between “list” and the actual command. This
  also changes the output to include the command as specified by the user,
  not the path found in the path. Previously, if the command did not exist
  it would not be included in the message.
  [[d486db46c]](https://git.sudo.ws/sudo/commit/?id=d486db46c)

* plugins/python/python\_convmessage.c, plugins/python/python\_loghandler.c,
  plugins/python/python\_plugin\_common.c,
  plugins/python/sudo\_python\_module.c,
  plugins/python/sudo\_python\_module.h:

  Add free function for sudo Python module.

  This reduces the amount of memory leaked on unload.
  [[1a00423af]](https://git.sudo.ws/sudo/commit/?id=1a00423af)

2023-07-24 Todd C. Miller

* NEWS:

  Document bug fixes in 1.9.14p3.
  [[e59c48743]](https://git.sudo.ws/sudo/commit/?id=e59c48743)

* plugins/python/python\_loghandler.c,
  plugins/python/python\_plugin\_common.c,
  plugins/python/sudo\_python\_module.c,
  plugins/python/sudo\_python\_module.h:

  Merge sudo\_module\_register\_loghandler and
  sudo\_module\_set\_default\_loghandler.

  We now create the LogHandler class for each interpreter in
  python\_plugin\_init() instead of just once in sudo\_module\_init(). This
  fixes the crash seen in Py\_EndInterpreter() with Python 3.12 and
  significantly reduces the number of leaked objects tracked by
  MemorySanitizer.
  [[09b963269]](https://git.sudo.ws/sudo/commit/?id=09b963269)

* plugins/python/python\_convmessage.c:

  sudo\_module\_register\_conv\_message: fix copy pasta in debug\_decl
  [[56b829f66]](https://git.sudo.ws/sudo/commit/?id=56b829f66)

2023-07-22 Todd C. Miller

* plugins/python/python\_baseplugin.c, plugins/python/python\_convmessage.c,
  plugins/python/python\_loghandler.c, plugins/python/sudo\_python\_module.c:
  sudo\_module\_register\_loghandler: clear sudo\_type\_LogHandler on error
  Also add comments about PyModule\_AddObject stealing a ref on success.
  [[0462a4ee8]](https://git.sudo.ws/sudo/commit/?id=0462a4ee8)

* plugins/python/pyhelpers.c:

  Use Py\_XDECREF instead of manual NULL check + Py\_DECREF
  [[b52c32f23]](https://git.sudo.ws/sudo/commit/?id=b52c32f23)

2023-07-21 Todd C. Miller

* plugins/python/python\_loghandler.c:

  Work around a crash with Python 3.12.

  In sudo\_module\_set\_default\_loghandler() if we don’t leak the reference
  to py\_loghandler we get a crash in Py\_EndInterpreter() with Python 3.12.
  This probably indicates a reference counting bug elsewhere.
  [[4e6254fea]](https://git.sudo.ws/sudo/commit/?id=4e6254fea)

* plugins/python/regress/check\_python\_examples.c:

  Unbuffer stdout so we don’t miss output during a crash.
  [[91ea59945]](https://git.sudo.ws/sudo/commit/?id=91ea59945)

* plugins/python/python\_loghandler.c:

  Use PyObject\_CallNoArgs() where possible.
  [[8c4cec148]](https://git.sudo.ws/sudo/commit/?id=8c4cec148)

* plugins/python/python\_convmessage.c, plugins/python/python\_loghandler.c,
  plugins/python/sudo\_python\_module.h:

  Make sudo\_type\_ConvMessage and sudo\_type\_LogHandler static.

  They are not used outside their respective compilation units.
  [[ba5ef624f]](https://git.sudo.ws/sudo/commit/?id=ba5ef624f)

2023-07-20 Todd C. Miller

* lib/eventlog/Makefile.in, lib/iolog/Makefile.in, lib/util/Makefile.in,
  plugins/python/Makefile.in, plugins/sudoers/Makefile.in:

  Pass TEST\_VERBOSE to all test programs.
  [[432ac1212]](https://git.sudo.ws/sudo/commit/?id=432ac1212)

* lib/iolog/regress/host\_port/host\_port\_test.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/editor/check\_editor.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/exptilde/check\_exptilde.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/serialize\_list/check\_serialize\_list.c,
  plugins/sudoers/regress/starttime/check\_starttime.c,
  plugins/sudoers/regress/unescape/check\_unesc.c:

  All test programs should accept the -v option, even if it is ignored.
  [[7499b2d27]](https://git.sudo.ws/sudo/commit/?id=7499b2d27)

* plugins/python/python\_plugin\_common.c:

  Revert last change, wrong diff committed.
  [[e710f7942]](https://git.sudo.ws/sudo/commit/?id=e710f7942)

2023-07-19 Todd C. Miller

* plugins/python/python\_plugin\_common.c:

  We can rely on Py\_FinalizeEx() to free sub-interpreters.
  [[a12dbfe90]](https://git.sudo.ws/sudo/commit/?id=a12dbfe90)

2023-07-20 Todd C. Miller

* plugins/python/regress/testhelpers.c:

  Adapt to changed formatting of a rejected result in Python 3.12
  [[2cb483578]](https://git.sudo.ws/sudo/commit/?id=2cb483578)

* plugins/python/example\_audit\_plugin.py, plugins/python/pyhelpers.c,
  plugins/python/regress/testdata/check\_example\_audit\_plugin\_receives\_acce
  pt.stdout,
  plugins/python/regress/testdata/check\_example\_audit\_plugin\_receives\_erro
  r.stdout,
  plugins/python/regress/testdata/check\_example\_audit\_plugin\_receives\_reje
  ct.stdout,
  plugins/python/regress/testdata/check\_example\_audit\_plugin\_version\_displ
  ay.stdout,
  plugins/python/regress/testdata/check\_example\_audit\_plugin\_workflow\_mult
  iple.stdout,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@diag.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@info.log
  ,
  plugins/python/regress/testdata/check\_example\_group\_plugin\_is\_able\_to\_de
  bug.log,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_validate\_inv
  alidate.log:

  Remove trailing whitespace from test output.
  [[adaba9c0f]](https://git.sudo.ws/sudo/commit/?id=adaba9c0f)

* plugins/python/python\_plugin\_common.c:

  \_python\_plugin\_new\_interpreter switches to the new interpreter

  No need to do PyThreadState\_Swap in the caller.
  [[7a10cdc28]](https://git.sudo.ws/sudo/commit/?id=7a10cdc28)

2023-07-19 Todd C. Miller

* plugins/python/python\_plugin\_common.c:

  Call PyImport\_AppendInittab after pre-initialization.

  Also remove redundant PyConfig settings.
  [[cc939297a]](https://git.sudo.ws/sudo/commit/?id=cc939297a)

2023-07-18 Todd C. Miller

* plugins/python/python\_plugin\_common.c:

  Use Py\_InitializeFromConfig() not Py\_InitializeEx() for Python >= 3.8.

  Avoids deprecation warnings on Python 3.12.
  [[da60384ad]](https://git.sudo.ws/sudo/commit/?id=da60384ad)

* NEWS:

  The sudoers option is “use\_pty”, not “log\_pty”

  [GitHub issue #291](https://github.com/sudo-project/sudo/issues/291)
  [[0efdd7632]](https://git.sudo.ws/sudo/commit/?id=0efdd7632)

2023-07-17 Todd C. Miller

* lib/util/term.c:

  Quiet a warning false positive with older versions of gcc.
  [[4b5480cf7]](https://git.sudo.ws/sudo/commit/?id=4b5480cf7)

* plugins/sudoers/sudoers.c:

  sudoers\_check\_common: MODE\_PRESERVE\_ENV is not valid with MODE\_CHECK.

  We should only check for MODE\_PRESERVE\_ENV when running a command.
  [[fa66c1668]](https://git.sudo.ws/sudo/commit/?id=fa66c1668)

2023-07-14 Todd C. Miller

* NEWS:

  Document bug fixes in 1.9.14p2.
  [[c29a27e84]](https://git.sudo.ws/sudo/commit/?id=c29a27e84)

2023-07-15 Todd C. Miller

* MANIFEST, plugins/sudoers/match.c,
  plugins/sudoers/regress/testsudoers/test28.out.ok,
  plugins/sudoers/regress/testsudoers/test28.sh:

  runas\_userlist\_matches: fix matching a Runas\_Spec with an empty runas
  user.

  We should only match a rule with an empty runas user if a group was
  specified on the command line (sudo -g) without a user (no -u option) or
  the user specified their own name on the command line. [GitHub issue
  #290](https://github.com/sudo-project/sudo/issues/290)
  [[db704c22e]](https://git.sudo.ws/sudo/commit/?id=db704c22e)

2023-07-14 Todd C. Miller

* src/exec\_pty.c:

  Pass SUDO\_TERM\_OFLAG to sudo\_term\_raw() when sudo output is piped.

  This fixes a problem with “stair-stepped” output when the sudo-run
  command’s output is piped to another program and the command reads input
  from the terminal.
  [[78b712101]](https://git.sudo.ws/sudo/commit/?id=78b712101)

* src/exec\_monitor.c, src/exec\_pty.c:

  Simplify the exec\_monitor() foreground flag.

  Add cmnd\_foreground flag that is only true if sudo is the foreground
  process and the CD\_EXEC\_BG flag is not set and pass it to
  exec\_monitor(). This means exec\_monitor() no longer needs to check for
  CD\_EXEC\_BG.
  [[db4bdb732]](https://git.sudo.ws/sudo/commit/?id=db4bdb732)

* include/sudo\_util.h, lib/util/term.c, plugins/sudoers/sudoreplay.c:

  sudo\_term\_raw: change the isig argument into a flags field

  There are current two flags: SUDO\_TERM\_ISIG (enable terminal signals)
  and SUDO\_TERM\_OFLAG (preserve output flags).
  [[625653de0]](https://git.sudo.ws/sudo/commit/?id=625653de0)

2023-07-12 Todd C. Miller

* src/exec\_ptrace.c:

  Fix a crash in intercept mode running a command with NULL argv[0].

  Newer Linux kernels replace a NULL argv[0] with the empty string, we
  should as well.
  [[ff6ddff39]](https://git.sudo.ws/sudo/commit/?id=ff6ddff39)

* src/conversation.c:

  sudo\_conversation\_printf: simplify \n -> \r\n handling
  [[b47f1799c]](https://git.sudo.ws/sudo/commit/?id=b47f1799c)

* src/conversation.c:

  sudo\_conversation: zero out reply even if no password is requested.

  This avoids a potential invalid free in the err label and provides more
  predictable behavior when mixing message types in a conversation.
  [[a014b0f2a]](https://git.sudo.ws/sudo/commit/?id=a014b0f2a)

2023-07-11 Todd C. Miller

* NEWS:

  Docume bug fixes in 1.9.14p1.
  [[9afb1851b]](https://git.sudo.ws/sudo/commit/?id=9afb1851b)

* plugins/sudoers/log\_client.c:

  fmt\_info\_messages: don’t include ttyname if it is NULL

  The NULL check was commented out for testing but should have been
  restored. Fixes a potential protocol error message from sudo\_logsrvd.
  [[56828f641]](https://git.sudo.ws/sudo/commit/?id=56828f641)

* logsrvd/iolog\_writer.c:

  evlog\_new: store a new copy of peeraddr, not a pointer to a buffer.

  Starting in sudo 1.9.14, eventlog\_free() will free the peeraddr member
  too so it needs to be dynamically allocated.
  [[2eee45ef9]](https://git.sudo.ws/sudo/commit/?id=2eee45ef9)

2023-07-10 Todd C. Miller

* config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/realpath.c:

  realpath.c: include limits.h and use sysconf(\_SC\_SYMLOOP\_MAX)

  This is more portable and eliminates the need to check for SYMLOOP\_MAX
  (and provide it if missing) in configure. Also quiet some -Wconversion
  warnings.
  [[a432aed4f]](https://git.sudo.ws/sudo/commit/?id=a432aed4f)

* plugins/sudoers/ldap\_conf.c:

  sudo\_krb5\_ccname\_path: avoid gcc false positive for ccname being NULL

  The callers all verify that they don’t pass a NULL ccname so I’m not
  sure how the compiler is getting confused (and why now?).
  [[dc1a5d7b4]](https://git.sudo.ws/sudo/commit/?id=dc1a5d7b4)

* include/sudo\_debug.h:

  Work around unused variable warning when fuzzing in enabled.
  [[c6a11b4fe]](https://git.sudo.ws/sudo/commit/?id=c6a11b4fe)

* plugins/sudoers/check\_util.c,
  plugins/sudoers/regress/testsudoers/test25.out.ok,
  plugins/sudoers/regress/testsudoers/test25.sh,
  plugins/sudoers/regress/testsudoers/test26.out.ok,
  plugins/sudoers/regress/testsudoers/test26.sh:

  Only allow the user to specify -D or -R for the special “\*” value.

  The sudoers file must now explicitly allow the user to specify a
  directory (sudo -D) or chroot (sudo -R) by setting cwd or chroot to “\*”.
  If a specific cwd or chroot value is set in sudoers, the user may not
  use the -D or -R options, even if they match the value in sudoers.
  [[d1625f9c8]](https://git.sudo.ws/sudo/commit/?id=d1625f9c8)

* docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in:

  Add restrict keyword to sudo\_printf\_t in plugin docs.
  [[44cfa9e13]](https://git.sudo.ws/sudo/commit/?id=44cfa9e13)

* include/sudo\_debug.h, lib/util/sudo\_debug.c:

  Convert sudo\_debug\_enter and sudo\_debug\_exit into macros.

  In most cases, these simply expand to a call to sudo\_debug\_printf2(). We
  need to keep the function versions around in libsudo\_util for backwards
  compatibility.
  [[db6baf2ca]](https://git.sudo.ws/sudo/commit/?id=db6baf2ca)

* lib/util/sudo\_debug.c:

  Fix sudo\_debug\_exit\_uint\_v1 declaration for fuzzers.
  [[2d12a4194]](https://git.sudo.ws/sudo/commit/?id=2d12a4194)

* lib/util/sudo\_debug.c:

  Add missing sudo\_debug\_exit\_uint\_v1 stub for fuzzers.
  [[eff4e1c0c]](https://git.sudo.ws/sudo/commit/?id=eff4e1c0c)

* src/conversation.c, src/edit\_open.c, src/exec\_common.c,
  src/parse\_args.c, src/selinux.c, src/sesh.c, src/sudo.c, src/sudo.h,
  src/sudo\_edit.h, src/sudo\_exec.h, src/tgetpass.c:

  sudo frontend: make more bit flags unsigned.
  [[dbb95ad21]](https://git.sudo.ws/sudo/commit/?id=dbb95ad21)

* plugins/sudoers/auth/API, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/check.c,
  plugins/sudoers/check.h, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers.h, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/lookup.c,
  plugins/sudoers/parse.h, plugins/sudoers/policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c:

  sudoers plugin: make more bit flags unsigned.
  [[cbcb1d250]](https://git.sudo.ws/sudo/commit/?id=cbcb1d250)

* include/sudo\_debug.h, include/sudo\_event.h, lib/util/event.c,
  lib/util/event\_poll.c, lib/util/event\_select.c, lib/util/sudo\_debug.c,
  lib/util/util.exp.in:

  libsudo\_util: make more bit flags unsigned.
  [[4f097eebd]](https://git.sudo.ws/sudo/commit/?id=4f097eebd)

2023-07-08 Todd C. Miller

* plugins/sudoers/timeout.c:

  parse\_timeout: move overflow check to the correct location

  It was not covering all cases in its original location. Fixes oss-fuzz
  issue 60454 with fuzz\_sudoers.
  [[9f7128fe8]](https://git.sudo.ws/sudo/commit/?id=9f7128fe8)

2023-07-07 Todd C. Miller

* :

  Merge pull request #287 from AtariDreams/restrict

  Give every printf-like function restrict qualifiers
  [[fc02df111]](https://git.sudo.ws/sudo/commit/?id=fc02df111)

2023-07-07 Rose

* include/sudo\_compat.h, include/sudo\_debug.h, include/sudo\_fatal.h,
  include/sudo\_lbuf.h, include/sudo\_plugin.h, include/sudo\_util.h,
  lib/eventlog/logwrap.c, lib/util/fatal.c, lib/util/inet\_ntop.c,
  lib/util/lbuf.c, lib/util/snprintf.c, lib/util/strlcat.c,
  lib/util/strlcpy.c, lib/util/sudo\_debug.c, lib/util/ttyname\_dev.c,
  logsrvd/iolog\_writer.c, logsrvd/logsrvd\_journal.c,
  plugins/audit\_json/audit\_json.c, plugins/group\_file/plugin\_test.c,
  plugins/python/pyhelpers.c, plugins/python/regress/iohelpers.c,
  plugins/python/regress/iohelpers.h,
  plugins/python/regress/testhelpers.c,
  plugins/python/regress/testhelpers.h, plugins/sudoers/audit.c,
  plugins/sudoers/check\_aliases.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers.h, plugins/sudoers/cvtsudoers\_csv.c,
  plugins/sudoers/defaults.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/ldap\_util.c,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/parse.h, plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudo\_ldap.h, plugins/sudoers/sudo\_printf.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c,
  src/conversation.c, src/exec\_preload.c, src/parse\_args.c,
  src/sudo\_plugin\_int.h:

  Give every printf-like function restrict qualifiers

  The format value has to be a string literal, every time.

  Otherwise, you are not using these functions correctly. To reinforce
  this fact, I putrestrict over every non-contrib example of this I could
  find.
  [[5d758264a]](https://git.sudo.ws/sudo/commit/?id=5d758264a)

2023-07-07 Todd C. Miller

* src/exec\_nopty.c, src/exec\_pty.c, src/sudo\_exec.h:

  struct exec\_closure: make rows and cols int, not short

  There’s no real space saved by using short and using int avoids a few
  casts.
  [[92860c717]](https://git.sudo.ws/sudo/commit/?id=92860c717)

* plugins/sudoers/testsudoers.c:

  testsudoers: avoid extern definitions where possible
  [[548e3e312]](https://git.sudo.ws/sudo/commit/?id=548e3e312)

* plugins/sample/sample\_plugin.c, src/conversation.c, src/copy\_file.c,
  src/env\_hooks.c, src/exec.c, src/exec\_common.c, src/exec\_intercept.c,
  src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_preload.c,
  src/exec\_ptrace.c, src/exec\_pty.c, src/net\_ifs.c, src/parse\_args.c,
  src/preserve\_fds.c, src/sudo.c, src/sudo.h, src/sudo\_edit.c,
  src/sudo\_exec.h, src/sudo\_intercept.c, src/sudo\_intercept\_common.c,
  src/tgetpass.c, src/ttyname.c:

  sudo frontend: silence most -Wconversion warnings.
  [[32f4b98f6]](https://git.sudo.ws/sudo/commit/?id=32f4b98f6)

* plugins/python/pyhelpers.c, plugins/python/python\_convmessage.c,
  plugins/python/regress/iohelpers.c,
  plugins/python/regress/testhelpers.c,
  plugins/python/sudo\_python\_module.c:

  python plugin: silence -Wconversion warnings.
  [[0c85f10c8]](https://git.sudo.ws/sudo/commit/?id=0c85f10c8)

* plugins/sudoers/alias.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/b64\_encode.c,
  plugins/sudoers/check\_aliases.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers.h, plugins/sudoers/cvtsudoers\_csv.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/cvtsudoers\_merge.c, plugins/sudoers/cvtsudoers\_pwutil.c,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/display.c, plugins/sudoers/editor.c,
  plugins/sudoers/env.c, plugins/sudoers/filedigest.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/fmtsudoers\_cvt.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path\_escapes.c, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/ldap\_innetgr.c,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/log\_client.c, plugins/sudoers/logging.c,
  plugins/sudoers/match\_addr.c, plugins/sudoers/match\_command.c,
  plugins/sudoers/parse.h, plugins/sudoers/parse\_ldif.c,
  plugins/sudoers/policy.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sssd.c,
  plugins/sudoers/starttime.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timeout.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/visudo.c:

  sudoers plugin: silence most -Wconversion warnings.
  [[a38b71466]](https://git.sudo.ws/sudo/commit/?id=a38b71466)

* logsrvd/iolog\_writer.c, logsrvd/logsrv\_util.c, logsrvd/logsrvd.c,
  logsrvd/logsrvd\_conf.c, logsrvd/logsrvd\_journal.c,
  logsrvd/logsrvd\_local.c, logsrvd/logsrvd\_queue.c,
  logsrvd/logsrvd\_relay.c, logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c,
  logsrvd/sendlog.c:

  sudo\_logsrvd: silence most -Wconversion warnings.
  [[4891f37a4]](https://git.sudo.ws/sudo/commit/?id=4891f37a4)

* include/sudo\_iolog.h, lib/iolog/hostcheck.c, lib/iolog/iolog\_filter.c,
  lib/iolog/iolog\_legacy.c, lib/iolog/iolog\_mkdirs.c,
  lib/iolog/iolog\_mkdtemp.c, lib/iolog/iolog\_read.c,
  lib/iolog/iolog\_timing.c, lib/iolog/iolog\_write.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c,
  lib/iolog/regress/iolog\_timing/check\_iolog\_timing.c:

  libiolog: silence -Wconversion warnings.
  [[6734a99f8]](https://git.sudo.ws/sudo/commit/?id=6734a99f8)

* lib/fuzzstub/fuzzstub.c:

  libfuzzstub: silence -Wconversion warnings.
  [[e93913e2b]](https://git.sudo.ws/sudo/commit/?id=e93913e2b)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  lib/eventlog/eventlog\_conf.c, lib/eventlog/logwrap.c,
  lib/eventlog/parse\_json.c,
  lib/eventlog/regress/eventlog\_store/store\_json\_test.c,
  lib/eventlog/regress/eventlog\_store/store\_sudo\_test.c,
  lib/eventlog/regress/logwrap/check\_wrap.c,
  lib/eventlog/regress/parse\_json/check\_parse\_json.c:

  libevent: silence -Wconversion warnings.
  [[c95423a8f]](https://git.sudo.ws/sudo/commit/?id=c95423a8f)

* include/sudo\_json.h, include/sudo\_lbuf.h, lib/util/closefrom.c,
  lib/util/digest.c, lib/util/event\_poll.c, lib/util/fatal.c,
  lib/util/getentropy.c, lib/util/getgrouplist.c, lib/util/gidlist.c,
  lib/util/json.c, lib/util/lbuf.c, lib/util/mkdir\_parents.c,
  lib/util/parseln.c, lib/util/regex.c,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.c,
  lib/util/regress/hexchar/hexchar\_test.c,
  lib/util/regress/mktemp/mktemp\_test.c,
  lib/util/regress/strtofoo/strtoid\_test.c, lib/util/secure\_path.c,
  lib/util/setgroups.c, lib/util/sig2str.c, lib/util/str2sig.c,
  lib/util/strlcat.c, lib/util/strlcpy.c, lib/util/strtoid.c,
  lib/util/strtonum.c, lib/util/sudo\_conf.c, lib/util/sudo\_debug.c,
  lib/util/ttysize.c:

  libsudo\_util: silence most -Wconversion warnings.
  [[5768d374c]](https://git.sudo.ws/sudo/commit/?id=5768d374c)

* config.h.in, configure, configure.ac:

  Add configure check for restrict keyword.
  [[f7801f216]](https://git.sudo.ws/sudo/commit/?id=f7801f216)

* plugins/sudoers/sudoers.c:

  sudoers\_check\_common: remove extraneous return statement.
  [[0205f6fc7]](https://git.sudo.ws/sudo/commit/?id=0205f6fc7)

2023-07-06 Todd C. Miller

* include/sudo\_digest.h, lib/util/digest.c, lib/util/digest\_gcrypt.c,
  lib/util/digest\_openssl.c, lib/util/regress/digest/digest\_test.c:

  Make the remaining instances of digest\_type unsigned.
  [[bced0a778]](https://git.sudo.ws/sudo/commit/?id=bced0a778)

2023-07-05 Todd C. Miller

* plugins/sudoers/iolog\_path\_escapes.c:

  Copy, don’t append group ID in fill\_group() and fill\_runas\_group()

  This only affects the case where a group ID cannot be resolved.
  [[43e914a5d]](https://git.sudo.ws/sudo/commit/?id=43e914a5d)

* lib/iolog/Makefile.in:

  Remove regress corpus directories correctly
  [[17c09dfd2]](https://git.sudo.ws/sudo/commit/?id=17c09dfd2)

* include/sudo\_debug.h, include/sudo\_util.h, lib/util/strtomode.c,
  lib/util/sudo\_debug.c, lib/util/util.exp.in:

  Change sudo\_strtomode() to return mode\_t.
  [[2d1b3c369]](https://git.sudo.ws/sudo/commit/?id=2d1b3c369)

2023-07-04 Todd C. Miller

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/sudoreplay.c:

  Rename print\_usage() to display\_usage()
  [[2848dddd8]](https://git.sudo.ws/sudo/commit/?id=2848dddd8)

* logsrvd/logsrvd.c, logsrvd/sendlog.c:

  Move display of usage text into display\_usage() so usage() always exits.
  [[f6d154241]](https://git.sudo.ws/sudo/commit/?id=f6d154241)

* lib/util/parseln.c, logsrvd/logsrvd\_journal.c:

  Fix some indentation.
  [[1f0f6b7c7]](https://git.sudo.ws/sudo/commit/?id=1f0f6b7c7)

* plugins/sudoers/Makefile.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers.h, plugins/sudoers/testsudoers.c:

  Include testsudoers\_pwutil.h for testsudoers\_pwutil.c prototypes.
  [[fd061e4d6]](https://git.sudo.ws/sudo/commit/?id=fd061e4d6)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/testsudoers\_pwutil.c,
  plugins/sudoers/testsudoers\_pwutil.h, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/tsgetgrpw.h:

  Fix wrapping of libc getpwnam/getpwuid/getgrnam/getgrgid on NetBSD.
  [[f1d906347]](https://git.sudo.ws/sudo/commit/?id=f1d906347)

* MANIFEST, aclocal.m4, config.h.in, configure, configure.ac,
  lib/util/roundup.c, m4/ax\_gcc\_builtin.m4:

  Add configure tests for \_\_builtin\_clz/\_\_builtin\_clzl
  [[bfb6132d9]](https://git.sudo.ws/sudo/commit/?id=bfb6132d9)

* lib/util/roundup.c:

  Add fallback for compilers without \_\_builtin\_clz/\_\_builtin\_clzl
  [[0f69939d7]](https://git.sudo.ws/sudo/commit/?id=0f69939d7)

* lib/util/roundup.c:

  sudo\_pow2\_roundup: fix 64-bit version when shifting 31 or more places

  Shift 1UL instead of 1 to avoid overflowing an int.
  [[3a7ca0a83]](https://git.sudo.ws/sudo/commit/?id=3a7ca0a83)

* :

  Merge pull request #286 from AtariDreams/one-more

  Optimize sudo\_pow2\_roundup\_v1
  [[d900e7a93]](https://git.sudo.ws/sudo/commit/?id=d900e7a93)

2023-07-03 Rose

* lib/util/roundup.c:

  Optimize sudo\_pow2\_roundup\_v1

  No need to call sudo\_pow2\_roundup\_v2.
  [[8c3e4a33c]](https://git.sudo.ws/sudo/commit/?id=8c3e4a33c)

2023-07-03 Todd C. Miller

* :

  Merge pull request #285 from AtariDreams/bug

  Remove comment about algorithm being from bit-twiddling hacks
  [[fa69ee5e1]](https://git.sudo.ws/sudo/commit/?id=fa69ee5e1)

2023-07-03 Rose

* lib/util/roundup.c:

  Remove comment about algorithm being from bit-twiddling hacks

  Said comment no longer applies.
  [[76d7aefb3]](https://git.sudo.ws/sudo/commit/?id=76d7aefb3)

2023-07-03 Todd C. Miller

* :

  Merge pull request #284 from AtariDreams/fix

  Fix fuzzing errors
  [[f884514b3]](https://git.sudo.ws/sudo/commit/?id=f884514b3)

2023-07-03 Rose

* lib/util/parseln.c, lib/util/roundup.c, logsrvd/logsrvd\_journal.c:

  Fix fuzzing errors

  We should be checking for integer overflow, rather than checking if size
  is 0.

  Additionally, we should set errno to ENOMEM when this overflow happens.

  Finally, the most efficient implementation of the round-up-to-2
  algorithm involves the clz intrinsic.
  [[732110428]](https://git.sudo.ws/sudo/commit/?id=732110428)

2023-07-03 Todd C. Miller

* :

  Merge pull request #283 from AtariDreams/bug

  Fixed even more signedness and conversion issues
  [[9266966ab]](https://git.sudo.ws/sudo/commit/?id=9266966ab)

2023-07-03 Rose

* plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/timestamp.c, plugins/sudoers/tsgetgrpw.c, src/sudo.c:

  Fixed even more signedness and conversion issues

  This should be the last of them.
  [[cbed9daa4]](https://git.sudo.ws/sudo/commit/?id=cbed9daa4)

2023-07-03 Todd C. Miller

* lib/util/lbuf.c:

  sudo\_lbuf\_expand: limit allocation to UINT\_MAX
  [[f5eb1e055]](https://git.sudo.ws/sudo/commit/?id=f5eb1e055)

* lib/util/parseln.c:

  sudo\_parseln: use sudo\_pow2\_roundup() instead of hand-rolling it.
  [[d3dc70ab6]](https://git.sudo.ws/sudo/commit/?id=d3dc70ab6)

* logsrvd/logsrv\_util.c, logsrvd/logsrv\_util.h, logsrvd/logsrvd.c,
  logsrvd/logsrvd\_relay.c, logsrvd/sendlog.c,
  plugins/sudoers/log\_client.c, plugins/sudoers/log\_client.h:

  Promote length/size/offset in struct connection\_buffer to size\_t.
  [[e95bd883d]](https://git.sudo.ws/sudo/commit/?id=e95bd883d)

* include/sudo\_util.h, lib/util/lbuf.c, lib/util/roundup.c,
  lib/util/util.exp.in, logsrvd/logsrv\_util.c, logsrvd/logsrvd.c,
  plugins/sudoers/log\_client.c:

  Make sudo\_pow2\_roundup() operate on size\_t.
  [[56a431f7e]](https://git.sudo.ws/sudo/commit/?id=56a431f7e)

2023-07-01 Todd C. Miller

* include/sudo\_debug.h, lib/util/sudo\_debug.c, plugins/python/pyhelpers.c,
  plugins/python/pyhelpers.h, plugins/python/python\_loghandler.c,
  plugins/python/sudo\_python\_debug.c, plugins/python/sudo\_python\_debug.h:

  Make the debug subsystem unsigned.

  It was already unsigned in sudoers but not in the front-end or the
  python plugin. Making this consistent resolves a lot of -Wconversion
  warnings. Also clean up some other -Wconversion warnings in
  sudo\_debug.c.
  [[b926df1df]](https://git.sudo.ws/sudo/commit/?id=b926df1df)

* lib/eventlog/eventlog.c,
  lib/eventlog/regress/eventlog\_store/store\_json\_test.c,
  lib/eventlog/regress/eventlog\_store/store\_sudo\_test.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c,
  src/exec\_monitor.c, src/sudo.c:

  Fix up indentation.
  [[04c7e910e]](https://git.sudo.ws/sudo/commit/?id=04c7e910e)

* :

  Merge pull request #280 from AtariDreams/bug

  Mark functions not returning as sudo\_noreturn
  [[575e4ab2f]](https://git.sudo.ws/sudo/commit/?id=575e4ab2f)

2023-07-01 Rose

* lib/eventlog/eventlog.c,
  lib/eventlog/regress/eventlog\_store/store\_json\_test.c,
  lib/eventlog/regress/eventlog\_store/store\_sudo\_test.c,
  lib/eventlog/regress/logwrap/check\_wrap.c,
  lib/eventlog/regress/parse\_json/check\_parse\_json.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c,
  lib/util/regress/hexchar/hexchar\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c, logsrvd/logsrvd.c,
  logsrvd/regress/logsrvd\_conf/logsrvd\_conf\_test.c, logsrvd/sendlog.c,
  plugins/group\_file/plugin\_test.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c,
  src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c, src/sesh.c,
  src/sudo.c:

  Mark functions not returning as sudo\_noreturn

  We also put NOTREACHED where it applies.
  [[45fdfa18f]](https://git.sudo.ws/sudo/commit/?id=45fdfa18f)

2023-07-01 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l, src/limits.c:

  Avoid passing debug\_return\_size\_t() a negative number.
  [[97e574091]](https://git.sudo.ws/sudo/commit/?id=97e574091)

* :

  Merge pull request #279 from AtariDreams/bison

  Regenerate toke.c using updated flex
  [[2a4939a1c]](https://git.sudo.ws/sudo/commit/?id=2a4939a1c)

2023-06-29 Rose

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Regenerate toke.c using updated flex

  Use the current version of flex to generate toke.c
  [[6ea68d208]](https://git.sudo.ws/sudo/commit/?id=6ea68d208)

2023-06-30 Todd C. Miller

* plugins/sudoers/regress/exptilde/check\_exptilde.c,
  plugins/sudoers/testsudoers.c:

  Fix a few memory leaks in the tests.
  [[5fbf431c4]](https://git.sudo.ws/sudo/commit/?id=5fbf431c4)

* MANIFEST, plugins/sudoers/regress/testsudoers/group,
  plugins/sudoers/regress/testsudoers/passwd,
  plugins/sudoers/regress/testsudoers/test27.out.ok,
  plugins/sudoers/regress/testsudoers/test27.sh,
  plugins/sudoers/testsudoers.c:

  Add test for runas\_check\_shell and check\_user\_shell()
  [[ac9b6c94d]](https://git.sudo.ws/sudo/commit/?id=ac9b6c94d)

* MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/testsudoers/test25.out.ok,
  plugins/sudoers/regress/testsudoers/test25.sh,
  plugins/sudoers/regress/testsudoers/test26.out.ok,
  plugins/sudoers/regress/testsudoers/test26.sh,
  plugins/sudoers/testsudoers.c:

  testsudoers: add -D and -R options to set cwd and chroot like sudo
  [[bdc8a7f35]](https://git.sudo.ws/sudo/commit/?id=bdc8a7f35)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/check.c,
  plugins/sudoers/check\_util.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Move check\_user\_\* functions to check\_util.c so testsudoers can use them.
  [[01ad570e2]](https://git.sudo.ws/sudo/commit/?id=01ad570e2)

2023-06-29 Todd C. Miller

* plugins/sudoers/testsudoers.c:

  testsudoers: make lbuf private to dump\_sudoers()

  It is no longer used directly in main.
  [[689efe3cd]](https://git.sudo.ws/sudo/commit/?id=689efe3cd)

* plugins/sudoers/regress/testsudoers/test11.out.ok,
  plugins/sudoers/regress/testsudoers/test4.out.ok,
  plugins/sudoers/regress/testsudoers/test5.out.ok,
  plugins/sudoers/testsudoers.c:

  testsudoers: display “Parse error” if there was a parse error.

  Previously, we just printed “Command unmatched” which makes it harder to
  see that an error occurred.
  [[260c2fb83]](https://git.sudo.ws/sudo/commit/?id=260c2fb83)

* plugins/sudoers/regress/testsudoers/test1.out.ok,
  plugins/sudoers/regress/testsudoers/test10.out.ok,
  plugins/sudoers/regress/testsudoers/test15.out.ok,
  plugins/sudoers/regress/testsudoers/test16.out.ok,
  plugins/sudoers/regress/testsudoers/test17.out.ok,
  plugins/sudoers/regress/testsudoers/test18.out.ok,
  plugins/sudoers/regress/testsudoers/test19.out.ok,
  plugins/sudoers/regress/testsudoers/test2.out.ok,
  plugins/sudoers/regress/testsudoers/test20.out.ok,
  plugins/sudoers/regress/testsudoers/test21.out.ok,
  plugins/sudoers/regress/testsudoers/test22.out.ok,
  plugins/sudoers/regress/testsudoers/test23.out.ok,
  plugins/sudoers/regress/testsudoers/test24.out.ok,
  plugins/sudoers/regress/testsudoers/test3.out.ok,
  plugins/sudoers/regress/testsudoers/test6.out.ok,
  plugins/sudoers/regress/testsudoers/test7.out.ok,
  plugins/sudoers/regress/testsudoers/test8.out.ok,
  plugins/sudoers/regress/testsudoers/test9.out.ok,
  plugins/sudoers/testsudoers.c:

  testsudoers: use allowed/denied/unmatched instead of just
  matched/unmatched

  This makes it possible to tell whether an entry was rejected due to a
  negative match (explicitly denied) as opposed to a non-match. Also fixes
  a bug where the runas status was only printed for positive matches.
  [[6a21aec0a]](https://git.sudo.ws/sudo/commit/?id=6a21aec0a)

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/testsudoers/test20.out.ok,
  plugins/sudoers/testsudoers.c:

  testsudoers: use sudoers\_lookup() instead of a custom loop.
  [[fd25bfc89]](https://git.sudo.ws/sudo/commit/?id=fd25bfc89)

* plugins/sudoers/lookup.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sudoers.c:

  Add callbacks to sudoers\_lookup() so we can use it in testsudoers.

  Also pass in the time to be used for NOTBEFORE/NOTAFTER checks.
  [[e025cca44]](https://git.sudo.ws/sudo/commit/?id=e025cca44)

* :

  Merge pull request #278 from AtariDreams/types

  Avoid compiler casting warnings Part 2
  [[41b82006d]](https://git.sudo.ws/sudo/commit/?id=41b82006d)

* plugins/sudoers/sudoers.c:

  check\_user\_runcwd: only allow sudo’s -D option if sudoers specifies a
  runcwd.

  Previously, the user could specify the runas user’s home dir for “sudo
  -i” or the user’s existing cwd when -i is not specified. This behavior
  was never documented and is inconsistent with how the -R option is
  handled.
  [[1c7a20d74]](https://git.sudo.ws/sudo/commit/?id=1c7a20d74)

* MANIFEST, plugins/sudoers/regress/testsudoers/test24.out.ok,
  plugins/sudoers/regress/testsudoers/test24.sh,
  plugins/sudoers/testsudoers.c:

  testsudoers: add support for NOTBEFORE and NOTAFTER

  Also adds -T option to set the value of “now”.
  [[2c1a473dd]](https://git.sudo.ws/sudo/commit/?id=2c1a473dd)

2023-05-18 Rose

* lib/util/mktemp.c, lib/util/regress/tailq/hltq\_test.c,
  lib/util/sudo\_debug.c, lib/util/ttyname\_dev.c,
  plugins/group\_file/plugin\_test.c, plugins/sudoers/editor.c,
  plugins/sudoers/filedigest.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/match\_digest.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/exptilde/check\_exptilde.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/tsdump.c, plugins/sudoers/visudo.c, src/exec\_monitor.c,
  src/limits.c, src/sesh.c, src/sudo.c, src/sudo.h, src/sudo\_edit.c:

  Avoid compiler casting warnings Part 2

  This saves instructions that are related to casting as well as compiler
  warnings.
  [[22079c307]](https://git.sudo.ws/sudo/commit/?id=22079c307)

2023-06-29 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/lookup.c:

  Rename parse.c -> lookup.c now that it only contains sudoers\_lookup.
  [[f2a274b06]](https://git.sudo.ws/sudo/commit/?id=f2a274b06)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/display.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h:

  Split display\_privs() and display\_cmnd() out of parse.c into display.c
  [[8b640329d]](https://git.sudo.ws/sudo/commit/?id=8b640329d)

* lib/util/snprintf.c:

  No need to round up to page size with sudo\_mmap\_alloc().
  [[1ba61cd13]](https://git.sudo.ws/sudo/commit/?id=1ba61cd13)

* :

  Merge pull request #265 from AtariDreams/types

  Avoid compiler casting warnings by assigning to variables of the same
  type where possible
  [[f437c66a2]](https://git.sudo.ws/sudo/commit/?id=f437c66a2)

* :

  Merge pull request #277 from AtariDreams/debug\_return\_int(1);

  We should be returning 0, not 1, when logservd finishes without errors
  [[e0238ab21]](https://git.sudo.ws/sudo/commit/?id=e0238ab21)

2023-06-28 Rose

* logsrvd/logsrvd.c:

  We should be returning 0, not 1, when logservd finishes without errors

  1 is for failure, 0 is for no failure, and this does not look like a
  failure.
  [[2c13d7130]](https://git.sudo.ws/sudo/commit/?id=2c13d7130)

2023-05-18 Rose

* lib/eventlog/eventlog.c, lib/eventlog/eventlog\_free.c,
  lib/eventlog/parse\_json.c, lib/iolog/hostcheck.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c, lib/util/event.c,
  lib/util/explicit\_bzero.c, lib/util/fatal.c, lib/util/getaddrinfo.c,
  lib/util/getentropy.c, lib/util/hexchar.c, lib/util/inet\_ntop.c,
  lib/util/json.c, lib/util/lbuf.c, lib/util/mksiglist.c,
  lib/util/mksigname.c, lib/util/multiarch.c, lib/util/progname.c,
  lib/util/sig2str.c, lib/util/snprintf.c, lib/util/sudo\_conf.c,
  lib/util/term.c, lib/util/uuid.c, logsrvd/iolog\_writer.c,
  logsrvd/logsrvd.c, logsrvd/sendlog.c, plugins/audit\_json/audit\_json.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_pwutil.c,
  plugins/sudoers/editor.c, plugins/sudoers/getdate.c,
  plugins/sudoers/getdate.y, plugins/sudoers/iolog.c,
  plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/starttime/check\_starttime.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/timestr.c, plugins/sudoers/tsdump.c,
  plugins/sudoers/visudo.c, src/conversation.c, src/exec\_monitor.c,
  src/limits.c, src/parse\_args.c, src/sesh.c, src/sudo.c, src/sudo.h:

  Avoid compiler casting warnings by assigning to the same type where
  possible

  This saves instructions that are related to casting as well as compiler
  warnings.
  [[e54ba33ea]](https://git.sudo.ws/sudo/commit/?id=e54ba33ea)

2023-06-28 Todd C. Miller

* config.h.in, configure, configure.ac, src/sudo\_intercept.c,
  src/sudo\_intercept\_common.c:

  Fix undefined symbol on macOS for intercept mode and log\_subcmds.

  macOS does not support direct access to the environ pointer from a
  shared object. We need to redirect through \_NSGetEnviron() instead.
  Fixes [GitHub issue
  #276](https://github.com/sudo-project/sudo/issues/276).
  [[a0b074cc9]](https://git.sudo.ws/sudo/commit/?id=a0b074cc9)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c:

  check\_user\_runcwd: allow -D option if it matches the cwd in sudoers

  Previously, check\_user\_runcwd() would return true if the runcwd matched
  the user’s cwd, even if sudoers specified a different one. The
  user-specified runcwd was ignored but it is better to error out in this
  case. It is now also possible to use “sudo -D” with the directory
  specified in sudoers.
  [[e7d4c05ac]](https://git.sudo.ws/sudo/commit/?id=e7d4c05ac)

2023-06-26 Todd C. Miller

* :

  Merge pull request #275 from AtariDreams/emergency

  Set command\_info to NULL once it is freed
  [[a2a87323e]](https://git.sudo.ws/sudo/commit/?id=a2a87323e)

2023-06-26 Rose

* plugins/sudoers/policy.c:

  Set command\_info to NULL once it is freed

  The lack of setting to NULL is a holdover from when command\_info was a
  local variable and not a global one. However, we given how other global
  variables are set to NULL, it is best that we do the same here to avoid
  potential issues should sudoers\_policy\_store\_result be called again
  after the first time failed, otherwise we could get a double-free.
  [[0bb41ed82]](https://git.sudo.ws/sudo/commit/?id=0bb41ed82)

2023-06-25 Todd C. Miller

* :

  Merge pull request #274 from bin-ly/main

  Modify the is\_script function for match\_command.c
  [[676066e2a]](https://git.sudo.ws/sudo/commit/?id=676066e2a)

2023-06-25 binlingyu

* plugins/sudoers/match\_command.c:

  Modify the is\_script function for match\_command.c
  [[f8a45e8a5]](https://git.sudo.ws/sudo/commit/?id=f8a45e8a5)

2023-06-21 Todd C. Miller

* NEWS:

  Mention C99 requirement.
  [[7fb98a9a3]](https://git.sudo.ws/sudo/commit/?id=7fb98a9a3)

2023-06-20 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Reference SETENV-related settings in the command environment section.

  Based on GitHub PR #273 from Ilya Kulakov.
  [[e0ee845df]](https://git.sudo.ws/sudo/commit/?id=e0ee845df)

* INSTALL.md:

  Sudo requires a C99 compiler due to the use of flexible array members.
  [[733d5291b]](https://git.sudo.ws/sudo/commit/?id=733d5291b)

* :

  Merge pull request #266 from AtariDreams/c99

  Do variable length arrays the C99 way
  [[3bdd2214a]](https://git.sudo.ws/sudo/commit/?id=3bdd2214a)

2023-06-19 Todd C. Miller

* :

  Merge pull request #269 from trackers-lover/main

  correct the return value type of function alias\_find\_used
  [[69b486d46]](https://git.sudo.ws/sudo/commit/?id=69b486d46)

2023-06-18 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Clarify that use\_pty is on by default starting with 1.9.14.
  [[5d2b1761f]](https://git.sudo.ws/sudo/commit/?id=5d2b1761f)

* docs/sudo.man.in, docs/sudo.mdoc.in:

  Sudo runs the command in a pty by default in 1.9.14 and above.
  [[afb09e004]](https://git.sudo.ws/sudo/commit/?id=afb09e004)

* plugins/sudoers/sudoers.in:

  Add commented out example for disabling use\_pty.
  [[4da1f373d]](https://git.sudo.ws/sudo/commit/?id=4da1f373d)

2023-05-18 Rose

* include/sudo\_event.h, lib/util/event.c, lib/util/rcstr.c,
  plugins/sudoers/canon\_path.c, plugins/sudoers/ldap\_conf.c,
  plugins/sudoers/sudo\_ldap\_conf.h:

  Do variable length arrays the C99 way

  Variable length arrays are supported by C99, but having it denoted as
  “1” confused the compiler and is not defined.

  Note that because we don’t get the inferred NULL terminator, we have to
  increase the malloc size by one.
  [[7fd680c98]](https://git.sudo.ws/sudo/commit/?id=7fd680c98)

2023-06-15 Todd C. Miller

* .circleci/config.yml:

  Update Xcode version from 13.2.1 to 13.4.1.
  [[64b666471]](https://git.sudo.ws/sudo/commit/?id=64b666471)

2023-06-14 Todd C. Miller

* MANIFEST:

  Add plugins/sudoers/regress/testsudoers/passwd to MANIFEST.
  [[dc49e11fa]](https://git.sudo.ws/sudo/commit/?id=dc49e11fa)

* plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po, po/eo.mo, po/eo.po,
  po/pl.mo, po/pl.po:

  Updated translations from translationproject.org
  [[c5c589da0]](https://git.sudo.ws/sudo/commit/?id=c5c589da0)

* NEWS:

  Document recent bug fixes.
  [[4f9185f4c]](https://git.sudo.ws/sudo/commit/?id=4f9185f4c)

* MANIFEST, plugins/sudoers/regress/testsudoers/group,
  plugins/sudoers/regress/testsudoers/passwd,
  plugins/sudoers/regress/testsudoers/test22.out.ok,
  plugins/sudoers/regress/testsudoers/test22.sh,
  plugins/sudoers/regress/testsudoers/test23.out.ok,
  plugins/sudoers/regress/testsudoers/test23.sh:

  Add tests to exercise recent runas user and group bug fixes.
  [[baf482763]](https://git.sudo.ws/sudo/commit/?id=baf482763)

* MANIFEST, plugins/sudoers/regress/testsudoers/passwd,
  plugins/sudoers/regress/testsudoers/test21.out.ok,
  plugins/sudoers/regress/testsudoers/test21.sh:

  Add test to exercise the bug that prevented the group specified via
  “sudo -g” from matching when a Runas\_Alias was used in the user or group
  portion of a Runas\_Spec.
  [[0d1732503]](https://git.sudo.ws/sudo/commit/?id=0d1732503)

2023-06-13 Todd C. Miller

* plugins/sudoers/match.c:

  runaslist\_matches: split out user\_list and group\_list matching.

  This makes it possible to call the appropriate runas user or group list
  match function when resolving aliases instead of calling
  runaslist\_matches() itself. Fixes a bug that prevented the group
  specified via “sudo -g” from matching when a Runas\_Alias was used in the
  user or group portion of a Runas\_Spec.
  [[78e65e14e]](https://git.sudo.ws/sudo/commit/?id=78e65e14e)

* plugins/sudoers/match.c:

  runaslist\_matches: fix bug when no runas list is specified in sudoers.

  If a sudoers rule has no runas list, a user-specified runas group should
  only be allowed if it matches a group that the default runas user
  belongs to. Instead, a missing group check allowed the user run commands
  as the default runas user with an arbitrary group.

  This means that a rule like “somebody host = ALL”, which should be
  equivalent to “somebody host = (root) ALL”, had the same effect as
  “somebody host = (root:ALL) ALL”.
  [[471028351]](https://git.sudo.ws/sudo/commit/?id=471028351)

* plugins/sudoers/match.c:

  runaslist\_matches: remove special case to handle “sudo -g group”

  Now that we are guaranteed to have a runas user list for all sudoers
  rules that contain a runas list, we can remove support for the special
  case where user\_matched is set in the runas group matching conditional.
  This fixes a bug where “sudo -u myuser -g mygroup” was permitted by a
  rule like “myuser ALL = (root) ALL”.
  [[8c1559e0e]](https://git.sudo.ws/sudo/commit/?id=8c1559e0e)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/regress/sudoers/test27.json.ok,
  plugins/sudoers/regress/sudoers/test27.ldif.ok,
  plugins/sudoers/regress/sudoers/test27.out.ok:

  Populate runasusers even when only a grouplist is specified.

  When a sudoers rule permits the user to run commands as a group, not a
  user, we should set the runasusers to single member with the special
  MYSELF token. This guarantees that the only time runasusers will be NULL
  is when no runaslist is present.
  [[64ab8cd23]](https://git.sudo.ws/sudo/commit/?id=64ab8cd23)

2023-06-11 Todd C. Miller

* plugins/python/pyhelpers.h:

  Python may be built with 32-bit time\_t support on 32-bit platforms. We
  need to undef the SIZEOF\_TIME\_T from pyconfig.h so it does not conflict
  with our own.
  [[a28d2d412]](https://git.sudo.ws/sudo/commit/?id=a28d2d412)

2023-06-10 Todd C. Miller

* :

  Merge pull request #272 from millert/main

  Avoid use of variable length arrays and add ctype(3) casts.
  [[ac46157e9]](https://git.sudo.ws/sudo/commit/?id=ac46157e9)

* lib/util/lbuf.c:

  Avoid use of variable length arrays and add ctype(3) casts.
  [[8fbdd414c]](https://git.sudo.ws/sudo/commit/?id=8fbdd414c)

* :

  Merge pull request #270 from moehanabi/main

  Add %n$s support for sudo\_lbuf\_append\_v1
  [[ee4f210f3]](https://git.sudo.ws/sudo/commit/?id=ee4f210f3)

2023-06-09 Brilliant Hanabi

* lib/util/lbuf.c:

  Add %n$s support for sudo\_lbuf\_append\_v1
  [[932339ed9]](https://git.sudo.ws/sudo/commit/?id=932339ed9)

2023-06-09 bianguangze

* plugins/sudoers/alias.c:

  correct the return value type of function alias\_find\_used
  [[b4dcac650]](https://git.sudo.ws/sudo/commit/?id=b4dcac650)

2023-06-07 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/ro.mo, plugins/sudoers/po/ro.po,
  plugins/sudoers/po/ru.mo, plugins/sudoers/po/ru.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po, po/cs.mo, po/cs.po,
  po/de.mo, po/de.po, po/eo.mo, po/eo.po, po/fr.mo, po/fr.po, po/hr.mo,
  po/hr.po, po/ko.mo, po/ko.po, po/ro.mo, po/ro.po, po/ru.mo, po/ru.po,
  po/sr.mo, po/sr.po, po/uk.mo, po/uk.po, po/vi.mo, po/vi.po:

  Updated translations from translationproject.org
  [[5baf817db]](https://git.sudo.ws/sudo/commit/?id=5baf817db)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update .pot files for 1.9.14
  [[2c58d8075]](https://git.sudo.ws/sudo/commit/?id=2c58d8075)

* NEWS:

  Mention [Bug #1050](https://bugzilla.sudo.ws/show_bug.cgi?id=1050) fix.
  [[2077b5157]](https://git.sudo.ws/sudo/commit/?id=2077b5157)

2023-06-05 Todd C. Miller

* NEWS, configure, configure.ac:

  sudo 1.9.14
  [[c7070b047]](https://git.sudo.ws/sudo/commit/?id=c7070b047)

2023-06-07 Todd C. Miller

* docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in,
  plugins/sudoers/ldap.c, plugins/sudoers/ldap\_conf.c,
  plugins/sudoers/sudo\_ldap\_conf.h:

  Add NETGROUP\_QUERY option for servers that can’t match
  nisNetgroupTriple. This can be used to support netgroup queries on
  systems that lack the innetgr() function and where the LDAP server
  cannot query the nisNetgroup by nisNetgroupTriple.
  [[3786654db]](https://git.sudo.ws/sudo/commit/?id=3786654db)

2023-06-06 Todd C. Miller

* plugins/sudoers/defaults.c, plugins/sudoers/ldap.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.h:

  sudo\_ldap\_check\_non\_unix\_group: pass nss pointer to netgr\_matches() This
  allows us to use the LDAP-specific version of innetgr() when possible.
  Also enable “use\_netgroups” by default even on systems without innetgr()
  since we can now query netgroups directly via LDAP.
  [[6fddb2875]](https://git.sudo.ws/sudo/commit/?id=6fddb2875)

2023-06-05 Todd C. Miller

* src/exec\_ptrace.c:

  Only call ptrace\_verify\_post\_exec() for intercept, not log\_subcmds.
  [[245c56bac]](https://git.sudo.ws/sudo/commit/?id=245c56bac)

2023-06-04 Todd C. Miller

* plugins/sudoers/visudo.c:

  run\_command: back out changes to run editor in its own process group. It
  unnecessarily complicates things to work around bugs in an OS almost no
  one runs.
  [[2392ee9d7]](https://git.sudo.ws/sudo/commit/?id=2392ee9d7)

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in,
  lib/util/util.exp.in, plugins/sudoers/Makefile.in, src/Makefile.in,
  src/sudo\_exec.h, src/suspend\_parent.c:

  Make suspend\_parent.c out of lib/util and into src. Nothing else uses it
  now.
  [[95cd40907]](https://git.sudo.ws/sudo/commit/?id=95cd40907)

2023-06-03 Todd C. Miller

* plugins/sudoers/digestname.c, plugins/sudoers/filedigest.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.h,
  plugins/sudoers/regress/parser/check\_digest.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Initialize digest\_type to SUDO\_DIGEST\_INVALID, not -1 and make it
  unsigned. This makes the digest type consistently unsigned instead of a
  mix of signed (for the -1 value in the tokenizer) and unsigned.
  [[1278e36ff]](https://git.sudo.ws/sudo/commit/?id=1278e36ff)

2023-05-25 Todd C. Miller

* docs/sudo\_plugin\_python.man.in, docs/sudo\_plugin\_python.mdoc.in,
  etc/codespell.exclude, etc/codespell.ignore, plugins/sudoers/getdate.c,
  plugins/sudoers/getdate.y, plugins/sudoers/pivot.c,
  plugins/sudoers/visudo.c:

  Fix typos and update excluded/ignored codespell lists.
  [[d633d82f2]](https://git.sudo.ws/sudo/commit/?id=d633d82f2)

2023-05-19 Todd C. Miller

* plugins/sudoers/visudo.c:

  run\_command: check that ttyfd is not -1 before using it
  [[0986a8846]](https://git.sudo.ws/sudo/commit/?id=0986a8846)

2023-05-11 Todd C. Miller

* plugins/sudoers/visudo.c:

  Work around a macOS a kernel bug where tcsetpgrp() does not restart.

  I reported this bug to Apple over 12 years ago.
  [[4d417b46d]](https://git.sudo.ws/sudo/commit/?id=4d417b46d)

* plugins/sudoers/visudo.c:

  run\_command: run editor in foreground if visudo is the foreground
  process

  The command is now always run in its own process group. If visudo is run
  in the foreground, the command is run in the foreground too. Otherwise,
  run the command in the background. There is a race between the
  tcsetpgrp() call in the parent and the execve() in the child. If we lose
  the race and the command needs the controlling terminal, it will be
  stopped with SIGTTOU or SIGTTIN, which the waitpid() loop will handle.
  [[be20e1592]](https://git.sudo.ws/sudo/commit/?id=be20e1592)

* plugins/sudoers/visudo.c:

  Accept carriage return for EOL in addition to newline.

  Since visudo doesn’t alter the terminal settings it is possible for the
  terminal to have the ONLCR bit set in the output control flags. In that
  case, we will get a CR, not a NL when the user presses enter/return. One
  way this can happen is if visudo is run in the background from a shell
  that supports line editing and the editor restores the (cbreak-style)
  terminal mode when it finishes.
  [[7e28e60b5]](https://git.sudo.ws/sudo/commit/?id=7e28e60b5)

2023-05-09 Todd C. Miller

* plugins/sudoers/regress/parser/check\_fill.c:

  check\_fill: sudoers\_strict() is now a function, not a global variable
  [[91f100f5b]](https://git.sudo.ws/sudo/commit/?id=91f100f5b)

* plugins/sudoers/parse.h, plugins/sudoers/sudoers.h,
  plugins/sudoers/toke.h:

  Move parser prototypes / externs from sudoers.h to parse.h or toke.h.
  [[f352ef5d6]](https://git.sudo.ws/sudo/commit/?id=f352ef5d6)

* plugins/sudoers/file.c, plugins/sudoers/sudoers.c:

  parse.h is already included by sudoers.h.
  [[01ff7c476]](https://git.sudo.ws/sudo/commit/?id=01ff7c476)

* plugins/sudoers/policy.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Rename parser\_conf -> sudoers\_conf in all but the parser itself.
  [[bde363e06]](https://git.sudo.ws/sudo/commit/?id=bde363e06)

2023-05-08 Todd C. Miller

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/file.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.h,
  plugins/sudoers/policy.c, plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Move sudoers search path to struct sudoers\_parser\_config.

  That way we can avoid passing it to init\_parser() directly. We still
  need sudoers\_search\_path to be shared between the lexer and the parser.
  [[8cbd5462a]](https://git.sudo.ws/sudo/commit/?id=8cbd5462a)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/file.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.h,
  plugins/sudoers/policy.c, plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c:

  Add struct sudoers\_parser\_config and pass it to init\_parser().

  This struct contains parser configuration such as the sudoers file
  uid/gid/mode and parse flags such as verbose, strict and recovery.
  [[9d7c30c5a]](https://git.sudo.ws/sudo/commit/?id=9d7c30c5a)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  push\_include\_int: Avoid passing close(2) a negative value on error.
  Coverity CID 314108
  [[fb9d0d79a]](https://git.sudo.ws/sudo/commit/?id=fb9d0d79a)

* plugins/sudoers/ldap.c:

  Eliminate dead store. Coverity CID 315032.
  [[f722272b7]](https://git.sudo.ws/sudo/commit/?id=f722272b7)

2023-05-05 Todd C. Miller

* include/sudo\_iolog.h, lib/iolog/iolog\_gets.c:

  iolog\_gets: change size parameter to int to match fgets/gzgets

  Return an error, setting errno to EINVAL, for negative sizes.
  [[2f4b40680]](https://git.sudo.ws/sudo/commit/?id=2f4b40680)

2023-05-04 Todd C. Miller

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Rename force\_umask to override\_umask and make it private to sudoers.c.

  Add getter for policy.c.
  [[c0fa3a4d2]](https://git.sudo.ws/sudo/commit/?id=c0fa3a4d2)

* plugins/sudoers/check.h, plugins/sudoers/regress/fuzz/fuzz\_stubs.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/timestamp.c:

  Make timestamp\_uid and timestamp\_gid private to timestamp.c.

  Add getter (for set\_perms.c) and setter (for sudoers.c).
  [[72489d7a8]](https://git.sudo.ws/sudo/commit/?id=72489d7a8)

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/sudo\_auth.h,
  plugins/sudoers/policy.c, plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/sudoers.h:

  Make login\_style private to bsdauth.c

  Add a setter for policy.c to handle auth\_type from the front-end.
  [[d5de5890f]](https://git.sudo.ws/sudo/commit/?id=d5de5890f)

2023-05-03 Todd C. Miller

* lib/util/sudo\_debug.c:

  Back out last change, len must be int, not size\_t, for %.\*s.
  [[cda03ed13]](https://git.sudo.ws/sudo/commit/?id=cda03ed13)

* src/exec\_pty.c:

  Use a “%s” format instead of using a translated string as the format.
  [[27ea64bac]](https://git.sudo.ws/sudo/commit/?id=27ea64bac)

* :

  Merge pull request #260 from AtariDreams/size\_t

  Prefer size\_t over int, as casting can take extra instructions
  [[16191bb3d]](https://git.sudo.ws/sudo/commit/?id=16191bb3d)

2023-05-03 Rose

* lib/eventlog/parse\_json.c, lib/util/sudo\_debug.c,
  plugins/sudoers/fmtsudoers.c:

  Prefer size\_t over int, as casting can take extra instructions
  [[459a49b1f]](https://git.sudo.ws/sudo/commit/?id=459a49b1f)

2023-05-02 Todd C. Miller

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/parse.h,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Rename init\_parser\_ext() to init\_parser() and remove old wrapper.

  There was only one consumer of the init\_parser() wrapper now that
  reset\_parser() has been introduced.
  [[bbbaea5b2]](https://git.sudo.ws/sudo/commit/?id=bbbaea5b2)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.h,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sudoers.c:

  Add reset\_parser() and use in place of init\_parser(NULL).
  [[f258a15df]](https://git.sudo.ws/sudo/commit/?id=f258a15df)

* plugins/sudoers/ldap.c, plugins/sudoers/ldap\_conf.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.h:

  Make path\_ldap\_conf and path\_ldap\_secret private to policy.c.

  Add getters for both so the ldap code can access them.
  [[80768ed3a]](https://git.sudo.ws/sudo/commit/?id=80768ed3a)

* plugins/sudoers/file.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/visudo.c:

  Make sudoers\_file private to policy.c and visudo.c.

  We just need a way for the policy (and visudo) to override the default
  sudoers path. This adds a getter to be used in file.c when sudoers is
  first opened.
  [[f553ddc43]](https://git.sudo.ws/sudo/commit/?id=f553ddc43)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.h,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/visudo.c:

  Support adminconfdir for relative include paths in sudoers.
  [[5446b009e]](https://git.sudo.ws/sudo/commit/?id=5446b009e)

* plugins/sudoers/visudo.c:

  Track the destination sudoers path for each parsed file.

  When adminconfdir is enabled, the destination pathh may be different
  from the path we opened. We always store an edited file in the
  adminconfdir (if enabled). This makes it possible to use visudo when
  /etc/sudoers is located on a read-only file system.
  [[7a6ac5d26]](https://git.sudo.ws/sudo/commit/?id=7a6ac5d26)

* INSTALL.md, Makefile.in, configure, configure.ac, docs/Makefile.in,
  examples/Makefile.in, include/Makefile.in, lib/util/Makefile.in,
  lib/zlib/Makefile.in, logsrvd/Makefile.in, m4/sudo.m4,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/python/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_approval/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Add adminconfdir and –enable-adminconf to set it. Configuration paths
  in sudo are now a colon-separated list of files with the adminconfdir
  instance first (if enabled), followed by a sysconfdir instance.
  [[d4c6ef122]](https://git.sudo.ws/sudo/commit/?id=d4c6ef122)

2023-02-08 Todd C. Miller

* configure, configure.ac, m4/sudo.m4, pathnames.h.in,
  plugins/sudoers/visudo.c:

  Substitute for \_PATH\_SUDO\* variables in pathnames.h. Previously these
  were hard-coded with Makefile overrides.
  [[9ad6dfa37]](https://git.sudo.ws/sudo/commit/?id=9ad6dfa37)

2023-05-02 Todd C. Miller

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/file.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/visudo.c:

  Support sudoers\_file being a colon-separated path of files. The first
  file found is used.
  [[f17b35471]](https://git.sudo.ws/sudo/commit/?id=f17b35471)

* configure, configure.ac, include/sudo\_util.h, lib/util/Makefile.in,
  lib/util/secure\_path.c, lib/util/sudo\_conf.c, lib/util/util.exp.in,
  logsrvd/Makefile.in, logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c,
  plugins/sudoers/Makefile.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/sudoers.c, src/Makefile.in:

  Convert config file paths to colon-separated path list. This means that
  \_PATH\_SUDO\_CONF, \_PATH\_SUDOERS, \_PATH\_SUDO\_LOGSRVD\_CONF, and
  \_PATH\_CVTSUDOERS\_CONF can now specify multiple files. The first file
  that exists is used.
  [[4363d03ef]](https://git.sudo.ws/sudo/commit/?id=4363d03ef)

2023-05-01 Todd C. Miller

* config.h.in, configure:

  Regenerate with latest autoconf from git.
  [[a7e906ff6]](https://git.sudo.ws/sudo/commit/?id=a7e906ff6)

2023-04-28 Todd C. Miller

* logsrvd/logsrvd\_conf.c:

  No longer need to set AI\_NUMERICSERV while fuzzing.

  Now that getaddrinfo() is stubbed out while fuzzing we can remove the
  hack that set AI\_NUMERICSERV.
  [[978aa9002]](https://git.sudo.ws/sudo/commit/?id=978aa9002)

2023-04-26 Todd C. Miller

* logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  getaddrinfo stub: set sin\_port
  [[d1f2452c0]](https://git.sudo.ws/sudo/commit/?id=d1f2452c0)

* logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Avoid NULL deref in stub getaddrinfo() when nodename is NULL. Also add
  support for parsing servname. We only need to support a subset of
  getaddrinfo() functionality in the fuzzer.
  [[2898c8511]](https://git.sudo.ws/sudo/commit/?id=2898c8511)

* configure, m4/hardening.m4:

  Add missing stdio.h include for the \_FORTIFY\_SOURCE=2 check.
  Implementations of \_FORTIFY\_SOURCE require the header file to be
  included. Also remove the useless test of an empty program with
  \_FORTIFY\_SOURCE defined. Pointed out by Florian Weimer.
  [[075ee0f9d]](https://git.sudo.ws/sudo/commit/?id=075ee0f9d)

* configure, m4/ldap.m4:

  Use ldap\_msgfree() instead of ldap\_init() for the lber.h test. The
  ldap\_init() function is marked as deprecated and not defined by default
  on some systems. This can cause an error for compilers that do not
  support implicit function declarations. From Florian Weimer.
  [[b83140e0f]](https://git.sudo.ws/sudo/commit/?id=b83140e0f)

2023-04-25 Todd C. Miller

* logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  Include arpa/inet.h for inet\_pton() prototype.
  [[47ae92d03]](https://git.sudo.ws/sudo/commit/?id=47ae92d03)

* logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  Add netdb.h for struct addrinfo and EAI\_\* error codes.
  [[3d4dc19ec]](https://git.sudo.ws/sudo/commit/?id=3d4dc19ec)

* logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  Stub out getaddrinfo() and freeaddrinfo(). We may not be able have
  access to DNS in the fuzzing environment.
  [[64f6d6fdb]](https://git.sudo.ws/sudo/commit/?id=64f6d6fdb)

* lib/eventlog/regress/eventlog\_store/store\_sudo\_test.c:

  Plug memory leaks in store\_sudo\_test found by LSAN.
  [[8c85fefae]](https://git.sudo.ws/sudo/commit/?id=8c85fefae)

2023-04-24 Todd C. Miller

* src/limits.c:

  disable\_coredump: only change the soft limit, leave the hard limit as-is
  This should avoid problems on Linux in cases where sudo does not have
  CAP\_SYS\_RESOURCE which may be the case in an unprivileged container.
  [GitHub issue #42](https://github.com/sudo-project/sudo/issues/42)
  [[b1deffbe5]](https://git.sudo.ws/sudo/commit/?id=b1deffbe5)

2023-04-19 Todd C. Miller

* scripts/build\_pkgs:

  Add basic support for remote power on/off via net-snmp.
  [[e2243e373]](https://git.sudo.ws/sudo/commit/?id=e2243e373)

* src/exec.c:

  More accurate description of what happens for “sudo -b”.
  [[6c3c8acba]](https://git.sudo.ws/sudo/commit/?id=6c3c8acba)

2023-04-18 Todd C. Miller

* src/exec\_nopty.c, src/exec\_pty.c, src/selinux.c, src/sudo.h,
  src/ttyname.c:

  Avoid calling isatty()/ttyname() on std{in,out,err} if not a char dev.

  The user controls these fds so we should avoid calling ioctl(2) on them
  unless they correspond to actual character device files.
  [[ab0f8dda3]](https://git.sudo.ws/sudo/commit/?id=ab0f8dda3)

2023-04-19 Todd C. Miller

* src/exec\_pty.c:

  Better support for “sudo -b” when running the command in a pty.

  When a command is run via “sudo -b” it has no access to terminal input.
  In non-pty mode, the command runs in an orphaned process group and reads
  from the controlling terminal fail with EIO. We cannot do the same while
  running in a pty but if we set stdin to a half-closed pipe, reads from
  it will get EOF. That is close enough.
  [[fe80c27de]](https://git.sudo.ws/sudo/commit/?id=fe80c27de)

2023-04-18 Todd C. Miller

* src/parse\_args.c, src/sudo\_usage.h.in:

  Hard-code usage() and help() for an 80-column terminal.

  Trying to tailor the help and usage output to the terminal width is
  simply not worth it and could be abused to mark a socket as “trusted” on
  Linux if there are additional kernel bugs like CVE-2023-2002.
  [[b24af7b3e]](https://git.sudo.ws/sudo/commit/?id=b24af7b3e)

* config.h.in, configure, configure.ac, src/sudo.c, src/sudo\_usage.h.in:

  Move CONFIGURE\_ARGS from sudo\_usage.h.in to config.h.in.
  [[65c0b5a08]](https://git.sudo.ws/sudo/commit/?id=65c0b5a08)

2023-04-17 Todd C. Miller

* lib/util/ttysize.c, src/sudo.c:

  get\_user\_info: call sudo\_get\_ttysize() even if no /dev/tty We still want
  to initialize rows and cols based on the environment if possible.
  [[80b85bdd5]](https://git.sudo.ws/sudo/commit/?id=80b85bdd5)

2023-04-16 Todd C. Miller

* src/parse\_args.c:

  Get the tty size using stdout, not stderr, when printing help output.
  While usage() prints to stderr, help() prints to stdout.
  [[4ac994179]](https://git.sudo.ws/sudo/commit/?id=4ac994179)

* src/sudo.c:

  get\_user\_info: pass sudo\_get\_ttysize() the fd of /dev/tty, not stderr.
  Both the plugin API and the main event loop expect lines/cols to refer
  to the user’s terminal, so using /dev/tty is better here.
  [[d1912957a]](https://git.sudo.ws/sudo/commit/?id=d1912957a)

* include/sudo\_util.h, lib/util/ttysize.c, lib/util/util.exp.in,
  plugins/sudoers/sudoreplay.c, src/parse\_args.c, src/sudo.c:

  Add an fd argument to sudo\_get\_ttysize() instead of always using stderr.

  For sudoreplay we open /dev/tty, so use that instead of stderr when
  determining the terminal size.
  [[cc22cca34]](https://git.sudo.ws/sudo/commit/?id=cc22cca34)

* lib/util/ttysize.c:

  Check whether stderr is a tty before trying TIOCGWINSZ.
  [[5650b436e]](https://git.sudo.ws/sudo/commit/?id=5650b436e)

2023-04-14 Todd C. Miller

* configure, configure.ac:

  Use -no-undefined on macOS to avoid “-undefined dynamic\_lookup”
  warnings.

  Starting with macOS 13, the linker warns when “-undefined
  dynamic\_lookup” is used. This is added by libtool by default on macOS
  but we can suppress it by passing -no-undefined to libtool.
  [[ae12d18ff]](https://git.sudo.ws/sudo/commit/?id=ae12d18ff)

2023-04-08 Todd C. Miller

* docker/debian/latest/Dockerfile, docker/debian/testing/Dockerfile,
  docker/fedora/latest/Dockerfile, docker/fedora/rawhide/Dockerfile,
  docker/ubuntu/devel/Dockerfile, docker/ubuntu/latest/Dockerfile,
  docker/ubuntu/rolling/Dockerfile:

  Add make to Dockerfile and sort packages.
  [[62a2d9f94]](https://git.sudo.ws/sudo/commit/?id=62a2d9f94)

2023-04-06 Todd C. Miller

* docs/UPGRADE.md, docs/sudoers.man.in, docs/sudoers.mdoc.in,
  plugins/sudoers/defaults.c:

  Enable the use\_pty option by default for sudo 1.9.14.

  [GitHub issue #258](https://github.com/sudo-project/sudo/issues/258)
  [[894daa88f]](https://git.sudo.ws/sudo/commit/?id=894daa88f)

2023-04-05 Todd C. Miller

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Split up the monolithic sudoers\_policy\_main() function.

  This splits the code to find the command, perform a sudoers lookup, ask
  for a password as needed, and perform post-lokup checks out into
  sudoers\_check\_common(). The old sudoers\_policy\_main() has been replaced
  by sudoers\_check\_cmnd() (called by sudoers\_policy\_check()),
  sudoers\_validate\_user() (called by sudoers\_policy\_validate()) and
  sudoers\_list() (called by sudoers\_policy\_list()). The list\_user lookup
  is now performed in sudoers\_list().
  [[d7b8f3ffb]](https://git.sudo.ws/sudo/commit/?id=d7b8f3ffb)

* plugins/sudoers/sudoers.c:

  Move the root\_sudo check until after we apply per-command Defaults.

  It is possible, though unlikely, for “root\_sudo” to be used in a
  per-command Defaults statement.
  [[859a81ad2]](https://git.sudo.ws/sudo/commit/?id=859a81ad2)

2023-04-01 Todd C. Miller

* plugins/sudoers/sudoers.c:

  sudoers\_policy\_main: restore locale if sudoers\_lookup() fails.

  Previously, if sudoers\_lookup() set VALIDATE\_ERROR, the sudoers locale
  would still be in effect instead of the original locale.
  [[ab4b94716]](https://git.sudo.ws/sudo/commit/?id=ab4b94716)

* plugins/sudoers/parse.c:

  sudoers\_lookup\_pseudo: remove validated function argument

  This was always set to FLAG\_NO\_USER|FLAG\_NO\_HOST which are cleared at
  the top of the fuction. Make validated a local variables, initialized to
  0, instead. No change in behavior.
  [[fb0a36c1a]](https://git.sudo.ws/sudo/commit/?id=fb0a36c1a)

2023-03-31 Todd C. Miller

* plugins/sudoers/audit.c, plugins/sudoers/iolog.c:

  The I/O log file name is not just the basename of the full iolog\_path.
  The audit plugin already has the correct value for iolog\_file, don’t
  overwrite it with basename(iolog\_path). In the future we may wish to
  pass in iolog\_file and iolog\_dir in addition to iolog\_path. Fixes [Bug
  #1046](https://bugzilla.sudo.ws/show_bug.cgi?id=1046).
  [[0a4c8872a]](https://git.sudo.ws/sudo/commit/?id=0a4c8872a)

2023-03-29 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Warn with “unknown user” not “unknown uid” if user cannot be resolved.
  Prior to sudo 1.8 this was after a getpwuid() but now we use getpwnam().
  [[ac12f82d8]](https://git.sudo.ws/sudo/commit/?id=ac12f82d8)

* plugins/sudoers/sudoers.c:

  Set timestamp\_uid and timestamp\_gid via a callback. This also makes it
  possible to include the location of the line in the sudoers file in the
  warning message (and mail).
  [[ad890acf6]](https://git.sudo.ws/sudo/commit/?id=ad890acf6)

2023-03-28 Todd C. Miller

* docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in:

  Fix display of escape sequencees in ldapsearch example.
  [[493b2441d]](https://git.sudo.ws/sudo/commit/?id=493b2441d)

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  White space is not allowed between Defaults and ‘@’, ‘:’, ‘!’, ‘>’.
  The EBNF made it appear that this is allowed when it really is not.
  [[3b55de4e8]](https://git.sudo.ws/sudo/commit/?id=3b55de4e8)

2023-03-27 Todd C. Miller

* src/edit\_open.c, src/exec.c, src/exec\_intercept.c, src/exec\_intercept.h,
  src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c, src/sudo.c,
  src/sudo.h, src/sudo\_edit.c, src/sudo\_edit.h, src/sudo\_exec.h,
  src/tgetpass.c:

  Make struct {command,user}\_details pointers const where possible.
  [[f0030cf30]](https://git.sudo.ws/sudo/commit/?id=f0030cf30)

* src/sudo.c, src/sudo.h, src/sudo\_edit.c, src/tgetpass.c:

  Make user\_details private to main.
  [[554397eae]](https://git.sudo.ws/sudo/commit/?id=554397eae)

* src/exec.c, src/exec\_nopty.c, src/exec\_pty.c, src/parse\_args.c,
  src/sudo.c, src/sudo.h, src/sudo\_edit.c, src/sudo\_exec.h,
  src/tgetpass.c:

  Make user\_details private to sudo.c.
  [[5108c279a]](https://git.sudo.ws/sudo/commit/?id=5108c279a)

2023-03-25 Todd C. Miller

* src/parse\_args.c:

  Use sudo\_get\_ttysize() in help() and usage(). This eliminates a
  dependency on the user\_details global.
  [[e435b158b]](https://git.sudo.ws/sudo/commit/?id=e435b158b)

2023-03-27 Todd C. Miller

* configure, scripts/config.sub:

  Regenerate with the autoconf 2.72c snapshot.
  [[f95c9f839]](https://git.sudo.ws/sudo/commit/?id=f95c9f839)

2023-03-25 Todd C. Miller

* src/exec.c, src/sudo.c, src/sudo.h:

  Store submitcwd (from user\_details) in struct command\_details. This
  eliminates use of the user\_details global from exec\_setup().
  [[86002226b]](https://git.sudo.ws/sudo/commit/?id=86002226b)

2023-03-24 Todd C. Miller

* src/utmp.c:

  utmp\_fill: user is now always non-NULL, no need for user\_details.
  [[51453c4f2]](https://git.sudo.ws/sudo/commit/?id=51453c4f2)

* src/parse\_args.c, src/sudo.c, src/sudo.h:

  Remove list\_user global.
  [[fa5a28f34]](https://git.sudo.ws/sudo/commit/?id=fa5a28f34)

* src/conversation.c:

  No need to declare tgetpass\_flags, it is already in sudo.h.
  [[a5b11a58b]](https://git.sudo.ws/sudo/commit/?id=a5b11a58b)

* src/sudo.c:

  No need for sudo\_mode to be global anymore.
  [[9fd787343]](https://git.sudo.ws/sudo/commit/?id=9fd787343)

* src/sudo.c:

  Make command\_details private to main().
  [[11277bb92]](https://git.sudo.ws/sudo/commit/?id=11277bb92)

* src/exec\_iolog.c, src/exec\_nopty.c, src/exec\_pty.c, src/sudo\_exec.h:

  Make iobufs private to exec\_iolog.c.
  [[8d2b9a434]](https://git.sudo.ws/sudo/commit/?id=8d2b9a434)

* src/sudo\_exec.h:

  Remove ttymode and its associated values.
  [[ee3f99c88]](https://git.sudo.ws/sudo/commit/?id=ee3f99c88)

* src/exec.c, src/exec\_pty.c, src/get\_pty.c, src/sudo.h, src/sudo\_exec.h:

  Move ptyname to struct exec\_closure
  [[f9b1beced]](https://git.sudo.ws/sudo/commit/?id=f9b1beced)

* src/exec\_monitor.c, src/exec\_pty.c, src/sudo\_exec.h:

  Move pty\_make\_controlling() to exec\_monitor.c where it is called. We can
  use details->tty to access the pty follower path.
  [[22776b0be]](https://git.sudo.ws/sudo/commit/?id=22776b0be)

* src/exec\_pty.c, src/sudo.c:

  Eliminate utmp\_user global, just use the value in struct command
  details.
  [[7ac9ce001]](https://git.sudo.ws/sudo/commit/?id=7ac9ce001)

* src/exec\_iolog.c, src/exec\_nopty.c, src/exec\_pty.c, src/sudo\_exec.h:

  Replace tty\_mode global with term\_raw flag in struct exec\_closure.

  The pty\_cleanup hook needs access to the closure so add
  pty\_cleanup\_init() to store a pointer to the closure for use by
  pty\_cleanup\_hook().
  [[778688d4f]](https://git.sudo.ws/sudo/commit/?id=778688d4f)

* src/exec\_monitor.c, src/exec\_pty.c, src/sudo\_exec.h:

  Register pty cleanup function in exec\_pty(), not exec\_cmnd\_pty(). We
  want it to execute in the main sudo process, not the monitor.
  [[b81c5e8da]](https://git.sudo.ws/sudo/commit/?id=b81c5e8da)

* src/exec\_iolog.c:

  Make ttyblock private to exec\_iolog.c
  [[11739e3de]](https://git.sudo.ws/sudo/commit/?id=11739e3de)

2023-03-23 Todd C. Miller

* src/exec\_pty.c, src/sudo\_exec.h:

  exec\_pty.c: move foreground flag to struct exec\_closure. Also make
  pipeline flag private to exec\_pty() and remove the unneeded
  check\_foreground() prototype.
  [[3303dd98c]](https://git.sudo.ws/sudo/commit/?id=3303dd98c)

* src/exec\_pty.c:

  On resume, always sync the pty terminal settings with /dev/tty.

  Changes made to the terminal settings while the command is suspended are
  now reflected in the pty when the command is resumed. This is more
  consistent with the non-pty behavior and allows for the removal of the
  “tty\_initialized” global. One downside to this change is that if a
  terminal-based program using the pty is stopped with SIGSTOP it may have
  the wrong terminal settings on resume. However, this is no different
  from the non-pty case.
  [[51cdb194b]](https://git.sudo.ws/sudo/commit/?id=51cdb194b)

* lib/util/suspend\_parent.c, lib/util/term.c:

  Correct a comment.
  [[3e734fa51]](https://git.sudo.ws/sudo/commit/?id=3e734fa51)

2023-03-22 Todd C. Miller

* .github/FUNDING.yml:

  GitHub sponsor settings.
  [[2a5d8bfea]](https://git.sudo.ws/sudo/commit/?id=2a5d8bfea)

* config.h.in, configure, configure.ac:

  Use built-in tests for bit types instead of using AC\_CHECK\_TYPES. This
  should be more portable as it handles the quirks of some older systems.
  [[f0f5e1b5b]](https://git.sudo.ws/sudo/commit/?id=f0f5e1b5b)

* plugins/sudoers/visudo.c, src/regress/intercept/test\_ptrace.c:

  Quiet compiler warnings on systems where pid\_t is not an int.
  Historically, pid\_t was a long on some 32-bit systems like Solaris.
  [[a17491972]](https://git.sudo.ws/sudo/commit/?id=a17491972)

* plugins/sudoers/visudo.c:

  Silence “used uninitialized” false positives with older gcc versions.
  [[775059156]](https://git.sudo.ws/sudo/commit/?id=775059156)

* src/exec\_pty.c:

  exec\_pty: always copy the terminal settings from /dev/tty the pty.
  Previously, we only did this when running in the foreground but this can
  cause problems when running a program that reads the terminal settings
  or window size in the background. If sudo is running in the background,
  the terminal settings will be updated if it transitions to the
  foreground process. Based on a suggestion from From Duncan Overbruck.
  [[9d55ae892]](https://git.sudo.ws/sudo/commit/?id=9d55ae892)

* src/exec\_pty.c:

  check\_foreground: use SFD\_LEADER not SFD\_FOLLOWER (which was closed).
  Also use SFD\_LEADER for sudo\_term\_copy() in exec\_pty() for consistency.
  From Duncan Overbruck.
  [[98ec786b4]](https://git.sudo.ws/sudo/commit/?id=98ec786b4)

* src/exec\_pty.c:

  suspend\_sudo\_pty: fix cut & pasto in last commit to catch SIGCONT. Also
  set sa.sa\_handler to SIG\_DFL instead of SIG\_IGN. There is no difference
  for SIGCONT but it means we can re-use sa as-is later.
  [[acbe617fb]](https://git.sudo.ws/sudo/commit/?id=acbe617fb)

2023-03-21 Todd C. Miller

* src/exec\_pty.c:

  Catch SIGCONT and restore terminal settings on resume from SIGSTOP.
  While we cannot catch SIGSTOP, we *can* catch SIGCONT and set /dev/tty
  to raw mode when running in the foreground. Ignore SIGCONT in
  suspend\_sudo\_pty() so we don’t call resume\_terminal() twice.
  [[0fcbcaede]](https://git.sudo.ws/sudo/commit/?id=0fcbcaede)

* src/exec\_monitor.c, src/exec\_pty.c:

  Only convert a signal number to a name if we are going to use it. It is
  mostly used for debug logging.
  [[1772fc7b6]](https://git.sudo.ws/sudo/commit/?id=1772fc7b6)

* src/exec\_monitor.c, src/exec\_pty.c, src/sudo.h:

  Move updating of the window size back to the main sudo process. We can
  use the leader file descriptor with TIOCGWINSZ to set the window size of
  the pty. Thanks to Duncan Overbruck for the hint.
  [[adb84293a]](https://git.sudo.ws/sudo/commit/?id=adb84293a)

* plugins/sudoers/visudo.c:

  visudo: restore controlling terminal after running the editor.
  Otherwise, visudo will get SIGTTOU if it tries to write to the terminal
  after the editor finishes. Also avoid races by setting the process group
  ID in both the parent and child, and grant the controlling terminal in
  the parent, not the child.
  [[c64993a0b]](https://git.sudo.ws/sudo/commit/?id=c64993a0b)

2023-03-20 Todd C. Miller

* docs/visudo.man.in, docs/visudo.mdoc.in, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/sudoers.h,
  plugins/sudoers/toke.c, plugins/sudoers/toke.h, plugins/sudoers/toke.l:

  Warn about ignored files in sudoers.d in visudo.
  [[28ecbe4d5]](https://git.sudo.ws/sudo/commit/?id=28ecbe4d5)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/parse.h,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/visudo.c:

  Replace sudoers\_warnings with sudoers\_verbose. This is now an int, with
  values > 1 reserved for visudo.
  [[8049e4e32]](https://git.sudo.ws/sudo/commit/?id=8049e4e32)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l:

  Split push\_include() into push\_include() and push\_includedir(). This
  moves the “isdir” function argument to the internal version.
  [[738387aa4]](https://git.sudo.ws/sudo/commit/?id=738387aa4)

2023-03-17 Todd C. Miller

* plugins/sudoers/file.c, plugins/sudoers/ldap.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_stubs.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudo\_nss.h:

  Pass around const struct sudo\_nss pointers where possible.
  [[4b563ea44]](https://git.sudo.ws/sudo/commit/?id=4b563ea44)

* plugins/sudoers/alias.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers.h, plugins/sudoers/cvtsudoers\_csv.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/fmtsudoers\_cvt.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.h:

  Pass around const struct sudoers\_parse\_tree pointers where possible.
  [[1f19a6b72]](https://git.sudo.ws/sudo/commit/?id=1f19a6b72)

* plugins/sudoers/sudo\_ldap.h, plugins/sudoers/sudo\_ldap\_conf.h:

  Move non-config-related macros to from sudo\_ldap\_conf.h to sudo\_ldap.h.
  [[70c533ec7]](https://git.sudo.ws/sudo/commit/?id=70c533ec7)

2023-03-16 Todd C. Miller

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/getcwd.c, scripts/mkdep.pl:

  Remove portable getcwd.c, nothing uses it anymore. Any operating system
  supported by sudo already includes getcwd(3).
  [[f5d0b7abf]](https://git.sudo.ws/sudo/commit/?id=f5d0b7abf)

* src/Makefile.in:

  Use LIBPROTOBUF\_C and LIBUTIL variables and use them.
  [[f2f233336]](https://git.sudo.ws/sudo/commit/?id=f2f233336)

2023-03-15 Todd C. Miller

* include/sudo\_util.h:

  Remove now-unused sudo\_timeval\* macros.
  [[14dd995b8]](https://git.sudo.ws/sudo/commit/?id=14dd995b8)

* lib/util/nanosleep.c:

  nanosleep: clear remainder on successful completion Also switch to doing
  everything in terms of struct timespec except for the actual select(2)
  call.
  [[708cdc61b]](https://git.sudo.ws/sudo/commit/?id=708cdc61b)

* lib/eventlog/Makefile.in, lib/iolog/Makefile.in:

  Add lib dependencies for fuzzer and test targets.
  [[3f5e7df3c]](https://git.sudo.ws/sudo/commit/?id=3f5e7df3c)

* lib/eventlog/eventlog\_free.c:

  eventlog\_free: free peeraddr
  [[7683ba1b8]](https://git.sudo.ws/sudo/commit/?id=7683ba1b8)

* plugins/sudoers/ldap\_innetgr.c:

  sudo\_ldap\_netgroup\_match\_str: “-” in a netgroup can never match. We
  already check for a NULL value above so “str == NULL” is always false.
  Found by PVS-Studio.
  [[b965d222d]](https://git.sudo.ws/sudo/commit/?id=b965d222d)

2023-03-14 Todd C. Miller

* lib/iolog/Makefile.in:

  Fix static compilation.
  [[027b42d5a]](https://git.sudo.ws/sudo/commit/?id=027b42d5a)

* MANIFEST:

  Replace eventlog\_json.h with parse\_json.h.
  [[33cb885cf]](https://git.sudo.ws/sudo/commit/?id=33cb885cf)

2023-03-13 Todd C. Miller

* MANIFEST, lib/eventlog/Makefile.in,
  lib/eventlog/regress/eventlog\_store/store\_json\_test.c,
  lib/eventlog/regress/eventlog\_store/store\_sudo\_test.c,
  lib/eventlog/regress/eventlog\_store/test1.json.in,
  lib/eventlog/regress/eventlog\_store/test1.json.out.ok,
  lib/eventlog/regress/eventlog\_store/test1.sudo.out.ok,
  lib/eventlog/regress/eventlog\_store/test2.json.in,
  lib/eventlog/regress/eventlog\_store/test2.json.out.ok,
  lib/eventlog/regress/eventlog\_store/test2.sudo.out.ok,
  lib/eventlog/regress/eventlog\_store/test3.json.in,
  lib/eventlog/regress/eventlog\_store/test3.json.out.ok,
  lib/eventlog/regress/eventlog\_store/test3.sudo.out.ok,
  lib/eventlog/regress/eventlog\_store/test4.json.in,
  lib/eventlog/regress/eventlog\_store/test4.json.out.ok,
  lib/eventlog/regress/eventlog\_store/test4.sudo.out.ok,
  lib/eventlog/regress/parse\_json/check\_parse\_json.c:

  Add tests for JSON and sudo-style log output.
  [[1b3991b71]](https://git.sudo.ws/sudo/commit/?id=1b3991b71)

2023-03-14 Todd C. Miller

* lib/eventlog/eventlog\_free.c, lib/eventlog/parse\_json.c:

  Add support for parsing all fields of struct eventlog.
  [[0f46ffa9f]](https://git.sudo.ws/sudo/commit/?id=0f46ffa9f)

2023-03-13 Todd C. Miller

* plugins/sudoers/match.c:

  Declare domain even if the system lacks innetgr(). Fixes a build error
  on musl-based systems like Alpine.
  [[d8e6396c5]](https://git.sudo.ws/sudo/commit/?id=d8e6396c5)

* lib/eventlog/Makefile.in:

  Add missing definition of $(SED).
  [[918af413f]](https://git.sudo.ws/sudo/commit/?id=918af413f)

* MANIFEST, include/sudo\_eventlog.h, lib/eventlog/Makefile.in,
  lib/eventlog/parse\_json.c, lib/eventlog/parse\_json.h,
  lib/eventlog/regress/parse\_json/check\_parse\_json.c,
  lib/eventlog/regress/parse\_json/test1.in,
  lib/eventlog/regress/parse\_json/test2.in,
  lib/eventlog/regress/parse\_json/test2.out.ok,
  lib/eventlog/regress/parse\_json/test3.in,
  lib/eventlog/regress/parse\_json/test3.out.ok, lib/iolog/Makefile.in,
  lib/iolog/iolog\_json.c, lib/iolog/regress/fuzz/fuzz\_iolog\_json.c:

  Move JSON log parsing from libsudo\_iolog.la to libsudo\_eventlog.la It
  will be used in the upcoming log output tests.
  [[86ab362fd]](https://git.sudo.ws/sudo/commit/?id=86ab362fd)

* lib/eventlog/eventlog.c:

  Add missing " ; " separator between environment variables and command.
  This is a regression introduced in sudo 1.9.13. [GitHub issue
  #254](https://github.com/sudo-project/sudo/issues/254).
  [[12648b4e0]](https://git.sudo.ws/sudo/commit/?id=12648b4e0)

2023-03-12 Todd C. Miller

* docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in:

  Add example to verify support for searching by nisNetgroupTriple.
  [[24f04c8cb]](https://git.sudo.ws/sudo/commit/?id=24f04c8cb)

2023-03-11 Todd C. Miller

* plugins/sudoers/gc.c:

  Remove unused sudoers\_gc\_init() function.
  [[34933ef9d]](https://git.sudo.ws/sudo/commit/?id=34933ef9d)

2023-03-10 Todd C. Miller

* docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in:

  Sudo now does its own netgroup lookups if NETGROUP\_BASE is set.
  Previously, it only performed netgroup queries to determine the list of
  netgroups a user was a member of.
  [[916d8b47c]](https://git.sudo.ws/sudo/commit/?id=916d8b47c)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.c:

  sudoers\_cleanup: free cached environment before running g/c. Avoids a
  double free in fuzz\_policy.
  [[c76ac1cab]](https://git.sudo.ws/sudo/commit/?id=c76ac1cab)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c:

  sudoers\_cleanup: run the garbage collector at the end
  [[cd5cd4533]](https://git.sudo.ws/sudo/commit/?id=cd5cd4533)

* plugins/sudoers/sudoers.c:

  Plugin a memory leak in intercept mode.
  [[c09aabecd]](https://git.sudo.ws/sudo/commit/?id=c09aabecd)

* src/exec\_intercept.c:

  Sync non-intercept version of intercept\_cleanup() declaration.
  [[d5a784442]](https://git.sudo.ws/sudo/commit/?id=d5a784442)

* plugins/sudoers/ldap\_innetgr.c:

  Plug memory leak if ldap\_get\_option() fails with LDAP\_NO\_MEMORY.
  [[33c385a78]](https://git.sudo.ws/sudo/commit/?id=33c385a78)

* src/exec.c, src/exec\_intercept.c, src/sudo\_exec.h:

  Plug a memory leak with ptrace-based intercept.
  [[c61306e58]](https://git.sudo.ws/sudo/commit/?id=c61306e58)

* src/exec\_intercept.c:

  Plug memory leak when log\_subcmds is enabled.
  [[31dad6b17]](https://git.sudo.ws/sudo/commit/?id=31dad6b17)

* lib/util/suspend\_parent.c:

  Pass closure to callback, not the callback pointer itself.
  [[cb7b1dd89]](https://git.sudo.ws/sudo/commit/?id=cb7b1dd89)

* MANIFEST, configure, m4/ldap.m4, plugins/sudoers/Makefile.in,
  plugins/sudoers/ldap.c, plugins/sudoers/ldap\_innetgr.c,
  plugins/sudoers/sudo\_ldap.h, scripts/mkdep.pl:

  Add LDAP-specific innetgr() implementation. Wheh netgroup\_base is set we
  now do out own netgroup lookups using LDAP. Previously, LDAP was queried
  directly to get a list of the netgroups the user belongs to but other
  netgroups queries went through innetgr(3). This makes it possible to use
  netgroups in LDAP sudoers on systems that don’t have an innetgr()
  function. [GitHub issue
  #251](https://github.com/sudo-project/sudo/issues/251).
  [[fc253048f]](https://git.sudo.ws/sudo/commit/?id=fc253048f)

* plugins/sudoers/ldap.c, plugins/sudoers/ldap\_conf.c,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/sudo\_ldap.h:

  Move some functions from ldap.c to ldap\_util.c. These will be used by
  the LDAP innetgr() implementation.
  [[554df8d93]](https://git.sudo.ws/sudo/commit/?id=554df8d93)

2023-03-08 Todd C. Miller

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/file.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudo\_nss.h:

  Add per-source innetgr function pointer and use it in netgr\_matches().
  This will be used to implement LDAP-specific netgroup lookups when
  netgroup\_base is set in ldap.conf.
  [[0aad96bba]](https://git.sudo.ws/sudo/commit/?id=0aad96bba)

* lib/zlib/Makefile.in:

  fix typo in uninstall target
  [[d2582c2cd]](https://git.sudo.ws/sudo/commit/?id=d2582c2cd)

* :

  Merge pull request #252 from bin-ly/main

  fix typo in uninstall target
  [[954980b56]](https://git.sudo.ws/sudo/commit/?id=954980b56)

2023-03-09 bin-ly

* lib/util/Makefile.in:

  fix command error for lib/util/Makefile.in
  [[ec255dca1]](https://git.sudo.ws/sudo/commit/?id=ec255dca1)

2023-03-07 Todd C. Miller

* MANIFEST, lib/util/Makefile.in, lib/util/regress/digest/digest\_test.c:

  Add tests for SHA2 digest support. This uses the NIST byte-oriented
  short message test vectors.
  [[dea110a84]](https://git.sudo.ws/sudo/commit/?id=dea110a84)

2023-03-04 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.13p3
  [[0df56634c]](https://git.sudo.ws/sudo/commit/?id=0df56634c)

2023-03-03 Todd C. Miller

* plugins/sudoers/match.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h:

  A user with “list” privs for root may not list all users. A user with
  “sudo ALL” for root *is* allowed to list any user.
  [[689022978]](https://git.sudo.ws/sudo/commit/?id=689022978)

* plugins/sudoers/policy.c:

  sudoers\_policy\_list: do not set runas\_pw to list\_pw when listing This
  change introduced in sudo 1.9.13 is not actually needed. The “list”
  pseudo-command checks are performed via runas\_matches\_pw() which does
  not use runas\_pw. [GitHub issue
  #248](https://github.com/sudo-project/sudo/issues/248)
  [[452d63d6c]](https://git.sudo.ws/sudo/commit/?id=452d63d6c)

* plugins/sudoers/logging.c, plugins/sudoers/parse.c,
  plugins/sudoers/sudoers.c:

  Fix “sudo -l command args”, broken in sudo 1.9.13. The value of
  user\_args should not contain the command to be run in “sudo -l command
  args”, only the arguments of the command being checked. This restores
  the pre-1.9.13 behavior. [GitHub issue
  #249](https://github.com/sudo-project/sudo/issues/249)
  [[d9e9307d9]](https://git.sudo.ws/sudo/commit/?id=d9e9307d9)

2023-03-01 Todd C. Miller

* logsrvd/logsrv\_util.c, logsrvd/logsrvd.c, logsrvd/logsrvd\_journal.c,
  logsrvd/sendlog.c, plugins/sudoers/log\_client.c:

  Check for sudo\_pow2\_roundup() overflow. Calling
  sudo\_pow2\_roundup(INT\_MAX+2) will return since there is no power of 2
  larger than INT\_MAX+1 that fits in an unsigned int. This is not an issue
  in practice since we restrict messages to 2Mib.
  [[b013711e4]](https://git.sudo.ws/sudo/commit/?id=b013711e4)

* src/exec\_nopty.c, src/exec\_pty.c:

  write\_callback: only enable /dev/tty reader if the command is running
  This fixes a hang when there is /dev/tty data in a buffer to be flushed
  by the final call to del\_io\_events(). We do not want to re-enable the
  reader when flushing the buffers as part of pty\_finish(). See PR #247
  for analysis of the problem and how to reproduce it.
  [[19a660612]](https://git.sudo.ws/sudo/commit/?id=19a660612)

2023-02-28 Todd C. Miller

* plugins/sudoers/regress/testsudoers/test12.out.ok,
  plugins/sudoers/regress/testsudoers/test12.sh:

  Test non-fully qualified path name.
  [[43378de75]](https://git.sudo.ws/sudo/commit/?id=43378de75)

* plugins/sudoers/Makefile.in:

  Fix removal of y.tab.[ch] when generating gram.[ch].
  [[7356a7796]](https://git.sudo.ws/sudo/commit/?id=7356a7796)

* MANIFEST, plugins/sudoers/regress/sudoers/test30.in,
  plugins/sudoers/regress/sudoers/test30.json.ok,
  plugins/sudoers/regress/sudoers/test30.ldif.ok,
  plugins/sudoers/regress/sudoers/test30.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test30.out.ok,
  plugins/sudoers/regress/sudoers/test30.sudo.ok,
  plugins/sudoers/regress/sudoers/test30.toke.ok:

  Add test for using “list” as user, runas and host.
  [[172515c94]](https://git.sudo.ws/sudo/commit/?id=172515c94)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Move handling of the “list” pseudo-command from lexer to parser. The
  special handling of “list” in the lexer meant it could not be used as a
  user, group or host, which was unintentional. [GitHub issue
  #246](https://github.com/sudo-project/sudo/issues/246).
  [[0197491e9]](https://git.sudo.ws/sudo/commit/?id=0197491e9)

2023-02-27 Todd C. Miller

* include/sudo\_compat.h:

  Make the check for HAVE\_DECL\_NSIG consistent with other decl checks.
  [[6c97b84c0]](https://git.sudo.ws/sudo/commit/?id=6c97b84c0)

* plugins/sudoers/match\_command.c:

  Plug memory leak with multiple matching CHROOT= entries. Found by
  oss-fuzz.
  [[a4f31cff2]](https://git.sudo.ws/sudo/commit/?id=a4f31cff2)

2023-02-25 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.13p2.
  [[f4d241262]](https://git.sudo.ws/sudo/commit/?id=f4d241262)

2023-02-21 Todd C. Miller

* MANIFEST, plugins/sudoers/match\_command.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/testsudoers/test20.out.ok,
  plugins/sudoers/regress/testsudoers/test20.sh,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Fix potential double free for rules that include a CHROOT= option. If a
  rule with a CHROOT= option matches the user, host and runas, the
  user\_cmnd variable could be freed twice.
  [[87ce69246]](https://git.sudo.ws/sudo/commit/?id=87ce69246)

2023-02-23 Todd C. Miller

* plugins/sudoers/logging.c:

  Include error string when formatting a SLOG\_PARSE\_ERROR message if
  present.
  [[6c52056d3]](https://git.sudo.ws/sudo/commit/?id=6c52056d3)

* lib/util/lbuf.c:

  Add missing include of errno.h.
  [[0be5a5191]](https://git.sudo.ws/sudo/commit/?id=0be5a5191)

* lib/util/lbuf.c:

  sudo\_lbuf\_expand: check for overflow when rounding to the nearest power
  of 2. Problem deteced by oss-fuzz using the fuzz\_sudoers fuzzer.
  [[3281d0eec]](https://git.sudo.ws/sudo/commit/?id=3281d0eec)

* src/load\_plugins.c:

  Fix –enable-static-sudoers, broken in sudo 1.9.13.
  sudo\_qualify\_plugin() should not try to fully-qualify the path to a
  statically-compiled plugin. [GitHub issue
  #245](https://github.com/sudo-project/sudo/issues/245)
  [[91814990a]](https://git.sudo.ws/sudo/commit/?id=91814990a)

2023-02-22 Todd C. Miller

* plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/sudoers.c:

  Add sudoers open errors to the list of parse errors sent via mail.
  Previously there would be one email for the open failure and a separate
  one describing the parse error. Now a single email message contains
  everything.
  [[fb6740fa2]](https://git.sudo.ws/sudo/commit/?id=fb6740fa2)

* plugins/sudoers/visudo.c:

  visudo: quiet a compiler warning on Solaris 10. Also explicitly close
  /dev/tty fd instead of relying on closefrom() in case the fd ends up
  being a value 0-2.
  [[1641c30ed]](https://git.sudo.ws/sudo/commit/?id=1641c30ed)

* configure, configure.ac, lib/util/Makefile.in:

  Replace LIBMD with LIBCRYPTO display crypto/tls libs in summary. We can
  only have one of either -lmd, -lgcrypt or -lcrypto so there is no need
  to have more than one variable.
  [[8bb116062]](https://git.sudo.ws/sudo/commit/?id=8bb116062)

* :

  Merge pull request #244 from ffontaine/main

  configure.ac: fix openssl static build
  [[05c866b6e]](https://git.sudo.ws/sudo/commit/?id=05c866b6e)

2023-02-22 Fabrice Fontaine

* m4/openssl.m4:

  configure.ac: fix openssl static build

  Do not use AX\_APPEND\_FLAG as it will break static builds by removing
  duplicates such as -lz or -latomic which are needed by -lssl and
  -lcrypto. This will fix the following build failure with sparc which
  needs -latomic:

  Checking for X509\_STORE\_CTX\_get0\_cert configure:21215:
  /home/thomas/autobuild/instance-3/output-1/host/bin/sparc-buildroot-linu
  x-uclibc-gcc -o conftest -D\_LARGEFILE\_SOURCE -D\_LARGEFILE64\_SOURCE
  -D\_FILE\_OFFSET\_BITS=64 -Os -g0 -static -D\_LARGEFILE\_SOURCE
  -D\_LARGEFILE64\_SOURCE -D\_FILE\_OFFSET\_BITS=64 -DZLIB\_CONST -static
  conftest.c
  -L/home/thomas/autobuild/instance-3/output-1/host/bin/../sparc-buildroot
  -linux-uclibc/sysroot/usr/lib -lssl -lz -pthread -latomic -lcrypto >&5
  /home/thomas/autobuild/instance-3/output-1/host/lib/gcc/sparc-buildroot-
  linux-uclibc/10.4.0/../../../../sparc-buildroot-linux-uclibc/bin/ld:
  /home/thomas/autobuild/instance-3/output-1/host/bin/../sparc-buildroot-l
  inux-uclibc/sysroot/usr/lib/libcrypto.a(x509cset.o): in function
  `X509_CRL_up_ref': x509cset.c:(.text+0x108): undefined reference to` \_\_atomic\_fetch\_add\_4’

  […]

  In file included from ./hostcheck.c:38:
  ../../include/sudo\_compat.h:342:41: error: conflicting types for
  ‘ASN1\_STRING\_data’ 342 | # define ASN1\_STRING\_get0\_data(x)
  ASN1\_STRING\_data(x) | ^~~~~~~~~~~~~~~~

  Fixes: -
  <http://autobuild.buildroot.org/results/8be59dd94e4916f9457cb435104e36e62>
  a28373b

  Signed-off-by: Fabrice Fontaine <fontaine.fabrice@…>
  [[1fed5adc1]](https://git.sudo.ws/sudo/commit/?id=1fed5adc1)

2023-02-21 Todd C. Miller

* plugins/sudoers/visudo.c:

  Check tcsetpgrp() return value.
  [[ba7b12645]](https://git.sudo.ws/sudo/commit/?id=ba7b12645)

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in,
  lib/util/suspend\_parent.c, lib/util/util.exp.in,
  plugins/sudoers/visudo.c, src/Makefile.in, src/exec\_iolog.c,
  src/exec\_nopty.c, src/regress/intercept/test\_ptrace.c, src/sudo.h,
  src/sudo\_exec.h, src/tcsetpgrp\_nobg.c:

  Run the editor in its own process group. This fixes suspending the
  editor on GNU Hurd which doesn’t seem to have proper process group
  signal handling.
  [[033933710]](https://git.sudo.ws/sudo/commit/?id=033933710)

* plugins/sudoers/Makefile.in, plugins/sudoers/regress/fuzz/fuzz\_stubs.c,
  plugins/sudoers/stubs.c, plugins/sudoers/testsudoers.c:

  Stub out pivot\_root() and unpivot\_root() for all but the sudoers module.
  [[1bcddb960]](https://git.sudo.ws/sudo/commit/?id=1bcddb960)

* plugins/sudoers/match\_command.c:

  Fix build when SUDOERS\_NAME\_MATCH is defined.
  [[8b9c1b962]](https://git.sudo.ws/sudo/commit/?id=8b9c1b962)

* plugins/sudoers/match\_command.c:

  Match using canonicalized directories where possible.
  [[b52631e87]](https://git.sudo.ws/sudo/commit/?id=b52631e87)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/canon\_path.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Add canon\_path(), a realpath() wrapper that performs caching. This also
  adds a new user\_cmnd\_dir variable that stores the canonicalized parent
  directory of the command to be run.
  [[0ef537367]](https://git.sudo.ws/sudo/commit/?id=0ef537367)

2023-02-12 Todd C. Miller

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/realpath.c, scripts/mkdep.pl:

  Add checks for realpath(3) and a version from NetBSD for those without
  it.
  [[0443d1457]](https://git.sudo.ws/sudo/commit/?id=0443d1457)

2023-02-21 Todd C. Miller

* plugins/sudoers/match\_command.c, plugins/sudoers/match\_digest.c,
  plugins/sudoers/parse.h:

  match\_command: apply runchroot if set when matching the command
  Previously we would prepend runchroot to the path we were checking but
  that does not properly handle symbolic links.
  [[78ff51435]](https://git.sudo.ws/sudo/commit/?id=78ff51435)

* plugins/sudoers/editor.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/goodpath.c,
  plugins/sudoers/regress/editor/check\_editor.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  set\_cmnd\_path: apply runchroot if set when finding the command path
  Previously we would prepend runchroot to the path we were checking but
  that does not properly handle symbolic links.
  [[bff4e3ce1]](https://git.sudo.ws/sudo/commit/?id=bff4e3ce1)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/pivot.c,
  plugins/sudoers/sudoers.h:

  Add pivot\_root() and unpivot\_root() to switch the root dir and restore
  it. This will be used to more accurately handling command resolution and
  path matching when a new root directory is specified.
  [[13a311bc7]](https://git.sudo.ws/sudo/commit/?id=13a311bc7)

* configure, configure.ac:

  Move initial values into AC\_SUBST() where possible.
  [[440d9649a]](https://git.sudo.ws/sudo/commit/?id=440d9649a)

* configure, configure.ac:

  No need to AC\_SUBST() standard autoconf variables.
  [[7c6f37358]](https://git.sudo.ws/sudo/commit/?id=7c6f37358)

* src/exec\_ptrace.c:

  ptrace\_intercept\_execve: preserve old argv[0] after policy check. We
  have to replace argv[0] with the pathname for the policy check but want
  to restore it afterwards if the policy has not changed the command’s
  path name to avoid a mismatch later on.
  [[8d95992c1]](https://git.sudo.ws/sudo/commit/?id=8d95992c1)

2023-02-19 Todd C. Miller

* INSTALL.md:

  Document –disable-largefile and –disable-year2038.
  [[ceee445e8]](https://git.sudo.ws/sudo/commit/?id=ceee445e8)

* configure, configure.ac:

  Fix indentation of intercept file in summary output.
  [[b8c13bbe8]](https://git.sudo.ws/sudo/commit/?id=b8c13bbe8)

* plugins/sudoers/regress/starttime/check\_starttime.c,
  plugins/sudoers/starttime.c:

  get\_starttime: add support for GNU Hurd using the mach task\_info call.
  This is currently Hurd-specific but could be made Mach-generic as long
  as the equivalent of pid2task() is available.
  [[a72bc5e6b]](https://git.sudo.ws/sudo/commit/?id=a72bc5e6b)

2023-02-18 Todd C. Miller

* plugins/sudoers/regress/starttime/check\_starttime.c:

  Only test get\_starttime() on platforms where we support it. Fixes a test
  failure on systems where we have no way to determine a process’s start
  time.
  [[0b000aab8]](https://git.sudo.ws/sudo/commit/?id=0b000aab8)

2023-02-16 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.13p1
  [[58382028a]](https://git.sudo.ws/sudo/commit/?id=58382028a)

* configure.ac:

  Use m4\_bmatch, m4\_case does not support shell-style globbing.
  [[42163ac0a]](https://git.sudo.ws/sudo/commit/?id=42163ac0a)

* configure, configure.ac:

  Allow configure.ac to be processed by autoconf 2.69. AC\_PROG\_CC\_STDC is
  deprecated in autoconf 2.70 and above but it is necessary for autoconf
  2.69.
  [[2feea9b2f]](https://git.sudo.ws/sudo/commit/?id=2feea9b2f)

* configure.ac:

  Only use AC\_SYS\_YEAR2038 if it is defined. Otherwise, use the method
  from 1.9.12. [GitHub issue
  #242](https://github.com/sudo-project/sudo/issues/242)
  [[d7080afe0]](https://git.sudo.ws/sudo/commit/?id=d7080afe0)

2023-02-15 Todd C. Miller

* scripts/mkpkg:

  Sudo-specific executables moved to /usr/libexec/sudo starting in Debian
  12 (Bookworm) and Ubuntu 22.04 (Jammy Jellyfish). Previously, they were
  stored in /usr/lib/sudo.
  [[439f0734f]](https://git.sudo.ws/sudo/commit/?id=439f0734f)

* lib/eventlog/Makefile.in, lib/iolog/Makefile.in, lib/util/Makefile.in,
  logsrvd/Makefile.in, plugins/python/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Handle “locale -a” returning both C.UTF-8 and C.utf8. It is possible to
  have mutiple matches from the output of “locale -a”. Just take the first
  one. Fixes [GitHub issue
  #241](https://github.com/sudo-project/sudo/issues/241).
  [[2845ceafb]](https://git.sudo.ws/sudo/commit/?id=2845ceafb)

* lib/util/Makefile.in, logsrvd/Makefile.in, plugins/sudoers/Makefile.in,
  src/Makefile.in:

  Add some missing files to the clean and distclean targets.
  [[4f50692ac]](https://git.sudo.ws/sudo/commit/?id=4f50692ac)

* :

  Merge pull request #240 from thesamesam/c23

  sudo\_fatal: Fix build where compiler recognises [[noreturn]] attributâ¦
  [[a845039de]](https://git.sudo.ws/sudo/commit/?id=a845039de)

2023-02-15 Sam James

* include/sudo\_fatal.h:

  sudo\_fatal: Fix build where compiler recognises [[noreturn]] attribute
  (C23)

  If the compiler supports [[noreturn]] as a attribute as in C23, then we
  define sudo\_noreturn to be it. When that’s the case, we must place it at
  the beginning of the declaration, before any other *extension*
  attributes (\_\_attribute(…)).

  A bug has been filed with GCC regarding rejecting/accepting mixed
  attribute styles.

  sudo\_dso\_public is always an extension attribute, while sudo\_noreturn
  only might be, so put it first.

  This only shows up with GCC 13 so far (see the linked GCC bug for a bit
  more exploration). Clang 16 does support the attribute but doesn’t let
  you use it for earlier language versions (need to pass explicit
  -std=c2x, unlike with GCC here).

  This is essentially a followup to
  e707ffe58b3ccfe5c72f54c38eac1d7069d5021e.

  Tested with GCC 13.0.1 20230212 (unreleased), GCC 12.2.1 20230211, Clang
  16.0.0\_rc2, and Clang 15.0.7.

  Bug: <https://gcc.gnu.org/bugzilla/show_bug.cgi?id=108796> Closes:
  <https://github.com/sudo-project/sudo/issues/239> Fixes:
  e707ffe58b3ccfe5c72f54c38eac1d7069d5021e Fixes:
  16ae61dcd7d3cd8bf6eb10a22fa742d4505da4e9
  [[66359c2bc]](https://git.sudo.ws/sudo/commit/?id=66359c2bc)

2023-02-14 Todd C. Miller

* configure, configure.ac:

  Add missing ‘[’ to AS\_IF() call. Fixes [GitHub issue
  #238](https://github.com/sudo-project/sudo/issues/238).
  [[defec5d46]](https://git.sudo.ws/sudo/commit/?id=defec5d46)

* MANIFEST, plugins/sudoers/po/ka.mo:

  Add compiled version of the sudoers Georgian translation.
  [[a80dcc6ac]](https://git.sudo.ws/sudo/commit/?id=a80dcc6ac)

* .gitignore, .hgignore:

  Do not ignore .mo files. Otherwise we are likely to miss uncommitted
  changes in them.
  [[5eed6adb6]](https://git.sudo.ws/sudo/commit/?id=5eed6adb6)

* plugins/sudoers/po/ru.mo, plugins/sudoers/po/zh\_CN.mo, po/zh\_CN.mo:

  Regenerate .mo files.
  [[f1b07aed4]](https://git.sudo.ws/sudo/commit/?id=f1b07aed4)

2023-02-09 Todd C. Miller

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  No longer need to define sudoers\_recovery here.
  [[bdef2ad6d]](https://git.sudo.ws/sudo/commit/?id=bdef2ad6d)

* NEWS:

  Mention that a missing include file is no longer fatal.
  [[0008d1f71]](https://git.sudo.ws/sudo/commit/?id=0008d1f71)

* plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/policy.c:

  Recover from missing include file unless error\_recovery is disabled. It
  is still treated as an error from a logging perspective, and mail is
  still sent.
  [[26385b45c]](https://git.sudo.ws/sudo/commit/?id=26385b45c)

2023-02-03 Todd C. Miller

* plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/fur.mo,
  po/fur.po, po/ja.mo, po/ja.po, po/zh\_TW.mo, po/zh\_TW.po:

  Updated translations from translationproject.org
  [[8960f5096]](https://git.sudo.ws/sudo/commit/?id=8960f5096)

2023-02-09 Todd C. Miller

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  plugins/sudoers/logging.c:

  Add eventlog\_mail() to send a log message via mail. This is used by
  mail\_parse\_errors() to send multi-line messages. Previously, the
  newlines would be escaped as control characters.
  [[b333d1687]](https://git.sudo.ws/sudo/commit/?id=b333d1687)

* lib/eventlog/eventlog.c:

  send\_mail: pass a single string instead of using varargs These days we
  only ever pass in a const string.
  [[b6caacfe4]](https://git.sudo.ws/sudo/commit/?id=b6caacfe4)

2023-02-05 Todd C. Miller

* configure, configure.ac:

  Use AS\_IF instead of if; then where possible.
  [[2e1a73502]](https://git.sudo.ws/sudo/commit/?id=2e1a73502)

2023-02-03 Todd C. Miller

* NEWS:

  Mention the fix for GitHub #237.
  [[cfa1fee62]](https://git.sudo.ws/sudo/commit/?id=cfa1fee62)

* src/exec\_pty.c, src/tgetpass.c:

  Display error in error message if we can’t restore the terminal.
  [[f160e5e6c]](https://git.sudo.ws/sudo/commit/?id=f160e5e6c)

2023-02-02 Todd C. Miller

* src/exec\_pty.c, src/tgetpass.c:

  Display an error message if unable to restore terminal settings.
  [[15b4cde69]](https://git.sudo.ws/sudo/commit/?id=15b4cde69)

* Makefile.in, etc/sudo.pp, plugins/sudoers/Makefile.in:

  Get rid of sudoersdir and just use sysconfdir. There is no need for
  sudoersdir when it is always just set to sysconfdir.
  [[1758c49d3]](https://git.sudo.ws/sudo/commit/?id=1758c49d3)

* src/exec\_pty.c:

  pty\_finish: only restore the terminal if sudo is the foreground process
  [[678d6664a]](https://git.sudo.ws/sudo/commit/?id=678d6664a)

* src/exec\_pty.c:

  Better background job detection when running a command in a pty. If sudo
  is not the process group leader and stdin is not a tty, we may be
  running as a background job via a shell script. Start the command in the
  background to avoid changing the terminal mode from a background
  process. [GitHub issue
  #237](https://github.com/sudo-project/sudo/issues/237)
  [[7cb23c85a]](https://git.sudo.ws/sudo/commit/?id=7cb23c85a)

* src/exec\_pty.c:

  suspend\_sudo\_pty: stop the process group even if sudo is not the leader.
  When sudo is not the process group leader, we still need to stop sudo’s
  process group and not just the sudo process itself. If we only send the
  signal to sudo itself, the shell will not notice if it is not in monitor
  mode. This can happen when sudo is run from a shell script, for example.
  In this case we need to signal the shell itself. If the process group
  leader is no longer present, we must kill the command since there will
  be no one to resume us.
  [[4fb985563]](https://git.sudo.ws/sudo/commit/?id=4fb985563)

* lib/util/term.c:

  Add debug tracing to tcsetattr\_nobg().
  [[e63eeee7b]](https://git.sudo.ws/sudo/commit/?id=e63eeee7b)

2023-01-31 Todd C. Miller

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Avoid compilation errors if getaddrinfo() or freeaddrinfo() are macros.
  If this is the case we probably can’t stub out the functions but at
  least the fuzzer will compile.
  [[3c9c8668c]](https://git.sudo.ws/sudo/commit/?id=3c9c8668c)

* src/net\_ifs.c:

  Initialize the integer result parameter passed to SIOCGIFANUM. It
  appears that passing in a non-zero value causes the ioctl() to fail.
  From Tim Rice.
  [[7c5f0d305]](https://git.sudo.ws/sudo/commit/?id=7c5f0d305)

* logsrvd/logsrvd.c, logsrvd/logsrvd\_relay.c,
  plugins/sudoers/log\_client.c:

  Protect use of AF\_INET6 with HAVE\_STRUCT\_IN6\_ADDR guards. From Tim Rice.
  [[0b2e662b2]](https://git.sudo.ws/sudo/commit/?id=0b2e662b2)

* config.h.in, configure, configure.ac, include/sudo\_compat.h:

  Add configure test for NSIG, \_NSIG or \_\_NSIG. This is better than just
  defining NSIG in sudo\_compat.h if it is not defined since signal.h may
  not have been included.
  [[ffb09be49]](https://git.sudo.ws/sudo/commit/?id=ffb09be49)

* logsrvd/logsrvd\_conf.c:

  Avoid DNS lookups when fuzzing.
  [[49df977c2]](https://git.sudo.ws/sudo/commit/?id=49df977c2)

2023-01-30 Todd C. Miller

* etc/sudo-logsrvd.pp, etc/sudo-python.pp, etc/sudo.pp, scripts/mkpkg,
  scripts/pp:

  No longer need to treat Rocky or Alma Linux specially. We now treat them
  the same as RHEL.
  [[23237bb00]](https://git.sudo.ws/sudo/commit/?id=23237bb00)

2023-01-29 Todd C. Miller

* :

  Merge pull request #230 from trackers-lover/main

  Return value does not match
  [[6d945448e]](https://git.sudo.ws/sudo/commit/?id=6d945448e)

2023-01-29 bianguangze@uniontech.com

* lib/util/sudo\_conf.c:

  Modify return value parameter
  [[8797f0ceb]](https://git.sudo.ws/sudo/commit/?id=8797f0ceb)

2023-01-27 Todd C. Miller

* scripts/build\_pkgs:

  Store conf hash in vm\_servers instead of vmid. Add a shutdown command
  fallback to the conf file.
  [[b257df55d]](https://git.sudo.ws/sudo/commit/?id=b257df55d)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/ro.mo, plugins/sudoers/po/ro.po,
  plugins/sudoers/po/ru.po, plugins/sudoers/po/sv.mo,
  plugins/sudoers/po/sv.po, plugins/sudoers/po/uk.mo,
  plugins/sudoers/po/uk.po, plugins/sudoers/po/zh\_CN.po,
  plugins/sudoers/po/zh\_TW.po, po/cs.mo, po/cs.po, po/de.mo, po/de.po,
  po/eo.mo, po/eo.po, po/fr.mo, po/fr.po, po/hr.mo, po/hr.po, po/ko.mo,
  po/ko.po, po/pl.mo, po/pl.po, po/ro.mo, po/ro.po, po/sv.mo, po/sv.po,
  po/uk.mo, po/uk.po, po/zh\_CN.po, po/zh\_TW.po:

  Updated translations from translationproject.org
  [[179ad08c8]](https://git.sudo.ws/sudo/commit/?id=179ad08c8)

2023-01-26 Todd C. Miller

* MANIFEST, plugins/sudoers/po/ka.po:

  New Georgian translation from translationproject.org
  [[ab9b20be9]](https://git.sudo.ws/sudo/commit/?id=ab9b20be9)

2023-01-27 Todd C. Miller

* NEWS:

  Mention the recent intercept/log\_subcmds fix.
  [[b4325e64c]](https://git.sudo.ws/sudo/commit/?id=b4325e64c)

* etc/sudo-logsrvd.pp, etc/sudo-python.pp, etc/sudo.pp, scripts/mkpkg,
  scripts/pp:

  Recognize Alma Linux and Rocky Linux (Open Source RHEL clones)
  [[53389b574]](https://git.sudo.ws/sudo/commit/?id=53389b574)

* config.h.in, configure, scripts/config.guess, scripts/config.sub:

  Regen with latest autoconf git.
  [[fd0021ee5]](https://git.sudo.ws/sudo/commit/?id=fd0021ee5)

* configure, m4/hardening.m4:

  Fix a typo.
  [[1977f98d2]](https://git.sudo.ws/sudo/commit/?id=1977f98d2)

* scripts/mkpkg:

  Fix determination of the number of CPU cores on Linux.
  [[94eafd2f0]](https://git.sudo.ws/sudo/commit/?id=94eafd2f0)

2023-01-26 Todd C. Miller

* :

  Merge pull request #235 from kernelmethod/apparmor\_dependencies

  Replace the Debian libselinux1 dependency with libapparmor1
  [[3b3089e4f]](https://git.sudo.ws/sudo/commit/?id=3b3089e4f)

2023-01-26 kernelmethod

* etc/sudo.pp:

  Replace the Debian libselinux1 dependency with libapparmor1

  Debian >= 10 uses AppArmor by default instead of SELinux, so
  SELinux-related sudo features are typically going to be unusable in
  Debian installs. This changes the dependency on libselinux1 to be a
  dependency on libapparmor1 for .deb packages built with `make package`.
  [[8c9a8933b]](https://git.sudo.ws/sudo/commit/?id=8c9a8933b)

2023-01-25 Todd C. Miller

* src/exec\_ptrace.c:

  get\_execve\_info: defer setting pathname until argbuf is finalized If we
  reallocate the buffer (via growbuf()) in ptrace\_read\_vec(), the address
  of argbuf may change. If so, the value stored in pathname will no longer
  be valid. [GitHub issue
  #194](https://github.com/sudo-project/sudo/issues/194).
  [[fe001b6ff]](https://git.sudo.ws/sudo/commit/?id=fe001b6ff)

* src/exec\_intercept.c, src/exec\_ptrace.c:

  Correct error message when command doesn’t exist in intercept mode.
  Previously, we would always use EACCES, even when ENOENT was
  appropriate. This also affected log\_subcmds.
  [[a32a54dce]](https://git.sudo.ws/sudo/commit/?id=a32a54dce)

2023-01-24 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update .pot files for 1.9.13
  [[de021b60d]](https://git.sudo.ws/sudo/commit/?id=de021b60d)

2023-01-23 Todd C. Miller

* NEWS:

  Update for 1.9.13.
  [[b9dc472bb]](https://git.sudo.ws/sudo/commit/?id=b9dc472bb)

* src/exec\_ptrace.h:

  Include elf.h, not linux/elf.h but define NT\_ARM\_SYSTEM\_CALL if missing.
  Older kernel headers are missing the definition of EM\_ARM in
  linux/elf.h. [GitHub issue
  #232](https://github.com/sudo-project/sudo/issues/232)
  [[d3afffec7]](https://git.sudo.ws/sudo/commit/?id=d3afffec7)

* lib/util/regress/regex/regex\_test.c:

  Add tests for escaped digits.
  [[e11bb93e2]](https://git.sudo.ws/sudo/commit/?id=e11bb93e2)

* lib/util/regex.c:

  check\_pattern: handle escaped digits since GNU libc accepts them.
  [[f6340068d]](https://git.sudo.ws/sudo/commit/?id=f6340068d)

2023-01-22 Todd C. Miller

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  plugins/sudoers/sudoreplay.c:

  Add eventlog\_store\_sudo() and use it in sudoreplay. This replaces the
  custom log formatting used by “sudoreplay -l”.
  [[2d9c0d903]](https://git.sudo.ws/sudo/commit/?id=2d9c0d903)

2023-01-21 Todd C. Miller

* scripts/build\_pkgs, scripts/mkpkg:

  Add –build-only flag to skip building packages.
  [[733303ed9]](https://git.sudo.ws/sudo/commit/?id=733303ed9)

2023-01-20 Todd C. Miller

* scripts/mkpkg, scripts/pp:

  Suport building packages on DragonFly BSD.
  [[ec79bbc8e]](https://git.sudo.ws/sudo/commit/?id=ec79bbc8e)

* configure, configure.ac, m4/visibility.m4:

  Try to link a simple shared object with -Wl,–no-undefined. This only
  works for gcc-style compilers, which should not be a problem. The source
  uses environ (FreeBSD) and errno (OpenBSD).
  [[f65a51afd]](https://git.sudo.ws/sudo/commit/?id=f65a51afd)

* scripts/build\_pkgs:

  Pass the name to the config.cache file to the build script. If
  –cache-file is not specified, no config.cache file will be used. Add an
  “omit\_artifacts” setting for platforms where we don’t publish artifacts.
  [[0010c9861]](https://git.sudo.ws/sudo/commit/?id=0010c9861)

2023-01-19 Todd C. Miller

* lib/util/regex.c:

  check\_pattern: accept a backslash before the numeric bound like glibc.
  This helps avoid out-of-memory conditions when fuzzing on Linux.
  [[ee2f2287a]](https://git.sudo.ws/sudo/commit/?id=ee2f2287a)

* configure, configure.ac:

  Don’t use -Wl,–no-undefined with the sanitizers/fuzzers. It breaks
  linking when using -fsanitize with clang at least.
  [[7a64275a3]](https://git.sudo.ws/sudo/commit/?id=7a64275a3)

* docs/SECURITY.md:

  Add a link to the sudo security advisories archive.
  [[c6cc68006]](https://git.sudo.ws/sudo/commit/?id=c6cc68006)

* config.h.in, configure, configure.ac:

  Eliminate usage of obsolete 2-argument AC\_CHECK\_TYPE macro.
  [[f7265f5de]](https://git.sudo.ws/sudo/commit/?id=f7265f5de)

* config.h.in, configure, configure.ac, plugins/sudoers/starttime.c,
  src/regress/ttyname/check\_ttyname.c, src/ttyname.c:

  Add support for the struct kinfo\_proc on Dragonfly BSD.
  [[9ddae6681]](https://git.sudo.ws/sudo/commit/?id=9ddae6681)

* configure, configure.ac:

  Elminate the $OS variable, we can just use $host\_os instead.
  [[d409ba67c]](https://git.sudo.ws/sudo/commit/?id=d409ba67c)

* configure, configure.ac:

  Need to link sudo and sudoers with -lutil on Dragonfly BSD. It is safer
  to just search for setusercontext() in libc and libutil instead of
  matching on the operating system.
  [[cb56fd2ed]](https://git.sudo.ws/sudo/commit/?id=cb56fd2ed)

* configure, configure.ac, m4/ldap.m4:

  Add -Wl,–no-undefined to LDFLAGS if it is supported. This will find
  missing symbols at build-time instead of run-time. Don’t use it on
  FreeBSD where environ is filled in by the dynamic loader. We also need
  to pull in -llber with -lldap where possible (instead of relying on
  DT\_NEEDED) to avoid undefined symbol errors when building with LDAP
  support.
  [[83b4cee98]](https://git.sudo.ws/sudo/commit/?id=83b4cee98)

* plugins/sudoers/editor.c:

  Restore the line that set errno to ENOENT when find\_path() fails. This
  was inadvertently removed when the “goto bad” was added.
  [[1e0bb704c]](https://git.sudo.ws/sudo/commit/?id=1e0bb704c)

* plugins/sample/README:

  The sample plugin is now built by default to avoid bit rot. [GitHub
  issue #234](https://github.com/sudo-project/sudo/issues/234).
  [[e3583e01b]](https://git.sudo.ws/sudo/commit/?id=e3583e01b)

* plugins/sample/sample\_plugin.c:

  The change from sudo\_printf -> sudo\_plugin\_printf was incomplete. Fixes
  [GitHub issue #234](https://github.com/sudo-project/sudo/issues/234).
  [[4f9da47e5]](https://git.sudo.ws/sudo/commit/?id=4f9da47e5)

2023-01-18 Todd C. Miller

* configure, m4/pie.m4:

  Solaris: use lt\_prog\_compiler\_pic instead of assuming -KPIC
  [[544c97821]](https://git.sudo.ws/sudo/commit/?id=544c97821)

* configure, m4/hardening.m4, m4/pie.m4:

  Solaris: the aslr, nxheap and nxstack link options are only for
  executables. Move them back to PIE\_LDFLAGS, which is only used when
  linking a binary.
  [[e72d75d38]](https://git.sudo.ws/sudo/commit/?id=e72d75d38)

* configure, m4/hardening.m4, m4/pie.m4:

  Solaris: move aslr linker option to hardening and try to build real PIEs
  These flags are specific to the Solaris linker.
  [[7d4666656]](https://git.sudo.ws/sudo/commit/?id=7d4666656)

* configure, m4/hardening.m4, m4/pie.m4:

  Enable non-executable heap and stack options for Solaris ld.
  [[b44ad49bf]](https://git.sudo.ws/sudo/commit/?id=b44ad49bf)

* configure, configure.ac, m4/hardening.m4:

  Limit some of the hardening tests to compilers that define **GNUC**.
  This should avoid false positives on other compilers.
  [[73c52e731]](https://git.sudo.ws/sudo/commit/?id=73c52e731)

* plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stdout:

  Update expected plugin version.
  [[7ff70c09f]](https://git.sudo.ws/sudo/commit/?id=7ff70c09f)

* docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h, src/sudo.c,
  src/sudo.h, src/sudo\_edit.c:

  Pass back the number of files to edit when using sudoedit. The sudo
  front-end can use this to determine where the list of files to edit
  begins.
  [[0865e61d9]](https://git.sudo.ws/sudo/commit/?id=0865e61d9)

* docs/sudoers.man.in, docs/sudoers.mdoc.in, docs/sudoreplay.man.in,
  docs/sudoreplay.mdoc.in, include/sudo\_lbuf.h, lib/eventlog/eventlog.c,
  lib/iolog/iolog\_json.c, lib/util/lbuf.c, lib/util/util.exp.in,
  plugins/sudoers/sudoreplay.c:

  Escape control characters in log messages and “sudoreplay -l” output.
  The log message contains user-controlled strings that could include
  things like terminal control characters. Space characters in the command
  path are now also escaped.

  Command line arguments that contain spaces are surrounded with single
  quotes and any literal single quote or backslash characters are escaped
  with a backslash. This makes it possible to distinguish multiple command
  line arguments from a single argument that contains spaces.

  Issue found by Matthieu Barjole and Victor Cutillas of Synacktiv
  (<https://synacktiv.com>).
  [[334daf92b]](https://git.sudo.ws/sudo/commit/?id=334daf92b)

* NEWS:

  Merge in sudo 1.9.12p2 changes.
  [[77557f8f1]](https://git.sudo.ws/sudo/commit/?id=77557f8f1)

2023-01-17 trackers-love

* lib/util/sudo\_conf.c:

  Return value does not match
  [[326f013cf]](https://git.sudo.ws/sudo/commit/?id=326f013cf)

2023-01-16 Todd C. Miller

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in, docs/sudo.conf.man.in,
  docs/sudo.conf.mdoc.in, docs/sudo\_logsrvd.conf.man.in,
  docs/sudo\_logsrvd.conf.mdoc.in, docs/sudoers.ldap.man.in,
  docs/sudoers.ldap.mdoc.in, docs/sudoers.man.in, docs/sudoers.mdoc.in,
  docs/visudo.man.in, docs/visudo.mdoc.in:

  Stop using 8n width in tagged lists. Use either 4n, when the body is
  expected to wrap or the width of the longest tag when no wrapping is
  expected.
  [[3726e3839]](https://git.sudo.ws/sudo/commit/?id=3726e3839)

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in, docs/sudo.man.in,
  docs/sudo.mdoc.in, docs/sudo\_logsrvd.man.in, docs/sudo\_logsrvd.mdoc.in,
  docs/sudo\_sendlog.man.in, docs/sudo\_sendlog.mdoc.in,
  docs/sudoreplay.man.in, docs/sudoreplay.mdoc.in, docs/visudo.man.in,
  docs/visudo.mdoc.in:

  Use -width Ds for the options list, not -width Fl.
  [[081474913]](https://git.sudo.ws/sudo/commit/?id=081474913)

* docs/sudo.man.in, docs/sudo.mdoc.in, docs/sudo\_logsrvd.conf.man.in,
  docs/sudo\_logsrvd.conf.mdoc.in, docs/sudo\_plugin\_python.man.in,
  docs/sudo\_plugin\_python.mdoc.in:

  Reduce the offset of bullet lists to 1n.
  [[a7e8a20d0]](https://git.sudo.ws/sudo/commit/?id=a7e8a20d0)

* INSTALL.md:

  Shorten –with-passprompt and –with-mailsubject arguments to a single
  word. The script that generates the web version of this file doesn’t
  expect options to include whitespace.
  [[1eae385af]](https://git.sudo.ws/sudo/commit/?id=1eae385af)

2023-01-15 Todd C. Miller

* INSTALL.md:

  Shorten –with-badpass-message argument to a single word. The
  fix\_install script can’t deal with whitespace in options.
  [[f0665166b]](https://git.sudo.ws/sudo/commit/?id=f0665166b)

* LICENSE.md:

  Make numbered lists more markdown-friendly. Also add line breaks when
  there are multiple authors.
  [[e5634ae99]](https://git.sudo.ws/sudo/commit/?id=e5634ae99)

* INSTALL.md:

  Make lists of directories more markdown-friendly.
  [[49ad30efa]](https://git.sudo.ws/sudo/commit/?id=49ad30efa)

2023-01-12 Todd C. Miller

* lib/iolog/regress/iolog\_mkpath/check\_iolog\_mkpath.c:

  Check for errors when removing the temp directory. If we cannot remove
  the directory tree that may indicate a file or directory mode problem.
  [[6725c37e3]](https://git.sudo.ws/sudo/commit/?id=6725c37e3)

* lib/iolog/iolog\_mkdtemp.c:

  iolog\_mkdtemp: fix pasto in last commit Set mode to iolog\_dirmode, not
  iolog\_filemode
  [[8d7feb76e]](https://git.sudo.ws/sudo/commit/?id=8d7feb76e)

* plugins/sudoers/editor.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/visudo.c:

  sudoedit: do not permit editor arguments to include “–”
  (CVE-2023-22809) We use “–” to separate the editor and arguments from
  the files to edit. If the editor arguments include “–”, sudo can be
  tricked into allowing the user to edit a file not permitted by the
  security policy. Thanks to Matthieu Barjole and Victor Cutillas of
  Synacktiv (<https://synacktiv.com>) for finding this bug.
  [[0274a4f3b]](https://git.sudo.ws/sudo/commit/?id=0274a4f3b)

2023-01-17 Todd C. Miller

* configure, m4/hardening.m4:

  Add back the linker check for -fstack-clash-protection. This is expected
  to fix [GitHub issue
  #231](https://github.com/sudo-project/sudo/issues/231).
  [[a960d2c45]](https://git.sudo.ws/sudo/commit/?id=a960d2c45)

2023-01-09 Todd C. Miller

* lib/util/sha2.c:

  In SHA256Pad and SHA512Pad use 511 and 1023 respectively for bitwise
  AND. Previously we were using 504 and 1016 which still produces the
  correct result since padding is done in 8-bit bytes. However, using
  size-1 for the bitwise AND makes the intent clearer and likely would
  have prevented the previous bug in SHA512Pad. From Matthieu Barjole and
  Victor Cutillas of Synacktiv (<https://synacktiv.com>)
  [[0b2f9cbe7]](https://git.sudo.ws/sudo/commit/?id=0b2f9cbe7)

* plugins/sudoers/env.c:

  env\_file\_next\_local: change the order of the val\_len check. It makes
  more sense to verify that val\_len > 1 before using it. This is not a
  problem in practice because val[val\_len - 1] is guaranteed not to
  underflow but it can confuse reviewers and static analyzers.
  [[3878ce8d4]](https://git.sudo.ws/sudo/commit/?id=3878ce8d4)

* plugins/sudoers/env.c:

  Fix typo in check for environment variables that start with ‘=’.
  [[d781ab0a8]](https://git.sudo.ws/sudo/commit/?id=d781ab0a8)

* lib/util/lbuf.c:

  sudo\_lbuf\_print: no longer need to check for lbuf->len > 0. Now that
  lbuf length is unsigned the earlier check for len == 0 is sufficient.
  [[1b7604e5c]](https://git.sudo.ws/sudo/commit/?id=1b7604e5c)

* lib/util/lbuf.c:

  Increase minimum allocation size from 256 to 1024 bytes.
  [[ca297658d]](https://git.sudo.ws/sudo/commit/?id=ca297658d)

* plugins/sudoers/sudoreplay.c:

  Fix IS\_IDLOG macro, it was testing the wrong byte for the NUL. This
  causes the macro to evaluate to false even for valid TSIDs.
  [[1f58e5a8e]](https://git.sudo.ws/sudo/commit/?id=1f58e5a8e)

2023-01-04 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  sudoers\_trace\_print: this is a no-op if not debugging
  [[8309fbb97]](https://git.sudo.ws/sudo/commit/?id=8309fbb97)

* lib/util/lbuf.c:

  sudo\_lbuf\_expand: don’t allocate less than 256 bytes at a time.
  [[532023f7b]](https://git.sudo.ws/sudo/commit/?id=532023f7b)

2023-01-03 Todd C. Miller

* lib/util/lbuf.c:

  sudo\_lbuf\_expand: round nearest power of two instead of multiple of 256.
  [[dc9ef6902]](https://git.sudo.ws/sudo/commit/?id=dc9ef6902)

* LICENSE.md:

  Update copyright year.
  [[dd934d6a2]](https://git.sudo.ws/sudo/commit/?id=dd934d6a2)

* include/sudo\_lbuf.h, lib/util/lbuf.c:

  sudo\_lbuf\_expand: check for possible integer overflow The numeric fields
  in struct sudo\_lbuf are now unsigned so that wraparound is defined, this
  make the overflow checks simpler. Problem deteced by oss-fuzz using the
  fuzz\_sudoers fuzzer.
  [[13df52889]](https://git.sudo.ws/sudo/commit/?id=13df52889)

* MANIFEST, lib/iolog/iolog\_json.c, lib/iolog/regress/iolog\_json/test3.in,
  lib/iolog/regress/iolog\_json/test3.out.ok:

  Decode \u00XX in a JSON string now that we escape control chars. We
  don’t write Unicode to the log.json file, only 8-bit ASCII.
  [[6b80ab74e]](https://git.sudo.ws/sudo/commit/?id=6b80ab74e)

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in, lib/util/hexchar.c,
  lib/util/regress/hexchar/hexchar\_test.c, lib/util/util.exp.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/match\_digest.c,
  plugins/sudoers/parse.h, plugins/sudoers/toke\_util.c:

  Move hexchar() from the sudoers plugin to lib/util.
  [[e5d98da01]](https://git.sudo.ws/sudo/commit/?id=e5d98da01)

* lib/util/mkdir\_parents.c:

  sudo\_open\_parent\_dir: adjust loop terminating condition Checking for ep
  < pathend should be a bit clearer than ep != ‘\0’ and has the advantage
  of working when pathend doesn’t point to a NUL byte. No intended change
  in behavior.
  [[0cb383511]](https://git.sudo.ws/sudo/commit/?id=0cb383511)

* lib/iolog/iolog\_mkdtemp.c:

  iolog\_mkdtemp: fix failure when the specified path contains
  subdirectories. This fixes a bug introduced in sudo 1.9.12.
  [[311d8e82d]](https://git.sudo.ws/sudo/commit/?id=311d8e82d)

* lib/iolog/regress/iolog\_mkpath/check\_iolog\_mkpath.c:

  check\_iolog\_mkpath: fix exit value
  [[bfd7d586b]](https://git.sudo.ws/sudo/commit/?id=bfd7d586b)

2023-01-02 Todd C. Miller

* :

  Merge pull request #227 from sohomdatta1/integer\_underflow

  Prevent integer underflow due to environment variable
  [[6f9485467]](https://git.sudo.ws/sudo/commit/?id=6f9485467)

2023-01-02 Sohom

* plugins/sudoers/env.c:

  Prevent integer underflow due to environment variable

  Gaurd against replacing quotes when the environment variable val\_len is
  1.
  [[761ffb3bf]](https://git.sudo.ws/sudo/commit/?id=761ffb3bf)

2023-01-01 Todd C. Miller

* lib/util/regex.c:

  glibc allows the ‘,’ in {low,high} to be escaped with a backslash.
  Adjust bound parsing to match this.
  [[8b5037a21]](https://git.sudo.ws/sudo/commit/?id=8b5037a21)

2022-12-31 Todd C. Miller

* configure, configure.ac:

  Fix logic goof in 05781ba6f1f3, disable replacements when fuzzing. Not
  the other way around.
  [[acee3ea6e]](https://git.sudo.ws/sudo/commit/?id=acee3ea6e)

2022-12-30 Todd C. Miller

* configure, configure.ac, docs/sudo\_plugin\_python.man.in,
  docs/sudo\_plugin\_python.mdoc.in, docs/sudoers.man.in,
  docs/sudoers.mdoc.in:

  Substitute python plugin file name in sudo\_plugin\_python documentation.
  Also use prefix for group plugin fallback path section in sudoers
  manual.
  [[4b0dc2eec]](https://git.sudo.ws/sudo/commit/?id=4b0dc2eec)

* lib/iolog/Makefile.in, lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.dict,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.dict:

  Use correct dictionary file format. Also use the new dictionaries in the
  Makefile fuzz target.
  [[ad55f8cce]](https://git.sudo.ws/sudo/commit/?id=ad55f8cce)

* MANIFEST, lib/iolog/regress/corpus/seed/log\_legacy/less.log,
  lib/iolog/regress/corpus/seed/log\_legacy/smtpctl.log,
  lib/iolog/regress/corpus/seed/log\_legacy/vi.log,
  lib/iolog/regress/corpus/seed/timing/timing.5,
  lib/iolog/regress/corpus/seed/timing/timing.6,
  lib/iolog/regress/corpus/seed/timing/timing.7,
  lib/iolog/regress/corpus/seed/timing/timing.8,
  lib/iolog/regress/corpus/seed/timing/timing.9:

  Add some addition entries for the I/O log fuzzer seed corpus.
  [[224a3b647]](https://git.sudo.ws/sudo/commit/?id=224a3b647)

* MANIFEST, lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.dict,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.dict:

  Add dictionaries for fuzz\_iolog\_legacy and fuzz\_iolog\_timing.
  [[148e5ad95]](https://git.sudo.ws/sudo/commit/?id=148e5ad95)

* include/sudo\_fatal.h:

  Don’t send warn/fatal output to the debug file when fuzzing.
  [[774b3c6e6]](https://git.sudo.ws/sudo/commit/?id=774b3c6e6)

* lib/util/getentropy.c:

  Back out the genentropy.c portion of c648cfe9ff0f We don’t need to
  special-case FUZZING\_BUILD\_MODE\_UNSAFE\_FOR\_PRODUCTION now that we use
  the glibc arc4random() where available.
  [[a9a3a8e37]](https://git.sudo.ws/sudo/commit/?id=a9a3a8e37)

2022-12-29 Todd C. Miller

* lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.c,
  logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Use initprogname(), not setprogname() in the fuzzers. This results in
  better coverage for progname.c.
  [[91d7592e8]](https://git.sudo.ws/sudo/commit/?id=91d7592e8)

* lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_conf/test1.out.ok,
  lib/util/regress/sudo\_conf/test2.out.ok,
  lib/util/regress/sudo\_conf/test3.out.ok,
  lib/util/regress/sudo\_conf/test4.out.ok,
  lib/util/regress/sudo\_conf/test5.out.ok,
  lib/util/regress/sudo\_conf/test6.out.ok,
  lib/util/regress/sudo\_conf/test7.out.ok:

  Add probe\_interfaces and intercept\_path.
  [[206155e60]](https://git.sudo.ws/sudo/commit/?id=206155e60)

* lib/util/regress/fuzz/fuzz\_sudo\_conf.c:

  Exercise getter functions.
  [[bd9886851]](https://git.sudo.ws/sudo/commit/?id=bd9886851)

* configure, configure.ac:

  Avoid using our function replacements when fuzzing (where possible). We
  don’t want to fuzz the function replacements themselves as this can skew
  the coverage reports.
  [[3068ec000]](https://git.sudo.ws/sudo/commit/?id=3068ec000)

* plugins/python/regress/check\_python\_examples.c:

  Disable sudo\_debug tests when fuzzing. The debug code is disable when
  fuzzing is enabled to avoid coverage issues.
  [[3f095ff1b]](https://git.sudo.ws/sudo/commit/?id=3f095ff1b)

* lib/util/fatal.c, lib/util/getentropy.c, lib/util/sudo\_conf.c:

  Avoid compiling some code paths that are unreachable when fuzzing.
  [[2e9e1c80f]](https://git.sudo.ws/sudo/commit/?id=2e9e1c80f)

* plugins/sudoers/regress/serialize\_list/check\_serialize\_list.c:

  Plug memory leak.
  [[8a5e9ffb4]](https://git.sudo.ws/sudo/commit/?id=8a5e9ffb4)

2022-12-28 Todd C. Miller

* plugins/sudoers/regress/fuzz/fuzz\_policy.dict:

  Update fuzz\_policy keywords to match current policy settings.
  [[47a211f19]](https://git.sudo.ws/sudo/commit/?id=47a211f19)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.dict:

  Add example users and groups to the dictionary.
  [[a7c1b78c6]](https://git.sudo.ws/sudo/commit/?id=a7c1b78c6)

* plugins/sudoers/env.c, plugins/sudoers/sudoers.c, src/parse\_args.c:

  parse\_args: an environment variable may not start with ‘=’. Also check
  VAR=val format in validate\_env\_vars() and add an error message if
  insert\_env\_vars() fails.
  [[8eabbf8fd]](https://git.sudo.ws/sudo/commit/?id=8eabbf8fd)

* plugins/sudoers/env.c:

  rebuild\_env: avoid a potential NULL dereference in fuzz\_policy
  [[c82059989]](https://git.sudo.ws/sudo/commit/?id=c82059989)

* plugins/sudoers/sudoers.c:

  sudoers\_policy\_main: plug memory leak of iolog\_path on error.
  [[b69ffd347]](https://git.sudo.ws/sudo/commit/?id=b69ffd347)

* plugins/sudoers/env.c:

  rebuild\_env: avoid a potential NULL dereference in fuzz\_policy
  [[8e8a22b8e]](https://git.sudo.ws/sudo/commit/?id=8e8a22b8e)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  The contents of the env\_add array should not include the leading “env=”
  prefix. The previous fix for this was incomplete.
  [[bca945f07]](https://git.sudo.ws/sudo/commit/?id=bca945f07)

* plugins/sudoers/env.c:

  validate\_env\_vars: more efficient errbuf handling Also avoid appending
  to errbuf if it is already full.
  [[9c4271f73]](https://git.sudo.ws/sudo/commit/?id=9c4271f73)

2022-12-27 Todd C. Miller

* docs/sudo.man.in, docs/sudo.mdoc.in:

  Document that -k does not interfere with sudo on other terminals. This
  should help clarify the difference between “sudo -k” and “sudo -K”.
  [[95a6c0459]](https://git.sudo.ws/sudo/commit/?id=95a6c0459)

* lib/util/regex.c, lib/util/regress/regex/regex\_test.c:

  Check for bound values larger than 255 and reject them. This is to
  prevent the fuzzers from running out of memory.
  [[ee5b43280]](https://git.sudo.ws/sudo/commit/?id=ee5b43280)

* scripts/pp:

  Use the POSIX shell “command -v” instead of “which” to find programs.
  Fix false detection of init.d/service status.
  [[adf2a432a]](https://git.sudo.ws/sudo/commit/?id=adf2a432a)

* etc/sudo.pp:

  Fix example dir mode on RedHat/Fedora.
  [[519a00580]](https://git.sudo.ws/sudo/commit/?id=519a00580)

* etc/sudo.pp:

  Use sed instead of ed to modify the packaged sudoers file. Some Linux
  distros do not include /bin/ed by default.
  [[e0fa2ec85]](https://git.sudo.ws/sudo/commit/?id=e0fa2ec85)

2022-12-26 Todd C. Miller

* docs/sudo.conf.man.in, docs/sudo.conf.mdoc.in:

  Use @intercept\_file@ and @noexec\_file@ like the example file.
  [[048b843e6]](https://git.sudo.ws/sudo/commit/?id=048b843e6)

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  There is a @pam\_login\_service@ substitution but no @pam\_service@.
  Just use sudo instead of @pam\_service@.
  [[772fc914a]](https://git.sudo.ws/sudo/commit/?id=772fc914a)

* examples/sudo.conf.in:

  Use @sudoers\_plugin@ instead of @sudoers\_module@.
  [[0354ec6a1]](https://git.sudo.ws/sudo/commit/?id=0354ec6a1)

* docs/sudo.conf.man.in, docs/sudo.conf.mdoc.in, docs/sudoers.man.in,
  docs/sudoers.mdoc.in, docs/visudo.man.in, docs/visudo.mdoc.in:

  Use @sudoers\_plugin@ instead of @sudoers\_module@.
  [[eeea67e70]](https://git.sudo.ws/sudo/commit/?id=eeea67e70)

* INSTALL.md, NEWS, config.h.in, configure, configure.ac, docs/UPGRADE.md,
  scripts/config.guess, scripts/config.sub:

  sudo 1.9.13 Document the changes to AIX plugins in docs/UPGRADE.md and
  regenerate configure using the latest autoconf from git.
  [[f6e0e87ba]](https://git.sudo.ws/sudo/commit/?id=f6e0e87ba)

* scripts/build\_pkgs:

  Remove anything after whitespace in MANIFEST when building tarball. This
  is consistent with how sudo’s Makefile builds the tarball.
  [[702f21f7f]](https://git.sudo.ws/sudo/commit/?id=702f21f7f)

* MANIFEST:

  Zap trailing whitespace.
  [[4baa6e103]](https://git.sudo.ws/sudo/commit/?id=4baa6e103)

* MANIFEST, docs/sudo.conf.man.in, docs/sudo.conf.mdoc.in,
  docs/sudo\_plugin\_python.man.in, docs/sudo\_plugin\_python.mdoc.in,
  examples/sudo.conf.in,
  lib/util/regress/corpus/seed/sudo\_conf/sudo.conf.1,
  lib/util/regress/corpus/seed/sudo\_conf/sudo.conf.2,
  lib/util/regress/corpus/seed/sudo\_conf/sudo.conf.3,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.dict,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_conf/test1.in,
  lib/util/regress/sudo\_conf/test1.out.ok,
  lib/util/regress/sudo\_conf/test2.out.ok,
  lib/util/regress/sudo\_conf/test3.out.ok,
  lib/util/regress/sudo\_conf/test4.out.ok,
  lib/util/regress/sudo\_conf/test5.out.ok,
  lib/util/regress/sudo\_conf/test6.out.ok,
  lib/util/regress/sudo\_conf/test7.out.ok,
  lib/util/regress/sudo\_conf/test8.err.ok,
  lib/util/regress/sudo\_conf/test8.in,
  lib/util/regress/sudo\_conf/test8.out.ok, lib/util/sudo\_conf.c:

  Remove developer mode from sudo.conf, it is no longer used.
  [[50958a05d]](https://git.sudo.ws/sudo/commit/?id=50958a05d)

* MANIFEST, plugins/python/Makefile.in,
  plugins/python/python\_importblocker.c,
  plugins/python/python\_plugin\_common.c,
  plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/testdata/sudo.conf.developer\_mode,
  plugins/python/regress/testdata/sudo.conf.normal\_mode,
  plugins/python/regress/testhelpers.c,
  plugins/python/regress/testhelpers.h,
  plugins/python/sudo\_python\_module.h:

  Remove the Python plugin import blocker code. The sudo.conf file is
  considered a trusted source of information and these checks suffer from
  TOCTOU issues anyway.
  [[fa1b86fca]](https://git.sudo.ws/sudo/commit/?id=fa1b86fca)

* plugins/sudoers/group\_plugin.c, src/load\_plugins.c:

  Remove the owner and mode checks when loading a sudo plugin. The
  sudo.conf file is considered a trusted source of information and these
  checks suffer from TOCTOU issues anyway. The checks complicate loading
  of shared objects since we need to perform fallback processing twice.
  [[73abff2d0]](https://git.sudo.ws/sudo/commit/?id=73abff2d0)

* lib/util/sudo\_dso.c, src/load\_plugins.c:

  sudo\_dso\_load: add AIX fallback path from shlib.so to shlib.a(shlib.so).
  If the .so file is missing but the .a file exists, try to dlopen() the
  AIX .a file using the .so name as the member. We need to avoid breaking
  existing configurations if the type of AIX shared library changes when
  sudo is upgraded.
  [[97fb4eae7]](https://git.sudo.ws/sudo/commit/?id=97fb4eae7)

* configure, configure.ac, docs/sudo.conf.man.in, docs/sudo.conf.mdoc.in,
  docs/sudoers.man.in, docs/sudoers.mdoc.in, docs/visudo.man.in,
  docs/visudo.mdoc.in, examples/sudo.conf.in, pathnames.h.in,
  src/load\_plugins.c, src/preload.c:

  Use AIX-style shared libraries on AIX by default instead of SVR4-style.
  This removes the need to use the -brtl linker flag which can cause
  problems when there are both a .so and .a version of the same library
  but with different versions. This was particularly problematic when
  using the AIX freeware version of OpenSSL. The –with-aix-soname=svr4
  option can be used to build SVR4-style shared libs instead.
  [[206700c3f]](https://git.sudo.ws/sudo/commit/?id=206700c3f)

* plugins/sudoers/sudoers\_version.h:

  Bump SUDOERS\_GRAMMAR\_VERSION to 50 for the new list pseudo-command.
  [[5165fb9b2]](https://git.sudo.ws/sudo/commit/?id=5165fb9b2)

2022-12-25 Todd C. Miller

* docs/Makefile.in, docs/sudo.man.in, docs/sudo.mdoc.in,
  docs/sudo\_plugin\_python.man.in, docs/sudo\_plugin\_python.mdoc.in,
  docs/sudoreplay.man.in, docs/sudoreplay.mdoc.in:

  Use “.Sy root” instead of “.Em root” when talking about the root user.
  Replace MANDOCPROG with “mandoc” now that MANDOCPROG has been removed.
  [[11aa808ef]](https://git.sudo.ws/sudo/commit/?id=11aa808ef)

2022-12-22 Todd C. Miller

* lib/util/sudo\_dso.c, src/load\_plugins.c:

  Fix support for AIX-style path(module) syntax in sudo.conf Plugin lines.
  [[49f2d6707]](https://git.sudo.ws/sudo/commit/?id=49f2d6707)

* :

  Merge pull request #226 from rtczza/main

  debug\_return\_int use error
  [[27aff55ac]](https://git.sudo.ws/sudo/commit/?id=27aff55ac)

2022-12-23 wanglujun

* src/exec\_pty.c:

  debug\_return\_int use error
  [[5c495b5fe]](https://git.sudo.ws/sudo/commit/?id=5c495b5fe)

2022-12-20 Todd C. Miller

* docs/sudo.man.in, docs/sudo.mdoc.in:

  Mention the “list” privilege in the description of the -U option.
  [[3040bf54c]](https://git.sudo.ws/sudo/commit/?id=3040bf54c)

* docs/sudo.man.in, docs/sudo.mdoc.in, src/parse\_args.c,
  src/sudo\_usage.h.in:

  Add [arg …] after command in SYNOPSIS and usage output. Use Ar markup
  when referring to the command and args.
  [[eada918bb]](https://git.sudo.ws/sudo/commit/?id=eada918bb)

2022-12-17 Todd C. Miller

* src/exec\_preload.c:

  fmtstr: call va\_arg() for %c when computing length. Even though we don’t
  need to read the actual char to know its length, we do need to consume
  it to get the correct value for the next format.
  [[9d5ed2f9e]](https://git.sudo.ws/sudo/commit/?id=9d5ed2f9e)

* configure, m4/sanitizer.m4:

  SUDO\_CHECK\_SANITIZER: quote “$3” in awk script so m4 doesn’t eat it.
  [[e64799723]](https://git.sudo.ws/sudo/commit/?id=e64799723)

* lib/util/regress/json/json\_test.c:

  Add missing sudo\_json\_free().
  [[d7b367393]](https://git.sudo.ws/sudo/commit/?id=d7b367393)

* MANIFEST, lib/util/Makefile.in, lib/util/regex.c,
  lib/util/regress/regex/regex\_test.c:

  check\_pattern: check bounds as a repetition operator too. Add regess to
  verify check\_pattern() via sudo\_regex\_compile().
  [[0614c1f62]](https://git.sudo.ws/sudo/commit/?id=0614c1f62)

* lib/util/regex.c:

  Instead of collapsing duplicate repetition characters, reject them. This
  is implementation-specific behavior–some regcomp(3) will reject
  duplicate repetition characters (BSD), others will try to support them
  (Glibc) but may allocate excessive amounts of memory.
  [[f0530b66d]](https://git.sudo.ws/sudo/commit/?id=f0530b66d)

* MANIFEST, docs/CONTRIBUTORS.md, po/sq.mo, po/sq.po:

  New Albanian translation from translationproject.org
  [[2f32b45d5]](https://git.sudo.ws/sudo/commit/?id=2f32b45d5)

2022-12-15 Todd C. Miller

* MANIFEST, include/sudo\_json.h, lib/eventlog/eventlog.c,
  lib/iolog/iolog\_loginfo.c,
  lib/iolog/regress/iolog\_json/check\_iolog\_json.c, lib/util/Makefile.in,
  lib/util/json.c, lib/util/regress/json/json\_test.c,
  lib/util/util.exp.in, logsrvd/logsrvd\_local.c,
  plugins/audit\_json/audit\_json.c, plugins/sudoers/cvtsudoers\_json.c:

  Add basic regress for JSON functions. Fix a bug in escaped control
  character handling. Roll back changes to buffer if sudo\_json\_add\_value()
  fails.
  [[797cc917a]](https://git.sudo.ws/sudo/commit/?id=797cc917a)

* plugins/python/regress/iohelpers.c,
  plugins/python/regress/testhelpers.c:

  Add missing memory allocation failure checks. Inspired by GitHub PR #221
  [[0e6482e82]](https://git.sudo.ws/sudo/commit/?id=0e6482e82)

2022-12-14 Todd C. Miller

* lib/util/json.c:

  Escape control characters in strings.
  [[e706204f5]](https://git.sudo.ws/sudo/commit/?id=e706204f5)

2022-12-12 Todd C. Miller

* docs/sudo.man.in, docs/sudo.mdoc.in:

  Mention the audit plugin in the “Process model” section. Remove
  extraneous information describing how sudo may exec the command
  directly, this is already included in the non-pty section.
  [[c184a241a]](https://git.sudo.ws/sudo/commit/?id=c184a241a)

2022-12-11 Todd C. Miller

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sudoers.c:

  Plug a memory leak of list\_cmnd in the fuzzers.
  [[62dd5734a]](https://git.sudo.ws/sudo/commit/?id=62dd5734a)

* plugins/sudoers/cvtsudoers.c:

  Suppress PVS Studio watning about reassigning a variable the same value.
  Working around the warning would result in more fragile code.
  [[25c709c4d]](https://git.sudo.ws/sudo/commit/?id=25c709c4d)

* plugins/python/python\_plugin\_audit.c,
  plugins/python/python\_plugin\_common.c,
  plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_policy.c:

  Fix some dead stores noted by PVS Studio. Since rc is initialized to
  SUDO\_RC\_ERROR there is no need to set it to SUDO\_RC\_ERROR again on
  failure if rc has not been changed since initialization.
  [[f26a2e762]](https://git.sudo.ws/sudo/commit/?id=f26a2e762)

* lib/util/regress/multiarch/multiarch\_test.c:

  Fix memory leak in multiarch\_test to quiet leak sanitizer.
  [[a04557c3d]](https://git.sudo.ws/sudo/commit/?id=a04557c3d)

* docs/sudoers.man.in, docs/sudoers.mdoc.in, plugins/sudoers/logging.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/parse.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Add “list” pseudo-command to allow a user to list another user’s privs.
  Previously, only root or a user with the ability to run any command as
  either root or the target user on the current host could use the -U
  option. For “sudo -l [-U otheruser] command”, NewArgv[0] is now set to
  “list” (just like “sudo -l”) and the actual command to be checked starts
  with NewArgv[1].
  [[a514a6eed]](https://git.sudo.ws/sudo/commit/?id=a514a6eed)

2022-12-09 Todd C. Miller

* etc/codespell.exclude:

  Adjust a line to quiet codespell warning.
  [[8c16c8faf]](https://git.sudo.ws/sudo/commit/?id=8c16c8faf)

2022-12-08 Todd C. Miller

* Makefile.in:

  Only build ChangeLog from a repo checkout, not a release tarball. The
  CODEOWNERS file is not present in the release tarball so we can use that
  when determining what is (or is not) a repo checkout.
  [[934a8793b]](https://git.sudo.ws/sudo/commit/?id=934a8793b)

* docs/CODEOWNERS:

  Add CODEOWNERS file, currently all owned by @millert.
  [[95a6731ff]](https://git.sudo.ws/sudo/commit/?id=95a6731ff)

* .gitignore, .hgignore, Makefile.in:

  Only regenerate ChangeLog if there have been changes. Also check that
  “hg –version” or “git –version” works before using hg or git. [Bug
  #1043](https://bugzilla.sudo.ws/show_bug.cgi?id=1043).
  [[179fd3247]](https://git.sudo.ws/sudo/commit/?id=179fd3247)

2022-12-07 Todd C. Miller

* plugins/sudoers/parse.c:

  Fix potential crash introduced in the fix for [GitHub issue
  #134](https://github.com/sudo-project/sudo/issues/134). If a user’s
  sudoers entry did not have any RunAs user’s set, running “sudo -U
  otheruser -l” would dereference a NULL pointer. We need to compare the
  default RunAs user if the sudoers entry does not specify one explicitly.
  Problem reported by Andreas Mueller who also suggested a different
  solution in PR #219.
  [[f5488d733]](https://git.sudo.ws/sudo/commit/?id=f5488d733)

* scripts/build\_pkgs:

  Defer installing the SIGCHLD handler until after non-job commands run.
  Lock the socket dir to avoid races in open\_persistent\_connection(). Also
  avoid using “ssh -f” since that may return before the socket is created.
  Strip carriage returns from log when running in a pty.
  [[31684dccc]](https://git.sudo.ws/sudo/commit/?id=31684dccc)

2022-12-06 Todd C. Miller

* configure, m4/sudo.m4:

  Fix a typo in SUDO\_CHECK\_NET\_FUNC.
  [[2e322c094]](https://git.sudo.ws/sudo/commit/?id=2e322c094)

* lib/util/inet\_ntop.c:

  Fix -Wsign-compare warning.
  [[185fe31fe]](https://git.sudo.ws/sudo/commit/?id=185fe31fe)

* configure, m4/sudo.m4:

  Initialize “found” in SUDO\_CHECK\_NET\_FUNC.
  [[104a0294e]](https://git.sudo.ws/sudo/commit/?id=104a0294e)

* configure, m4/sudo.m4:

  Fix pasto introduced in last commit.
  [[11264cd49]](https://git.sudo.ws/sudo/commit/?id=11264cd49)

* lib/eventlog/Makefile.in, lib/iolog/Makefile.in, lib/util/Makefile.in,
  logsrvd/Makefile.in, plugins/python/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Fix failure in check targets when there is no UTF-8 C locale.
  [[3df7b64d8]](https://git.sudo.ws/sudo/commit/?id=3df7b64d8)

* configure, configure.ac, m4/sudo.m4:

  Add SUDO\_CHECK\_NET\_FUNC to check functions in the network libraries. If
  a function is not found, check again with “-lsocket”, “-linet”,
  “-lsocket -lnsl”, or “-lresolv”. Also display network libs in final
  summary as well as the different linker flags.
  [[3d2082cdf]](https://git.sudo.ws/sudo/commit/?id=3d2082cdf)

* configure, m4/sudo.m4:

  Make sure HAVE\_MAILLOCK\_H is defined on Solaris 10.
  [[f9639aca8]](https://git.sudo.ws/sudo/commit/?id=f9639aca8)

* configure, configure.ac:

  Remove extraneous “(cached)” line when the -C option is used. We do not
  need to call AC\_CACHE\_VAL() to ensure that a variable is cached, its
  name just needs to match the pattern **cv**.
  [[2c97e7f47]](https://git.sudo.ws/sudo/commit/?id=2c97e7f47)

* configure, m4/sudo.m4:

  Make path checks in sudo.m4 cachable.
  [[3cdd044c6]](https://git.sudo.ws/sudo/commit/?id=3cdd044c6)

* configure, configure.ac:

  Use AC\_PATH\_PROGS\_FEATURE\_CHECK to find mandoc/nroff. We don’t use the
  NROFFPROG or MANDOCPROG any longer so no need to set those.
  [[1b76f7612]](https://git.sudo.ws/sudo/commit/?id=1b76f7612)

* configure, configure.ac:

  Don’t check for \_sys\_siglist if sys\_siglist is found.
  [[dd1eb1f6c]](https://git.sudo.ws/sudo/commit/?id=dd1eb1f6c)

* configure, configure.ac:

  Fix check for sys\_sigabbrev.
  [[fd6484917]](https://git.sudo.ws/sudo/commit/?id=fd6484917)

2022-12-05 Todd C. Miller

* configure, configure.ac:

  Skip test for **func** on C99 and above, avoid extra \_sys\_signame test.
  [[29c36a3c1]](https://git.sudo.ws/sudo/commit/?id=29c36a3c1)

* MANIFEST, aclocal.m4, configure, configure.ac, m4/gettext.m4:

  Move gettext checks to m4/gettext.m4
  [[38ffd03cd]](https://git.sudo.ws/sudo/commit/?id=38ffd03cd)

* MANIFEST, aclocal.m4, configure, configure.ac, m4/ldap.m4:

  Move LDAP library checks to m4/ldap.m4 and make more tests cacheable.
  [[12da6bd0c]](https://git.sudo.ws/sudo/commit/?id=12da6bd0c)

* MANIFEST, aclocal.m4, configure, configure.ac, m4/openssl.m4:

  Move OpenSSL/wolfSSL checks to m4/openssl.m4
  [[00e22508a]](https://git.sudo.ws/sudo/commit/?id=00e22508a)

* MANIFEST, aclocal.m4, configure, configure.ac, m4/pie.m4:

  Move PIE executable checks to m4/pie.m4
  [[f515c238b]](https://git.sudo.ws/sudo/commit/?id=f515c238b)

* MANIFEST, aclocal.m4, configure, configure.ac, m4/sanitizer.m4:

  Move address sanitizer and fuzzer checks to m4/sanitizer.m4
  [[4220e6631]](https://git.sudo.ws/sudo/commit/?id=4220e6631)

* MANIFEST, aclocal.m4, configure, configure.ac, m4/visibility.m4:

  Move symbol visibility checks to m4/visibility.m4
  [[ea5668086]](https://git.sudo.ws/sudo/commit/?id=ea5668086)

* MANIFEST, aclocal.m4, configure, configure.ac, m4/hardening.m4:

  Move hardening checks to m4/hardening.m4
  [[5bf5a4e26]](https://git.sudo.ws/sudo/commit/?id=5bf5a4e26)

* configure, configure.ac, m4/sudo.m4:

  Make cpp variadic arguments check into a macro and move to sudo.m4. Also
  move the PVS-Studio.cfg generation to sudo.m4.
  [[8718fc208]](https://git.sudo.ws/sudo/commit/?id=8718fc208)

2022-12-03 Todd C. Miller

* lib/util/snprintf.c:

  Sync with OpenBSD.
  [[ee6420ad5]](https://git.sudo.ws/sudo/commit/?id=ee6420ad5)

* :

  Merge pull request #218 from sohomdatta1/snprintf

  [snprintf] Check for ‘\0’ to prevent undef memory read
  [[31152ba4d]](https://git.sudo.ws/sudo/commit/?id=31152ba4d)

2022-12-03 Sohom

* lib/util/snprintf.c:

  [snprintf] Check for ‘\0’ to prevent undef memory read
  [[8ac89f8d0]](https://git.sudo.ws/sudo/commit/?id=8ac89f8d0)

2022-12-01 Todd C. Miller

* lib/eventlog/eventlog.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/tsdump.c, plugins/sudoers/visudo.c, src/parse\_args.c,
  src/regress/noexec/check\_noexec.c:

  Place C23 attributes before keywords in function declarations. In
  practice this means we must use “sudo\_noreturn static foo(void)” instead
  of “static sudo\_noreturn foo(void)”.
  [[e707ffe58]](https://git.sudo.ws/sudo/commit/?id=e707ffe58)

2022-11-30 Todd C. Miller

* scripts/build\_pkgs:

  Convert from using IPC::Open3 to IPC::Run. Run tests in a pty so
  check\_ttyname works as expected. Explicitly set short command line
  options letters in GetOptions(). Add a debug flag to help see what is
  going on internally. Add hook for die() to kill running jobs when we are
  dying. SSH\_AGENT\_PID will not be present if the agent is forwarded. In
  close\_persistent\_connections() only close active connections.
  [[a44a005f0]](https://git.sudo.ws/sudo/commit/?id=a44a005f0)

2022-11-29 Todd C. Miller

* config.h.in, configure.ac, include/sudo\_compat.h:

  Use C23 [[**fallthrough**]] and [[**noreturn**]] attributes if
  supported. If the C23 attributes are not supported, use gcc-style
  attributes where possible.
  [[16ae61dcd]](https://git.sudo.ws/sudo/commit/?id=16ae61dcd)

* configure, configure.ac:

  Move the check for the fallthrough attribute outside the warnings block.
  Use AX\_APPEND\_FLAG instead of addind to CFLAGS directly.
  [[cfdcd96b6]](https://git.sudo.ws/sudo/commit/?id=cfdcd96b6)

2022-11-28 Todd C. Miller

* scripts/build\_pkgs:

  The distributed package build script I use to build all sudo packages.
  This is not included in the release tarball because it is of limited use
  to other people.
  [[63e58cbbe]](https://git.sudo.ws/sudo/commit/?id=63e58cbbe)

2022-11-25 Todd C. Miller

* Makefile.in:

  Pass the list of files to include in the tarball on stdin. This avoids
  any limit on the size of argv.
  [[a9cab46f8]](https://git.sudo.ws/sudo/commit/?id=a9cab46f8)

2022-11-23 Todd C. Miller

* :

  Merge pull request #214 from BornThisWay/1124\_repeated\_invocation

  check\_syntax(): Remove duplicate calls to init\_defaults()
  [[9a3669816]](https://git.sudo.ws/sudo/commit/?id=9a3669816)

2022-11-24 modric

* plugins/sudoers/visudo.c:

  check\_syntax(): Remove duplicate calls to init\_defaults()
  [[26cf125fb]](https://git.sudo.ws/sudo/commit/?id=26cf125fb)

2022-11-22 Todd C. Miller

* plugins/sample/sample\_plugin.c:

  build\_command\_info: free command\_info on failure. Once upon a time,
  command\_info was a stack variable, now it is dynamically allocated.
  Coverity CID 299987.
  [[46d286947]](https://git.sudo.ws/sudo/commit/?id=46d286947)

* plugins/sample/sample\_plugin.c:

  Better handling of out-of-memory conditions.
  [[eb4ae10ab]](https://git.sudo.ws/sudo/commit/?id=eb4ae10ab)

* plugins/group\_file/group\_file.c:

  Keep group file open until the call to myendgrent(). This restores the
  previous behavior.
  [[9fff5a5fa]](https://git.sudo.ws/sudo/commit/?id=9fff5a5fa)

* lib/util/json.c, plugins/group\_file/getgrent.c,
  plugins/sudoers/cvtsudoers\_merge.c, plugins/sudoers/env.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/log\_client.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/strvec\_join.c,
  plugins/sudoers/tsgetgrpw.c, plugins/sudoers/visudo.c, src/sudo.c:

  Eliminate a few harmless dead stores. Quiets warnings from Infer.
  [[f066ff9e0]](https://git.sudo.ws/sudo/commit/?id=f066ff9e0)

* plugins/sudoers/ldap\_util.c:

  sudo\_ldap\_parse\_option: add explicit NULL check for strchr(). This
  should not be needed since we only use the returned pointer if it is
  larger than the string passed to strchr(). Quiets a warning from Infer.
  [[2f97da316]](https://git.sudo.ws/sudo/commit/?id=2f97da316)

* logsrvd/logsrvd\_journal.c:

  journal\_fdopen: free journal\_path and close journal before setting Fixes
  a potential resource leak that currently cannot happen. Quiets a warning
  from Infer.
  [[a0d9963fe]](https://git.sudo.ws/sudo/commit/?id=a0d9963fe)

* plugins/sudoers/ldap.c:

  sudo\_ldap\_result\_add\_entry: check sudo\_ldap\_get\_values\_len() return
  value. Previously, we just compared the error code with LDAP\_NO\_MEMORY
  when checking for sudoOrder since this is the only error we care about.
  We now return NULL for LDAP\_NO\_MEMORY and ignore other errors. Quiets a
  warning from Infer.
  [[a37ecb266]](https://git.sudo.ws/sudo/commit/?id=a37ecb266)

* plugins/group\_file/getgrent.c, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/tsgetgrpw.h:

  Refactor code to open passwd/group file and add setpassent/setgroupent.
  This makes the “stayopen” semantics match the system passwd/group
  functions. The getpwent/getgrent functions now open the database if it
  is not already open.
  [[1c9c7bd34]](https://git.sudo.ws/sudo/commit/?id=1c9c7bd34)

* plugins/sudoers/Makefile.in, plugins/sudoers/gram.h:

  gram.h: #line directives should reference gram.h not y.tab.h.
  [[4d7823e51]](https://git.sudo.ws/sudo/commit/?id=4d7823e51)

* scripts/mkpkg:

  Use clang, not /usr/bin/cc on FreeBSD and macOS. While /usr/bin/cc *is*
  clang on those platforms, some static analyzers get confused if we don’t
  run it as clang.
  [[7ac13204f]](https://git.sudo.ws/sudo/commit/?id=7ac13204f)

2022-11-21 Todd C. Miller

* :

  Merge pull request #212 from BornThisWay/1122\_null\_deref

  sudo\_rcstr\_dup: Fix potential NULL pointer deref
  [[da7a5ecab]](https://git.sudo.ws/sudo/commit/?id=da7a5ecab)

2022-11-22 modric

* lib/util/rcstr.c:

  sudo\_rcstr\_dup: Fix potential NULL pointer deref
  [[dbfd84301]](https://git.sudo.ws/sudo/commit/?id=dbfd84301)

2022-11-21 Todd C. Miller

* plugins/sudoers/check.c:

  Add a reminder to the default lecture that the password will not echo.
  This line is only displayed when the pwfeedback option is disabled.
  [GitHub issue #195](https://github.com/sudo-project/sudo/issues/195).
  [[339626729]](https://git.sudo.ws/sudo/commit/?id=339626729)

* :

  Merge pull request #210 from BornThisWay/1121\_typo

  Fix some typos
  [[c3f138eaa]](https://git.sudo.ws/sudo/commit/?id=c3f138eaa)

2022-11-21 modric

* plugins/python/regress/testhelpers.h, plugins/sudoers/parse.c:

  Fix some typos
  [[cbdc4883d]](https://git.sudo.ws/sudo/commit/?id=cbdc4883d)

2022-11-20 Todd C. Miller

* :

  Merge pull request #208 from BornThisWay/1121\_return

  intercept\_read: Print and then return.
  [[6a5546b11]](https://git.sudo.ws/sudo/commit/?id=6a5546b11)

2022-11-21 modric

* src/exec\_intercept.c:

  intercept\_read: Print and then return.
  [[b1af59aa5]](https://git.sudo.ws/sudo/commit/?id=b1af59aa5)

2022-11-20 Todd C. Miller

* :

  Merge pull request #205 from BornThisWay/1119\_access\_null\_pointer

  sudo\_mmap\_strdup\_v1: Fix potential NULL pointer deref
  [[496ae6e6f]](https://git.sudo.ws/sudo/commit/?id=496ae6e6f)

2022-11-19 modric

* lib/util/mmap\_alloc.c:

  sudo\_mmap\_strdup\_v1: Fix potential NULL pointer deref
  [[1eabf1357]](https://git.sudo.ws/sudo/commit/?id=1eabf1357)

2022-11-18 Todd C. Miller

* src/sudo\_intercept.c:

  copy\_vector: plug memory leak in error path Only the array was being
  freed, not the contents. [GitHub issue
  #202](https://github.com/sudo-project/sudo/issues/202).
  [[9c694e9a6]](https://git.sudo.ws/sudo/commit/?id=9c694e9a6)

2022-11-17 Todd C. Miller

* scripts/mkpkg:

  Better matching of macOS version to SDK path.
  [[981cc2f8e]](https://git.sudo.ws/sudo/commit/?id=981cc2f8e)

* :

  Merge pull request #200 from BornThisWay/fix\_mem\_leak\_converse

  Fix memory leak of pass in converse().
  [[ad220d72d]](https://git.sudo.ws/sudo/commit/?id=ad220d72d)

* plugins/sudoers/auth/passwd.c:

  sudo\_passwd\_cleanup: Set auth->data to NULL after freeing. [GitHub
  issue #201](https://github.com/sudo-project/sudo/issues/201)
  [[b3834bbf2]](https://git.sudo.ws/sudo/commit/?id=b3834bbf2)

2022-11-17 modric

* plugins/sudoers/auth/pam.c:

  Fix memory leak of pass in converse().
  [[f5cae905c]](https://git.sudo.ws/sudo/commit/?id=f5cae905c)

2022-11-16 Todd C. Miller

* config.h.in, configure, configure.ac:

  Use AC\_SYS\_YEAR2038 instead of setting \_TIME\_BITS by hand.
  [[004489396]](https://git.sudo.ws/sudo/commit/?id=004489396)

* configure, m4/ax\_append\_flag.m4, m4/ax\_check\_compile\_flag.m4,
  m4/ax\_func\_snprintf.m4, m4/ax\_prog\_cc\_for\_build.m4:

  Update macros from autoconf-archive.
  [[4af5e6293]](https://git.sudo.ws/sudo/commit/?id=4af5e6293)

* plugins/sudoers/regress/corpus/seed/ldif/pr196.ldif,
  plugins/sudoers/regress/visudo/test3.sh:

  Fix typo; excerise -> exercise
  [[fe8e1f3d3]](https://git.sudo.ws/sudo/commit/?id=fe8e1f3d3)

* config.h.in, configure, scripts/config.guess, scripts/config.sub:

  Regenerate with the autoconf 2.72a pre-release.
  [[920d38494]](https://git.sudo.ws/sudo/commit/?id=920d38494)

* configure.ac, m4/ax\_func\_getaddrinfo.m4, m4/sudo.m4:

  Replace `foo` in descriptions with ‘foo’
  [[03559d077]](https://git.sudo.ws/sudo/commit/?id=03559d077)

* configure.ac:

  Fix insufficient quoting in AC\_CHECK\_LIB() calls.
  [[cc0615059]](https://git.sudo.ws/sudo/commit/?id=cc0615059)

* autogen.sh:

  If AUTOCONF\_VERSION is unset, use version 2.71 not 2.69.
  [[096eacb21]](https://git.sudo.ws/sudo/commit/?id=096eacb21)

2022-11-15 Todd C. Miller

* configure, configure.ac:

  Add -Wvla and -Walloca to –enable-warnings
  [[bef72f76f]](https://git.sudo.ws/sudo/commit/?id=bef72f76f)

2022-11-11 Todd C. Miller

* plugins/sudoers/pwutil.c:

  sudo\_debug\_group\_list: short-circuit if groups is NULL
  [[3ecfa025b]](https://git.sudo.ws/sudo/commit/?id=3ecfa025b)

* configure, configure.ac:

  configure: only check for getauxval() if getentropy() is missing.
  [[3cfba230c]](https://git.sudo.ws/sudo/commit/?id=3cfba230c)

* config.h.in, configure, configure.ac:

  Remove checks for random() and lrand48(), they are no longer used. Also
  remove duplicate checks for arc4random() and getentropy().
  [[28dbad334]](https://git.sudo.ws/sudo/commit/?id=28dbad334)

* configure, configure.ac:

  Skip check for cpp variadic macro support if the compiler supports C99.
  [[3d0fcc0ff]](https://git.sudo.ws/sudo/commit/?id=3d0fcc0ff)

* configure, configure.ac:

  HI-UX/MPP is based on OSF-1, not HP-UX Completely untested.
  [[6b005e811]](https://git.sudo.ws/sudo/commit/?id=6b005e811)

* configure, configure.ac:

  Only check for utmps.h on HP-UX.
  [[a142bc183]](https://git.sudo.ws/sudo/commit/?id=a142bc183)

* configure, configure.ac:

  Only check for sys/syscall.h on Linux. We only use it in the
  Linux-specific getentropy() emulation code.
  [[a3684d7f3]](https://git.sudo.ws/sudo/commit/?id=a3684d7f3)

* config.h.in, configure, configure.ac:

  configure: avoid running unnecessary tests on modern systems. Remove
  AC\_SYS\_POSIX\_TERMIOS, AC\_TYPE\_MODE\_T, AC\_TYPE\_UID\_T. Add missing checks
  for int16\_t, uint16\_t, int32\_t, and int64\_t. Only check for intmax\_t,
  uintmax\_t and bit-width types if missing both inttypes.h and stdint.h.
  Remove unused clockid\_t replacement.
  [[feba299f2]](https://git.sudo.ws/sudo/commit/?id=feba299f2)

* MANIFEST, plugins/sudoers/regress/cvtsudoers/test40.out.ok,
  plugins/sudoers/regress/cvtsudoers/test40.sh:

  Add a regress check for the cvtsudoers filter crash. [GitHub issue
  #198](https://github.com/sudo-project/sudo/issues/198).
  [[b8e9fc1b1]](https://git.sudo.ws/sudo/commit/?id=b8e9fc1b1)

2022-11-10 Todd C. Miller

* plugins/sudoers/parse\_ldif.c:

  Fix a potential use-after-free bug with cvtsudoers filtering. In
  role\_to\_sudoers() when merging a privilege to the previous one where the
  runas lists are the same we need to re-use the runas lists of the last
  command in the previous privilege, not the first. Otherwise, the check
  in free\_cmndspec() will not notice the re-used runas lists.
  Reported/analyzed by Sohom Datta. [GitHub issue
  #198](https://github.com/sudo-project/sudo/issues/198).
  [[264326de5]](https://git.sudo.ws/sudo/commit/?id=264326de5)

2022-11-11 Todd C. Miller

* Makefile.in, lib/eventlog/Makefile.in, lib/iolog/Makefile.in,
  lib/util/Makefile.in, logsrvd/Makefile.in, plugins/python/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  The name of the C locale w/ UTF-8 support is not always C.UTF-8. Use a
  pattern to find it (if present) and use that value instead of
  hard-coding C.UTF-8. This works around a leak sanitizer crash on certain
  inputs.
  [[5683fc6f7]](https://git.sudo.ws/sudo/commit/?id=5683fc6f7)

2022-11-10 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/corpus/seed/ldif/invalid\_b64.ldif,
  plugins/sudoers/regress/corpus/seed/ldif/pr196.ldif,
  plugins/sudoers/regress/corpus/seed/ldif/sample.ldif,
  plugins/sudoers/regress/corpus/seed/ldif/valid\_b64.ldif,
  plugins/sudoers/regress/cvtsudoers/test39.sh:

  Copy some LDIF test data from the cvtsudoers tests to the seed corpus.
  This includes a test to exercise the fix in PR #196.
  [[75008a057]](https://git.sudo.ws/sudo/commit/?id=75008a057)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Set LDAP base for sudoers\_parse\_ldif(). Without this set the fuzzer will
  not exercise the dn parsing.
  [[455f250ac]](https://git.sudo.ws/sudo/commit/?id=455f250ac)

* src/exec\_ptrace.h:

  Include linux/elf.h, not elf.h to make sure we get NT\_ARM\_SYSTEM\_CALL.
  The NT\_PRSTATUS define is present in both files.
  [[82150340a]](https://git.sudo.ws/sudo/commit/?id=82150340a)

2022-11-09 Todd C. Miller

* include/sudo\_compat.h:

  Remove CMSG\_\* compatibility macros, they are no longer used.
  [[3e8497b5c]](https://git.sudo.ws/sudo/commit/?id=3e8497b5c)

* lib/util/multiarch.c, lib/util/sudo\_dso.c:

  Add missing include of sys/stat.h
  [[ecb5526fc]](https://git.sudo.ws/sudo/commit/?id=ecb5526fc)

* include/sudo\_util.h:

  Move forward declaration of struct stat before its first use.
  [[8b06bdc12]](https://git.sudo.ws/sudo/commit/?id=8b06bdc12)

* plugins/sudoers/regress/cvtsudoers/test28.sh,
  plugins/sudoers/regress/cvtsudoers/test29.sh,
  plugins/sudoers/regress/cvtsudoers/test33.sh,
  plugins/sudoers/regress/cvtsudoers/test39.sh:

  Use a consistent base when testing cvtsudoers conversion from ldif.
  [[0b1335f54]](https://git.sudo.ws/sudo/commit/?id=0b1335f54)

* MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/cvtsudoers/test39.out.ok,
  plugins/sudoers/regress/cvtsudoers/test39.sh,
  plugins/sudoers/regress/harness.in:

  Test parsing LDIF when a backslash is the last char of the file. If run
  with address sanitizer, this test will crash when the fix in
  ceaf706ab74b is reverted.
  [[8b898b2ca]](https://git.sudo.ws/sudo/commit/?id=8b898b2ca)

* :

  Merge pull request #196 from sohomdatta1/main

  Prevent cvtsudoers from reading into undefined memory
  [[685150586]](https://git.sudo.ws/sudo/commit/?id=685150586)

2022-11-09 Sohom

* plugins/sudoers/parse\_ldif.c:

  [cvtsudoers]: Prevent sudo from reading into undefined memory
  [[902271f44]](https://git.sudo.ws/sudo/commit/?id=902271f44)

2022-11-08 Todd C. Miller

* plugins/sudoers/auth/passwd.c:

  sudo\_passwd\_verify: zero out des\_pass before returning.
  [[9f948224a]](https://git.sudo.ws/sudo/commit/?id=9f948224a)

2022-11-07 Todd C. Miller

* src/exec\_nopty.c, src/regress/intercept/test\_ptrace.c, src/sudo\_exec.h,
  src/suspend\_nopty.c:

  Pass sudo’s process ID to suspend\_sudo\_nopty() since we already know it.
  Saves an unnecessary getpid(2) call.
  [[045d08bec]](https://git.sudo.ws/sudo/commit/?id=045d08bec)

* src/exec\_pty.c:

  Don’t kill the parent process group on suspend if it is not sudo’s pid.
  If sudo is not the process group leader we must only send the suspend
  signal to sudo itself. When sudo is run via a shell script, it usually
  has the same process group as the shell script interpreter. We do not
  want to suspend the script itself when the command run by sudo is
  suspended.
  [[f87fac3b5]](https://git.sudo.ws/sudo/commit/?id=f87fac3b5)

* src/exec\_nopty.c:

  Call terminate\_command() with use\_pgrp = false when not running in a
  pty. When sudo runs a command in the user’s existing terminal the
  command is run in the same process group as sudo itself. The proper way
  to terminate it is to use kill(2), not killpg(3)
  [[bbe4fbaaa]](https://git.sudo.ws/sudo/commit/?id=bbe4fbaaa)

* src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c, src/sudo\_exec.h:

  Fix handling of signal forwarding when running commands in a script. We
  need to forward signals from a process in the same pgrp if the pgrp
  leader is not either sudo or the command itself.
  [[36742deec]](https://git.sudo.ws/sudo/commit/?id=36742deec)

* src/regress/intercept/test\_ptrace.c:

  Make test\_ptrace compile again after recent changes.
  [[c7071f6da]](https://git.sudo.ws/sudo/commit/?id=c7071f6da)

* src/exec\_intercept.c, src/exec\_intercept.h, src/exec\_ptrace.c:

  Update the cwd for log\_subcmds too. Fixes a problem for
  intercept\_method=trace when running a relative command from a different
  directory than what sudo ws started from. [GitHub issue
  #194](https://github.com/sudo-project/sudo/issues/194)
  [[8db1eb0c8]](https://git.sudo.ws/sudo/commit/?id=8db1eb0c8)

2022-11-04 Todd C. Miller

* NEWS, aclocal.m4, configure, configure.ac:

  sudo 1.9.12p1
  [[3df1e9a07]](https://git.sudo.ws/sudo/commit/?id=3df1e9a07)

2022-11-03 Todd C. Miller

* lib/iolog/host\_port.c:

  Include time.h for struct timespec used by sudo\_iolog.h.
  [[7ba318470]](https://git.sudo.ws/sudo/commit/?id=7ba318470)

* src/sudo.c:

  Display sudo\_mode in hex in debug log. This makes it easier to match
  against the MODE\_ defines.
  [[b2c8e1b1b]](https://git.sudo.ws/sudo/commit/?id=b2c8e1b1b)

2022-11-01 Todd C. Miller

* plugins/sudoers/auth/bsdauth.c:

  bsdauth\_verify: do not write to prompt, it is now const
  [[7ec1ee0e5]](https://git.sudo.ws/sudo/commit/?id=7ec1ee0e5)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Store raw sudoers lines in the debug log. Also add a “sudoerslex” prefix
  to the token debug info in sudoers\_trace\_print().
  [[d242261dd]](https://git.sudo.ws/sudo/commit/?id=d242261dd)

2022-10-31 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  The line numbers in sudoers\_trace\_print() were off by one. The line
  counter is incremented when a newline is seen so the output actually
  refers to the previous line.
  [[966731311]](https://git.sudo.ws/sudo/commit/?id=966731311)

* plugins/sudoers/auth/API, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.h:

  Make the second arg to the sudo auth verify function const. This may be
  either a plaintext password or a password prompt. Either way it should
  not be modified by the verify function.
  [[4da22b101]](https://git.sudo.ws/sudo/commit/?id=4da22b101)

2022-10-28 Todd C. Miller

* plugins/sudoers/auth/passwd.c:

  Fix CVE-2022-43995, potential heap overflow for passwords < 8
  characters. Starting with sudo 1.8.0 the plaintext password buffer is
  dynamically sized so it is not safe to assume that it is at least 9
  bytes in size. Found by Hugo Lefeuvre (University of Manchester) with
  ConfFuzz.
  [[bd209b9f1]](https://git.sudo.ws/sudo/commit/?id=bd209b9f1)

2022-10-29 Todd C. Miller

* plugins/sudoers/match.c:

  Move debugging info from hostname\_matches() to host\_matches().
  [[c78e78dc5]](https://git.sudo.ws/sudo/commit/?id=c78e78dc5)

2022-10-28 Todd C. Miller

* plugins/sudoers/pwutil.c:

  Add debugging to sudo\_set\_grlist() and sudo\_set\_gidlist().
  [[6a3fb3fd7]](https://git.sudo.ws/sudo/commit/?id=6a3fb3fd7)

2022-10-27 Todd C. Miller

* configure, configure.ac:

  configure: better test for -fstack-clash-protection The gcc front-end
  may accept -fstack-clash-protection even if the machine-specific code
  does not support it. We use a test program with a large stack allocation
  to try to cause the compiler to insert the stack clash protection code,
  or fail if not supported. [GitHub issue
  #191](https://github.com/sudo-project/sudo/issues/191)
  [[366217571]](https://git.sudo.ws/sudo/commit/?id=366217571)

* configure, configure.ac:

  Check that compiler accepts -fstack-clash-protection and
  -fcf-protection. Previously, we only checked that linker accepted them.
  [GitHub issue #191](https://github.com/sudo-project/sudo/issues/191)
  [[6a2075b67]](https://git.sudo.ws/sudo/commit/?id=6a2075b67)

2022-10-26 Todd C. Miller

* src/exec\_ptrace.c:

  Fix compilation error on Linux/mips.
  [[794449419]](https://git.sudo.ws/sudo/commit/?id=794449419)

2022-10-21 Todd C. Miller

* src/Makefile.in:

  Regenerate dependencies for src/sesh.c.
  [[802e500cc]](https://git.sudo.ws/sudo/commit/?id=802e500cc)

* plugins/audit\_json/Makefile.in, plugins/sample\_approval/Makefile.in:

  Sync clean target with other Makefile.in files.
  [[ebd285850]](https://git.sudo.ws/sudo/commit/?id=ebd285850)

* Makefile.in, plugins/sample/Makefile.in:

  Build the sample plugin but do not install it by default. We no longer
  install the sample approval plugin.
  [[8087604e5]](https://git.sudo.ws/sudo/commit/?id=8087604e5)

* plugins/sample/sample\_plugin.c:

  Adapt to current plugin API and fix warnings.
  [[45ea24833]](https://git.sudo.ws/sudo/commit/?id=45ea24833)

2022-10-20 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Disable admin\_flag by setting to NULL, not false. Found by cppcheck.
  [[9b9404b6f]](https://git.sudo.ws/sudo/commit/?id=9b9404b6f)

* NEWS:

  [Bug #1042](https://bugzilla.sudo.ws/show_bug.cgi?id=1042).
  [[3a6083f04]](https://git.sudo.ws/sudo/commit/?id=3a6083f04)

* include/sudo\_util.h, lib/util/fatal.c, lib/util/term.c,
  lib/util/util.exp.in, src/conversation.c:

  Only add trailing carriage return to messages if output is a raw tty. If
  output is being written to a terminal in “raw” mode, we need to add a
  carriage return after the newline to avoid “stair-step” output. However,
  we should not write the carriage return if the terminal is in “cooked”
  mode, output to a pipe, or output redirected to a file. [Bug
  #1042](https://bugzilla.sudo.ws/show_bug.cgi?id=1042).
  [[803998d2b]](https://git.sudo.ws/sudo/commit/?id=803998d2b)

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Make it clear that runas\_default sets the default user for Runas\_Spec.
  Also use mention runas\_default in other parts of the manual, use
  @runas\_default@ instead of root and add markup around user names.
  [GitHub issue #186](https://github.com/sudo-project/sudo/issues/186).
  [[d744271a6]](https://git.sudo.ws/sudo/commit/?id=d744271a6)

* lib/util/multiarch.c, lib/util/sudo\_dso.c:

  Fix a typo, muti-arch -> multi-arch [GitHub issue
  #185](https://github.com/sudo-project/sudo/issues/185)
  [[3ca21f950]](https://git.sudo.ws/sudo/commit/?id=3ca21f950)

2022-10-19 Todd C. Miller

* NEWS:

  Mention log\_servers eventlog fix.
  [[82db62ec6]](https://git.sudo.ws/sudo/commit/?id=82db62ec6)

* plugins/sudoers/policy.c:

  Don’t NULL out the plugin close function when logging to a log server.
  If sudo calls execve(2) directly the accept info will not be sent. We
  also need the sudo front-end to wait until the command finishes to send
  the exit status.
  [[e7db62f64]](https://git.sudo.ws/sudo/commit/?id=e7db62f64)

2022-10-17 Todd C. Miller

* INSTALL.md:

  Fix numbering in “Simple sudo installation”
  [[d251dfd55]](https://git.sudo.ws/sudo/commit/?id=d251dfd55)

2022-10-14 Todd C. Miller

* NEWS:

  zlib 1.2.13 update
  [[5c5ff3fda]](https://git.sudo.ws/sudo/commit/?id=5c5ff3fda)

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/ro.mo, plugins/sudoers/po/ro.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po, po/cs.mo, po/cs.po,
  po/de.mo, po/de.po, po/fr.mo, po/fr.po, po/ja.mo, po/ja.po, po/ka.mo,
  po/ka.po, po/ko.mo, po/ko.po, po/pl.mo, po/pl.po, po/ro.mo, po/ro.po,
  po/sr.mo, po/sr.po, po/sv.mo, po/sv.po, po/uk.mo, po/uk.po:

  Updated translations from translationproject.org
  [[5dbb8ac6e]](https://git.sudo.ws/sudo/commit/?id=5dbb8ac6e)

* lib/zlib/zconf.h.in:

  Don’t define \_LARGEFILE64\_SOURCE or \_LFS64\_LARGEFILE. We don’t need them
  and the missing prototype for crc32\_combine\_gen64() issue has been fixed
  upstream.
  [[6185c4f84]](https://git.sudo.ws/sudo/commit/?id=6185c4f84)

2022-10-13 Todd C. Miller

* lib/zlib/compress.c, lib/zlib/crc32.c, lib/zlib/deflate.c,
  lib/zlib/deflate.h, lib/zlib/gzlib.c, lib/zlib/gzread.c,
  lib/zlib/gzwrite.c, lib/zlib/infback.c, lib/zlib/inflate.c,
  lib/zlib/inftrees.c, lib/zlib/inftrees.h, lib/zlib/trees.c,
  lib/zlib/uncompr.c, lib/zlib/zconf.h.in, lib/zlib/zlib.h,
  lib/zlib/zutil.c, lib/zlib/zutil.h:

  Update embedded copy of zlib to version 1.2.13. Fixes CVE-2022-37434.
  [[51a1a7d63]](https://git.sudo.ws/sudo/commit/?id=51a1a7d63)

* lib/util/fchownat.c:

  Add fchownat() for systems without it.
  [[0be0757d6]](https://git.sudo.ws/sudo/commit/?id=0be0757d6)

2022-10-10 Todd C. Miller

* NEWS:

  Update NEWS for 1.9.12.
  [[23e1d3293]](https://git.sudo.ws/sudo/commit/?id=23e1d3293)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update .pot files for 1.9.12
  [[3b205bc41]](https://git.sudo.ws/sudo/commit/?id=3b205bc41)

* src/selinux.c, src/sesh.c, src/sudo\_edit.c:

  Use getopt() and getopt\_long() for sesh command line options.
  [[3bdb58548]](https://git.sudo.ws/sudo/commit/?id=3bdb58548)

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in:

  Update the description of intercept\_verify
  [[8d5e59c8a]](https://git.sudo.ws/sudo/commit/?id=8d5e59c8a)

2022-10-07 Todd C. Miller

* src/load\_plugins.c:

  Silence a warning from the Solaris Studio compiler.
  [[fbd8de027]](https://git.sudo.ws/sudo/commit/?id=fbd8de027)

* docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in,
  include/sudo\_eventlog.h, include/sudo\_json.h, include/sudo\_plugin.h,
  lib/eventlog/eventlog.c, lib/iolog/iolog\_loginfo.c,
  lib/iolog/regress/iolog\_json/check\_iolog\_json.c, lib/util/json.c,
  logsrvd/logsrvd\_local.c, plugins/audit\_json/audit\_json.c,
  plugins/sudoers/sudoers.h, src/env\_hooks.c, src/exec\_intercept.c,
  src/net\_ifs.c, src/sudo\_intercept\_common.c, src/sudo\_plugin\_int.h:

  Avoid a -Wshadow warning on Solaris 9.
  [[57b5ff8e8]](https://git.sudo.ws/sudo/commit/?id=57b5ff8e8)

* lib/util/mmap\_alloc.c:

  Fix a build error on Solaris 9.
  [[0eb136d65]](https://git.sudo.ws/sudo/commit/?id=0eb136d65)

2022-10-06 Todd C. Miller

* plugins/sudoers/parse.c:

  Fix display of command tags and options in “sudo -l” when RunAs changes.
  A new line is started when RunAs changes which means we need to display
  the command tags and options again. [GitHub issue
  #184](https://github.com/sudo-project/sudo/issues/184)
  [[af83e3c10]](https://git.sudo.ws/sudo/commit/?id=af83e3c10)

* plugins/sudoers/fmtsudoers.c:

  Fix printing of MYSELF when listing another user’s privileges. We need
  to use list\_pw if it is set instead of user\_name. [GitHub issue
  #183](https://github.com/sudo-project/sudo/issues/183)
  [[6a0f7ccc4]](https://git.sudo.ws/sudo/commit/?id=6a0f7ccc4)

* NEWS:

  Update NEWS file with recent changes.
  [[282d13532]](https://git.sudo.ws/sudo/commit/?id=282d13532)

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in,
  lib/util/multiarch.c, lib/util/regress/multiarch/multiarch\_test.c,
  lib/util/sudo\_dso.c, lib/util/util.exp.in, src/load\_plugins.c:

  Apply multiarch rules when loading plugins too.
  [[7e20e4b80]](https://git.sudo.ws/sudo/commit/?id=7e20e4b80)

2022-10-05 Todd C. Miller

* lib/util/sudo\_dso.c:

  sudo\_dso\_load: try multi-arch on Linux if we can’t load the path. For
  example, if loading /usr/lib/libsss\_sudo.so fails, try again with
  /usr/lib/x86\_64-linux-gnu/libsss\_sudo.so.
  [[0b506a2d0]](https://git.sudo.ws/sudo/commit/?id=0b506a2d0)

* MANIFEST, lib/util/Makefile.in,
  lib/util/regress/open\_parent\_dir/open\_parent\_dir\_test.c:

  Add test for sudo open\_parent\_dir()
  [[b37bf44cd]](https://git.sudo.ws/sudo/commit/?id=b37bf44cd)

* MANIFEST, plugins/sudoers/regress/testsudoers/test19.out.ok,
  plugins/sudoers/regress/testsudoers/test19.sh:

  Add test for matching a literal "" command line argument as "" in
  sudoers. [GitHub issue
  #182](https://github.com/sudo-project/sudo/issues/182).
  [[2e2dd48be]](https://git.sudo.ws/sudo/commit/?id=2e2dd48be)

2022-10-04 Todd C. Miller

* docs/visudo.man.in, docs/visudo.mdoc.in, plugins/sudoers/visudo.c:

  Add -I flag to disable editing include files unless there is an error.
  This can be used when you only want to edit a single sudoers file unless
  there is a pre-existing syntax error.
  [[fa952bfbb]](https://git.sudo.ws/sudo/commit/?id=fa952bfbb)

* plugins/sudoers/match\_command.c:

  Do not match a literal "" command line argument as "" in sudoers. If the
  empty string is specified in sudoers, no user args are allowed. [GitHub
  issue #182](https://github.com/sudo-project/sudo/issues/182).
  [[575200e73]](https://git.sudo.ws/sudo/commit/?id=575200e73)

* lib/util/sudo\_conf.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/timestamp.c:

  sudo\_secure\_open\_{file,dir}: always check thatreturn value is not -1.
  Avoids false positives from static analyzers that can’t figure out that
  the fd is always valid when error is SUDO\_PATH\_SECURE.
  [[3940020c9]](https://git.sudo.ws/sudo/commit/?id=3940020c9)

* lib/iolog/iolog\_mkdtemp.c:

  Correct return value when mkdtempat() fails.
  [[59765dd36]](https://git.sudo.ws/sudo/commit/?id=59765dd36)

* lib/util/mkdir\_parents.c:

  sudo\_open\_parent\_dir: stop before creating the last path component Fix a
  regression introduced in sudo 1.9.9 where the entire directory path was
  created instead of just the parent directory.
  [[719b7f933]](https://git.sudo.ws/sudo/commit/?id=719b7f933)

2022-10-01 Todd C. Miller

* Makefile.in, scripts/log2cl.pl:

  Use “hg log –template” instead of “hg log –style”.
  [[371b974e0]](https://git.sudo.ws/sudo/commit/?id=371b974e0)

2022-09-29 Todd C. Miller

* plugins/sudoers/strlcpy\_unesc.c, plugins/sudoers/sudoers.c,
  src/parse\_args.c:

  Mark code that escapes/unescapes “sudo -s cmd args…” for removal. A
  future version of the plugin API will defer any such escaping to the
  policy plugin so it can be configurable.
  [[afaeb0ed5]](https://git.sudo.ws/sudo/commit/?id=afaeb0ed5)

* NEWS:

  Update with recent changes.
  [[63efad271]](https://git.sudo.ws/sudo/commit/?id=63efad271)

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in:

  Improve the description of JSON output.
  [[6cd99d0b7]](https://git.sudo.ws/sudo/commit/?id=6cd99d0b7)

2022-09-28 Todd C. Miller

* INSTALL.md, etc/codespell.ignore, lib/eventlog/eventlog.c,
  plugins/group\_file/getgrent.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/tsgetgrpw.c, plugins/sudoers/tsgetgrpw.h,
  src/exec\_nopty.c:

  Fix typos found by codespell 2.2.1.
  [[d2a13a815]](https://git.sudo.ws/sudo/commit/?id=d2a13a815)

* logsrvd/iolog\_writer.c:

  Change max user-ID and group-ID from INT\_MAX to UINT\_MAX.
  [[166e0e13b]](https://git.sudo.ws/sudo/commit/?id=166e0e13b)

* logsrvd/logsrvd\_local.c:

  Add support for NumberList stored in an InfoMessage.
  [[865d3cd0b]](https://git.sudo.ws/sudo/commit/?id=865d3cd0b)

* logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, logsrvd/logsrvd\_local.c,
  plugins/sudoers/log\_client.c:

  Add missing NULL checks for mandatory fields in protobuf messages. Also
  no longer reject an InfoMessage with an unknown value\_case, just log and
  ignore it.
  [[e6f2ad0ed]](https://git.sudo.ws/sudo/commit/?id=e6f2ad0ed)

2022-09-27 Todd C. Miller

* plugins/sudoers/log\_client.c:

  Don’t send ttyname to log server if it is NULL. Otherwise the log server
  will reject the AcceptMessage because a NULL string is not allowed.
  [[915042367]](https://git.sudo.ws/sudo/commit/?id=915042367)

* src/exec\_nopty.c:

  HP-UX has struct winsize in termios.h.
  [[cf95f8d5a]](https://git.sudo.ws/sudo/commit/?id=cf95f8d5a)

* plugins/python/Makefile.in, src/Makefile.in:

  Regen dependencies
  [[f360a8006]](https://git.sudo.ws/sudo/commit/?id=f360a8006)

* docs/sudoers.man.in, docs/sudoers.mdoc.in, src/exec.c, src/exec\_nopty.c,
  src/exec\_pty.c, src/regress/intercept/test\_ptrace.c, src/sudo\_exec.h,
  src/suspend\_nopty.c:

  Add support for logging stdin/stdout/stderr in the non-pty exec path. If
  we are logging I/O but not terminal input/output (either because no
  terminal is present or because that is what the plugin requested), the
  non-pty exec path is now taken.
  [[87b7209eb]](https://git.sudo.ws/sudo/commit/?id=87b7209eb)

* MANIFEST, src/Makefile.in, src/exec.c, src/exec\_iolog.c,
  src/exec\_nopty.c, src/exec\_pty.c, src/regress/noexec/check\_noexec.c,
  src/sudo\_exec.h, src/sudo\_intercept\_common.c:

  Move exec code to call into I/O log plugin to exec\_iolog.c. This will be
  shared with exec\_nopty.c in the future to log stdin/stdout/stderr
  without running the command in a pty. Both exec\_pty.c and exec\_nopty.c
  now use the same closure.
  [[803b4939b]](https://git.sudo.ws/sudo/commit/?id=803b4939b)

* plugins/python/python\_importblocker.c:

  Implement find\_spec, not the deprecated find\_module. Fixes a test
  failure due to find\_module having removed from setuptools.
  [[3ca9220e5]](https://git.sudo.ws/sudo/commit/?id=3ca9220e5)

2022-09-23 Todd C. Miller

* plugins/sudoers/editor.c, plugins/sudoers/regress/editor/check\_editor.c:
  copy\_arg: fix copying an escaped backslash [GitHub issue
  #179](https://github.com/sudo-project/sudo/issues/179)
  [[e66f34d25]](https://git.sudo.ws/sudo/commit/?id=e66f34d25)

2022-09-22 Todd C. Miller

* config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/mktemp.c:

  Use mkdtempat\_np() and mkostempsat\_np() on macOS
  [[d37710b0f]](https://git.sudo.ws/sudo/commit/?id=d37710b0f)

2022-09-21 Todd C. Miller

* include/sudo\_iolog.h, lib/iolog/iolog\_mkdirs.c,
  lib/iolog/iolog\_mkdtemp.c, lib/util/mkdir\_parents.c, logsrvd/logsrvd.c,
  logsrvd/logsrvd\_journal.c:

  Convert remaining uses of sudo\_mkdir\_parents() to
  sudo\_open\_parent\_dir().
  [[9d654482b]](https://git.sudo.ws/sudo/commit/?id=9d654482b)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, scripts/mkdep.pl:

  Add fchownat() systems without it.
  [[376d18b5d]](https://git.sudo.ws/sudo/commit/?id=376d18b5d)

* config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/mktemp.c, plugins/python/regress/iohelpers.h:

  Add mkdtempat() and mkostempsat() for systems without them.
  [[86c108b50]](https://git.sudo.ws/sudo/commit/?id=86c108b50)

* docs/sudoers.man.in, docs/sudoers.mdoc.in, include/sudo\_util.h,
  lib/util/secure\_path.c, lib/util/sudo\_conf.c,
  plugins/sudoers/regress/testsudoers/test11.out.ok,
  plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestamp.c:

  Use sudo\_secure\_open\_file() instead of sudo\_secure\_file() where
  possible. Both sudo\_secure\_open\_file() and sudo\_secure\_open\_dir() are
  now passed a struct stat pointer like sudo\_secure\_file() and
  sudo\_secure\_dir().
  [[88ac5e09b]](https://git.sudo.ws/sudo/commit/?id=88ac5e09b)

* include/sudo\_util.h, lib/util/mkdir\_parents.c, lib/util/secure\_path.c,
  lib/util/util.exp.in, plugins/sudoers/timestamp.c:

  Fix potential TOCTOU when creating time stamp directory and file.
  [[cbd52e705]](https://git.sudo.ws/sudo/commit/?id=cbd52e705)

* lib/util/mkdir\_parents.c:

  sudo\_mkdir\_parents: just use memcpy() to copy the path component. Using
  snprintf() for this is overkill, we need to do the same length check
  either way.
  [[8c482bfeb]](https://git.sudo.ws/sudo/commit/?id=8c482bfeb)

* lib/util/Makefile.in:

  regen
  [[e91620144]](https://git.sudo.ws/sudo/commit/?id=e91620144)

2022-09-20 Todd C. Miller

* lib/util/digest\_gcrypt.c:

  Quiet libgcrypt run-time warning about not being initialized. Fixes
  Debian bug #1019428 and Ubuntu bug #1397663.
  [[c823ca1e4]](https://git.sudo.ws/sudo/commit/?id=c823ca1e4)

* docs/sudoers.man.in, docs/sudoers.mdoc.in, plugins/sudoers/audit.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.h,
  plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Split log\_{input,output} into log\_{stdin,ttyin} and
  log\_{ttyout,stdout,stderr} If log\_input is set, log\_{stdin,ttyin} will
  be set as well. If log\_output is set, log\_{stdout,stderr,ttyout} will be
  set as well. This provides more fine-grained control over I/O logging
  and makes it possible to disable logging piped or redirected intput or
  output.
  [[ce387a684]](https://git.sudo.ws/sudo/commit/?id=ce387a684)

* LICENSE.md, include/protobuf-c/protobuf-c.h,
  lib/protobuf-c/protobuf-c.c:

  Update to protobuf-c 1.4.1 We already had all the relevant fixes so this
  is just cosmetic.
  [[4ee0caf07]](https://git.sudo.ws/sudo/commit/?id=4ee0caf07)

* src/load\_plugins.c:

  new\_container: no need to initialize container pointer in declaration.
  From Li zeming.
  [[7464b300d]](https://git.sudo.ws/sudo/commit/?id=7464b300d)

2022-09-15 Todd C. Miller

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Use tcpgid if passed from sudo front-end and use it in tty\_present().
  This can be used as another indicator that a terminal is present without
  having to open /dev/tty.
  [[498985632]](https://git.sudo.ws/sudo/commit/?id=498985632)

2022-09-07 Todd C. Miller

* config.h.in, configure.ac, include/sudo\_compat.h, include/sudo\_debug.h,
  include/sudo\_fatal.h, include/sudo\_lbuf.h, include/sudo\_util.h,
  lib/eventlog/eventlog.c, plugins/sudoers/check\_aliases.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/defaults.c, plugins/sudoers/logging.h,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke.h, plugins/sudoers/tsdump.c,
  plugins/sudoers/visudo.c, src/parse\_args.c,
  src/regress/noexec/check\_noexec.c, src/sudo.h:

  Move gcc-style **attribute** macros to config.h.in Renamed \_\_malloc ->
  sudo\_malloclike, \_\_printflike -> sudo\_printflike, \_\_printf0like ->
  sudo\_printf0like. Add sudo\_noreturn instead of
  **attribute**((**noreturn**)). We do not use stdnoreturn.h since it has
  been deprecated in C23 in favor of the [[noreturn]] attribute.
  [[304726a21]](https://git.sudo.ws/sudo/commit/?id=304726a21)

2022-09-13 Todd C. Miller

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in, docs/sudo.conf.man.in,
  docs/sudo.conf.mdoc.in, docs/sudo.man.in, docs/sudo.mdoc.in,
  docs/sudo\_logsrv.proto.man.in, docs/sudo\_logsrv.proto.mdoc.in,
  docs/sudo\_logsrvd.conf.man.in, docs/sudo\_logsrvd.conf.mdoc.in,
  docs/sudo\_logsrvd.man.in, docs/sudo\_logsrvd.mdoc.in,
  docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in,
  docs/sudo\_sendlog.man.in, docs/sudo\_sendlog.mdoc.in,
  docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in,
  docs/sudoers.man.in, docs/sudoers.mdoc.in,
  docs/sudoers\_timestamp.man.in, docs/sudoers\_timestamp.mdoc.in,
  docs/sudoreplay.man.in, docs/sudoreplay.mdoc.in, docs/visudo.man.in,
  docs/visudo.mdoc.in:

  Remove most uses of the deprecated Li macro which has no effect. Also
  fix some other incorrect markup.
  [[c34160807]](https://git.sudo.ws/sudo/commit/?id=c34160807)

2022-09-12 Todd C. Miller

* Makefile.in, lib/eventlog/Makefile.in, lib/iolog/Makefile.in,
  lib/util/Makefile.in, logsrvd/Makefile.in, plugins/python/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Use $(GREP) and $(EGREP) variables in Makefile.in files.
  [[a32641190]](https://git.sudo.ws/sudo/commit/?id=a32641190)

* :

  Merge pull request #177 from a1346054/fixes

  Makefile.in: replace `egrep` and fix target name
  [[f235390d1]](https://git.sudo.ws/sudo/commit/?id=f235390d1)

2022-09-12 a1346054

* Makefile.in:

  Fix incorrect makefile target name
  [[5c1c276e2]](https://git.sudo.ws/sudo/commit/?id=5c1c276e2)

* Makefile.in:

  Use `grep -E` instead of `egrep`
  [[6fac1f518]](https://git.sudo.ws/sudo/commit/?id=6fac1f518)

2022-09-11 Todd C. Miller

* docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in:

  Document apparmor\_profile, intercept\_verify, and update\_ticket.
  [[3194d1667]](https://git.sudo.ws/sudo/commit/?id=3194d1667)

* docs/sudo\_plugin\_python.man.in, docs/sudo\_plugin\_python.mdoc.in:

  Fix some of the markup to be more consistent with sudo\_plugin.mdoc.in.
  Also reword a few awkward phrases.
  [[5bcec0244]](https://git.sudo.ws/sudo/commit/?id=5bcec0244)

* docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in:

  Use correct markup of function arguments and struct members. Also remove
  most uses of the deprecated Li macro which has no effect.
  [[a7b200d01]](https://git.sudo.ws/sudo/commit/?id=a7b200d01)

* docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in:

  Move the init\_session() errstr description to where it belongs.
  [[3f6ffead0]](https://git.sudo.ws/sudo/commit/?id=3f6ffead0)

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Fix a typo
  [[b85f95cb3]](https://git.sudo.ws/sudo/commit/?id=b85f95cb3)

2022-09-07 Todd C. Miller

* plugins/sudoers/logging.c:

  log\_parse\_error: make errstr const to quiet a -Wwrite-strings warning
  [[d6c7abd42]](https://git.sudo.ws/sudo/commit/?id=d6c7abd42)

* plugins/sudoers/visudo.c:

  Add \_\_printf0like to visudo\_track\_error().
  [[89a40741b]](https://git.sudo.ws/sudo/commit/?id=89a40741b)

2022-09-06 Todd C. Miller

* plugins/sudoers/gram.y:

  Back out unintended change in last commit.
  [[7f169da83]](https://git.sudo.ws/sudo/commit/?id=7f169da83)

* plugins/sudoers/gram.y, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h:

  It is possibble for sudoerserrorf() to be called with a NULL format. So
  log\_parse\_error() needs to check fmt for NULL before using it.
  [[965e2a0c0]](https://git.sudo.ws/sudo/commit/?id=965e2a0c0)

2022-09-03 Todd C. Miller

* docs/UPGRADE.md:

  Mention how to restore the historic core resource limit behavior.
  [[67be67385]](https://git.sudo.ws/sudo/commit/?id=67be67385)

2022-09-02 Todd C. Miller

* NEWS:

  Update with latest changes.
  [[2815b77e4]](https://git.sudo.ws/sudo/commit/?id=2815b77e4)

2022-09-03 Todd C. Miller

* plugins/sudoers/audit.c:

  Set MODE\_POLICY\_INTERCEPTED for log\_subcmds too. This fixes a problem
  where sub-commands were not being logged to the remote log server, if
  configured. Since we don’t go through sudoers\_policy\_main() again for
  log\_subcmds, we set the flag in sudoers\_audit\_accept() instead. The
  reason this is complicated is that when I/O logging is enabled the
  initial accept message gets sent as part of the remote logging
  handshake. [GitHub issue
  #174](https://github.com/sudo-project/sudo/issues/174)
  [[02e92c2af]](https://git.sudo.ws/sudo/commit/?id=02e92c2af)

2022-09-02 Todd C. Miller

* docs/cvtsudoers.mdoc.in:

  Fix typo.
  [[21b48a303]](https://git.sudo.ws/sudo/commit/?id=21b48a303)

* plugins/sudoers/sudoers.c:

  Only check the admin flag file once in intercept mode.
  [[49e9e5eb8]](https://git.sudo.ws/sudo/commit/?id=49e9e5eb8)

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in:

  Document cvtsudoers CSV output format
  [[159bdb1cb]](https://git.sudo.ws/sudo/commit/?id=159bdb1cb)

2022-08-31 Todd C. Miller

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in:

  Document cvtsudoers JSON output format
  [[37ae66062]](https://git.sudo.ws/sudo/commit/?id=37ae66062)

2022-08-30 Todd C. Miller

* src/exec\_ptrace.c:

  Zero out register struct before calling ptrace\_getregs(). Quiets a
  spurious valgrind warning.
  [[a6472710e]](https://git.sudo.ws/sudo/commit/?id=a6472710e)

2022-08-29 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  intercept\_verify is fast, but the policy check is (relatively) slow.
  [[caa0408a8]](https://git.sudo.ws/sudo/commit/?id=caa0408a8)

* src/exec\_ptrace.c:

  Realloc the buffer used to store argv and envp as needed. We now store
  the vector immediately after the string table. It is possible for argv
  and its contents to be invalidated by realloc() when reading envp so we
  store the pointers as offsets until we are done allocating.
  [[817f63b05]](https://git.sudo.ws/sudo/commit/?id=817f63b05)

2022-08-28 Todd C. Miller

* src/exec\_ptrace.c, src/exec\_ptrace.h:

  ptrace\_verify\_post\_exec: use /proc/PID/cmdline and /proc/PID/environ
  There is no reason to read these directly from the tracee when we rely
  on /proc being mounted to access /proc/PID/exe.
  [[0d2f1c4a2]](https://git.sudo.ws/sudo/commit/?id=0d2f1c4a2)

* src/exec\_ptrace.c:

  Protect ptrace\_readv\_string() with #ifdef HAVE\_PROCESS\_VM\_READV
  [[234c56b87]](https://git.sudo.ws/sudo/commit/?id=234c56b87)

2022-08-25 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Rework the intercept section in “Preventing shell escapes”.
  [[922772c6c]](https://git.sudo.ws/sudo/commit/?id=922772c6c)

* .github/workflows/codeql-analysis.yml:

  Update CodeQL Action to v2 using current example config.
  [[351175eb2]](https://git.sudo.ws/sudo/commit/?id=351175eb2)

* lib/util/arc4random.c:

  Suppress PVS-Studio false positive.
  [[0af393e75]](https://git.sudo.ws/sudo/commit/?id=0af393e75)

* src/exec\_intercept.c:

  intercept\_check\_policy\_req: an empty argv[] is now supported
  [[2902ebe06]](https://git.sudo.ws/sudo/commit/?id=2902ebe06)

* config.h.in, configure, configure.ac, src/exec\_ptrace.c:

  Use process\_vm\_readv(2) and process\_vm\_writev(2) if available. This is
  faster than reading/writing from/to the remote process one word at a
  time using PTRACE\_PEEKDATA and PTRACE\_POKEDATA.
  [[14356c194]](https://git.sudo.ws/sudo/commit/?id=14356c194)

* plugins/sudoers/check.c:

  Skip all of check\_user() for intercept unless intercept\_authenticate
  set. Previously we were calling the PAM approval modules even in
  intercept mode which can take a lot of time. We may wish to make PAM
  approval configurable in intercept mode in the future.
  [[36747f89a]](https://git.sudo.ws/sudo/commit/?id=36747f89a)

* plugins/sudoers/sudoers.c:

  Only set MODE\_POLICY\_INTERCEPTED on subsequent policy checks. This fixes
  a bug where MODE\_POLICY\_INTERCEPTED was set too early if the intercept
  option was set globally in sudoers. It should only be set after the
  original command has executed.
  [[22dad3f59]](https://git.sudo.ws/sudo/commit/?id=22dad3f59)

2022-08-23 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  intercept\_verify also compares the environment. Also mention the
  overhead involved in checking things.
  [[966eae6bf]](https://git.sudo.ws/sudo/commit/?id=966eae6bf)

2022-08-22 Todd C. Miller

* src/exec\_ptrace.c:

  ptrace\_getregs: make compat check more generic No need to use different
  checks for mips and non-mips, the compiler will optimize away the
  superfluous check.
  [[3d995f7e5]](https://git.sudo.ws/sudo/commit/?id=3d995f7e5)

* src/preload.c:

  Correct type of sudoers\_audit. [GitHub issue
  #61](https://github.com/sudo-project/sudo/issues/61)
  [[4d58fc904]](https://git.sudo.ws/sudo/commit/?id=4d58fc904)

2022-08-20 Todd C. Miller

* src/sesh.c:

  Fix shadowed variable warning.
  [[a3a181df0]](https://git.sudo.ws/sudo/commit/?id=a3a181df0)

2022-08-19 Todd C. Miller

* src/exec\_ptrace.h:

  Fix shadowed variable warning on aarch64.
  [[c948717bd]](https://git.sudo.ws/sudo/commit/?id=c948717bd)

* src/regress/intercept/test\_ptrace.c:

  Quiet another -Wwrite-strings warning.
  [[8145ad12d]](https://git.sudo.ws/sudo/commit/?id=8145ad12d)

* src/exec\_ptrace.c:

  ptrace\_getregs: try to determine compat mode if caller doesn’t know. In
  ptrace\_verify\_post\_exec(), we don’t know whether the executable that is
  now running is a native or compat binary. In most cases ptrace\_getregs()
  will be able to figure it out for us.
  [[8eb619ac2]](https://git.sudo.ws/sudo/commit/?id=8eb619ac2)

* src/exec\_ptrace.c:

  ptrace\_intercept\_execve: fail syscall rather than killing process on
  error. If the execve(2) args are bogus pointers, we should just return
  an error instead of killing the process. For consistency with the
  kernel, convert EIO from ptrace(2) to EFAULT. Also convert some
  ptrace(2) warnings to debug printfs so sudo is less chatty.
  [[b2d8909c1]](https://git.sudo.ws/sudo/commit/?id=b2d8909c1)

2022-08-18 Todd C. Miller

* src/exec\_ptrace.c:

  Treat argv and closure->run\_argv of different sizes as a mismatch. If
  argv and closure->run\_argv match up to the point where we hit a NULL
  but one of them has additional entries, we still need to rewrite argv.
  [[9f552471b]](https://git.sudo.ws/sudo/commit/?id=9f552471b)

* src/exec\_ptrace.c:

  Handle the case where argc is 0 when allocating space for argv. We need
  to pass the pathname to the policy plugin in argv[0] so we must be sure
  to allocate space for it even if argc is 0.
  [[aef4a6188]](https://git.sudo.ws/sudo/commit/?id=aef4a6188)

* src/sudo\_intercept.c:

  copy\_vector: treat a NULL pointer as an empty vector. Linux execve(2)
  allows argv to be NULL so we must allocate an empty vector in this case
  and not return an error.
  [[76bd1bcc9]](https://git.sudo.ws/sudo/commit/?id=76bd1bcc9)

* src/exec\_preload.c:

  Update debug\_decl name for sudo\_preload\_dso -> sudo\_preload\_dso\_alloc
  change.
  [[48a9126a1]](https://git.sudo.ws/sudo/commit/?id=48a9126a1)

* src/exec\_intercept.c:

  Handle the case where argc is 0 when rebuilding argv. We need to pass
  the pathname to the policy plugin in argv[0] so we must be sure to
  allocate space for it even if argc is 0.
  [[bc5016296]](https://git.sudo.ws/sudo/commit/?id=bc5016296)

* src/exec\_ptrace.c:

  Handle sysconf(\_SC\_ARG\_MAX) failure, Coverity CID 276504.
  [[23fa22975]](https://git.sudo.ws/sudo/commit/?id=23fa22975)

* plugins/sudoers/match\_digest.c:

  Avoid a Coverity false positive.
  [[d65bcf2ab]](https://git.sudo.ws/sudo/commit/?id=d65bcf2ab)

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y:

  Remove cast from time\_t to int to avoid a Coverity false positive. The
  cast should not be required.
  [[81a3339df]](https://git.sudo.ws/sudo/commit/?id=81a3339df)

2022-08-11 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in,
  plugins/sudoers/group\_plugin.c:

  Use multilib rules to look for a 64-bit group plugin on failure. If
  sudo\_dso\_load() fails on a 64-bit system, try to load a 64-bit native
  version of the file using system-dependent multilib rules. If we don’t
  support multilib on the platform, check for a version of the file that
  ends in “64” before the .so suffix.
  [[158facf6d]](https://git.sudo.ws/sudo/commit/?id=158facf6d)

* docs/sudo\_plugin.man.in:

  regen
  [[68b26056f]](https://git.sudo.ws/sudo/commit/?id=68b26056f)

2022-08-08 Todd C. Miller

* plugins/sudoers/env.c, src/env\_hooks.c:

  In putenv(3) replacement reject a string with no ‘=’ or that starts with
  one.
  [[2f3afd14e]](https://git.sudo.ws/sudo/commit/?id=2f3afd14e)

2022-08-05 Todd C. Miller

* LICENSE.md:

  Update copyright year for embedded zlib.
  [[6e08fa9fb]](https://git.sudo.ws/sudo/commit/?id=6e08fa9fb)

2022-08-04 Todd C. Miller

* configure, configure.ac:

  Use our own arc4random() in preference to the glibc version. The glibc
  arc4random() may fail in chroot on older kernels and exit.
  [[a366c623f]](https://git.sudo.ws/sudo/commit/?id=a366c623f)

* lib/util/sudo\_dso.c:

  sudo\_dso\_load: restore original error for AIX on failure. For AIX, if
  dlopen() fails we try again with RTLD\_MEMBER set and a default member
  (shr.o or shr\_64.o). However, if that also fails, the user will receive
  a useless error message that doesn’t correspond to the actual problem.
  We now retry the original dlopen() if the fallback to RTLD\_MEMBER fails,
  which has the effect of restoring the original error message.
  [[9ebaabfdd]](https://git.sudo.ws/sudo/commit/?id=9ebaabfdd)

2022-08-02 Todd C. Miller

* :

  Merge pull request #165 from bdrung/xdg-current-desktop

  Add XDG\_CURRENT\_DESKTOP to initial\_keepenv\_table
  [[184f0a249]](https://git.sudo.ws/sudo/commit/?id=184f0a249)

* NEWS, configure, configure.ac:

  Sudo 1.9.12.
  [[b422ddea7]](https://git.sudo.ws/sudo/commit/?id=b422ddea7)

* docs/sudo\_plugin.mdoc.in, include/sudo\_plugin.h,
  plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stdout, src/exec.c:

  Bump the sudo plugin minor version. The “update\_ticket” entry was added
  to the settings list and the “intercept\_verify” entry was added to the
  command\_info list.
  [[9c61d7e6e]](https://git.sudo.ws/sudo/commit/?id=9c61d7e6e)

* docs/sudo.man.in, docs/sudo.mdoc.in, plugins/sudoers/check.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.h, src/parse\_args.c,
  src/sudo.c, src/sudo.h, src/sudo\_usage.h.in:

  Add a way to run a command without updating the cached credentials. This
  can also be used to test for whether or not the user’s credentials are
  currently cached.
  [[556dacf1f]](https://git.sudo.ws/sudo/commit/?id=556dacf1f)

* :

  Merge pull request #168 from likunyur/lky

  Remove unnecessary initialization and casts.
  [[2d94d329c]](https://git.sudo.ws/sudo/commit/?id=2d94d329c)

2022-08-01 Li zeming

* lib/iolog/hostcheck.c:

  iolog/hostcheck: These two parameters do not need to be initialized and
  assigned, the following code is directly assigned

  Signed-off-by: Li zeming <zeming@…>
  [[393d9997c]](https://git.sudo.ws/sudo/commit/?id=393d9997c)

* lib/util/arc4random.c:

  util/arc4random: (void\*) type pointer passing address could remove cast

  Signed-off-by: Li zeming <zeming@…>
  [[c27acf55e]](https://git.sudo.ws/sudo/commit/?id=c27acf55e)

2022-08-02 Todd C. Miller

* :

  Merge pull request #169 from kempstonjoystick/main

  Fix incorrect SHA384/512 digest calculation.
  [[210eb17cb]](https://git.sudo.ws/sudo/commit/?id=210eb17cb)

2022-08-02 Tim Shearer

* lib/util/sha2.c:

  Fix incorrect SHA384/512 digest calculation.

  Resolves an issue where certain message sizes result in an incorrect
  checksum. Specifically, when: (n\*8) mod 1024 == 896 where n is the file
  size in bytes.
  [[e4f08157b]](https://git.sudo.ws/sudo/commit/?id=e4f08157b)

2022-08-01 Todd C. Miller

* src/exec.c, src/selinux.c, src/sesh.c, src/sudo.c, src/sudo.h:

  Defer chdir(2) until sesh when running with SELinux. We need to be
  running with the correct security context or the chdir(2) may fail.
  [GitHub issue #160](https://github.com/sudo-project/sudo/issues/160).
  [[cf250354f]](https://git.sudo.ws/sudo/commit/?id=cf250354f)

2022-07-31 Todd C. Miller

* :

  Merge pull request #166 from c4rlo/patch-1

  visudo.c: add nvim (Neovim) to lineno\_editor list
  [[555474d3a]](https://git.sudo.ws/sudo/commit/?id=555474d3a)

2022-07-31 Carlo Teubner

* plugins/sudoers/visudo.c:

  visudo.c: add nvim (Neovim) to lineno\_editor list

  Neovim supports it: <https://neovim.io/doc/user/starting.html#-+>
  [[2b5dcf255]](https://git.sudo.ws/sudo/commit/?id=2b5dcf255)

2022-07-29 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Document the TOCTOU issue with intercept mode. Describe how
  intercept\_verify attempts to reduce the risk.
  [[4de5e12dd]](https://git.sudo.ws/sudo/commit/?id=4de5e12dd)

* etc/codespell.exclude, etc/codespell.ignore:

  Update a codespell exclude pattern.
  [[3eb6e7856]](https://git.sudo.ws/sudo/commit/?id=3eb6e7856)

* docs/sudoers.man.in, docs/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/policy.c, src/exec\_ptrace.c,
  src/sudo.c, src/sudo.h:

  Add intercept\_verify sudoers option to control execve(2) argument
  checking.
  [[3ce19efca]](https://git.sudo.ws/sudo/commit/?id=3ce19efca)

* src/exec\_ptrace.c:

  Use PTRACE\_EVENT\_EXEC to stop execution before return from execve(2). We
  can now verify that the arguments match what we accepted before the
  command actually runs. If there is a mismatch, the process is killed.
  Shell scripts must be handled specially since the path executed will be
  the interpreter, not the script name. Linux allows interpreters to be
  nested up to 4 deep.
  [[b80b012de]](https://git.sudo.ws/sudo/commit/?id=b80b012de)

* plugins/sudoers/sudoers.c:

  Only set MODE\_POLICY\_INTERCEPTED if we are running a command. Fixes an
  error with “sudo -l” when intercept is enabled globally.
  [[620a563b5]](https://git.sudo.ws/sudo/commit/?id=620a563b5)

2022-07-29 Benjamin Drung

* plugins/sudoers/env.c:

  Add XDG\_CURRENT\_DESKTOP to initial\_keepenv\_table

  Qt needs `XDG_CURRENT_DESKTOP` to be set to determine the correct theme.

  Since `DISPLAY` and `XAUTHORITY` are already in the default table of
  variables to preserve in the environment, just add `XDG_CURRENT_DESKTOP`
  to it.

  Bug: <https://launchpad.net/bugs/1958055> Signed-off-by: Benjamin Drung
  <bdrung@…>
  [[225feb386]](https://git.sudo.ws/sudo/commit/?id=225feb386)

2022-07-27 Todd C. Miller

* src/exec\_ptrace.c:

  The length returned by ptrace\_read\_string() include the NUL. We were
  wasting a extra byte in the string table for each entry.
  [[25513b4f3]](https://git.sudo.ws/sudo/commit/?id=25513b4f3)

2022-07-26 Todd C. Miller

* include/sudo\_compat.h, include/sudo\_util.h:

  Use gcc’s malloc attribute for malloc-like allocation functions.
  [[882990b1b]](https://git.sudo.ws/sudo/commit/?id=882990b1b)

* lib/util/mmap\_alloc.c:

  Avoid a Coverity positive.
  [[23ab31fce]](https://git.sudo.ws/sudo/commit/?id=23ab31fce)

* src/exec\_preload.c:

  fmtstr: add missing va\_end() for the overflow case Coverity CID 275335
  [[6c9b3c761]](https://git.sudo.ws/sudo/commit/?id=6c9b3c761)

* lib/util/sudo\_debug.c:

  Fix potential NULL pointer deference found by clang-analyzer.
  [[3421c8b6c]](https://git.sudo.ws/sudo/commit/?id=3421c8b6c)

* src/sudo.c, src/sudo\_intercept\_common.c:

  Quiet some harmless PVS-Studio warnings.
  [[f5dc739ea]](https://git.sudo.ws/sudo/commit/?id=f5dc739ea)

* src/exec\_intercept.c:

  Reject relative command paths if runcwd is not set. This is now treated
  as a policy rejection.
  [[de3d5fe93]](https://git.sudo.ws/sudo/commit/?id=de3d5fe93)

* src/exec\_intercept.c:

  intercept\_check\_policy: close saved\_dir before returning
  [[16ea0bb3f]](https://git.sudo.ws/sudo/commit/?id=16ea0bb3f)

* src/exec\_intercept.c:

  Change to runcwd during the policy check where possible. Otherwise,
  attempts to run “./command” from a shell with intercept set will fail if
  the current working directory is different from the main sudo process.
  [[3c1f3ef10]](https://git.sudo.ws/sudo/commit/?id=3c1f3ef10)

2022-07-25 Todd C. Miller

* include/sudo\_util.h, lib/util/mmap\_alloc.c, lib/util/util.exp.in,
  src/sudo\_intercept.c:

  For preload DSO make copies of cmnd, argv, envp and map them read-only.
  [[5516cdcd5]](https://git.sudo.ws/sudo/commit/?id=5516cdcd5)

* src/exec\_preload.c, src/sudo\_exec.h, src/sudo\_intercept.c,
  src/sudo\_intercept\_common.c:

  Use sudo\_mmap\_alloc functions in DSO-based intercept code.
  [[226a6cd75]](https://git.sudo.ws/sudo/commit/?id=226a6cd75)

* lib/util/snprintf.c:

  Use sudo\_mmap\_alloc functions instead of private versions. We no longer
  need to keep track of the allocation size.
  [[e43c964c4]](https://git.sudo.ws/sudo/commit/?id=e43c964c4)

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in,
  lib/util/mmap\_alloc.c, lib/util/util.exp.in:

  Add sudo\_mmap\_{alloc,allocarrary,strdup,free} functions. These allocate
  memory via mmap anonymous regions and store the mapped size immediately
  before the returned pointer as an unsigned long. They are intended to be
  used in cases where malloc(3) and free(3) are unsuitable due to concerns
  about corrupting global state in multi-threaded programs or signal
  handlers.
  [[fccf3c9c5]](https://git.sudo.ws/sudo/commit/?id=fccf3c9c5)

* src/sudo\_intercept.c:

  resolve\_path: skip non-regular files
  [[15fd62f0d]](https://git.sudo.ws/sudo/commit/?id=15fd62f0d)

* docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in:

  Sync with schema.OpenLDAP for user/group utf8 support.
  [[308a6c31d]](https://git.sudo.ws/sudo/commit/?id=308a6c31d)

* :

  Merge pull request #163 from Firstyear/20220725-sudo-ldap-schema

  Update sudoUser to be utf8 in ldap schemas
  [[36b603aa9]](https://git.sudo.ws/sudo/commit/?id=36b603aa9)

2022-07-25 William Brown

* docs/schema.OpenLDAP, docs/schema.iPlanet, docs/schema.olcSudo:

  Update sudoUser to be utf8 in ldap schemas

  In most unix-style LDAP servers, uid is a utf8 string defined by OID
  1.3.6.1.4.1.1466.115.121.1.15. However, sudoUser was defined as an IA5
  String (OID 1.3.6.1.4.1.1466.115.121.1.26) which meant that sudoUser
  could only represent a subset of possible values.

  In some cases when using sudoers.ldap, the uid from the machine which
  was utf8 was fed back into sudo which would then issue a search for
  sudoUsers. If this uid contained utf8 characters, the ldap server would
  refuse to match into sudoUsers because these were limited to IA5.

  This is a safe-forward upgrade as IA5 is a subset of UTF8 meaning that
  this change will not impact existing deployments and their rules.
  [[7f9ea23e7]](https://git.sudo.ws/sudo/commit/?id=7f9ea23e7)

2022-07-14 Todd C. Miller

* src/exec\_intercept.c, src/sudo.c:

  Make sure the plugin provides a command, argv and envp.
  [[75e97fd5b]](https://git.sudo.ws/sudo/commit/?id=75e97fd5b)

* lib/util/sudo\_debug.c, src/exec\_intercept.c, src/exec\_preload.c,
  src/exec\_ptrace.c, src/sudo\_intercept.c, src/sudo\_intercept\_common.c:

  Linux execve(2) allows argv or envp to be NULL. Add checks to make sure
  we don’t deference a NULL pointer.
  [[e5652fc65]](https://git.sudo.ws/sudo/commit/?id=e5652fc65)

2022-07-13 Todd C. Miller

* src/exec\_intercept.c:

  intercept\_check\_policy: add oom label and fix approval failure case. If
  the approval plugin fails we need to set the state to POLICY\_REJECT just
  like we do if the policy rejected the command.
  [[a5ac29219]](https://git.sudo.ws/sudo/commit/?id=a5ac29219)

2022-07-09 Todd C. Miller

* plugins/sudoers/cvtsudoers\_csv.c, plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/cvtsudoers\_merge.c,
  plugins/sudoers/def\_data.in, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/policy.c, src/apparmor.c:

  Fix a few whitespace issues.
  [[a2b0a8330]](https://git.sudo.ws/sudo/commit/?id=a2b0a8330)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Increase the realloc increment from 128 to 1024. The contents of the
  env\_add array should not include the leading “env=” prefix.
  [[e7b7fbaf6]](https://git.sudo.ws/sudo/commit/?id=e7b7fbaf6)

* plugins/sudoers/env.c:

  sudo\_putenv\_nodebug: require that the environment string include a ‘=’
  [[224d78993]](https://git.sudo.ws/sudo/commit/?id=224d78993)

2022-07-08 Todd C. Miller

* plugins/sudoers/visudo.c:

  If update\_defaults() fails, treat it as a parse error.
  [[fba81260a]](https://git.sudo.ws/sudo/commit/?id=fba81260a)

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Add additional PVS-studio suppression comments for generated code.
  [[3dc8497b4]](https://git.sudo.ws/sudo/commit/?id=3dc8497b4)

2022-07-07 Todd C. Miller

* plugins/sudoers/match\_command.c:

  Fix compilation error when SUDOERS\_NAME\_MATCH is defined.
  [[a7f9c8162]](https://git.sudo.ws/sudo/commit/?id=a7f9c8162)

* plugins/sudoers/match\_command.c:

  Fix a NOPASSWD issue with a non-existent command when fdexec=always In
  command\_matches\_all(), if the command is fully-qualified and open\_cmnd()
  return false, only treat it as an error if we are able to stat(2) the
  command. For “sudo ALL” a non-existent command is not an error.
  [[5a59ce159]](https://git.sudo.ws/sudo/commit/?id=5a59ce159)

* plugins/sudoers/regress/testsudoers/test18.sh:

  Quote ^foo$ on command line to protect it from the shell.
  [[41e7532c9]](https://git.sudo.ws/sudo/commit/?id=41e7532c9)

2022-07-05 Todd C. Miller

* lib/eventlog/regress/logwrap/check\_wrap.c,
  lib/util/regress/closefrom/closefrom\_test.c,
  lib/util/regress/fnmatch/fnm\_test.c,
  lib/util/regress/getgrouplist/getgrouplist\_test.c,
  lib/util/regress/glob/globtest.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/strsig/strsig\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/strtofoo/strtobool\_test.c,
  lib/util/regress/strtofoo/strtoid\_test.c,
  lib/util/regress/strtofoo/strtomode\_test.c,
  lib/util/regress/strtofoo/strtonum\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c, lib/util/regress/uuid/uuid\_test.c,
  logsrvd/regress/logsrvd\_conf/logsrvd\_conf\_test.c,
  plugins/python/regress/check\_python\_examples.c, src/exec\_ptrace.c:

  Add explicit include of unistd.h for getopt(3) and related variables.
  [[f6e4d2765]](https://git.sudo.ws/sudo/commit/?id=f6e4d2765)

2022-07-01 Todd C. Miller

* lib/util/timegm.c:

  In timegm() initialize tm\_isdst to 0 like tzcode does.
  [[42c6d9fb5]](https://git.sudo.ws/sudo/commit/?id=42c6d9fb5)

2022-07-04 Todd C. Miller

* :

  Merge pull request #161 from likunyur/lky

  sudoers/cvtsudoers: Remove the repeated ‘;’ from code
  [[fd0c5566a]](https://git.sudo.ws/sudo/commit/?id=fd0c5566a)

2022-07-04 Li kunyu

* src/sudo\_intercept\_common.c:

  src/send: Remove the repeated ‘;’ from code

  Signed-off-by: Li kunyu <kunyu@…>
  [[a9a164e71]](https://git.sudo.ws/sudo/commit/?id=a9a164e71)

* plugins/sudoers/cvtsudoers.c:

  sudoers/cvtsudoers: Remove the repeated ‘;’ from code

  Signed-off-by: Li kunyu <kunyu@…>
  [[a311180bb]](https://git.sudo.ws/sudo/commit/?id=a311180bb)

2022-06-30 Todd C. Miller

* include/intercept.pb-c.h, include/sudo\_event.h, src/exec\_intercept.c,
  src/exec\_intercept.h, src/intercept.pb-c.c, src/intercept.proto,
  src/sudo\_intercept\_common.c:

  Stop sending an InterceptResponse to a PolicyCheckRequest for
  log\_subcmds. There’s no real reason for the command to wait for sudo
  send back a response that will always be a PolicyAcceptMessage.
  [[3cd9c5f5e]](https://git.sudo.ws/sudo/commit/?id=3cd9c5f5e)

* plugins/sudoers/sudoers.c:

  sudoers\_main: defer setting return value until the end when running a
  command Otherwise, we could return success when there was an error from
  a system call or memory allocation failure.
  [[985a2261b]](https://git.sudo.ws/sudo/commit/?id=985a2261b)

* plugins/sudoers/audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Save the initial command run via sudo and use it when logging exit
  status. Otherwise, if we are in intercept mode or logging sub-commands
  the exit status will be logged with the wrong command.
  [[885abf48d]](https://git.sudo.ws/sudo/commit/?id=885abf48d)

2022-06-29 Todd C. Miller

* lib/zlib/zconf.h.in:

  Define \_LARGEFILE64\_SOURCE if \_FILE\_OFFSET\_BITS == 64. Fixes a
  -Wwrite-strings warning on 32-bit systems.
  [[3badff39c]](https://git.sudo.ws/sudo/commit/?id=3badff39c)

* lib/util/strsignal.c:

  Quiet another -Wwrite-strings warning.
  [[50813f816]](https://git.sudo.ws/sudo/commit/?id=50813f816)

* lib/protobuf-c/protobuf-c.c:

  Fix a clang analyzer 14 warning about a possible NULL deref.
  [[bfc624990]](https://git.sudo.ws/sudo/commit/?id=bfc624990)

2022-06-21 Todd C. Miller

* src/exec\_preload.c, src/sudo\_exec.h, src/sudo\_intercept\_common.c:

  sudo\_preload\_dso: make the envp function argument const This lets us fix
  an inappropriate cast in sudo\_intercept\_common.c.
  [[424fa7f2b]](https://git.sudo.ws/sudo/commit/?id=424fa7f2b)

2022-06-29 Todd C. Miller

* lib/iolog/Makefile.in, lib/logsrv/Makefile.in,
  lib/protobuf-c/Makefile.in, plugins/sudoers/Makefile.in,
  src/Makefile.in:

  Regenerate dependencies
  [[5f534979e]](https://git.sudo.ws/sudo/commit/?id=5f534979e)

* scripts/mkdep.pl:

  Do not check files generated by protbuf-c with PVS-Studio
  [[a14bef6a4]](https://git.sudo.ws/sudo/commit/?id=a14bef6a4)

* logsrvd/logsrv\_util.c, logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c,
  logsrvd/logsrvd\_queue.c, logsrvd/sendlog.c, logsrvd/tls\_client.c,
  plugins/sudoers/log\_client.c, src/sudo\_intercept\_common.c:

  Quiet some harmless PVS Studio warnings.
  [[b6151781c]](https://git.sudo.ws/sudo/commit/?id=b6151781c)

* logsrvd/logsrvd\_conf.c, logsrvd/sendlog.c:

  Use “unable to allocate memory” warning on malloc failure. This is
  consistent with the rest of the sudo source code.
  [[54ed54d94]](https://git.sudo.ws/sudo/commit/?id=54ed54d94)

* lib/eventlog/Makefile.in, lib/fuzzstub/Makefile.in,
  lib/iolog/Makefile.in, lib/iolog/host\_port.c, lib/logsrv/Makefile.in,
  lib/protobuf-c/Makefile.in, lib/util/Makefile.in, lib/util/getentropy.c,
  lib/util/roundup.c, logsrvd/iolog\_writer.c, logsrvd/logsrv\_util.c,
  logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c, logsrvd/logsrvd\_journal.c,
  logsrvd/logsrvd\_local.c, logsrvd/logsrvd\_queue.c,
  logsrvd/logsrvd\_relay.c, logsrvd/sendlog.c, logsrvd/tls\_client.c,
  logsrvd/tls\_init.c, plugins/sudoers/log\_client.c, src/Makefile.in,
  src/apparmor.c:

  Add missing PVS Studio Open Source comments. Also avoid checking
  protobuf-c source and protobuf-c generated files.
  [[3e21c8da5]](https://git.sudo.ws/sudo/commit/?id=3e21c8da5)

* lib/iolog/host\_port.c, lib/iolog/hostcheck.c, lib/util/roundup.c,
  logsrvd/iolog\_writer.c, logsrvd/logsrv\_util.c, logsrvd/logsrvd.c,
  logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c, logsrvd/logsrvd\_journal.c,
  logsrvd/logsrvd\_local.c, logsrvd/logsrvd\_queue.c,
  logsrvd/logsrvd\_relay.c, logsrvd/sendlog.c, logsrvd/sendlog.h,
  logsrvd/tls\_client.c, logsrvd/tls\_common.h, logsrvd/tls\_init.c,
  plugins/python/pyhelpers.h, plugins/python/regress/iohelpers.h,
  plugins/sudoers/log\_client.c:

  Use #include <config.h> not #include “config.h” for consistency.
  Otherwise, some compilers may do the wrong thing in a build dir if there
  is a config.h file in the source dir too.
  [[e5834bd40]](https://git.sudo.ws/sudo/commit/?id=e5834bd40)

2022-06-28 Todd C. Miller

* plugins/sudoers/group\_plugin.c:

  Update group\_plugin\_load() stub to match its prototype.
  [[38278640c]](https://git.sudo.ws/sudo/commit/?id=38278640c)

* configure, configure.ac, include/sudo\_iolog.h, lib/eventlog/eventlog.c,
  lib/eventlog/logwrap.c, lib/iolog/host\_port.c,
  lib/iolog/regress/host\_port/host\_port\_test.c,
  lib/iolog/regress/iolog\_mkpath/check\_iolog\_mkpath.c, lib/util/aix.c,
  lib/util/getgrouplist.c, lib/util/getopt\_long.c, lib/util/lbuf.c,
  lib/util/logfac.c, lib/util/logpri.c,
  lib/util/regress/progname/progname\_test.c, lib/util/snprintf.c,
  lib/util/sudo\_conf.c, lib/util/sudo\_debug.c, logsrvd/logsrvd\_conf.c,
  logsrvd/logsrvd\_local.c, logsrvd/logsrvd\_relay.c, logsrvd/sendlog.c,
  plugins/audit\_json/audit\_json.c, plugins/python/python\_convmessage.c,
  plugins/python/python\_plugin\_common.c,
  plugins/python/regress/check\_python\_examples.c,
  plugins/python/sudo\_python\_module.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/sudo\_auth.h,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_csv.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/defaults.c,
  plugins/sudoers/defaults.h, plugins/sudoers/editor.c,
  plugins/sudoers/env.c, plugins/sudoers/exptilde.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/insults.h,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/log\_client.c,
  plugins/sudoers/logging.c, plugins/sudoers/parse.c,
  plugins/sudoers/policy.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/regress/editor/check\_editor.c,
  plugins/sudoers/regress/exptilde/check\_exptilde.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/serialize\_list/check\_serialize\_list.c,
  plugins/sudoers/regress/unescape/check\_unesc.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoers\_hooks.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c,
  src/edit\_open.c, src/exec\_common.c, src/parse\_args.c,
  src/regress/noexec/check\_noexec.c, src/selinux.c, src/sudo.c,
  src/sudo\_edit.c, src/sudo\_intercept.c:

  Make sudo pass -Wwrite-strings
  [[13672f28d]](https://git.sudo.ws/sudo/commit/?id=13672f28d)

* configure, configure.ac:

  A typo prevented -Wno-deprecated-declarations from being used on macOS.
  [[b3a8cad34]](https://git.sudo.ws/sudo/commit/?id=b3a8cad34)

2022-06-27 Todd C. Miller

* src/preload.c:

  Fix missing prototype warning.
  [[0efd61620]](https://git.sudo.ws/sudo/commit/?id=0efd61620)

* lib/zlib/zconf.h.in:

  Define \_LFS64\_LARGEFILE, \_LARGEFILE64\_SOURCE if 64-bit or \_LARGE\_FILES
  set. autoconf does not define \_LARGEFILE64\_SOURCE by default but zlib
  expects it (its own configure script will define it). Fixes a missing
  prototype for crc32\_combine\_gen64() on AIX and HP-UX.
  [[89666e7c3]](https://git.sudo.ws/sudo/commit/?id=89666e7c3)

* configure, configure.ac, include/sudo\_iolog.h, include/sudo\_util.h,
  lib/iolog/host\_port.c, lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c,
  lib/iolog/regress/iolog\_json/check\_iolog\_json.c,
  lib/iolog/regress/iolog\_timing/check\_iolog\_timing.c,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.c,
  lib/util/regress/glob/globtest.c, lib/util/regress/mktemp/mktemp\_test.c,
  lib/util/strtoid.c, logsrvd/logsrvd.c, logsrvd/logsrvd\_relay.c,
  logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c, logsrvd/sendlog.c,
  plugins/python/pyhelpers.c, plugins/python/python\_plugin\_approval.c,
  plugins/python/python\_plugin\_approval\_multi.inc,
  plugins/python/python\_plugin\_audit.c,
  plugins/python/python\_plugin\_audit\_multi.inc,
  plugins/python/python\_plugin\_common.c,
  plugins/python/python\_plugin\_group.c, plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_io\_multi.inc,
  plugins/python/python\_plugin\_policy.c,
  plugins/python/regress/check\_python\_examples.c,
  plugins/python/sudo\_python\_module.c, plugins/sudoers/audit.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/iolog.c,
  plugins/sudoers/log\_client.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_stubs.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/stubs.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/timestr.c, plugins/sudoers/tsgetgrpw.h,
  plugins/sudoers/unesc\_str.c, src/copy\_file.c, src/exec\_ptrace.c,
  src/load\_plugins.c, src/net\_ifs.c, src/sudo.h, src/sudo\_intercept.c,
  src/sudo\_intercept\_common.c, src/sudo\_noexec.c:

  Make sudo pass -Wmissing-prototypes
  [[f5ac1317c]](https://git.sudo.ws/sudo/commit/?id=f5ac1317c)

* src/exec\_ptrace.c:

  Include inttypes.h if stdint.h is not present. [Bug
  #1035](https://bugzilla.sudo.ws/show_bug.cgi?id=1035)
  [[f43220930]](https://git.sudo.ws/sudo/commit/?id=f43220930)

2022-06-21 Todd C. Miller

* src/exec\_intercept.c:

  intercept\_write: remove unused CD\_USE\_PTRACE code. It is not possible to
  end up in intercept\_write when CD\_USE\_PTRACE is set.
  [[e9c269526]](https://git.sudo.ws/sudo/commit/?id=e9c269526)

* src/exec\_ptrace.c:

  readlink(2) does NUL-terminate the buffer, do it manually. Fixes a bug
  where the current working directory could include garbage in intercept
  mode using ptrace(2).
  [[33547702f]](https://git.sudo.ws/sudo/commit/?id=33547702f)

2022-06-20 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.11p3
  [[01a9e5a15]](https://git.sudo.ws/sudo/commit/?id=01a9e5a15)

* src/exec\_intercept.c, src/sudo\_intercept\_common.c:

  Set TCP\_NODELAY on the socket used for intercept IPC to reduce latency.
  On some systems, Nagle’s algorithm was delaying receipt of the data,
  causing commands with intercept or log\_subcmds to run slowly. Related to
  [Bug #1034](https://bugzilla.sudo.ws/show_bug.cgi?id=1034).
  [[332a6afe7]](https://git.sudo.ws/sudo/commit/?id=332a6afe7)

* src/sudo\_intercept\_common.c:

  Use blocking I/O when talking to the sudo process. Also check for
  EAGAIN/EINTR when reading the message size. Fixes a problem seen on AIX
  where recv\_intercept\_response() could fail unexpectedly. [Bug
  #1034](https://bugzilla.sudo.ws/show_bug.cgi?id=1034).
  [[b10201bdc]](https://git.sudo.ws/sudo/commit/?id=b10201bdc)

* src/exec\_intercept.c:

  Add debug printfs when send/recv return EAGAIN or EINTR. These are not
  actually errors but can help gain insight into what is going on and, in
  the case of EAGAIN, whether or not there may be a kernel resource
  starvation problem.
  [[8829c028d]](https://git.sudo.ws/sudo/commit/?id=8829c028d)

2022-06-14 Todd C. Miller

* plugins/sudoers/logging.c:

  log\_exit\_status: make local variables match struct evlog members.
  [[49c27f527]](https://git.sudo.ws/sudo/commit/?id=49c27f527)

2022-06-13 Todd C. Miller

* lib/util/getgrouplist.c:

  Quiet a compiler warning on macOS. The getgrouplist() groups array on
  macOS is int \* instead of gid\_t \*.
  [[5787da7b2]](https://git.sudo.ws/sudo/commit/?id=5787da7b2)

2022-06-12 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.11p2
  [[04746d0e6]](https://git.sudo.ws/sudo/commit/?id=04746d0e6)

2022-06-11 Todd C. Miller

* src/exec\_ptrace.h:

  Fix compilation on Linux/x32; [GitHub issue
  #158](https://github.com/sudo-project/sudo/issues/158)
  [[dfee181d1]](https://git.sudo.ws/sudo/commit/?id=dfee181d1)

2022-06-10 Todd C. Miller

* plugins/sudoers/policy.c:

  Fix pasto in comment after HAVE\_PRIV\_SET #endif
  [[1c00c7c23]](https://git.sudo.ws/sudo/commit/?id=1c00c7c23)

* include/sudo\_compat.h:

  Fix typo, we should define SSIZE\_MAXÂ if it is not defined.
  [[169e04982]](https://git.sudo.ws/sudo/commit/?id=169e04982)

2022-06-09 Todd C. Miller

* plugins/sudoers/env.c:

  Change black list -> blocklist This was missed in the previous
  conversion.
  [[6525436db]](https://git.sudo.ws/sudo/commit/?id=6525436db)

* plugins/sudoers/audit.c, plugins/sudoers/iolog.c,
  plugins/sudoers/log\_client.c, plugins/sudoers/log\_client.h,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/policy.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudoers.h:

  Save a pointer to the event\_alloc parameter in the plugin open function.
  That way we don’t need to pass event\_alloc around to the log client
  functions.
  [[d04810c4f]](https://git.sudo.ws/sudo/commit/?id=d04810c4f)

* lib/protobuf-c/protobuf-c.c:

  Fix regression with zero-length messages introduced in protobuf-c PR
  500.
  [[b6a645148]](https://git.sudo.ws/sudo/commit/?id=b6a645148)

2022-06-08 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.11p1
  [[d2bf3aad0]](https://git.sudo.ws/sudo/commit/?id=d2bf3aad0)

2022-06-07 Todd C. Miller

* src/exec\_pty.c:

  Make read and write events persistent and disable as needed. For the
  read callback, disable reader when the buffer is full. For the write
  callback, disable writer when the buffer is consumed.
  [[964bcfa2d]](https://git.sudo.ws/sudo/commit/?id=964bcfa2d)

* config.h.in, configure, configure.ac, src/sudo\_exec.h,
  src/sudo\_noexec.c:

  Check for SECCOMP\_MODE\_FILTER not SECCOMP\_SET\_MODE\_FILTER. This matches
  the actual prctl() call we use.
  [[7689b8718]](https://git.sudo.ws/sudo/commit/?id=7689b8718)

* :

  Merge pull request #157 from 0x2b3bfa0/improve-tag-spec-ebnf-docs

  Improve Tag\_Spec EBNF documentation
  [[fedcb99ee]](https://git.sudo.ws/sudo/commit/?id=fedcb99ee)

* logsrvd/logsrvd.c, logsrvd/logsrvd\_relay.c, logsrvd/sendlog.c:

  Treat EINTR in a callback like we do EAGAIN. We shouldn’t get EINTR in
  practice since we set SA\_RESTART when registering signal handlers but it
  doesn’t hurt to be consistent.
  [[161b01fcc]](https://git.sudo.ws/sudo/commit/?id=161b01fcc)

2022-06-07 Helio Machado

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Improve Tag\_Spec EBNF documentation
  [[d60b6c618]](https://git.sudo.ws/sudo/commit/?id=d60b6c618)

2022-06-07 Todd C. Miller

* :

  Merge pull request #156 from delroth/aarch64-build

  exec\_ptrace: fix missing sudo\_pt\_regs on aarch64
  [[7f98ae7d2]](https://git.sudo.ws/sudo/commit/?id=7f98ae7d2)

2022-06-07 Pierre Bourdon

* src/exec\_ptrace.h:

  exec\_ptrace: fix missing sudo\_pt\_regs on aarch64

  AArch64 already had an existing “user\_pt\_regs” struct and didn’t need a
  struct alias before the renaming to “sudo\_pt\_regs”. Make the code build
  again by adding the now missing alias.

  Fixes: 2eb8ff17
  [[d549adf04]](https://git.sudo.ws/sudo/commit/?id=d549adf04)

2022-06-07 Todd C. Miller

* :

  Merge pull request #154 from 0x2b3bfa0/fix-tag-spec-docs

  Add missing colon in Tag\_Spec documentation
  [[a4b2012c1]](https://git.sudo.ws/sudo/commit/?id=a4b2012c1)

* :

  Merge pull request #152 from particleflux/fix-sudoers-typo

  Fix typo in sudoers comment
  [[ab00d29ec]](https://git.sudo.ws/sudo/commit/?id=ab00d29ec)

2022-06-07 Helio Machado

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Add missing colon in Tag\_Spec documentation
  [[3405fac05]](https://git.sudo.ws/sudo/commit/?id=3405fac05)

2022-06-07 Stefan Linke

* plugins/sudoers/sudoers.in:

  Fix typo in sudoers comment

  Fix a typo in the sudoers comment about `maxseq` param.

  Introduced by 906eb19ece47023c659b4b3db2e7a6bb57dff0d9 in 1.9.11.
  [[a074d058e]](https://git.sudo.ws/sudo/commit/?id=a074d058e)

2022-06-06 Todd C. Miller

* lib/protobuf-c/protobuf-c.c:

  Only shift unsigned values to avoid implementation-specific behavior.
  This converts the arithmetic shifts to logical shifts.
  [[e4ea5ad8a]](https://git.sudo.ws/sudo/commit/?id=e4ea5ad8a)

* lib/protobuf-c/protobuf-c.c:

  Fix issue protobuf-c#499: unsigned integer overflow Signed-off-by:
  10054172 <hui.zhang@…>
  [[263fdc6b0]](https://git.sudo.ws/sudo/commit/?id=263fdc6b0)

* include/sudo\_event.h, lib/util/event\_select.c:

  Fix building with select (not poll) when fd\_set is not defined in
  sys/types.h. We can use a void \* for the fd\_set arrays and just add a
  cast when using the FD\_SET macros.
  [[b77cbb2e6]](https://git.sudo.ws/sudo/commit/?id=b77cbb2e6)

* src/exec\_pty.c:

  Reinstall the event handler if we get EAGAIN from read/write callback.
  The read and write events do not set SUDO\_EV\_PERSIST so we need to
  explicitly re-enable the event if there is still data to be read. [Bug
  #963](https://bugzilla.sudo.ws/show_bug.cgi?id=963).
  [[c2a131714]](https://git.sudo.ws/sudo/commit/?id=c2a131714)

* logsrvd/logsrvd.c, logsrvd/logsrvd\_relay.c, logsrvd/sendlog.c:

  If write(2) returns EAGAIN just re-enter the event loop. This is
  consistent with how we handle EAGAIN for read(2).
  [[db6fc237c]](https://git.sudo.ws/sudo/commit/?id=db6fc237c)

* docs/sudo\_plugin\_python.man.in, docs/sudo\_plugin\_python.mdoc.in:

  Document how setting ModulePath affects the Python search path. Also
  advise the user to use a unique prefix to avoid name space collisions
  with installed Python modules. [Bug
  #1031](https://bugzilla.sudo.ws/show_bug.cgi?id=1031).
  [[fcb5867f1]](https://git.sudo.ws/sudo/commit/?id=fcb5867f1)

* configure, configure.ac, docs/sudo\_plugin\_python.man.in,
  docs/sudo\_plugin\_python.mdoc.in:

  Add EXAMPLES variables for use in the man pages for the examples
  directory.
  [[96c3c2819]](https://git.sudo.ws/sudo/commit/?id=96c3c2819)

2022-06-04 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po:

  Updated translations from translationproject.org
  [[24522fb4e]](https://git.sudo.ws/sudo/commit/?id=24522fb4e)

* plugins/sudoers/po/hr.mo, po/hr.mo:

  Rebuild Croatian message catalog.
  [[258b504be]](https://git.sudo.ws/sudo/commit/?id=258b504be)

2022-06-03 Todd C. Miller

* .gitignore, .hgignore:

  Add new test binaries to the ignore files.
  [[4386be3d6]](https://git.sudo.ws/sudo/commit/?id=4386be3d6)

* po/cs.mo, po/cs.po:

  Updated translations from translationproject.org
  [[5cb94eb25]](https://git.sudo.ws/sudo/commit/?id=5cb94eb25)

* lib/protobuf-c/protobuf-c.c:

  Define WORDS\_BIGENDIAN on big endian systems. Instead of a configure
  check, we use endian.h (or a fallback).
  [[ac06fb7f2]](https://git.sudo.ws/sudo/commit/?id=ac06fb7f2)

* include/intercept.pb-c.h, include/log\_server.pb-c.h,
  include/protobuf-c/protobuf-c.h, lib/protobuf-c/protobuf-c.c,
  scripts/unanon:

  Update to protobuf-c 1.4.0
  [[71c07579b]](https://git.sudo.ws/sudo/commit/?id=71c07579b)

* logsrvd/logsrvd.c, plugins/sudoers/cvtsudoers\_csv.c:

  Quiet two clang analyzer false positives.
  [[aee276ea6]](https://git.sudo.ws/sudo/commit/?id=aee276ea6)

* src/exec\_intercept.c:

  Move a comment to the correct location.
  [[f19a71a3d]](https://git.sudo.ws/sudo/commit/?id=f19a71a3d)

* logsrvd/logsrvd.c:

  union sockaddr\_union: pass in sockaddr\_union \* instead of sockaddr \*.
  This eliminates the need for a few casts and is consistent with how
  create\_listener() is written.
  [[5012c7f97]](https://git.sudo.ws/sudo/commit/?id=5012c7f97)

* src/exec\_ptrace.c:

  Eliminate some dead stores that clang-analyzer complains about.
  [[898ca5054]](https://git.sudo.ws/sudo/commit/?id=898ca5054)

* src/exec\_ptrace.c:

  ptrace\_read\_vec: don’t try to free memory on the error path This is
  leftover from when ptrace\_read\_string() allocated its own memory.
  [[63e6973ad]](https://git.sudo.ws/sudo/commit/?id=63e6973ad)

* config.h.in, configure, configure.ac, src/sudo\_intercept.c:

  Avoid using vfork(2) in the DSO system(3) wrapper. Traditional vfork(2)
  semantics make it unsafe for use for more than just vfork(2) +
  execve(2).
  [[25a26f504]](https://git.sudo.ws/sudo/commit/?id=25a26f504)

2022-06-02 Todd C. Miller

* po/vi.mo, po/vi.po:

  Updated translations from translationproject.org
  [[06bf1be67]](https://git.sudo.ws/sudo/commit/?id=06bf1be67)

* NEWS:

  Mention sudo\_logsrvd.conf “log\_server” parsing fix.
  [[66909a483]](https://git.sudo.ws/sudo/commit/?id=66909a483)

* MANIFEST, logsrvd/Makefile.in,
  logsrvd/regress/logsrvd\_conf/sudo\_logsrvd.conf.1.in,
  logsrvd/regress/logsrvd\_conf/sudo\_logsrvd.conf.2.in,
  logsrvd/regress/logsrvd\_conf/tls/sudo\_logsrvd.conf.1.in,
  logsrvd/regress/logsrvd\_conf/tls/sudo\_logsrvd.conf.2.in:

  For logsrvd\_conf\_test include both tls and non-tls configs.
  [[2d6b9d22e]](https://git.sudo.ws/sudo/commit/?id=2d6b9d22e)

* MANIFEST, logsrvd/Makefile.in, logsrvd/regress/logsrvd\_conf/cacert.pem,
  logsrvd/regress/logsrvd\_conf/logsrvd\_cert.pem,
  logsrvd/regress/logsrvd\_conf/logsrvd\_conf\_test.c,
  logsrvd/regress/logsrvd\_conf/logsrvd\_dhparams.pem,
  logsrvd/regress/logsrvd\_conf/logsrvd\_key.pem,
  logsrvd/regress/logsrvd\_conf/sudo\_logsrvd.conf.1.in,
  logsrvd/regress/logsrvd\_conf/sudo\_logsrvd.conf.2.in:

  Add a simple regression test for logsrvd.conf parser. Unlike the parser
  fuzzer, this includes sample certs and keys. This test would have
  detected the BIO\_new\_file() bug in set\_dhparams().
  [[d7b2ff321]](https://git.sudo.ws/sudo/commit/?id=d7b2ff321)

* logsrvd/logsrvd\_conf.c:

  Fix inverted logic when setting server\_log. A value that starts with a
  ‘/’ should be treated as a path.
  [[0ca222aa8]](https://git.sudo.ws/sudo/commit/?id=0ca222aa8)

* plugins/audit\_json/Makefile.in, plugins/sample\_approval/Makefile.in:

  Use abs\_top\_builddir instead of `pwd`/$(top\_builddir).
  [[bec9603f3]](https://git.sudo.ws/sudo/commit/?id=bec9603f3)

2022-06-01 Todd C. Miller

* lib/util/regress/parse\_gids/parse\_gids\_test.c:

  Plug a memory leak.
  [[51b64780c]](https://git.sudo.ws/sudo/commit/?id=51b64780c)

* plugins/sudoers/parse\_ldif.c:

  Fix bug in last commit, need to reinitialize role to NULL.
  [[89b80ea69]](https://git.sudo.ws/sudo/commit/?id=89b80ea69)

* plugins/sudoers/parse\_ldif.c:

  Simplify the check for when we can reuse the previous user and host
  specs. This makes the code easier to read and quiets a cppcheck false
  positive.
  [[eb0135a93]](https://git.sudo.ws/sudo/commit/?id=eb0135a93)

* docs/Makefile.in:

  Install the plugin man pages in section 5 (or 4 for System V). The
  manual had the correct section in the text but was installed in the
  wrong directory.
  [[77a47affb]](https://git.sudo.ws/sudo/commit/?id=77a47affb)

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/ro.mo, plugins/sudoers/po/ro.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po, po/de.mo, po/de.po,
  po/eo.mo, po/eo.po, po/fr.mo, po/fr.po, po/hr.mo, po/hr.po, po/ko.mo,
  po/ko.po, po/pl.mo, po/pl.po, po/ro.mo, po/ro.po, po/uk.mo, po/uk.po:

  Updated translations from translationproject.org
  [[3074f64bd]](https://git.sudo.ws/sudo/commit/?id=3074f64bd)

* NEWS:

  Sudo now supports intercepting system(3).
  [[4b5ee47e0]](https://git.sudo.ws/sudo/commit/?id=4b5ee47e0)

2022-05-31 Todd C. Miller

* plugins/sudoers/log\_client.c:

  Only display “unable to connect to log server” warning once. Previously,
  in intercept mode, if the log server is unreachable the message would be
  printed for each sub-command.
  [[c20c3b563]](https://git.sudo.ws/sudo/commit/?id=c20c3b563)

* src/exec.c, src/exec\_monitor.c, src/exec\_nopty.c, src/sudo\_exec.h:

  When using ptrace(2), push the point where we suspend into exec\_cmnd().
  This should reduce the amount of time the child has to wait for the
  parent to use PTRACE\_SEIZE to seize control and then PTRACE\_CONT to
  continue the child.
  [[de4d53e48]](https://git.sudo.ws/sudo/commit/?id=de4d53e48)

* config.h.in, configure, configure.ac, src/sudo\_intercept.c:

  Add configure check for vfork(2) and fall back to fork(2) if missing.
  [[cec83a05a]](https://git.sudo.ws/sudo/commit/?id=cec83a05a)

* docs/sudo.conf.man.in, docs/sudo.conf.mdoc.in, docs/sudoers.man.in,
  docs/sudoers.mdoc.in, src/intercept.exp.in, src/sudo\_intercept.c:

  Add support for intercepting the system(3) function. This also means we
  can log system(3) with log\_subcmds.
  [[f52342031]](https://git.sudo.ws/sudo/commit/?id=f52342031)

* include/compat/endian.h:

  Newer compilers define **BYTE\_ORDER** and **ORDER*{BIG,LITTLE}*ENDIAN**
  Also add riscv the little endian list.
  [[436deda08]](https://git.sudo.ws/sudo/commit/?id=436deda08)

2022-05-29 Todd C. Miller

* configure, configure.ac:

  On AIX, fmemopen(3) has a bug where feof() returns false at EOF. See
  <https://www.ibm.com/support/pages/apar/IJ11845>
  [[1c8316162]](https://git.sudo.ws/sudo/commit/?id=1c8316162)

2022-05-27 Todd C. Miller

* plugins/sudoers/defaults.c:

  Fix potential signed integer overflow on 32-bit CPUs. Converting
  fractional minutes to nanoseconds could overflow a 32-bit integer, use
  long long instead.
  [[dc8311dae]](https://git.sudo.ws/sudo/commit/?id=dc8311dae)

* plugins/sudoers/Makefile.in:

  Fix path to example sudoers file, it is now in the build dir.
  [[93916fde4]](https://git.sudo.ws/sudo/commit/?id=93916fde4)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  init\_options: initialize apparmor\_profile to NULL
  [[b497d7454]](https://git.sudo.ws/sudo/commit/?id=b497d7454)

* NEWS:

  Update with latest 1.9.11 changes.
  [[c1934a636]](https://git.sudo.ws/sudo/commit/?id=c1934a636)

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Fix typo
  [[6eda28ef5]](https://git.sudo.ws/sudo/commit/?id=6eda28ef5)

* docs/CONTRIBUTORS.md:

  Update contributors.
  [[789bc6ec8]](https://git.sudo.ws/sudo/commit/?id=789bc6ec8)

* logsrvd/tls\_init.c:

  Fix uninitialized use of ca\_store when building with wolfSSL.
  [[15f167c3a]](https://git.sudo.ws/sudo/commit/?id=15f167c3a)

* docker/debian/testing/Dockerfile, docker/ubuntu/devel/Dockerfile,
  docker/ubuntu/latest/Dockerfile, docker/ubuntu/rolling/Dockerfile:

  Newer Debian/Ubuntu uses libsepol-dev not libsepol1-dev.
  [[7125a9cc2]](https://git.sudo.ws/sudo/commit/?id=7125a9cc2)

2022-05-26 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update .pot files for 1.9.11
  [[346e63cd7]](https://git.sudo.ws/sudo/commit/?id=346e63cd7)

2022-05-27 Todd C. Miller

* configure, configure.ac, plugins/sudoers/def\_data.h,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/toke.c,
  src/Makefile.in:

  Regenerate files after merging AppArmor integration.
  [[9bb288d10]](https://git.sudo.ws/sudo/commit/?id=9bb288d10)

* :

  Merge pull request #148 from kernelmethod/apparmor\_support

  Add AppArmor support to sudo
  [[402fc832f]](https://git.sudo.ws/sudo/commit/?id=402fc832f)

* :

  Merge branch ‘main’ into apparmor\_support
  [[f16754a1d]](https://git.sudo.ws/sudo/commit/?id=f16754a1d)

2022-05-26 Todd C. Miller

* src/sudo\_intercept.c:

  Pass envp, not environ, to real execve() from exec\_wrapper() if
  possible. The replacement execve() function was passing the global
  environ to exec\_wrapper() instead of the envp parameter. This caused the
  command to be run with the wrong environment on AIX systems, and
  possibly others, when intercept or log\_subcmds was enabled. [Bug
  #1030](https://bugzilla.sudo.ws/show_bug.cgi?id=1030).
  [[dc2b28d3e]](https://git.sudo.ws/sudo/commit/?id=dc2b28d3e)

* src/exec\_ptrace.c:

  Consolidate some translatable strings.
  [[b6ddf3db6]](https://git.sudo.ws/sudo/commit/?id=b6ddf3db6)

* logsrvd/logsrvd.c, logsrvd/logsrvd\_journal.c, logsrvd/logsrvd\_relay.c,
  logsrvd/sendlog.c, plugins/sudoers/log\_client.c, src/exec\_intercept.c:

  Standardize protobuf “unable to unpack” warning messages.
  [[38c6e1bff]](https://git.sudo.ws/sudo/commit/?id=38c6e1bff)

* docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h,
  plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stdout, src/exec.c:

  Bump plugin minor version and document new intercept-related settings.
  There should have been a minor version bump for sudo 1.9.8 when
  intercept was originally implemented.
  [[9ac42292d]](https://git.sudo.ws/sudo/commit/?id=9ac42292d)

2022-05-25 Todd C. Miller

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Reset intercept\_allow\_setid if intercept\_type changes from trace to dso.
  But only reset intercept\_allow\_setid if the user didn’t explicitly set
  it.
  [[6ced49a34]](https://git.sudo.ws/sudo/commit/?id=6ced49a34)

2022-05-24 Todd C. Miller

* etc/sudo-logsrvd.pp, etc/sudo-python.pp, etc/sudo.pp:

  CentOS Stream only uses a major version number, no minor version. This
  prevents the packages from being created as foo.el.arch.rpm since we
  were assuming that the version number was two digits.
  [[deef5e57f]](https://git.sudo.ws/sudo/commit/?id=deef5e57f)

* src/exec\_ptrace.c, src/exec\_ptrace.h:

  Add support for running o32 and n32 binaries on mips64.
  [[d6be44db0]](https://git.sudo.ws/sudo/commit/?id=d6be44db0)

* src/exec\_ptrace.c, src/exec\_ptrace.h, src/sudo\_exec.h:

  Enable ptrace support for MIPS but only for log\_subcmds. It is not
  possible to change the syscall return value on MIPS so we cannot support
  full intercept mode. Another complication on MIPS is that if a system
  call is invoked via syscall(\_*NR*###), v0 holds \_\_NR\_O32\_Linux and the
  real syscall is in the first arg (a0) and other args are shifted by one.
  [[bc6a0e1a1]](https://git.sudo.ws/sudo/commit/?id=bc6a0e1a1)

* docs/sudoers.man.in, docs/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h, src/exec\_ptrace.c, src/parse\_args.c,
  src/sudo.c, src/sudo.h, src/sudo\_exec.h:

  Add intercept\_type sudoers option to set intercept/log\_subcmds
  mechanism.
  [[f053f174b]](https://git.sudo.ws/sudo/commit/?id=f053f174b)

2022-05-23 kernelmethod

* INSTALL.md, docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Add documentation for AppArmor support

  + Document the AppArmor userspec option in the sudoers man pages. - Add
    information about the –with-apparmor build configuration option to
    INSTALL.md.
    [[d8184fdb6]](https://git.sudo.ws/sudo/commit/?id=d8184fdb6)

2022-05-22 kernelmethod

* docker/debian/latest/Dockerfile, docker/debian/testing/Dockerfile,
  docker/ubuntu/devel/Dockerfile, docker/ubuntu/latest/Dockerfile,
  docker/ubuntu/rolling/Dockerfile:

  Add libapparmor-dev to the Debian and Ubuntu Dockerfiles

  Install libapparmor-dev on Debian- and Ubuntu-based Docker images so
  that they can build sudo with AppArmor support.
  [[58ce33aba]](https://git.sudo.ws/sudo/commit/?id=58ce33aba)

2022-05-23 kernelmethod

* plugins/sudoers/check.c, plugins/sudoers/cvtsudoers\_csv.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/cvtsudoers\_merge.c, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/gram.y,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/policy.c, plugins/sudoers/regress/fuzz/fuzz\_policy.dict,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.dict,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/toke.l:

  Add an APPARMOR\_PROFILE user spec option to sudoers

  sudoers now supports an APPARMOR\_PROFILE option, which can be specified
  as e.g.

  alice ALL=(ALL:ALL) APPARMOR\_PROFILE=foo ALL

  The line above says “user alice can run any command as any user/group,
  under confinement by the AppArmor profile ‘foo’.” Profiles can be
  specified in any way that complies with the rules of
  aa\_change\_profile(2). For instance, the sudoers configuration

  alice ALL=(ALL:ALL) APPARMOR\_PROFILE=unconfined ALL

  allows alice to run any command unconfined (i.e., without an AppArmor
  profile), while

  alice ALL=(ALL:ALL) APPARMOR\_PROFILE=foo//&bar ALL

  tells sudoers that alice can run any command under the stacked AppArmor
  profiles ‘foo’ and ‘bar’.

  The intention of this option is to give sysadmins on Linux distros
  supporting AppArmor better options for fine-grained access control.
  Among other things, this option can enforce mandatory access control
  (MAC) over the operations that a privileged user is able to perform to
  ensure that they cannot privesc past the boundaries of a specified
  profile. It can also be used to limit which users are able to get
  unconfined system access, by enforcing a default AppArmor profile on all
  users and then specifying ‘APPARMOR\_PROFILE=unconfined’ for a privileged
  subset of users.
  [[c20859d55]](https://git.sudo.ws/sudo/commit/?id=c20859d55)

* MANIFEST, include/sudo\_debug.h, src/Makefile.in, src/apparmor.c,
  src/parse\_args.c, src/sudo.c, src/sudo.h:

  Add an apparmor\_profile sudo setting

  Define a new sudo setting, `apparmor_profile`, that can be used to pass
  in an AppArmor profile that should be used to confine commands. If
  apparmor\_profile is specified, sudo will execute the command using the
  new `apparmor_execve` function, which confines the command under the
  provided profile before exec’ing it.
  [[bd25b85a6]](https://git.sudo.ws/sudo/commit/?id=bd25b85a6)

* config.h.in, configure.ac, scripts/mkdep.pl, scripts/mkpkg:

  Add a –with-apparmor build flag

  Add a new build flag, –with-apparmor, that builds sudo with AppArmor
  support. Modify the build script for Debian and Ubuntu to enable this
  flag by default.
  [[0b541c202]](https://git.sudo.ws/sudo/commit/?id=0b541c202)

2022-05-19 Todd C. Miller

* src/exec\_nopty.c, src/exec\_pty.c:

  Pass the WUNTRACED flag to waitpid() even if \_\_WALL is present.
  Otherwise, we won’t get the wait status of a suspended command that is
  not being traced.
  [[b20375301]](https://git.sudo.ws/sudo/commit/?id=b20375301)

* configure, configure.ac, lib/iolog/Makefile.in, lib/logsrv/Makefile.in,
  logsrvd/Makefile.in, plugins/sudoers/Makefile.in:

  Use explicit library dependencies instead of implicit. We now include
  all the dependent libraries when linking. Fixes a linking problem on
  CentOS Stream 9.
  [[583e8bf53]](https://git.sudo.ws/sudo/commit/?id=583e8bf53)

* plugins/sudoers/logging.c:

  mail\_parse\_errors: allocate the correct amount of space for mail body.
  Use strlen(), not sizeof(), on “problem parsing sudoers” since it is a
  tranlated string and not a constant. This was caught by the existing
  overflow checks.
  [[0b63af91b]](https://git.sudo.ws/sudo/commit/?id=0b63af91b)

2022-05-18 Todd C. Miller

* MANIFEST, src/Makefile.in, src/exec\_nopty.c, src/exec\_pty.c,
  src/regress/intercept/test\_ptrace.c, src/sudo\_exec.h,
  src/suspend\_nopty.c:

  Move code to suspend sudo when no pty is in use to separate file. Use
  this in test\_ptrace.c to be able to suspend just like sudo does.
  [[0ea431e39]](https://git.sudo.ws/sudo/commit/?id=0ea431e39)

2022-05-17 Todd C. Miller

* src/exec\_nopty.c, src/exec\_ptrace.c, src/exec\_pty.c,
  src/regress/intercept/test\_ptrace.c, src/sudo\_exec.h:

  Fix suspending a sudo-run shell in ptrace intercept mode with no pty.
  When ptracing a process, we receive the signal-delivery-stop signal
  before the group-stop signal. If sudo is running the command in the same
  terminal, we need to wait until the stop signal is actually delivered to
  the command before we can suspend sudo itself. If we suspend sudo before
  receiving the group-stop, the command will be restarted with
  PTRACE\_LISTEN too late and will miss the SIGCONT from sudo.
  [[a52e3776f]](https://git.sudo.ws/sudo/commit/?id=a52e3776f)

* docs/TROUBLESHOOTING.md, docs/sudo\_logsrvd.man.in,
  docs/sudo\_logsrvd.mdoc.in:

  OpenSSL 3.x requires the key usage extension be present in CA and certs.
  Certificates generated with a CA that doesn’t set the key usage
  extension will fail to validate if “tls\_verify” is enabled.
  [[0bcfe6184]](https://git.sudo.ws/sudo/commit/?id=0bcfe6184)

* logsrvd/tls\_init.c:

  Include the cert or ca file in error messages where applicable.
  [[69fa04f06]](https://git.sudo.ws/sudo/commit/?id=69fa04f06)

* logsrvd/tls\_init.c:

  Add missing include of string.h for strerror(3).
  [[a82fe9aa0]](https://git.sudo.ws/sudo/commit/?id=a82fe9aa0)

* logsrvd/logsrvd.c, logsrvd/logsrvd\_relay.c, logsrvd/sendlog.c,
  logsrvd/tls\_client.c, logsrvd/tls\_init.c, plugins/sudoers/log\_client.c:

  If ERR\_reason\_error\_string() returns NULL, fall back on strerror(errno).
  That way we get reasonable error messages for missing files, etc.
  [[d7df7abf8]](https://git.sudo.ws/sudo/commit/?id=d7df7abf8)

* logsrvd/tls\_init.c:

  set\_dhparams: pass BIO\_new\_file() “r” for the file mode, not O\_RDONLY.
  Unlike BIO\_new\_fp(), BIO\_new\_file() takes an fopen-style mode string.
  [[3ba807b70]](https://git.sudo.ws/sudo/commit/?id=3ba807b70)

* src/exec\_ptrace.c:

  The set\_sc\_arg3, get\_sc\_arg3 and set\_sc\_arg4 functions are not used. Use
  ifdef notyet to disable for now since they may be used in the future.
  [[161a97260]](https://git.sudo.ws/sudo/commit/?id=161a97260)

2022-05-16 Todd C. Miller

* src/exec\_ptrace.h, src/sudo\_exec.h:

  Use **x86\_64** preprocessor symbol, not **amd64** Also clarify a comment
  about MIPS ptrace.
  [[0bfbef016]](https://git.sudo.ws/sudo/commit/?id=0bfbef016)

* src/exec\_ptrace.h, src/sudo\_exec.h:

  ptrace support has been tested on Debian/s390x. It should also work on
  s390 but this has not been tested. I have not added a compat mode to
  trace 31-bit binaries on s390x due to the lack of a test system.
  [[7329a4a86]](https://git.sudo.ws/sudo/commit/?id=7329a4a86)

* src/exec\_ptrace.h:

  Define sudo\_pt\_regs instead of user\_pt\_regs and include the struct
  keyword. On s390, the struct is typedef’d without a name.
  [[2eb8ff17b]](https://git.sudo.ws/sudo/commit/?id=2eb8ff17b)

* src/exec\_ptrace.h, src/sudo\_exec.h:

  ptrace support has been tested on Debian/riscv64.
  [[74c6353a8]](https://git.sudo.ws/sudo/commit/?id=74c6353a8)

2022-05-15 Todd C. Miller

* plugins/sudoers/sudoers.in:

  Add maxseq setting to log\_output example. This should make it more
  obvious that you need to adjust maxseq unless you have (virtually)
  unlimited disk space.
  [[906eb19ec]](https://git.sudo.ws/sudo/commit/?id=906eb19ec)

* scripts/mkpkg:

  Fix dependency check for libssl on Debian/Ubuntu with OpenSSL 3. Also
  add check for python 3.10 and 3.11 and remove versions < 3.4. Fixes
  building on Ubuntu 22.04.
  [[b61a55eb1]](https://git.sudo.ws/sudo/commit/?id=b61a55eb1)

2022-05-14 Todd C. Miller

* src/exec\_ptrace.h:

  Tracing 32-bit arm binaries from a 64-bit sudo works.
  [[55bd6272c]](https://git.sudo.ws/sudo/commit/?id=55bd6272c)

* src/exec\_ptrace.c:

  ptrace\_write\_string: the terminating NUL fix was reverted by mistake.
  [[3238c43f9]](https://git.sudo.ws/sudo/commit/?id=3238c43f9)

* src/exec\_ptrace.h, src/sudo\_exec.h:

  ptrace-based intercept has now been tested on 32-bit arm
  [[cb95b75ff]](https://git.sudo.ws/sudo/commit/?id=cb95b75ff)

2022-05-13 Todd C. Miller

* src/exec\_ptrace.h:

  Don’t use PTRACE\_SET\_SYSCALL for 32-bit arm binaries running on aarch64.
  Use PTRACE\_SETREGSET with NT\_ARM\_SYSTEM\_CALL instead just like we would
  for a 64-bit binary. Newer Linux headers don’t define PTRACE\_SET\_SYSCALL
  for aarch64.
  [[bb3c4ba07]](https://git.sudo.ws/sudo/commit/?id=bb3c4ba07)

* src/regress/intercept/test\_ptrace.c:

  Replace verbose flag with debug flag. This is more accurate since it
  actually uses the debug subsystem.
  [[6a196190c]](https://git.sudo.ws/sudo/commit/?id=6a196190c)

* src/exec\_ptrace.h:

  Initial cut at MIPS support, untested. Mips is a bit different in that
  most Linux distros appear to use the n32 ABI on 64-bit CPUs. We don’t
  currently support tracing a 64-bit binary from a 32-bit sudo. We could
  suport tracing o32 ABI binaries in compat mode, though.
  [[3226c2df4]](https://git.sudo.ws/sudo/commit/?id=3226c2df4)

2022-05-12 Todd C. Miller

* src/regress/intercept/test\_ptrace.c:

  Add have\_seccomp\_action(“trap”) call to check for SECCOMP\_MODE\_FILTER.
  [[f4cc99c06]](https://git.sudo.ws/sudo/commit/?id=f4cc99c06)

* src/exec\_ptrace.c, src/exec\_ptrace.h:

  Add arm-specific code to set the system call number. Fixes rejection of
  commands due to policy on arm when in intercept mode.
  [[b99debf92]](https://git.sudo.ws/sudo/commit/?id=b99debf92)

* scripts/mkpkg:

  Fix OS major version detection on CentOS Stream
  [[4a7d26c38]](https://git.sudo.ws/sudo/commit/?id=4a7d26c38)

* src/exec\_ptrace.c:

  ptrace\_intercept\_execve: read back the updated syscall args in test
  mode. This makes it easier to detect problems with the syscall rewrite
  code when testing with test\_ptrace.
  [[ea2bf7f1f]](https://git.sudo.ws/sudo/commit/?id=ea2bf7f1f)

* src/exec\_ptrace.c:

  Repair ptrace\_write\_vec() for compat binaries.
  [[4ecada04a]](https://git.sudo.ws/sudo/commit/?id=4ecada04a)

* src/regress/intercept/test\_ptrace.c:

  Fix a crash when not run in verbose mode.
  [[0f104d2ff]](https://git.sudo.ws/sudo/commit/?id=0f104d2ff)

2022-05-11 Todd C. Miller

* src/exec\_ptrace.c:

  Fix compilation error on systems with no compat arch. Currently only
  affects i386.
  [[f94e5d40d]](https://git.sudo.ws/sudo/commit/?id=f94e5d40d)

* src/exec\_ptrace.c:

  Move code to write a string vector to ptrace\_write\_vec().
  [[64aba8f88]](https://git.sudo.ws/sudo/commit/?id=64aba8f88)

* src/exec\_ptrace.c:

  Fix tracing compat binaries on big endian systems. We need to swap the
  order of the two 32-bit addresses for big-endian.
  [[55f5e389b]](https://git.sudo.ws/sudo/commit/?id=55f5e389b)

* src/exec\_ptrace.c, src/exec\_ptrace.h, src/sudo\_exec.h:

  Enable ptrace intercept on powerpc. Tested on ppc64 and ppc64le.
  [[31e8506c8]](https://git.sudo.ws/sudo/commit/?id=31e8506c8)

* MANIFEST, src/Makefile.in, src/exec\_intercept.h, src/exec\_ptrace.c,
  src/regress/intercept/test\_ptrace.c, src/sudo\_exec.h:

  Add test\_ptrace program to test ptrace-based intercept support.
  [[040e75a07]](https://git.sudo.ws/sudo/commit/?id=040e75a07)

* src/exec\_ptrace.c:

  Use unsigned long for addresses so we don’t have to worry about sign
  extension.
  [[532e8218b]](https://git.sudo.ws/sudo/commit/?id=532e8218b)

2022-05-10 Todd C. Miller

* src/exec\_ptrace.c:

  ptrace\_write\_string: make sure we always write the terminating NUL. We
  can’t check \*str for NUL since it may not have been written yet.
  [[6cd461d9f]](https://git.sudo.ws/sudo/commit/?id=6cd461d9f)

* src/exec\_ptrace.c:

  Fix compilation error when SECCOMP\_AUDIT\_ARCH\_COMPAT is not defined.
  [[8fe123867]](https://git.sudo.ws/sudo/commit/?id=8fe123867)

2022-05-09 Todd C. Miller

* src/exec\_ptrace.c, src/exec\_ptrace.h:

  It is now safe to make WORDALIGN use compat (not native) aligment. We
  allocate space for an extra pointer between argv and the string table
  for compat binaries so there is no need to align address to
  sizeof(long).
  [[a40d62b3d]](https://git.sudo.ws/sudo/commit/?id=a40d62b3d)

* src/exec\_ptrace.c, src/exec\_ptrace.h:

  Use the entire word in ptrace\_get\_vec\_len() and ptrace\_read\_vec(). For
  compat binaries, use the upper 32-bits as the next word instead of
  calling ptrace(2) to get it. This reduces the number of ptrace(2) calls
  when reading argv and envp for compat binaries.
  [[f82aa334c]](https://git.sudo.ws/sudo/commit/?id=f82aa334c)

2022-05-07 Todd C. Miller

* src/exec\_ptrace.c:

  We don’t need to align strings in the string table. We align the start
  of the string table to a word boundary to help prevent overlap when
  writing the pointers. However, the actual strings themselves don’t need
  to be aligned.
  [[c9a481506]](https://git.sudo.ws/sudo/commit/?id=c9a481506)

2022-05-06 Todd C. Miller

* src/exec\_ptrace.c:

  Avoid potentially overwriting string table when writing argv. In compat
  mode, if argc is odd, writing the last pointer of argv will overlap with
  the address of argv[0], so leave an extra word in between. Also remove
  incorrect comments about PTRACE\_PEEKDATA unaligned access.
  [[206cd10ed]](https://git.sudo.ws/sudo/commit/?id=206cd10ed)

2022-05-05 Todd C. Miller

* src/exec\_ptrace.c:

  ptrace\_intercept\_execve: rewrite path to exec if changed by the policy
  [[0a2975367]](https://git.sudo.ws/sudo/commit/?id=0a2975367)

2022-05-06 Todd C. Miller

* src/exec\_ptrace.c, src/exec\_ptrace.h:

  Use native word size for padding and when reading/writing strings. If we
  try to use the compat word size we can end up in a situation where a
  subsequent PTRACE\_POKEDATA overwrites part of what we’ve already written
  since it always writes in sizeof(long) units.
  [[a15ca9c85]](https://git.sudo.ws/sudo/commit/?id=a15ca9c85)

2022-05-05 Todd C. Miller

* src/exec\_ptrace.c:

  ptrace\_intercept\_execve: plug memory leak of get\_execve\_info() buffer
  [[339746730]](https://git.sudo.ws/sudo/commit/?id=339746730)

* MANIFEST, src/Makefile.in, src/exec\_intercept.h, src/exec\_ptrace.c,
  src/exec\_ptrace.h:

  Move register definitions to exec\_ptrace.h
  [[35ea534b3]](https://git.sudo.ws/sudo/commit/?id=35ea534b3)

* src/exec\_ptrace.c:

  Add support for intercepting 32-bit binaries on 64-bit systems. We need
  to define the ptrace register struct ourselves for the 32-bit system
  since there is no good way to get it from the system headers. Currently
  only implemented for x86\_64 and aarch64.
  [[d3a1bf421]](https://git.sudo.ws/sudo/commit/?id=d3a1bf421)

* src/exec\_ptrace.c:

  Add setters and getters for ptrace(2) register access. This will be used
  when running 32-bit binaries from a 64-bit sudo.
  [[de678ba77]](https://git.sudo.ws/sudo/commit/?id=de678ba77)

* src/exec\_ptrace.c:

  exec\_ptrace\_handled: don’t return early if ptrace\_intercept\_execve()
  fails. We need to continue the traced process even if there is a fatal
  error. Otherwise, sudo will appear to hang as the running process is
  left in PTRACE\_EVENT stop.
  [[f53053a66]](https://git.sudo.ws/sudo/commit/?id=f53053a66)

* src/exec\_ptrace.c:

  Don’t use PTRACE\_GETREGS, it is too complicated when runing compat
  binaries. Unlike PTRACE\_GETREGSET, PTRACE\_GETREGS requires that we
  manually map registers from 64-bit to 32-bit layouts when running, e.g.
  a 32-bit binary from a 64-bit sudo process.
  [[bbbb6e2ac]](https://git.sudo.ws/sudo/commit/?id=bbbb6e2ac)

2022-05-04 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in, plugins/sudoers/defaults.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.h, src/exec\_nopty.c,
  src/exec\_pty.c, src/parse\_args.c, src/sudo.c, src/sudo.h,
  src/sudo\_exec.h:

  Initialize intercept\_allow\_setid to true if we use ptrace(2) and
  seccomp(2).
  [[4ab6a87b9]](https://git.sudo.ws/sudo/commit/?id=4ab6a87b9)

2022-05-03 Todd C. Miller

* src/exec\_nopty.c, src/exec\_ptrace.c, src/exec\_pty.c, src/sudo\_exec.h:

  If the process is already being traced, just resume it and clear flags.
  This makes it possible to run sudo in ptrace intercept mode from within
  a shell (or other process) that is already being traced by sudo.
  [[e84fdd99f]](https://git.sudo.ws/sudo/commit/?id=e84fdd99f)

* src/exec\_ptrace.c:

  exec\_ptrace\_handled: fix delivery of non-stop signals. We need to
  deliver signals to the tracee as long as it is not a group stop. Fixes a
  hang while tracing another sudo process.
  [[cc52ab770]](https://git.sudo.ws/sudo/commit/?id=cc52ab770)

* src/exec\_nopty.c:

  Make SIGCHLD handler more consistent with the pty version. No real
  change other than a few debug statements.
  [[4cac34b86]](https://git.sudo.ws/sudo/commit/?id=4cac34b86)

* plugins/sudoers/parse.c:

  sudoers\_lookup\_check: preserve intercepted flag when reinitializing
  cmnd\_info Otherwise we may not reject an attempt to run a set-user-ID
  command.
  [[4d75b3279]](https://git.sudo.ws/sudo/commit/?id=4d75b3279)

* src/exec\_nopty.c, src/exec\_pty.c:

  Kill the command if intercept\_setup() or ptrace\_seize() fail.
  [[3ee8bcefb]](https://git.sudo.ws/sudo/commit/?id=3ee8bcefb)

2022-05-02 Todd C. Miller

* src/exec\_ptrace.c:

  Add support for intercepting x32 binaries on Linux x64\_64.
  [[1d17415b6]](https://git.sudo.ws/sudo/commit/?id=1d17415b6)

* plugins/sudoers/match\_command.c:

  Move intercept setid check out of do\_stat() and into its own function.
  For command\_matches\_all() we should only perform the setid check if the
  file exists and intercept is enabled. Otherwise, we can end up returning
  an error if the fully-qualified command does not exist. Fixes a
  regression introduced in sudo 1.9.0 with the support for digests in
  conjunction with “sudo ALL”.
  [[42117a1ce]](https://git.sudo.ws/sudo/commit/?id=42117a1ce)

2022-04-29 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.11
  [[4ac1237bd]](https://git.sudo.ws/sudo/commit/?id=4ac1237bd)

* plugins/sudoers/auth/kerb5.c, src/exec\_ptrace.c:

  Fix typos
  [[307b4f69b]](https://git.sudo.ws/sudo/commit/?id=307b4f69b)

* MANIFEST, docs/CONTRIBUTORS.md, po/ka.mo, po/ka.po:

  New Georgian translation from translationproject.org
  [[77979932b]](https://git.sudo.ws/sudo/commit/?id=77979932b)

* src/exec\_ptrace.c:

  Short-circuit the policy check if the command doesn’t exist. Otherwise,
  both sudo and the shell will report the error.
  [[cdc35afff]](https://git.sudo.ws/sudo/commit/?id=cdc35afff)

* src/exec\_ptrace.c:

  Use PTRACE\_GETREGS/PTRACE\_SETREGS on platforms that support it. This has
  a better chance of working on things like user-mode Linux.
  [[b75a8be34]](https://git.sudo.ws/sudo/commit/?id=b75a8be34)

* src/exec\_intercept.c, src/exec\_ptrace.c:

  In ptrace(2) intercept mode, add execveat to the seccomp(2) filter. This
  allows us to avoid logging the initial command twice regardless of
  whether the kernel supports execveat(2) or not.
  [[4010d06ed]](https://git.sudo.ws/sudo/commit/?id=4010d06ed)

* docs/sudo.conf.man.in, docs/sudo.conf.mdoc.in, docs/sudoers.man.in,
  docs/sudoers.mdoc.in:

  Update intercept documentation.
  [[052d3d1d9]](https://git.sudo.ws/sudo/commit/?id=052d3d1d9)

* src/exec\_intercept.c, src/exec\_intercept.h, src/exec\_ptrace.c,
  src/sudo.c, src/sudo.h:

  For ptrace intercept mode, do not do a policy check for the initial
  command. We can skip the policy check for the execve(2) of the initial
  command since it has already been check. Otherwise, we would log the
  command twice. When using fexecve(2) due to a digest check, there should
  be no need to skip the initial command since it will be executed via
  execveat(2) not execve(2). However, on older kernels without
  execveat(2), glibc will emulate fexecve(2) using /proc which will result
  in the extra log entry.
  [[52cacfc30]](https://git.sudo.ws/sudo/commit/?id=52cacfc30)

* plugins/sudoers/parse.c, src/exec.c, src/selinux.c, src/sudo.h:

  Enable intercept and log\_subcmds for SELinux using ptrace and seccomp.
  [[5d385b3c5]](https://git.sudo.ws/sudo/commit/?id=5d385b3c5)

* src/exec\_common.c, src/exec\_monitor.c, src/exec\_nopty.c,
  src/exec\_ptrace.c:

  Suspend the child process and wait for SIGUSR when using ptrace. This
  fixes a race condition in ptrace-based intercept mode when running the
  command in a pty. It was possible for the monitor to receive SIGCHLD
  when the command sent itself SIGSTOP before the main sudo process did.
  [[423fbedb6]](https://git.sudo.ws/sudo/commit/?id=423fbedb6)

* src/exec\_ptrace.c:

  Check architecture in the seccomp filter. Currently only supports the
  native architecture.
  [[fe80dc0bc]](https://git.sudo.ws/sudo/commit/?id=fe80dc0bc)

* src/exec\_ptrace.c:

  Add support for replacing argv in ptrace intecept mode. The new argv is
  written below the tracee’s stack and the system call argument is
  replaced with the new argv address.
  [[8e7ead57f]](https://git.sudo.ws/sudo/commit/?id=8e7ead57f)

* MANIFEST, src/Makefile.in, src/exec\_intercept.c, src/exec\_intercept.h,
  src/exec\_nopty.c, src/exec\_ptrace.c, src/exec\_pty.c, src/sudo\_exec.h:

  Check the policy for ptrace-based intercept mode.
  [[8e375445f]](https://git.sudo.ws/sudo/commit/?id=8e375445f)

* src/exec\_ptrace.c:

  Add support for getting the execve(2) arguments via ptrace(2). This will
  be used to perform a policy check in intercept mode.
  [[3e73644cd]](https://git.sudo.ws/sudo/commit/?id=3e73644cd)

* MANIFEST, src/Makefile.in, src/exec.c, src/exec\_common.c,
  src/exec\_intercept.c, src/exec\_nopty.c, src/exec\_ptrace.c,
  src/exec\_pty.c, src/sudo.h, src/sudo\_exec.h:

  Add scaffolding for ptrace-based intercept mode.
  [[01733a521]](https://git.sudo.ws/sudo/commit/?id=01733a521)

* src/exec\_nopty.c, src/exec\_pty.c:

  Handle multiple child processes in the SIGCHLD handler. This is required
  by the uncoming ptrace intercept code.
  [[22866f242]](https://git.sudo.ws/sudo/commit/?id=22866f242)

* include/sudo\_compat.h, src/exec\_monitor.c, src/exec\_nopty.c,
  src/exec\_pty.c:

  Stop using the WCONTINUED flag with waitpid(2). We don’t use it for
  anything other than a debug message and it will cause problems when
  intercept mode starts using ptrace(2).
  [[46edc4e19]](https://git.sudo.ws/sudo/commit/?id=46edc4e19)

2022-04-24 Todd C. Miller

* logsrvd/iolog\_writer.c, logsrvd/logsrvd\_journal.c,
  plugins/sudoers/log\_client.c:

  sudo\_logsrvd: update elapsed time for winsize and suspend in journal
  mode Fixes a bug in store-first relay mode where the commit point
  messages sent by the server were incorrect.
  [[c7ed03c98]](https://git.sudo.ws/sudo/commit/?id=c7ed03c98)

2022-04-23 Todd C. Miller

* docs/visudo.man.in, docs/visudo.mdoc.in:

  Fix typo; [GitHub issue
  #144](https://github.com/sudo-project/sudo/issues/144)
  [[72794ecd7]](https://git.sudo.ws/sudo/commit/?id=72794ecd7)

2022-04-20 Todd C. Miller

* src/exec\_monitor.c:

  Add struct command details \* to struct monitor\_closure. This will be
  used in the future by the ptrace intercept code.
  [[d2da56dac]](https://git.sudo.ws/sudo/commit/?id=d2da56dac)

* src/exec.c, src/exec\_intercept.c:

  Don’t require a pty for intercept or log\_subcmmds. The code to take back
  control of the tty before a policy check doesn’t appear to be needed. If
  the command is run in its own pty, sudo has control over the user’s tty.
  If the command is run in the user’s tty, sudo should be in the
  foreground process group.
  [[841375783]](https://git.sudo.ws/sudo/commit/?id=841375783)

* src/exec.c:

  Translate “unable to set limit privileges” strings.
  [[839c18937]](https://git.sudo.ws/sudo/commit/?id=839c18937)

2022-04-19 Todd C. Miller

* config.h.in, configure, configure.ac:

  Define \_TIME\_BITS=64 on systems that define \_\_TIMESIZE, like GNU libc.
  This should be replaced by a specialized autoconf macro when one becomes
  available.
  [[ec5164ced]](https://git.sudo.ws/sudo/commit/?id=ec5164ced)

2022-04-20 Todd C. Miller

* ABOUT-NLS, MANIFEST, docs/CONTRIBUTING.md:

  Remove ABOUT-NLS file, it is no longer maintained as part of GNU
  gettext. Expand the Translations section in CONTRIBUTING.md.
  [[c414a89eb]](https://git.sudo.ws/sudo/commit/?id=c414a89eb)

* docs/TROUBLESHOOTING.md:

  Expand section about expired accounts to include /etc/shadow info.
  [GitHub issue #143](https://github.com/sudo-project/sudo/issues/143)
  [[c51b81fa5]](https://git.sudo.ws/sudo/commit/?id=c51b81fa5)

2022-04-11 Todd C. Miller

* plugins/python/regress/testdata/check\_example\_group\_plugin\_is\_able\_to\_de
  bug.log, plugins/python/regress/testhelpers.c:

  clean\_output: prune lines that consisting of ‘^’ characters and
  whitespace. Starting with Python 3.11, backtraces may contain a line
  with ‘^’ characters to bring attention to the important part of the
  line. Also replace “REJECT” with “0” in backtrace output for Python
  3.11.
  [[930271847]](https://git.sudo.ws/sudo/commit/?id=930271847)

2022-04-04 Todd C. Miller

* configure, configure.ac:

  Fix check for EVP\_MD\_CTX\_new() when -pthread is in Libs.private.
  [[a1e20ddd9]](https://git.sudo.ws/sudo/commit/?id=a1e20ddd9)

2022-04-01 Todd C. Miller

* configure, configure.ac, lib/eventlog/Makefile.in,
  lib/fuzzstub/Makefile.in, lib/iolog/Makefile.in, lib/logsrv/Makefile.in,
  lib/protobuf-c/Makefile.in, lib/util/Makefile.in, lib/zlib/Makefile.in,
  logsrvd/Makefile.in, plugins/audit\_json/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/python/Makefile.in,
  plugins/sample/Makefile.in, plugins/sample\_approval/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  Rename SSP\_(C|LD)FLAGS -> HARDENING\_(C|LD)FLAGS
  [[dcb2fb26a]](https://git.sudo.ws/sudo/commit/?id=dcb2fb26a)

* INSTALL.md:

  Mention other hardening compilation and linker options.
  [[4a8877beb]](https://git.sudo.ws/sudo/commit/?id=4a8877beb)

2022-03-31 Todd C. Miller

* configure, m4/libtool.m4, m4/ltoptions.m4, m4/ltsugar.m4,
  m4/ltversion.m4, m4/lt~obsolete.m4, scripts/ltmain.sh:

  Update to libtool 2.4.7.
  [[cc4d7196f]](https://git.sudo.ws/sudo/commit/?id=cc4d7196f)

* configure, configure.ac:

  Fix check for EVP\_MD\_CTX\_new using static libcrypto with dependencies.
  [[90501b700]](https://git.sudo.ws/sudo/commit/?id=90501b700)

2022-03-30 Todd C. Miller

* configure, configure.ac:

  –enable-openssl: don’t add non-existent directories to
  PKG\_CONFIG\_LIBDIR
  [[c77cba373]](https://git.sudo.ws/sudo/commit/?id=c77cba373)

2022-03-29 Todd C. Miller

* scripts/mkpkg:

  Fix a typo in the AIX section.
  [[dfd8ef293]](https://git.sudo.ws/sudo/commit/?id=dfd8ef293)

2022-03-28 Todd C. Miller

* lib/zlib/crc32.c, lib/zlib/crc32.h, lib/zlib/deflate.c,
  lib/zlib/deflate.h, lib/zlib/gzguts.h, lib/zlib/gzlib.c,
  lib/zlib/gzread.c, lib/zlib/gzwrite.c, lib/zlib/infback.c,
  lib/zlib/inffast.c, lib/zlib/inflate.c, lib/zlib/inflate.h,
  lib/zlib/inftrees.c, lib/zlib/trees.c, lib/zlib/zlib.exp,
  lib/zlib/zlib.h, lib/zlib/zutil.c, lib/zlib/zutil.h:

  Update embedded copy of zlib to version 1.2.12. Fixes CVE-2018-25032
  [[5c0436f0b]](https://git.sudo.ws/sudo/commit/?id=5c0436f0b)

2022-03-16 Todd C. Miller

* plugins/sudoers/auth/kerb5.c:

  Minor style nit.
  [[6af2b4188]](https://git.sudo.ws/sudo/commit/?id=6af2b4188)

* :

  Merge pull request #138 from dfskoll/main

  If we’re using Kerberos, don’t overwrite a custom prompt
  [[6143dcae9]](https://git.sudo.ws/sudo/commit/?id=6143dcae9)

2022-03-16 Dianne Skoll

* plugins/sudoers/auth/kerb5.c:

  If we’re using Kerberos, don’t overwrite a custom prompt if one was
  given with -p

  Thanks to @thend20 for testing this patch.
  [[11c6cdc02]](https://git.sudo.ws/sudo/commit/?id=11c6cdc02)

2022-03-15 Todd C. Miller

* src/conversation.c:

  Write the \r\n pair to ttyfp if possible, falling back on fp. This is
  consistent with the vfprintf() call and fixes a problem introduced by
  the last commit where the newline could be written before the message
  instead of after.
  [[e2692f109]](https://git.sudo.ws/sudo/commit/?id=e2692f109)

* include/sudo\_util.h,
  plugins/sudoers/regress/starttime/check\_starttime.c:

  Adjust starttime test when run under Debian faketime. [Bug
  #1026](https://bugzilla.sudo.ws/show_bug.cgi?id=1026)
  [[753771390]](https://git.sudo.ws/sudo/commit/?id=753771390)

2022-03-14 Todd C. Miller

* src/conversation.c:

  sudo\_conversation\_printf: convert trailing nl to cr + nl combo. This
  fixes output when the terminal is in raw mode and is consistent with how
  sudo\_conversation() behaves.
  [[210875796]](https://git.sudo.ws/sudo/commit/?id=210875796)

* plugins/sudoers/sudoers.c:

  Do not warn, log or send mail for errors when reinitializing defaults.
  If there is a problem, we would have already warned, logged or mailed
  it. The one exception is the initial defaults, which should never fail.
  [[ff1731798]](https://git.sudo.ws/sudo/commit/?id=ff1731798)

* lib/eventlog/eventlog.c, src/exec\_monitor.c, src/exec\_nopty.c,
  src/exec\_pty.c, src/tgetpass.c:

  Block SIGCHLD when forking the mailer. Otherwise, it may be picked up by
  the signal handler instead of our waitpid(2) call. Don’t warn if
  waitpid() returns 0 in a SIGCHLD handler.
  [[de4738035]](https://git.sudo.ws/sudo/commit/?id=de4738035)

* plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/parse.c, plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sudoers.c:

  If there are multiple parse errors, send them in a single mail message.
  [[e5a50ae42]](https://git.sudo.ws/sudo/commit/?id=e5a50ae42)

* lib/eventlog/Makefile.in, lib/iolog/Makefile.in, lib/util/Makefile.in,
  logsrvd/Makefile.in, plugins/python/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Unset LANGUAGE when running tests, otherwise it may override LC\_ALL.
  [Bug #1025](https://bugzilla.sudo.ws/show_bug.cgi?id=1025).
  [[1f64aca22]](https://git.sudo.ws/sudo/commit/?id=1f64aca22)

2022-03-11 Todd C. Miller

* plugins/sudoers/visudo.c:

  Looser owner/permission checks for an uninstalled sudoers file. We don’t
  check the owner or permissions on a sudoers file that is specified as an
  argument to visudo by default. However, the owner and mode of files
  included via @includedir were still checked. This commit makes the
  owner and permissions checks for filed included via @includedir follow
  the same as for the original sudoers file.
  [[ef4ce5c08]](https://git.sudo.ws/sudo/commit/?id=ef4ce5c08)

* lib/util/regress/getdelim/getdelim\_test.c:

  getdelim\_test: increase longstr to check end pointer after realloc This
  would have caught the recent bug in our getdelim replacement when run
  under address-sanitizer or valgrind.
  [[b2a32f95e]](https://git.sudo.ws/sudo/commit/?id=b2a32f95e)

* plugins/sudoers/check\_aliases.c:

  Add missing va\_start/va\_end around call to sudoers\_error\_hook().
  Coverity CID 250885
  [[8e7c004c7]](https://git.sudo.ws/sudo/commit/?id=8e7c004c7)

* lib/util/getdelim.c:

  Correctly update the end pointer when we expand the buffer. From Robert
  Manner.
  [[c48c511e9]](https://git.sudo.ws/sudo/commit/?id=c48c511e9)

2022-03-10 Todd C. Miller

* lib/util/secure\_path.c:

  sudo\_secure\_path: pass the struct stat \* argument directly to stat(2)
  Set the pointer to a struct stat on the stack if st is NULL. Avoids a
  needless memcpy() at the end.
  [[6ff33922f]](https://git.sudo.ws/sudo/commit/?id=6ff33922f)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Fix off-by-one when storing line number in userspec. We store the line
  number *after* parsing the newline so we need to subtract one.
  [[8dae0ba06]](https://git.sudo.ws/sudo/commit/?id=8dae0ba06)

* lib/eventlog/eventlog.c:

  For alert messages, the command or runuser may not be set. This fixes
  the logging of parse errors when JSON logging is enabled.
  [[eb2803c3e]](https://git.sudo.ws/sudo/commit/?id=eb2803c3e)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/iolog.c,
  plugins/sudoers/locale.c, plugins/sudoers/logging.h,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c:

  Pass file, line and column to sudoers defaults callbacks.
  [[65e5b89f1]](https://git.sudo.ws/sudo/commit/?id=65e5b89f1)

* plugins/sudoers/audit.c, plugins/sudoers/check\_aliases.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/defaults.c,
  plugins/sudoers/file.c, plugins/sudoers/gram.c, plugins/sudoers/gram.h,
  plugins/sudoers/gram.y, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/parse.h,
  plugins/sudoers/policy.c, plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/sudoers/test18.toke.ok,
  plugins/sudoers/regress/visudo/test2.err.ok, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/visudo.c:

  Add a hook for sudoers parse errors (including defaults and aliases).
  The hook can be used to log parser errors (sudoers module) or keep track
  of which files have an error (visudo). Previously, we only kept track of
  a single parse error.
  [[d7ddff2a3]](https://git.sudo.ws/sudo/commit/?id=d7ddff2a3)

2022-03-09 Todd C. Miller

* plugins/sudoers/file.c, plugins/sudoers/ldap.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/sudoers/test18.out.ok, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c:

  Add a source to struct sudo\_nss and use it if getdefs() fails. Also
  remove useless “Problem with defaults entries” warning in testsudoers.
  [[6ec279532]](https://git.sudo.ws/sudo/commit/?id=6ec279532)

2022-03-08 Todd C. Miller

* lib/iolog/regress/iolog\_path/check\_iolog\_path.c,
  lib/util/regress/getgrouplist/getgrouplist\_test.c:

  Plug a few test memory leaks now that they return from main().
  [[31ab2e229]](https://git.sudo.ws/sudo/commit/?id=31ab2e229)

2022-03-06 Todd C. Miller

* lib/eventlog/regress/logwrap/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c:

  Remove extra newline in sudo\_warnx() calls.
  [[346dce435]](https://git.sudo.ws/sudo/commit/?id=346dce435)

* plugins/sudoers/check\_aliases.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/file.c, plugins/sudoers/gram.c, plugins/sudoers/gram.h,
  plugins/sudoers/gram.y, plugins/sudoers/sudoers.h,
  plugins/sudoers/visudo.c:

  Preserve the column and error message when there is a syntax error. This
  information is now included in the error mail sent to root.
  [[7d3f9293c]](https://git.sudo.ws/sudo/commit/?id=7d3f9293c)

* plugins/python/python\_plugin\_common.c:

  Deinit python subinterpreters in reverse order (last to first). This
  appears to work around a crash on OpenBSD with Python 3.9.10.
  [[dfda098ae]](https://git.sudo.ws/sudo/commit/?id=dfda098ae)

2022-03-03 Todd C. Miller

* lib/eventlog/Makefile.in, lib/iolog/Makefile.in, lib/util/Makefile.in,
  logsrvd/Makefile.in, plugins/python/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  For ‘make check-verbose’ run fuzzers with -verbose=1 This is the default
  for libFuzzer but not for the stub fuzzer lib.
  [[c131b2747]](https://git.sudo.ws/sudo/commit/?id=c131b2747)

2022-03-02 Todd C. Miller

* INSTALL.md:

  INSTALL.md: Mention “make check” and “make check-verbose”
  [[ecaa8ab42]](https://git.sudo.ws/sudo/commit/?id=ecaa8ab42)

* scripts/generate\_test\_coverage.sh:

  Repair generate\_test\_coverage.sh after move to scripts directory.
  [[9f47ea5cb]](https://git.sudo.ws/sudo/commit/?id=9f47ea5cb)

* Makefile.in, docs/Makefile.in, examples/Makefile.in,
  include/Makefile.in, lib/eventlog/Makefile.in, lib/fuzzstub/Makefile.in,
  lib/iolog/Makefile.in, lib/logsrv/Makefile.in,
  lib/protobuf-c/Makefile.in, lib/util/Makefile.in, lib/zlib/Makefile.in,
  logsrvd/Makefile.in, plugins/audit\_json/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/python/Makefile.in,
  plugins/sample/Makefile.in, plugins/sample\_approval/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  Add check-verbose Makefile target that runs tests in verbose mode.
  [[cdee5d48d]](https://git.sudo.ws/sudo/commit/?id=cdee5d48d)

* lib/eventlog/regress/logwrap/check\_wrap.c,
  lib/iolog/regress/host\_port/host\_port\_test.c,
  lib/iolog/regress/iolog\_filter/check\_iolog\_filter.c,
  lib/iolog/regress/iolog\_json/check\_iolog\_json.c,
  lib/iolog/regress/iolog\_mkpath/check\_iolog\_mkpath.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c,
  lib/iolog/regress/iolog\_timing/check\_iolog\_timing.c,
  lib/util/regress/closefrom/closefrom\_test.c,
  lib/util/regress/fnmatch/fnm\_test.c,
  lib/util/regress/getdelim/getdelim\_test.c,
  lib/util/regress/getgrouplist/getgids.c,
  lib/util/regress/getgrouplist/getgrouplist\_test.c,
  lib/util/regress/glob/globtest.c, lib/util/regress/mktemp/mktemp\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/strsig/strsig\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/strtofoo/strtobool\_test.c,
  lib/util/regress/strtofoo/strtoid\_test.c,
  lib/util/regress/strtofoo/strtomode\_test.c,
  lib/util/regress/strtofoo/strtonum\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c, lib/util/regress/uuid/uuid\_test.c:

  Add -v option parsing to regress tests, currently a no-op. This will be
  used by a “check-verbose” target in the future.
  [[43cc80d79]](https://git.sudo.ws/sudo/commit/?id=43cc80d79)

2022-03-01 Todd C. Miller

* plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/testhelpers.h:

  Less verbose output unless the -v option is used. Also display a test
  summary at the end.
  [[dda14cb57]](https://git.sudo.ws/sudo/commit/?id=dda14cb57)

* src/regress/net\_ifs/check\_net\_ifs.c, src/regress/noexec/check\_noexec.c,
  src/regress/ttyname/check\_ttyname.c:

  verbose flag is boolean, not int
  [[2c329dbe4]](https://git.sudo.ws/sudo/commit/?id=2c329dbe4)

* configure.ac:

  Update copyright year.
  [[908ae9510]](https://git.sudo.ws/sudo/commit/?id=908ae9510)

* plugins/sudoers/Makefile.in, src/Makefile.in:

  Regenerate dependencies.
  [[e9155a067]](https://git.sudo.ws/sudo/commit/?id=e9155a067)

* MANIFEST, configure, configure.ac, lib/util/Makefile.in,
  lib/util/regress/closefrom/closefrom\_test.c:

  Add sudo\_closefrom() regression test.
  [[75a0e5159]](https://git.sudo.ws/sudo/commit/?id=75a0e5159)

* NEWS, config.h.in, configure, configure.ac, lib/util/closefrom.c:

  Use close\_range(2) in closefrom() emulation if available. On Linux,
  prefer our own closefrom() emulation since the glibc version may fail if
  /proc is not present and close\_range() is not supported. On FreeBSD,
  closefrom(3) will either call the closefrom or close\_range system call,
  depending on which is available.
  [[f1a697a8f]](https://git.sudo.ws/sudo/commit/?id=f1a697a8f)

* configure, configure.ac:

  Repair –enable-pvs-studio on Linux.
  [[c3177ce83]](https://git.sudo.ws/sudo/commit/?id=c3177ce83)

* configure, configure.ac:

  Mention apple radar 3710161 in the comment about broken macOS poll(2).
  [[10ca59097]](https://git.sudo.ws/sudo/commit/?id=10ca59097)

2022-02-28 Todd C. Miller

* src/regress/net\_ifs/check\_net\_ifs.c, src/regress/noexec/check\_noexec.c,
  src/regress/ttyname/check\_ttyname.c:

  Only display test totals unless run in verbose mode.
  [[a199abe0e]](https://git.sudo.ws/sudo/commit/?id=a199abe0e)

* lib/util/regress/harness.in, plugins/sudoers/regress/harness.in:

  Allow test harness to be run from any directory. Also add missing
  copyright notice.
  [[c2bd52edf]](https://git.sudo.ws/sudo/commit/?id=c2bd52edf)

* lib/util/regress/harness.in:

  Adapt test harness for lib/util and move to regress directory.
  [[a4f847b1d]](https://git.sudo.ws/sudo/commit/?id=a4f847b1d)

* .gitignore, .hgignore, MANIFEST, configure, configure.ac,
  lib/util/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/harness.in:

  Adapt test harness for lib/util and move to regress directory.
  [[a57e97996]](https://git.sudo.ws/sudo/commit/?id=a57e97996)

* lib/fuzzstub/fuzzstub.c:

  Make fuzzer stub main() quiet by default. LLVM LibFuzzer displays the
  input and running time by default but we don’t care about that for the
  stub fuzzer library.
  [[6a8452367]](https://git.sudo.ws/sudo/commit/?id=6a8452367)

* .gitignore, .hgignore, MANIFEST, configure, configure.ac,
  plugins/sudoers/Makefile.in, plugins/sudoers/harness.in:

  Move the cvtsudoers/sudoers/testsudoers/visudo tests into a script. It
  is easier to maintain these tests in script form. The output now more
  closely matches that of the other tests. The harness script can be
  invoked directly and supports running specific tests.
  [[f35bbd5a3]](https://git.sudo.ws/sudo/commit/?id=f35bbd5a3)

2022-02-27 Todd C. Miller

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po:

  Updated translations from translationproject.org
  [[e7b7c902d]](https://git.sudo.ws/sudo/commit/?id=e7b7c902d)

2022-02-25 Todd C. Miller

* logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  sudo\_regex\_compile\_v1 stub: set errstr on error
  [[e703feeae]](https://git.sudo.ws/sudo/commit/?id=e703feeae)

* logsrvd/Makefile.in, logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  fuzz\_logsrvd\_conf: add stub version of sudo\_regex\_compile\_v1(). We want
  to fuzz our parser, not the libc regular expression code.
  [[590c4cf62]](https://git.sudo.ws/sudo/commit/?id=590c4cf62)

* plugins/sudoers/regress/testsudoers/test18.out.ok,
  plugins/sudoers/regress/testsudoers/test18.sh:

  testsudoers/test18: don’t rely on /usr/bin/w being present Fixes a test
  failure on Alpine Linux.
  [[e5bbd3383]](https://git.sudo.ws/sudo/commit/?id=e5bbd3383)

2022-02-24 Todd C. Miller

* configure, configure.ac:

  Add configure check for gzclearerr() when using system zlib.
  [[42f735c8d]](https://git.sudo.ws/sudo/commit/?id=42f735c8d)

* configure, configure.ac:

  Fix PVS-Studio platform check for macOS.
  [[68bc030c0]](https://git.sudo.ws/sudo/commit/?id=68bc030c0)

* plugins/sudoers/ldap.c:

  sudo\_ldap\_parse\_options: fix memory leak of sudoRole cn string. Coverity
  CID 249976
  [[22a01410b]](https://git.sudo.ws/sudo/commit/?id=22a01410b)

* src/sudo\_intercept\_common.c:

  command\_allowed: plug memory leak on strdup() failure. Coverity CID
  249972
  [[f793042be]](https://git.sudo.ws/sudo/commit/?id=f793042be)

2022-02-23 Todd C. Miller

* plugins/sudoers/check.c:

  display\_lecture: just return if callback is NULL
  [[b1fd1ec0f]](https://git.sudo.ws/sudo/commit/?id=b1fd1ec0f)

* lib/eventlog/eventlog.c:

  For alert messages it is possible for evlog to be NULL. Coverity CID
  238641
  [[330b4e821]](https://git.sudo.ws/sudo/commit/?id=330b4e821)

* logsrvd/logsrv\_util.c:

  iolog\_seekto: initialize struct timing\_closure before using. Coverity
  CID 249977
  [[8290a1e57]](https://git.sudo.ws/sudo/commit/?id=8290a1e57)

* logsrvd/iolog\_writer.c:

  iolog\_rewrite: initialize struct timing\_closure before using. Coverity
  CID 249971
  [[2315c0b3b]](https://git.sudo.ws/sudo/commit/?id=2315c0b3b)

* scripts/mkpkg:

  Allow ARCH\_FLAGS to be overridden and handle macOS 12.
  [[79d850034]](https://git.sudo.ws/sudo/commit/?id=79d850034)

* scripts/mkpkg:

  Prefer if [ … ]; then over if test …; then.
  [[9f427b017]](https://git.sudo.ws/sudo/commit/?id=9f427b017)

* .circleci/config.yml:

  Do not build with -Werror on macOS. Some macOS warnings are bogus, for
  instance it has an incorrect getgrouplist(3) definition.
  [[77164836f]](https://git.sudo.ws/sudo/commit/?id=77164836f)

* .circleci/config.yml:

  Build and test macos with circleci.
  [[cf8451127]](https://git.sudo.ws/sudo/commit/?id=cf8451127)

2022-02-22 Todd C. Miller

* NEWS:

  Mention lecture behavior change.
  [[c7fb51359]](https://git.sudo.ws/sudo/commit/?id=c7fb51359)

* lib/iolog/regress/iolog\_filter/check\_iolog\_filter.c:

  Fix compilation on systems without a real openat(2).
  [[eaf76278e]](https://git.sudo.ws/sudo/commit/?id=eaf76278e)

* plugins/sudoers/match\_digest.c:

  Better warning message when the digest in sudoers is the wrong length.
  [[b0fa76950]](https://git.sudo.ws/sudo/commit/?id=b0fa76950)

* lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.c,
  logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Do not disable fuzzer output if SUDO\_FUZZ\_VERBOSE env variable is set.
  [[41bc52302]](https://git.sudo.ws/sudo/commit/?id=41bc52302)

2022-02-21 Todd C. Miller

* plugins/sudoers/auth/afs.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/check.c,
  plugins/sudoers/check.h, plugins/sudoers/timestamp.c:

  Display the lecture immediately before prompting for a password. This
  means we no longer display the lecture unless the user is going to enter
  a password. Authentication methods that don’t interact with the user via
  the terminal don’t trigger the lecture.
  [[2911c31dd]](https://git.sudo.ws/sudo/commit/?id=2911c31dd)

* NEWS, plugins/sudoers/logging.c:

  Add back warning when a user is not allowed to run a command.
  Previously, the warning was displayed when a user was not in the sudoers
  file, or was present but not listed for the local host. The new behavior
  is to display the warning if a command is denied and mail is sent to the
  administrator. Whether or not mail is sent is controlled by the “mail\_\*”
  flags in sudoers. The warning text is now “This incident has been
  reported to the administrator.” which is hopefully less confusing. The
  message will not be printed if either the “mailto” or “mailerpath”
  sudoers settings are disabled.
  [[9757d29a2]](https://git.sudo.ws/sudo/commit/?id=9757d29a2)

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Document that negating mailto or mailerpath disables sending mail.
  [[973a8f08f]](https://git.sudo.ws/sudo/commit/?id=973a8f08f)

2022-02-20 Todd C. Miller

* plugins/sudoers/logging.c:

  Don’t try to send mail if mailto not set or the mailer is not present.
  [[98ac09de3]](https://git.sudo.ws/sudo/commit/?id=98ac09de3)

2022-02-21 Todd C. Miller

* TODO:

  Remove obsolete TODO file.
  [[81d63244e]](https://git.sudo.ws/sudo/commit/?id=81d63244e)

2022-02-18 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/cs.mo,
  po/cs.po, po/de.mo, po/de.po, po/eo.mo, po/eo.po, po/fi.mo, po/fi.po,
  po/fr.mo, po/fr.po, po/hr.mo, po/hr.po, po/ja.mo, po/ja.po, po/ko.mo,
  po/ko.po, po/pl.mo, po/pl.po, po/ro.mo, po/ro.po, po/sr.mo, po/sr.po,
  po/uk.mo, po/uk.po, po/vi.mo, po/vi.po, po/zh\_CN.mo, po/zh\_CN.po,
  po/zh\_TW.mo, po/zh\_TW.po:

  Updated translations from translationproject.org
  [[bde48fb4c]](https://git.sudo.ws/sudo/commit/?id=bde48fb4c)

* MANIFEST, lib/iolog/Makefile.in,
  lib/iolog/regress/iolog\_filter/check\_iolog\_filter.c,
  lib/iolog/regress/iolog\_filter/test1/log,
  lib/iolog/regress/iolog\_filter/test1/timing,
  lib/iolog/regress/iolog\_filter/test1/ttyin,
  lib/iolog/regress/iolog\_filter/test1/ttyin.filtered,
  lib/iolog/regress/iolog\_filter/test1/ttyout,
  lib/iolog/regress/iolog\_filter/test2/log,
  lib/iolog/regress/iolog\_filter/test2/timing,
  lib/iolog/regress/iolog\_filter/test2/ttyin,
  lib/iolog/regress/iolog\_filter/test2/ttyin.filtered,
  lib/iolog/regress/iolog\_filter/test2/ttyout,
  lib/iolog/regress/iolog\_filter/test3/log,
  lib/iolog/regress/iolog\_filter/test3/timing,
  lib/iolog/regress/iolog\_filter/test3/ttyin,
  lib/iolog/regress/iolog\_filter/test3/ttyin.filtered,
  lib/iolog/regress/iolog\_filter/test3/ttyout:

  Add tests for iolog filtering. This is the functionality used by the
  log\_passwords and passprompt\_regex options.
  [[cadfbfedb]](https://git.sudo.ws/sudo/commit/?id=cadfbfedb)

* lib/iolog/iolog\_filter.c:

  iolog\_pwfilt\_run: apply regex on ttyout even if we disabled filtering.
  The heuristic used to decide when to disable filtering is when we see
  another ttyout buffer or find a cr or nl in the ttyin buffer. However,
  we should also check the buffer that caused us to disable filtering for
  a matching regex that would re-enable filtering. Programs that prompt
  for a password twice might otherwise not have the second password
  filtered.
  [[b19bd9853]](https://git.sudo.ws/sudo/commit/?id=b19bd9853)

2022-02-16 Todd C. Miller

* INSTALL.md, README.LDAP.md, docs/TROUBLESHOOTING.md, docs/UPGRADE.md,
  docs/sudo.conf.man.in, docs/sudo.conf.mdoc.in, docs/sudo.man.in,
  docs/sudo.mdoc.in, docs/sudo\_logsrv.proto.man.in,
  docs/sudo\_logsrv.proto.mdoc.in, docs/sudo\_logsrvd.conf.man.in,
  docs/sudo\_logsrvd.conf.mdoc.in, docs/sudo\_plugin.man.in,
  docs/sudo\_plugin.mdoc.in, docs/sudo\_plugin\_python.man.in,
  docs/sudo\_plugin\_python.mdoc.in, docs/sudoers.ldap.man.in,
  docs/sudoers.ldap.mdoc.in, docs/sudoers.man.in, docs/sudoers.mdoc.in,
  docs/sudoreplay.man.in, docs/sudoreplay.mdoc.in, docs/visudo.man.in,
  docs/visudo.mdoc.in, examples/sudo\_logsrvd.conf.in:

  Avoid using “note that” and “note: " in documentation.
  [[9f5615e5b]](https://git.sudo.ws/sudo/commit/?id=9f5615e5b)

* INSTALL.md, README.LDAP.md, README.md, docs/CONTRIBUTING.md,
  docs/CONTRIBUTORS.md, docs/SECURITY.md, docs/TROUBLESHOOTING.md,
  docs/UPGRADE.md, docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in,
  docs/sudo.conf.man.in, docs/sudo.conf.mdoc.in, docs/sudo.man.in,
  docs/sudo.mdoc.in, docs/sudo\_logsrv.proto.man.in,
  docs/sudo\_logsrv.proto.mdoc.in, docs/sudo\_logsrvd.conf.man.in,
  docs/sudo\_logsrvd.conf.mdoc.in, docs/sudo\_logsrvd.man.in,
  docs/sudo\_logsrvd.mdoc.in, docs/sudo\_plugin.man.in,
  docs/sudo\_plugin.mdoc.in, docs/sudo\_plugin\_python.man.in,
  docs/sudo\_plugin\_python.mdoc.in, docs/sudo\_sendlog.man.in,
  docs/sudo\_sendlog.mdoc.in, docs/sudoers.ldap.man.in,
  docs/sudoers.ldap.mdoc.in, docs/sudoers.man.in, docs/sudoers.mdoc.in,
  docs/sudoers\_timestamp.man.in, docs/sudoers\_timestamp.mdoc.in,
  docs/sudoreplay.man.in, docs/sudoreplay.mdoc.in, docs/visudo.man.in,
  docs/visudo.mdoc.in:

  Remove “please” from the documentation, it is considered bad style.
  [[917595489]](https://git.sudo.ws/sudo/commit/?id=917595489)

* docs/UPGRADE.md:

  Mention regular expressions and “sudo -l -U user” behavior change.
  [[c4fc9b695]](https://git.sudo.ws/sudo/commit/?id=c4fc9b695)

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  Add security notes about regular expressions in sudoers rules.
  [[339ef82d6]](https://git.sudo.ws/sudo/commit/?id=339ef82d6)

* NEWS:

  Update NEWS for [GitHub issue
  #134](https://github.com/sudo-project/sudo/issues/134).
  [[03484c0c1]](https://git.sudo.ws/sudo/commit/?id=03484c0c1)

2022-02-15 Todd C. Miller

* plugins/sudoers/logging.c:

  fmt\_authfail\_message: compute the exact amount of space needed. Instead
  of truncating on overflow, warn and return NULL.
  [[de52b8e44]](https://git.sudo.ws/sudo/commit/?id=de52b8e44)

* lib/eventlog/eventlog.c:

  do\_logfile\_sudo: plug memory leak of full\_line Coverity CID 249329
  [[274468d7d]](https://git.sudo.ws/sudo/commit/?id=274468d7d)

* plugins/sudoers/logging.c:

  log\_server\_alert: plug potential memory leak Coverity CID 249328
  [[f01b04401]](https://git.sudo.ws/sudo/commit/?id=f01b04401)

* plugins/sudoers/parse.c:

  Fix potential NULL deref if getpwuid(0) fails. Coverity CID 249326
  [[72961fe43]](https://git.sudo.ws/sudo/commit/?id=72961fe43)

2022-02-14 Todd C. Miller

* docs/sudo.man.in, docs/sudo.mdoc.in, plugins/sudoers/parse.c,
  plugins/sudoers/policy.c:

  Restrict “sudo -U other -l” to users with sudo ALL for root or “other”.
  Having “sudo ALL” permissions in no longer sufficient to be able to list
  another user’s privileges. The invoking user must now have “sudo ALL”
  for root or the target user. [GitHub issue
  #134](https://github.com/sudo-project/sudo/issues/134)
  [[9f695f0fc]](https://git.sudo.ws/sudo/commit/?id=9f695f0fc)

2022-02-13 Todd C. Miller

* NEWS:

  Reword some of the NEWS items for 1.9.10.
  [[df1bb3814]](https://git.sudo.ws/sudo/commit/?id=df1bb3814)

2022-02-12 Todd C. Miller

* docs/sudo\_logsrvd.conf.man.in, docs/sudo\_logsrvd.conf.mdoc.in,
  docs/sudoers.man.in, docs/sudoers.mdoc.in, lib/util/regex.c,
  po/sudo.pot:

  Limit regular expressions to 1024 characters each. Avoids a problem with
  the fuzzer creating large regular expressions that blow up the glibc
  regcomp().
  [[33f54c853]](https://git.sudo.ws/sudo/commit/?id=33f54c853)

2022-02-11 Todd C. Miller

* .gitignore, .hgignore, MANIFEST, configure, configure.ac,
  examples/Makefile.in, examples/sudo.conf.in, examples/syslog.conf.in:

  Substitute values in the example syslog.conf too. Also update ignore
  files for example changes
  [[63b2a62f8]](https://git.sudo.ws/sudo/commit/?id=63b2a62f8)

* MANIFEST, configure, configure.ac, docs/sudo.conf.man.in,
  docs/sudo.conf.mdoc.in, docs/sudo.man.in, docs/sudo.mdoc.in,
  docs/sudo\_logsrvd.conf.man.in, docs/sudo\_logsrvd.conf.mdoc.in,
  docs/sudo\_plugin\_python.man.in, docs/sudo\_plugin\_python.mdoc.in,
  docs/sudoers.man.in, docs/sudoers.mdoc.in, examples/Makefile.in,
  examples/sudo\_logsrvd.conf.in, examples/sudoers.in:

  Substitute paths set by configure in examples. [Bug
  #1023](https://bugzilla.sudo.ws/show_bug.cgi?id=1023)
  [[0bbe4b181]](https://git.sudo.ws/sudo/commit/?id=0bbe4b181)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update Project-Id-Version to 1.9.10.
  [[0e2e4b688]](https://git.sudo.ws/sudo/commit/?id=0e2e4b688)

* plugins/sudoers/po/sudoers.pot:

  Update .pot files for 1.9.10
  [[541c165e6]](https://git.sudo.ws/sudo/commit/?id=541c165e6)

* NEWS, configure, configure.ac:

  Sudo 1.9.10
  [[85f9f2beb]](https://git.sudo.ws/sudo/commit/?id=85f9f2beb)

* MANIFEST, docs/sudo\_logsrvd.conf.man.in, docs/sudo\_logsrvd.conf.mdoc.in,
  docs/sudoers.man.in, docs/sudoers.mdoc.in, include/sudo\_util.h,
  lib/iolog/iolog\_filter.c, lib/util/Makefile.in, lib/util/regex.c,
  lib/util/util.exp.in, plugins/sudoers/defaults.c,
  plugins/sudoers/match\_command.c,
  plugins/sudoers/regress/sudoers/test28.in,
  plugins/sudoers/regress/sudoers/test28.json.ok,
  plugins/sudoers/regress/sudoers/test28.ldif.ok,
  plugins/sudoers/regress/sudoers/test28.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test28.out.ok,
  plugins/sudoers/regress/sudoers/test28.toke.ok,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c:

  Add helper function to compile a regex that supports (?i).
  [[7c17f84a3]](https://git.sudo.ws/sudo/commit/?id=7c17f84a3)

2022-02-10 Todd C. Miller

* MANIFEST, configure, configure.ac, docs/sudoers.man.in,
  docs/sudoers.mdoc.in, examples/sudoers, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/sudoers/test28.in,
  plugins/sudoers/regress/sudoers/test28.json.ok,
  plugins/sudoers/regress/sudoers/test28.ldif.ok,
  plugins/sudoers/regress/sudoers/test28.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test28.out.ok,
  plugins/sudoers/regress/sudoers/test28.toke.ok,
  plugins/sudoers/regress/sudoers/test29.in,
  plugins/sudoers/regress/sudoers/test29.json.ok,
  plugins/sudoers/regress/sudoers/test29.ldif.ok,
  plugins/sudoers/regress/sudoers/test29.out.ok,
  plugins/sudoers/regress/sudoers/test29.toke.ok,
  plugins/sudoers/regress/testsudoers/test18.out.ok,
  plugins/sudoers/regress/testsudoers/test18.sh, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c:

  Add support for matching command and args using regular expressions.
  Either the command, its arguments or both may be (separate) regular
  expressions.
  [[86d217393]](https://git.sudo.ws/sudo/commit/?id=86d217393)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Clear sudoers\_errstr after it is used. This way we avoid printing the
  same error message more than once if there are multiple ERROR tokens
  returned from the lexer.
  [[c8bf59104]](https://git.sudo.ws/sudo/commit/?id=c8bf59104)

* logsrvd/logsrvd\_local.c:

  store\_iobuf\_local: fix potential double free on the error path.
  [[3c1ce4bf7]](https://git.sudo.ws/sudo/commit/?id=3c1ce4bf7)

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in, docs/sudo.conf.man.in,
  docs/sudo.conf.mdoc.in, docs/sudo.man.in, docs/sudo.mdoc.in,
  docs/sudo\_logsrv.proto.man.in, docs/sudo\_logsrv.proto.mdoc.in,
  docs/sudo\_logsrvd.conf.man.in, docs/sudo\_logsrvd.conf.mdoc.in,
  docs/sudo\_logsrvd.man.in, docs/sudo\_logsrvd.mdoc.in,
  docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in,
  docs/sudo\_plugin\_python.man.in, docs/sudo\_plugin\_python.mdoc.in,
  docs/sudo\_sendlog.man.in, docs/sudo\_sendlog.mdoc.in,
  docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in,
  docs/sudoers.man.in, docs/sudoers.mdoc.in,
  docs/sudoers\_timestamp.man.in, docs/sudoers\_timestamp.mdoc.in,
  docs/sudoreplay.man.in, docs/sudoreplay.mdoc.in, docs/visudo.man.in,
  docs/visudo.mdoc.in:

  Update links to sudo web site and reference markdown docs.
  [[3b6f620e3]](https://git.sudo.ws/sudo/commit/?id=3b6f620e3)

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in, docs/sudo.conf.man.in,
  docs/sudo.conf.mdoc.in, docs/sudo.man.in, docs/sudo.mdoc.in,
  docs/sudo\_logsrvd.man.in, docs/sudo\_logsrvd.mdoc.in,
  docs/sudo\_plugin\_python.man.in, docs/sudo\_plugin\_python.mdoc.in,
  docs/sudoers.man.in, docs/sudoers.mdoc.in, docs/sudoreplay.man.in,
  docs/sudoreplay.mdoc.in, docs/visudo.man.in, docs/visudo.mdoc.in:

  Use a 4n indent for code blocks instead of the default 6n.
  [[7b5f0dfaf]](https://git.sudo.ws/sudo/commit/?id=7b5f0dfaf)

* plugins/sudoers/testsudoers.c:

  testsudoers: disable argument permutation in GNU getopt This makes it
  easier to test commands with arguments.
  [[4e3a48f2d]](https://git.sudo.ws/sudo/commit/?id=4e3a48f2d)

* lib/iolog/iolog\_filter.c:

  iolog\_pwfilt\_run: fix types in error return
  [[b6a2fcf59]](https://git.sudo.ws/sudo/commit/?id=b6a2fcf59)

* lib/iolog/iolog\_filter.c, plugins/sudoers/iolog.c:

  Free potential leaks of passprompt\_regex\_handle. Coverity CID 249057
  [[c5027c796]](https://git.sudo.ws/sudo/commit/?id=c5027c796)

2022-02-09 Todd C. Miller

* :

  Merge pull request #133 from Dzejrou/main

  Do not unset user timeout when no default timeout is set.
  [[8dc2dc8bb]](https://git.sudo.ws/sudo/commit/?id=8dc2dc8bb)

2022-02-09 Jaroslav Jindrak

* plugins/sudoers/policy.c:

  Do not unset user timeout when no default timeout is set.
  [[1f3815c4f]](https://git.sudo.ws/sudo/commit/?id=1f3815c4f)

2022-02-08 Todd C. Miller

* plugins/sudoers/fmtsudoers.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/sudoers/test2.in,
  plugins/sudoers/regress/sudoers/test2.json.ok,
  plugins/sudoers/regress/sudoers/test2.ldif.ok,
  plugins/sudoers/regress/sudoers/test2.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test2.out.ok,
  plugins/sudoers/regress/sudoers/test2.toke.ok:

  Don’t escape double quotes (”) in a command when printing it.
  Previously, cvtsudoers and “sudo -l” would escape double quotes in a
  command or command line argument, which is not valid sudoers syntax.
  [[10ad934b7]](https://git.sudo.ws/sudo/commit/?id=10ad934b7)

* docs/sudoers.man.in, docs/sudoers.mdoc.in:

  A few minor (mostly cosmetic) fixes. Add missing ALL to Runas\_Member and
  Host. Replace some tabs with spaces. Fix the syntax of a sudoedit
  example.
  [[8adad85b4]](https://git.sudo.ws/sudo/commit/?id=8adad85b4)

2022-02-04 Todd C. Miller

* :

  Merge pull request #132 from ninedotnine/patch-1

  Sync example sudoers with default sudoers
  [[53d3e2009]](https://git.sudo.ws/sudo/commit/?id=53d3e2009)

2022-02-04 dan soucy

* examples/sudoers:

  Sync example sudoers with default sudoers

  `sudoers.in` was changed by 1d13533
  [[8130dc9cb]](https://git.sudo.ws/sudo/commit/?id=8130dc9cb)

2022-02-04 Todd C. Miller

* ABOUT-NLS, INSTALL.md, NEWS, README.LDAP.md, docs/CONTRIBUTING.md,
  plugins/sudoers/po/README, po/README:

  Upgrade http links to https where possible and fix some broken links.
  [[c5133d84e]](https://git.sudo.ws/sudo/commit/?id=c5133d84e)

2022-02-03 Todd C. Miller

* plugins/sudoers/logging.c:

  Remove “This incident will be reported.” from user warnings. This used
  to indicate that email had been sent to the administrator telling them
  that someone tried to run sudo. Whether or not sudo sends email is now
  configurable, so the warning may not be accurate. It is also confusing
  to the user since they will not know who the incident is being reported
  to. See also <https://xkcd.com/838/>
  [[6aa320c96]](https://git.sudo.ws/sudo/commit/?id=6aa320c96)

* plugins/sudoers/sssd.c:

  Log fn\_get\_values() return code in the debug log on error. Also move a
  nested switch() statement out of ‘case 0’ for improved readability.
  [[4d0aeea68]](https://git.sudo.ws/sudo/commit/?id=4d0aeea68)

* plugins/sudoers/sssd.c:

  Do not return an error if we cannot connect to the SSSD connector. This
  may simply mean that nsswitch.conf lists sss as a sudoers source but
  SSSD is not configured for sudo. Otherwise, the user will receive a
  useless “problem with defaults entries” when the sssd backend tries to
  fetch the global defaults. [Bug
  #1022](https://bugzilla.sudo.ws/show_bug.cgi?id=1022).
  [[de0f4398e]](https://git.sudo.ws/sudo/commit/?id=de0f4398e)

* plugins/sudoers/log\_client.c, plugins/sudoers/logging.c:

  Set client\_closure to NULL after freeing it.
  [[c236d58b5]](https://git.sudo.ws/sudo/commit/?id=c236d58b5)

* plugins/sudoers/log\_client.c:

  client\_closure\_alloc: init write\_bufs/free\_bufs before other
  allocations. We must initialize the tail queues before any possible call
  to client\_closure\_free(), such as due to malloc() failure.
  [[3f1bb7bc9]](https://git.sudo.ws/sudo/commit/?id=3f1bb7bc9)

* logsrvd/logsrvd\_journal.c:

  Add missing default return in last commit.
  [[c4e67624e]](https://git.sudo.ws/sudo/commit/?id=c4e67624e)

* logsrvd/logsrvd\_journal.c:

  sudo\_logsrvd: make sure journal exists before writing the alert message.
  Fixes a potential NULL dereference when journaling an alert message.
  [[d18ee7935]](https://git.sudo.ws/sudo/commit/?id=d18ee7935)

* include/sudo\_compat.h:

  Fix compilation on Debian kFreeBSD. The configure script correctly
  detects that utimensat() and futimens() are missing but the headers
  define stub versions of the functions. Including sys/stat.h pulls in the
  system definitions so we can override them safely. [Bug
  #1021](https://bugzilla.sudo.ws/show_bug.cgi?id=1021).
  [[2e957cd43]](https://git.sudo.ws/sudo/commit/?id=2e957cd43)

2022-02-02 Todd C. Miller

* src/ttyname.c:

  Add fallback if /proc/self/stat or /proc/pid/psinfo is missing or
  invalid. If the /proc file indicates no terminal is present there is no
  fallback. [Bug #1020](https://bugzilla.sudo.ws/show_bug.cgi?id=1020)
  [[a29940629]](https://git.sudo.ws/sudo/commit/?id=a29940629)

2022-02-01 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in, plugins/sudoers/check.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c:

  Add sudoers option to perform authentication even in non-interative
  mode. If noninteractive\_auth is set, authentication methods that do not
  require input from the user’s terminal may proceed. It is off by
  default, which restores the pre-1.9.9 behavior of “sudo -n”.
  [[85fef8b50]](https://git.sudo.ws/sudo/commit/?id=85fef8b50)

* MANIFEST, lib/iolog/iolog\_filter.c,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.7:

  Work around a glibc regcomp() bug with repeated ‘+’ operators. Glibc
  regcomp() has a bug where it uses excessive memory for repeated ‘+’ ops.
  Collapse them to avoid running the fuzzer out of memory.
  [[6564f1ae4]](https://git.sudo.ws/sudo/commit/?id=6564f1ae4)

* logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.1,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.2,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.3,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.4,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.5,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.6:

  Rebase seed corpus on updated sudo\_logsrvd.conf example.
  [[ac555d454]](https://git.sudo.ws/sudo/commit/?id=ac555d454)

* logsrvd/logsrvd\_conf.c:

  Fix parsing of “retry\_interval” in the relay section. The setting was
  present but the callback was missing so it could not be parsed in the
  conf file.
  [[ad719d06b]](https://git.sudo.ws/sudo/commit/?id=ad719d06b)

* logsrvd/logsrvd\_conf.c:

  Use TIME\_T\_MAX as the upper limit when parsing timeouts.
  [[2df2276d5]](https://git.sudo.ws/sudo/commit/?id=2df2276d5)

* plugins/sudoers/auth/pam.c:

  converse: don’t set response pointer on error Linux pam\_conv(3) says not
  to set the pointer on PAM\_CONV\_ERR.
  [[46ca28821]](https://git.sudo.ws/sudo/commit/?id=46ca28821)

2022-01-31 Todd C. Miller

* MANIFEST, plugins/sudoers/regress/cvtsudoers/sudoers4:

  Add missing sudoers4 test file for new cvtsudoers test.
  [[3c84aef90]](https://git.sudo.ws/sudo/commit/?id=3c84aef90)

* MANIFEST, plugins/sudoers/cvtsudoers\_merge.c,
  plugins/sudoers/regress/cvtsudoers/test38.out.ok,
  plugins/sudoers/regress/cvtsudoers/test38.sh:

  defaults\_check\_conflict: it is only really a conflict if the binding
  match If the Defaults name matched but the binding does not, we can
  simply leave it be. Fixes a problem where given two sudoers sources that
  have a host specified, if they contain conflicting Defaults entries we
  would drop one of the Defaults instead of keeping both after making them
  host-specific.
  [[960bf9965]](https://git.sudo.ws/sudo/commit/?id=960bf9965)

* MANIFEST, plugins/sudoers/cvtsudoers\_merge.c,
  plugins/sudoers/regress/cvtsudoers/sudoers1,
  plugins/sudoers/regress/cvtsudoers/sudoers2,
  plugins/sudoers/regress/cvtsudoers/sudoers3,
  plugins/sudoers/regress/cvtsudoers/test34.out.ok,
  plugins/sudoers/regress/cvtsudoers/test34.sh,
  plugins/sudoers/regress/cvtsudoers/test35.out.ok,
  plugins/sudoers/regress/cvtsudoers/test35.sh,
  plugins/sudoers/regress/cvtsudoers/test36.out.ok,
  plugins/sudoers/regress/cvtsudoers/test36.sh,
  plugins/sudoers/regress/cvtsudoers/test37.out.ok,
  plugins/sudoers/regress/cvtsudoers/test37.sh:

  Make it possible to merge a host-based Defaults with a global one. We
  convert the global Defaults to a host-based one with a single “ALL”
  member. Later, when we simplify the host list, we’ll convert this back
  to a global Defaults.
  [[8f4351a89]](https://git.sudo.ws/sudo/commit/?id=8f4351a89)

2022-01-29 Todd C. Miller

* logsrvd/logsrvd\_conf.c:

  Check for garbage after [section] in sudo\_logsrvd.conf.
  [[be4d62e9a]](https://git.sudo.ws/sudo/commit/?id=be4d62e9a)

* logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.dict,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.dict:

  Sync fuzzing dictionary with current configuration keyword list.
  [[9303aec0d]](https://git.sudo.ws/sudo/commit/?id=9303aec0d)

2022-01-28 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/iolog.c,
  plugins/sudoers/policy.c,
  plugins/sudoers/regress/serialize\_list/check\_serialize\_list.c,
  plugins/sudoers/regress/unescape/check\_unesc.c,
  plugins/sudoers/serialize\_list.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/unesc\_str.c:

  Escape/unescape commas when serializing/deserializing a stringlist.
  [[5ea0bf4ee]](https://git.sudo.ws/sudo/commit/?id=5ea0bf4ee)

* docs/sudo\_logsrvd.conf.man.in, docs/sudo\_logsrvd.conf.mdoc.in,
  examples/sudo\_logsrvd.conf, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  logsrvd/logsrvd\_local.c:

  Add new log\_passwords and passprompt\_regex settings. When logging
  terminal input, if log\_passwords is false and any of the regular
  expressions in the passprompt\_regex list are found in the terminal
  output, terminal input will be replaced with ‘\*’ characters until a
  newline or carriage return is found in the input or an output character
  is received.
  [[9b93961b3]](https://git.sudo.ws/sudo/commit/?id=9b93961b3)

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h:

  Add a flag to avoid splitting list entries on white space.
  [[c58a080dd]](https://git.sudo.ws/sudo/commit/?id=c58a080dd)

* docs/sudoers.man.in, docs/sudoers.mdoc.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/defaults.h, plugins/sudoers/iolog.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.c:

  Add a new sudoers settings log\_passwords and passprompt\_regex. When
  logging terminal input, if log\_passwords is disabled and any of the
  regular expressions in the passprompt\_regex list are found in the
  terminal output, terminal input will be replaced with ‘\*’ characters
  until a newline or carriage return is found in the input or an output
  character is received.
  [[0efe28003]](https://git.sudo.ws/sudo/commit/?id=0efe28003)

* MANIFEST, include/sudo\_iolog.h, lib/iolog/Makefile.in,
  lib/iolog/iolog\_filter.c:

  lib/iolog: add support for filtering password out of tty input If a
  password regex is found in the tty output, tty input will be replaced
  with ‘\*’ chars until a newline or another tty output character is
  received.
  [[946404434]](https://git.sudo.ws/sudo/commit/?id=946404434)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/iolog.c,
  plugins/sudoers/locale.c, plugins/sudoers/logging.h,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c:

  Pass the operator to the Defaults callback too. That way we can tell
  what to do in callbacks for lists.
  [[86f123cd9]](https://git.sudo.ws/sudo/commit/?id=86f123cd9)

2022-01-27 Todd C. Miller

* docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in:

  “plain text” -> “plaintext” for consistency.
  [[be45d8fef]](https://git.sudo.ws/sudo/commit/?id=be45d8fef)

2022-01-25 Todd C. Miller

* po/ro.mo, po/ro.po:

  Updated translations from translationproject.org
  [[cc5eb2bc4]](https://git.sudo.ws/sudo/commit/?id=cc5eb2bc4)

* INSTALL.configure:

  Sync with autoconf git.
  [[f4dd59049]](https://git.sudo.ws/sudo/commit/?id=f4dd59049)

* scripts/mkdep.pl:

  Fix potential infinite loop when trying to format long lines.
  [[ada7d4382]](https://git.sudo.ws/sudo/commit/?id=ada7d4382)

2022-01-20 Todd C. Miller

* docs/sudo.man.in, docs/sudo.mdoc.in:

  Document how commands are passed to the shell for the -i and -s options.
  The concatenation of command and arguments and escaping of special
  characters was not documented. Text adapted from [GitHub issue
  #121](https://github.com/sudo-project/sudo/issues/121) from Kris
  Rinzwind
  [[5f45fd907]](https://git.sudo.ws/sudo/commit/?id=5f45fd907)

* docs/TROUBLESHOOTING.md:

  Also mention no\_new\_privs error in the troubleshooting guide.
  [[805e1b947]](https://git.sudo.ws/sudo/commit/?id=805e1b947)

* INSTALL.md, docs/TROUBLESHOOTING.md, docs/sudo.conf.man.in,
  docs/sudo.conf.mdoc.in, docs/sudo.man.in, docs/sudo.mdoc.in,
  docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in,
  docs/sudo\_plugin\_python.man.in, docs/sudo\_plugin\_python.mdoc.in,
  docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in,
  docs/sudoers.man.in, docs/sudoers.mdoc.in, docs/visudo.man.in,
  docs/visudo.mdoc.in:

  Replace uid and gid with user-ID and group-ID in more places.
  [[e4ee1a850]](https://git.sudo.ws/sudo/commit/?id=e4ee1a850)

2022-01-19 Todd C. Miller

* INSTALL.md:

  PAM is enabled on NetBSD by default too.
  [[bdae9843a]](https://git.sudo.ws/sudo/commit/?id=bdae9843a)

* INSTALL.md, README.LDAP.md, docs/HISTORY.md, docs/TROUBLESHOOTING.md,
  docs/UPGRADE.md:

  Use the Oxford comma consistently, it is helpful in technical documents.
  [[9d79a0767]](https://git.sudo.ws/sudo/commit/?id=9d79a0767)

* docs/sudo.man.in, docs/sudo.mdoc.in:

  Document the error message when no\_new\_privs is set.
  [[78e74c605]](https://git.sudo.ws/sudo/commit/?id=78e74c605)

* docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in:

  Sudo now recovers from sudoers syntax errors.
  [[17b7ac346]](https://git.sudo.ws/sudo/commit/?id=17b7ac346)

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in, docs/sudo.conf.man.in,
  docs/sudo.conf.mdoc.in, docs/sudo.man.in, docs/sudo.mdoc.in,
  docs/sudo\_logsrv.proto.man.in, docs/sudo\_logsrv.proto.mdoc.in,
  docs/sudo\_logsrvd.conf.man.in, docs/sudo\_logsrvd.conf.mdoc.in,
  docs/sudo\_plugin.man.in, docs/sudo\_plugin.mdoc.in,
  docs/sudo\_plugin\_python.man.in, docs/sudo\_plugin\_python.mdoc.in,
  docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in,
  docs/sudoers.man.in, docs/sudoers.mdoc.in, docs/sudoreplay.man.in,
  docs/sudoreplay.mdoc.in, docs/visudo.man.in, docs/visudo.mdoc.in,
  examples/sudo.conf.in, examples/sudo\_logsrvd.conf:

  Use the Oxford comma consistently, it is helpful in technical documents.
  [[0d0e7de45]](https://git.sudo.ws/sudo/commit/?id=0d0e7de45)

* INSTALL.md:

  Mention docker configuration.
  [[144e57832]](https://git.sudo.ws/sudo/commit/?id=144e57832)

* plugins/sudoers/ldap\_util.c:

  Quiet a cppcheck false positive.
  [[368e5d49e]](https://git.sudo.ws/sudo/commit/?id=368e5d49e)

* docs/CONTRIBUTING.md:

  Mention <https://www.sudo.ws/security/fuzzing/> in the fuzzing section.
  [[9a013b79b]](https://git.sudo.ws/sudo/commit/?id=9a013b79b)

* plugins/sudoers/sssd.c:

  Fix logic inversion when setting negated flag.
  [[08abeb94a]](https://git.sudo.ws/sudo/commit/?id=08abeb94a)

* src/sudo.c:

  Quiet a PVS-Studio format string warning.
  [[5e30d0120]](https://git.sudo.ws/sudo/commit/?id=5e30d0120)

2022-01-18 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Regen .pot files.
  [[c8b9f4ad1]](https://git.sudo.ws/sudo/commit/?id=c8b9f4ad1)

* NEWS:

  [Bug #1016](https://bugzilla.sudo.ws/show_bug.cgi?id=1016), #1017 and
  negated sudoUser in LDAP.
  [[3f8b7f6ea]](https://git.sudo.ws/sudo/commit/?id=3f8b7f6ea)

* plugins/sudoers/defaults.c:

  Don’t set/run early Defaults if a custom defaults\_list is specified.
  Defaults settings passed in by the front end are already “early” so
  there is no need to treat any of them as special.

  Otherwise, we end up running the early defaults callbacks before sudoers
  has been parsed. This means that, for instance, it is not possible to
  disable the fqdn flag before its callback is run if sudo is build with
  the –with-fqdn option. [Bug
  #1016](https://bugzilla.sudo.ws/show_bug.cgi?id=1016).
  [[e1c2288fb]](https://git.sudo.ws/sudo/commit/?id=e1c2288fb)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h:

  Mark is\_early\_default(), run\_early\_defaults(), set\_early\_default()
  static. They are not used outside of defaults.c.
  [[28cfe868e]](https://git.sudo.ws/sudo/commit/?id=28cfe868e)

* plugins/sudoers/sssd.c:

  Add support in SSSD for negated users.
  [[9bb3df748]](https://git.sudo.ws/sudo/commit/?id=9bb3df748)

* docs/sudoers.ldap.man.in, docs/sudoers.ldap.mdoc.in,
  plugins/sudoers/ldap.c:

  Add support in the LDAP filter for negated users. Based on a diff from
  Simon Lees
  [[e88087721]](https://git.sudo.ws/sudo/commit/?id=e88087721)

2022-01-12 Todd C. Miller

* lib/util/mkdir\_parents.c:

  Use PATH\_MAX, not NAME\_MAX+1 for the directory entry length. On some
  systems, such as Solaris, the max length of a directory entry is
  filesystem-dependent. We could use fpathconf() and dynamically allocate
  the name but it is simpler to just use PATH\_MAX here.
  [[1afce22f7]](https://git.sudo.ws/sudo/commit/?id=1afce22f7)

* plugins/python/python\_plugin\_common.c:

  Only emulate Py\_FinalizeEx for Python 3.[0-5].
  [[853e710f4]](https://git.sudo.ws/sudo/commit/?id=853e710f4)

* lib/util/getcwd.c, lib/util/mkdir\_parents.c:

  Use POSIX NAME\_MAX, not the obsolete MAXNAMLEN define. Fixes compilation
  with musl libc.
  [[1f098a202]](https://git.sudo.ws/sudo/commit/?id=1f098a202)

2022-01-11 Todd C. Miller

* src/limits.c:

  When applying fallback limits, make sure we don’t reduce rlim\_max. Fixes
  a problem where sudo could reduce the max stack size on some systems if
  the original limit was higher than the fallback limit, but not
  unlimited/infinity.
  [[757c3a1d3]](https://git.sudo.ws/sudo/commit/?id=757c3a1d3)

* src/limits.c:

  Don’t modify the stack limit if it is >= SUDO\_STACK\_MIN.
  [[1c95ab885]](https://git.sudo.ws/sudo/commit/?id=1c95ab885)

* plugins/sudoers/Makefile.in:

  The pre-install target requires visudo, add an explicit dependency.
  [[5fdaa4822]](https://git.sudo.ws/sudo/commit/?id=5fdaa4822)

2022-01-09 Todd C. Miller

* src/sudo.c:

  If sudo is not set-user-ID root, check for the no\_new\_privs flag on
  Linux. This flag disables set-user-ID at execve(2) time and may be set
  by default for some containers. [GitHub issue
  #129](https://github.com/sudo-project/sudo/issues/129).
  [[2e08db369]](https://git.sudo.ws/sudo/commit/?id=2e08db369)

2022-01-08 Todd C. Miller

* docs/sudoers.man.in, docs/sudoers.mdoc.in, plugins/sudoers/auth/pam.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h, src/parse\_args.c:

  Add pam\_askpass\_service sudoers setting for “sudo -A”. This makes it
  possible to use a different PAM configuration for when “sudo -A” is
  used. The main use case is to only use PAM modules that can interact
  with the askpass program. [GitHub issue
  #112](https://github.com/sudo-project/sudo/issues/112).
  [[48bc498a6]](https://git.sudo.ws/sudo/commit/?id=48bc498a6)

2022-01-07 Todd C. Miller

* lib/iolog/iolog\_loginfo.c:

  Improve debugging info when fdopen() fails.
  [[763256e46]](https://git.sudo.ws/sudo/commit/?id=763256e46)

2022-01-06 Todd C. Miller

* plugins/sudoers/sssd.c:

  sss\_sudo\_free\_values() checks for NULL, no need to do it manually.
  [[3b7d32b25]](https://git.sudo.ws/sudo/commit/?id=3b7d32b25)

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y:

  Quiet a clang analyzer false positive.
  [[8aec6c2a8]](https://git.sudo.ws/sudo/commit/?id=8aec6c2a8)

2022-01-05 Todd C. Miller

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y:

  Quiet a clang analyzer false positive.
  [[de7171ab6]](https://git.sudo.ws/sudo/commit/?id=de7171ab6)

* plugins/sudoers/auth/sudo\_auth.c:

  Fix return value for non-interactive mode for non-standalone auth
  methods. AUTH\_NONINTERACTIVE was being stored in the wrong variable.
  [[a2d27bc9e]](https://git.sudo.ws/sudo/commit/?id=a2d27bc9e)

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po, po/fi.mo, po/fi.po,
  po/ko.mo, po/ko.po, po/tr.mo, po/tr.po:

  Updated translations from translationproject.org
  [[513574ce1]](https://git.sudo.ws/sudo/commit/?id=513574ce1)

* plugins/sudoers/cvtsudoers\_merge.c:

  defaults\_var\_matches() should return bool, not enum match\_result. Remove
  enum match\_result as it is no longer used.
  [[d6ff97d83]](https://git.sudo.ws/sudo/commit/?id=d6ff97d83)

* plugins/sudoers/audit.c, plugins/sudoers/auth/sudo\_auth.c:

  Quiet two PVS-studio warnings.
  [[72989bf83]](https://git.sudo.ws/sudo/commit/?id=72989bf83)

* plugins/sudoers/auth/pam.c:

  Remove PAM\_TTY workaround for old, buggy PAM modules. In the past, some
  PAM modules assumed that PAM\_TTY was set and would misbehave (or crash)
  if not. This was primarily obsolete versions of Linux-PAM, so it should
  now be safe to remove this. Setting PAM\_TTY to an empty string can cause
  its own set of issues. [GitHub issue
  #74](https://github.com/sudo-project/sudo/issues/74)
  [[1b72f138e]](https://git.sudo.ws/sudo/commit/?id=1b72f138e)

2022-01-04 Todd C. Miller

* NEWS:

  Mention fix for [Bug #956](https://bugzilla.sudo.ws/show_bug.cgi?id=956)
  and [GitHub issue #83](https://github.com/sudo-project/sudo/issues/83).
  [[8c42a29a1]](https://git.sudo.ws/sudo/commit/?id=8c42a29a1)

* plugins/sudoers/auth/API, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/check.c,
  plugins/sudoers/logging.c, plugins/sudoers/sudoers.h:

  Push non-interactive mode checking down into the auth methods. For “sudo
  -n” we only want to reject a command if user input is actually required.
  In the case of PAM at least, we may not need to interact with the user.
  [Bug #956](https://bugzilla.sudo.ws/show_bug.cgi?id=956), [GitHub issue
  #83](https://github.com/sudo-project/sudo/issues/83)
  [[521ef37ae]](https://git.sudo.ws/sudo/commit/?id=521ef37ae)

2022-01-03 Todd C. Miller

* plugins/sudoers/cvtsudoers\_merge.c,
  plugins/sudoers/regress/cvtsudoers/sudoers1,
  plugins/sudoers/regress/cvtsudoers/sudoers2,
  plugins/sudoers/regress/cvtsudoers/sudoers3,
  plugins/sudoers/regress/cvtsudoers/test34.out.ok,
  plugins/sudoers/regress/cvtsudoers/test35.out.ok,
  plugins/sudoers/regress/cvtsudoers/test36.out.ok:

  userspec\_overridden: fix checks when there is more than one userspec
  [[296d876b7]](https://git.sudo.ws/sudo/commit/?id=296d876b7)

* MANIFEST, plugins/sudoers/cvtsudoers\_merge.c,
  plugins/sudoers/regress/cvtsudoers/test35.out.ok,
  plugins/sudoers/regress/cvtsudoers/test36.out.ok,
  plugins/sudoers/regress/cvtsudoers/test36.sh:

  Fix merging of global/ALL entries when each input file has a host. If a
  host is specified for the input file, cvtsudoers will bind global
  Defaults to that host and change host “ALL” in a userspec to the host
  name. However, if all the input files have matching hosts we can
  simplify the merged file by converting back to ALL after resolving
  conflicts.
  [[835079fa3]](https://git.sudo.ws/sudo/commit/?id=835079fa3)

* LICENSE.md:

  Welcome to 2022.
  [[d02ba52fa]](https://git.sudo.ws/sudo/commit/?id=d02ba52fa)

* docs/Makefile.in:

  LICENSE.md moved to the top-level src dir.
  [[59d55c530]](https://git.sudo.ws/sudo/commit/?id=59d55c530)

2021-12-22 Todd C. Miller

* :

  Merge pull request #127 from Tyler887/main

  Typo
  [[dabd8d80a]](https://git.sudo.ws/sudo/commit/?id=dabd8d80a)

2021-12-22 Tyler887

* INSTALL.md:

  Typo
  [[d9594cb21]](https://git.sudo.ws/sudo/commit/?id=d9594cb21)

2021-12-22 Todd C. Miller

* NEWS, docs/UPGRADE.md, plugins/sudoers/policy.c, src/selinux.c,
  src/sudo.c:

  Back out changes to enable SELinux by default. This may return in a
  future release in a different form.
  [[e22cc7253]](https://git.sudo.ws/sudo/commit/?id=e22cc7253)

* LICENSE.md, MANIFEST, README.md:

  Move LICENSE.md out of docs and back to the top-level. GitHub expects it
  to be in the top-level directory.
  [[0ed92e616]](https://git.sudo.ws/sudo/commit/?id=0ed92e616)

2021-12-20 Todd C. Miller

* MANIFEST, plugins/sudoers/cvtsudoers\_merge.c,
  plugins/sudoers/regress/cvtsudoers/test35.out.ok,
  plugins/sudoers/regress/cvtsudoers/test35.sh:

  cvtsudoers: fix a regression when merging matching Defaults. If a host
  is specified with a sudoers file, we have to treat Defaults as
  Defaults@host checking for duplicates.
  [[149e8208b]](https://git.sudo.ws/sudo/commit/?id=149e8208b)

2021-12-18 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  add\_defaults: add defs == NULL check to quiet coverity false positive
  [[4ffc3142c]](https://git.sudo.ws/sudo/commit/?id=4ffc3142c)

2021-12-17 Todd C. Miller

* plugins/sudoers/cvtsudoers\_merge.c,
  plugins/sudoers/regress/cvtsudoers/test34.out.ok,
  plugins/sudoers/regress/cvtsudoers/test34.sh:

  When merging Defaults, allow a subsequent global Defaults (no binding)
  to override a prior Defaults setting with a binding.
  [[dfc11d748]](https://git.sudo.ws/sudo/commit/?id=dfc11d748)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  add\_defaults: defs can never be NULL
  [[6a2c5043a]](https://git.sudo.ws/sudo/commit/?id=6a2c5043a)

* plugins/sudoers/cvtsudoers\_merge.c:

  Plug memory leak when making a default host-specific. We don’t need to
  allocate new space for the binding list, just the members of the list.
  [[546d4f624]](https://git.sudo.ws/sudo/commit/?id=546d4f624)

2021-12-16 Todd C. Miller

* MANIFEST, examples/Makefile.in, examples/cvtsudoers.conf:

  Add an example cvtsudoers.conf file.
  [[5d95345e6]](https://git.sudo.ws/sudo/commit/?id=5d95345e6)

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h:

  Add group\_file, match\_local, and passwd\_file to cvtsudoers.conf.
  Previously, these were only settable via command line options.
  [[991ef3250]](https://git.sudo.ws/sudo/commit/?id=991ef3250)

2021-12-12 Todd C. Miller

* docs/TROUBLESHOOTING.md:

  Remove question about running Solaris 11 binaries on Solaris 10. Current
  versions of sudo use many APIs that are not present on Solaris 10. If
  you want a sudo Solaris 10 binary, build it on Solaris 10, not 11.
  [[537f75dc7]](https://git.sudo.ws/sudo/commit/?id=537f75dc7)

* MANIFEST, plugins/sudoers/regress/cvtsudoers/test34.out.ok,
  plugins/sudoers/regress/cvtsudoers/test34.sh:

  Add simple test for cvtsudoers merge functionality.
  [[7158b03b5]](https://git.sudo.ws/sudo/commit/?id=7158b03b5)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/cs.mo,
  po/cs.po, po/de.mo, po/de.po, po/eo.mo, po/eo.po, po/fr.mo, po/fr.po,
  po/hr.mo, po/hr.po, po/ja.mo, po/ja.po, po/pl.mo, po/pl.po, po/sr.mo,
  po/sr.po, po/uk.mo, po/uk.po, po/zh\_CN.mo, po/zh\_CN.po, po/zh\_TW.mo,
  po/zh\_TW.po:

  Updated translations from translationproject.org
  [[955359af5]](https://git.sudo.ws/sudo/commit/?id=955359af5)

* MANIFEST, plugins/sudoers/po/es.mo, plugins/sudoers/po/es.po:

  Add sudoers Spanish translation from translationproject.org
  [[869994433]](https://git.sudo.ws/sudo/commit/?id=869994433)

2021-12-11 Todd C. Miller

* NEWS:

  Bugs #1013 and #1014
  [[7d7e24d16]](https://git.sudo.ws/sudo/commit/?id=7d7e24d16)

* lib/util/mkdir\_parents.c:

  sudo\_mkdir\_parents: make sure the path we created is a directory For
  extra paranoia, verify that the directory we created is still a
  directory before we fchown() it.
  [[c53192eb7]](https://git.sudo.ws/sudo/commit/?id=c53192eb7)

* docs/sudo.man.in, docs/sudo.mdoc.in:

  In SECURITY NOTES, clarify that PATH may be overridden by the policy.
  [Bug #1014](https://bugzilla.sudo.ws/show_bug.cgi?id=1014)
  [[e66e1ca38]](https://git.sudo.ws/sudo/commit/?id=e66e1ca38)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  include/sudo\_util.h, lib/util/Makefile.in, lib/util/mkdir\_parents.c,
  lib/util/mkdirat.c, logsrvd/logsrvd.c, plugins/sudoers/timestamp.c,
  scripts/mkdep.pl:

  Avoid TOCTOU in sudo\_mkdir\_parents() using openat(2) and mkdirat(2).
  This also allows us to make path const as it should be.
  [[c13b21c19]](https://git.sudo.ws/sudo/commit/?id=c13b21c19)

* plugins/sudoers/ldap\_conf.c, plugins/sudoers/sudo\_ldap\_conf.h:

  Sudo parsed “deref” and “tls\_reqcert” in ldap.conf but didn’t set the
  options. The switch() in the sudo\_ldap\_set\_options\_table() function
  needed to be updated to treat CONF\_DEREF\_VAL and CONF\_REQCERT\_VAL data
  types as int. Fix from Dennis Filder. [Bug
  #1013](https://bugzilla.sudo.ws/show_bug.cgi?id=1013).
  [[55db23924]](https://git.sudo.ws/sudo/commit/?id=55db23924)

2021-12-10 Todd C. Miller

* docs/SECURITY.md:

  Minor formatting tweak so we can import into the sudo web site.
  [[a2aa70970]](https://git.sudo.ws/sudo/commit/?id=a2aa70970)

* plugins/sudoers/defaults.c, plugins/sudoers/pwutil\_impl.c:

  Fix CodeQL “Multiplication result converted to larger type” warnings.
  [[83defd3a6]](https://git.sudo.ws/sudo/commit/?id=83defd3a6)

2021-12-09 Todd C. Miller

* docs/SECURITY.md:

  Surround email addresses with angle brackets, not square backets.
  [[014339948]](https://git.sudo.ws/sudo/commit/?id=014339948)

2021-12-08 Todd C. Miller

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po, po/fa.mo, po/fa.po,
  po/fi.mo, po/fi.po, po/ja.mo, po/ja.po, po/sr.mo, po/sr.po, po/zh\_CN.mo,
  po/zh\_CN.po, po/zh\_TW.mo, po/zh\_TW.po:

  Updated translations from translationproject.org
  [[3cd0ffade]](https://git.sudo.ws/sudo/commit/?id=3cd0ffade)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update .pot files for 1.9.9
  [[27121cff6]](https://git.sudo.ws/sudo/commit/?id=27121cff6)

2021-12-06 Todd C. Miller

* README.LDAP.md, docs/CONTRIBUTING.md, docs/TROUBLESHOOTING.md,
  docs/UPGRADE.md:

  Minor formatting tweaks.
  [[d324a5306]](https://git.sudo.ws/sudo/commit/?id=d324a5306)

2021-12-05 Todd C. Miller

* INSTALL, INSTALL.md, MANIFEST, README, README.LDAP.md, README.md,
  docs/CONTRIBUTING.md, docs/CONTRIBUTORS.md, docs/HISTORY.md,
  docs/LICENSE, docs/LICENSE.md, docs/Makefile.in, docs/TROUBLESHOOTING,
  docs/TROUBLESHOOTING.md, docs/UPGRADE, docs/UPGRADE.md,
  etc/sudo-logsrvd.pp, etc/sudo-python.pp, etc/sudo.pp:

  Convert README and docs files to markdown. This makes things look better
  on GitHub and we can use the markdown version directly in the new sudo
  web site.
  [[3bd572ba8]](https://git.sudo.ws/sudo/commit/?id=3bd572ba8)

2021-12-04 Todd C. Miller

* docs/SECURITY.md:

  Policy -> Disclosure Policy
  [[2c754a8d4]](https://git.sudo.ws/sudo/commit/?id=2c754a8d4)

* :

  Merge pull request #124 from juspence/main

  Allow sudo -g anyone and sudo -u anyone -g anytwo
  [[9497ab99c]](https://git.sudo.ws/sudo/commit/?id=9497ab99c)

2021-12-04 juspence

* plugins/sudoers/sudoers.in:

  Allow sudo -g anyone and sudo -u anyone -g anytwo

  When only the user (ALL) is specified explicitly, and the group is
  implied, only sudo -u works. Specifying both the user and group, like
  (ALL:ALL), is required to:

  1. Use sudo -g by itself (with no -u user) 2) Use sudo -u and -g
     together, with a -g group that is different from the -u user’s primary
     group
     [[1d13533ea]](https://git.sudo.ws/sudo/commit/?id=1d13533ea)

2021-12-02 Todd C. Miller

* lib/util/Makefile.in:

  Add build dir to include search path for mksiglist.h and mksigname.h
  Fixes out of tree builds on systems without sys\_siglist[] or
  sys\_signame[]. [GitHub issue
  #123](https://github.com/sudo-project/sudo/issues/123).
  [[aae130eb7]](https://git.sudo.ws/sudo/commit/?id=aae130eb7)

2021-11-29 Todd C. Miller

* MANIFEST, plugins/sudoers/cvtsudoers\_merge.c,
  plugins/sudoers/regress/cvtsudoers/sudoers1,
  plugins/sudoers/regress/cvtsudoers/sudoers2,
  plugins/sudoers/regress/cvtsudoers/sudoers3:

  cvtsudoers: better merging of lists that are not exact duplicates When
  merging rules, if one list would be overridden by another, remove the
  overridden rule and continue merging.
  [[0608a4ea6]](https://git.sudo.ws/sudo/commit/?id=0608a4ea6)

2021-11-28 Todd C. Miller

* NEWS:

  Update NEWS with latest changes.
  [[a9f3032b5]](https://git.sudo.ws/sudo/commit/?id=a9f3032b5)

2021-11-27 Todd C. Miller

* src/edit\_open.c:

  dir\_is\_writable: don’t treat EPERM from faccessat() as a fatal error. We
  can get EPERM on Linux with SELinux. [GitHub issue
  #122](https://github.com/sudo-project/sudo/issues/122).
  [[f9f39cde2]](https://git.sudo.ws/sudo/commit/?id=f9f39cde2)

2021-11-24 Todd C. Miller

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_merge.c:

  cvtsudoers: add -l option to log merge actions The “-l logfile” option
  can be used to store a log of what actions cvtsudoers took when merging
  multiple files. For example, which aliases were renamed, which entries
  were overriden or removed as duplicated.
  [[003f9550f]](https://git.sudo.ws/sudo/commit/?id=003f9550f)

* NEWS, configure, configure.ac:

  Sudo 1.9.9
  [[ce9c6d17c]](https://git.sudo.ws/sudo/commit/?id=ce9c6d17c)

2021-11-21 Todd C. Miller

* MANIFEST, docs/CONTRIBUTORS, po/fa.mo, po/fa.po:

  New Persian (Farsi) translation from translationproject.org
  [[409410b02]](https://git.sudo.ws/sudo/commit/?id=409410b02)

2021-11-20 Todd C. Miller

* plugins/sudoers/cvtsudoers\_csv.c:

  Quiet a PVS Studio warning. The warning that need\_comma is always false
  is correct but in this case it is better to use a consistent construct
  so that if the code is re-ordered no bugs are introduced.
  [[d83321388]](https://git.sudo.ws/sudo/commit/?id=d83321388)

* lib/util/getentropy.c:

  Pass correct size to free\_zero(). Coverity CID 241233
  [[dc5ac7424]](https://git.sudo.ws/sudo/commit/?id=dc5ac7424)

* plugins/sudoers/alias.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers\_csv.c, plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/cvtsudoers\_merge.c, plugins/sudoers/defaults.c,
  plugins/sudoers/fmtsudoers\_cvt.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/parse\_ldif.c:

  Add reference counting to Defaults bindings. Previously, we checked that
  the previous entry’s binding pointer was not the same while freeing.
  However, to be able to merge Defaults records we cannot rely on Defaults
  entries with the same binding being immediately adjacent. This removes
  the prev\_binding checks in favor of a reference count which allows us to
  plug the memory leak in cvtsudoers when merging Defaults.
  [[e64a089ae]](https://git.sudo.ws/sudo/commit/?id=e64a089ae)

2021-11-19 Todd C. Miller

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_merge.c:

  cvtsudoers: use init\_parse\_tree() to initialize a parse tree. Also free
  the parse tree before exit.
  [[aed51033e]](https://git.sudo.ws/sudo/commit/?id=aed51033e)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.h,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sssd.c:

  init\_parse\_tree() now takes ownership of lhost and shost, if any. This
  means that lhost and shost in struct sudoers\_parse\_tree are no longer
  const and that free\_parse\_tree() will free lhost/shost. The only
  consumer that passed in lho.st/shost was the SSSD back-end which has
  been updated to avoid a double-free.
  [[730ebabdb]](https://git.sudo.ws/sudo/commit/?id=730ebabdb)

* docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in:

  Document how to merge sudoers files with cvtsudoers.
  [[cc7903873]](https://git.sudo.ws/sudo/commit/?id=cc7903873)

* plugins/sudoers/cvtsudoers\_merge.c:

  cvtsudoers: merge userspecs when multiple sudoers files are specified If
  a hostname is specified with the sudoers file, it will be used to make
  the userspec host-specific, if possible. Duplicate userspecs are removed
  but conflicting entries are not currently pruned.
  [[f5c6e2df7]](https://git.sudo.ws/sudo/commit/?id=f5c6e2df7)

* plugins/sudoers/cvtsudoers\_merge.c:

  cvtsudoers: merge Defaults when multiple sudoers files are specified If
  a hostname is specified with the sudoers file, it will be used to make
  the Defaults setting host-specific, if possible. Duplicate Defaults
  settings are removed and conflicts are warned about. It is not possible
  to resolve all conflicts automatically.
  [[d31109ded]](https://git.sudo.ws/sudo/commit/?id=d31109ded)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/alias.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/cvtsudoers\_merge.c, plugins/sudoers/parse.h:

  cvtsudoers: merge aliases when multiple sudoers files are specified
  Duplicate aliases are remove. If there are conflicting alias names, the
  conflicts are renamed by appending a numerical suffix. For example, if
  there are two SERVERS Host\_Aliases, the second one will be renamed to
  SERVERS\_1.
  [[ab9e44a6c]](https://git.sudo.ws/sudo/commit/?id=ab9e44a6c)

2021-11-16 Todd C. Miller

* plugins/sudoers/cvtsudoers.c:

  Add support for specifying the hostname as a prefix to the sudoers file.
  If present, the host name is copied into the struct sudoers\_parse\_tree.
  [[33fbf5946]](https://git.sudo.ws/sudo/commit/?id=33fbf5946)

2021-11-11 Todd C. Miller

* plugins/sudoers/cvtsudoers.c:

  cvtsudoers: parse multiple sudoers files and store them in a tail queue
  In the future the parsed files will be merged before they are output.
  [[4cb34a201]](https://git.sudo.ws/sudo/commit/?id=4cb34a201)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.h, plugins/sudoers/gram.y, plugins/sudoers/parse.h:
  Add sudoers\_parse\_tree\_list, a tail queue of struct sudoers\_parse\_tree.
  This will be used to store multiple parse trees and merge them into a
  single sudoers\_parse\_tree.
  [[b1309f76d]](https://git.sudo.ws/sudo/commit/?id=b1309f76d)

2021-11-19 Todd C. Miller

* MANIFEST, Makefile.in, etc/macos-background.png, etc/sudo-logsrvd.pp,
  etc/sudo-python.pp, etc/sudo.pp:

  Add a background image for the macOS installer.
  [[7baee707b]](https://git.sudo.ws/sudo/commit/?id=7baee707b)

* scripts/pp:

  Update PolyPkg
  [[7b0b18699]](https://git.sudo.ws/sudo/commit/?id=7b0b18699)

2021-11-18 Todd C. Miller

* scripts/mkpkg:

  mkpkg: handle a macOS SDK that just uses the major version. For example,
  MacOSX11.sdk instead of MacOSX11.3.sdk.
  [[0a89b87a3]](https://git.sudo.ws/sudo/commit/?id=0a89b87a3)

* lib/util/Makefile.in:

  Add missing dependencies for timegm.
  [[70c0d35fa]](https://git.sudo.ws/sudo/commit/?id=70c0d35fa)

2021-11-11 Todd C. Miller

* docs/CONTRIBUTING.md:

  Fix formatting of links.
  [[3ab280fc6]](https://git.sudo.ws/sudo/commit/?id=3ab280fc6)

* MANIFEST, docs/CONTRIBUTING.md:

  Add contributing guide.
  [[781a4fb69]](https://git.sudo.ws/sudo/commit/?id=781a4fb69)

* .github/workflows/codeql-analysis.yml:

  Create codeql-analysis.yml
  [[658eba7ee]](https://git.sudo.ws/sudo/commit/?id=658eba7ee)

2021-11-10 Todd C. Miller

* MANIFEST, docs/SECURITY.md:

  Add security doc, inspired by the Microsoft template.
  [[85325a7d2]](https://git.sudo.ws/sudo/commit/?id=85325a7d2)

* .gitignore, .hgignore, INSTALL, MANIFEST, Makefile.in, README,
  configure, configure.ac, docs/CONTRIBUTORS, docs/HISTORY, docs/LICENSE,
  docs/Makefile.in, docs/TROUBLESHOOTING, docs/UPGRADE,
  docs/cvtsudoers.man.in, docs/cvtsudoers.mdoc.in, docs/fixman.sh,
  docs/fixmdoc.sed, docs/schema.ActiveDirectory, docs/schema.OpenLDAP,
  docs/schema.iPlanet, docs/schema.olcSudo, docs/sudo.conf.man.in,
  docs/sudo.conf.man.in.sed, docs/sudo.conf.mdoc.in, docs/sudo.man.in,
  docs/sudo.man.in.sed, docs/sudo.mdoc.in, docs/sudo\_logsrv.proto.man.in,
  docs/sudo\_logsrv.proto.mdoc.in, docs/sudo\_logsrvd.conf.man.in,
  docs/sudo\_logsrvd.conf.mdoc.in, docs/sudo\_logsrvd.man.in,
  docs/sudo\_logsrvd.mdoc.in, docs/sudo\_plugin.man.in,
  docs/sudo\_plugin.mdoc.in, docs/sudo\_plugin\_python.man.in,
  docs/sudo\_plugin\_python.mdoc.in, docs/sudo\_sendlog.man.in,
  docs/sudo\_sendlog.mdoc.in, docs/sudoers.ldap.man.in,
  docs/sudoers.ldap.mdoc.in, docs/sudoers.man.in, docs/sudoers.man.in.sed,
  docs/sudoers.mdoc.in, docs/sudoers\_timestamp.man.in,
  docs/sudoers\_timestamp.mdoc.in, docs/sudoreplay.man.in,
  docs/sudoreplay.mdoc.in, docs/visudo.man.in, docs/visudo.mdoc.in,
  etc/codespell.skip:

  Rename “doc” directory to “docs” for better GitHub compatibility.
  [[289a045a4]](https://git.sudo.ws/sudo/commit/?id=289a045a4)

* lib/util/Makefile.in:

  Use $(SED), not sed, when generating mksiglist.h/mksigname.h
  [[5faf46de6]](https://git.sudo.ws/sudo/commit/?id=5faf46de6)

* configure, configure.ac, lib/iolog/Makefile.in, lib/util/Makefile.in,
  logsrvd/Makefile.in, plugins/sudoers/Makefile.in:

  Add configure check for sha1sum and use “openssh dgst -sha1” if missing.
  Only needed when building the seed corpus zip files.
  [[09b82a22c]](https://git.sudo.ws/sudo/commit/?id=09b82a22c)

* include/sudo\_compat.h:

  sudo\_compat.h: include unistd.h regardless of OS type This helps to
  avoid issues with mismatched headers and libraries.
  [[c2d03f7cc]](https://git.sudo.ws/sudo/commit/?id=c2d03f7cc)

2021-11-09 Todd C. Miller

* plugins/sudoers/visudo.c:

  install\_sudoers: fix return value when there is no temp file to install
  This can happen when no changes were made. Also preserve the edited temp
  file on error if we are unable to move it into place.
  [[55d17eaa3]](https://git.sudo.ws/sudo/commit/?id=55d17eaa3)

* plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stdout:

  Bump plugin version in test data to 1.18.
  [[def7a51f4]](https://git.sudo.ws/sudo/commit/?id=def7a51f4)

* plugins/sudoers/defaults.c:

  free\_defs\_val: free rlimits like strings (which they are).
  [[8e656b63c]](https://git.sudo.ws/sudo/commit/?id=8e656b63c)

* plugins/sudoers/visudo.c:

  Rename {check,set}\_perms variable to {check,set}\_mode. Avoids a name
  clash with the set\_perms() function.
  [[288bb8254]](https://git.sudo.ws/sudo/commit/?id=288bb8254)

* src/edit\_open.c:

  Avoid symbol name clash with is\_writable() function variable. Rename
  “is\_writable” variable to “writable”.
  [[7085a6447]](https://git.sudo.ws/sudo/commit/?id=7085a6447)

* doc/UPGRADE:

  Mention that the core dump size resource limit now defaults to 0.
  [[03927f998]](https://git.sudo.ws/sudo/commit/?id=03927f998)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document new resource limit settings.
  [[6f7f8601e]](https://git.sudo.ws/sudo/commit/?id=6f7f8601e)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, include/sudo\_plugin.h,
  src/exec.c:

  Document resource limit support in command\_info[] and Bump plugin API
  minor. This is supported beginning with sudo 1.9.9 and plugin API 1.17.
  [[7c8746bc7]](https://git.sudo.ws/sudo/commit/?id=7c8746bc7)

2021-11-08 Todd C. Miller

* config.h.in, configure, configure.ac, plugins/sudoers/defaults.c,
  src/limits.c:

  Use strtoul() on systems without strtoull(). We can assume that systems
  without strtoull() have 32-bit resource limits.
  [[19065cb22]](https://git.sudo.ws/sudo/commit/?id=19065cb22)

* src/exec.c, src/limits.c, src/sudo.c, src/sudo.h:

  Add front-end support for setting resouce limits. The special value
  “user” means preserve the invoking user’s limit. The value “default”
  means don’t override the default limit for the user as assigned by the
  system (PAM, loging.conf, userdb, etc).
  [[74ef983f6]](https://git.sudo.ws/sudo/commit/?id=74ef983f6)

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/defaults.h, plugins/sudoers/mkdefaults,
  plugins/sudoers/policy.c:

  Add basic support for setting resource limits in sudoers. The default
  for rlimit\_core is “0,0” Resource limits are passed back to the
  front-end in command\_info[] when set.
  [[f279df5e1]](https://git.sudo.ws/sudo/commit/?id=f279df5e1)

* src/edit\_open.c:

  switch\_user\_nonfatal: only define if using faccessat()
  [[9c465f84a]](https://git.sudo.ws/sudo/commit/?id=9c465f84a)

2021-11-06 Todd C. Miller

* doc/visudo.man.in, doc/visudo.mdoc.in, plugins/sudoers/visudo.c:

  visudo: add -O and -P options to check/set owner and permissions. This
  can be used in conjunction with the -c option to check that the sudoers
  file ownership and permissions are correct. [Bug
  #1007](https://bugzilla.sudo.ws/show_bug.cgi?id=1007)
  [[cdd41af66]](https://git.sudo.ws/sudo/commit/?id=cdd41af66)

2021-11-05 Todd C. Miller

* doc/UPGRADE:

  UPGRADE: mention SELinux behavior change.
  [[78709eaee]](https://git.sudo.ws/sudo/commit/?id=78709eaee)

* src/selinux.c, src/sudo.h, src/sudo\_edit.c:

  Rename selinux\_setcon -> selinux\_setexeccon
  [[22d624c02]](https://git.sudo.ws/sudo/commit/?id=22d624c02)

* src/selinux.c:

  In the SELinux role is “unconfined\_r”, disable SELinux support. We only
  want to apply SELinux to confined users. This is a bit of a hack as
  unconfined\_r is specific to the targeted policy.
  [[e92c3d841]](https://git.sudo.ws/sudo/commit/?id=e92c3d841)

* src/exec\_monitor.c, src/exec\_nopty.c, src/selinux.c, src/sudo.c,
  src/sudo.h, src/sudo\_edit.c:

  Separate out the code to compute the context from selinux\_setup(). This
  makes it possible to determine whether we really need to execute the
  command via the sesh helper. What was left of selinux\_setup() is now
  selinux\_relabel\_tty() and selinux\_audit\_role\_change().
  [[e97fb5fd0]](https://git.sudo.ws/sudo/commit/?id=e97fb5fd0)

* plugins/sudoers/policy.c, src/selinux.c, src/sudo.c:

  Pass status of selinux sudoers setting to front-end as selinux-rbac. The
  front-end uses this to decide whether or not to enable SELinux. If
  selinux-rbac is true *or* if it is not present and selinux\_role or
  selinux\_type are set, SELinux support is enabled. Previously, SELinux
  support was only enabled if a role was specified.
  [[a336a8422]](https://git.sudo.ws/sudo/commit/?id=a336a8422)

2021-11-01 Todd C. Miller

* src/selinux.c:

  Make get\_exec\_context static, it is unused outside selinux.c.
  [[680463259]](https://git.sudo.ws/sudo/commit/?id=680463259)

2021-11-05 Todd C. Miller

* src/edit\_open.c:

  dir\_is\_writable: add fallback if changing UIDs fails The SELinux policy
  may not allow uid/gid changes which will break the writability checks
  and cause sudoedit to fail.
  [[a527d6dfd]](https://git.sudo.ws/sudo/commit/?id=a527d6dfd)

2021-11-04 Todd C. Miller

* scripts/mkpkg:

  Build python package on Fedora
  [[733fe4bd1]](https://git.sudo.ws/sudo/commit/?id=733fe4bd1)

2021-11-01 Todd C. Miller

* doc/sudo.conf.mdoc.in:

  Fix lint warning: skipping paragraph macro: Pp before Bd
  [[ff888e700]](https://git.sudo.ws/sudo/commit/?id=ff888e700)

2021-10-31 Todd C. Miller

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in:

  Escape some minus signs (’-’) as required by newer groff.
  [[4e1e07b88]](https://git.sudo.ws/sudo/commit/?id=4e1e07b88)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/timegm.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/gentime.c, plugins/sudoers/parse.h, scripts/mkdep.pl:

  parse\_gentime: use timegm() to generate time since the epoch The
  timegm() function is non-standard but widely available. Provide an
  implementation for those systems that lack it. [Bug
  #1006](https://bugzilla.sudo.ws/show_bug.cgi?id=1006)
  [[4eebd53bc]](https://git.sudo.ws/sudo/commit/?id=4eebd53bc)

* include/sudo\_compat.h, lib/util/Makefile.in, scripts/mkdep.pl:

  Fix pasto in gmtime\_r and localtime\_r macros. Also add missing Makefile
  targets for them.
  [[b506497fe]](https://git.sudo.ws/sudo/commit/?id=b506497fe)

* plugins/sudoers/gmtoff.c:

  Take daylight saving time into consideration when computing offset.
  Otherwise, the resulting time may be off by and hour, depending on
  whether DST is currently active compared to the target time.
  [[dcd2199f7]](https://git.sudo.ws/sudo/commit/?id=dcd2199f7)

2021-10-29 Todd C. Miller

* scripts/mkpkg:

  Back out f2d82771e7dd, arm64e on macOS is still in preview state. Until
  arm64e on macOS is finalized, continue to build arm64 packages.
  [[12c8dba4c]](https://git.sudo.ws/sudo/commit/?id=12c8dba4c)

2021-10-27 Todd C. Miller

* scripts/mkpkg:

  Build arm64e ABI binaries on macOS 11 and above. We originally used
  arm64 here but the correct ABI is arm64e. The arm64 arch will be removed
  in a future release.
  [[491aee866]](https://git.sudo.ws/sudo/commit/?id=491aee866)

* logsrvd/logsrvd\_local.c:

  Use iolog\_openat() when opening the log.json file in the I/O log dir.
  [[7c4c61be0]](https://git.sudo.ws/sudo/commit/?id=7c4c61be0)

2021-10-26 Todd C. Miller

* logsrvd/tls\_init.c:

  Use BIO\_new\_file() not BIO\_new\_fd() to read dhparams file. Older
  versions of OpenSSL and wolfSSL lack BIO\_new\_fd(). Also explicitly
  include openssl/bio.h and openssl/dh.h for wolfSSL.
  [[ed13faf9f]](https://git.sudo.ws/sudo/commit/?id=ed13faf9f)

* INSTALL, config.h.in, configure, configure.ac:

  wolfSSL not WolfSSL
  [[fc5fa1bbd]](https://git.sudo.ws/sudo/commit/?id=fc5fa1bbd)

* .circleci/config.yml:

  Add wolfSSL variant to continuous integration tests.
  [[77048c119]](https://git.sudo.ws/sudo/commit/?id=77048c119)

* docker/debian/latest/Dockerfile, docker/debian/testing/Dockerfile,
  docker/ubuntu/devel/Dockerfile, docker/ubuntu/latest/Dockerfile,
  docker/ubuntu/rolling/Dockerfile:

  Add libwolfssl-dev to Debian and Ubuntu Dockerfiles Fedora does not
  appear to have an official wolfssl package.
  [[21c240d80]](https://git.sudo.ws/sudo/commit/?id=21c240d80)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  White space in an include file path supported by sudo 1.9.1 or higher.
  [[094f4dac5]](https://git.sudo.ws/sudo/commit/?id=094f4dac5)

2021-10-25 Todd C. Miller

* INSTALL, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/iolog/hostcheck.c, lib/util/digest\_openssl.c, lib/util/getentropy.c,
  logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_relay.c,
  logsrvd/sendlog.c, logsrvd/sendlog.h, logsrvd/tls\_client.c,
  logsrvd/tls\_common.h, logsrvd/tls\_init.c, plugins/sudoers/log\_client.c,
  plugins/sudoers/log\_client.h:

  Add support for WolfSSL’s OpenSSL compatibility layer. Based on changes
  from Hayden Roche
  [[cc6157d7d]](https://git.sudo.ws/sudo/commit/?id=cc6157d7d)

* lib/util/Makefile.in, plugins/sudoers/Makefile.in:

  regenerate dependencies
  [[465bfbba7]](https://git.sudo.ws/sudo/commit/?id=465bfbba7)

* logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_conf.c, logsrvd/logsrvd\_journal.c,
  logsrvd/logsrvd\_local.c, logsrvd/logsrvd\_queue.c,
  logsrvd/logsrvd\_relay.c, logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c,
  logsrvd/sendlog.c, logsrvd/sendlog.h:

  Move include of log\_server.pb-c.h into logsrvd.h and sendlog.h This way
  there is no include file order issue with the PROTOBUF\_C\_VERSION\_NUMBER
  check.
  [[87c1dd9d7]](https://git.sudo.ws/sudo/commit/?id=87c1dd9d7)

* docker/debian/latest/Dockerfile, docker/debian/testing/Dockerfile,
  docker/fedora/latest/Dockerfile, docker/fedora/rawhide/Dockerfile,
  docker/ubuntu/devel/Dockerfile, docker/ubuntu/latest/Dockerfile,
  docker/ubuntu/rolling/Dockerfile:

  Add pkg-config to all Dockerfile
  [[1dbf95645]](https://git.sudo.ws/sudo/commit/?id=1dbf95645)

2021-10-24 Todd C. Miller

* logsrvd/tls\_init.c:

  Use SSL\_FILETYPE\_PEM with SSL\_CTX\_use\_PrivateKey\_file, not
  X509\_FILETYPE\_PEM While they are defined to the same value in OpenSSL
  one should not rely on this.
  [[8a9c8794d]](https://git.sudo.ws/sudo/commit/?id=8a9c8794d)

2021-10-23 Todd C. Miller

* configure, configure.ac:

  Fix setting \_PATH\_ASAN\_LIB, need to double up the square brackets.
  [[a808f8e7e]](https://git.sudo.ws/sudo/commit/?id=a808f8e7e)

* logsrvd/sendlog.c:

  sudo\_sendlog: send runenv, rungid and runuid from log.json too With this
  change, sudo\_sendlog can now round-trip sudo-style I/O logs that use the
  newer log.json format without losing any information.
  [[e73e9d5e4]](https://git.sudo.ws/sudo/commit/?id=e73e9d5e4)

2021-10-22 Todd C. Miller

* config.h.in, configure, configure.ac, lib/util/arc4random.c:

  arc4random: need to include sys/random.h on Solaris too. This was
  removed when Linux genentropy() was disabled.
  [[ef3eb25a1]](https://git.sudo.ws/sudo/commit/?id=ef3eb25a1)

2021-10-21 Todd C. Miller

* lib/iolog/hostcheck.c, lib/util/inet\_ntop.c, logsrvd/logsrv\_util.h,
  plugins/sudoers/log\_client.h:

  Make sure INET\_ADDRSTRLEN and INET6\_ADDRSTRLEN are defined.
  [[88c577171]](https://git.sudo.ws/sudo/commit/?id=88c577171)

* plugins/sudoers/audit.c, plugins/sudoers/iolog.c,
  plugins/sudoers/log\_client.c, plugins/sudoers/log\_client.h,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h:

  Only include log\_client.h if SUDOERS\_LOG\_CLIENT is defined.
  [[00f0c233b]](https://git.sudo.ws/sudo/commit/?id=00f0c233b)

* :

  Merge pull request #118 from larb0b/main

  Define MAP\_FAILED where relevant if undefined
  [[cf47187eb]](https://git.sudo.ws/sudo/commit/?id=cf47187eb)

2021-10-21 Larkin Nickle

* lib/util/getentropy.c, lib/util/regress/mktemp/mktemp\_test.c,
  lib/util/snprintf.c:

  Define MAP\_FAILED where relevant if undefined

  On systems such as HP-UX 10.20, MAP\_FAILED is not defined.
  [[07bdfeedb]](https://git.sudo.ws/sudo/commit/?id=07bdfeedb)

2021-10-20 Todd C. Miller

* configure, m4/libtool.m4:

  Improve macOS version detection to support macOS 11 and simplify legacy
  logic From Jeremy Huddleston Sequoia
  [[cccefb962]](https://git.sudo.ws/sudo/commit/?id=cccefb962)

* logsrvd/sendlog.c:

  sudo\_sendlog: send multiple I/O log records together if possible Try to
  fill the write buffer and then send to the server instead of sending
  records one at a time.
  [[14873832c]](https://git.sudo.ws/sudo/commit/?id=14873832c)

* logsrvd/sendlog.c, logsrvd/sendlog.h:

  sudo\_sendlog: support multiple write buffers like sudo\_logsrvd
  [[1a26d2c88]](https://git.sudo.ws/sudo/commit/?id=1a26d2c88)

* configure, configure.ac, lib/util/Makefile.in:

  Always link libsudo\_util.so with libcrypto.so if using OpenSSL. We may
  need to use RAND\_bytes() in the getentropy() emulation.
  [[9fbbca7b7]](https://git.sudo.ws/sudo/commit/?id=9fbbca7b7)

* config.h.in, configure, configure.ac, lib/util/getentropy.c,
  plugins/sudoers/boottime.c:

  Add an explicit check for sys/sysctl.h. This test needs to be done after
  AC\_LANG\_WERROR to avoid including sys/sysctl.h on systems where it is
  marked as deprecated via a #warning directive.
  [[23eef895f]](https://git.sudo.ws/sudo/commit/?id=23eef895f)

* config.h.in, configure, configure.ac, lib/util/arc4random.c:

  Use our own getentropy() by default on Linux. The glibc getentropy()
  emulation will fail on older kernels that don’t support getrandom().
  Also use sudo\_fatal() instead of sending SIGKILL on getentropy()
  failure. [GitHub issue
  #117](https://github.com/sudo-project/sudo/issues/117).
  [[00e53b32e]](https://git.sudo.ws/sudo/commit/?id=00e53b32e)

* lib/util/getentropy.c:

  Use the OpenSSL RAND\_bytes() function if getrandom() fails.
  [[de4fd4a31]](https://git.sudo.ws/sudo/commit/?id=de4fd4a31)

* lib/util/Makefile.in, lib/util/arc4random\_buf.c, scripts/mkdep.pl:

  Fix compilation of standalone arc4random\_buf(). Apparently this code was
  never compiled anywhere.
  [[badd6267b]](https://git.sudo.ws/sudo/commit/?id=badd6267b)

* lib/util/uuid.c:

  sudo\_uuid\_create: no longer need a union for the uuid.
  [[9dd630494]](https://git.sudo.ws/sudo/commit/?id=9dd630494)

2021-10-19 Todd C. Miller

* lib/eventlog/eventlog\_free.c:

  eventlog\_free: free signal\_name too
  [[803fc56be]](https://git.sudo.ws/sudo/commit/?id=803fc56be)

* lib/iolog/regress/fuzz/fuzz\_iolog\_json.dict:

  Add new log.json keywords
  [[f49c7ac5a]](https://git.sudo.ws/sudo/commit/?id=f49c7ac5a)

* lib/iolog/regress/fuzz/fuzz\_iolog\_json.c:

  fuzz\_iolog\_json: initialize exit\_value to -1
  [[89b53d5ed]](https://git.sudo.ws/sudo/commit/?id=89b53d5ed)

* logsrvd/logsrvd.c:

  Fix potential use-after-free when calling iolog\_flush\_all(). We need to
  call iolog\_flush\_all() *before* scheduling the commit point. If we fail
  to schedule to commit point, the closure will be freed. Coverity CID
  220557
  [[02e77e656]](https://git.sudo.ws/sudo/commit/?id=02e77e656)

* logsrvd/sendlog.c:

  sendlog: use runargv from log.json if available
  [[5eebc3098]](https://git.sudo.ws/sudo/commit/?id=5eebc3098)

* logsrvd/sendlog.c:

  sudo\_sendlog: send exit data in eventlog if present
  [[a71d1f7ce]](https://git.sudo.ws/sudo/commit/?id=a71d1f7ce)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  logsrvd/logsrvd\_local.c, plugins/sudoers/logging.c:

  No longer need to pass exit params to eventlog\_exit(), use struct
  eventlog. Now that struct eventlog includes the exit parameters we can
  simplify how eventlog\_exit() is called.
  [[bddf03fe4]](https://git.sudo.ws/sudo/commit/?id=bddf03fe4)

* include/sudo\_eventlog.h, lib/iolog/iolog\_json.c,
  lib/iolog/iolog\_loginfo.c, logsrvd/iolog\_writer.c:

  Read command run\_time, signal and exit\_value from I/O log log.json file.
  [[d415624ff]](https://git.sudo.ws/sudo/commit/?id=d415624ff)

* logsrvd/logsrvd\_local.c:

  Log the command run-time and exit status in the I/O log.
  [[d21c935a1]](https://git.sudo.ws/sudo/commit/?id=d21c935a1)

2021-10-18 Todd C. Miller

* lib/eventlog/eventlog.c, logsrvd/logsrvd\_local.c:

  Handle a missing run\_time in an ExitMessage. It is now possible to pass
  a NULL run\_time to eventlog\_exit().
  [[77c339858]](https://git.sudo.ws/sudo/commit/?id=77c339858)

2021-10-19 Todd C. Miller

* lib/eventlog/eventlog.c:

  format\_json: fix pasto when setting dumped\_core boolean
  [[f73bc6dee]](https://git.sudo.ws/sudo/commit/?id=f73bc6dee)

2021-10-16 Todd C. Miller

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  logsrvd/logsrvd.c:

  No need to flush logs before commit point if we flush after each write.
  Also document that logs are flushed before sending a commit point even
  when flushing is disabled.
  [[15b4427b9]](https://git.sudo.ws/sudo/commit/?id=15b4427b9)

2021-10-15 Todd C. Miller

* MANIFEST, include/sudo\_iolog.h, lib/iolog/Makefile.in,
  lib/iolog/iolog\_conf.c, lib/iolog/iolog\_flush.c, logsrvd/iolog\_writer.c,
  logsrvd/logsrvd.c, logsrvd/logsrvd.h:

  Flush I/O logs before we send a commit point. The commit point message
  means we have written the data to disk so we should not be buffering it
  any longer. We do not currently fsync(2) the data after flushing,
  perhaps we should.
  [[a554629d8]](https://git.sudo.ws/sudo/commit/?id=a554629d8)

* logsrvd/logsrv\_util.c:

  Do not treat a resume point of [0, 0] as an error. If the connecton is
  interrupted before sudo sends back a commit\_point message, resuming at
  [0, 0] is correct. Also add a warning on unexpected EOF parsing the
  timing file.
  [[3e4f6aa2e]](https://git.sudo.ws/sudo/commit/?id=3e4f6aa2e)

2021-10-11 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Display a more helpful message if the user tries to run “sudo cd”. Since
  “cd” is a shell built-in command it cannot be run directly via sudo. The
  user either needs to spawn a shell via “sudo -s” or use the -D option to
  run a command in a specific directory.
  [[369d21323]](https://git.sudo.ws/sudo/commit/?id=369d21323)

* configure, configure.ac:

  Don’t install sudoers.a when configured with –enable-static-sudoers. We
  already avoid installing it when –disable-shared-util is specified.
  [[64e579831]](https://git.sudo.ws/sudo/commit/?id=64e579831)

2021-10-10 Todd C. Miller

* scripts/mkpkg:

  mkpkg: preserve make exit value on exit Fixes a problem where the exit
  value from mkpkg was 0 even on error.
  [[7a56c9871]](https://git.sudo.ws/sudo/commit/?id=7a56c9871)

* plugins/sudoers/cvtsudoers\_csv.c:

  Fix typos in SELinux and Solaris priv support.
  [[4b7b3c05e]](https://git.sudo.ws/sudo/commit/?id=4b7b3c05e)

* MANIFEST, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers.h, plugins/sudoers/cvtsudoers\_csv.c:

  cvtsudoers: initial support for CSV output For CSV output we double
  quotes strings that contain commas. For each literal double quote
  character present inside the string, two double quotes are output.
  [[430048d16]](https://git.sudo.ws/sudo/commit/?id=430048d16)

* lib/iolog/Makefile.in, lib/util/Makefile.in, logsrvd/Makefile.in,
  plugins/sudoers/Makefile.in:

  regenerate dependencies
  [[de5ca187b]](https://git.sudo.ws/sudo/commit/?id=de5ca187b)

* docker/README, etc/codespell.ignore:

  Fix typo and avoid a codespell false positive.
  [[a4fb31aa0]](https://git.sudo.ws/sudo/commit/?id=a4fb31aa0)

2021-10-08 Todd C. Miller

* .circleci/config.yml:

  Add build-nointercept and test-nointercept
  [[032575f57]](https://git.sudo.ws/sudo/commit/?id=032575f57)

2021-10-07 Todd C. Miller

* .circleci/config.yml:

  circleci: test multiple build options We now do separate builds with
  LDAP/SSSD enabled, logsrv client/server disabled, and static-sudoers
  enabled.
  [[25129cb77]](https://git.sudo.ws/sudo/commit/?id=25129cb77)

* configure, configure.ac, plugins/sudoers/Makefile.in:

  Fix fuzzer build with when –enable-static-sudoers is used. This
  introduces a sudoers-specific version of LT\_STATIC instead of appending
  the –tag=disable-shared to SUDOERS\_LDFLAGS. I’ve also removed the
  -static flag as it should not be needed.
  [[eaee7a0eb]](https://git.sudo.ws/sudo/commit/?id=eaee7a0eb)

2021-10-05 Todd C. Miller

* docker/README:

  Mention –security-opt=seccomp=unconfined workaround for bleeding edge.
  May be needed for Fedora rawhide and Ubuntu testing, among others.
  [[f6fc70e5d]](https://git.sudo.ws/sudo/commit/?id=f6fc70e5d)

* configure, configure.ac:

  Try to handle the case where libasan.so is a linker script. Fixes
  check\_noexec with ASAN on Fedora where libasan.so just includes the
  actual library file.
  [[8350307a2]](https://git.sudo.ws/sudo/commit/?id=8350307a2)

* .circleci/config.yml, docker/README, docker/fedora/latest/Dockerfile,
  docker/fedora/rawhide/Dockerfile:

  Enable address and undefined behavior sanitizers in CI builds. We need
  to disable leak sanitizer during “make check” because it uses ptrace
  which is not allowed for unprivileged containers.
  [[850804472]](https://git.sudo.ws/sudo/commit/?id=850804472)

2021-10-04 Todd C. Miller

* .circleci/config.yml:

  Switch to Ubuntu latest for circleci build.
  [[49611d6cc]](https://git.sudo.ws/sudo/commit/?id=49611d6cc)

* .circleci/config.yml, docker/debian/latest/Dockerfile,
  docker/debian/testing/Dockerfile, docker/fedora/latest/Dockerfile,
  docker/fedora/rawhide/Dockerfile, docker/ubuntu/devel/Dockerfile,
  docker/ubuntu/latest/Dockerfile, docker/ubuntu/rolling/Dockerfile:

  Add build user for circleci instead of running as root.
  [[3fa025281]](https://git.sudo.ws/sudo/commit/?id=3fa025281)

* .circleci/config.yml, MANIFEST, docker/README,
  docker/debian/latest/Dockerfile, docker/debian/testing/Dockerfile,
  docker/fedora/latest/Dockerfile, docker/fedora/rawhide/Dockerfile,
  docker/ubuntu/devel/Dockerfile, docker/ubuntu/latest/Dockerfile,
  docker/ubuntu/rolling/Dockerfile:

  Use circleci for continuous integegration. Build container descriptions
  are in the new docker directory.
  [[8d98a447c]](https://git.sudo.ws/sudo/commit/?id=8d98a447c)

2021-10-03 Todd C. Miller

* .gitignore, .hgignore:

  Update ignore file.
  [[a02af3a45]](https://git.sudo.ws/sudo/commit/?id=a02af3a45)

2021-10-01 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Sync “sudo -l” output with normal sudo log format. It now prints
  runchroot and runcwd (falling back on cwd). As a result, submithost is
  now printed first, matching sudo. Also avoid printing NULL pointers and
  skip entries that don’t have at least command, submituser and runuser
  set.
  [[4e4b506f2]](https://git.sudo.ws/sudo/commit/?id=4e4b506f2)

* lib/iolog/iolog\_json.c:

  iolog\_parse\_json\_object: optimize for large argv
  [[3575e995a]](https://git.sudo.ws/sudo/commit/?id=3575e995a)

2021-09-29 Todd C. Miller

* configure, configure.ac:

  Add “-fcf-protection” to SSP\_CFLAGS and SSP\_LDFLAGS if supported. Can be
  disabled via –disable-hardening.
  [[c5f983c64]](https://git.sudo.ws/sudo/commit/?id=c5f983c64)

* configure, configure.ac:

  Add “-z now” to hardened link options if supported. Can be disabled via
  –disable-hardening.
  [[edf30c727]](https://git.sudo.ws/sudo/commit/?id=edf30c727)

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/editor.c,
  plugins/sudoers/regress/editor/check\_editor.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/visudo.c:

  find\_editor: remove the env\_error argument There is no case where we
  should fail to find an editor just because the values of EDITOR, VISUAL
  and SUDO\_EDITOR are unavailable. Both sudoedit and the “env\_editor”
  sudoers setting are documented as falling back on the hard-coded list of
  editors in the “editors” sudoers setting. [Bug
  #1000](https://bugzilla.sudo.ws/show_bug.cgi?id=1000)
  [[d15e117c2]](https://git.sudo.ws/sudo/commit/?id=d15e117c2)

* plugins/sudoers/check\_aliases.c:

  Use sudo\_printf(SUDO\_CONV\_ERROR\_MSG) instead of fprintf(stderr). Avoids
  extraneous output in the fuzzer.
  [[dde951a09]](https://git.sudo.ws/sudo/commit/?id=dde951a09)

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Stub out sudo\_printf() and avoid other use of stderr in fuzzers. This
  makes it possible to parse sudoers without using quiet mode, resulting
  in better coverage.
  [[2aa6cb13a]](https://git.sudo.ws/sudo/commit/?id=2aa6cb13a)

2021-09-28 Todd C. Miller

* lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.c,
  logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Use a consistent version of fuzz\_conversation() with all fuzzers. Also
  undo a change to fuzz\_sudoers.c that snuck in to the last commit.
  [[eefb7b0d5]](https://git.sudo.ws/sudo/commit/?id=eefb7b0d5)

* lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.c,
  logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Fuzzers should not produce output. Excessive output makes the fuzzer
  runs much less efficient.
  [[7d964875d]](https://git.sudo.ws/sudo/commit/?id=7d964875d)

* logsrvd/logsrv\_util.c:

  expand\_buf: fix conditional for when we need to preserve existing data
  It is possible for the buffer offset to be zero when the length is
  non-zero. The proper value to use is the same as is used for the
  memcpy/memmove size. Fixes buffer corruption caused by a very long
  command line that usually results in a dropped connection.
  [[dea7e6aef]](https://git.sudo.ws/sudo/commit/?id=dea7e6aef)

2021-09-27 Todd C. Miller

* config.h.in, configure, configure.ac, lib/util/closefrom.c:

  Emulate closefrom() on macOS using proc\_pidinfo(). This avoids relying
  on /dev/fd which may not exist in a chroot jail. Adapted from a change
  in OpenSSH by likan\_999.student AT sina.com
  [[476f00b82]](https://git.sudo.ws/sudo/commit/?id=476f00b82)

2021-09-26 Todd C. Miller

* src/edit\_open.c:

  Handle EMLINK and EFTYPE errno values for O\_NOFOLLOW failure. FreeBSD
  returns EMLINK and NetBSD returns EFTYPE instead of ELOOP. This is only
  used to present the user with a more appropriate error message.
  [[73e9256f9]](https://git.sudo.ws/sudo/commit/?id=73e9256f9)

2021-09-24 Todd C. Miller

* plugins/sudoers/cvtsudoers.c:

  Fix typo in last commit, use boolean AND not bitwise.
  [[1d203c834]](https://git.sudo.ws/sudo/commit/?id=1d203c834)

* doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.h:
  Add the ability to filter/match by command via the -m option. For
  example “cvtsudoers -m cmd=/bin/ls” would only display entries that
  would allow /bin/ls to be allowed or denied.
  [[1831176a1]](https://git.sudo.ws/sudo/commit/?id=1831176a1)

2021-09-23 Todd C. Miller

* doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers.h, plugins/sudoers/pwutil.c:

  Add –group-file and –passwd-file options to cvtsudoers. These are
  based on the code in testsudoers.
  [[41f116050]](https://git.sudo.ws/sudo/commit/?id=41f116050)

2021-09-22 Todd C. Miller

* lib/util/mkdir\_parents.c:

  Move cppcheck suppression annotation to where it needs to be.
  [[a7367ce47]](https://git.sudo.ws/sudo/commit/?id=a7367ce47)

* lib/util/mksigname.c:

  format string fix: print signal number as unsigned. Quiets a cppcheck
  warning; mksiglist.c already has this fixed.
  [[99655f28d]](https://git.sudo.ws/sudo/commit/?id=99655f28d)

* plugins/sudoers/ldap\_util.c:

  Fix memory leak on error path if snprintf() overflows. Coverity CID
  188804
  [[86df86ed9]](https://git.sudo.ws/sudo/commit/?id=86df86ed9)

2021-09-21 Todd C. Miller

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c:

  Avoid reinitializing other auth methods.
  [[b9b845183]](https://git.sudo.ws/sudo/commit/?id=b9b845183)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  expand\_include: add bounds checking when expanding %h escape.
  [[4a49f1696]](https://git.sudo.ws/sudo/commit/?id=4a49f1696)

* plugins/sudoers/iolog.c, plugins/sudoers/ldap.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Check snprintf() return values even if we preallocated the correct
  amount. There are no remaining unchecked snprintf() that can actually
  overflow.
  [[dc90df8de]](https://git.sudo.ws/sudo/commit/?id=dc90df8de)

* include/sudo\_iolog.h, lib/iolog/iolog\_nextid.c:

  iolog\_nextid(): make iolog\_dir argument const. We make a copy of the
  directory so there’s no real reason that parameter can’t be const.
  [[23d04dde2]](https://git.sudo.ws/sudo/commit/?id=23d04dde2)

* plugins/sudoers/ldap\_util.c:

  Amend truncation fix, the real problem was the size passed to
  snprintf(). sudo\_rcstr\_alloc() takes a length (not a size) parameter so
  when calling snprintf() we need to add one to the length.
  [[0f2252f89]](https://git.sudo.ws/sudo/commit/?id=0f2252f89)

* plugins/sudoers/ldap\_util.c:

  Fix truncation of the last char of the sudoRole cn passed to
  append\_default(). This string is primarily used for warning messages.
  Also check the snprintf() return value to avoid silent truncation.
  [GitHub issue #115](https://github.com/sudo-project/sudo/issues/115)
  [[e23874d0f]](https://git.sudo.ws/sudo/commit/?id=e23874d0f)

2021-09-20 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.8p2
  [[4fef09e1c]](https://git.sudo.ws/sudo/commit/?id=4fef09e1c)

* etc/codespell.exclude:

  Standardize on “front-end” not “front end” in the man pages.
  [[0340a9056]](https://git.sudo.ws/sudo/commit/?id=0340a9056)

* configure, configure.ac:

  fix typo
  [[a036cb025]](https://git.sudo.ws/sudo/commit/?id=a036cb025)

* logsrvd/logsrvd\_journal.c:

  Reuse existing journal file for an accepted/rejected sub-command.
  Otherwise we end up with zero-length files in the incoming queue dir and
  may end up relaying one of those instead of the actual journal file.
  [[a78d3cc25]](https://git.sudo.ws/sudo/commit/?id=a78d3cc25)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Re-enable error output for the sudoers parser. It is only the alias and
  defaults warnings we need to suppress.
  [[b6561831b]](https://git.sudo.ws/sudo/commit/?id=b6561831b)

* src/exec\_intercept.c:

  Add intercept\_cleanup() stub for when building w/o intercept support.
  [[5421c6182]](https://git.sudo.ws/sudo/commit/?id=5421c6182)

* src/exec\_intercept.c, src/exec\_nopty.c, src/exec\_pty.c, src/sudo\_exec.h:
  Add intercept\_cleanup() to free the closure used by
  intercept\_accept\_cb().
  [[a8c4d9800]](https://git.sudo.ws/sudo/commit/?id=a8c4d9800)

* plugins/sudoers/auth/pam.c:

  Don’t re-initialize PAM for sub-commands.
  [[328bc282e]](https://git.sudo.ws/sudo/commit/?id=328bc282e)

* logsrvd/logsrvd\_local.c:

  sudo\_logsrvd: only send log ID for first command of a session There is
  no need to send the log ID for each sub-command.
  [[8cc7e4bb5]](https://git.sudo.ws/sudo/commit/?id=8cc7e4bb5)

* plugins/sudoers/log\_client.c:

  Only store the first log id received from the server. Plugs a small
  memory leak in intercept mode if the log server sends the log ID again
  for sub-commands.
  [[0eb677b74]](https://git.sudo.ws/sudo/commit/?id=0eb677b74)

2021-09-19 Todd C. Miller

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  fuzz\_sudoers: don’t warn about unknown defaults entries Some fuzzing
  inputs cause a huge number of warnings and displaying them all can
  result in the fuzz run timing out. If we disable the warnings we can
  avoid the timeout.
  [[77ef8baa9]](https://git.sudo.ws/sudo/commit/?id=77ef8baa9)

* plugins/sudoers/defaults.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/policy.c:

  Limit paths for command, cwd and chroot to PATH\_MAX bytes. This helps
  prevent the fuzzer from going off the rails.
  [[0ea561ca6]](https://git.sudo.ws/sudo/commit/?id=0ea561ca6)

* plugins/sudoers/sudoers.c:

  sudo -i: missing NULL terminator when moving argv to make room for
  –login Fixes a potential crash for “sudo -i” when the target user has
  bash as the shell (which needs the –login option). [Bug
  #998](https://bugzilla.sudo.ws/show_bug.cgi?id=998).
  [[7ab66eb3a]](https://git.sudo.ws/sudo/commit/?id=7ab66eb3a)

* lib/eventlog/eventlog.c:

  Only append argv[] to the log line if argv[0] is not NULL. It should not
  be possible to reach this point with a command defined but argv[] empty
  but it doesn’t hurt to check.
  [[518bc1b25]](https://git.sudo.ws/sudo/commit/?id=518bc1b25)

2021-09-18 Todd C. Miller

* plugins/sudoers/check\_aliases.c:

  Only warn about an undefined alias or a cycle a single time. There’s no
  point in warning about the same problem multiple times. This
  implementation assumes a small number of warnings and so just uses a
  simple listed link.
  [[613468e4d]](https://git.sudo.ws/sudo/commit/?id=613468e4d)

* configure, configure.ac:

  Remove now-unused CHECK\_INTERCEPT variable.
  [[1d2512ae1]](https://git.sudo.ws/sudo/commit/?id=1d2512ae1)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Quiet pvs-studio false positive: V557 Array overrun is possible. Make
  the zero length check explicit so as not to confuse static (or human)
  analyzers.
  [[d9e8c852b]](https://git.sudo.ws/sudo/commit/?id=d9e8c852b)

2021-09-17 Todd C. Miller

* MANIFEST, plugins/sudoers/regress/testsudoers/test17.out.ok,
  plugins/sudoers/regress/testsudoers/test17.sh:

  Test that digest matching works with LDAP sudoCommand: ALL
  [[292916f43]](https://git.sudo.ws/sudo/commit/?id=292916f43)

* plugins/sudoers/ldap\_util.c:

  Allow a digest to be specified with the “ALL” command for ldap/sssd
  back-ends. This has been possible with sudoers file entries since sudo
  1.9.0 but no corresponding change was made for ldap/sssd.
  [[702746f96]](https://git.sudo.ws/sudo/commit/?id=702746f96)

* lib/eventlog/eventlog.c:

  Use localtime\_r() not gmtime\_r() when formatting the local time. This is
  consistent with how sudo formatted time stamps prior to the logging code
  being split off into libeventlog. We only need to use gmtime\_r() for ISO
  8601 time.
  [[49bf0cc84]](https://git.sudo.ws/sudo/commit/?id=49bf0cc84)

* lib/eventlog/eventlog.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c, lib/util/sudo\_debug.c,
  plugins/audit\_json/audit\_json.c, plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/ldap.c, plugins/sudoers/parse.c,
  plugins/sudoers/timestr.c:

  Check strftime(3) return value in all cases. Old versions of strftime(3)
  didn’t guarantee to NUL-terminate the buffer so we explicitly clear the
  last byte of the buffer and check it.
  [[55171df5e]](https://git.sudo.ws/sudo/commit/?id=55171df5e)

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, doc/sudo.man.in,
  doc/sudo.mdoc.in, doc/sudo\_logsrvd.man.in, doc/sudo\_logsrvd.mdoc.in,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in,
  doc/sudo\_sendlog.man.in, doc/sudo\_sendlog.mdoc.in, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, doc/visudo.man.in, doc/visudo.mdoc.in:

  Standardize on “front-end” not “front end” in the man pages.
  [[698481492]](https://git.sudo.ws/sudo/commit/?id=698481492)

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  Plugin lines are for approval and audit plugins too.
  [[7c550c5d1]](https://git.sudo.ws/sudo/commit/?id=7c550c5d1)

* lib/eventlog/eventlog.c, lib/iolog/iolog\_path.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c, lib/util/sudo\_debug.c,
  plugins/audit\_json/audit\_json.c,
  plugins/sample\_approval/sample\_approval.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/getdate.c,
  plugins/sudoers/getdate.y, plugins/sudoers/gmtoff.c,
  plugins/sudoers/ldap.c, plugins/sudoers/parse.c,
  plugins/sudoers/timestr.c:

  Use gmtime\_r() and localtime\_r() instead of gmtime() and localtime().
  [[18f1884dd]](https://git.sudo.ws/sudo/commit/?id=18f1884dd)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/gmtime\_r.c, lib/util/localtime\_r.c:

  Add gmtime\_r and localtime\_r tests and compat if missing.
  [[fa71679b5]](https://git.sudo.ws/sudo/commit/?id=fa71679b5)

* lib/util/sudo\_debug.c:

  Store milliseconds in the debug file timestamp. Sometime second
  granularity is not enough.
  [[46d71c436]](https://git.sudo.ws/sudo/commit/?id=46d71c436)

* configure, configure.ac:

  When using pkg-config, don’t assume the names of the ssl and crypto
  libs. On the HP-UX build machines these are named libssl\_pic.a and
  libcrypto\_pic.a to avoid conflicting with the system libs.
  [[78eb24064]](https://git.sudo.ws/sudo/commit/?id=78eb24064)

2021-09-13 Todd C. Miller

* configure, configure.ac, plugins/python/Makefile.in, scripts/mkdep.pl,
  src/Makefile.in:

  Teach mkdep.pl about –tag=disable-static in LTFLAGS. If static objs are
  disabled we need to add explicit dependencies for .o files. The OpenBSD
  libtool doesn’t use a pic object file when linking executables so we
  need to build the non-pic objects too.
  [[4289e9609]](https://git.sudo.ws/sudo/commit/?id=4289e9609)

* configure, configure.ac:

  Use SUDO\_APPEND\_LIBPATH when appending to LIBTLS and LIBMD. The OpenSSL
  pkgconfig files only include -L paths, not -R paths. Using
  SUDO\_APPEND\_LIBPATH ensures the rpath is set correctly so the binaries
  will run (not just link).
  [[229dfe175]](https://git.sudo.ws/sudo/commit/?id=229dfe175)

2021-09-17 Todd C. Miller

* configure, configure.ac, lib/util/digest\_openssl.c:

  Use the EVP digest routines instead of calling SHA2 functions directly.
  Avoids compiler warnings with OpenSSL 3.0. EVP\_MD\_CTX\_new() is only
  available for OpenSSL 1.1 and higher–we will fall back to sudo’s SHA2
  code if necessary.
  [[921bc1c69]](https://git.sudo.ws/sudo/commit/?id=921bc1c69)

* config.h.in, configure, configure.ac, logsrvd/tls\_init.c:

  tls\_init.c: use SSL\_CTX\_set0\_tmp\_dh\_pkey if present. Fixes a warning on
  OpenSSL 3.0 and plugs a memory leak of dhparams on config reload.
  [[4e0b77be4]](https://git.sudo.ws/sudo/commit/?id=4e0b77be4)

2021-09-13 Todd C. Miller

* INSTALL, configure, configure.ac:

  Add –enable-openssl-pkgconfig-template option. This can be used to find
  the correct openssl pkg-config file if it is not named “openssl” (also
  libcrypto).
  [[052391da9]](https://git.sudo.ws/sudo/commit/?id=052391da9)

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y:

  Some POSIX yacc fixes for bison 3.8 yyerror() must be extern void
  declare tokens with type instead of using separate %type lines
  [[ecc3aeffc]](https://git.sudo.ws/sudo/commit/?id=ecc3aeffc)

2021-09-17 Todd C. Miller

* scripts/mkpkg:

  mkpkg: limit the number of cores used to 16
  [[18613eee2]](https://git.sudo.ws/sudo/commit/?id=18613eee2)

* MANIFEST, plugins/sudoers/regress/testsudoers/test16.out.ok,
  plugins/sudoers/regress/testsudoers/test16.sh:

  Add a test to exercise [Bug
  #994](https://bugzilla.sudo.ws/show_bug.cgi?id=994)
  [[cf225d2f1]](https://git.sudo.ws/sudo/commit/?id=cf225d2f1)

2021-09-16 Todd C. Miller

* NEWS:

  fix typo
  [[2445576e9]](https://git.sudo.ws/sudo/commit/?id=2445576e9)

* NEWS:

  [Bug #994](https://bugzilla.sudo.ws/show_bug.cgi?id=994).
  [[eab915ae9]](https://git.sudo.ws/sudo/commit/?id=eab915ae9)

* plugins/sudoers/ldap\_util.c:

  Always allocate a struct sudo\_command for the command, even for ALL.
  This was missed in the previous set of changes, resulting in a crash for
  LDAP and SSSD rules that give sudo “ALL” privileges. [Bug
  #994](https://bugzilla.sudo.ws/show_bug.cgi?id=994).
  [[0c30976ae]](https://git.sudo.ws/sudo/commit/?id=0c30976ae)

* plugins/sudoers/Makefile.in:

  Add SUDOERS\_LDFLAGS to FUZZ\_LDFLAGS Fixes a fuzzer link error when
  building with ldap if the ldap libs are not in the default library
  search path.
  [[31e4a0a0a]](https://git.sudo.ws/sudo/commit/?id=31e4a0a0a)

* configure, configure.ac:

  Fix the OpenSSL link order for the non-pkg-config case. Since -lssl
  depends on -lcrypto, -lcrypto must be listed after -lssl. Fixes linking
  of non-dynamic OpenSSL libs.
  [[2d632937e]](https://git.sudo.ws/sudo/commit/?id=2d632937e)

2021-09-15 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.8p1
  [[e1653be43]](https://git.sudo.ws/sudo/commit/?id=e1653be43)

* src/sudo\_intercept\_common.c:

  sudo\_interposer\_init: verify message type from sudo We should only get a
  HelloResponse from sudo at this point.
  [[51d5f05e6]](https://git.sudo.ws/sudo/commit/?id=51d5f05e6)

* include/intercept.pb-c.h, src/exec\_intercept.c, src/intercept.pb-c.c,
  src/intercept.proto, src/sudo\_intercept\_common.c:

  Avoid symbol name clash to fix –enable-static-sudoers linking.
  [[db750232c]](https://git.sudo.ws/sudo/commit/?id=db750232c)

2021-09-14 Todd C. Miller

* plugins/sudoers/defaults.c, plugins/sudoers/policy.c:

  append\_defaults() should not be passed a value for boolean flags. The
  operation should simply be set to true/false. Also treat a NULL file as
  coming from the front-end. [Bug
  #993](https://bugzilla.sudo.ws/show_bug.cgi?id=993).
  [[d7cdf1e47]](https://git.sudo.ws/sudo/commit/?id=d7cdf1e47)

2021-09-09 Todd C. Miller

* .gitignore, .hgignore:

  Add src/intercept.exp to ignore files.
  [[4b5a67cf8]](https://git.sudo.ws/sudo/commit/?id=4b5a67cf8)

2021-09-08 Todd C. Miller

* plugins/sudoers/po/cs.mo:

  regen
  [[197d4ced3]](https://git.sudo.ws/sudo/commit/?id=197d4ced3)

* NEWS:

  Mention –enable-static-sudoers fix.
  [[02966f059]](https://git.sudo.ws/sudo/commit/?id=02966f059)

* configure, configure.ac:

  Fix typo introduced in 1.9.7 that set SUDO\_LDFLAGS to SUDOERS\_LDFLAGS.
  Copy pasta is not always the best kind of pasta.
  [[4b365300a]](https://git.sudo.ws/sudo/commit/?id=4b365300a)

* MANIFEST, configure, configure.ac, m4/sudo.m4, src/Makefile.in,
  src/intercept.exp.in, src/sudo\_intercept.c:

  sudo\_intercept.so: only replace execvpe() if it is present. execvpe() is
  a GNU extension also found on \*BSD (but not macOS).
  [[3a4aec7a6]](https://git.sudo.ws/sudo/commit/?id=3a4aec7a6)

* NEWS:

  We now intercept more than just execve().
  [[6d5f450a6]](https://git.sudo.ws/sudo/commit/?id=6d5f450a6)

2021-09-07 Todd C. Miller

* src/sudo\_intercept.c:

  Implement simple PATH resolution for execvp(). We want to use PATH from
  the current value of the environment, not the initial value of PATH when
  the policy was opened. This is a little different from how real execvp()
  works since we use stat() instead of just execve().
  [[6c456127b]](https://git.sudo.ws/sudo/commit/?id=6c456127b)

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, src/intercept.exp, src/sudo\_intercept.c:

  Add support for execl, execle, execlp, execvp, and execvpe. Currently,
  PATH traversal is handled by sudoers which uses the original PATH, not
  the one updated by the shell.
  [[7ae62866e]](https://git.sudo.ws/sudo/commit/?id=7ae62866e)

2021-09-03 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y:

  Remove conditional include of alloca.h, we don’t define HAVE\_ALLOCA\_H.
  The configure check for alloca() was removed long ago but this got
  missed.
  [[bf6045184]](https://git.sudo.ws/sudo/commit/?id=bf6045184)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Define RBAC and mention incompatibility with intercept/log\_subcmds.
  [[aac09cf7b]](https://git.sudo.ws/sudo/commit/?id=aac09cf7b)

2021-09-02 Todd C. Miller

* src/exec\_intercept.c:

  Fix computation of the token address when handling a partial read. We
  want to treat it as an array of bytes, not an array of tokens. Coverity
  CID 240011
  [[157ceadfa]](https://git.sudo.ws/sudo/commit/?id=157ceadfa)

* plugins/sudoers/parse.c:

  Quiet a PVS-Studio format string warning.
  [[f64d71674]](https://git.sudo.ws/sudo/commit/?id=f64d71674)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Regen .pot files.
  [[9a9a22e93]](https://git.sudo.ws/sudo/commit/?id=9a9a22e93)

* plugins/sudoers/po/cs.po:

  Updated translations from translationproject.org
  [[2f6cacd1e]](https://git.sudo.ws/sudo/commit/?id=2f6cacd1e)

2021-09-01 Todd C. Miller

* src/Makefile.in:

  regen
  [[967bcab4d]](https://git.sudo.ws/sudo/commit/?id=967bcab4d)

* configure, configure.ac, lib/util/sudo\_conf.c, scripts/mkdep.pl,
  src/Makefile.in, src/exec\_common.c, src/exec\_intercept.c:

  Do not compile intercept code if –disable-intercept is specified.
  [[38d884a62]](https://git.sudo.ws/sudo/commit/?id=38d884a62)

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  We now intercept execv() too.
  [[5c2f1ebbc]](https://git.sudo.ws/sudo/commit/?id=5c2f1ebbc)

* INSTALL:

  INSTALL: –disable-intercept will also disable “log\_subcmds”
  [[190e495b6]](https://git.sudo.ws/sudo/commit/?id=190e495b6)

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/parse.c:

  Can’t use intercept or log\_subcmds with SELinux RBAC. SELinux policy
  will prevent the inherited socket from sudo from being used and may also
  restrict the ability to connect back to the sudo process.
  [[f40afd73f]](https://git.sudo.ws/sudo/commit/?id=f40afd73f)

* m4/ax\_prog\_cc\_for\_build.m4:

  Fix typo in comment.
  [[242e4d070]](https://git.sudo.ws/sudo/commit/?id=242e4d070)

* po/cs.mo, po/cs.po:

  Updated translations from translationproject.org
  [[4ca5c7d64]](https://git.sudo.ws/sudo/commit/?id=4ca5c7d64)

* include/intercept.pb-c.h, src/exec\_intercept.c, src/intercept.pb-c.c,
  src/intercept.proto, src/sudo\_exec.h, src/sudo\_intercept\_common.c:

  Switch to a 128-bit token instead of a 64-bit secret. Protobuf doesn’t
  have a 128-bit type so use two u64s. We now support partial reads of the
  token.
  [[9a690a898]](https://git.sudo.ws/sudo/commit/?id=9a690a898)

2021-08-31 Todd C. Miller

* MANIFEST, lib/util/Makefile.in, lib/util/regress/uuid/uuid\_test.c,
  lib/util/uuid.c:

  Fix random uuid generation, no need to convert between byte order. Also
  add regression test.
  [[4bff82cab]](https://git.sudo.ws/sudo/commit/?id=4bff82cab)

* include/intercept.pb-c.h, src/exec\_intercept.c, src/intercept.pb-c.c,
  src/intercept.proto, src/sudo\_intercept\_common.c:

  sudo\_intercept.so: send the secret immediately after connecting. Sending
  the secret out of band, before the message size is read, should make it
  harder to mount a DoS attack.
  [[9137909c7]](https://git.sudo.ws/sudo/commit/?id=9137909c7)

* src/sudo\_intercept\_common.c:

  Handle reading large messages that don’t fit in a single recv(). We know
  the length of what we are receiving so just loop until we have it all,
  get EOF or an error.
  [[26938012f]](https://git.sudo.ws/sudo/commit/?id=26938012f)

* configure, configure.ac:

  Add checks for -fstack-clash-protection and -Wl,-z,noexecstack We use
  -Wc,-fstack-clash-protection as the linker flag to prevent libtool from
  removing it from the link line.
  [[c0630a36c]](https://git.sudo.ws/sudo/commit/?id=c0630a36c)

* src/exec\_intercept.c:

  Make the sudo side of the intercept socket non-blocking.
  [[a078bc64b]](https://git.sudo.ws/sudo/commit/?id=a078bc64b)

* src/exec\_intercept.c:

  Handle partial read/write by dropping back into the event loop.
  [[3c26b92a7]](https://git.sudo.ws/sudo/commit/?id=3c26b92a7)

* src/exec\_intercept.c:

  intercept\_check\_policy: Fix double free introduced in last commit If the
  command is not accepted we don’t rebuild command\_info[] and must not
  free it. It will be freed by the policy instead.
  [[33d1b26c6]](https://git.sudo.ws/sudo/commit/?id=33d1b26c6)

2021-08-27 Todd C. Miller

* include/intercept.pb-c.h, src/exec\_intercept.c, src/intercept.pb-c.c,
  src/intercept.proto, src/sudo\_intercept\_common.c:

  Update runcwd in command\_info[] before passing it to the audit plugin.
  Since sudoers does rejected commands itself the runcwd will still not be
  correct for those.
  [[168d5c47c]](https://git.sudo.ws/sudo/commit/?id=168d5c47c)

* src/exec\_preload.c:

  Fix LD\_PRELOAD formatting when there is an existing LD\_PRELOAD var.
  [[22de92b0d]](https://git.sudo.ws/sudo/commit/?id=22de92b0d)

2021-08-26 Todd C. Miller

* src/exec\_intercept.c:

  intercept\_check\_policy: fix potential NUL dereference on the error path.
  [[75bac8dee]](https://git.sudo.ws/sudo/commit/?id=75bac8dee)

* NEWS, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/policy.c, src/exec.c,
  src/exec\_common.c, src/exec\_nopty.c, src/exec\_pty.c, src/sudo.c,
  src/sudo.h:

  Rename log\_children -> log\_subcmds
  [[ba171724f]](https://git.sudo.ws/sudo/commit/?id=ba171724f)

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt.mo, plugins/sudoers/po/pt.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/eo.mo,
  po/eo.po, po/fr.mo, po/fr.po, po/hr.mo, po/hr.po, po/ko.mo, po/ko.po,
  po/pl.mo, po/pl.po, po/pt.mo, po/pt.po, po/pt\_BR.mo, po/pt\_BR.po,
  po/tr.mo, po/tr.po, po/uk.mo, po/uk.po, po/zh\_CN.mo, po/zh\_CN.po,
  po/zh\_TW.mo, po/zh\_TW.po:

  Updated translations from translationproject.org
  [[d8d402333]](https://git.sudo.ws/sudo/commit/?id=d8d402333)

* lib/util/sudo\_debug.c:

  Add sudo\_debug\_register\_v2() stub for fuzzing build.
  [[dcab17900]](https://git.sudo.ws/sudo/commit/?id=dcab17900)

* src/exec\_intercept.c:

  Fix use-after-free on error. Also remove useless free of a ptr that is
  always NULL on the error path.
  [[3d8b327c6]](https://git.sudo.ws/sudo/commit/?id=3d8b327c6)

* src/exec\_common.c:

  No longer need to remap intercept fd but we do need to remap debug fd.
  The intercept fd is closed in the ctor but the debug fd will still be
  open.
  [[dc30c842b]](https://git.sudo.ws/sudo/commit/?id=dc30c842b)

* include/sudo\_debug.h, lib/util/sudo\_debug.c, lib/util/util.exp.in,
  logsrvd/logsrvd.c, logsrvd/sendlog.c, plugins/audit\_json/audit\_json.c,
  plugins/python/sudo\_python\_debug.c,
  plugins/sample\_approval/sample\_approval.c,
  plugins/sudoers/sudoers\_debug.c, plugins/sudoers/sudoreplay.c,
  src/sesh.c, src/sudo.c, src/sudo\_intercept\_common.c:

  sudo\_debug\_register: add minfd argument to specify lowest fd number Use
  this in sudo\_intercept.so to avoid allocating a low-numbered fd which
  the shell reserves for use by scripts.
  [[70aef0eb2]](https://git.sudo.ws/sudo/commit/?id=70aef0eb2)

* src/exec\_intercept.c:

  Fix command name of sub-command in logs when log\_children is set.
  [[d6a71fe32]](https://git.sudo.ws/sudo/commit/?id=d6a71fe32)

2021-08-25 Todd C. Miller

* plugins/sudoers/audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h:

  log\_allowed: pass struct eventlog \* instead of argv[] and envp[]. This
  lets us log based on the command\_info[] list passed in from the
  front-end. Previously, much of the struct eventlog was constructed from
  internal sudoers state instead.
  [[ec751c63e]](https://git.sudo.ws/sudo/commit/?id=ec751c63e)

* include/sudo\_compat.h:

  sudo\_compat.h: include unistd.h on HP-UX to safely redefine pread/pwrite
  HP-UX 11.31 defines static functions for pread() and pwrite() which will
  conflict with our macros.
  [[e199dd825]](https://git.sudo.ws/sudo/commit/?id=e199dd825)

* src/exec\_intercept.c:

  Add a state variable to intercept\_closure, replaces policy\_result.
  [[438a0cf07]](https://git.sudo.ws/sudo/commit/?id=438a0cf07)

* config.h.in, configure, configure.ac, include/intercept.pb-c.h,
  src/exec\_intercept.c, src/exec\_nopty.c, src/exec\_pty.c,
  src/intercept.pb-c.c, src/intercept.proto, src/sudo\_exec.h,
  src/sudo\_intercept\_common.c:

  Change intercept IPC to use a localhost socket instead of inherited fd.
  This allows intercept mode to work with shells that close all open fds
  upon startup. The ctor in sudo\_intercept.so requests the port number and
  secret over the socket inherited from the parent then closes it. For
  each policy request, a TCP connection is made to the sudo parent process
  to perform the policy check. Child processes re-use the TCP socket to
  request the port number and secret just like the initial process started
  by sudo does.
  [[c465d8971]](https://git.sudo.ws/sudo/commit/?id=c465d8971)

2021-08-24 Todd C. Miller

* src/exec\_intercept.c:

  Fold intercept\_closure\_reset() into intercept\_close().
  [[448536e0f]](https://git.sudo.ws/sudo/commit/?id=448536e0f)

2021-08-25 Todd C. Miller

* plugins/sudoers/match\_command.c:

  command\_matches: avoid printf("%s") of NULL in debug for sudo ALL.
  [[0aedc965f]](https://git.sudo.ws/sudo/commit/?id=0aedc965f)

* :

  Merge pull request #111 from commodo/fix-cflags

  lib/util/Makefile.in: use host CFLAGS and CPPFLAGS for mksig{name,list}
  [[9980357a7]](https://git.sudo.ws/sudo/commit/?id=9980357a7)

2021-08-25 Alexandru Ardelean

* lib/util/Makefile.in:

  lib: util: Makefile.in: use host CFLAGS and CPPFLAGS for
  mksig{name,list}

  When cross-build support was added for mkig{name,list} was added, the
  CFLAGS and CPPFLAGS should have been updated to the
  HOSTCFLAGS/HOSTCPPFLAGS vars.

  In a cross-build scenario, some of these flags don’t match what the
  compiler can understand (because they may be architecture specific) and
  may fail the build.

  Using the HOSTCFLAGS/HOSTCPPFLAGS works and builds successfully. Also
  the output binary works on the target.

  This is in continuation of -
  <https://github.com/sudo-project/sudo/pull/104> -
  <https://github.com/sudo-project/sudo/pull/109>

  Signed-off-by: Alexandru Ardelean <ardeleanalex@…>
  [[a12b15b43]](https://git.sudo.ws/sudo/commit/?id=a12b15b43)

2021-08-24 Todd C. Miller

* src/exec\_preload.c:

  Fix typo that caused SUDO\_INTERCEPT\_FD to overwrite LD\_PRELOAD.
  [[222d6f94c]](https://git.sudo.ws/sudo/commit/?id=222d6f94c)

* src/exec\_preload.c:

  Fix off-by-one that could result in duplicate SUDO\_INTERCEPT\_FD vars.
  [[139181344]](https://git.sudo.ws/sudo/commit/?id=139181344)

* src/sudo\_intercept.c:

  Fix typo in macOS execv change.
  [[df68f4c8d]](https://git.sudo.ws/sudo/commit/?id=df68f4c8d)

2021-08-21 Todd C. Miller

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, src/intercept.exp, src/sudo\_intercept.c:

  Add execv(3) support to sudo\_intercept.so. This allows intercept to work
  with csh which uses execv(3) not execve(2).
  [[98401c058]](https://git.sudo.ws/sudo/commit/?id=98401c058)

2021-08-20 Todd C. Miller

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, doc/sudoers.man.in,
  doc/sudoers.mdoc.in:

  Sync the list of functions trapped by sudo\_noexec.so.
  [[02b78c38e]](https://git.sudo.ws/sudo/commit/?id=02b78c38e)

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  Add a Debug example for sudo\_intercept.so Don’t try to enumerate all the
  sudo programs that support debugging since all of them do.
  [[1e795b548]](https://git.sudo.ws/sudo/commit/?id=1e795b548)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Update sudoers Debug example to match the debug changes from sudo
  1.8.12.
  [[bb40491c9]](https://git.sudo.ws/sudo/commit/?id=bb40491c9)

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  sudo\_intercept.so only intercepts execve(2) for now.
  [[8ccb7f009]](https://git.sudo.ws/sudo/commit/?id=8ccb7f009)

* plugins/sudoers/parse.c:

  Fix formatting for bound defaults with multiple entries in the binding.
  The entries in the binding were separated with " ," instead of “, “.
  [[7df245dc9]](https://git.sudo.ws/sudo/commit/?id=7df245dc9)

* MANIFEST, src/Makefile.in, src/intercept.exp:

  Add exports file for sudo\_intercept.so that only exports execve()
  [[4ccd966e2]](https://git.sudo.ws/sudo/commit/?id=4ccd966e2)

* src/Makefile.in, src/sudo\_intercept.c, src/sudo\_intercept\_common.c:

  Add some debugging to the sudo\_intercept.so.
  [[dc281f036]](https://git.sudo.ws/sudo/commit/?id=dc281f036)

* config.h.in, configure, configure.ac:

  Use AC\_FUNC\_FSEEKO instead of AC\_CHECK\_FUNCS\_ONCE([fseeko]). This will
  define \_LARGEFILE\_SOURCE, if needed, to make the prototype visible on
  older systems.
  [[680fd4a62]](https://git.sudo.ws/sudo/commit/?id=680fd4a62)

2021-08-19 Todd C. Miller

* config.h.in, configure, configure.ac, include/sudo\_compat.h:

  We still need the pread/pwrite hack for HP-UX 11.11 at least. This time
  around, avoid defining \_LARGEFILE64\_SOURCE and just declare
  pread64/pwrite64 ourselves.
  [[ad28b90c4]](https://git.sudo.ws/sudo/commit/?id=ad28b90c4)

* include/sudo\_compat.h:

  Fix prototypes for sudo\_pread() and sudo\_pwrite().
  [[23e5304b7]](https://git.sudo.ws/sudo/commit/?id=23e5304b7)

* src/exec\_intercept.c:

  intercept\_fd\_cb: store the passed fd in newfd, not fd only affects the
  old BSD-style fd passing code, not POSIX-style.
  [[5d3ab032f]](https://git.sudo.ws/sudo/commit/?id=5d3ab032f)

* lib/util/Makefile.in:

  Fix mksiglist and mksigname dependencies.
  [[d333f484e]](https://git.sudo.ws/sudo/commit/?id=d333f484e)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  set-user-ID and set-group-ID not set user-ID and set group-ID.
  [[52e7594ae]](https://git.sudo.ws/sudo/commit/?id=52e7594ae)

* NEWS:

  The fix for bug #989 will make sudo 1.9.8. Also mention
  intercept\_authenticate and intercept\_allow\_setid.
  [[09f160779]](https://git.sudo.ws/sudo/commit/?id=09f160779)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[90aee138b]](https://git.sudo.ws/sudo/commit/?id=90aee138b)

* logsrvd/logsrvd\_conf.c, plugins/sudoers/check.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/exptilde.c,
  plugins/sudoers/iolog.c, plugins/sudoers/logging.c,
  plugins/sudoers/mkdefaults, plugins/sudoers/policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/tsdump.c:

  Replace messages like “unknown foo: %s” with “unknown foo %s”. The colon
  really doesn’t belong there; we generally use a colon to separate a
  message from the warning detail.
  [[bb5843055]](https://git.sudo.ws/sudo/commit/?id=bb5843055)

* .gitignore, .hgignore, MANIFEST, aclocal.m4, configure, configure.ac,
  lib/util/Makefile.in, lib/util/mksiglist.c, lib/util/mksigname.c,
  lib/util/sys\_siglist.h, lib/util/sys\_signame.h,
  m4/ax\_prog\_cc\_for\_build.m4:

  Cross-build support for mksigname and mksiglist We must build these with
  the host C compiler but use the target preprocessor to generate the
  output.
  [[b40f74cb2]](https://git.sudo.ws/sudo/commit/?id=b40f74cb2)

2021-08-19 a1346054

* .clang-format, INSTALL, MANIFEST, autogen.sh, doc/LICENSE, etc/sudo.pp,
  examples/Makefile.in:

  Minor cleanup (#110)

  + fix trivial shell script issues \* remove trailing whitespace
    [[bf7d20b48]](https://git.sudo.ws/sudo/commit/?id=bf7d20b48)

2021-08-19 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  log\_server\_peer\_cert and log\_server\_peer\_key are not required by
  default. They are only required if sudo\_logsrvd has tls\_checkpeer
  enabled.
  [[1c52c24a9]](https://git.sudo.ws/sudo/commit/?id=1c52c24a9)

* logsrvd/logsrvd\_conf.c:

  Sync warning messages with sudoers/logging.c Avoids 3 translation
  strings that were effectively duplicated.
  [[e17003b35]](https://git.sudo.ws/sudo/commit/?id=e17003b35)

2021-08-18 Todd C. Miller

* lib/protobuf-c/Makefile.in, src/Makefile.in:

  regen
  [[ad5feeb40]](https://git.sudo.ws/sudo/commit/?id=ad5feeb40)

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/match\_command.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Add intercept\_allow\_setid sudoers option, disabled by default. With this
  change, a shell in intercept mode cannot run a setuid or setgid binary
  by default. On most systems, the dynamic loader will ignore LD\_PRELOAD
  for setuid/setgid binaries such as sudo which would effectively disable
  intercept mode.
  [[f9d3f46fa]](https://git.sudo.ws/sudo/commit/?id=f9d3f46fa)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/match.c:
  Always allocate a struct sudo\_command for the command, even for ALL.
  Previously we special-cased handling of ALL but this complicates some
  upcoming changes.
  [[53a95e3a5]](https://git.sudo.ws/sudo/commit/?id=53a95e3a5)

2021-08-16 Todd C. Miller

* etc/codespell.exclude:

  Update TAGS\_CHANGED macro based on parse.h
  [[dad40a50a]](https://git.sudo.ws/sudo/commit/?id=dad40a50a)

* doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoers.man.in,
  doc/sudoers.mdoc.in:

  Better document the limitations of intercept mode. Also mention
  log\_children under “Preventing shell escapes”
  [[fc9a01936]](https://git.sudo.ws/sudo/commit/?id=fc9a01936)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update .pot files for 1.9.8.
  [[e4809d634]](https://git.sudo.ws/sudo/commit/?id=e4809d634)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Try to clarify log\_server\_peer\_key and log\_server\_peer\_cert. These are
  client-side not server-side.
  [[a85cf1f3f]](https://git.sudo.ws/sudo/commit/?id=a85cf1f3f)

* logsrvd/logsrvd\_conf.c:

  Print the section when warning about an illegal key in the conf file.
  This should make it easier to tell when a setting is present in the
  wrong section.
  [[bfcc31b19]](https://git.sudo.ws/sudo/commit/?id=bfcc31b19)

2021-08-14 Todd C. Miller

* lib/eventlog/eventlog.c:

  new\_logline: limit offset to two significant digits after the decimal
  Now instead of TSID=0001L3@5.168230749 we would log TSID=0001L3@5.16.
  [[5902c0e21]](https://git.sudo.ws/sudo/commit/?id=5902c0e21)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  logsrvd/logsrvd\_journal.c:

  Set umask to be less restrictive before creating parent directories.
  Otherwise we could end up creating them with a more restrictive mode
  than indended. Coverity CID 221592
  [[9248ea6bb]](https://git.sudo.ws/sudo/commit/?id=9248ea6bb)

* lib/eventlog/eventlog.c:

  new\_logline: handle case where evlog is NULL
  [[babb498c6]](https://git.sudo.ws/sudo/commit/?id=babb498c6)

* logsrvd/logsrvd\_local.c:

  store\_alert\_local: fix memory leak on error path Coverity CID 238642
  [[6d3cf0ffd]](https://git.sudo.ws/sudo/commit/?id=6d3cf0ffd)

* plugins/sudoers/audit.c:

  log\_server\_accept: fix memory leak of evlog when logging a sub-command.
  Coverity CID 238643
  [[e2abcd6cb]](https://git.sudo.ws/sudo/commit/?id=e2abcd6cb)

* src/exec\_intercept.c:

  Fix memory leak when client requests secret. Move closure allocation
  closer to where it is used.
  [[340d75394]](https://git.sudo.ws/sudo/commit/?id=340d75394)

* logsrvd/logsrvd\_local.c:

  store\_accept\_local: fix return value on error
  [[4add9c2c0]](https://git.sudo.ws/sudo/commit/?id=4add9c2c0)

2021-08-13 Todd C. Miller

* lib/eventlog/eventlog.c:

  Cast iolog\_offset.tv\_sec to long long for %lld printf format. Quiets a
  compiler warning on systems where tv\_sec in struct timeval is not long
  long.
  [[0f6a74f18]](https://git.sudo.ws/sudo/commit/?id=0f6a74f18)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  logsrvd/logsrvd\_local.c, plugins/sudoers/logging.c:

  For intercepted commands, log an offset into the current I/O log. This
  can be used with sudoreplay to jump to when a specific command was
  executed within a session log.
  [[4aefd4394]](https://git.sudo.ws/sudo/commit/?id=4aefd4394)

* doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in, lib/iolog/iolog\_timing.c,
  plugins/sudoers/sudoreplay.c:

  Add support for an optional offset when parsing the ID to replay. The
  offset is a suffix in the form of @sec[.nanosec]
  [[695f4bea0]](https://git.sudo.ws/sudo/commit/?id=695f4bea0)

* logsrvd/logsrvd\_local.c:

  Don’t overwrite closure->evlog for sub-commands.
  [[064981fb1]](https://git.sudo.ws/sudo/commit/?id=064981fb1)

* config.h.in, configure, configure.ac, include/sudo\_compat.h:

  Older Solaris has getusershell() et al but does not declare it.
  [[62aca803c]](https://git.sudo.ws/sudo/commit/?id=62aca803c)

* src/exec\_intercept.c, src/exec\_nopty.c, src/exec\_pty.c,
  src/sudo\_intercept\_common.c:

  Add missing stdint.h and sudo\_rand.h includes. Needed for arc4random()
  and uin64\_t.
  [[a55b54329]](https://git.sudo.ws/sudo/commit/?id=a55b54329)

* include/intercept.pb-c.h, src/exec\_intercept.c, src/exec\_nopty.c,
  src/exec\_pty.c, src/intercept.pb-c.c, src/intercept.proto,
  src/sudo\_exec.h, src/sudo\_intercept\_common.c:

  Pass a secret value to sudo\_intercept.so and verify after policy check.
  The goal is to make it harder for someone to have a fake policy checker.
  This will not stop a determined adversary since the secret is present in
  the address space of the running process.
  [[eaf03a382]](https://git.sudo.ws/sudo/commit/?id=eaf03a382)

2021-08-11 Todd C. Miller

* MANIFEST, src/Makefile.in, src/exec.c, src/exec\_intercept.c:

  Split off intercept code into exec\_intercept.c.
  [[c9d922546]](https://git.sudo.ws/sudo/commit/?id=c9d922546)

* scripts/mkpkg:

  Add trivial support for FreeBSD packages. The actual FreeBSD port
  supports multiple options but this is sufficient for testing purposes.
  [[3f30704ab]](https://git.sudo.ws/sudo/commit/?id=3f30704ab)

* scripts/pp:

  FreeBSD: Set default directory and file mode if not specified in %files
  Otherwise, a mode of 0 will be used, potentially rendering the system
  unusable.
  [[374d49981]](https://git.sudo.ws/sudo/commit/?id=374d49981)

* plugins/sudoers/logging.c:

  Use same check for intercepted commands as log\_server\_accept().
  Previously, log\_server\_reject() and log\_server\_alert() just checked
  whether client\_closure has been set.
  [[f327a19f3]](https://git.sudo.ws/sudo/commit/?id=f327a19f3)

* logsrvd/logsrvd.c, logsrvd/logsrvd\_relay.c, logsrvd/sendlog.c,
  plugins/sudoers/log\_client.c:

  Call shutdown() on sockets before closing() if they are connected. This
  should ensure that the other side sees any queued data before the
  connection is dropped.
  [[0e2094471]](https://git.sudo.ws/sudo/commit/?id=0e2094471)

* logsrvd/logsrvd.c, logsrvd/logsrvd\_relay.c, logsrvd/sendlog.c,
  plugins/sudoers/log\_client.c:

  If SSL\_shutdown() returns 0 it needs to be called one more time.
  [[79129613e]](https://git.sudo.ws/sudo/commit/?id=79129613e)

* plugins/sudoers/editor.c:

  resolve\_editor: sudoers\_gc\_remove(editor) before freeing it.
  [[ffdd7920c]](https://git.sudo.ws/sudo/commit/?id=ffdd7920c)

2021-08-10 Todd C. Miller

* lib/util/mksigname.h, lib/util/siglist.in:

  Sync siglist.in with the generated files. The change to prefer SIGSYS
  over SIGUNUSED wasn’t made to siglist.in. Also, mksigname.c doesn’t need
  to explicitly set sudo\_sys\_signame[0].
  [[ef91b90ad]](https://git.sudo.ws/sudo/commit/?id=ef91b90ad)

* plugins/sudoers/Makefile.in, plugins/sudoers/editor.c,
  plugins/sudoers/gc.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Add garbage collection to resolve\_editor(). Fixes a leak when evaluating
  the policy multiple times if sudoedit is set.
  [[9798fd86b]](https://git.sudo.ws/sudo/commit/?id=9798fd86b)

2021-08-09 Todd C. Miller

* src/exec\_common.c:

  Fix compilation when configure option –disable-shared is specified.
  [[abac06956]](https://git.sudo.ws/sudo/commit/?id=abac06956)

* NEWS, configure, configure.ac:

  Sudo 1.9.8
  [[aa20eccad]](https://git.sudo.ws/sudo/commit/?id=aa20eccad)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c:

  Avoid some double frees in the fuzzer Now that sudoers free old values
  of NewArgv and command\_info the fuzzer needs to reset those values.
  Otherwise we end up with stashed values that have already been garbage
  collected.
  [[462e8ab47]](https://git.sudo.ws/sudo/commit/?id=462e8ab47)

* plugins/sudoers/audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h:

  Use a separate uuid for intercepted commands. We use the uuid to match
  the command with its exit status.
  [[dae370fb7]](https://git.sudo.ws/sudo/commit/?id=dae370fb7)

* plugins/sudoers/audit.c, plugins/sudoers/iolog.c,
  plugins/sudoers/log\_client.c, plugins/sudoers/log\_client.h,
  plugins/sudoers/logging.c:

  Fix logging intercepted commands to a log server in sudoers. Only
  available when the server supports the subcommands capability.
  [[2e99450d4]](https://git.sudo.ws/sudo/commit/?id=2e99450d4)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c:

  Plug some memory leaks when sudoers\_policy\_main is called multiple
  times. These would get cleaned up a policy close time but we don’t want
  to bloat sudo’s memory footprint when running a shell with multiple
  commands.
  [[3a090dcdc]](https://git.sudo.ws/sudo/commit/?id=3a090dcdc)

* configure, configure.ac, pathnames.h.in, src/Makefile.in,
  src/exec\_preload.c:

  If building with address sanitizer make sure its DSO is first. Address
  sanitizer requires that it be preloaded before any other DSO in
  LD\_PRELOAD. This should not be required for clang, which links in asan
  statically by default.
  [[dfe26f8c3]](https://git.sudo.ws/sudo/commit/?id=dfe26f8c3)

* configure, configure.ac, src/exec\_preload.c:

  Require that our dso be first in the list to make sure it takes effect.
  Otherwise, another dso could take precedence and ours would not be run.
  [[8f8a9c37b]](https://git.sudo.ws/sudo/commit/?id=8f8a9c37b)

* config.h.in, configure, configure.ac, src/exec.c,
  src/sudo\_intercept\_common.c:

  If msg\_control is not present in struct msghdr use msg\_accrights
  instead. Fixes building on Solaris and probably others. It is possible
  to expose msg\_control on Solaris but this requires a specific set of
  feature flag defines which can cause other complications.
  [[0ea5efd8b]](https://git.sudo.ws/sudo/commit/?id=0ea5efd8b)

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/check.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Add intercept\_authenticate sudoers option, defaults to false. By
  default, sudoers will not require authentication of commands run via an
  intercepted session. To require authenticaton of subsequent commands,
  enable intercept\_authenticate in sudoers.
  [[788708c9f]](https://git.sudo.ws/sudo/commit/?id=788708c9f)

* src/exec.c, src/exec\_nopty.c, src/exec\_pty.c:

  Make the log\_children option only log and not check policy.
  [[13b89e910]](https://git.sudo.ws/sudo/commit/?id=13b89e910)

* src/exec\_preload.c, src/sudo\_intercept\_common.c:

  Add debug support to sudo\_intercept.so
  [[258fa9d4f]](https://git.sudo.ws/sudo/commit/?id=258fa9d4f)

* MANIFEST, src/Makefile.in, src/exec\_common.c, src/exec\_preload.c,
  src/sudo\_exec.h, src/sudo\_intercept.c, src/sudo\_intercept\_common.c:

  Move preload\_dso() to its own file and rename to sudo\_preload\_dso(). It
  now takes an intercept fd as an optional argument instead of a list of
  extra variables to add. This lets us check whether it is already set to
  the expected value (and add it if not). sudo\_intercept.so now uses
  sudo\_preload\_dso() to make sure that LD\_PRELOAD and SUDO\_INTERCEPT\_FD
  are set properly before executing.
  [[9c3df47da]](https://git.sudo.ws/sudo/commit/?id=9c3df47da)

* src/exec.c:

  Take control of the tty and save its settings before doing a policy
  check. Otherwise the policy plugin won’t be able to read the password.
  [[60e76e3e3]](https://git.sudo.ws/sudo/commit/?id=60e76e3e3)

* src/exec.c, src/sudo.c, src/sudo.h:

  Call the approval plugin after the policy plugin accepts a command.
  Previously, for intercepted commands we only called the policy plugin.
  [[42598735d]](https://git.sudo.ws/sudo/commit/?id=42598735d)

* src/sudo.c:

  Reduce the number of function args passed to plugin wrappers. This makes
  sudo\_settings, user\_info, submit\_argv, submit\_envp and submit\_optind
  global. This will be required for calling the wrapper from outside of
  sudo.c where we may not have access to those variables.
  [[4ff3f7604]](https://git.sudo.ws/sudo/commit/?id=4ff3f7604)

* src/sudo.c, src/sudo.h:

  Add return values for most of the plugin function wrappers that returned
  void. Previously, they would just exit if there was an error. Now the
  error is passed back up the stack so we can use them in
  sudo\_intercept.so.
  [[840bf4b09]](https://git.sudo.ws/sudo/commit/?id=840bf4b09)

* MANIFEST, src/Makefile.in, src/exec.c, src/exec\_common.c,
  src/sudo\_exec.h, src/sudo\_intercept.c, src/sudo\_intercept\_common.c:

  Implement sudo\_intercept.so. Uses protobuf to talk to main sudo process
  over a socketpair.
  [[4cf3d1c41]](https://git.sudo.ws/sudo/commit/?id=4cf3d1c41)

* src/exec.c, src/sudo.c, src/sudo.h:

  Implement the sudo side of the sudo\_intercept.so communication.
  [[d7380bb27]](https://git.sudo.ws/sudo/commit/?id=d7380bb27)

* MANIFEST, include/intercept.pb-c.h, src/Makefile.in,
  src/intercept.pb-c.c, src/intercept.proto:

  Define protocol for sudo <-> sudo\_intercept.so communication. Uses
  google protocol buffers.
  [[cede7dd92]](https://git.sudo.ws/sudo/commit/?id=cede7dd92)

* MANIFEST, Makefile.in, configure, configure.ac, lib/logsrv/Makefile.in,
  lib/protobuf-c/Makefile.in, lib/protobuf-c/protobuf-c.c:

  Add separate convenience lib for protobuf-c We need to use it for sudo
  <-> sudo\_intercept.so communication.
  [[5d4120fa5]](https://git.sudo.ws/sudo/commit/?id=5d4120fa5)

* doc/sudo\_logsrv.proto.man.in, doc/sudo\_logsrv.proto.mdoc.in,
  include/log\_server.pb-c.h, lib/logsrv/log\_server.pb-c.c,
  lib/logsrv/log\_server.proto, logsrvd/logsrvd.c:

  Allow multiple accept/reject messages during a logsrv conversation. The
  log server now advertises a subcommands flag if it supports logging
  subcommands (e.g. commands run from a sudo-spawned program like a
  shell). The client should only log additional commands during a session
  if this flag is set in the ServerHello message.
  [[9d776b4e7]](https://git.sudo.ws/sudo/commit/?id=9d776b4e7)

* plugins/sudoers/audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h:

  Use run\_argv and run\_envp passed into the audit plugin for event
  logging. Previously we used NewArgv[] and env\_get() but now that logging
  is performed via an audit plugin we should use the values passed in.
  [[1ae9954c6]](https://git.sudo.ws/sudo/commit/?id=1ae9954c6)

* plugins/sudoers/set\_perms.c:

  Allow set\_perms(PERM\_INITIAL) to be called more than once. If the perm
  stack depth is non-zero when set\_perms(PERM\_INITIAL) is called, rewind
  it first and re-initialize the stack depth to 0. Fixes a user-after-free
  bug if set\_perms(PERM\_INITIAL) is called multiple times.
  [[5e3ce532f]](https://git.sudo.ws/sudo/commit/?id=5e3ce532f)

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/file.c, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_ldap.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Make it possible to call the sudoers policy check function multiple
  times. We need to reset the Defaults values to their original state.
  [[132936f8f]](https://git.sudo.ws/sudo/commit/?id=132936f8f)

* include/sudo\_compat.h, src/exec.c, src/exec\_common.c,
  src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c, src/selinux.c,
  src/sesh.c, src/sudo\_exec.h:

  Allocate a socketpair to communicate with sudo\_intercept.so over. This
  is used for the intercept and log\_children options.
  [[a556b373c]](https://git.sudo.ws/sudo/commit/?id=a556b373c)

* INSTALL, configure, configure.ac, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, examples/sudo.conf.in, include/sudo\_conf.h,
  lib/util/sudo\_conf.c, lib/util/util.exp.in, pathnames.h.in,
  src/Makefile.in, src/exec.c, src/exec\_common.c, src/selinux.c,
  src/sesh.c, src/sudo.c, src/sudo.h, src/sudo\_exec.h:

  Add support for loading the sudo\_intercept.so DSO.
  [[6287e8ca7]](https://git.sudo.ws/sudo/commit/?id=6287e8ca7)

* doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/policy.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Add “intercept” Defaults setting to allow interception of sub-commands.
  This causes “intercept” to be set to true in command\_info[] which the
  sudo front-end will use to determine whether or not to intercept
  attempts to run further commands, such as from a shell. Also add
  “log\_children” which will use the same mechanism but only log (audit)
  further commands.
  [[786e5865c]](https://git.sudo.ws/sudo/commit/?id=786e5865c)

* plugins/sudoers/prompt.c:

  expand\_prompt: use correct strlcpy() size parameter The available size
  passed to strlcpy() was computed incorrectly. Switch to updating the
  length after writing to the new prompt instead of computing it each
  time. The actual buffer size is computed and allocated correctly so
  there is no real consequence to this bug. Found by Qualys.
  [[b3e86c65b]](https://git.sudo.ws/sudo/commit/?id=b3e86c65b)

2021-08-03 Todd C. Miller

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  examples/sudo\_logsrvd.conf:

  The tls\_verify setting only affects server behavior, not the client.
  Originally, there was a flag in the ServerHello message to indicate that
  the client should verify the server cert, but this was removed TLS was
  moved to a separate port. Client validation of the server certificate is
  now configured in the sudoers file instead.
  [[14ffa00c0]](https://git.sudo.ws/sudo/commit/?id=14ffa00c0)

2021-08-02 Todd C. Miller

* scripts/mkpkg:

  On macOS, don’t disable tty tickets and set password timeout to 0. This
  more closely matches the options used by the macOS version of sudo.
  [[57cb62d7d]](https://git.sudo.ws/sudo/commit/?id=57cb62d7d)

* plugins/sudoers/find\_path.c:

  Add some debugging info to find\_path()
  [[d1c29fb00]](https://git.sudo.ws/sudo/commit/?id=d1c29fb00)

2021-07-30 Todd C. Miller

* lib/iolog/iolog\_mkdtemp.c:

  iolog\_mkdtemp: umask must not be more restrictive than the file modes.
  We need this even though we will be calling mkdtemp() since the umask
  affects the mode of any parent directories.
  [[e4568ceaf]](https://git.sudo.ws/sudo/commit/?id=e4568ceaf)

2021-07-29 Todd C. Miller

* plugins/sudoers/visudo.c:

  Plug memory leak in error path when sudoers cannot be opened.
  [[8b009f62e]](https://git.sudo.ws/sudo/commit/?id=8b009f62e)

* plugins/sudoers/defaults.c:

  Trying to use “+=” or “-=” operators on a non-list is an error.
  Previously, they were simply treated as “=” for non-lists.
  [[1032fca5b]](https://git.sudo.ws/sudo/commit/?id=1032fca5b)

* src/regress/net\_ifs/check\_net\_ifs.c:

  Plug a memory leak in check\_net\_ifs found by address sanitizer.
  [[2ea773ed1]](https://git.sudo.ws/sudo/commit/?id=2ea773ed1)

* configure, configure.ac:

  Prefix sanitizer and fuzzer options with -XCClinker in ASAN\_LDFLAGS.
  Otherwise libtool may ignore the options when linking.
  [[40496f510]](https://git.sudo.ws/sudo/commit/?id=40496f510)

2021-07-27 Todd C. Miller

* logsrvd/tls\_init.c:

  Display the correct error message if X509\_verify\_cert() fails. We must
  use X509\_STORE\_CTX\_get\_error() and X509\_verify\_cert\_error\_string()
  instead of the generic OpenSSL error functions.
  [[aee82efe4]](https://git.sudo.ws/sudo/commit/?id=aee82efe4)

* lib/eventlog/eventlog.c:

  In new\_logline check for NULL args->reason for EVLOG\_RAW. This can’t
  happen in practice since we never set EVLOG\_RAW without passing in a
  reason. Coverity CID 237142 237143
  [[d109cd61d]](https://git.sudo.ws/sudo/commit/?id=d109cd61d)

* lib/eventlog/eventlog.c:

  format\_json: don’t dereference evlog if it is NULL. Also silence a PVS
  Studio false positive.
  [[e00ed390d]](https://git.sudo.ws/sudo/commit/?id=e00ed390d)

2021-07-26 Todd C. Miller

* configure, configure.ac:

  Bump version to 1.9.7p2
  [[625ab9d29]](https://git.sudo.ws/sudo/commit/?id=625ab9d29)

* NEWS:

  Sudo 1.9.7p2
  [[8d23e2611]](https://git.sudo.ws/sudo/commit/?id=8d23e2611)

* config.h.in, configure, configure.ac, include/sudo\_compat.h,
  logsrvd/tls\_client.c, logsrvd/tls\_init.c, plugins/sudoers/log\_client.c:

  Use TLS\_method() instead of TLS\_client\_method() throughout. OpenSSL
  returns an error for SSL\_accept() if TLS\_client\_method() was used to
  generate the context (LibreSSL doesn’t care).

  Prior to sudo 1.9.7, TLS\_client\_method() and TLS\_server\_method() were
  used in the TLS client and server initialization code respectively. This
  was refactored in sudo 1.9.7 to allow the code to be shared. [Bug
  #988](https://bugzilla.sudo.ws/show_bug.cgi?id=988)
  [[36fbb13c4]](https://git.sudo.ws/sudo/commit/?id=36fbb13c4)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Only replace getaddrinfo for FUZZING\_BUILD\_MODE\_UNSAFE\_FOR\_PRODUCTION.
  This works around an issue on SCO which uses inline functions in the
  header files which call the actual, versioned, library function.
  [[532e00aa2]](https://git.sudo.ws/sudo/commit/?id=532e00aa2)

2021-07-26 MertsA

* src/utmp.c:

  Rewind utmp file pointer after searching for entry (#108)

  getutline() advances the file pointer until it matches or reaches EOF.
  pututline() starts from the current position in utmp. This rewinds the
  file pointer to the beginning to avoid allocating additional spurious
  utmp entries.
  [[0a506b380]](https://git.sudo.ws/sudo/commit/?id=0a506b380)

2021-07-25 Todd C. Miller

* configure, configure.ac, m4/sudo.m4:

  Use AC\_CACHE\_CHECK in place of AC\_MSG\_CHECKING + AC\_CACHE\_VAL where
  possible.
  [[f8e05dd98]](https://git.sudo.ws/sudo/commit/?id=f8e05dd98)

* config.h.in, configure, configure.ac, include/sudo\_compat.h:

  Add configure check for va\_copy instead of using #ifdef This prevents
  the va\_copy compat #define from being used if sudo\_compat.h is somehow
  included before stdarg.h.
  [[4a90deb2a]](https://git.sudo.ws/sudo/commit/?id=4a90deb2a)

2021-07-23 Todd C. Miller

* src/limits.c:

  Avoid using RLIM\_INFINITY for the nofile soft limit to prevent
  closefrom\_fallback() from closing too many file descriptors.
  [[b0ae7a566]](https://git.sudo.ws/sudo/commit/?id=b0ae7a566)

* plugins/sudoers/logging.c:

  Include signal.h for SIG2STR\_MAX and sig2str().
  [[b48cd11a4]](https://git.sudo.ws/sudo/commit/?id=b48cd11a4)

2021-07-15 Todd C. Miller

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  logsrvd/logsrvd\_local.c, plugins/sudoers/logging.c:

  Remove unused info\_cb and info arguments from eventlog\_exit()
  [[c234bab7b]](https://git.sudo.ws/sudo/commit/?id=c234bab7b)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  logsrvd/iolog\_writer.c, plugins/sudoers/logging.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.h:

  Create a UUID and log it in the JSON version of the event log.
  [[fa7250ead]](https://git.sudo.ws/sudo/commit/?id=fa7250ead)

2021-07-09 Todd C. Miller

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  examples/sudo\_logsrvd.conf, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  logsrvd/logsrvd\_local.c:

  Add log\_exit setting in the sudo\_logsrvd.conf eventlog stanza This
  causes sudo\_logsrvd to log a record with the exit status or terminating
  signal in response to an ExitMessage.
  [[0dd2b6442]](https://git.sudo.ws/sudo/commit/?id=0dd2b6442)

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/policy.c, plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Add log\_exit\_status sudoers option to log when a command exits. This
  option defaults to off.
  [[17a415ae7]](https://git.sudo.ws/sudo/commit/?id=17a415ae7)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c:

  Add support for logging exit status events. For sudo-formatted logs,
  this is a record with “EXIT=number” and potentially “SIGNAL=name” after
  the command. For JSON-format logs, a new “exit” record is logged which
  contains an “exit\_value” and potentially “signal” and “core\_dumped”.
  JSON-format logs now incude a UUID to associate the “exit” record with
  the “accept” record.
  [[b54a16e17]](https://git.sudo.ws/sudo/commit/?id=b54a16e17)

2021-07-08 Todd C. Miller

* plugins/python/python\_plugin\_common.c:

  Check that the python module we actually loaded is what we intended.
  This is intended to provide a more useful error message if the user
  defines a module which conflicts with a system python module. For
  example, a module called test.py would conflicts with the system python
  test module.
  [[657897b8b]](https://git.sudo.ws/sudo/commit/?id=657897b8b)

2021-07-02 Todd C. Miller

* doc/CONTRIBUTORS:

  Mention that xkcd inspired the sandwich logo.
  [[16f78f59b]](https://git.sudo.ws/sudo/commit/?id=16f78f59b)

* doc/HISTORY:

  Mention log server and fuzzers under Quest contributions.
  [[86680255b]](https://git.sudo.ws/sudo/commit/?id=86680255b)

2021-06-26 Todd C. Miller

* src/sesh.c, src/sudo.c, src/sudo\_edit.c:

  Don’t assume that the number of groups returned by getgroups() is
  static. On systems where getgroups() returns results based on more than
  just the per-process group vector in the kernel it is possible for the
  number of groups to change in between invocations. Based on GitHub PR
  #106 from Pierre-Olivier Martel.
  [[7a309d70b]](https://git.sudo.ws/sudo/commit/?id=7a309d70b)

* doc/Makefile.in:

  Use “mandoc -Tlint -Wwarning” instead of -Wstyle. The style checks now
  include “referenced manual not found” warnings which is not helpful.
  [[555596e57]](https://git.sudo.ws/sudo/commit/?id=555596e57)

2021-06-22 Todd C. Miller

* logsrvd/Makefile.in, src/Makefile.in:

  regen
  [[0b809cdaf]](https://git.sudo.ws/sudo/commit/?id=0b809cdaf)

2021-06-21 Todd C. Miller

* lib/fuzzstub/fuzzstub.c:

  Change ms from size\_t to long. Avoids a spurious test failure on Solaris
  9
  [[90b4f4c4f]](https://git.sudo.ws/sudo/commit/?id=90b4f4c4f)

* plugins/sudoers/interfaces.c, src/net\_ifs.c:

  Move definition of INADDR\_NONE from interfaces.c to net\_ifs.c. Fixes
  compilation on Solaris 9.
  [[ae0e25cf2]](https://git.sudo.ws/sudo/commit/?id=ae0e25cf2)

2021-06-19 Todd C. Miller

* logsrvd/logsrvd.c:

  Fix dead store found by clang analyzer.
  [[030746ce5]](https://git.sudo.ws/sudo/commit/?id=030746ce5)

* logsrvd/logsrvd\_conf.c:

  Fix prefix skipping when the prefix is embedded and not separate. This
  doesn’t currently matter since the progname and the “: " are stored in
  separate messages. Found by clang analyzer.
  [[442778aee]](https://git.sudo.ws/sudo/commit/?id=442778aee)

* logsrvd/logsrvd\_relay.c:

  Remove dead store found by clang analyzer.
  [[f3deb3737]](https://git.sudo.ws/sudo/commit/?id=f3deb3737)

2021-06-16 Todd C. Miller

* plugins/audit\_json/audit\_json.c:

  Make sure we store an octal number (like umask) as a string. JSON
  doesn’t (portably) support octal numbers with a leading zero.
  [[b7e81c46b]](https://git.sudo.ws/sudo/commit/?id=b7e81c46b)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  Replace logsrvd\_is\_early() with logsrvd\_warn\_stderr(). This is now
  defined in logsrvd\_conf.c which removes a dependency on another
  compilation unit for the fuzzer.
  [[efaa173fb]](https://git.sudo.ws/sudo/commit/?id=efaa173fb)

2021-06-15 Todd C. Miller

* logsrvd/logsrvd\_local.c:

  Silence a compiler warning on Solaris.
  [[1d41937ca]](https://git.sudo.ws/sudo/commit/?id=1d41937ca)

* logsrvd/logsrvd.c:

  Reduce scope of errstr variable so it is only declared for OpenSSL.
  [[74f034cbf]](https://git.sudo.ws/sudo/commit/?id=74f034cbf)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[024f4475b]](https://git.sudo.ws/sudo/commit/?id=024f4475b)

* logsrvd/iolog\_writer.c, logsrvd/logsrv\_util.c, logsrvd/logsrvd.c,
  logsrvd/logsrvd\_conf.c, logsrvd/logsrvd\_journal.c,
  logsrvd/logsrvd\_local.c, logsrvd/logsrvd\_queue.c,
  logsrvd/logsrvd\_relay.c, logsrvd/sendlog.c, logsrvd/tls\_init.c:

  Use sudo\_warnx?() instead of sudo\_debug\_printf for errors. We now hook
  the warn functions so the messages are logged. The messages still show
  up in the debug log too.
  [[5a3bbba12]](https://git.sudo.ws/sudo/commit/?id=5a3bbba12)

2021-06-14 Todd C. Miller

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/regress/vsyslog/vsyslog\_test.c,
  lib/util/vsyslog.c, scripts/mkdep.pl:

  Remove vsyslog(3) emulation, it is no longer used.
  [[cc3b4ffb0]](https://git.sudo.ws/sudo/commit/?id=cc3b4ffb0)

2021-06-13 Todd C. Miller

* logsrvd/logsrvd\_conf.c, logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  If logsrvd\_config not set fall back to using stderr for warnings. Also
  fix fuzz\_logsrvd\_conf link error.
  [[d311c7b2e]](https://git.sudo.ws/sudo/commit/?id=d311c7b2e)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  examples/sudo\_logsrvd.conf, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_conf.c:

  Add support for logging server warning/error messages. We can use
  sudo\_warn\_set\_conversation() to set a conversation function that either
  writes to a log file or calls syslog().
  [[2c1988410]](https://git.sudo.ws/sudo/commit/?id=2c1988410)

2021-06-11 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.7p1
  [[df1895f66]](https://git.sudo.ws/sudo/commit/?id=df1895f66)

2021-06-09 Todd C. Miller

* plugins/audit\_json/audit\_json.c:

  Check arrays that are passed in for NULL before using them.
  [[8f7cae69c]](https://git.sudo.ws/sudo/commit/?id=8f7cae69c)

* configure, configure.ac:

  Disable nss\_search()-based group lookups on HP-UX for now. There is a
  crash when “group: compat” is used in /etc/nsswitch.conf that I haven’t
  been able to debug. Since HP-UX doesn’t ship the appropriate headers it
  is likely that there is a mismatch between include/compat/nss\_dbdefs.h
  and what HP actually uses.
  [[f7f161782]](https://git.sudo.ws/sudo/commit/?id=f7f161782)

2021-06-08 Todd C. Miller

* logsrvd/logsrvd.c, logsrvd/logsrvd.h:

  Remove logsrvd closure ERROR state and use a boolean flag instead. Fixes
  a bug where we would not insert a journal file that failed to relay into
  the queue because its state was changed from CONNECTING to ERROR after
  failing to connect.
  [[7b33974f2]](https://git.sudo.ws/sudo/commit/?id=7b33974f2)

* include/compat/nss\_dbdefs.h, lib/util/getgrouplist.c:

  Add NSS\_TRYAGAIN and correct buflen in struct nss\_XbyY\_buf\_t. Add some
  function argument names. Also use struct nss\_db\_state \* instead of void
  + in nss\_db\_root\_t. We don’t define struct nss\_db\_state but since it is
    a pointer all we need is a forward declaration.
    [[c5247845a]](https://git.sudo.ws/sudo/commit/?id=c5247845a)

2021-06-07 Todd C. Miller

* lib/fuzzstub/fuzzstub.c, lib/iolog/Makefile.in, lib/util/Makefile.in,
  logsrvd/Makefile.in:

  Make sure we link with libsudo\_util *after* libfuzzstub. This only
  affects builds with a static libsudo\_util. Also fix a warning on HP-UX
  about main not being public.
  [[b913a832e]](https://git.sudo.ws/sudo/commit/?id=b913a832e)

* MANIFEST, lib/util/Makefile.in, lib/util/regress/getgrouplist/getgids.c:
  Add getgids utility to simular “id -G” using sudo\_getgrouplist2()
  [[dfaa9b95f]](https://git.sudo.ws/sudo/commit/?id=dfaa9b95f)

* lib/util/getgrouplist.c:

  Make sure we don’t read or write past the end of the group buffer. We
  need to leave room for the terminating NULL in gr\_mem. It is possible
  for gbm->numgids > gbm->maxgids if we ran out of room.
  [[3104d8ba0]](https://git.sudo.ws/sudo/commit/?id=3104d8ba0)

2021-06-04 Todd C. Miller

* lib/util/getgrouplist.c:

  Add some debugging to sudo\_getgrouplist2().
  [[4b73c98c0]](https://git.sudo.ws/sudo/commit/?id=4b73c98c0)

2021-04-07 Radovan Sroka

* src/sudo\_edit.c:

  Fixed bad condition for sesh args

  In selinux\_edit\_copy\_tfiles() when there is only one file and the open()
  fails then number of arguments is lower than expected. Sudo should
  return error with or without “Defaults !sudoedit\_checkdir” set.

  This was found with regression testing of CVE-2021-23240.

  Signed-off-by: Radovan Sroka <rsroka@…>
  [[f44adcdf3]](https://git.sudo.ws/sudo/commit/?id=f44adcdf3)

2021-06-02 Todd C. Miller

* src/load\_plugins.c:

  Fix some debug\_decl typos and remove an unneeded cast.
  [[97f6fc259]](https://git.sudo.ws/sudo/commit/?id=97f6fc259)

* plugins/sudoers/defaults.h:

  T\_TIMEOUT is not a bitwise flag so doesn’t need to be a power of 2.
  [[82f5592d6]](https://git.sudo.ws/sudo/commit/?id=82f5592d6)

2021-05-28 Todd C. Miller

* src/load\_plugins.c:

  sudo\_stat\_plugin(): set errno but do not warn if plugin path too long.
  The caller will display the warning (using errno) so there is no need to
  do it twice.
  [[b1d4a02ea]](https://git.sudo.ws/sudo/commit/?id=b1d4a02ea)

2021-05-26 Todd C. Miller

* doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in:

  sudoreplay does not parse sudoers to find the value of iolog\_dir. The
  default value for the I/O log directory is set at build time.
  [[5087f6885]](https://git.sudo.ws/sudo/commit/?id=5087f6885)

* plugins/sudoers/policy.c:

  Fix group list ref leak in sudoers\_policy\_store\_result() on error path.
  [[cc647c32e]](https://git.sudo.ws/sudo/commit/?id=cc647c32e)

2021-05-24 Todd C. Miller

* plugins/sudoers/policy.c:

  Update comment to match reality.
  [[958066edd]](https://git.sudo.ws/sudo/commit/?id=958066edd)

2021-05-13 Todd C. Miller

* configure, configure.ac, scripts/ltmain.sh, src/Makefile.in:

  Build sudo\_noexec.so as a module on systems other then Darwin. On
  Darwin, shared modules and shared libraries are not interchangable and
  since we preload sudo\_noexec.so via DYLD\_INSERT\_LIBRARIES it must be a
  library, not a module. We must relax the requirement that libraries
  begin with a “lib” prefix to work around this difference. This does mean
  you must use sudo’s libtool on Darwin (macOS) but that is already a
  requirement on other systems (notably HP-UX and SCO) due to a number of
  libtool patches we require that haven’t be accepted upstream. This is a
  different fix for PR #102.
  [[2e492267e]](https://git.sudo.ws/sudo/commit/?id=2e492267e)

* configure, configure.ac:

  Use -Wno-deprecated-declarations on macOS This quiets warnings about
  LDAP and audit libraries being deprecated. We will use them until they
  are removed in a future version of macOS.
  [[31e613811]](https://git.sudo.ws/sudo/commit/?id=31e613811)

2021-05-12 Todd C. Miller

* scripts/mkpkg:

  Use /usr/bin/cc on FreeBSD and macOS.
  [[0645a2ade]](https://git.sudo.ws/sudo/commit/?id=0645a2ade)

* plugins/sudoers/log\_client.c:

  Don’t include errno in “unable to connect to log server” message. There
  should be a more specific message, usually with an error string,
  displayed earlier.
  [[78849e672]](https://git.sudo.ws/sudo/commit/?id=78849e672)

* src/ttyname.c:

  Fix compiler warning on FreeBSD.
  [[d9b831112]](https://git.sudo.ws/sudo/commit/?id=d9b831112)

* lib/iolog/hostcheck.c:

  Explicitly include netinet/in.h for struct sockaddr\_in and
  sockaddr+\_in6. Fixes a compilation problem on FreeBSD.
  [[96fb72e7c]](https://git.sudo.ws/sudo/commit/?id=96fb72e7c)

2021-05-10 Todd C. Miller

* plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po:

  Updated translations from translationproject.org
  [[ec0dcab3c]](https://git.sudo.ws/sudo/commit/?id=ec0dcab3c)

* plugins/sudoers/log\_client.c:

  Better warning when close function is passed a non-terminal signal.
  [[f2155c704]](https://git.sudo.ws/sudo/commit/?id=f2155c704)

* logsrvd/logsrvd\_local.c:

  Remove line causing store\_suspend\_local() to return false on success.
  This is something that should have been removed as part of the local I/O
  logging refactor.
  [[0f5c8fe12]](https://git.sudo.ws/sudo/commit/?id=0f5c8fe12)

* src/exec\_pty.c:

  Don’t set the command status in the closure when the command is
  suspended. This should only be set for signals that terminate the
  process. Fixes a bug where the sudo front-end could call the plugin
  close function with a non-terminal signal argument.
  [[3147bbeb2]](https://git.sudo.ws/sudo/commit/?id=3147bbeb2)

2021-05-07 Todd C. Miller

* plugins/python/pyhelpers.c, plugins/python/python\_plugin\_policy.c:

  Quiet -Wshadow warnings from gcc.
  [[6cdf49d33]](https://git.sudo.ws/sudo/commit/?id=6cdf49d33)

* NEWS, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  The -g option may also be used with any group the target user belongs
  to. The description in the Runas\_Spec section incorrectly stated that
  the -g option could not be used if no runas group was set. [Bug
  #975](https://bugzilla.sudo.ws/show_bug.cgi?id=975).
  [[7033f1c1d]](https://git.sudo.ws/sudo/commit/?id=7033f1c1d)

* configure, configure.ac:

  Remove redundant “configuring Sudo version X.YY” line. We now display
  this along with the summary info at the end.
  [[2efa90352]](https://git.sudo.ws/sudo/commit/?id=2efa90352)

* configure, configure.ac:

  Don’t check for -Wl,-z,relro twice.
  [[841e1b33f]](https://git.sudo.ws/sudo/commit/?id=841e1b33f)

2021-05-06 Todd C. Miller

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt.mo, plugins/sudoers/po/pt.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po:

  Updated translations from translationproject.org
  [[bfc17bc66]](https://git.sudo.ws/sudo/commit/?id=bfc17bc66)

* scripts/mkpkg:

  Build python plugin for RHEL 6 as well.
  [[3018c1cd2]](https://git.sudo.ws/sudo/commit/?id=3018c1cd2)

* configure, configure.ac:

  Remove shell-style quotes in configure warning/error/notice messages.
  Square bracket quotes are used, no need for shell-style double quotes.
  [[9b33594a4]](https://git.sudo.ws/sudo/commit/?id=9b33594a4)

* NEWS, configure, configure.ac:

  Summarize configure settings after all tests have run. This makes it a
  lot easier to see what features have been enabled.
  [[96436787a]](https://git.sudo.ws/sudo/commit/?id=96436787a)

2021-05-04 Todd C. Miller

* INSTALL, configure, configure.ac:

  Remove –with-efence option, there are better options available.
  [[d71731e50]](https://git.sudo.ws/sudo/commit/?id=d71731e50)

* NEWS:

  Move misplaced changes into the 1.9.7 section where they belong.
  [[f2081f902]](https://git.sudo.ws/sudo/commit/?id=f2081f902)

* lib/util/regress/sudo\_conf/conf\_test.c:

  Awful hack to pass on macOS where group\_source=dynamic by default.
  [[468e9c7f4]](https://git.sudo.ws/sudo/commit/?id=468e9c7f4)

* plugins/sudoers/po/ca.mo, plugins/sudoers/po/ca.po,
  plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po, po/ca.mo, po/ca.po,
  po/it.mo, po/it.po, po/sr.mo, po/sr.po:

  Updated translations from translationproject.org
  [[0e9a5e4f9]](https://git.sudo.ws/sudo/commit/?id=0e9a5e4f9)

* NEWS:

  Document late stage 1.9.7 changes.
  [[e6f1adcb2]](https://git.sudo.ws/sudo/commit/?id=e6f1adcb2)

* doc/sudo\_sendlog.man.in, doc/sudo\_sendlog.mdoc.in, logsrvd/sendlog.c,
  logsrvd/sendlog.h:

  sudo\_sendlog: rename -m (max-time) to -s (stop-after).
  [[9d734d57e]](https://git.sudo.ws/sudo/commit/?id=9d734d57e)

* logsrvd/logsrv\_util.c, logsrvd/logsrvd.c, logsrvd/logsrvd\_journal.c:

  Update closure->elapsed\_time in journal\_seek(). Otherwise the commit
  point messages won’t be accurate when restarting.
  [[caf096e1a]](https://git.sudo.ws/sudo/commit/?id=caf096e1a)

* doc/sudo\_sendlog.man.in, doc/sudo\_sendlog.mdoc.in, logsrvd/sendlog.c,
  logsrvd/sendlog.h:

  Add “-m elapsed” option to specify the max elapsed time of records to
  send. Useful for testing the ability of the server to handle restarted
  log transfers.
  [[7376fa632]](https://git.sudo.ws/sudo/commit/?id=7376fa632)

2021-05-03 Todd C. Miller

* logsrvd/logsrvd.c, logsrvd/logsrvd\_relay.c:

  Disable reading from client or relay when sending error to client. We
  treat an error from the relay as fatal and must stop processing data
  from both client and relay to make sure we don’t get out of sync.
  [[5a3906634]](https://git.sudo.ws/sudo/commit/?id=5a3906634)

* logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, logsrvd/logsrvd\_local.c:

  Fix I/O log restart of locally-store logs. This got broken a while ago
  when evlog in struct connection\_closure was changed to a pointer.
  [[c3534712d]](https://git.sudo.ws/sudo/commit/?id=c3534712d)

* scripts/pp:

  Fix detection of the volatile flag when other flags are present.
  Otherwise flags fields like “volatile,ignore-other” will be ignored by
  the Debian and BSD back ends.
  [[b5542f8b2]](https://git.sudo.ws/sudo/commit/?id=b5542f8b2)

* src/limits.c:

  Fix debug message when prctl(PR\_SET\_DUMPABLE, 0, 0, 0, 0) fails. [GitHub
  issue #101](https://github.com/sudo-project/sudo/issues/101)
  [[51cbc626f]](https://git.sudo.ws/sudo/commit/?id=51cbc626f)

* logsrvd/logsrvd\_relay.c, logsrvd/sendlog.c, logsrvd/tls\_client.c,
  logsrvd/tls\_common.h, plugins/sudoers/log\_client.c:

  Don’t hard-code the TLS connect timeout, use normal connect timeout. For
  sudo\_logsrvd, this is the relay connect\_timeout setting. For sudoers,
  this is the log\_server\_timeout setting.
  [[109a0331a]](https://git.sudo.ws/sudo/commit/?id=109a0331a)

2021-05-02 Todd C. Miller

* logsrvd/logsrvd\_queue.c:

  Add missing closedir(3) in logsrvd\_queue\_scan(). Coverity CID 221591
  [[06cb6459c]](https://git.sudo.ws/sudo/commit/?id=06cb6459c)

2021-04-27 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  regen
  [[d883213f5]](https://git.sudo.ws/sudo/commit/?id=d883213f5)

2021-05-02 Todd C. Miller

* NEWS:

  Mention “log\_server\_verify” bug fix.
  [[d204d4120]](https://git.sudo.ws/sudo/commit/?id=d204d4120)

* configure, configure.ac, doc/sudo\_logsrvd.conf.man.in,
  doc/sudo\_logsrvd.conf.mdoc.in, examples/sudo\_logsrvd.conf, m4/sudo.m4,
  pathnames.h.in:

  Rename logsrvd log dir to /var/log/sudo\_logsrvd.
  [[fda17ecfd]](https://git.sudo.ws/sudo/commit/?id=fda17ecfd)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  examples/sudo\_logsrvd.conf, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  logsrvd/logsrvd\_queue.c:

  Make the failed relay retry interval configurable. This is the amount of
  time to wait before trying to resend a journal to the relay server after
  a connection error.
  [[f49930c62]](https://git.sudo.ws/sudo/commit/?id=f49930c62)

2021-05-01 Todd C. Miller

* MANIFEST, logsrvd/Makefile.in, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_journal.c, logsrvd/logsrvd\_queue.c,
  logsrvd/logsrvd\_relay.c:

  Send outgoing messages to the relay server on startup. Also attempt to
  retry messages that could not be relayed periodically.
  [[177816b78]](https://git.sudo.ws/sudo/commit/?id=177816b78)

* lib/util/fatal.c:

  Avoid clobbering errno in warning().
  [[9077daee9]](https://git.sudo.ws/sudo/commit/?id=9077daee9)

* logsrvd/logsrvd\_relay.c:

  Set relay name string to NULL after dropping the reference. Otherwise it
  is possible to decrement the reference more than once.
  [[bc82430a6]](https://git.sudo.ws/sudo/commit/?id=bc82430a6)

2021-04-30 Todd C. Miller

* plugins/sudoers/iolog.c:

  Fix cut & pasto that prevented the verify\_server option from being set.
  The “log\_server\_verify” setting passed from the policy plugin was
  applied to the “keepalive” option instead of “verify\_server”. From
  Krisztian Kovacs.
  [[af0345e23]](https://git.sudo.ws/sudo/commit/?id=af0345e23)

2021-04-29 Todd C. Miller

* doc/sudo\_logsrvd.man.in, doc/sudo\_logsrvd.mdoc.in, logsrvd/logsrvd.c:

  Write client and server information to debug file on SIGUSR1 This can be
  used to debug client problems such as a connection not being closed as
  expected.
  [[01bdfd3be]](https://git.sudo.ws/sudo/commit/?id=01bdfd3be)

* doc/sudo\_logsrvd.man.in, doc/sudo\_logsrvd.mdoc.in:

  Document journal file directories in store\_first mode.
  [[cefa72c6a]](https://git.sudo.ws/sudo/commit/?id=cefa72c6a)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_journal.c:

  Create journal files in an incoming directory, move to outgoing when
  complete. This will make it possible to process completed journal files
  periodically if the relay server is down.
  [[f92bb8840]](https://git.sudo.ws/sudo/commit/?id=f92bb8840)

* logsrvd/logsrvd\_relay.c:

  Add missing connection\_close() call for relay-only connections. For an
  immediate relay we will close the connection when the client disconnects
  (or there is a timeout). However, for store-and-forward mode the client
  has already disconnected at the time we are relaying.
  [[5c593d5a4]](https://git.sudo.ws/sudo/commit/?id=5c593d5a4)

2021-04-27 Todd C. Miller

* logsrvd/logsrvd\_conf.c:

  Replace non-ascii characters in warning string.
  [[d4bdc85d7]](https://git.sudo.ws/sudo/commit/?id=d4bdc85d7)

* lib/util/regress/getgrouplist/getgrouplist\_test.c,
  lib/util/regress/tailq/hltq\_test.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/editor/check\_editor.c,
  plugins/sudoers/regress/exptilde/check\_exptilde.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/parser/check\_hexchar.c,
  plugins/sudoers/regress/starttime/check\_starttime.c,
  plugins/sudoers/regress/unescape/check\_unesc.c:

  Quiet clang analyzer false positive in regress tests.
  [[ac878d3e2]](https://git.sudo.ws/sudo/commit/?id=ac878d3e2)

* MANIFEST, logsrvd/Makefile.in, logsrvd/iolog\_writer.c,
  logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_local.c:

  Move local iolog log functions to logsrvd\_local.c
  [[84a01d3a9]](https://git.sudo.ws/sudo/commit/?id=84a01d3a9)

* logsrvd/logsrvd\_relay.c:

  Better client error reporting on relay server connection error. More
  detailed error messages may be found in the debug log.
  [[6d8942e82]](https://git.sudo.ws/sudo/commit/?id=6d8942e82)

* logsrvd/logsrvd.c:

  Update debug pid string when sudo\_logsrvd becomes a daemon.
  [[e55991f24]](https://git.sudo.ws/sudo/commit/?id=e55991f24)

2021-04-26 Todd C. Miller

* logsrvd/logsrvd.c:

  Must call SSL\_shutdown() before closing the underlying socket. This got
  broken by some code rearrangement when relay mode was added.
  [[f25275ad5]](https://git.sudo.ws/sudo/commit/?id=f25275ad5)

* logsrvd/logsrvd.c, logsrvd/logsrvd\_relay.c:

  Recover if the client or relay server closes the TLS connection
  uncleanly. The other end of the connection should perform a proper TLS
  shutdown but as long as we are in the correct state there is no need to
  treat this as a user-visible error.
  [[67029f3cc]](https://git.sudo.ws/sudo/commit/?id=67029f3cc)

* NEWS, aclocal.m4, configure, configure.ac:

  Sudo 1.9.7
  [[66c6edada]](https://git.sudo.ws/sudo/commit/?id=66c6edada)

* MANIFEST, plugins/python/Makefile.in, plugins/python/lsan\_suppr.txt:

  Add a suppression file for the libpython leaks. This is a big hammer but
  it seems like the best we can do for now. Allows “make check” to succeed
  when address sanitizer is used.
  [[8a6589343]](https://git.sudo.ws/sudo/commit/?id=8a6589343)

2021-04-25 Todd C. Miller

* plugins/sudoers/Makefile.in, plugins/sudoers/editor.c,
  plugins/sudoers/regress/editor/check\_editor.c:

  When spliting EDITOR check for escaped quote characters. Also add
  check\_editor to sudoers “make check”.
  [[6907376ae]](https://git.sudo.ws/sudo/commit/?id=6907376ae)

2021-04-24 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/editor.c,
  plugins/sudoers/regress/editor/check\_editor.c:

  Treat a lone backslash at the end of a string as a literal backslash.
  [GitHub issue #99](https://github.com/sudo-project/sudo/issues/99)
  [[5e5131dec]](https://git.sudo.ws/sudo/commit/?id=5e5131dec)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in:

  Fix typo.
  [[d6d2e3488]](https://git.sudo.ws/sudo/commit/?id=d6d2e3488)

2021-04-23 Todd C. Miller

* plugins/python/pyhelpers.c:

  Avoid a potential NULL dereference when mutating args\_str. Coverit CID
  221401
  [[a85c6b41a]](https://git.sudo.ws/sudo/commit/?id=a85c6b41a)

* logsrvd/logsrvd\_journal.c:

  Avoid calling fread() with a NUL buffer if msg\_len is 0. Coverity CID
  221399
  [[65a55497e]](https://git.sudo.ws/sudo/commit/?id=65a55497e)

* logsrvd/logsrvd.c:

  Set a restrictive umask so new files are only read/write by owner.
  Coverity CID 221402
  [[d9f0eba1f]](https://git.sudo.ws/sudo/commit/?id=d9f0eba1f)

* logsrvd/logsrvd.c:

  In connection\_closure\_free() only close sock if it is not -1. When
  relaying from a journal there will be no socket. Coverity CID 221403
  [[bfd5803bd]](https://git.sudo.ws/sudo/commit/?id=bfd5803bd)

* logsrvd/logsrvd.c:

  Avoid potential NULL dereference in get\_free\_buf(). Coverity CID 221400
  [[57b8122cf]](https://git.sudo.ws/sudo/commit/?id=57b8122cf)

* logsrvd/logsrvd.c, logsrvd/logsrvd\_relay.c:

  Remove some now-dead code in the error path. Coverity CID 221397 and
  221398
  [[21641a27e]](https://git.sudo.ws/sudo/commit/?id=21641a27e)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_journal.c,
  logsrvd/logsrvd\_relay.c:

  Use function pointers for each client message type instead of
  conditionals. This separats out the message handler from the functions
  that store or relay the message contents.
  [[761b02d34]](https://git.sudo.ws/sudo/commit/?id=761b02d34)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_relay.c:

  Add enqueue\_error\_message() helper function. Formats and enqueues an
  error message and enables the write event.
  [[64ac63918]](https://git.sudo.ws/sudo/commit/?id=64ac63918)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_journal.c,
  logsrvd/logsrvd\_relay.c:

  Forward the journaled entry after it has been stored locally.
  [[050e91f8d]](https://git.sudo.ws/sudo/commit/?id=050e91f8d)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_journal.c:

  Stash the value of the store\_first config setting in connection\_closure.
  If the configuration changes it should not affect a connection that is
  already in progress.
  [[280fabac3]](https://git.sudo.ws/sudo/commit/?id=280fabac3)

* MANIFEST, logsrvd/Makefile.in, logsrvd/iolog\_writer.c,
  logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  logsrvd/logsrvd\_journal.c, logsrvd/logsrvd\_relay.c:

  Journal messages to disk when store\_first is set in the relay section.
  Instead of forwarding messages immediately, they are journaled locally
  in wire format. This will be used to implement relay store-and-forward
  mode.
  [[c2d3070fa]](https://git.sudo.ws/sudo/commit/?id=c2d3070fa)

* INSTALL, configure, configure.ac, doc/sudo\_logsrvd.conf.man.in,
  doc/sudo\_logsrvd.conf.mdoc.in, doc/sudo\_logsrvd.mdoc.in,
  logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c, m4/sudo.m4, pathnames.h.in:

  Add configuration for sudo\_logsrvd store-and-forward mode. Adds
  “relay\_dir” and “store\_first” settings to sudo\_logsrvd.conf in the
  [relay] section. Also adds a –with-relaydir configure argument to
  change the default value (usually /var/log/logsrvd-relay.
  [[6f5b353e8]](https://git.sudo.ws/sudo/commit/?id=6f5b353e8)

* src/signal.c:

  Make sure SIGCHLD is not ignored when sudo is executed. If SIGCHLD is
  ignored there is a race condition between when the process is executed
  and when the SIGCHLD handler is installed. This fixes the bug described
  by GitHub PR #98
  [[727056e0c]](https://git.sudo.ws/sudo/commit/?id=727056e0c)

2021-04-20 Todd C. Miller

* config.h.in, configure, configure.ac:

  Remove the HP-UX 11.0 pread64() hack, it causes problems on modern
  HP-UX.
  [[b0a32fe73]](https://git.sudo.ws/sudo/commit/?id=b0a32fe73)

* src/limits.c:

  Add minimum value to consider when overriding resource limits. Currently
  only used for RLIMIT\_DATA and RLIMIT\_AS.

  This works around a problem on HP-UX where setting RLIMIT\_DATA changes
  the resource limits for both 32-bit and 64-bit processes. HP-UX
  processes start out with RLIMIT\_DATA set based on the values of the
  maxdsiz and maxdsiz\_64bit kernel tunables, depending on whether they are
  32-bit or 64-bit. By default this limit is 1GB for 32-bit processes and
  4GB for 64-bit. However, once RLIMIT\_DATA is changed, it does not appear
  to be possible to restore the old values. This can result in a 64-bit
  process that is executed by a 32-bit shell getting the 32-bit
  RLIMIT\_DATA instead of the 64-bit one. [Bug
  #973](https://bugzilla.sudo.ws/show_bug.cgi?id=973)
  [[6717415e7]](https://git.sudo.ws/sudo/commit/?id=6717415e7)

2021-04-19 Todd C. Miller

* logsrvd/logsrvd\_relay.c:

  Don’t use msg\_len as a length after converting it to network byte order.
  [[32f742389]](https://git.sudo.ws/sudo/commit/?id=32f742389)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_relay.c:

  Use the packed message buffer when relaying if possible. There’s no need
  to rebuild the message buffer for anything but RestartMessage and
  ClientHello.
  [[110d9667e]](https://git.sudo.ws/sudo/commit/?id=110d9667e)

2021-04-18 Todd C. Miller

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_relay.c:

  Allocate the data buffer in get\_free\_buf() too. We always know the size
  of the data buffer we need at allocation time.
  [[935daf6b7]](https://git.sudo.ws/sudo/commit/?id=935daf6b7)

2021-04-17 Todd C. Miller

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_relay.c:

  Relay ChangeWindowSize and CommandSuspend events too.
  [[3dce67ec1]](https://git.sudo.ws/sudo/commit/?id=3dce67ec1)

2021-04-16 Todd C. Miller

* plugins/python/pyhelpers.c,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@diag.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@info.log
  ,
  plugins/python/regress/testdata/check\_example\_group\_plugin\_is\_able\_to\_de
  bug.log:

  Regenerate test output with python 3.10a7 Also adjust debug tests so
  they pass on older python versions
  [[7c2224584]](https://git.sudo.ws/sudo/commit/?id=7c2224584)

* configure, m4/python.m4:

  determine Python (3.10) version number correctly. from upstream automake
  [[5ffa915c9]](https://git.sudo.ws/sudo/commit/?id=5ffa915c9)

* MANIFEST, aclocal.m4, m4/python.m4, m4/runlog.m4:

  Move python.m4 and runlog.m4 to the m4 directory. Previously they were
  inline in aclocal.m4.
  [[fbbf60266]](https://git.sudo.ws/sudo/commit/?id=fbbf60266)

2021-04-15 Todd C. Miller

* configure, configure.ac:

  Add hiuxmpp where we have hpux for special cases. Also move the HP-UX
  11.00 pread(2) workaround into the section where pread(2) is tested for,
  not before it.
  [[d76cc96af]](https://git.sudo.ws/sudo/commit/?id=d76cc96af)

* etc/sudo-logsrvd.pp, etc/sudo-python.pp:

  Only replace the last instance of “sudo” in example and doc dir.
  Otherwise we end up with weird paths for a prefix like /opt/sudo.
  [[620b0dec8]](https://git.sudo.ws/sudo/commit/?id=620b0dec8)

2021-04-13 Todd C. Miller

* doc/sudoers.ldap.mdoc.in:

  Fix lint warning.
  [[a1323ba43]](https://git.sudo.ws/sudo/commit/?id=a1323ba43)

* doc/sudo\_logsrvd.man.in, doc/sudo\_logsrvd.mdoc.in:

  Mention relay mode and update TLS example.
  [[556b8f62c]](https://git.sudo.ws/sudo/commit/?id=556b8f62c)

* etc/sudo-logsrvd.pp, etc/sudo.pp:

  If libssl\_dep was not passed in, use ldd to determine its value.
  Normally, mkpkg will figure this out, but if the user does “make
  package” outside of the mkpkg script, libssl\_dep will not be set.
  [[d028410bf]](https://git.sudo.ws/sudo/commit/?id=d028410bf)

2021-04-12 Todd C. Miller

* INSTALL, configure, configure.ac, doc/UPGRADE:

  Enable the use of OpenSSL if log client/server not disabled. This adds a
  dependency on OpenSSL unless it is explicitly disabled
  (–disable-openssl) or the sudo log client and server are disabled
  (–disable-log-client and –disable-log-server).
  [[28d41ceca]](https://git.sudo.ws/sudo/commit/?id=28d41ceca)

2021-04-09 Todd C. Miller

* etc/codespell.skip:

  configure aux scripts moved to the scripts directory
  [[b8fda5b0a]](https://git.sudo.ws/sudo/commit/?id=b8fda5b0a)

* logsrvd/Makefile.in, logsrvd/logsrvd\_conf.c:

  Set logsrvd\_config to NULL in logsrvd\_conf\_cleanup() after freeing it.
  Fixes a double free in fuzz\_logsrvd\_conf (but not sudo\_logsrvd itself).
  Also fix linking fuzz\_logsrvd\_conf with OpenSSL.
  [[4e9baba2b]](https://git.sudo.ws/sudo/commit/?id=4e9baba2b)

* logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.1,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.2,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.3,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.4,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.5,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.6,
  logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c,
  logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.dict:

  Update sudo\_logsrvd.conf fuzzer to match configuration changes.
  [[e4e0e734b]](https://git.sudo.ws/sudo/commit/?id=e4e0e734b)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  examples/sudo\_logsrvd.conf:

  Document relay configuration changes.
  [[ae77355ed]](https://git.sudo.ws/sudo/commit/?id=ae77355ed)

2021-04-08 Todd C. Miller

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  logsrvd/logsrvd\_relay.c:

  Move relay configuration into its own section and add TLS options. TLS
  options in the relay section will be used if specified, otherwise the
  TLS options from the server section are used.
  [[163a5f08b]](https://git.sudo.ws/sudo/commit/?id=163a5f08b)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  logsrvd/logsrvd\_relay.c:

  Add “server” and “relay” to getters/callbacks specific to server and
  relay.
  [[25d4dd8e6]](https://git.sudo.ws/sudo/commit/?id=25d4dd8e6)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  logsrvd/logsrvd\_relay.c:

  Remove struct logsrvd\_tls\_config. Now that the SSL context is
  initialized in logsrvd\_conf.c there’s no need to export TLS
  configuration other than tls\_check\_peer.
  [[90770794d]](https://git.sudo.ws/sudo/commit/?id=90770794d)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  logsrvd/logsrvd\_relay.c:

  No longer need struct logsrvd\_tls\_runtime, use SSL\_CTX instead.
  [[9779996c3]](https://git.sudo.ws/sudo/commit/?id=9779996c3)

* logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c:

  Move allocation of the TLS context to logsrvd\_conf\_apply(). This way we
  get certificate errors at configuration time, not after. It also means
  that a change to the config file that renders the TLS settings invalid
  will no longer cause the server to exit. The new config will just be
  ignored as if there was a syntax error.
  [[990fa4f5a]](https://git.sudo.ws/sudo/commit/?id=990fa4f5a)

* logsrvd/tls\_init.c:

  Only initialize the SSL library once.
  [[8f0c16f06]](https://git.sudo.ws/sudo/commit/?id=8f0c16f06)

2021-04-07 Todd C. Miller

* plugins/sudoers/timestamp.c:

  Sanity check struct timespec in timestamp file. Coverity CID 220564
  [[c2909e20e]](https://git.sudo.ws/sudo/commit/?id=c2909e20e)

* plugins/sudoers/timestamp.c:

  Check lseek(fd, 0, SEEK\_CUR) for -1 return value. Not actually possible
  in practice. Coverity CID 220568.
  [[394673cbf]](https://git.sudo.ws/sudo/commit/?id=394673cbf)

* src/net\_ifs.c:

  Check for NULL ifa->ifa\_addr and ifa->ifa\_netmask in both loops.
  [[42865567d]](https://git.sudo.ws/sudo/commit/?id=42865567d)

2021-04-06 Todd C. Miller

* src/net\_ifs.c:

  Plug memory leak on overflow; Coverity CID 220556
  [[52c29aa7a]](https://git.sudo.ws/sudo/commit/?id=52c29aa7a)

* logsrvd/logsrvd.c:

  In schedule\_commit\_point() do not free the closure on error. It is the
  caller’s responsibility to free resources on error. Coverity CID 220557
  [[37e8b5868]](https://git.sudo.ws/sudo/commit/?id=37e8b5868)

* plugins/sudoers/pwutil.c, plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Cast NULL terminator argument to char \* when calling sudo\_mkgrent().
  Avoids a portability issue on systems where NULL is not a pointer.
  [[a2e4f5364]](https://git.sudo.ws/sudo/commit/?id=a2e4f5364)

* logsrvd/tls\_init.c:

  Rename LOGSRVD\_DEFAULT\_CIPHER\_LST13 to DEFAULT\_CIPHER\_LST13
  [[d92610ee4]](https://git.sudo.ws/sudo/commit/?id=d92610ee4)

* logsrvd/tls\_client.c:

  Include string.h for strerror(3) prototype.
  [[5cb5a45ba]](https://git.sudo.ws/sudo/commit/?id=5cb5a45ba)

* logsrvd/logsrvd\_relay.c:

  Move connect\_relay\_tls() so we don’t need a prototype for it. Fixes a
  warning when sudo is not configured to use OpenSSL.
  [[3f1a76cb8]](https://git.sudo.ws/sudo/commit/?id=3f1a76cb8)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  examples/sudo\_logsrvd.conf:

  Document relay and connect\_timeout server settings.
  [[3aec794b7]](https://git.sudo.ws/sudo/commit/?id=3aec794b7)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c:

  Add logsrvd\_conf\_cleanup() to free the conf data structures on exit.
  There is no longer a need to do anything in shutdown\_cb() other than
  break out of the event loop.
  [[86c815fd6]](https://git.sudo.ws/sudo/commit/?id=86c815fd6)

* logsrvd/logsrvd\_conf.c:

  Don’t allow a wildcard address for the relay parameter.
  [[ec52810c0]](https://git.sudo.ws/sudo/commit/?id=ec52810c0)

* logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c, logsrvd/logsrvd\_relay.c:

  Add sa\_host to struct server\_address as a ref counted string. Also
  convert sa\_str to ref counted string.
  [[30f57bcdc]](https://git.sudo.ws/sudo/commit/?id=30f57bcdc)

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in, lib/util/rcstr.c,
  lib/util/util.exp.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/alias.c, plugins/sudoers/check\_aliases.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/visudo.c:

  Move reference-counted string code from sudoers to libsudo\_util. It will
  be used by sudo\_logsrvd too.
  [[2db9e6421]](https://git.sudo.ws/sudo/commit/?id=2db9e6421)

* logsrvd/Makefile.in, logsrvd/logsrvd.h, logsrvd/logsrvd\_relay.c,
  logsrvd/sendlog.c, logsrvd/tls\_common.h:

  Add support for relaying to another sudo\_logsrvd via TLS.
  [[b1c4de208]](https://git.sudo.ws/sudo/commit/?id=b1c4de208)

* MANIFEST, logsrvd/Makefile.in, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_conf.c, logsrvd/logsrvd\_relay.c:

  Add a relay mode to sudo\_logsrvd where it forwards instead of stores.
  Relay hosts are be specified in the server section of sudo\_logsrvd.conf.
  [[d60b8a791]](https://git.sudo.ws/sudo/commit/?id=d60b8a791)

* logsrvd/logsrvd.c:

  Split most of server\_commit\_cb() out into schedule\_commit\_point(). This
  allows it to be used by the relay code too.
  [[343100307]](https://git.sudo.ws/sudo/commit/?id=343100307)

* logsrvd/logsrvd.c:

  Try to send an error message to client for some client\_msg\_cb()
  failures.
  [[533fcc3f0]](https://git.sudo.ws/sudo/commit/?id=533fcc3f0)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c:

  Rename listen\_address -> server\_address and add reference counting.
  This will be used by the upcoming relay mode.
  [[8101b23e5]](https://git.sudo.ws/sudo/commit/?id=8101b23e5)

* MANIFEST, logsrvd/Makefile.in, logsrvd/logsrv\_util.h, logsrvd/sendlog.c,
  logsrvd/sendlog.h, logsrvd/tls\_client.c, logsrvd/tls\_common.h:

  Move common TLS client code to tls\_client.c and use it in sendlog.c.
  [[72c40ae0e]](https://git.sudo.ws/sudo/commit/?id=72c40ae0e)

2021-03-10 Todd C. Miller

* MANIFEST, logsrvd/Makefile.in, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/sendlog.c, logsrvd/sendlog.h, logsrvd/tls\_common.h,
  logsrvd/tls\_init.c:

  Move common TLS initialization code to tls\_init.c.
  [[71e5275a1]](https://git.sudo.ws/sudo/commit/?id=71e5275a1)

2021-04-06 Todd C. Miller

* logsrvd/logsrv\_util.h, logsrvd/logsrvd.c, logsrvd/logsrvd.h:

  Use a tailq of write buffers instead of a single one per connection.
  This allows us to queue up multiple messages for writing like the
  sudoers client supports. Currently, each connection has its own free
  list. In the future we may want a single free list with low and high
  water marks.
  [[7bb5eef9d]](https://git.sudo.ws/sudo/commit/?id=7bb5eef9d)

* src/tgetpass.c:

  Set user group list when executing the askpass helper. Under normal
  circumstances the existing group list will match the list fetched by
  sudo. However, if sudo is executed by a process that has changed the
  group list via setgroups(2) and “group\_source” in sudo.conf is set to
  “dynamic” it is possible for them to be different.

  If group\_source in sudo.conf is set to “dynamic” it is possible for the
  group list
  [[e3ff4e663]](https://git.sudo.ws/sudo/commit/?id=e3ff4e663)

* configure.ac:

  Increase autoconf minimum version to 2.70. Some of the macros deprecated
  in 2.70 are required by older versions. For example, AC\_PROG\_CC now does
  the work of AC\_PROG\_CC\_STDC. [Bug
  #972](https://bugzilla.sudo.ws/show_bug.cgi?id=972)
  [[f1f8515bd]](https://git.sudo.ws/sudo/commit/?id=f1f8515bd)

* MANIFEST, Makefile.in, configure, configure.ac, doc/Makefile.in,
  examples/Makefile.in, include/Makefile.in, lib/util/Makefile.in,
  lib/zlib/Makefile.in, logsrvd/Makefile.in,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/python/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_approval/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, scripts/config.guess,
  scripts/config.sub, scripts/install-sh, scripts/ltmain.sh,
  src/Makefile.in:

  Move autoconf auxiliary files to the scripts directory.
  [[d4517e0a1]](https://git.sudo.ws/sudo/commit/?id=d4517e0a1)

2021-04-01 Radovan Sroka

* src/selinux.c:

  Removed depricated security\_context\_t

  Signed-off-by: Radovan Sroka <rsroka@…>
  [[c2a63690c]](https://git.sudo.ws/sudo/commit/?id=c2a63690c)

2021-04-05 Todd C. Miller

* doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:

  Document SUCCESS=return support in sudoers nsswitch.conf entries. Based
  on a patch from Dennis Filder. [Bug
  #971](https://bugzilla.sudo.ws/show_bug.cgi?id=971).
  [[28d65159e]](https://git.sudo.ws/sudo/commit/?id=28d65159e)

2021-04-01 Todd C. Miller

* plugins/sudoers/audit.c:

  Move log\_server\_accept() out from under the #ifdef SUDOERS\_LOG\_CLIENT
  Fixes a link error when sudo is configured with –disable-log-client.
  [[8fa897d3a]](https://git.sudo.ws/sudo/commit/?id=8fa897d3a)

2021-03-31 Todd C. Miller

* logsrvd/sendlog.c:

  Return NULL if init\_tls\_client\_context() fails. Otherwise, we will call
  SSL\_new with a freed SSL context. [Bug
  #970](https://bugzilla.sudo.ws/show_bug.cgi?id=970)
  [[5a7984120]](https://git.sudo.ws/sudo/commit/?id=5a7984120)

2021-03-30 Todd C. Miller

* etc/sudo-logsrvd.pp, etc/sudo-python.pp, etc/sudo.pp:

  Do not include parent directories in rpm and deb files. Fixes a
  directory conflict with the AIX sudo rpm package. Other deb/rpm packages
  were not affected because parent dirs are omitted for a prefix of /usr.
  [[4f9d2374c]](https://git.sudo.ws/sudo/commit/?id=4f9d2374c)

* src/parse\_args.c:

  Use separate getopt config for sudoedit. Avoids a problem where the user
  gets an exclusive usage error message when using a sudo-specific option.
  [GitHub issue #95](https://github.com/sudo-project/sudo/issues/95)
  [[a40e4b386]](https://git.sudo.ws/sudo/commit/?id=a40e4b386)

* src/parse\_args.c, src/sudo\_usage.h.in:

  Add -h and -V to sudoedit usage and customize help output for sudoedit.
  Also add missing -B option to usage strings.
  [[a4c710ccf]](https://git.sudo.ws/sudo/commit/?id=a4c710ccf)

* src/parse\_args.c:

  Don’t report a usage error for “sudo -V”. [GitHub issue
  #95](https://github.com/sudo-project/sudo/issues/95)
  [[b9a0c72fd]](https://git.sudo.ws/sudo/commit/?id=b9a0c72fd)

2021-03-29 Todd C. Miller

* src/net\_ifs.c:

  SCO OpenServer uses SIOCGIFANUM, not SIOCGIFNUM. On OpenServer,
  SIOCGIFNUM is the number of network interfaces, not the number of ifreq
  structs.
  [[ce1f0da84]](https://git.sudo.ws/sudo/commit/?id=ce1f0da84)

2021-03-27 Todd C. Miller

* src/net\_ifs.c:

  Add support for HP-UX SIOCGLIFNUM and SIOCGLIFCONF ioctls. We need to
  use both SIOCGIFCONF and SIOCGLIFCONF since SIOCGLIFCONF only returns
  IPv6 addresses.
  [[b269da75b]](https://git.sudo.ws/sudo/commit/?id=b269da75b)

2021-03-24 Todd C. Miller

* src/net\_ifs.c:

  Move get\_net\_ifs stub to the top and remove unused INET\_ADDRSTRLEN def.
  [[00cdc83cb]](https://git.sudo.ws/sudo/commit/?id=00cdc83cb)

* src/net\_ifs.c:

  No longer need ifr\_tmp variable, just reuse ifr. Now that we store the
  string version of the address before fetching the netmask we can just
  re-use ifr. This simplifies things and is safer since if there is space
  for the address there must also be space for the mask.
  [[0e49dd238]](https://git.sudo.ws/sudo/commit/?id=0e49dd238)

* src/net\_ifs.c:

  SCO OpenServer 5 returns a bogus value for SIOCGIFNUM. Gleaned from
  sendmail.
  [[423e23122]](https://git.sudo.ws/sudo/commit/?id=423e23122)

* src/net\_ifs.c:

  Use SIOCGSIZIFCONF or SIOCGIFNUM where available. Still falls back to a
  loop if not but now maxes out at 2048 interfaces instead of potentially
  looping forever.
  [[45ca46d73]](https://git.sudo.ws/sudo/commit/?id=45ca46d73)

* configure, configure.ac, src/net\_ifs.c:

  Remove support for obsolete ISC UNIX and MIPS RISC/OS systems. They were
  getting in the way of net\_its.c simplification.
  [[cf8feb287]](https://git.sudo.ws/sudo/commit/?id=cf8feb287)

2021-03-22 Todd C. Miller

* src/net\_ifs.c:

  Use SIOCGLIFCONF to get interface list where supported (Solaris). HP-UX
  has a SIOCGLIFCONF but it is incompatible (and appears to only return
  IPv6 addresses). Also add IPv6 support using SIOCGIFCONF (probably AIX
  only) and make sure ifr\_tmpbuf[] is properly aligned.
  [[9d6a37a49]](https://git.sudo.ws/sudo/commit/?id=9d6a37a49)

* MANIFEST, src/Makefile.in, src/regress/net\_ifs/check\_net\_ifs.c:

  Add simple regress check to display the network interfaces found.
  [[06df3a1b4]](https://git.sudo.ws/sudo/commit/?id=06df3a1b4)

2021-03-19 Todd C. Miller

* INSTALL:

  Suggest clang 11 or higher, some fuzzers may hang when used with clang
  10.
  [[009069115]](https://git.sudo.ws/sudo/commit/?id=009069115)

2021-03-18 Todd C. Miller

* MANIFEST, logsrvd/Makefile.in,
  logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.dict:

  Add dictionary file for fuzz\_logsrvd\_conf.
  [[977f238d3]](https://git.sudo.ws/sudo/commit/?id=977f238d3)

* Makefile.in, doc/Makefile.in, examples/Makefile.in, include/Makefile.in,
  lib/eventlog/Makefile.in, lib/fuzzstub/Makefile.in,
  lib/iolog/Makefile.in, lib/logsrv/Makefile.in, lib/util/Makefile.in,
  lib/zlib/Makefile.in, logsrvd/Makefile.in,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/python/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_approval/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Add a new “fuzz” target that executes the fuzzers for 8192 runs each. To
  run indefinately, set FUZZ\_RUNS=-1, e.g. “make FUZZ\_RUNS=-1 fuzz”
  [[dfff13212]](https://git.sudo.ws/sudo/commit/?id=dfff13212)

* MANIFEST, lib/iolog/Makefile.in,
  lib/iolog/regress/corpus/seed/log\_json/id.json,
  lib/iolog/regress/corpus/seed/log\_json/ls.json,
  lib/iolog/regress/corpus/seed/log\_json/mailq.json,
  lib/iolog/regress/corpus/seed/log\_json/make.json,
  lib/iolog/regress/corpus/seed/log\_json/pkg\_add.json,
  lib/iolog/regress/corpus/seed/log\_json/pkg\_delete.json,
  lib/iolog/regress/corpus/seed/log\_json/printenv.json,
  lib/iolog/regress/corpus/seed/log\_legacy/id.log,
  lib/iolog/regress/corpus/seed/log\_legacy/ls.log,
  lib/iolog/regress/corpus/seed/log\_legacy/mailq.log,
  lib/iolog/regress/corpus/seed/log\_legacy/make.log,
  lib/iolog/regress/corpus/seed/log\_legacy/pkg\_add.log,
  lib/iolog/regress/corpus/seed/log\_legacy/pkg\_delete.log,
  lib/iolog/regress/corpus/seed/log\_legacy/printenv.log,
  lib/iolog/regress/corpus/seed/timing/timing.1,
  lib/iolog/regress/corpus/seed/timing/timing.2,
  lib/iolog/regress/corpus/seed/timing/timing.3,
  lib/iolog/regress/corpus/seed/timing/timing.4, lib/util/Makefile.in,
  lib/util/regress/corpus/seed/sudo\_conf/sudo.conf.1,
  lib/util/regress/corpus/seed/sudo\_conf/sudo.conf.2,
  lib/util/regress/corpus/seed/sudo\_conf/sudo.conf.3, logsrvd/Makefile.in,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.1,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.2,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.3,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.4,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.5,
  logsrvd/regress/corpus/seed/logsrvd\_conf/logsrvd.conf.6,
  plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/corpus/seed/policy/policy.1,
  plugins/sudoers/regress/corpus/seed/policy/policy.2,
  plugins/sudoers/regress/corpus/seed/policy/policy.3,
  plugins/sudoers/regress/corpus/seed/policy/policy.4,
  plugins/sudoers/regress/corpus/seed/policy/policy.5:

  Move corpus files to a seed subdirectory.
  [[6eff3b313]](https://git.sudo.ws/sudo/commit/?id=6eff3b313)

* lib/fuzzstub/fuzzstub.c:

  We can now rely on LLVMFuzzerTestOneInput to flush stdout.
  [[5498c6a93]](https://git.sudo.ws/sudo/commit/?id=5498c6a93)

* plugins/sudoers/Makefile.in:

  Fix fuzz\_sudoers output comparison when fuzzing is enabled. libFuzzer
  outputs additional info to stderr that our stub doesn’t.
  [[bac057913]](https://git.sudo.ws/sudo/commit/?id=bac057913)

* lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.c,
  logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Flush stdout before successful return from LLVMFuzzerTestOneInput().
  Fixes a problem with diag lines from libFuzzer being interspersed with
  test output.
  [[95bfd65fe]](https://git.sudo.ws/sudo/commit/?id=95bfd65fe)

* configure, configure.ac:

  Use –allow-multiple-definition to work around an issue with ld.lld. For
  fuzz\_policy we redefine getaddrinfo/freeaddrinfo to work around a DNS
  timeout problem with name resolution and CIfuzz. However, this causes a
  link failure when sanitizers are enabled on systems that use ld.lld as
  their linker. Use a big hammer to avoid the link error.
  [[d03805c41]](https://git.sudo.ws/sudo/commit/?id=d03805c41)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/testsudoers.c,
  plugins/sudoers/testsudoers\_pwutil.c, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/tsgetgrpw.h:

  Do not redefine system group and passwd functions for testsudoers.
  Instead, prefix the replacements with “testsudoers\_” and use a custom
  pwutil backend so they get used.
  [[3e5cf7baa]](https://git.sudo.ws/sudo/commit/?id=3e5cf7baa)

* Makefile.in, doc/Makefile.in, examples/Makefile.in, include/Makefile.in,
  lib/eventlog/Makefile.in, lib/fuzzstub/Makefile.in,
  lib/iolog/Makefile.in, lib/logsrv/Makefile.in, lib/util/Makefile.in,
  lib/zlib/Makefile.in, logsrvd/Makefile.in,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/python/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_approval/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Rename “fuzz” makefile target to “check-fuzzer”. It’s purpose is to run
  the fuzzers are part of a normal “make check” to avoid bit rot, not to
  perform a fuzzer run. The fuzz\_logsrvd\_conf fuzzer was not wired up to
  “make check” previously.
  [[4c182c90f]](https://git.sudo.ws/sudo/commit/?id=4c182c90f)

2021-03-15 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.6p1
  [[85d77fb3d]](https://git.sudo.ws/sudo/commit/?id=85d77fb3d)

2021-03-15 Alexandru Ardelean

* plugins/sudoers/policy.c:

  plugins: sudoers: policy: add MODE\_IMPLIED\_SHELL to RUN\_VALID\_FLAGS

  Since this flag isn’t set, the sudo\_mode variable gets invalidated and
  running the ‘sudo’ command seems to error out with message
  ‘sudoers\_policy\_check: invalid mode flags from sudo front end: 0x80001”’
  [[058fde925]](https://git.sudo.ws/sudo/commit/?id=058fde925)

2021-03-13 Todd C. Miller

* NEWS:

  fix typo
  [[f57ab1a63]](https://git.sudo.ws/sudo/commit/?id=f57ab1a63)

2021-03-10 Todd C. Miller

* NEWS:

  [Bug #968](https://bugzilla.sudo.ws/show_bug.cgi?id=968)
  [[bc32789af]](https://git.sudo.ws/sudo/commit/?id=bc32789af)

* plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po, po/tr.mo, po/tr.po:

  Updated translations from translationproject.org
  [[843c4b632]](https://git.sudo.ws/sudo/commit/?id=843c4b632)

* plugins/sudoers/Makefile.in, plugins/sudoers/gram.c:

  Use HAVE\_STDINT\_H instead of trying to guess based on **STDC\_VERSION**.
  Fixes compilation with pre-C99 headers when the compiler supports C99.
  [[d7d80e703]](https://git.sudo.ws/sudo/commit/?id=d7d80e703)

* include/sudo\_compat.h, lib/util/secure\_path.c:

  Remove compatibility defines for POSIX sys/stat.h macros. Modern systems
  have them and we no longer support pre-POSIX systems. This fixes
  potential redefinition of the macros if sys/stat.h is included after
  sudo\_compat.h. [Bug #968](https://bugzilla.sudo.ws/show_bug.cgi?id=968).
  [[d9d450292]](https://git.sudo.ws/sudo/commit/?id=d9d450292)

* lib/eventlog/logwrap.c, plugins/python/python\_plugin\_approval\_multi.inc,
  plugins/python/python\_plugin\_audit\_multi.inc,
  plugins/python/python\_plugin\_io\_multi.inc, src/get\_pty.c:

  Quiet a few Solaris Studio compiler warnings.
  [[3f11e8d9a]](https://git.sudo.ws/sudo/commit/?id=3f11e8d9a)

* configure, configure.ac:

  Add -Wno-unknown-pragmas along with -Wall. We don’t want warnings about
  unknown pragmas in system headers.
  [[b8e588565]](https://git.sudo.ws/sudo/commit/?id=b8e588565)

* scripts/pp:

  Solaris 11.4 removed /usr/bin/optisa, use /usr/bin/isainfo instead.
  [[42fbc185a]](https://git.sudo.ws/sudo/commit/?id=42fbc185a)

2021-03-08 Todd C. Miller

* configure, configure.ac:

  Compare OS name against freebsd\* and netbsd\* not freebsd and netbsd.
  Fixes an issue on NetBSD where host\_os starts with netbsdelf.
  [[0e2ba920e]](https://git.sudo.ws/sudo/commit/?id=0e2ba920e)

* plugins/sudoers/Makefile.in:

  Add @SUDOERS\_LIBS@ to FUZZ\_LIBS for -lutil on FreeBSD and NetBSD
  [[07af7caf7]](https://git.sudo.ws/sudo/commit/?id=07af7caf7)

* lib/util/Makefile.in, plugins/python/Makefile.in, src/Makefile.in:

  Set locale for all “make check” targets.
  [[0cf7c3a95]](https://git.sudo.ws/sudo/commit/?id=0cf7c3a95)

2021-03-07 Todd C. Miller

* configure, configure.ac:

  AIX 6.1 may have a broken fmemopen(). We only use it for the fuzzers so
  ignore it for AIX < 7.1.
  [[7bce330ff]](https://git.sudo.ws/sudo/commit/?id=7bce330ff)

2021-03-06 Todd C. Miller

* scripts/pp:

  Only put specific directories in the ROOT section of the AIX package.
  Previously, /usr and /opt were placed in USR and everything else went in
  ROOT. Now, only /dev, /etc, /sbin and /var go in ROOT.
  [[2b564cd7b]](https://git.sudo.ws/sudo/commit/?id=2b564cd7b)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt.mo, plugins/sudoers/po/pt.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/cs.mo,
  po/cs.po, po/de.mo, po/de.po, po/eo.mo, po/eo.po, po/fi.mo, po/fi.po,
  po/fr.mo, po/fr.po, po/hr.mo, po/hr.po, po/ja.mo, po/ja.po, po/ko.mo,
  po/ko.po, po/pl.mo, po/pl.po, po/pt.mo, po/pt.po, po/pt\_BR.mo,
  po/pt\_BR.po, po/uk.mo, po/uk.po, po/zh\_CN.mo, po/zh\_CN.po, po/zh\_TW.mo,
  po/zh\_TW.po:

  Updated translations from translationproject.org
  [[ce497bf30]](https://git.sudo.ws/sudo/commit/?id=ce497bf30)

2021-03-05 Todd C. Miller

* logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c:

  Remove unused tls parameter, we now use a per-address tls flag.
  [[1c6080f13]](https://git.sudo.ws/sudo/commit/?id=1c6080f13)

2021-03-03 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document double escaping of backslashes. [Bug
  #961](https://bugzilla.sudo.ws/show_bug.cgi?id=961).
  [[2759920b8]](https://git.sudo.ws/sudo/commit/?id=2759920b8)

* NEWS, configure, configure.ac:

  No longer need to define \_DARWIN\_UNLIMITED\_GETGROUPS on macOS. We now
  define \_DARWIN\_C\_SOURCE which accomplishes the same thing.
  [[06beb6f06]](https://git.sudo.ws/sudo/commit/?id=06beb6f06)

* plugins/sudoers/auth/pam.c:

  Fix a potential use-after-free in conversation function. The prompt
  passed in to sudo\_pam\_verify() will be freed later by
  check\_user\_interactive() so we need to reset the stashed value. From
  Pavel Heimlich. [Bug
  #967](https://bugzilla.sudo.ws/show_bug.cgi?id=967).
  [[08b0b626f]](https://git.sudo.ws/sudo/commit/?id=08b0b626f)

* plugins/sudoers/pwutil.c:

  No need to update cp after storing gr->gr\_name, it is not used,
  Coverity CID 219314
  [[f0761a981]](https://git.sudo.ws/sudo/commit/?id=f0761a981)

2021-03-02 Todd C. Miller

* NEWS:

  Mention [GitHub issue
  #56](https://github.com/sudo-project/sudo/issues/56).
  [[a31bbbfbb]](https://git.sudo.ws/sudo/commit/?id=a31bbbfbb)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[428515327]](https://git.sudo.ws/sudo/commit/?id=428515327)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, logsrvd/logsrvd.h:

  Log peer address in sudo\_logsrvd JSON-format logs. The peer that
  connected to us might not be the same host where the log entry
  originated.
  [[d45267878]](https://git.sudo.ws/sudo/commit/?id=d45267878)

* NEWS, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, lib/util/sudo\_conf.c:
  Make “group\_source=dynamic” the default on macOS. Recent versions of
  macOS do not reliably return all of a user’s non-local groups via
  getgroups(2), even when \_DARWIN\_UNLIMITED\_GETGROUPS is defined. [Bug
  #946](https://bugzilla.sudo.ws/show_bug.cgi?id=946).
  [[5ffa0ce05]](https://git.sudo.ws/sudo/commit/?id=5ffa0ce05)

* lib/eventlog/Makefile.in, lib/iolog/Makefile.in, lib/util/Makefile.in,
  logsrvd/Makefile.in, plugins/sudoers/Makefile.in:

  For regess/fuzz set LC\_ALL to C.UTF-8 if possible, falling back on C.
  Works around a crash in leak sanitizer when the locale is set to C and
  TLS support is enabled.
  [[9bbf120bd]](https://git.sudo.ws/sudo/commit/?id=9bbf120bd)

2021-03-01 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Initialize the lbuf used by sudoers\_trace\_print() in init\_lexer(). Free
  the old buffer if there is one, otherwise it would never be freed.
  [[ac8f23ef9]](https://git.sudo.ws/sudo/commit/?id=ac8f23ef9)

* lib/util/lbuf.c:

  In sudo\_lbuf\_destroy(), reset error, len and size.
  [[7f27b0461]](https://git.sudo.ws/sudo/commit/?id=7f27b0461)

* NEWS:

  Mention the integer overflow check in store\_timespec().
  [[c8a8afba7]](https://git.sudo.ws/sudo/commit/?id=c8a8afba7)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  In find\_path() stub only make a copy in outfile if returning FOUND.
  Fixed a recently-introduced memory leak in the fuzzer.
  [[4a28b5d58]](https://git.sudo.ws/sudo/commit/?id=4a28b5d58)

2021-02-28 Todd C. Miller

* lib/util/sudo\_debug.c:

  Disable debug code for FUZZING\_BUILD\_MODE\_UNSAFE\_FOR\_PRODUCTION It will
  not be used and just confuses the coverage stats.
  [[79dbf9f17]](https://git.sudo.ws/sudo/commit/?id=79dbf9f17)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Expand stub getaddrinfo() to resolve “localhost”.
  [[0c944576e]](https://git.sudo.ws/sudo/commit/?id=0c944576e)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Improve fuzz\_policy coverage and set defaults in setdefs not parse. Now
  exercises session open/close and set additional defaults to exercise
  more code paths.
  [[cfcbc42ec]](https://git.sudo.ws/sudo/commit/?id=cfcbc42ec)

* plugins/sudoers/match\_command.c, plugins/sudoers/match\_digest.c:

  Improve SUDOERS\_NAME\_MATCH support. Now supports digests and performs
  better directory matching.
  [[f34a3072e]](https://git.sudo.ws/sudo/commit/?id=f34a3072e)

* plugins/sudoers/policy.c:

  Add MODE\_CHECK to LIST\_VALID\_FLAGS, fixes “sudo -l command”.
  [[f86c11c4a]](https://git.sudo.ws/sudo/commit/?id=f86c11c4a)

2021-02-26 Todd C. Miller

* MANIFEST, include/sudo\_iolog.h, lib/iolog/Makefile.in,
  lib/iolog/iolog\_clearerr.c, lib/iolog/iolog\_close.c,
  lib/iolog/iolog\_eof.c, lib/iolog/iolog\_fileio.c, lib/iolog/iolog\_gets.c,
  lib/iolog/iolog\_mkdirs.c, lib/iolog/iolog\_mkdtemp.c,
  lib/iolog/iolog\_mkpath.c, lib/iolog/iolog\_nextid.c,
  lib/iolog/iolog\_open.c, lib/iolog/iolog\_openat.c,
  lib/iolog/iolog\_read.c, lib/iolog/iolog\_seek.c,
  lib/iolog/iolog\_swapids.c, lib/iolog/iolog\_util.c,
  lib/iolog/iolog\_write.c, lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c,
  logsrvd/iolog\_writer.c, logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  Split iolog\_fileio.c into multiple files.
  [[851247e58]](https://git.sudo.ws/sudo/commit/?id=851247e58)

* plugins/sudoers/regress/sudoers/test27.ldif2sudo.ok:

  Update file that was missed in test27 changes.
  [[fc9170d80]](https://git.sudo.ws/sudo/commit/?id=fc9170d80)

* MANIFEST, include/sudo\_iolog.h, lib/iolog/Makefile.in,
  lib/iolog/iolog\_conf.c, lib/iolog/iolog\_fileio.c,
  lib/iolog/iolog\_loginfo.c:

  Break out I/O log config handling into iolog\_conf.c.
  [[d51d4af7a]](https://git.sudo.ws/sudo/commit/?id=d51d4af7a)

* lib/fuzzstub/Makefile.in, lib/iolog/Makefile.in, logsrvd/Makefile.in,
  plugins/sudoers/Makefile.in:

  regen Makefile.in
  [[7144955b0]](https://git.sudo.ws/sudo/commit/?id=7144955b0)

* examples/Makefile.in, lib/eventlog/Makefile.in,
  plugins/sudoers/Makefile.in:

  Add some missing files to the clean target
  [[bdfc07f33]](https://git.sudo.ws/sudo/commit/?id=bdfc07f33)

* plugins/sudoers/defaults.c:

  Correct the integer overflow check in store\_timespec(). Fixes oss-fuzz
  issue #31463
  [[d1cc1c59e]](https://git.sudo.ws/sudo/commit/?id=d1cc1c59e)

* plugins/sudoers/regress/sudoers/test27.in,
  plugins/sudoers/regress/sudoers/test27.json.ok,
  plugins/sudoers/regress/sudoers/test27.ldif.ok,
  plugins/sudoers/regress/sudoers/test27.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test27.out.ok,
  plugins/sudoers/regress/sudoers/test27.toke.ok:

  Add netgroup check to sudoers test27
  [[963ea4151]](https://git.sudo.ws/sudo/commit/?id=963ea4151)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.out.ok:

  Sync with fuzz\_sudoers changes.
  [[ddb1350b7]](https://git.sudo.ws/sudo/commit/?id=ddb1350b7)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Fuzz with runuser and rungroup specified too.
  [[963475a9b]](https://git.sudo.ws/sudo/commit/?id=963475a9b)

* MANIFEST, plugins/sudoers/regress/sudoers/test27.in,
  plugins/sudoers/regress/sudoers/test27.json.ok,
  plugins/sudoers/regress/sudoers/test27.ldif.ok,
  plugins/sudoers/regress/sudoers/test27.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test27.out.ok,
  plugins/sudoers/regress/sudoers/test27.toke.ok:

  Add test to exercise RunasSpec without a RunasUser.
  [[d160dac35]](https://git.sudo.ws/sudo/commit/?id=d160dac35)

* MANIFEST, plugins/sudoers/regress/sudoers/test22.sudo.ok,
  plugins/sudoers/regress/sudoers/test23.sudo.ok,
  plugins/sudoers/regress/sudoers/test24.sudo.ok,
  plugins/sudoers/regress/sudoers/test26.sudo.ok:

  Remove unused regress files.
  [[2e0ca52b5]](https://git.sudo.ws/sudo/commit/?id=2e0ca52b5)

* logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  Don’t try to run getters if we failed to parse the config file.
  [[b3ef60312]](https://git.sudo.ws/sudo/commit/?id=b3ef60312)

2021-02-25 Todd C. Miller

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Add a stub getaddrinfo(3) to avoid a DNS timeout in CIfuzz.
  [[3fc5932be]](https://git.sudo.ws/sudo/commit/?id=3fc5932be)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Fix runchroot, runcwd, tty\_tickets. Add timestampowner.
  [[8b545e561]](https://git.sudo.ws/sudo/commit/?id=8b545e561)

* plugins/sudoers/policy.c:

  Only add command\_info to garbage collector on successful return.
  Otherwise it will be freed on failure.
  [[65b598602]](https://git.sudo.ws/sudo/commit/?id=65b598602)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Add user millert to group sudo, which is often the exempt group.
  [[3595fd550]](https://git.sudo.ws/sudo/commit/?id=3595fd550)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Add some defaults settings in sudo\_file\_parse(). We don’t have a real
  policy file but we still want to exercise callbacks in sudoers.c.
  [[d75db837b]](https://git.sudo.ws/sudo/commit/?id=d75db837b)

* plugins/sudoers/sudoers.c:

  Do not free sudo\_user.iolog\_{file,path} in sudo\_user\_free(). They are
  not dynamically allocated.
  [[48669edd3]](https://git.sudo.ws/sudo/commit/?id=48669edd3)

* lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c:

  Remove unnecessary warnings, we want to fail silently.
  [[80e223b6c]](https://git.sudo.ws/sudo/commit/?id=80e223b6c)

* logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  No longer need to stub out eventlog config functions.
  [[df1b43111]](https://git.sudo.ws/sudo/commit/?id=df1b43111)

* MANIFEST, logsrvd/Makefile.in,
  logsrvd/regress/corpus/logsrvd\_conf/logsrvd.conf.4,
  logsrvd/regress/corpus/logsrvd\_conf/logsrvd.conf.5,
  logsrvd/regress/corpus/logsrvd\_conf/logsrvd.conf.6,
  logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  Call public getters in logsrvd.conf fuzzer and add to corpus. Now
  exercises the syslog config erorr path.
  [[f5d7db56e]](https://git.sudo.ws/sudo/commit/?id=f5d7db56e)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Add more passes to policy fuzzer Now execises list, list other user and
  show\_version.
  [[65df01dd7]](https://git.sudo.ws/sudo/commit/?id=65df01dd7)

* plugins/sudoers/defaults.c, plugins/sudoers/policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Implement sudoers\_policy\_deregister\_hooks() Register/deregister hooks in
  fuzz\_policy and also call show\_version().
  [[b3b80fe6d]](https://git.sudo.ws/sudo/commit/?id=b3b80fe6d)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Add sudoers debug register/deregister.
  [[e6dc13229]](https://git.sudo.ws/sudo/commit/?id=e6dc13229)

* plugins/sudoers/defaults.c:

  Remove unnecessary break statement.
  [[7bafd52fa]](https://git.sudo.ws/sudo/commit/?id=7bafd52fa)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.out.ok,
  plugins/sudoers/regress/sudoers/test14.in,
  plugins/sudoers/regress/sudoers/test14.json.ok,
  plugins/sudoers/regress/sudoers/test14.ldif.ok,
  plugins/sudoers/regress/sudoers/test14.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test14.out.ok,
  plugins/sudoers/regress/sudoers/test14.toke.ok:

  Include a sha384 digest in the test corpus.
  [[0d04bbdbe]](https://git.sudo.ws/sudo/commit/?id=0d04bbdbe)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Parse sudoers file in the C locale.
  [[ea341e2d3]](https://git.sudo.ws/sudo/commit/?id=ea341e2d3)

* MANIFEST, plugins/sudoers/regress/sudoers/test26.in,
  plugins/sudoers/regress/sudoers/test26.json.ok,
  plugins/sudoers/regress/sudoers/test26.ldif.ok,
  plugins/sudoers/regress/sudoers/test26.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test26.out.ok,
  plugins/sudoers/regress/sudoers/test26.sudo.ok,
  plugins/sudoers/regress/sudoers/test26.toke.ok:

  Add regress test with all current Defaults settings. Currently skips
  SELinux and Solaris privilege settings.
  [[24e1774ce]](https://git.sudo.ws/sudo/commit/?id=24e1774ce)

2021-02-24 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/env.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoers\_hooks.c:

  Move env hooks into sudoers\_hooks.c.
  [[e7b414ce4]](https://git.sudo.ws/sudo/commit/?id=e7b414ce4)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  No need to call check\_defaults() and check\_aliases() in quiet mode.
  [[f82890e5d]](https://git.sudo.ws/sudo/commit/?id=f82890e5d)

* plugins/sudoers/gc.c:

  sudoers\_gc\_init() is not currently used
  [[b4e86a911]](https://git.sudo.ws/sudo/commit/?id=b4e86a911)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/fmtsudoers\_cvt.c:

  Split fmtsudoers.c into the parts used by sudoers plugin and cvtsudoers.
  Only testsudoers and cvtsudoers use the full set of formatting
  functions.
  [[38c381a0c]](https://git.sudo.ws/sudo/commit/?id=38c381a0c)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Check defaults settings too.
  [[39e80e47b]](https://git.sudo.ws/sudo/commit/?id=39e80e47b)

* MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_stubs.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Add fuzzer-specific stubs source file.
  [[05767145b]](https://git.sudo.ws/sudo/commit/?id=05767145b)

* Makefile.in:

  Do not overwrite existing ChangeLog file if there is no hg/git dir. We
  don’t want “make install” from a source tarball to nuke the ChangeLog.
  [[792407fbe]](https://git.sudo.ws/sudo/commit/?id=792407fbe)

* lib/iolog/Makefile.in, lib/util/Makefile.in, logsrvd/Makefile.in,
  plugins/sudoers/Makefile.in:

  Remove fuzzer targets in “make clean”
  [[1ae4c1bf6]](https://git.sudo.ws/sudo/commit/?id=1ae4c1bf6)

* .gitignore, .hgignore:

  Ignore fuzzer targets
  [[39774e238]](https://git.sudo.ws/sudo/commit/?id=39774e238)

* lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Set program name in fuzzers so we get consisten warnings.
  [[a3f38fac0]](https://git.sudo.ws/sudo/commit/?id=a3f38fac0)

* plugins/sudoers/Makefile.in, plugins/sudoers/regress/fuzz/fuzz\_policy.c:
  Use real eventlog config fuctions instead of stubs.
  [[9d27880af]](https://git.sudo.ws/sudo/commit/?id=9d27880af)

* include/sudo\_iolog.h, lib/iolog/iolog\_fileio.c,
  lib/iolog/iolog\_loginfo.c:

  Move iolog info log writing to iolog\_loginfo.c
  [[b93aad4e9]](https://git.sudo.ws/sudo/commit/?id=b93aad4e9)

* MANIFEST, lib/iolog/Makefile.in, lib/iolog/iolog\_loginfo.c,
  lib/iolog/iolog\_timing.c,
  lib/iolog/regress/iolog\_timing/check\_iolog\_timing.c:

  Split iolog\_util.c into iolog\_loginfo.c and iolog\_timing.c. Also rename
  check\_iolog\_util -> check\_iolog\_timing.
  [[a56f7daee]](https://git.sudo.ws/sudo/commit/?id=a56f7daee)

* MANIFEST, lib/iolog/Makefile.in, lib/iolog/iolog\_legacy.c,
  lib/iolog/iolog\_util.c:

  Move legacy I/O log info file parsing to iolog\_legacy.c
  [[2a657e2a1]](https://git.sudo.ws/sudo/commit/?id=2a657e2a1)

* MANIFEST, include/sudo\_eventlog.h, lib/eventlog/Makefile.in,
  lib/eventlog/eventlog.c, lib/eventlog/eventlog\_conf.c:

  Move eventlog config code into eventlog\_conf.c
  [[412858272]](https://git.sudo.ws/sudo/commit/?id=412858272)

* MANIFEST, lib/eventlog/Makefile.in, lib/eventlog/eventlog.c,
  lib/eventlog/eventlog\_free.c:

  Move eventlog\_free() into its own file.
  [[f399c449a]](https://git.sudo.ws/sudo/commit/?id=f399c449a)

* logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  Stub out eventlog and iolog configuration setters.
  [[dba37768b]](https://git.sudo.ws/sudo/commit/?id=dba37768b)

* MANIFEST, plugins/sudoers/defaults.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.out.ok:

  Update Defaults settings after parsing sudoers. Also stub out
  dump\_defaults when fuzzing as it is not used.
  [[cbd11c44d]](https://git.sudo.ws/sudo/commit/?id=cbd11c44d)

* plugins/sudoers/Makefile.in, plugins/sudoers/b64\_decode.c,
  plugins/sudoers/b64\_encode.c:

  Split base64 encode/decode functions into separate source files. They
  are independent functions.
  [[33551acd1]](https://git.sudo.ws/sudo/commit/?id=33551acd1)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  fuzz\_printf and fuzz\_conversation can be stubs.
  [[f35d9c8be]](https://git.sudo.ws/sudo/commit/?id=f35d9c8be)

2021-02-23 Todd C. Miller

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Exercise tilde expansion if used in runcwd or runchroot.
  [[9f5aed70a]](https://git.sudo.ws/sudo/commit/?id=9f5aed70a)

* plugins/sudoers/check\_aliases.c:

  Move alias checking code out of visudo.c and into check\_aliases.c.
  [[c70295787]](https://git.sudo.ws/sudo/commit/?id=c70295787)

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Check aliases in fuzz\_sudoers if the policy parsed correctly.
  [[2a0ba4008]](https://git.sudo.ws/sudo/commit/?id=2a0ba4008)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/parse.h,
  plugins/sudoers/visudo.c:

  Move alias checking code out of visudo.c and into check\_aliases.c.
  [[5a85543c1]](https://git.sudo.ws/sudo/commit/?id=5a85543c1)

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  We don’t need to link fuzz\_sudoers with file.c.
  [[c71a39736]](https://git.sudo.ws/sudo/commit/?id=c71a39736)

* lib/iolog/regress/fuzz/fuzz\_iolog\_json.dict,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.dict,
  plugins/sudoers/regress/fuzz/fuzz\_policy.dict,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.dict,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.dict:

  Strings in dictionary files need to be quoted.
  [[03e610dab]](https://git.sudo.ws/sudo/commit/?id=03e610dab)

* MANIFEST, lib/iolog/Makefile.in,
  lib/iolog/regress/fuzz/fuzz\_iolog\_json.dict, lib/util/Makefile.in,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.dict, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/fuzz/fuzz\_policy.dict,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.dict,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.dict:

  Add dictionary files for fuzzers where possible.
  [[081e219e2]](https://git.sudo.ws/sudo/commit/?id=081e219e2)

2021-02-22 Todd C. Miller

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Also free safe\_cmnd so it doesn’t leak.
  [[e0761b9e3]](https://git.sudo.ws/sudo/commit/?id=e0761b9e3)

* plugins/sudoers/stubs.c, plugins/sudoers/testsudoers.c:

  Return NOT\_FOUND from the set\_cmnd\_path() stub since we don’t set
  user\_cmnd. The purpose of set\_cmnd\_path() is to reset user\_cmnd based on
  a new runchroot. For the stub version we don’t modify user\_cmnd and so
  must not return a status of FOUND. Fixes oss-fuzz issue #31250 which
  only affected the fuzzer and not sudo.
  [[322e0b369]](https://git.sudo.ws/sudo/commit/?id=322e0b369)

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.out.ok:

  Fix fuzz\_sudoers output matching.
  [[5fc6b8c17]](https://git.sudo.ws/sudo/commit/?id=5fc6b8c17)

* lib/fuzzstub/fuzzstub.c:

  Print “running” and “executed” lines to stderr like libfuzzer does.
  [[4adc11e33]](https://git.sudo.ws/sudo/commit/?id=4adc11e33)

* plugins/sudoers/pwutil\_impl.c:

  Support passing sudo\_make\_gidlist\_item() an array of gids. The gids are
  formatted as strings, not gid\_t.
  [[39db44b04]](https://git.sudo.ws/sudo/commit/?id=39db44b04)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.out.ok:

  Prime user/group cached and set the interface list. Also match parsed
  policy against multiple users.
  [[f92080be6]](https://git.sudo.ws/sudo/commit/?id=f92080be6)

* plugins/sudoers/pwutil.c, plugins/sudoers/sudoers.h:

  Add sudo\_mkgrent(), to be used to prime the group cache in
  tests/fuzzers.
  [[7463a1989]](https://git.sudo.ws/sudo/commit/?id=7463a1989)

2021-02-21 Todd C. Miller

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Perform matching in fuzz\_sudoers for inputs that parse correctly. The
  fuzzer now exercised the normal match code as well as the pseudo-command
  (list, validate, etc) match code. Privileges are also listed for
  well-formed sudoers file.
  [[df42c0c1d]](https://git.sudo.ws/sudo/commit/?id=df42c0c1d)

* plugins/sudoers/match\_command.c, plugins/sudoers/match\_digest.c,
  plugins/sudoers/parse.h:

  Add back SUDOERS\_NAME\_MATCH and enable it when fuzzing. This avoids the
  test environment from influencing sudoers matching.
  [[921097cb6]](https://git.sudo.ws/sudo/commit/?id=921097cb6)

* plugins/sudoers/match\_command.c:

  Add missing globfree(3) in command\_matches\_glob() when matching a
  directory.
  [[ecbe95589]](https://git.sudo.ws/sudo/commit/?id=ecbe95589)

2021-02-19 Todd C. Miller

* lib/util/sudo\_dso.c:

  Add support on AIX for loading plugins that are .a (not .so) files. It
  is possible to specify the member name in parens after the path, e.g.
  sudoers.a(shr.o) for 32-bit or sudoers.a(shr\_64.o) for 64-bit. If no
  member is specified in the path and dlopen() fails with ENOEXEC, try
  again with an explicit member, either shr.o or shr\_64.o.
  [[387169ac6]](https://git.sudo.ws/sudo/commit/?id=387169ac6)

* Makefile.in, doc/Makefile.in, examples/Makefile.in, include/Makefile.in,
  lib/eventlog/Makefile.in, lib/fuzzstub/Makefile.in,
  lib/iolog/Makefile.in, lib/logsrv/Makefile.in, lib/util/Makefile.in,
  lib/zlib/Makefile.in, logsrvd/Makefile.in,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/python/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_approval/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Add clean rules to .PHONY target.
  [[14c71eaa8]](https://git.sudo.ws/sudo/commit/?id=14c71eaa8)

2021-02-18 Todd C. Miller

* Makefile.in, doc/Makefile.in, examples/Makefile.in, include/Makefile.in,
  lib/eventlog/Makefile.in, lib/fuzzstub/Makefile.in,
  lib/iolog/Makefile.in, lib/logsrv/Makefile.in, lib/util/Makefile.in,
  lib/zlib/Makefile.in, logsrvd/Makefile.in,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/python/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_approval/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Add install-fuzz Makefile target to install the fuzzers and seed corpus.
  The FUZZ\_DESTDIR make variable needs to be set in the environment or on
  the command line.
  [[9f1e016cd]](https://git.sudo.ws/sudo/commit/?id=9f1e016cd)

* plugins/sudoers/Makefile.in:

  Only display fuzz\_policy output if the fuzzer exits with an error.
  [[5ea2acc4c]](https://git.sudo.ws/sudo/commit/?id=5ea2acc4c)

* plugins/sudoers/regress/corpus/policy/policy.1,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Call list, validate and invalidate entry points too. We need a separate
  open/close for each one.
  [[d02cc9c3a]](https://git.sudo.ws/sudo/commit/?id=d02cc9c3a)

* INSTALL, configure, configure.ac:

  Add –disable-ssp configure option. This allows for disabling
  -fstack-protector without turning off the other hardening options.
  [[90534b5b2]](https://git.sudo.ws/sudo/commit/?id=90534b5b2)

* lib/util/regress/getdelim/getdelim\_test.c:

  Test the error case by closing the underlying fd. Note that we don’t use
  ferror() here since our getdelim() has no way to set the error flag if
  there is a memory allocation error.
  [[a7e2dd15e]](https://git.sudo.ws/sudo/commit/?id=a7e2dd15e)

* lib/util/regress/getdelim/getdelim\_test.c:

  Test the case where getdelim() must reallocate the buffer. Reproduces
  [Bug #960](https://bugzilla.sudo.ws/show_bug.cgi?id=960).
  [[db70a70d0]](https://git.sudo.ws/sudo/commit/?id=db70a70d0)

* lib/eventlog/eventlog.c:

  When logging JSON to syslog, wrap the contents in a “sudo” object. This
  makes it easier for log parsers to identify what is a sudo log entry.
  [[e5c1778e7]](https://git.sudo.ws/sudo/commit/?id=e5c1778e7)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Restore the check for sudoers\_policy.close == NULL. The fuzzers run as
  part of “make check” too in which case NO\_LEAKS won’t be defined and the
  close function will be set to NULL.
  [[f76c59fc8]](https://git.sudo.ws/sudo/commit/?id=f76c59fc8)

* lib/iolog/iolog\_json.c:

  Use %td when printing the difference of two pointers.
  [[e047e9930]](https://git.sudo.ws/sudo/commit/?id=e047e9930)

* plugins/sudoers/parse.c:

  Don’t print a NULL as a string if role/type/privs/limitprivs is not set.
  We can’t rely on printf("%s”, NULL) not crashing.
  [[5813358b2]](https://git.sudo.ws/sudo/commit/?id=5813358b2)

* plugins/sudoers/sudoers.c:

  Fix compilation error on Solaris introduced with sudo\_user\_free().
  [[aaf3d5643]](https://git.sudo.ws/sudo/commit/?id=aaf3d5643)

2021-02-17 Todd C. Miller

* NEWS:

  [Bug #960](https://bugzilla.sudo.ws/show_bug.cgi?id=960).
  [[ac45fba89]](https://git.sudo.ws/sudo/commit/?id=ac45fba89)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Distinguish between EOF and error using feof(3), not ferror(3). Our
  getdelim(3) emulation won’t set the error flag if the error is due to an
  allocation failure. This explains the premature EOF without error seen
  in [Bug #960](https://bugzilla.sudo.ws/show_bug.cgi?id=960).
  [[9937d0803]](https://git.sudo.ws/sudo/commit/?id=9937d0803)

* lib/util/getdelim.c:

  Reset end pointer when reallocing the line buffer in getdelim(). Fixes
  excessive memory allocations for long lines. [Bug
  #960](https://bugzilla.sudo.ws/show_bug.cgi?id=960).
  [[75004b705]](https://git.sudo.ws/sudo/commit/?id=75004b705)

* lib/eventlog/Makefile.in, lib/iolog/Makefile.in,
  plugins/sudoers/Makefile.in:

  Remove duplicated MALLOC\_OPTIONS and MALLOC\_CONF env variables.
  [[abdef93f7]](https://git.sudo.ws/sudo/commit/?id=abdef93f7)

* lib/iolog/iolog\_json.c:

  On parse error, display line and column instead of the offending line.
  [[dc45ac5bc]](https://git.sudo.ws/sudo/commit/?id=dc45ac5bc)

* logsrvd/Makefile.in, plugins/sudoers/Makefile.in:

  regen
  [[79a18cb41]](https://git.sudo.ws/sudo/commit/?id=79a18cb41)

* NEWS, configure, configure.ac:

  Sudo 1.9.6
  [[b736804cf]](https://git.sudo.ws/sudo/commit/?id=b736804cf)

2021-02-16 Todd C. Miller

* lib/iolog/iolog\_json.c, lib/iolog/iolog\_util.c:

  Pass I/O log memory allocation errors up to the caller.
  [[4a279d576]](https://git.sudo.ws/sudo/commit/?id=4a279d576)

* INSTALL, config.h.in, configure, configure.ac, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, pathnames.h.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/timestamp.c:

  Add admin\_flag sudoers option and make –enable-admin-flag take a path.
  It is now possible to disable the Ubuntu admin flag in sudoers or change
  its location. [GitHub issue
  #56](https://github.com/sudo-project/sudo/issues/56)
  [[a5504148a]](https://git.sudo.ws/sudo/commit/?id=a5504148a)

* plugins/sudoers/exptilde.c,
  plugins/sudoers/regress/exptilde/check\_exptilde.c:

  Fix tilde expansion of paths with no user like ~/foo. The ‘/’ separator
  was missing in the resulting path.
  [[5ec59cddc]](https://git.sudo.ws/sudo/commit/?id=5ec59cddc)

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, lib/util/sudo\_conf.c,
  plugins/sudoers/policy.c:

  Limit max\_groups in sudo.conf to 1024. The max\_groups setting should no
  longer be needed anyway.
  [[a18b2a9dd]](https://git.sudo.ws/sudo/commit/?id=a18b2a9dd)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c:

  In sudoers\_policy\_close() call sudoers\_cleanup() instead of
  sudo\_user\_free(). If we didn’t call sudoers\_policy\_main() due to an
  early error there may be more things to clean up.
  [[df91e15b8]](https://git.sudo.ws/sudo/commit/?id=df91e15b8)

* plugins/sudoers/policy.c:

  Check for invalid flag combinations from front-end for all cases. The
  checks are now performed in the check\_policy, list, validate and
  invalidate functions instead of as part of the open function. We can’t
  perform the checks in open because we don’t yet know what operation is
  going to be performed.
  [[ecdf732ad]](https://git.sudo.ws/sudo/commit/?id=ecdf732ad)

* plugins/sudoers/policy.c, plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/sudoers.c:

  Always dynamically allocate user\_cmnd, it is freed in sudo\_user\_free().
  Instead of setting user\_cmnd in the policy functions, always set argv.
  Calling sudoers\_policy\_main() with argc of 0 is no longer allowed.
  [[ae3a098d2]](https://git.sudo.ws/sudo/commit/?id=ae3a098d2)

* plugins/sudoers/policy.c:

  No need for sudoers\_cleanup() in sudoers\_policy\_invalidate(). The
  sudoers close() function is now called even for “sudo -k”. Also no need
  to set user\_cmnd, it is not used in this code path.
  [[c09169e81]](https://git.sudo.ws/sudo/commit/?id=c09169e81)

2021-02-15 Todd C. Miller

* MANIFEST, logsrvd/Makefile.in, logsrvd/logsrvd\_conf.c,
  logsrvd/regress/corpus/logsrvd\_conf/logsrvd.conf.1,
  logsrvd/regress/corpus/logsrvd\_conf/logsrvd.conf.2,
  logsrvd/regress/corpus/logsrvd\_conf/logsrvd.conf.3,
  logsrvd/regress/fuzz/fuzz\_logsrvd\_conf.c:

  Add simple fuzzer for sudo\_logsrvd.conf parser.
  [[d23508334]](https://git.sudo.ws/sudo/commit/?id=d23508334)

* MANIFEST, lib/util/Makefile.in,
  lib/util/regress/corpus/sudo\_conf/sudo.conf.1,
  lib/util/regress/corpus/sudo\_conf/sudo.conf.2,
  lib/util/regress/corpus/sudo\_conf/sudo.conf.3,
  lib/util/regress/fuzz/fuzz\_sudo\_conf.c:

  Add simple fuzzer for sudo.conf parser.
  [[25f50e2f0]](https://git.sudo.ws/sudo/commit/?id=25f50e2f0)

* lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c:

  Fix unlinking of timing temp file.
  [[d81d7e0cf]](https://git.sudo.ws/sudo/commit/?id=d81d7e0cf)

* lib/eventlog/Makefile.in, lib/iolog/Makefile.in,
  plugins/python/Makefile.in, plugins/sudoers/Makefile.in:

  Set MALLOC\_OPTIONS and MALLOC\_CONF for all regress targets.
  [[de2a47f27]](https://git.sudo.ws/sudo/commit/?id=de2a47f27)

* plugins/sudoers/policy.c, plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Free struct sudo\_user in sudoers\_policy\_close() and sudoers\_cleanup().
  Also, do not NULL out the close function if NO\_LEAKS is defined.
  [[52e3fcc79]](https://git.sudo.ws/sudo/commit/?id=52e3fcc79)

* MANIFEST, lib/iolog/Makefile.in,
  lib/iolog/regress/corpus/log\_legacy/id.log,
  lib/iolog/regress/corpus/log\_legacy/ls.log,
  lib/iolog/regress/corpus/log\_legacy/mailq.log,
  lib/iolog/regress/corpus/log\_legacy/make.log,
  lib/iolog/regress/corpus/log\_legacy/pkg\_add.log,
  lib/iolog/regress/corpus/log\_legacy/pkg\_delete.log,
  lib/iolog/regress/corpus/log\_legacy/printenv.log,
  plugins/sudoers/Makefile.in:

  For “make fuzz” only fuzz the seed corpus. This way we avoid files
  generated by the fuzzer itself.
  [[ea7a70e85]](https://git.sudo.ws/sudo/commit/?id=ea7a70e85)

2021-02-14 Todd C. Miller

* plugins/sudoers/env.c, plugins/sudoers/gc.c, plugins/sudoers/policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Fix sudoers garbage collection and run it in policy fuzzer.
  [[7f3c670a1]](https://git.sudo.ws/sudo/commit/?id=7f3c670a1)

* .github/workflows/main.yml:

  Rename master -> main
  [[5ade1c253]](https://git.sudo.ws/sudo/commit/?id=5ade1c253)

* plugins/sudoers/policy.c:

  Do not include errno string for invalid params from front-end.
  [[7f0b26923]](https://git.sudo.ws/sudo/commit/?id=7f0b26923)

* plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  Always dynamically allocate user\_role, user\_type, user\_privs,
  user\_limitprivs
  [[561740cd5]](https://git.sudo.ws/sudo/commit/?id=561740cd5)

* plugins/sudoers/policy.c:

  Remove dead code, front-end does not set runas\_privs or runas\_limitprivs
  [[5c0454495]](https://git.sudo.ws/sudo/commit/?id=5c0454495)

* plugins/sudoers/iolog.c:

  Plug memory leak if there are duplicate user\_info or command\_info
  entries.
  [[d1969b4f0]](https://git.sudo.ws/sudo/commit/?id=d1969b4f0)

2021-02-13 Todd C. Miller

* .github/workflows/main.yml:

  Add CIFuzz workflow to run fuzzers on push or PR.
  <https://google.github.io/oss-fuzz/getting-started/continuous-integration>
  /
  [[96d1dc8ab]](https://git.sudo.ws/sudo/commit/?id=96d1dc8ab)

* plugins/sudoers/check.h, plugins/sudoers/regress/fuzz/fuzz\_policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/timestamp.c:

  Move create\_admin\_success\_flag() to timestamp.c.
  [[776c57a81]](https://git.sudo.ws/sudo/commit/?id=776c57a81)

* configure, configure.ac:

  Error out if fuzzer/sanitizer enabled but not supported by the compiler.
  [[440febff8]](https://git.sudo.ws/sudo/commit/?id=440febff8)

* plugins/sudoers/regress/fuzz/fuzz\_policy.c:

  The push() function was not updating the size after reallocating.
  [[651a225a4]](https://git.sudo.ws/sudo/commit/?id=651a225a4)

* plugins/sudoers/pwutil\_impl.c, src/sudo.c:

  If sudo\_getgrouplist2() returns -1, clamp ngroups based on max\_groups.
  The ngroups parameter is an out parameter that is filled in with the
  actual number of groups, which may be less than the static number
  allocated when max\_groups is set in sudo.conf. Fixes a potential out of
  bounds read found by LLVM libFuzzer.
  [[41eae9120]](https://git.sudo.ws/sudo/commit/?id=41eae9120)

2021-02-12 Todd C. Miller

* plugins/sudoers/policy.c:

  Reset sudoers path, owner and mode before parsing plugin arguments. This
  is only needed when calling sudoers\_policy\_deserialize\_info() more than
  once, which is true for the policy fuzzer.
  [[e89a8133a]](https://git.sudo.ws/sudo/commit/?id=e89a8133a)

* plugins/sudoers/sudoers.c:

  Cleanup sudoers sources on denial and error too.
  [[197d6600f]](https://git.sudo.ws/sudo/commit/?id=197d6600f)

* plugins/sudoers/pwutil.c:

  Fix sudo\_getgrgid reference count bug when gid doesn’t exist. This one
  was missed when the other user/group lookup functions were fixed.
  [[520db741b]](https://git.sudo.ws/sudo/commit/?id=520db741b)

* MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/corpus/policy/policy.1,
  plugins/sudoers/regress/corpus/policy/policy.2,
  plugins/sudoers/regress/corpus/policy/policy.3,
  plugins/sudoers/regress/corpus/policy/policy.4,
  plugins/sudoers/regress/corpus/policy/policy.5,
  plugins/sudoers/regress/fuzz/fuzz\_policy.c, plugins/sudoers/sudoers.c:

  Fuzz sudoers policy module API. Includes a test case to reproduce
  CVE-2021-3156.
  [[df2931588]](https://git.sudo.ws/sudo/commit/?id=df2931588)

* plugins/sudoers/policy.c:

  Plug memory leak if there are duplicate user\_info entries.
  [[ed7962769]](https://git.sudo.ws/sudo/commit/?id=ed7962769)

* lib/iolog/Makefile.in, plugins/sudoers/Makefile.in:

  Make fuzz targets depend on fuzzer stub library. We really want a
  dependency on $(LIB\_FUZZING\_ENGINE) but that could be a flag like
  “-fsanitize=fuzzer” instead of a path.
  [[eedc72d7b]](https://git.sudo.ws/sudo/commit/?id=eedc72d7b)

* lib/util/Makefile.in:

  regen
  [[a9f204aef]](https://git.sudo.ws/sudo/commit/?id=a9f204aef)

* MANIFEST, plugins/sudoers/Makefile.in:

  Move audit.c from libparsesudoers to the sudoers module itself. Now that
  audit.c contains the audit module it doesn’t belong in libparsesudoers.
  [[1f97ef92b]](https://git.sudo.ws/sudo/commit/?id=1f97ef92b)

* configure, configure.ac:

  Do not pass AX\_APPEND\_FLAG more than a single flag. [GitHub issue
  #92](https://github.com/sudo-project/sudo/issues/92)
  [[942b11149]](https://git.sudo.ws/sudo/commit/?id=942b11149)

2021-02-10 Todd C. Miller

* lib/eventlog/Makefile.in, lib/iolog/Makefile.in, logsrvd/Makefile.in,
  plugins/sudoers/Makefile.in:

  Fix up some .la file library dependencies. libsudo\_iolog.la already
  depends on libsudo\_util.la and libsudo\_eventlog.la so we don’t need to
  list those explicitly when libsudo\_iolog.la is listed.
  [[53e3dca7a]](https://git.sudo.ws/sudo/commit/?id=53e3dca7a)

* lib/eventlog/eventlog.c, lib/util/Makefile.in, lib/util/progname.c,
  lib/util/regress/progname/progname\_test.c, lib/util/sudo\_conf.c,
  lib/util/util.exp.in, plugins/sudoers/audit.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/iolog.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c,
  src/sudo\_edit.c, src/sudo\_noexec.c:

  Use sudo\_basename() instead of doing the equivalent manually.
  [[0663ffbc3]](https://git.sudo.ws/sudo/commit/?id=0663ffbc3)

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in,
  lib/util/basename.c, lib/util/util.exp.in:

  Add a GNU-compatible version of basename(3). Unlike POSIX basename(3),
  the GNU variant does not modify its argument. Note that basename of a
  path ending in “/” returns an empty string.
  [[41fa461fe]](https://git.sudo.ws/sudo/commit/?id=41fa461fe)

2021-02-09 Todd C. Miller

* lib/iolog/iolog\_fileio.c:

  feof(3) returns non-zero at EOF, not necessarily 1. On Illumos at least
  it returns a value other than 1.
  [[bbfd430cf]](https://git.sudo.ws/sudo/commit/?id=bbfd430cf)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Portable workaround for getdelim(3) implementations modify buf on EOF.
  We should assume that the contents of buf are undefined when getdelim(3)
  returns -1. We now peek ahead one char and skip the getdelim(3) call if
  EOF is detected. This will preserve the original value of the last line.
  [[cbf73e19b]](https://git.sudo.ws/sudo/commit/?id=cbf73e19b)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Some getdelim(3) implementations write a NUL to the buffer on EOF. AIX
  and Illumos appear to have this behavior. We now preserve the first
  character of the buffer on EOF to work around this. Fixes reporting of
  syntax errors on the last line of a file.
  [[cf1801146]](https://git.sudo.ws/sudo/commit/?id=cf1801146)

* plugins/sudoers/Makefile.in:

  Fuzz the example sudoers file, not the default one. The default sudoers
  uses @includedir which can result in different output, depending on the
  permissions of /etc/sudoers.d.
  [[1412695a4]](https://git.sudo.ws/sudo/commit/?id=1412695a4)

* configure, configure.ac:

  illumos has a broken fmemopen(3), don’t use it.
  [[a527c583d]](https://git.sudo.ws/sudo/commit/?id=a527c583d)

2021-02-08 Todd C. Miller

* config.h.in, configure, configure.ac, include/sudo\_compat.h:

  Add configure check for SSIZE\_MAX
  [[e392646ed]](https://git.sudo.ws/sudo/commit/?id=e392646ed)

* lib/iolog/iolog\_json.c:

  Suppress PVS Studio false positives.
  [[91351d57f]](https://git.sudo.ws/sudo/commit/?id=91351d57f)

* src/sesh.c:

  Silence a clang analyzer false positive.
  [[63d043fae]](https://git.sudo.ws/sudo/commit/?id=63d043fae)

* plugins/sudoers/toke\_util.c:

  Silence a clang analyzer false positive.
  [[3d55bca8a]](https://git.sudo.ws/sudo/commit/?id=3d55bca8a)

* lib/fuzzstub/fuzzstub.c:

  Fix CID 217123, size check always false on 64-bit systems.
  [[722759d0b]](https://git.sudo.ws/sudo/commit/?id=722759d0b)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Make open\_sudoers() always return NULL like fuzz\_sudoers.c
  [[aae168c48]](https://git.sudo.ws/sudo/commit/?id=aae168c48)

* plugins/sudoers/regress/sudoers/test4.toke.ok,
  plugins/sudoers/regress/sudoers/test5.toke.ok,
  plugins/sudoers/regress/sudoers/test7.toke.ok,
  plugins/sudoers/regress/sudoers/test8.toke.ok:

  Update \*.toke.ok now that lexer doesn’t call sudoerserror() itself.
  [[19d8d4a54]](https://git.sudo.ws/sudo/commit/?id=19d8d4a54)

* plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/toke.c, plugins/sudoers/toke.h, plugins/sudoers/toke.l:

  The lexer now sets an error string before returning ERROR. The parser
  will use that when reporting on an ERROR state. This prevents the lexer
  from reporting errors about tokens that are not actually consumed by the
  parser and we don’t have to worry about both the lexer and the parser
  reporting errors. It also means we only get one error per sudoers line.
  [[04de04f54]](https://git.sudo.ws/sudo/commit/?id=04de04f54)

* plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Go back to storing the last error file/line in sudoerserrorf(). This is
  still the best way to avoid displaying more than one error per line.
  [[9325a342b]](https://git.sudo.ws/sudo/commit/?id=9325a342b)

* configure, configure.ac:

  Add -fsanitize=fuzzer-no-link to ASAN\_LDFLAGS too, not just ASAN\_CFLAGS.
  [[a046e3bbb]](https://git.sudo.ws/sudo/commit/?id=a046e3bbb)

* MANIFEST, Makefile.in, doc/Makefile.in, examples/Makefile.in,
  include/Makefile.in, lib/eventlog/Makefile.in, lib/fuzzstub/Makefile.in,
  lib/iolog/Makefile.in, lib/logsrv/Makefile.in, lib/util/Makefile.in,
  lib/zlib/Makefile.in, logsrvd/Makefile.in,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/python/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_approval/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.out.ok,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Add fuzz Makefile target and run fuzzer corpus in make check.
  [[63a3f6254]](https://git.sudo.ws/sudo/commit/?id=63a3f6254)

2021-02-07 Todd C. Miller

* MANIFEST, Makefile.in, configure, configure.ac,
  lib/fuzzstub/Makefile.in, lib/fuzzstub/fuzzstub.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Add stub library that just feeds files to the fuzzing target. This will
  allow the fuzzers to be run as part of “make check”.
  [[30d9497eb]](https://git.sudo.ws/sudo/commit/?id=30d9497eb)

* scripts/mkpkg:

  Append to CFLAGS and LDFLAGS instead of overriding them when adding
  -m64.
  [[db4ee0a90]](https://git.sudo.ws/sudo/commit/?id=db4ee0a90)

* config.h.in, configure, configure.ac,
  lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Fall back to a temp file if fmemopen() is not available().
  [[a72d743ec]](https://git.sudo.ws/sudo/commit/?id=a72d743ec)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Add missing return statement when NO\_LEAKS is not defined.
  [[c19cb388b]](https://git.sudo.ws/sudo/commit/?id=c19cb388b)

* lib/eventlog/Makefile.in:

  Remove remnants of liblogsrv.
  [[c140b5942]](https://git.sudo.ws/sudo/commit/?id=c140b5942)

* INSTALL, configure, configure.ac, lib/iolog/Makefile.in,
  plugins/sudoers/Makefile.in:

  Add –enable-fuzzer-linker and –enable-fuzzer-engine options. These
  will allow the fuzzers to be built as part of oss-fuzz.
  [[55df5efdc]](https://git.sudo.ws/sudo/commit/?id=55df5efdc)

2021-02-06 Todd C. Miller

* .gitignore, .hgignore:

  Sync ignore files.
  [[38f1e55cd]](https://git.sudo.ws/sudo/commit/?id=38f1e55cd)

* plugins/sudoers/Makefile.in:

  Fix linking of sudoers fuzzers with static libsudo\_util.
  [[a3dae6f2c]](https://git.sudo.ws/sudo/commit/?id=a3dae6f2c)

* INSTALL, configure, configure.ac, lib/iolog/Makefile.in,
  plugins/sudoers/Makefile.in:

  Add –enable-fuzzer option to use when building fuzzers
  [[6216fb3cc]](https://git.sudo.ws/sudo/commit/?id=6216fb3cc)

* INSTALL, configure, configure.ac:

  Replace –enable-asan with –enable-sanitizer It is not possible to set
  the sanitizer flags at configure time.
  [[7a2a211df]](https://git.sudo.ws/sudo/commit/?id=7a2a211df)

* lib/iolog/Makefile.in, lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Build (but don’t run) fuzzers as part of “make check”. Uses a stub to
  make it possible to link w/o libfuzzer. The goal is to ensure the
  fuzzers are always buildable and avoid bit rot.
  [[4480e2697]](https://git.sudo.ws/sudo/commit/?id=4480e2697)

* lib/iolog/Makefile.in, plugins/sudoers/Makefile.in:

  Add libsudo\_eventlog.la as a dependency of libsudo\_iolog.la No longer
  need to link against libsudo\_eventlog.la in sudoers.
  [[ecaa9cd08]](https://git.sudo.ws/sudo/commit/?id=ecaa9cd08)

2021-02-06 Anton Bershanskiy

* src/copy\_file.c:

  Fix comment typo in src/copy\_file.c
  [[fecb68617]](https://git.sudo.ws/sudo/commit/?id=fecb68617)

2021-02-05 Todd C. Miller

* MANIFEST, lib/iolog/regress/corpus/log\_json/id.json,
  lib/iolog/regress/corpus/log\_json/ls.json,
  lib/iolog/regress/corpus/log\_json/mailq.json,
  lib/iolog/regress/corpus/log\_json/make.json,
  lib/iolog/regress/corpus/log\_json/pkg\_add.json,
  lib/iolog/regress/corpus/log\_json/pkg\_delete.json,
  lib/iolog/regress/corpus/log\_json/printenv.json,
  lib/iolog/regress/corpus/log\_legacy/id,
  lib/iolog/regress/corpus/log\_legacy/ls,
  lib/iolog/regress/corpus/log\_legacy/mailq,
  lib/iolog/regress/corpus/log\_legacy/make,
  lib/iolog/regress/corpus/log\_legacy/pkg\_add,
  lib/iolog/regress/corpus/log\_legacy/pkg\_delete,
  lib/iolog/regress/corpus/log\_legacy/printenv,
  lib/iolog/regress/corpus/timing/timing.1,
  lib/iolog/regress/corpus/timing/timing.2,
  lib/iolog/regress/corpus/timing/timing.3,
  lib/iolog/regress/corpus/timing/timing.4:

  Add more test files for fuzzers.
  [[1c02c14c3]](https://git.sudo.ws/sudo/commit/?id=1c02c14c3)

2021-02-05 Daniel Milnes

* doc/sudo.mdoc.in:

  Fix the typo in the mdoc
  [[d51c49789]](https://git.sudo.ws/sudo/commit/?id=d51c49789)

* doc/sudo.man.in:

  Fix a tiny typo in the Sudo manpage
  [[2b2e5d0c4]](https://git.sudo.ws/sudo/commit/?id=2b2e5d0c4)

2021-02-04 Todd C. Miller

* MANIFEST, lib/iolog/regress/fuzz/fuzz\_iolog\_timing.c:

  fuzzer for I/O log timing files
  [[5c2a21350]](https://git.sudo.ws/sudo/commit/?id=5c2a21350)

* lib/iolog/iolog\_json.c:

  In JSON, name/value pairs must be separated by a comma. Previously we
  didn’t require the comma to be there.
  [[47f08e986]](https://git.sudo.ws/sudo/commit/?id=47f08e986)

* lib/iolog/iolog\_json.c:

  Detect integer overflow when converting JSON\_ARRAY to string vector.
  Extremely unlikely to happen but better safe than sorry.
  [[92cf172ed]](https://git.sudo.ws/sudo/commit/?id=92cf172ed)

2021-02-03 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Only strip double quotes from an include path if len >= 2. Found
  locally using libfuzzer/oss-fuzz.
  [[665f8d2e3]](https://git.sudo.ws/sudo/commit/?id=665f8d2e3)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Don’t allow the sudoers fuzzer to open include files. If we allow the
  fuzzer to choose include paths it will include random files in the file
  system. This leads to bug reports that cannot be reproduced.
  [[e675f4c07]](https://git.sudo.ws/sudo/commit/?id=e675f4c07)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  If getdelim() returns a string with embedded NULs, truncate on first
  one. This should avoid some issues with the fuzzer.
  [[f5fc5d641]](https://git.sudo.ws/sudo/commit/?id=f5fc5d641)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Reallocate the buffer correctly when appending a newline. Fixes a
  potential buffer overflow introduced in the last commit.
  [[10e37223b]](https://git.sudo.ws/sudo/commit/?id=10e37223b)

* plugins/sudoers/alias.c, plugins/sudoers/gram.c, plugins/sudoers/gram.y:
  Don’t free the alias name in alias\_add() if the alias already exists. We
  need to be able to display it using alias\_error(). Only free what we
  actually allocated in alias\_add() on error and let the caller handle
  cleanup. Note that we cannot completely fill in the alias until it is
  inserted. Otherwise, we will have modified the file and members
  parameters even if there was an error. As a result, we have to remove
  those from the leak list after alias\_add(), not before.
  [[b4cabdb39]](https://git.sudo.ws/sudo/commit/?id=b4cabdb39)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Fix NUL termination when parsing a sudoers file with no ending newline.
  oss-fuzz issue #30252
  [[884b2fb86]](https://git.sudo.ws/sudo/commit/?id=884b2fb86)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  sudoersrestart() does not reset state to INITIAL, do it in init\_lexer().
  Fixes spurious errors from fuzz\_sudoers, which calls the parser multiple
  times.
  [[077c9b0c7]](https://git.sudo.ws/sudo/commit/?id=077c9b0c7)

* plugins/sudoers/regress/parser/check\_fill.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c:

  Push lexer leak tracking down into check\_fill.c. This lets us track
  things correctly when buffers are realloc()d. Rewrote fill() and
  append() to be more readable.
  [[63a63680b]](https://git.sudo.ws/sudo/commit/?id=63a63680b)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/visudo.c:

  Use sudoersrestart() in fuzz\_sudoers.c Since we run the parser multiple
  times we need to restart it each time.
  [[3237a18ee]](https://git.sudo.ws/sudo/commit/?id=3237a18ee)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Parser needs user\_shost for the %h escape in @include expansion. Fixes
  oss-fuzz issue #30238
  [[e66b132d7]](https://git.sudo.ws/sudo/commit/?id=e66b132d7)

* INSTALL:

  The –disable-leaks option is not recommended for production use.
  [[bde441186]](https://git.sudo.ws/sudo/commit/?id=bde441186)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Remove options from the leak list before freeing them. Should fix
  oss-fuzz issue #30236
  [[bd4e8bc69]](https://git.sudo.ws/sudo/commit/?id=bd4e8bc69)

* MANIFEST, include/sudo\_iolog.h, lib/iolog/iolog\_util.c,
  lib/iolog/regress/fuzz/fuzz\_iolog\_legacy.c:

  Add fuzzer for legacy I/O log info file.
  [[d2901f412]](https://git.sudo.ws/sudo/commit/?id=d2901f412)

* doc/Makefile.in, plugins/sudoers/Makefile.in:

  Fix uninstall target; there were missing line continuation chars.
  [GitHub issue #87](https://github.com/sudo-project/sudo/issues/87)
  [[29f5f3c53]](https://git.sudo.ws/sudo/commit/?id=29f5f3c53)

2021-02-02 Todd C. Miller

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/parse\_ldif.c:

  Don’t close fp in sudoers\_parse\_ldif() The caller should be the one to
  handle this.
  [[aaa2e8dde]](https://git.sudo.ws/sudo/commit/?id=aaa2e8dde)

* .gitignore, .hgignore:

  Update ignore files.
  [[68939adee]](https://git.sudo.ws/sudo/commit/?id=68939adee)

* plugins/sudoers/alias.c, plugins/sudoers/gram.c, plugins/sudoers/gram.y:
  Got back to calling alias\_free() on alias\_add() failure. We now need to
  remove the name and members from the leak list *before* calling
  alias\_add() since alias\_add() will consume them for both success and
  failure.
  [[bdb02b1ef]](https://git.sudo.ws/sudo/commit/?id=bdb02b1ef)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  close sudoersin, not fp, and reset it to be safe
  [[8f2254594]](https://git.sudo.ws/sudo/commit/?id=8f2254594)

* lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Add missing fclose(3) of fmemopen(3) stream; it does not modify the
  data.
  [[20b3904f4]](https://git.sudo.ws/sudo/commit/?id=20b3904f4)

* lib/iolog/iolog\_json.c:

  Check for unexpected value after checking the name, not before.
  [[2fd4a2ad7]](https://git.sudo.ws/sudo/commit/?id=2fd4a2ad7)

* lib/iolog/iolog\_json.c:

  Fix potential leak of evlog->runuser. Also warn if we find an
  unexpected JSON type.
  [[71997da16]](https://git.sudo.ws/sudo/commit/?id=71997da16)

* lib/util/progname.c:

  Allow getprogname() to succeed as long as \_\_progname is present. Also
  simplify the progname code so we only need a single implementation.
  [[eec4f4236]](https://git.sudo.ws/sudo/commit/?id=eec4f4236)

2021-02-01 Todd C. Miller

* plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Parse into a local parse\_tree and add missing cleanup. Since
  parsed\_policy is for the sudoers parser we should declare our own.
  [[0d34fa428]](https://git.sudo.ws/sudo/commit/?id=0d34fa428)

* plugins/sudoers/regress/fuzz/fuzz\_sudoers.c:

  Call init\_parser() after parsing to clean up completely.
  [[d3735b98e]](https://git.sudo.ws/sudo/commit/?id=d3735b98e)

* MANIFEST, plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/regress/sudoers/test25.in,
  plugins/sudoers/regress/sudoers/test25.json.ok,
  plugins/sudoers/regress/sudoers/test25.ldif.ok,
  plugins/sudoers/regress/sudoers/test25.out.ok,
  plugins/sudoers/regress/sudoers/test25.toke.ok, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/toke\_util.c:

  Plug a few more parser leaks.
  [[f30670a42]](https://git.sudo.ws/sudo/commit/?id=f30670a42)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Make parser\_leak\_remove(type, NULL) a no-op.
  [[f59a8f303]](https://git.sudo.ws/sudo/commit/?id=f59a8f303)

* MANIFEST, lib/iolog/regress/fuzz/fuzz\_iolog\_json.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers.c,
  plugins/sudoers/regress/fuzz/fuzz\_sudoers\_ldif.c:

  Add initial fuzzers to be used by oss-fuzz. These are not yet hooked up
  to the sudo build.
  [[1e3cecc60]](https://git.sudo.ws/sudo/commit/?id=1e3cecc60)

2021-01-31 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/parse.h,
  plugins/sudoers/sssd.c, plugins/sudoers/sudo\_ldap.h:

  Move new\_member\_all to ldap\_util.c, it is only used by ldap/sssd.
  [[568931035]](https://git.sudo.ws/sudo/commit/?id=568931035)

2021-02-01 Todd C. Miller

* plugins/sudoers/gc.c, plugins/sudoers/sudoers.h:

  Garbage collect unused gc\_remove() function.
  [[a74e8502c]](https://git.sudo.ws/sudo/commit/?id=a74e8502c)

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/testsudoers/test11.sh,
  plugins/sudoers/regress/testsudoers/test12.sh,
  plugins/sudoers/regress/testsudoers/test13.sh,
  plugins/sudoers/regress/testsudoers/test4.sh,
  plugins/sudoers/regress/testsudoers/test5.sh:

  The parser should be leak free, re-enable leak detection in ASAN.
  [[66cd61a9b]](https://git.sudo.ws/sudo/commit/?id=66cd61a9b)

* plugins/sudoers/alias.c, plugins/sudoers/gram.c, plugins/sudoers/gram.h,
  plugins/sudoers/gram.y, plugins/sudoers/parse.h, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/toke\_util.c:

  Add garbage collection to the sudoers parser to clean up on error. This
  makes it possible to avoid memory leaks when there is a parse error.
  [[9ed14870c]](https://git.sudo.ws/sudo/commit/?id=9ed14870c)

2021-01-30 Todd C. Miller

* lib/iolog/iolog\_json.c:

  Fix crashes trying to parse invalid JSON. Found locally using
  libfuzzer/oss-fuzz.
  [[4cd6350ca]](https://git.sudo.ws/sudo/commit/?id=4cd6350ca)

* lib/iolog/iolog\_json.c:

  Plug memory leak if a key is listed more than once in the log.json file.
  [[de82d08e7]](https://git.sudo.ws/sudo/commit/?id=de82d08e7)

* lib/iolog/regress/iolog\_json/check\_iolog\_json.c:

  Fix crash when file does not exist.
  [[5dc297d30]](https://git.sudo.ws/sudo/commit/?id=5dc297d30)

* plugins/sudoers/gentime.c:

  Strict tz offset parsing. Fixes an out of bounds read found locally
  using libfuzzer/oss-fuzz.
  [[439660c7f]](https://git.sudo.ws/sudo/commit/?id=439660c7f)

* plugins/sudoers/ldap\_util.c:

  Don’t leak memory for duplicate command options. The last option wins
  but we also now warn about the duplicate. Found locally using
  libfuzzer/oss-fuzz.
  [[9f81e8a10]](https://git.sudo.ws/sudo/commit/?id=9f81e8a10)

* plugins/sudoers/ldap\_util.c:

  Copy command options when converting a sudoRole with multiple
  sudoCommands. A sudoRole with multiple sudoCommands is converted to a
  privilege with multiple cmndspecs. However, we were not copying some of
  the command options to subsequent cmndspecs in the list.
  [[4eb591c6f]](https://git.sudo.ws/sudo/commit/?id=4eb591c6f)

* plugins/sudoers/parse\_ldif.c:

  Fix memory leak if the last line is folded. Fixes issue 30080 by
  ClusterFuzz-External
  [[75f76eba8]](https://git.sudo.ws/sudo/commit/?id=75f76eba8)

* INSTALL, configure, configure.ac:

  Add –disable-leaks configure option. This enables the extra freeing of
  memory before exit also enabled by –enable-asan. To be used by
  oss-fuzz.
  [[bd10bb5cf]](https://git.sudo.ws/sudo/commit/?id=bd10bb5cf)

* plugins/sudoers/gentime.c:

  Stricter parsing of generalized time. Fixes potential out of bounds read
  found by libfuzzer/oss-fuzz.
  [[995601c62]](https://git.sudo.ws/sudo/commit/?id=995601c62)

2021-01-29 Todd C. Miller

* plugins/sudoers/parse\_ldif.c:

  Don’t bother calling ldif\_to\_sudoers() if there are no roles to convert.
  [[419c89524]](https://git.sudo.ws/sudo/commit/?id=419c89524)

* lib/iolog/iolog\_json.c:

  In json\_stack\_push() treat stack exhaustion like memory allocation
  failure. Return NULL instead of treating as a fatal error. This should
  make life a little easier for oss-fuzz.
  [[8781560e1]](https://git.sudo.ws/sudo/commit/?id=8781560e1)

* plugins/sudoers/sudoers.c:

  Update comment about return values for resolve\_host().
  [[6c8242c35]](https://git.sudo.ws/sudo/commit/?id=6c8242c35)

* plugins/sudoers/logging.c, plugins/sudoers/policy.c:

  Fix NO\_ROOT\_MAILER, broken by the eventlog refactor in sudo 1.9.4.
  init\_eventlog\_config() is called immediately after initializing the
  Defaults settings, which is before struct sudo\_user is setup. This adds
  a call to eventlog\_set\_mailuid() if NO\_ROOT\_MAILER is defined after the
  invoking user is determined. Reported by Roman Fiedler.
  [[e5ad88488]](https://git.sudo.ws/sudo/commit/?id=e5ad88488)

2020-12-08 Todd C. Miller

* config.guess, config.h.in, config.sub, configure, configure.ac:

  Regenerate configure script with autoconf 2.71. Also fix some warnings
  from the new version.
  [[da5c6c6c4]](https://git.sudo.ws/sudo/commit/?id=da5c6c6c4)

2021-01-28 Todd C. Miller

* MANIFEST:

  Add plugins/sudoers/strvec\_join.c
  [[8f114c2aa]](https://git.sudo.ws/sudo/commit/?id=8f114c2aa)

* plugins/sudoers/strvec\_join.c, plugins/sudoers/sudoers.c:

  Fix compilation on systems without a native strlcpy() function.
  [[8ca47cc99]](https://git.sudo.ws/sudo/commit/?id=8ca47cc99)

* logsrvd/logsrvd.c, logsrvd/sendlog.c:

  Break up the long help string into multiple printf() statements. AIX xlc
  compiler doesn’t like cpp directives in between strings. Also fixes a
  complaint from cppcheck and makes translation easier.
  [[dceab7d75]](https://git.sudo.ws/sudo/commit/?id=dceab7d75)

* plugins/sudoers/regress/unescape/check\_unesc.c,
  plugins/sudoers/strvec\_join.c, plugins/sudoers/sudoers.h:

  strvec\_join: free result on error and actually use separator char
  [[c9eff9385]](https://git.sudo.ws/sudo/commit/?id=c9eff9385)

2021-01-27 Todd C. Miller

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/unescape/check\_unesc.c:

  Test strvec\_join() using strlcpy\_unesc(). Emulates an overflow like:
  sudoedit -s ‘' `perl -e 'print "A" x 65536'`
  [[888f63a9c]](https://git.sudo.ws/sudo/commit/?id=888f63a9c)

* plugins/sudoers/Makefile.in, plugins/sudoers/strvec\_join.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Refactor code to flatten an argument vector into a string. This is used
  when building up the user\_args string.
  [[29acc6419]](https://git.sudo.ws/sudo/commit/?id=29acc6419)

* MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/unescape/check\_unesc.c,
  plugins/sudoers/strlcpy\_unesc.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Add strlcpy\_unescape() function to undo escaping from front-end.
  Includes unit test.
  [[2804c2c78]](https://git.sudo.ws/sudo/commit/?id=2804c2c78)

* plugins/sudoers/parse\_ldif.c:

  Add missing check for reallocarray() failure. Found by OSS-Fuzz.
  [[aa50aaf8d]](https://git.sudo.ws/sudo/commit/?id=aa50aaf8d)

2021-01-26 Todd C. Miller

* plugins/python/pyhelpers.c, plugins/python/pyhelpers.h,
  plugins/python/python\_convmessage.c,
  plugins/python/sudo\_python\_module.c:

  Remove Py\_SSIZE2SIZE to quiet cppcheck warnings. Tuple size cannot be
  negative and we already handle the case where it is zero.
  [[bca213959]](https://git.sudo.ws/sudo/commit/?id=bca213959)

* src/parse\_args.c:

  The program name may now only be “sudo” or “sudoedit”. We no longer need
  to check for any string that ends in “edit”.
  [[19d5845f8]](https://git.sudo.ws/sudo/commit/?id=19d5845f8)

2021-01-23 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.5p2
  [[98d5cc2a8]](https://git.sudo.ws/sudo/commit/?id=98d5cc2a8)

* src/parse\_args.c:

  Don’t assume that argv is allocated as a single flat buffer. While this
  is how the kernel behaves it is not a portable assumption. The
  assumption may also be violated if getopt\_long(3) permutes arguments.
  Found by Qualys.
  [[c0eecf85c]](https://git.sudo.ws/sudo/commit/?id=c0eecf85c)

* plugins/sudoers/timestamp.c:

  Fix the memset offset when converting a v1 timestamp to TS\_LOCKEXCL. We
  want to zero the struct starting at flags, not type (which was just
  set). Found by Qualys.
  [[0754533d2]](https://git.sudo.ws/sudo/commit/?id=0754533d2)

* plugins/sudoers/sudoers.c:

  Fix potential buffer overflow when unescaping backslashes in user\_args.
  Also, do not try to unescaping backslashes unless in run mode *and* we
  are running the command via a shell. Found by Qualys, this fixes
  CVE-2021-3156.
  [[1f8638577]](https://git.sudo.ws/sudo/commit/?id=1f8638577)

* plugins/sudoers/policy.c:

  Add sudoedit flag checks in plugin that are consistent with front-end.
  Don’t assume the sudo front-end is sending reasonable mode flags. These
  checks need to be kept consistent between the sudo front-end and the
  sudoers plugin.
  [[c4d384082]](https://git.sudo.ws/sudo/commit/?id=c4d384082)

* src/parse\_args.c:

  Reset valid\_flags to MODE\_NONINTERACTIVE for sudoedit. This is
  consistent with how the -e option is handled. Also reject -H and -P
  flags for sudoedit as was done in sudo 1.7. Found by Qualys, this is
  part of the fix for CVE-2021-3156.
  [[b301b46b7]](https://git.sudo.ws/sudo/commit/?id=b301b46b7)

2021-01-18 Pavel BÅezina

* plugins/sudoers/auth/pam.c:

  pam: pass KRB5CCNAME to pam\_authenticate environment if available

  If a PAM module wants to authenticate user using GSSAPI, the
  authentication is broken if non-default ccache name is used in
  KRB5CCNAME environment variable.

  One way to mitigate this would be to add this to env\_keep, but this also
  makes the variable available in the executed command which may not be
  always desirable.

  This patch sets KRB5CCNAME for pam\_authenticate only, if it is available
  and not yet set.
  [[3b7977a42]](https://git.sudo.ws/sudo/commit/?id=3b7977a42)

2021-01-22 Fabrice Fontaine

* lib/eventlog/Makefile.in:

  lib/eventlog/Makefile.in: fix static build without closefrom

  Since version 1.9.4 and
  <https://github.com/sudo-project/sudo/commit/bd1ca79cca827a92e904f022e49d>
  f121931d4ff5, when closefrom is not available, libsudo\_eventlog.a
  depends on libsudo\_util.a. So reflect this dependency in the libtool
  file to avoid the following static build failure of logsrvd:

  /bin/bash ../libtool –tag=disable-static –mode=link
  /home/buildroot/autobuild/instance-1/output-1/host/bin/powerpc-linux-gcc
  -o sudo\_logsrvd logsrv\_util.o iolog\_writer.o logsrvd.o logsrvd\_conf.o
  -static -Wl,–enable-new-dtags -Wl,-z,relro
  ../lib/iolog/libsudo\_iolog.la ../lib/eventlog/libsudo\_eventlog.la
  ../lib/logsrv/liblogsrv.la /bin/bash ../libtool –tag=disable-static
  –mode=link
  /home/buildroot/autobuild/instance-1/output-1/host/bin/powerpc-linux-gcc
  -o sudo\_sendlog logsrv\_util.o sendlog.o -static -Wl,–enable-new-dtags
  -Wl,-z,relro ../lib/iolog/libsudo\_iolog.la
  ../lib/eventlog/libsudo\_eventlog.la ../lib/logsrv/liblogsrv.la libtool:
  link:
  /home/buildroot/autobuild/instance-1/output-1/host/bin/powerpc-linux-gcc
  -o sudo\_logsrvd logsrv\_util.o iolog\_writer.o logsrvd.o logsrvd\_conf.o
  -static -Wl,–enable-new-dtags -Wl,-z -Wl,relro
  ../lib/iolog/.libs/libsudo\_iolog.a
  /home/buildroot/autobuild/instance-1/output-1/build/sudo-1.9.5p1/lib/uti
  l/.libs/libsudo\_util.a -lpthread -lz
  ../lib/eventlog/.libs/libsudo\_eventlog.a ../lib/logsrv/.libs/liblogsrv.a
  /home/buildroot/autobuild/instance-1/output-1/host/opt/ext-toolchain/bin
  /../lib/gcc/powerpc-buildroot-linux-uclibc/8.3.0/../../../../powerpc-bui
  ldroot-linux-uclibc/bin/ld:
  ../lib/eventlog/.libs/libsudo\_eventlog.a(eventlog.o): in function
  `send_mail.constprop.1': eventlog.c:(.text+0x149c): undefined reference to` sudo\_closefrom’ collect2: error: ld returned 1 exit status

  Fixes: -
  <http://autobuild.buildroot.org/results/515b45f876fa9de03c9235f86017f4dc1>
  0eb3b54

  Signed-off-by: Fabrice Fontaine <fontaine.fabrice@…>
  [[c05fe9366]](https://git.sudo.ws/sudo/commit/?id=c05fe9366)

2021-01-21 Todd C. Miller

* plugins/sudoers/log\_client.c:

  Do not add an unfinished write buffer to the queue if it is already
  present. In client\_msg\_cb() we only remove a buffer from the queue when
  it is finished. Inserting the buf again can cause a cycle in the queue.
  [[376ad5e6b]](https://git.sudo.ws/sudo/commit/?id=376ad5e6b)

2021-01-20 Todd C. Miller

* plugins/sudoers/log\_client.c:

  Fix problem when SSL\_read() returns SSL\_ERROR\_WANT\_WRITE. This can
  happen when the socket cannot be written to immediately. We need to set
  the read\_instead\_of\_write flag in that case, *not*
  write\_instead\_of\_read. Also sync comments with sendlog.c. [Bug
  #954](https://bugzilla.sudo.ws/show_bug.cgi?id=954)
  [[eb536d8b7]](https://git.sudo.ws/sudo/commit/?id=eb536d8b7)

2021-01-15 Todd C. Miller

* lib/util/progname.c:

  Fix setprogname() emulation on systems without it. For fully-qualified
  paths, store the string starting after the last slash, not at the slash
  itself.
  [[d98dd5f98]](https://git.sudo.ws/sudo/commit/?id=d98dd5f98)

2021-01-11 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.5p1
  [[e60ff9058]](https://git.sudo.ws/sudo/commit/?id=e60ff9058)

* src/sudo\_edit.c:

  Run the editor with the user’s real and effective uid and gid. Fixes a
  bug introduced in sudo 1.9.5 where the editor was run setuid root unless
  SELinux RBAC was in use.
  [[3a13f1bf0]](https://git.sudo.ws/sudo/commit/?id=3a13f1bf0)

* NEWS:

  fix typo
  [[ea150d591]](https://git.sudo.ws/sudo/commit/?id=ea150d591)

* src/copy\_file.c, src/edit\_open.c:

  Add casts to quiet two warnings on Solaris.
  [[01d0bbfb8]](https://git.sudo.ws/sudo/commit/?id=01d0bbfb8)

2021-01-08 Todd C. Miller

* NEWS, configure, configure.ac, doc/LICENSE, etc/sudo-logsrvd.pp,
  etc/sudo-python.pp, etc/sudo.pp:

  Sudo 1.9.5
  [[9e111eae5]](https://git.sudo.ws/sudo/commit/?id=9e111eae5)

2021-01-09 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update .pot files for 1.9.5.
  [[250cccfe4]](https://git.sudo.ws/sudo/commit/?id=250cccfe4)

2021-01-08 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.man.in.sed, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/policy.c:

  Allow SELinux support to be disabled via the sudoers file. Defaults to
  true if sudo is built with SELinux support and SELinux is not disabled
  on the system.
  [[1b72d6a5c]](https://git.sudo.ws/sudo/commit/?id=1b72d6a5c)

2021-01-06 Todd C. Miller

* plugins/python/python\_importblocker.c:

  Add a comment to verify\_import() to clarify its purpose.
  [[4603da02a]](https://git.sudo.ws/sudo/commit/?id=4603da02a)

* lib/eventlog/eventlog.c, lib/util/arc4random.c, lib/util/sudo\_debug.c,
  plugins/audit\_json/audit\_json.c, plugins/python/python\_convmessage.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/getdate.c,
  plugins/sudoers/getdate.y, plugins/sudoers/goodpath.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/rcstr.c, plugins/sudoers/redblack.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c,
  src/exec\_common.c, src/sesh.c, src/sudo.c, src/sudo\_edit.c:

  Suppress PVS Studio false positives.
  [[4e11bc0e2]](https://git.sudo.ws/sudo/commit/?id=4e11bc0e2)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Plug a memory leak in sudoerserrorf().
  [[108e29446]](https://git.sudo.ws/sudo/commit/?id=108e29446)

* plugins/sudoers/editor.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/parse.h,
  plugins/sudoers/starttime.c, plugins/sudoers/tsgetgrpw.c, src/ttyname.c:
  Quiet a few harmless cppcheck warnings.
  [[92c88d410]](https://git.sudo.ws/sudo/commit/?id=92c88d410)

* Makefile.in, lib/eventlog/Makefile.in, lib/iolog/Makefile.in,
  lib/logsrv/Makefile.in, lib/util/Makefile.in, logsrvd/Makefile.in,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/python/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_approval/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Remove the –force option from the cppcheck args, it causes errors.
  [[84b3a1dae]](https://git.sudo.ws/sudo/commit/?id=84b3a1dae)

* src/sesh.c, src/sudo\_edit.c:

  Split up sesh\_sudoedit() so it is organized more like sudo\_edit.c. The
  new sesh\_edit\_create\_tfiles() and sesh\_edit\_copy\_tfiles() functions are
  analogous to sudo\_edit\_create\_tfiles() and sudo\_edit\_copy\_tfiles(). Also
  use “sudoedit” in the warning/error messages from sesh\_sudoedit().
  Otherwise, the user gets a mix of messages from sudoedit and sesh.
  [[83ff16469]](https://git.sudo.ws/sudo/commit/?id=83ff16469)

* configure, configure.ac, include/sudo\_compat.h, lib/util/progname.c:

  Add setprogname(3) for those without it.
  [[9e068c15e]](https://git.sudo.ws/sudo/commit/?id=9e068c15e)

* src/edit\_open.c, src/sesh.c, src/sudo\_edit.c, src/sudo\_edit.h:

  Rename run\_cred -> cur\_cred and stash existing creds in set\_tmpdir().
  For sudo\_edit\_open() et al what we need is a copy of the current cred to
  restore after dir\_is\_writable() changes to the user cred.
  [[778858147]](https://git.sudo.ws/sudo/commit/?id=778858147)

* src/edit\_open.c, src/exec.c, src/exec\_pty.c, src/sesh.c, src/sudo.c,
  src/sudo.h, src/sudo\_edit.c, src/sudo\_edit.h, src/tgetpass.c:

  Add struct sudo\_cred to hold the invoking or runas user credentials. We
  can use this when we need to pass around credential info instead of the
  user\_details and command\_details structs.
  [[ece5adc66]](https://git.sudo.ws/sudo/commit/?id=ece5adc66)

* src/Makefile.in, src/edit\_open.c, src/sesh.c, src/sudo\_edit.c,
  src/sudo\_edit.h:

  Add directory writability checks for SELinux RBAC sudoedit. These were
  never added to the SELinux RBAC path.
  [[46e2d7290]](https://git.sudo.ws/sudo/commit/?id=46e2d7290)

* MANIFEST, src/Makefile.in, src/edit\_open.c, src/sesh.c, src/sudo\_edit.c,
  src/sudo\_edit.h, src/sudo\_exec.h:

  Move safe open code out of sudo\_edit.c and into edit\_open.c.
  [[a5be62c68]](https://git.sudo.ws/sudo/commit/?id=a5be62c68)

* src/copy\_file.c, src/sudo\_edit.c:

  In sudoedit, use sudo\_check\_temp\_file() for non-SELinux too.
  [[397a07e86]](https://git.sudo.ws/sudo/commit/?id=397a07e86)

* src/copy\_file.c, src/sesh.c, src/sudo\_edit.c, src/sudo\_exec.h:

  Add security checks before using temp files for SELinux RBAC sudoedit.
  Otherwise, it may be possible for the user running sudoedit to replace
  the newly-created temporary files with a symbolic link and have sudoedit
  set the owner of an arbitrary file. Problem reported by Matthias
  Gerstner of SUSE.
  [[7cd36222e]](https://git.sudo.ws/sudo/commit/?id=7cd36222e)

* src/sudo\_edit.c:

  Fix potential directory existing info leak in sudoedit. When creating a
  new file, sudoedit checks to make sure the parent directory exists so it
  can provide the user with a sensible error message. However, this could
  be used to test for the existence of directories not normally accessible
  to the user by pointing to them with a symbolic link when the parent
  directory is controlled by the user. Problem reported by Matthias
  Gerstner of SUSE.
  [[db1f27c03]](https://git.sudo.ws/sudo/commit/?id=db1f27c03)

* lib/iolog/iolog\_fileio.c, lib/util/sudo\_debug.c,
  plugins/group\_file/getgrent.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/tsgetgrpw.c:

  Check the return value of fcntl() when setting FD\_CLOEXEC. This should
  never fail unless the fd is invalid. Problem reported by Matthias
  Gerstner of SUSE.
  [[71339c574]](https://git.sudo.ws/sudo/commit/?id=71339c574)

* include/sudo\_util.h, lib/util/progname.c, lib/util/util.exp.in,
  src/sudo.c:

  For sudo, only allow “sudo” or “sudoedit” as the program name. The
  program name is also used when matching Debug lines in sudo.conf. We
  don’t want the user to be able to influence sudo.conf Debug matching.
  The string “sudoedit” is treated the same as “sudo” in sudo.conf.
  Problem reported by Matthias Gerstner of SUSE.
  [[b132def0b]](https://git.sudo.ws/sudo/commit/?id=b132def0b)

2020-12-21 Todd C. Miller

* src/net\_ifs.c:

  Fix the buffer size parameter when serializing the interface list.
  Problem reported by Matthias Gerstner of SUSE.
  [[a29cac8bd]](https://git.sudo.ws/sudo/commit/?id=a29cac8bd)

2021-01-06 Todd C. Miller

* plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po, po/ko.mo, po/ko.po,
  po/sr.mo, po/sr.po, po/sv.mo, po/sv.po:

  Updated translations from translationproject.org
  [[295f099cf]](https://git.sudo.ws/sudo/commit/?id=295f099cf)

2021-01-04 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Use debug\_return\_int() not debug\_return\_bool() to return -1. Found by
  PVS Studio.
  [[741cf082a]](https://git.sudo.ws/sudo/commit/?id=741cf082a)

* plugins/sudoers/logging.c:

  Fix a crash introduced in 1.9.4 when running “sudo -i” as an unknown
  user.
  [[4ea6f7306]](https://git.sudo.ws/sudo/commit/?id=4ea6f7306)

2021-01-03 Todd C. Miller

* plugins/sudoers/check.c:

  Make sure lecture file is a regular file before reading it.
  [[7f34b8bbb]](https://git.sudo.ws/sudo/commit/?id=7f34b8bbb)

2021-01-02 Todd C. Miller

* lib/iolog/iolog\_fileio.c, plugins/sudoers/match\_command.c,
  plugins/sudoers/timestamp.c:

  Remove #ifdefs around code using pread(3) and pwrite(3).
  [[6e1986e91]](https://git.sudo.ws/sudo/commit/?id=6e1986e91)

* MANIFEST, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/pread.c, lib/util/pwrite.c,
  scripts/mkdep.pl:

  Add emulation of pread(3) and pwrite(3) for systems without them. This
  makes it possible to remove some ugly #ifdefs and only affects very old
  systems.
  [[06bfbecd6]](https://git.sudo.ws/sudo/commit/?id=06bfbecd6)

* src/exec.c:

  Cannot do direct exec of a command when SELinux RBAC is enabled.
  [[267b9a8a2]](https://git.sudo.ws/sudo/commit/?id=267b9a8a2)

* logsrvd/logsrvd.c:

  Avoid potential use after free with eventlog-only connections. Coverity
  CID 215884.
  [[f6452c7ca]](https://git.sudo.ws/sudo/commit/?id=f6452c7ca)

* Makefile.in, lib/eventlog/Makefile.in, lib/iolog/Makefile.in,
  lib/logsrv/Makefile.in, lib/util/Makefile.in, logsrvd/Makefile.in,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/group\_file/plugin\_test.c, plugins/python/Makefile.in,
  plugins/sample/Makefile.in, plugins/sample\_approval/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/parse.h,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Minor fixes pointed out by cppcheck. Also add
  compareBoolExpressionWithInt to suppression list.
  [[861783338]](https://git.sudo.ws/sudo/commit/?id=861783338)

* plugins/sudoers/Makefile.in:

  Regen now that ldap.c and sssd.c no longer need gram.h
  [[8ea19e294]](https://git.sudo.ws/sudo/commit/?id=8ea19e294)

2020-12-30 Todd C. Miller

* lib/util/fatal.c:

  Fix deregistration of a callback that is not at the head of the list.
  The SLIST\_FOREACH\_PREVPTR macro doesn’t work the way I thought it did.
  Just store our own prev pointer and use that instead.
  [[9547755c3]](https://git.sudo.ws/sudo/commit/?id=9547755c3)

2020-12-20 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.4p2
  [[4151d8fc8]](https://git.sudo.ws/sudo/commit/?id=4151d8fc8)

* plugins/sudoers/sudoers.c:

  The runas user must be set before applying runas-based Defaults. This
  effectively backs out changeset f738f5ac5350, which made it possible to
  log the command when an invalid user was specified. The policy plugin
  API doesn’t supply the command until the check function, at which point
  we’ve already denied the command due to the invalid user. [Bug
  #951](https://bugzilla.sudo.ws/show_bug.cgi?id=951).
  [[b3173fded]](https://git.sudo.ws/sudo/commit/?id=b3173fded)

2020-12-18 Todd C. Miller

* etc/uncrustify-small.cfg, etc/uncrustify.cfg:

  Don’t enable mod\_remove\_empty\_return We like to use an empty return for
  stub functions.
  [[4c00a4e5b]](https://git.sudo.ws/sudo/commit/?id=4c00a4e5b)

2020-12-15 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.4p1
  [[4949fd291]](https://git.sudo.ws/sudo/commit/?id=4949fd291)

2020-12-16 Todd C. Miller

* plugins/sudoers/policy.c:

  The lower bounds for the “closefrom” option is 3, not 4. This is a
  regression introduced in sudo 1.8.9 with the strtonum() conversion. [Bug
  #950](https://bugzilla.sudo.ws/show_bug.cgi?id=950).
  [[4551b19f6]](https://git.sudo.ws/sudo/commit/?id=4551b19f6)

2020-12-11 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Direct execution of a command is incompatible with using a log server.
  [[f41b2c1f5]](https://git.sudo.ws/sudo/commit/?id=f41b2c1f5)

* plugins/sudoers/audit.c:

  Set sudoers\_audit.close to NULL if not using a log server.
  [[5c66e9532]](https://git.sudo.ws/sudo/commit/?id=5c66e9532)

2020-12-07 Todd C. Miller

* config.h.in, configure, configure.ac, src/sudo.c:

  Define \_DARWIN\_UNLIMITED\_GETGROUPS on macOS to suport > 16 groups. On
  macOS 10.6 and above, getgroups(2) can return more than NGROUPS\_MAX if
  \_DARWIN\_UNLIMITED\_GETGROUPS or \_DARWIN\_C\_SOURCE is defined. [Bug
  #946](https://bugzilla.sudo.ws/show_bug.cgi?id=946)
  [[0e3e13d87]](https://git.sudo.ws/sudo/commit/?id=0e3e13d87)

2020-12-05 Todd C. Miller

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, examples/sudo.conf.in:

  Comment out the default plugin lines in the example sudo.conf. Fixes a
  problem when there are multiple versions of sudo installed and not all
  suport the audit plugin, such as on macOS. [GitHub issue
  #75](https://github.com/sudo-project/sudo/issues/75)
  [[1cdc4716c]](https://git.sudo.ws/sudo/commit/?id=1cdc4716c)

* plugins/sudoers/logging.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Store the user-provided runas user and group name in struct sudo\_user.
  This makes it available for event logging in case the name doesn’t
  resolve.
  [[63739dd32]](https://git.sudo.ws/sudo/commit/?id=63739dd32)

* plugins/sudoers/logging.c:

  Log submit group to event log.
  [[bac76512f]](https://git.sudo.ws/sudo/commit/?id=bac76512f)

* plugins/sudoers/logging.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Store iolog\_path in struct sudo\_user for use in the event log.
  [[008a0e8dc]](https://git.sudo.ws/sudo/commit/?id=008a0e8dc)

2020-12-04 Todd C. Miller

* plugins/sudoers/logging.c, plugins/sudoers/sudoers.c:

  Defer lookup of runas user until sudoers\_main() for better logging. The
  log message now includes user info and the command attempted.
  [[fd39e2d7d]](https://git.sudo.ws/sudo/commit/?id=fd39e2d7d)

* lib/eventlog/eventlog.c:

  Don’t assume that just because command is non-NULL, argv is non-NULL.
  [[567e5167d]](https://git.sudo.ws/sudo/commit/?id=567e5167d)

* plugins/sudoers/logging.c:

  Fix a crash introduced in 1.9.4 when running command as an unknown user.
  [Bug #948](https://bugzilla.sudo.ws/show_bug.cgi?id=948)
  [[a7d670ee3]](https://git.sudo.ws/sudo/commit/?id=a7d670ee3)

2020-12-03 Todd C. Miller

* logsrvd/logsrvd.c:

  When shutting down the server, close non-I/O log connections
  immediately. Avoids a timeout during server shutdown while the server
  waits for active connections to close.
  [[c5a7f0eb4]](https://git.sudo.ws/sudo/commit/?id=c5a7f0eb4)

* src/sudo.c:

  Audit errors from policy\_init\_session(), audit\_accept(), and
  audit\_reject().
  [[cbb7b4afa]](https://git.sudo.ws/sudo/commit/?id=cbb7b4afa)

* src/sudo.c:

  Do not run the command if the audit accept function fails. Also add
  warnings if the audit reject or error functions fail.
  [[02ebdfd7f]](https://git.sudo.ws/sudo/commit/?id=02ebdfd7f)

* plugins/sudoers/log\_client.c:

  Reduce the number of error messages when we can’t connect to the audit
  server. Add the error string to “unable to connect to log server”
  instead of using an extra error message for the connect(2) failure.
  [[67e6e2085]](https://git.sudo.ws/sudo/commit/?id=67e6e2085)

* plugins/sudoers/log\_client.c:

  Use correct error message when the TLS connection is dropped. Was:
  “recv: Unknown error 0”, now: “lost connection to log server”.
  [[a19f24279]](https://git.sudo.ws/sudo/commit/?id=a19f24279)

2020-12-02 Todd C. Miller

* plugins/sudoers/alias.c, plugins/sudoers/gram.c, plugins/sudoers/gram.h,
  plugins/sudoers/gram.y, plugins/sudoers/parse.h:

  Change alias\_add() to return bool and set errno on failure. This fixes a
  localization problem where the error message could have been reported in
  the wrong locale.
  [[d98374753]](https://git.sudo.ws/sudo/commit/?id=d98374753)

2020-11-30 Todd C. Miller

* lib/eventlog/eventlog.c:

  Fix build when configured using –without-sendmail [Bug
  #947](https://bugzilla.sudo.ws/show_bug.cgi?id=947)
  [[e22817e3a]](https://git.sudo.ws/sudo/commit/?id=e22817e3a)

2020-11-29 Todd C. Miller

* plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/hr.mo,
  po/hr.po:

  Updated translations from translationproject.org
  [[833e273ad]](https://git.sudo.ws/sudo/commit/?id=833e273ad)

2020-11-24 Todd C. Miller

* NEWS:

  sudo\_logsrvd.conf pid\_file change.
  [[7ac951bb6]](https://git.sudo.ws/sudo/commit/?id=7ac951bb6)

* logsrvd/logsrvd.c:

  Don’t try to unlink a NULL pointer.
  [[293911eed]](https://git.sudo.ws/sudo/commit/?id=293911eed)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c:

  If pid\_file is set to an empty value, disable the use of a pid file.
  [[0f6d581ab]](https://git.sudo.ws/sudo/commit/?id=0f6d581ab)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  logsrvd/logsrvd.c:

  Don’t overwrite sudo\_logsrvd.pid if it is a symbolic link.
  [[d0042eda9]](https://git.sudo.ws/sudo/commit/?id=d0042eda9)

* INSTALL, configure, configure.ac, etc/codespell.exclude,
  plugins/sudoers/env.c:

  Fix typo detected by codespell 2.0.0 Also avoid some new false positives
  [[94c5052eb]](https://git.sudo.ws/sudo/commit/?id=94c5052eb)

2020-11-23 Todd C. Miller

* etc/uncrustify-small.cfg, etc/uncrustify.cfg,
  plugins/python/regress/testhelpers.h, plugins/sudoers/env.c,
  plugins/sudoers/sudo\_ldap\_conf.h:

  Set pp\_ignore\_define\_body=false in uncrustify config. Need to work
  around a bug that produces closed brace errors, see
  <https://github.com/uncrustify/uncrustify/issues/2569>
  [[bdf553001]](https://git.sudo.ws/sudo/commit/?id=bdf553001)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt.mo, plugins/sudoers/po/pt.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/hr.mo,
  po/hr.po, po/it.mo, po/it.po:

  Updated translations from translationproject.org
  [[7bbd7c8e0]](https://git.sudo.ws/sudo/commit/?id=7bbd7c8e0)

2020-11-18 Todd C. Miller

* lib/util/sudo\_conf.c:

  Fix calling sudo\_conf\_read() multiple times with different conf\_types.
  The change to reinitialize the configuration data when sudo\_conf\_read()
  is called again didn’t take into account that sudo calls
  sudo\_conf\_read() twice–once for the debug info and once for everything
  else.
  [[4a6ca4ba2]](https://git.sudo.ws/sudo/commit/?id=4a6ca4ba2)

2020-11-17 Todd C. Miller

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c:

  Don’t free the private copy of the environment until the close function.
  We may need to use it when logging from the audit reject function.
  [[7d0b19d2a]](https://git.sudo.ws/sudo/commit/?id=7d0b19d2a)

* plugins/sudoers/log\_client.c:

  It is possible for evlog->argv or evlog->envp to be NULL.
  [[cb87253d1]](https://git.sudo.ws/sudo/commit/?id=cb87253d1)

* src/exec\_pty.c, src/sudo.c, src/sudo.h:

  Pass command\_info[] to audit plugin on I/O log plugin reject or error.
  The audit plugin should cope with a NULL command\_info but there’s no
  reason not to pass the info when we have it.
  [[24d812d03]](https://git.sudo.ws/sudo/commit/?id=24d812d03)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  plugins/sudoers/audit.c:

  For the audit plugin, command\_info may be NULL. Fixes a NULL dereference
  in sudoers\_audit when an I/O logging plugin rejects input/output or
  returns an error.
  [[27615b558]](https://git.sudo.ws/sudo/commit/?id=27615b558)

* plugins/sudoers/defaults.c:

  Add missing initialization of def\_log\_format to sudo.
  [[e4a2765cc]](https://git.sudo.ws/sudo/commit/?id=e4a2765cc)

2020-11-16 Todd C. Miller

* config.h.in, configure, configure.ac:

  Newer LibreSSL has SSL\_CTX\_set\_ciphersuites but it is not enabled. Add a
  check for the function declaration in openssl/ssl.h.
  [[a96b9a137]](https://git.sudo.ws/sudo/commit/?id=a96b9a137)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Event log data is sent to sudo\_logsrvd even when not I/O logging.
  [[38dd0f63b]](https://git.sudo.ws/sudo/commit/?id=38dd0f63b)

2020-11-14 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  Regenerate sudoers.pot for 1.9.4
  [[061b53e33]](https://git.sudo.ws/sudo/commit/?id=061b53e33)

* NEWS, configure, configure.ac:

  Update for sudo 1.9.4.
  [[1aa76e9b7]](https://git.sudo.ws/sudo/commit/?id=1aa76e9b7)

* plugins/sudoers/audit.c:

  Update struct eventlog based on command\_info[] from front-end. The I/O
  log path is not known until the I/O log plugins have run and other
  plugins may alter the execution environment.
  [[2b71b6104]](https://git.sudo.ws/sudo/commit/?id=2b71b6104)

* plugins/sudoers/alias.c, plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/logging.h,
  plugins/sudoers/regress/testsudoers/test13.out.ok,
  plugins/sudoers/toke.h:

  Add sudoerserrorf(), a printf-style yyerror() function. Use this to
  display a better error message when using a reserved work in an alias
  definition.
  [[95fb8eb72]](https://git.sudo.ws/sudo/commit/?id=95fb8eb72)

2020-11-13 Todd C. Miller

* scripts/mkpkg:

  Build universal binaries on macOS 11.0 and higher. The resulting package
  should work on Macs based on Apple Silicon.
  [[d28b4291c]](https://git.sudo.ws/sudo/commit/?id=d28b4291c)

2020-11-12 Todd C. Miller

* plugins/sudoers/editor.c:

  Support EDITOR environment variable that includes quotes. Quote support
  is limited to the beginning of a word. Also handles characters escaped
  with a backslash.
  [[aeef6db85]](https://git.sudo.ws/sudo/commit/?id=aeef6db85)

2020-11-11 Todd C. Miller

* plugins/python/Makefile.in, plugins/python/pyhelpers.c,
  plugins/python/python\_plugin\_common.c,
  plugins/python/regress/iohelpers.h,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@diag.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@info.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_plugin@info.log,
  plugins/python/regress/testdata/check\_example\_debugging\_py\_calls@diag.lo
  g,
  plugins/python/regress/testdata/check\_example\_debugging\_py\_calls@info.lo
  g,
  plugins/python/regress/testdata/check\_example\_group\_plugin\_is\_able\_to\_de
  bug.log,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log.stor
  ed,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log\_mult
  iple1.stored,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log\_mult
  iple2.stored,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_failed\_to\_start\_
  command.stored,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_fails\_with\_pytho
  n\_backtrace.stderr,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_validate\_inv
  alidate.log,
  plugins/python/regress/testdata/check\_loading\_fails\_not\_owned\_by\_root.st
  derr,
  plugins/python/regress/testdata/check\_loading\_fails\_wrong\_classname.stde
  rr,
  plugins/python/regress/testdata/check\_loading\_fails\_wrong\_path.stderr,
  plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stdout,
  plugins/python/regress/testdata/check\_python\_plugins\_do\_not\_affect\_each\_
  other.stdout, plugins/python/regress/testhelpers.c,
  plugins/python/regress/testhelpers.h:

  Back out regex use in python tests, filter the output instead. This
  makes it possible to regenerate the test output again. Also adds an
  update\_test\_data target to the Makefile.
  [[d688f4d34]](https://git.sudo.ws/sudo/commit/?id=d688f4d34)

* src/sudo.c:

  Stay setuid until just before executing the command. Fixes a problem
  with pam\_xauth which checks effective and real uids to get the real
  identity of the user.
  [[b2ccbb3a9]](https://git.sudo.ws/sudo/commit/?id=b2ccbb3a9)

* plugins/sudoers/ldap.c:

  Ignore sudoNotBefore and sudoNotAfter unless ldap.conf contains
  SUDOERS\_TIMED This is consistent with the pre-1.8.24 behavior. [Bug
  #945](https://bugzilla.sudo.ws/show_bug.cgi?id=945)
  [[6439b4cc0]](https://git.sudo.ws/sudo/commit/?id=6439b4cc0)

2020-11-10 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/parse.h,
  plugins/sudoers/sssd.c:

  Introduce new\_member\_all() for code that doesn’t include gram.h. The
  ldap and sssd back-ends no longer require gram.h which fixes a
  compilation issue with IBM LDAP.
  [[55c4f3bdd]](https://git.sudo.ws/sudo/commit/?id=55c4f3bdd)

* lib/util/sudo\_conf.c, lib/util/sudo\_debug.c, logsrvd/logsrvd.c:

  On SIGHUP, deregister the old debug instance before registering a new
  one. Otherwise, if debugging is enabled we will get an extra log
  instance each time sudo\_logsrvd reeives SIGHUP which results in
  duplicate lines in the debug log.
  [[deb217adf]](https://git.sudo.ws/sudo/commit/?id=deb217adf)

2020-11-09 Todd C. Miller

* plugins/sudoers/log\_client.c, plugins/sudoers/log\_client.h:

  Refactor code to format the client message after the hello.
  [[72df19088]](https://git.sudo.ws/sudo/commit/?id=72df19088)

* plugins/sudoers/audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h:

  Use sudoers\_to\_eventlog() and init\_log\_details() in
  sudoers\_audit\_accept(). log\_deserialize\_info() can be private to iolog.c
  again.
  [[56fb16d3e]](https://git.sudo.ws/sudo/commit/?id=56fb16d3e)

* doc/sudo\_logsrv.proto.man.in, doc/sudo\_logsrv.proto.mdoc.in,
  include/log\_server.pb-c.h, lib/eventlog/eventlog.c,
  lib/logsrv/log\_server.pb-c.c, lib/logsrv/log\_server.proto,
  logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, plugins/sudoers/log\_client.c:
  Add info\_msgs to AlertMessage and populate it. This lets us log eventlog
  info along with the alert if it is available.
  [[9779009fa]](https://git.sudo.ws/sudo/commit/?id=9779009fa)

* plugins/sudoers/Makefile.in, plugins/sudoers/audit.c,
  plugins/sudoers/iolog.c, plugins/sudoers/log\_client.c,
  plugins/sudoers/log\_client.h, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h:

  Log reject and alert messages to the log server if one is defined.
  [[62525dcc9]](https://git.sudo.ws/sudo/commit/?id=62525dcc9)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/audit.c,
  plugins/sudoers/iolog.c, plugins/sudoers/log\_client.c,
  plugins/sudoers/log\_client.h:

  Rename iolog\_plugin.h to log\_client.h. It is no longer I/O log specific
  and is used by sudoers\_audit too.
  [[e56c3b342]](https://git.sudo.ws/sudo/commit/?id=e56c3b342)

* MANIFEST, config.h.in, configure, configure.ac,
  plugins/sudoers/Makefile.in, plugins/sudoers/audit.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_plugin.h,
  plugins/sudoers/log\_client.c, plugins/sudoers/sudoers.c:

  Rename iolog\_client -> log\_client. The logsrvd client code is now used
  for more than just I/O logging.
  [[62547746d]](https://git.sudo.ws/sudo/commit/?id=62547746d)

2020-11-04 Todd C. Miller

* plugins/sudoers/Makefile.in, plugins/sudoers/audit.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h:

  Log accept messages in sudoers\_audit if not I/O logging.
  [[2112d9beb]](https://git.sudo.ws/sudo/commit/?id=2112d9beb)

* plugins/sudoers/iolog\_client.c:

  Refactor code to format InfoMesage array into fmt\_info\_messages(). Add
  free\_info\_messages() to free the array.
  [[8f5290b19]](https://git.sudo.ws/sudo/commit/?id=8f5290b19)

* plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h:

  Refactor sudoers\_io\_open\_remote() into log\_server\_open(). Also rename
  client\_close() to log\_server\_close(). This keeps more of the client code
  details out of iolog.c and will be used when logging accept messages
  from the audit plugin.
  [[e264767ea]](https://git.sudo.ws/sudo/commit/?id=e264767ea)

* plugins/sudoers/iolog.c:

  Move argv and envp setting into iolog\_deserialize\_info().
  [[2d888380a]](https://git.sudo.ws/sudo/commit/?id=2d888380a)

* logsrvd/logsrvd.c:

  Avoid early return in handle\_accept() if expect\_iobufs not set.
  [[f1ded289e]](https://git.sudo.ws/sudo/commit/?id=f1ded289e)

2020-11-02 Todd C. Miller

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, include/sudo\_plugin.h,
  plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stdout, src/exec.c, src/load\_plugins.c:

  Add event\_alloc to the audit plugin API. The sudoers audit plugin will
  use this to communicate with sudo\_logsrvd.
  [[fe9e65754]](https://git.sudo.ws/sudo/commit/?id=fe9e65754)

2020-11-09 Todd C. Miller

* plugins/sudoers/logging.c:

  Treat an authentication failure as a reject, not an alert. This matters
  when logging via sudo\_logsrvd. It also lets us remove a special case in
  vlog\_warning().
  [[ad4024170]](https://git.sudo.ws/sudo/commit/?id=ad4024170)

2020-11-06 Todd C. Miller

* lib/eventlog/eventlog.c:

  For logsrvd AlertMessages, evlog will be NULL.
  [[0dd4c5797]](https://git.sudo.ws/sudo/commit/?id=0dd4c5797)

* lib/eventlog/eventlog.c:

  Append errstr to reason for alert and reject events if specified.
  Previously, we logged the error string separately but this is not
  consistent with how it is logged in other formats.
  [[444ca3789]](https://git.sudo.ws/sudo/commit/?id=444ca3789)

2020-11-09 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.h:

  Regenerate with bison 3.7.3
  [[f8a708dae]](https://git.sudo.ws/sudo/commit/?id=f8a708dae)

* configure, configure.ac:

  Remove hack to define YYTOKENTYPE, it breaks newer bison.
  [[08d236293]](https://git.sudo.ws/sudo/commit/?id=08d236293)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c:

  Use struct eventlog \*evlog, not struct eventlog \*details.
  [[a9cad13b1]](https://git.sudo.ws/sudo/commit/?id=a9cad13b1)

2020-11-06 Todd C. Miller

* plugins/sudoers/logging.c:

  Fix cut & pasto in debug subsystem.
  [[282a7e80f]](https://git.sudo.ws/sudo/commit/?id=282a7e80f)

2020-11-02 Todd C. Miller

* logsrvd/sendlog.c, plugins/sudoers/iolog\_client.c:

  Set server\_name before initiating TLS connection so verify function
  works. Fixes a crash in the SSL\_VERIFY\_PEER callback. Also call
  inet\_ntop(3) with addr pointer, not sockaddr pointer so we get the
  correct IP address.
  [[de58c11db]](https://git.sudo.ws/sudo/commit/?id=de58c11db)

* plugins/sudoers/alias.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/sudoers/test18.toke.ok,
  plugins/sudoers/regress/sudoers/test2.ldif.ok,
  plugins/sudoers/regress/sudoers/test3.ldif.ok,
  plugins/sudoers/regress/sudoers/test6.ldif.ok,
  plugins/sudoers/regress/visudo/test2.err.ok,
  plugins/sudoers/regress/visudo/test3.err.ok, plugins/sudoers/visudo.c:

  Store column number for aliases, defaults and userspecs too. This is
  used to provided the column number along with the line number in error
  messages. For aliases we store the column of the alias name, not the
  value since that is what visudo generally needs.
  [[6286ce1d1]](https://git.sudo.ws/sudo/commit/?id=6286ce1d1)

2020-11-01 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/regress/testsudoers/test11.out.ok,
  plugins/sudoers/regress/testsudoers/test12.out.ok,
  plugins/sudoers/regress/testsudoers/test13.out.ok:

  Display column number in parse error messages too. [Bug
  #841](https://bugzilla.sudo.ws/show_bug.cgi?id=841)
  [[982012dbb]](https://git.sudo.ws/sudo/commit/?id=982012dbb)

* plugins/sudoers/iolog\_client.c, plugins/sudoers/iolog\_plugin.h:

  Move tls initialized flag into client\_closure. We may call tls\_init()
  from multiple places in the future so a static initialized flag will
  cause problems.
  [[6f7e5b104]](https://git.sudo.ws/sudo/commit/?id=6f7e5b104)

* plugins/sudoers/cvtsudoers\_json.c:

  Fix -Wshadow warnings caused by json enum member.
  [[10b09e4d8]](https://git.sudo.ws/sudo/commit/?id=10b09e4d8)

2020-10-30 Todd C. Miller

* ABOUT-NLS, INSTALL, NEWS, configure.ac, doc/UPGRADE,
  doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, doc/sudo\_plugin.man.in,
  doc/sudo\_plugin.mdoc.in, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  doc/sudoers\_timestamp.man.in, doc/sudoers\_timestamp.mdoc.in,
  doc/visudo.man.in, doc/visudo.mdoc.in, examples/sudo.conf.in,
  include/compat/getaddrinfo.h, install-sh, lib/util/getaddrinfo.c,
  lib/util/getentropy.c, lib/util/regress/sudo\_conf/test1.in,
  lib/util/regress/sudo\_parseln/test1.in,
  lib/util/regress/vsyslog/vsyslog\_test.c, lib/util/strtoid.c,
  logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c, logsrvd/sendlog.c,
  m4/sudo.m4, plugins/group\_file/group\_file.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in,
  plugins/sudoers/editor.c, plugins/sudoers/env.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/gram.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/stubs.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/timestamp.c,
  plugins/sudoers/visudo.c, src/load\_plugins.c, src/sudo.c,
  src/sudo\_noexec.c, src/tgetpass.c:

  Apply Google inclusive language guidelines. Also replace backwards with
  backward.
  [[e0c2635fb]](https://git.sudo.ws/sudo/commit/?id=e0c2635fb)

2020-10-29 Todd C. Miller

* doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:

  Refernce IBM LDAP libs, not Tivoli since that is how it is packaged. We
  still use Tivoli when talking about the server itself but refer to it as
  the “IBM Tivoli Directory Server”.
  [[973da9a59]](https://git.sudo.ws/sudo/commit/?id=973da9a59)

* doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:

  Add a newline before “This option is …”
  [[f4c5f34ab]](https://git.sudo.ws/sudo/commit/?id=f4c5f34ab)

* doc/sudoers.man.in:

  regen
  [[8dee1b1ec]](https://git.sudo.ws/sudo/commit/?id=8dee1b1ec)

2020-10-28 Todd C. Miller

* lib/eventlog/regress/logwrap/check\_wrap.c,
  lib/eventlog/regress/logwrap/check\_wrap.in,
  lib/eventlog/regress/logwrap/check\_wrap.out.ok:

  Test eventlog\_writeln() when word wrap is disabled.
  [[1910b1924]](https://git.sudo.ws/sudo/commit/?id=1910b1924)

* configure, configure.ac:

  Bison generates an extra enum containing the parser tokens. This
  conflicts with the IBM ldap.h at least. Prevent it from being exposed by
  defining YYTOKENTYPE.
  [[3078d67c1]](https://git.sudo.ws/sudo/commit/?id=3078d67c1)

* config.h.in, configure, configure.ac, plugins/sudoers/ldap.c:

  Use ssl\_err2string() in message on ldap\_ssl\_client\_init() failure.
  Displaying SSL reason code directly is not user-friendly.
  [[c8c7e1f60]](https://git.sudo.ws/sudo/commit/?id=c8c7e1f60)

* configure, configure.ac:

  IBM LDAP packages use a lib64 directory for 64-bit libraries. We need to
  add this to LDFLAGS so the linker is able to find the correct libs when
  building 64-bit binaries.
  [[488aeff53]](https://git.sudo.ws/sudo/commit/?id=488aeff53)

2020-10-27 Todd C. Miller

* lib/eventlog/eventlog.c:

  For JSON logs, write the most important log elements first. This is
  important for syslog where the record could be truncated.
  [[8c43eeb29]](https://git.sudo.ws/sudo/commit/?id=8c43eeb29)

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/logging.c, plugins/sudoers/sudoers.c:

  Add log\_format sudoers setting to select sudo or json format logs.
  Defaults to sudo-format logs.
  [[28d6771d2]](https://git.sudo.ws/sudo/commit/?id=28d6771d2)

* include/sudo\_json.h, lib/eventlog/eventlog.c, lib/util/json.c:

  Support “minimal” JSON which skips all non-essention whitespace. This
  replaces the old “compact” mode which is only used for syslog.
  [[6bc729aa3]](https://git.sudo.ws/sudo/commit/?id=6bc729aa3)

* plugins/sudoers/logging.c:

  Don’t warn about log failure more than once.
  [[4fc39cfb0]](https://git.sudo.ws/sudo/commit/?id=4fc39cfb0)

2020-10-26 Todd C. Miller

* lib/eventlog/eventlog.c:

  Check for fdopen(3) failure in send\_mail().
  [[34c165151]](https://git.sudo.ws/sudo/commit/?id=34c165151)

* MANIFEST, include/sudo\_eventlog.h, lib/eventlog/Makefile.in,
  lib/eventlog/eventlog.c, lib/eventlog/logwrap.c,
  lib/eventlog/regress/logwrap/check\_wrap.c,
  lib/eventlog/regress/logwrap/check\_wrap.in,
  lib/eventlog/regress/logwrap/check\_wrap.out.ok,
  plugins/sudoers/Makefile.in, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/sudoers.c:

  Add support for file log line wrapping in libeventlog.
  [[fdae4bdbb]](https://git.sudo.ws/sudo/commit/?id=fdae4bdbb)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  logsrvd/logsrvd\_conf.c, plugins/sudoers/defaults.c,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/stubs.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c:

  Use real setters for the eventlog config. This makes it possible to have
  a base config that the callers can modify instead of replacing the
  config wholesale.
  [[d899fe593]](https://git.sudo.ws/sudo/commit/?id=d899fe593)

* lib/eventlog/eventlog.c, plugins/sudoers/logging.c:

  Log the short version of the tty in sudoers-format logs. This is
  consistent with historical practice.
  [[39b540ff3]](https://git.sudo.ws/sudo/commit/?id=39b540ff3)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  plugins/sudoers/Makefile.in, plugins/sudoers/audit.c,
  plugins/sudoers/defaults.c, plugins/sudoers/locale.c,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/policy.c, plugins/sudoers/stubs.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c:

  Use libeventlog in sudoers instead of doing our own logging.
  [[4416bd597]](https://git.sudo.ws/sudo/commit/?id=4416bd597)

* lib/eventlog/eventlog.c:

  Add default values in eventlog\_setconf().
  [[541252beb]](https://git.sudo.ws/sudo/commit/?id=541252beb)

* include/sudo\_eventlog.h, lib/eventlog/Makefile.in,
  lib/eventlog/eventlog.c, logsrvd/logsrvd.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/defaults.c, plugins/sudoers/logging.h:

  Add support for mailing eventlog entries and for logging raw messages.
  These will be used by the sudoers plugin.
  [[bd1ca79cc]](https://git.sudo.ws/sudo/commit/?id=bd1ca79cc)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c,
  lib/iolog/iolog\_fileio.c:

  If no JSON callback is provided, store the contents of struct eventlog.
  This moves the JSON formatting of struct eventlog out of libsudo\_iolog
  and into libsudo\_eventlog where it belongs.
  [[fe6e0fb21]](https://git.sudo.ws/sudo/commit/?id=fe6e0fb21)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c, logsrvd/logsrvd.c:

  struct eventlog contains submit\_time, no need to pass it in directly.
  [[4652698f8]](https://git.sudo.ws/sudo/commit/?id=4652698f8)

* include/sudo\_eventlog.h, lib/eventlog/eventlog.c, logsrvd/logsrvd.c:

  Add an errstr argument to eventlog\_alert().
  [[c0e91d758]](https://git.sudo.ws/sudo/commit/?id=c0e91d758)

* plugins/sudoers/Makefile.in, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_client.c, plugins/sudoers/iolog\_plugin.h:

  Make a copy of the strings stored in iolog\_details and struct eventlog.
  Previously, we just made the strings const and relied on the front-end
  not changing them. Now the sudoers I/O log plugin behavior is consistent
  with the policy plugin.
  [[3ca3bfaab]](https://git.sudo.ws/sudo/commit/?id=3ca3bfaab)

* plugins/sudoers/Makefile.in, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_client.c, plugins/sudoers/iolog\_plugin.h:

  Use struct eventlog in iolog\_details.
  [[2d45becd4]](https://git.sudo.ws/sudo/commit/?id=2d45becd4)

* include/sudo\_eventlog.h, include/sudo\_iolog.h, lib/eventlog/eventlog.c,
  lib/iolog/Makefile.in, lib/iolog/iolog\_fileio.c, lib/iolog/iolog\_json.c,
  lib/iolog/iolog\_util.c, logsrvd/Makefile.in, logsrvd/iolog\_writer.c,
  logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/sendlog.c,
  logsrvd/sendlog.h, plugins/sudoers/Makefile.in, plugins/sudoers/iolog.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudoreplay.c:

  Use struct eventlog in place of struct iolog\_info.
  [[db7249825]](https://git.sudo.ws/sudo/commit/?id=db7249825)

* logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c:

  No longer need eventlog-related getters in logsrvd.c
  [[b9aff696f]](https://git.sudo.ws/sudo/commit/?id=b9aff696f)

* MANIFEST, logsrvd/Makefile.in, logsrvd/eventlog.c,
  logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_conf.c:

  Use libeventlog in sudo\_logsrvd.
  [[8c4334047]](https://git.sudo.ws/sudo/commit/?id=8c4334047)

* MANIFEST, Makefile.in, configure, configure.ac, include/sudo\_eventlog.h,
  lib/eventlog/Makefile.in, lib/eventlog/eventlog.c, logsrvd/logsrvd.h:

  Refactor eventlog code into a library
  [[707437f6c]](https://git.sudo.ws/sudo/commit/?id=707437f6c)

2020-10-20 Todd C. Miller

* lib/iolog/Makefile.in, lib/logsrv/Makefile.in, lib/util/Makefile.in,
  logsrvd/Makefile.in, plugins/python/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  regen Makefiles
  [[79921387a]](https://git.sudo.ws/sudo/commit/?id=79921387a)

* scripts/mkpkg:

  Build 64-bit binaries on HP-UX ia64
  [[866b0b77f]](https://git.sudo.ws/sudo/commit/?id=866b0b77f)

2020-10-16 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Explicitly set umask when running tests. Some tests create files that
  must not be world-writable.
  [[5c7c94b83]](https://git.sudo.ws/sudo/commit/?id=5c7c94b83)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  sudoers\_policy\_store() -> sudoers\_policy\_store\_result()
  [[a5a5cc7f8]](https://git.sudo.ws/sudo/commit/?id=a5a5cc7f8)

2020-10-14 Todd C. Miller

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Rename sudoers\_policy\_exec\_setup() -> sudoers\_policy\_store(). It is
  called even when there is no command to execute. Also pass in status of
  whether or not the command was accepted.
  [[bf9d20866]](https://git.sudo.ws/sudo/commit/?id=bf9d20866)

2020-10-10 Todd C. Miller

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/cvtsudoers/test1.sh,
  plugins/sudoers/regress/cvtsudoers/test10.sh,
  plugins/sudoers/regress/cvtsudoers/test11.sh,
  plugins/sudoers/regress/cvtsudoers/test12.sh,
  plugins/sudoers/regress/cvtsudoers/test13.sh,
  plugins/sudoers/regress/cvtsudoers/test14.sh,
  plugins/sudoers/regress/cvtsudoers/test15.sh,
  plugins/sudoers/regress/cvtsudoers/test16.sh,
  plugins/sudoers/regress/cvtsudoers/test17.sh,
  plugins/sudoers/regress/cvtsudoers/test18.sh,
  plugins/sudoers/regress/cvtsudoers/test19.sh,
  plugins/sudoers/regress/cvtsudoers/test2.sh,
  plugins/sudoers/regress/cvtsudoers/test20.sh,
  plugins/sudoers/regress/cvtsudoers/test21.sh,
  plugins/sudoers/regress/cvtsudoers/test22.sh,
  plugins/sudoers/regress/cvtsudoers/test23.sh,
  plugins/sudoers/regress/cvtsudoers/test24.sh,
  plugins/sudoers/regress/cvtsudoers/test25.sh,
  plugins/sudoers/regress/cvtsudoers/test26.sh,
  plugins/sudoers/regress/cvtsudoers/test27.sh,
  plugins/sudoers/regress/cvtsudoers/test28.sh,
  plugins/sudoers/regress/cvtsudoers/test29.sh,
  plugins/sudoers/regress/cvtsudoers/test3.sh,
  plugins/sudoers/regress/cvtsudoers/test30.sh,
  plugins/sudoers/regress/cvtsudoers/test31.sh,
  plugins/sudoers/regress/cvtsudoers/test32.sh,
  plugins/sudoers/regress/cvtsudoers/test33.sh,
  plugins/sudoers/regress/cvtsudoers/test4.sh,
  plugins/sudoers/regress/cvtsudoers/test5.sh,
  plugins/sudoers/regress/cvtsudoers/test6.sh,
  plugins/sudoers/regress/cvtsudoers/test7.sh,
  plugins/sudoers/regress/cvtsudoers/test8.sh,
  plugins/sudoers/regress/cvtsudoers/test9.sh,
  plugins/sudoers/regress/testsudoers/test1.sh,
  plugins/sudoers/regress/testsudoers/test10.sh,
  plugins/sudoers/regress/testsudoers/test11.sh,
  plugins/sudoers/regress/testsudoers/test12.sh,
  plugins/sudoers/regress/testsudoers/test13.sh,
  plugins/sudoers/regress/testsudoers/test14.sh,
  plugins/sudoers/regress/testsudoers/test15.sh,
  plugins/sudoers/regress/testsudoers/test2.sh,
  plugins/sudoers/regress/testsudoers/test3.sh,
  plugins/sudoers/regress/testsudoers/test4.sh,
  plugins/sudoers/regress/testsudoers/test5.sh,
  plugins/sudoers/regress/testsudoers/test6.sh,
  plugins/sudoers/regress/testsudoers/test7.sh,
  plugins/sudoers/regress/testsudoers/test8.sh,
  plugins/sudoers/regress/testsudoers/test9.sh,
  plugins/sudoers/regress/visudo/test1.sh,
  plugins/sudoers/regress/visudo/test10.sh,
  plugins/sudoers/regress/visudo/test2.sh,
  plugins/sudoers/regress/visudo/test3.sh,
  plugins/sudoers/regress/visudo/test4.sh,
  plugins/sudoers/regress/visudo/test5.sh,
  plugins/sudoers/regress/visudo/test6.sh,
  plugins/sudoers/regress/visudo/test7.sh,
  plugins/sudoers/regress/visudo/test8.sh,
  plugins/sudoers/regress/visudo/test9.sh:

  Pass path to testsudoers, visudo or cvtsudoers in the environment. Falls
  back on the unqualified command if the environment variable is not set.
  [[b0a6e1c1e]](https://git.sudo.ws/sudo/commit/?id=b0a6e1c1e)

2020-10-09 Todd C. Miller

* plugins/sudoers/sssd.c:

  Init cmnds to NULL in rule\_to\_priv() so we don’t free a bogus pointer.
  In the sssd backend, the rule\_to\_priv() cleanup code assumes cmnds can
  be passed to fn\_free\_values(), which was not the case if we receive an
  error getting values for “sudoCommand”. This is a regression introduced
  in sudo 1.9.1. Fix from Ron Bowes. [GitHub issue
  #67](https://github.com/sudo-project/sudo/issues/67).
  [[807857a2c]](https://git.sudo.ws/sudo/commit/?id=807857a2c)

2020-10-06 Todd C. Miller

* plugins/sudoers/match\_command.c, plugins/sudoers/match\_digest.c,
  plugins/sudoers/parse.h:

  Pass runchroot to match\_digest() too. We use the open fd for the actual
  I/O but having runchroot makes it possible to report the correct file
  name in error messages.
  [[607076d8a]](https://git.sudo.ws/sudo/commit/?id=607076d8a)

2020-10-04 Todd C. Miller

* NEWS:

  [GitHub issue #61](https://github.com/sudo-project/sudo/issues/61) was
  fixed in sudo 1.9.3.
  [[645eda55a]](https://git.sudo.ws/sudo/commit/?id=645eda55a)

2020-09-29 Todd C. Miller

* plugins/sudoers/def\_data.h, plugins/sudoers/mkdefaults:

  Fix indentation of enum def\_tuple.
  [[ea57249e2]](https://git.sudo.ws/sudo/commit/?id=ea57249e2)

2020-09-28 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Remove special case EOF handling; lines now always end in a newline.
  Previously we needed to emulate some of the state transitions that
  happen at end-of-line at end-of-file as well. Those are no longer needed
  now that we are guaranteed to always have a newline at the end.
  [[772619b7e]](https://git.sudo.ws/sudo/commit/?id=772619b7e)

2020-09-27 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Increment sudolinebuf.size after realloc().
  [[f984f49c3]](https://git.sudo.ws/sudo/commit/?id=f984f49c3)

* plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/regress/sudoers/test13.toke.ok, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Add a newline at end of line if one is missing. This is simpler than
  having to support entries that end at EOF too.
  [[e8747a33f]](https://git.sudo.ws/sudo/commit/?id=e8747a33f)

* MANIFEST, plugins/sudoers/regress/testsudoers/test14.out.ok,
  plugins/sudoers/regress/testsudoers/test14.sh,
  plugins/sudoers/regress/testsudoers/test15.out.ok,
  plugins/sudoers/regress/testsudoers/test15.sh:

  Add tests for entries without a newline.
  [[32db52868]](https://git.sudo.ws/sudo/commit/?id=32db52868)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Fix handling of a command spec without a newline at the end. For include
  files, we may need to inject a newline token now that the grammar
  requires lines to end with a newline or EOF. There is no END (EOF) token
  processed after popping off an include file since everything is just
  treated as one big file.
  [[9bb91cb64]](https://git.sudo.ws/sudo/commit/?id=9bb91cb64)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Mark sudoerserror() messages for translation.
  [[0276a565e]](https://git.sudo.ws/sudo/commit/?id=0276a565e)

* plugins/sudoers/regress/sudoers/test8.toke.ok, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Fix line number accounting when a string contains a newline. Strings are
  not allowed to span multiple lines without a continuation character.
  Also provide a better error message if we are in the middle of a string
  and hit EOF.
  [[ddc138383]](https://git.sudo.ws/sudo/commit/?id=ddc138383)

2020-09-26 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/sudoers.h, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Use sudoerschar (yychar) instead of last\_token. The parser already
  provides a way to examing the last token processed, we don’t need to add
  our own.
  [[7d2090061]](https://git.sudo.ws/sudo/commit/?id=7d2090061)

2020-09-25 Todd C. Miller

* lib/util/closefrom.c, lib/util/getentropy.c, lib/util/pipe2.c,
  lib/util/term.c, lib/util/ttyname\_dev.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/env.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/gmtoff.c, plugins/sudoers/locale.c,
  plugins/sudoers/logging.h, plugins/sudoers/policy.c,
  plugins/sudoers/starttime.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c,
  plugins/system\_group/system\_group.c, src/load\_plugins.c, src/sudo.c,
  src/sudo\_plugin\_int.h, src/tgetpass.c, src/ttyname.c:

  Fix -Wshadow warnings.
  [[88dcdcd11]](https://git.sudo.ws/sudo/commit/?id=88dcdcd11)

* configure, configure.ac:

  Add -Wshadow to warning flags if the compiler supports it.
  [[7eda22c72]](https://git.sudo.ws/sudo/commit/?id=7eda22c72)

* MANIFEST, plugins/sudoers/regress/testsudoers/test13.out.ok,
  plugins/sudoers/regress/testsudoers/test13.sh:

  Add test for syntax error when defining an alias using a reserved word.
  [[7a36d70fc]](https://git.sudo.ws/sudo/commit/?id=7a36d70fc)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Fix pasto, TIMEOUT not CMND\_TIMEOUT.
  [[e826705b6]](https://git.sudo.ws/sudo/commit/?id=e826705b6)

* NEWS, doc/UPGRADE, doc/sudoers.man.in, doc/sudoers.man.in.sed,
  doc/sudoers.mdoc.in:

  Document reserved words that cannot be used as alias names. [Bug
  #941](https://bugzilla.sudo.ws/show_bug.cgi?id=941)
  [[b1a59accf]](https://git.sudo.ws/sudo/commit/?id=b1a59accf)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/sudoers\_version.h:

  Detect when a reserved word is used when declaring an alias. Now instead
  of “syntax error, unexpected CHROOT, expecting ALIAS” the message is
  “syntax error, reserved word used as an alias name” [Bug
  #941](https://bugzilla.sudo.ws/show_bug.cgi?id=941)
  [[70ada21c5]](https://git.sudo.ws/sudo/commit/?id=70ada21c5)

2020-09-23 Todd C. Miller

* NEWS, configure, configure.ac:

  Update for sudo 1.9.3p1
  [[b2593b22b]](https://git.sudo.ws/sudo/commit/?id=b2593b22b)

* plugins/sudoers/audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/sudoers.c:

  Add SLOG\_AUDIT flag for log\_warningx() to also audit the message. This
  lets us combine audit\_failure() and log\_warningx() calls with the same
  message.
  [[f1d19f1d6]](https://git.sudo.ws/sudo/commit/?id=f1d19f1d6)

* plugins/sudoers/sudoers.c:

  Log when user-specified command line options are rejected by sudoers. We
  already audit those but in some cases they were not logged as well.
  [[6ee731caf]](https://git.sudo.ws/sudo/commit/?id=6ee731caf)

* plugins/sudoers/sudoers.c:

  Fix potential NULL deref in debug code.
  [[6f8e1b974]](https://git.sudo.ws/sudo/commit/?id=6f8e1b974)

* plugins/sudoers/getspwuid.c:

  Close the passwd db before calling getpwnam\_shadow(3). Otherwise, we
  will get the non-shadow passwd entry (”\*") since we called setpassent(3)
  earlier to keep the passwd db open.
  [[09835b719]](https://git.sudo.ws/sudo/commit/?id=09835b719)

* configure, configure.ac:

  Fix configure test for crypt(3) when it is present in libc. Fixes a
  regression introduced in sudo 1.9.3.
  [[75d53ee54]](https://git.sudo.ws/sudo/commit/?id=75d53ee54)

2020-09-19 Todd C. Miller

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt.mo, plugins/sudoers/po/pt.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/eo.mo,
  po/eo.po, po/fi.mo, po/fi.po, po/fr.mo, po/fr.po:

  Updated translations from translationproject.org
  [[d4428133b]](https://git.sudo.ws/sudo/commit/?id=d4428133b)

2020-09-20 Todd C. Miller

* configure, configure.ac:

  Move warning about plaintext password to the end of configure. It is
  unlikely to be noticed at the beginning of the output.
  [[e2c72300c]](https://git.sudo.ws/sudo/commit/?id=e2c72300c)

2020-09-18 Todd C. Miller

* config.h.in, configure, configure.ac, plugins/sudoers/auth/passwd.c:

  Use a simple string compare on systems without crypt(3). This is only
  used on systems without PAM, BSD authentication or AIX authentication.
  [Bug #940](https://bugzilla.sudo.ws/show_bug.cgi?id=940).
  [[874c2b27c]](https://git.sudo.ws/sudo/commit/?id=874c2b27c)

* src/utmp.c:

  Fix typo in last commit.
  [[44a1058aa]](https://git.sudo.ws/sudo/commit/?id=44a1058aa)

2020-09-17 Todd C. Miller

* src/sudo\_edit.c:

  Only use faccessat(3) if AT\_EACCESS is defined. Apparently Android
  (bionic) has faccessat() but not AT\_EACCESS. [Bug
  #940](https://bugzilla.sudo.ws/show_bug.cgi?id=940).
  [[90bcae798]](https://git.sudo.ws/sudo/commit/?id=90bcae798)

* src/utmp.c:

  Guard use of ttyslot() with HAVE\_TTYSLOT, fix guard for utmp\_setid().
  This should make it easier to compile sudo on Android which doesn’t
  provide a way to write to the utmp file. [Bug
  #940](https://bugzilla.sudo.ws/show_bug.cgi?id=940).
  [[4f1fff953]](https://git.sudo.ws/sudo/commit/?id=4f1fff953)

2020-09-16 Todd C. Miller

* po/zh\_CN.mo, po/zh\_CN.po:

  Updated translations from translationproject.org
  [[a00130328]](https://git.sudo.ws/sudo/commit/?id=a00130328)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt.mo, plugins/sudoers/po/pt.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/cs.mo,
  po/cs.po, po/de.mo, po/de.po, po/eo.mo, po/eo.po, po/fi.mo, po/fi.po,
  po/fr.mo, po/fr.po, po/hr.mo, po/hr.po, po/it.mo, po/it.po, po/ja.mo,
  po/ja.po, po/pl.mo, po/pl.po, po/pt.mo, po/pt.po, po/pt\_BR.mo,
  po/pt\_BR.po, po/sr.mo, po/sr.po, po/tr.mo, po/tr.po, po/uk.mo, po/uk.po,
  po/zh\_TW.mo, po/zh\_TW.po:

  Updated translations from translationproject.org
  [[9f6a3d35c]](https://git.sudo.ws/sudo/commit/?id=9f6a3d35c)

* configure, configure.ac, plugins/sudoers/po/sudoers.pot:

  Back out sudo 1.9.3b1 version change.
  [[1154e1d60]](https://git.sudo.ws/sudo/commit/?id=1154e1d60)

2020-09-14 Todd C. Miller

* NEWS, configure, configure.ac, plugins/sudoers/defaults.c,
  plugins/sudoers/po/sudoers.pot:

  Fix typo in warning for T\_CHPATH, list ‘~’ not ‘\*’ twice. [Bug
  #938](https://bugzilla.sudo.ws/show_bug.cgi?id=938)
  [[def99ffd7]](https://git.sudo.ws/sudo/commit/?id=def99ffd7)

2020-09-12 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update .pot files for 1.9.3.
  [[86df234e1]](https://git.sudo.ws/sudo/commit/?id=86df234e1)

2020-09-10 Todd C. Miller

* plugins/sudoers/iolog\_client.c:

  Add missing check for strdup() failure. Coverity CID 214243
  [[3fc3b62d7]](https://git.sudo.ws/sudo/commit/?id=3fc3b62d7)

* examples/sudoers:

  Sync example sudoers with manual page.
  [[4239a45b6]](https://git.sudo.ws/sudo/commit/?id=4239a45b6)

2020-09-09 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Add simple runchroot and runcwd examples. Also document the limitation
  of command-based Defaults settings.
  [[5ca6056a3]](https://git.sudo.ws/sudo/commit/?id=5ca6056a3)

* plugins/sudoers/sudoers.c:

  Add callback for runchroot Defaults and require password -D/-R checks.
  Using a command-based Default for runchroot will still only work for
  paths that exist both in and outside the chroot.
  [[c200e7163]](https://git.sudo.ws/sudo/commit/?id=c200e7163)

* plugins/sudoers/defaults.c, plugins/sudoers/match.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c:

  Pass a struct to the match functions to track the resolved command. This
  makes it possible to update user\_cmnd and cmnd\_status modified by
  per-rule CHROOT settings.
  [[10d3d69aa]](https://git.sudo.ws/sudo/commit/?id=10d3d69aa)

* plugins/sudoers/defaults.c, plugins/sudoers/editor.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/goodpath.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_command.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/stubs.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c:

  Take the chroot into account when search for the command. This could a a
  user-specific chroot via the -R option, a runchroot Defaults value, or a
  per-command CHROOT spec in the sudoers rule.
  [[b6dbfe509]](https://git.sudo.ws/sudo/commit/?id=b6dbfe509)

2020-09-06 Todd C. Miller

* configure, configure.ac:

  Remove closefrom\_fallback() from lib/util/util.exp. It is a static
  function and should not be exported.
  [[e9997c8ec]](https://git.sudo.ws/sudo/commit/?id=e9997c8ec)

2020-09-06 Evan Anderson

* configure, m4/sudo.m4:

  configure: Fix runstatedir handling for distros that do not support it

  runstatedir was added in yet-to-be released autoconf 2.70. Some distros
  are shipping this addition in their autoconf packages, but others, such
  as Fedora, are not. This causes the rundir variable to be set
  incorrectly if the configure script is regenerated with an unpatched
  autoconf since the runstatedir variable set is deleted after
  regeneration. This change works around that problem by checking that
  runstatedir is non-empty before potentially using it to set the rundir
  variable
  [[92e5d8194]](https://git.sudo.ws/sudo/commit/?id=92e5d8194)

2020-09-05 Todd C. Miller

* lib/util/Makefile.in:

  We need to link with NET\_LIBS for gai\_strerror() on some systems. From
  Tim Rice
  [[3d9154cd4]](https://git.sudo.ws/sudo/commit/?id=3d9154cd4)

* ltmain.sh:

  Fix sco library versioning; fallout from frebsd-elf reorg. From Tim Rice
  [[d6ed38e7e]](https://git.sudo.ws/sudo/commit/?id=d6ed38e7e)

* configure, configure.ac:

  SVR4/5 fixes and long password support for OpenServer 6 & 5. From Tim
  Rice
  [[72b28bbc3]](https://git.sudo.ws/sudo/commit/?id=72b28bbc3)

* lib/logsrv/protobuf-c.c:

  Use config.h to handle systems without inline function support.
  [[0f8802676]](https://git.sudo.ws/sudo/commit/?id=0f8802676)

* configure, configure.ac:

  Prefer dlopen() over shl\_load() on HP-UX 11.11 and higher.
  [[f6cb5c72b]](https://git.sudo.ws/sudo/commit/?id=f6cb5c72b)

* include/sudo\_fatal.h, lib/util/fatal.c:

  Define sudo\_warn\_setlocale\_t and use sudo\_conv\_t in sudo\_fatal.h. Works
  around a bug in older versions of the HP ANSI C compiler and results in
  more readable code.
  [[d56347b98]](https://git.sudo.ws/sudo/commit/?id=d56347b98)

* configure, configure.ac:

  HP-UX cc may not allow \_\_declspec(dllexport) to be used in conjunction
  with “#pragma HP\_DEFINED\_EXTERNAL” when redefining standard libc
  functions.
  [[a7033f33a]](https://git.sudo.ws/sudo/commit/?id=a7033f33a)

2020-09-04 Todd C. Miller

* configure, configure.ac:

  Fix check for hiding unexported symbols on HP-UX. We need to pass the -b
  option to the compiler, not just the linker, so it will choose the PIC C
  runtime.
  [[88c7a35dd]](https://git.sudo.ws/sudo/commit/?id=88c7a35dd)

* src/regress/ttyname/check\_ttyname.c:

  Check that the files are character devices before comparing st\_rdev.
  [[cc8e6c601]](https://git.sudo.ws/sudo/commit/?id=cc8e6c601)

* src/regress/ttyname/check\_ttyname.c:

  Fix regress when ttyname(3) returns the same device under a different
  name. On systems that have both new and old pty names we can end up with
  a name mismatch even though the underlying device is the same.
  [[a0092ce31]](https://git.sudo.ws/sudo/commit/?id=a0092ce31)

* plugins/sudoers/regress/testsudoers/test3.sh:

  Use the same pattern of redefining TESTDIR as test10.sh. Adapted from a
  diff from Tim Rice.
  [[e561f5b85]](https://git.sudo.ws/sudo/commit/?id=e561f5b85)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c:

  Rename sa\_len -> sa\_size to avoid a conflict on UnixWare and others. On
  some systems, sa\_len is a #define for 4.4BSD compatibility.
  [[e92d10011]](https://git.sudo.ws/sudo/commit/?id=e92d10011)

* plugins/sudoers/pwutil.c:

  Include strings.h for strcasecmp(3). From Tim Rice
  [[f6a14c941]](https://git.sudo.ws/sudo/commit/?id=f6a14c941)

* lib/util/getentropy.c:

  Add missing #ifdef HAVE\_CLOCK\_GETTIME in getentropy\_fallback() From Tim
  Rice
  [[c4b9f6136]](https://git.sudo.ws/sudo/commit/?id=c4b9f6136)

* plugins/sudoers/Makefile.in:

  Regen for check\_exptilde.o
  [[f6d477692]](https://git.sudo.ws/sudo/commit/?id=f6d477692)

* lib/util/Makefile.in, scripts/mkdep.pl:

  Add missing dependency info for cfmakeraw.lo in lib/util/Makefile.in
  From Tim Rice
  [[dad149f78]](https://git.sudo.ws/sudo/commit/?id=dad149f78)

* plugins/sudoers/auth/pam.c:

  Be consistent and use \_\_hpux not **hpux** like the rest of sudo.
  [[fb64210f7]](https://git.sudo.ws/sudo/commit/?id=fb64210f7)

* lib/logsrv/protobuf-c.c:

  Replace “static inline” with “static \_\_inline” for older compilers.
  [[0576eb010]](https://git.sudo.ws/sudo/commit/?id=0576eb010)

* MANIFEST, include/log\_server.pb-c.h, lib/logsrv/Makefile.in,
  lib/logsrv/log\_server.pb-c.c, logsrvd/eventlog.c,
  logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, logsrvd/sendlog.c,
  plugins/sudoers/iolog\_client.c, scripts/unanon:

  Post-process protoc-c files to avoid depending on anonymous unions.
  Based on a patch from Michael Osipov. [GitHub issue
  #60](https://github.com/sudo-project/sudo/issues/60)
  [[eaa95acb3]](https://git.sudo.ws/sudo/commit/?id=eaa95acb3)

* src/preload.c:

  Add sudoers\_audit to sudo\_sudoers\_plugin\_symbols[] array. Fixes loading
  of sudoers\_audit when configured with –enable-static-sudoers. [GitHub
  issue #61](https://github.com/sudo-project/sudo/issues/61)
  [[24b35393e]](https://git.sudo.ws/sudo/commit/?id=24b35393e)

2020-09-03 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Fix copy and paste error; Coverity CID 214191
  [[8a8a24560]](https://git.sudo.ws/sudo/commit/?id=8a8a24560)

* plugins/sudoers/visudo.c:

  Fix memory leak on error found by the clang 10.01 analyzer.
  [[24d5ee589]](https://git.sudo.ws/sudo/commit/?id=24d5ee589)

* src/limits.c:

  Use correct size for curlim and maxlim.
  [[010634303]](https://git.sudo.ws/sudo/commit/?id=010634303)

* configure, configure.ac, doc/Makefile.in:

  Only install man pages for logsrvd and python plugin if we build them.
  [GitHub issue #58](https://github.com/sudo-project/sudo/issues/58)
  [[049430ee5]](https://git.sudo.ws/sudo/commit/?id=049430ee5)

* Makefile.in, configure, configure.ac, doc/Makefile.in:

  Remove obsolete mansrcdir variable, add \_SRC suffix to LOGSRV and
  LOGSRVD
  [[21a2dce50]](https://git.sudo.ws/sudo/commit/?id=21a2dce50)

2020-09-02 Todd C. Miller

* logsrvd/eventlog.c, plugins/sudoers/logging.c:

  If the command was run in a chroot, add it to the log.
  [[fd06e588e]](https://git.sudo.ws/sudo/commit/?id=fd06e588e)

* logsrvd/eventlog.c, logsrvd/iolog\_writer.c, plugins/sudoers/logging.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Log the runcwd not submitcwd in the sudo-style log file. The log entry
  should reflect the working directory the command actually ran in.
  [[226307591]](https://git.sudo.ws/sudo/commit/?id=226307591)

* MANIFEST, plugins/sudoers/regress/testsudoers/test12.out.ok,
  plugins/sudoers/regress/testsudoers/test12.sh:

  Add test of multiple syntax errors. Where possible, the portion of the
  line before the error should be still be interpreted.
  [[a51d194a7]](https://git.sudo.ws/sudo/commit/?id=a51d194a7)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Fix error recovery in a privilege after a ‘:’ separator.
  [[578789c56]](https://git.sudo.ws/sudo/commit/?id=578789c56)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Initialize runchroot and runcwd in init\_options()
  [[fc563286f]](https://git.sudo.ws/sudo/commit/?id=fc563286f)

* MANIFEST:

  Fix path to check\_exptilde.c
  [[2adde428c]](https://git.sudo.ws/sudo/commit/?id=2adde428c)

* include/log\_server.pb-c.h, include/protobuf-c/protobuf-c.h,
  lib/logsrv/protobuf-c.c:

  Update to protobuf-c 1.3.3
  [[965ad7448]](https://git.sudo.ws/sudo/commit/?id=965ad7448)

2020-09-01 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.h:

  Regenerate the parser with “bison -y” for verbose syntax error messages.
  [[e3b85171f]](https://git.sudo.ws/sudo/commit/?id=e3b85171f)

* NEWS:

  Add chroot/chdir changes.
  [[b7130775f]](https://git.sudo.ws/sudo/commit/?id=b7130775f)

* doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudo\_plugin.man.in,
  doc/sudo\_plugin.mdoc.in, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, src/parse\_args.c, src/sudo\_usage.h.in:

  Support “*” for CWD/CHROOT to allow user to specify cwd or chroot. Adds
  two new command line options, -D (–chdir) and -R (–chroot) that can
  only be used when sudoers sets runcwd or runchroot to “*”.
  [[1676f0cee]](https://git.sudo.ws/sudo/commit/?id=1676f0cee)

* include/sudo\_iolog.h, lib/iolog/iolog\_fileio.c, lib/iolog/iolog\_json.c,
  lib/iolog/iolog\_util.c, logsrvd/iolog\_writer.c, logsrvd/logsrvd.h,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h:

  Read/write runchroot and runcwd entries in the JSON event log.
  [[bd254e104]](https://git.sudo.ws/sudo/commit/?id=bd254e104)

* MANIFEST, plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/parse.c,
  plugins/sudoers/regress/sudoers/test24.in,
  plugins/sudoers/regress/sudoers/test24.json.ok,
  plugins/sudoers/regress/sudoers/test24.ldif.ok,
  plugins/sudoers/regress/sudoers/test24.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test24.out.ok,
  plugins/sudoers/regress/sudoers/test24.sudo.ok,
  plugins/sudoers/regress/sudoers/test24.toke.ok:

  Add support for runchroot and runcwd to “sudo -l” and cvtsudoers.
  [[9ff960457]](https://git.sudo.ws/sudo/commit/?id=9ff960457)

* MANIFEST, lib/util/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/exptilde.c,
  plugins/sudoers/regress/exptilde/check\_exptilde.c:

  Unit test for exptilde
  [[86513c78b]](https://git.sudo.ws/sudo/commit/?id=86513c78b)

* MANIFEST, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/exptilde.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.h, plugins/sudoers/gram.y, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/policy.c,
  plugins/sudoers/regress/sudoers/test1.toke.ok,
  plugins/sudoers/regress/sudoers/test11.toke.ok,
  plugins/sudoers/regress/sudoers/test12.toke.ok,
  plugins/sudoers/regress/sudoers/test13.toke.ok,
  plugins/sudoers/regress/sudoers/test14.toke.ok,
  plugins/sudoers/regress/sudoers/test15.toke.ok,
  plugins/sudoers/regress/sudoers/test16.toke.ok,
  plugins/sudoers/regress/sudoers/test17.toke.ok,
  plugins/sudoers/regress/sudoers/test18.toke.ok,
  plugins/sudoers/regress/sudoers/test19.toke.ok,
  plugins/sudoers/regress/sudoers/test22.toke.ok,
  plugins/sudoers/regress/sudoers/test3.toke.ok,
  plugins/sudoers/regress/sudoers/test4.toke.ok,
  plugins/sudoers/regress/sudoers/test6.toke.ok,
  plugins/sudoers/regress/sudoers/test8.toke.ok,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoers\_version.h,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Add CHROOT and CWD sudoers options. Also matching runchroot and runcwd
  Defaults settings.
  [[6bdfd010d]](https://git.sudo.ws/sudo/commit/?id=6bdfd010d)

2020-08-31 Todd C. Miller

* NEWS, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h,
  plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stdout, src/exec.c, src/limits.c, src/sudo.c, src/sudo.h:

  Pass resource limits values to the plugin in user\_info[] Sudo resets the
  resource limits early in its execution so the plugin cannot tell what
  the original limits were itself.
  [[c4a579cf8]](https://git.sudo.ws/sudo/commit/?id=c4a579cf8)

* doc/Makefile.in, doc/sudo\_logsrvd.man.in, doc/sudo\_plugin\_python.man.in,
  doc/sudo\_plugin\_python.mdoc.in, lib/logsrv/Makefile.in,
  lib/util/cfmakeraw.c, lib/util/fchmodat.c, lib/util/fstatat.c,
  lib/util/getdelim.c, lib/util/getusershell.c, lib/util/openat.c,
  lib/util/regress/getdelim/getdelim\_test.c,
  lib/util/regress/strsig/strsig\_test.c,
  lib/util/regress/strtofoo/strtobool\_test.c,
  lib/util/regress/strtofoo/strtoid\_test.c,
  lib/util/regress/strtofoo/strtomode\_test.c,
  lib/util/regress/strtofoo/strtonum\_test.c,
  lib/util/regress/vsyslog/vsyslog\_test.c, lib/util/roundup.c,
  lib/util/strtoid.c, lib/util/strtonum.c, lib/util/term.c,
  lib/util/unlinkat.c, logsrvd/Makefile.in, logsrvd/eventlog.c,
  logsrvd/iolog\_writer.c, logsrvd/logsrv\_util.c,
  plugins/python/Makefile.in, plugins/python/pyhelpers.c,
  plugins/python/pyhelpers.h, plugins/python/python\_baseplugin.c,
  plugins/python/python\_convmessage.c,
  plugins/python/python\_importblocker.c,
  plugins/python/python\_loghandler.c,
  plugins/python/python\_plugin\_approval.c,
  plugins/python/python\_plugin\_audit.c,
  plugins/python/python\_plugin\_common.c,
  plugins/python/python\_plugin\_common.h,
  plugins/python/python\_plugin\_group.c, plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_policy.c,
  plugins/python/sudo\_python\_debug.c, plugins/python/sudo\_python\_module.c,
  plugins/python/sudo\_python\_module.h, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/ldap\_conf.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse\_ldif.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/starttime.c,
  plugins/sudoers/tsdump.c, src/exec\_monitor.c, src/exec\_nopty.c,
  src/limits.c, src/ttyname.c:

  Update copyright year on some files where it was out of date.
  [[84e6e6ccf]](https://git.sudo.ws/sudo/commit/?id=84e6e6ccf)

2020-08-27 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in, doc/visudo.man.in,
  doc/visudo.mdoc.in:

  Refer to “syntax error” instead of “parse error”. This is the term the
  parser uses when there is an actual error.
  [[47ed1721b]](https://git.sudo.ws/sudo/commit/?id=47ed1721b)

* plugins/sudoers/visudo.c:

  Remove superfluous “parse error in sudoers near line N” message. The
  sudoers parser now produces better syntax error messages so we don’t
  need visudo to print its own.
  [[1b300f78d]](https://git.sudo.ws/sudo/commit/?id=1b300f78d)

* plugins/sudoers/visudo.c:

  Don’t override errorfile and errorlineno set by check\_aliases(). Now
  that alias parsing stores the file and line number, visudo can use that
  information to go to the line with an error when re-editing.
  [[03eb3d6db]](https://git.sudo.ws/sudo/commit/?id=03eb3d6db)

2020-08-25 Todd C. Miller

* config.h.in, configure, configure.ac, lib/util/sig2str.c,
  lib/util/str2sig.c:

  Use sigabbrev\_np(3) to access signal abbreviations if supported.
  glibc-2.32 has removed sys\_sigabbrev[], we can use sigabbrev\_np(3)
  instead.
  [[019f1f6b9]](https://git.sudo.ws/sudo/commit/?id=019f1f6b9)

2020-08-17 Todd C. Miller

* NEWS:

  Briefly describe how to restore historical parse error behavior.
  [[3235687d9]](https://git.sudo.ws/sudo/commit/?id=3235687d9)

* NEWS, doc/UPGRADE:

  Mention eof-of-line terminator and plugin argument changes.
  [[da5afe11b]](https://git.sudo.ws/sudo/commit/?id=da5afe11b)

* doc/sudoers.man.in, doc/sudoers.mdoc.in, src/load\_plugins.c:

  Fix sudoers\_policy plugin options when sudoers\_audit is not listed. As
  of sudo 1.9.1 the sudoers file is opened by the audit plugin, not the
  policy plugin. As a result, plugin options set for sudoers\_policy have
  no effect. If sudoers\_policy has plugin options in sudo.conf and
  sudoers\_audit is not listed, move the options to sudoers\_audit so they
  will have an effect.
  [[a3364c1e9]](https://git.sudo.ws/sudo/commit/?id=a3364c1e9)

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/file.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.h:

  sudoers error recovery can be configured via an “error\_recovery”
  setting. This setting is an argument to the sudoers plugin, similar to
  how sudoers\_file, sudoers\_mode, sudoers\_uid, etc. are implemented. The
  default value is true.
  [[609910cc2]](https://git.sudo.ws/sudo/commit/?id=609910cc2)

* plugins/sudoers/regress/testsudoers/test11.sh:

  Make this test pass with bison’s verbose error messages.
  [[360c26476]](https://git.sudo.ws/sudo/commit/?id=360c26476)

2020-08-16 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Recover from a syntax error after the ‘:’ in a privilege spec. For
  compound privilege specs, don’t throw away the entire thing if we have a
  syntax error, only the part after the error is encountered.
  [[c7bc24d40]](https://git.sudo.ws/sudo/commit/?id=c7bc24d40)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/regress/sudoers/test5.toke.ok:

  Add explicit end-of-line matching in the parser for better error
  messages. A valid line in sudoers must end in a newline or EOF.
  Previously, it was possible (though not documented) to have multiple
  user specs on a single line. Now, each must be on its own line.
  [[11803027c]](https://git.sudo.ws/sudo/commit/?id=11803027c)

* plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Add NOMATCH token and use it in the lexer for an unmatched pattern. The
  ERROR token is now only used for errors detected by the lexer and for
  which we’ve already printed an error. This lets us remove the hack in
  sudoerserror() and just check last\_token to determine whether or not to
  display the error.
  [[d72a48dc7]](https://git.sudo.ws/sudo/commit/?id=d72a48dc7)

2020-08-15 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Enable error recovery for syntax erorrs that don’t end with a newline. A
  syntax error on the last line of a sudoers file with no trailing newline
  is now recoverable.
  [[de9c77ba7]](https://git.sudo.ws/sudo/commit/?id=de9c77ba7)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/regress/testsudoers/test11.out.ok:

  Add error recovery for unexpected tokens after include/includedir.
  [[94eb14c21]](https://git.sudo.ws/sudo/commit/?id=94eb14c21)

* NEWS:

  Sudo 1.9.3 changes so far.
  [[9c258de89]](https://git.sudo.ws/sudo/commit/?id=9c258de89)

* configure, configure.ac:

  sudo 1.9.3
  [[31d41853b]](https://git.sudo.ws/sudo/commit/?id=31d41853b)

2020-08-14 Todd C. Miller

* scripts/pp:

  Format the macOS minor version number with two digits. This way we get
  consistent 4-digit version numbers even for macOS verions like 10.3 or
  11.0 where the minor number is a single digit. For example. 10.3 will be
  formatted as 1003 and 11.0 will be 1100.
  [[086aaeb44]](https://git.sudo.ws/sudo/commit/?id=086aaeb44)

2020-08-13 Todd C. Miller

* lib/zlib/infback.c, lib/zlib/inflate.c:

  Add missing ZFALLTHROUGH and use spaces not tabs.
  [[cb2eb8ea9]](https://git.sudo.ws/sudo/commit/?id=cb2eb8ea9)

* scripts/pp:

  Fix probe for macOS Big Sur “sw\_vers -productName” now returns “macOS”,
  not “Mac OS X”
  [[d12f7ccf2]](https://git.sudo.ws/sudo/commit/?id=d12f7ccf2)

2020-08-12 Todd C. Miller

* plugins/python/pyhelpers.c, plugins/python/python\_plugin\_common.h,
  plugins/python/sudo\_python\_module.c, src/parse\_args.c, src/selinux.c:

  Fix some warnings from pvs-studio
  [[a940a2c78]](https://git.sudo.ws/sudo/commit/?id=a940a2c78)

* Makefile.in, lib/iolog/iolog\_fileio.c, lib/iolog/iolog\_json.c,
  lib/util/aix.c, lib/util/sudo\_debug.c, logsrvd/logsrvd.c,
  logsrvd/sendlog.c, plugins/audit\_json/audit\_json.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/env.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/ldap.c, plugins/sudoers/ldap\_conf.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c,
  src/copy\_file.c, src/exec.c, src/exec\_common.c, src/exec\_monitor.c,
  src/exec\_nopty.c, src/exec\_pty.c, src/load\_plugins.c, src/parse\_args.c,
  src/selinux.c, src/sesh.c, src/solaris.c, src/sudo.c, src/sudo\_edit.c,
  src/tgetpass.c, src/utmp.c:

  Fix some warnings from pvs-studio
  [[961a4afe6]](https://git.sudo.ws/sudo/commit/?id=961a4afe6)

* plugins/sudoers/ldap.c, plugins/sudoers/ldap\_util.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sssd.c:

  Use angle quotes when including gram.h and def\_data.c. Otherwise, we can
  include the wrong file when doing an out-of-source build when configured
  using –with-devel.
  [[fb8ed8ba6]](https://git.sudo.ws/sudo/commit/?id=fb8ed8ba6)

* lib/util/fatal.c, lib/util/regress/fnmatch/fnm\_test.c,
  logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c, logsrvd/sendlog.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/logging.c, plugins/sudoers/match.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/visudo.c,
  src/parse\_args.c:

  Move inclusion of compat headers up with the system headers. Now that
  sudo\_dso\_public is defined in config.h we don’t need sudo\_compat.h
  before including the compat headers.
  [[cbad17a99]](https://git.sudo.ws/sudo/commit/?id=cbad17a99)

* config.h.in, configure.ac, include/compat/fnmatch.h,
  include/compat/getaddrinfo.h, include/compat/getopt.h,
  include/compat/glob.h, include/compat/sha2.h, include/sudo\_compat.h,
  include/sudo\_conf.h, include/sudo\_debug.h, include/sudo\_digest.h,
  include/sudo\_dso.h, include/sudo\_event.h, include/sudo\_fatal.h,
  include/sudo\_json.h, include/sudo\_lbuf.h, include/sudo\_rand.h,
  include/sudo\_util.h, lib/iolog/regress/host\_port/host\_port\_test.c,
  lib/iolog/regress/iolog\_json/check\_iolog\_json.c,
  lib/iolog/regress/iolog\_mkpath/check\_iolog\_mkpath.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c,
  lib/iolog/regress/iolog\_util/check\_iolog\_util.c, lib/util/mksiglist.c,
  lib/util/mksigname.c, lib/util/regress/fnmatch/fnm\_test.c,
  lib/util/regress/getdelim/getdelim\_test.c,
  lib/util/regress/getgrouplist/getgrouplist\_test.c,
  lib/util/regress/glob/globtest.c, lib/util/regress/mktemp/mktemp\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/strsig/strsig\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/strtofoo/strtobool\_test.c,
  lib/util/regress/strtofoo/strtoid\_test.c,
  lib/util/regress/strtofoo/strtomode\_test.c,
  lib/util/regress/strtofoo/strtonum\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c,
  lib/util/regress/vsyslog/vsyslog\_test.c, lib/util/term.c,
  logsrvd/logsrvd.c, logsrvd/sendlog.c, plugins/audit\_json/audit\_json.c,
  plugins/group\_file/group\_file.c, plugins/group\_file/plugin\_test.c,
  plugins/python/python\_plugin\_approval.c,
  plugins/python/python\_plugin\_audit.c,
  plugins/python/python\_plugin\_group.c, plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_policy.c, plugins/sample/sample\_plugin.c,
  plugins/sample\_approval/sample\_approval.c, plugins/sudoers/audit.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/iolog.c,
  plugins/sudoers/policy.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/parser/check\_hexchar.c,
  plugins/sudoers/regress/starttime/check\_starttime.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/tsdump.c,
  plugins/sudoers/visudo.c, plugins/system\_group/system\_group.c,
  src/env\_hooks.c, src/regress/noexec/check\_noexec.c,
  src/regress/ttyname/check\_ttyname.c, src/sesh.c, src/sudo.c,
  src/sudo\_noexec.c:

  Rename \_\_dso\_public -> sudo\_dso\_public and move to config.h.
  [[985af422d]](https://git.sudo.ws/sudo/commit/?id=985af422d)

* lib/iolog/host\_port.c, lib/iolog/iolog\_fileio.c, lib/iolog/iolog\_json.c,
  lib/iolog/iolog\_path.c, lib/iolog/iolog\_util.c, lib/util/ttyname\_dev.c,
  logsrvd/eventlog.c, logsrvd/iolog\_writer.c, logsrvd/logsrv\_util.c,
  logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c, logsrvd/sendlog.c,
  plugins/audit\_json/audit\_json.c, plugins/sample/sample\_plugin.c,
  plugins/sample\_approval/sample\_approval.c, plugins/sudoers/locale.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoreplay.c, src/net\_ifs.c,
  src/sesh.c, src/sudo.h:

  We no longer need to include sudo\_gettext.h before sudo\_compat.h
  [[076d0376d]](https://git.sudo.ws/sudo/commit/?id=076d0376d)

* .gitignore, .hgignore:

  Add \*.map to the ignore file.
  [[4b0783b0b]](https://git.sudo.ws/sudo/commit/?id=4b0783b0b)

2020-08-11 Todd C. Miller

* etc/uncrustify.cfg:

  Update to uncrustify 0.71.0
  [[4193f5482]](https://git.sudo.ws/sudo/commit/?id=4193f5482)

* doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoers.man.in,
  doc/sudoers.mdoc.in:

  Mention visudo in sudo(8) and document sudoers error recovery.
  [[71a879d90]](https://git.sudo.ws/sudo/commit/?id=71a879d90)

2020-08-10 Todd C. Miller

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/freezero.c, lib/util/getentropy.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, scripts/mkdep.pl, src/conversation.c:

  Use OpenBSD-compatible freezero() in place of explicit\_bzero() + free()
  [[ce97ca28d]](https://git.sudo.ws/sudo/commit/?id=ce97ca28d)

* MANIFEST, config.h.in, configure, configure.ac, doc/sudo\_plugin.man.in,
  doc/sudo\_plugin.mdoc.in, include/sudo\_compat.h, include/sudo\_plugin.h,
  lib/util/Makefile.in, lib/util/arc4random.c, lib/util/explicit\_bzero.c,
  lib/util/getentropy.c, lib/util/memset\_s.c, lib/util/sha2.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, scripts/mkdep.pl, src/conversation.c:

  Switch from memset\_s() -> explicit\_bzero(). memset\_s() (and all of
  Annex K) is likely to be removed from the a future version of the
  standard.
  [[cef6e3687]](https://git.sudo.ws/sudo/commit/?id=cef6e3687)

* plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Define YYERROR\_VERBOSE for bison and rename COMMENT -> ‘\n’ This
  results in better error messages when there is a parse error
  [[8a97150f5]](https://git.sudo.ws/sudo/commit/?id=8a97150f5)

* plugins/sudoers/mkdefaults:

  Some minor cleanup. Use ntuples instead of tuple\_last Strip leading and
  trailing double quotes using a single gsub() ntuples will never be zero
  so don’t bother checking No need to explicitly close files in END
  [[6702f4ac4]](https://git.sudo.ws/sudo/commit/?id=6702f4ac4)

2020-08-07 Todd C. Miller

* lib/util/event.c, plugins/sudoers/cvtsudoers\_pwutil.c,
  plugins/sudoers/defaults.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/logging.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil\_impl.c, src/selinux.c:

  Quiet some clang 10 analyzer warnings.
  [[fa5d44b8b]](https://git.sudo.ws/sudo/commit/?id=fa5d44b8b)

* logsrvd/sendlog.c:

  Refactor freeing of InfoMessage list into free\_info\_messages(). Also
  fixes a false positive from the clang analyzer.
  [[63dadad9d]](https://git.sudo.ws/sudo/commit/?id=63dadad9d)

* plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/regress/testsudoers/test11.out.ok,
  plugins/sudoers/regress/testsudoers/test11.sh:

  Require that a @include line end with a newline or EOF. We now parse
  the entire line before reading the include file. This is less surprising
  behavior and results in better error messages.
  [[5f5f28ac7]](https://git.sudo.ws/sudo/commit/?id=5f5f28ac7)

* plugins/sudoers/defaults.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/parse.c,
  plugins/sudoers/regress/sudoers/test1.out.ok,
  plugins/sudoers/regress/sudoers/test10.out.ok,
  plugins/sudoers/regress/sudoers/test11.out.ok,
  plugins/sudoers/regress/sudoers/test12.out.ok,
  plugins/sudoers/regress/sudoers/test13.out.ok,
  plugins/sudoers/regress/sudoers/test14.out.ok,
  plugins/sudoers/regress/sudoers/test15.out.ok,
  plugins/sudoers/regress/sudoers/test16.out.ok,
  plugins/sudoers/regress/sudoers/test17.out.ok,
  plugins/sudoers/regress/sudoers/test18.out.ok,
  plugins/sudoers/regress/sudoers/test18.toke.ok,
  plugins/sudoers/regress/sudoers/test19.out.ok,
  plugins/sudoers/regress/sudoers/test2.out.ok,
  plugins/sudoers/regress/sudoers/test20.out.ok,
  plugins/sudoers/regress/sudoers/test21.out.ok,
  plugins/sudoers/regress/sudoers/test22.out.ok,
  plugins/sudoers/regress/sudoers/test23.out.ok,
  plugins/sudoers/regress/sudoers/test3.out.ok,
  plugins/sudoers/regress/sudoers/test4.out.ok,
  plugins/sudoers/regress/sudoers/test4.toke.ok,
  plugins/sudoers/regress/sudoers/test5.out.ok,
  plugins/sudoers/regress/sudoers/test5.toke.ok,
  plugins/sudoers/regress/sudoers/test6.out.ok,
  plugins/sudoers/regress/sudoers/test7.out.ok,
  plugins/sudoers/regress/sudoers/test7.toke.ok,
  plugins/sudoers/regress/sudoers/test8.out.ok,
  plugins/sudoers/regress/sudoers/test8.toke.ok,
  plugins/sudoers/regress/sudoers/test9.out.ok,
  plugins/sudoers/regress/testsudoers/test1.out.ok,
  plugins/sudoers/regress/testsudoers/test10.out.ok,
  plugins/sudoers/regress/testsudoers/test11.out.ok,
  plugins/sudoers/regress/testsudoers/test2.out.ok,
  plugins/sudoers/regress/testsudoers/test3.out.ok,
  plugins/sudoers/regress/testsudoers/test4.out.ok,
  plugins/sudoers/regress/testsudoers/test5.out.ok,
  plugins/sudoers/regress/testsudoers/test6.out.ok,
  plugins/sudoers/regress/testsudoers/test7.out.ok,
  plugins/sudoers/regress/testsudoers/test8.out.ok,
  plugins/sudoers/regress/testsudoers/test9.out.ok,
  plugins/sudoers/regress/visudo/test2.err.ok,
  plugins/sudoers/regress/visudo/test3.err.ok,
  plugins/sudoers/regress/visudo/test8.err.ok,
  plugins/sudoers/regress/visudo/test8.sh, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/visudo.c:

  Display more specific parser error messages when possible.
  [[3235e4353]](https://git.sudo.ws/sudo/commit/?id=3235e4353)

* plugins/sudoers/file.c:

  Let the sudoers parser recover after a parse error. We currently just
  discard the line with the error.
  [[7c342e586]](https://git.sudo.ws/sudo/commit/?id=7c342e586)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/regress/testsudoers/test11.out.ok,
  plugins/sudoers/toke.c, plugins/sudoers/toke.h, plugins/sudoers/toke.l:

  Keep track of the position of the current token for error messages.
  [[91cc68d7f]](https://git.sudo.ws/sudo/commit/?id=91cc68d7f)

2020-08-06 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/regress/testsudoers/test11.out.ok,
  plugins/sudoers/toke.c, plugins/sudoers/toke.h, plugins/sudoers/toke.l:

  Store the current line in our own buffer for better error messages.
  [[99f43f8a0]](https://git.sudo.ws/sudo/commit/?id=99f43f8a0)

* plugins/sample\_approval/sample\_approval.exp:

  Sync sample\_approval.exp with sample\_approval.c
  [[03816d020]](https://git.sudo.ws/sudo/commit/?id=03816d020)

* plugins/sudoers/Makefile.in:

  regen
  [[a8bfeba58]](https://git.sudo.ws/sudo/commit/?id=a8bfeba58)

2020-08-05 Todd C. Miller

* etc/sudo-logsrvd.pp, etc/sudo.pp, scripts/mkpkg:

  Fix libssl dependency on Debian-based systems. Older systems may still
  have libssl1.0.0, not libssl1.1.
  [[c90539015]](https://git.sudo.ws/sudo/commit/?id=c90539015)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Add workaround for yyless() not resetting yy\_at\_bol.
  [[2a58b19f9]](https://git.sudo.ws/sudo/commit/?id=2a58b19f9)

2020-08-03 Todd C. Miller

* configure, configure.ac:

  Always use a linker script to hide symbols if it is supported. We use
  this even if the compiler has symbol visibility support so we will
  notice mismatches between the exports file and \_\_dso\_public annotations
  in the source code.
  [[4bc70c02c]](https://git.sudo.ws/sudo/commit/?id=4bc70c02c)

* MANIFEST, configure, configure.ac, plugins/python/python\_plugin.exp:

  Rename python\_plugin.exp.in -> python\_plugin.exp There is nothing
  dynamic in this file.
  [[38e28dcbf]](https://git.sudo.ws/sudo/commit/?id=38e28dcbf)

* MANIFEST, configure, configure.ac, plugins/python/python\_plugin.exp.in,
  plugins/python/python\_plugin\_approval\_multi.inc,
  plugins/python/python\_plugin\_audit\_multi.inc:

  Add missing python\_plugin.exp.in file and remove unneeded \_\_dso\_public
  This fixes building the python plugin on systems where the compiler
  doesn’t support symbol hiding (but wherethe linker does).
  [[3b4d4ab8d]](https://git.sudo.ws/sudo/commit/?id=3b4d4ab8d)

2020-08-02 Todd C. Miller

* plugins/sudoers/mkdefaults:

  Use “foo in bar” syntax for testing existence of a key.
  [[974f833e1]](https://git.sudo.ws/sudo/commit/?id=974f833e1)

* plugins/sudoers/Makefile.in, plugins/sudoers/toke.c:

  Replace /*FALLTHROUGH*/ in generated code.
  [[838255bb8]](https://git.sudo.ws/sudo/commit/?id=838255bb8)

2020-08-01 Todd C. Miller

* lib/zlib/infback.c, lib/zlib/inflate.c, lib/zlib/zconf.h.in:

  Add ZFALLTHROUGH macro to use instead of /\* FALLTHROUGH \*/ comments.
  [[c87a47735]](https://git.sudo.ws/sudo/commit/?id=c87a47735)

* config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/arc4random\_buf.c, lib/util/glob.c, lib/util/snprintf.c,
  lib/util/strtonum.c, logsrvd/sendlog.c, plugins/python/pyhelpers.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/check.c,
  plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/defaults.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/ldap\_util.c,
  plugins/sudoers/match.c, plugins/sudoers/parse\_ldif.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudo\_printf.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/visudo.c, src/conversation.c, src/exec\_monitor.c,
  src/exec\_pty.c, src/parse\_args.c, src/regress/noexec/check\_noexec.c,
  src/tgetpass.c:

  Use the fallthrough attribute instead of /\* FALLTHROUGH \*/ comments.
  [[03ad96e44]](https://git.sudo.ws/sudo/commit/?id=03ad96e44)

2020-07-30 Todd C. Miller

* plugins/sudoers/Makefile.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/mkdefaults:

  Rewrite mkdefaults in awk.
  [[20fd3b636]](https://git.sudo.ws/sudo/commit/?id=20fd3b636)

2020-07-22 Todd C. Miller

* doc/CONTRIBUTORS:

  Update translators.
  [[feebbd6d2]](https://git.sudo.ws/sudo/commit/?id=feebbd6d2)

* doc/sudo.man.in, doc/sudo.mdoc.in, src/copy\_file.c:

  Prompt user before truncating a file to zero bytes. [Bug
  #922](https://bugzilla.sudo.ws/show_bug.cgi?id=922).
  [[6ee98cf45]](https://git.sudo.ws/sudo/commit/?id=6ee98cf45)

2020-07-19 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt.mo, plugins/sudoers/po/pt.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/ro.mo, plugins/sudoers/po/ro.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/cs.mo,
  po/cs.po, po/de.mo, po/de.po, po/eo.mo, po/eo.po, po/ja.mo, po/ja.po,
  po/ko.mo, po/ko.po, po/pl.mo, po/pl.po, po/pt.mo, po/pt.po, po/pt\_BR.mo,
  po/pt\_BR.po, po/ro.mo, po/ro.po, po/tr.mo, po/tr.po, po/uk.mo, po/uk.po,
  po/zh\_CN.mo, po/zh\_CN.po, po/zh\_TW.mo, po/zh\_TW.po:

  Updated translations from translationproject.org
  [[bcf96c153]](https://git.sudo.ws/sudo/commit/?id=bcf96c153)

2020-07-21 kuberlog

* config.h.in, configure.ac:

  configure.ac: fix documentation about lecture
  [[054939c1e]](https://git.sudo.ws/sudo/commit/?id=054939c1e)

2020-07-16 Todd C. Miller

* configure, configure.ac:

  Handle openssl where there is no separate libcrypto pkgconfig file. In
  this case, just use the full openssl libs to get the sha2 functions.
  [[bd24a322c]](https://git.sudo.ws/sudo/commit/?id=bd24a322c)

* INSTALL, configure, configure.ac:

  Ignore –enable-gcrypt if –enable-openssl is also specified.
  [[10f8bb639]](https://git.sudo.ws/sudo/commit/?id=10f8bb639)

2020-07-15 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.2
  [[6a9ed1998]](https://git.sudo.ws/sudo/commit/?id=6a9ed1998)

* config.h.in, configure, configure.ac:

  Fix some warnings displayed by autoconf 2.69b This fixes the missing
  HAVE\_GSSAPI\_GSSAPI\_H define in config.h.in. TODO: replace shadow\_funcs
  variable in function checks with literals
  [[be89bdcf7]](https://git.sudo.ws/sudo/commit/?id=be89bdcf7)

2020-07-12 Todd C. Miller

* plugins/sudoers/audit.c:

  Initialize sudo\_conv and sudo\_printf in sudoers\_audit\_open(). We will
  need them if there is an error parsing sudoers and leaving them unset
  can result in NULL deref. Also set the text domain to “sudoers” like we
  do for the policy and I/O logging open functions. [Bug
  #934](https://bugzilla.sudo.ws/show_bug.cgi?id=934).
  [[ac00a0701]](https://git.sudo.ws/sudo/commit/?id=ac00a0701)

2020-07-11 Todd C. Miller

* plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/ro.mo, plugins/sudoers/po/ro.po, po/it.mo, po/it.po,
  po/ko.mo, po/ko.po, po/ro.mo, po/ro.po:

  Updated translations from translationproject.org
  [[1e4ce8525]](https://git.sudo.ws/sudo/commit/?id=1e4ce8525)

2020-07-06 Todd C. Miller

* plugins/sudoers/sudoers.exp:

  Export sudoers\_audit symbol for compilers without symbol visibility.
  [[b9ad3704d]](https://git.sudo.ws/sudo/commit/?id=b9ad3704d)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document the contents of the log.json file.
  [[d6bc75e1e]](https://git.sudo.ws/sudo/commit/?id=d6bc75e1e)

* lib/iolog/iolog\_fileio.c:

  Fix typo, runas\_uid should be runas\_gid.
  [[3175049e4]](https://git.sudo.ws/sudo/commit/?id=3175049e4)

* examples/sudo.conf.in:

  Add sudoers\_audit line for completeness, matching the documentation.
  When sudoers is loaded as a policy plugin, it will be loaded
  automatically as an audit plugin. Listing it explicitly in the default
  sudo.conf file helps bring attention to the fact that sudoers now
  supports the audit plugin type.
  [[90dbdf8f3]](https://git.sudo.ws/sudo/commit/?id=90dbdf8f3)

* plugins/sudoers/defaults.c:

  Add some debugging statements around Defaults lookup.
  [[e9a39c149]](https://git.sudo.ws/sudo/commit/?id=e9a39c149)

* plugins/sudoers/sudoers.in:

  Replace #includedir with @includedir in default sudoers file.
  [[660738139]](https://git.sudo.ws/sudo/commit/?id=660738139)

2020-06-26 Todd C. Miller

* configure, m4/libtool.m4:

  Allow HP-UX share libs and modules to link against static libs. hppa64
  and ia64 use PIC by default
  [[9ef09595f]](https://git.sudo.ws/sudo/commit/?id=9ef09595f)

2020-06-25 Todd C. Miller

* configure, configure.ac:

  Use pkg-config to find the openssl cflags and libs if possible. We
  support linking against static openssl libs too.
  [[4cadd5495]](https://git.sudo.ws/sudo/commit/?id=4cadd5495)

2020-06-24 Todd C. Miller

* scripts/pp:

  Fix parsing of /etc/redhat-release on RHEL 8. RedHat dropped the word
  “server” from the release name in redhat-release which results in the
  awk script printing the wrong field. Instead of using awk, just use sed
  to pull out the version number immediately following the word “release”.
  [[d04805eec]](https://git.sudo.ws/sudo/commit/?id=d04805eec)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen without `scare quotes’
  [[820d6ae20]](https://git.sudo.ws/sudo/commit/?id=820d6ae20)

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in,
  src/parse\_args.c, src/sudo.c:

  Replace or remove use of `scare quotes’ These don’t translate well and
  look odd in many fonts.
  [[df49897bd]](https://git.sudo.ws/sudo/commit/?id=df49897bd)

2020-06-20 Todd C. Miller

* lib/zlib/infback.c, lib/zlib/inflate.c:

  Add FALLTHROUGH comments to quiet -Wimplicit-fallthrough
  [[95ba6645d]](https://git.sudo.ws/sudo/commit/?id=95ba6645d)

* src/solaris.c:

  Fix implicit fallthrough warning and add break to default cases.
  [[1cec928d1]](https://git.sudo.ws/sudo/commit/?id=1cec928d1)

* configure, configure.ac:

  Add -Wimplicit-fallthrough to –enable-warnings if available. Note that
  clang 10 has support for -Wimplicit-fallthrough in C code but doesn’t
  recognize lint-style FALLTHROUGH comments like gcc does so we can’t use
  it.
  [[5e9346d4e]](https://git.sudo.ws/sudo/commit/?id=5e9346d4e)

* configure, configure.ac, m4/ax\_func\_snprintf.m4, m4/sudo.m4:

  Fix some warnings from configure test programs.
  [[23b1ee2f4]](https://git.sudo.ws/sudo/commit/?id=23b1ee2f4)

* configure, configure.ac:

  Drop old test for -lcposix for ISC Unix.
  [[f2dce25ac]](https://git.sudo.ws/sudo/commit/?id=f2dce25ac)

2020-06-19 Todd C. Miller

* README:

  Mention sudo-blog announce list.
  [[802058b36]](https://git.sudo.ws/sudo/commit/?id=802058b36)

* NEWS:

  Bugs #860 and #917 were fixed in 1.9.0.
  [[e6d6e9ba0]](https://git.sudo.ws/sudo/commit/?id=e6d6e9ba0)

2020-06-18 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  regen to fix a typo
  [[65edf6344]](https://git.sudo.ws/sudo/commit/?id=65edf6344)

* MANIFEST, lib/iolog/Makefile.in,
  lib/iolog/regress/iolog\_mkpath/check\_iolog\_mkpath.c:

  Add regress test to catch swapids() bug when called by iolog\_mkdtemp()
  [[d4739533f]](https://git.sudo.ws/sudo/commit/?id=d4739533f)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po, po/ro.mo, po/ro.po:

  Updated translations from translationproject.org
  [[88393fc96]](https://git.sudo.ws/sudo/commit/?id=88393fc96)

2020-06-16 Todd C. Miller

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Document the order in which the plugin open/close functions are called.
  [[ce76c9fe8]](https://git.sudo.ws/sudo/commit/?id=ce76c9fe8)

* NEWS, lib/iolog/iolog\_fileio.c:

  Fix a typo that prevented swapids() from restoring the original gid.
  This led to a regression when the iolog\_file setting ends in six or more
  X’s or when the I/O logs are stored on NFS.
  [[bc6e36e94]](https://git.sudo.ws/sudo/commit/?id=bc6e36e94)

2020-06-15 Todd C. Miller

* src/exec\_monitor.c, src/exec\_pty.c, src/get\_pty.c, src/sudo.h,
  src/sudo\_exec.h:

  Replace master/slave in code with leader/follower.
  [[8bb5aedac]](https://git.sudo.ws/sudo/commit/?id=8bb5aedac)

* NEWS, doc/sudoers.man.in, doc/sudoers.mdoc.in, examples/sudoers,
  plugins/sudoers/regress/cvtsudoers/sudoers,
  plugins/sudoers/regress/cvtsudoers/sudoers.defs,
  plugins/sudoers/regress/cvtsudoers/test13.out.ok,
  plugins/sudoers/regress/cvtsudoers/test19.out.ok,
  plugins/sudoers/regress/visudo/test6.sh:

  Replace terms master and blacklist in docs and examples.
  [[f093cb2e5]](https://git.sudo.ws/sudo/commit/?id=f093cb2e5)

* NEWS:

  [Bug #929](https://bugzilla.sudo.ws/show_bug.cgi?id=929)
  [[4a3aff156]](https://git.sudo.ws/sudo/commit/?id=4a3aff156)

2020-06-14 Todd C. Miller

* src/sudo\_edit.c:

  Clean up temporary sudoedit files on success; [Bug
  #929](https://bugzilla.sudo.ws/show_bug.cgi?id=929) This is a regression
  introduced in sudo 1.9.0.
  [[bee995059]](https://git.sudo.ws/sudo/commit/?id=bee995059)

2020-06-12 Todd C. Miller

* NEWS:

  New Romanian translation
  [[ddd3b0ece]](https://git.sudo.ws/sudo/commit/?id=ddd3b0ece)

2020-06-11 Todd C. Miller

* NEWS:

  Add missing entry for the LDAP/SSSD sudoHost regression. Also add new
  Romanian translation
  [[47b2df64c]](https://git.sudo.ws/sudo/commit/?id=47b2df64c)

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt.mo, plugins/sudoers/po/pt.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/cs.mo,
  po/cs.po, po/de.mo, po/de.po, po/eo.mo, po/eo.po, po/fi.mo, po/fi.po,
  po/fr.mo, po/fr.po, po/hr.mo, po/hr.po, po/pl.mo, po/pl.po, po/pt.mo,
  po/pt.po, po/pt\_BR.mo, po/pt\_BR.po, po/sv.mo, po/sv.po, po/tr.mo,
  po/tr.po, po/uk.mo, po/uk.po, po/zh\_CN.mo, po/zh\_CN.po, po/zh\_TW.mo,
  po/zh\_TW.po:

  Updated translations from translationproject.org
  [[7f96e4537]](https://git.sudo.ws/sudo/commit/?id=7f96e4537)

* MANIFEST, doc/CONTRIBUTORS, plugins/sudoers/po/ro.mo,
  plugins/sudoers/po/ro.po, po/ro.mo, po/ro.po:

  Romanian translation from translationproject.org.
  [[d003da33d]](https://git.sudo.ws/sudo/commit/?id=d003da33d)

2020-06-07 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Fix a typo in the audit string when “sudo -E” is not allowed.
  [[852d8c795]](https://git.sudo.ws/sudo/commit/?id=852d8c795)

2020-06-06 Todd C. Miller

* plugins/python/regress/testhelpers.c:

  Check asprintf() return value.
  [[3e12b99ee]](https://git.sudo.ws/sudo/commit/?id=3e12b99ee)

* scripts/mkpkg:

  Prefer the python3 in /usr/bin on Solaris. The /opt/csw version, if it
  exists, may be a 32-bit version which we can’t link with. Also handle
  the case where the /usr/bin/python3 link is missing.
  [[a33994584]](https://git.sudo.ws/sudo/commit/?id=a33994584)

* config.h.in, configure, configure.ac, include/sudo\_compat.h:

  Declare getdelim(3) if it exists in libc but is not prototyped in
  stdio.h. This can happen on systems with a gcc packages that was built
  on and older versions of the OS where getdelim(3) was not present.
  [[48c2bd000]](https://git.sudo.ws/sudo/commit/?id=48c2bd000)

* aclocal.m4, configure, configure.ac:

  For python3-config, only use -I and -L/-l from –cflags and –ldflags
  output. Otherwise we may get other flags used to build python that
  conflict with what sudo uses.
  [[17b3f90f7]](https://git.sudo.ws/sudo/commit/?id=17b3f90f7)

* scripts/mkpkg:

  Build 64-bit binaries and the python package on Solaris 11 and above. No
  longer prefer the Solaris Studio C compiler over gcc, it causes issues
  with the Python plugin.
  [[6c881477b]](https://git.sudo.ws/sudo/commit/?id=6c881477b)

* logsrvd/sendlog.c:

  Fix memory leak on error in fmt\_info\_messages().
  [[8da1f3195]](https://git.sudo.ws/sudo/commit/?id=8da1f3195)

* NEWS:

  Update for 1.9.1b1
  [[3f4de6949]](https://git.sudo.ws/sudo/commit/?id=3f4de6949)

2020-06-05 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen for sudo 1.9.1
  [[d4e92164f]](https://git.sudo.ws/sudo/commit/?id=d4e92164f)

2020-06-04 Todd C. Miller

* plugins/sudoers/audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h:

  Add basic support for reject and error audit events to sudoers. This is
  only used when logging events from plugins other than sudoers, such as
  an approval plugin. With this change, if an approval plugin rejects the
  command the denial will be logged in the sudoers log file using the
  message from the approval plugin.
  [[f047377a0]](https://git.sudo.ws/sudo/commit/?id=f047377a0)

* plugins/sudoers/bsm\_audit.c, plugins/sudoers/solaris\_audit.c,
  scripts/mkpkg:

  Fix Solaris and BSM audit warnings. Use BSM audit on Illumos, which
  lacks Solaris audit.
  [[15d93a1ca]](https://git.sudo.ws/sudo/commit/?id=15d93a1ca)

* plugins/sudoers/policy.c:

  Track whether the session was opened in sudoers. In
  sudoers\_policy\_close() only warn about being unable to run the command
  if we actually opened the session (and thus passed all approval
  plugins).
  [[a5a721593]](https://git.sudo.ws/sudo/commit/?id=a5a721593)

* src/sudo.c:

  Only display an error in the built-in policy close if command is set. If
  a policy or approval plugin denies the command, command\_details will not
  have been filled out.
  [[1198dfc93]](https://git.sudo.ws/sudo/commit/?id=1198dfc93)

* plugins/sudoers/ldap.c, plugins/sudoers/parse.c, plugins/sudoers/sssd.c:
  Avoid passing NULL to printf in match debug code for LDAP/SSSD. The file
  name in struct userspec was not set for the LDAP and SSSD backends.
  There is no actual file in this case so set the name to LDAP/SSSD. Also
  add a guard to make sure we don’t try to print NULL in
  sudoers\_lookup\_check() if name is left unset.
  [[49e43f580]](https://git.sudo.ws/sudo/commit/?id=49e43f580)

2020-06-03 Todd C. Miller

* plugins/sudoers/linux\_audit.c, plugins/sudoers/linux\_audit.h:

  Add missing const to linux\_audit\_command()’s argv function argument.
  [[b40551dc3]](https://git.sudo.ws/sudo/commit/?id=b40551dc3)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  When converting LDAP to sudoers, ignore entries with no sudoHost
  attribute. Otherwise, sudo\_ldap\_role\_to\_priv() will treat a NULL host
  list as as the “ALL” wildcard. This regression was introduced in sudo
  1.8.23, which was the first version to convert LDAP sudoRole objects to
  sudoers internal data structures. Thanks to Andreas Mueller for
  reporting and debugging this problem.
  [[73c1b0430]](https://git.sudo.ws/sudo/commit/?id=73c1b0430)

2020-06-02 Todd C. Miller

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, src/load\_plugins.c:

  Load the sudoers module as an audit plugin if loaded as a policy plugin.
  Now that logging of successful commands is performed by sudoers as an
  audit plugin we need to load sudoers\_audit if sudoers\_policy is also
  loaded. Otherwise, accpted commands will not be logged.
  [[253e041d3]](https://git.sudo.ws/sudo/commit/?id=253e041d3)

* plugins/sudoers/audit.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/bsm\_audit.h,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/policy.c, plugins/sudoers/solaris\_audit.c,
  plugins/sudoers/solaris\_audit.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Defer logging of the successful command until approval plugins have run.
  This adds audit plugin support to the sudoers module, currently only
  used for accept events. As a result, the sudoers file is now initially
  parsed as an audit plugin.
  [[b51948191]](https://git.sudo.ws/sudo/commit/?id=b51948191)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in,
  include/sudo\_plugin.h, plugins/audit\_json/audit\_json.c,
  plugins/python/sudo\_python\_module.c, src/sudo.c:

  Add support for “accept” audit events sent by the sudo front-end. With
  this change, the sudo front-end will send an “accept” audit event to the
  audit plugins after all the I/O logging plugins have been initialized.
  This can be used by an audit plugin that does not care about the result
  of the individual policy and approval plugins and only wants to receive
  a single “accept” event if all policy and approval plugins have
  succeeded. The plugin\_type argument for events sent by the front-end is
  SUDO\_FRONT\_END (0).
  [[f0dc48548]](https://git.sudo.ws/sudo/commit/?id=f0dc48548)

* src/exec\_pty.c:

  If event loop fails due to ENXIO, remove /dev/tty events and recover.
  This fixes an issue on Solaris 11.4 (and probably others) with “sudo
  reboot” when I/O logging is enabled. Previously, sudo would kill the
  command if it was still running after the event loop terminated, leaving
  the system in a half-dead state.
  [[a38070921]](https://git.sudo.ws/sudo/commit/?id=a38070921)

2020-06-01 Todd C. Miller

* src/exec\_pty.c:

  Don’t try to suspend sudo if the user’s tty has gone away. Fixes a
  problem on Solaris 11.4 (and possibly others) where sudo continually
  tries to put itself in the background after the user’s terminal has been
  revoked.
  [[592eb7ab4]](https://git.sudo.ws/sudo/commit/?id=592eb7ab4)

* src/exec\_pty.c:

  Back out WIP code that was mistakenly committed.
  [[de31e6d53]](https://git.sudo.ws/sudo/commit/?id=de31e6d53)

* scripts/mkpkg:

  Don’t enable BSM audit on Solaris 10, it is missing AUE\_sudo
  [[a0aaae554]](https://git.sudo.ws/sudo/commit/?id=a0aaae554)

* src/exec\_pty.c, src/get\_pty.c:

  On Solaris 11.4 the openpty(3) prototype lives in termios.h.
  [[ad70fb4f1]](https://git.sudo.ws/sudo/commit/?id=ad70fb4f1)

* plugins/sudoers/solaris\_audit.c:

  Add missing stdlib.h include and fix solaris\_audit\_failure() error
  return.
  [[51dc8ad83]](https://git.sudo.ws/sudo/commit/?id=51dc8ad83)

* scripts/mkpkg:

  Use Solaris audit for Solaris 11, not BSM audit. BSM audit is no longer
  supported in Solaris 11.4.
  [[e1aa76de1]](https://git.sudo.ws/sudo/commit/?id=e1aa76de1)

2020-05-26 Todd C. Miller

* src/exec.c:

  Check audit plugins for a close function too before execing command
  directly. We cannot exec the command directly if any of the policy or
  audit plugins use a close function.
  [[2dd1e1907]](https://git.sudo.ws/sudo/commit/?id=2dd1e1907)

2020-05-22 Todd C. Miller

* NEWS:

  Mention [Bug #927](https://bugzilla.sudo.ws/show_bug.cgi?id=927).
  [[d9cbb7beb]](https://git.sudo.ws/sudo/commit/?id=d9cbb7beb)

2020-05-20 Todd C. Miller

* configure, configure.ac, m4/sudo.m4:

  Add basic support for –runstatedir If the user specifies –runstatedir
  but not –with-rundir, use runstatdir as the parent directory of the
  sudo rundir.

  In the future we may deprecate –with-rundir in favor of –runstatedir
  but that will require changes for systems with no /var/run directory.
  [[026caf008]](https://git.sudo.ws/sudo/commit/?id=026caf008)

* MANIFEST, NEWS, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/regress/testsudoers/test10.out.ok,
  plugins/sudoers/regress/testsudoers/test10.sh,
  plugins/sudoers/regress/testsudoers/test11.out.ok,
  plugins/sudoers/regress/testsudoers/test11.sh,
  plugins/sudoers/regress/testsudoers/test2.out.ok,
  plugins/sudoers/regress/testsudoers/test2.sh,
  plugins/sudoers/regress/testsudoers/test3.out.ok,
  plugins/sudoers/regress/testsudoers/test3.sh,
  plugins/sudoers/regress/testsudoers/test4.sh,
  plugins/sudoers/regress/testsudoers/test5.sh,
  plugins/sudoers/regress/testsudoers/test8.out.ok,
  plugins/sudoers/regress/testsudoers/test8.sh,
  plugins/sudoers/regress/testsudoers/test9.out.ok,
  plugins/sudoers/regress/testsudoers/test9.sh,
  plugins/sudoers/sudoers\_version.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.h, plugins/sudoers/toke.l:

  Add support for @include and @includedir These are less confusing than
  #include and #includedir when the hash character is also the comment
  character.

  This commit also adds real parsing of include directives as opposed to
  the pure lexer approach used previously. As a result, it is now possible
  to include files with spaces by either using a double-quoted string or
  escaping the space characters with a backslash.
  [[741c6f274]](https://git.sudo.ws/sudo/commit/?id=741c6f274)

2020-05-19 Todd C. Miller

* lib/iolog/iolog\_fileio.c:

  In iolog\_openat() enable the write bit on pre-existing files if needed.
  This prevents problems caused by the change to strip the write bit from
  the timing file when it is finished.
  [[c63ba01e0]](https://git.sudo.ws/sudo/commit/?id=c63ba01e0)

* plugins/sudoers/visudo.c:

  In visudo check that an include file is regular file before using it.
  Avoids a generic “input in flex scanner failed” error message.
  [[7febc3913]](https://git.sudo.ws/sudo/commit/?id=7febc3913)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Fix a memory leak on error when including a file or directory.
  [[a41d7b545]](https://git.sudo.ws/sudo/commit/?id=a41d7b545)

2020-05-18 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.9.1
  [[5a69831dd]](https://git.sudo.ws/sudo/commit/?id=5a69831dd)

* doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  plugins/sudoers/sudoreplay.c:

  Add a follow option (-F) to support replaying a live session. By
  default, sudoreplay will exit when it reaches the end of the timing
  file. With the -F option, it will keep going until the timing file is
  finished and its write bit is cleared.
  [[452be1a4c]](https://git.sudo.ws/sudo/commit/?id=452be1a4c)

* include/sudo\_iolog.h, lib/iolog/iolog\_fileio.c:

  Add iolog\_clearerr() that acts like clearerr(3). Works for both
  compressed and uncompressed I/O logs.
  [[0312292e9]](https://git.sudo.ws/sudo/commit/?id=0312292e9)

* plugins/sudoers/iolog.c:

  Clear the write bit from the I/O log timing file when it is complete.
  This matches the behavior of sudo\_logsrvd.
  [[2a29daee1]](https://git.sudo.ws/sudo/commit/?id=2a29daee1)

* logsrvd/logsrvd.c, logsrvd/sendlog.c:

  Use PACKAGE\_VERSION instead of 0.1 as the client and server version.
  [[84f0ae0cb]](https://git.sudo.ws/sudo/commit/?id=84f0ae0cb)

* lib/util/Makefile.in, lib/util/aix.c, lib/util/fatal.c,
  lib/util/getusershell.c, lib/util/gidlist.c, lib/util/json.c,
  lib/util/mkdir\_parents.c, lib/util/strsignal.c, lib/util/strtoid.c,
  lib/util/strtomode.c, lib/util/strtonum.c, lib/util/sudo\_conf.c,
  lib/util/sudo\_debug.c:

  Set DEFAULT\_TEXT\_DOMAIN in lib/util’s Makefile not individual .c files.
  We no longer need to include sudo\_gettext.h before sudo\_compat.h
  [[8ef5c4cf9]](https://git.sudo.ws/sudo/commit/?id=8ef5c4cf9)

* lib/iolog/iolog\_fileio.c, lib/iolog/iolog\_json.c,
  lib/iolog/iolog\_path.c, lib/iolog/iolog\_util.c,
  lib/iolog/regress/host\_port/host\_port\_test.c,
  lib/iolog/regress/iolog\_json/check\_iolog\_json.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c,
  lib/iolog/regress/iolog\_util/check\_iolog\_util.c,
  lib/util/digest\_gcrypt.c, lib/util/event.c, lib/util/event\_select.c,
  lib/util/fnmatch.c, lib/util/getaddrinfo.c, lib/util/getcwd.c,
  lib/util/getdelim.c, lib/util/getgrouplist.c, lib/util/getopt\_long.c,
  lib/util/glob.c, lib/util/inet\_pton.c, lib/util/json.c,
  lib/util/key\_val.c, lib/util/lbuf.c, lib/util/locking.c,
  lib/util/mkdir\_parents.c, lib/util/mktemp.c, lib/util/parseln.c,
  lib/util/progname.c, lib/util/pw\_dup.c,
  lib/util/regress/fnmatch/fnm\_test.c,
  lib/util/regress/getdelim/getdelim\_test.c,
  lib/util/regress/getgrouplist/getgrouplist\_test.c,
  lib/util/regress/glob/globtest.c, lib/util/regress/mktemp/mktemp\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c,
  lib/util/regress/vsyslog/vsyslog\_test.c, lib/util/secure\_path.c,
  lib/util/sha2.c, lib/util/sig2str.c, lib/util/snprintf.c,
  lib/util/str2sig.c, lib/util/strndup.c, lib/util/strtobool.c,
  lib/util/sudo\_conf.c, lib/util/sudo\_debug.c, lib/util/sudo\_dso.c,
  lib/util/term.c, lib/util/ttyname\_dev.c, lib/util/vsyslog.c,
  plugins/audit\_json/audit\_json.c, plugins/group\_file/getgrent.c,
  plugins/group\_file/group\_file.c, plugins/python/sudo\_python\_debug.c,
  plugins/sample/sample\_plugin.c,
  plugins/sample\_approval/sample\_approval.c, plugins/sudoers/alias.c,
  plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/boottime.c,
  plugins/sudoers/check.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/defaults.c,
  plugins/sudoers/editor.c, plugins/sudoers/env.c,
  plugins/sudoers/env\_pattern.c, plugins/sudoers/filedigest.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/gentime.c, plugins/sudoers/getdate.c,
  plugins/sudoers/getdate.y, plugins/sudoers/getspwuid.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/interfaces.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path\_escapes.c, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/ldap\_util.c,
  plugins/sudoers/locale.c, plugins/sudoers/logging.c,
  plugins/sudoers/logwrap.c, plugins/sudoers/match.c,
  plugins/sudoers/match\_addr.c, plugins/sudoers/match\_command.c,
  plugins/sudoers/match\_digest.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse\_ldif.c, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/rcstr.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/parser/check\_hexchar.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sssd.c,
  plugins/sudoers/starttime.c, plugins/sudoers/strlist.c,
  plugins/sudoers/stubs.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers\_debug.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timeout.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsdump.c,
  plugins/sudoers/tsgetgrpw.c, plugins/sudoers/visudo.c,
  plugins/system\_group/system\_group.c, src/conversation.c,
  src/env\_hooks.c, src/exec.c, src/exec\_common.c, src/exec\_monitor.c,
  src/exec\_nopty.c, src/exec\_pty.c, src/get\_pty.c, src/hooks.c,
  src/limits.c, src/load\_plugins.c, src/net\_ifs.c, src/parse\_args.c,
  src/preserve\_fds.c, src/regress/noexec/check\_noexec.c,
  src/regress/ttyname/check\_ttyname.c, src/signal.c, src/sudo.c,
  src/sudo\_edit.c, src/sudo\_noexec.c, src/tcsetpgrp\_nobg.c,
  src/tgetpass.c, src/ttyname.c, src/utmp.c:

  Include string.h unconditionally and only use strings.h for
  strn?casecmp() In the pre-POSIX days BSD had strings.h, not string.h.
  Now strings.h is only used for non-ANSI string functions.
  [[446ae3f50]](https://git.sudo.ws/sudo/commit/?id=446ae3f50)

* lib/iolog/host\_port.c, lib/iolog/iolog\_fileio.c, lib/iolog/iolog\_json.c,
  lib/iolog/iolog\_path.c, lib/iolog/iolog\_util.c,
  lib/iolog/regress/host\_port/host\_port\_test.c,
  lib/iolog/regress/iolog\_json/check\_iolog\_json.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c,
  lib/iolog/regress/iolog\_util/check\_iolog\_util.c, lib/util/aix.c,
  lib/util/arc4random.c, lib/util/arc4random\_buf.c,
  lib/util/arc4random\_uniform.c, lib/util/cfmakeraw.c,
  lib/util/closefrom.c, lib/util/digest.c, lib/util/digest\_gcrypt.c,
  lib/util/digest\_openssl.c, lib/util/dup3.c, lib/util/event\_poll.c,
  lib/util/event\_select.c, lib/util/fatal.c, lib/util/fchmodat.c,
  lib/util/fnmatch.c, lib/util/fstatat.c, lib/util/getaddrinfo.c,
  lib/util/getcwd.c, lib/util/getdelim.c, lib/util/getgrouplist.c,
  lib/util/gethostname.c, lib/util/getopt\_long.c, lib/util/gettime.c,
  lib/util/getusershell.c, lib/util/gidlist.c, lib/util/glob.c,
  lib/util/isblank.c, lib/util/json.c, lib/util/key\_val.c,
  lib/util/lbuf.c, lib/util/locking.c, lib/util/logfac.c,
  lib/util/logpri.c, lib/util/memset\_s.c, lib/util/mkdir\_parents.c,
  lib/util/mksiglist.c, lib/util/mksigname.c, lib/util/mktemp.c,
  lib/util/openat.c, lib/util/parseln.c, lib/util/pipe2.c,
  lib/util/progname.c, lib/util/pw\_dup.c, lib/util/reallocarray.c,
  lib/util/regress/fnmatch/fnm\_test.c,
  lib/util/regress/getgrouplist/getgrouplist\_test.c,
  lib/util/regress/glob/globtest.c, lib/util/regress/mktemp/mktemp\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/strsig/strsig\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/strtofoo/strtobool\_test.c,
  lib/util/regress/strtofoo/strtoid\_test.c,
  lib/util/regress/strtofoo/strtomode\_test.c,
  lib/util/regress/strtofoo/strtonum\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c,
  lib/util/regress/vsyslog/vsyslog\_test.c, lib/util/roundup.c,
  lib/util/secure\_path.c, lib/util/setgroups.c, lib/util/sha2.c,
  lib/util/sig2str.c, lib/util/snprintf.c, lib/util/str2sig.c,
  lib/util/strlcat.c, lib/util/strlcpy.c, lib/util/strndup.c,
  lib/util/strsignal.c, lib/util/strsplit.c, lib/util/strtobool.c,
  lib/util/strtoid.c, lib/util/strtomode.c, lib/util/strtonum.c,
  lib/util/sudo\_conf.c, lib/util/sudo\_debug.c, lib/util/sudo\_dso.c,
  lib/util/term.c, lib/util/ttysize.c, lib/util/unlinkat.c,
  lib/util/utimens.c, lib/util/uuid.c, plugins/audit\_json/audit\_json.c,
  plugins/group\_file/getgrent.c, plugins/group\_file/group\_file.c,
  plugins/group\_file/plugin\_test.c, plugins/python/regress/testhelpers.h,
  plugins/python/sudo\_python\_debug.h, plugins/sample/sample\_plugin.c,
  plugins/sample\_approval/sample\_approval.c, plugins/sudoers/alias.c,
  plugins/sudoers/audit.c, plugins/sudoers/base64.c,
  plugins/sudoers/boottime.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/check.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/defaults.c,
  plugins/sudoers/digestname.c, plugins/sudoers/editor.c,
  plugins/sudoers/env.c, plugins/sudoers/env\_pattern.c,
  plugins/sudoers/file.c, plugins/sudoers/filedigest.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/gc.c, plugins/sudoers/gentime.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/getspwuid.c, plugins/sudoers/gmtoff.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/hexchar.c, plugins/sudoers/interfaces.c,
  plugins/sudoers/iolog\_client.c, plugins/sudoers/iolog\_path\_escapes.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/locale.c, plugins/sudoers/logging.c,
  plugins/sudoers/logwrap.c, plugins/sudoers/match.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/match\_digest.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse\_ldif.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/rcstr.c,
  plugins/sudoers/redblack.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/parser/check\_hexchar.c,
  plugins/sudoers/regress/starttime/check\_starttime.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/solaris\_audit.c,
  plugins/sudoers/sssd.c, plugins/sudoers/strlist.c,
  plugins/sudoers/stubs.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudo\_printf.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers\_debug.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/timeout.c,
  plugins/sudoers/timestamp.c, plugins/sudoers/timestr.c,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsdump.c,
  plugins/sudoers/tsgetgrpw.c, plugins/sudoers/visudo.c,
  plugins/system\_group/system\_group.c, src/conversation.c,
  src/copy\_file.c, src/env\_hooks.c, src/exec.c, src/exec\_common.c,
  src/exec\_nopty.c, src/get\_pty.c, src/hooks.c, src/limits.c,
  src/load\_plugins.c, src/openbsd.c, src/parse\_args.c, src/preload.c,
  src/preserve\_fds.c, src/selinux.c, src/sesh.c, src/signal.c,
  src/solaris.c, src/sudo\_edit.c, src/tcsetpgrp\_nobg.c, src/tgetpass.c,
  src/utmp.c:

  We no longer need to include headers we don’t use for sudo\*.h files.
  Previously we needed to include headers required by the various sudo\*h
  files. Now those files are more self-sufficient and we should only
  include headers needed by code in the various .c files.
  [[dd8846080]](https://git.sudo.ws/sudo/commit/?id=dd8846080)

* include/sudo\_compat.h, include/sudo\_conf.h, include/sudo\_debug.h,
  include/sudo\_iolog.h, include/sudo\_json.h, include/sudo\_util.h,
  plugins/sudoers/sudoers.h:

  Add dependent system includes to make sudo\_*.h more standalone. In the
  past we’ve relied on the various .c files to include the system headers
  that define types that the sudo\_*.h headers require. This is fragile and
  can cause issues when includes get re-ordered.
  [[d85d370c6]](https://git.sudo.ws/sudo/commit/?id=d85d370c6)

* plugins/sudoers/env.c:

  Fix typo in PERLIO\_DEBUG (trailing whitespace). This has no effect
  unless env\_reset is disabled. From Allan Wirth
  [[b66cf649f]](https://git.sudo.ws/sudo/commit/?id=b66cf649f)

2020-05-16 Dan Robertson

* include/sudo\_debug.h:

  Fix includes when building with musl

  Include sys/types.h for mode\_t and id\_t in sudo\_debug.h
  [[f4e9e4337]](https://git.sudo.ws/sudo/commit/?id=f4e9e4337)

2020-05-17 Sebastian Rasmussen

* plugins/sudoers/visudo.c:

  Fix typo in warning message.
  [[3d73f05e3]](https://git.sudo.ws/sudo/commit/?id=3d73f05e3)

2020-05-15 Todd C. Miller

* lib/util/mksiglist.h, lib/util/mksigname.h:

  Prefer SIGSYS if SIGUNUSED is defined to the same value. Fixes a regress
  failure on musl libc where SIGSYS and SIGUNUSED share the same value.
  [[aaea46227]](https://git.sudo.ws/sudo/commit/?id=aaea46227)

* plugins/python/regress/testhelpers.h:

  Add missing sys/wait.h include; fixes a compilation problem on musl
  libc.
  [[26b599a5b]](https://git.sudo.ws/sudo/commit/?id=26b599a5b)

* lib/iolog/hostcheck.c:

  Add missing sys/types.h include; fixes a compilation problem on musl
  libc.
  [[36bbf629b]](https://git.sudo.ws/sudo/commit/?id=36bbf629b)

* include/sudo\_compat.h:

  Only define WCONTINUED and WIFCONTINUED if neither are already defined.
  Fixes a warning on musl libc where WIFCONTINUED is defined in stdlib.h
  for some reason.
  [[ea1226be7]](https://git.sudo.ws/sudo/commit/?id=ea1226be7)

* scripts/mkpkg:

  Enable OpenSSL on RHEL 6 too. The version of OpenSSL in RHEL 6 is new
  enough for the log server to use.
  [[4ea7ecffd]](https://git.sudo.ws/sudo/commit/?id=4ea7ecffd)

* logsrvd/logsrvd\_conf.c:

  Don’t print errno for the “TLS not supported” message.
  [[1c3946e9b]](https://git.sudo.ws/sudo/commit/?id=1c3946e9b)

2020-05-14 Todd C. Miller

* etc/sudo-logsrvd.pp, etc/sudo-python.pp:

  Fix macOS bundle IDs for sudo-logsrvd and sudo-python packages
  [[3ded5cbd6]](https://git.sudo.ws/sudo/commit/?id=3ded5cbd6)

2020-05-13 Todd C. Miller

* logsrvd/eventlog.c:

  Add iolog\_path to the JSON-format event log
  [[f71b56941]](https://git.sudo.ws/sudo/commit/?id=f71b56941)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h:

  Rename FLUSHED state to FINISHED This makes more sense when receiving
  event-only logs.
  [[d2686dde0]](https://git.sudo.ws/sudo/commit/?id=d2686dde0)

2020-05-12 Todd C. Miller

* logsrvd/logsrvd.c, logsrvd/logsrvd.h:

  Fix handling of connections without associated I/O logs. This fixes
  reject events as well as accept events without the expect\_iobufs flag
  set.
  [[0337f5b73]](https://git.sudo.ws/sudo/commit/?id=0337f5b73)

* logsrvd/sendlog.c:

  Fix handling of accept and reject messages without an I/O log. Only set
  expect\_iobufs in AcceptMessage if sending I/O logs. Set state to
  FINISHED immediately after sending a RejectMessage.
  [[27355e6aa]](https://git.sudo.ws/sudo/commit/?id=27355e6aa)

* doc/sudo\_sendlog.man.in, doc/sudo\_sendlog.mdoc.in, logsrvd/sendlog.c,
  logsrvd/sendlog.h:

  Add -A and -R options to test logging of accept and reject events. If -A
  is specified, no I/O will be sent, only the accept event. For -R, a
  reject event with the specified reason is sent.
  [[d5888e274]](https://git.sudo.ws/sudo/commit/?id=d5888e274)

* configure, configure.ac:

  cfmakeraw(3) is broken on AIX, don’t use it there The cfmakeraw(3)
  function exists but does not set VMIN to 1 or VTIME to 0 in c\_cc[] in
  struct termios, which makes it useless. The AIX version also doesn’t
  clear the CSIZE and PARENB flags from c\_cflag.
  [[d3b710b0d]](https://git.sudo.ws/sudo/commit/?id=d3b710b0d)

* NEWS:

  fix pastos
  [[af0d84032]](https://git.sudo.ws/sudo/commit/?id=af0d84032)

2020-05-11 Todd C. Miller

* MANIFEST, include/sudo\_iolog.h, include/sudo\_util.h,
  lib/iolog/Makefile.in, lib/iolog/host\_port.c,
  lib/iolog/regress/host\_port/host\_port\_test.c, lib/util/Makefile.in,
  lib/util/util.exp.in, logsrvd/logsrvd\_conf.c,
  plugins/sudoers/iolog\_client.c:

  Rename sudo\_parse\_host\_port -> iolog\_parse\_host\_port and mv to
  lib/iolog It is not used outside of the I/O log client and server and
  the host:port syntax may change in the future.
  [[83d1bee91]](https://git.sudo.ws/sudo/commit/?id=83d1bee91)

* plugins/sudoers/sudoreplay.c:

  Remove duplicate inclusion of time.h
  [[fbf25112e]](https://git.sudo.ws/sudo/commit/?id=fbf25112e)

2020-05-08 Todd C. Miller

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c,
  plugins/sudoers/iolog\_client.c:

  Only enable TLS listener by default if we have a cert for it. We want
  the log server to work with the default configuration. If the default
  certificate path exists, it will be used with the default listener. If
  the user explicitly enabled a TLS listener we always attempt to use it.
  If TLS was specified but no cert file was set, the default location will
  be used (and an error will occur if the cert cannot be loaded).
  [[fc79cbc31]](https://git.sudo.ws/sudo/commit/?id=fc79cbc31)

2020-05-07 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen for 1.9.0 final
  [[3de3de8b7]](https://git.sudo.ws/sudo/commit/?id=3de3de8b7)

* logsrvd/Makefile.in:

  regen
  [[e9be26c4b]](https://git.sudo.ws/sudo/commit/?id=e9be26c4b)

* doc/sudo.man.in, doc/sudo.mdoc.in, src/parse\_args.c:

  The –preserve-env=list option may be specified more than once.
  [[92199e25c]](https://git.sudo.ws/sudo/commit/?id=92199e25c)

* doc/sudo\_logsrv.proto.man.in, doc/sudo\_logsrv.proto.mdoc.in,
  doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Quiet some warnings from igor.
  [[deb9ce7d1]](https://git.sudo.ws/sudo/commit/?id=deb9ce7d1)

* MANIFEST, Makefile.in, etc/codespell.exclude, etc/codespell.ignore,
  etc/codespell.skip:

  Plumb in codespell with a “make spell” target.
  [[7f2585ed0]](https://git.sudo.ws/sudo/commit/?id=7f2585ed0)

* configure, configure.ac, install-sh:

  Fix a few more typos.
  [[04cb06160]](https://git.sudo.ws/sudo/commit/?id=04cb06160)

2020-05-06 Todd C. Miller

* NEWS, doc/sudo.man.in, doc/sudo.mdoc.in, src/parse\_args.c:

  Don’t allow duplicate values for command line options that take an
  argument. Previously, if multiple instances of the same command line
  option were specified, the last one would be used. This meant that, for
  example, “sudo -u someuser -u otheruser id” would run the command as
  “otheruser”. This has the potential to cause problems for programs that
  run sudo with a user-specified command that do not use the “–” option
  to indicate that no more options should be processed. While this is a
  bug in the calling program, there is little downside to erroring out
  when multiple options of the same type are specified on the command
  line. [Bug #924](https://bugzilla.sudo.ws/show_bug.cgi?id=924)
  [[4266279c0]](https://git.sudo.ws/sudo/commit/?id=4266279c0)

* NEWS:

  Debian bug #734752
  [[24ad424a5]](https://git.sudo.ws/sudo/commit/?id=24ad424a5)

* src/sudo.c, src/sudo.h:

  Look up runas user by name, not euid, where possible. Fixes a problem
  when there are multiple users with the same user-ID where the PAM
  session modules could be called with the wrong user name. Debian bug
  #734752
  [[4dba87262]](https://git.sudo.ws/sudo/commit/?id=4dba87262)

* src/sesh.c:

  Fix ironic typo in spelling fixes. [Bug
  #925](https://bugzilla.sudo.ws/show_bug.cgi?id=925)
  [[ea99394fc]](https://git.sudo.ws/sudo/commit/?id=ea99394fc)

* scripts/pp:

  Sync PolyPkg from upstream.
  [[e42afc773]](https://git.sudo.ws/sudo/commit/?id=e42afc773)

* NEWS, TODO, config.h.in, configure.ac, doc/sudo\_plugin\_python.man.in,
  doc/sudo\_plugin\_python.mdoc.in, etc/sudo.pp,
  include/compat/getaddrinfo.h, include/sudo\_event.h, include/sudo\_util.h,
  lib/util/fnmatch.c, lib/util/getaddrinfo.c,
  lib/util/regress/vsyslog/vsyslog\_test.c, logsrvd/logsrvd.c,
  plugins/audit\_json/audit\_json.c, plugins/python/example\_debugging.py,
  plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/testhelpers.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_client.c, plugins/sudoers/parse.h,
  plugins/sudoers/pwutil.h, plugins/sudoers/regress/cvtsudoers/test30.sh,
  scripts/mkdep.pl, src/exec.c, src/exec\_monitor.c, src/exec\_pty.c,
  src/sesh.c:

  Apply spelling fixes. Fixes from PR #30 (ka7) and [Bug
  #925](https://bugzilla.sudo.ws/show_bug.cgi?id=925) (fossies.org
  codespell)
  [[0cf2e09e0]](https://git.sudo.ws/sudo/commit/?id=0cf2e09e0)

2020-05-05 Todd C. Miller

* Makefile.in, etc/sudo-python.pp:

  Use the proper python version in the libpython dependency on Debian. The
  configure script already detects the python version, we just need to use
  it.
  [[5d3f635ae]](https://git.sudo.ws/sudo/commit/?id=5d3f635ae)

* plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po, po/ja.mo, po/ja.po,
  po/sv.mo, po/sv.po:

  Updated translations from translationproject.org
  [[f261d58af]](https://git.sudo.ws/sudo/commit/?id=f261d58af)

* NEWS:

  [Bug #922](https://bugzilla.sudo.ws/show_bug.cgi?id=922) and Bug #923
  [[a3e94aefa]](https://git.sudo.ws/sudo/commit/?id=a3e94aefa)

2020-05-04 Todd C. Miller

* doc/sudo\_logsrv.proto.man.in, doc/sudo\_logsrv.proto.mdoc.in,
  include/log\_server.pb-c.h, lib/logsrv/log\_server.pb-c.c,
  lib/logsrv/log\_server.proto, logsrvd/logsrvd.c, logsrvd/sendlog.c,
  plugins/sudoers/iolog\_client.c:

  Add a ClientHello message that client sends to the server. This makes it
  easier to detect a plaintext client sending to a TLS port. Without this,
  the TLS server will be silent as it waits for the client to initiate the
  TLS connection.
  [[6901fc97a]](https://git.sudo.ws/sudo/commit/?id=6901fc97a)

* logsrvd/sendlog.c, plugins/sudoers/iolog\_client.c:

  Better error messages when there is a problem with the TLS connection.
  If SSL\_read, SSL\_write or SSL\_connect fails we can use the reason string
  to let the user know what the problem is.
  [[1e765e1ca]](https://git.sudo.ws/sudo/commit/?id=1e765e1ca)

* logsrvd/logsrvd.c, plugins/sudoers/iolog\_client.c:

  Warn about tls errors during startup so the user has a clue. We write
  messages to stderr until we become a daemon.
  [[1f8da42f9]](https://git.sudo.ws/sudo/commit/?id=1f8da42f9)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  doc/sudo\_sendlog.man.in, doc/sudo\_sendlog.mdoc.in, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, include/log\_server.pb-c.h,
  lib/logsrv/log\_server.pb-c.c, lib/logsrv/log\_server.proto,
  logsrvd/logsrvd.c, logsrvd/sendlog.c:

  Remove the tls parameter from the ServerHello message. The TLS
  connection is now initiated before ServerHello is received.
  [[e5f8214c0]](https://git.sudo.ws/sudo/commit/?id=e5f8214c0)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_client.c, plugins/sudoers/iolog\_plugin.h,
  plugins/sudoers/policy.c:

  Adapt sudoers iolog client to log server dual port changes. The TLS
  handshake now occurs before the ServerHello message is read. This fixes
  potential man-in-the-middle attacks and works better with TLS 1.3.
  [[8186b9820]](https://git.sudo.ws/sudo/commit/?id=8186b9820)

* doc/sudo\_logsrv.proto.man.in, doc/sudo\_logsrv.proto.mdoc.in,
  doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  examples/sudo\_logsrvd.conf, logsrvd/logsrv\_util.h, logsrvd/logsrvd.c,
  logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c, logsrvd/sendlog.c:

  Use port 30343 for plaintext and port 30344 for TLS. For TLS connections
  we now do the TLS handshake immediately before the ServerHello message.
  This lets the client recieve an alert from the server is there is a
  handshake error after the TLS connect has succeeded. It also means that
  the contents of the ServerHello are protected from a man-in-the-middle
  attack.
  [[1659d96c5]](https://git.sudo.ws/sudo/commit/?id=1659d96c5)

* include/sudo\_util.h, lib/util/host\_port.c,
  lib/util/regress/host\_port/host\_port\_test.c, logsrvd/logsrvd\_conf.c,
  plugins/sudoers/iolog\_client.c:

  Add support for a tls flag in sudo\_parse\_host\_port(). If the string
  “(tls)” appears at the end, the tls flag is set to true and the default
  tls port is used if necessary.
  [[b5a317aeb]](https://git.sudo.ws/sudo/commit/?id=b5a317aeb)

* etc/sudo.pp:

  Fix Debian ldap dependency broken in last commit.
  [[82bc05d99]](https://git.sudo.ws/sudo/commit/?id=82bc05d99)

* etc/sudo.pp:

  Fix “make package” on Debian when linux\_audit is not set.
  [[3b078b7a9]](https://git.sudo.ws/sudo/commit/?id=3b078b7a9)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  logsrvd/logsrvd\_conf.c:

  Make the default certificate and key paths match the example file.
  [[42df431ce]](https://git.sudo.ws/sudo/commit/?id=42df431ce)

* logsrvd/sendlog.c, plugins/sudoers/iolog\_client.c:

  Plug memory leaks in sudo\_sendlog
  [[7d621fc6f]](https://git.sudo.ws/sudo/commit/?id=7d621fc6f)

* lib/util/event.c, lib/util/event\_poll.c, lib/util/event\_select.c:

  Handle EAGAIN like we do ENOMEM from poll() and select(). On some
  systems, poll() and select() can return EAGAIN instead of ENOMEM if
  there is a kernel resource shortage. In this case we just re-enter the
  event loop and retry.
  [[0460008c5]](https://git.sudo.ws/sudo/commit/?id=0460008c5)

2020-05-03 Todd C. Miller

* configure, configure.ac:

  Use the –embed when running “python3-config –ldflags” if supported.
  Newer versions of python3-config only include libpython in the output
  when the –embed is used. Otherwise, “python3-config –libs” and
  “python3-config –ldflags” only list the libraries python is dependent
  on and not the python library itself.
  [[a212ee64e]](https://git.sudo.ws/sudo/commit/?id=a212ee64e)

2020-04-30 Todd C. Miller

* logsrvd/sendlog.c, plugins/sudoers/iolog\_client.c:

  On error, remove the connection with an error without freeing the
  closure. Fixes the final message at the end when there is a network
  error.
  [[aba4915b8]](https://git.sudo.ws/sudo/commit/?id=aba4915b8)

* lib/util/event\_poll.c:

  Do not call poll(2) or ppoll(2) with nfds > RLIMIT\_NOFILE. Both poll(2)
  and ppoll(2) will return EINVAL if the nfds function argument is larger
  than the max files per process resource limit. Prevent this by limiting
  the max number entries in the pfds[] array to the RLIMIT\_NOFILE soft
  limit.
  [[2b1e98657]](https://git.sudo.ws/sudo/commit/?id=2b1e98657)

2020-04-29 Todd C. Miller

* include/sudo\_event.h, lib/util/event.c:

  The timeout parameter of sudo\_ev\_add() should be const.
  [[85fe30e49]](https://git.sudo.ws/sudo/commit/?id=85fe30e49)

2020-04-28 Todd C. Miller

* plugins/sudoers/iolog\_client.c:

  Don’t free TLS on error in tls\_init(), it is freed in
  client\_closure\_free(). Fixes a double free on error introduced with the
  TLS state cleanup in client\_closure\_free().
  [[3b7768be7]](https://git.sudo.ws/sudo/commit/?id=3b7768be7)

* logsrvd/logsrvd.c:

  Check for tls\_config->dhparams\_path being non-NULL before using it.
  [[2ab8f2a73]](https://git.sudo.ws/sudo/commit/?id=2ab8f2a73)

2020-04-23 Todd C. Miller

* doc/sudo\_sendlog.man.in, doc/sudo\_sendlog.mdoc.in:

  Document the TLS and test options.
  [[79b064139]](https://git.sudo.ws/sudo/commit/?id=79b064139)

* logsrvd/sendlog.c:

  Allow -t option even without OpenSSL Also add -t to the usage message
  [[5dec0f763]](https://git.sudo.ws/sudo/commit/?id=5dec0f763)

* logsrvd/sendlog.c:

  Use sudo\_strtonum() instead of relying on strtoll(). Older, pre-C99,
  systems may not include strtoll() in their C library.
  [[0fafcf6ae]](https://git.sudo.ws/sudo/commit/?id=0fafcf6ae)

* include/protobuf-c/protobuf-c.h:

  Allow this to build on systems without stdint.h by using config.h. Old,
  pre-C99, systems may have inttypes.h but not stdint.h.
  [[b26e32f39]](https://git.sudo.ws/sudo/commit/?id=b26e32f39)

2020-04-22 Todd C. Miller

* etc/sudo-logsrvd.pp, scripts/pp:

  Fix support for pp\_systemd\_disabled and check for systemd existence. On
  our build schroots we don’t have systemctl installed but do have the
  /etc/systemd and /lib/systemd (or /usr/lib/systemd) directories.
  [[40f47f013]](https://git.sudo.ws/sudo/commit/?id=40f47f013)

* etc/sudo-logsrvd.pp:

  Set pp\_macos\_service\_id instead of pp\_macos\_default\_service\_id\_prefix.
  It is only effective to set pp\_macos\_default\_service\_id\_prefix in the
  indivisual %service sections (and not %set) so we may was well use
  pp\_macos\_service\_id which includes the service name.
  [[8c5befaae]](https://git.sudo.ws/sudo/commit/?id=8c5befaae)

* etc/sudo-logsrvd.pp:

  Set launchd service id prefix to “ws.sudo.” The default value in PolyPkg
  is “com.quest.rc.”
  [[c70606c3c]](https://git.sudo.ws/sudo/commit/?id=c70606c3c)

* scripts/pp:

  Fix macOS package creation.
  [[d5b06ff7f]](https://git.sudo.ws/sudo/commit/?id=d5b06ff7f)

2020-04-21 Todd C. Miller

* plugins/sudoers/iolog\_client.c:

  Shut down the TLS connection cleanly in client\_closure\_free(). Also free
  the SSL data which is part of the client closure.
  [[557be2b0b]](https://git.sudo.ws/sudo/commit/?id=557be2b0b)

* src/exec\_monitor.c, src/exec\_nopty.c, src/selinux.c, src/sudo.c,
  src/sudo.h, src/sudo\_edit.c, src/sudo\_exec.h:

  Fix sudoedit when running with SELinux RBAC mode. We can’t use
  run\_command() to run sesh, that will use the sudo event loop (and might
  run it in a pty!). There’s no need to relabel the tty when copying
  files. Get the path to sesh from sudo.conf.

  Currently, for SELinux RBAC, the editor runs with the target user’s
  security context. This defeats the purpose of sudoedit. Fixing that
  requires passing file descriptors between the main sudo process (running
  with the invoking user’s security context) and sesh (runnning with the
  target user’s security context).
  [[76bf9a73b]](https://git.sudo.ws/sudo/commit/?id=76bf9a73b)

* MANIFEST, src/Makefile.in, src/copy\_file.c, src/sesh.c, src/sudo\_edit.c,
  src/sudo\_exec.h:

  Refactor the sudoedit code to copy files so it can be shared. The
  SELinux sudoedit code now extends the destination file the same way the
  non-SELinux version does.
  [[009876bf3]](https://git.sudo.ws/sudo/commit/?id=009876bf3)

* src/sudo\_edit.c:

  Do not remove sudoedit temporary files if we cannot overwrite the real
  file. The warning message says the files were preserved but they
  actually got removed.
  [[0bd39701b]](https://git.sudo.ws/sudo/commit/?id=0bd39701b)

* scripts/pp:

  Only remove the systemd unit service file if we copied it manually. If
  the service file was installed as part of the package it will be removed
  automatically when the package is uninstalled.
  [[d22800edd]](https://git.sudo.ws/sudo/commit/?id=d22800edd)

* include/compat/glob.h, lib/util/glob.c:

  Make gl\_pathc, gl\_matchc and gl\_offs size\_t in glob\_t to match POSIX.
  [[99129ba41]](https://git.sudo.ws/sudo/commit/?id=99129ba41)

2020-04-20 Todd C. Miller

* doc/sudo\_logsrv.proto.man.in, doc/sudo\_logsrv.proto.mdoc.in:

  Document TLS settings in ServerHello
  [[c161f68b4]](https://git.sudo.ws/sudo/commit/?id=c161f68b4)

2020-04-17 Todd C. Miller

* src/sudo\_edit.c:

  Extend the original file before to the new size before updating it.
  Instead of opening the original file for writing w/ tuncation, we first
  extend the file with zeroes (by writing, not seeking), then overwrite
  it. This should allow sudo to fail early if the disk is out of space
  before it overwrites the original file.
  [[adb4360c4]](https://git.sudo.ws/sudo/commit/?id=adb4360c4)

* src/sudo.c:

  I/O log plugins should be closed *before* the policy plugin, not after.
  [[2a60816f7]](https://git.sudo.ws/sudo/commit/?id=2a60816f7)

* plugins/sudoers/set\_perms.c:

  Fix typo
  [[af4eb80df]](https://git.sudo.ws/sudo/commit/?id=af4eb80df)

* plugins/sudoers/iolog.c:

  Only display error string once on I/O error. We already include the
  error string in the format so no need to use errno too.
  [[132b943a2]](https://git.sudo.ws/sudo/commit/?id=132b943a2)

* plugins/sudoers/iolog.c, plugins/sudoers/policy.c:

  Free passwd and group caches in I/O plugin after log\_warning(), not
  before. The logging functions may try to use the cache via
  set\_perms(PERM\_ROOT).
  [[ae7bb1233]](https://git.sudo.ws/sudo/commit/?id=ae7bb1233)

2020-04-17 Laszlo Orban

* logsrvd/logsrvd.c:

  add missing shudown of TLS connection
  [[481427f9f]](https://git.sudo.ws/sudo/commit/?id=481427f9f)

2020-04-16 Todd C. Miller

* etc/sudo-logsrvd.pp, scripts/pp:

  Disable systemd support on Linux systems that don’t use it.
  [[a89ddb63f]](https://git.sudo.ws/sudo/commit/?id=a89ddb63f)

2020-04-14 Todd C. Miller

* configure, configure.ac:

  1.9.0 final
  [[024b146d0]](https://git.sudo.ws/sudo/commit/?id=024b146d0)

* etc/sudo-logsrvd.pp, scripts/pp:

  Update PolyPkg from my branch with systemd support.
  [[1034d3f5b]](https://git.sudo.ws/sudo/commit/?id=1034d3f5b)

2020-04-09 Todd C. Miller

* plugins/python/example\_conversation.py,
  plugins/python/example\_io\_plugin.py,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_fails\_with\_pytho
  n\_backtrace.stdout:

  If the signal.Signals enum is not present, search the dictionary. The
  Signals enum was added in Python 3.5. If it is not present we need to
  iterate over the dictionary items, looking for signal name to number
  mappings. Fixes the signal tests with Python 3.4.
  [[75b9a26a3]](https://git.sudo.ws/sudo/commit/?id=75b9a26a3)

* plugins/python/regress/check\_python\_examples.c,
  plugins/python/sudo\_python\_module.c:

  Python dictionaries are sparse so we cannot use pos as an index. When
  converting sudo options from a dictionary to a tuple we need to track
  the current index into the tuple separately from the position of the
  dictionary entry.
  [[57cef10ce]](https://git.sudo.ws/sudo/commit/?id=57cef10ce)

2020-04-08 Todd C. Miller

* etc/sudo-logsrvd.pp:

  Fix handling of /etc/sudo\_logsrvd.conf in the sudo-logsrvd package. For
  rpm and deb we include the file directly and mark it volatile. For all
  others we copy it in the postinstall script from the example dir if the
  file doesn’t already exist.
  [[324b23724]](https://git.sudo.ws/sudo/commit/?id=324b23724)

* scripts/mkpkg:

  Check for the Sun Studio C compiler on Solaris under /opt. Also
  intialize with\_python to false.
  [[eebe68233]](https://git.sudo.ws/sudo/commit/?id=eebe68233)

* po/sudo.pot:

  regen
  [[6d32858b4]](https://git.sudo.ws/sudo/commit/?id=6d32858b4)

* lib/util/parseln.c:

  Explicitly include stdio.h for getdelim(3)
  [[3bf417227]](https://git.sudo.ws/sudo/commit/?id=3bf417227)

* logsrvd/logsrvd.c:

  Reload sudo.conf upon SIGUP This makes it possible to update the Debug
  settings in sudo.conf and have them take effect on reload.
  [[ce92674cc]](https://git.sudo.ws/sudo/commit/?id=ce92674cc)

* logsrvd/logsrvd.c, logsrvd/sendlog.c, plugins/sudoers/iolog\_client.c:

  Store the result of ERR\_get\_error() so we can use it for both warn and
  debug. Otherwise, only the debug framework gets the actual error and the
  user won’t see the problem.
  [[69b6783be]](https://git.sudo.ws/sudo/commit/?id=69b6783be)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c:

  Disable IPv4-mapped IPv6 addresses in the listener. Also store the host
  + port string and use it in error messages.
    [[18ff60f6f]](https://git.sudo.ws/sudo/commit/?id=18ff60f6f)

* configure, configure.ac, examples/Makefile.in:

  Install the example sudo\_logsrvd.conf unless one already exists
  [[55eb0a633]](https://git.sudo.ws/sudo/commit/?id=55eb0a633)

2020-04-07 Todd C. Miller

* examples/sudo\_logsrvd.conf:

  Make the path to logsrvd\_cert.pem match the documentation.
  [[700becabc]](https://git.sudo.ws/sudo/commit/?id=700becabc)

* etc/sudo-logsrvd.pp, logsrvd/logsrvd.c:

  Create the pid file parent directory if it doesn’t already exist. Also
  package the run directory in the sudo\_logsrvd PolyPkg file.
  [[e86106f2e]](https://git.sudo.ws/sudo/commit/?id=e86106f2e)

* configure, configure.ac:

  Sudo 1.9.0rc1
  [[dfd5a8877]](https://git.sudo.ws/sudo/commit/?id=dfd5a8877)

* scripts/mkpkg:

  Build python packages where possible.
  [[d6684b851]](https://git.sudo.ws/sudo/commit/?id=d6684b851)

* MANIFEST, Makefile.in, configure, configure.ac, etc/sudo-logsrvd.pp,
  etc/sudo-python.pp, etc/sudo.pp:

  Split sudo\_logsrvd and the python plugin into their own packages.
  [[0a10c702b]](https://git.sudo.ws/sudo/commit/?id=0a10c702b)

* etc/sudo.pp:

  Remove bits for Tru64 kit-style packages
  [[ab18c22ab]](https://git.sudo.ws/sudo/commit/?id=ab18c22ab)

* plugins/python/Makefile.in, plugins/sudoers/Makefile.in,
  scripts/mkdep.pl:

  Handle dependencies for .h files in the same directory as the source.
  Fixes missing header dependencies for the sudoers and python plugins.
  [[6a2b5fd82]](https://git.sudo.ws/sudo/commit/?id=6a2b5fd82)

* plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c:

  Increase the maximum delay again for slower systems. Otherwise we may
  get a spurious test failure.
  [[5b488f313]](https://git.sudo.ws/sudo/commit/?id=5b488f313)

* plugins/python/pyhelpers.c, plugins/python/python\_plugin\_common.c,
  plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/iohelpers.c,
  plugins/python/regress/plugin\_approval\_test.py,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@diag.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@info.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_py\_calls@diag.lo
  g,
  plugins/python/regress/testdata/check\_example\_debugging\_py\_calls@info.lo
  g,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_validate\_inv
  alidate.log,
  plugins/python/regress/testdata/check\_loading\_fails\_wrong\_classname.stde
  rr,
  plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stdout, plugins/python/regress/testhelpers.h:

  Make most python tests pass with Python 3.4 Dictionary order is not
  stable in Python < 3.6 so we need to sort by key to have consistent
  results. The LogHandler output is also different on older Python
  versions. Also, don’t stop running python tests after the first error.
  [[cd74b83c2]](https://git.sudo.ws/sudo/commit/?id=cd74b83c2)

* plugins/python/regress/iohelpers.h,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@info.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_plugin@info.log,
  plugins/python/regress/testhelpers.c:

  Use regex to match **init**.py instead of hacking it in
  verify\_log\_lines()
  [[fa5025a56]](https://git.sudo.ws/sudo/commit/?id=fa5025a56)

* plugins/python/regress/iohelpers.h,
  plugins/python/regress/testdata/check\_example\_group\_plugin\_is\_able\_to\_de
  bug.log,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log.stor
  ed,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log\_mult
  iple1.stored,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log\_mult
  iple2.stored,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_failed\_to\_start\_
  command.stored,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_fails\_with\_pytho
  n\_backtrace.stderr,
  plugins/python/regress/testdata/check\_loading\_fails\_wrong\_path.stderr,
  plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stdout,
  plugins/python/regress/testdata/check\_python\_plugins\_do\_not\_affect\_each\_
  other.stdout, plugins/python/regress/testhelpers.h:

  Use regular expressions when matching expected and actual text.
  [[a77ef93f8]](https://git.sudo.ws/sudo/commit/?id=a77ef93f8)

* plugins/python/python\_plugin\_common.c,
  plugins/python/regress/testdata/check\_loading\_fails\_missing\_classname.st
  derr:

  Sort the list of possible plugins before printing it. This gives more
  reproducible error messages for the tests.
  [[8a2c0d784]](https://git.sudo.ws/sudo/commit/?id=8a2c0d784)

* plugins/python/example\_approval\_plugin.py,
  plugins/python/example\_audit\_plugin.py,
  plugins/python/example\_group\_plugin.py,
  plugins/python/example\_io\_plugin.py,
  plugins/python/example\_policy\_plugin.py,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_fails\_with\_pytho
  n\_backtrace.stdout:

  Avoid using typing annotations so tests run with Python 3.4.
  [[02a117f33]](https://git.sudo.ws/sudo/commit/?id=02a117f33)

* MANIFEST:

  Include all python plugin files in MANIFEST, not the directory itself.
  [[ee868776d]](https://git.sudo.ws/sudo/commit/?id=ee868776d)

2020-04-06 Robert Manner

* logsrvd/eventlog.c:

  logsrvd/eventlog.c: add a newline after each log message for logfile
  output
  [[468a5d228]](https://git.sudo.ws/sudo/commit/?id=468a5d228)

* lib/iolog/iolog\_fileio.c:

  lib/iolog/iolog\_fileio.c: do not call fchown on invalid fd

  Fixes the warning in the log: iolog\_write\_info\_file\_json: unable to
  fchown 0:0 /var/log/…: Bad file descriptor
  [[8f0370cd8]](https://git.sudo.ws/sudo/commit/?id=8f0370cd8)

* logsrvd/iolog\_writer.c:

  logsrvd/iolog\_writer.c: treat runuid, rungid 0 as valid (usually ==root)
  [[ace8e1895]](https://git.sudo.ws/sudo/commit/?id=ace8e1895)

2020-04-06 Todd C. Miller

* plugins/sudoers/iolog\_client.c:

  Don’t pass a NULL submitcwd or ttyname value to the server. It is
  possible for the cwd and/or tty to be missing. If we send a NULL pointer
  to the server where it expects a string the AcceptMessage will fail to
  parse.
  [[e31e0c4d3]](https://git.sudo.ws/sudo/commit/?id=e31e0c4d3)

* plugins/python/python\_plugin\_common.c:

  Fall back to using Py\_Finalize() for Python version < 3.6
  [[93f5e1be3]](https://git.sudo.ws/sudo/commit/?id=93f5e1be3)

* include/sudo\_plugin.h:

  Disable -Wstrict-prototypes for sudo\_hook\_fn\_t typedef.
  [[4e44bd46f]](https://git.sudo.ws/sudo/commit/?id=4e44bd46f)

2020-04-05 Todd C. Miller

* po/eo.mo, po/eo.po, po/sr.mo, po/sr.po:

  Updated translations from translationproject.org
  [[725f9f652]](https://git.sudo.ws/sudo/commit/?id=725f9f652)

2020-04-03 Todd C. Miller

* examples/Makefile.in:

  Install example sudo\_logsrvd.conf file
  [[4ee7ae647]](https://git.sudo.ws/sudo/commit/?id=4ee7ae647)

2020-04-02 Todd C. Miller

* NEWS:

  Fixed Debian bugs #571621, #596631 and #669687
  [[79d3bd822]](https://git.sudo.ws/sudo/commit/?id=79d3bd822)

2020-04-03 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Make it clear in the sudoers grammar that sudoedit needs file args.
  Debian bug #571621
  [[66c8f69f8]](https://git.sudo.ws/sudo/commit/?id=66c8f69f8)

2020-04-02 Todd C. Miller

* doc/sudo.man.in, doc/sudo.mdoc.in, plugins/sudoers/env.c:

  Truncate the command args at 4096 chars when formatting SUDO\_COMMAND. We
  have to limit the length of SUDO\_COMMAND to avoid getting E2BIG from
  execve(2) for very long argument vectors. The command’s environment also
  counts against the ARG\_MAX limit. Debian bug #596631
  [[1d008b92f]](https://git.sudo.ws/sudo/commit/?id=1d008b92f)

* plugins/sudoers/auth/pam.c:

  Do not try to delete creds we did not set. If pam\_setcred() fails when
  opening the PAM session, we don’t want to call it with PAM\_DELETE\_CRED
  when closing the session.
  [[9b8cb1a57]](https://git.sudo.ws/sudo/commit/?id=9b8cb1a57)

2020-04-01 Todd C. Miller

* plugins/sudoers/auth/API, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/check.c,
  plugins/sudoers/sudoers.h:

  Add a force flag to sudo\_auth\_cleanup() to force immediate cleanup. This
  is used for PAM authentication to make sure pam\_end() is called via
  sudo\_auth\_cleanup() when the user authenticates successfully but sudoers
  denies the command. Debian bug #669687
  [[ec3fdd3aa]](https://git.sudo.ws/sudo/commit/?id=ec3fdd3aa)

* plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c:

  Increase the maximum delay for slower systems. Otherwise we may get a
  spurious test failure.
  [[5e95c24d8]](https://git.sudo.ws/sudo/commit/?id=5e95c24d8)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Document when cwd\_optional was added.
  [[835984adc]](https://git.sudo.ws/sudo/commit/?id=835984adc)

2020-03-31 Todd C. Miller

* NEWS, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  plugins/sudoers/policy.c, src/exec.c, src/sudo.c, src/sudo.h:

  Add cwd\_optional to command details and enable it in the sudoers plugin.
  If cwd\_optional is set to true, a failure to set the cwd will be a
  warning, not an error, and the command will still run. Debian bug
  #598519
  [[93aa9f9e9]](https://git.sudo.ws/sudo/commit/?id=93aa9f9e9)

* doc/sudo.man.in, doc/sudo.mdoc.in:

  The policy close function is responsible for closing the PAM session.
  [[9dea4bb24]](https://git.sudo.ws/sudo/commit/?id=9dea4bb24)

* .clang-format:

  Config file for clang-format 8.x and higher based on webkit style. This
  approximates what I want the sudo coding style to look like. Only
  deviations from webkit style are included.
  [[8b35753a2]](https://git.sudo.ws/sudo/commit/?id=8b35753a2)

* src/exec\_pty.c:

  Don’t kill the command just because the loop exited unexpectedly. We
  currently have no good way to distinguish between an error executing the
  command and an error while the command is running.

  In the future, we should have additional status codes so we can tell
  what type of condition caused the loop to exit.

  For now, only kill the command if cstat is left uninitialized.
  [[3221c8b4d]](https://git.sudo.ws/sudo/commit/?id=3221c8b4d)

2020-03-29 Todd C. Miller

* logsrvd/logsrvd.c:

  Write process ID as an unsigned int (with a cast). On Solaris, pid\_t may
  be typedef’d as a long but the actual range is 32 bits at most.
  [[c122e9bf6]](https://git.sudo.ws/sudo/commit/?id=c122e9bf6)

* doc/LICENSE:

  Add license info for a few other files. These are all ISC licensed but
  it is still best to have them all listed in one place.
  [[d4b2db907]](https://git.sudo.ws/sudo/commit/?id=d4b2db907)

* plugins/sudoers/po/ca.mo, plugins/sudoers/po/ca.po,
  plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt.mo, plugins/sudoers/po/pt.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/ca.mo,
  po/ca.po, po/cs.mo, po/cs.po, po/de.mo, po/de.po, po/eo.mo, po/eo.po,
  po/fi.mo, po/fi.po, po/fr.mo, po/fr.po, po/hr.mo, po/hr.po, po/it.mo,
  po/it.po, po/ja.mo, po/ja.po, po/ko.mo, po/ko.po, po/nb.mo, po/nb.po,
  po/pl.mo, po/pl.po, po/pt.mo, po/pt.po, po/pt\_BR.mo, po/pt\_BR.po,
  po/sv.mo, po/sv.po, po/tr.mo, po/tr.po, po/uk.mo, po/uk.po, po/vi.mo,
  po/vi.po, po/zh\_CN.mo, po/zh\_CN.po, po/zh\_TW.mo, po/zh\_TW.po:

  Updated translations from translationproject.org
  [[5b1de6cfc]](https://git.sudo.ws/sudo/commit/?id=5b1de6cfc)

* plugins/sudoers/po/sudoers.pot:

  Update sudoers.pot with json parser warnings.
  [[0f0d03a57]](https://git.sudo.ws/sudo/commit/?id=0f0d03a57)

* etc/sudo.pp:

  Add sudo\_logsrvd as a service so it gets started at boot.
  [[891872336]](https://git.sudo.ws/sudo/commit/?id=891872336)

* configure, doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  doc/sudo\_logsrvd.man.in, doc/sudo\_logsrvd.mdoc.in,
  examples/sudo\_logsrvd.conf, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_conf.c, m4/sudo.m4, pathnames.h.in:

  Create a pidfile for sudo\_logsrvd when not run with the -n flag.
  [[f908ddd1b]](https://git.sudo.ws/sudo/commit/?id=f908ddd1b)

* logsrvd/logsrvd.c:

  sudo\_logsrvd now exits with an error if it cannot open any listen
  sockets.
  [[1b90f6560]](https://git.sudo.ws/sudo/commit/?id=1b90f6560)

* NEWS:

  Update NEWS for 1.9.0b5 changes
  [[baccc0f5c]](https://git.sudo.ws/sudo/commit/?id=baccc0f5c)

* lib/iolog/iolog\_json.c:

  Simply the JSON parsing code a bit. We can use a single stack for nested
  objects and arrays. There is also no need to track the current object
  and array separately. This allows us to remove the array special case
  when assigning a value.
  [[01ceba044]](https://git.sudo.ws/sudo/commit/?id=01ceba044)

* MANIFEST, lib/iolog/Makefile.in, lib/iolog/iolog\_json.c,
  lib/iolog/iolog\_json.h, lib/iolog/regress/iolog\_json/check\_iolog\_json.c,
  lib/iolog/regress/iolog\_json/test1.in,
  lib/iolog/regress/iolog\_json/test2.in,
  lib/iolog/regress/iolog\_json/test2.out.ok,
  lib/iolog/regress/iolog\_json/test3.in, lib/util/json.c:

  Add tests for the simple json parser.
  [[3cd9cbbad]](https://git.sudo.ws/sudo/commit/?id=3cd9cbbad)

* include/sudo\_json.h, lib/iolog/iolog\_fileio.c, lib/util/json.c,
  logsrvd/eventlog.c, logsrvd/iolog\_writer.c, logsrvd/logsrvd.h,
  plugins/audit\_json/audit\_json.c:

  Do not use JSON\_ARRAY with sudo\_json\_add\_value()
  [[cffda82e2]](https://git.sudo.ws/sudo/commit/?id=cffda82e2)

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c:

  Create files for check\_iolog\_plugin in the build dir, not src dir.
  [[f24dacdee]](https://git.sudo.ws/sudo/commit/?id=f24dacdee)

* logsrvd/iolog\_writer.c, logsrvd/logsrvd.h:

  Store runenv in the I/O log info file too.
  [[9b144069f]](https://git.sudo.ws/sudo/commit/?id=9b144069f)

* MANIFEST, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  include/sudo\_iolog.h, lib/iolog/Makefile.in, lib/iolog/iolog\_json.c,
  lib/iolog/iolog\_util.c, plugins/sudoers/sudoreplay.c:

  Parse I/O JSON info file in JSON if present. The JSON version includes
  more information than the original “log” file in the I/O log dir.
  [[056173e57]](https://git.sudo.ws/sudo/commit/?id=056173e57)

* include/sudo\_iolog.h, lib/iolog/Makefile.in, lib/iolog/iolog\_fileio.c,
  lib/iolog/iolog\_util.c, logsrvd/eventlog.c, logsrvd/iolog\_writer.c,
  logsrvd/logsrvd.h, logsrvd/sendlog.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/iolog.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudoreplay.c:

  Write an extended I/O info log in JSON format. This will be used by
  sudoreplay if it exists to get more information about the command being
  replayed.
  [[ea9b711a7]](https://git.sudo.ws/sudo/commit/?id=ea9b711a7)

* include/sudo\_iolog.h, lib/iolog/iolog\_util.c, logsrvd/sendlog.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudoreplay.c:

  iolog\_parse\_loginfo() now opens the log file itself.
  [[a644c1d1d]](https://git.sudo.ws/sudo/commit/?id=a644c1d1d)

* .gitignore, .hgignore:

  Ignore **pycache** directories.
  [[9ab8efa8f]](https://git.sudo.ws/sudo/commit/?id=9ab8efa8f)

* lib/util/getusershell.c, lib/util/host\_port.c, lib/util/roundup.c,
  logsrvd/iolog\_writer.c, logsrvd/logsrv\_util.c, logsrvd/logsrv\_util.h,
  logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  logsrvd/sendlog.c, logsrvd/sendlog.h, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h:

  Some new source files got created with my old email address.
  [[5034ea91b]](https://git.sudo.ws/sudo/commit/?id=5034ea91b)

2020-03-19 Todd C. Miller

* scripts/mkpkg:

  Enable OpenSSL on systems that can support it.
  [[a46d8bd11]](https://git.sudo.ws/sudo/commit/?id=a46d8bd11)

2020-03-17 Todd C. Miller

* config.h.in, configure, configure.ac, logsrvd/logsrvd.c:

  Add configure check for SSL\_CTX\_get0\_certificate(). Dummy out
  verify\_server\_cert() if it is not present to allow building on older
  OpenSSL versions. Rewriting this to work with old OpenSSL is not worth
  the trouble.
  [[84d9c7b24]](https://git.sudo.ws/sudo/commit/?id=84d9c7b24)

* lib/iolog/hostcheck.c:

  Include stdlib.h for malloc(3) prototype. We shouldn’t rely on it to be
  implicitly included via OpenSSL headers.
  [[d75d36b68]](https://git.sudo.ws/sudo/commit/?id=d75d36b68)

2020-03-16 Todd C. Miller

* plugins/sudoers/policy.c:

  Only set errstr for plugin API version 1.15 and above.
  [[390ace925]](https://git.sudo.ws/sudo/commit/?id=390ace925)

2020-03-14 Todd C. Miller

* NEWS:

  Sudo 1.8.31p1
  [[26097a442]](https://git.sudo.ws/sudo/commit/?id=26097a442)

* src/limits.c:

  Ignore a failure to restore the RLIMIT\_CORE resource limit. Linux
  containers don’t allow RLIMIT\_CORE to be set back to RLIM\_INFINITY if we
  set the limit to zero, even for root. This is not a problem outside the
  container.
  [[712afe031]](https://git.sudo.ws/sudo/commit/?id=712afe031)

2020-03-12 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[7ace49a33]](https://git.sudo.ws/sudo/commit/?id=7ace49a33)

* include/sudo\_event.h, lib/util/event.c:

  Add SUDO\_EV\_MASK to mask off invalid event values. Now used by
  sudo\_ev\_init() to avoid bogus events.
  [[d83c09fb6]](https://git.sudo.ws/sudo/commit/?id=d83c09fb6)

2020-03-11 Todd C. Miller

* plugins/python/regress/iohelpers.c,
  plugins/python/regress/testhelpers.c:

  Avoid using sprintf(), vsprintf(), strcat(), and strncat(). It is less
  error-prone to use functions with a return value that indicates when
  truncation ocurred.
  [[a23048bbb]](https://git.sudo.ws/sudo/commit/?id=a23048bbb)

* plugins/sudoers/match\_digest.c:

  Work around two Coverity false positives; CID 208813 208815
  [[1015b493b]](https://git.sudo.ws/sudo/commit/?id=1015b493b)

* logsrvd/logsrvd.c:

  Fix potential use-after-free; Coverity CID 208814
  [[b308b63b5]](https://git.sudo.ws/sudo/commit/?id=b308b63b5)

* plugins/python/regress/iohelpers.h,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@info.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_plugin@info.log,
  plugins/python/regress/testhelpers.c:

  Don’t hard-code path to logging/**init**.py or line numbers. Allows
  python plugin tests to success on versions other than 3.7.
  [[ec78f0689]](https://git.sudo.ws/sudo/commit/?id=ec78f0689)

* doc/LICENSE:

  Add copyright for the Python bindings.
  [[6c1b155fe]](https://git.sudo.ws/sudo/commit/?id=6c1b155fe)

* plugins/sudoers/match\_command.c:

  Fix typo introduced on systems with O\_PATH or O\_EXEC
  [[277b297ae]](https://git.sudo.ws/sudo/commit/?id=277b297ae)

* NEWS:

  Update for sudo 1.9.0
  [[d31689211]](https://git.sudo.ws/sudo/commit/?id=d31689211)

* doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/match.c,
  plugins/sudoers/match\_command.c,
  plugins/sudoers/regress/sudoers/test14.in,
  plugins/sudoers/regress/sudoers/test14.json.ok,
  plugins/sudoers/regress/sudoers/test14.ldif.ok,
  plugins/sudoers/regress/sudoers/test14.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test14.out.ok,
  plugins/sudoers/regress/sudoers/test14.toke.ok,
  plugins/sudoers/sudoers\_version.h:

  Allow the ALL keyword to be specified with a digest list.
  [[ea8445e36]](https://git.sudo.ws/sudo/commit/?id=ea8445e36)

* plugins/sudoers/ldap\_util.c, plugins/sudoers/parse\_ldif.c:

  A struct member of type ALL should have its name field set to NULL.
  [[3edd30a27]](https://git.sudo.ws/sudo/commit/?id=3edd30a27)

* doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/ldap\_util.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_command.c,
  plugins/sudoers/match\_digest.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/sudoers/test14.in,
  plugins/sudoers/regress/sudoers/test14.json.ok,
  plugins/sudoers/regress/sudoers/test14.ldif.ok,
  plugins/sudoers/regress/sudoers/test14.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test14.out.ok,
  plugins/sudoers/regress/sudoers/test14.toke.ok,
  plugins/sudoers/sudo\_ldap.h:

  Allow a list of digests to be specified for a command.
  [[4eca44324]](https://git.sudo.ws/sudo/commit/?id=4eca44324)

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Allow Cmd\_Alias in addition to Cmnd\_Alias. Some people find using
  Cmd\_Alias more natural.
  [[8c08f5ef0]](https://git.sudo.ws/sudo/commit/?id=8c08f5ef0)

2020-03-01 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/auth/pam.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c:

  Add pam\_ruser and pam\_rhost sudoers flags.
  [[e1df9d1dc]](https://git.sudo.ws/sudo/commit/?id=e1df9d1dc)

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/sendlog.c,
  logsrvd/sendlog.h:

  Store the event base in the client closure. Explicitly passing the event
  base removes the need to set a default base.
  [[f561e2caf]](https://git.sudo.ws/sudo/commit/?id=f561e2caf)

* plugins/sudoers/iolog.c:

  Revert change to initialize io\_operations earlier. Instead, check
  io\_operations.open for NULL which is the case for “sudo -V”. Also move
  the early return in sudoers\_io\_open() for “sudo -V” until after we have
  initialized debugging.
  [[bf2bc931a]](https://git.sudo.ws/sudo/commit/?id=bf2bc931a)

2020-02-28 Todd C. Miller

* plugins/sudoers/iolog.c:

  Initialize io\_operations earlier.
  [[f590f81b3]](https://git.sudo.ws/sudo/commit/?id=f590f81b3)

2020-02-27 Robert Manner

* plugins/python/example\_debugging.py,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@diag.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@info.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_plugin@err.log,
  plugins/python/regress/testdata/check\_example\_debugging\_plugin@info.log:
  plugins/python/regress: add a test and example of using the python
  logger
  [[6c9515496]](https://git.sudo.ws/sudo/commit/?id=6c9515496)

* MANIFEST, doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in,
  plugins/python/Makefile.in, plugins/python/python\_baseplugin.c,
  plugins/python/python\_convmessage.c,
  plugins/python/python\_importblocker.c,
  plugins/python/python\_loghandler.c,
  plugins/python/python\_plugin\_common.c,
  plugins/python/sudo\_python\_module.c,
  plugins/python/sudo\_python\_module.h:

  plugins/python/sudo\_module: add sudo.LogHandler

  so python log system can be used with sudo logsystem. Loggers use it by
  default (the handler is set on the root logger). If that is not the
  intent, it can be overridden explicitly.
  [[c039a99c1]](https://git.sudo.ws/sudo/commit/?id=c039a99c1)

2020-02-26 Robert Manner

* doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in,
  plugins/python/python\_plugin\_common.c,
  plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/testdata/check\_loading\_fails\_missing\_classname.st
  derr,
  plugins/python/regress/testdata/check\_loading\_succeeds\_with\_missing\_clas
  sname.stdout:

  plugins/python: autodetect ClassName field

  If “ClassName” is not specified, load the one and only sudo.Plugin from
  the module (if so), otherwise display which plugins are available from
  which the system admin can choose.
  [[34b4bb72d]](https://git.sudo.ws/sudo/commit/?id=34b4bb72d)

* doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in,
  plugins/python/Makefile.in, plugins/python/python\_plugin\_common.c:

  plugins/python/plugin\_common: add a default search path for python
  plugins

  If the ModulePath is relative, assume it is under
  “/usr/local/libexec/sudo/python” or wherever the sudo plugins are in a
  “python” subdirectory.
  [[5c96b4407]](https://git.sudo.ws/sudo/commit/?id=5c96b4407)

2020-02-27 Todd C. Miller

* plugins/sudoers/iolog\_client.c:

  Mark up some remaining TODOs
  [[34972e834]](https://git.sudo.ws/sudo/commit/?id=34972e834)

* src/conversation.c:

  Sudo’s -S option should override the SUDO\_CONV\_PREFER\_TTY flag.
  [[9c90f592c]](https://git.sudo.ws/sudo/commit/?id=9c90f592c)

* plugins/python/pyhelpers.c, plugins/python/python\_plugin\_policy.c,
  plugins/python/sudo\_python\_module.c:

  Use C99 **func** instead of gcc-specific **PRETTY\_FUNCTION**
  [[de9a143a3]](https://git.sudo.ws/sudo/commit/?id=de9a143a3)

2020-02-26 Todd C. Miller

* INSTALL, Makefile.in, config.h.in, configure, configure.ac,
  lib/iolog/iolog\_fileio.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h, plugins/sudoers/sudoers.c:

  Add –disable-log-server and –disable-log-client configure options.
  These can be used to optionally disable building sudo\_logsrvd and
  support for remote I/O logging in the sudoers plugin respectively.
  [[5635c22f6]](https://git.sudo.ws/sudo/commit/?id=5635c22f6)

2020-02-26 Robert Manner

* plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/testdata/check\_example\_audit\_plugin\_version\_displ
  ay.stdout,
  plugins/python/regress/testdata/check\_example\_debugging\_py\_calls@info.lo
  g,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_version\_display\_
  full.stdout,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_version\_disp
  lay\_full.stdout,
  plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stdout:

  plugins/python/regress: update tests for show\_version changes

  + plugin->show\_version is not marked NULL any more. - if verbose, it
    also displays which python class was loaded from which file
    [[9cc46f115]](https://git.sudo.ws/sudo/commit/?id=9cc46f115)

* plugins/python/python\_plugin\_approval.c,
  plugins/python/python\_plugin\_audit.c,
  plugins/python/python\_plugin\_common.c,
  plugins/python/python\_plugin\_common.h,
  plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_policy.c:

  plugins/python: make show\_version display the plugin in verbose mode

  Before it only displayed the plugin version, now it also displays which
  python plugin is loaded to be more useful.
  [[f387cdf53]](https://git.sudo.ws/sudo/commit/?id=f387cdf53)

* plugins/python/python\_plugin\_approval.c,
  plugins/python/python\_plugin\_common.c:

  plugins/python/approval: fix show\_version crash when it is not
  implemented

  For approval plugins show\_version is not optional.
  [[38fc37b21]](https://git.sudo.ws/sudo/commit/?id=38fc37b21)

2020-02-21 Robert Manner

* doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in:

  doc/sudo\_plugin\_python: add approval plugin to supported plugins
  [[e588879cf]](https://git.sudo.ws/sudo/commit/?id=e588879cf)

2020-02-24 Todd C. Miller

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c:

  Avoid calling sudoers\_policy\_exec\_setup() on error. We only want to pass
  the execution environment back for commands that are accepted or
  rejected. Also avoid potentially freeing the wrong pointer when garbage
  collection is enabled.
  [[f6a264e71]](https://git.sudo.ws/sudo/commit/?id=f6a264e71)

2020-02-22 Todd C. Miller

* logsrvd/eventlog.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c:

  Open event log at config time instead of open/close for each entry. If
  logging via syslog, do the openlog() at config time instead. We still
  lock the log file prior to writing to it but unlock immediately after.
  [[f40b4c288]](https://git.sudo.ws/sudo/commit/?id=f40b4c288)

* lib/util/locking.c:

  Fix unlocking of an entire file with lockf(). Since lockf() uses the
  files’s current offset, we need to seek to the start of the file to
  unlock the entire file.
  [[7e5641bc7]](https://git.sudo.ws/sudo/commit/?id=7e5641bc7)

2020-02-20 Todd C. Miller

* lib/util/util.exp.in:

  Add sudo\_json\_free\_v1 to symbol exports file too.
  [[1b930b585]](https://git.sudo.ws/sudo/commit/?id=1b930b585)

* lib/util/Makefile.in, logsrvd/Makefile.in, plugins/sudoers/Makefile.in:

  Regenerate dependencies to match the recent JSON changes.
  [[4b4db9694]](https://git.sudo.ws/sudo/commit/?id=4b4db9694)

* plugins/python/python\_convmessage.c:

  Add missing check for calloc(3) failure.
  [[4d1454eba]](https://git.sudo.ws/sudo/commit/?id=4d1454eba)

2020-02-19 Robert Manner

* doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in:

  doc/sudo\_plugin\_python: document approval plugin and PluginReject
  [[95dce8cbe]](https://git.sudo.ws/sudo/commit/?id=95dce8cbe)

* plugins/python/sudo\_python\_module.c:

  plugins/python/sudo\_python\_module.c: remove unused declaration

  We do not use structsequence any more.
  [[06b1f58e9]](https://git.sudo.ws/sudo/commit/?id=06b1f58e9)

2020-02-18 Robert Manner

* plugins/python/python\_plugin\_common.c:

  plugins/python: restore the original python inittab after interpreter
  deinit
  [[3be61db35]](https://git.sudo.ws/sudo/commit/?id=3be61db35)

2020-02-17 Robert Manner

* plugins/python/pyhelpers.c, plugins/python/pyhelpers.h,
  plugins/python/python\_plugin\_common.c,
  plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/testdata/check\_example\_debugging\_load@diag.log,
  plugins/python/regress/testhelpers.c:

  plugins/python: only deinit interpreters when sudo unlinks the plugin

  This only happens when sudo unloads the last python plugin. The reason
  doing so is because there are some python modules which does not support
  importing them again after destroying the interpreter which has imported
  them previously.

  Another solution would be to just leak the interpreters (let the kernel
  free up), but then there might be some python resources like open files
  would not get cleaned up correctly if the plugin is badly written.

  Tests are meant to test the scenario sudo does, so I have modified them
  to generally do not unlink but only a few times (~per plugin type) so it
  does not use 48 interpreters (one gets started on every plugin->open)
  and it is visible at least which type of plugin fails deinit if there is
  an error.
  [[27de7dd24]](https://git.sudo.ws/sudo/commit/?id=27de7dd24)

* plugins/python/python\_plugin\_common.c,
  plugins/python/sudo\_python\_debug.c:

  plugins/python/debug: adapt debug refcount solution of sudoers plugin
  [[8a9218d16]](https://git.sudo.ws/sudo/commit/?id=8a9218d16)

2020-02-18 Todd C. Miller

* logsrvd/logsrvd.c, logsrvd/logsrvd.h:

  Re-register listeners on SIGHUP. Previously, a config reload would
  refresh the listener address list but the changes had no effect on the
  actual addresses being listened on.
  [[a0c2de4ce]](https://git.sudo.ws/sudo/commit/?id=a0c2de4ce)

* logsrvd/logsrvd.c:

  Fix compilation error when not built with OpenSSL support. Adds a
  missing #ifdef HAVE\_OPENSSL and reorders code to avoid the need for a
  static init\_tls\_server\_context() prototype.
  [[adb3bdf6d]](https://git.sudo.ws/sudo/commit/?id=adb3bdf6d)

2020-02-17 Todd C. Miller

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  include/sudo\_json.h, lib/util/json.c, logsrvd/eventlog.c:

  Add support for JSON structured logging using syslog. Note that
  depending on the system, the default syslog buffer may not be large
  enough to store all the logging data.
  [[982c003b8]](https://git.sudo.ws/sudo/commit/?id=982c003b8)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  examples/sudo\_logsrvd.conf, logsrvd/eventlog.c, logsrvd/iolog\_writer.c,
  logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c:

  Add support for JSON logging in sudo\_logsrvd.
  [[5781a6a4c]](https://git.sudo.ws/sudo/commit/?id=5781a6a4c)

* include/sudo\_json.h, lib/util/json.c, lib/util/util.exp.in,
  plugins/audit\_json/audit\_json.c, plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/regress/sudoers/test10.json.ok,
  plugins/sudoers/regress/sudoers/test9.json.ok:

  Rework the JSON API to write to a memory buffer, not a stdio stream.
  [[8ef5b734c]](https://git.sudo.ws/sudo/commit/?id=8ef5b734c)

* logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c:

  Fix support for reloading the config in sudo\_logsrvd. We need to
  re-initialize the TLS server context. Also fix a memory leak of the TLS
  parameters on reload.
  [[25542216f]](https://git.sudo.ws/sudo/commit/?id=25542216f)

2020-02-16 Todd C. Miller

* plugins/sudoers/iolog\_client.c:

  The environment in the accept message is runenv not submitenv. The I/O
  logging plugin is passed the environment the command will run with, not
  the user’s original environment.
  [[2e836cc57]](https://git.sudo.ws/sudo/commit/?id=2e836cc57)

2020-02-15 Todd C. Miller

* include/sudo\_compat.h, lib/iolog/iolog\_fileio.c,
  plugins/audit\_json/audit\_json.c, src/utmp.c:

  Add compatibility define for fseeko(3). This is better than cluttering
  up the code with #ifdefs for obsolete systems.
  [[92e42ff54]](https://git.sudo.ws/sudo/commit/?id=92e42ff54)

2020-02-14 Todd C. Miller

* MANIFEST, plugins/sudoers/regress/testsudoers/test8.out.ok,
  plugins/sudoers/regress/testsudoers/test8.sh:

  Add test for #include directive without a trailing newline.
  [[e7bd19bd1]](https://git.sudo.ws/sudo/commit/?id=e7bd19bd1)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Don’t require a newline at the end of include or includedir directives.
  [[d2314acae]](https://git.sudo.ws/sudo/commit/?id=d2314acae)

2020-02-14 Robert Manner

* plugins/python/regress/testhelpers.c:

  plugins/python/regress/testhelpers.c: replace fromisoformat

  fromisoformat is only supported from python >=3.7
  [[8395a20a2]](https://git.sudo.ws/sudo/commit/?id=8395a20a2)

2020-02-13 Robert Manner

* plugins/python/python\_plugin\_approval.c:

  plugins/python/python\_plugin\_approval: fix negative ref count

  The python\_plugin\_api\_rc\_call function already decrements the refcount
  of py\_args. Python avoids the double free, but the error gets shown if
  using python debug build.
  [[efa97b5b9]](https://git.sudo.ws/sudo/commit/?id=efa97b5b9)

* plugins/python/python\_plugin\_common.c:

  plugins/python/python\_plugin\_common.c: release py\_args in close

  even if the arguments are not used (eg. when there is no “close” call in
  the plugin).

  It was not really a memleak, because interpreter is deinitialized
  anyway, which frees the object.
  [[a71828b38]](https://git.sudo.ws/sudo/commit/?id=a71828b38)

* plugins/python/python\_plugin\_common.h,
  plugins/python/sudo\_python\_module.c:

  plugins/python: add missing annotations to help cpychecker
  [[b2ae79c2b]](https://git.sudo.ws/sudo/commit/?id=b2ae79c2b)

2020-02-11 Robert Manner

* plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/plugin\_approval\_test.py,
  plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stderr,
  plugins/python/regress/testdata/check\_multiple\_approval\_plugin\_and\_argum
  ents.stdout, plugins/python/regress/testhelpers.c,
  plugins/python/regress/testhelpers.h:

  plugins/python/regress: add tests for approval plugin
  [[43e256e34]](https://git.sudo.ws/sudo/commit/?id=43e256e34)

* MANIFEST, plugins/python/Makefile.in,
  plugins/python/example\_approval\_plugin.py:

  plugins/python: add python approval plugin example
  [[80b3d86d6]](https://git.sudo.ws/sudo/commit/?id=80b3d86d6)

* MANIFEST, plugins/python/Makefile.in,
  plugins/python/python\_plugin\_approval.c,
  plugins/python/python\_plugin\_approval\_multi.inc,
  plugins/python/python\_plugin\_common.c,
  plugins/python/python\_plugin\_common.h,
  plugins/python/sudo\_python\_module.c:

  plugins/python: add python approval plugin wrapper
  [[23af39b00]](https://git.sudo.ws/sudo/commit/?id=23af39b00)

2020-02-12 Robert Manner

* plugins/python/regress/check\_python\_examples.c:

  plugins/python/regress: strengthen errstr verification

  Tests did not catch the issue where errstr was not set correctly, but
  its pointer contained the expected data, because the memory allocator
  reused the same space for storing the string.

  Now it is either verified to be NULL, or reset to NULL.
  [[33e7fdcae]](https://git.sudo.ws/sudo/commit/?id=33e7fdcae)

* plugins/python/regress/check\_python\_examples.c:

  plugins/python/regress: simplify plugin option creation
  [[9fa6500d6]](https://git.sudo.ws/sudo/commit/?id=9fa6500d6)

* plugins/python/python\_plugin\_audit.c,
  plugins/python/python\_plugin\_common.c,
  plugins/python/python\_plugin\_common.h,
  plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_policy.c:

  plugins/python: make storing errstr more explicit

  The error is always stored in plugin\_ctx, but it is only set into errstr
  if the API version is enough. (Previously it worked the opposite: we
  only stored the error if API level was enough.)
  [[b1d2ccecd]](https://git.sudo.ws/sudo/commit/?id=b1d2ccecd)

2020-02-11 Robert Manner

* plugins/python/python\_plugin\_common.c,
  plugins/python/sudo\_python\_module.c,
  plugins/python/sudo\_python\_module.h:

  plugins/python/sudo\_module: let a reject also supply error message

  Same as sudo.PluginError exception, have a sudo.PluginReject exception
  as well. Added common base exception as well.
  [[b16524203]](https://git.sudo.ws/sudo/commit/?id=b16524203)

2020-02-12 Robert Manner

* plugins/python/regress/check\_python\_examples.c:

  plugins/python/regress: still some memleak fix
  [[d1f94c857]](https://git.sudo.ws/sudo/commit/?id=d1f94c857)

2020-02-11 Todd C. Miller

* include/sudo\_debug.h, lib/util/sudo\_debug.c, lib/util/util.exp.in,
  plugins/audit\_json/audit\_json.c, plugins/python/sudo\_python\_debug.c,
  plugins/sample\_approval/sample\_approval.c,
  plugins/sudoers/sudoers\_debug.c:

  Move duplicated code to parse plugin debug flags to libsudo\_util.
  There’s no need for four copies of sudo\_debug\_parse\_flags().
  [[0e4c3c47d]](https://git.sudo.ws/sudo/commit/?id=0e4c3c47d)

2020-02-10 Todd C. Miller

* MANIFEST, plugins/sudoers/regress/sudoers/test23.in,
  plugins/sudoers/regress/sudoers/test23.json.ok,
  plugins/sudoers/regress/sudoers/test23.ldif.ok,
  plugins/sudoers/regress/sudoers/test23.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test23.out.ok,
  plugins/sudoers/regress/sudoers/test23.sudo.ok,
  plugins/sudoers/regress/sudoers/test23.toke.ok:

  Add regress test for parsing Defaults lists. Currently only env\_check,
  env\_delete, env\_keep and log\_servers are lists.
  [[9e2e79b6f]](https://git.sudo.ws/sudo/commit/?id=9e2e79b6f)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Clarify that approval close happens after auditing. Also fix a few
  typos.
  [[009788afa]](https://git.sudo.ws/sudo/commit/?id=009788afa)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, include/sudo\_plugin.h,
  plugins/sample\_approval/sample\_approval.c, src/sudo.c:

  Add open and close functions to the approval plugin API. We need a close
  function to be able to to free memory allocated for errstr. Unlike the
  other plugins, the close function is called immediately after the
  plugin’s check or show\_version function. The plugin does not remain open
  until the command completes.
  [[01a53f286]](https://git.sudo.ws/sudo/commit/?id=01a53f286)

* plugins/audit\_json/audit\_json.c:

  Use unique function names to avoid confusion with front-end functions.
  Also add a missing sudo\_debug\_enter() after debug registration.
  [[55b61b989]](https://git.sudo.ws/sudo/commit/?id=55b61b989)

* scripts/log2cl.pl:

  Use Text::Wrap instead of perl’s built-in format function. This still
  breaks log filename incorrectly but is a step in the right direction.
  [[3911e4f7b]](https://git.sudo.ws/sudo/commit/?id=3911e4f7b)

* Makefile.in, scripts/log2cl.pl:

  Avoid changing directory when generating the ChangeLog file. Instead,
  pass the repo path to either hg or log2cl.pl
  [[c2f3f6058]](https://git.sudo.ws/sudo/commit/?id=c2f3f6058)

2020-02-10 Robert Manner

* src/sudo.c:

  src/sudo.c: call audit plugin close when result is a wait status
  [[2781ec030]](https://git.sudo.ws/sudo/commit/?id=2781ec030)

* Makefile.in:

  Makefile.in: fix install target for out of source build

  The scriptdir contained a path relative to where the target was started.
  The scripts are called like “$scriptdir/script\_name” which is fine with
  relative path as well, until the current directory is not changed. But
  things like cd $srcdir && $scriptdir/script\_name fails (if building in
  separate build directory).
  [[0202dc67c]](https://git.sudo.ws/sudo/commit/?id=0202dc67c)

* doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in:

  doc/sudo\_plugin\_python: document python audit plugin support
  [[ecdaaffd5]](https://git.sudo.ws/sudo/commit/?id=ecdaaffd5)

* doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in:

  doc/sudo\_plugin\_python: document returning error string
  [[bd465b308]](https://git.sudo.ws/sudo/commit/?id=bd465b308)

* doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in:

  doc/sudo\_plugin\_python: update python manual for constant -> enum
  changes
  [[8f79d5c1c]](https://git.sudo.ws/sudo/commit/?id=8f79d5c1c)

2020-02-06 Robert Manner

* plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/testdata/check\_example\_audit\_plugin\_receives\_acce
  pt.stdout,
  plugins/python/regress/testdata/check\_example\_audit\_plugin\_receives\_erro
  r.stdout,
  plugins/python/regress/testdata/check\_example\_audit\_plugin\_receives\_reje
  ct.stdout,
  plugins/python/regress/testdata/check\_example\_audit\_plugin\_version\_displ
  ay.stdout,
  plugins/python/regress/testdata/check\_example\_audit\_plugin\_workflow\_mult
  iple.stderr,
  plugins/python/regress/testdata/check\_example\_audit\_plugin\_workflow\_mult
  iple.stdout:

  plugins/python/regress/check\_python\_examples: add audit\_plugin tests
  [[1a1cb5497]](https://git.sudo.ws/sudo/commit/?id=1a1cb5497)

2020-02-03 Robert Manner

* MANIFEST, plugins/python/Makefile.in,
  plugins/python/example\_audit\_plugin.py:

  plugins/python: add example python audit plugin
  [[52d067b01]](https://git.sudo.ws/sudo/commit/?id=52d067b01)

* MANIFEST, plugins/python/Makefile.in,
  plugins/python/python\_plugin\_audit.c,
  plugins/python/python\_plugin\_audit\_multi.inc,
  plugins/python/sudo\_python\_module.c:

  plugins/python: add python audit plugin wrapper
  [[cbf60cff5]](https://git.sudo.ws/sudo/commit/?id=cbf60cff5)

2020-02-06 Robert Manner

* plugins/python/example\_group\_plugin.py,
  plugins/python/example\_io\_plugin.py,
  plugins/python/example\_policy\_plugin.py,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_fails\_with\_pytho
  n\_backtrace.stdout:

  plugins/python/example\_\*.py: document returning error string
  [[bbbcb3933]](https://git.sudo.ws/sudo/commit/?id=bbbcb3933)

2020-02-05 Robert Manner

* plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/plugin\_errorstr.py:

  plugins/python/regress: add test for callback error msg return
  [[9c4f076f8]](https://git.sudo.ws/sudo/commit/?id=9c4f076f8)

* plugins/python/python\_plugin\_common.c,
  plugins/python/python\_plugin\_common.h,
  plugins/python/python\_plugin\_group.c, plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_policy.c,
  plugins/python/sudo\_python\_module.c,
  plugins/python/sudo\_python\_module.h:

  plugins/python: add support for callback errstr arguments

  Plugins can raise a sudo.PluginError exception to add context message
  for the failure.

  The callback’s errstr gets filled up with the specified message. But, as
  sudo expects a string constant (will not free the string), we store it
  in the plugin context at least until next callback invocation.
  [[3dd5f37af]](https://git.sudo.ws/sudo/commit/?id=3dd5f37af)

2020-02-06 Robert Manner

* plugins/python/example\_conversation.py,
  plugins/python/example\_debugging.py,
  plugins/python/example\_group\_plugin.py,
  plugins/python/example\_io\_plugin.py,
  plugins/python/example\_policy\_plugin.py,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@info.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_plugin@info.log,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_fails\_with\_pytho
  n\_backtrace.stdout:

  plugins/python/example\*.py: pep8 fixes (mainly line too long)
  [[45d263857]](https://git.sudo.ws/sudo/commit/?id=45d263857)

2020-02-05 Robert Manner

* plugins/python/regress/check\_python\_examples.c:

  plugins/python/regress: load/unload module for each testcase

  so they can start from clean state. (My problem was optional argument
  tests has destroyed the callbacks.)
  [[0f3631cc0]](https://git.sudo.ws/sudo/commit/?id=0f3631cc0)

2020-02-06 Robert Manner

* plugins/python/python\_plugin\_common.c,
  plugins/python/python\_plugin\_common.h,
  plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_policy.c:

  plugins/python/python\_plugin\_common: close can get custom arguments

  For the audit plugin. Ensure we do not fail if plugin\_ctx->py\_instance
  is NULL (because plugin init has failed).
  [[36694fce8]](https://git.sudo.ws/sudo/commit/?id=36694fce8)

2020-02-05 Robert Manner

* plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_policy.c:

  plugins/python\_plugin\_io,policy: fix version display in verbose mode

  Unfortunately the test did not catch this mistake, because it only
  searches that “Python policy plugin API version” string is present and
  does not check the version.
  [[a7eb9d341]](https://git.sudo.ws/sudo/commit/?id=a7eb9d341)

2020-02-06 Robert Manner

* plugins/python/sudo\_python\_module.c:

  plugins/python/sudo\_python\_module.c: fix options\_as\_dict if no equal
  sign

  The intented behaviour was that those get skipped, but the
  PyList\_GetItem sets the interpreter into error state, so python has
  raised exception.
  [[99f99e8a5]](https://git.sudo.ws/sudo/commit/?id=99f99e8a5)

2020-02-04 Robert Manner

* plugins/python/example\_conversation.py,
  plugins/python/example\_debugging.py,
  plugins/python/example\_group\_plugin.py,
  plugins/python/example\_io\_plugin.py,
  plugins/python/example\_policy\_plugin.py, plugins/python/pyhelpers.c,
  plugins/python/pyhelpers.h, plugins/python/python\_plugin\_common.c,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@diag.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@info.log
  ,
  plugins/python/regress/testdata/check\_example\_group\_plugin\_is\_able\_to\_de
  bug.log, plugins/python/sudo\_python\_module.c:

  plugins/python/sudo\_python\_module.c: use IntEnums instead of constants

  It is a bit more code, but it is more “pythonic” and easier to debug as
  the enum values also know their names.

  It is also an API break, eg. sudo.RC\_OK becomes sudo.RC.OK as sudo.RC
  will be the “type” of the enum, but I guess that is acceptable before
  the initial release.
  [[21c02e173]](https://git.sudo.ws/sudo/commit/?id=21c02e173)

2020-02-03 Robert Manner

* plugins/python/python\_plugin\_policy.c:

  plugins/python/python\_plugin\_policy: add missing debug return
  [[67ab6fd5d]](https://git.sudo.ws/sudo/commit/?id=67ab6fd5d)

2020-01-31 Robert Manner

* plugins/python/pyhelpers.c, plugins/python/pyhelpers.h,
  plugins/python/python\_convmessage.c:

  plugins/python/pyhelpers: add helpers for attribute handling

  to simplify code a bit.
  [[62524416e]](https://git.sudo.ws/sudo/commit/?id=62524416e)

2020-01-28 Robert Manner

* plugins/python/example\_io\_plugin.py,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_fails\_with\_pytho
  n\_backtrace.stdout:

  plugins/python/example\_io\_plugin: close the file at destroy

  to avoid warning of debug python build.
  [[4110800c1]](https://git.sudo.ws/sudo/commit/?id=4110800c1)

* plugins/python/Makefile.in,
  plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/testhelpers.c,
  plugins/python/regress/testhelpers.h:

  plugins/python: memleak fixes in test

  The main problem was that string array objects were constructed
  differently: - if constructed by the test, then the elements were
  constant - if constructed by the plugin, then the elements were
  allocated

  Modified it so that now each array contains allocated strings so they
  can be handled similarly. For freeing, I have used the str\_array\_free
  function from the plugin, so I have linked its object into the test
  runner.

  Happy path is now free of “definitely lost” memleaks, so the test can be
  used for valgrind.
  [[a3a7630ff]](https://git.sudo.ws/sudo/commit/?id=a3a7630ff)

2020-02-08 Todd C. Miller

* lib/iolog/regress/iolog\_path/check\_iolog\_path.c, lib/util/mksiglist.c,
  lib/util/mksigname.c, lib/util/regress/fnmatch/fnm\_test.c,
  lib/util/regress/getdelim/getdelim\_test.c,
  lib/util/regress/glob/globtest.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c, logsrvd/logsrvd.c,
  logsrvd/sendlog.c, plugins/group\_file/plugin\_test.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/logging.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/tsdump.c, plugins/sudoers/visudo.c, src/exec.c,
  src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c, src/parse\_args.c,
  src/regress/noexec/check\_noexec.c:

  Use EXIT\_SUCCESS and EXIT\_FAILURE more consistently.
  [[ac61b5655]](https://git.sudo.ws/sudo/commit/?id=ac61b5655)

* src/parse\_args.c, src/sudo.c, src/sudo.h:

  Mark main sudo usage() function **noreturn**. This splits the usage
  printing out into display\_usage().
  [[c5afbf00f]](https://git.sudo.ws/sudo/commit/?id=c5afbf00f)

* include/sudo\_json.h, lib/util/json.c, lib/util/util.exp.in,
  plugins/sudoers/cvtsudoers\_json.c:

  Use json functions from libsudo\_util in cvtsudoers.
  [[c92f39ed3]](https://git.sudo.ws/sudo/commit/?id=c92f39ed3)

2020-02-07 Todd C. Miller

* plugins/sample\_approval/sample\_approval.c:

  Check localtime() return value; coverity CID 208156
  [[d25ce46c5]](https://git.sudo.ws/sudo/commit/?id=d25ce46c5)

* plugins/audit\_json/audit\_json.c:

  Check fseeko() return value; coverity CID 207993
  [[a75992897]](https://git.sudo.ws/sudo/commit/?id=a75992897)

* logsrvd/sendlog.c, logsrvd/sendlog.h:

  Make restart and elapsed members of the closure structs not pointers.
  Fixes coverity CID 207992
  [[630fc9b17]](https://git.sudo.ws/sudo/commit/?id=630fc9b17)

* lib/iolog/iolog\_fileio.c:

  Check return value of sudo\_lock\_file(); coverity CID 207991
  [[9d5f06618]](https://git.sudo.ws/sudo/commit/?id=9d5f06618)

* logsrvd/logsrvd.c:

  Only keepalive if accept() succeeded; coverity CID 207990
  [[589adfee2]](https://git.sudo.ws/sudo/commit/?id=589adfee2)

2020-02-06 Todd C. Miller

* MANIFEST, Makefile.in, doc/Makefile.in, examples/Makefile.in,
  include/Makefile.in, lib/iolog/Makefile.in, lib/logsrv/Makefile.in,
  lib/util/Makefile.in, lib/zlib/Makefile.in, logsrvd/Makefile.in,
  plugins/audit\_json/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/python/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_approval/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, scripts/generate\_test\_coverage.sh,
  scripts/log2cl.pl, scripts/mkdep.pl, scripts/mkinstalldirs,
  scripts/mkpkg, scripts/pp, src/Makefile.in:

  Move some scripts from the top level src dir to a scripts dir.
  [[2fe127d10]](https://git.sudo.ws/sudo/commit/?id=2fe127d10)

* MANIFEST, plugins/sample\_approval/Makefile.in,
  plugins/sample\_approval/sample\_approval.c,
  plugins/sample\_approval/sample\_approval.exp:

  Add sample approval plugin that simply tests for “business hours”
  [[aa1ca9c9b]](https://git.sudo.ws/sudo/commit/?id=aa1ca9c9b)

* Makefile.in, configure, configure.ac:

  Add sample approval plugin that simply tests for “business hours”
  [[7d5734a31]](https://git.sudo.ws/sudo/commit/?id=7d5734a31)

* src/load\_plugins.c:

  Refactor code to alloc and insert a new plugin\_container. The only
  outlier is the policy plugin which is not part of a list since there can
  only be a single policy plugin.
  [[0972dafb1]](https://git.sudo.ws/sudo/commit/?id=0972dafb1)

* plugins/audit\_json/audit\_json.c:

  Tech audit\_json about approval plugin accept/reject
  [[ce21233fb]](https://git.sudo.ws/sudo/commit/?id=ce21233fb)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, include/sudo\_plugin.h,
  src/load\_plugins.c, src/sudo.c, src/sudo\_plugin\_int.h:

  Add an approval plugin type that runs after the policy plugin. The basic
  idea is that the approval plugin adds an additional layer of policy.
  There can be multiple approval plugins.
  [[db17cadaf]](https://git.sudo.ws/sudo/commit/?id=db17cadaf)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  plugin documentation fixes: o whitespace cleanup o show\_version doesn’t
  have an errstr argument o document runas\_user and runas\_group in
  command\_info[] o add missing .El at before start of audit section
  [[084cad212]](https://git.sudo.ws/sudo/commit/?id=084cad212)

2020-02-05 Todd C. Miller

* plugins/audit\_json/audit\_json.exp:

  Exported symbol is audit\_json
  [[404b28c4d]](https://git.sudo.ws/sudo/commit/?id=404b28c4d)

* doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in:

  Silence lint warning.
  [[ea377e432]](https://git.sudo.ws/sudo/commit/?id=ea377e432)

* plugins/sudoers/policy.c:

  Add runas\_user and runas\_group (if set) to command\_info for audit
  plugin. Otherwise, the audit plugin has to look up the runas name and
  group by user or group ID.
  [[c2faa9e6e]](https://git.sudo.ws/sudo/commit/?id=c2faa9e6e)

* src/tgetpass.c:

  Only enable pwfeedback when reading password from /dev/tty. This
  effectively disables pwfeedback when the -S or -A options are used.
  [[d219c6463]](https://git.sudo.ws/sudo/commit/?id=d219c6463)

2020-02-03 Laszlo Orban

* logsrvd/sendlog.c:

  fixed compiler error when sudo is configured without –enable-openssl
  [[0ca2d1427]](https://git.sudo.ws/sudo/commit/?id=0ca2d1427)

2020-02-02 Todd C. Miller

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_plugin.man.in:

  Regenerate .man.in files from .mdoc.in
  [[cec6b1708]](https://git.sudo.ws/sudo/commit/?id=cec6b1708)

* doc/sudo\_plugin.mdoc.in:

  Update documentation for setbase when the given base is NULL.
  [[b35cc96f0]](https://git.sudo.ws/sudo/commit/?id=b35cc96f0)

* plugins/sudoers/iolog\_client.c, src/sudo.c:

  For plugin events, set the sudo event base for setbase(NULL). This makes
  it possible for a plugin to change the event base to a local one and
  then reset it back to its original value.
  [[658702b6d]](https://git.sudo.ws/sudo/commit/?id=658702b6d)

2020-02-01 Todd C. Miller

* plugins/sudoers/iolog\_client.c:

  Don’t display “error in event loop” on loop break reading ServerHello.
  We should already have displayed a more useful error message. Otherwise,
  we can get two “error in event loop” warnings if the TLS handshake fails
  (in addition to other error messages).
  [[49e7e4ecd]](https://git.sudo.ws/sudo/commit/?id=49e7e4ecd)

2020-01-31 Todd C. Miller

* plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h:

  Read ServerHello message synchronously before the command is executed.
  Otherwise, the command could be run before the TLS handshake completes.
  [[b9bea2559]](https://git.sudo.ws/sudo/commit/?id=b9bea2559)

2020-01-28 Laszlo Orban

* logsrvd/sendlog.c, logsrvd/sendlog.h:

  Refactor sudo\_sendlog in order to be able to send one I/O log multiple
  times in parallel (for testing purposes)
  [[1e5562df9]](https://git.sudo.ws/sudo/commit/?id=1e5562df9)

2020-01-30 Todd C. Miller

* doc/sudo\_plugin.mdoc.in:

  Document audit plugin in the sudo\_plugin manual.
  [[790f8bb62]](https://git.sudo.ws/sudo/commit/?id=790f8bb62)

* include/sudo\_plugin.h, plugins/audit\_json/audit\_json.c, src/sudo.c:

  Change audit close arguments to a type and value. That way we can
  distinguish between different error types.
  [[1b7dc82fe]](https://git.sudo.ws/sudo/commit/?id=1b7dc82fe)

* MANIFEST, Makefile.in, configure, configure.ac, m4/sudo.m4,
  pathnames.h.in, plugins/audit\_json/Makefile.in,
  plugins/audit\_json/audit\_json.c, plugins/audit\_json/audit\_json.exp:

  Example audit plugin that writes JSON output to a log file.
  [[bf85ea2bf]](https://git.sudo.ws/sudo/commit/?id=bf85ea2bf)

* plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_io\_multi.inc,
  plugins/python/python\_plugin\_policy.c,
  plugins/python/regress/check\_python\_examples.c:

  Adapt python plugin to new plugin API changes
  [[a88a05c1e]](https://git.sudo.ws/sudo/commit/?id=a88a05c1e)

* plugins/sudoers/audit.c, plugins/sudoers/iolog.c,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/policy.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Pass back a failure or error string to the front end. The
  audit\_failure() function now stores the failure string. This will allow
  an audit plugin to log the reason if the user’s request is a rejected.
  [[45e589d44]](https://git.sudo.ws/sudo/commit/?id=45e589d44)

* doc/sudo\_plugin.mdoc.in, include/sudo\_plugin.h, src/exec\_pty.c,
  src/load\_plugins.c, src/parse\_args.c, src/sudo.c, src/sudo.h,
  src/sudo\_plugin\_int.h:

  Define a new plugin type that receives accept and reject messages. This
  can be used to implement logging-only plugins. The plugin functions now
  take an errstr argument that can be used to return an error string to be
  logged on failure or error.
  [[22105009d]](https://git.sudo.ws/sudo/commit/?id=22105009d)

* MANIFEST, include/sudo\_json.h, lib/util/Makefile.in, lib/util/json.c,
  lib/util/util.exp.in:

  Add a simple API for writing JSON records. To be used by the upcoming
  JSON audit module.
  [[88f9f2ba9]](https://git.sudo.ws/sudo/commit/?id=88f9f2ba9)

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in,
  lib/util/util.exp.in, lib/util/uuid.c:

  Add code to generate universally unique identifiers. We create type 4,
  variant 1 uuids (random).
  [[ed294b828]](https://git.sudo.ws/sudo/commit/?id=ed294b828)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_rand.h,
  lib/util/arc4random.c, lib/util/arc4random\_buf.c:

  Add tests for arc4random\_buf() and an implementation for those without.
  [[dc45c4d4e]](https://git.sudo.ws/sudo/commit/?id=dc45c4d4e)

2020-01-29 Todd C. Miller

* NEWS:

  Sudo 1.8.31 changes.
  [[df2e3f7c7]](https://git.sudo.ws/sudo/commit/?id=df2e3f7c7)

* src/tgetpass.c:

  Fix a buffer overflow when pwfeedback is enabled and input is a not a
  tty. In getln() if the user enters ^U (erase line) and the write(2)
  fails, the remaining buffer size is reset but the current pointer is
  not. While here, fix an incorrect break for erase when write(2) fails.
  Also disable pwfeedback when input is not a tty as it cannot work.
  CVE-2019-18634 Credit: Joe Vennix from Apple Information Security.
  [[fa8ffeb17]](https://git.sudo.ws/sudo/commit/?id=fa8ffeb17)

2020-01-28 Todd C. Miller

* configure, configure.ac:

  Check for presence of fseeko() regardless of utmp type.
  [[0fcb64716]](https://git.sudo.ws/sudo/commit/?id=0fcb64716)

* plugins/sudoers/sudoers.c:

  Fix warning about unresolved host name with “sudo -l -h hostname”. The
  resolve\_host() function returns 0 on success, not bool.
  [[604945f93]](https://git.sudo.ws/sudo/commit/?id=604945f93)

* plugins/python/regress/check\_python\_examples.c:

  Fix typo in a test: python\_policy->close not python\_io->close
  [[4e87e1a97]](https://git.sudo.ws/sudo/commit/?id=4e87e1a97)

2020-01-28 Robert Manner

* plugins/python/sudo\_python\_module.c:

  plugins/sudo\_python\_module: Fix double free in sudo.options\_as\_dict
  function

  PyArg\_ParseTuple sets the py\_config\_tuple pointer, but it does not
  increment the reference count, so by decrementing, we end up freeing the
  argument passed in.
  [[f268e851d]](https://git.sudo.ws/sudo/commit/?id=f268e851d)

2020-01-28 Todd C. Miller

* lib/util/getentropy.c:

  Allow getentropy.c to compile when MAP\_ANON is unavailable.
  [[9d69c4a02]](https://git.sudo.ws/sudo/commit/?id=9d69c4a02)

* MANIFEST, lib/util/Makefile.in, lib/util/arc4random.c,
  lib/util/arc4random.h:

  Remove multi-thread support from arc4random. Sudo is not multi-threaded
  so we don’t need the added complexity.
  [[13cc65038]](https://git.sudo.ws/sudo/commit/?id=13cc65038)

* lib/util/arc4random.h, lib/util/getentropy.c:

  Backed out changeset 9dce3ebb2c37 MAP\_SGI\_ANYADDR cannot be used in
  place of MAP\_ANON
  [[aa7ea419f]](https://git.sudo.ws/sudo/commit/?id=aa7ea419f)

2020-01-27 Todd C. Miller

* lib/util/arc4random.h, lib/util/getentropy.c:

  Fix compilation on IRIX; [Bug
  #915](https://bugzilla.sudo.ws/show_bug.cgi?id=915) IRIX lacks MAP\_ANON
  (and MAP\_ANONYMOUS) but we can use the IRIX-specific flag
  MAP\_SGI\_ANYADDR instead. From Kazuo Kuroi
  [[1fd82e149]](https://git.sudo.ws/sudo/commit/?id=1fd82e149)

2020-01-24 Robert Manner

* plugins/python/pyhelpers.c, plugins/python/pyhelpers.h,
  plugins/python/python\_plugin\_common.c,
  plugins/python/python\_plugin\_common.h,
  plugins/python/python\_plugin\_group.c, plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_policy.c:

  plugins/python: use separate python interpreter for each plugin

  On each plugin initialization we create a separate python interpreter
  which gets stored in the plugin\_ctx. The main interpreter is stored in
  py\_ctx and is used for creating more interpreters (if more plugins get
  loaded) and final python deinitialization.

  The “traceback” module import and the ImportBlocker initialization was
  moved, because it has to happen inside the plugin specific interpreters.
  [[22c64f58c]](https://git.sudo.ws/sudo/commit/?id=22c64f58c)

* plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/plugin\_conflict.py,
  plugins/python/regress/testdata/check\_python\_plugins\_do\_not\_affect\_each\_
  other.stdout:

  plugins/python/regress: add a failing textcase about python plugins
  affect each other

  Since python plugins are run inside the same interpreter, they affect
  each other’s state, which would be better to avoid.
  [[99f839418]](https://git.sudo.ws/sudo/commit/?id=99f839418)

2020-01-24 Todd C. Miller

* plugins/sudoers/check.c:

  Fix crash in sudo 1.8.30 when suspending sudo at the password prompt.
  The closure pointer in sudo\_conv\_callback was being filled in with a
  struct getpass\_closure \*\* instead of a struct getpass\_closure \*. The bug
  was introduced in the fix for [Bug
  #910](https://bugzilla.sudo.ws/show_bug.cgi?id=910); previously the
  closure variable was a struct getpass\_closure, not a pointer. Fix from
  Michael Norton; Bug #914.
  [[5472b1751]](https://git.sudo.ws/sudo/commit/?id=5472b1751)

2020-01-23 Robert Manner

* doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in:

  doc/sudo\_plugin\_python: update doc about the multiple I/O plugin loading
  [[9294108cd]](https://git.sudo.ws/sudo/commit/?id=9294108cd)

* plugins/python/Makefile.in:

  plugins/python/Makefile.in: update autogenerated header dependencies
  [[d3d3a59e0]](https://git.sudo.ws/sudo/commit/?id=d3d3a59e0)

* plugins/python/pyhelpers.c, plugins/python/pyhelpers.h,
  plugins/python/python\_plugin\_common.c,
  plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log\_mult
  iple.stderr, plugins/python/sudo\_python\_module.c:

  plugins/python/pyhelpers: have a default sudo\_printf function

  Adapted the default sudo\_printf from sudoers plugin to be able to print
  errors before plugin open() gets called. (This is used by the multiple
  io plugin loading to display error for too much plugin load.)

  Since this makes us always have a sudo\_log, I have removed the logic
  about whether it is available or not.
  [[d67c64bb3]](https://git.sudo.ws/sudo/commit/?id=d67c64bb3)

* src/load\_plugins.c:

  src/load\_plugins.c: plugins can supply a clone function

  if they want to support getting loaded multiple times.
  [[74f559155]](https://git.sudo.ws/sudo/commit/?id=74f559155)

2020-01-22 Robert Manner

* plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log\_mult
  iple.stderr,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log\_mult
  iple.stdout,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log\_mult
  iple1.stored,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log\_mult
  iple2.stored, plugins/python/regress/testhelpers.c,
  plugins/python/regress/testhelpers.h:

  plugins/python/regress: add a testcase for multiple io plugin loading

  to verify 2 python plugins can work next to each other.
  [[2eeda38f9]](https://git.sudo.ws/sudo/commit/?id=2eeda38f9)

* plugins/python/python\_baseplugin.c, plugins/python/python\_convmessage.c:
  plugins/python: fix return value typo for the error case
  [[3128cc97c]](https://git.sudo.ws/sudo/commit/?id=3128cc97c)

2020-01-21 Robert Manner

* plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_io\_multi.inc:

  plugins/python/plugin\_io: enable loading of multiple io plugins

  Separate sudo io plugin symbols are created which stores wrapper
  functions adding the context of which python plugin the callback is
  about.

  These sudo io plugin “slots” get generated with macros by the
  preprocessor.

  This makes sudo support loading multiple python IO plugins like this:
  (note the differences in the symbol names)

  Plugin python\_io python\_plugin.so ModulePath=… ClassName=SudoIOPlugin1
  Plugin python\_io1 python\_plugin.so ModulePath=…
  ClassName=SudoIOPlugin2 Plugin python\_io2 python\_plugin.so
  ModulePath=… ClassName=SudoIOPlugin3
  [[304a7fdc1]](https://git.sudo.ws/sudo/commit/?id=304a7fdc1)

2020-01-20 Robert Manner

* plugins/python/Makefile.in:

  plugins/python/Makefile.in: remove path prefix from examples to make
  install target work
  [[edd7356f2]](https://git.sudo.ws/sudo/commit/?id=edd7356f2)

2020-01-23 Todd C. Miller

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in:

  Document new tls\_verify setting.
  [[f4716a75e]](https://git.sudo.ws/sudo/commit/?id=f4716a75e)

2020-01-23 Laszlo Orban

* examples/sudo\_logsrvd.conf, include/log\_server.pb-c.h,
  lib/logsrv/log\_server.pb-c.c, lib/logsrv/log\_server.proto,
  logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  plugins/sudoers/iolog\_client.c:

  logserver option to disable certificate verification on server side and
  server authentication on client side
  [[24c943848]](https://git.sudo.ws/sudo/commit/?id=24c943848)

2020-01-22 Laszlo Orban

* include/log\_server.pb-c.h, lib/logsrv/log\_server.pb-c.c,
  lib/logsrv/log\_server.proto, logsrvd/logsrvd.c, logsrvd/sendlog.c,
  plugins/sudoers/iolog\_client.c:

  Rename tls\_checkpeer to tls\_reqcert in ServerHello message
  [[9935a7e2f]](https://git.sudo.ws/sudo/commit/?id=9935a7e2f)

2020-01-23 Todd C. Miller

* config.h.in, configure, configure.ac:

  Use AC\_CHECK\_DECLS when checking for SSL\_CTX\_set\_min\_proto\_version Also
  use AC\_CHECK\_FUNCS to check for the other OpenSSL functions
  [[c9b68ccb3]](https://git.sudo.ws/sudo/commit/?id=c9b68ccb3)

2020-01-22 Todd C. Miller

* src/load\_plugins.c:

  Refactor code to allocate and fill struct plugin\_container. This will
  help avoid duplicate code in the audit and approval plugins.
  [[fb5fc9876]](https://git.sudo.ws/sudo/commit/?id=fb5fc9876)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, examples/sudo\_logsrvd.conf:

  Document TCP keepalive options in the manual pages.
  [[07a2965ba]](https://git.sudo.ws/sudo/commit/?id=07a2965ba)

2020-01-21 Laszlo Orban

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h, plugins/sudoers/policy.c:

  sudoers: disable SO\_KEEPALIVE socket option based on
  log\_server\_disable\_keepalive flag in sudoers
  [[6f3f45aa2]](https://git.sudo.ws/sudo/commit/?id=6f3f45aa2)

* examples/sudo\_logsrvd.conf, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_conf.c:

  logserver: enable/disable SO\_KEEPALIVE socket option based on
  tcp\_keepalive configuration option in sudo\_logsrvd.conf
  [[38160d0cc]](https://git.sudo.ws/sudo/commit/?id=38160d0cc)

2020-01-22 Todd C. Miller

* doc/CONTRIBUTORS:

  Add proper diacritical to RÃ³bert’s name.
  [[b8e1422e8]](https://git.sudo.ws/sudo/commit/?id=b8e1422e8)

2020-01-21 Todd C. Miller

* etc/sudo.pp, examples/Makefile.in, examples/sudo.conf.in:

  Install a default sudo.conf file.
  [[db1a9b155]](https://git.sudo.ws/sudo/commit/?id=db1a9b155)

* aclocal.m4, autogen.sh, config.h.in, configure, configure.ac,
  include/sudo\_compat.h, logsrvd/logsrvd.c, logsrvd/sendlog.c,
  plugins/sudoers/iolog\_client.c:

  Add support for building on OpenSSL 1.0.2. This adds compatibility
  defines for some OpenSSL 1.1.x functions.
  [[dde86e585]](https://git.sudo.ws/sudo/commit/?id=dde86e585)

2020-01-20 Todd C. Miller

* include/hostcheck.h:

  No need to export the validate\_hostname() symbol. We don’t export
  symbols in convenience libraries, only installed DSOs.
  [[a755c658a]](https://git.sudo.ws/sudo/commit/?id=a755c658a)

* lib/iolog/hostcheck.c:

  Fix a few pointer signedness warnings on Linux.
  [[1ba896821]](https://git.sudo.ws/sudo/commit/?id=1ba896821)

* include/sudo\_compat.h, lib/iolog/hostcheck.c, logsrvd/logsrvd.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h, src/net\_ifs.c:

  Store the server host name and IP in client\_closure\_fill(). Also check
  for getpeername() and inet\_ntop() failure.
  [[c3bd02505]](https://git.sudo.ws/sudo/commit/?id=c3bd02505)

2020-01-07 Todd C. Miller

* src/sudo.c:

  Iterate over io\_plugins list in the iolog\_\* wrappers. Moving the
  iteration into the wrapper functions simplifies the calling code.
  [[0d2195c37]](https://git.sudo.ws/sudo/commit/?id=0d2195c37)

* src/sudo.c:

  policy\_plugin is global, no need to pass it to policy\_\* functions.
  [[b0a84c429]](https://git.sudo.ws/sudo/commit/?id=b0a84c429)

2020-01-20 Todd C. Miller

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/sendlog.c,
  logsrvd/sendlog.h, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h:

  Fix handling of SSL\_ERROR\_WANT\_{READ,WRITE} during normal I/O. If we get
  SSL\_ERROR\_WANT\_WRITE during SSL\_read(), we need to resume the
  SSL\_read(), not call SSL\_write() as we were doing. Likewise for
  SSL\_ERROR\_WANT\_READ received from SSL\_write(). This introduces a flag so
  we call the proper callback even when the I/O direction doesn’t match
  the read/write calls.
  [[2d91555e8]](https://git.sudo.ws/sudo/commit/?id=2d91555e8)

* lib/util/Makefile.in:

  Add siglist.c and signame.c as dependencies for depend target. Fixes
  running “make depend” in lib/util dir when siglist.c or signame.c are
  not already present.
  [[36fbdc48f]](https://git.sudo.ws/sudo/commit/?id=36fbdc48f)

* Makefile.in, doc/Makefile.in, examples/Makefile.in, include/Makefile.in,
  lib/iolog/Makefile.in, lib/logsrv/Makefile.in, lib/util/Makefile.in,
  lib/zlib/Makefile.in, logsrvd/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/python/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Add abs\_top\_srcdir and abs\_top\_builddir and use them. Configure provides
  absolution versions of srcdir, builddir, top\_srcdir and top\_builddir. We
  can use these instead of calling pwd.
  [[5913c6364]](https://git.sudo.ws/sudo/commit/?id=5913c6364)

2020-01-17 Robert Manner

* plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/iohelpers.c, plugins/python/regress/iohelpers.h,
  plugins/python/regress/testhelpers.c,
  plugins/python/regress/testhelpers.h:

  plugins/python/regress: add missing license texts
  [[8cacaabe9]](https://git.sudo.ws/sudo/commit/?id=8cacaabe9)

2020-01-14 Robert Manner

* aclocal.m4, configure, configure.ac,
  plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/testhelpers.c,
  plugins/python/regress/testhelpers.h,
  plugins/python/sudo\_python\_debug.h:

  plugins/python: various portability improvements
  [[b66ecf6e1]](https://git.sudo.ws/sudo/commit/?id=b66ecf6e1)

* plugins/python/example\_conversation.py,
  plugins/python/example\_io\_plugin.py,
  plugins/python/regress/testdata/check\_example\_conversation\_plugin\_reason
  *log\_with\_suspend.stdout,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log.stor
  ed,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_fails\_with\_pytho
  n\_backtrace.stdout:

  plugins/python/example*{io,conversation}: avoid printing signal number

  They are platform dependant, so their test would fail on some platforms.
  While we could create separate plugin for the tests, I like the idea
  that the examples are ensured to be working.

  I believe this is a good compromise for being able to auto update the
  test cases.
  [[f3b7f3c0d]](https://git.sudo.ws/sudo/commit/?id=f3b7f3c0d)

* plugins/python/Makefile.in,
  plugins/python/regress/check\_python\_examples.c:

  plugins/python/regress: load the python plugin dynamically

  instead of linking with it.
  [[40f218958]](https://git.sudo.ws/sudo/commit/?id=40f218958)

2020-01-10 Robert Manner

* generate\_test\_coverage.sh:

  generate\_test\_coverage.sh: example script to ease test coverage
  generation

  Uses lcov and genhtml to generate test coverage. It is meant to be run
  in a clean directory. Extra configure options can be added as script
  arguments.

  Example execution:

  mkdir build cd build ../generate\_test\_coverage.sh –enable-python
  [[d9af3b2d3]](https://git.sudo.ws/sudo/commit/?id=d9af3b2d3)

2020-01-07 Robert Manner

* plugins/python/regress/testdata/check\_example\_conversation\_plugin\_reason
  \_log\_with\_suspend.conversation,
  plugins/python/regress/testdata/check\_example\_conversation\_plugin\_reason
  \_log\_with\_suspend.stderr,
  plugins/python/regress/testdata/check\_example\_conversation\_plugin\_reason
  \_log\_with\_suspend.stdout,
  plugins/python/regress/testdata/check\_example\_conversation\_plugin\_reason
  \_log\_with\_suspend.stored,
  plugins/python/regress/testdata/check\_example\_conversation\_plugin\_reason
  \_log\_without\_suspend.conversation,
  plugins/python/regress/testdata/check\_example\_conversation\_plugin\_reason
  *log\_without\_suspend.stderr,
  plugins/python/regress/testdata/check\_example\_conversation\_plugin\_reason
  *log\_without\_suspend.stdout,
  plugins/python/regress/testdata/check\_example\_conversation\_plugin\_reason
  *log\_without\_suspend.stored,
  plugins/python/regress/testdata/check\_example\_conversation\_plugin\_user\_i
  nterrupts.conv,
  plugins/python/regress/testdata/check\_example\_conversation\_plugin\_user\_i
  nterrupts.conversation,
  plugins/python/regress/testdata/check\_example\_conversation\_plugin\_user\_i
  nterrupts.stderr,
  plugins/python/regress/testdata/check\_example\_conversation\_plugin\_user\_i
  nterrupts.stdout,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@diag.log
  ,
  plugins/python/regress/testdata/check\_example\_debugging\_c\_calls@info.log
  , plugins/python/regress/testdata/check\_example\_debugging\_load@diag.log,
  plugins/python/regress/testdata/check\_example\_debugging\_plugin@err.log,
  plugins/python/regress/testdata/check\_example\_debugging\_plugin@info.log,
  plugins/python/regress/testdata/check\_example\_debugging\_py\_calls@diag.lo
  g,
  plugins/python/regress/testdata/check\_example\_debugging\_py\_calls@info.lo
  g,
  plugins/python/regress/testdata/check\_example\_debugging\_sudo\_cb@info.log
  ,
  plugins/python/regress/testdata/check\_example\_group\_plugin\_is\_able\_to\_de
  bug.log,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log.stde
  rr,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log.stdo
  ut,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_command\_log.stor
  ed,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_failed\_to\_start*
  command.stderr,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_failed\_to\_start*
  command.stdout,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_failed\_to\_start*
  command.stored,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_fails\_with\_pytho
  n\_backtrace.stderr,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_fails\_with\_pytho
  n\_backtrace.stdout,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_version\_display.
  stderr,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_version\_display.
  stdout,
  plugins/python/regress/testdata/check\_example\_io\_plugin\_version\_display.
  stored,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_accepted\_exe
  cution.stderr,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_accepted\_exe
  cution.stdout,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_denied\_execu
  tion.stderr,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_denied\_execu
  tion.stdout,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_failed\_execu
  tion.stderr,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_failed\_execu
  tion.stdout,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_list.stderr,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_list.stdout,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_validate\_inv
  alidate.log,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_version\_disp
  lay.stderr,
  plugins/python/regress/testdata/check\_example\_policy\_plugin\_version\_disp
  lay.stdout,
  plugins/python/regress/testdata/check\_loading\_fails\_missing\_classname.st
  derr,
  plugins/python/regress/testdata/check\_loading\_fails\_missing\_classname.st
  dout,
  plugins/python/regress/testdata/check\_loading\_fails\_missing\_path.stderr,
  plugins/python/regress/testdata/check\_loading\_fails\_missing\_path.stdout,
  plugins/python/regress/testdata/check\_loading\_fails\_not\_owned\_by\_root.st
  derr,
  plugins/python/regress/testdata/check\_loading\_fails\_not\_owned\_by\_root.st
  dout,
  plugins/python/regress/testdata/check\_loading\_fails\_wrong\_classname.stde
  rr,
  plugins/python/regress/testdata/check\_loading\_fails\_wrong\_classname.stdo
  ut,
  plugins/python/regress/testdata/check\_loading\_fails\_wrong\_path.stderr,
  plugins/python/regress/testdata/check\_loading\_fails\_wrong\_path.stdout:

  plugins/python/regress/testdata: generated data for the pyplugin tests
  [[383ca8033]](https://git.sudo.ws/sudo/commit/?id=383ca8033)

2020-01-03 Robert Manner

* MANIFEST, plugins/python/Makefile.in,
  plugins/python/regress/check\_python\_examples.c,
  plugins/python/regress/iohelpers.c, plugins/python/regress/iohelpers.h,
  plugins/python/regress/testdata/sudo.conf.developer\_mode,
  plugins/python/regress/testdata/sudo.conf.normal\_mode,
  plugins/python/regress/testhelpers.c,
  plugins/python/regress/testhelpers.h:

  plugins/python/regress: adds tests for python plugin feature and
  examples
  [[5da7bd562]](https://git.sudo.ws/sudo/commit/?id=5da7bd562)

2020-01-10 Robert Manner

* plugins/python/example\_policy\_plugin.py:

  plugins/python/example\_policy\_plugin.py: extend user env changing
  example

  Make the demonstration extend the environment with a new variable.
  Easier to read, and makes the testing able to check for that it is
  working.
  [[0b2d0334b]](https://git.sudo.ws/sudo/commit/?id=0b2d0334b)

2020-01-09 Robert Manner

* plugins/python/python\_plugin\_common.c,
  plugins/python/python\_plugin\_policy.c:

  plugins/python/python\_plugin\_policy: fix validate() call

  When calling validate() python function, TypeError exception was thrown
  (“argument list must be a tuple”), because the call does not have
  arguments, and python does not accept empty tuple for execution. NULL
  must be used instead, which was handled as argument construction failure
  previously.
  [[185471f26]](https://git.sudo.ws/sudo/commit/?id=185471f26)

* plugins/python/example\_policy\_plugin.py:

  plugins/python/example\_policy\_plugin.py: make allowed\_commands ordered

  Storing them as “tuple” instead of “set”, so they have a fix order. This
  makes the output of the list() example stable. (“set” is printed out in
  random order)
  [[35c85596d]](https://git.sudo.ws/sudo/commit/?id=35c85596d)

* plugins/python/example\_io\_plugin.py,
  plugins/python/example\_policy\_plugin.py,
  plugins/python/python\_plugin\_common.c,
  plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_policy.c:

  plugins/python: fix confusing version display

  IO/Group/Policy Python API version is displayed instead of sudo version,
  because that is not very meaningful in this context.

  They are only displayed in verbose mode.

  Example plugins express it more concrete that they are displaying their
  version, not the API version.
  [[2ee1dd3ec]](https://git.sudo.ws/sudo/commit/?id=2ee1dd3ec)

2020-01-08 Robert Manner

* plugins/python/example\_conversation.py:

  plugins/python/example\_conversation.py: make log path configurable

  Similarly to IO plugin example. (It is easier to test it this way.)
  [[87d76f4bb]](https://git.sudo.ws/sudo/commit/?id=87d76f4bb)

2020-01-07 Robert Manner

* plugins/python/example\_io\_plugin.py:

  plugins/python/example\_io\_plugin.py: fix backtrace during destructor

  If the plugin fails to open the file for writing, constructor will raise
  an exception and exit before creating the “\_log” member variable. So the
  destructor will also raise a backtrace. (Which python ignores, but dumps
  out to stderr.)
  [[591d57ad2]](https://git.sudo.ws/sudo/commit/?id=591d57ad2)

* plugins/python/python\_plugin\_common.c:

  plugins/python/python\_plugin\_common: raise debug level for module import
  [[5be81eb25]](https://git.sudo.ws/sudo/commit/?id=5be81eb25)

* plugins/python/example\_debugging.py:

  plugins/python/example\_debugging: fix typo in comment
  [[8eab16909]](https://git.sudo.ws/sudo/commit/?id=8eab16909)

2020-01-19 Todd C. Miller

* lib/iolog/Makefile.in:

  Rebuild dependencies after hostcheck.c include changes.
  [[1093e7bc4]](https://git.sudo.ws/sudo/commit/?id=1093e7bc4)

2020-01-18 Todd C. Miller

* include/hostcheck.h, lib/iolog/hostcheck.c, logsrvd/logsrvd.c,
  plugins/sudoers/iolog\_client.c:

  Add debugging statements to certificate checks.
  [[47d950471]](https://git.sudo.ws/sudo/commit/?id=47d950471)

* MANIFEST, lib/iolog/Makefile.in, lib/iolog/hostcheck.c,
  plugins/sudoers/iolog.c:

  Portability fixes and correct path to hostcheck.h in MANIFEST. Include
  sys/socket.h for getpeername(). Link with -lnsl on Solaris to get
  inet\_pton().
  [[5a86073bd]](https://git.sudo.ws/sudo/commit/?id=5a86073bd)

* lib/iolog/Makefile.in, lib/logsrv/Makefile.in, lib/util/Makefile.in,
  lib/zlib/Makefile.in, logsrvd/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/python/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Using “libtool –clean” to remove regular files is slow. We only need to
  use libtool’s clean mode to remove files created by libtool.
  [[d2b7148b6]](https://git.sudo.ws/sudo/commit/?id=d2b7148b6)

2020-01-15 Laszlo Orban

* plugins/sudoers/Makefile.in, plugins/sudoers/iolog\_client.c:

  do server identity validation in iolog plugin
  [[a6916c219]](https://git.sudo.ws/sudo/commit/?id=a6916c219)

* logsrvd/Makefile.in, logsrvd/logsrvd.c, logsrvd/logsrvd.h:

  do client identity validation in logserver
  [[829fb9db8]](https://git.sudo.ws/sudo/commit/?id=829fb9db8)

* MANIFEST, include/hostcheck.h, lib/iolog/Makefile.in,
  lib/iolog/hostcheck.c:

  implement host validation for the audit server SSL certificates
  [[8d111db60]](https://git.sudo.ws/sudo/commit/?id=8d111db60)

2020-01-06 Laszlo Orban

* plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h:

  save a pointer to the currently connected audit server in the closure
  object
  [[de02745a3]](https://git.sudo.ws/sudo/commit/?id=de02745a3)

2020-01-17 Todd C. Miller

* .gitignore, .hgignore:

  Add examples/sudo.conf to ignore files.
  [[7ceeca1eb]](https://git.sudo.ws/sudo/commit/?id=7ceeca1eb)

* doc/sudo\_plugin\_python.mdoc.in:

  Fix mdoc lint warnings by removing .Pp before and after .Ss.
  [[0ab02b8a1]](https://git.sudo.ws/sudo/commit/?id=0ab02b8a1)

* doc/sudo.conf.mdoc.in, examples/sudo.conf.in:

  Remove whitespace at the end of the line in example sudo.conf
  [[c9f26ebbb]](https://git.sudo.ws/sudo/commit/?id=c9f26ebbb)

2020-01-16 Todd C. Miller

* logsrvd/logsrvd.c:

  Fix TLS accept when SSL\_accept() returns SSL\_ERROR\_WANT\_WRITE. We need
  to switch from SUDO\_EV\_READ to SUDO\_EV\_WRITE for this case.
  [[9b12b21ea]](https://git.sudo.ws/sudo/commit/?id=9b12b21ea)

* logsrvd/sendlog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h:

  Fix TLS connect when SSL\_connect returns SSL\_ERROR\_WANT\_READ. We need to
  switch from SUDO\_EV\_WRITE to SUDO\_EV\_READ for this case. Also make the
  tls connect events private to tls\_timed\_connect() with their own
  closure. There is no need to store them in the client closure.
  [[36b3362b9]](https://git.sudo.ws/sudo/commit/?id=36b3362b9)

* logsrvd/iolog\_writer.c:

  Store submit time in struct iolog\_info. Fixes missing time stamp in
  remote I/O log info file.
  [[fb9d7d8cc]](https://git.sudo.ws/sudo/commit/?id=fb9d7d8cc)

* src/sudo\_edit.c:

  Treat EROFS (like EACCES) as a non-fatal error in dir\_is\_writable().
  Fixes sudoedit on macOS 10.15 and above where the root file system is
  mounted read-only. See <https://support.apple.com/en-us/HT210650>. From
  Dan Villiom Podlaski Christiansen. [Bug
  #913](https://bugzilla.sudo.ws/show_bug.cgi?id=913)
  [[9e12b7177]](https://git.sudo.ws/sudo/commit/?id=9e12b7177)

2020-01-15 Todd C. Miller

* lib/util/event.c, plugins/sudoers/iolog\_client.c:

  Really fix flushing of data in client\_close(). Now that we call
  fmt\_exit\_message() from client\_close() we do not need to try to
  determine whether the read or write events were pending in the old base.

  We can’t tell anyway because the active flag in the event was cleared
  when the old sudo event base was destroyed. It is correct to enable both
  the read and write events after formatting the ExitMessage.
  [[161750fc5]](https://git.sudo.ws/sudo/commit/?id=161750fc5)

* plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_path\_escapes.c:

  Use SUDOERS\_DEBUG\_\* not SUDO\_DEBUG\_\* in debug\_decl() for the sudoers
  plugin.
  [[bbb9520c3]](https://git.sudo.ws/sudo/commit/?id=bbb9520c3)

* src/sudo.c, src/sudo\_plugin\_int.h:

  Wrap calls to plugin event callbacks to use the plugin’s debug instance.
  Otherwise, the debug output in a plugin’s event callback will go to the
  sudo debug file, not sudoers.
  [[405d26f5b]](https://git.sudo.ws/sudo/commit/?id=405d26f5b)

* lib/util/regress/strsig/strsig\_test.c:

  FreeBSD is missing SIGLWP (aka SIGTHR) in sys\_signame[]. Don’t test
  SIGLWP on FreeBSD where it is reserved for the thread library and is not
  listed in sys\_signame[].
  [[41242e121]](https://git.sudo.ws/sudo/commit/?id=41242e121)

* configure, configure.ac:

  We want to use DT\_RUNPATH in preference to DT\_RPATH in ELF binaries.
  Otherwise, LD\_LIBRARY\_PATH does not work when running the tests. The GNU
  linker’s –enable-new-dtags can be used to do this. We don’t do this on
  NetBSD where RPATH already supports LD\_LIBRARY\_PATH.
  [[aed69fb47]](https://git.sudo.ws/sudo/commit/?id=aed69fb47)

2020-01-14 Todd C. Miller

* plugins/sudoers/sudoers\_debug.c:

  Fix reference counting when both sudoers policy and I/O log are loaded.
  If both sudoers policy and I/O log plugins are loaded, debug\_files will
  be empty when the I/O plugin is initialized. This changes the logic to
  always increase the reference count if the instance is valid.
  [[e7eef9c3a]](https://git.sudo.ws/sudo/commit/?id=e7eef9c3a)

* src/load\_plugins.c:

  Fix handling of duplicate policy and I/O plugins. The warning message
  said the later I/O plugin was ignored but it actually overwrote the
  existing one instead. The first registered plugin of the same name now
  is used, as was intended. Specifying more than one policy plugin is no
  longer a fatal error; this allows the admin to fix the situation.
  [[9c5c79194]](https://git.sudo.ws/sudo/commit/?id=9c5c79194)

2020-01-11 Todd C. Miller

* src/sudo\_edit.c:

  For sudoedit\_checkdir consider a user-owner directory to be writable.
  The non-faccessat() code already did this so this just brings the
  faccessat() path into alignment. [Bug
  #912](https://bugzilla.sudo.ws/show_bug.cgi?id=912)
  [[c592470db]](https://git.sudo.ws/sudo/commit/?id=c592470db)

2020-01-10 Todd C. Miller

* doc/CONTRIBUTORS:

  Add newline before list of artwork authors.
  [[e7480c341]](https://git.sudo.ws/sudo/commit/?id=e7480c341)

2020-01-09 Todd C. Miller

* plugins/sudoers/logging.c:

  Remove MAXSYSLOGTRIES, it is no longer used.
  [[3fddfedb5]](https://git.sudo.ws/sudo/commit/?id=3fddfedb5)

2020-01-10 Todd C. Miller

* doc/LICENSE:

  Update copyright year.
  [[bf68dce05]](https://git.sudo.ws/sudo/commit/?id=bf68dce05)

2020-01-07 Todd C. Miller

* configure, configure.ac:

  If –enable-openssl or –enable-gcrypt is given a path, append to
  LDFLAGS. Previously we appended the path to SUDOERS\_LDFLAGS but now that
  we use OpenSSL in the log server, LDFLAGS is the correct one to use.
  [[8747a9554]](https://git.sudo.ws/sudo/commit/?id=8747a9554)

* doc/CONTRIBUTORS:

  Add Robert Manner
  [[b141213a1]](https://git.sudo.ws/sudo/commit/?id=b141213a1)

2020-01-05 Todd C. Miller

* plugins/sudoers/timestamp.c:

  Sanity check size when converting the first record to TS\_LOCKEXCL
  Coverity CID 206591
  [[586b418ad]](https://git.sudo.ws/sudo/commit/?id=586b418ad)

* include/sudo\_iolog.h, lib/iolog/iolog\_fileio.c:

  Fix coverity CID 206586. Potential use after free calling gzstrerror()
  after gzclose().
  [[9e57bea4e]](https://git.sudo.ws/sudo/commit/?id=9e57bea4e)

* plugins/sudoers/cvtsudoers.c:

  Use canonical pattern when freeing a tail queue. Avoids some coverity
  false positives when using TAILQ\_FOREACH\_SAFE to free the tail queue.
  [[3e0dcae6c]](https://git.sudo.ws/sudo/commit/?id=3e0dcae6c)

2020-01-03 Todd C. Miller

* plugins/sudoers/iolog\_client.c:

  Avoid potential NULL deref in tls\_timed\_connect() error path. Coverity
  CID 206396
  [[b3c5efd48]](https://git.sudo.ws/sudo/commit/?id=b3c5efd48)

* logsrvd/sendlog.c:

  Check for sudo\_ev\_add() failure; Coverity CID 206395 206397
  [[920cdf421]](https://git.sudo.ws/sudo/commit/?id=920cdf421)

2020-01-02 Todd C. Miller

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, examples/sudo.conf.in:

  Update sample sudo.conf with all supported settings. The deprecated
  “max\_groups” setting is not documented.
  [[b527ac3fb]](https://git.sudo.ws/sudo/commit/?id=b527ac3fb)

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, examples/sudo.conf.in,
  lib/util/regress/sudo\_conf/test1.in,
  lib/util/regress/sudo\_parseln/test1.in:

  Remove POD-style C<> markup (typewriter font) from sudo.conf
  [[8aa815643]](https://git.sudo.ws/sudo/commit/?id=8aa815643)

* MANIFEST, configure, configure.ac, examples/Makefile.in,
  examples/sudo.conf.in:

  Substitute plugin dir into examples/sudo.conf
  [[5bf075202]](https://git.sudo.ws/sudo/commit/?id=5bf075202)

2020-01-02 Robert Manner

* plugins/sudoers/sudoers\_debug.c:

  plugins/sudoers/sudoers\_debug.c: fix harmless debug deregistration
  warning

  If the debug sudoers subsystem is not registered, because it does not
  get any file names to deal with (TAILQ\_EMPTY(debug\_files)),
  deregistration of the subsystem outputs a warning:

  sudo: sudo\_debug\_deregister\_v1: invalid instance ID -1, max -1

  This patch prevents that by only increasing the refcount if the
  debug\_instance was registered successfully.
  [[972ea1448]](https://git.sudo.ws/sudo/commit/?id=972ea1448)

* plugins/python/Makefile.in:

  plugins/python/Makefile.in: fix the install path of examples

  Examples are installed by default to “docdir”, which refers to
  PACKAGE\_TARNAME variable which was empty for the python plugin
  Makefile.in

  So the examples were installed to ‘…/share/doc/examples’ instead of
  ‘…/share/doc/sudo/examples’. This also made them be skipped from the
  package.

  Also the install target now depends on install-doc so the examples gets
  installed also (similarly as other examples).
  [[3e9d15a4d]](https://git.sudo.ws/sudo/commit/?id=3e9d15a4d)

* doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in:

  doc/sudo\_plugin\_python: indent code examples for easier readability
  [[3f890e4db]](https://git.sudo.ws/sudo/commit/?id=3f890e4db)

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  doc/sudo.conf: document developer\_mode option
  [[9871f7e37]](https://git.sudo.ws/sudo/commit/?id=9871f7e37)

2019-12-31 Todd C. Miller

* doc/UPGRADE:

  fix typo in previous
  [[a76b7543b]](https://git.sudo.ws/sudo/commit/?id=a76b7543b)

* Makefile.in:

  In update-pot match \*.c not \*c.
  [[4eaea77fa]](https://git.sudo.ws/sudo/commit/?id=4eaea77fa)

* NEWS, doc/UPGRADE:

  Changes in sudo 1.8.30
  [[a8c39ea81]](https://git.sudo.ws/sudo/commit/?id=a8c39ea81)

2019-12-26 Todd C. Miller

* Makefile.in:

  Add check for up to date def\_data.[ch] in check-dist target.
  [[f139d2361]](https://git.sudo.ws/sudo/commit/?id=f139d2361)

2019-12-25 Todd C. Miller

* src/limits.c:

  Use 64-bit resource limits on AIX.
  [[1e25d03c9]](https://git.sudo.ws/sudo/commit/?id=1e25d03c9)

* src/limits.c:

  When restoring old resource limits, try to recover if we receive EINVAL.
  On NetBSD, setrlimit(2) can return EINVAL if the new soft limit is lower
  than the current resource usage. This can be a problem when restoring
  the old stack limit if sudo has raised it.
  [[dfabda3d4]](https://git.sudo.ws/sudo/commit/?id=dfabda3d4)

* src/limits.c:

  Sudo doesn’t require such a large stack.
  [[dbc905fdf]](https://git.sudo.ws/sudo/commit/?id=dbc905fdf)

* plugins/sudoers/Makefile.in:

  Restore check for readable /etc/sudoers in pre-install target. If there
  is no installed sudoers there is nothing to check…
  [[047f37ade]](https://git.sudo.ws/sudo/commit/?id=047f37ade)

* config.h.in, configure, configure.ac:

  Enable OpenBSD extensions on NetBSD to get reallocarray(3) prototype.
  [[c8532ae7a]](https://git.sudo.ws/sudo/commit/?id=c8532ae7a)

* include/sudo\_event.h:

  Add forward declaration of struct timeval for deprecated APIs.
  [[c321b3e60]](https://git.sudo.ws/sudo/commit/?id=c321b3e60)

* lib/util/sig2str.c, lib/util/str2sig.c:

  Fix compilation on systems with SIGRTMIN/SIGRTMAX but not \_SC\_RTSIG\_MAX.
  [[4347ed90d]](https://git.sudo.ws/sudo/commit/?id=4347ed90d)

* include/sudo\_compat.h:

  Older systems may not support WCONTINUED.
  [[291221c69]](https://git.sudo.ws/sudo/commit/?id=291221c69)

* plugins/sudoers/logging.c:

  Support systems that have nl\_langinfo(3) but not the CODESET define.
  Fixes compilation on old NetBSD versions.
  [[58d50f44c]](https://git.sudo.ws/sudo/commit/?id=58d50f44c)

* plugins/sudoers/starttime.c:

  Fix a typo; HAVE\_KINFO\_PROC2\_NETBSD not HAVE\_KINFO\_PROC2\_NETBSD2
  [[8b571c59a]](https://git.sudo.ws/sudo/commit/?id=8b571c59a)

2019-12-23 Todd C. Miller

* MANIFEST, Makefile.in, configure, configure.ac, etc/init.d/aix.sh.in,
  etc/init.d/hpux.sh.in, etc/init.d/sudo.conf.in, etc/sudo.pp,
  src/Makefile.in:

  Move init.d and sudo.pp to the etc dir.
  [[c6f8f4b54]](https://git.sudo.ws/sudo/commit/?id=c6f8f4b54)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/cfmakeraw.c:

  Add cfmakeraw() for systems without it.
  [[4690d3ecf]](https://git.sudo.ws/sudo/commit/?id=4690d3ecf)

* MANIFEST:

  Remove indent.pro from MANIFEST
  [[1b10ac03e]](https://git.sudo.ws/sudo/commit/?id=1b10ac03e)

* .gitignore, .hgignore:

  Add uncrustify.files to ignore file.
  [[d089bd94e]](https://git.sudo.ws/sudo/commit/?id=d089bd94e)

* doc/sudo\_plugin\_python.man.in, doc/sudo\_plugin\_python.mdoc.in:

  Substitute @prefix@ in for the example paths. We can’t use
  @exampledir@ here since it contains Makefile variables.
  [[79e52c776]](https://git.sudo.ws/sudo/commit/?id=79e52c776)

2019-12-22 Todd C. Miller

* include/sudo\_debug.h, lib/iolog/iolog\_fileio.c, lib/iolog/iolog\_path.c,
  lib/iolog/iolog\_util.c, lib/util/aix.c, lib/util/digest.c,
  lib/util/digest\_gcrypt.c, lib/util/digest\_openssl.c, lib/util/event.c,
  lib/util/event\_poll.c, lib/util/event\_select.c, lib/util/gettime.c,
  lib/util/getusershell.c, lib/util/gidlist.c, lib/util/host\_port.c,
  lib/util/key\_val.c, lib/util/lbuf.c, lib/util/locking.c,
  lib/util/logfac.c, lib/util/logpri.c, lib/util/mkdir\_parents.c,
  lib/util/parseln.c, lib/util/secure\_path.c, lib/util/setgroups.c,
  lib/util/strsplit.c, lib/util/strtobool.c, lib/util/strtoid.c,
  lib/util/strtomode.c, lib/util/sudo\_conf.c, lib/util/term.c,
  lib/util/ttyname\_dev.c, lib/util/ttysize.c, logsrvd/eventlog.c,
  logsrvd/iolog\_writer.c, logsrvd/logsrv\_util.c, logsrvd/logsrvd.c,
  logsrvd/logsrvd\_conf.c, logsrvd/sendlog.c,
  plugins/python/python\_plugin\_common.c,
  plugins/python/sudo\_python\_debug.c, plugins/sudoers/alias.c,
  plugins/sudoers/audit.c, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/base64.c, plugins/sudoers/boottime.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/check.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/cvtsudoers\_pwutil.c,
  plugins/sudoers/defaults.c, plugins/sudoers/digestname.c,
  plugins/sudoers/editor.c, plugins/sudoers/env.c,
  plugins/sudoers/env\_pattern.c, plugins/sudoers/file.c,
  plugins/sudoers/filedigest.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/gc.c,
  plugins/sudoers/gentime.c, plugins/sudoers/getspwuid.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/hexchar.c, plugins/sudoers/interfaces.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_path\_escapes.c, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/ldap\_util.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/locale.c,
  plugins/sudoers/logging.c, plugins/sudoers/logwrap.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/match\_digest.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse\_ldif.c,
  plugins/sudoers/policy.c, plugins/sudoers/prompt.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/rcstr.c, plugins/sudoers/redblack.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sssd.c,
  plugins/sudoers/starttime.c, plugins/sudoers/strlist.c,
  plugins/sudoers/stubs.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers\_debug.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timeout.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsdump.c,
  plugins/sudoers/visudo.c, src/exec.c, src/exec\_common.c,
  src/exec\_nopty.c, src/exec\_pty.c, src/get\_pty.c, src/hooks.c,
  src/limits.c, src/load\_plugins.c, src/net\_ifs.c, src/parse\_args.c,
  src/preserve\_fds.c, src/selinux.c, src/sesh.c, src/signal.c,
  src/solaris.c, src/sudo.c, src/sudo\_edit.c, src/tgetpass.c,
  src/ttyname.c, src/utmp.c:

  debug\_decl and debug\_decl\_vars now require a semicolon at the end.
  [[486ee2b71]](https://git.sudo.ws/sudo/commit/?id=486ee2b71)

2019-12-21 Todd C. Miller

* MANIFEST, doc/Makefile.in, doc/sudo\_plugin\_python.man.in,
  doc/sudo\_plugin\_python.mdoc.in:

  Add sudo\_plugin\_python manual page. Based on markdown docs from Robert
  Manner.
  [[5dcc28180]](https://git.sudo.ws/sudo/commit/?id=5dcc28180)

2019-12-18 Todd C. Miller

* plugins/sudoers/sudoers.c, src/limits.c:

  Output the name of the limit when warning about setrlimit or getrlimit.
  From Kimmo Suominen.
  [[4392b5726]](https://git.sudo.ws/sudo/commit/?id=4392b5726)

2019-12-14 Todd C. Miller

* aclocal.m4, config.h.in, configure:

  regen
  [[96a03a089]](https://git.sudo.ws/sudo/commit/?id=96a03a089)

* MANIFEST:

  Add python module files to MANIFEST
  [[42732821f]](https://git.sudo.ws/sudo/commit/?id=42732821f)

2019-12-05 Robert Manner

* plugins/python/example\_conversation.py,
  plugins/python/example\_debugging.py:

  plugins/python: example plugin demonstrating conversation and debug API
  [[4ad362dd8]](https://git.sudo.ws/sudo/commit/?id=4ad362dd8)

2019-11-19 Robert Manner

* plugins/python/example\_group\_plugin.py:

  plugins/python: add example python group plugin
  [[523bcbedb]](https://git.sudo.ws/sudo/commit/?id=523bcbedb)

* plugins/python/example\_policy\_plugin.py:

  plugins/python: add example python policy plugin
  [[d8432fca3]](https://git.sudo.ws/sudo/commit/?id=d8432fca3)

* plugins/python/example\_io\_plugin.py:

  plugins/python: add example io python plugin
  [[ee856cc4b]](https://git.sudo.ws/sudo/commit/?id=ee856cc4b)

2019-10-22 Robert Manner

* Makefile.in, configure.ac, plugins/python/Makefile.in:

  Makefile.in, configure.ac: add python plugin build
  [[91e6bf8cc]](https://git.sudo.ws/sudo/commit/?id=91e6bf8cc)

2019-12-10 Robert Manner

* plugins/python/python\_plugin\_common.c:

  plugins/python: make group plugin able to debug

  It does not get the debug settings, so it looks them up through
  sudo\_conf.
  [[d888d4459]](https://git.sudo.ws/sudo/commit/?id=d888d4459)

2019-11-21 Robert Manner

* plugins/python/python\_baseplugin.c, plugins/python/python\_convmessage.c,
  plugins/python/sudo\_python\_module.c,
  plugins/python/sudo\_python\_module.h:

  plugins/python: add a sudo python module
  [[9b49d44e8]](https://git.sudo.ws/sudo/commit/?id=9b49d44e8)

2019-12-02 Robert Manner

* plugins/python/python\_importblocker.c:

  plugins/python: add ImportBlocker which forbids loading unsafe python
  modules

  If non root can alter any imported python modules, he is able to run
  anything he would like to as root user. This class is a helper to avoid
  such situation.

  This feature can be disabled with ‘DeveloperMode=1’ plugin option.
  [[a6bac23ba]](https://git.sudo.ws/sudo/commit/?id=a6bac23ba)

2019-10-22 Robert Manner

* plugins/python/pyhelpers.c, plugins/python/pyhelpers.h,
  plugins/python/pyhelpers\_cpychecker.h,
  plugins/python/python\_plugin\_common.c,
  plugins/python/python\_plugin\_common.h,
  plugins/python/python\_plugin\_group.c, plugins/python/python\_plugin\_io.c,
  plugins/python/python\_plugin\_policy.c:

  plugins/python: a plugin which can load policy/io plugin written in
  python
  [[babdcbd03]](https://git.sudo.ws/sudo/commit/?id=babdcbd03)

2019-12-04 Robert Manner

* plugins/python/sudo\_python\_debug.c, plugins/python/sudo\_python\_debug.h:

  plugins/python: add sudo debug helpers
  [[311cf122e]](https://git.sudo.ws/sudo/commit/?id=311cf122e)

2019-12-10 Robert Manner

* include/sudo\_conf.h, lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_conf/test1.in,
  lib/util/regress/sudo\_conf/test1.out.ok,
  lib/util/regress/sudo\_conf/test2.out.ok,
  lib/util/regress/sudo\_conf/test3.out.ok,
  lib/util/regress/sudo\_conf/test4.out.ok,
  lib/util/regress/sudo\_conf/test5.out.ok,
  lib/util/regress/sudo\_conf/test6.out.ok,
  lib/util/regress/sudo\_conf/test7.out.ok,
  lib/util/regress/sudo\_conf/test8.err.ok,
  lib/util/regress/sudo\_conf/test8.in,
  lib/util/regress/sudo\_conf/test8.out.ok, lib/util/sudo\_conf.c,
  lib/util/util.exp.in, plugins/sudoers/group\_plugin.c,
  src/load\_plugins.c:

  src/load\_plugins, plugins/sudoers: added developer\_mode sudo.conf option

  It can be used to disable the enforcement that a plugin (shared object
  or an imported python module) must be owned by root and not modifiable
  by others. This can make plugin development easier.
  [[c0d53d75e]](https://git.sudo.ws/sudo/commit/?id=c0d53d75e)

2019-12-05 Robert Manner

* include/sudo\_debug.h, lib/util/sudo\_debug.c, lib/util/util.exp.in:

  lib/util/sudo\_debug.c: add a function for querying if debugging is
  needed

  for a level. Rationale: this way we can avoid computing details for the
  log which will not happen at all if the computation is slow.
  [[6710048c8]](https://git.sudo.ws/sudo/commit/?id=6710048c8)

2019-11-21 Robert Manner

* Makefile.in:

  Makefile.in: fix calling log2cl when doing out of source build

  If doing build out of source and not calling configure by absolute path,
  $(top\_srcdir) variable will contain a path relative to the directory we
  stand in. So, after changing the current directory “cd $(srcdir)”, this
  path will point to somewhere else making the install step fail.
  [[80fa75f0e]](https://git.sudo.ws/sudo/commit/?id=80fa75f0e)

2019-12-14 Todd C. Miller

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Update SUDO\_CONV\_REPL\_MAX in docs.
  [[a44158054]](https://git.sudo.ws/sudo/commit/?id=a44158054)

* Makefile.in:

  Remove uncrustify.files in clean target
  [[9f4409c25]](https://git.sudo.ws/sudo/commit/?id=9f4409c25)

2019-12-13 Todd C. Miller

* Makefile.in, etc/uncrustify-small.cfg, etc/uncrustify.cfg, indent.pro:

  Add uncrustify config file for new sudo code style.
  [[60328e5c7]](https://git.sudo.ws/sudo/commit/?id=60328e5c7)

* include/sudo\_plugin.h:

  Bump SUDO\_CONV\_REPL\_MAX from 255 to 1023
  [[3a0445af9]](https://git.sudo.ws/sudo/commit/?id=3a0445af9)

* lib/util/digest\_gcrypt.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/secureware.c:

  Minor style cleanups. Remove extraneous break after return statement.
  Convert two old K&R function declarations.
  [[3ec23ad5e]](https://git.sudo.ws/sudo/commit/?id=3ec23ad5e)

2019-12-11 Todd C. Miller

* src/selinux.c:

  Save/restore the raw form of the file context in case mctrans is not
  available.
  [[718e6997f]](https://git.sudo.ws/sudo/commit/?id=718e6997f)

2019-12-09 Todd C. Miller

* MANIFEST, config.h.in, configure, configure.ac, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, include/sudo\_compat.h, lib/util/Makefile.in,
  lib/util/getusershell.c, mkdep.pl, plugins/sudoers/check.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Add runas\_check\_shell flag to require a runas user to have a valid
  shell. Not enabled by default.
  [[b14d633ec]](https://git.sudo.ws/sudo/commit/?id=b14d633ec)

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/sudoers.c:

  Add a new flag “allow\_unknown\_runas\_id” to control matching of unknown
  IDs. Previous, sudo would always allow unknown user or group IDs if the
  sudoers entry permitted it. This included the “ALL” alias. With this
  change, the admin must explicitly enable support for unknown IDs.
  [[df8f06609]](https://git.sudo.ws/sudo/commit/?id=df8f06609)

2019-12-07 Todd C. Miller

* lib/util/term.c:

  Use cfmakeraw() in sudo\_term\_raw() instead of doing it manually.
  [[d7b4f8865]](https://git.sudo.ws/sudo/commit/?id=d7b4f8865)

* plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h:

  Fix event loop called via I/O log close function. We need to set events
  that were pending in the old base in the new one. Fixes sending the
  final I/O log data and the ExitMessage to the server.
  [[9d737441f]](https://git.sudo.ws/sudo/commit/?id=9d737441f)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, include/sudo\_plugin.h,
  src/sudo.c:

  Replace timeleft with pending in sudo plugin event API.
  [[d0b80b404]](https://git.sudo.ws/sudo/commit/?id=d0b80b404)

* plugins/sudoers/sudoreplay.c:

  Use sudo\_ev\_pending() instead of the deprecated sudo\_ev\_timeleft().
  [[bf3b93f08]](https://git.sudo.ws/sudo/commit/?id=bf3b93f08)

* include/sudo\_event.h, lib/util/event.c, lib/util/util.exp.in:

  Add sudo\_ev\_pending(), used to check whether an event is pending.
  [[22ffffe12]](https://git.sudo.ws/sudo/commit/?id=22ffffe12)

* plugins/sudoers/Makefile.in:

  Add TLS libs when linking check\_iolog\_plugin
  [[931407284]](https://git.sudo.ws/sudo/commit/?id=931407284)

2019-12-06 Todd C. Miller

* plugins/sudoers/iolog\_client.c:

  Remove extraneous newlines in some sudo\_warnx() calls.
  [[5711c1b49]](https://git.sudo.ws/sudo/commit/?id=5711c1b49)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document log\_server\_cabundle, log\_server\_peer\_cert and
  log\_server\_peer\_key
  [[d98022177]](https://git.sudo.ws/sudo/commit/?id=d98022177)

* :

  Merge pull request #16 from laczau/master

  Proper handling of certificate chain file
  [[03d02c4ac]](https://git.sudo.ws/sudo/commit/?id=03d02c4ac)

2019-12-06 Laszlo Orban

* logsrvd/logsrvd.c:

  cert files can contain the full chain of trust, so load all certs in
  every case for verification
  [[5e36cc655]](https://git.sudo.ws/sudo/commit/?id=5e36cc655)

2019-12-05 Todd C. Miller

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Sync init\_session() prototype with sudo\_plugin.h and fix a typo.
  [[a1e61f5ac]](https://git.sudo.ws/sudo/commit/?id=a1e61f5ac)

2019-12-04 Todd C. Miller

* plugins/sudoers/check.c:

  Only update the time stamp entry after the approval function has
  succeeded. [Bug #910](https://bugzilla.sudo.ws/show_bug.cgi?id=910)
  [[4b6de608c]](https://git.sudo.ws/sudo/commit/?id=4b6de608c)

* :

  Merge pull request #14 from sudo-project/tls-config-default-values

  Audit Server - add default values for cert paths
  [[049bbbfae]](https://git.sudo.ws/sudo/commit/?id=049bbbfae)

2019-12-04 Laszlo Orban

* logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c:

  add default values for cert paths
  [[1dceb8bbb]](https://git.sudo.ws/sudo/commit/?id=1dceb8bbb)

2019-12-03 Todd C. Miller

* lib/util/sudo\_debug.c:

  Add reference counting to debug register/deregister. Fixes a potential
  problem when an instance is re-registered.
  [[3ab29e29b]](https://git.sudo.ws/sudo/commit/?id=3ab29e29b)

* plugins/sudoers/sudoers\_debug.c:

  Only deregister the sudoers debug instance on last close. Reference
  count calls to sudoers\_debug\_register and only deregister
  sudoers\_debug\_instance when refcnt reaches 0. Fixes a problem where the
  debug system was deregistered when the sudoers policy is closed even
  though the iolog plugin is active.
  [[7c782edf5]](https://git.sudo.ws/sudo/commit/?id=7c782edf5)

2019-11-28 Laszlo Orban

* plugins/sudoers/iolog\_client.c, plugins/sudoers/iolog\_plugin.h:

  implement tls layer in iolog plugin
  [[24cda2592]](https://git.sudo.ws/sudo/commit/?id=24cda2592)

* plugins/sudoers/iolog.c, plugins/sudoers/policy.c:

  process tls config options
  [[a409d8f1f]](https://git.sudo.ws/sudo/commit/?id=a409d8f1f)

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in:

  add audit server tls related configuration options to sudoers
  [[3ce51d40c]](https://git.sudo.ws/sudo/commit/?id=3ce51d40c)

* plugins/sudoers/Makefile.in:

  optionally link sudoers with openssl libs
  [[a9c2cf927]](https://git.sudo.ws/sudo/commit/?id=a9c2cf927)

2019-11-27 Laszlo Orban

* :

  Merge pull request #11 from sudo-project/audit-server-tls-async

  Sudo audit Server - TLS protocol update
  [[f5e0e2a4b]](https://git.sudo.ws/sudo/commit/?id=f5e0e2a4b)

2019-11-26 Laszlo Orban

* logsrvd/logsrvd.c:

  disable timeout for the reader after ServerHello message
  [[06a0f8970]](https://git.sudo.ws/sudo/commit/?id=06a0f8970)

2019-11-22 Laszlo Orban

* logsrvd/logsrvd.c, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c:

  use event timeout instead of socket timeout
  [[21e7fdfd5]](https://git.sudo.ws/sudo/commit/?id=21e7fdfd5)

* logsrvd/sendlog.c, logsrvd/sendlog.h:

  adapt sudo sendlog (async communication, unencrypted ServerHello
  message)
  [[f4bbce670]](https://git.sudo.ws/sudo/commit/?id=f4bbce670)

2019-11-25 Todd C. Miller

* logsrvd/logsrvd.c:

  Exit if the first call to logsrvd\_conf\_read() fails. It is not fatal if
  subsequent calls fail (due to SIGHUP) since we keep a copy of the old
  config before installing the new one.
  [[1747e5009]](https://git.sudo.ws/sudo/commit/?id=1747e5009)

* Makefile.in, plugins/sudoers/Makefile.in:

  Add some missing files to “make clean” and “make distclean”
  [[333ea878e]](https://git.sudo.ws/sudo/commit/?id=333ea878e)

* .gitignore, .hgignore:

  Update .hgignore and convert to .gitignore
  [[42adbca7a]](https://git.sudo.ws/sudo/commit/?id=42adbca7a)

2019-11-22 Laszlo Orban

* logsrvd/logsrvd.c, logsrvd/logsrvd.h:

  ServerHello message is now unencrypted, TLS communication has been
  refactored to full async
  [[f67d0d13c]](https://git.sudo.ws/sudo/commit/?id=f67d0d13c)

* include/log\_server.pb-c.h, lib/logsrv/log\_server.pb-c.c,
  lib/logsrv/log\_server.proto, logsrvd/logsrvd.c:

  extend ServerHello message with two fields (tls, tls\_checkpeer)
  [[33f6a1676]](https://git.sudo.ws/sudo/commit/?id=33f6a1676)

2019-11-20 Todd C. Miller

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  plugins/sudoers/policy.c, src/sudo.c:

  For plugin API 1.15 and up, always call the plugin close function.
  Previously, it was only called when a command was run (including
  sudoedit). Now, plugin operations list, validate, invalidate, and
  show\_version are also closed.
  [[f976a5d86]](https://git.sudo.ws/sudo/commit/?id=f976a5d86)

2019-11-19 Todd C. Miller

* plugins/sudoers/iolog\_client.c:

  Avoid NULL deref on an error path if calloc() fails. Coverity CID 205873
  [[214374637]](https://git.sudo.ws/sudo/commit/?id=214374637)

* src/conversation.c:

  Fix potential fd leak when converting trailing newline to cr + nl.
  Coverity CID 205872
  [[e0a4b2d68]](https://git.sudo.ws/sudo/commit/?id=e0a4b2d68)

* doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  doc/sudo\_logsrvd.man.in, doc/sudo\_logsrvd.mdoc.in,
  examples/sudo\_logsrvd.conf:

  Document the process of creating self-signed certificates for
  sudo\_logsrvd. Based on a document from Laszlo Orban.
  [[b31b83051]](https://git.sudo.ws/sudo/commit/?id=b31b83051)

* plugins/group\_file/plugin\_test.c:

  Sync with argument handling in group\_plugin.c
  [[c7cac7c0e]](https://git.sudo.ws/sudo/commit/?id=c7cac7c0e)

* plugins/sudoers/group\_plugin.c:

  If a group plugin has optional arguments, NULL terminate the vector.
  Otherwise, the plugin cannot determine the end of arguments. The
  behavior now matches the plugin documentation.
  [[a3266edc2]](https://git.sudo.ws/sudo/commit/?id=a3266edc2)

2019-11-18 Todd C. Miller

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, src/sudo.c:

  If there is no session or terminal group ID, pass the plugin a value of
  0. This behavior already matches what is documented in the sudo\_plugin
  manual for “sid” but the “tcpgid” entry needed to be updated.
  [[368e12b0f]](https://git.sudo.ws/sudo/commit/?id=368e12b0f)

* plugins/sudoers/sudoers.c:

  Don’t touch the local iolog sequence file if we are logging remotely
  [[d10220162]](https://git.sudo.ws/sudo/commit/?id=d10220162)

* plugins/sudoers/iolog\_client.c:

  Plug a memory leak found by leak sanitizer
  [[6c2821fe4]](https://git.sudo.ws/sudo/commit/?id=6c2821fe4)

* plugins/sudoers/iolog.c, plugins/sudoers/iolog\_client.c,
  plugins/sudoers/iolog\_plugin.h:

  Make a shallow copy of user\_env in I/O plugin in case it is reallocated.
  The policy plugin’s session init function may reallocate the user
  environment pointer. Fixes a use after free when PAM is used.
  [[3241b82a7]](https://git.sudo.ws/sudo/commit/?id=3241b82a7)

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/policy.c:

  Rename “log\_server” in sudoers to “log\_servers” to match I/O plugin.
  [[f913249dd]](https://git.sudo.ws/sudo/commit/?id=f913249dd)

2019-11-17 Todd C. Miller

* logsrvd/logsrvd.c:

  Check closure->ssl for non-NULL instead of logsrvd\_conf\_get\_tls\_opt().
  It’s a little more obvious this way and ssl is only non-NULL when the
  tls option is enabled anyway.
  [[810669c4f]](https://git.sudo.ws/sudo/commit/?id=810669c4f)

* logsrvd/logsrvd.c:

  Init iolog\_dir\_fd and sock in connection\_closure before adding to list.
  Otherwise we could close the wrong fds in the error path.
  [[5be951bd7]](https://git.sudo.ws/sudo/commit/?id=5be951bd7)

* doc/CONTRIBUTORS:

  Add Laszlo Orban
  [[82fea739a]](https://git.sudo.ws/sudo/commit/?id=82fea739a)

2019-11-16 Todd C. Miller

* doc/sudo\_logsrvd.conf.man.in:

  regen
  [[4bb2b2f60]](https://git.sudo.ws/sudo/commit/?id=4bb2b2f60)

* doc/sudo\_logsrvd.conf.mdoc.in, examples/sudo\_logsrvd.conf:

  Change TLS example file locations to be under /etc/ssl/sudo.
  [[366a63ce5]](https://git.sudo.ws/sudo/commit/?id=366a63ce5)

* doc/sudo\_logsrvd.conf.mdoc.in, examples/sudo\_logsrvd.conf:

  Document sudo\_logsrvd TLS configuration.
  [[49c09ee2d]](https://git.sudo.ws/sudo/commit/?id=49c09ee2d)

2019-11-15 Todd C. Miller

* include/sudo\_event.h:

  Include time.h for struct timespec.
  [[dae0da2fe]](https://git.sudo.ws/sudo/commit/?id=dae0da2fe)

* lib/util/util.exp.in:

  Add sudo\_ev\_set\_v1 to the exports file.
  [[20bc94635]](https://git.sudo.ws/sudo/commit/?id=20bc94635)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document the log\_server and log\_server\_timeout options
  [[d8ccf11c5]](https://git.sudo.ws/sudo/commit/?id=d8ccf11c5)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_client.c, plugins/sudoers/iolog\_plugin.h,
  plugins/sudoers/policy.c, src/exec\_nopty.c, src/exec\_pty.c, src/sudo.c:

  Add support for logging to the log server
  [[82237194d]](https://git.sudo.ws/sudo/commit/?id=82237194d)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, include/sudo\_event.h,
  include/sudo\_plugin.h, lib/util/event.c, plugins/sudoers/iolog.c,
  plugins/sudoers/policy.c, src/Makefile.in, src/exec.c,
  src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c,
  src/load\_plugins.c, src/preload.c, src/sudo.c, src/sudo.h,
  src/sudo\_plugin\_int.h:

  Add a plugin interface to sudo main event loop.
  [[5793023ff]](https://git.sudo.ws/sudo/commit/?id=5793023ff)

* MANIFEST, Makefile.in, configure, configure.ac,
  include/log\_server.pb-c.h, include/protobuf-c/protobuf-c.h,
  lib/logsrv/Makefile.in, lib/logsrv/log\_server.pb-c.c,
  lib/logsrv/log\_server.proto, lib/logsrv/protobuf-c.c,
  logsrvd/Makefile.in:

  Move protobuf-c.c, log\_server.proto, log\_server.pb-c.[ch] to lib/logsrv
  [[58cede6fe]](https://git.sudo.ws/sudo/commit/?id=58cede6fe)

* lib/util/event.c:

  When freeing an event base, reset ev->base to NULL for associated
  events.
  [[f6acc134f]](https://git.sudo.ws/sudo/commit/?id=f6acc134f)

* logsrvd/logsrvd\_conf.c:

  Move cb\_timeout() out from under the HAVE\_OPENSSL ifdef.
  [[3689839a0]](https://git.sudo.ws/sudo/commit/?id=3689839a0)

* INSTALL, config.h.in, configure, configure.ac, logsrvd/Makefile.in,
  logsrvd/logsrvd.c:

  LibreSSL and older OpenSSL don’t support SSL\_CTX\_set\_ciphersuites(). Add
  a configure test and skip TLS 1.3 setup if it is missing. We still
  accept the tls\_ciphers13 config setting but it will be ignored.
  [[690f145d3]](https://git.sudo.ws/sudo/commit/?id=690f145d3)

* logsrvd/logsrvd.c, logsrvd/sendlog.c:

  Minor style nits that I missed during review.
  [[68480b095]](https://git.sudo.ws/sudo/commit/?id=68480b095)

* logsrvd/sendlog.c:

  Avoid calling SSL\_CTX\_free() on an uninitialized pointer in an error
  path.
  [[c9da8d408]](https://git.sudo.ws/sudo/commit/?id=c9da8d408)

* :

  Merge pull request #9 from sudo-project/audit-server-tls-support

  Audit server tls support
  [[f08c98a6a]](https://git.sudo.ws/sudo/commit/?id=f08c98a6a)

2019-11-13 Laszlo Orban

* logsrvd/Makefile.in, logsrvd/sendlog.c:

  update sudo\_sendlog to support openssl tls
  [[8c8023d21]](https://git.sudo.ws/sudo/commit/?id=8c8023d21)

2019-11-11 Laszlo Orban

* examples/sudo\_logsrvd.conf, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_conf.c:

  set timeout value for the socket
  [[b9641816d]](https://git.sudo.ws/sudo/commit/?id=b9641816d)

2019-11-08 Laszlo Orban

* configure, logsrvd/Makefile.in, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_conf.c:

  make audit server openssl dependency optional; tls layer is compiled
  only if sudo is built with –enable-openssl feature switch
  [[e201f104d]](https://git.sudo.ws/sudo/commit/?id=e201f104d)

2019-11-07 Laszlo Orban

* logsrvd/logsrvd.c:

  fixed segfault when connection\_closure\_free() tries to remove a
  non-existent connection object from the list
  [[9df5e6c11]](https://git.sudo.ws/sudo/commit/?id=9df5e6c11)

2019-11-05 Laszlo Orban

* logsrvd/logsrvd.c:

  verify server/client certs with CA certificate chain file
  [[764fb3e6b]](https://git.sudo.ws/sudo/commit/?id=764fb3e6b)

2019-11-04 Laszlo Orban

* logsrvd/logsrvd.c:

  fix copy-paste mistake
  [[037fb9298]](https://git.sudo.ws/sudo/commit/?id=037fb9298)

2019-10-31 Laszlo Orban

* logsrvd/logsrvd.c:

  process tls config params in the audit server and establish TLS
  connection accordingly
  [[361557648]](https://git.sudo.ws/sudo/commit/?id=361557648)

2019-11-12 Todd C. Miller

* src/limits.c:

  Simplify resource limit fallback logic a bit.
  [[9309ca007]](https://git.sudo.ws/sudo/commit/?id=9309ca007)

2019-10-25 Laszlo Orban

* examples/sudo\_logsrvd.conf, logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c:

  add configuration options for TLS
  [[2c5e42176]](https://git.sudo.ws/sudo/commit/?id=2c5e42176)

2019-11-11 Todd C. Miller

* doc/CONTRIBUTORS:

  Add sudo logo designers
  [[da82b16fc]](https://git.sudo.ws/sudo/commit/?id=da82b16fc)

* src/limits.c:

  Don’t set the RLIMIT\_STACK soft/hard limits to unlimited. Use 8Mb for
  soft and 64Mb for hard. Works around issues on macOS and docker. See
  also [Bug #908](https://bugzilla.sudo.ws/show_bug.cgi?id=908)
  [[f3ebe5025]](https://git.sudo.ws/sudo/commit/?id=f3ebe5025)

* src/tgetpass.c:

  Restore resource limits before executing the askpass program. Linux with
  docker seems to have issues executing a program when the stack size is
  unlimited. [Bug #908](https://bugzilla.sudo.ws/show_bug.cgi?id=908)
  [[4a893912c]](https://git.sudo.ws/sudo/commit/?id=4a893912c)

* src/conversation.c:

  Check for replies pointer being NULL just in case.
  [[ad52ce661]](https://git.sudo.ws/sudo/commit/?id=ad52ce661)

2019-11-09 Todd C. Miller

* src/conversation.c:

  Convert trailing newline to carriage return + newline for tty. Does not
  currently handle embedded newlines.
  [[6863a848d]](https://git.sudo.ws/sudo/commit/?id=6863a848d)

2019-11-08 Todd C. Miller

* lib/util/fatal.c:

  Only write a carriage return if output is to a tty.
  [[f6a3dc6d2]](https://git.sudo.ws/sudo/commit/?id=f6a3dc6d2)

* lib/util/fatal.c:

  Include a carriage return when printing warning messages. Otherwise, if
  the command is running in a pty the output is stair-stepped.
  [[b4878c95e]](https://git.sudo.ws/sudo/commit/?id=b4878c95e)

2019-11-07 Todd C. Miller

* lib/util/util.exp.in:

  Add sudo\_parse\_host\_port\_v1 and sudo\_pow2\_roundup\_v1 to exports file.
  [[9f3bbdbd6]](https://git.sudo.ws/sudo/commit/?id=9f3bbdbd6)

2019-11-06 Todd C. Miller

* lib/util/closefrom.c:

  Fix typo in closefrom emulation.
  [[09f1c2649]](https://git.sudo.ws/sudo/commit/?id=09f1c2649)

* plugins/sudoers/env.c:

  Do not warn about a missing /etc/environment file on Linux without PAM.
  [Bug #907](https://bugzilla.sudo.ws/show_bug.cgi?id=907)
  [[71aed42f9]](https://git.sudo.ws/sudo/commit/?id=71aed42f9)

2019-11-05 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.h,
  plugins/sudoers/regress/parser/check\_fill.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c:

  Transparently handle the “sudo sudoedit” problem. Some admin are
  confused about how to give users sudoedit permission and many users try
  to run sudoedit via sudo instead of directly. If the user runs “sudo
  sudoedit” sudo will now treat it as plain “sudoedit” after issuing a
  warning. If the admin has specified a fully-qualified path for sudoedit
  in sudoers, sudo will treat it as just “sudoedit” and match accordingly.
  In visudo (but not sudo), a fully-qualified path for sudoedit is now
  treated as an error.
  [[635445d47]](https://git.sudo.ws/sudo/commit/?id=635445d47)

* logsrvd/iolog\_writer.c, logsrvd/sendlog.c:

  Rename cwd -> submitcwd to match man page.
  [[73031bbb5]](https://git.sudo.ws/sudo/commit/?id=73031bbb5)

* MANIFEST, lib/util/Makefile.in, lib/util/host\_port.c,
  lib/util/regress/host\_port/host\_port\_test.c:

  Add unit test for parse\_host\_port and make an empty port an error.
  [[98ce89ee8]](https://git.sudo.ws/sudo/commit/?id=98ce89ee8)

2019-11-04 Todd C. Miller

* lib/util/host\_port.c:

  Fill in host and port pointers on success.
  [[2949d2c47]](https://git.sudo.ws/sudo/commit/?id=2949d2c47)

2019-10-28 Todd C. Miller

* Makefile.in:

  Fix ChangeLog generation on a branch.
  [[4c54e61ea]](https://git.sudo.ws/sudo/commit/?id=4c54e61ea)

2019-11-02 Todd C. Miller

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in,
  lib/util/host\_port.c, logsrvd/logsrvd\_conf.c:

  Split out code to parse host:port into a utility function.
  [[b270b0c88]](https://git.sudo.ws/sudo/commit/?id=b270b0c88)

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in, lib/util/roundup.c,
  logsrvd/logsrv\_util.c, logsrvd/logsrv\_util.h, logsrvd/logsrvd.c,
  logsrvd/sendlog.c:

  Move bufsize\_roundup() -> sudo\_pow2\_roundup() in libsudo\_util.
  [[f1d0c99e0]](https://git.sudo.ws/sudo/commit/?id=f1d0c99e0)

* lib/iolog/Makefile.in, logsrvd/Makefile.in:

  Add missing depend target
  [[676d3fc67]](https://git.sudo.ws/sudo/commit/?id=676d3fc67)

* lib/iolog/Makefile.in, lib/util/Makefile.in, logsrvd/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  We haven’t needed -I$(top\_srcdir) for a long time.
  [[655fdde22]](https://git.sudo.ws/sudo/commit/?id=655fdde22)

* lib/util/closefrom.c:

  In closefrom\_fallback() use the interval [OPEN\_MAX, INT\_MAX]. We want to
  try closing at least OPEN\_MAX fds but no more than INT\_MAX. On 64-bit
  systems it is possible for sysconf(\_SC\_OPEN\_MAX) to return a value
  larger than INT\_MAX when the number of open files is unlimited.
  [[ac36cf2d4]](https://git.sudo.ws/sudo/commit/?id=ac36cf2d4)

* plugins/sudoers/logging.c, src/exec\_monitor.c, src/selinux.c,
  src/tgetpass.c:

  Use dup3() instead of dup2(). This is less error prone since dup3()
  returns an error if old == new. Sudo guarantees that fds 0-2 are already
  open.
  [[356287557]](https://git.sudo.ws/sudo/commit/?id=356287557)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/dup3.c, mkdep.pl:

  Add dup3() emulation.
  [[43df08618]](https://git.sudo.ws/sudo/commit/?id=43df08618)

* plugins/sudoers/logging.c, src/exec\_monitor.c, src/exec\_pty.c,
  src/tgetpass.c:

  Open all pipes using pipe2() with O\_CLOEXEC. We no longer depend on
  calling closefrom() before exec.
  [[352212c7b]](https://git.sudo.ws/sudo/commit/?id=352212c7b)

* src/exec.c, src/tgetpass.c:

  Call closefrom() before we change to a non-root UID. This prevents
  another process from changing the NOFILE resource limit of the child
  process and defeating the closefrom() call. Reported by Joe Vennix from
  Apple Information Security.
  [[7acbfc18a]](https://git.sudo.ws/sudo/commit/?id=7acbfc18a)

* MANIFEST, logsrvd/Makefile.in:

  Regenerate Makefile and sort MANIFEST
  [[fd9fa6bca]](https://git.sudo.ws/sudo/commit/?id=fd9fa6bca)

2019-11-01 Todd C. Miller

* doc/sudo.man.in, doc/sudo.mdoc.in:

  Reference timestamp\_type and timestamp\_timeout in sudoers. This should
  help users find details on how time stamp files work.
  [[e6fe02d64]](https://git.sudo.ws/sudo/commit/?id=e6fe02d64)

2019-10-29 Todd C. Miller

* src/limits.c:

  macOS does not allow rlim\_cur to be set to RLIM\_INFINITY for
  RLIMIT\_NOFILE. We need to use OPEN\_MAX instead as per the macOS
  setrlimit manual. [Bug
  #904](https://bugzilla.sudo.ws/show_bug.cgi?id=904)
  [[0d8062c10]](https://git.sudo.ws/sudo/commit/?id=0d8062c10)

2019-10-27 Todd C. Miller

* logsrvd/sendlog.c:

  Remove unused copy of iolog\_seekto().
  [[0129f3a72]](https://git.sudo.ws/sudo/commit/?id=0129f3a72)

2019-10-24 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[5a1e5e9fa]](https://git.sudo.ws/sudo/commit/?id=5a1e5e9fa)

* include/sudo\_iolog.h, lib/iolog/iolog\_fileio.c, lib/iolog/iolog\_path.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c,
  lib/iolog/regress/iolog\_path/data, logsrvd/iolog\_writer.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_path\_escapes.c,
  plugins/sudoers/sudoers.c:

  Simplify expand\_iolog\_path()
  [[ee91b7360]](https://git.sudo.ws/sudo/commit/?id=ee91b7360)

* logsrvd/logsrvd.c:

  Redirect std{in,out,err} to /dev/null even when given the -n option.
  [[74a0e686a]](https://git.sudo.ws/sudo/commit/?id=74a0e686a)

* doc/sudo\_logsrvd.man.in, doc/sudo\_logsrvd.mdoc.in,
  logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_conf.c:

  Clear the write bit on the timing file for completed logs. This allows
  us to tell whether or not a log can be restarted.
  [[955fa11b5]](https://git.sudo.ws/sudo/commit/?id=955fa11b5)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/fchmodat.c, lib/util/fstatat.c, mkdep.pl:
  Add fchmodat() and fstatat() emulation. Note that fchmodat() emulation
  does not support AT\_SYMLINK\_NOFOLLOW
  [[dbf78d071]](https://git.sudo.ws/sudo/commit/?id=dbf78d071)

* include/sudo\_iolog.h, lib/iolog/iolog\_fileio.c, logsrvd/logsrvd\_conf.c,
  plugins/sudoers/iolog.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c:

  Simplify iolog\_set\_user and iolog\_set\_group
  [[13e3eaad5]](https://git.sudo.ws/sudo/commit/?id=13e3eaad5)

* include/sudo\_iolog.h, lib/iolog/iolog\_util.c,
  lib/iolog/regress/iolog\_util/check\_iolog\_util.c, logsrvd/iolog\_writer.c,
  logsrvd/logsrv\_util.c, logsrvd/sendlog.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudoreplay.c:

  Add iolog\_ prefix to exported functions in iolog\_util.c
  [[56c21243d]](https://git.sudo.ws/sudo/commit/?id=56c21243d)

* include/sudo\_iolog.h, lib/iolog/iolog\_fileio.c, logsrvd/logsrvd\_conf.c,
  plugins/sudoers/iolog.c:

  Read logsrvd.conf in two steps: first read, then apply if OK. This fixes
  a problem where when logsrvd.conf was reloaded while running (due to
  SIGHUP) and there was an error we could end up with a partial config.
  [[aaf5d0dc6]](https://git.sudo.ws/sudo/commit/?id=aaf5d0dc6)

* MANIFEST, doc/Makefile.in, doc/sudo\_logsrv.proto.man.in,
  doc/sudo\_logsrv.proto.mdoc.in, doc/sudo\_logsrvd.conf.man.in,
  doc/sudo\_logsrvd.conf.mdoc.in, examples/sudo\_logsrvd.conf,
  logsrvd/iolog\_writer.c:

  Document the sudo log server protocol
  [[1df3230c2]](https://git.sudo.ws/sudo/commit/?id=1df3230c2)

* logsrvd/log\_server.pb-c.c, logsrvd/log\_server.pb-c.h,
  logsrvd/log\_server.proto:

  Add NumberList to InfoMessage. Also make comments fit in 80 columns when
  formatted as a man page.
  [[3b8011ea9]](https://git.sudo.ws/sudo/commit/?id=3b8011ea9)

* lib/util/mkdir\_parents.c:

  Avoid TOCTOU in sudo\_mkdir\_parents; Coverity CID 204357
  [[6c6f0567b]](https://git.sudo.ws/sudo/commit/?id=6c6f0567b)

* lib/iolog/iolog\_fileio.c:

  Avoid TOCTOU in iolog\_mkdirs; Coverity CID 204356
  [[8552b283b]](https://git.sudo.ws/sudo/commit/?id=8552b283b)

* logsrvd/logsrvd\_conf.c:

  Fix Coverity CID 204355, resource leak on error path.
  [[16b3513a9]](https://git.sudo.ws/sudo/commit/?id=16b3513a9)

* logsrvd/sendlog.c:

  Fix Coverity CID 204353, fd leak on error path.
  [[822fd99b6]](https://git.sudo.ws/sudo/commit/?id=822fd99b6)

* logsrvd/logsrvd.c, logsrvd/sendlog.c:

  Fix some warnings from the clang static analyzer.
  [[e74134d04]](https://git.sudo.ws/sudo/commit/?id=e74134d04)

* MANIFEST, lib/iolog/iolog\_fileio.c, logsrvd/Makefile.in,
  logsrvd/iolog\_writer.c, logsrvd/logsrv\_util.c, logsrvd/logsrv\_util.h,
  logsrvd/logsrvd.h, logsrvd/sendlog.c, logsrvd/sendlog.h:

  Rename buffer.c -> logsrv\_util.c and add iolog\_seekto()
  [[728ed2100]](https://git.sudo.ws/sudo/commit/?id=728ed2100)

* include/sudo\_iolog.h, lib/iolog/iolog\_util.c, logsrvd/iolog\_writer.c,
  logsrvd/sendlog.c, plugins/sudoers/sudoreplay.c:

  Move read\_timing\_record() into libsudo\_iolog
  [[b58ecb7e6]](https://git.sudo.ws/sudo/commit/?id=b58ecb7e6)

* logsrvd/sendlog.c, logsrvd/sendlog.h:

  Fix client side of restart. Seek to the target point there too so we
  start sending from the right place.
  [[0ab2d8299]](https://git.sudo.ws/sudo/commit/?id=0ab2d8299)

* include/sudo\_iolog.h, lib/iolog/iolog\_fileio.c, logsrvd/iolog\_writer.c,
  logsrvd/logsrvd.c:

  Add restart support for compresses I/O logs.
  [[3394785f6]](https://git.sudo.ws/sudo/commit/?id=3394785f6)

* MANIFEST, configure, configure.ac, doc/Makefile.in,
  doc/sudo\_logsrvd.conf.man.in, doc/sudo\_logsrvd.conf.mdoc.in,
  doc/sudo\_logsrvd.man.in, doc/sudo\_logsrvd.mdoc.in,
  doc/sudo\_sendlog.man.in, doc/sudo\_sendlog.mdoc.in,
  examples/sudo\_logsrvd.conf, m4/sudo.m4:

  Add manual pages for logsrvd and sendlog.
  [[b57054785]](https://git.sudo.ws/sudo/commit/?id=b57054785)

* MANIFEST, logsrvd/Makefile.in, logsrvd/buffer.c, logsrvd/buffer.h,
  logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/sendlog.c, logsrvd/sendlog.h:

  Allow messages up to 2Mb in size.
  [[66fc92695]](https://git.sudo.ws/sudo/commit/?id=66fc92695)

* logsrvd/logsrvd.c, logsrvd/sendlog.c:

  Add OpenBSD malloc options.
  [[c25b6dc7e]](https://git.sudo.ws/sudo/commit/?id=c25b6dc7e)

* MANIFEST, examples/sudo\_logsrvd.conf, include/sudo\_util.h,
  lib/util/Makefile.in, lib/util/logfac.c, lib/util/logpri.c,
  lib/util/util.exp.in, logsrvd/Makefile.in, logsrvd/eventlog.c,
  logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_conf.c, plugins/sudoers/defaults.c:

  Add basic support for event logging using a sudo-style log format.
  [[76eec78a3]](https://git.sudo.ws/sudo/commit/?id=76eec78a3)

* examples/sudo\_logsrvd.conf, logsrvd/logsrvd\_conf.c:

  Convert sudo\_logsrvd.conf to ini file format
  [[402820e8c]](https://git.sudo.ws/sudo/commit/?id=402820e8c)

* logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, logsrvd/logsrvd.h:

  Return an error to the client on error instead of dropping the
  connection.
  [[c7f0f9e0f]](https://git.sudo.ws/sudo/commit/?id=c7f0f9e0f)

* logsrvd/Makefile.in, logsrvd/logsrvd.c, logsrvd/sendlog.c:

  Add long option support to logsrvd and sendlog.
  [[216747476]](https://git.sudo.ws/sudo/commit/?id=216747476)

* Makefile.in, logsrvd/Makefile.in, logsrvd/iolog\_writer.c,
  logsrvd/logsrvd.c, logsrvd/logsrvd\_conf.c, logsrvd/sendlog.c:

  Mark logsrvd and sendlog strings for translation in the sudoers domain
  [[af7f65fdf]](https://git.sudo.ws/sudo/commit/?id=af7f65fdf)

* examples/sudo\_logsrvd.conf, include/sudo\_iolog.h,
  lib/iolog/iolog\_fileio.c, logsrvd/Makefile.in, logsrvd/logsrvd.c,
  logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c:

  Make the logsrvd port and list address configurable.
  [[534aba7a3]](https://git.sudo.ws/sudo/commit/?id=534aba7a3)

* logsrvd/iolog\_writer.c, logsrvd/log\_server.pb-c.c,
  logsrvd/log\_server.pb-c.h, logsrvd/log\_server.proto, logsrvd/logsrvd.c,
  logsrvd/logsrvd.h, logsrvd/sendlog.c, logsrvd/sendlog.h:

  Rename ExecMessage -> AcceptMessage and add RejectMessage
  [[077e9aebb]](https://git.sudo.ws/sudo/commit/?id=077e9aebb)

* logsrvd/Makefile.in, sudo.pp:

  Add sudo\_ prefix to logsrvd and sendlog.
  [[2e2d9e869]](https://git.sudo.ws/sudo/commit/?id=2e2d9e869)

* include/sudo\_iolog.h, lib/iolog/iolog\_fileio.c, lib/iolog/iolog\_util.c,
  logsrvd/iolog\_writer.c, logsrvd/logsrvd.h, logsrvd/sendlog.c,
  plugins/sudoers/iolog.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudoreplay.c:

  Use openat(2) when opening files in the I/O log directory.
  [[282263c11]](https://git.sudo.ws/sudo/commit/?id=282263c11)

* Makefile.in, include/sudo\_iolog.h, lib/iolog/iolog\_path.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c, logsrvd/iolog\_writer.c,
  logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c,
  plugins/sudoers/iolog\_path\_escapes.c, plugins/sudoers/sudoers.c:

  Enable sudo\_logsrvd.conf settings.
  [[7ba7c5835]](https://git.sudo.ws/sudo/commit/?id=7ba7c5835)

* MANIFEST, Makefile.in, configure, configure.ac, include/sudo\_iolog.h,
  include/sudo\_util.h, lib/iolog/Makefile.in, lib/iolog/iolog\_fileio.c,
  lib/iolog/iolog\_path.c, lib/iolog/iolog\_util.c,
  lib/iolog/regress/iolog\_path/check\_iolog\_path.c,
  lib/iolog/regress/iolog\_path/data,
  lib/iolog/regress/iolog\_util/check\_iolog\_util.c, lib/util/sudo\_conf.c,
  logsrvd/Makefile.in, logsrvd/iolog\_writer.c, logsrvd/logsrvd.c,
  logsrvd/logsrvd.h, logsrvd/logsrvd\_conf.c, logsrvd/sendlog.c,
  logsrvd/sendlog.h, plugins/sample/sample\_plugin.c,
  plugins/sudoers/Makefile.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog.h,
  plugins/sudoers/iolog\_files.h, plugins/sudoers/iolog\_path\_escapes.c,
  plugins/sudoers/iolog\_util.h, plugins/sudoers/policy.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoreplay.c, src/sudo.h:

  Refactor code in sudoers that creates I/O log files to share with
  logsrvd.
  [[059b55ce7]](https://git.sudo.ws/sudo/commit/?id=059b55ce7)

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in,
  lib/util/mkdir\_parents.c, lib/util/util.exp.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/sudoers.h:

  Move mkdir\_parents to libsudo\_util.
  [[e0c9a9dfa]](https://git.sudo.ws/sudo/commit/?id=e0c9a9dfa)

* MANIFEST, examples/sudo\_logsrvd.conf, logsrvd/Makefile.in,
  logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/logsrvd\_conf.c, pathnames.h.in:

  Add config file support for logsrvd
  [[a808dd45c]](https://git.sudo.ws/sudo/commit/?id=a808dd45c)

* configure, configure.ac, include/sudo\_rand.h, logsrvd/Makefile.in,
  logsrvd/logsrvd.c:

  Command line option processing for logsrvd
  [[240d58913]](https://git.sudo.ws/sudo/commit/?id=240d58913)

* logsrvd/Makefile.in, logsrvd/iolog\_writer.c, logsrvd/logsrvd.c,
  logsrvd/logsrvd.h, logsrvd/sendlog.c, logsrvd/sendlog.h:

  Add support for restarting I/O log transfers.
  [[e76d2e820]](https://git.sudo.ws/sudo/commit/?id=e76d2e820)

* MANIFEST, doc/LICENSE, logsrvd/Makefile.in,
  logsrvd/protobuf-c/protobuf-c.c, logsrvd/protobuf-c/protobuf-c.h:

  Import protobuf-c source since to avoid an external dependency. The
  files generated with protoc-c are not standalone. We need to include
  protobuf-c.c and protobuf-c.h from the protobuf-c distribution too.
  Building protoc-c requires a relative recent version of gcc which limits
  its portability.
  [[8a16e62a8]](https://git.sudo.ws/sudo/commit/?id=8a16e62a8)

* logsrvd/iolog\_writer.c, logsrvd/logsrvd.c, logsrvd/sendlog.c:

  Add debugging for logsrvd and sendlog
  [[706553f9d]](https://git.sudo.ws/sudo/commit/?id=706553f9d)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/openat.c, lib/util/unlinkat.c, src/sudo\_edit.c:

  Move openat() emulation to lib/util and at unlinkat() emulation.
  [[0d69de5b2]](https://git.sudo.ws/sudo/commit/?id=0d69de5b2)

* MANIFEST, logsrvd/Makefile.in, logsrvd/iolog.h, logsrvd/iolog\_reader.c,
  logsrvd/iolog\_writer.c, logsrvd/logsrvd.h, logsrvd/sendlog.c,
  logsrvd/sendlog.h, mkdep.pl, plugins/sudoers/Makefile.in,
  plugins/sudoers/iolog.h, plugins/sudoers/iolog\_util.c,
  plugins/sudoers/iolog\_util.h,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/iolog\_util/check\_iolog\_util.c,
  plugins/sudoers/sudoreplay.c:

  Refactor I/O log code so it can be shared between sudoers and logsrvd
  [[4dacf8108]](https://git.sudo.ws/sudo/commit/?id=4dacf8108)

* MANIFEST, Makefile.in, configure, configure.ac, logsrvd/Makefile.in,
  logsrvd/iolog.h, logsrvd/iolog\_reader.c, logsrvd/iolog\_writer.c,
  logsrvd/log\_server.pb-c.c, logsrvd/log\_server.pb-c.h,
  logsrvd/log\_server.proto, logsrvd/logsrvd.c, logsrvd/logsrvd.h,
  logsrvd/sendlog.c, logsrvd/sendlog.h, sudo.pp:

  Import proof of concept sudo log server.
  [[227243071]](https://git.sudo.ws/sudo/commit/?id=227243071)

* lib/util/strtonum.c:

  Avoid invalid read when minval > maxval
  [[aa9959457]](https://git.sudo.ws/sudo/commit/?id=aa9959457)

2019-10-23 Todd C. Miller

* NEWS, plugins/sudoers/policy.c, src/sudo.c:

  Don’t pass an invalid session or process group ID to the plugin. Fixes a
  regression in 1.8.28 when there is no terminal session leader.
  [[271ead2fd]](https://git.sudo.ws/sudo/commit/?id=271ead2fd)

2019-10-21 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[0375eaca5]](https://git.sudo.ws/sudo/commit/?id=0375eaca5)

* src/limits.c:

  Not all systems support RLIMIT\_NPROC and RLIMIT\_RSS
  [[5391ee2d5]](https://git.sudo.ws/sudo/commit/?id=5391ee2d5)

* NEWS, configure, configure.ac, doc/UPGRADE:

  Sudo 1.8.29
  [[8ea71f9ae]](https://git.sudo.ws/sudo/commit/?id=8ea71f9ae)

* doc/Makefile.in, examples/Makefile.in, include/Makefile.in,
  lib/util/Makefile.in, lib/zlib/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  Add depend target to all Makefile.in files.
  [[b157b9689]](https://git.sudo.ws/sudo/commit/?id=b157b9689)

* MANIFEST, lib/util/Makefile.in, src/Makefile.in, src/exec.c,
  src/limits.c, src/sudo.c, src/sudo.h:

  Set resource limits in the sudo process to unlimited. We don’t want sudo
  to be limited by the caller’s resource limits. The original resource
  limits are restore before session setup.
  [[e80079eaa]](https://git.sudo.ws/sudo/commit/?id=e80079eaa)

2019-10-20 Todd C. Miller

* plugins/sudoers/starttime.c, src/ttyname.c:

  Older FreeBSD needs sys/param.h included before sys/user.h. From Darren
  Tucker
  [[f57e2d04a]](https://git.sudo.ws/sudo/commit/?id=f57e2d04a)

2019-10-19 Todd C. Miller

* doc/UPGRADE, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in,
  doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudo\_plugin.man.in,
  doc/sudo\_plugin.mdoc.in, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  doc/sudoers\_timestamp.man.in, doc/sudoers\_timestamp.mdoc.in,
  doc/visudo.man.in, doc/visudo.mdoc.in,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/iolog.c,
  plugins/sudoers/ldap.c, plugins/sudoers/policy.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/sssd.c,
  plugins/sudoers/testsudoers.c, src/exec.c:

  Refer to user-ID and group-ID instead of “user ID” and “group ID”
  [[c3ce3a84f]](https://git.sudo.ws/sudo/commit/?id=c3ce3a84f)

2019-10-20 Todd C. Miller

* include/sudo\_util.h, lib/util/getgrouplist.c, lib/util/gidlist.c,
  lib/util/regress/strtofoo/strtoid\_test.c, lib/util/strtoid.c,
  lib/util/util.exp.in, plugins/group\_file/getgrent.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/iolog.c,
  plugins/sudoers/match.c, plugins/sudoers/policy.c,
  plugins/sudoers/pwutil.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/tsgetgrpw.c, plugins/sudoers/visudo.c,
  plugins/system\_group/system\_group.c, src/sudo.c:

  Rename sudo\_strtoid() to sudo\_strtoidx() and add simplified
  sudo\_strtoid()
  [[40bf4081b]](https://git.sudo.ws/sudo/commit/?id=40bf4081b)

2019-10-18 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  sudoedit doesn’t create a new PAM session so PAM umask does not apply.
  [[6260bf60b]](https://git.sudo.ws/sudo/commit/?id=6260bf60b)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, include/sudo\_plugin.h, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h, src/exec.c,
  src/sudo.c, src/sudo.h:

  Change how the umask is handled with PAM and login.conf. If the umask is
  explicitly set in sudoers, use that value regardless of what is in PAM
  or login.conf. If using the default umask from sudoers, allow PAM or
  login.conf to override it. [Bug
  #900](https://bugzilla.sudo.ws/show_bug.cgi?id=900)
  [[b02851dcf]](https://git.sudo.ws/sudo/commit/?id=b02851dcf)

2019-10-17 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/audit.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/logging.c:

  Add log\_allowed and log\_denied sudoers flags, defaulting to true.
  [[cf6c60c10]](https://git.sudo.ws/sudo/commit/?id=cf6c60c10)

* lib/util/Makefile.in, plugins/sudoers/Makefile.in, src/Makefile.in:

  Enable security auditing malloc options for “make check”.
  [[4229dfc56]](https://git.sudo.ws/sudo/commit/?id=4229dfc56)

2019-10-16 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Be more consistent with how we talk about sudoers Defaults settings. Use
  “flag” not “option” when referring to boolean flags. Use “setting” in
  place of “Defaults setting” in most places. Use “the foo option” instead
  of “sudo’s foo option” for command line options.
  [[8761217f8]](https://git.sudo.ws/sudo/commit/?id=8761217f8)

* plugins/sudoers/Makefile.in:

  No need to check existing sudoers file when installing to DESTDIR This
  check can cause problems on systems where /etc/sudoers.d is not
  readable.
  [[cf2f37136]](https://git.sudo.ws/sudo/commit/?id=cf2f37136)

* lib/util/str2sig.c:

  Inclue sudo\_util.h to get sudo\_strtonum() prototype.
  [[43e44a998]](https://git.sudo.ws/sudo/commit/?id=43e44a998)

* lib/util/str2sig.c:

  strtonum -> sudo\_strtonum
  [[f5a7585a4]](https://git.sudo.ws/sudo/commit/?id=f5a7585a4)

* MANIFEST:

  Add split out strtofoo tests.
  [[d5ea5b7fb]](https://git.sudo.ws/sudo/commit/?id=d5ea5b7fb)

* lib/util/strtonum.c:

  Make sure we don’t go past the end of the string when out of range.
  [[1037b685e]](https://git.sudo.ws/sudo/commit/?id=1037b685e)

* lib/util/regress/strtofoo/strtonum\_test.c, lib/util/strtonum.c:

  Fix stronum() regress test and the errno value for out of range numbers.
  [[e339d9950]](https://git.sudo.ws/sudo/commit/?id=e339d9950)

* lib/util/Makefile.in, lib/util/regress/strtofoo/strtobool\_test.c,
  lib/util/regress/strtofoo/strtoid\_test.c,
  lib/util/regress/strtofoo/strtomode\_test.c,
  lib/util/regress/strtofoo/strtonum\_test.c:

  Split atofoo.c regress into multiple tests.
  [[29afe160a]](https://git.sudo.ws/sudo/commit/?id=29afe160a)

* NEWS, configure, configure.ac:

  Sudo 1.8.28p1
  [[b6aa80b5f]](https://git.sudo.ws/sudo/commit/?id=b6aa80b5f)

2019-10-15 Todd C. Miller

* plugins/sudoers/parse.c:

  The fix for bug #869 broke “sudo -v” when verifypw=all (the default)
  [[d494b8155]](https://git.sudo.ws/sudo/commit/?id=d494b8155)

2019-10-14 Todd C. Miller

* include/sudo\_compat.h, include/sudo\_util.h, lib/util/Makefile.in,
  lib/util/closefrom.c, lib/util/getaddrinfo.c, lib/util/strtonum.c,
  lib/util/sudo\_conf.c, lib/util/ttysize.c, plugins/sudoers/boottime.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/defaults.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_util.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/policy.c, plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/starttime/check\_starttime.c, src/parse\_args.c,
  src/sesh.c, src/sudo.c, src/ttyname.c:

  Use sudo\_strtonum() explicitly instead of via a macro.
  [[2512f6efb]](https://git.sudo.ws/sudo/commit/?id=2512f6efb)

* config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/strtoid.c, lib/util/strtonum.c,
  lib/util/util.exp.in, mkdep.pl:

  Always use our own strtonum and implement sudo\_strtoid in terms of it.
  [[04a17095b]](https://git.sudo.ws/sudo/commit/?id=04a17095b)

* plugins/sudoers/pwutil.c:

  Use errno in warning when sudo\_make\_\*\_item() fails. Previously we always
  said “out of memory” if not ENOENT.
  [[9d5867eae]](https://git.sudo.ws/sudo/commit/?id=9d5867eae)

* plugins/sudoers/Makefile.in, plugins/sudoers/parse\_ldif.c,
  plugins/sudoers/regress/cvtsudoers/test26.err.ok,
  plugins/sudoers/regress/cvtsudoers/test26.sh:

  Reject non-LDIF input when converting from LDIF to sudoers or JSON.
  [[3edd6afed]](https://git.sudo.ws/sudo/commit/?id=3edd6afed)

2019-09-05 Todd C. Miller

* plugins/sudoers/parse\_ldif.c:

  More case-insensitive compare for LDAP attributes and string lists. Only
  the ALL keyword should be compared case-sensitive.
  [[8e58e6715]](https://git.sudo.ws/sudo/commit/?id=8e58e6715)

2019-10-10 Todd C. Miller

* plugins/sudoers/po/ca.mo, plugins/sudoers/po/da.mo,
  plugins/sudoers/po/el.mo, plugins/sudoers/po/eu.mo,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fur.mo,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hu.mo,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/lt.mo,
  plugins/sudoers/po/nl.mo, plugins/sudoers/po/ru.mo,
  plugins/sudoers/po/sk.mo, plugins/sudoers/po/sl.mo,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/tr.mo,
  plugins/sudoers/po/zh\_CN.mo, po/ast.mo, po/ca.mo, po/es.mo, po/eu.mo,
  po/fi.mo, po/fur.mo, po/gl.mo, po/hr.mo, po/hu.mo, po/ko.mo, po/nl.mo,
  po/nn.mo, po/ru.mo, po/sk.mo, po/sl.mo, po/sr.mo, po/sudo.pot, po/vi.mo,
  po/zh\_CN.mo:

  regen
  [[208a52c61]](https://git.sudo.ws/sudo/commit/?id=208a52c61)

* lib/util/regress/atofoo/atofoo\_test.c,
  plugins/sudoers/regress/testsudoers/test5.out.ok,
  plugins/sudoers/regress/testsudoers/test5.sh:

  Add sudo\_strtoid() tests for -1 and range errors. Also adjust
  testsudoers/test5 which relied upon gid -1 parsing.
  [[396bc57fe]](https://git.sudo.ws/sudo/commit/?id=396bc57fe)

* NEWS, lib/util/strtoid.c:

  Treat an ID of -1 as invalid since that means “no change”. Fixes
  CVE-2019-14287. Found by Joe Vennix from Apple Information Security.
  [[f752ae5ce]](https://git.sudo.ws/sudo/commit/?id=f752ae5ce)

2019-10-06 Todd C. Miller

* INSTALL, configure, configure.ac:

  Back out compiler override for now.
  [[fd5d0f511]](https://git.sudo.ws/sudo/commit/?id=fd5d0f511)

* configure, configure.ac:

  Only prefer clang over gcc on BSD systems.
  [[364821602]](https://git.sudo.ws/sudo/commit/?id=364821602)

2019-10-05 Todd C. Miller

* Makefile.in:

  Fix “make pvs-studio” run in a build dir
  [[c64add170]](https://git.sudo.ws/sudo/commit/?id=c64add170)

2019-09-27 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[45a79cf86]](https://git.sudo.ws/sudo/commit/?id=45a79cf86)

* NEWS:

  [Bug #898](https://bugzilla.sudo.ws/show_bug.cgi?id=898)
  [[ab6cfc404]](https://git.sudo.ws/sudo/commit/?id=ab6cfc404)

* src/exec.c, src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c,
  src/selinux.c, src/sudo.c, src/sudo.h:

  Fix restoring the file context of the user’s tty with SELinux. Also fix
  broken tty labeling when running a command in a pty. Includes a fix for
  a typo introduced in the last change set.
  [[112dff276]](https://git.sudo.ws/sudo/commit/?id=112dff276)

* lib/util/arc4random.c:

  \_rs\_random\_buf is currently unused
  [[b7b3fb72d]](https://git.sudo.ws/sudo/commit/?id=b7b3fb72d)

* src/selinux.c:

  Add some debugging around context setting and tty labeling Also be more
  extact with error return values
  [[bcf8c3dd5]](https://git.sudo.ws/sudo/commit/?id=bcf8c3dd5)

2019-09-21 Todd C. Miller

* lib/util/sudo\_debug.c:

  Better error message when debug log file cannot be opened.
  [[73dd3849c]](https://git.sudo.ws/sudo/commit/?id=73dd3849c)

2019-09-20 Todd C. Miller

* .hgignore:

  Ignore in-tree build directory.
  [[81a30dd44]](https://git.sudo.ws/sudo/commit/?id=81a30dd44)

* configure, configure.ac:

  Set CC before AC\_USE\_SYSTEM\_EXTENSIONS to get our preferred compiler.
  [[7355363d6]](https://git.sudo.ws/sudo/commit/?id=7355363d6)

2019-09-19 Todd C. Miller

* pp:

  Update Polypkg to the latest version from git.
  [[de87774ea]](https://git.sudo.ws/sudo/commit/?id=de87774ea)

* configure, configure.ac:

  If no mandoc or nroff is present, install mdoc format manuals. If there
  is no installed nroff/mandoc they will need to install groff or heirloom
  doctools to format the manual pages.
  [[0faf5eed7]](https://git.sudo.ws/sudo/commit/?id=0faf5eed7)

2019-09-18 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in, include/sudo\_plugin.h:

  Refer to number of terminal lines, not rows, for consistency.
  [[984382f8a]](https://git.sudo.ws/sudo/commit/?id=984382f8a)

2019-09-17 Todd C. Miller

* INSTALL, configure, configure.ac:

  Prefer clang over gcc. We want to use clang on systems where clang is
  the system compiler. It is less common to have clang installed on
  systems where gcc is the system compiler.
  [[e49e8c1e8]](https://git.sudo.ws/sudo/commit/?id=e49e8c1e8)

* INSTALL:

  No longer need bypass\_last\_login on HP-UX, warnings work with clang.
  Also add deb package names for pam and ldap devel on Linux.
  [[2707acf23]](https://git.sudo.ws/sudo/commit/?id=2707acf23)

* src/parse\_args.c:

  Silence a warning from clang about string concatenation.
  [[d35670d1a]](https://git.sudo.ws/sudo/commit/?id=d35670d1a)

2019-09-14 Todd C. Miller

* NEWS, doc/UPGRADE:

  sudoedit umask fix
  [[b2fadf66d]](https://git.sudo.ws/sudo/commit/?id=b2fadf66d)

2019-09-13 Todd C. Miller

* lib/util/event.c:

  Fix sorting of the time-based event queue.
  [[8c96df036]](https://git.sudo.ws/sudo/commit/?id=8c96df036)

* lib/util/event.c:

  Support default base in got\_exit, got\_break, loopexit, loopbreak,
  loopcontinue
  [[751c0c444]](https://git.sudo.ws/sudo/commit/?id=751c0c444)

2019-09-11 Todd C. Miller

* src/sudo\_edit.c:

  Create new files with the umask specified in sudoers.
  [[ab9a2ecac]](https://git.sudo.ws/sudo/commit/?id=ab9a2ecac)

2019-08-30 Todd C. Miller

* src/sudo.h:

  Enable asserts for Coverity too.
  [[d94798e5d]](https://git.sudo.ws/sudo/commit/?id=d94798e5d)

* src/parse\_args.c, src/sudo.h:

  Add asserts() to avoid static analyzer false positives.
  [[ffaef7939]](https://git.sudo.ws/sudo/commit/?id=ffaef7939)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Plug memory leak on malloc failure.
  [[679cd3823]](https://git.sudo.ws/sudo/commit/?id=679cd3823)

* plugins/sudoers/ldap\_util.c:

  Plug memory leak on malloc failure.
  [[dd37f0836]](https://git.sudo.ws/sudo/commit/?id=dd37f0836)

2019-08-29 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  Add sudo\_pam\_strerror(), like pam\_strerror() but never returns NULL. It
  also uses strerror(errno) for PAM\_SYSTEM\_ERR.
  [[5138ed9be]](https://git.sudo.ws/sudo/commit/?id=5138ed9be)

* plugins/sudoers/auth/pam.c:

  If pam\_start() fails, display the PAM error using pam\_strerror(). It is
  legal to pass pam\_strerror() a NULL handle.
  [[60862b4d0]](https://git.sudo.ws/sudo/commit/?id=60862b4d0)

2019-08-27 Todd C. Miller

* doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  plugins/sudoers/sudoreplay.c:

  If the sudoreplay ID option is a fully-qualified path, use it directly.
  Previously, one had to use the -d option to override the I/O log
  directory.
  [[9eeedb470]](https://git.sudo.ws/sudo/commit/?id=9eeedb470)

* plugins/sudoers/Makefile.in:

  regen
  [[91d508d40]](https://git.sudo.ws/sudo/commit/?id=91d508d40)

* MANIFEST, doc/sudo.conf.man.in.sed:

  Add conditional for sesh path in sudo.conf manual.
  [[eb95a35ed]](https://git.sudo.ws/sudo/commit/?id=eb95a35ed)

2019-08-26 Todd C. Miller

* NEWS:

  [Bug #895](https://bugzilla.sudo.ws/show_bug.cgi?id=895)
  [[62bb4aa63]](https://git.sudo.ws/sudo/commit/?id=62bb4aa63)

* plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/check.c, plugins/sudoers/sudo\_printf.c,
  src/conversation.c:

  Use the SUDO\_CONV\_PREFER\_TTY flag during authentication. This prevents
  the password and PAM prompts from being redirected. [Bug
  #895](https://bugzilla.sudo.ws/show_bug.cgi?id=895)
  [[972670bfc]](https://git.sudo.ws/sudo/commit/?id=972670bfc)

2019-08-23 Todd C. Miller

* mkpkg:

  Fix typo that prevented a missing linux audit lib from being detected.
  [[5a2286513]](https://git.sudo.ws/sudo/commit/?id=5a2286513)

2019-08-20 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Use fputs(), not printf() for plain strings.
  [[2087f6354]](https://git.sudo.ws/sudo/commit/?id=2087f6354)

* NEWS:

  Recent fixes.
  [[e3967dc7d]](https://git.sudo.ws/sudo/commit/?id=e3967dc7d)

* plugins/sudoers/ldap.c:

  Add user ID to the search filter when matching sudoUser. We already
  support group IDs but the user ID was missing. From
  sudo-1.8.23-ldapsearchuidfix.patch in RHEL 7.
  [[a7cd4f0d4]](https://git.sudo.ws/sudo/commit/?id=a7cd4f0d4)

* plugins/sudoers/regress/sudoers/test2.json.ok,
  plugins/sudoers/regress/sudoers/test2.toke.ok, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Fix parsing of double-quoted Defaults bindings that start with % or +.
  From sudo-1.8.23-fix-double-quote-parsing-for-Defaults-values.patch in
  RHEL 7.
  [[37670a008]](https://git.sudo.ws/sudo/commit/?id=37670a008)

* src/exec.c:

  Restore core dump resource limit before the PAM session module is run.
  Otherwise, we may override the limits set by PAM. [Bug
  #894](https://bugzilla.sudo.ws/show_bug.cgi?id=894)
  [[5e692576c]](https://git.sudo.ws/sudo/commit/?id=5e692576c)

2019-08-19 Todd C. Miller

* lib/util/sig2str.c, lib/util/str2sig.c:

  sys\_signame on macOS contains lower-cases names
  [[b98b82e4a]](https://git.sudo.ws/sudo/commit/?id=b98b82e4a)

* MANIFEST, configure, configure.ac, lib/util/Makefile.in,
  lib/util/regress/strsig/strsig\_test.c:

  Add regress tests for str2sig() and sig2str().
  [[0bbfdc992]](https://git.sudo.ws/sudo/commit/?id=0bbfdc992)

* lib/util/str2sig.c:

  SIGIOT and SIGABRT are aliases on BSD systems.
  [[48066e0db]](https://git.sudo.ws/sudo/commit/?id=48066e0db)

* lib/util/sig2str.c, lib/util/str2sig.c:

  Fix handling of real-time signals.
  [[29534ad96]](https://git.sudo.ws/sudo/commit/?id=29534ad96)

2019-08-16 Todd C. Miller

* NEWS:

  ipa\_hostname fix
  [[9f7db2df2]](https://git.sudo.ws/sudo/commit/?id=9f7db2df2)

2019-08-15 Todd C. Miller

* plugins/sudoers/file.c, plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/ldap.c, plugins/sudoers/match.c,
  plugins/sudoers/parse.h, plugins/sudoers/sssd.c:

  Fix special handling of ipa\_hostname that was lost in sudo 1.8.24. We
  now include the long and short hostname in sudo parser container.
  [[e99082e05]](https://git.sudo.ws/sudo/commit/?id=e99082e05)

2019-08-14 Todd C. Miller

* plugins/sudoers/iolog\_event.h:

  Remove unused include file.
  [[b4bef30d3]](https://git.sudo.ws/sudo/commit/?id=b4bef30d3)

2019-08-05 Todd C. Miller

* NEWS, doc/UPGRADE:

  Mention I/O log signal change in NEWS and UPGRADE files.
  [[44e990c2a]](https://git.sudo.ws/sudo/commit/?id=44e990c2a)

* MANIFEST, NEWS, plugins/sudoers/po/ast.mo, plugins/sudoers/po/ast.po:

  Asturian translation for sudoers from translationproject.org.
  [[7a7f02a7e]](https://git.sudo.ws/sudo/commit/?id=7a7f02a7e)

* mkdep.pl:

  Check source dir if source file is not listed in MANIFEST. Previously,
  we just used the file name without $(srcdir).
  [[37887c154]](https://git.sudo.ws/sudo/commit/?id=37887c154)

* MANIFEST, config.h.in, configure, configure.ac, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, include/sudo\_compat.h, lib/util/Makefile.in,
  lib/util/str2sig.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_util.c:

  Store signal name, not number in I/O log timing file. The “SIG” prefix
  is not used so, e.g. SIGTERM -> “TERM”. This makes the I/O log files
  portable from one system to another. Older I/O log files with signal
  numbers can still be replayed.
  [[3e56be356]](https://git.sudo.ws/sudo/commit/?id=3e56be356)

2019-07-30 Todd C. Miller

* src/utmp.c:

  Disable stringop-truncation false positive warnings on gcc 8. Strings in
  struct utmp/utmpx are not guaranteed to be NUL-terminated.
  [[dfc32e5b3]](https://git.sudo.ws/sudo/commit/?id=dfc32e5b3)

* plugins/group\_file/plugin\_test.c, src/net\_ifs.c:

  Replace non-essential strncpy() calls.
  [[aa200cda6]](https://git.sudo.ws/sudo/commit/?id=aa200cda6)

2019-07-26 Todd C. Miller

* configure, configure.ac:

  Revert version back to 1.8.28
  [[aa73c86a5]](https://git.sudo.ws/sudo/commit/?id=aa73c86a5)

* lib/util/Makefile.in:

  Link util functions being tested directly with the test harness.
  Otherwise we may get the version from the installed libsudo\_util.so.
  [[e91865fb2]](https://git.sudo.ws/sudo/commit/?id=e91865fb2)

2019-07-23 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt.mo, plugins/sudoers/po/pt.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/zh\_TW.mo,
  plugins/sudoers/po/zh\_TW.po, po/cs.mo, po/cs.po, po/da.mo, po/da.po,
  po/de.mo, po/de.po, po/eo.mo, po/eo.po, po/fr.mo, po/fr.po, po/it.mo,
  po/it.po, po/ja.mo, po/ja.po, po/nb.mo, po/nb.po, po/pl.mo, po/pl.po,
  po/pt.mo, po/pt.po, po/pt\_BR.mo, po/pt\_BR.po, po/sv.mo, po/sv.po,
  po/tr.mo, po/tr.po, po/uk.mo, po/uk.po, po/zh\_TW.mo, po/zh\_TW.po:

  Updated translations from translationproject.org
  [[711794842]](https://git.sudo.ws/sudo/commit/?id=711794842)

2019-07-19 Todd C. Miller

* configure, configure.ac, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/parse.c:

  Use strftime(3) instead of formatting struct tm by hand. Fixes a warning
  on newer versions of gcc.
  [[5e424640b]](https://git.sudo.ws/sudo/commit/?id=5e424640b)

* doc/sudo.man.in, doc/sudo.mdoc.in:

  Update error message when the password cannot be read from the terminal.
  [[6f3d826f8]](https://git.sudo.ws/sudo/commit/?id=6f3d826f8)

* NEWS:

  Fix for [Bug #888](https://bugzilla.sudo.ws/show_bug.cgi?id=888)
  [[f63424111]](https://git.sudo.ws/sudo/commit/?id=f63424111)

* plugins/sudoers/match\_command.c, plugins/sudoers/match\_digest.c:

  If the command in sudoers does not exist on the file system, match by
  name. We still want to match the command even if it doesn’t exist so
  that the NOPASSWD flag on sudoers entries with non-existant paths works
  as expected. [Bug #888](https://bugzilla.sudo.ws/show_bug.cgi?id=888).
  [[a7137a522]](https://git.sudo.ws/sudo/commit/?id=a7137a522)

* NEWS, doc/TROUBLESHOOTING, po/sudo.pot, src/tgetpass.c:

  More verbose error message when a password is required and no terminal
  is present. [Bug #828](https://bugzilla.sudo.ws/show_bug.cgi?id=828).
  [[15db0c3f8]](https://git.sudo.ws/sudo/commit/?id=15db0c3f8)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[3c825e298]](https://git.sudo.ws/sudo/commit/?id=3c825e298)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document that PAM session modules are now run with the silent flag.
  [[6e0f7166e]](https://git.sudo.ws/sudo/commit/?id=6e0f7166e)

2019-07-14 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Simpler change to retry sudo\_secure\_file() as root as needed.
  [[c49760e55]](https://git.sudo.ws/sudo/commit/?id=c49760e55)

* plugins/sudoers/sudoers.c:

  If we are unable to stat() sudoers as non-root, try again as root. By
  default, sudo relies soley on group permissions to read sudoers to make
  it possible to store sudoers on NFS. However, if /etc/sudoers is not
  accessible to non-root uids for some reason, sudo will fail. [Bug
  #880](https://bugzilla.sudo.ws/show_bug.cgi?id=880).
  [[cecf69ff3]](https://git.sudo.ws/sudo/commit/?id=cecf69ff3)

2019-07-12 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Clarify that ttyin contains raw terminal input.
  [[10b5529a0]](https://git.sudo.ws/sudo/commit/?id=10b5529a0)

2019-07-11 Todd C. Miller

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Expand the description of the I/O log files.
  [[03ba6426e]](https://git.sudo.ws/sudo/commit/?id=03ba6426e)

* doc/sudo.conf.mdoc.in:

  Remove trailing whitespace.
  [[679f13ef5]](https://git.sudo.ws/sudo/commit/?id=679f13ef5)

2019-07-03 Todd C. Miller

* configure, configure.ac, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in:

  Rename PLUGINDIR -> plugindir
  [[bb024cf09]](https://git.sudo.ws/sudo/commit/?id=bb024cf09)

* configure, configure.ac:

  Use $libexecdir in default settings used by the documentation. The web
  and pdf pages will substitute /usr/local/libexec for $noexec\_file. Also
  do substitution of variables using exec\_prefix even if we don’t use them
  in the Makefile since the documentation may reference them.
  [[caceced2f]](https://git.sudo.ws/sudo/commit/?id=caceced2f)

* doc/Makefile.in, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  Add conditional for sesh path in sudo.conf manual.
  [[cd258e1d3]](https://git.sudo.ws/sudo/commit/?id=cd258e1d3)

* configure, configure.ac:

  Update plugindir even when –disable-shared is specified. Otherwise, the
  default value is substituted into the Makefiles and documentation which
  may not match –prefix. [Bug
  #886](https://bugzilla.sudo.ws/show_bug.cgi?id=886)
  [[6e497be93]](https://git.sudo.ws/sudo/commit/?id=6e497be93)

2019-06-25 Todd C. Miller

* include/sudo\_util.h, lib/util/fatal.c, lib/util/inet\_ntop.c,
  lib/util/regress/vsyslog/vsyslog\_test.c, lib/util/sudo\_debug.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/logging.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/timestamp.c, src/load\_plugins.c, src/net\_ifs.c,
  src/sudo.c:

  Add ssizeof macro that returns ssize\_t. We can use this instead of
  casting the result of size\_t to int. Also change checks for snprintf()
  returning <=0 to <0.
  [[9d8f37439]](https://git.sudo.ws/sudo/commit/?id=9d8f37439)

2019-06-21 Todd C. Miller

* doc/TROUBLESHOOTING, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  sudoedit should be used for editing files instead of “sudo editor” That
  way the user’s editor config files are used by the editor.
  [[81602ad08]](https://git.sudo.ws/sudo/commit/?id=81602ad08)

* doc/TROUBLESHOOTING:

  Move the section on HOME to be after the environment section. Also
  strongly discourage the disabling of env\_reset.
  [[1fe9644f5]](https://git.sudo.ws/sudo/commit/?id=1fe9644f5)

2019-06-20 Todd C. Miller

* doc/TROUBLESHOOTING:

  Remove the Solaris last login question, add one about HOME. The PAM
  session is opened with PAM\_SILENT so last login info is not printed. It
  is dangerous to preserve HOME from the user’s environment.
  [[2d8949198]](https://git.sudo.ws/sudo/commit/?id=2d8949198)

* doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, doc/sudo\_plugin.man.in,
  doc/sudo\_plugin.mdoc.in, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Use the term pseudo-terminal more consistently.
  [[a45732528]](https://git.sudo.ws/sudo/commit/?id=a45732528)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document why HOME should not be preserved from the user’s environment.
  Text was adapted from what is already present in the UPGRADE file. Also
  mark set\_home and always\_set\_home as obsolete.
  [[ee214e526]](https://git.sudo.ws/sudo/commit/?id=ee214e526)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Refer to command line options, not flags.
  [[e11fa62cd]](https://git.sudo.ws/sudo/commit/?id=e11fa62cd)

* NEWS:

  sync
  [[646f09d74]](https://git.sudo.ws/sudo/commit/?id=646f09d74)

* doc/TROUBLESHOOTING:

  sudo will now prompt for a password as long as /dev/tty is available.
  [[c1fc4e6be]](https://git.sudo.ws/sudo/commit/?id=c1fc4e6be)

* MANIFEST, configure, configure.ac, doc/Makefile.in, doc/cvtsudoers.cat,
  doc/sudo.cat, doc/sudo.conf.cat, doc/sudo\_plugin.cat, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoers\_timestamp.cat, doc/sudoreplay.cat,
  doc/visudo.cat:

  Remove .cat pages, there is no need for them in the modern world. Sudo
  only shipped .cat pages for Irix, which lacked nroff. Irix is long dead
  and there are multiple open source nroff options.
  [[71fdb8e03]](https://git.sudo.ws/sudo/commit/?id=71fdb8e03)

* INSTALL, configure.ac, doc/sudoers.cat, doc/visudo.cat:

  Make env\_editor the default. It is already the default in the package
  script.
  [[184484b21]](https://git.sudo.ws/sudo/commit/?id=184484b21)

* INSTALL, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Don’t describe env\_editor as a security hole. Users that are able to
  edit sudoers can grant themselves permissions so the fact that visudo
  runs the editor as root is not a security issue.
  [[958cf7e37]](https://git.sudo.ws/sudo/commit/?id=958cf7e37)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Fix details of how EDITOR, VISUAL and SUDO\_EDITOR are (or are not)
  preserved. The description in the editor option was incorrect and didn’t
  mention env\_keep. Reported by Sander Bos
  [[6fe222329]](https://git.sudo.ws/sudo/commit/?id=6fe222329)

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Modern visudo locks the actual sudoers file, not the sudoers.tmp file.
  Refer to sudoers.tmp as a temporary file, not a lock file. Reported by
  Sander Bos
  [[a193f39c8]](https://git.sudo.ws/sudo/commit/?id=a193f39c8)

2019-06-19 Todd C. Miller

* plugins/sudoers/sudoers.c:

  In tty\_present(), check for /dev/tty if sudo was unable to get the tty
  name. For requiretty it is enough to check that /dev/tty is available.
  If sudo can’t get the tty from the kernel (missing /proc?) that is OK.
  [[29223d7f6]](https://git.sudo.ws/sudo/commit/?id=29223d7f6)

* src/tgetpass.c:

  Don’t refuse to use the tty unless /dev/tty is unavailable. We don’t
  care whether sudo was able to get the tty name from the kernel. All that
  really matters is whether we are able to disable echo as needed.
  [[82920726f]](https://git.sudo.ws/sudo/commit/?id=82920726f)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Use of “they” was ambiguous.
  [[7ce9b8008]](https://git.sudo.ws/sudo/commit/?id=7ce9b8008)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Better description of secure\_path. The secure\_path option affects the
  resolution of unqualified commands as well as the environment that
  commands run with.
  [[05f9643b8]](https://git.sudo.ws/sudo/commit/?id=05f9643b8)

* doc/CONTRIBUTORS:

  Add Sander Bos
  [[030441609]](https://git.sudo.ws/sudo/commit/?id=030441609)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Fix a few typos and awkward wording. Use the singular “they” instead of
  he/she. Add back missing text in description of variables starting with
  (). Based on changes from Sander Bos.
  [[7d5b1e3b1]](https://git.sudo.ws/sudo/commit/?id=7d5b1e3b1)

2019-06-15 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Clarify which environment variables are set based on the target user.
  [[cb4ded8fb]](https://git.sudo.ws/sudo/commit/?id=cb4ded8fb)

2019-06-10 Todd C. Miller

* lib/util/Makefile.in:

  libsudo\_util depends on LT\_DEP\_LIBS even when building a static lib
  [[5d4142f29]](https://git.sudo.ws/sudo/commit/?id=5d4142f29)

* aclocal.m4, config.h.in, configure, configure.ac, lib/util/arc4random.c:
  Solaris getentropy() requires that sys/random.h be included.
  [[81c6cac81]](https://git.sudo.ws/sudo/commit/?id=81c6cac81)

2019-05-29 Todd C. Miller

* plugins/sudoers/parse.c:

  Use the runhost for “User foo is not allowed to run sudo on bar.”
  Otherwise, if the -h option is specified sudo will print the local host
  name instead of the host specified via -h.
  [[12c29e91b]](https://git.sudo.ws/sudo/commit/?id=12c29e91b)

2019-05-28 Todd C. Miller

* doc/TROUBLESHOOTING:

  Document that “no tty present and no askpass program specified” may
  happen when /proc is not accessible.
  [[948007e77]](https://git.sudo.ws/sudo/commit/?id=948007e77)

2019-05-27 Todd C. Miller

* doc/CONTRIBUTORS:

  Add Sangamesh Mallayya and Michael Spradling
  [[d63fe33d1]](https://git.sudo.ws/sudo/commit/?id=d63fe33d1)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, src/parse\_args.c,
  src/sudo.h, src/tgetpass.c:

  Add -B option to ring the bell before the password prompt.
  [[19c548fd5]](https://git.sudo.ws/sudo/commit/?id=19c548fd5)

* plugins/sudoers/auth/aix\_auth.c:

  Allow the user to change their password if expired on AIX. [Bug
  #883](https://bugzilla.sudo.ws/show_bug.cgi?id=883)
  [[dae484213]](https://git.sudo.ws/sudo/commit/?id=dae484213)

2019-05-26 Todd C. Miller

* plugins/sudoers/auth/aix\_auth.c:

  When using AIX auth, don’t display the AIX password incorrect message.
  Avoids a “3004-300 You entered an invalid login name or password”
  message in addition to sudo’s own “Sorry, try again” message.
  [[07ed5b86f]](https://git.sudo.ws/sudo/commit/?id=07ed5b86f)

2019-05-24 Todd C. Miller

* mkpkg:

  AIX packages were not being build with optimization enabled.
  [[8c9b23b0c]](https://git.sudo.ws/sudo/commit/?id=8c9b23b0c)

2019-05-22 Todd C. Miller

* plugins/sudoers/parse.c, plugins/sudoers/parse.h:

  Fix a typo.
  [[e28ba02c7]](https://git.sudo.ws/sudo/commit/?id=e28ba02c7)

* mkpkg:

  Support using macOS SDKs from /Library/Developer/CommandLineTools/SDKs
  [[19e2da8ee]](https://git.sudo.ws/sudo/commit/?id=19e2da8ee)

2019-05-16 Todd C. Miller

* lib/util/term.c:

  It is safe to assume \_POSIX\_VDISABLE is defined. The old compat defines
  were to support pre-termios systems.
  [[cd2cfeb8c]](https://git.sudo.ws/sudo/commit/?id=cd2cfeb8c)

2019-05-06 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  Remove second catopen() which is never called.
  [[30a5ee9c5]](https://git.sudo.ws/sudo/commit/?id=30a5ee9c5)

2019-05-01 Todd C. Miller

* doc/TROUBLESHOOTING:

  Sudo’s conversation functions now filters out the last login
  information.
  [[14e72b3ec]](https://git.sudo.ws/sudo/commit/?id=14e72b3ec)

2019-04-29 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/auth/pam.c, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c:

  Add pam\_acct\_mgmt setting to enable/disable PAM account validation.
  [[976550084]](https://git.sudo.ws/sudo/commit/?id=976550084)

* doc/cvtsudoers.cat, doc/sudo.cat, doc/sudo.conf.cat,
  doc/sudo\_plugin.cat, doc/sudoers.cat, doc/sudoers.ldap.cat,
  doc/sudoers\_timestamp.cat, doc/sudoreplay.cat, doc/visudo.cat:

  regen
  [[4b240c267]](https://git.sudo.ws/sudo/commit/?id=4b240c267)

* NEWS, configure, configure.ac:

  Sudo 1.8.28
  [[91b6d71a0]](https://git.sudo.ws/sudo/commit/?id=91b6d71a0)

* Makefile.in, configure.ac, doc/Makefile.in, doc/cvtsudoers.man.in,
  doc/cvtsudoers.mdoc.in, doc/fixman.sh, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, doc/sudoers\_timestamp.man.in,
  doc/sudoers\_timestamp.mdoc.in, doc/sudoreplay.man.in,
  doc/sudoreplay.mdoc.in, doc/visudo.man.in, doc/visudo.mdoc.in,
  examples/Makefile.in, include/Makefile.in, include/compat/charclass.h,
  include/compat/endian.h, include/compat/fnmatch.h,
  include/compat/getopt.h, include/compat/glob.h,
  include/compat/nss\_dbdefs.h, include/compat/sha2.h,
  include/sudo\_compat.h, include/sudo\_conf.h, include/sudo\_debug.h,
  include/sudo\_digest.h, include/sudo\_dso.h, include/sudo\_event.h,
  include/sudo\_fatal.h, include/sudo\_gettext.h, include/sudo\_lbuf.h,
  include/sudo\_plugin.h, include/sudo\_queue.h, include/sudo\_rand.h,
  include/sudo\_util.h, lib/util/Makefile.in, lib/util/aix.c,
  lib/util/arc4random.c, lib/util/arc4random.h,
  lib/util/arc4random\_uniform.c, lib/util/closefrom.c, lib/util/digest.c,
  lib/util/digest\_gcrypt.c, lib/util/digest\_openssl.c, lib/util/event.c,
  lib/util/event\_poll.c, lib/util/event\_select.c, lib/util/fatal.c,
  lib/util/fnmatch.c, lib/util/getcwd.c, lib/util/getdelim.c,
  lib/util/getentropy.c, lib/util/getgrouplist.c, lib/util/gethostname.c,
  lib/util/getopt\_long.c, lib/util/gettime.c, lib/util/gidlist.c,
  lib/util/glob.c, lib/util/inet\_ntop.c, lib/util/inet\_pton.c,
  lib/util/isblank.c, lib/util/key\_val.c, lib/util/lbuf.c,
  lib/util/locking.c, lib/util/memrchr.c, lib/util/memset\_s.c,
  lib/util/mksiglist.c, lib/util/mksigname.c, lib/util/mktemp.c,
  lib/util/nanosleep.c, lib/util/parseln.c, lib/util/pipe2.c,
  lib/util/progname.c, lib/util/pw\_dup.c, lib/util/reallocarray.c,
  lib/util/regress/atofoo/atofoo\_test.c,
  lib/util/regress/getdelim/getdelim\_test.c,
  lib/util/regress/getgrouplist/getgrouplist\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c,
  lib/util/regress/vsyslog/vsyslog\_test.c, lib/util/secure\_path.c,
  lib/util/setgroups.c, lib/util/sha2.c, lib/util/sig2str.c,
  lib/util/snprintf.c, lib/util/strlcat.c, lib/util/strlcpy.c,
  lib/util/strndup.c, lib/util/strnlen.c, lib/util/strsignal.c,
  lib/util/strsplit.c, lib/util/strtobool.c, lib/util/strtoid.c,
  lib/util/strtomode.c, lib/util/strtonum.c, lib/util/sudo\_conf.c,
  lib/util/sudo\_debug.c, lib/util/sudo\_dso.c, lib/util/term.c,
  lib/util/ttyname\_dev.c, lib/util/ttysize.c, lib/util/utimens.c,
  lib/util/vsyslog.c, lib/zlib/Makefile.in, log2cl.pl, m4/sudo.m4,
  mkdep.pl, mkpkg, pathnames.h.in, plugins/group\_file/Makefile.in,
  plugins/group\_file/getgrent.c, plugins/group\_file/group\_file.c,
  plugins/group\_file/plugin\_test.c, plugins/sample/Makefile.in,
  plugins/sample/sample\_plugin.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/alias.c, plugins/sudoers/audit.c,
  plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/auth/sudo\_auth.h,
  plugins/sudoers/base64.c, plugins/sudoers/boottime.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/bsm\_audit.h,
  plugins/sudoers/check.c, plugins/sudoers/check.h,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/defaults.c,
  plugins/sudoers/defaults.h, plugins/sudoers/digestname.c,
  plugins/sudoers/editor.c, plugins/sudoers/env.c,
  plugins/sudoers/env\_pattern.c, plugins/sudoers/file.c,
  plugins/sudoers/filedigest.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/gc.c,
  plugins/sudoers/gentime.c, plugins/sudoers/getspwuid.c,
  plugins/sudoers/gmtoff.c, plugins/sudoers/goodpath.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/hexchar.c,
  plugins/sudoers/ins\_2001.h, plugins/sudoers/ins\_classic.h,
  plugins/sudoers/ins\_csops.h, plugins/sudoers/ins\_goons.h,
  plugins/sudoers/ins\_python.h, plugins/sudoers/insults.h,
  plugins/sudoers/interfaces.c, plugins/sudoers/interfaces.h,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog.h,
  plugins/sudoers/iolog\_event.h, plugins/sudoers/iolog\_files.h,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/iolog\_util.c,
  plugins/sudoers/ldap.c, plugins/sudoers/ldap\_conf.c,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/linux\_audit.h, plugins/sudoers/locale.c,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/logwrap.c, plugins/sudoers/match.c,
  plugins/sudoers/match\_addr.c, plugins/sudoers/match\_command.c,
  plugins/sudoers/match\_digest.c, plugins/sudoers/mkdir\_parents.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/parse\_ldif.c, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil.h, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/rcstr.c, plugins/sudoers/redblack.c,
  plugins/sudoers/redblack.h,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/iolog\_util/check\_iolog\_util.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/parser/check\_hexchar.c,
  plugins/sudoers/regress/starttime/check\_starttime.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/solaris\_audit.c,
  plugins/sudoers/solaris\_audit.h, plugins/sudoers/sssd.c,
  plugins/sudoers/starttime.c, plugins/sudoers/strlist.c,
  plugins/sudoers/strlist.h, plugins/sudoers/stubs.c,
  plugins/sudoers/sudo\_ldap.h, plugins/sudoers/sudo\_ldap\_conf.h,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudo\_nss.h,
  plugins/sudoers/sudo\_printf.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoers\_debug.c,
  plugins/sudoers/sudoers\_debug.h, plugins/sudoers/sudoers\_version.h,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timeout.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/timestr.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsdump.c,
  plugins/sudoers/tsgetgrpw.c, plugins/sudoers/tsgetgrpw.h,
  plugins/sudoers/visudo.c, plugins/system\_group/Makefile.in,
  plugins/system\_group/system\_group.c, src/Makefile.in,
  src/conversation.c, src/env\_hooks.c, src/exec.c, src/exec\_common.c,
  src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c, src/get\_pty.c,
  src/hooks.c, src/load\_plugins.c, src/net\_ifs.c, src/openbsd.c,
  src/parse\_args.c, src/preload.c, src/preserve\_fds.c,
  src/regress/noexec/check\_noexec.c, src/regress/ttyname/check\_ttyname.c,
  src/selinux.c, src/sesh.c, src/signal.c, src/solaris.c, src/sudo.c,
  src/sudo.h, src/sudo\_edit.c, src/sudo\_exec.h, src/sudo\_noexec.c,
  src/sudo\_plugin\_int.h, src/sudo\_usage.h.in, src/tcsetpgrp\_nobg.c,
  src/tgetpass.c, src/ttyname.c, src/utmp.c:

  Add SPDX-License-Identifier to files.
  [[1e1ef6190]](https://git.sudo.ws/sudo/commit/?id=1e1ef6190)

2019-04-28 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  Filter out last login messages on HP-UX unless running a shell. HP-UX in
  trusted mode will display last login messages as part of the PAM account
  management module by libpam\_comsec. There is no way to suppress these
  messages from the PAM configuration in trusted mode so we need to filter
  them in the conversation function. In regular mode, similar (but
  different) messages may be produced by libpam\_hpsec.
  [[96ac6adae]](https://git.sudo.ws/sudo/commit/?id=96ac6adae)

2019-04-26 Todd C. Miller

* lib/util/closefrom.c:

  FreeBSD’s /dev/fd only contains fds 0-2 unless fdescfs is mounted. In
  practice this doesn’t matter since FreeBSD >= 8 has a native closefrom
  [[30a56af6e]](https://git.sudo.ws/sudo/commit/?id=30a56af6e)

2019-04-20 Todd C. Miller

* plugins/sudoers/logging.c:

  Keep debug fds open in send\_mail() to aid in debugging. Adds
  closefrom\_nodebug() which acts like closefrom(3) but doesn’t close debug
  fds for use by send\_mail(). Also moves the code to exec the mailer to
  its own function.
  [[aa0146d68]](https://git.sudo.ws/sudo/commit/?id=aa0146d68)

2019-04-19 Todd C. Miller

* plugins/sudoers/defaults.c:

  Set def\_mailerflags even if sendmail was not found at configure time.
  Fixes a NULL dereference when mailerpath is set but mailerflags is not.
  [Bug #878](https://bugzilla.sudo.ws/show_bug.cgi?id=878)
  [[9048ee6c4]](https://git.sudo.ws/sudo/commit/?id=9048ee6c4)

2019-04-08 Todd C. Miller

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/getdelim.c, lib/util/parseln.c,
  lib/util/regress/getdelim/getdelim\_test.c, mkdep.pl,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/boottime.c,
  plugins/sudoers/iolog\_util.c, plugins/sudoers/ldap\_conf.c,
  plugins/sudoers/parse\_ldif.c, plugins/sudoers/sssd.c:

  Add a proper getdelim(3) replacement and use it instead of getline(3).
  [[de65d7092]](https://git.sudo.ws/sudo/commit/?id=de65d7092)

* plugins/sudoers/auth/pam.c:

  Restrict the PAM\_TTY kludge to Solaris and Linux-PAM. Setting PAM\_TTY to
  the empty string causes problems with some modules on HP-UX so restrict
  it to systems where it is fixes known issues.
  [[f0910c01d]](https://git.sudo.ws/sudo/commit/?id=f0910c01d)

2019-03-18 Todd C. Miller

* lib/util/getgrouplist.c:

  Fix the counting of supplementary groups on AIX. We should not assume
  that basegid will be present in the list of gids returned by getgrset().
  [[731e79671]](https://git.sudo.ws/sudo/commit/?id=731e79671)

2019-03-14 Todd C. Miller

* plugins/sudoers/pwutil.c:

  Plug a memory leak on user/group lookup failure found by ASAN.
  [[194968eaf]](https://git.sudo.ws/sudo/commit/?id=194968eaf)

2019-03-08 Todd C. Miller

* MANIFEST, plugins/sudoers/regress/testsudoers/test3.d/root,
  plugins/sudoers/regress/testsudoers/test3.sh:

  Fix test failure when run by a user other than the file owner.
  [[e31ac5a99]](https://git.sudo.ws/sudo/commit/?id=e31ac5a99)

* MANIFEST, plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/zh\_TW.mo, plugins/sudoers/po/zh\_TW.po, po/da.mo,
  po/da.po, po/eo.mo, po/eo.po, po/es.mo, po/es.po, po/zh\_TW.mo,
  po/zh\_TW.po:

  Updated translations from translationproject.org
  [[28b0bff4f]](https://git.sudo.ws/sudo/commit/?id=28b0bff4f)

* MANIFEST, plugins/sudoers/regress/cvtsudoers/test1.sh,
  plugins/sudoers/regress/cvtsudoers/test10.sh,
  plugins/sudoers/regress/cvtsudoers/test11.sh,
  plugins/sudoers/regress/cvtsudoers/test12.sh,
  plugins/sudoers/regress/cvtsudoers/test13.sh,
  plugins/sudoers/regress/cvtsudoers/test14.sh,
  plugins/sudoers/regress/cvtsudoers/test15.sh,
  plugins/sudoers/regress/cvtsudoers/test16.sh,
  plugins/sudoers/regress/cvtsudoers/test17.sh,
  plugins/sudoers/regress/cvtsudoers/test18.sh,
  plugins/sudoers/regress/cvtsudoers/test19.sh,
  plugins/sudoers/regress/cvtsudoers/test2.sh,
  plugins/sudoers/regress/cvtsudoers/test20.sh,
  plugins/sudoers/regress/cvtsudoers/test21.sh,
  plugins/sudoers/regress/cvtsudoers/test22.sh,
  plugins/sudoers/regress/cvtsudoers/test23.sh,
  plugins/sudoers/regress/cvtsudoers/test24.sh,
  plugins/sudoers/regress/cvtsudoers/test25.sh,
  plugins/sudoers/regress/cvtsudoers/test26.err.ok,
  plugins/sudoers/regress/cvtsudoers/test26.out.ok,
  plugins/sudoers/regress/cvtsudoers/test26.sh,
  plugins/sudoers/regress/cvtsudoers/test27.sh,
  plugins/sudoers/regress/cvtsudoers/test28.sh,
  plugins/sudoers/regress/cvtsudoers/test29.sh,
  plugins/sudoers/regress/cvtsudoers/test3.sh,
  plugins/sudoers/regress/cvtsudoers/test30.sh,
  plugins/sudoers/regress/cvtsudoers/test31.sh,
  plugins/sudoers/regress/cvtsudoers/test32.err.ok,
  plugins/sudoers/regress/cvtsudoers/test32.out.ok,
  plugins/sudoers/regress/cvtsudoers/test32.sh,
  plugins/sudoers/regress/cvtsudoers/test33.sh,
  plugins/sudoers/regress/cvtsudoers/test4.sh,
  plugins/sudoers/regress/cvtsudoers/test5.sh,
  plugins/sudoers/regress/cvtsudoers/test6.sh,
  plugins/sudoers/regress/cvtsudoers/test7.sh,
  plugins/sudoers/regress/cvtsudoers/test8.sh,
  plugins/sudoers/regress/cvtsudoers/test9.sh:

  Test cvtsudoers stdout and stderr separately. Fixes a test failure on
  systems with musl libc. [Bug
  #873](https://bugzilla.sudo.ws/show_bug.cgi?id=873)
  [[0c31cf15f]](https://git.sudo.ws/sudo/commit/?id=0c31cf15f)

2019-03-06 Todd C. Miller

* plugins/sudoers/starttime.c, src/ttyname.c:

  Better comment about EOVERFLOW and pstat\_getproc(). Also remove some
  useless casts.
  [[0766e0c64]](https://git.sudo.ws/sudo/commit/?id=0766e0c64)

* lib/util/closefrom.c:

  Ignore EOVERFLOW from pstat\_getproc(), it is not a fatal error. It just
  means that one of the fields in pstat lacks the precision to store a
  value. That’s not an issue for pst\_highestfd.
  [[17ca31c38]](https://git.sudo.ws/sudo/commit/?id=17ca31c38)

* sudo.pp:

  update copyright year
  [[9c4487b73]](https://git.sudo.ws/sudo/commit/?id=9c4487b73)

2019-03-05 Todd C. Miller

* src/load\_plugins.c:

  Fix error message when a fully-qualified plugin path does not exist.
  [[8ee2de998]](https://git.sudo.ws/sudo/commit/?id=8ee2de998)

2019-03-04 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Fix unescaped ‘' and remove an extra ‘[’ in the definition of digest.
  [[0e8fffdb3]](https://git.sudo.ws/sudo/commit/?id=0e8fffdb3)

2019-03-03 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Ignore carriage return before a linefeed. This allows sudo to parse
  files with DOS-style line endings.
  [[ea3ede690]](https://git.sudo.ws/sudo/commit/?id=ea3ede690)

2019-02-26 Todd C. Miller

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  For sssd, the nsswitch.conf setting should be “sss” not “sssd”. From
  Johnathan Smith.
  [[f4853cb75]](https://git.sudo.ws/sudo/commit/?id=f4853cb75)

2019-02-20 Todd C. Miller

* plugins/sudoers/env.c, plugins/sudoers/sudoers.h:

  Add simple API for to allow reading environment data from different
  sources. Currently, this is used to read a file like /etc/environment.
  [[e1205f08d]](https://git.sudo.ws/sudo/commit/?id=e1205f08d)

2019-02-19 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Fix pasto; the unrestricted env file was read when we want the
  restricted one.
  [[f3344b588]](https://git.sudo.ws/sudo/commit/?id=f3344b588)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/defaults.h,
  plugins/sudoers/parse.h, plugins/sudoers/strlist.c, src/sudo.h:

  Be sure to include sudo\_queue.h where needed instead of relying on other
  headers.
  [[c0a12d9d9]](https://git.sudo.ws/sudo/commit/?id=c0a12d9d9)

2019-02-18 Todd C. Miller

* lib/util/util.exp.in:

  Only export sudo\_arc4random\_uniform() if arc4random\_uniform() is
  missing.
  [[683c65b98]](https://git.sudo.ws/sudo/commit/?id=683c65b98)

* lib/util/regress/vsyslog/vsyslog\_test.c:

  Quiet a warning on gcc 8
  [[f17683482]](https://git.sudo.ws/sudo/commit/?id=f17683482)

* include/sudo\_compat.h:

  AIX 7.1 defines O\_CLOEXEC but it can’t be used outside the kernel.
  Redefine O\_CLOEXEC if it doesn’t fit in an int and pipe2() is missing.
  [[da98428e9]](https://git.sudo.ws/sudo/commit/?id=da98428e9)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/match.c,
  plugins/sudoers/match\_command.c, plugins/sudoers/match\_digest.c,
  plugins/sudoers/parse.h:

  Split command match code out into match\_command.c. Also remove unused
  SUDOERS\_NAME\_MATCH code.
  [[36d437340]](https://git.sudo.ws/sudo/commit/?id=36d437340)

2019-02-17 Todd C. Miller

* plugins/sudoers/match\_digest.c:

  Split out digest matching into its own file.
  [[cf2bfbcd3]](https://git.sudo.ws/sudo/commit/?id=cf2bfbcd3)

* plugins/sudoers/Makefile.in, plugins/sudoers/match.c,
  plugins/sudoers/parse.h:

  Split out digest matching into its own file.
  [[a04409747]](https://git.sudo.ws/sudo/commit/?id=a04409747)

2019-02-12 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Rename FOLLOW and NOFOLLOW tokens FOLLOWLNK and NOFOLLOWLNK. Fixes a
  namespace collision on Solaris when bison is used.
  [[1e6e04818]](https://git.sudo.ws/sudo/commit/?id=1e6e04818)

2019-02-06 Todd C. Miller

* plugins/sudoers/match.c:

  Add stub definition of digest\_matches() for SUDOERS\_NAME\_MATCH
  [[bc2591505]](https://git.sudo.ws/sudo/commit/?id=bc2591505)

* plugins/sudoers/sudo\_nss.c:

  No longer need to include sudo\_lbuf.h
  [[694999487]](https://git.sudo.ws/sudo/commit/?id=694999487)

* mkpkg:

  On RedHat/CentOS get the OS major version from /etc/redhat-release. We
  cannot determine this from the output of “pp –probe” since it doesn’t
  contain a period to separate the major and minor numbers.
  [[ffc4db6ae]](https://git.sudo.ws/sudo/commit/?id=ffc4db6ae)

2019-02-05 Todd C. Miller

* plugins/sudoers/policy.c:

  Use SET macro instead of bitwise OR.
  [[6dceca47c]](https://git.sudo.ws/sudo/commit/?id=6dceca47c)

* plugins/sudoers/pwutil\_impl.c:

  In sudo\_make\_grlist\_item() the calculation of total did not include
  space for pointers to the group names.
  [[c92f80b79]](https://git.sudo.ws/sudo/commit/?id=c92f80b79)

* plugins/sudoers/cvtsudoers\_pwutil.c:

  Use correct debug\_decl() names.
  [[4f74fe3a8]](https://git.sudo.ws/sudo/commit/?id=4f74fe3a8)

* plugins/sudoers/sudoers.h:

  Add fallback values for sudoers uid, gid and mode if not set in
  Makefile.
  [[928faf27f]](https://git.sudo.ws/sudo/commit/?id=928faf27f)

2019-02-04 Todd C. Miller

* lib/util/memset\_s.c:

  include stddef.h to make sure we get NULL
  [[13c324422]](https://git.sudo.ws/sudo/commit/?id=13c324422)

2019-02-02 Todd C. Miller

* src/net\_ifs.c:

  Fix memory leak when there are no network interfaces or an error occurs.
  [[3788c6548]](https://git.sudo.ws/sudo/commit/?id=3788c6548)

2019-01-25 Todd C. Miller

* configure, configure.ac:

  Use $ac\_cv\_search\_FUNCTION instead of $ac\_lib and $ac\_res. Fixes a
  problem where libcrypt is not used with autoconf caching. Adapted from a
  diff from Adam Labbe.
  [[c1d934894]](https://git.sudo.ws/sudo/commit/?id=c1d934894)

2019-01-24 Todd C. Miller

* po/de.mo, po/de.po, po/ko.mo, po/ko.po:

  Updated translations from translationproject.org
  [[df8b855b2]](https://git.sudo.ws/sudo/commit/?id=df8b855b2)

2019-01-22 Todd C. Miller

* plugins/sudoers/parse.c:

  Fix listpw=never and verifypw=never. [Bug
  #869](https://bugzilla.sudo.ws/show_bug.cgi?id=869)
  [[ecc9c366e]](https://git.sudo.ws/sudo/commit/?id=ecc9c366e)

2019-01-20 Todd C. Miller

* lib/util/regress/vsyslog/vsyslog\_test.c, lib/util/sig2str.c,
  plugins/sudoers/alias.c, plugins/sudoers/cvtsudoers\_pwutil.c,
  plugins/sudoers/env.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/ldap\_util.c,
  plugins/sudoers/logging.c, plugins/sudoers/match.c,
  plugins/sudoers/parse.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/starttime.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/tsdump.c, src/exec\_monitor.c, src/exec\_nopty.c,
  src/exec\_pty.c, src/sudo.c, src/ttyname.c:

  Minor snprintf() usage tweaks: 1) don’t assume snprintf() returns -1 on
  error, check for <0 2) when comparing return value of sizeof(foo), cast
  the sizeof, not the len 3) cast return value to void in cases where
  snprintf cannot fail
  [[985600e7f]](https://git.sudo.ws/sudo/commit/?id=985600e7f)

2019-01-07 Todd C. Miller

* NEWS:

  The AIX nofiles hard limit fix and bug #867 will make 1.8.27.
  [[3d63eee34]](https://git.sudo.ws/sudo/commit/?id=3d63eee34)

* plugins/sudoers/auth/pam.c:

  Use PAM\_SILENT to prevent pam\_lastlog from printing last login
  information on RedHat except when explicitly running a shell. Adapted
  from a patch from Nir Soffer. [Bug
  #867](https://bugzilla.sudo.ws/show_bug.cgi?id=867)
  [[e2675d8f1]](https://git.sudo.ws/sudo/commit/?id=e2675d8f1)

* lib/util/aix.c:

  Fix the default nofiles and stack hard limits. The table of default hard
  limits in /etc/security/limits was out of date with respect to the
  current documentation. The default hard limit for nofiles should be
  unlimited, not 8196. The default hard limit for stack should be 4194304
  blocks (which fits in an unsigned long on 32-bit platforms).
  [[f7d7a9a61]](https://git.sudo.ws/sudo/commit/?id=f7d7a9a61)

2019-01-03 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  regen
  [[32dc90c28]](https://git.sudo.ws/sudo/commit/?id=32dc90c28)

* NEWS:

  Final updates for sudo 1.8.27.
  [[7ae29420d]](https://git.sudo.ws/sudo/commit/?id=7ae29420d)

* src/exec\_pty.c:

  Update copyright year
  [[64d08d8bf]](https://git.sudo.ws/sudo/commit/?id=64d08d8bf)

* doc/LICENSE:

  Update for 2019
  [[de94a04ba]](https://git.sudo.ws/sudo/commit/?id=de94a04ba)

2019-01-02 Todd C. Miller

* src/exec\_pty.c:

  Fix setting of utmp entry when running command in a pty. Regression
  introduced in sudo 1.8.22.
  [[b2f7983c8]](https://git.sudo.ws/sudo/commit/?id=b2f7983c8)

2018-12-24 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Use debug\_return\_int not debug\_return\_bool in resolve\_host
  [[efe35e5b1]](https://git.sudo.ws/sudo/commit/?id=efe35e5b1)

* NEWS, configure, configure.ac:

  sudo 1.8.27
  [[24b0da367]](https://git.sudo.ws/sudo/commit/?id=24b0da367)

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in,
  plugins/sudoers/visudo.c:

  Allow the sudoers file to be specified without the -f option. [Bug
  #864](https://bugzilla.sudo.ws/show_bug.cgi?id=864)
  [[dc9338ffe]](https://git.sudo.ws/sudo/commit/?id=dc9338ffe)

2018-12-20 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  The iolog\_dir section is below the maxseq section, not above.
  [[7d5b0064a]](https://git.sudo.ws/sudo/commit/?id=7d5b0064a)

2018-12-12 Todd C. Miller

* plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po, po/ja.mo, po/ja.po:

  Updated translations from translationproject.org
  [[3d8415073]](https://git.sudo.ws/sudo/commit/?id=3d8415073)

2018-12-11 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Add -n and -R options to help; reported by Radovan Sroka
  [[72050203b]](https://git.sudo.ws/sudo/commit/?id=72050203b)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in:

  Add missing description of padding option and missing argument to -c.
  [[258c7d4dd]](https://git.sudo.ws/sudo/commit/?id=258c7d4dd)

* plugins/sudoers/cvtsudoers.c:

  The -c option was missing from the help info; from Radovan Sroka
  [[142b370c1]](https://git.sudo.ws/sudo/commit/?id=142b370c1)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in:

  Fix some typos; reported by Radovan Sroka
  [[04a4b3c1f]](https://git.sudo.ws/sudo/commit/?id=04a4b3c1f)

2018-12-08 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  In sudo\_pam\_approval(), for the exempt case, only overwrite pam status
  when the passwd is expired or needs to be updated.
  [[524277348]](https://git.sudo.ws/sudo/commit/?id=524277348)

2018-12-07 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  The fix for bug #843 was incomplete and caused pam\_end() to be called
  early. sudo\_pam\_approval() must not set the global pam status to an
  error value if it returns AUTH\_SUCCESS. Otherwise, sudo\_pam\_cleanup()
  will call pam\_end() before sudo\_pam\_begin\_session(). This resulted in a
  NULL PAM handle being used in sudo\_pam\_begin\_session().
  [[4125808a8]](https://git.sudo.ws/sudo/commit/?id=4125808a8)

2018-12-05 Todd C. Miller

* src/exec.c:

  Don’t run the command in a pty if no I/O plugins are logging anything.
  That way an I/O plugin that doesn’t actually log anything won’t cause
  the command to be run in a pty.
  [[e91e5ee82]](https://git.sudo.ws/sudo/commit/?id=e91e5ee82)

2018-11-29 Todd C. Miller

* .hgignore:

  Update ignore patterns to match doc changes.
  [[83fd48a75]](https://git.sudo.ws/sudo/commit/?id=83fd48a75)

* doc/fixmdoc.sed:

  fix mode fixmdoc.sed
  [[85dd1747c]](https://git.sudo.ws/sudo/commit/?id=85dd1747c)

2018-11-27 Todd C. Miller

* doc/Makefile.in, doc/sudo.conf.man.in, doc/sudo.man.in,
  doc/sudoers.ldap.man.in, doc/sudoers.man.in,
  doc/sudoers\_timestamp.man.in, doc/sudoreplay.man.in, doc/visudo.man.in:

  Fix section in the .TH line of \*.man.in file. The substitution for
  @mansectsu@ and @mansectform@ was broken. No longer need to strip
  out OpenBSD from the header line.
  [[b8ba37222]](https://git.sudo.ws/sudo/commit/?id=b8ba37222)

* doc/sudoers.man.in.sed:

  Add sudoers.man.in.sed, missed from previous commit.
  [[e0d2dc61e]](https://git.sudo.ws/sudo/commit/?id=e0d2dc61e)

* doc/CONTRIBUTORS:

  Add Guillem Jover
  [[168a7ca11]](https://git.sudo.ws/sudo/commit/?id=168a7ca11)

* NEWS:

  recent changes
  [[8964dd5d2]](https://git.sudo.ws/sudo/commit/?id=8964dd5d2)

* MANIFEST, doc/Makefile.in, doc/fixman.sh, doc/fixmdoc.sed,
  doc/fixmdoc.sh, doc/sudo.cat, doc/sudo.man.in, doc/sudo.man.in.sed,
  doc/sudo.mdoc.in, doc/sudoers.cat, doc/sudoers.man.in,
  doc/sudoers.mdoc.in:

  Use roff conditionals in the manuals instead of post-processing. We
  still need to process the resulting .man.in files to add back the
  conditionals but this should be easier to debug as the changes are
  visible in the .in file. Some minor postprocessing is still used to make
  the manuals HP-UX friendly and to change “0 seconds” -> unlimited after
  substitution.
  [[e010706ed]](https://git.sudo.ws/sudo/commit/?id=e010706ed)

2018-11-24 Todd C. Miller

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Sudo plugin manual updates and clarification from Guillem Jover: - Add
  missing return information for show\_version(). - Fix prototypes for
  several function pointers. - Update SUDO\_API\_VERSION\_MINOR. - Add
  missing references to log\_suspend() and change\_winsize(). - Add missing
  “array.”. - Clarify that argc can be zero on sudo -V. - Clarify size
  requirements for conversation array arguments. - Clarify timeout zero
  value for struct sudo\_conv\_message. - Clarify initial and final state of
  reply in struct sudo\_conv\_reply.
  [[23006c72c]](https://git.sudo.ws/sudo/commit/?id=23006c72c)

* doc/fixmdoc.sh, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoers.man.in,
  doc/sudoers.mdoc.in:

  Revert changes to give arguments to the .Bx macro. This is intended for
  things like .Bx 4.3 to generate “4.3BSD” so the argument ends up before
  the BSD, not after. Just go back to using “BSD authentication” and “BSD
  login classes” so fixmdoc.sh can operate correctly. [Bug
  #861](https://bugzilla.sudo.ws/show_bug.cgi?id=861)
  [[7c0019d2a]](https://git.sudo.ws/sudo/commit/?id=7c0019d2a)

2018-11-23 Todd C. Miller

* doc/fixmdoc.sh, doc/sudo.mdoc.in, doc/sudoers.mdoc.in:

  Update fixmdoc.sh to match the BSD -> .Bx changes in the manuals. [Bug
  #861](https://bugzilla.sudo.ws/show_bug.cgi?id=861)
  [[0679f4529]](https://git.sudo.ws/sudo/commit/?id=0679f4529)

2018-11-18 Todd C. Miller

* config.h.in, configure, configure.ac, m4/sudo.m4, src/utmp.c:

  Add support for utmps as found in HP-UX.
  [[ecd968881]](https://git.sudo.ws/sudo/commit/?id=ecd968881)

2018-11-14 Todd C. Miller

* config.h.in, configure, configure.ac, include/sudo\_util.h,
  lib/util/utimens.c:

  Support st\_nmtime in struct stat as found in HP-UX.
  [[716aa6e4a]](https://git.sudo.ws/sudo/commit/?id=716aa6e4a)

* lib/util/closefrom.c:

  If fcntl fails, fall back to the /proc implementation.
  [[7c5469264]](https://git.sudo.ws/sudo/commit/?id=7c5469264)

2018-11-12 Todd C. Miller

* NEWS:

  Mention schema.olcSudo
  [[4f5acff6e]](https://git.sudo.ws/sudo/commit/?id=4f5acff6e)

2018-11-09 Todd C. Miller

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  Mention schema.olcSudo here too.
  [[5f5d4a285]](https://git.sudo.ws/sudo/commit/?id=5f5d4a285)

* MANIFEST, README.LDAP, doc/CONTRIBUTORS, doc/schema.OpenLDAP,
  doc/schema.olcSudo:

  OpenLDAP schema file for Sudo in on-line configuration (OLC) format.
  From Frederic Pasteleurs.
  [[5e098a782]](https://git.sudo.ws/sudo/commit/?id=5e098a782)

* po/ast.mo, po/ast.po:

  Updated translations from translationproject.org
  [[d6c2c5368]](https://git.sudo.ws/sudo/commit/?id=d6c2c5368)

2018-11-08 Todd C. Miller

* lib/util/closefrom.c:

  Only use closefrom\_fallback() if no better method exists. The previous
  logic was too fragile.
  [[537a2f977]](https://git.sudo.ws/sudo/commit/?id=537a2f977)

2018-11-07 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/cs.mo,
  po/cs.po, po/fr.mo, po/fr.po, po/hr.mo, po/hr.po, po/it.mo, po/it.po,
  po/nb.mo, po/nb.po, po/pl.mo, po/pl.po, po/pt\_BR.mo, po/pt\_BR.po,
  po/sv.mo, po/sv.po, po/tr.mo, po/tr.po, po/uk.mo, po/uk.po, po/vi.mo,
  po/vi.po, po/zh\_CN.mo, po/zh\_CN.po:

  Updated translations from translationproject.org
  [[733669ec3]](https://git.sudo.ws/sudo/commit/?id=733669ec3)

* MANIFEST, NEWS, doc/CONTRIBUTORS, plugins/sudoers/po/pt.mo,
  plugins/sudoers/po/pt.po, po/pt.mo, po/pt.po:

  Portuguese translation for sudo and sudoers from translationproject.org.
  [[cad10fbd2]](https://git.sudo.ws/sudo/commit/?id=cad10fbd2)

2018-11-05 Todd C. Miller

* NEWS, configure, configure.ac, include/sudo\_fatal.h,
  lib/util/Makefile.in, lib/util/fatal.c, lib/util/util.exp.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/sudoers.c:

  Add sudo\_gai\_fatal, sudo\_gai\_vfatal, sudo\_gai\_vwarn, sudo\_gai\_warn and
  gai\_log\_warning that use gai\_strerror() instead of strerror().
  [[cdd5bb32e]](https://git.sudo.ws/sudo/commit/?id=cdd5bb32e)

2018-10-31 Todd C. Miller

* plugins/sudoers/match.c:

  Fix memory leak in runaslist\_matches().
  [[cfa4879db]](https://git.sudo.ws/sudo/commit/?id=cfa4879db)

2018-10-29 Todd C. Miller

* NEWS:

  typo
  [[c88b85985]](https://git.sudo.ws/sudo/commit/?id=c88b85985)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[9c2f4b8f1]](https://git.sudo.ws/sudo/commit/?id=9c2f4b8f1)

* NEWS:

  More updates for 1.8.26
  [[9378808b3]](https://git.sudo.ws/sudo/commit/?id=9378808b3)

2018-10-28 Todd C. Miller

* MANIFEST, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in, plugins/sudoers/ldap\_util.c,
  plugins/sudoers/regress/cvtsudoers/test33.out.ok,
  plugins/sudoers/regress/cvtsudoers/test33.sh:

  Add support for negated sudoRunAsUser and sudoRunAsGroup entries.
  [[1fe582a0e]](https://git.sudo.ws/sudo/commit/?id=1fe582a0e)

2018-10-27 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document that the target user’s groups may be specified via the -g
  option.
  [[fb015fac1]](https://git.sudo.ws/sudo/commit/?id=fb015fac1)

* plugins/sudoers/tsgetgrpw.c:

  Include getpwent() version of sudo\_getgrouplist2\_v1() from
  getgrouplist.c
  [[03c56db40]](https://git.sudo.ws/sudo/commit/?id=03c56db40)

* MANIFEST, plugins/sudoers/regress/testsudoers/group,
  plugins/sudoers/regress/testsudoers/test1.sh:

  Use a testsudoers group file with known contents instead of the system
  one.
  [[0398996b3]](https://git.sudo.ws/sudo/commit/?id=0398996b3)

* plugins/sudoers/match.c, plugins/sudoers/parse.h,
  plugins/sudoers/set\_perms.c:

  Allow the group set by “sudo -g” to be any of the target user’s groups.
  Previously, this was only allowed if the group matched the target user’s
  primary group ID (from the passwd database entry). The sudoers policy
  will now allow the group if it is one of the target user’s supplemental
  groups as well.
  [[391ed95f5]](https://git.sudo.ws/sudo/commit/?id=391ed95f5)

2018-10-26 Todd C. Miller

* lib/util/regress/getgrouplist/getgrouplist\_test.c:

  Skip sudo\_getgrouplist2() check on systems with getgrouplist\_2().
  sudo\_getgrouplist2() is just a wrapper on such systems and this avoids a
  test failure on macOS where a user is automatically a member of certain
  groups.
  [[ffe2041a0]](https://git.sudo.ws/sudo/commit/?id=ffe2041a0)

* lib/util/util.exp.in:

  Add missing exported symbol sudo\_term\_eof
  [[e22410ba6]](https://git.sudo.ws/sudo/commit/?id=e22410ba6)

* plugins/sudoers/ldap\_conf.c:

  Add missing #ifdef LDAP\_OPT\_X\_TLS\_REQUIRE\_CERT Fixes problems building
  on older LDAP sdks.
  [[059796930]](https://git.sudo.ws/sudo/commit/?id=059796930)

* MANIFEST:

  add getgrouplist\_test.c
  [[5eb0fbd07]](https://git.sudo.ws/sudo/commit/?id=5eb0fbd07)

* lib/util/regress/getgrouplist/getgrouplist\_test.c:

  Check the user’s primary gid from the passwd file too.
  [[a3cb22b46]](https://git.sudo.ws/sudo/commit/?id=a3cb22b46)

* .hgignore:

  ignore prologue
  [[06035f193]](https://git.sudo.ws/sudo/commit/?id=06035f193)

* lib/util/aix.c, lib/util/arc4random.c, lib/util/arc4random\_uniform.c,
  lib/util/closefrom.c, lib/util/digest.c, lib/util/digest\_gcrypt.c,
  lib/util/digest\_openssl.c, lib/util/event.c, lib/util/event\_poll.c,
  lib/util/event\_select.c, lib/util/fatal.c, lib/util/fnmatch.c,
  lib/util/getentropy.c, lib/util/getgrouplist.c, lib/util/gethostname.c,
  lib/util/getline.c, lib/util/getopt\_long.c, lib/util/gettime.c,
  lib/util/gidlist.c, lib/util/isblank.c, lib/util/key\_val.c,
  lib/util/lbuf.c, lib/util/locking.c, lib/util/memrchr.c,
  lib/util/memset\_s.c, lib/util/mksiglist.c, lib/util/mksigname.c,
  lib/util/mktemp.c, lib/util/nanosleep.c, lib/util/parseln.c,
  lib/util/pipe2.c, lib/util/progname.c, lib/util/pw\_dup.c,
  lib/util/reallocarray.c, lib/util/regress/atofoo/atofoo\_test.c,
  lib/util/regress/getgrouplist/getgrouplist\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c,
  lib/util/regress/vsyslog/vsyslog\_test.c, lib/util/secure\_path.c,
  lib/util/setgroups.c, lib/util/sha2.c, lib/util/sig2str.c,
  lib/util/strlcat.c, lib/util/strlcpy.c, lib/util/strndup.c,
  lib/util/strnlen.c, lib/util/strsignal.c, lib/util/strsplit.c,
  lib/util/strtobool.c, lib/util/strtoid.c, lib/util/strtomode.c,
  lib/util/strtonum.c, lib/util/sudo\_conf.c, lib/util/sudo\_debug.c,
  lib/util/sudo\_dso.c, lib/util/term.c, lib/util/ttyname\_dev.c,
  lib/util/ttysize.c, lib/util/utimens.c, lib/util/vsyslog.c,
  plugins/group\_file/getgrent.c, plugins/group\_file/group\_file.c,
  plugins/group\_file/plugin\_test.c, plugins/sample/sample\_plugin.c,
  plugins/sudoers/Makefile.in, plugins/sudoers/alias.c,
  plugins/sudoers/audit.c, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/base64.c, plugins/sudoers/boottime.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/check.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/cvtsudoers\_pwutil.c,
  plugins/sudoers/defaults.c, plugins/sudoers/digestname.c,
  plugins/sudoers/editor.c, plugins/sudoers/env.c,
  plugins/sudoers/env\_pattern.c, plugins/sudoers/file.c,
  plugins/sudoers/filedigest.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/gc.c,
  plugins/sudoers/gentime.c, plugins/sudoers/getdate.c,
  plugins/sudoers/getspwuid.c, plugins/sudoers/gmtoff.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/hexchar.c,
  plugins/sudoers/interfaces.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/iolog\_util.c,
  plugins/sudoers/ldap.c, plugins/sudoers/ldap\_conf.c,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/locale.c, plugins/sudoers/logging.c,
  plugins/sudoers/logwrap.c, plugins/sudoers/match.c,
  plugins/sudoers/match\_addr.c, plugins/sudoers/mkdir\_parents.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse\_ldif.c,
  plugins/sudoers/policy.c, plugins/sudoers/prompt.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/rcstr.c, plugins/sudoers/redblack.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/iolog\_util/check\_iolog\_util.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/parser/check\_hexchar.c,
  plugins/sudoers/regress/starttime/check\_starttime.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/solaris\_audit.c,
  plugins/sudoers/sssd.c, plugins/sudoers/starttime.c,
  plugins/sudoers/strlist.c, plugins/sudoers/stubs.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudo\_printf.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers\_debug.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timeout.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/timestr.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsdump.c,
  plugins/sudoers/tsgetgrpw.c, plugins/sudoers/visudo.c,
  plugins/system\_group/system\_group.c, src/conversation.c,
  src/env\_hooks.c, src/exec.c, src/exec\_common.c, src/exec\_monitor.c,
  src/exec\_nopty.c, src/exec\_pty.c, src/get\_pty.c, src/hooks.c,
  src/load\_plugins.c, src/net\_ifs.c, src/openbsd.c, src/parse\_args.c,
  src/preload.c, src/preserve\_fds.c, src/regress/noexec/check\_noexec.c,
  src/regress/ttyname/check\_ttyname.c, src/selinux.c, src/sesh.c,
  src/signal.c, src/solaris.c, src/sudo.c, src/sudo\_edit.c,
  src/sudo\_noexec.c, src/tcsetpgrp\_nobg.c, src/tgetpass.c, src/ttyname.c,
  src/utmp.c:

  Convert PVS-Studio comment to ANSI C.
  [[6c3d20cb4]](https://git.sudo.ws/sudo/commit/?id=6c3d20cb4)

* Makefile.in, doc/Makefile.in, doc/cvtsudoers.man.in,
  doc/cvtsudoers.mdoc.in, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in,
  doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudo\_plugin.man.in,
  doc/sudo\_plugin.mdoc.in, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  doc/sudoers\_timestamp.man.in, doc/sudoers\_timestamp.mdoc.in,
  doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in, doc/visudo.man.in,
  doc/visudo.mdoc.in, examples/Makefile.in, include/Makefile.in,
  include/sudo\_lbuf.h, lib/util/Makefile.in, lib/util/digest.c,
  lib/util/digest\_gcrypt.c, lib/util/digest\_openssl.c, lib/util/lbuf.c,
  lib/util/setgroups.c, lib/util/ttysize.c, lib/zlib/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/alias.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/base64.c, plugins/sudoers/file.c,
  plugins/sudoers/filedigest.c, plugins/sudoers/gentime.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/match.c,
  plugins/sudoers/match\_addr.c, plugins/sudoers/parse.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/timeout.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsdump.c,
  plugins/system\_group/Makefile.in, src/Makefile.in, src/sesh.c,
  src/sudo\_usage.h.in:

  Fix some mangled text in the license block.
  [[019279a4b]](https://git.sudo.ws/sudo/commit/?id=019279a4b)

* lib/util/Makefile.in, lib/util/regress/getgrouplist/getgrouplist\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c:

  Add regress test for sudo\_getgrouplist2(). This test assumes all the
  groups in root’s group list can be resolved by group ID.
  [[404524c4e]](https://git.sudo.ws/sudo/commit/?id=404524c4e)

2018-10-25 Todd C. Miller

* NEWS:

  More changes in 1.8.26
  [[50b581ec3]](https://git.sudo.ws/sudo/commit/?id=50b581ec3)

* MANIFEST, doc/cvtsudoers.cat, doc/cvtsudoers.man.in,
  doc/cvtsudoers.mdoc.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers.h, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/regress/cvtsudoers/test31.conf,
  plugins/sudoers/regress/cvtsudoers/test31.out.ok,
  plugins/sudoers/regress/cvtsudoers/test31.sh,
  plugins/sudoers/regress/cvtsudoers/test32.out.ok,
  plugins/sudoers/regress/cvtsudoers/test32.sh:

  Add padding option to cvtsudoers. [Bug
  #856](https://bugzilla.sudo.ws/show_bug.cgi?id=856)
  [[1b035b542]](https://git.sudo.ws/sudo/commit/?id=1b035b542)

* lib/util/getgrouplist.c:

  Remove an errant grset++ in the AIX version of sudo\_getgrouplist2().
  [Bug #857](https://bugzilla.sudo.ws/show_bug.cgi?id=857)
  [[78d35de93]](https://git.sudo.ws/sudo/commit/?id=78d35de93)

2018-10-22 Todd C. Miller

* lib/util/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Pass –sourcetree-root to pvs-studio and don’t check sudo\_noexec.c.
  Since we don’t auto-generate dependencies for sudo\_noexec.c we can’t
  easily check it from outside the source tree. This is not a problem as
  it just contains stub functions.
  [[cb588f233]](https://git.sudo.ws/sudo/commit/?id=cb588f233)

* MANIFEST, doc/CONTRIBUTORS, po/ast.mo, po/ast.po:

  Asturian translation for sudo from translationproject.org
  [[56cff772e]](https://git.sudo.ws/sudo/commit/?id=56cff772e)

2018-10-21 Todd C. Miller

* lib/util/gettime.c:

  Add support for CLOCK\_MONOTONIC\_RAW and CLOCK\_UPTIME\_RAW, present on
  macOS.
  [[3710d5ba0]](https://git.sudo.ws/sudo/commit/?id=3710d5ba0)

* INSTALL, configure, configure.ac:

  Add –enable-pvs-studio configure option to create PVS-Studio.cfg.
  [[4c82e18ac]](https://git.sudo.ws/sudo/commit/?id=4c82e18ac)

* .hgignore, Makefile.in, doc/Makefile.in, examples/Makefile.in,
  include/Makefile.in, lib/util/Makefile.in, lib/zlib/Makefile.in,
  mkdep.pl, plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  Add pvs-studio target and associated production rules.
  [[c5df09112]](https://git.sudo.ws/sudo/commit/?id=c5df09112)

* lib/util/aix.c, lib/util/arc4random.c, lib/util/arc4random\_uniform.c,
  lib/util/closefrom.c, lib/util/digest.c, lib/util/digest\_gcrypt.c,
  lib/util/digest\_openssl.c, lib/util/event.c, lib/util/event\_poll.c,
  lib/util/event\_select.c, lib/util/fatal.c, lib/util/fnmatch.c,
  lib/util/getentropy.c, lib/util/getgrouplist.c, lib/util/gethostname.c,
  lib/util/getline.c, lib/util/getopt\_long.c, lib/util/gettime.c,
  lib/util/gidlist.c, lib/util/isblank.c, lib/util/key\_val.c,
  lib/util/lbuf.c, lib/util/locking.c, lib/util/memrchr.c,
  lib/util/memset\_s.c, lib/util/mksiglist.c, lib/util/mksigname.c,
  lib/util/mktemp.c, lib/util/nanosleep.c, lib/util/parseln.c,
  lib/util/pipe2.c, lib/util/progname.c, lib/util/pw\_dup.c,
  lib/util/reallocarray.c, lib/util/regress/atofoo/atofoo\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c,
  lib/util/regress/vsyslog/vsyslog\_test.c, lib/util/secure\_path.c,
  lib/util/setgroups.c, lib/util/sha2.c, lib/util/sig2str.c,
  lib/util/strlcat.c, lib/util/strlcpy.c, lib/util/strndup.c,
  lib/util/strnlen.c, lib/util/strsignal.c, lib/util/strsplit.c,
  lib/util/strtobool.c, lib/util/strtoid.c, lib/util/strtomode.c,
  lib/util/strtonum.c, lib/util/sudo\_conf.c, lib/util/sudo\_debug.c,
  lib/util/sudo\_dso.c, lib/util/term.c, lib/util/ttyname\_dev.c,
  lib/util/ttysize.c, lib/util/utimens.c, lib/util/vsyslog.c,
  plugins/group\_file/getgrent.c, plugins/group\_file/group\_file.c,
  plugins/group\_file/plugin\_test.c, plugins/sample/sample\_plugin.c,
  plugins/sudoers/alias.c, plugins/sudoers/audit.c,
  plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/base64.c,
  plugins/sudoers/boottime.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/check.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/defaults.c,
  plugins/sudoers/digestname.c, plugins/sudoers/editor.c,
  plugins/sudoers/env.c, plugins/sudoers/env\_pattern.c,
  plugins/sudoers/file.c, plugins/sudoers/filedigest.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/gc.c, plugins/sudoers/gentime.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getspwuid.c,
  plugins/sudoers/gmtoff.c, plugins/sudoers/goodpath.c,
  plugins/sudoers/gram.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/hexchar.c, plugins/sudoers/interfaces.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/iolog\_util.c, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/ldap\_util.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/locale.c,
  plugins/sudoers/logging.c, plugins/sudoers/logwrap.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/mkdir\_parents.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse\_ldif.c, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/rcstr.c,
  plugins/sudoers/redblack.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/iolog\_util/check\_iolog\_util.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/parser/check\_hexchar.c,
  plugins/sudoers/regress/starttime/check\_starttime.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/solaris\_audit.c,
  plugins/sudoers/sssd.c, plugins/sudoers/starttime.c,
  plugins/sudoers/strlist.c, plugins/sudoers/stubs.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudo\_printf.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers\_debug.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timeout.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/timestr.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsdump.c,
  plugins/sudoers/tsgetgrpw.c, plugins/sudoers/visudo.c,
  plugins/system\_group/system\_group.c, src/conversation.c,
  src/env\_hooks.c, src/exec.c, src/exec\_common.c, src/exec\_monitor.c,
  src/exec\_nopty.c, src/exec\_pty.c, src/get\_pty.c, src/hooks.c,
  src/load\_plugins.c, src/net\_ifs.c, src/openbsd.c, src/parse\_args.c,
  src/preload.c, src/preserve\_fds.c, src/regress/noexec/check\_noexec.c,
  src/regress/ttyname/check\_ttyname.c, src/selinux.c, src/sesh.c,
  src/signal.c, src/solaris.c, src/sudo.c, src/sudo\_edit.c,
  src/sudo\_noexec.c, src/tcsetpgrp\_nobg.c, src/tgetpass.c, src/ttyname.c,
  src/utmp.c:

  Add comments in .c files so PVS-Studio will check them.
  [[64e5d34c5]](https://git.sudo.ws/sudo/commit/?id=64e5d34c5)

2018-10-20 Todd C. Miller

* plugins/sudoers/iolog\_util.c:

  Simplify range checks. No need to check for ERANGE in the cases where we
  also check that the value is <= INT\_MAX. Found by PVS-Studio.
  [[45652e6d7]](https://git.sudo.ws/sudo/commit/?id=45652e6d7)

2018-10-19 Todd C. Miller

* lib/util/key\_val.c, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/toke\_util.c,
  src/preserve\_fds.c:

  Avoid some PVS-Studio false positives.
  [[8c94175ba]](https://git.sudo.ws/sudo/commit/?id=8c94175ba)

* src/sudo.c:

  Remove some calls to sudo\_fatalx(); just propagate the error return.
  [[e9dec0f8d]](https://git.sudo.ws/sudo/commit/?id=e9dec0f8d)

* src/sesh.c:

  No need to check if fd\_dst is -1 in sudoedit mode. Failure to open the
  destination sudoedit file is fatal so there’s no need to check that
  fd\_dst != -1 later on. Found by PVS-Studio.
  [[6a85992b3]](https://git.sudo.ws/sudo/commit/?id=6a85992b3)

* plugins/sudoers/timestamp.c:

  In timestamp\_open() no need to free cookie on error, it is NULL. Found
  by PVS-Studio.
  [[6786d53d4]](https://git.sudo.ws/sudo/commit/?id=6786d53d4)

2018-10-18 Todd C. Miller

* plugins/sudoers/ldap\_util.c:

  Fix a memory leak on malloc() error in sudo\_ldap\_role\_to\_priv().
  Coverity CID 188804
  [[deccfe68f]](https://git.sudo.ws/sudo/commit/?id=deccfe68f)

* plugins/sudoers/parse\_ldif.c:

  Move the allocation of role to be immediately before in\_role is set.
  This makes it clear that when in\_role == true, role is non-NULL. Also
  remove two dead stores.
  [[84ef50006]](https://git.sudo.ws/sudo/commit/?id=84ef50006)

* plugins/sudoers/parse\_ldif.c:

  Fix trimming of non-escaped trailing space in ldif\_parse\_attribute().
  Found by PVS-Studio.
  [[2ff8f8601]](https://git.sudo.ws/sudo/commit/?id=2ff8f8601)

* plugins/sudoers/match.c:

  Simplify the logic surrounding sudoers\_args in command\_args\_match(). We
  only need to check that sudoers\_args is non-NULL once. Found by
  PVS-Studio.
  [[c2d93b8c9]](https://git.sudo.ws/sudo/commit/?id=c2d93b8c9)

* plugins/sudoers/ldap.c:

  If sudo\_ldap\_get\_values\_len() fails goto cleanup instead of oom. This is
  not strictly necessary as there’s not anything to cleanup in this case
  but it is more consistent with the code that follows.
  [[54784a234]](https://git.sudo.ws/sudo/commit/?id=54784a234)

* plugins/sudoers/policy.c:

  Fix handling of timeout values in sudoers. When passing the timeout back
  to the front end, ignore the user-specified timeout if it is not set
  (initialized to 0). Otherwise, sudo would choose a zero user-specified
  timeout over the sudoers-specified timeout (non-zero).
  [[63afa569f]](https://git.sudo.ws/sudo/commit/?id=63afa569f)

2018-10-17 Todd C. Miller

* plugins/sudoers/cvtsudoers\_pwutil.c:

  Fix cut & pastos in cvtsudoers\_make\_gritem()
  [[675fc34c3]](https://git.sudo.ws/sudo/commit/?id=675fc34c3)

* plugins/sudoers/regress/sudoers/test17.ldif2sudo.ok:

  Fix expected test output now that command\_timeout is parsed correctly in
  LDIF.
  [[60f0d65e2]](https://git.sudo.ws/sudo/commit/?id=60f0d65e2)

* lib/util/event.c, lib/util/event\_poll.c, lib/util/event\_select.c:

  tv\_nsec can never be negative after timespecsub. Found by PVS Studio
  [[939585e90]](https://git.sudo.ws/sudo/commit/?id=939585e90)

2018-10-16 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Avoid potentially undefined behavior. Found by PVS Studio.
  [[25a58ba1c]](https://git.sudo.ws/sudo/commit/?id=25a58ba1c)

* plugins/sudoers/ldap\_util.c:

  sudo\_ldap\_parse\_option() never returns ‘=’ as the operator. When parsing
  command\_timeout, role, type, privs and limitprivs, check that val is
  non-NULL instead. Found by PVS Studio.
  [[e1a402f1d]](https://git.sudo.ws/sudo/commit/?id=e1a402f1d)

* plugins/sudoers/Makefile.in, plugins/sudoers/toke.c:

  Fix up #line entries that reference lex.sudoers.c.
  [[a9fd783f2]](https://git.sudo.ws/sudo/commit/?id=a9fd783f2)

2018-10-13 Todd C. Miller

* plugins/sudoers/iolog.h, plugins/sudoers/iolog\_util.c:

  Fix workaround for broken sudo 1.8.7 timing files.
  [[387672583]](https://git.sudo.ws/sudo/commit/?id=387672583)

* plugins/sudoers/parse\_ldif.c:

  Fix memory leak when reusing the runas list. We need to free the member
  list itself as well as its contents.
  [[fa7e6f3f0]](https://git.sudo.ws/sudo/commit/?id=fa7e6f3f0)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Some DIAGNOSTICS updates: Update error message for when the user’s uid
  does not exist in passwd. Remove “This error indicates” and some other
  cosmetic cleanups.
  [[75d9c6f16]](https://git.sudo.ws/sudo/commit/?id=75d9c6f16)

* src/sudo.c:

  If the user’s passwd entry cannot be resolved via the uid, use the same
  error message as visudo.
  [[fbf396e33]](https://git.sudo.ws/sudo/commit/?id=fbf396e33)

2018-10-12 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Add a DIAGNOSTICS section with an explanation of the more non-trivial
  error messages.
  [[ae7198a24]](https://git.sudo.ws/sudo/commit/?id=ae7198a24)

* plugins/sudoers/sudoreplay.c, src/exec\_monitor.c, src/exec\_nopty.c,
  src/exec\_pty.c:

  Replace sudo\_fatal(NULL) with an “unable to allocate memory” message
  that includes the function name.
  [[b89cf34b5]](https://git.sudo.ws/sudo/commit/?id=b89cf34b5)

2018-10-09 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, src/tgetpass.c:

  Make EOF handling while reading the password prompt more like
  getpass(3). We now return the password as long as at least one character
  has been read. Previously, EOF at the password prompt was treated as if
  nothing was entered.
  [[9e269e0ac]](https://git.sudo.ws/sudo/commit/?id=9e269e0ac)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in:

  regen
  [[7b395aad8]](https://git.sudo.ws/sudo/commit/?id=7b395aad8)

* src/tgetpass.c:

  Print a warning for password read issues. Issues include: timeout at the
  password prompt, read error while reading the password, and EOF reading
  the password.
  [[ab2cba0f5]](https://git.sudo.ws/sudo/commit/?id=ab2cba0f5)

2018-10-08 Todd C. Miller

* lib/util/term.c, src/tgetpass.c:

  Handle EOF on password input when pwfedback is enabled.
  [[2b5625221]](https://git.sudo.ws/sudo/commit/?id=2b5625221)

2018-10-07 Todd C. Miller

* doc/sudoers.ldap.mdoc.in:

  Fix remaining instances of “e.g.” without a trailing ‘,’.
  [[013e0025c]](https://git.sudo.ws/sudo/commit/?id=013e0025c)

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, doc/sudoers\_timestamp.cat,
  doc/sudoers\_timestamp.man.in, doc/sudoers\_timestamp.mdoc.in:

  Use mdoc macros for BSD systems. All manuals now pass “make lint”
  [[675802b71]](https://git.sudo.ws/sudo/commit/?id=675802b71)

* doc/Makefile.in:

  Use -Wstyle with -Tlint since sudo is not part of the base system. This
  avoids “referenced manual not found” and “operating system explicitly
  specified” warnings.
  [[244be2330]](https://git.sudo.ws/sudo/commit/?id=244be2330)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Document log\_suspend() and fix the description of the change\_winsize()
  return value.
  [[5433eb546]](https://git.sudo.ws/sudo/commit/?id=5433eb546)

2018-10-06 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, doc/sudoers\_timestamp.cat,
  doc/sudoers\_timestamp.man.in, doc/sudoers\_timestamp.mdoc.in,
  doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Fix problems found by igor. [Bug
  #854](https://bugzilla.sudo.ws/show_bug.cgi?id=854)
  [[dd6a6e401]](https://git.sudo.ws/sudo/commit/?id=dd6a6e401)

* doc/Makefile.in:

  Sort DOCS and DEVDOCS and remove extra sudoers entry (it was listed
  twice).
  [[a814da673]](https://git.sudo.ws/sudo/commit/?id=a814da673)

* doc/Makefile.in:

  Add igor target to run igor(1) on the manuals.
  [[ec2cc68c0]](https://git.sudo.ws/sudo/commit/?id=ec2cc68c0)

2018-10-05 Todd C. Miller

* doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  plugins/sudoers/sudoreplay.c:

  Add new -S option to sleep while the command was suspended. The default
  behavior is now to not consider the time the command was suspended as
  part of the normal inter-event delay.
  [[a71eb86a7]](https://git.sudo.ws/sudo/commit/?id=a71eb86a7)

* MANIFEST, include/sudo\_plugin.h, plugins/sudoers/Makefile.in,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog.h,
  plugins/sudoers/iolog\_event.h, plugins/sudoers/iolog\_files.h,
  plugins/sudoers/iolog\_util.c, plugins/sudoers/iolog\_util.h,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/iolog\_util/check\_iolog\_util.c,
  plugins/sudoers/sudoreplay.c, src/exec\_pty.c:

  Add a suspend event type to the I/O log to log suspend/resume of the
  command so we can skip that delay during replay.
  [[cf07dc075]](https://git.sudo.ws/sudo/commit/?id=cf07dc075)

* src/exec\_pty.c, src/sudo.c, src/sudo.h:

  Initialize the pty rows/cols based on the values we stored in
  user\_details. This fixes a minor issue where we would send an extra
  window size change event the first time the command was suspended.
  [[e2570307e]](https://git.sudo.ws/sudo/commit/?id=e2570307e)

2018-09-27 Todd C. Miller

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/sudo\_ldap\_conf.h:

  Add support for OpenLDAP’s TLS\_REQCERT setting in ldap.conf.
  [[c0e8bde10]](https://git.sudo.ws/sudo/commit/?id=c0e8bde10)

2018-09-24 Todd C. Miller

* include/sudo\_util.h, plugins/sudoers/defaults.c,
  plugins/sudoers/iolog\_util.c,
  plugins/sudoers/regress/starttime/check\_starttime.c:

  Move definition of TIME\_T\_MAX to sudo\_util.h
  [[212169387]](https://git.sudo.ws/sudo/commit/?id=212169387)

* NEWS, doc/UPGRADE:

  Changes in 1.8.26 (so far).
  [[4c4f44621]](https://git.sudo.ws/sudo/commit/?id=4c4f44621)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/env.c:

  Treat LOGIN, LOGNAME and USER specially. If one is preserved or deleted
  we want to preserve or delete all of them.
  [[d537daf78]](https://git.sudo.ws/sudo/commit/?id=d537daf78)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/env.c,
  plugins/sudoers/logging.c, plugins/sudoers/regress/visudo/test6.sh:

  Remove special handling of the USERNAME environment variable. It used to
  be set on old versions of Fedora but that hasn’t been the case for some
  time. It’s worth noting that ssh doesn’t set USERNAME either.
  [[5f61f2c0f]](https://git.sudo.ws/sudo/commit/?id=5f61f2c0f)

* configure, configure.ac:

  sudo 1.8.26
  [[ce9a7dd25]](https://git.sudo.ws/sudo/commit/?id=ce9a7dd25)

2018-09-22 Todd C. Miller

* src/sudo.c:

  Remove unused system\_maxgroups argument from fill\_group\_list().
  [[9abcd6160]](https://git.sudo.ws/sudo/commit/?id=9abcd6160)

* lib/util/getgrouplist.c:

  Pass getgrouplist() NGROUPS\_MAX+1, not NGROUPS\_MAX so we have room for
  the primary gid.
  [[d8870177c]](https://git.sudo.ws/sudo/commit/?id=d8870177c)

2018-09-20 Todd C. Miller

* plugins/sudoers/cvtsudoers\_json.c:

  In print\_member\_json\_int() eliminate the need\_newline variable and just
  move the non-alias expansion printing bits into the else clause,
  including the newline and comma printing.
  [[72ce2c807]](https://git.sudo.ws/sudo/commit/?id=72ce2c807)

* MANIFEST, plugins/sudoers/regress/cvtsudoers/test30.out.ok,
  plugins/sudoers/regress/cvtsudoers/test30.sh:

  Add regress test for bug #853
  [[8bf279b11]](https://git.sudo.ws/sudo/commit/?id=8bf279b11)

* plugins/sudoers/cvtsudoers\_json.c:

  When expanding an alias in print\_member\_json\_int() avoid printing an
  extra comma at the end of the entry. [Bug
  #853](https://bugzilla.sudo.ws/show_bug.cgi?id=853).
  [[8aad36508]](https://git.sudo.ws/sudo/commit/?id=8aad36508)

2018-09-12 Todd C. Miller

* doc/CONTRIBUTORS:

  Add Kan Sasaki
  [[8e1e46433]](https://git.sudo.ws/sudo/commit/?id=8e1e46433)

* NEWS, configure, configure.ac:

  sudo 1.8.25p1
  [[365a1ecd4]](https://git.sudo.ws/sudo/commit/?id=365a1ecd4)

* lib/util/event\_poll.c:

  Fix a crash in the event system’s poll() backend introduced with support
  for nanosecond timers. Only affects systems without ppoll(). [Bug
  #851](https://bugzilla.sudo.ws/show_bug.cgi?id=851)
  [[c639c965c]](https://git.sudo.ws/sudo/commit/?id=c639c965c)

2018-09-02 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  regen
  [[1a9b932ff]](https://git.sudo.ws/sudo/commit/?id=1a9b932ff)

2018-08-31 Todd C. Miller

* plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c:

  Allow for some clock drift due to ntpd, etc.
  [[27e549a3e]](https://git.sudo.ws/sudo/commit/?id=27e549a3e)

* plugins/sudoers/visudo.c:

  If sudo\_lock\_file() fails for a reason other than the file already being
  locked, give the user a chance to edit anyway.
  [[470a7830d]](https://git.sudo.ws/sudo/commit/?id=470a7830d)

2018-08-30 Todd C. Miller

* plugins/sudoers/regress/cvtsudoers/test28.sh:

  Quick sort is not a stable sort; use distinct sudoOrder values so the
  output is predictable.
  [[0715b5547]](https://git.sudo.ws/sudo/commit/?id=0715b5547)

* lib/util/regress/atofoo/atofoo\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c, plugins/sudoers/ldap.c,
  plugins/sudoers/regress/parser/check\_base64.c:

  Fix warnings on OpenIndiana (Illumos)
  [[a924b4610]](https://git.sudo.ws/sudo/commit/?id=a924b4610)

* plugins/sudoers/ldap.c:

  Correct ldap\_to\_sudoers() return value.
  [[765d99e1f]](https://git.sudo.ws/sudo/commit/?id=765d99e1f)

* NEWS:

  [Bug #849](https://bugzilla.sudo.ws/show_bug.cgi?id=849)
  [[6e4f8c8cd]](https://git.sudo.ws/sudo/commit/?id=6e4f8c8cd)

* plugins/sudoers/sssd.c:

  The sssd backend used to take the first match, assuming that entries
  were sorted in descending order by sudoOrder. That allowed it to avoid
  iterating over the entire list of rules. Now that we convert to a
  sudoers parse tree, we need to convert rules in ascending order, not
  descending. The simplest way to accomplish this is to simply iterate
  over the rules from last to first, reversing the sort order. [Bug
  #849](https://bugzilla.sudo.ws/show_bug.cgi?id=849)
  [[ae04b40c0]](https://git.sudo.ws/sudo/commit/?id=ae04b40c0)

* MANIFEST, plugins/sudoers/regress/cvtsudoers/test28.out.ok,
  plugins/sudoers/regress/cvtsudoers/test28.sh,
  plugins/sudoers/regress/cvtsudoers/test29.out.ok,
  plugins/sudoers/regress/cvtsudoers/test29.sh:

  Add some more ldif -> sudoers tests to verify sudoOrder.
  [[2221fbe2f]](https://git.sudo.ws/sudo/commit/?id=2221fbe2f)

* plugins/sudoers/ldap.c:

  For conversion to a sudoers parse tree, ldap\_entry\_compare() now needs
  to sort in ascending order, not descending. [Bug
  #849](https://bugzilla.sudo.ws/show_bug.cgi?id=849)
  [[ea38e9d90]](https://git.sudo.ws/sudo/commit/?id=ea38e9d90)

2018-08-29 Todd C. Miller

* plugins/sudoers/cvtsudoers.c:

  No need to set input\_file for stdin in parse\_ldif(); noted by clang
  analyzer.
  [[58445393a]](https://git.sudo.ws/sudo/commit/?id=58445393a)

* plugins/sudoers/iolog\_util.c:

  Use TIME\_T\_MAX when parsing the I/O log file timestamp and disallow
  negative times.
  [[e0b413eb1]](https://git.sudo.ws/sudo/commit/?id=e0b413eb1)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/iolog\_util.c,
  plugins/sudoers/iolog\_util.h,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/regress/iolog\_util/check\_iolog\_util.c,
  plugins/sudoers/sudoreplay.c:

  When parsing an I/O log timing line, store the result in a timespec, not
  a double. The speed factor (for scaling the delay) in sudoreplay is
  still a double but we only need to adjust the delay if the factor is
  something other than 1.0.
  [[e318f27fb]](https://git.sudo.ws/sudo/commit/?id=e318f27fb)

* plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c:

  Fix memory leak in test.
  [[f1f632665]](https://git.sudo.ws/sudo/commit/?id=f1f632665)

* doc/cvtsudoers.cat, doc/sudo.cat, doc/sudo.conf.cat,
  doc/sudo\_plugin.cat, doc/sudoers.cat, doc/sudoers.ldap.cat,
  doc/sudoers\_timestamp.cat, doc/sudoreplay.cat, doc/visudo.cat:

  regen
  [[f9b3223ed]](https://git.sudo.ws/sudo/commit/?id=f9b3223ed)

2018-08-28 Todd C. Miller

* plugins/sudoers/env.c:

  Update conversion of DID\_\* to KEPT\_\* to match the new values of DID\_\*
  and KEPT\_\*.
  [[2ff787026]](https://git.sudo.ws/sudo/commit/?id=2ff787026)

* NEWS, plugins/sudoers/env.c:

  Set the LOGIN environment variable on AIX like we do LOGNAME.
  [[8acc29dc0]](https://git.sudo.ws/sudo/commit/?id=8acc29dc0)

2018-08-27 Todd C. Miller

* config.h.in, configure, configure.ac, m4/sudo.m4,
  plugins/sudoers/bsm\_audit.c:

  Add a test for the 4-argument au\_close() function found in Solaris 11
  instead of assuming it is present if \_\_sun is defined. Fixes a
  compilation error on OpenIndiana and older Solaris versions.
  [[fdd729612]](https://git.sudo.ws/sudo/commit/?id=fdd729612)

* doc/CONTRIBUTORS:

  Add Miguel Sanders and Scott Cheloha
  [[a22296788]](https://git.sudo.ws/sudo/commit/?id=a22296788)

* NEWS:

  testsudoers changes
  [[5bac1e0dd]](https://git.sudo.ws/sudo/commit/?id=5bac1e0dd)

* plugins/sudoers/Makefile.in, plugins/sudoers/testsudoers.c:

  Add ldif support to testsudoers
  [[901b2666f]](https://git.sudo.ws/sudo/commit/?id=901b2666f)

2018-08-26 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers.h, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/parse.h, plugins/sudoers/parse\_ldif.c:

  Move ldif -> sudoers conversion code into parse\_ldif.c
  [[4782b22a4]](https://git.sudo.ws/sudo/commit/?id=4782b22a4)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers.h, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/strlist.c,
  plugins/sudoers/strlist.h:

  Move string list functions to their own file.
  [[52d54997e]](https://git.sudo.ws/sudo/commit/?id=52d54997e)

* lib/util/Makefile.in:

  sync
  [[5fea22e51]](https://git.sudo.ws/sudo/commit/?id=5fea22e51)

2018-08-25 Todd C. Miller

* include/sudo\_event.h, lib/util/event.c, lib/util/util.exp.in:

  Backward ABI compatibility for even functions that use a timeval.
  [[63f7aa8fc]](https://git.sudo.ws/sudo/commit/?id=63f7aa8fc)

* lib/util/event.c, lib/util/event\_poll.c, lib/util/event\_select.c:

  Use a monotonic timer for the event subsystem.
  [[6b76f9dbd]](https://git.sudo.ws/sudo/commit/?id=6b76f9dbd)

* config.h.in, configure, configure.ac, include/sudo\_event.h,
  lib/util/event.c, lib/util/event\_poll.c, lib/util/event\_select.c,
  plugins/sudoers/iolog\_util.h, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c:

  Use struct timespec, not struct timeval in the event subsystem. Use
  ppoll() or pselect() if avaialble which use timespec.
  [[04d1f56d9]](https://git.sudo.ws/sudo/commit/?id=04d1f56d9)

2018-08-24 Todd C. Miller

* .hgignore:

  sync
  [[1f248504a]](https://git.sudo.ws/sudo/commit/?id=1f248504a)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c:

  Eliminate most use of parsed\_sudoers in cvtsudoers
  [[5d1dddc46]](https://git.sudo.ws/sudo/commit/?id=5d1dddc46)

* plugins/sudoers/alias.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/parse.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Make alias\_apply() take 3 arguments, the first being a pointer to the
  struct sudoers\_parse\_tree.
  [[b2e3adccf]](https://git.sudo.ws/sudo/commit/?id=b2e3adccf)

2018-08-23 Todd C. Miller

* plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c:

  Handle systems where root’s gid is not 0.
  [[4b3c8a73a]](https://git.sudo.ws/sudo/commit/?id=4b3c8a73a)

* plugins/sudoers/iolog\_util.c, plugins/sudoers/iolog\_util.h:

  Add missing files from last commit.
  [[2960e3963]](https://git.sudo.ws/sudo/commit/?id=2960e3963)

* .hgignore, MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/po/sudoers.pot,
  plugins/sudoers/regress/iolog\_plugin/check\_iolog\_plugin.c,
  plugins/sudoers/sudoreplay.c:

  Add regress test for I/O log plugin endpoints
  [[aaad554cd]](https://git.sudo.ws/sudo/commit/?id=aaad554cd)

* plugins/sudoers/iolog.c:

  We cannot reuse last\_time for the I/O log info file now that it is a
  monotonic timer. Just call time(3) in write\_info\_log() directly.
  [[0d36ea932]](https://git.sudo.ws/sudo/commit/?id=0d36ea932)

* src/exec\_pty.c:

  Move the loop to free the monitor\_messages list into
  free\_exec\_closure\_pty()
  [[59e5e379b]](https://git.sudo.ws/sudo/commit/?id=59e5e379b)

* po/sudo.pot:

  regen
  [[93fc7cf6d]](https://git.sudo.ws/sudo/commit/?id=93fc7cf6d)

2018-08-22 Todd C. Miller

* lib/util/getentropy.c:

  Fix typo in last commit.
  [[fe965c3a3]](https://git.sudo.ws/sudo/commit/?id=fe965c3a3)

* config.h.in, configure, configure.ac, lib/util/getentropy.c:

  Do not assume all Linux has linux/random.h. Add missing sys/syscall.h
  include
  [[d876602db]](https://git.sudo.ws/sudo/commit/?id=d876602db)

* plugins/sudoers/policy.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/visudo.c, src/sudo\_edit.c:

  Cast uid/gid to unsigned int before printing.
  [[fe5806254]](https://git.sudo.ws/sudo/commit/?id=fe5806254)

* include/sudo\_compat.h:

  Only include stdarg.h if we need it.
  [[10198ef6f]](https://git.sudo.ws/sudo/commit/?id=10198ef6f)

* plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/ldap.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/rcstr.c, plugins/sudoers/timestamp.c, src/sudo\_noexec.c:
  Include stddef.h for offsetof() definition.
  [[aaefdd757]](https://git.sudo.ws/sudo/commit/?id=aaefdd757)

* plugins/sudoers/bsm\_audit.c, plugins/sudoers/timestamp.c:

  fix compiler warnings on Solaris 11
  [[dcf168e70]](https://git.sudo.ws/sudo/commit/?id=dcf168e70)

* lib/util/getentropy.c:

  Fix setting of errno when gotdata() fails.
  [[ad104a3e4]](https://git.sudo.ws/sudo/commit/?id=ad104a3e4)

* NEWS:

  Bugs 846 and 847
  [[6e4ec9180]](https://git.sudo.ws/sudo/commit/?id=6e4ec9180)

* include/sudo\_compat.h:

  We still need to include string.h for AIX (and possibly others) when we
  are not using the system memset\_r() function and rsize\_t is defined by
  the system headers.
  [[5a0c86bb6]](https://git.sudo.ws/sudo/commit/?id=5a0c86bb6)

* configure, configure.ac, include/sudo\_compat.h, mkpkg:

  Add –enable-package-build to give configure a hint that we are building
  a package. This can be used to avoid relying on libc functions that may
  not be present in all libc versions for a particular system. For
  instance, AIX 7.1 may or may not have memset\_s() and getline() present.
  [[957f284bb]](https://git.sudo.ws/sudo/commit/?id=957f284bb)

* include/sudo\_compat.h:

  AIX defines rsize\_t in string.h, not stddef.h for use by the memset\_s()
  prototype. We use our own memset\_s() on AIX since it is not available on
  all BOS levels which makes package building problematic.
  [[d9dec9327]](https://git.sudo.ws/sudo/commit/?id=d9dec9327)

2018-08-21 Todd C. Miller

* plugins/sudoers/defaults.c:

  Fix printing of T\_TIMESPEC values.
  [[9e6c14b09]](https://git.sudo.ws/sudo/commit/?id=9e6c14b09)

* plugins/sudoers/iolog.c:

  Remove unused struct script\_buf
  [[31e065c6c]](https://git.sudo.ws/sudo/commit/?id=31e065c6c)

2018-08-20 Todd C. Miller

* NEWS:

  Document when the I/O log timing file entry bug was introduced.
  [[8d83bd5c0]](https://git.sudo.ws/sudo/commit/?id=8d83bd5c0)

* NEWS:

  sync
  [[afca08c74]](https://git.sudo.ws/sudo/commit/?id=afca08c74)

* config.h.in, configure, configure.ac, lib/util/gettime.c:

  HP-UX doesn’t suport CLOCK\_MONOTONIC but we can use gethrtime() instead.
  [[df1c06252]](https://git.sudo.ws/sudo/commit/?id=df1c06252)

* src/exec\_monitor.c, src/exec\_pty.c:

  Close the pty slave in the parent so that when the command and monitor
  exit, the pty gets recycled without our having to close it directly.
  [[5cca42186]](https://git.sudo.ws/sudo/commit/?id=5cca42186)

* lib/util/term.c, src/exec\_monitor.c, src/exec\_pty.c, src/sudo.h:

  Move updating of the window size to the monitor process. This will allow
  us to close the slave in the main sudo process in the future so only the
  command and monitor have it open.
  [[6953e7fc7]](https://git.sudo.ws/sudo/commit/?id=6953e7fc7)

* configure, configure.ac:

  sudo 1.8.25
  [[db8a760b0]](https://git.sudo.ws/sudo/commit/?id=db8a760b0)

* plugins/sudoers/regress/sudoers/test19.ldif2sudo.ok:

  Fix test output for bug #845
  [[3c562facc]](https://git.sudo.ws/sudo/commit/?id=3c562facc)

* plugins/sudoers/ldap\_util.c:

  Fix pasto when converting sudoNotAfter; from Miguel Sanders [Bug
  #845](https://bugzilla.sudo.ws/show_bug.cgi?id=845)
  [[5af268228]](https://git.sudo.ws/sudo/commit/?id=5af268228)

2018-08-19 Todd C. Miller

* plugins/sudoers/iolog.c:

  Use a monotonic timer that only runs while not suspended for the iolog
  timing values and write nsec-precision entries.
  [[3f1470ebe]](https://git.sudo.ws/sudo/commit/?id=3f1470ebe)

* aclocal.m4, config.h.in, configure, configure.ac, include/sudo\_util.h,
  lib/util/gettime.c, lib/util/util.exp.in:

  Add sudo\_gettime\_uptime() to measure time while not sleeping.
  [[b3227d3ed]](https://git.sudo.ws/sudo/commit/?id=b3227d3ed)

2018-08-18 Todd C. Miller

* mkpkg:

  Detect number of CPUs on AIX.
  [[e74d7e872]](https://git.sudo.ws/sudo/commit/?id=e74d7e872)

* plugins/sudoers/iolog.c:

  Fix I/O log timing file on systems without a C99-compatible snprintf().
  On those systems we use our own snprintf() that doesn’t support floating
  point. We don’t actually need floating point in this case since the we
  can print seconds and microseconds without using it.
  [[afad4eb94]](https://git.sudo.ws/sudo/commit/?id=afad4eb94)

* NEWS:

  Fix for [Bug #844](https://bugzilla.sudo.ws/show_bug.cgi?id=844)
  [[46ab293ce]](https://git.sudo.ws/sudo/commit/?id=46ab293ce)

* src/sudo\_edit.c:

  Handle the case where O\_PATH or O\_SEARCH is defined but O\_DIRECTORY is
  not. In theory, O\_DIRECTORY is redundant when O\_SEARCH is specified but
  it is legal for O\_EXEC and O\_SEARCH to have the same value. [Bug
  #844](https://bugzilla.sudo.ws/show_bug.cgi?id=844)
  [[69541be94]](https://git.sudo.ws/sudo/commit/?id=69541be94)

2018-08-17 Todd C. Miller

* NEWS:

  sync
  [[288f3f17a]](https://git.sudo.ws/sudo/commit/?id=288f3f17a)

* plugins/sudoers/starttime.c:

  Fix get\_starttime() on HP-UX.
  [[92975ee7c]](https://git.sudo.ws/sudo/commit/?id=92975ee7c)

* src/net\_ifs.c:

  Avoid a compilation problem on HP-UX 11.31 with gcc and
  machine/sys/getppdp.h
  [[7d014dfac]](https://git.sudo.ws/sudo/commit/?id=7d014dfac)

* mkpkg:

  Detect number of CPUs on HP-UX. Use MAKE environment variable if set.
  [[d7e265939]](https://git.sudo.ws/sudo/commit/?id=d7e265939)

2018-08-16 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Add CHECK\_SYMBOLS\_LDFLAGS to check\_symbols target. Non-ELF HP-UX
  executables don’t support SHLIB\_PATH or LD\_LIBRARY\_PATH unless ld is
  passed the +s flag. This lets the check\_symbols test pass on systems
  where the ldap libraries aren’t installed in the standard location.
  [[9317367e2]](https://git.sudo.ws/sudo/commit/?id=9317367e2)

2018-08-15 Todd C. Miller

* doc/Makefile.in:

  For the lint target, don’t stop after the first manual that fails lint.
  [[18ddabfeb]](https://git.sudo.ws/sudo/commit/?id=18ddabfeb)

* plugins/sudoers/timestamp.c:

  Add debugging info so we can tell why a timestamp record doesn’t match.
  [[7a929ce13]](https://git.sudo.ws/sudo/commit/?id=7a929ce13)

2018-08-13 Todd C. Miller

* NEWS:

  typo
  [[c0d60b9dd]](https://git.sudo.ws/sudo/commit/?id=c0d60b9dd)

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po, po/da.mo, po/da.po:

  sync with translationproject.org
  [[a7b42e9b2]](https://git.sudo.ws/sudo/commit/?id=a7b42e9b2)

2018-08-08 Todd C. Miller

* NEWS:

  sync
  [[c5f64b741]](https://git.sudo.ws/sudo/commit/?id=c5f64b741)

2018-08-11 Todd C. Miller

* plugins/sudoers/iolog.c:

  Fix the return value of sudoers\_io\_change\_winsize() on success.
  Otherwise, we only log a single window size change.
  [[418bf793f]](https://git.sudo.ws/sudo/commit/?id=418bf793f)

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po:

  sync with translationproject.org
  [[d02646928]](https://git.sudo.ws/sudo/commit/?id=d02646928)

2018-08-07 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Fix ambiguity when talking about Aliases. We can’t use User\_Alias in the
  grammar as both the definition of the Alias as well as its name. This
  adds {User,Runas,Host,Cmnd}\_Alias\_Spec to help differentiate between the
  name of the alias and its definition. [Bug
  #834](https://bugzilla.sudo.ws/show_bug.cgi?id=834)
  [[0484e3d6a]](https://git.sudo.ws/sudo/commit/?id=0484e3d6a)

* doc/cvtsudoers.cat, doc/sudoreplay.cat:

  regen
  [[9722b304b]](https://git.sudo.ws/sudo/commit/?id=9722b304b)

* Makefile.in:

  Warn if unable to run xgettext or msgfmt.
  [[78190bb9c]](https://git.sudo.ws/sudo/commit/?id=78190bb9c)

2018-08-06 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/hr.mo,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/ja.mo,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pt\_BR.mo,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/uk.mo,
  plugins/sudoers/po/vi.mo:

  sync with translationproject.org
  [[0053b07ed]](https://git.sudo.ws/sudo/commit/?id=0053b07ed)

2018-08-05 Todd C. Miller

* plugins/sudoers/fmtsudoers.c, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/policy.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Refactor code to convert defaults to tags and do conversion on output
  for “sudo -l”.

  Remove the short\_list (was long\_list) global in favor of a verbose
  argument.
  [[1e5af3556]](https://git.sudo.ws/sudo/commit/?id=1e5af3556)

2018-08-04 Todd C. Miller

* plugins/sudoers/policy.c:

  Assign short\_list true, not 1 now that it is a boolean.
  [[413b53cda]](https://git.sudo.ws/sudo/commit/?id=413b53cda)

* plugins/sudoers/fmtsudoers.c:

  fix typo
  [[db387a53a]](https://git.sudo.ws/sudo/commit/?id=db387a53a)

2018-08-03 Todd C. Miller

* plugins/sudoers/rcstr.c:

  Fix a warning on FreeBSD which has a fancier \_\_containerof
  implementation.
  [[9cc09e437]](https://git.sudo.ws/sudo/commit/?id=9cc09e437)

* plugins/sudoers/po/de.po, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/it.po, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/pl.po, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/sv.po, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.po:

  sync with translationproject.org
  [[6a692fec3]](https://git.sudo.ws/sudo/commit/?id=6a692fec3)

2018-08-02 Todd C. Miller

* aclocal.m4, autogen.sh, config.h.in, configure:

  Regen with aclocal 1.15.1.
  [[f4a5d2b3e]](https://git.sudo.ws/sudo/commit/?id=f4a5d2b3e)

* plugins/sudoers/ldap.c, plugins/sudoers/parse.c,
  plugins/sudoers/policy.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  For ldap/sssd, include defaults in the generate privilege unless we are
  listing in short mode (in which case we convert them to tags if
  possible). Fixes a problem where sudoOptions were not being applied to
  the command.
  [[608574a21]](https://git.sudo.ws/sudo/commit/?id=608574a21)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/parse.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  update\_defaults() needs to be able to take a defaults\_list for the
  ldap/sssd backends which support per-role defaults.
  [[171686c42]](https://git.sudo.ws/sudo/commit/?id=171686c42)

2018-07-31 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  regen
  [[34655148e]](https://git.sudo.ws/sudo/commit/?id=34655148e)

2018-07-30 Todd C. Miller

* NEWS:

  Update
  [[3b5723085]](https://git.sudo.ws/sudo/commit/?id=3b5723085)

2018-07-26 Todd C. Miller

* plugins/sudoers/alias.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/file.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  o Move userspecs, defaults and aliases into a new struct
  sudoers\_parse\_tree. o The parse tree is now passed to the alias, match
  and defaults functions. o The nss API has been changed so that the nss
  parse() function returns a pointer to a struct sudoers\_parse\_tree which
  will be filled in by the getdefs() and query() functions.
  [[70d519c8a]](https://git.sudo.ws/sudo/commit/?id=70d519c8a)

* lib/util/getgrouplist.c:

  Don’t need to preallocate 4 x NGROUP\_MAX on AIX or BSD/Linux. For
  BSD/Linux, getgrouplist(3) will tell us the number of groups if we don’t
  have enough. For AIX, we can count the entries in the group set before
  allocating the group vector.
  [[86413f95e]](https://git.sudo.ws/sudo/commit/?id=86413f95e)

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/auth/sudo\_auth.h,
  plugins/sudoers/check.c, plugins/sudoers/sudoers.h:

  Ignore PAM\_NEW\_AUTHTOK\_REQD and PAM\_AUTHTOK\_EXPIRED errors from
  pam\_acct\_mgmt() if authentication is disabled for the user. [Bug
  #843](https://bugzilla.sudo.ws/show_bug.cgi?id=843)
  [[394524fd5]](https://git.sudo.ws/sudo/commit/?id=394524fd5)

2018-07-23 Todd C. Miller

* src/exec\_pty.c:

  Work around a bug on AIX where closing the pty slave causes the main
  sudo process to lose its controlling tty (which was *not* the pty
  slave).
  [[dc1e0e716]](https://git.sudo.ws/sudo/commit/?id=dc1e0e716)

* src/sudo.c:

  Add missing aix\_restoreauthdb() call to match the aix\_setauthdb() added
  in b8a011be9af7. Fixes issues on AIX where local users/groups may not be
  resolved when some NIS/AD/LDAP is used for users.
  [[5d31be96a]](https://git.sudo.ws/sudo/commit/?id=5d31be96a)

* lib/util/getgrouplist.c:

  Linux getgrouplist(3) returns the number of groups on success instead of
  0 like BSD.
  [[e7daff062]](https://git.sudo.ws/sudo/commit/?id=e7daff062)

2018-07-20 Todd C. Miller

* mkdep.pl, plugins/sudoers/Makefile.in:

  When both a .o and .lo file was used in a Makefile, we used to make the
  .o depend on the .lo. Unfortunately, this creates a race condition for
  parallel make since libtool is not atomic (it creates a .o and then
  renames it when building PIC objects for shared libs).

  We always link with libtool so the only reason to prefer the .o over the
  .lo file is to avoid mixing .o and .lo in the dependencies. That’s not a
  good enough reason so change mkdep.pl to warn when both a .o and .lo are
  referenced in a Makefile and do nothing else.

  [Bug #842](https://bugzilla.sudo.ws/show_bug.cgi?id=842)
  [[36e21a216]](https://git.sudo.ws/sudo/commit/?id=36e21a216)

2018-07-15 Todd C. Miller

* plugins/sudoers/ldap.c:

  Avoid duplicate free when netgroup\_base is invalid.
  [[2270b1e89]](https://git.sudo.ws/sudo/commit/?id=2270b1e89)

2018-07-03 Todd C. Miller

* lib/util/arc4random.h:

  Use madvise(2) with MADV\_WIPEONFORK if available.
  [[33f96a034]](https://git.sudo.ws/sudo/commit/?id=33f96a034)

2018-07-01 Todd C. Miller

* plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po, po/eo.mo,
  po/eo.po:

  sync with translationproject.org
  [[4b54799dd]](https://git.sudo.ws/sudo/commit/?id=4b54799dd)

* NEWS:

  Update.
  [[c84c32d9e]](https://git.sudo.ws/sudo/commit/?id=c84c32d9e)

2018-06-25 Todd C. Miller

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  sync with schema.OpenLDAP
  [[4859b7879]](https://git.sudo.ws/sudo/commit/?id=4859b7879)

* doc/schema.OpenLDAP:

  RFC 2849 specifies whitespace as the space character only so replace
  tabs with spaces. [Bug
  #840](https://bugzilla.sudo.ws/show_bug.cgi?id=840)
  [[433a74d1d]](https://git.sudo.ws/sudo/commit/?id=433a74d1d)

* doc/schema.OpenLDAP:

  Fix typo; bug #839
  [[dd3366106]](https://git.sudo.ws/sudo/commit/?id=dd3366106)

2018-06-16 Todd C. Miller

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  Should no longer need to set max\_groups.
  [[e1ecc7142]](https://git.sudo.ws/sudo/commit/?id=e1ecc7142)

2018-06-15 Todd C. Miller

* plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/pwutil\_impl.c,
  src/sudo.c:

  Use new sudo\_getgrouplist2() function instead of getgrouplist().
  [[c57ca7440]](https://git.sudo.ws/sudo/commit/?id=c57ca7440)

* configure, configure.ac, include/sudo\_compat.h, include/sudo\_util.h,
  lib/util/Makefile.in, lib/util/getgrouplist.c, lib/util/util.exp.in:

  Add sudo\_getgrouplist2() to dynamically allocate the group vector. This
  allows us to avoid repeatedly calling getgrouplist() with a statically
  sized vector on macOS, Solaris, HP-UX, and AIX.
  [[0ae966283]](https://git.sudo.ws/sudo/commit/?id=0ae966283)

* src/conversation.c:

  Fix fd leak introduced by SUDO\_CONV\_PREFER\_TTY commit. Coverity CID
  186605.
  [[138561379]](https://git.sudo.ws/sudo/commit/?id=138561379)

2018-06-13 Todd C. Miller

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, doc/sudoers\_timestamp.cat,
  doc/sudoers\_timestamp.man.in, doc/sudoers\_timestamp.mdoc.in,
  doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Fix some issues pointed out by mandoc -Tlint
  [[b67915c6e]](https://git.sudo.ws/sudo/commit/?id=b67915c6e)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h, src/conversation.c:

  Add SUDO\_CONV\_PREFER\_TTY flag for conversation function to tell sudo to
  try writing to /dev/tty first. Can be used in conjunction with
  SUDO\_CONV\_INFO\_MSG and SUDO\_CONV\_ERROR\_MSG.
  [[6eadaddc9]](https://git.sudo.ws/sudo/commit/?id=6eadaddc9)

2018-06-08 Todd C. Miller

* doc/LICENSE:

  Update for arc4random.c, arc4random\_uniform.c and getentropy.c
  [[89c83f032]](https://git.sudo.ws/sudo/commit/?id=89c83f032)

2018-06-05 Todd C. Miller

* src/regress/noexec/check\_noexec.c:

  FreeBSD wordexp() returns WRDE\_SYNTAX if it can’t write to the shell
  process. Since we’ve prevented execve() from succeeding this is the
  error we get back from wordexp() on FreeBSD.
  [[8b63ec654]](https://git.sudo.ws/sudo/commit/?id=8b63ec654)

2018-06-04 Todd C. Miller

* plugins/sudoers/starttime.c:

  Fix conversion of usec to nsec; from Scott Cheloha
  [[ec2dae810]](https://git.sudo.ws/sudo/commit/?id=ec2dae810)

2018-06-01 Todd C. Miller

* include/sudo\_plugin.h:

  Fix typo.
  [[dafb5f523]](https://git.sudo.ws/sudo/commit/?id=dafb5f523)

2018-05-29 Todd C. Miller

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  The getdefs() function now get called multiple times so use the cached
  data if present.
  [[919b56722]](https://git.sudo.ws/sudo/commit/?id=919b56722)

* plugins/sudoers/sssd.c, plugins/sudoers/sudoers.c:

  Return an empty defaults list, not NULL if there is no global sudoers
  defaults entry in sss.
  [[899aedfd1]](https://git.sudo.ws/sudo/commit/?id=899aedfd1)

* plugins/sudoers/file.c:

  Fix memory leak of handle pointer on close.
  [[1202beafb]](https://git.sudo.ws/sudo/commit/?id=1202beafb)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Remove a needless copy when parsing options.
  [[c990d93a4]](https://git.sudo.ws/sudo/commit/?id=c990d93a4)

* plugins/sudoers/file.c, plugins/sudoers/ldap.c, plugins/sudoers/parse.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudo\_nss.h, plugins/sudoers/sudoers.c:

  Move cached userspecs and defaults into the handle object.
  [[0b31f186c]](https://git.sudo.ws/sudo/commit/?id=0b31f186c)

2018-05-28 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Quiet a clang analyzer warning. It should not be possible for
  pop\_include() to be called when YY\_CURRENT\_BUFFER is NULL.
  [[1ad2290a2]](https://git.sudo.ws/sudo/commit/?id=1ad2290a2)

* plugins/sudoers/file.c, plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Reorder things to avoid the need to declare static functions.
  [[e401f9283]](https://git.sudo.ws/sudo/commit/?id=e401f9283)

2018-05-24 Todd C. Miller

* lib/util/Makefile.in, lib/util/mktemp.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/insults.h:

  Use arc4random for mkstemp() and insults.
  [[43003d29d]](https://git.sudo.ws/sudo/commit/?id=43003d29d)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_rand.h,
  lib/util/Makefile.in, lib/util/arc4random.c, lib/util/arc4random.h,
  lib/util/arc4random\_uniform.c, lib/util/chacha\_private.h,
  lib/util/getentropy.c, lib/util/util.exp.in, mkdep.pl:

  Import arc4random() from libressl. This takes an all-in-one approach
  instead of the one-file-per-OS approach that libressl takes. The
  fallback code does not have as many OS-specific bits as libressl.
  [[ddd663a5f]](https://git.sudo.ws/sudo/commit/?id=ddd663a5f)

* MANIFEST, configure, configure.ac, include/sudo\_digest.h,
  lib/util/Makefile.in, lib/util/digest.c, lib/util/digest\_gcrypt.c,
  lib/util/digest\_openssl.c, lib/util/util.exp.in, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/digestname.c,
  plugins/sudoers/filedigest.c, plugins/sudoers/filedigest\_gcrypt.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/match.c,
  plugins/sudoers/parse.h, plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/sudo\_ldap.h, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Move digest code into libutil
  [[154a5f59a]](https://git.sudo.ws/sudo/commit/?id=154a5f59a)

2018-05-20 Todd C. Miller

* MANIFEST, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/regress/cvtsudoers/test25.sh,
  plugins/sudoers/regress/cvtsudoers/test26.out.ok,
  plugins/sudoers/regress/cvtsudoers/test26.sh,
  plugins/sudoers/regress/cvtsudoers/test27.out.ok,
  plugins/sudoers/regress/cvtsudoers/test27.sh:

  Check for invalid bas64 attributes.
  [[1cd472c05]](https://git.sudo.ws/sudo/commit/?id=1cd472c05)

* plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/regress/parser/check\_base64.c:

  Fix pointer sign warnings.
  [[a04cb53e3]](https://git.sudo.ws/sudo/commit/?id=a04cb53e3)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Add missing variable declaration for SELinux and Solaris.
  [[5c113e59e]](https://git.sudo.ws/sudo/commit/?id=5c113e59e)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Handle empty string and treat it as safe.
  [[03aa84ed0]](https://git.sudo.ws/sudo/commit/?id=03aa84ed0)

* MANIFEST, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/regress/cvtsudoers/test26.out.ok,
  plugins/sudoers/regress/cvtsudoers/test26.sh:

  Add support for base64-encoding non-safe strings in LDIF output.
  [[1bc8e9abf]](https://git.sudo.ws/sudo/commit/?id=1bc8e9abf)

2018-05-19 Todd C. Miller

* plugins/sudoers/base64.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/parser/check\_base64.c:

  Add base64\_encode() by Jon Mayo.
  [[574c9fcd7]](https://git.sudo.ws/sudo/commit/?id=574c9fcd7)

2018-05-18 Todd C. Miller

* MANIFEST, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/regress/cvtsudoers/test25.out.ok,
  plugins/sudoers/regress/cvtsudoers/test25.sh:

  Add support for parsing base64-encoded attributes
  [[1ab360601]](https://git.sudo.ws/sudo/commit/?id=1ab360601)

2018-05-17 Todd C. Miller

* plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/regress/sudoers/test2.ldif.ok:

  rfc2253 says we need to escape " and leading and trailing space.
  [[7d42a609d]](https://git.sudo.ws/sudo/commit/?id=7d42a609d)

* configure, configure.ac:

  Define ZLIB\_CONST so we get the const version of the API.
  [[dfb66044e]](https://git.sudo.ws/sudo/commit/?id=dfb66044e)

2018-05-16 Todd C. Miller

* plugins/sudoers/parse.c:

  Fix logic inversion when handing the authenticate Defaults option for
  “sudo -l” and “sudo -v” in long list mode.
  [[1494f25ba]](https://git.sudo.ws/sudo/commit/?id=1494f25ba)

* plugins/sudoers/sssd.c:

  Set handle->pw before sss\_to\_sudoers() since sss\_check\_user() uses it.
  Coverity CID 185651
  [[c30ad9710]](https://git.sudo.ws/sudo/commit/?id=c30ad9710)

* plugins/sudoers/ldap\_util.c:

  Fix memory leak on error, CID 185602
  [[8ce49ecb2]](https://git.sudo.ws/sudo/commit/?id=8ce49ecb2)

* plugins/sudoers/ldap.c:

  Some ldap\_get\_values\_len -> sudo\_ldap\_get\_values\_len that were missed
  before.
  [[8ad51fe08]](https://git.sudo.ws/sudo/commit/?id=8ad51fe08)

* plugins/sudoers/ldap\_util.c:

  When building up the cmndspec, add the actual command member last. This
  simplifies the logic regarding the SETENV tag and alsomakes “out of
  memory” cleanup simpler.
  [[b7e6d0490]](https://git.sudo.ws/sudo/commit/?id=b7e6d0490)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Fix format string mismatch, sudo\_order is unsigned.
  [[210280082]](https://git.sudo.ws/sudo/commit/?id=210280082)

* plugins/sudoers/pwutil.c:

  Add cppcheck annotation to suppress memory leak false positive.
  [[b31656b7f]](https://git.sudo.ws/sudo/commit/?id=b31656b7f)

* plugins/sudoers/ldap\_util.c:

  Sudo “ALL” implies the SETENV tag.
  [[3ca0882d1]](https://git.sudo.ws/sudo/commit/?id=3ca0882d1)

* src/parse\_args.c:

  Only set MODE\_PRESERVE\_ENV when preserving the entire environment. Fixes
  a problem introduced in 1.8.23 where “sudo -i” could not be used in
  conjunction with –preserve-env=VARIABLE. [Bug
  #835](https://bugzilla.sudo.ws/show_bug.cgi?id=835)
  [[cf9c0102d]](https://git.sudo.ws/sudo/commit/?id=cf9c0102d)

2018-05-15 Todd C. Miller

* plugins/sudoers/file.c, plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/ldap.c, plugins/sudoers/parse.h, plugins/sudoers/sssd.c:
  Add free\_userspecs() and free\_default() and use them instead of looping
  over the lists and calling free\_userspec() and free\_default().
  [[f38317269]](https://git.sudo.ws/sudo/commit/?id=f38317269)

* configure, configure.ac:

  Depending on the bos level, AIX 6.1 may or may not include
  getline/getdelim and AIX 7.1 may or may not include memset\_s. Since we
  need to build packages that will work on all AIX 6.1 and 7.1 machines,
  use our getline() and memset\_s emulation.
  [[3a4c0e06c]](https://git.sudo.ws/sudo/commit/?id=3a4c0e06c)

2018-05-14 Todd C. Miller

* plugins/sudoers/ldap\_util.c:

  Do not leak struct sudo\_command when the command is ALL. Coverity CID
  185602.
  [[93eec5fb9]](https://git.sudo.ws/sudo/commit/?id=93eec5fb9)

* NEWS, configure, configure.ac:

  Sudo 1.8.24
  [[808ec34ab]](https://git.sudo.ws/sudo/commit/?id=808ec34ab)

* plugins/sudoers/sssd.c:

  Improve comments about why we need to do a user check and how it related
  to netgroups.
  [[9f36ae62f]](https://git.sudo.ws/sudo/commit/?id=9f36ae62f)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Add checks for ldap/sss functions failing due to memory allocation
  errors.
  [[d052f8a68]](https://git.sudo.ws/sudo/commit/?id=d052f8a68)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Let the main sudoers lookup code check the host name. We still check the
  user name so it is possible to use a single userspec but this may change
  in the future.
  [[904f37e03]](https://git.sudo.ws/sudo/commit/?id=904f37e03)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/defaults.c,
  plugins/sudoers/defaults.h, plugins/sudoers/file.c,
  plugins/sudoers/ldap.c, plugins/sudoers/ldap\_util.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/sssd.c, plugins/sudoers/sudo\_ldap.h,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudo\_nss.h,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Simplify the nss interface such that each sudoers provider fills in a
  per-nss list of userspecs and defaults instead of using separate lookup
  and list functions. This makes it possible to have a single
  implementation of the code for sudoers lookup and listing.
  [[f9be3a48a]](https://git.sudo.ws/sudo/commit/?id=f9be3a48a)

* plugins/sudoers/alias.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/defaults.c, plugins/sudoers/filedigest.c,
  plugins/sudoers/filedigest\_gcrypt.c,
  plugins/sudoers/filedigest\_openssl.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/ldap\_util.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.c,
  plugins/sudoers/policy.c, plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/toke\_util.c,
  plugins/sudoers/visudo.c:

  Include parse.h in sudoers.h since it will soon be required.
  [[71e98d949]](https://git.sudo.ws/sudo/commit/?id=71e98d949)

* plugins/sudoers/ldap\_util.c:

  Parse “ALL” as a command correctly.
  [[cc3428398]](https://git.sudo.ws/sudo/commit/?id=cc3428398)

2018-05-11 Todd C. Miller

* plugins/sudoers/match.c:

  Add debug warning if lseek() fails (should not be possible).
  [[4a3aa5f6e]](https://git.sudo.ws/sudo/commit/?id=4a3aa5f6e)

* plugins/sudoers/match.c:

  Fix swapped args of lseek() when rewinding. This didn’t cause a problem
  because the value of SEEK\_SET is 0.
  [[7b1e78d6d]](https://git.sudo.ws/sudo/commit/?id=7b1e78d6d)

2018-05-10 Todd C. Miller

* plugins/sudoers/regress/parser/check\_hexchar.c:

  Fix a format-truncation warning in newer gcc by avoiding using %0x and
  %0X in the test. We are formatting a single byte so just do it one
  nybble at a time.
  [[6e290763c]](https://git.sudo.ws/sudo/commit/?id=6e290763c)

* configure:

  Regen with autoconf git commit e17a30e987d7ee695fb4294a82d987ec3dc9b974
  AC\_HEADER\_MAJOR: port to glibc 2.25
  [[3359d7290]](https://git.sudo.ws/sudo/commit/?id=3359d7290)

2018-05-03 Todd C. Miller

* plugins/sudoers/cvtsudoers\_ldif.c:

  No need to explicitly free role on EOF, it will be freed after the loop
  is done.
  [[7a940ce30]](https://git.sudo.ws/sudo/commit/?id=7a940ce30)

* plugins/sudoers/policy.c:

  Garbage collect the command argv, envp and info vectors since they are
  not available at policy close time.
  [[29d188f4b]](https://git.sudo.ws/sudo/commit/?id=29d188f4b)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Plug memory leaks on parse error or when an LDIF entry doesn’t match the
  dn filter.
  [[b0c13e995]](https://git.sudo.ws/sudo/commit/?id=b0c13e995)

* plugins/sudoers/cvtsudoers.c:

  Rename variables now that the string list functions are not
  ldap-specific.
  [[620070f49]](https://git.sudo.ws/sudo/commit/?id=620070f49)

2018-04-30 Todd C. Miller

* NEWS:

  Fix typo
  [[1a087ceba]](https://git.sudo.ws/sudo/commit/?id=1a087ceba)

2018-04-29 Todd C. Miller

* configure, configure.ac:

  fix version
  [[82dfbf458]](https://git.sudo.ws/sudo/commit/?id=82dfbf458)

* NEWS:

  sync
  [[929396fbc]](https://git.sudo.ws/sudo/commit/?id=929396fbc)

* configure, configure.ac, plugins/sudoers/po/zh\_CN.mo,
  plugins/sudoers/po/zh\_CN.po, po/zh\_CN.mo, po/zh\_CN.po:

  sync with translationproject.org
  [[23b2879e0]](https://git.sudo.ws/sudo/commit/?id=23b2879e0)

2018-04-25 Todd C. Miller

* plugins/sudoers/match.c:

  O\_EXEC for fexecve() not O\_SEARCH.
  [[a18e81148]](https://git.sudo.ws/sudo/commit/?id=a18e81148)

* doc/TROUBLESHOOTING:

  Document how to suppress the last login message on Solaris.
  [[95fb4458d]](https://git.sudo.ws/sudo/commit/?id=95fb4458d)

2018-04-24 Todd C. Miller

* plugins/sudoers/cvtsudoers\_json.c:

  Fix compilation error with older Sun Studio compilers.
  [[f53e5e2bd]](https://git.sudo.ws/sudo/commit/?id=f53e5e2bd)

* NEWS:

  Update [Bug #831](https://bugzilla.sudo.ws/show_bug.cgi?id=831)
  decription.
  [[55869277b]](https://git.sudo.ws/sudo/commit/?id=55869277b)

* MANIFEST, doc/CONTRIBUTORS, po/zh\_TW.mo, po/zh\_TW.po:

  Add Chinese(Taiwan) translation for sudo.
  [[f23d73dfe]](https://git.sudo.ws/sudo/commit/?id=f23d73dfe)

* plugins/sudoers/match.c:

  Move the check for /dev/fd/N until *after* the digest has been checked.
  We still need to be able to check the digest even if there is no
  /dev/fd/N or fexecve().
  [[cfdae3a4f]](https://git.sudo.ws/sudo/commit/?id=cfdae3a4f)

2018-04-23 Todd C. Miller

* plugins/sudoers/match.c:

  Rewind the fd after calling sudo\_filedigest(). Otherwise, when running a
  script via fexecve(), the interpreter may get EOF when reading
  /dev/fd/N. This only appears to affect BSD systems with fdescfs. [Bug
  #831](https://bugzilla.sudo.ws/show_bug.cgi?id=831).
  [[64c78a61c]](https://git.sudo.ws/sudo/commit/?id=64c78a61c)

* plugins/sudoers/match.c:

  In open\_cmnd(), return true, not false, if we the /dev/fd/N pathname is
  not present. We don’t want to fail a match because of this.
  [[6e22da341]](https://git.sudo.ws/sudo/commit/?id=6e22da341)

* NEWS:

  [Bug #831](https://bugzilla.sudo.ws/show_bug.cgi?id=831).
  [[3f1ec0c5f]](https://git.sudo.ws/sudo/commit/?id=3f1ec0c5f)

* plugins/sudoers/match.c:

  We can only use fexecve() on a script if /dev/fd/N exists. Some systems,
  such as FreeBSD, don’t have /dev/fd mounted by default. [Bug
  #831](https://bugzilla.sudo.ws/show_bug.cgi?id=831)
  [[def2e761e]](https://git.sudo.ws/sudo/commit/?id=def2e761e)

2018-04-22 Todd C. Miller

* plugins/sudoers/po/ca.mo, plugins/sudoers/po/ca.po,
  plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/el.mo, plugins/sudoers/po/el.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/eu.mo, plugins/sudoers/po/eu.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/fur.mo, plugins/sudoers/po/fur.po,
  plugins/sudoers/po/hu.mo, plugins/sudoers/po/hu.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/lt.mo, plugins/sudoers/po/lt.po,
  plugins/sudoers/po/nl.mo, plugins/sudoers/po/nl.po,
  plugins/sudoers/po/ru.mo, plugins/sudoers/po/ru.po,
  plugins/sudoers/po/sk.mo, plugins/sudoers/po/sk.po,
  plugins/sudoers/po/sl.mo, plugins/sudoers/po/sl.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/tr.mo, plugins/sudoers/po/tr.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/ca.mo,
  po/ca.po, po/da.mo, po/da.po, po/de.mo, po/de.po, po/eo.mo, po/eo.po,
  po/es.mo, po/es.po, po/eu.mo, po/eu.po, po/fi.mo, po/fi.po, po/fur.mo,
  po/fur.po, po/gl.mo, po/gl.po, po/hu.mo, po/hu.po, po/ko.mo, po/ko.po,
  po/nl.mo, po/nl.po, po/nn.mo, po/nn.po, po/ru.mo, po/ru.po, po/sk.mo,
  po/sk.po, po/sl.mo, po/sl.po, po/sr.mo, po/sr.po, po/vi.mo, po/vi.po,
  po/zh\_CN.mo, po/zh\_CN.po:

  sync with translationproject.org
  [[16093ee8d]](https://git.sudo.ws/sudo/commit/?id=16093ee8d)

2018-04-21 Todd C. Miller

* plugins/sudoers/po/ca.mo, plugins/sudoers/po/ca.po,
  plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/el.mo, plugins/sudoers/po/el.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/eu.mo, plugins/sudoers/po/eu.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/fur.mo, plugins/sudoers/po/fur.po,
  plugins/sudoers/po/hu.mo, plugins/sudoers/po/hu.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/lt.mo, plugins/sudoers/po/lt.po,
  plugins/sudoers/po/nl.mo, plugins/sudoers/po/nl.po,
  plugins/sudoers/po/ru.mo, plugins/sudoers/po/ru.po,
  plugins/sudoers/po/sk.mo, plugins/sudoers/po/sk.po,
  plugins/sudoers/po/sl.mo, plugins/sudoers/po/sl.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/tr.mo, plugins/sudoers/po/tr.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/ca.mo,
  po/ca.po, po/da.mo, po/da.po, po/de.mo, po/de.po, po/eo.mo, po/eo.po,
  po/es.mo, po/es.po, po/eu.mo, po/eu.po, po/fi.mo, po/fi.po, po/fur.mo,
  po/fur.po, po/gl.mo, po/gl.po, po/hu.mo, po/hu.po, po/ko.mo, po/ko.po,
  po/nl.mo, po/nl.po, po/nn.mo, po/nn.po, po/ru.mo, po/ru.po, po/sk.mo,
  po/sk.po, po/sl.mo, po/sl.po, po/sr.mo, po/sr.po, po/vi.mo, po/vi.po,
  po/zh\_CN.mo, po/zh\_CN.po:

  sync with translationproject.org
  [[388ef262d]](https://git.sudo.ws/sudo/commit/?id=388ef262d)

* MANIFEST, plugins/sudoers/regress/cvtsudoers/test23.out.ok,
  plugins/sudoers/regress/cvtsudoers/test23.sh,
  plugins/sudoers/regress/cvtsudoers/test24.out.ok,
  plugins/sudoers/regress/cvtsudoers/test24.sh:

  Add tests for round-tripping cvtsudoers, sudoers -> LDIF -> sudoers
  and LDIF -> sudoers -> LDIF.
  [[c64e57dad]](https://git.sudo.ws/sudo/commit/?id=c64e57dad)

2018-04-19 Todd C. Miller

* MANIFEST, plugins/sudoers/regress/cvtsudoers/test22.out.ok,
  plugins/sudoers/regress/cvtsudoers/test22.sh:

  Test the -b option when converting from LDIF.
  [[48f74db60]](https://git.sudo.ws/sudo/commit/?id=48f74db60)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Fix the -b option when converting from LDIF.
  [[e1392cd28]](https://git.sudo.ws/sudo/commit/?id=e1392cd28)

2018-04-18 Todd C. Miller

* plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po, po/it.mo, po/it.po:

  sync with translationproject.org
  [[109160df3]](https://git.sudo.ws/sudo/commit/?id=109160df3)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in:

  Fix some more typos.
  [[3dd7d9693]](https://git.sudo.ws/sudo/commit/?id=3dd7d9693)

* doc/Makefile.in:

  mandoc now preserves the copyright notice, no need to do it ourselves
  [[93a8ddca2]](https://git.sudo.ws/sudo/commit/?id=93a8ddca2)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Describe the special handling of LOGNAME, USER and USERNAME. Fix typos
  reported by aspell.
  [[1e26c6043]](https://git.sudo.ws/sudo/commit/?id=1e26c6043)

* src/load\_plugins.c:

  Fix a memory leak on the error path.
  [[8eccfbd7b]](https://git.sudo.ws/sudo/commit/?id=8eccfbd7b)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document that the editor setting is also used by sudoedit.
  [[3194a00e9]](https://git.sudo.ws/sudo/commit/?id=3194a00e9)

2018-04-17 Todd C. Miller

* src/load\_plugins.c, src/sudo.c, src/sudo\_plugin\_int.h:

  Plug memory leak when an I/O plugin is specified in sudo.conf but the
  I/O plugin is not configured.
  [[18e06825f]](https://git.sudo.ws/sudo/commit/?id=18e06825f)

* INSTALL, MANIFEST, NEWS, config.h.in, configure, configure.ac,
  plugins/sudoers/Makefile.in, plugins/sudoers/ins\_python.h,
  plugins/sudoers/insults.h:

  Monty Python insults from Philip Hudson
  [[523f0eeea]](https://git.sudo.ws/sudo/commit/?id=523f0eeea)

2018-04-15 Todd C. Miller

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in:

  add examples
  [[f9994f79d]](https://git.sudo.ws/sudo/commit/?id=f9994f79d)

* doc/sudo.conf.man.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.ldap.man.in, doc/sudoers.man.in,
  doc/sudoers\_timestamp.man.in, doc/sudoreplay.man.in, doc/visudo.man.in:

  Update copyright year and regen man pages.
  [[43ea752de]](https://git.sudo.ws/sudo/commit/?id=43ea752de)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po, po/cs.mo, po/cs.po,
  po/fr.mo, po/fr.po, po/hr.mo, po/hr.po, po/ja.mo, po/ja.po, po/nb.mo,
  po/nb.po, po/pl.mo, po/pl.po, po/pt\_BR.mo, po/pt\_BR.po, po/sv.mo,
  po/sv.po, po/tr.mo, po/tr.po, po/uk.mo, po/uk.po:

  sync with translationproject.org
  [[9de8a0bd0]](https://git.sudo.ws/sudo/commit/?id=9de8a0bd0)

* MANIFEST, examples/sudoers, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/cvtsudoers/sudoers,
  plugins/sudoers/regress/cvtsudoers/sudoers.defs,
  plugins/sudoers/regress/cvtsudoers/test1.out.ok,
  plugins/sudoers/regress/cvtsudoers/test1.sh,
  plugins/sudoers/regress/cvtsudoers/test10.out.ok,
  plugins/sudoers/regress/cvtsudoers/test10.sh,
  plugins/sudoers/regress/cvtsudoers/test11.out.ok,
  plugins/sudoers/regress/cvtsudoers/test11.sh,
  plugins/sudoers/regress/cvtsudoers/test12.out.ok,
  plugins/sudoers/regress/cvtsudoers/test12.sh,
  plugins/sudoers/regress/cvtsudoers/test13.out.ok,
  plugins/sudoers/regress/cvtsudoers/test13.sh,
  plugins/sudoers/regress/cvtsudoers/test14.out.ok,
  plugins/sudoers/regress/cvtsudoers/test14.sh,
  plugins/sudoers/regress/cvtsudoers/test15.out.ok,
  plugins/sudoers/regress/cvtsudoers/test15.sh,
  plugins/sudoers/regress/cvtsudoers/test16.out.ok,
  plugins/sudoers/regress/cvtsudoers/test16.sh,
  plugins/sudoers/regress/cvtsudoers/test17.out.ok,
  plugins/sudoers/regress/cvtsudoers/test17.sh,
  plugins/sudoers/regress/cvtsudoers/test18.out.ok,
  plugins/sudoers/regress/cvtsudoers/test18.sh,
  plugins/sudoers/regress/cvtsudoers/test19.out.ok,
  plugins/sudoers/regress/cvtsudoers/test19.sh,
  plugins/sudoers/regress/cvtsudoers/test2.out.ok,
  plugins/sudoers/regress/cvtsudoers/test2.sh,
  plugins/sudoers/regress/cvtsudoers/test20.conf,
  plugins/sudoers/regress/cvtsudoers/test20.out.ok,
  plugins/sudoers/regress/cvtsudoers/test20.sh,
  plugins/sudoers/regress/cvtsudoers/test21.conf,
  plugins/sudoers/regress/cvtsudoers/test21.out.ok,
  plugins/sudoers/regress/cvtsudoers/test21.sh,
  plugins/sudoers/regress/cvtsudoers/test3.out.ok,
  plugins/sudoers/regress/cvtsudoers/test3.sh,
  plugins/sudoers/regress/cvtsudoers/test4.out.ok,
  plugins/sudoers/regress/cvtsudoers/test4.sh,
  plugins/sudoers/regress/cvtsudoers/test5.out.ok,
  plugins/sudoers/regress/cvtsudoers/test5.sh,
  plugins/sudoers/regress/cvtsudoers/test6.out.ok,
  plugins/sudoers/regress/cvtsudoers/test6.sh,
  plugins/sudoers/regress/cvtsudoers/test7.out.ok,
  plugins/sudoers/regress/cvtsudoers/test7.sh,
  plugins/sudoers/regress/cvtsudoers/test8.out.ok,
  plugins/sudoers/regress/cvtsudoers/test8.sh,
  plugins/sudoers/regress/cvtsudoers/test9.out.ok,
  plugins/sudoers/regress/cvtsudoers/test9.sh:

  cvtsudoers regress tests
  [[4be8aba9f]](https://git.sudo.ws/sudo/commit/?id=4be8aba9f)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/match.c:

  Prune alias contents when pruning and expanding aliases. This abuses the
  userlist\_matches\_filter() and hostlist\_matches\_filter() functions. A
  better approach would be to call the correct function from
  user\_matches() and host\_matches().
  [[1bfe03000]](https://git.sudo.ws/sudo/commit/?id=1bfe03000)

2018-04-14 Todd C. Miller

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in:

  Fix typo
  [[f8f0c16c7]](https://git.sudo.ws/sudo/commit/?id=f8f0c16c7)

* plugins/sudoers/cvtsudoers.c:

  Fix cut & pasto that prevented “-d command” from working.
  [[d85e244c6]](https://git.sudo.ws/sudo/commit/?id=d85e244c6)

2018-04-13 Todd C. Miller

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y:

  Fix a user after free crash as well as a memory leak when filtering
  Defaults.
  [[38ff66162]](https://git.sudo.ws/sudo/commit/?id=38ff66162)

2018-04-12 Todd C. Miller

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in:

  Document that a User\_Alias or Host\_Alias may be used in the match
  filter.
  [[c1accd4b4]](https://git.sudo.ws/sudo/commit/?id=c1accd4b4)

* plugins/sudoers/fmtsudoers.c:

  Don’t always expand aliases when formatting a host-based Defaults line.
  This was missed when expand\_aliases support was added.
  [[df7a6ea4e]](https://git.sudo.ws/sudo/commit/?id=df7a6ea4e)

* plugins/sudoers/cvtsudoers.c:

  Allow host and user aliases to be specified in match filters.
  [[2b2565b2c]](https://git.sudo.ws/sudo/commit/?id=2b2565b2c)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update copyright year.
  [[aa900c0f2]](https://git.sudo.ws/sudo/commit/?id=aa900c0f2)

2018-04-10 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/hu.mo, plugins/sudoers/po/hu.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po, po/da.mo, po/da.po,
  po/hr.mo, po/hr.po, po/hu.mo, po/hu.po, po/pt\_BR.mo, po/pt\_BR.po,
  po/tr.mo, po/tr.po:

  sync with translationproject.org
  [[7a3472cb0]](https://git.sudo.ws/sudo/commit/?id=7a3472cb0)

2018-04-09 Todd C. Miller

* plugins/sudoers/alias.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/parse.h:

  When the -d option is used, remove aliases used by the non-converted
  Defaults settings if the aliases are not also referenced by userspecs.
  [[9e91d3f45]](https://git.sudo.ws/sudo/commit/?id=9e91d3f45)

2018-04-05 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[8c64cd97d]](https://git.sudo.ws/sudo/commit/?id=8c64cd97d)

* NEWS:

  update
  [[9e0c75135]](https://git.sudo.ws/sudo/commit/?id=9e0c75135)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in:

  Mention -p and -M options in the description of -m.
  [[0b7abea16]](https://git.sudo.ws/sudo/commit/?id=0b7abea16)

2018-04-04 Todd C. Miller

* src/sudo\_edit.c:

  Check sudoedit temporary directory for writability before using it.
  [[5ae557e30]](https://git.sudo.ws/sudo/commit/?id=5ae557e30)

* plugins/sudoers/regress/starttime/check\_starttime.c:

  Use btime in /proc/stat to determine system start time instead of
  /proc/uptime. Fixes the process start time test when run from a
  container where /proc/uptime is the uptime of the container but the
  process start time is relative to the host system boot time. [Bug
  #829](https://bugzilla.sudo.ws/show_bug.cgi?id=829)
  [[512e0be83]](https://git.sudo.ws/sudo/commit/?id=512e0be83)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/match.c, plugins/sudoers/parse.h:

  Add option to prune non-matching entries from cvtsudoers output with -m
  option is used.
  [[7663ae7b2]](https://git.sudo.ws/sudo/commit/?id=7663ae7b2)

2018-04-02 Todd C. Miller

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h:

  Allow defaults types and suppression list to be specified in the config
  file.
  [[5c1d9899e]](https://git.sudo.ws/sudo/commit/?id=5c1d9899e)

* plugins/sudoers/alias.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/parse.h, plugins/sudoers/visudo.c:

  Refactor common alias code out of cvtsudoers and visudo and into
  alias.c.
  [[18ba38ef4]](https://git.sudo.ws/sudo/commit/?id=18ba38ef4)

2018-03-29 Todd C. Miller

* plugins/sudoers/cvtsudoers.c:

  Avoid NULL deref in an error path. CID 183467
  [[dbd5613b1]](https://git.sudo.ws/sudo/commit/?id=dbd5613b1)

* plugins/sudoers/cvtsudoers.c:

  No need to initialize the last pointer passed to strtok\_r(). This was
  originally added to appease newer gcc but no longer seems to be
  required. CID 183466, CID 183468, CID 183469
  [[18371cacb]](https://git.sudo.ws/sudo/commit/?id=18371cacb)

* plugins/sudoers/cvtsudoers\_json.c:

  Avoid false positive NULL dereference by uses value.u.string instead of
  name as the former is guaranteed not to be NULL. Fixes CID 183465.
  [[6f6621644]](https://git.sudo.ws/sudo/commit/?id=6f6621644)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[b4b5243bf]](https://git.sudo.ws/sudo/commit/?id=b4b5243bf)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  Add a section on convertion from file-based sudoers.
  [[e7ba359ab]](https://git.sudo.ws/sudo/commit/?id=e7ba359ab)

2018-03-28 Todd C. Miller

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c:

  Add support for “cvtsudoers -d all”
  [[dd545f38c]](https://git.sudo.ws/sudo/commit/?id=dd545f38c)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h:

  Add -d option to control what type of Defaults entries are converted.
  [[aa402cdc3]](https://git.sudo.ws/sudo/commit/?id=aa402cdc3)

2018-03-27 Todd C. Miller

* src/exec\_pty.c:

  In pty\_close() we still need to check whether the pty master and slave
  fds are open before closing them. When no tty is present but we are I/O
  logging pty\_close() will be called when there is no actual pty in use.
  [[a42cf67ac]](https://git.sudo.ws/sudo/commit/?id=a42cf67ac)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/sudo.conf.cat,
  doc/sudoers\_timestamp.cat, doc/visudo.cat:

  regen
  [[809c15d16]](https://git.sudo.ws/sudo/commit/?id=809c15d16)

2018-03-26 Todd C. Miller

* .hgignore:

  ignore \*.ldif2sudo regress output
  [[693cdbd96]](https://git.sudo.ws/sudo/commit/?id=693cdbd96)

* src/exec\_pty.c:

  In pty\_close() there is no need to remove events associated with the pty
  slave as there are none. We also don’t need to check for the pty fds
  being -1 since they are not closed elsewhere and pty\_close() is only
  called if pty\_setup() succeeds.
  [[233649634]](https://git.sudo.ws/sudo/commit/?id=233649634)

2018-03-25 Todd C. Miller

* doc/Makefile.in, doc/cvtsudoers.mdoc.in:

  Move cvtsudoers to section 1.
  [[5e7ff154b]](https://git.sudo.ws/sudo/commit/?id=5e7ff154b)

* src/exec\_pty.c:

  In pty\_close() close the slave and remove any events associated with it.
  Fixes a potential hang when performing the final flush on non-BSD
  systems.
  [[4df454310]](https://git.sudo.ws/sudo/commit/?id=4df454310)

2018-03-23 Todd C. Miller

* plugins/sudoers/ldap\_util.c:

  Fix typo in strcmp(), we are comparing var not val.
  [[6da40a7b5]](https://git.sudo.ws/sudo/commit/?id=6da40a7b5)

* MANIFEST:

  sync
  [[22c9ed8e7]](https://git.sudo.ws/sudo/commit/?id=22c9ed8e7)

* NEWS:

  sync
  [[7cdc79eb7]](https://git.sudo.ws/sudo/commit/?id=7cdc79eb7)

2018-03-22 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  regen
  [[30f817408]](https://git.sudo.ws/sudo/commit/?id=30f817408)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/cvtsudoers\_pwutil.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/sudoers.h:

  Add -M option to cvtsudoers to force the use of the local passwd and
  group databases when matching.
  [[14ee65c52]](https://git.sudo.ws/sudo/commit/?id=14ee65c52)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c:

  Add cvtsudoers command line option to suppress certain parts of the
  security policy. Can be used to suppress displaying of Defaults entries,
  aliases or privileges.
  [[8a237eb07]](https://git.sudo.ws/sudo/commit/?id=8a237eb07)

2018-03-21 Todd C. Miller

* plugins/sudoers/regress/parser/check\_gentime.c:

  Silence a false positive from the clang static analyzer.
  [[af6e1cd7c]](https://git.sudo.ws/sudo/commit/?id=af6e1cd7c)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/parse.h:

  Silence a false positive from the clang static analyzer.
  [[821e8a07d]](https://git.sudo.ws/sudo/commit/?id=821e8a07d)

* plugins/sudoers/cvtsudoers.c:

  Fix memory leak on error path.
  [[fbed17e1a]](https://git.sudo.ws/sudo/commit/?id=fbed17e1a)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[e9512df6b]](https://git.sudo.ws/sudo/commit/?id=e9512df6b)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/cvtsudoers\_ldif.c:

  Move cvtsudoers string functions into cvtsudoers.c
  [[bbd3e558b]](https://git.sudo.ws/sudo/commit/?id=bbd3e558b)

* plugins/sudoers/Makefile.in:

  regen
  [[9ab5dc5f7]](https://git.sudo.ws/sudo/commit/?id=9ab5dc5f7)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/alias.c,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/cvtsudoers\_pwutil.c,
  plugins/sudoers/parse.h:

  Initial support filtering by user, group and host in cvtsudoers.
  Currently forces alias expansion when a filter is applied and the entire
  matching user or host list is printed, even the non-matching entries.
  This effectively allows you to grep sudoers by user, group and host.
  [[ff79de859]](https://git.sudo.ws/sudo/commit/?id=ff79de859)

* plugins/sudoers/defaults.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/parse.h:

  Add free\_default() to free a struct defaults pointer so we have a single
  place where we free the defaults. A pointer to the previous Default’s
  binding may be passed in to avoid freeing an already free binding.
  [[bc5e2d06a]](https://git.sudo.ws/sudo/commit/?id=bc5e2d06a)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Decrease bullet width to 1n.
  [[b6c53ac84]](https://git.sudo.ws/sudo/commit/?id=b6c53ac84)

2018-03-17 Todd C. Miller

* src/sudo.c:

  Add aix\_setauthdb() before the initial getpwuid() call.
  [[b06e04683]](https://git.sudo.ws/sudo/commit/?id=b06e04683)

2018-03-10 Todd C. Miller

* plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.h:
  fix compilation on Solaris
  [[910f28894]](https://git.sudo.ws/sudo/commit/?id=910f28894)

2018-03-08 Todd C. Miller

* doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  plugins/sudoers/sudoreplay.c:

  Make “sudoreplay -m 0” skip the pauses entirely.
  [[1cb5ab8b9]](https://git.sudo.ws/sudo/commit/?id=1cb5ab8b9)

* doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in:

  Document that a negative value for -m will elmininate the pauses.
  [[0ffd23945]](https://git.sudo.ws/sudo/commit/?id=0ffd23945)

2018-03-06 Todd C. Miller

* plugins/sudoers/testsudoers.c:

  Update copyright date, remove unneeded include and add a few comments.
  [[24f8e62e7]](https://git.sudo.ws/sudo/commit/?id=24f8e62e7)

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/sudoers/test1.out.ok,
  plugins/sudoers/regress/sudoers/test10.out.ok,
  plugins/sudoers/regress/sudoers/test11.out.ok,
  plugins/sudoers/regress/sudoers/test12.out.ok,
  plugins/sudoers/regress/sudoers/test13.out.ok,
  plugins/sudoers/regress/sudoers/test14.out.ok,
  plugins/sudoers/regress/sudoers/test15.out.ok,
  plugins/sudoers/regress/sudoers/test16.out.ok,
  plugins/sudoers/regress/sudoers/test17.out.ok,
  plugins/sudoers/regress/sudoers/test18.out.ok,
  plugins/sudoers/regress/sudoers/test19.out.ok,
  plugins/sudoers/regress/sudoers/test2.out.ok,
  plugins/sudoers/regress/sudoers/test20.out.ok,
  plugins/sudoers/regress/sudoers/test21.out.ok,
  plugins/sudoers/regress/sudoers/test22.out.ok,
  plugins/sudoers/regress/sudoers/test3.out.ok,
  plugins/sudoers/regress/sudoers/test4.out.ok,
  plugins/sudoers/regress/sudoers/test5.out.ok,
  plugins/sudoers/regress/sudoers/test6.out.ok,
  plugins/sudoers/regress/sudoers/test7.out.ok,
  plugins/sudoers/regress/sudoers/test8.out.ok,
  plugins/sudoers/regress/sudoers/test9.out.ok,
  plugins/sudoers/testsudoers.c:

  Use fmtsudoers functions in testsudoers.
  [[e6c0d80fa]](https://git.sudo.ws/sudo/commit/?id=e6c0d80fa)

* MANIFEST, plugins/sudoers/regress/sudoers/test22.in,
  plugins/sudoers/regress/sudoers/test22.json.ok,
  plugins/sudoers/regress/sudoers/test22.ldif.ok,
  plugins/sudoers/regress/sudoers/test22.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test22.out.ok,
  plugins/sudoers/regress/sudoers/test22.sudo.ok,
  plugins/sudoers/regress/sudoers/test22.toke.ok:

  Add test for empty runas user list.
  [[81a373677]](https://git.sudo.ws/sudo/commit/?id=81a373677)

* plugins/sudoers/testsudoers.c:

  Don’t print an empty user list as ALL.
  [[3e7db4828]](https://git.sudo.ws/sudo/commit/?id=3e7db4828)

* plugins/sudoers/fmtsudoers.c, plugins/sudoers/parse.h:

  In sudoers\_format\_userspecs make the separator optional and silence a
  printf format warning.
  [[bb31544fc]](https://git.sudo.ws/sudo/commit/?id=bb31544fc)

* plugins/sudoers/starttime.c:

  Use correct defines when checking for sysctl kinfo\_proc support.
  [[f984de1ba]](https://git.sudo.ws/sudo/commit/?id=f984de1ba)

* plugins/sudoers/cvtsudoers\_json.c:

  Fix crash when converting sudoers entry with a runas list that is
  present but empty.
  [[bdbd102c9]](https://git.sudo.ws/sudo/commit/?id=bdbd102c9)

2018-03-05 Todd C. Miller

* config.h.in, configure, configure.ac, plugins/sudoers/starttime.c,
  plugins/sudoers/sudoers.c, src/regress/ttyname/check\_ttyname.c,
  src/tgetpass.c, src/ttyname.c:

  Less confusing sysctl checks for kinfo\_proc.
  [[217e0a9b4]](https://git.sudo.ws/sudo/commit/?id=217e0a9b4)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/ldap.c, plugins/sudoers/match.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/sssd.c:

  Add case\_insensitive\_group and case\_insensitive\_user sudoers options,
  which are enabled by default.
  [[e26ef96a6]](https://git.sudo.ws/sudo/commit/?id=e26ef96a6)

2018-03-04 Todd C. Miller

* plugins/sudoers/fmtsudoers.c:

  Kill dead store found by clang-analyzer.
  [[6014b4075]](https://git.sudo.ws/sudo/commit/?id=6014b4075)

2018-03-02 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/sudoers/test1.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test14.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test15.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test16.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test17.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test19.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test2.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test20.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test21.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test3.ldif2sudo.ok,
  plugins/sudoers/regress/sudoers/test6.ldif2sudo.ok:

  Add tests for round-tripping sudoers -> ldif -> sudoers
  [[487406807]](https://git.sudo.ws/sudo/commit/?id=487406807)

2018-03-04 Todd C. Miller

* plugins/sudoers/Makefile.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_util.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/sudoers/test2.ldif.ok,
  plugins/sudoers/regress/sudoers/test3.ldif.ok,
  plugins/sudoers/regress/sudoers/test6.ldif.ok, plugins/sudoers/sssd.c:

  Initial support for adding comments that will be emitted when sudoers is
  formatted. Currently adds a comment for the source sudoRole when
  converting from ldif -> sudoers.
  [[5c36f9dec]](https://git.sudo.ws/sudo/commit/?id=5c36f9dec)

* lib/util/lbuf.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/parse.h:

  Special case comment lines in lbufs.
  [[670d8e6d7]](https://git.sudo.ws/sudo/commit/?id=670d8e6d7)

2018-03-03 Todd C. Miller

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/fmtsudoers.c,
  plugins/sudoers/parse.h:

  When formatting as sudoers, flush the lbuf after each userspec.
  [[c9b70940c]](https://git.sudo.ws/sudo/commit/?id=c9b70940c)

2018-03-04 Todd C. Miller

* plugins/sudoers/cvtsudoers\_ldif.c:

  Handle escaped commas when skipping over the cn.
  [[843213d3d]](https://git.sudo.ws/sudo/commit/?id=843213d3d)

2018-03-02 Todd C. Miller

* plugins/sudoers/cvtsudoers\_ldif.c:

  Add missing sudoOrder support to parse\_ldif().
  [[72dd971ee]](https://git.sudo.ws/sudo/commit/?id=72dd971ee)

* plugins/sudoers/ldap\_util.c:

  Add missing support for converting LOG\_INPUT/LOG\_OUTPUT tags and expand
  support for NOMAIL tags.
  [[8c7f3e791]](https://git.sudo.ws/sudo/commit/?id=8c7f3e791)

* plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/regress/sudoers/test2.ldif.ok,
  plugins/sudoers/regress/sudoers/test3.ldif.ok,
  plugins/sudoers/regress/sudoers/test6.ldif.ok:

  Don’t emit an empty sudoRole for global defaults if there are none.
  [[44fc165e7]](https://git.sudo.ws/sudo/commit/?id=44fc165e7)

* plugins/sudoers/ldap\_util.c:

  Avoid changing the order of non-negated hosts and commands. We still put
  negated hosts/commands at the end of the list.
  [[e96398cac]](https://git.sudo.ws/sudo/commit/?id=e96398cac)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Handle parsing boolean options that have no explicit value.
  [[e750bae75]](https://git.sudo.ws/sudo/commit/?id=e750bae75)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Refactor the code that actually converts the role to sudoers format into
  role\_to\_sudoers() now that it is more involved than just calling
  sudo\_ldap\_role\_to\_priv().
  [[9af4447c3]](https://git.sudo.ws/sudo/commit/?id=9af4447c3)

* plugins/sudoers/cvtsudoers\_ldif.c:

  When merging two privileges, use the runas lists of the previous
  privilege when possible. Otherwise, the generated sudoers line will
  include a runas list for commands that is not necessary.
  [[9b20bb149]](https://git.sudo.ws/sudo/commit/?id=9b20bb149)

2018-03-01 Todd C. Miller

* plugins/sudoers/match.c:

  Use a case-insensitive comparison when matching user and group names in
  sudoers with the passwd or group database. This can be necessary when
  users and groups are stored in AD or LDAP.
  [[fff4acc1f]](https://git.sudo.ws/sudo/commit/?id=fff4acc1f)

* plugins/sudoers/Makefile.in:

  Fix clean target for \*.sudo regress files
  [[88bc4ba86]](https://git.sudo.ws/sudo/commit/?id=88bc4ba86)

* .hgignore:

  ignore more binaries
  [[0804cda64]](https://git.sudo.ws/sudo/commit/?id=0804cda64)

* plugins/sudoers/cvtsudoers.c:

  Fix use of uninitialized variable (conf) if sudoers\_debug\_register()
  happens to fail.
  [[8275ab873]](https://git.sudo.ws/sudo/commit/?id=8275ab873)

2018-02-28 Todd C. Miller

* plugins/sudoers/cvtsudoers\_ldif.c:

  Split conversion code out of parse\_ldif() and into ldif\_to\_sudoers().
  [[73b5f961e]](https://git.sudo.ws/sudo/commit/?id=73b5f961e)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Quiet a clang analyzer warning.
  [[8da213c8b]](https://git.sudo.ws/sudo/commit/?id=8da213c8b)

* MANIFEST, configure, configure.ac, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/ldap\_util.c:

  rename ldap\_common.c -> ldap\_util.c
  [[120bb6de7]](https://git.sudo.ws/sudo/commit/?id=120bb6de7)

* plugins/sudoers/cvtsudoers\_ldif.c:

  When converting from ldif to sudoers, sudoRole objects with the same
  user if possible. If both user and host are the same, merge into a
  single privilege. This makes it possible to convert a sudoers entry
  like:

  aaron shanty = NOEXEC: /usr/bin/vi, /usr/bin/more, EXEC: /bin/sh

  to ldif and then back to sudoers as a single line. Currently, the ldif
  entries to be merged must have the same or adjacent sudoOrder
  attributes.
  [[3a2ae844e]](https://git.sudo.ws/sudo/commit/?id=3a2ae844e)

* plugins/sudoers/cvtsudoers\_ldif.c:

  plug memory leaks
  [[56bdde133]](https://git.sudo.ws/sudo/commit/?id=56bdde133)

* src/parse\_args.c:

  Restore line to set MODE\_PRESERVE\_ENV in flags when the -E command line
  option is used. The caller doesn’t check MODE\_PRESERVE\_ENV these days
  but parse\_args uses it to detect usage errors when -E is used along with
  a mutually excusive option. Problem found by Yuriy Vostrikov.
  [[4b29e0bd7]](https://git.sudo.ws/sudo/commit/?id=4b29e0bd7)

2018-02-26 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Add missing close parenthesis in “Including other files from within
  sudoers” section. [Bug
  #824](https://bugzilla.sudo.ws/show_bug.cgi?id=824)
  [[12affcd5e]](https://git.sudo.ws/sudo/commit/?id=12affcd5e)

2018-02-25 Todd C. Miller

* plugins/sudoers/ldap\_common.c:

  When converting from LDAP to sudoers, put negated hosts and commands at
  the end of the list. Since LDAP doesn’t guarantee attribute order we
  need to make sure negated entries always override non-negated ones.
  [[7919b9ad2]](https://git.sudo.ws/sudo/commit/?id=7919b9ad2)

2018-02-24 Todd C. Miller

* plugins/sudoers/cvtsudoers.c:

  We may need the hostname to resolve %h escapes in include files.
  [[6f097eb02]](https://git.sudo.ws/sudo/commit/?id=6f097eb02)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_ldif.c:

  Setting a sudoOrder start point of 0 will disable creation of sudoOrder
  attributes in the resulting LDIF output.
  [[b3a0c3272]](https://git.sudo.ws/sudo/commit/?id=b3a0c3272)

* plugins/sudoers/cvtsudoers.c:

  Don’t need to fill in struct sudo\_user since we don’t do matching.
  [[111d79b53]](https://git.sudo.ws/sudo/commit/?id=111d79b53)

* MANIFEST, doc/cvtsudoers.cat, doc/cvtsudoers.man.in,
  doc/cvtsudoers.mdoc.in, pathnames.h.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers.h,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c:

  Add support for setting default options in a config file. In addition to
  expand\_aliases, input\_format and output\_format, both the initial
  sudoOrder and the increment when updating sudoOrder for subsequent
  sudoRole objects can be specified. Command line options have also been
  added for the start order and increment.
  [[5999cfb90]](https://git.sudo.ws/sudo/commit/?id=5999cfb90)

2018-02-22 Todd C. Miller

* NEWS:

  cvtsudoers can now read LDIF
  [[fc82a1665]](https://git.sudo.ws/sudo/commit/?id=fc82a1665)

* doc/UPGRADE:

  Fix a typo.
  [[bb0623324]](https://git.sudo.ws/sudo/commit/?id=bb0623324)

* plugins/sudoers/fmtsudoers.c:

  Deal with user\_name not being set in cvtsudoers.
  [[19502307a]](https://git.sudo.ws/sudo/commit/?id=19502307a)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/ldap.c, plugins/sudoers/ldap\_common.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudo\_ldap.h:

  Initial support for parsing sudoers LDIF files in cvtsudoers. This makes
  it possible to convert from LDAP sudoers to a traditional sudoers file.
  Semantic differences between file sudoers and LDAP sudoers mean that
  LDIF -> sudoers is not completely equivalent.
  [[ceea24b96]](https://git.sudo.ws/sudo/commit/?id=ceea24b96)

2018-02-21 Todd C. Miller

* plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/regress/sudoers/test14.ldif.ok:

  Fix LDIF conversion of commands with an associated digest.
  [[8b22ed783]](https://git.sudo.ws/sudo/commit/?id=8b22ed783)

* plugins/sudoers/ldap\_common.c:

  In array\_to\_member\_list() use the correct type for netgroups and user
  groups.
  [[91f97d2f2]](https://git.sudo.ws/sudo/commit/?id=91f97d2f2)

* plugins/sudoers/fmtsudoers.c:

  Prepend digest to command if present. Fix printing of group IDs and
  non-unix groups.
  [[337ace644]](https://git.sudo.ws/sudo/commit/?id=337ace644)

* plugins/sudoers/cvtsudoers\_json.c:

  Fix gcc false positive for uninitialized variable
  [[c13557b6c]](https://git.sudo.ws/sudo/commit/?id=c13557b6c)

2018-02-20 Todd C. Miller

* pp:

  Update Polypkg to the latest version from git.
  [[03f94d62f]](https://git.sudo.ws/sudo/commit/?id=03f94d62f)

* config.h.in, configure, configure.ac, src/sudo.c:

  Use setpassent() and setgroupent() on systems that support it to keep
  the passwd and group database open. Sudo does a lot of passwd and group
  lookups so it can be beneficial to just leave the file open.
  [[faa5baac9]](https://git.sudo.ws/sudo/commit/?id=faa5baac9)

2018-02-19 Todd C. Miller

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/cvtsudoers\_ldif.c, plugins/sudoers/fmtsudoers.c:

  Add option to cvtsudoers to expand aliases in the output.
  [[4f9296928]](https://git.sudo.ws/sudo/commit/?id=4f9296928)

* plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/regress/sudoers/test1.json.ok,
  plugins/sudoers/regress/sudoers/test14.json.ok,
  plugins/sudoers/regress/sudoers/test15.json.ok,
  plugins/sudoers/regress/sudoers/test16.json.ok,
  plugins/sudoers/regress/sudoers/test17.json.ok,
  plugins/sudoers/regress/sudoers/test19.json.ok,
  plugins/sudoers/regress/sudoers/test2.json.ok,
  plugins/sudoers/regress/sudoers/test6.json.ok:

  Fix conversion of “ALL” in the JSON output format, which was being
  printed as an alias.
  [[3f204c5eb]](https://git.sudo.ws/sudo/commit/?id=3f204c5eb)

* INSTALL, configure, configure.ac:

  Clarify that –with-rundir and –with-vardir take sudo-specific
  directory, e.g. /var/run/sudo and not just /var/run. [Bug
  #823](https://bugzilla.sudo.ws/show_bug.cgi?id=823)
  [[e48cbfc10]](https://git.sudo.ws/sudo/commit/?id=e48cbfc10)

* src/exec\_pty.c:

  In pty\_cleanup() we need to call sudo\_term\_restore() even if no I/O
  plugins are present as long as /dev/tty exists. Fixes the use\_pty case
  with no I/O plugins.
  [[d5d170252]](https://git.sudo.ws/sudo/commit/?id=d5d170252)

* include/sudo\_event.h, lib/util/event.c, lib/util/util.exp.in,
  plugins/sudoers/sudoreplay.c, src/exec\_monitor.c, src/exec\_nopty.c,
  src/exec\_pty.c:

  Add sudo\_ev\_dispatch(), a wrapper for ev\_loop() with no flags. Similar
  the dispatch function in libevent.
  [[42fe0409f]](https://git.sudo.ws/sudo/commit/?id=42fe0409f)

* INSTALL, configure, configure.ac, doc/sudoers.cat, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, m4/sudo.m4:

  Use /run in preference to /var/run if it exists. [Bug
  #822](https://bugzilla.sudo.ws/show_bug.cgi?id=822)
  [[525c6a3d9]](https://git.sudo.ws/sudo/commit/?id=525c6a3d9)

2018-02-14 Todd C. Miller

* NEWS:

  mention common sudoers formatting changes
  [[59086e9c8]](https://git.sudo.ws/sudo/commit/?id=59086e9c8)

2018-02-11 Todd C. Miller

* MANIFEST, configure, configure.ac, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_conf.c, plugins/sudoers/sudo\_ldap.h,
  plugins/sudoers/sudo\_ldap\_conf.h:

  Move LDAP configuration bits into ldap\_conf.c
  [[43a3a23fe]](https://git.sudo.ws/sudo/commit/?id=43a3a23fe)

2018-02-10 Todd C. Miller

* plugins/sudoers/ldap.c, plugins/sudoers/ldap\_common.c:

  No longer need to include stddef.h
  [[0c08de88c]](https://git.sudo.ws/sudo/commit/?id=0c08de88c)

* plugins/sudoers/iolog.c:

  Remove dead store, found by cppcheck.
  [[e2213dc1e]](https://git.sudo.ws/sudo/commit/?id=e2213dc1e)

* plugins/sudoers/ldap.c, plugins/sudoers/ldap\_common.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudo\_ldap.h:

  simplify iterator
  [[34820c6b1]](https://git.sudo.ws/sudo/commit/?id=34820c6b1)

* plugins/sudoers/mkdir\_parents.c:

  Silence a false positive from cppcheck.
  [[6e2a26706]](https://git.sudo.ws/sudo/commit/?id=6e2a26706)

* plugins/sudoers/tsdump.c:

  Cast version to int when printing. Avoids a cppcheck warning.
  [[d0d413d07]](https://git.sudo.ws/sudo/commit/?id=d0d413d07)

2018-02-09 Todd C. Miller

* plugins/sudoers/ldap.c, plugins/sudoers/ldap\_common.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudo\_ldap.h:

  Use an iterator instead of fragile pointer arithmetic to iterate over
  value arrays in sudo\_ldap\_role\_to\_priv().
  [[4459ee42e]](https://git.sudo.ws/sudo/commit/?id=4459ee42e)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/fmtsudoers.c, plugins/sudoers/ldap.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/sssd.c:

  Move sudoers formatting code into fmtsudoers.
  [[64e99328e]](https://git.sudo.ws/sudo/commit/?id=64e99328e)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/parse.c:

  Clean up some XXX in parse.c
  [[dda1d6cef]](https://git.sudo.ws/sudo/commit/?id=dda1d6cef)

* plugins/sudoers/ldap.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/sssd.c:

  Rename sudo\_file\_append\_default() -> sudo\_lbuf\_append\_default() and use
  it for ldap and sssd too.
  [[2522229e8]](https://git.sudo.ws/sudo/commit/?id=2522229e8)

* MANIFEST, configure, configure.ac, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/ldap\_common.c, plugins/sudoers/parse.h,
  plugins/sudoers/sssd.c, plugins/sudoers/sudo\_ldap.h:

  Move common bits of ldap to sudoers conversion into ldap\_common.c and
  use it in sssd.c.
  [[3226f7e28]](https://git.sudo.ws/sudo/commit/?id=3226f7e28)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h:

  Convert ldap results into a sudoers userspec so we can use the “sudo -l”
  output functions in parse.c.
  [[4e2402a8e]](https://git.sudo.ws/sudo/commit/?id=4e2402a8e)

2018-02-08 Todd C. Miller

* sudo.pp:

  Don’t mark sudoers.dist volatile, it only gets used on systems that
  don’t have the concept of volatile files.
  [[787717755]](https://git.sudo.ws/sudo/commit/?id=787717755)

2018-02-05 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.h:
  Refactor member freeing code into free\_member(). Refactor userspec
  freeing code into free\_userspec().
  [[5cca4b690]](https://git.sudo.ws/sudo/commit/?id=5cca4b690)

* plugins/sudoers/cvtsudoers.c:

  Fix compilation with glibc where stdout is not constant.
  [[9d49592f1]](https://git.sudo.ws/sudo/commit/?id=9d49592f1)

2018-02-04 Todd C. Miller

* plugins/sudoers/ldap.c:

  For “sudo -l”, if a word includes spaces, print it in double quotes.
  Also escape spaces in the command path. This matches the sudoers quoting
  rules.
  [[57e7b4b49]](https://git.sudo.ws/sudo/commit/?id=57e7b4b49)

2018-02-03 Todd C. Miller

* plugins/sudoers/ldap.c:

  Display sudoNotBefore and sudoNotAfter in “sudo -l”
  [[3189de5bb]](https://git.sudo.ws/sudo/commit/?id=3189de5bb)

* plugins/sudoers/parse.c:

  For “sudo -l”, if a word includes spaces, print it in double quotes.
  Also escape spaces in the command path. This matches the sudoers quoting
  rules.
  [[105ced47b]](https://git.sudo.ws/sudo/commit/?id=105ced47b)

* plugins/sudoers/cvtsudoers.c:

  Add back printing of negation operator (’!’) when printing a word with
  spaces in it.
  [[40c200af1]](https://git.sudo.ws/sudo/commit/?id=40c200af1)

* plugins/sudoers/Makefile.in:

  Use visudo to validate “cvtsudoers -f sudoers” output.
  [[1aca11c78]](https://git.sudo.ws/sudo/commit/?id=1aca11c78)

* plugins/sudoers/regress/sudoers/test21.in,
  plugins/sudoers/regress/sudoers/test21.json.ok,
  plugins/sudoers/regress/sudoers/test21.ldif.ok,
  plugins/sudoers/regress/sudoers/test21.out.ok,
  plugins/sudoers/regress/sudoers/test21.toke.ok:

  Remove syslog\_goodpri and syslog\_badpri without a value that causes
  visudo to report an error.
  [[f31ba6c22]](https://git.sudo.ws/sudo/commit/?id=f31ba6c22)

* plugins/sudoers/cvtsudoers.c:

  When outputting sudoers, if a word includes spaces, print it in double
  quotes. Also escape spaces in the command path.
  [[61b6ae64d]](https://git.sudo.ws/sudo/commit/?id=61b6ae64d)

2018-02-02 Todd C. Miller

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/alias.c, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/parse.h, plugins/sudoers/visudo.c:

  Add sudoers output format to cvtsudoers. In the future this may be used
  with filters to emit a partial sudoers file instead of a full one.
  [[3354cbd02]](https://git.sudo.ws/sudo/commit/?id=3354cbd02)

* plugins/sudoers/parse.c:

  When printing a member name, quote sudoers special characters unless it
  is a UID/GID, in which case we print the ‘#’ unquoted.
  [[df08d0d8f]](https://git.sudo.ws/sudo/commit/?id=df08d0d8f)

* plugins/sudoers/parse.c, plugins/sudoers/parse.h:

  Move SUDOERS\_QUOTED define to parse.h
  [[f4ce2b25f]](https://git.sudo.ws/sudo/commit/?id=f4ce2b25f)

2018-01-30 Todd C. Miller

* plugins/sudoers/timestamp.c:

  Remove extraneous break statement and fix some whitespace.
  [[07d9cec27]](https://git.sudo.ws/sudo/commit/?id=07d9cec27)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  The max timeout for kernel time stamps is 60 minutes, not 3600 minutes.
  [[5de49b2d6]](https://git.sudo.ws/sudo/commit/?id=5de49b2d6)

2018-01-29 Todd C. Miller

* plugins/sudoers/testsudoers.c:

  Check the return value of sudoers\_debug\_register(). Coverity CID 182574
  [[5e9e641b3]](https://git.sudo.ws/sudo/commit/?id=5e9e641b3)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Fix memory leak, su->count is now 0 when it is unused, not 1. Covertity
  CID 182573
  [[f3ef0f509]](https://git.sudo.ws/sudo/commit/?id=f3ef0f509)

* plugins/sudoers/cvtsudoers\_ldif.c:

  Quiet a clang analyzer false positive.
  [[776627803]](https://git.sudo.ws/sudo/commit/?id=776627803)

* plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/regress/sudoers/test2.ldif.ok,
  plugins/sudoers/regress/sudoers/test6.ldif.ok:

  Quote special characters when creating the cn as per RFC2253
  [[b374effcb]](https://git.sudo.ws/sudo/commit/?id=b374effcb)

* NEWS, configure, configure.ac, doc/UPGRADE:

  Sudo 1.8.23
  [[d2303d8b1]](https://git.sudo.ws/sudo/commit/?id=d2303d8b1)

* doc/LICENSE:

  Remove the C-style comment charactes from the getopt\_long.c and
  inet\_pton.c license text as it was inconsistent with the rest of the
  file and messed up the html formatting.
  [[9d49c9193]](https://git.sudo.ws/sudo/commit/?id=9d49c9193)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/sudoers2ldif,
  sudo.pp:

  Remove sudoers2ldif, it has been replaced by cvtsudoers.
  [[7f310d738]](https://git.sudo.ws/sudo/commit/?id=7f310d738)

2018-01-28 Todd C. Miller

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_ldif.c:

  Add -b option to specify the base dn.
  [[831de0fc8]](https://git.sudo.ws/sudo/commit/?id=831de0fc8)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in:

  Document limitations of LDIF conversion.
  [[b0abdd5a1]](https://git.sudo.ws/sudo/commit/?id=b0abdd5a1)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c:

  Switch the default output format to LDIF
  [[4acaa9c74]](https://git.sudo.ws/sudo/commit/?id=4acaa9c74)

* plugins/sudoers/visudo.c:

  Execute cvtsudoers if the user runs “visudo -x” but also emit a warning.
  [[7e5e1f6a6]](https://git.sudo.ws/sudo/commit/?id=7e5e1f6a6)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/stubs.c,
  plugins/sudoers/visudo.c:

  Revert 04ec05108b2b, change the default input source back to stdin.
  [[63321f19a]](https://git.sudo.ws/sudo/commit/?id=63321f19a)

* MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/sudoers/test1.ldif.ok,
  plugins/sudoers/regress/sudoers/test10.ldif.ok,
  plugins/sudoers/regress/sudoers/test11.ldif.ok,
  plugins/sudoers/regress/sudoers/test12.ldif.ok,
  plugins/sudoers/regress/sudoers/test13.ldif.ok,
  plugins/sudoers/regress/sudoers/test14.ldif.ok,
  plugins/sudoers/regress/sudoers/test15.ldif.ok,
  plugins/sudoers/regress/sudoers/test16.ldif.ok,
  plugins/sudoers/regress/sudoers/test17.ldif.ok,
  plugins/sudoers/regress/sudoers/test18.ldif.ok,
  plugins/sudoers/regress/sudoers/test19.ldif.ok,
  plugins/sudoers/regress/sudoers/test2.ldif.ok,
  plugins/sudoers/regress/sudoers/test20.ldif.ok,
  plugins/sudoers/regress/sudoers/test21.ldif.ok,
  plugins/sudoers/regress/sudoers/test3.ldif.ok,
  plugins/sudoers/regress/sudoers/test4.ldif.ok,
  plugins/sudoers/regress/sudoers/test5.ldif.ok,
  plugins/sudoers/regress/sudoers/test6.ldif.ok,
  plugins/sudoers/regress/sudoers/test7.ldif.ok,
  plugins/sudoers/regress/sudoers/test8.ldif.ok,
  plugins/sudoers/regress/sudoers/test9.ldif.ok:

  Add LDIF conversion to sudoers tests
  [[6272829dc]](https://git.sudo.ws/sudo/commit/?id=6272829dc)

* plugins/sudoers/cvtsudoers\_json.c, plugins/sudoers/cvtsudoers\_ldif.c,
  plugins/sudoers/regress/sudoers/test19.json.ok:

  Add notbefore and notafter support to the backends.
  [[7dd620981]](https://git.sudo.ws/sudo/commit/?id=7dd620981)

2018-01-27 Todd C. Miller

* README.LDAP:

  cvtsudoers instead of sudoers2ldif
  [[ea7daee6f]](https://git.sudo.ws/sudo/commit/?id=ea7daee6f)

* MANIFEST, doc/cvtsudoers.cat, doc/cvtsudoers.man.in,
  doc/cvtsudoers.mdoc.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_ldif.c:

  Add ldif backend to cvtsudoers, to replace sudoers2ldif
  [[681fb2e76]](https://git.sudo.ws/sudo/commit/?id=681fb2e76)

* plugins/sudoers/Makefile.in:

  fix make check
  [[7638e7173]](https://git.sudo.ws/sudo/commit/?id=7638e7173)

2018-01-26 Todd C. Miller

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_json.c:

  Parse sudoers in the front end, not the back end.
  [[cc31b3fd4]](https://git.sudo.ws/sudo/commit/?id=cc31b3fd4)

* doc/Makefile.in:

  install the cvtsudoers manual
  [[c360ad460]](https://git.sudo.ws/sudo/commit/?id=c360ad460)

* doc/cvtsudoers.cat, doc/cvtsudoers.man.in, doc/cvtsudoers.mdoc.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/stubs.c,
  plugins/sudoers/visudo.c:

  Use the built-in sudoers file location as the default sudoers file for
  cvtsudoers and move parse\_sudoers\_options() to stubs.c since it is
  shared between visudo.c and cvtsudoers.c.
  [[98c19a68c]](https://git.sudo.ws/sudo/commit/?id=98c19a68c)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/cvtsudoers.c,
  plugins/sudoers/stubs.c, plugins/sudoers/visudo.c:

  Move common stub functions required by the parser out of visudo.c and
  cvtsudoers.c and into stubs.c.
  [[0f3030d50]](https://git.sudo.ws/sudo/commit/?id=0f3030d50)

* plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_json.c:

  Rename export\_sudoers() to convert\_sudoers\_json() and move the check for
  the same input and output file to the front-end.
  [[02d917e60]](https://git.sudo.ws/sudo/commit/?id=02d917e60)

* sudo.pp:

  add cvtsudoers
  [[41bd9ae26]](https://git.sudo.ws/sudo/commit/?id=41bd9ae26)

* MANIFEST, doc/Makefile.in, doc/cvtsudoers.cat, doc/cvtsudoers.man.in,
  doc/cvtsudoers.mdoc.in, doc/visudo.cat, doc/visudo.man.in,
  doc/visudo.mdoc.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/cvtsudoers.c, plugins/sudoers/cvtsudoers\_json.c,
  plugins/sudoers/visudo.c:

  Move sudoers JSON conversion to cvtsudoers which will eventually output
  to other formats too.
  [[80cb1b5da]](https://git.sudo.ws/sudo/commit/?id=80cb1b5da)

* plugins/sudoers/defaults.c:

  Convert from time in minutes to timespec directly instead of converting
  to double via strtod(). This makes it easier to catch overflow.
  [[bcfb092a4]](https://git.sudo.ws/sudo/commit/?id=bcfb092a4)

2018-01-24 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  document that kernel tty timestamps don’t support negative timeouts
  [[eb8b5c796]](https://git.sudo.ws/sudo/commit/?id=eb8b5c796)

2018-01-23 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/timestamp.c:

  Fall back to ppid time stamps if timestamp\_type == kernel and no tty is
  present. This is consistent with timestamp\_type == tty.
  [[b3601253e]](https://git.sudo.ws/sudo/commit/?id=b3601253e)

* plugins/sudoers/timestamp.c:

  Do not call the TIOCSETVERAUTH ioctl with a negative number of seconds.
  Also cap the max number of seconds at 3600 to avoid getting EINVAL from
  TIOCSETVERAUTH.
  [[52409b9c7]](https://git.sudo.ws/sudo/commit/?id=52409b9c7)

2018-01-22 Todd C. Miller

* plugins/sudoers/defaults.c:

  Better conversion from double to nanoseconds.
  [[2e37959fe]](https://git.sudo.ws/sudo/commit/?id=2e37959fe)

* plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/auth/sudo\_auth.h,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/defaults.h, plugins/sudoers/mkdefaults,
  plugins/sudoers/timestamp.c:

  Store passwd\_timeout and timestamp\_timeout as a struct timespec instead
  of as a float. Remove timeout argument to auth\_getpass() as it was never
  used.
  [[4c0c22506]](https://git.sudo.ws/sudo/commit/?id=4c0c22506)

2018-01-21 Todd C. Miller

* plugins/sudoers/mkdefaults:

  Don’t rely on perl being installed in /usr/local/bin
  [[44e4aac44]](https://git.sudo.ws/sudo/commit/?id=44e4aac44)

2018-01-17 Todd C. Miller

* config.h.in, configure, configure.ac, lib/util/gettime.c,
  lib/util/mktemp.c, lib/util/nanosleep.c, lib/util/utimens.c,
  plugins/sudoers/boottime.c, plugins/sudoers/check.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/iolog.c,
  plugins/sudoers/ldap.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/visudo.c, src/net\_ifs.c, src/sesh.c, src/sudo.c,
  src/sudo\_edit.c, src/utmp.c:

  Remove use of AC\_HEADER\_TIME, only obsolete platforms actually need
  this. Also stop removing sys/time.h unless the source file uses struct
  timeval.
  [[a885b952f]](https://git.sudo.ws/sudo/commit/?id=a885b952f)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Remove duplicate options %type
  [[b161ebe62]](https://git.sudo.ws/sudo/commit/?id=b161ebe62)

2018-01-16 Todd C. Miller

* plugins/sudoers/auth/API, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/check.c,
  plugins/sudoers/sudoers.h:

  Add an approval function to the sudo auth API which is run after the
  user’s password has been verified. The approval function is run even if
  no password is required. This is currently only used for PAM (use
  pam\_acct\_mgmt) and BSD auth (auth\_approval).
  [[594c2d4ef]](https://git.sudo.ws/sudo/commit/?id=594c2d4ef)

2018-01-15 Todd C. Miller

* plugins/sudoers/tsdump.c:

  treat uid as unsigned in error message
  [[f7896025e]](https://git.sudo.ws/sudo/commit/?id=f7896025e)

* MANIFEST, plugins/sudoers/po/fur.mo:

  Add missing plugins/sudoers/po/fur.mo file to repo.
  [[aa516b0a5]](https://git.sudo.ws/sudo/commit/?id=aa516b0a5)

* NEWS:

  Mention new sudoers\_timestamp manual.
  [[44fdb3228]](https://git.sudo.ws/sudo/commit/?id=44fdb3228)

2018-01-12 Todd C. Miller

* .hgignore:

  ignore tsdump
  [[b92a33ba3]](https://git.sudo.ws/sudo/commit/?id=b92a33ba3)

* plugins/sudoers/tsdump.c:

  Convert from mono time to real time before displaying time stamps.
  [[a47f47967]](https://git.sudo.ws/sudo/commit/?id=a47f47967)

2018-01-11 Todd C. Miller

* plugins/sudoers/solaris\_audit.c:

  Use PATH\_MAX, not MAXPATHLEN.
  [[da67a5490]](https://git.sudo.ws/sudo/commit/?id=da67a5490)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_util.h,
  lib/util/Makefile.in, lib/util/ttyname\_dev.c, lib/util/util.exp.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/check.h,
  plugins/sudoers/tsdump.c, src/ttyname.c:

  Add tsdump, a simple utility to dump a timestamp file. To build, run
  “make tsdump” in the plugins/sudoers directory (it is not built by
  default). In order to map the tty device number to a name,
  sudo\_ttyname\_dev() has been moved into libsudo\_util.
  [[ff5ac3ef0]](https://git.sudo.ws/sudo/commit/?id=ff5ac3ef0)

2018-01-04 Todd C. Miller

* plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po, po/uk.mo, po/uk.po:

  sync with translationproject.org
  [[d5f4fdb81]](https://git.sudo.ws/sudo/commit/?id=d5f4fdb81)

* doc/LICENSE:

  Welcome to 2018
  [[70f406d67]](https://git.sudo.ws/sudo/commit/?id=70f406d67)

2017-12-28 Todd C. Miller

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/fur.po, plugins/sudoers/po/nb.mo,
  plugins/sudoers/po/nb.po, plugins/sudoers/po/zh\_CN.mo,
  plugins/sudoers/po/zh\_CN.po:

  sync with translationproject.org
  [[636bfad02]](https://git.sudo.ws/sudo/commit/?id=636bfad02)

2017-12-22 Todd C. Miller

* plugins/sudoers/logging.c:

  Silence a clang analyzer false positive.
  [[f2fdda1aa]](https://git.sudo.ws/sudo/commit/?id=f2fdda1aa)

* doc/Makefile.in:

  Remove extra $(srcdir)/sudoreplay.man.in target added by mistake.
  [[83ad5d9db]](https://git.sudo.ws/sudo/commit/?id=83ad5d9db)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/nl.mo, plugins/sudoers/po/nl.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po, po/ja.mo, po/ja.po:

  sync with translationproject.org
  [[00016b17a]](https://git.sudo.ws/sudo/commit/?id=00016b17a)

* plugins/sudoers/timestamp.c:

  Use a tty lock even for kernel time stamps so we can avoid simultaneous
  password prompts.
  [[7f99af859]](https://git.sudo.ws/sudo/commit/?id=7f99af859)

* NEWS:

  visudo changes
  [[c4534798d]](https://git.sudo.ws/sudo/commit/?id=c4534798d)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in,
  plugins/sudoers/editor.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/visudo.c:

  Also honor SUDO\_EDITOR in visudo. Previously is was only used by
  sudoedit.
  [[23ac62cfb]](https://git.sudo.ws/sudo/commit/?id=23ac62cfb)

2017-12-21 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Stop looking for an editor as soon as we find one. A similar fix was
  made to visudo some time ago.
  [[fa2ab63da]](https://git.sudo.ws/sudo/commit/?id=fa2ab63da)

* doc/sudoers\_timestamp.cat, doc/sudoers\_timestamp.man.in,
  doc/sudoers\_timestamp.mdoc.in:

  The session ID was added in 1.8.6p7 to prevent a user in another session
  from re-using the time stamp file. Other minor cleanups.
  [[740a47980]](https://git.sudo.ws/sudo/commit/?id=740a47980)

* plugins/sudoers/check.h:

  “time stamp” not “timestamp”
  [[54158f691]](https://git.sudo.ws/sudo/commit/?id=54158f691)

2017-12-20 Todd C. Miller

* NEWS, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/timestamp.c:

  Add “kernel” as a possible value of timestamp\_type. Currently only
  supported on OpenBSD.
  [[feb48b8eb]](https://git.sudo.ws/sudo/commit/?id=feb48b8eb)

* MANIFEST, doc/Makefile.in, doc/sudoers.cat, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, doc/sudoers\_timestamp.cat,
  doc/sudoers\_timestamp.man.in, doc/sudoers\_timestamp.mdoc.in,
  plugins/sudoers/check.h:

  Document the sudoers time stamp file format.
  [[5f3797c75]](https://git.sudo.ws/sudo/commit/?id=5f3797c75)

2017-12-19 Todd C. Miller

* plugins/sudoers/regress/starttime/check\_starttime.c:

  Verify start time of the current process, allowing for some clock drift.
  For Linux, process start time is relative to boot time, not wallclock
  time.
  [[ae8917a07]](https://git.sudo.ws/sudo/commit/?id=ae8917a07)

2017-12-18 Todd C. Miller

* NEWS:

  sync
  [[f41927488]](https://git.sudo.ws/sudo/commit/?id=f41927488)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[e73a5574c]](https://git.sudo.ws/sudo/commit/?id=e73a5574c)

* MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/starttime/check\_starttime.c:

  Trivial test for process start time. We don’t try to check the resulting
  timespec as it differs by platform. On most it is wallclock time, on
  others it is relative to boot time (Linux).
  [[6ce85b174]](https://git.sudo.ws/sudo/commit/?id=6ce85b174)

* lib/util/Makefile.in:

  regen
  [[d93559e9c]](https://git.sudo.ws/sudo/commit/?id=d93559e9c)

2017-12-17 Todd C. Miller

* plugins/sudoers/starttime.c:

  Support start time on macOS and 4.4BSD
  [[de2f455d3]](https://git.sudo.ws/sudo/commit/?id=de2f455d3)

2017-12-16 Todd C. Miller

* plugins/sudoers/regress/env\_match/check\_env\_pattern.c:

  Include sys/types.h for mode\_t used in sudoers.h.
  [[428a487e0]](https://git.sudo.ws/sudo/commit/?id=428a487e0)

* plugins/sudoers/starttime.c:

  Fix compilation error on FreeBSD
  [[b78296197]](https://git.sudo.ws/sudo/commit/?id=b78296197)

* plugins/sudoers/starttime.c:

  Fix debug\_decl(), it should be SUDOERS\_DEBUG\_UTIL Add debugging for the
  successful case For Linux, don’t NUL out \*ep before parsing with
  strtoull(). \* \* \* Add missing debug info for the System V /proc version.
  [[79caf1e68]](https://git.sudo.ws/sudo/commit/?id=79caf1e68)

* MANIFEST, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/check.h,
  plugins/sudoers/starttime.c, plugins/sudoers/timestamp.c:

  In the timestamp record, include the start time of the terminal session
  leader for tty-based timestamps or the start time of the parent process
  for ppid-based timestamps. Idea from Duncan Overbruck.
  [[1709dc7f7]](https://git.sudo.ws/sudo/commit/?id=1709dc7f7)

2017-12-15 Todd C. Miller

* plugins/sudoers/timestamp.c:

  If the lock record doesn’t match the expected record size we need to
  seek to the end of the record as we otherwise may have gone too far (or
  not far enough). Fixes interop problems when the time stamp record
  changes size.
  [[5cec5734c]](https://git.sudo.ws/sudo/commit/?id=5cec5734c)

2017-12-12 Todd C. Miller

* src/exec\_pty.c:

  No need for a loop around the recv() now that we don’t have to worry
  about EINTR. CID 180697
  [[cd0b70054]](https://git.sudo.ws/sudo/commit/?id=cd0b70054)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Try to be clearer about sudo’s exit value when the -l option is used.
  [[bda2f4c44]](https://git.sudo.ws/sudo/commit/?id=bda2f4c44)

* NEWS:

  sync
  [[3604ff5bb]](https://git.sudo.ws/sudo/commit/?id=3604ff5bb)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  An empty RunAsUser means run as the invoking user, similar to how the
  sudoers files works.
  [[6ca8447e0]](https://git.sudo.ws/sudo/commit/?id=6ca8447e0)

* doc/sudoers.cat, doc/sudoers.man.in:

  regen
  [[f869086ef]](https://git.sudo.ws/sudo/commit/?id=f869086ef)

2017-12-11 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/logging.c:

  Add authfail\_message sudoers option to allow the user to override the
  default message of %d incorrect password attempt(s).
  [[1350a3073]](https://git.sudo.ws/sudo/commit/?id=1350a3073)

* plugins/sudoers/policy.c, src/parse\_args.c:

  Allow the plugin to determine whether or not an empty timeout is
  allowed. For sudoers, an error will be returned for an empty timeout.
  [[5106bfc13]](https://git.sudo.ws/sudo/commit/?id=5106bfc13)

* plugins/sudoers/timeout.c:

  Return an error for an empty timeout string. Just use strtol() for
  syntax checking instead of scanning with strspn().
  [[b5463c280]](https://git.sudo.ws/sudo/commit/?id=b5463c280)

* src/parse\_args.c, src/sudo\_edit.c:

  Change some *() into U*() since they are used for warn/fatal. We always
  want to issue warnings in the user’s locale.
  [[bbc43b5e3]](https://git.sudo.ws/sudo/commit/?id=bbc43b5e3)

* Makefile.in:

  update my email address
  [[b68554b7c]](https://git.sudo.ws/sudo/commit/?id=b68554b7c)

2017-12-10 Todd C. Miller

* log2cl.pl:

  Don’t print mercurial branch info for merges.
  [[3d13fe4fa]](https://git.sudo.ws/sudo/commit/?id=3d13fe4fa)

* log2cl.pl:

  Use log size instead of using a separator between the log entry and the
  file names.
  [[a388ddbcf]](https://git.sudo.ws/sudo/commit/?id=a388ddbcf)

* src/parse\_args.c:

  Print usage and return an error when an empty argument is given for all
  command line arguments other than -p and -E. [Bug
  #817](https://bugzilla.sudo.ws/show_bug.cgi?id=817)
  [[d322caf7a]](https://git.sudo.ws/sudo/commit/?id=d322caf7a)

* plugins/sudoers/policy.c:

  Better input validation of settings passed by the sudo front-end.
  Instead of ignoring an empty setting, throw an error.
  [[00a00ebd1]](https://git.sudo.ws/sudo/commit/?id=00a00ebd1)

* log2cl.pl:

  Treat a blank line in a commit message as a line break. There doesn’t
  appear to be a way to make perl’s format use a blank field but at least
  the line break happens now.
  [[63209fe8f]](https://git.sudo.ws/sudo/commit/?id=63209fe8f)

2017-12-09 Todd C. Miller

* MANIFEST, Makefile.in, log2cl.pl:

  Add script to generate ChangeLog from git log output.
  [[5f5a60f82]](https://git.sudo.ws/sudo/commit/?id=5f5a60f82)

2017-12-08 Todd C. Miller

* plugins/sudoers/defaults.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h:

  Don’t include syslog.h from logging.h, just include it in the two .c
  files it is actually needed.
  [[b16912da1]](https://git.sudo.ws/sudo/commit/?id=b16912da1)

2017-12-06 Todd C. Miller

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Document that in check mode, visudo does not check the owner/mode on
  files specified with the -f flag.
  [[e78283af9]](https://git.sudo.ws/sudo/commit/?id=e78283af9)

2017-12-03 Todd C. Miller

* Makefile.in, configure.ac, doc/HISTORY, doc/LICENSE, doc/Makefile.in,
  doc/fixman.sh, doc/fixmdoc.sh, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  doc/visudo.man.in, doc/visudo.mdoc.in, examples/Makefile.in,
  include/Makefile.in, include/compat/charclass.h,
  include/compat/endian.h, include/compat/fnmatch.h,
  include/compat/nss\_dbdefs.h, include/compat/sha2.h,
  include/sudo\_compat.h, include/sudo\_conf.h, include/sudo\_debug.h,
  include/sudo\_dso.h, include/sudo\_event.h, include/sudo\_fatal.h,
  include/sudo\_gettext.h, include/sudo\_lbuf.h, include/sudo\_plugin.h,
  include/sudo\_util.h, lib/util/Makefile.in, lib/util/aix.c,
  lib/util/closefrom.c, lib/util/event.c, lib/util/event\_poll.c,
  lib/util/event\_select.c, lib/util/fatal.c, lib/util/getgrouplist.c,
  lib/util/gethostname.c, lib/util/getline.c, lib/util/getopt\_long.c,
  lib/util/gettime.c, lib/util/gidlist.c, lib/util/glob.c,
  lib/util/isblank.c, lib/util/key\_val.c, lib/util/lbuf.c,
  lib/util/locking.c, lib/util/memrchr.c, lib/util/memset\_s.c,
  lib/util/mksiglist.c, lib/util/mksigname.c, lib/util/mktemp.c,
  lib/util/nanosleep.c, lib/util/parseln.c, lib/util/pipe2.c,
  lib/util/progname.c, lib/util/pw\_dup.c,
  lib/util/regress/atofoo/atofoo\_test.c,
  lib/util/regress/fnmatch/fnm\_test.c, lib/util/regress/glob/globtest.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c,
  lib/util/regress/vsyslog/vsyslog\_test.c, lib/util/secure\_path.c,
  lib/util/setgroups.c, lib/util/sha2.c, lib/util/sig2str.c,
  lib/util/snprintf.c, lib/util/strlcat.c, lib/util/strlcpy.c,
  lib/util/strndup.c, lib/util/strnlen.c, lib/util/strsignal.c,
  lib/util/strsplit.c, lib/util/strtobool.c, lib/util/strtoid.c,
  lib/util/strtomode.c, lib/util/strtonum.c, lib/util/sudo\_conf.c,
  lib/util/sudo\_debug.c, lib/util/sudo\_dso.c, lib/util/term.c,
  lib/util/ttysize.c, lib/util/utimens.c, lib/util/vsyslog.c,
  lib/zlib/Makefile.in, m4/sudo.m4, mkdep.pl, mkpkg, pathnames.h.in,
  plugins/group\_file/Makefile.in, plugins/group\_file/getgrent.c,
  plugins/group\_file/group\_file.c, plugins/group\_file/plugin\_test.c,
  plugins/sample/Makefile.in, plugins/sample/sample\_plugin.c,
  plugins/sudoers/Makefile.in, plugins/sudoers/alias.c,
  plugins/sudoers/audit.c, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/base64.c,
  plugins/sudoers/boottime.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/bsm\_audit.h, plugins/sudoers/check.c,
  plugins/sudoers/check.h, plugins/sudoers/defaults.c,
  plugins/sudoers/defaults.h, plugins/sudoers/digestname.c,
  plugins/sudoers/editor.c, plugins/sudoers/env.c,
  plugins/sudoers/env\_pattern.c, plugins/sudoers/filedigest.c,
  plugins/sudoers/filedigest\_gcrypt.c,
  plugins/sudoers/filedigest\_openssl.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/gc.c, plugins/sudoers/gentime.c,
  plugins/sudoers/getspwuid.c, plugins/sudoers/gmtoff.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/hexchar.c, plugins/sudoers/ins\_2001.h,
  plugins/sudoers/ins\_classic.h, plugins/sudoers/ins\_csops.h,
  plugins/sudoers/ins\_goons.h, plugins/sudoers/insults.h,
  plugins/sudoers/interfaces.c, plugins/sudoers/interfaces.h,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog.h,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/ldap.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/linux\_audit.h,
  plugins/sudoers/locale.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/logwrap.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/mkdir\_parents.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/po/sudoers.pot,
  plugins/sudoers/policy.c, plugins/sudoers/prompt.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/pwutil.h,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/rcstr.c,
  plugins/sudoers/redblack.c, plugins/sudoers/redblack.h,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/parser/check\_hexchar.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudo\_nss.h,
  plugins/sudoers/sudo\_printf.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoers2ldif,
  plugins/sudoers/sudoers\_debug.c, plugins/sudoers/sudoers\_debug.h,
  plugins/sudoers/sudoers\_version.h, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/timeout.c,
  plugins/sudoers/timestamp.c, plugins/sudoers/timestr.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/tsgetgrpw.h, plugins/sudoers/visudo.c,
  plugins/sudoers/visudo\_json.c, plugins/system\_group/Makefile.in,
  plugins/system\_group/system\_group.c, po/sudo.pot, src/Makefile.in,
  src/conversation.c, src/env\_hooks.c, src/exec.c, src/exec\_common.c,
  src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c, src/get\_pty.c,
  src/hooks.c, src/load\_plugins.c, src/net\_ifs.c, src/openbsd.c,
  src/parse\_args.c, src/preload.c, src/preserve\_fds.c,
  src/regress/noexec/check\_noexec.c, src/regress/ttyname/check\_ttyname.c,
  src/selinux.c, src/sesh.c, src/signal.c, src/solaris.c, src/sudo.c,
  src/sudo.h, src/sudo\_edit.c, src/sudo\_exec.h, src/sudo\_noexec.c,
  src/sudo\_plugin\_int.h, src/sudo\_usage.h.in, src/tcsetpgrp\_nobg.c,
  src/tgetpass.c, src/ttyname.c, src/utmp.c, sudo.pp:

  update my email to Todd.Miller@…
  [[48fba3c2c]](https://git.sudo.ws/sudo/commit/?id=48fba3c2c)

2017-12-02 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Add missing carriage return before prompt when replay is done.
  [[01587b1b1]](https://git.sudo.ws/sudo/commit/?id=01587b1b1)

* src/exec\_pty.c:

  Track window size changes that happen while sudo is suspended
  [[a2eff1150]](https://git.sudo.ws/sudo/commit/?id=a2eff1150)

2017-12-01 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[988328393]](https://git.sudo.ws/sudo/commit/?id=988328393)

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo\_plugin.cat, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoreplay.cat, doc/visudo.cat:

  regen for sudo 1.8.22
  [[276d83cc9]](https://git.sudo.ws/sudo/commit/?id=276d83cc9)

* NEWS, configure, configure.ac:

  Sudo 1.8.22
  [[e8532bdce]](https://git.sudo.ws/sudo/commit/?id=e8532bdce)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Background processes started by the command will no longer receive
  SIGHUP.
  [[c2eee7904]](https://git.sudo.ws/sudo/commit/?id=c2eee7904)

* src/exec\_monitor.c:

  When the command completes, make the monitor the foreground process
  group before informing the main sudo process of the command’s exit
  status. This will prevent processes started by the command (which runs
  in a different process group) from receiving SIGHUP since the kernel
  sends SIGHUP to the foreground process group associated with the
  terminal session. The monitor has a SIGHUP handler installed so the
  signal is effectively ignored.
  [[b561d0d7d]](https://git.sudo.ws/sudo/commit/?id=b561d0d7d)

* src/sudo.c:

  Add debug printfs around group list retrieval.
  [[4168668f5]](https://git.sudo.ws/sudo/commit/?id=4168668f5)

2017-11-30 Todd C. Miller

* src/exec\_pty.c:

  Move call to sudo\_ev\_loopcontinue() into schedule\_signal() itself. We
  always want to prioritize signal forwarding.
  [[116c5d7ef]](https://git.sudo.ws/sudo/commit/?id=116c5d7ef)

* src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c:

  Don’t loop over read/write, recv/send or tcgetpgrp/tcsetpgrp trying to
  handle EINTR. We now use SA\_RESTART with signals so this is not needed
  and is potentially dangerous if it is possible to receive SIGTTIN or
  SIGTTOU (which it currently is not).
  [[b9adb3dd5]](https://git.sudo.ws/sudo/commit/?id=b9adb3dd5)

2017-11-21 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Better describe things when a command is run in a pty.
  [[9298a2a42]](https://git.sudo.ws/sudo/commit/?id=9298a2a42)

2017-11-29 Todd C. Miller

* src/exec\_monitor.c, src/signal.c:

  Sprinkle some extra debugging printfs
  [[486ced7c1]](https://git.sudo.ws/sudo/commit/?id=486ced7c1)

* src/exec\_pty.c:

  Handle receipt of SIGTTIN/SIGTTOU when reading/writing from/to the tty.
  We can’t use a signal event for these since that would restart the
  system call after the signal was handled and the callback would not get
  a chance to run. Fixes running a command in the background that write to
  the tty when the TOSTOP terminal flag is set.
  [[54acf4f99]](https://git.sudo.ws/sudo/commit/?id=54acf4f99)

* src/exec\_pty.c:

  We don’t need to be the foreground process to be able to write to the
  terminal in most cases. If the background process tries to modify the
  terminal flags it will receive SIGTTOU which is relayed to the sudo
  front-end. This currently mishandles terminals with the TOSTOP local
  flag set.
  [[5ccc7ab87]](https://git.sudo.ws/sudo/commit/?id=5ccc7ab87)

2017-11-28 Todd C. Miller

* plugins/sudoers/sssd.c:

  Avoid a double free when ipa\_hostname is set in sssd.conf and it is an
  unqualified host name. From Daniel Kopecek.

  Also move the “unable to allocate memory” warning into
  get\_ipa\_hostname() itself to make it easier to see where the allocation
  failed in the debug log.
  [[93828eca6]](https://git.sudo.ws/sudo/commit/?id=93828eca6)

* plugins/sudoers/ldap.c, plugins/sudoers/policy.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/pwutil.h,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  When running a command as the invoking user we cannot use the gid list
  from the front-end since it may not correspond to the user’s aux group
  vector as defined by the group database.
  [[250209d7a]](https://git.sudo.ws/sudo/commit/?id=250209d7a)

* lib/util/regress/fnmatch/fnm\_test.c, lib/util/regress/glob/globtest.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/parser/check\_hexchar.c:

  Add missing initprogname() calls.
  [[dd47a0a41]](https://git.sudo.ws/sudo/commit/?id=dd47a0a41)

2017-11-16 Todd C. Miller

* plugins/sudoers/ldap.c:

  Plug some memory leaks on error, some found by the clang static
  analyzer.
  [[ca2e1a455]](https://git.sudo.ws/sudo/commit/?id=ca2e1a455)

2017-11-15 Todd C. Miller

* plugins/sudoers/parse.c:

  Avoid calling cmnd\_matches() in list/verify mode if we already have a
  match.
  [[bcc0eeb57]](https://git.sudo.ws/sudo/commit/?id=bcc0eeb57)

* plugins/sudoers/ldap.c, plugins/sudoers/parse.c, plugins/sudoers/sssd.c:
  In list (-l) or verify (-v) mode, if we have a match but authentication
  is required, clear FLAG\_NOPASSWD so that when listpw/verifypw is set to
  “all” and there are multiple sudoers sources a password will be required
  unless none of the entries in all sources require authentication. From
  Radovan Sroka of RedHat
  [[88faa5873]](https://git.sudo.ws/sudo/commit/?id=88faa5873)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  When checking the results for “sudo -l” and “sudo -v”, keep checking
  even after we get a match since the value of doauth may depend on
  evaluating all the results. From Radovan Sroka of RedHat.
  [[2cbdc2654]](https://git.sudo.ws/sudo/commit/?id=2cbdc2654)

2017-11-14 Todd C. Miller

* plugins/sudoers/sudoers.c:

  If passwd\_tries is less than 1, check\_user() will always return false
  (since the user didn’t authenticate). The normal reason for this is an
  authentication error but in this case no authentication was tries so no
  warning message has been displayed to the user. If the user wasn’t given
  a chance to authenticate, set inform\_user to true when calling
  log\_denial() from sudoers\_policy\_main().

  An alternate approach would be for check\_user() to return true in this
  case but seems more confusing.
  [[a62cd4b4f]](https://git.sudo.ws/sudo/commit/?id=a62cd4b4f)

2017-10-22 Todd C. Miller

* doc/TROUBLESHOOTING:

  Document bash shell alias issue with “sudo -i”.
  [[4e8c037f2]](https://git.sudo.ws/sudo/commit/?id=4e8c037f2)

2017-10-20 Todd C. Miller

* plugins/sudoers/policy.c:

  Return an error if the sudo front end doesn’t set the user name, user
  ID, group ID or host name. [Bug
  #807](https://bugzilla.sudo.ws/show_bug.cgi?id=807)
  [[53a8ad712]](https://git.sudo.ws/sudo/commit/?id=53a8ad712)

* lib/util/gethostname.c:

  Treat an empty hostname as a failure and return NULL.
  [[2c45774a3]](https://git.sudo.ws/sudo/commit/?id=2c45774a3)

2017-10-17 Todd C. Miller

* plugins/sudoers/sudoers2ldif:

  Add support for #include and #includedir from Natale Vinto.
  [[740c619d3]](https://git.sudo.ws/sudo/commit/?id=740c619d3)

2017-10-14 Todd C. Miller

* doc/CONTRIBUTORS:

  Minor corrections from Tae Wong
  [[c01774158]](https://git.sudo.ws/sudo/commit/?id=c01774158)

2017-10-12 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Add a warning that for “sudo -i command” and “sudo -s command” the shell
  is not run in interactive mode which may change its behavior.
  [[cece54ae8]](https://git.sudo.ws/sudo/commit/?id=cece54ae8)

2017-09-26 Todd C. Miller

* include/sudo\_compat.h, src/exec\_pty.c:

  Fix stair-stepped output when the output of a sudo command is piped to
  another command and use\_pty is set.
  [[3b88cdfcd]](https://git.sudo.ws/sudo/commit/?id=3b88cdfcd)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  env\_keep and env\_check are also taken into account with “sudo -i”. [Bug
  #806](https://bugzilla.sudo.ws/show_bug.cgi?id=806)
  [[1051cf1e6]](https://git.sudo.ws/sudo/commit/?id=1051cf1e6)

2017-09-18 Todd C. Miller

* INSTALL, config.h.in, configure, configure.ac,
  plugins/sudoers/ins\_classic.h:

  Make PC insults the default and add new configure option,
  enable-offensive-insults, to enable the offensive insults.
  [[749cdc9d9]](https://git.sudo.ws/sudo/commit/?id=749cdc9d9)

2017-09-14 Todd C. Miller

* doc/CONTRIBUTORS:

  Add missing translators from recent updates and one name change.
  [[dcb887807]](https://git.sudo.ws/sudo/commit/?id=dcb887807)

2017-09-07 Todd C. Miller

* MANIFEST, plugins/sudoers/po/fur.po, plugins/sudoers/po/hr.mo,
  plugins/sudoers/po/hr.po, plugins/sudoers/po/sv.mo,
  plugins/sudoers/po/sv.po, po/hr.mo, po/hr.po, po/sv.mo, po/sv.po:

  sync with translationproject.org \* \* \* sync with translationproject.org
  [[9ab1c9935]](https://git.sudo.ws/sudo/commit/?id=9ab1c9935)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  More accurately describe the use\_pty option now that its behavior has
  changed with respect to interposition with a pipe. Also describe some
  caveats with log\_input.
  [[7e78fbccf]](https://git.sudo.ws/sudo/commit/?id=7e78fbccf)

* doc/UPGRADE:

  Document changes in use\_pty behavior when no terminal is present.
  [[b4f4bb334]](https://git.sudo.ws/sudo/commit/?id=b4f4bb334)

* src/exec\_pty.c:

  Set ec->cmnd\_pid to the correct value when receiving the command’s
  process ID from the monitor.
  [[894999204]](https://git.sudo.ws/sudo/commit/?id=894999204)

* src/exec.c, src/exec\_nopty.c, src/exec\_pty.c, src/sudo\_exec.h:

  If /dev/tty is not available and no I/O logging plugins are configured,
  fall back on exec\_nopty() even if the policy plugin requested a pty. We
  never allocate a pty when sudo is not run from a terminal anyway.
  [[84af812b8]](https://git.sudo.ws/sudo/commit/?id=84af812b8)

* src/exec\_pty.c:

  Do not set utmp\_user if we did not actually allocate a pty.
  [[2c2476f07]](https://git.sudo.ws/sudo/commit/?id=2c2476f07)

2017-09-06 Todd C. Miller

* NEWS, configure, configure.ac:

  sudo 1.8.21p2
  [[87eba6c89]](https://git.sudo.ws/sudo/commit/?id=87eba6c89)

* src/exec.c:

  sudo\_terminated() should not return true when SIGCHLD is pending. [Bug
  #801](https://bugzilla.sudo.ws/show_bug.cgi?id=801)
  [[d85056d95]](https://git.sudo.ws/sudo/commit/?id=d85056d95)

* src/tgetpass.c:

  Set SIGCHLD handler to SIG\_DFL before forking the askpass command and
  restore after. Otherwise, SIGCHLD will end up in the list of pending
  signals and sudo\_execute() will not execute the command.
  [[4b5aeefeb]](https://git.sudo.ws/sudo/commit/?id=4b5aeefeb)

* lib/util/event.c:

  The read and write sides of signal\_pipe[] were swapped, resulting in
  EBADF reading from and writing to the signal pipe on Linux and probably
  others. On systems with bidirectional pipes this was not an issue.
  [[fdff345e0]](https://git.sudo.ws/sudo/commit/?id=fdff345e0)

2017-09-05 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  Fix a logic error in 96651906de42 which prevented sudo from using the
  PAM-supplied prompt. [Bug
  #799](https://bugzilla.sudo.ws/show_bug.cgi?id=799)
  [[8e021c39f]](https://git.sudo.ws/sudo/commit/?id=8e021c39f)

2017-09-01 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.8.21p1
  [[f5425a80a]](https://git.sudo.ws/sudo/commit/?id=f5425a80a)

* mkpkg:

  The Fedora sudo package uses /etc/ldap.conf not /etc/sudo-ldap.conf.
  [[171512b17]](https://git.sudo.ws/sudo/commit/?id=171512b17)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  The fix for matching when no sudoRunAsUser is present in a sudoRole was
  incomplete. If no -g option was specified on the command line but
  sudoRunAsGroup is present in a sudoRole, we need to treat the group
  match as failed instead of missing.
  [[06d52c97c]](https://git.sudo.ws/sudo/commit/?id=06d52c97c)

* plugins/sudoers/check.c, plugins/sudoers/defaults.c:

  Sprinkle a few more debugging printfs.
  [[507ab6fdc]](https://git.sudo.ws/sudo/commit/?id=507ab6fdc)

* plugins/sudoers/sudoreplay.c:

  Fix replaying sessions that contain input logs. When the inter-record
  timeout expires we need to read the next record if there is nothing to
  output.
  [[e10025961]](https://git.sudo.ws/sudo/commit/?id=e10025961)

* doc/visudo.cat:

  regen
  [[447c2c7e8]](https://git.sudo.ws/sudo/commit/?id=447c2c7e8)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Fix typo (Auguest vs. August). From David Pocock.
  [[7652dad0d]](https://git.sudo.ws/sudo/commit/?id=7652dad0d)

2017-08-31 Todd C. Miller

* plugins/sudoers/sudo\_nss.c:

  Go back to returning true from display\_privs() on non-error. This
  results in “sudo -U otheruser -l” exiting with a status of 0 even when
  otheruser is not allowed to run commands. This is appropriate since the
  “sudo -l” command was successful. This does not change the exit value
  when otheruser runs “sudo -l” themselves, the exit status will be 1
  since that user is not allowed to run commands. Requested by Radovan
  Sroka.
  [[d5c41ae37]](https://git.sudo.ws/sudo/commit/?id=d5c41ae37)

* plugins/sudoers/ldap.c:

  Fix the pass2 ldap query string when no search filter is defined. Due to
  the addition of “(sudoUser=\*)” to the query we always need the AND
  operator, even if no search filter is present.
  [[5cdee2c2c]](https://git.sudo.ws/sudo/commit/?id=5cdee2c2c)

2017-08-29 Todd C. Miller

* src/exec\_nopty.c:

  Don’t forward SIGINFO to the child when it is send by the kernel (not
  another user process). This is consistent with the handling of other
  keyboard-generated signals such as SIGINT, SIGQUIT and SIGTSTP. [Bug
  #796](https://bugzilla.sudo.ws/show_bug.cgi?id=796)
  [[c3d098254]](https://git.sudo.ws/sudo/commit/?id=c3d098254)

2017-08-23 Todd C. Miller

* sudo.pp:

  Fix path to LICENSE and NEWS files that get used in the installer.
  Previously, the installed versions were used instead of the ones in the
  destdir.
  [[0d31a1c30]](https://git.sudo.ws/sudo/commit/?id=0d31a1c30)

2017-08-20 Todd C. Miller

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po, po/fi.mo, po/fi.po:

  sync with translationproject.org
  [[0d243a882]](https://git.sudo.ws/sudo/commit/?id=0d243a882)

2017-08-18 Todd C. Miller

* po/es.mo, po/es.po:

  sync with translationproject.org
  [[b7b00c26d]](https://git.sudo.ws/sudo/commit/?id=b7b00c26d)

2017-08-12 Todd C. Miller

* plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po, po/it.mo, po/it.po:

  sync with translationproject.org
  [[b45d73acb]](https://git.sudo.ws/sudo/commit/?id=b45d73acb)

2017-08-11 Todd C. Miller

* NEWS:

  Preserving environment variables on the command line was bug #279
  [[159f89f0d]](https://git.sudo.ws/sudo/commit/?id=159f89f0d)

2017-08-10 Todd C. Miller

* MANIFEST, NEWS, doc/CONTRIBUTORS, po/fur.mo, po/fur.po:

  Add Friulian translation for sudo from Fabio Tomat via
  translationproject.org
  [[a01bbfacf]](https://git.sudo.ws/sudo/commit/?id=a01bbfacf)

2017-08-08 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/cs.mo,
  po/cs.po, po/fr.mo, po/fr.po, po/ko.mo, po/ko.po, po/nb.mo, po/nb.po,
  po/pl.mo, po/pl.po, po/pt\_BR.mo, po/pt\_BR.po, po/sr.mo, po/sr.po,
  po/sv.mo, po/sv.po, po/vi.mo, po/vi.po, po/zh\_CN.mo, po/zh\_CN.po:

  sync with translationproject.org
  [[6696653e4]](https://git.sudo.ws/sudo/commit/?id=6696653e4)

2017-08-04 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  In the Runas example that uses “boulder” make it clear that “boulder” is
  a host name.
  [[54860cf7f]](https://git.sudo.ws/sudo/commit/?id=54860cf7f)

2017-08-03 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[deaeffe73]](https://git.sudo.ws/sudo/commit/?id=deaeffe73)

* NEWS, doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, src/parse\_args.c:
  Allow the user to specify a list of environment variables to preserve.
  This adds an option paramter to the –preserve-env option, a
  comma-separated list of variable names.
  [[c18dde235]](https://git.sudo.ws/sudo/commit/?id=c18dde235)

2017-08-01 Todd C. Miller

* INSTALL, NEWS, config.h.in, configure, configure.ac, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/timestamp.c:

  Replace tty\_tickets option with timestamp\_type which can be global, ppid
  or tty. Defaults to tty (no change in behavior). Some users want the
  ppid behavior.
  [[63d954d1f]](https://git.sudo.ws/sudo/commit/?id=63d954d1f)

* lib/util/Makefile.in, plugins/sudoers/Makefile.in:

  regen
  [[c3b3e501b]](https://git.sudo.ws/sudo/commit/?id=c3b3e501b)

* plugins/sudoers/sudoers.c:

  Don’t send email about an unresolvable host name if fqdn is enabled and
  the user specified the run host via the -h flag.
  [[48459292f]](https://git.sudo.ws/sudo/commit/?id=48459292f)

2017-07-31 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  fix playback of stdout/stderr without embedded carriage returns
  [[5ab1d724a]](https://git.sudo.ws/sudo/commit/?id=5ab1d724a)

2017-07-28 Todd C. Miller

* plugins/sudoers/ldap.c:

  Avoid unused variable warning when sasl is not used.
  [[98369bf98]](https://git.sudo.ws/sudo/commit/?id=98369bf98)

* INSTALL, configure, configure.ac:

  Add support for –enable-sasl and –disable-sasl to make it possible to
  enable/disable support for LDAP with SASL authentication. Sudo compiles
  in support for SASL authentiation by default if the
  ldap\_sasl\_interactive\_bind\_s() function is detected. [Bug
  #788](https://bugzilla.sudo.ws/show_bug.cgi?id=788)
  [[beece9171]](https://git.sudo.ws/sudo/commit/?id=beece9171)

* NEWS:

  List the correct pattern ("*=()*") in the env\_delete description. Use
  pseudo-tty instead of pseudo terminal for consistency.
  [[ad81862b0]](https://git.sudo.ws/sudo/commit/?id=ad81862b0)

2017-07-27 Todd C. Miller

* lib/util/closefrom.c:

  Include pathnames.h for /dev/fd on FreeBSD and Mac OS X.
  [[5a6b8a78f]](https://git.sudo.ws/sudo/commit/?id=5a6b8a78f)

* NEWS:

  update for 1.8.21
  [[ec45b77d0]](https://git.sudo.ws/sudo/commit/?id=ec45b77d0)

* src/exec\_pty.c:

  No need to call sudo\_ev\_del() before sudo\_ev\_free(); sudo\_ev\_free() will
  delete the event from its base before freeing it.
  [[0849e2cac]](https://git.sudo.ws/sudo/commit/?id=0849e2cac)

* src/exec\_pty.c:

  Terminate the command if an I/O log function returns 0 or -1. This was
  mistakenly removed by 25b7fd056614 in Sudo 1.8.18 with the removal of
  the ignore\_iolog\_errors variable.
  [[1cfaf6c34]](https://git.sudo.ws/sudo/commit/?id=1cfaf6c34)

* plugins/sudoers/sudoreplay.c:

  Quiet a coverity false positive.
  [[4b5162291]](https://git.sudo.ws/sudo/commit/?id=4b5162291)

* plugins/sudoers/sudoreplay.c:

  Change to a single event loop in sudoreplay and use signal events.
  [[2d30c42a0]](https://git.sudo.ws/sudo/commit/?id=2d30c42a0)

2017-07-21 Todd C. Miller

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  start new sentences on a new line
  [[9ea9ecb18]](https://git.sudo.ws/sudo/commit/?id=9ea9ecb18)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Clarify how the variable prompt options interact with each other and
  PAM.
  [[d76d5eaeb]](https://git.sudo.ws/sudo/commit/?id=d76d5eaeb)

* plugins/sudoers/sudoers.c:

  Don’t set passprompt\_override when SUDO\_PROMPT is present. This
  effectively reverts ed77d255f383.

  We treat the SUDO\_PROMPT environment variable similar to passprompt in
  sudoers: it will only override a PAM prompt if the PAM prompt is either
  “Password:” or “username’s Password:”.
  [[879ba6887]](https://git.sudo.ws/sudo/commit/?id=879ba6887)

2017-07-20 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/logging.c:

  Add syslog\_pid sudoers option to log sudo’s process ID when logging via
  syslog. This is disabled by default to match historic behavior.
  [[d129f306e]](https://git.sudo.ws/sudo/commit/?id=d129f306e)

* plugins/sudoers/auth/pam.c:

  When deciding which prompt to use (PAM’s or sudo’s) treat the PAM prompt
  “username’s Password:” as equivalent to “Password:”. Some PAM modules
  (on AIX at least) use this prompt.
  [[43cbcbc24]](https://git.sudo.ws/sudo/commit/?id=43cbcbc24)

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in:

  Add missing argument to a few of the defaults strings in the “sudo -V”
  output.
  [[5923a2811]](https://git.sudo.ws/sudo/commit/?id=5923a2811)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/visudo.c:

  When examining environment variables or variables passed in from the
  front-end, ignore variables with no value specified.
  [[52b25940c]](https://git.sudo.ws/sudo/commit/?id=52b25940c)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Document that “-p prompt” overrides SUDO\_PROMPT.
  [[6b4d871b1]](https://git.sudo.ws/sudo/commit/?id=6b4d871b1)

* plugins/sudoers/sudoers.c:

  Enable passprompt\_override by default if SUDO\_PROMPT is present in the
  environment. This is consistent with how “sudo -p prompt” is handled.
  [[37f591d2d]](https://git.sudo.ws/sudo/commit/?id=37f591d2d)

2017-07-17 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  When reading a single character via a switch() use “default: instead of
  “case 1:” to quiet a coverity warning.
  [[1918ec4a5]](https://git.sudo.ws/sudo/commit/?id=1918ec4a5)

* plugins/sudoers/sudoreplay.c:

  Initialize ch in getsize\_cb() in case we are called with the wrong
  initial state.
  [[6509482bf]](https://git.sudo.ws/sudo/commit/?id=6509482bf)

* plugins/sudoers/sudoreplay.c:

  remove unused variable
  [[58858513f]](https://git.sudo.ws/sudo/commit/?id=58858513f)

* plugins/sudoers/visudo.c:

  Call install\_sudoers() even when doedit is false. If a file in a
  #includedir has a syntax error it will still have been edited and we
  need to install the edited temp file.
  [[034132774]](https://git.sudo.ws/sudo/commit/?id=034132774)

* plugins/sudoers/visudo.c:

  Reparse sudoers if a new #include file was added. Otherwise the new file
  will not get its syntax checked. [Bug
  #791](https://bugzilla.sudo.ws/show_bug.cgi?id=791)
  [[5bc80d3dd]](https://git.sudo.ws/sudo/commit/?id=5bc80d3dd)

2017-07-14 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  don’t restore the cursor when setting terminal size, we don’t want the
  cursor to move
  [[28fe33501]](https://git.sudo.ws/sudo/commit/?id=28fe33501)

* plugins/sudoers/sudoreplay.c:

  Read the xterm terminal size using an event so we can easily time out if
  needed.
  [[dbddf1bc3]](https://git.sudo.ws/sudo/commit/?id=dbddf1bc3)

* lib/util/event.c, src/exec\_nopty.c, src/exec\_pty.c:

  If we free the default base in sudo\_ev\_base\_free(), reset the default
  base to NULL.
  [[7f8765d32]](https://git.sudo.ws/sudo/commit/?id=7f8765d32)

2017-07-13 Todd C. Miller

* include/sudo\_event.h, lib/util/event.c, lib/util/util.exp.in,
  src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c:

  Add the ability to set a default event base, to be used by plugins which
  don’t have access to the event base.
  [[d2a0bfbb1]](https://git.sudo.ws/sudo/commit/?id=d2a0bfbb1)

* doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  plugins/sudoers/sudoreplay.c:

  Allow sudoreplay to adjust the window size on xterm-like terminals.
  [[9a7667831]](https://git.sudo.ws/sudo/commit/?id=9a7667831)

2017-07-12 Todd C. Miller

* plugins/sudoers/iolog.c, plugins/sudoers/sudoreplay.c:

  Log window size change events in the sudoers I/O plugin. Let sudoreplay
  parse a timing file with window change events (currently ignored).
  [[f79a23653]](https://git.sudo.ws/sudo/commit/?id=f79a23653)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h, src/exec\_pty.c:

  Pass window size change events to the plugin.
  [[8898ec1f9]](https://git.sudo.ws/sudo/commit/?id=8898ec1f9)

* lib/util/term.c:

  Clear input, output, control and local flags before copying them from
  the source terminal. Otherwise, flags that are disabled in the source
  terminal may still be enabled in the destination.
  [[6505d0580]](https://git.sudo.ws/sudo/commit/?id=6505d0580)

* Makefile.in, doc/Makefile.in, examples/Makefile.in, include/Makefile.in,
  lib/util/Makefile.in, lib/zlib/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  Remove pointless subshells in targets that simply change the directory
  and execute a command. The command is already run in a shell so there is
  no need to execute a subshell in this case.
  [[e70a953fb]](https://git.sudo.ws/sudo/commit/?id=e70a953fb)

2017-07-10 Todd C. Miller

* src/sudo.c:

  Store the debug instance ID for I/O plugins too. Now iolog\_open() is
  consistent with policy\_open().
  [[a7759b626]](https://git.sudo.ws/sudo/commit/?id=a7759b626)

2017-06-01 Todd C. Miller

* lib/util/event.c:

  Move the bits to fill in the new event base to sudo\_ev\_base\_init(),
  which is not currently exported.
  [[88bf0337e]](https://git.sudo.ws/sudo/commit/?id=88bf0337e)

2017-06-29 Todd C. Miller

* config.h.in, configure, configure.ac, lib/util/mktemp.c:

  Use getentropy() in mkstemp/mkdtemp replacement.
  [[c00018968]](https://git.sudo.ws/sudo/commit/?id=c00018968)

* configure, configure.ac, lib/util/closefrom.c, lib/util/mktemp.c,
  pathnames.h.in, src/exec\_pty.c, src/get\_pty.c, src/ttyname.c:

  Use \_PATH\_DEV consistently
  [[6d4d4594b]](https://git.sudo.ws/sudo/commit/?id=6d4d4594b)

2017-06-15 Todd C. Miller

* lib/util/term.c:

  When copying terminal settings from one tty to another only copy a
  subset of the flags. Sudo now copies the same set of flags that OpenSSH
  uses, which should be safe.
  [[c77c5d026]](https://git.sudo.ws/sudo/commit/?id=c77c5d026)

* src/exec\_monitor.c, src/exec\_nopty.c:

  Add debug warning when we have wait status but don’t overwrite the
  existing cstat.
  [[f5b60ef74]](https://git.sudo.ws/sudo/commit/?id=f5b60ef74)

* src/exec\_monitor.c:

  Better handling of SIGCONT from in command in the monitor. It is useful
  to know when the command continued but we don’t want to inform the
  parent or store the wait status in this case. Fixes a hang after
  multiple suspends on Linux.
  [[c8c586ee0]](https://git.sudo.ws/sudo/commit/?id=c8c586ee0)

2017-06-09 Todd C. Miller

* plugins/sudoers/parse.h:

  avoid padding in struct cmndspec
  [[022ac87d6]](https://git.sudo.ws/sudo/commit/?id=022ac87d6)

2017-06-07 Todd C. Miller

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudoers.cat, doc/sudoers.ldap.cat, doc/sudoers.man.in,
  doc/sudoers.mdoc.in:

  Fix the man section of sudo\_plugin in cross-references.
  [[60146c295]](https://git.sudo.ws/sudo/commit/?id=60146c295)

2017-06-05 Todd C. Miller

* src/sudo\_edit.c:

  Don’t treat an unchanged file as an error. From Xin Li.
  [[ab59834a0]](https://git.sudo.ws/sudo/commit/?id=ab59834a0)

* src/sudo\_edit.c:

  sudo\_edit() must return a wait status but if there is an error, or even
  if no changes were made to the file, it was returning 1 instead which
  would be interpreted as the command having received SIGHUP. Use the
  W\_EXITCODE() to construct a proper wait status in the error case too.
  [[0d70e868f]](https://git.sudo.ws/sudo/commit/?id=0d70e868f)

2017-06-03 Todd C. Miller

* src/ttyname.c:

  Avoid sign extension when assigning the value of tty\_nr in
  /proc/self/stat on Linux. It is an unsigned int value that is printed as
  a signed int but dev\_t is unsigned long long. We need to cast to
  unsigned int before assigning to a dev\_t.
  [[26d9043bf]](https://git.sudo.ws/sudo/commit/?id=26d9043bf)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/env.c:

  Instead of hard-coding a check for bash functions in
  env\_should\_delete(), use a “*=()* " pattern in initial\_badenv\_table[] to
  match them instead. This allows the user to remove the check via
  env\_delete.
  [[e1e2162dc]](https://git.sudo.ws/sudo/commit/?id=e1e2162dc)

2017-06-02 Todd C. Miller

* INSTALL.configure, configure.ac, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, mkpkg, sudo.pp:

  Mac OS X -> macOS
  [[0ab00964e]](https://git.sudo.ws/sudo/commit/?id=0ab00964e)

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  devsearch is ignored on BSD, macOS and Solaris
  [[7526869d8]](https://git.sudo.ws/sudo/commit/?id=7526869d8)

2017-05-31 Todd C. Miller

* NEWS:

  Sudo 1.8.20p2
  [[13633ae5a]](https://git.sudo.ws/sudo/commit/?id=13633ae5a)

* src/ttyname.c:

  A command name may also contain newline characters so read
  /proc/self/stat until EOF. It is not legal for /proc/self/stat to
  contain embedded NUL bytes so treat the file as corrupt if we see any.
  With help from Qualys.

  This is not exploitable due to the /dev traversal changes in sudo
  1.8.20p1 (thanks Solar!).
  [[c13ebffbc]](https://git.sudo.ws/sudo/commit/?id=c13ebffbc)

2017-05-30 Todd C. Miller

* src/ttyname.c:

  Use /proc/self consistently on Linux. As far as I know, only AIX doesn’t
  support /proc/self.
  [[15901c948]](https://git.sudo.ws/sudo/commit/?id=15901c948)

* INSTALL, configure, configure.ac, doc/sudo.conf.cat,
  doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in, include/sudo\_conf.h,
  lib/util/sudo\_conf.c, lib/util/util.exp.in, pathnames.h.in,
  src/ttyname.c:

  Add a new “devsearch” Path setting to sudo.conf for configuring the /dev
  paths to traverse instead of hard-coding a list in ttyname.c The default
  value can be set at configure time.
  [[cc71b9984]](https://git.sudo.ws/sudo/commit/?id=cc71b9984)

* src/selinux.c:

  After opening a tty device, fstat() and error out if it is not a
  character device.
  [[777abca38]](https://git.sudo.ws/sudo/commit/?id=777abca38)

2017-05-29 Todd C. Miller

* NEWS, configure:

  Sudo 1.8.20p1
  [[71e496a90]](https://git.sudo.ws/sudo/commit/?id=71e496a90)

* src/ttyname.c:

  Fix for CVE-2017-1000367, parsing of /proc/pid/stat on Linux when the
  process name contains spaces. Since the user has control over the
  command name this could be used by a user with sudo access to overwrite
  an arbitrary file. Thanks to Qualys for investigating and reporting this
  bug.

  Also stop performing a breadth-first traversal of /dev when looking for
  the device. Only the directories specified in search\_devs[] are checked.
  [[b3fe46ce6]](https://git.sudo.ws/sudo/commit/?id=b3fe46ce6)

2017-05-23 Todd C. Miller

* lib/util/event\_select.c:

  Fix potential memory leak on reallocarray() error. Coverity CID 169639
  [[20a0fa128]](https://git.sudo.ws/sudo/commit/?id=20a0fa128)

* plugins/sudoers/bsm\_audit.c:

  Only fall back to deprecated getaudit() on FreeBSD. Fixes compiler
  warnings on macOS.
  [[b2770313c]](https://git.sudo.ws/sudo/commit/?id=b2770313c)

* mkpkg:

  Use clang on macOS if present
  [[f794de950]](https://git.sudo.ws/sudo/commit/?id=f794de950)

* sudo.pp:

  fix paths to LICENSE and NEWS files for macOS packages
  [[b53a531cc]](https://git.sudo.ws/sudo/commit/?id=b53a531cc)

2017-05-18 Todd C. Miller

* src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c:

  To avoid overwriting existing command status, check for CMD\_INVALID
  instead of CMD\_ERRNO or CMD\_WSTATUS.
  [[ad8c1ae07]](https://git.sudo.ws/sudo/commit/?id=ad8c1ae07)

* plugins/sudoers/regress/env\_match/data:

  Add some patterns that could result in exponential run time for poorly
  written ‘\*’ matching.
  [[47df575f6]](https://git.sudo.ws/sudo/commit/?id=47df575f6)

2017-05-15 Todd C. Miller

* lib/util/ttysize.c, src/exec\_pty.c:

  On HP-UX 11.0, sys/ioctl.h is not sufficient to make struct winsize
  visisble, we need termios.h too.
  [[c91b6777d]](https://git.sudo.ws/sudo/commit/?id=c91b6777d)

* lib/util/ttysize.c:

  Always used TIOCGWINSZ.
  [[ea9120ee2]](https://git.sudo.ws/sudo/commit/?id=ea9120ee2)

* src/exec.c, src/sudo.c, src/sudo.h:

  Move exec\_setup(), unlimit\_nproc() and restore\_nproc() from sudo.c to
  exec.c.
  [[6a8eaef4b]](https://git.sudo.ws/sudo/commit/?id=6a8eaef4b)

* src/sudo\_edit.c:

  No need to include selinux.h here.
  [[befa862f7]](https://git.sudo.ws/sudo/commit/?id=befa862f7)

* plugins/sudoers/regress/env\_match/check\_env\_pattern.c:

  Fix compilation error on macOS
  [[f60030b90]](https://git.sudo.ws/sudo/commit/?id=f60030b90)

2017-05-12 Todd C. Miller

* plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/ldap.c:

  Avoid a clang analyzer false positive.
  [[7db97c783]](https://git.sudo.ws/sudo/commit/?id=7db97c783)

* Makefile.in:

  Add cov-build and cov-submit targets for checking with coverity.
  [[1dc39e9d9]](https://git.sudo.ws/sudo/commit/?id=1dc39e9d9)

* plugins/sudoers/iolog.c, plugins/sudoers/mkdir\_parents.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/visudo.c:

  Use debug logging instead of ignore\_result() where possible.
  [[a842913aa]](https://git.sudo.ws/sudo/commit/?id=a842913aa)

* config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/term.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/visudo.c, src/exec\_monitor.c, src/exec\_nopty.c,
  src/exec\_pty.c, src/signal.c, src/sudo.c, src/tcsetpgrp\_nobg.c,
  src/tgetpass.c:

  Remove use of non-standard sigaction\_t
  [[d979898e7]](https://git.sudo.ws/sudo/commit/?id=d979898e7)

* include/sudo\_compat.h, plugins/sudoers/timestamp.c,
  src/tcsetpgrp\_nobg.c, src/tgetpass.c:

  Remove use of the non-standard SA\_INTERRUPT
  [[b5c88e52b]](https://git.sudo.ws/sudo/commit/?id=b5c88e52b)

* configure, configure.ac:

  sudo 1.8.21
  [[9c3783a17]](https://git.sudo.ws/sudo/commit/?id=9c3783a17)

* MANIFEST, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/env.c,
  plugins/sudoers/env\_pattern.c,
  plugins/sudoers/regress/env\_match/check\_env\_pattern.c,
  plugins/sudoers/regress/env\_match/data, plugins/sudoers/sudoers.h:

  Add support for multiple ‘\*’ in env\_keep, env\_check and env\_delete
  entries.
  [[17514b55e]](https://git.sudo.ws/sudo/commit/?id=17514b55e)

* src/signal.c:

  Add SIGCHLD to the list of signals we install sudo\_handler() for.
  Otherwise, it is possible for the command to exit before the SIGCHLD
  handler is installed. POSIX says that signals that are ignored by
  default are still ignored even if the signal mask would block them. We
  need to have a handler installed for SIGCHLD before the fork().
  [[15790b69c]](https://git.sudo.ws/sudo/commit/?id=15790b69c)

* lib/util/event.c:

  Activate the sigevents inside the signal pipe callback itself and call
  signal\_pipe\_cb() directly if the backend returns EINTR and the
  signal\_caught flag is set. This has the side effect of processing signal
  events in the current pass of the event loop instead of the next one.
  [[95e92bfe4]](https://git.sudo.ws/sudo/commit/?id=95e92bfe4)

* src/exec.c, src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c,
  src/signal.c, src/sudo.h, src/sudo\_exec.h:

  Use SUDO\_EV\_SIGNAL and SUDO\_EV\_SIGINFO instead of managing the
  signal\_pipe explicitly.
  [[1186f3984]](https://git.sudo.ws/sudo/commit/?id=1186f3984)

* include/sudo\_event.h, lib/util/event.c:

  Handle the possibility of the siginfo parameter in sa\_sigaction handler
  being NULL.
  [[9d4a92b9b]](https://git.sudo.ws/sudo/commit/?id=9d4a92b9b)

* include/sudo\_event.h, lib/util/event.c:

  Add support for signal events in sudo’s event subsystem
  [[2a5580877]](https://git.sudo.ws/sudo/commit/?id=2a5580877)

* plugins/sudoers/sudoreplay.c:

  Restore the error message for sudo\_ev\_add() failure.
  [[e453c9797]](https://git.sudo.ws/sudo/commit/?id=e453c9797)

* include/sudo\_queue.h:

  Add workaround for clang static analyzer being confused by LIST\_REMOVE
  and TAILQ\_REMOVE.
  [[a2a83557e]](https://git.sudo.ws/sudo/commit/?id=a2a83557e)

2017-05-11 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Fix “make check” when openssl or gcrypt is used. [Bug
  #787](https://bugzilla.sudo.ws/show_bug.cgi?id=787)
  [[246ed8777]](https://git.sudo.ws/sudo/commit/?id=246ed8777)

2017-05-10 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Only display string version of errno if sudo\_ev\_add() fails for now
  [[0244f931d]](https://git.sudo.ws/sudo/commit/?id=0244f931d)

2017-05-08 Todd C. Miller

* NEWS:

  update
  [[75f5f4934]](https://git.sudo.ws/sudo/commit/?id=75f5f4934)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Be clear that #includedir diverts control to the files in the specified
  directory and, when parsing of those files is complete, returns control
  to the original file. [Bug
  #775](https://bugzilla.sudo.ws/show_bug.cgi?id=775)
  [[e51831fab]](https://git.sudo.ws/sudo/commit/?id=e51831fab)

2017-05-07 Todd C. Miller

* plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po, po/sr.mo, po/sr.po:

  sync with translationproject.org
  [[93c029f4f]](https://git.sudo.ws/sudo/commit/?id=93c029f4f)

2017-05-05 Todd C. Miller

* NEWS:

  update
  [[6f3cc3f10]](https://git.sudo.ws/sudo/commit/?id=6f3cc3f10)

* src/exec\_monitor.c:

  Fix a hang introduced in the last commit. Don’t close the pty slave
  until after we have the controlling tty.
  [[e18a5c7d7]](https://git.sudo.ws/sudo/commit/?id=e18a5c7d7)

* src/exec\_monitor.c, src/exec\_pty.c:

  If any of std{in,out,err} are not hooked up to a tty only interpose
  ourselves with a pipe if the plugin will actually log the data. This
  avoids a problem with non-interactive commands where no tty is present
  where sudo will consume stdin even when log\_input is not enabled in
  sudoers.
  [[44dc15d02]](https://git.sudo.ws/sudo/commit/?id=44dc15d02)

* NEWS:

  update
  [[62730d13d]](https://git.sudo.ws/sudo/commit/?id=62730d13d)

* doc/TROUBLESHOOTING:

  Update based on information from Michael Felt.
  [[01228b735]](https://git.sudo.ws/sudo/commit/?id=01228b735)

2017-05-04 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  In check\_input() when switch()ing on the return value of read(), use the
  default label instead of 1 for the success case. It is only reading a
  single byte so the two are equivalent but it reads better using default.
  [[4e67ac56b]](https://git.sudo.ws/sudo/commit/?id=4e67ac56b)

* plugins/sudoers/sudoreplay.c:

  Check sudo\_ev\_add() return value. Coverity CID 168362
  [[1a047b156]](https://git.sudo.ws/sudo/commit/?id=1a047b156)

* plugins/sudoers/iolog.c:

  Add io\_open() wrapper for open(2) that retries with PERM\_IOLOG if
  open(2) fails with EACCES. Use io\_open() instead of duplicate copies of
  the same fallback code.
  [[1d1ebb611]](https://git.sudo.ws/sudo/commit/?id=1d1ebb611)

* plugins/sudoers/iolog.c:

  Don’t retry the open() if set\_perms() fails.
  [[8757691fc]](https://git.sudo.ws/sudo/commit/?id=8757691fc)

* plugins/sudoers/iolog.c:

  Fix typo (fd2 vs. fd) caught by coverity, CID 168359.
  [[237eddd95]](https://git.sudo.ws/sudo/commit/?id=237eddd95)

* po/hu.mo, po/hu.po:

  sync with translationproject.org
  [[32ebb4a38]](https://git.sudo.ws/sudo/commit/?id=32ebb4a38)

2017-05-03 Todd C. Miller

* INSTALL:

  Warn people not to use –enable-asan in production.
  [[280d5ac69]](https://git.sudo.ws/sudo/commit/?id=280d5ac69)

* configure, configure.ac, src/Makefile.in:

  Move the invocation of check\_noexec into the main “check” target but
  only run it if not cross compiling and whe CHECK\_NOEXEC is not empty.
  [[80f8960fc]](https://git.sudo.ws/sudo/commit/?id=80f8960fc)

* src/Makefile.in:

  Move @CHECK\_NOEXEC@ to TEST\_PROGS so it gets cleaned up properly.
  [[ecbf89509]](https://git.sudo.ws/sudo/commit/?id=ecbf89509)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Move syslog\_maxlen to the “Integers” section. Move syslog\_goodpri and
  syslog\_badpri to the “Strings at can be used in a boolean context”
  section.
  [[8468f13c6]](https://git.sudo.ws/sudo/commit/?id=8468f13c6)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Fix a pasto that resulted in an extra (empty) syslog\_goodpri list entry.
  [[d9bfaa386]](https://git.sudo.ws/sudo/commit/?id=d9bfaa386)

* MANIFEST, plugins/sudoers/regress/sudoers/test20.in,
  plugins/sudoers/regress/sudoers/test20.json.ok,
  plugins/sudoers/regress/sudoers/test20.out.ok,
  plugins/sudoers/regress/sudoers/test20.toke.ok,
  plugins/sudoers/regress/sudoers/test21.in,
  plugins/sudoers/regress/sudoers/test21.json.ok,
  plugins/sudoers/regress/sudoers/test21.out.ok,
  plugins/sudoers/regress/sudoers/test21.toke.ok:

  Add tests for parsing tuples and syslog options.
  [[c37966555]](https://git.sudo.ws/sudo/commit/?id=c37966555)

* plugins/sudoers/defaults.c:

  Allow the syslog Defaults option to be used in a “true” boolean context
  and use the compiled in default log facility in this case.
  [[2d8717bdd]](https://git.sudo.ws/sudo/commit/?id=2d8717bdd)

* plugins/sudoers/defaults.c:

  Allow a tuple to be set to boolean true. Regression introduced by
  refactor of set\_default\_entry() in sudo 1.8.18.
  [[631d458b6]](https://git.sudo.ws/sudo/commit/?id=631d458b6)

2017-05-01 Todd C. Miller

* doc/TROUBLESHOOTING:

  Replace the list of “dangerous” environment variables and explain how
  sudo handles the environment instead.
  [[ddf1fa16f]](https://git.sudo.ws/sudo/commit/?id=ddf1fa16f)

2017-04-28 Todd C. Miller

* lib/util/glob.c:

  Fix exponential behavior in glob() with respect to multiple ‘\*’. See
  <https://research.swtch.com/glob> Adapted from
  <https://perl5.git.perl.org/perl.git/commit/33252c318625f3c6c89b816ee8848>
  1940e3e6f95
  [[6af6f8467]](https://git.sudo.ws/sudo/commit/?id=6af6f8467)

* src/exec\_pty.c:

  We no longer need to write to the tty if the command was killed by a
  signal. Sudo will terminate itself with the same signal the command died
  from. Unfortunately, we lose the “core dumped” bit since sudo itself
  will not dump core, but there doesn’t appear to be a way around that.
  [[dab8651ed]](https://git.sudo.ws/sudo/commit/?id=dab8651ed)

2017-04-27 Todd C. Miller

* src/sudo.c:

  On Linux, if the command we ran dumped core, set PR\_SET\_DUMPABLE to 0.
  This will prevent sudo itself from dumping core in this case.
  [[f57629c95]](https://git.sudo.ws/sudo/commit/?id=f57629c95)

* INSTALL:

  Update path to sudo\_noexec.so
  [[f0425ca81]](https://git.sudo.ws/sudo/commit/?id=f0425ca81)

* src/sudo.c:

  If the command terminated due to a signal, sudo will send that same
  signal to itself so the parent shell knows the command died from a
  signal. However, we don’t want sudo itself to dump core.
  [[91aec9730]](https://git.sudo.ws/sudo/commit/?id=91aec9730)

2017-04-26 Todd C. Miller

* NEWS:

  sync
  [[2d13bf356]](https://git.sudo.ws/sudo/commit/?id=2d13bf356)

* src/sudo.c:

  The fix for [Bug #722](https://bugzilla.sudo.ws/show_bug.cgi?id=722)
  contained a typo/thinko that resulted in the exit status being 0 when a
  command was killed by a signal other than SIGINT. This fixes the signal
  handler setup so sudo will terminate with the same signal as the
  command. Bug #784.
  [[9ee50beaa]](https://git.sudo.ws/sudo/commit/?id=9ee50beaa)

* sudo.pp:

  Better check for /etc/rc.d/rc2.d/S90sudo on AIX
  [[2180eab1f]](https://git.sudo.ws/sudo/commit/?id=2180eab1f)

* src/Makefile.in:

  Don’t install the rc.d link when installing to a DESTDIR. DESTDIR is
  generally only set when installing to a temporary directory for
  packaging in which case the link should be made in a post-install
  script.
  [[54a23d2c5]](https://git.sudo.ws/sudo/commit/?id=54a23d2c5)

* plugins/sudoers/Makefile.in, sudo.pp:

  In “make install”, install sample sudoers file as /etc/sudoers.dist and
  copy it to /etc/sudoers if there is no existing /etc/sudoers. Packages
  either contain /etc/sudoers (RPM and Debian) or /etc/sudoers.dist
  (everything else).
  [[9bccceaea]](https://git.sudo.ws/sudo/commit/?id=9bccceaea)

* Makefile.in, mkdep.pl:

  Allow “make dist” and “make depend” to work for out of tree builds.
  [[495931f4a]](https://git.sudo.ws/sudo/commit/?id=495931f4a)

2017-04-24 Todd C. Miller

* lib/zlib/Makefile.in:

  Add missing $(srcdir) prefix to shlib\_exp definition.
  [[f7df25062]](https://git.sudo.ws/sudo/commit/?id=f7df25062)

2017-04-21 Todd C. Miller

* include/sudo\_compat.h:

  Fix typo in killpg macro.
  [[11c82e2f1]](https://git.sudo.ws/sudo/commit/?id=11c82e2f1)

* include/sudo\_compat.h:

  Fix the killpg macro for systems without killpg() in libc.
  [[18c8ce10e]](https://git.sudo.ws/sudo/commit/?id=18c8ce10e)

2017-04-20 Todd C. Miller

* src/exec\_pty.c:

  Use the standard idiom for popping all entries from a tail queue. The
  llvm checker gets confused by TAILQ\_REMOVE and generate use-after-free
  false positives.
  [[9f1afe23f]](https://git.sudo.ws/sudo/commit/?id=9f1afe23f)

* src/exec\_monitor.c, src/exec\_nopty.c:

  rewrite errpipe callbacks
  [[c60259bd6]](https://git.sudo.ws/sudo/commit/?id=c60259bd6)

* src/exec\_monitor.c, src/exec\_nopty.c:

  use pipe2() with O\_CLOEXEC instead of pipe() + fcntl() and FD\_CLOEXEC
  [[c2176c32a]](https://git.sudo.ws/sudo/commit/?id=c2176c32a)

* src/exec\_pty.c:

  init io\_pipe[][] to -1, not 0
  [[6e7517952]](https://git.sudo.ws/sudo/commit/?id=6e7517952)

2017-04-19 Todd C. Miller

* plugins/sudoers/sssd.c:

  In sudo\_sss\_check\_user() it is not possible for handle to be NULL.
  [[f3daaba1c]](https://git.sudo.ws/sudo/commit/?id=f3daaba1c)

* plugins/sudoers/sssd.c:

  Fix a use after free when the fqdn sudoOption is set and no hostname
  value is present in sssd.conf.
  [[583fac17e]](https://git.sudo.ws/sudo/commit/?id=583fac17e)

* src/sudo.c:

  Avoid unused variable when getgrouplist\_2() is available. It would be
  nicer to just provide getgrouplist\_2() (or the equivalent) and avoid the
  ugly #ifdefs.
  [[a245fedc2]](https://git.sudo.ws/sudo/commit/?id=a245fedc2)

* plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po, po/nb.mo, po/nb.po:

  sync with translationproject.org
  [[871b912f4]](https://git.sudo.ws/sudo/commit/?id=871b912f4)

2017-04-13 Todd C. Miller

* plugins/sudoers/Makefile.in:

  regen
  [[7c63dbf65]](https://git.sudo.ws/sudo/commit/?id=7c63dbf65)

2017-04-12 Todd C. Miller

* src/ttyname.c:

  In sudo\_ttyname\_scan() if dir is the empty string, set errno to ENOENT
  before returning.
  [[d989f8af3]](https://git.sudo.ws/sudo/commit/?id=d989f8af3)

2017-04-11 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Try to make it clear that when match\_group\_by\_gid is enabled, groups in
  sudoers are looked up by group name instead of group ID. This doesn’t
  usually cause problems, but if there are conflicting group entries (for
  example, from a local /etc/group file and an LDAP or AD group database),
  whether the group is resolved by name or ID can be used to work around
  conflicts.
  [[0b81e0b19]](https://git.sudo.ws/sudo/commit/?id=0b81e0b19)

2017-04-07 Todd C. Miller

* plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po, po/ja.mo, po/ja.po:

  sync with translationproject.org
  [[f7251f806]](https://git.sudo.ws/sudo/commit/?id=f7251f806)

* plugins/sudoers/regress/parser/check\_digest.c:

  plug memory leak in check\_digest
  [[491e6ae9f]](https://git.sudo.ws/sudo/commit/?id=491e6ae9f)

* src/exec.c:

  Check return value of dispatch\_pending\_signals() in case we received
  SIGINT or SIGQUIT before executing the command.
  [[c6f9f06c4]](https://git.sudo.ws/sudo/commit/?id=c6f9f06c4)

2017-03-30 Todd C. Miller

* configure, configure.ac:

  back out unintentional change to the version number
  [[ec5b78335]](https://git.sudo.ws/sudo/commit/?id=ec5b78335)

2017-03-28 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/cs.mo,
  po/cs.po, po/da.mo, po/da.po, po/de.mo, po/de.po, po/fr.mo, po/fr.po,
  po/hr.mo, po/hr.po, po/it.mo, po/it.po, po/pl.mo, po/pl.po, po/pt\_BR.mo,
  po/pt\_BR.po, po/tr.mo, po/tr.po, po/uk.mo, po/uk.po, po/vi.mo, po/vi.po,
  po/zh\_CN.mo, po/zh\_CN.po:

  sync with translationproject.org
  [[04d83c41c]](https://git.sudo.ws/sudo/commit/?id=04d83c41c)

2017-03-27 Todd C. Miller

* configure, configure.ac, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_digest.out.ok:

  Make check\_digest test sudo\_filedigest() itself instead of the
  underlying SHA2 functions. That way we can test it regardless of whether
  we use sudo’s SHA2 functions or a library version.
  [[bdc925118]](https://git.sudo.ws/sudo/commit/?id=bdc925118)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document that commands matched by “sudo ALL” are not affected by fdexec.
  [[272a9c8e9]](https://git.sudo.ws/sudo/commit/?id=272a9c8e9)

2017-03-24 Todd C. Miller

* NEWS:

  Update for 1.8.20
  [[ba15306c9]](https://git.sudo.ws/sudo/commit/?id=ba15306c9)

* plugins/sudoers/po/sudoers.pot:

  regen for restricted\_env\_file
  [[a58c7d7db]](https://git.sudo.ws/sudo/commit/?id=a58c7d7db)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Mention that iolog\_user is useful for NFS.
  [[7f2633807]](https://git.sudo.ws/sudo/commit/?id=7f2633807)

2017-03-23 Todd C. Miller

* plugins/sudoers/iolog.c:

  Only retry mkdir or create with PERM\_IOLOG if errno is EACCES. Also
  always use PERM\_IOLOG for mkdtemp() since we cannot retry if it fails.
  Since we are guaranteed to create a new directory there’s no real need
  to try w/o PERM\_IOLOG in this case.
  [[4df6b62b5]](https://git.sudo.ws/sudo/commit/?id=4df6b62b5)

2017-03-22 Todd C. Miller

* plugins/sudoers/iolog.c:

  Add fallback to PERM\_IOLOG when making the final componenet of
  iolog\_dir.
  [[31b16fd3e]](https://git.sudo.ws/sudo/commit/?id=31b16fd3e)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/env.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Add restricted\_env\_file which is like env\_file but subject to the same
  restrictions as the user’s own environment.
  [[b3af85ddc]](https://git.sudo.ws/sudo/commit/?id=b3af85ddc)

* plugins/sudoers/iolog.c:

  quiet a warning on older zlib
  [[4621e4367]](https://git.sudo.ws/sudo/commit/?id=4621e4367)

* plugins/sudoers/iolog.c, plugins/sudoers/timestamp.c:

  cast mode\_t to unsigned int when printing with %o
  [[8d1e994d8]](https://git.sudo.ws/sudo/commit/?id=8d1e994d8)

2017-03-21 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  regen
  [[7f1fa00be]](https://git.sudo.ws/sudo/commit/?id=7f1fa00be)

* plugins/sudoers/iolog.c, plugins/sudoers/mkdir\_parents.c,
  plugins/sudoers/timestamp.c:

  Set umask temporarily when creating files instead of changing the mode
  after the fact. This is slightly less error prone.
  [[7668b4b42]](https://git.sudo.ws/sudo/commit/?id=7668b4b42)

* plugins/sudoers/iolog.c:

  remove now-useless variable
  [[2a37590b7]](https://git.sudo.ws/sudo/commit/?id=2a37590b7)

* plugins/sudoers/mkdir\_parents.c:

  Don’t set owner/mode on directories that already exist, only on
  newly-created ones.
  [[2caddff3f]](https://git.sudo.ws/sudo/commit/?id=2caddff3f)

* plugins/sudoers/iolog.c, plugins/sudoers/mkdir\_parents.c:

  Explicitly set the file mode of I/O log files so the mode is not
  affected by the invoking user’s umask.
  [[1bd90d8ff]](https://git.sudo.ws/sudo/commit/?id=1bd90d8ff)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/iolog.c, plugins/sudoers/mkdir\_parents.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/timestamp.c:

  Add PERM\_IOLOG so we can create I/O log files on an NFS-mounted
  filesystem where root is remapped to an unprivileged user.
  [[8d57491dc]](https://git.sudo.ws/sudo/commit/?id=8d57491dc)

* plugins/sudoers/mkdir\_parents.c:

  Restore the ‘/’ in the path before returning if we encounter an error.
  [[cfb15106e]](https://git.sudo.ws/sudo/commit/?id=cfb15106e)

2017-03-20 Todd C. Miller

* plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/timestamp.c:

  When creating the timestamp directory, use the group of the timestamp
  owner instead of inheriting the group of the parent directory.
  [[2dbd09144]](https://git.sudo.ws/sudo/commit/?id=2dbd09144)

2017-03-21 Todd C. Miller

* plugins/sudoers/sssd.c:

  zero out nss->handle after it has been freed to make sure we cannot
  free it twice
  [[a1322d7dd]](https://git.sudo.ws/sudo/commit/?id=a1322d7dd)

2017-03-20 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/iolog.c:

  Add iolog\_flush option.
  [[c4e703696]](https://git.sudo.ws/sudo/commit/?id=c4e703696)

2017-03-17 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/iolog.c:

  Don’t allow the user to specify an I/O log file mode that sudo can’t
  read or write to. I/O logs must always be readable and writable by the
  owner.
  [[8c8d078f6]](https://git.sudo.ws/sudo/commit/?id=8c8d078f6)

2017-03-14 Todd C. Miller

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo\_plugin.cat, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoreplay.cat, doc/visudo.cat:

  Regenerate the cat pages with newer mandoc which formats double quotes
  as “foo” instead of ``foo’’.
  [[8b3845c1c]](https://git.sudo.ws/sudo/commit/?id=8b3845c1c)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Make it clear that I/O logs will be complete even if the command run by
  sudo is terminated by a signal. The I/O log buffering just prevents the
  logs from being displayed in real-time as the command is running.
  [[4bdbc6b29]](https://git.sudo.ws/sudo/commit/?id=4bdbc6b29)

2017-03-13 Todd C. Miller

* src/exec.c, src/exec\_monitor.c, src/signal.c, src/sudo.h:

  Replace pipe\_nonblock() with pipe2()
  [[35e4bd3e9]](https://git.sudo.ws/sudo/commit/?id=35e4bd3e9)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/pipe2.c, mkdep.pl:

  Emulate pipe2() on systems without it.
  [[7aa89c49b]](https://git.sudo.ws/sudo/commit/?id=7aa89c49b)

2017-03-10 Todd C. Miller

* plugins/sudoers/auth/kerb5.c:

  Fix declaration of sudo\_krb5\_verify() in the case where
  krb5\_verify\_user() is not present. [Bug
  #777](https://bugzilla.sudo.ws/show_bug.cgi?id=777)
  [[b63df21ba]](https://git.sudo.ws/sudo/commit/?id=b63df21ba)

* plugins/sudoers/rcstr.c:

  Use HAVE\_STDBOOL\_H to detect systems w/o stdbool.h. [Bug
  #778](https://bugzilla.sudo.ws/show_bug.cgi?id=778)
  [[453360666]](https://git.sudo.ws/sudo/commit/?id=453360666)

2017-03-09 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[a86d399ef]](https://git.sudo.ws/sudo/commit/?id=a86d399ef)

* src/exec\_monitor.c, src/exec\_nopty.c, src/exec\_pty.c:

  Move SIGCHLD handling into handle\_sigchld() functions and move the
  remaining bits of dispatch\_signal() into signal\_pipe\_cb()
  [[867fd1634]](https://git.sudo.ws/sudo/commit/?id=867fd1634)

2017-03-08 Todd C. Miller

* src/utmp.c:

  e\_termination should be set to the value of WTERMSIG not WEXITSTATUS
  [[78f3f8bb9]](https://git.sudo.ws/sudo/commit/?id=78f3f8bb9)

2017-03-07 Todd C. Miller

* MANIFEST, src/Makefile.in, src/exec\_nopty.c, src/sudo.h,
  src/tcsetpgrp\_nobg.c:

  Add tcsetpgrp\_nobg() which acts like tcsetpgrp() but returns -1 for a
  background process. This is safer than blocking SIGTTOU which would
  cause tcsetpgrp() to succeed in the background.
  [[af1482f48]](https://git.sudo.ws/sudo/commit/?id=af1482f48)

2017-03-06 Todd C. Miller

* src/exec\_nopty.c:

  Prevent sudo from receiving SIGTTOU when it tries to restore the
  controlling terminal. There appears to be a race with the shell (bash)
  which we may lose.
  [[2f074d33a]](https://git.sudo.ws/sudo/commit/?id=2f074d33a)

2017-03-03 Todd C. Miller

* plugins/sudoers/timestamp.c, src/exec\_monitor.c:

  Add some casts to quiet gcc warnings on Solaris and remove a now-useless
  debug printf.
  [[00b4732c9]](https://git.sudo.ws/sudo/commit/?id=00b4732c9)

* src/exec\_pty.c:

  change debug info when suspending sudo
  [[a78814409]](https://git.sudo.ws/sudo/commit/?id=a78814409)

* MANIFEST, src/Makefile.in, src/exec.c, src/exec\_monitor.c,
  src/exec\_nopty.c, src/exec\_pty.c, src/sudo\_exec.h:

  Reorganize the command execution code to separate out the pty and
  non-pty code paths into their own event loops. The non-pty exec code is
  now contained in exec\_nopty.c and the pty exec code is split between
  exec\_pty.c (parent process) and exec\_monitor.c (session leader). This
  results in a small bit of duplicated code but improves readability. Some
  of the duplicated code will fall out in future changes to the event
  subsystem (the signal pipe).
  [[6dba84dca]](https://git.sudo.ws/sudo/commit/?id=6dba84dca)

2017-02-26 Todd C. Miller

* lib/util/ttysize.c, src/exec\_pty.c:

  Remove support for the TIOCGSIZE ioctl. Systems that use this rather
  than TIOCGWINSZ are too old for sudo to build on anyway.
  [[4b1f0c417]](https://git.sudo.ws/sudo/commit/?id=4b1f0c417)

2017-02-24 Todd C. Miller

* src/exec.c, src/exec\_pty.c:

  Set the child pid to -1 after we’ve waited for it and take care to avoid
  killing pid -1. This makes it a bit more explicit and removes the need
  for a separate variable to track the child’s status. Sudo already stops
  processing signals after it receives SIGCHLD so it is not vulnerable to
  CVE-2017-2616.
  [[13fcdb4f5]](https://git.sudo.ws/sudo/commit/?id=13fcdb4f5)

2017-02-22 Todd C. Miller

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Update the description of strict mode to current reality. Aliases
  haven’t needed to be defined before they are used since sudo 1.7.
  [[05e52c7b8]](https://git.sudo.ws/sudo/commit/?id=05e52c7b8)

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in,
  plugins/sudoers/regress/visudo/test2.err.ok,
  plugins/sudoers/regress/visudo/test3.err.ok, plugins/sudoers/visudo.c:

  Go back to using a Warning/Error prefix in the message printed to stderr
  for alias problems. Requested by Tomas Sykora.
  [[daa728fd8]](https://git.sudo.ws/sudo/commit/?id=daa728fd8)

2017-02-21 Todd C. Miller

* plugins/sudoers/filedigest.c, plugins/sudoers/filedigest\_openssl.c:

  fix copyright years
  [[143620bb2]](https://git.sudo.ws/sudo/commit/?id=143620bb2)

2017-02-20 Todd C. Miller

* INSTALL, MANIFEST, configure, configure.ac, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/filedigest\_gcrypt.c:

  Add support for using the message digest functions in libgcrypt instead
  of sudo’s own SHA2 implementation.
  [[b9954fb9b]](https://git.sudo.ws/sudo/commit/?id=b9954fb9b)

* INSTALL, MANIFEST, configure, configure.ac, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/filedigest\_openssl.c:

  Add support for using the message digest functions in OpenSSL instead of
  sudo’s own SHA2 implementation.
  [[199a594f4]](https://git.sudo.ws/sudo/commit/?id=199a594f4)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/digestname.c,
  plugins/sudoers/filedigest.c, plugins/sudoers/ldap.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.h,
  plugins/sudoers/sssd.c, plugins/sudoers/visudo\_json.c:

  Move the file digest code out of match.c and into filedigest.c. Inspired
  by RedHat changes that used libgcrypt. Also add digest\_type\_to\_name() to
  map a sudo digest type (int) to a name (string) and use it.
  [[b5e7b7bd2]](https://git.sudo.ws/sudo/commit/?id=b5e7b7bd2)

* plugins/sudoers/gmtoff.c:

  Check for gmtime() or localtime() returning NULL and just use a zero
  offset in that case. Should not be possible.
  [[00b76afe4]](https://git.sudo.ws/sudo/commit/?id=00b76afe4)

2017-02-18 Todd C. Miller

* plugins/sudoers/sudoers2ldif:

  Add support for ROLE, TYPE, PRIVS, LIMITPRIVS, TIMEOUT, NOTBEFORE and
  NOTAFTER.
  [[b3fdb26c4]](https://git.sudo.ws/sudo/commit/?id=b3fdb26c4)

* config.h.in, configure, configure.ac, plugins/sudoers/timestr.c:

  strftime() was in C89 so use it unconditionally.
  [[fd40d88ba]](https://git.sudo.ws/sudo/commit/?id=fd40d88ba)

* MANIFEST, config.h.in, configure, configure.ac, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, include/sudo\_debug.h,
  lib/util/sudo\_debug.c, lib/util/util.exp.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/gentime.c,
  plugins/sudoers/gmtoff.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.h, plugins/sudoers/gram.y, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/regress/parser/check\_gentime.c,
  plugins/sudoers/regress/sudoers/test19.in,
  plugins/sudoers/regress/sudoers/test19.json.ok,
  plugins/sudoers/regress/sudoers/test19.out.ok,
  plugins/sudoers/regress/sudoers/test19.toke.ok,
  plugins/sudoers/regress/visudo/test10.out.ok,
  plugins/sudoers/regress/visudo/test10.sh,
  plugins/sudoers/sudoers\_version.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Add NOTBEFORE and NOTAFTER command options similar to what is already
  available in LDAP.
  [[e5dee1557]](https://git.sudo.ws/sudo/commit/?id=e5dee1557)

2017-02-16 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[3b19d05fe]](https://git.sudo.ws/sudo/commit/?id=3b19d05fe)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h:

  Bump version to 1.11 for timeout entry in settings[]
  [[31540e622]](https://git.sudo.ws/sudo/commit/?id=31540e622)

* doc/sudo.conf.cat, doc/sudo\_plugin.cat, doc/sudoers.ldap.cat,
  doc/sudoreplay.cat, doc/visudo.cat:

  regen
  [[b030c96a8]](https://git.sudo.ws/sudo/commit/?id=b030c96a8)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, src/parse\_args.c, src/sudo\_usage.h.in:

  Add a command line option to specify the command timeout, as long as
  sudoers does not specify a shorter time limit.
  [[c86a6a23a]](https://git.sudo.ws/sudo/commit/?id=c86a6a23a)

2017-02-15 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Better error message when the timeout value does not parse.
  [[9b0622b58]](https://git.sudo.ws/sudo/commit/?id=9b0622b58)

* plugins/sudoers/timeout.c:

  set errno to ERANGE not EOVERFLOW on range error
  [[8bffd0988]](https://git.sudo.ws/sudo/commit/?id=8bffd0988)

2017-02-14 Todd C. Miller

* plugins/sudoers/Makefile.in:

  regen
  [[635f330a4]](https://git.sudo.ws/sudo/commit/?id=635f330a4)

* plugins/sudoers/Makefile.in:

  Only inhibit ASAN leak detector for tests that result in a parse error.
  The parser cannot currently clean up completely on error.
  [[e5266f9eb]](https://git.sudo.ws/sudo/commit/?id=e5266f9eb)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Plug some memory leaks found by ASAN.
  [[0f3f4e028]](https://git.sudo.ws/sudo/commit/?id=0f3f4e028)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  List SELinux role/type for “sudo -l” with LDAP and SSSd backends. Also
  fix printing of the timeout.
  [[e954facb9]](https://git.sudo.ws/sudo/commit/?id=e954facb9)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Only inherit SELinux role/type and Solaris privilege sets if the command
  does not include any. Previously, a command with only a role would
  inherit a type from the previous command which is not what was intended.
  [[d7f7cf7a7]](https://git.sudo.ws/sudo/commit/?id=d7f7cf7a7)

* doc/fixman.sh, doc/fixmdoc.sh, doc/sudoers.cat, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, plugins/sudoers/gram.c, plugins/sudoers/gram.h,
  plugins/sudoers/gram.y, plugins/sudoers/parse.h:

  Split out tags again so they must precede the command and not allow them
  to be mixed in with options.
  [[24cdbb8de]](https://git.sudo.ws/sudo/commit/?id=24cdbb8de)

* MANIFEST, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/ldap.c, plugins/sudoers/mkdefaults,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/policy.c, plugins/sudoers/regress/sudoers/test17.in,
  plugins/sudoers/regress/sudoers/test17.json.ok,
  plugins/sudoers/regress/sudoers/test17.out.ok,
  plugins/sudoers/regress/sudoers/test17.toke.ok,
  plugins/sudoers/regress/sudoers/test18.in,
  plugins/sudoers/regress/sudoers/test18.json.ok,
  plugins/sudoers/regress/sudoers/test18.out.ok,
  plugins/sudoers/regress/sudoers/test18.toke.ok,
  plugins/sudoers/testsudoers.c, plugins/sudoers/timeout.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/visudo\_json.c:

  Add support for command timeouts in sudoers. After the timeout, the
  command will be terminated.
  [[3980f1531]](https://git.sudo.ws/sudo/commit/?id=3980f1531)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/parse.h:

  Merge command tags, SELinux type/role and Solaris privs settings into
  “command options”. This relaxes the order of things so tags and other
  options can be interspersed.
  [[4f9dcd726]](https://git.sudo.ws/sudo/commit/?id=4f9dcd726)

* plugins/sudoers/rcstr.c:

  supress cppcheck memory leak false positive
  [[fb419ba06]](https://git.sudo.ws/sudo/commit/?id=fb419ba06)

* lib/util/strtoid.c:

  fix typo that prevented compilation on FreeBSD
  [[47b82acd7]](https://git.sudo.ws/sudo/commit/?id=47b82acd7)

2017-02-13 Todd C. Miller

* lib/util/Makefile.in:

  Link vsyslog.lo directly into vsyslog\_test to make sure the syslog()
  stub gets called. Otherwise, the real syslog will get called via libutil
  on AIX.
  [[4dad181be]](https://git.sudo.ws/sudo/commit/?id=4dad181be)

* lib/util/regress/vsyslog/vsyslog\_test.c:

  Fix final test with a format > 2048 bytes. Keep track of tests run in
  the syslog() stub so we can detect if the stub is not being called.
  [[f59327bc5]](https://git.sudo.ws/sudo/commit/?id=f59327bc5)

* lib/zlib/deflate.c:

  avoid redefining the MIN macro
  [[6263cc55a]](https://git.sudo.ws/sudo/commit/?id=6263cc55a)

* plugins/sudoers/parse.h, plugins/sudoers/timestr.c:

  Include parse.h in timestr.c which is where function prototype lives.
  [[09438e5b4]](https://git.sudo.ws/sudo/commit/?id=09438e5b4)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Fix for including a sudoers file that begins with the letter ‘i’. The
  hack to determine whether we are parsing an include or includedir is no
  longer safe now that relative include paths are permitted. [Bug
  #776](https://bugzilla.sudo.ws/show_bug.cgi?id=776).
  [[359cacc40]](https://git.sudo.ws/sudo/commit/?id=359cacc40)

2017-02-10 Todd C. Miller

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in:

  Display the value of syslog\_maxlen in sudo -V output.
  [[8c1da9b69]](https://git.sudo.ws/sudo/commit/?id=8c1da9b69)

2017-02-06 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c:

  Add ignore\_unknown\_defaults flag to ignore unknown Defaults entries in
  sudoers instead of producing a warning.
  [[3742f7a46]](https://git.sudo.ws/sudo/commit/?id=3742f7a46)

2017-01-27 Todd C. Miller

* plugins/sudoers/match.c:

  Always set the close-on-exec bit on the fd used to generate the digest
  (i.e. the command to run) on systems that lack fexecve(2). That way we
  don’t need to explicitly close it using #ifdefs.
  [[ba8f75669]](https://git.sudo.ws/sudo/commit/?id=ba8f75669)

* plugins/sudoers/po/ca.mo, plugins/sudoers/po/ca.po,
  plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po, po/ca.mo, po/ca.po,
  po/eo.mo, po/eo.po, po/sv.mo, po/sv.po:

  sync with translationproject.org
  [[1a8957e30]](https://git.sudo.ws/sudo/commit/?id=1a8957e30)

* NEWS:

  first updates for 1.8.20
  [[ca89a0a91]](https://git.sudo.ws/sudo/commit/?id=ca89a0a91)

* configure, configure.ac:

  sudo 1.8.20
  [[c392e469d]](https://git.sudo.ws/sudo/commit/?id=c392e469d)

2017-01-25 Todd C. Miller

* doc/LICENSE, lib/zlib/adler32.c, lib/zlib/compress.c, lib/zlib/crc32.c,
  lib/zlib/deflate.c, lib/zlib/deflate.h, lib/zlib/gzguts.h,
  lib/zlib/gzlib.c, lib/zlib/gzread.c, lib/zlib/gzwrite.c,
  lib/zlib/infback.c, lib/zlib/inffast.c, lib/zlib/inflate.c,
  lib/zlib/inflate.h, lib/zlib/inftrees.c, lib/zlib/trees.c,
  lib/zlib/uncompr.c, lib/zlib/zconf.h.in, lib/zlib/zlib.exp,
  lib/zlib/zlib.h, lib/zlib/zutil.c, lib/zlib/zutil.h:

  update zlib to version 1.2.11
  [[8e3613340]](https://git.sudo.ws/sudo/commit/?id=8e3613340)

2017-01-23 Todd C. Miller

* plugins/sudoers/match.c:

  Fix fdexec=never when a digest is present.
  [[26b8dc11b]](https://git.sudo.ws/sudo/commit/?id=26b8dc11b)

2017-01-22 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/match.c:

  Add new fdexec sudoers setting to allow choose whether execve() or
  fexecve() is used.
  [[413e1100b]](https://git.sudo.ws/sudo/commit/?id=413e1100b)

* src/exec.c, src/exec\_pty.c:

  Close execfd in parent processes where it is not needed.
  [[dde2b5eb2]](https://git.sudo.ws/sudo/commit/?id=dde2b5eb2)

2017-01-21 Todd C. Miller

* plugins/sudoers/match.c:

  Add support for digest matching when the command is a glob-style pattern
  or a directory. For example:

  millert ALL = sha224:TmUvLkp3a2txliSC2X6CiK42626qdKsH72m/PQ== /bin/
  millert ALL = sha224:TmUvLkp3a2txliSC2X6CiK42626qdKsH72m/PQ== /bin/\*

  would only match /bin/ls (assuming the digest matches).

  Previously, only explicit path matches checked the digest.
  [[5514ea685]](https://git.sudo.ws/sudo/commit/?id=5514ea685)

2017-01-17 Todd C. Miller

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  plugins/sudoers/ldap.c:

  Add support for SASL\_MECH in ldap.conf; [Bug
  #764](https://bugzilla.sudo.ws/show_bug.cgi?id=764)
  [[df03020c4]](https://git.sudo.ws/sudo/commit/?id=df03020c4)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Fix documentation bug, the contents of env\_file have never been subject
  to env\_keep or env\_check. However, variables are only added if they have
  not already been preserved.
  [[34ba901ba]](https://git.sudo.ws/sudo/commit/?id=34ba901ba)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  examples/sudoers:

  Safer example for rule that can change non-root passwords. GNU getopts
  allows options to follow arguments so we need to be able to deny things
  like “passwd root -q”. From Paul “Joey” Clark. [Bug
  #772](https://bugzilla.sudo.ws/show_bug.cgi?id=772)
  [[57933a8ff]](https://git.sudo.ws/sudo/commit/?id=57933a8ff)

2017-01-16 Todd C. Miller

* plugins/sudoers/ldap.c:

  Don’t overwrite the return value of ldap\_sasl\_interactive\_bind\_s() by
  the subsequent call to sudo\_set\_krb5\_ccache\_name(). From Paul Zirnik of
  SUSE.
  [[b4f524fe7]](https://git.sudo.ws/sudo/commit/?id=b4f524fe7)

* plugins/sudoers/env.c:

  In sudo\_unsetenv\_nodebug(), decrement envp.env\_len after removing the
  variable. From Paul Zirnik of SUSE.
  [[deb4c3b19]](https://git.sudo.ws/sudo/commit/?id=deb4c3b19)

2017-01-15 Todd C. Miller

* lib/util/Makefile.in:

  only run vsyslog\_test if it exists
  [[1a59ab8b7]](https://git.sudo.ws/sudo/commit/?id=1a59ab8b7)

* MANIFEST, configure, configure.ac, lib/util/Makefile.in,
  lib/util/regress/vsyslog/vsyslog\_test.c:

  Add regress for vsyslog replacement.
  [[63deb7770]](https://git.sudo.ws/sudo/commit/?id=63deb7770)

2017-01-13 Todd C. Miller

* configure, configure.ac:

  Define HAVE\_NANOSLEEP if we find nanosleep in librt
  [[09698b8a3]](https://git.sudo.ws/sudo/commit/?id=09698b8a3)

* configure, configure.ac:

  sudo\_nanosleep not nanosleep in util.exp.in
  [[f589897f8]](https://git.sudo.ws/sudo/commit/?id=f589897f8)

* configure, configure.ac:

  add nanosleep to util.exp.in if needed
  [[e636f96c4]](https://git.sudo.ws/sudo/commit/?id=e636f96c4)

* NEWS, configure, configure.ac:

  sudo 1.8.19p2
  [[08b662bf0]](https://git.sudo.ws/sudo/commit/?id=08b662bf0)

* lib/util/vsyslog.c:

  Double the size of new\_fmt[] and remove an extraneous break in the %m
  handling that was leftover from an earlier edit.
  [[a957a657b]](https://git.sudo.ws/sudo/commit/?id=a957a657b)

* lib/util/vsyslog.c:

  Fix typo, want vsnprintf not snprintf.
  [[921ad88ab]](https://git.sudo.ws/sudo/commit/?id=921ad88ab)

* plugins/sudoers/logging.c:

  move va\_start() in mysyslog()
  [[414b28dc4]](https://git.sudo.ws/sudo/commit/?id=414b28dc4)

* plugins/sudoers/sudoers.c:

  Only treat failure of expand\_iolog\_path() as fatal if
  ignore\_iolog\_errors is not set.
  [[269b8602d]](https://git.sudo.ws/sudo/commit/?id=269b8602d)

2017-01-12 Todd C. Miller

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/nanosleep.c, mkdep.pl, src/exec\_pty.c:

  When waiting for the parent to grant us the tty, use nanosleep instead
  of spinning to avoid hogging the CPU.
  [[2f0295373]](https://git.sudo.ws/sudo/commit/?id=2f0295373)

* src/sudo.c:

  Use ROOT\_UID instead of 0
  [[0ef26ff0b]](https://git.sudo.ws/sudo/commit/?id=0ef26ff0b)

2017-01-09 Todd C. Miller

* plugins/sudoers/Makefile.in:

  regen
  [[fabb38c91]](https://git.sudo.ws/sudo/commit/?id=fabb38c91)

2017-01-07 Todd C. Miller

* MANIFEST, plugins/sudoers/interfaces.c,
  plugins/sudoers/regress/visudo/test9.out.ok,
  plugins/sudoers/regress/visudo/test9.sh, plugins/sudoers/visudo.c:

  Fix crash in visudo introduced in sudo 1.8.9 when an IP address or
  network is used in a host-based Defaults entry. [Bug
  #766](https://bugzilla.sudo.ws/show_bug.cgi?id=766)
  [[90e1f4ec3]](https://git.sudo.ws/sudo/commit/?id=90e1f4ec3)

2017-01-05 Todd C. Miller

* configure, configure.ac, doc/LICENSE:

  Avoid using the system strnlen/strndup on AIX < 6. Even if configure
  correctly detects it is working on the build machine, the sudo package
  may be run on a system with an old libc were it is broken.
  [[0c3a8085b]](https://git.sudo.ws/sudo/commit/?id=0c3a8085b)

2016-12-20 Todd C. Miller

* NEWS, configure, configure.ac:

  sudo 1.8.19p1
  [[6c2cb6cb9]](https://git.sudo.ws/sudo/commit/?id=6c2cb6cb9)

* plugins/sudoers/defaults.c:

  Fix logic bug when matching syslog priority and facility.
  [[0d9255b2f]](https://git.sudo.ws/sudo/commit/?id=0d9255b2f)

* doc/HISTORY:

  Dell spun off Quest so simplify the history by just talking about Quest
  and not Dell.
  [[87d02bfe2]](https://git.sudo.ws/sudo/commit/?id=87d02bfe2)

2016-12-19 Todd C. Miller

* doc/LICENSE:

  Fix copyright year
  [[f847570ba]](https://git.sudo.ws/sudo/commit/?id=f847570ba)

* NEWS:

  typo
  [[f9ea84383]](https://git.sudo.ws/sudo/commit/?id=f9ea84383)

2016-12-18 Todd C. Miller

* include/sudo\_compat.h:

  HAVE\_DECL\_GETGROUPLIST\_2 is always defined if HAVE\_GETGROUPLIST\_2 is, we
  need to check its value, not whether it is defined.
  [[6aa43ff1e]](https://git.sudo.ws/sudo/commit/?id=6aa43ff1e)

2016-12-15 Todd C. Miller

* plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po:

  sync with translationproject.org
  [[cc0305480]](https://git.sudo.ws/sudo/commit/?id=cc0305480)

2016-12-13 Todd C. Miller

* configure, plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/sr.mo,
  po/sr.po:

  sync with translationproject.org
  [[2eeb191b9]](https://git.sudo.ws/sudo/commit/?id=2eeb191b9)

* config.h.in, configure.ac, include/sudo\_compat.h,
  plugins/sudoers/pwutil\_impl.c, src/sudo.c:

  Use getgrouplist\_2() on macOS if available.
  [[ae76e1a22]](https://git.sudo.ws/sudo/commit/?id=ae76e1a22)

2016-12-03 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  regen
  [[56cc9aa02]](https://git.sudo.ws/sudo/commit/?id=56cc9aa02)

* plugins/sudoers/interfaces.c:

  In set\_interfaces() treat a parse error as fatal.
  [[c62b7dc2e]](https://git.sudo.ws/sudo/commit/?id=c62b7dc2e)

2016-12-02 Todd C. Miller

* lib/util/regress/atofoo/atofoo\_test.c:

  Fix a clang warning on macOS
  [[e8f612ead]](https://git.sudo.ws/sudo/commit/?id=e8f612ead)

2016-12-01 Todd C. Miller

* plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po, po/ko.mo, po/ko.po,
  po/vi.mo, po/vi.po:

  sync with translationproject.org
  [[2884816c8]](https://git.sudo.ws/sudo/commit/?id=2884816c8)

* NEWS:

  update for 1.8.19b2
  [[4fc0c36ef]](https://git.sudo.ws/sudo/commit/?id=4fc0c36ef)

* plugins/sudoers/timestamp.c:

  Ignore a boot time that is in the future, which can happen when the
  clock is corrected down after boot. Otherwise, the timestamp file will
  be unlinked each time sudo is run and a password is always required.
  [[852ffa593]](https://git.sudo.ws/sudo/commit/?id=852ffa593)

2016-11-30 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/logging.c:

  Allow syslog priority to be negated or set to “none” to disable logging
  successes or failures.
  [[00b6be9df]](https://git.sudo.ws/sudo/commit/?id=00b6be9df)

* doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  plugins/sudoers/sudoreplay.c:

  Allow stdin and ttyin to be displayed too. The only one that is really
  useful in sudoreplay is stdin when input is from a pipe.
  [[cb1f04401]](https://git.sudo.ws/sudo/commit/?id=cb1f04401)

* src/regress/noexec/check\_noexec.c:

  Solaris 10 wordexp() returns 127 on execve() failure like popen() does.
  [[52d6a5e40]](https://git.sudo.ws/sudo/commit/?id=52d6a5e40)

* config.h.in, configure, configure.ac, include/sudo\_debug.h,
  lib/util/regress/atofoo/atofoo\_test.c, lib/util/strtoid.c,
  lib/util/sudo\_debug.c, lib/util/util.exp.in:

  id\_t is 64-bits on FreeBSD so use strtoll() there. Fixes the strtoid
  regress.
  [[334350af4]](https://git.sudo.ws/sudo/commit/?id=334350af4)

2016-11-29 Todd C. Miller

* NEWS:

  fix typo
  [[70d3e0e98]](https://git.sudo.ws/sudo/commit/?id=70d3e0e98)

* plugins/sudoers/sudoers.c:

  Fix the “all” setting for verifypw and listpw; nopass would never be
  true even if all the user’s entries had the NOPASSWD tag. Regression
  introduce in sudo 1.8.17. [Bug
  #762](https://bugzilla.sudo.ws/show_bug.cgi?id=762)
  [[aaf6fff73]](https://git.sudo.ws/sudo/commit/?id=aaf6fff73)

2016-11-28 Todd C. Miller

* plugins/sudoers/po/ca.mo, plugins/sudoers/po/cs.mo,
  plugins/sudoers/po/cs.po, plugins/sudoers/po/da.mo,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/el.mo, plugins/sudoers/po/eo.mo,
  plugins/sudoers/po/eu.mo, plugins/sudoers/po/fi.mo,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/hr.mo,
  plugins/sudoers/po/hr.po, plugins/sudoers/po/hu.mo,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/ko.mo, plugins/sudoers/po/ko.po,
  plugins/sudoers/po/lt.mo, plugins/sudoers/po/nb.mo,
  plugins/sudoers/po/nb.po, plugins/sudoers/po/nl.mo,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/ru.mo, plugins/sudoers/po/sk.mo,
  plugins/sudoers/po/sl.mo, plugins/sudoers/po/sr.mo,
  plugins/sudoers/po/tr.mo, plugins/sudoers/po/uk.mo,
  plugins/sudoers/po/uk.po, plugins/sudoers/po/zh\_CN.mo,
  plugins/sudoers/po/zh\_CN.po, po/cs.mo, po/cs.po, po/de.mo, po/de.po,
  po/es.mo, po/es.po, po/fr.mo, po/fr.po, po/hr.mo, po/hr.po, po/it.mo,
  po/it.po, po/ja.mo, po/ja.po, po/ko.mo, po/ko.po, po/nb.mo, po/nb.po,
  po/pl.mo, po/pl.po, po/pt\_BR.mo, po/pt\_BR.po, po/tr.mo, po/tr.po,
  po/uk.mo, po/uk.po, po/zh\_CN.mo, po/zh\_CN.po:

  sync with translationproject.org
  [[7bcd0285e]](https://git.sudo.ws/sudo/commit/?id=7bcd0285e)

2016-11-25 Todd C. Miller

* plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c, src/openbsd.c:

  Just use malloc\_options “S” on OpenBSD instead of “AFGJPR”.
  [[1aea3f6e3]](https://git.sudo.ws/sudo/commit/?id=1aea3f6e3)

2016-11-22 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update year in license
  [[4d06a612f]](https://git.sudo.ws/sudo/commit/?id=4d06a612f)

2016-11-21 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[0382a2d47]](https://git.sudo.ws/sudo/commit/?id=0382a2d47)

* doc/sudo.conf.cat, doc/sudoers.ldap.cat, doc/sudoreplay.cat:

  regen
  [[94b844ebb]](https://git.sudo.ws/sudo/commit/?id=94b844ebb)

* include/sudo\_debug.h, lib/util/sudo\_debug.c, plugins/sudoers/iolog.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoers\_debug.c, plugins/sudoers/visudo.c, src/sudo.c:

  Add SUDO\_DEBUG\_INSTANCE\_ERROR return value for sudo\_debug\_register() and
  check for it in places where we check the return value of
  sudo\_debug\_register().
  [[6c5936296]](https://git.sudo.ws/sudo/commit/?id=6c5936296)

2016-11-20 Todd C. Miller

* NEWS:

  update for 1.8.19
  [[de0c5c48a]](https://git.sudo.ws/sudo/commit/?id=de0c5c48a)

2016-11-17 Todd C. Miller

* config.h.in, configure, configure.ac, plugins/sudoers/getspwuid.c:

  Add support for getpwnam\_shadow() on OpenBSD
  [[695784e6e]](https://git.sudo.ws/sudo/commit/?id=695784e6e)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  plugins/sudoers/policy.c, src/sudo.c:

  Add umask to user\_info passed in from the front end to the plugin.
  [[f70f595b5]](https://git.sudo.ws/sudo/commit/?id=f70f595b5)

* plugins/sudoers/auth/rfc1938.c:

  Fix sign compare warning.
  [[0cde3f5de]](https://git.sudo.ws/sudo/commit/?id=0cde3f5de)

* MANIFEST, aclocal.m4, configure, configure.ac, m4/ax\_append\_flag.m4,
  m4/sudo.m4:

  Use AX\_APPEND\_FLAG instead of SUDO\_APPEND\_CPPFLAGS and direct
  modification of LDFLAGS.
  [[cb7e82acc]](https://git.sudo.ws/sudo/commit/?id=cb7e82acc)

* MANIFEST, configure, configure.ac, plugins/sudoers/aixcrypt.exp:

  Remove aixcrypt.exp, it was a remnant of the 90’s crypto wars where
  crypt() was not exported.
  [[a77ecca7d]](https://git.sudo.ws/sudo/commit/?id=a77ecca7d)

* doc/TROUBLESHOOTING:

  Remove obsolete solaris issue with snprintf
  [[80217f0bb]](https://git.sudo.ws/sudo/commit/?id=80217f0bb)

* INSTALL:

  SunOS 4.x is no longer supported
  [[c3373f03b]](https://git.sudo.ws/sudo/commit/?id=c3373f03b)

2016-11-16 Todd C. Miller

* lib/util/regress/sudo\_conf/test1.in, lib/util/sudo\_conf.c:

  Plug memory leak when a particular Path is set more than once.
  [[e797fc643]](https://git.sudo.ws/sudo/commit/?id=e797fc643)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Add sudo\_ldap\_is\_negated() and sudo\_ldap\_is\_negated() functions and use
  them to parse negated entries instead of doing it manually.
  [[d6c30ba27]](https://git.sudo.ws/sudo/commit/?id=d6c30ba27)

* plugins/sudoers/ldap.c:

  Fix printing of sudoedit\_follow in “sudo -l”
  [[da7373372]](https://git.sudo.ws/sudo/commit/?id=da7373372)

* plugins/sudoers/sssd.c:

  For “sudo -l” print sudoOption sudoedit\_follow as FOLLOW.
  [[c7d6521b4]](https://git.sudo.ws/sudo/commit/?id=c7d6521b4)

* config.h.in, configure, configure.ac, include/sudo\_conf.h,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_conf/test1.out.ok, lib/util/sudo\_conf.c,
  lib/util/util.exp.in, plugins/sudoers/policy.c, src/exec\_common.c,
  src/load\_plugins.c, src/parse\_args.c:

  Always define \_PATH\_SUDO\_NOEXEC, \_PATH\_SUDO\_SESH, \_PATH\_SUDO\_PLUGIN\_DIR,
  even if only defined to NULL. This means the accessors can always be
  present.

  Use RTLD\_PRELOAD\_VAR instead of \_PATH\_SUDO\_NOEXEC to tell when noexec is
  available.

  Add ENABLE\_SUDO\_PLUGIN\_API and use it instead of \_PATH\_SUDO\_PLUGIN\_DIR
  to tell when the plugin API is available.

  Add sudo\_conf\_clear\_paths() to clear the path values so the regress
  tests are not affected by compile-time settings.
  [[6dff4ac7f]](https://git.sudo.ws/sudo/commit/?id=6dff4ac7f)

* plugins/sudoers/ldap.c:

  Use readline() in sudo\_ldap\_read\_secret()
  [[8820ff3ef]](https://git.sudo.ws/sudo/commit/?id=8820ff3ef)

2016-11-15 Todd C. Miller

* lib/util/sudo\_conf.c:

  Get rid of struct sudo\_conf\_paths and just use #defined index values to
  access the path values. Make all accessors available even when the
  feature is not enabled.
  [[8cb9f298b]](https://git.sudo.ws/sudo/commit/?id=8cb9f298b)

* configure, configure.ac, lib/util/Makefile.in, lib/zlib/Makefile.in,
  mkdep.pl, plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  Add ASAN\_CFLAGS and ASAN\_LDFLAGS and use -Wc prefix in ASAN\_LDFLAGS to
  prevent libtool from strippign them out. Avoid using ASAN flags when
  building sudo\_noexec.so.
  [[bdbb3e985]](https://git.sudo.ws/sudo/commit/?id=bdbb3e985)

2016-11-14 Todd C. Miller

* configure, configure.ac:

  Disable noexec for HP-UX 10.x which probably doesn’t support LD\_PRELOAD
  [[589e129c8]](https://git.sudo.ws/sudo/commit/?id=589e129c8)

* config.h.in, configure, configure.ac, plugins/sudoers/getspwuid.c:

  Remove SunOS 4 support, it is not modern enough to run sudo.
  [[08a4a2859]](https://git.sudo.ws/sudo/commit/?id=08a4a2859)

* config.h.in, configure, configure.ac, plugins/sudoers/getspwuid.c:

  Remove HP-UX 9 support, it is not modern enough for sudo.
  [[b56bce312]](https://git.sudo.ws/sudo/commit/?id=b56bce312)

* config.h.in, configure, configure.ac, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/getspwuid.c:

  Remove Ultrix support, modern sudo can’t run on Ultrix anyway.
  [[9d11b725c]](https://git.sudo.ws/sudo/commit/?id=9d11b725c)

* MANIFEST, configure, configure.ac, lib/util/sudo\_conf.c,
  src/Makefile.in, src/exec\_common.c, src/regress/noexec/check\_noexec.c,
  src/sudo\_exec.h:

  Add regress for noexec functionality
  [[66af45eb2]](https://git.sudo.ws/sudo/commit/?id=66af45eb2)

* src/Makefile.in:

  Unbreak sudo\_noexec on macOS where shared libraries and dynamic modules
  are different. We still want to install sudo\_noexec.so without the “lib”
  prefix so some hackery is required.
  [[068f96a21]](https://git.sudo.ws/sudo/commit/?id=068f96a21)

* configure, configure.ac:

  Don’t enable noexec for AIX 5.0-5.2, we need 5.3 and above.
  [[60bf13945]](https://git.sudo.ws/sudo/commit/?id=60bf13945)

2016-11-13 Todd C. Miller

* src/Makefile.in:

  Need to link sudo\_noexec.so with -ldl for dlsym() on some platforms.
  Otherwise, the wordexp(3) wrapper will fail due to an undefined symbol.
  [Bug #761](https://bugzilla.sudo.ws/show_bug.cgi?id=761)
  [[07cc9d815]](https://git.sudo.ws/sudo/commit/?id=07cc9d815)

* plugins/sudoers/visudo.c:

  In strict mode, go to the file/line with an undefined aliases or aliases
  cycle directly.
  [[deb625976]](https://git.sudo.ws/sudo/commit/?id=deb625976)

2016-11-12 Todd C. Miller

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in,
  plugins/sudoers/alias.c, plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/parse.h, plugins/sudoers/regress/visudo/test2.err.ok,
  plugins/sudoers/regress/visudo/test3.err.ok, plugins/sudoers/visudo.c:

  Store the file/lineno for alias and userspec entries so we can provide
  that info if there is an error.
  [[7524c231c]](https://git.sudo.ws/sudo/commit/?id=7524c231c)

2016-11-11 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/rcstr.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/visudo.c,
  plugins/sudoers/visudo\_json.c:

  Add simple reference-counted string allocator and use it for passing
  around references to the sudoers path. This lets us avoid making copies
  of the sudoers path for the errorfile as well as each Defaults entry.
  [[90995c0ac]](https://git.sudo.ws/sudo/commit/?id=90995c0ac)

* lib/util/sha2.c:

  Cast len from size\_t to uint64\_t before bit shifting since we are adding
  to count which is also uint64\_t. Quiets a PVS-Studio warning.
  [[b5e3a7aef]](https://git.sudo.ws/sudo/commit/?id=b5e3a7aef)

2016-11-10 Todd C. Miller

* MANIFEST, plugins/sudoers/regress/visudo/test7.out.ok,
  plugins/sudoers/regress/visudo/test7.sh,
  plugins/sudoers/regress/visudo/test8.err.ok,
  plugins/sudoers/regress/visudo/test8.out.ok,
  plugins/sudoers/regress/visudo/test8.sh:

  Add checks for sudoers\_locale early Defaults
  [[52e136863]](https://git.sudo.ws/sudo/commit/?id=52e136863)

2016-11-09 Todd C. Miller

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/parser/check\_fill.c, plugins/sudoers/sssd.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c,
  plugins/sudoers/visudo\_json.c:

  Go back to parsing Defaults entries in update\_defaults instead of as
  sudoers is read. Otherwise, we cannot properly support early defaults
  like sudoers\_locale.
  [[79ca75280]](https://git.sudo.ws/sudo/commit/?id=79ca75280)

2016-11-10 Todd C. Miller

* src/parse\_args.c, src/sudo.c, src/sudo.h:

  Add the argument vector allocated for -s and -i mode to the garbage
  collector list. Avoids an ASAN warning on exit when the -s or -i flags
  are used.
  [[efe957544]](https://git.sudo.ws/sudo/commit/?id=efe957544)

2016-11-09 Todd C. Miller

* plugins/sudoers/iolog.c:

  add missing sudo\_pw\_delref/sudo\_gr\_delref to plug memory leak
  [[cefcb6f50]](https://git.sudo.ws/sudo/commit/?id=cefcb6f50)

* mkpkg:

  Use expr instead of POSIX sh numerical expression to avoid a syntax
  error on older shells.
  [[dbf07431d]](https://git.sudo.ws/sudo/commit/?id=dbf07431d)

2016-11-08 Todd C. Miller

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h:

  Bump plugin minor version to 10 for sudo\_mode, sudo\_group and sudo\_user.
  [[541ffbeec]](https://git.sudo.ws/sudo/commit/?id=541ffbeec)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Fix a bug in host matching where a negated sudoHost entry would prevent
  other sudoHosts following it from matching.
  [[17868f89d]](https://git.sudo.ws/sudo/commit/?id=17868f89d)

* plugins/sudoers/defaults.c:

  Zero out sd\_un before calling parse\_default() so we don’t try to free
  stack garbage in the ldap/sssd backends.
  [[1d9b8ca32]](https://git.sudo.ws/sudo/commit/?id=1d9b8ca32)

2016-11-07 Todd C. Miller

* plugins/sudoers/ldap.c:

  Use “ret”, not “rc” for the function return value.
  [[738c3cbf3]](https://git.sudo.ws/sudo/commit/?id=738c3cbf3)

* include/sudo\_compat.h, lib/util/strtomode.c, plugins/sudoers/defaults.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/logging.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/timestamp.c, plugins/sudoers/visudo.c, src/sesh.c,
  src/sudo.c, src/sudo\_edit.c:

  Use sys/stat.h defines instead of bare octal values.
  [[8133cdfdf]](https://git.sudo.ws/sudo/commit/?id=8133cdfdf)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/iolog.c, plugins/sudoers/policy.c:

  Pass iolog mode, group and user from policy plugin to I/O log plugin.
  [[2b020c9f1]](https://git.sudo.ws/sudo/commit/?id=2b020c9f1)

2016-11-06 Todd C. Miller

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/parse.h, plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/sssd.c:

  Instead of parsing sudoers Defaults twice, parse once while reading
  sudoers and then just set the parsed value in update\_defaults().
  [[df8404dbd]](https://git.sudo.ws/sudo/commit/?id=df8404dbd)

* plugins/sudoers/defaults.c:

  Use “struct defaults \*d” instead of “struct defaults \*def” throughout
  for consistency and to avoid confusino with “struct def\_values *def”.
  Use “str” not “var” for the string argument to convert and store in
  sd\_un for the store\_* functions.
  [[1f2410896]](https://git.sudo.ws/sudo/commit/?id=1f2410896)

* plugins/sudoers/parse.c:

  In display\_bound\_defaults() rename dtype arg -> deftype.
  [[4ca0838ba]](https://git.sudo.ws/sudo/commit/?id=4ca0838ba)

2016-11-03 Todd C. Miller

* lib/util/regress/sudo\_conf/test4.err.ok,
  lib/util/regress/sudo\_conf/test5.err.ok,
  plugins/sudoers/regress/visudo/test2.err.ok,
  plugins/sudoers/regress/visudo/test3.err.ok:

  Update error output to match quoting changes.
  [[f3c7e0f83]](https://git.sudo.ws/sudo/commit/?id=f3c7e0f83)

* plugins/sudoers/defaults.c:

  Avoid passing in a struct sudo\_defs\_types pointer to the store
  functions. Pass in a pointer to the union to fill instead.
  [[4f532dcc5]](https://git.sudo.ws/sudo/commit/?id=4f532dcc5)

* plugins/sudoers/defaults.h:

  no longer need struct defaults forward referebce
  [[3c28810fe]](https://git.sudo.ws/sudo/commit/?id=3c28810fe)

2016-11-02 Todd C. Miller

* lib/util/sudo\_conf.c, plugins/sudoers/alias.c,
  plugins/sudoers/defaults.c, plugins/sudoers/logging.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/visudo.c,
  plugins/sudoers/visudo\_json.c, src/load\_plugins.c:

  Use “double quotes” in messages instead of a combination of the accent
  (grave) mark and apostrophe.
  [[7c56179c7]](https://git.sudo.ws/sudo/commit/?id=7c56179c7)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/sssd.c:

  Add file:linenumber prefix to all Defaults warnings so we can see them
  when running sudo too. For LDAP/SSSD we print the sudoRole instead of
  the file name and omit the line number.
  [[75e29f163]](https://git.sudo.ws/sudo/commit/?id=75e29f163)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Use sudoedit in examples instead of “sudo vi”
  [[a9715211a]](https://git.sudo.ws/sudo/commit/?id=a9715211a)

2016-11-01 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c, plugins/sudoers/visudo\_json.c:

  Only treat an unknown Defaults entry as a parse error in visudo, not in
  sudo itself.
  [[f6ce83ea7]](https://git.sudo.ws/sudo/commit/?id=f6ce83ea7)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/visudo.c:

  Instead of checking Defaults values after the fact, check them at
  sudoers parse time. This makes it possible to display the file and line
  number with the problem and for visudo to go right to the error.
  [[8a4808518]](https://git.sudo.ws/sudo/commit/?id=8a4808518)

* plugins/sudoers/alias.c, plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/parse.h:

  Refactor freeing of a member\_list into free\_members().
  [[0aa216ed5]](https://git.sudo.ws/sudo/commit/?id=0aa216ed5)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  add\_defaults() now calls sudoerserror() itself instead of the caller
  assuming any error means out of member.
  [[9de491dc2]](https://git.sudo.ws/sudo/commit/?id=9de491dc2)

* plugins/sudoers/defaults.c, plugins/sudoers/mkdir\_parents.c:

  s/rval/ret/g – old habits die hard
  [[484b5718d]](https://git.sudo.ws/sudo/commit/?id=484b5718d)

2016-10-31 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Remove inaccurate XXX comment, sudo\_file\_parse() sends mail on parse
  error.
  [[2dbe50d1e]](https://git.sudo.ws/sudo/commit/?id=2dbe50d1e)

* plugins/sudoers/visudo.c:

  The fix for [Bug #408](https://bugzilla.sudo.ws/show_bug.cgi?id=408)
  broke editing of files in an include dir that have a syntax error.
  Normally, visudo does not edit those files, but if a syntax error is
  detected in one, the user gets a chance to fix it.
  [[b5f444111]](https://git.sudo.ws/sudo/commit/?id=b5f444111)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/sudoers.h, plugins/sudoers/visudo.c,
  plugins/sudoers/visudo\_json.c:

  Make a copy of the current sudoers path when assigning errorfile. Fixes
  a potential use after free in visudo when there is an error in one of
  the include files.
  [[5a8b60e4b]](https://git.sudo.ws/sudo/commit/?id=5a8b60e4b)

* plugins/sudoers/sudoers\_debug.c:

  sudoers\_debug\_register() was not setting the active debug instance to
  sudoers\_debug\_instance when called from the I/O log plugin. This is
  because it relied on sudo\_debug\_register to do that but
  sudoers\_debug\_parse\_flags() doesn’t set debug\_files[]
  sudoers\_debug\_instance is already set (we can only init sudoers debug
  once).

  To work around this, just make sudoers\_debug\_instance the active debug
  instance in sudoers\_debug\_register() when it is already set.
  [[a3a545e41]](https://git.sudo.ws/sudo/commit/?id=a3a545e41)

* src/load\_plugins.c:

  Fix pasto when setting I/O plugin debug files
  [[e8af335eb]](https://git.sudo.ws/sudo/commit/?id=e8af335eb)

* plugins/sudoers/iolog.c:

  use cp instead of \*cur when comparing against plugin\_path
  [[1fdcce7fa]](https://git.sudo.ws/sudo/commit/?id=1fdcce7fa)

2016-10-30 Todd C. Miller

* plugins/sudoers/mkdir\_parents.c:

  In sudo\_mkdir\_parents() inherit the gid of / instead of using gid 0 for
  the first component.
  [[9f903d3bd]](https://git.sudo.ws/sudo/commit/?id=9f903d3bd)

* plugins/sudoers/iolog.c:

  We want to inherit the gid from the parent directory when not setting
  permissions on intermerdiate directories.
  [[cf707cf5f]](https://git.sudo.ws/sudo/commit/?id=cf707cf5f)

2016-10-29 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/iolog.c,
  plugins/sudoers/mkdir\_parents.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/timestamp.c:

  Move io\_mkdir\_parents() to its own file and use it in ts\_mkdirs().
  [[bf62530ac]](https://git.sudo.ws/sudo/commit/?id=bf62530ac)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/iolog.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Make the I/O log file/dir permissions and owner configurable.
  [[271a07ff0]](https://git.sudo.ws/sudo/commit/?id=271a07ff0)

* lib/util/Makefile.in, mkdep.pl:

  Add vsyslog.lo
  [[b058ac529]](https://git.sudo.ws/sudo/commit/?id=b058ac529)

* configure, configure.ac:

  sudo 1.8.19
  [[43bf2fdb9]](https://git.sudo.ws/sudo/commit/?id=43bf2fdb9)

2016-10-28 Todd C. Miller

* plugins/sudoers/defaults.c:

  Don’t try to syntax check an unrecognized Defaults value in visudo.
  [[3423d0af7]](https://git.sudo.ws/sudo/commit/?id=3423d0af7)

2016-10-26 Todd C. Miller

* plugins/sudoers/iolog.c:

  Create I/O log files with the same gid as the parent directory.
  [[7122a733a]](https://git.sudo.ws/sudo/commit/?id=7122a733a)

* plugins/sudoers/ldap.c:

  Check for sudo\_ldap\_result\_last\_search() returning NULL. This can’t
  happen in practice because we always call sudo\_ldap\_result\_add\_search()
  first which guarantees there is a result to be found. Quiets a
  PVS-Studio warning.
  [[a40110756]](https://git.sudo.ws/sudo/commit/?id=a40110756)

* src/exec\_pty.c:

  Quiet a PVS-Studio warning about the spin loop when waiting for the
  parent to assign us the terminal pgrp.
  [[5a7936209]](https://git.sudo.ws/sudo/commit/?id=5a7936209)

* plugins/sudoers/env.c:

  Fix incorrect strncmp() lengths. The check for USERNAME was only looking
  at the first 5 characters (copy and paste error). The check for SUDO\_PS1
  was not checking the trailing ‘=’ character (off by one error). Found by
  PVS-Studio.
  [[dbd525279]](https://git.sudo.ws/sudo/commit/?id=dbd525279)

* plugins/sudoers/env.c:

  When checking for old-style bash functions in the environment, check for
  values starting with “() " (note the trailing space) rather than “()”.
  Bash will only treat the value as a function if the space after “()” is
  present. The trailing space was already present in the compare string
  but when it was added, the length passed to strncmp() was not updated
  from 3 to 4. Found by PVS-Studio. No security impact.
  [[4c8988d48]](https://git.sudo.ws/sudo/commit/?id=4c8988d48)

* plugins/sudoers/set\_perms.c:

  Add some missing casts from uid\_t/gid\_t to int when printing uid/gid
  values. We print these as signed so a value of -1 (no change) is
  obvious. Quiets PVS-Studio warnings.
  [[63adb21ce]](https://git.sudo.ws/sudo/commit/?id=63adb21ce)

* plugins/sudoers/timestamp.c:

  def\_timestamp\_timeout is a double so compare against 0.0 not 0 to avoid
  making it appear to be an integer type.
  [[cf5a12c09]](https://git.sudo.ws/sudo/commit/?id=cf5a12c09)

* plugins/sudoers/defaults.c:

  When checking syslog facility or priority, move the string compare into
  the body of the loop and return if it matches. If we finish the loop it
  means we didn’t find a match. This makes the code a little bit more
  readable.
  [[e3825cbed]](https://git.sudo.ws/sudo/commit/?id=e3825cbed)

* lib/util/strlcpy.c, lib/util/strnlen.c, plugins/sudoers/defaults.c,
  plugins/sudoers/env.c, plugins/sudoers/logging.c,
  plugins/sudoers/visudo\_json.c, src/env\_hooks.c, src/exec\_pty.c:

  Replace bare “;” in the body of for() loops with “continue;” for
  improved readability.
  [[fc1b4155d]](https://git.sudo.ws/sudo/commit/?id=fc1b4155d)

2016-10-21 Todd C. Miller

* config.guess, config.sub:

  Update from <http://git.savannah.gnu.org/gitweb/?p=config.git>
  [[f9d677775]](https://git.sudo.ws/sudo/commit/?id=f9d677775)

* config.guess, config.sub, configure, ltmain.sh, m4/libtool.m4,
  m4/ltoptions.m4, m4/ltsugar.m4, m4/ltversion.m4, m4/lt~obsolete.m4:

  Update to libtool 2.4.6
  [[17d873458]](https://git.sudo.ws/sudo/commit/?id=17d873458)

2016-10-19 Todd C. Miller

* lib/util/vsyslog.c:

  Use a static buffer if possible.
  [[d078450fb]](https://git.sudo.ws/sudo/commit/?id=d078450fb)

* MANIFEST, configure, configure.ac, include/sudo\_compat.h,
  lib/util/vsyslog.c, plugins/sudoers/logging.c:

  add vsyslog() for systems without it.
  [[19c96da44]](https://git.sudo.ws/sudo/commit/?id=19c96da44)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  There are now 14 tag values, not 10. Don’t bother mentioning the number
  since it keeps increasing. [Bug
  #759](https://bugzilla.sudo.ws/show_bug.cgi?id=759)
  [[6fa59b741]](https://git.sudo.ws/sudo/commit/?id=6fa59b741)

2016-10-18 Todd C. Miller

* config.h.in, configure, configure.ac, plugins/sudoers/logging.c:

  Use vsyslog() if available.
  [[c18ff022e]](https://git.sudo.ws/sudo/commit/?id=c18ff022e)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/logging.c:

  Add syslog\_maxlen to control the max size of syslog messages.
  [[44c2679f8]](https://git.sudo.ws/sudo/commit/?id=44c2679f8)

2016-10-17 Todd C. Miller

* src/tgetpass.c:

  Don’t generate SIGTOU when restoring the terminal modes. It doen’t make
  sense to suspend the process only to restore the terminal settings since
  in this case the shell has already taken ownership of the tty.
  [[f632e0a63]](https://git.sudo.ws/sudo/commit/?id=f632e0a63)

* plugins/sudoers/sudoreplay.c, src/exec\_pty.c, src/tgetpass.c:

  The flush parameter of sudo\_term\_restore() is bool, not int.
  [[9b886f6b2]](https://git.sudo.ws/sudo/commit/?id=9b886f6b2)

2016-10-14 Todd C. Miller

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  Add wordexp() to the list of functions wrapped by sudo\_noexec.so.
  [[afcdc2853]](https://git.sudo.ws/sudo/commit/?id=afcdc2853)

2016-10-10 Todd C. Miller

* src/sudo\_noexec.c:

  Need RTLD\_NEXT for wordexp() on dlopen() systems. It is missing on AIX
  5.1 at least.
  [[ddbbcb944]](https://git.sudo.ws/sudo/commit/?id=ddbbcb944)

* src/sudo\_noexec.c:

  add missing guard around wordexp()
  [[9dbd45ff6]](https://git.sudo.ws/sudo/commit/?id=9dbd45ff6)

* NEWS:

  expand on 1.8.18p1 changes
  [[bea34c9e6]](https://git.sudo.ws/sudo/commit/?id=bea34c9e6)

2016-10-09 Todd C. Miller

* NEWS, configure, configure.ac:

  sudo 1.8.18p1
  [[45b396598]](https://git.sudo.ws/sudo/commit/?id=45b396598)

* config.h.in, configure, configure.ac, src/sudo\_noexec.c:

  Fix configure check for seccomp filter on Linux
  [[8e49ce07f]](https://git.sudo.ws/sudo/commit/?id=8e49ce07f)

2016-10-08 Todd C. Miller

* config.h.in, configure, configure.ac, src/sudo\_noexec.c:

  Use a seccomp filter on Linux to disable execve(2) and execveat(2). This
  still relies on LD\_PRELOAD to work so it has the same issues as the
  existing mether with respect to running 32-bit binaries on a 64-bit
  kernel.
  [[237e2f964]](https://git.sudo.ws/sudo/commit/?id=237e2f964)

* src/Makefile.in:

  regen
  [[d24b9246a]](https://git.sudo.ws/sudo/commit/?id=d24b9246a)

* plugins/sudoers/Makefile.in:

  regen
  [[b5f1d4e25]](https://git.sudo.ws/sudo/commit/?id=b5f1d4e25)

2016-10-05 Todd C. Miller

* aclocal.m4, config.h.in, configure, configure.ac, src/sudo\_noexec.c:

  Wrap wordexp(3) in sudo\_noexec.
  [[d0ccd947d]](https://git.sudo.ws/sudo/commit/?id=d0ccd947d)

2016-09-26 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Clean .json files created by “make check”
  [[96580de20]](https://git.sudo.ws/sudo/commit/?id=96580de20)

2016-09-19 Todd C. Miller

* po/ca.mo, po/da.mo, po/eo.mo, po/es.mo, po/eu.mo, po/fi.mo, po/gl.mo,
  po/hr.mo, po/hu.mo, po/ko.mo, po/nl.mo, po/ru.mo, po/sk.mo, po/sl.mo,
  po/sr.mo, po/tr.mo:

  recompile .po files
  [[90e4538c0]](https://git.sudo.ws/sudo/commit/?id=90e4538c0)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Fix matching when no sudoRunAsUser is present in a sudoRole. If only a
  sudoRunAsGroup is present, match on the invoking user if the -g option
  was specified and the group matched. If no sudoRunAsGroup is present and
  the -g option was specified, allow it if it matches the passwd gid of
  the runas user. This matches the behavior of the sudoers backend.
  [[0a68d6799]](https://git.sudo.ws/sudo/commit/?id=0a68d6799)

* plugins/sudoers/match.c:

  runas\_pw can no longer be NULL
  [[1bccd1418]](https://git.sudo.ws/sudo/commit/?id=1bccd1418)

2016-09-15 Todd C. Miller

* NEWS:

  RunAsGroup without RunAsUser issues
  [[25f90b481]](https://git.sudo.ws/sudo/commit/?id=25f90b481)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  user\_matched and group\_matched must be type int, not bool
  [[9a55c0c25]](https://git.sudo.ws/sudo/commit/?id=9a55c0c25)

* plugins/sudoers/ldap.c, plugins/sudoers/match.c,
  plugins/sudoers/parse.h, plugins/sudoers/sssd.c:

  Use RUNAS\_USER\_SPECIFIED and RUNAS\_GROUP\_SPECIFIED when deciding whether
  to check runas user/group instead of checking runas\_pw or runas\_gr.
  [[b165a5ff7]](https://git.sudo.ws/sudo/commit/?id=b165a5ff7)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  When matching against runas\_default use userpw\_matches() instead of just
  strcasecmp().
  [[0ff95dfaa]](https://git.sudo.ws/sudo/commit/?id=0ff95dfaa)

* plugins/sudoers/testsudoers.c:

  Set RUNAS\_USER\_SPECIFIED when -u is specified and/or
  RUNAS\_GROUP\_SPECIFIED when -g is specified.
  [[a750bebf1]](https://git.sudo.ws/sudo/commit/?id=a750bebf1)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Fix printing of the default runas user when a RunAsGroup is specified
  but no RunAsUser is present.
  [[d64153967]](https://git.sudo.ws/sudo/commit/?id=d64153967)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Only match against runas\_default if both sudoRunAsUser and
  sudoRunAsGroup are missing.
  [[fb32867e4]](https://git.sudo.ws/sudo/commit/?id=fb32867e4)

* plugins/sudoers/match.c:

  runas\_pw can no longer be NULL here
  [[d2af18c1f]](https://git.sudo.ws/sudo/commit/?id=d2af18c1f)

* plugins/sudoers/ldap.c, plugins/sudoers/match.c,
  plugins/sudoers/parse.h, plugins/sudoers/sssd.c:

  Update check for whether or not the runas user was set in the ldap and
  sssd backends to match the sudoers file backend. Introduces the
  runas\_user\_set() macro to improve readability. Previously, runas\_pw was
  set late, now it is set before checking sudoers.
  [[ef82f792a]](https://git.sudo.ws/sudo/commit/?id=ef82f792a)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  Document that negated sudoHosts are only supported by 1.8.18 and higher.
  [[db7ce3c21]](https://git.sudo.ws/sudo/commit/?id=db7ce3c21)

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/testsudoers/test4.sh,
  plugins/sudoers/regress/testsudoers/test5.sh:

  Disable Address Sanitizer leak detection for tests which generate parse
  errors. The parser leaks a bit on error.
  [[50d0191de]](https://git.sudo.ws/sudo/commit/?id=50d0191de)

* plugins/sudoers/sssd.c:

  Fix underflow in get\_ipa\_hostname() when trimming trailing whitespace.
  [[37099a6e7]](https://git.sudo.ws/sudo/commit/?id=37099a6e7)

2016-09-14 Todd C. Miller

* NEWS:

  Document negated sudoHost entries.
  [[394485f27]](https://git.sudo.ws/sudo/commit/?id=394485f27)

* plugins/sudoers/sssd.c:

  Support negated sudoHost entries.
  [[ff753d1e1]](https://git.sudo.ws/sudo/commit/?id=ff753d1e1)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  Document negated sudoHost entries.
  [[7fd6edb6d]](https://git.sudo.ws/sudo/commit/?id=7fd6edb6d)

* plugins/sudoers/ldap.c:

  Support negated sudoHost entries.
  [[f51fbfa40]](https://git.sudo.ws/sudo/commit/?id=f51fbfa40)

2016-09-13 Todd C. Miller

* plugins/sudoers/match.c:

  Don’t check the username when matching a host netgroup unless
  def\_netgroup\_tuple is enabled.
  [[ca2a1f310]](https://git.sudo.ws/sudo/commit/?id=ca2a1f310)

* plugins/sudoers/match.c:

  Move valid domain name check into a new valid\_domain() function. Fix
  memory leak if getdomainname(2) fails and avoid using heap garbage for
  the domain name matching in this case.
  [[c73dec723]](https://git.sudo.ws/sudo/commit/?id=c73dec723)

2016-09-12 Todd C. Miller

* plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po, po/it.mo, po/it.po:

  sync with translationproject.org
  [[7687dd652]](https://git.sudo.ws/sudo/commit/?id=7687dd652)

2016-09-11 Todd C. Miller

* src/exec\_pty.c:

  Add back line mistakenly removed in 0cf2a9351740
  [[533c9ce10]](https://git.sudo.ws/sudo/commit/?id=533c9ce10)

* plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po, po/nb.mo, po/nb.po:

  sync with translationproject.org
  [[86ce2f89f]](https://git.sudo.ws/sudo/commit/?id=86ce2f89f)

2016-09-09 Todd C. Miller

* NEWS:

  [Bug #757](https://bugzilla.sudo.ws/show_bug.cgi?id=757)
  [[f7bd14f70]](https://git.sudo.ws/sudo/commit/?id=f7bd14f70)

* plugins/sudoers/sudoers.c:

  Fix typo that broke short host name matching when the fqdn flag is
  enabled. [Bug #757](https://bugzilla.sudo.ws/show_bug.cgi?id=757)
  [[ead485b96]](https://git.sudo.ws/sudo/commit/?id=ead485b96)

2016-09-08 Todd C. Miller

* include/sudo\_debug.h, lib/util/aix.c, lib/util/fnmatch.c,
  lib/util/getgrouplist.c, lib/util/secure\_path.c, lib/util/setgroups.c,
  lib/util/strtoid.c, lib/util/sudo\_conf.c, lib/util/sudo\_debug.c,
  plugins/sample/sample\_plugin.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/check.c, plugins/sudoers/env.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/interfaces.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/logging.c, plugins/sudoers/match.c,
  plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/visudo.c, plugins/sudoers/visudo\_json.c,
  src/env\_hooks.c, src/exec.c, src/exec\_pty.c, src/get\_pty.c, src/hooks.c,
  src/load\_plugins.c, src/regress/ttyname/check\_ttyname.c, src/selinux.c,
  src/signal.c, src/sudo.c, src/sudo\_edit.c, src/tgetpass.c,
  src/ttyname.c, src/utmp.c:

  Be consistent with the naming of the variable used to store the function
  return value. Previously, some code used “rval”, some used “ret”. This
  standardizes on “ret” and uses “rc” for temporary return codes.
  [[3f022419a]](https://git.sudo.ws/sudo/commit/?id=3f022419a)

2016-09-07 Todd C. Miller

* plugins/sudoers/po/ca.po, plugins/sudoers/po/cs.mo,
  plugins/sudoers/po/cs.po, plugins/sudoers/po/da.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/el.po, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/eu.po, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/fr.po, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/hu.po, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/ko.po, plugins/sudoers/po/lt.po,
  plugins/sudoers/po/nb.po, plugins/sudoers/po/nl.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/ru.po, plugins/sudoers/po/sk.po,
  plugins/sudoers/po/sl.po, plugins/sudoers/po/sr.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/tr.po, plugins/sudoers/po/uk.mo,
  plugins/sudoers/po/uk.po, plugins/sudoers/po/vi.mo,
  plugins/sudoers/po/vi.po, plugins/sudoers/po/zh\_CN.mo,
  plugins/sudoers/po/zh\_CN.po, po/ca.po, po/cs.mo, po/cs.po, po/da.po,
  po/de.mo, po/de.po, po/eo.po, po/es.po, po/eu.po, po/fi.po, po/fr.mo,
  po/fr.po, po/gl.po, po/hr.po, po/hu.po, po/it.po, po/ja.mo, po/ja.po,
  po/ko.po, po/nb.po, po/nl.po, po/pl.mo, po/pl.po, po/pt\_BR.mo,
  po/pt\_BR.po, po/ru.po, po/sk.po, po/sl.po, po/sr.po, po/sv.mo, po/sv.po,
  po/tr.po, po/uk.mo, po/uk.po, po/vi.mo, po/vi.po, po/zh\_CN.mo,
  po/zh\_CN.po:

  sync with translationproject.org
  [[33fb814e8]](https://git.sudo.ws/sudo/commit/?id=33fb814e8)

* MANIFEST, NEWS, doc/CONTRIBUTORS, po/nn.mo, po/nn.po:

  Norwegian Nynorsk translation of sudo from translationproject.org
  [[6eb1b8c7e]](https://git.sudo.ws/sudo/commit/?id=6eb1b8c7e)

* NEWS:

  Fix for [Bug #756](https://bugzilla.sudo.ws/show_bug.cgi?id=756)
  [[fc7e2a98f]](https://git.sudo.ws/sudo/commit/?id=fc7e2a98f)

2016-09-05 Todd C. Miller

* plugins/sudoers/sudoers.c:

  In sudoers\_main() avoid setting rval prematurely. Prevents a crash when
  auditing fails after successfully authenticating. [Bug
  #756](https://bugzilla.sudo.ws/show_bug.cgi?id=756)
  [[b80309e6d]](https://git.sudo.ws/sudo/commit/?id=b80309e6d)

* plugins/sudoers/defaults.c:

  Apply match\_group\_by\_gid early.
  [[43084d8f9]](https://git.sudo.ws/sudo/commit/?id=43084d8f9)

2016-09-02 Todd C. Miller

* NEWS:

  update
  [[0181bf2c2]](https://git.sudo.ws/sudo/commit/?id=0181bf2c2)

* src/ttyname.c:

  Don’t disable large file support for Linux, just SVR4-style /proc.
  Otherwise, stat(2) may fail on Linux when running a 32-bit sudo on a
  64-bit machine. [Bug #755](https://bugzilla.sudo.ws/show_bug.cgi?id=755)
  [[40d0ecc7d]](https://git.sudo.ws/sudo/commit/?id=40d0ecc7d)

2016-09-01 Todd C. Miller

* include/sudo\_util.h:

  Make sudo\_parseln() flags hex to make it more obvious that they are bit
  flags.
  [[5b86d2d29]](https://git.sudo.ws/sudo/commit/?id=5b86d2d29)

* plugins/sudoers/env.c:

  Don’t try to support line continuation in /etc/environment.
  [[881814c9f]](https://git.sudo.ws/sudo/commit/?id=881814c9f)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  plugins/sudoers/ldap.c:

  No line continuation support in ldap.conf.
  [[c0db5c123]](https://git.sudo.ws/sudo/commit/?id=c0db5c123)

* include/sudo\_util.h, lib/util/parseln.c:

  Add flag to sudo\_parseln() to disable line continuation support.
  [[2a4ba64c8]](https://git.sudo.ws/sudo/commit/?id=2a4ba64c8)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  A comment character (’#’) is only special at the beginning of the line.
  [[852fe25bc]](https://git.sudo.ws/sudo/commit/?id=852fe25bc)

* include/sudo\_util.h, lib/util/parseln.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c, lib/util/sudo\_conf.c,
  lib/util/util.exp.in, plugins/sudoers/env.c, plugins/sudoers/ldap.c,
  plugins/sudoers/sudo\_nss.c:

  Add a flags option to sudo\_parseln() and a flag to only mach comments at
  the beginning of the line. Use the flag when parsing ldap.conf.
  [[17ad75d50]](https://git.sudo.ws/sudo/commit/?id=17ad75d50)

* src/sudo.c:

  If get\_process\_ttyname() fails for errno != ENOENT, just warn instead of
  making it a fatal error. [Bug
  #755](https://bugzilla.sudo.ws/show_bug.cgi?id=755)
  [[04340eea6]](https://git.sudo.ws/sudo/commit/?id=04340eea6)

2016-08-31 Todd C. Miller

* plugins/sudoers/mkdefaults:

  use strict
  [[c9572db75]](https://git.sudo.ws/sudo/commit/?id=c9572db75)

* plugins/sudoers/def\_data.h, plugins/sudoers/mkdefaults:

  Define def\_foo in terms of the I\_FOO index instead of a bare number.
  [[7a54b49fc]](https://git.sudo.ws/sudo/commit/?id=7a54b49fc)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po:

  sync with translationproject.org
  [[8ee6f0d1d]](https://git.sudo.ws/sudo/commit/?id=8ee6f0d1d)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Mention that match\_group\_by\_gid has no effect when sudoers is stored in
  LDAP.
  [[dba28a945]](https://git.sudo.ws/sudo/commit/?id=dba28a945)

* include/sudo\_compat.h, src/sudo.c:

  Use W\_EXITCODE to construct the wait status if sudo could not execute
  the command. Fixes the sudo exit value for exec(3) failure.
  [[e147ba1fe]](https://git.sudo.ws/sudo/commit/?id=e147ba1fe)

* src/exec.c:

  fix brace style
  [[a9570e64f]](https://git.sudo.ws/sudo/commit/?id=a9570e64f)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[b610137ef]](https://git.sudo.ws/sudo/commit/?id=b610137ef)

* src/sudo.c:

  It is possible for get\_user\_info() to fail for reasons other than ENOMEM
  so print the warning message there rather than in main().
  [[ef4e80810]](https://git.sudo.ws/sudo/commit/?id=ef4e80810)

2016-08-30 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  match\_group\_by\_gid is only available in sudo 1.8.18 and above
  [[edcb137f6]](https://git.sudo.ws/sudo/commit/?id=edcb137f6)

* doc/UPGRADE:

  Mention match\_group\_by\_gid
  [[7aeb11a92]](https://git.sudo.ws/sudo/commit/?id=7aeb11a92)

* NEWS, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document match\_group\_by\_gid
  [[c57979bfb]](https://git.sudo.ws/sudo/commit/?id=c57979bfb)

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/pwutil.c:

  Add match\_group\_by\_gid Defaults option to allow sites with slow group
  lookups and a small number of groups in sudoers to match groups by group
  ID instead of by group name.
  [[9cfd55685]](https://git.sudo.ws/sudo/commit/?id=9cfd55685)

2016-08-29 Todd C. Miller

* NEWS:

  Mention “sudo -l command” bug fix.
  [[12ab1383a]](https://git.sudo.ws/sudo/commit/?id=12ab1383a)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Fix “sudo -l command” in the LDAP and SSS backends when the command is
  not allowed.
  [[5b51b7f11]](https://git.sudo.ws/sudo/commit/?id=5b51b7f11)

2016-08-26 Todd C. Miller

* plugins/sudoers/defaults.c:

  Use sudo\_strsplit() instead of doing the equivalent manually.
  [[7918f7e7e]](https://git.sudo.ws/sudo/commit/?id=7918f7e7e)

2016-08-25 Todd C. Miller

* NEWS:

  Move SIGPIPE bug fix to 1.8.18 where it belongs
  [[c50b83525]](https://git.sudo.ws/sudo/commit/?id=c50b83525)

* plugins/sudoers/defaults.c:

  Fix memset size typo in previous commit.
  [[a246c9570]](https://git.sudo.ws/sudo/commit/?id=a246c9570)

* plugins/sudoers/regress/visudo/test6.out.ok,
  plugins/sudoers/regress/visudo/test6.sh:

  Add regress for check\_defaults() use-after-free bug.
  [[c5cfc9584]](https://git.sudo.ws/sudo/commit/?id=c5cfc9584)

* MANIFEST, plugins/sudoers/defaults.c:

  Fix use-after-free in check\_defaults(), reported by Radovan Sroka of
  RedHat.
  [[99b969979]](https://git.sudo.ws/sudo/commit/?id=99b969979)

2016-08-24 Todd C. Miller

* NEWS:

  SIGPIPE bug fix
  [[403b904ab]](https://git.sudo.ws/sudo/commit/?id=403b904ab)

* src/signal.c:

  Now that we ignore SIGPIPE in sudo we need to restore it at exec time.
  Problem reported by Radovan Sroka of RedHat.
  [[7625f0684]](https://git.sudo.ws/sudo/commit/?id=7625f0684)

2016-08-22 Todd C. Miller

* mkpkg:

  Fix appending to make\_opts
  [[d54148bbd]](https://git.sudo.ws/sudo/commit/?id=d54148bbd)

* NEWS:

  Add [Bug #753](https://bugzilla.sudo.ws/show_bug.cgi?id=753) and fix
  reference to Bug #752.
  [[5a432b961]](https://git.sudo.ws/sudo/commit/?id=5a432b961)

2016-08-21 Todd C. Miller

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po, po/da.mo, po/da.po,
  po/pt\_BR.mo, po/pt\_BR.po:

  sync with translationproject.org
  [[8d89d8395]](https://git.sudo.ws/sudo/commit/?id=8d89d8395)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen pot files
  [[ba91ebb14]](https://git.sudo.ws/sudo/commit/?id=ba91ebb14)

2016-08-17 Todd C. Miller

* NEWS:

  Update with logging changes.
  [[8f9869df7]](https://git.sudo.ws/sudo/commit/?id=8f9869df7)

* plugins/sudoers/logging.c:

  Avoid duplicate warnings when we cannot write to the log file. Also send
  the warning in mail if possible.
  [[d8a65715d]](https://git.sudo.ws/sudo/commit/?id=d8a65715d)

* plugins/sudoers/iolog.c, src/exec\_pty.c, src/sudo.c, src/sudo.h:

  Move the ignoring of I/O log plugin errors into the I/O log plugin
  itself.
  [[3e4c7eed3]](https://git.sudo.ws/sudo/commit/?id=3e4c7eed3)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/iolog.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, src/exec\_pty.c, src/sudo.c, src/sudo.h:

  Make the behavior when we cannot write to a log or audit file
  configurable. File log failures are ignored by default for consistency
  with syslog. Audit errors are ignored by default to allow the admin to
  fix the issue. I/O log file errors are still fatal by default since if
  I/O logging is activated it is usually to have an audit trail. [Bug
  #751](https://bugzilla.sudo.ws/show_bug.cgi?id=751)
  [[ed18d0d5f]](https://git.sudo.ws/sudo/commit/?id=ed18d0d5f)

2016-08-15 Todd C. Miller

* plugins/sudoers/logging.c:

  Make sure we print an error message to stderr (and not just send mail)
  if do\_logfile() fails. [Bug
  #751](https://bugzilla.sudo.ws/show_bug.cgi?id=751)
  [[9ccd26084]](https://git.sudo.ws/sudo/commit/?id=9ccd26084)

2016-08-13 Todd C. Miller

* plugins/sudoers/pwutil.c:

  Separate out the supplemental group ID checks from the supplemental
  group name checks in user\_in\_group(). We now call sudo\_get\_gidlist()
  only when the group name in sudoers begins with a ‘#’ (which is seldom
  used).
  [[043b3d223]](https://git.sudo.ws/sudo/commit/?id=043b3d223)

* plugins/sudoers/ldap.c, plugins/sudoers/policy.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/pwutil.h,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Cache the user’s group IDs and group names separately and only resolve
  group IDs -> names when needed. If the sudoers file doesn’t contain
  groups we will no longer try to resolve all the user’s group IDs to
  names, which can be expensive on some systems.
  [[985ab1dd3]](https://git.sudo.ws/sudo/commit/?id=985ab1dd3)

2016-08-12 Todd C. Miller

* plugins/sudoers/defaults.c:

  Remove the “op” parameter from all the store\_foo() functions except
  store\_list() where it is actually needed. For the others, a NULL value
  indicates the setting was negated. This unconfuses static analyzers (and
  perhaps humans too).
  [[c3b8e97a6]](https://git.sudo.ws/sudo/commit/?id=c3b8e97a6)

* plugins/sudoers/defaults.c:

  Flags always have a NULL value. Regression introduced by refactor of
  set\_default\_entry().
  [[8c2b6fb34]](https://git.sudo.ws/sudo/commit/?id=8c2b6fb34)

* plugins/sudoers/defaults.c:

  Set rc to true when setting a flag Defaults value.
  [[1ca261c30]](https://git.sudo.ws/sudo/commit/?id=1ca261c30)

* src/utmp.c:

  suppress a cppcheck false positive
  [[25f39ff31]](https://git.sudo.ws/sudo/commit/?id=25f39ff31)

* plugins/sudoers/defaults.c:

  Refactor the error parts of set\_default\_entry() so the switch() is
  mostly just calls to store\_foo() functions. Avoids a lot of duplicated
  error checking and silences a cppcheck false positive.
  [[caf064e17]](https://git.sudo.ws/sudo/commit/?id=caf064e17)

* plugins/sudoers/defaults.c:

  In set\_default\_entry() check for unsupported Defaults type.
  [[9051c92cb]](https://git.sudo.ws/sudo/commit/?id=9051c92cb)

* lib/util/aix.c:

  Add missing break in switch that sets the max limit for RLIMIT\_NOFILE.
  Found by cppcheck.
  [[f17f9ba9b]](https://git.sudo.ws/sudo/commit/?id=f17f9ba9b)

* plugins/sudoers/defaults.c:

  Check sudoers\_initlocale return value and treat as oom. Coverity CID
  141832
  [[7ac77b094]](https://git.sudo.ws/sudo/commit/?id=7ac77b094)

2016-08-10 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/match.c, plugins/sudoers/parse.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c:

  Set runas\_pw early and adjust runaslist\_matches() to deal. Since we now
  set runas\_default early there is no need to call update\_defaults with
  SETDEF\_RUNAS after sudoers has been parsed.
  [[a08ea1b14]](https://git.sudo.ws/sudo/commit/?id=a08ea1b14)

2016-08-09 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/defaults.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c:

  Load sudoers group plugin via an early callback.
  [[56ead7388]](https://git.sudo.ws/sudo/commit/?id=56ead7388)

* sudo.pp:

  System Integrity Protection on Mac OS X won’t allow us to write directly
  to /etc or /var. We must install in /private/{etc,var} instead.
  [[a9973c2e6]](https://git.sudo.ws/sudo/commit/?id=a9973c2e6)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document that fqdn, runas\_default and sudoers\_locale are parsed early.
  [[d17bc132d]](https://git.sudo.ws/sudo/commit/?id=d17bc132d)

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo\_plugin.cat, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoreplay.cat, doc/visudo.cat:

  Regen for 1.8.18
  [[ac20b8ddf]](https://git.sudo.ws/sudo/commit/?id=ac20b8ddf)

2016-08-08 Todd C. Miller

* plugins/sudoers/defaults.h, plugins/sudoers/ldap.c,
  plugins/sudoers/sssd.c:

  Avoid passing around struct defaults when it is not needed. As a result,
  we no longer need to include gram.h in the LDAP and SSSD backends.
  [[9d94ee11c]](https://git.sudo.ws/sudo/commit/?id=9d94ee11c)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Instead of deferring setting early defaults until we have traversed the
  entire defaults list, just defer running the callbacks. Otherwise, if
  the last early default setting we see has a bad value we won’t set any
  defaults of that type even if there was an earlier one that was valid.
  [[0bf2d9b16]](https://git.sudo.ws/sudo/commit/?id=0bf2d9b16)

* plugins/sudoers/defaults.c:

  Run callbacks once in set\_default\_entry() instead of each of the
  store\_foo() functions.
  [[e5a7891ec]](https://git.sudo.ws/sudo/commit/?id=e5a7891ec)

2016-08-03 Todd C. Miller

* mkpkg:

  Use /proc/cpuinfo on Linux instead of running lscpu
  [[14c9d203e]](https://git.sudo.ws/sudo/commit/?id=14c9d203e)

* mkpkg:

  If using GNU make on a multi-cpu system, use the -j flag to run make
  jobs in parallel, up to the number of cpus/cores.
  [[820934082]](https://git.sudo.ws/sudo/commit/?id=820934082)

2016-07-31 Todd C. Miller

* plugins/sudoers/visudo.c:

  Only check SUDO\_USER if euid is 0
  [[54efa54c0]](https://git.sudo.ws/sudo/commit/?id=54efa54c0)

2016-07-30 Todd C. Miller

* plugins/sudoers/visudo.c:

  Initialize sudo\_user based on the SUDO\_USER environment variable if
  present. This allows things like :Defaults:username editor=foo” to work
  when visudo is run via sudo.
  [[f85e95329]](https://git.sudo.ws/sudo/commit/?id=f85e95329)

2016-07-28 Todd C. Miller

* src/exec\_pty.c:

  Add function name in “command resumed” debug message
  [[4352bb9ca]](https://git.sudo.ws/sudo/commit/?id=4352bb9ca)

* src/exec\_pty.c:

  If waitpid() returns 0 or -1, display a warning, this should never
  happen. Add a check for unhandled wait status (also should never
  happen).
  [[383debee9]](https://git.sudo.ws/sudo/commit/?id=383debee9)

* plugins/sudoers/defaults.c:

  Flag settings have a NULL value so we can’t use that to test whether an
  entry in struct early\_default is set or not. Add a “set” member and use
  that instead.
  [[2b150925d]](https://git.sudo.ws/sudo/commit/?id=2b150925d)

2016-07-27 Todd C. Miller

* src/exec\_pty.c:

  Explicitly check for a continued process with waitpid(2). Otherwise,
  waitpid() will return 0 when the command is resumed after being
  suspended, which we were treating the same as -1. Fixes suspend and
  resume on Linux and probably others.
  [[4f47a2ad7]](https://git.sudo.ws/sudo/commit/?id=4f47a2ad7)

* plugins/sudoers/defaults.c:

  Fix –with-fqdn, the value should be NULL since it is a flag.
  [[a014a2abd]](https://git.sudo.ws/sudo/commit/?id=a014a2abd)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Add support for early defaults to the ldap and sssd backends.
  [[16551031f]](https://git.sudo.ws/sudo/commit/?id=16551031f)

2016-07-25 Todd C. Miller

* src/sudo\_edit.c:

  Repair symlink check in sudo\_edit\_openat\_nofollow() on systems without
  O\_NOFOLLOW, it must be done relative to dfd. Previously the lstat()
  would always fail, possibly leading to a false positive. Also add an
  early symlink check like in sudo\_edit() while here.
  [[cc31c2b24]](https://git.sudo.ws/sudo/commit/?id=cc31c2b24)

* src/sudo\_edit.c:

  On systems that lack the O\_NOFOLLOW open(2) flag, check in
  sudo\_edit\_open() whether the path to be opened is symlink before opening
  it. This is racey but we detect losing the last post-open and it is
  better to fail early if possible. When editing a link to a non-existent
  file, a zero-length file will be left behind but it is too dangerous to
  try and remove it after the fact. [Bug
  #753](https://bugzilla.sudo.ws/show_bug.cgi?id=753)
  [[bf82b3f2b]](https://git.sudo.ws/sudo/commit/?id=bf82b3f2b)

* src/sudo\_edit.c:

  Update debug\_decl for sudo\_edit\_openat\_nofollow() Remove unused
  variables when O\_NOFOLLOW is not present.
  [[266357511]](https://git.sudo.ws/sudo/commit/?id=266357511)

2016-07-23 Todd C. Miller

* plugins/sudoers/defaults.c, plugins/sudoers/visudo.c:

  Split set\_default\_entry() out of set\_default() so we can call it from
  check\_defaults() to validate the defaults value. In visudo, suppress
  warnings from update\_defaults() and rely on check\_defaults() to provide
  warnings.
  [[2c21663b2]](https://git.sudo.ws/sudo/commit/?id=2c21663b2)

* plugins/sudoers/defaults.c:

  Split binding match code out of default\_type\_matches() into
  default\_binding\_matches(). We can now use default\_type\_matches() in
  check\_defaults().
  [[29d842dba]](https://git.sudo.ws/sudo/commit/?id=29d842dba)

* plugins/sudoers/visudo.c:

  Pass quiet flag to init\_parser() and update\_defaults() when doing first
  parse of sudoers.
  [[e0ac76647]](https://git.sudo.ws/sudo/commit/?id=e0ac76647)

2016-07-22 Todd C. Miller

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/ldap.c, plugins/sudoers/parse.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Update defaults in visudo after sudoers has been edited so we pick up
  locale changes. The init\_defaults() function will now re-init the
  sudoers locale.
  [[256ca993b]](https://git.sudo.ws/sudo/commit/?id=256ca993b)

2016-07-20 Todd C. Miller

* plugins/sudoers/testsudoers.c:

  Set sudoers locale before calling sudoersparse(). We don’t need to
  restore the user’s locale since warnings are displayed in the user’s
  locale anyway.
  [[65579b69e]](https://git.sudo.ws/sudo/commit/?id=65579b69e)

* plugins/sudoers/visudo.c:

  Set the locale to the sudoers locale when parsing and restore the user’s
  locale afterward. Also set the warn/fatal locale helper function so
  warning messages during a sudoers parse are displayed in the user’s own
  locale.
  [[ef24bd5c3]](https://git.sudo.ws/sudo/commit/?id=ef24bd5c3)

* plugins/sudoers/logging.h:

  Add forward decl of union sudo\_defs\_val to silence a gcc warning.
  [[6ba2769ba]](https://git.sudo.ws/sudo/commit/?id=6ba2769ba)

* plugins/sudoers/sudoers.c:

  Set the warn/fatal locale helper function in sudoers\_policy\_init() so
  warning messages during sudoers loading are displayed in the user’s own
  locale.
  [[e257f2c9e]](https://git.sudo.ws/sudo/commit/?id=e257f2c9e)

* plugins/sudoers/locale.c, plugins/sudoers/logging.h,
  plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Move sudoers locale callback function to locale.c and user it in visudo
  and testsudoers.
  [[b5c2ca2fe]](https://git.sudo.ws/sudo/commit/?id=b5c2ca2fe)

* plugins/sudoers/sudoers.c:

  In cb\_sudoers\_locale() actually set the locale in addition to storing
  its name. Otherwise, it won’t take effect until sudoers lookup time.
  [[30f7ecca1]](https://git.sudo.ws/sudo/commit/?id=30f7ecca1)

* plugins/sudoers/defaults.c:

  Fix regression that would cause early defaults entries to be set
  multiple times.
  [[684161618]](https://git.sudo.ws/sudo/commit/?id=684161618)

* NEWS, configure, configure.ac:

  sudo 1.8.18
  [[1349bb760]](https://git.sudo.ws/sudo/commit/?id=1349bb760)

2016-07-19 Todd C. Miller

* plugins/sudoers/defaults.c, plugins/sudoers/sudoers.c:

  Only set early defaults once, regardless of how many times the variable
  is set in sudoers. This avoids running an early callback more than once.
  For example, we don’t want to call cb\_fqdn() if sudo is compiled with
  FQDN set but sudoers has “Defaults !fqdn”.
  [[6daf3c5ce]](https://git.sudo.ws/sudo/commit/?id=6daf3c5ce)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h:

  Make strings const in functions that set defaults as they are not
  modified.
  [[5e9173df7]](https://git.sudo.ws/sudo/commit/?id=5e9173df7)

* plugins/sudoers/sudoers.c:

  In cb\_fqdn() just return if the fqdn flag is set to false.
  [[08e369572]](https://git.sudo.ws/sudo/commit/?id=08e369572)

2016-07-18 Todd C. Miller

* plugins/sudoers/defaults.c:

  Implement callbacks for defaults flags (T\_FLAG).
  [[7218dbe54]](https://git.sudo.ws/sudo/commit/?id=7218dbe54)

* plugins/sudoers/sudoers.c:

  add debug\_decl for cb\_runas\_default and cb\_sudoers\_locale
  [[d92a396da]](https://git.sudo.ws/sudo/commit/?id=d92a396da)

* plugins/sudoers/defaults.c, plugins/sudoers/sudoers.c:

  Convert fqdn to a callback and add it to the list of early defaults.
  [[36b18c6e6]](https://git.sudo.ws/sudo/commit/?id=36b18c6e6)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/iolog.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c:

  Change defaults callbacks to take a union sudo\_defs\_val \* instead of a
  char \*.
  [[9b42640ef]](https://git.sudo.ws/sudo/commit/?id=9b42640ef)

* plugins/sudoers/defaults.c:

  When updating defaults, process certain values fist since they can
  influence how other defaults are parsed. Currently, runas\_default and
  sudoers\_locale are processed early.
  [[6ddc95a47]](https://git.sudo.ws/sudo/commit/?id=6ddc95a47)

2016-07-16 Todd C. Miller

* plugins/sudoers/toke\_util.c:

  Fix typo introduced in last commit to fix fill\_args() overflow check.
  [[eae8bc9d5]](https://git.sudo.ws/sudo/commit/?id=eae8bc9d5)

* plugins/sudoers/toke\_util.c:

  Fix underflow checl in fill\_args().
  [[73b0ac4bc]](https://git.sudo.ws/sudo/commit/?id=73b0ac4bc)

* plugins/sudoers/toke\_util.c:

  Make sure we account for the trailing NUL when computing arg\_size in
  fill\_args(). [Bug #752](https://bugzilla.sudo.ws/show_bug.cgi?id=752)
  [[88ba54f47]](https://git.sudo.ws/sudo/commit/?id=88ba54f47)

* plugins/sudoers/toke\_util.c:

  Make arg\_size and arg\_len unsigned since we do bitwise operations on
  them.
  [[0f816c440]](https://git.sudo.ws/sudo/commit/?id=0f816c440)

2016-07-08 Todd C. Miller

* lib/util/Makefile.in, lib/zlib/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  Only remove backup files as part of “make uninstall” when INSTALL\_BACKUP
  is set.
  [[6f5b8cf75]](https://git.sudo.ws/sudo/commit/?id=6f5b8cf75)

* configure, configure.ac, lib/util/Makefile.in, lib/zlib/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  Only keep backups of installed files on HP-UX where you cannot unlink a
  shared library that is in use.
  [[144e3bb53]](https://git.sudo.ws/sudo/commit/?id=144e3bb53)

2016-07-03 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Ignore a missing or insecure #includedir, it is not a fatal error.
  [[19c80f8ae]](https://git.sudo.ws/sudo/commit/?id=19c80f8ae)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Make sure we always call sudoerserror() on error in read\_dir\_files(),
  otherwise sudo will not treat it as a fatal error.
  [[026b403f2]](https://git.sudo.ws/sudo/commit/?id=026b403f2)

2016-06-30 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Set the sudoers locale before opening the sudoers file. Previously the
  sudoers locale was used when evaluating sudoers but not during the
  inital parse. [Bug #748](https://bugzilla.sudo.ws/show_bug.cgi?id=748)
  [[7bfe2e796]](https://git.sudo.ws/sudo/commit/?id=7bfe2e796)

* plugins/sudoers/locale.c:

  Add debugging
  [[5a176e850]](https://git.sudo.ws/sudo/commit/?id=5a176e850)

* plugins/sudoers/Makefile.in:

  Don’t link test programs with the sudoers-specific locale code if we
  don’t need to.
  [[c56d52ea6]](https://git.sudo.ws/sudo/commit/?id=c56d52ea6)

* plugins/sudoers/Makefile.in:

  sudoreplay does not need to link with the sudoers-specific locale code.
  [[cbd2cf290]](https://git.sudo.ws/sudo/commit/?id=cbd2cf290)

2016-06-27 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  new\_digest was prototyped as static but not explicitly declared static.
  [[81e33e1f5]](https://git.sudo.ws/sudo/commit/?id=81e33e1f5)

* configure, configure.ac:

  Some versions of HP-UX 11.11 do not expose struct sockaddr\_ext if
  \_XOPEN\_SOURCE\_EXTENDED is defined. Only define \_XOPEN\_SOURCE\_EXTENDED if
  we can still compile net/if.h.
  [[9cc354aae]](https://git.sudo.ws/sudo/commit/?id=9cc354aae)

* plugins/sudoers/Makefile.in:

  Some versions of HP-UX make will ignore suffix rules if they are empty.
  [[9c7680e01]](https://git.sudo.ws/sudo/commit/?id=9c7680e01)

2016-06-23 Todd C. Miller

* src/exec\_pty.c:

  Don’t skip debug printfs in handle\_sigchld() just because execve()
  returned an error.
  [[66ab525f1]](https://git.sudo.ws/sudo/commit/?id=66ab525f1)

* include/compat/charclass.h, include/sudo\_compat.h, lib/util/aix.c,
  lib/util/getaddrinfo.c, lib/util/sudo\_debug.c,
  plugins/sudoers/insults.h,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/sudoers\_debug.c:

  Add definition of nitems for those without it and use it throughout.
  [[f683cbd58]](https://git.sudo.ws/sudo/commit/?id=f683cbd58)

2016-06-22 Todd C. Miller

* sudo.pp:

  Update copyright year.
  [[ff2cd3cf2]](https://git.sudo.ws/sudo/commit/?id=ff2cd3cf2)

* NEWS, configure, configure.ac:

  Sudo 1.8.17p1
  [[c4118f66f]](https://git.sudo.ws/sudo/commit/?id=c4118f66f)

* src/sudo.c, src/sudo.h:

  Set user groups in exec\_setup() if they were not already set by
  policy\_init\_session(). [Bug
  #749](https://bugzilla.sudo.ws/show_bug.cgi?id=749)
  [[ed9b457eb]](https://git.sudo.ws/sudo/commit/?id=ed9b457eb)

2016-06-15 Todd C. Miller

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  Point the reader to the sudoers manual for the list of supported
  arguments after the plugin path.
  [[f98b481af]](https://git.sudo.ws/sudo/commit/?id=f98b481af)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  forgot to update date in last commit
  [[3a85a8892]](https://git.sudo.ws/sudo/commit/?id=3a85a8892)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  Fix typo; cn=default should be cn=defaults
  [[6c7eb07e0]](https://git.sudo.ws/sudo/commit/?id=6c7eb07e0)

2016-06-13 Todd C. Miller

* lib/util/Makefile.in, lib/zlib/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  Fold lines at 80 characters for the clean: target
  [[72f18cff9]](https://git.sudo.ws/sudo/commit/?id=72f18cff9)

* lib/util/Makefile.in:

  Remove mksiglist, siglist.c, mksigname, signame.c as part of “distclean”
  [[5348d32ab]](https://git.sudo.ws/sudo/commit/?id=5348d32ab)

2016-06-12 Todd C. Miller

* plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po:

  sync with translationproject.org
  [[ea23932af]](https://git.sudo.ws/sudo/commit/?id=ea23932af)

* plugins/sudoers/sssd.c:

  LDAP sudoers doesn’t support negated users, groups or netgroups.
  [[d9e14bc65]](https://git.sudo.ws/sudo/commit/?id=d9e14bc65)

2016-06-09 Todd C. Miller

* NEWS:

  [Bug #746](https://bugzilla.sudo.ws/show_bug.cgi?id=746)
  [[63a242889]](https://git.sudo.ws/sudo/commit/?id=63a242889)

* plugins/sudoers/match.c:

  When matching paths with glob(3), check returned matches against
  user\_cmnd first if it is fully-qualified. This avoids a lot of needless
  stat(2) calls and avoids a mismatch between safe\_cmnd and argv[0] if
  there are multiple matches with the same inode/dev due to links. [Bug
  #746](https://bugzilla.sudo.ws/show_bug.cgi?id=746).
  [[e2de0027d]](https://git.sudo.ws/sudo/commit/?id=e2de0027d)

* NEWS:

  Add execve failure in pty bug fix.
  [[74c2dc780]](https://git.sudo.ws/sudo/commit/?id=74c2dc780)

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po:

  sync with translationproject.org
  [[ce28b15ec]](https://git.sudo.ws/sudo/commit/?id=ce28b15ec)

* src/exec\_pty.c:

  In handle\_sigchld() fix the return value when we’ve already received an
  exec error. We don’t want to overwrite the error status but we do need
  to indicate that the command is no longer running. Fixes as hang on
  execve(2) error when running in a pty.
  [[8a86233c1]](https://git.sudo.ws/sudo/commit/?id=8a86233c1)

* src/exec.c, src/exec\_common.c:

  Move sudo\_debug\_execve() call into sudo\_execve().
  [[1ec4d9918]](https://git.sudo.ws/sudo/commit/?id=1ec4d9918)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/sr.mo,
  po/sr.po, po/sv.mo, po/sv.po:

  sync with translationproject.org
  [[12ab5b810]](https://git.sudo.ws/sudo/commit/?id=12ab5b810)

2016-06-07 Todd C. Miller

* NEWS:

  update for 1.8.17 final
  [[bd8e3b5fb]](https://git.sudo.ws/sudo/commit/?id=bd8e3b5fb)

* lib/util/aix.c:

  Fix setting of hard stack limit when stack\_hard is not specified in
  /etc/security/limits. When 64-bit resource limits are supported we can
  use the default value of 8388608 512-byte blocks directly. We should
  only resort to using RLIM\_SAVED\_MAX for 32-bit resource limits.
  [[1052a7205]](https://git.sudo.ws/sudo/commit/?id=1052a7205)

2016-06-06 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  regen
  [[734b43c6b]](https://git.sudo.ws/sudo/commit/?id=734b43c6b)

2016-06-05 Todd C. Miller

* plugins/sudoers/sssd.c:

  Ignore empty ipa\_hostname
  [[316925982]](https://git.sudo.ws/sudo/commit/?id=316925982)

* plugins/sudoers/sssd.c:

  Better martching of ipa\_hostname in sssd.conf
  [[c6a21bd53]](https://git.sudo.ws/sudo/commit/?id=c6a21bd53)

2016-06-04 Todd C. Miller

* INSTALL, configure, configure.ac, pathnames.h.in,
  plugins/sudoers/sssd.c:

  Use the value of ipa\_hostname from /etc/sssd/sssd.conf if present
  instead of the system hostname.
  [[9b027676c]](https://git.sudo.ws/sudo/commit/?id=9b027676c)

2016-06-03 Todd C. Miller

* plugins/sudoers/sssd.c:

  When matching host, short-circuit the loop when we get a match. Only
  check username as part of the netgroup when netgroup\_tuple is enabled.
  [[ccf88d3bb]](https://git.sudo.ws/sudo/commit/?id=ccf88d3bb)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Avoid using !strcmp()
  [[a71cac91f]](https://git.sudo.ws/sudo/commit/?id=a71cac91f)

2016-06-02 Todd C. Miller

* plugins/sudoers/sssd.c:

  SSSD doesn’t handle netgroups, we have to ensure they are correctly
  filtered in sudo. The rules may contain mixed sudoUser specification so
  we have to check not only for netgroup membership but also for user and
  group matches. Adapted from a patch from Daniel Kopecek.
  [[b6beccf19]](https://git.sudo.ws/sudo/commit/?id=b6beccf19)

2016-06-01 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  Return PAM\_CONV\_ERR from the conversation function if getpass returns
  NULL or the user pressed ^C.
  [[a24f4b824]](https://git.sudo.ws/sudo/commit/?id=a24f4b824)

* plugins/sudoers/base64.c:

  Make base64 decoding table-driven.
  [[7a35bab8c]](https://git.sudo.ws/sudo/commit/?id=7a35bab8c)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Back out cfa26b99228f, it was already fixed differently. Caught by
  regress checks.
  [[fc517ba9f]](https://git.sudo.ws/sudo/commit/?id=fc517ba9f)

2016-05-31 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Allow double-quoted groups and netgroups to be part of a Defaults spec.
  From Daniel Kopecek.
  [[6c3c03ea2]](https://git.sudo.ws/sudo/commit/?id=6c3c03ea2)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  The sudoers.ldap manual is installed in section 4 or 5, not 1m or 8.
  Also fix the section for ldap.conf cross-references.
  [[638acc28c]](https://git.sudo.ws/sudo/commit/?id=638acc28c)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  Fix copy pasta, “sudoNotAfter” not “sudoNotBefore”. Add missing word
  “order” in a sentence describing sudoOrder.
  [[77331392e]](https://git.sudo.ws/sudo/commit/?id=77331392e)

* plugins/sudoers/sssd.c:

  For sudo -ll (long list) print the SSSD role just like we do for the
  LDAP backend. Adapted from sudo-1.8.6p3-sssdrulenames.patch
  [[461a419d0]](https://git.sudo.ws/sudo/commit/?id=461a419d0)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Setting timestamp\_timeout less than zero only lasts until the next
  reboot. Adapted from a RedHat patch.
  [[c6b41b165]](https://git.sudo.ws/sudo/commit/?id=c6b41b165)

* po/it.mo, po/it.po, po/nb.mo, po/nb.po:

  sync with translationproject.org
  [[77179d69d]](https://git.sudo.ws/sudo/commit/?id=77179d69d)

2016-05-25 Todd C. Miller

* src/conversation.c:

  fputs() is now specified as returning non-negative on success, not
  explicitly zero. Fixes a failure on glibc.
  [[53ebf69af]](https://git.sudo.ws/sudo/commit/?id=53ebf69af)

* src/conversation.c:

  Don’t try to dereference replies[] if it is a NULL pointer.
  [[e93b4aa68]](https://git.sudo.ws/sudo/commit/?id=e93b4aa68)

* plugins/sudoers/policy.c:

  sudo\_version should be unsigned
  [[db2c73293]](https://git.sudo.ws/sudo/commit/?id=db2c73293)

* plugins/sudoers/po/ca.mo, plugins/sudoers/po/ca.po,
  plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/ca.mo,
  po/ca.po, po/cs.mo, po/cs.po, po/da.mo, po/da.po, po/de.mo, po/de.po,
  po/fr.mo, po/fr.po, po/hr.mo, po/hr.po, po/ja.mo, po/ja.po, po/pl.mo,
  po/pl.po, po/sk.mo, po/sk.po, po/sv.mo, po/sv.po, po/uk.mo, po/uk.po,
  po/vi.mo, po/vi.po, po/zh\_CN.mo, po/zh\_CN.po:

  sync with translationproject.org
  [[4d36fbec2]](https://git.sudo.ws/sudo/commit/?id=4d36fbec2)

* MANIFEST, NEWS, doc/CONTRIBUTORS, plugins/sudoers/po/ko.mo,
  plugins/sudoers/po/ko.po, po/ko.mo, po/ko.po:

  Korean translation for sudo and sudoers from translationproject.org.
  [[63dbb7425]](https://git.sudo.ws/sudo/commit/?id=63dbb7425)

* NEWS, plugins/sudoers/auth/pam.c:

  Ignore PAM\_SESSION\_ERR from pam\_open\_session() since this can apparently
  happen on systems using Solaris-derived PAM. Other errors from
  pam\_open\_session() are treated as fatal. This avoids the “policy plugin
  failed session initialization” error message seen on some systems.
  [[5e1084c08]](https://git.sudo.ws/sudo/commit/?id=5e1084c08)

2016-05-24 Todd C. Miller

* NEWS, src/exec\_pty.c:

  Don’t read from stdin when flushing final buffers in blocking mode.
  Reading from the pipe can block too if the other end is not closed.
  [[356e74e1d]](https://git.sudo.ws/sudo/commit/?id=356e74e1d)

2016-05-23 Todd C. Miller

* NEWS:

  Mention visudo -x change.
  [[e3514817d]](https://git.sudo.ws/sudo/commit/?id=e3514817d)

* plugins/sudoers/regress/sudoers/test1.json.ok,
  plugins/sudoers/regress/sudoers/test14.json.ok,
  plugins/sudoers/regress/sudoers/test15.json.ok,
  plugins/sudoers/regress/sudoers/test16.json.ok,
  plugins/sudoers/regress/sudoers/test2.json.ok,
  plugins/sudoers/visudo\_json.c:

  There’s no need to escape forward slashes in JSON output. While it is
  legal to escape a forward slash, it is not required.
  [[58ffab1df]](https://git.sudo.ws/sudo/commit/?id=58ffab1df)

* doc/UPGRADE:

  Document that in 1.8.12 sudo started being able to check the NIS domain
  on Solaris.
  [[ab861b92d]](https://git.sudo.ws/sudo/commit/?id=ab861b92d)

2016-05-20 Todd C. Miller

* NEWS:

  Better description of the I/O logging pipe issue.
  [[ccece8c01]](https://git.sudo.ws/sudo/commit/?id=ccece8c01)

* src/exec\_pty.c:

  In del\_io\_events(), avoid reading from the pty master in blocking mode.
  We now do two passes, one with SUDO\_EVLOOP\_NONBLOCK and another that
  could block if stdin is a pipe. This ensures we consume the pipe until
  EOF.
  [[8f694cc22]](https://git.sudo.ws/sudo/commit/?id=8f694cc22)

* lib/util/event.c:

  Improve debug info in sudo\_ev\_add() and sudo\_ev\_del()
  [[223b251c1]](https://git.sudo.ws/sudo/commit/?id=223b251c1)

* src/exec\_pty.c:

  In pty\_close(), call del\_io\_events with the SUDO\_EVLOOP\_ONCE flag so the
  event loop will exit after a single run through. Otherwise, we may hang
  at exit on non-BSD systems.
  [[994f86b40]](https://git.sudo.ws/sudo/commit/?id=994f86b40)

2016-05-18 Todd C. Miller

* po/sudo.pot:

  regen
  [[d8cfe6211]](https://git.sudo.ws/sudo/commit/?id=d8cfe6211)

2016-05-17 Todd C. Miller

* src/exec\_pty.c:

  Bump I/O buffer size to 64K. We don’t use PIPE\_BUF or \_PC\_PIPE\_BUF for
  this because that corresponds to the value for atomic pipe writes. The
  actual pipe buffer is much larger on modern systems and 64K is what BSD
  and Linux support for large pipe buffers.
  [[38f4ba224]](https://git.sudo.ws/sudo/commit/?id=38f4ba224)

* NEWS:

  I/O logging bug fix
  [[fb247aa76]](https://git.sudo.ws/sudo/commit/?id=fb247aa76)

* src/exec\_pty.c:

  Don’t use SUDO\_EVLOOP\_NONBLOCK when flushing buffers at pty close time,
  only when the user suspends sudo. Fixes a problem where all buffers
  might not get flushed at exit when logging I/O. Reproducible via “sudo
  tar cf - foo | (cd /tmp && sudo tar xf -)” on OpenBSD.
  [[3b6cb9d65]](https://git.sudo.ws/sudo/commit/?id=3b6cb9d65)

2016-05-16 Todd C. Miller

* plugins/sudoers/visudo\_json.c:

  Don’t try to fflush(export\_fp) or ferror(export\_fp) if export\_fp is
  NULL, which can happen on the error path.
  [[eb4510597]](https://git.sudo.ws/sudo/commit/?id=eb4510597)

* plugins/sudoers/sudoers.c, src/exec.c, src/exec\_pty.c, src/sudo.c,
  src/tgetpass.c:

  O\_NOCTTY has no effect when opening /dev/tty as the open can only
  succeed if there is already a controlling tty.
  [[a2e541aef]](https://git.sudo.ws/sudo/commit/?id=a2e541aef)

* src/sudo.c:

  Do not need to open /dev/tty with O\_NONBLOCK, it doesn’t block on first
  open like a physical terminal. By definition, if you have a controlling
  tty, the first open (which might block) has already occurred.
  [[3b3937724]](https://git.sudo.ws/sudo/commit/?id=3b3937724)

* src/selinux.c:

  Use O\_NOCTTY when opening a tty.
  [[4e6b6fd0f]](https://git.sudo.ws/sudo/commit/?id=4e6b6fd0f)

* src/Makefile.in:

  regen
  [[3161c05a0]](https://git.sudo.ws/sudo/commit/?id=3161c05a0)

* plugins/sudoers/auth/sudo\_auth.c:

  No need to set pass to NULL after freeing at the end of the loop it
  since it is already set to NULL each time through the loop.
  [[b9dde1480]](https://git.sudo.ws/sudo/commit/?id=b9dde1480)

2016-05-14 Todd C. Miller

* NEWS:

  SELinux fixes in 1.8.17.
  [[67eb6dad0]](https://git.sudo.ws/sudo/commit/?id=67eb6dad0)

* plugins/sudoers/logging.h, plugins/sudoers/logwrap.c:

  Check fprintf() return value in writeln\_wrap() and return the number of
  characters actually written, or -1 on error.
  [[787912fa9]](https://git.sudo.ws/sudo/commit/?id=787912fa9)

* src/conversation.c:

  Check fputs() return value.
  [[009f3e645]](https://git.sudo.ws/sudo/commit/?id=009f3e645)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Do not write directly to stdout/stderr, use sudo\_printf which calls the
  conversation function.
  [[9d526c1af]](https://git.sudo.ws/sudo/commit/?id=9d526c1af)

* plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/securid5.c:

  Do not write directly to stdout/stderr, use sudo\_printf which calls the
  conversation function.
  [[90fdb6a31]](https://git.sudo.ws/sudo/commit/?id=90fdb6a31)

* plugins/sudoers/iolog.c, plugins/sudoers/visudo\_json.c:

  Use ferror() after fflush() to check the error status of the stdio
  stream we wrote to.
  [[578af5af4]](https://git.sudo.ws/sudo/commit/?id=578af5af4)

2016-05-13 Todd C. Miller

* plugins/sudoers/parse.c:

  printf() returns < 0 on error, not explicitly -1
  [[6d63ed8a9]](https://git.sudo.ws/sudo/commit/?id=6d63ed8a9)

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo\_plugin.cat,
  doc/sudoers.ldap.cat, doc/sudoreplay.cat, doc/visudo.cat:

  Regen for 1.8.17
  [[7461dcf9a]](https://git.sudo.ws/sudo/commit/?id=7461dcf9a)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document that you need to preserve EDITOR and/or VISUAL for env\_editor
  to be useful.
  [[d25500afa]](https://git.sudo.ws/sudo/commit/?id=d25500afa)

* src/selinux.c:

  Fix last commit, now that argc is not reset we need to explicitly start
  the copy from argv[1]. From Daniel Kopecek
  [[a2085809f]](https://git.sudo.ws/sudo/commit/?id=a2085809f)

2016-05-12 Todd C. Miller

* src/selinux.c:

  cosmetic change to warning string
  [[ea5bd18b9]](https://git.sudo.ws/sudo/commit/?id=ea5bd18b9)

* plugins/sudoers/auth/pam.c:

  Avoid adding an extraneous warning string to sudoers.pot.
  [[4f46e0720]](https://git.sudo.ws/sudo/commit/?id=4f46e0720)

* lib/util/snprintf.c:

  Use EOVERFLOW, not ENOMEM for overflow conditions. For snprintf() and
  vsnprintf(), POSIX says we should return -1 and set errno to EOVERFLOW
  if the size param is > INT\_MAX; also zero out the string in this case
  (not mandated by POSIX) for safety.
  [[e014159fe]](https://git.sudo.ws/sudo/commit/?id=e014159fe)

2016-05-11 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  Now that pam\_open\_session() failure is fatal we should print and log an
  error from it. [Bug #744](https://bugzilla.sudo.ws/show_bug.cgi?id=744)
  [[b0be9895d]](https://git.sudo.ws/sudo/commit/?id=b0be9895d)

* src/selinux.c:

  Repair SELinux support, broken by 397722cdd7ec. From Daniel Kopecek.
  [[d3622b0f2]](https://git.sudo.ws/sudo/commit/?id=d3622b0f2)

* plugins/sudoers/iolog.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Remove sudo\_mkpwcache() and sudo\_mkgrcache(). We now create the caches
  as needed on demand. Also remove calls to sudo\_freepwcache() and
  sudo\_freegrcache() that are immediately followed by execve(), they are
  not needed.
  [[05db5aa3b]](https://git.sudo.ws/sudo/commit/?id=05db5aa3b)

* plugins/sudoers/iolog.c, plugins/sudoers/logging.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Eliminate use of setpwent()/endpwent() and setgrent()/endgrent(). Sudo
  never iterates over the passwd or group file. Rename
  sudo\_set{pw,gr}ent() -> sudo\_mk{pw,gr}cache() and use
  sudo\_free{pw,gr}cache() instead of sudo\_end{pw,gr}ent().
  [[23d288563]](https://git.sudo.ws/sudo/commit/?id=23d288563)

2016-05-10 Todd C. Miller

* plugins/sudoers/parse.h:

  Remove unnecessary NULL checks in the RUNAS\_CHANGED macro. The only
  place where the pointers could be NULL is in visudo\_json.c but we
  already check for “next” being NULL there. Quiets a cppcheck warning.
  [[8b4de8404]](https://git.sudo.ws/sudo/commit/?id=8b4de8404)

2016-05-09 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  In replay\_session() free iov at the end of the function (if needed)
  instead of after processing each line from the timing file. Coverity CID
  104843.
  [[398ddd046]](https://git.sudo.ws/sudo/commit/?id=398ddd046)

* plugins/sudoers/sudoreplay.c:

  Add io\_log\_read() and io\_log\_gets() to hide differences between
  gzread/fread and gzgets/fgets. Check for premature EOF and error from
  io\_log\_read(). Also sanity check the index in the timing file. Coverity
  CID 104630.
  [[e528cad79]](https://git.sudo.ws/sudo/commit/?id=e528cad79)

* src/exec\_pty.c:

  Break up io\_callback() into read\_callback() and write\_callback() to make
  it clear that we can’t get an event with both read and write set.
  [[b04c49dbd]](https://git.sudo.ws/sudo/commit/?id=b04c49dbd)

2016-05-07 Todd C. Miller

* src/exec\_pty.c:

  In io\_callback() make sure we clear SUDO\_EV\_READ if we close the fd. It
  should not be possible for SUDO\_EV\_READ to be set when revent is
  non-NULL but this makes static analyzers happier. Coverity CID 104124.
  [[094854adf]](https://git.sudo.ws/sudo/commit/?id=094854adf)

* plugins/sudoers/ldap.c:

  In sudo\_krb5\_copy\_cc\_file() move the close(ofd) to the done: label so we
  only have to cleanup in one place. Coverity CID 104577.
  [[194c7c806]](https://git.sudo.ws/sudo/commit/?id=194c7c806)

* plugins/sudoers/ldap.c:

  Fix memory leak in sudo\_netgroup\_lookup() in the non-error case.
  Coverity CID 104572, 104573, 104574, 104575.
  [[0568fa90c]](https://git.sudo.ws/sudo/commit/?id=0568fa90c)

* plugins/sudoers/ldap.c:

  Fix fd leak in sudo\_krb5\_copy\_cc\_file() if restore\_perms() fails.
  Coverity CID 104571.
  [[334b8f36a]](https://git.sudo.ws/sudo/commit/?id=334b8f36a)

* plugins/sudoers/sudoreplay.c:

  Free the events and event base before returning from replay\_session().
  Coverity CID 104116, 104117.
  [[b84b2e680]](https://git.sudo.ws/sudo/commit/?id=b84b2e680)

* src/sudo\_edit.c:

  In sudo\_edit\_create\_tfiles(), fix fd leak if sudo\_edit\_mktemp() fails.
  Coverity CID 104114.
  [[e99e3c26c]](https://git.sudo.ws/sudo/commit/?id=e99e3c26c)

* src/sudo\_edit.c:

  Fix fd leak in sudo\_edit\_open\_nonwritable() if dir\_is\_writable() returns
  an error. Coverity CID 104113.
  [[355cce457]](https://git.sudo.ws/sudo/commit/?id=355cce457)

* src/sudo\_edit.c:

  Fix memory leak of sesh\_args in selinux\_edit\_copy\_tfiles(). Coverity CID
  104112.
  [[d733dd778]](https://git.sudo.ws/sudo/commit/?id=d733dd778)

* plugins/sudoers/visudo.c:

  Fix memory leak in get\_editor() if resolve\_editor() fails with an error.
  Coverity CID 104107.
  [[bbda2e7b5]](https://git.sudo.ws/sudo/commit/?id=bbda2e7b5)

* src/sudo.c:

  Fix memory leak on error if sudo\_new\_key\_val() fails. Coverity CID
  104103.
  [[0f359e038]](https://git.sudo.ws/sudo/commit/?id=0f359e038)

* plugins/sudoers/visudo.c:

  Ignore the return value of the initial sudoersparse(), before we have
  actually edited any files. Coverity CID 104078.
  [[96f5fe4cd]](https://git.sudo.ws/sudo/commit/?id=96f5fe4cd)

* src/exec.c:

  Ignore the result of send() on exec error, if it fails the other end of
  the pipe is gone and we are headed for exit. Coverity CID 104066.
  [[00727a310]](https://git.sudo.ws/sudo/commit/?id=00727a310)

* plugins/sudoers/toke\_util.c:

  In fill\_args() clean up properly if there is an internal overflow (which
  should not be possible). Coverity CID 104569.
  [[edd1a1cac]](https://git.sudo.ws/sudo/commit/?id=edd1a1cac)

* plugins/sudoers/gc.c:

  Fix logic inversion in sudoers\_gc\_remove(), currently unused. Coverity
  CID 104568
  [[0ecc6025a]](https://git.sudo.ws/sudo/commit/?id=0ecc6025a)

2016-05-06 Todd C. Miller

* plugins/sudoers/iolog.c:

  In io\_mkdirs(), change the order from stat then mkdir, to mkdir then
  stat. This more closely matches what “mkdir -p” does. Coverity CID
  104120.
  [[c56a812ea]](https://git.sudo.ws/sudo/commit/?id=c56a812ea)

* plugins/sudoers/timestamp.c:

  In ts\_mkdirs(), change the order from stat then mkdir, to mkdir then
  stat. This more closely matches what “mkdir -p” does. Coverity CID
  104119.
  [[602ed0c74]](https://git.sudo.ws/sudo/commit/?id=602ed0c74)

* plugins/sudoers/sudoers.c:

  Newer versions of Ubuntu have switched from using the “admin” group to
  the “sudo” group to align with Debian. create\_admin\_success\_flag() now
  accepts either one.
  [https://bugs.launchpad.net/ubuntu/+source/sudo/+bug/1387347](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/1387347)
  [[5ee1e5bbc]](https://git.sudo.ws/sudo/commit/?id=5ee1e5bbc)

* plugins/sudoers/timestamp.c:

  Cast off\_t printed via printf(3) instead of assuming it is long long.
  [[7a86430d4]](https://git.sudo.ws/sudo/commit/?id=7a86430d4)

* plugins/sudoers/sudoers.c:

  Instead of using stat(2) to see if the admin flag file exists and
  creating it if not, just try to create the file and treat EEXIST as a
  non-error. Coverity CID 104121.
  [[151e03fb5]](https://git.sudo.ws/sudo/commit/?id=151e03fb5)

* MANIFEST, plugins/sample/README:

  README file for the sample plugin that tells the user how to build,
  install and enable it.
  [[bb1232806]](https://git.sudo.ws/sudo/commit/?id=bb1232806)

* plugins/sample/sample\_plugin.c:

  Fix compilation error and export sample\_policy struct. From Michael
  Evans
  [[cc82c3193]](https://git.sudo.ws/sudo/commit/?id=cc82c3193)

* NEWS:

  Update for 1.8.17
  [[3b4f2bbff]](https://git.sudo.ws/sudo/commit/?id=3b4f2bbff)

* configure, configure.ac:

  Sudo 1.8.17
  [[3b043207b]](https://git.sudo.ws/sudo/commit/?id=3b043207b)

* plugins/sudoers/logging.c:

  Check return value of restore\_perms() in vlog\_warning(). Coverity CID
  104079.
  [[7b302e09a]](https://git.sudo.ws/sudo/commit/?id=7b302e09a)

* plugins/sudoers/editor.c:

  Fix memory leaks in resolve\_editor() in the error path. Coverity CID
  104109, 104110
  [[b4cb1c0a1]](https://git.sudo.ws/sudo/commit/?id=b4cb1c0a1)

* plugins/sudoers/policy.c:

  Fix memory leak of gid\_list in sudoers\_policy\_exec\_setup() in the error
  path. Coverity CID 104111.
  [[61c53c8e6]](https://git.sudo.ws/sudo/commit/?id=61c53c8e6)

* plugins/sudoers/logging.c:

  Fix fd leak in do\_logfile() if we fail to lock the log file. Coverity
  CID 104115.
  [[0690793c2]](https://git.sudo.ws/sudo/commit/?id=0690793c2)

* plugins/sudoers/sssd.c:

  Fix memory leak of sss\_result in sudo\_sss\_lookup() Coverity CID 104106
  [[7a5149d73]](https://git.sudo.ws/sudo/commit/?id=7a5149d73)

* plugins/sudoers/iolog.c:

  Fix fd leak in open\_io\_fd() if gzdopen/fdopen fails. Coverity CID 104105
  [[4bfdf0c2b]](https://git.sudo.ws/sudo/commit/?id=4bfdf0c2b)

* plugins/sudoers/iolog.c:

  Fix fd leak in io\_nextid() in error path. Coverity CID 104104
  [[444d2a5c3]](https://git.sudo.ws/sudo/commit/?id=444d2a5c3)

2016-05-05 Todd C. Miller

* plugins/sudoers/timestamp.c:

  Check lseek() return value. Coverity CID 104061.
  [[562b5cb59]](https://git.sudo.ws/sudo/commit/?id=562b5cb59)

* plugins/sudoers/timestamp.c:

  Ignore ts\_write() return value when disabling an entry with a bogus
  timestamp. We ignore the timestamp entry even it doesn’t succeed.
  Coverity CID 104062.
  [[60e740dd6]](https://git.sudo.ws/sudo/commit/?id=60e740dd6)

* plugins/sudoers/iolog.c, plugins/sudoers/match.c,
  plugins/sudoers/tsgetgrpw.c, src/exec.c, src/exec\_pty.c, src/sudo.c:

  Cast the return value of fcntl() to void when setting FD\_CLOEXEC.
  Coverity CID 104063, 104064, 104069, 104070, 104071, 104072, 104073,
  104074
  [[6473d55aa]](https://git.sudo.ws/sudo/commit/?id=6473d55aa)

* plugins/group\_file/getgrent.c:

  Cast the return value of fcntl() to void when setting FD\_CLOEXEC.
  Coverity CID 104075, 104076, 104077.
  [[9471ec45a]](https://git.sudo.ws/sudo/commit/?id=9471ec45a)

* plugins/sudoers/env.c:

  Avoid a false positive. Coverity CID 104056.
  [[a7fa036d4]](https://git.sudo.ws/sudo/commit/?id=a7fa036d4)

* plugins/sudoers/visudo\_json.c:

  Avoid calling fclose(NULL) on error in export\_sudoers(). Coverity CID
  104091.
  [[c0a3c6bb9]](https://git.sudo.ws/sudo/commit/?id=c0a3c6bb9)

* plugins/sudoers/toke\_util.c:

  In fill\_args(), check for “arg\_size == 0” instead of
  “sudoerslval.command.args == NULL” since the latter leads Coverity to
  imply that sudoerslval.command.args could be NULL later on. Coverity CID
  104093.
  [[a09e45d33]](https://git.sudo.ws/sudo/commit/?id=a09e45d33)

* plugins/sudoers/sudoers.c:

  Avoid calling fclose(NULL) if the sudoers file is not secure and
  restore\_perms() fails. Coverity CID 104090.
  [[64142f9da]](https://git.sudo.ws/sudo/commit/?id=64142f9da)

2016-05-04 Todd C. Miller

* plugins/sudoers/toke.h, plugins/sudoers/toke\_util.c:

  In fill\_args(), replace loop that increments arg\_size() with a simple
  add and mask. Should prevent a false positive from Coverity CID 104094.
  [[5725acd1c]](https://git.sudo.ws/sudo/commit/?id=5725acd1c)

* plugins/sudoers/sudoreplay.c:

  In parse\_expr(), move the “bad” label after the “default” case in the
  switch(), not before it. This seemed to confuse Covertity, resulting in
  a false positive, CID 104095.
  [[bf734419b]](https://git.sudo.ws/sudo/commit/?id=bf734419b)

* doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in:

  For “sudoreplay -l”, not all predicates may be shortened to a single
  character. Both ‘c’ and ’t’ have more than one possibility.
  [[ea44d3757]](https://git.sudo.ws/sudo/commit/?id=ea44d3757)

* src/exec.c, src/exec\_pty.c, src/sudo.c:

  pid\_t is defined by POSIX as a signed integer type so we don’t need a
  cast when comparing to -1.
  [[829917f00]](https://git.sudo.ws/sudo/commit/?id=829917f00)

* src/exec.c:

  In dispatch\_signal() for stopped processes check for tcgetpgrp()
  returning -1. Also change checks from “saved\_pgrp != -1” to “fd != -1”.
  Coverity CID 104098.
  [[c70da6dcd]](https://git.sudo.ws/sudo/commit/?id=c70da6dcd)

* src/selinux.c:

  In relabel\_tty() always jump to bad: on error, regardless of the value
  of se\_state.enforcing. On error, return -1 if enforcing, else 0.
  Coverity CID 104099.
  [[2cd22f290]](https://git.sudo.ws/sudo/commit/?id=2cd22f290)

* config.h.in, configure.ac:

  Define NO\_LEAKS when sudo is built with Coverity.
  [[b20b411e7]](https://git.sudo.ws/sudo/commit/?id=b20b411e7)

* src/exec\_pty.c:

  In io\_callback() if we write the complete buffer and find that there is
  no associated reader just return as there is nothing else to be done. In
  practice is it not possible for SUDO\_EV\_READ to be set if revent is NULL
  but an early return is harmless and possibly easier to understand.
  Coverity CID 104124.
  [[4ce39df38]](https://git.sudo.ws/sudo/commit/?id=4ce39df38)

* src/sudo\_edit.c:

  Handle read() returning -1 when creating temporary files. Coverity CID
  104100
  [[6ea903623]](https://git.sudo.ws/sudo/commit/?id=6ea903623)

* plugins/sudoers/policy.c:

  Fix cut and paste error when checking cols for 0. Coverity CID 104081
  [[20ff6023a]](https://git.sudo.ws/sudo/commit/?id=20ff6023a)

* plugins/sudoers/pwutil.c:

  Use a single debug message for cache hit or store to avoid another
  situation where they get out of sync. [Bug
  #743](https://bugzilla.sudo.ws/show_bug.cgi?id=743)
  [[2152f053b]](https://git.sudo.ws/sudo/commit/?id=2152f053b)

* plugins/sudoers/pwutil.c:

  Sync the “cache hit” debug messages with the “cached” debug messages.
  This fixes a bug where we could dereference a NULL pointer when we look
  up a negative cached entry which is stored as a NULL passwd or group
  struct pointer. [Bug
  #743](https://bugzilla.sudo.ws/show_bug.cgi?id=743).
  [[a152afaeb]](https://git.sudo.ws/sudo/commit/?id=a152afaeb)

2016-04-28 Todd C. Miller

* configure, configure.ac:

  Remove the check for \_\_sprintf\_chk when checking for \_FORTIFY\_SOURCE,
  Some implementations are purely header-file based. As long as we can
  link a test program using sprintf() when \_FORTIFY\_SOURCE=2 it should be
  safe to use.
  [[9d5c6fbd6]](https://git.sudo.ws/sudo/commit/?id=9d5c6fbd6)

* config.h.in, configure, configure.ac:

  Remove configure checks for dev\_t, id\_t, ino\_t, ptrdiff\_t, size\_t and
  ssize\_t. These have been specified by either ANSI C or POSIX for long
  enough that if the system doesn’t support them, it is unlikely to be
  able to compile sudo anyway.
  [[e0f12d81a]](https://git.sudo.ws/sudo/commit/?id=e0f12d81a)

* src/sudo.c:

  Do group setup in policy\_init\_session() before calling out to the
  plugin. This makes it possible for the pam\_group module to change the
  group in pam\_setcred(). It’s a bit bogus since pam\_setcred() is
  documented as not changing the group or user ID, but pam\_group is
  shipped with stock Linux-PAM so we need to support it.
  [[f88da1c1a]](https://git.sudo.ws/sudo/commit/?id=f88da1c1a)

2016-04-26 Todd C. Miller

* plugins/sudoers/logging.c:

  Add missing newline when logging to a file (not syslog) and loglinelen
  is set to a non-positive number. [Bug
  #742](https://bugzilla.sudo.ws/show_bug.cgi?id=742)
  [[57b1dc5e1]](https://git.sudo.ws/sudo/commit/?id=57b1dc5e1)

2016-04-25 Todd C. Miller

* src/exec.c:

  style fix; fork\_cmnd should start on a new line
  [[3e9702580]](https://git.sudo.ws/sudo/commit/?id=3e9702580)

2016-04-22 Todd C. Miller

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  plugins/sudoers/ldap.c, plugins/sudoers/logging.c, src/signal.c,
  src/sudo.c, src/tgetpass.c:

  Ignore SIGPIPE for the duration of sudo and not just in a few select
  places. We have no control over what nss, PAM modules or sudo plugins
  might do so ignoring SIGPIPE is safest.
  [[b4309d4ae]](https://git.sudo.ws/sudo/commit/?id=b4309d4ae)

* src/selinux.c:

  Use string\_to\_security\_class() instead of pulling SECCLASS\_CHR\_FILE from
  flask.h. Avoids a warning with new SELinux includes.
  [[70cf5674b]](https://git.sudo.ws/sudo/commit/?id=70cf5674b)

2016-04-19 Todd C. Miller

* plugins/sudoers/ldap.c, plugins/sudoers/parse.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  When determining whether or not “sudo -l” or “sudo -b” should prompt for
  a password, take all sudoers sources into account. In other words, if
  both file and ldap sudoers sources are in use, “sudo -v” will now
  require that all entries in both sources be have NOPASSWD (file) or
  !authenticate (ldap) in the entries.
  [[6717c3202]](https://git.sudo.ws/sudo/commit/?id=6717c3202)

2016-03-22 Todd C. Miller

* plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/sudo\_auth.h:

  If the auth\_type setting in /etc/security/login.cfg is set to PAM\_AUTH
  but pam\_start() fails, fall back to use AIX authentication. Skip the
  auth\_type check if sudo is not compiled with PAM support.
  [[b2d1c457c]](https://git.sudo.ws/sudo/commit/?id=b2d1c457c)

2016-03-17 Todd C. Miller

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  The header for sudo.conf(5) should be SUDO.CONF(5) not SUDO(5).
  [[7cd6d4ec7]](https://git.sudo.ws/sudo/commit/?id=7cd6d4ec7)

2016-03-16 Todd C. Miller

* plugins/sudoers/policy.c:

  hook\_version and hook\_type are unsigned so use 0, not -1 in the final
  (empty) entry. Quiets a warning on Solaris Studio 12.2.
  [[c5cafb433]](https://git.sudo.ws/sudo/commit/?id=c5cafb433)

2016-03-09 Todd C. Miller

* NEWS, config.h.in, configure, configure.ac, plugins/sudoers/auth/pam.c:

  Work around an ambiguity in the PAM spec with respect to the
  conversation function. It is not clear whether the “struct pam\_message
  \*\*msg” is an array of pointers or a pointer to an array. Linux-PAM and
  OpenPAM use an array of pointers while Solaris/HP-UX/AIX uses a pointer
  to an array. [Bug #726](https://bugzilla.sudo.ws/show_bug.cgi?id=726).
  [[48dff8408]](https://git.sudo.ws/sudo/commit/?id=48dff8408)

2016-03-08 Todd C. Miller

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po, po/eo.mo, po/eo.po,
  po/it.mo, po/it.po, po/ja.mo, po/ja.po, po/ru.mo, po/ru.po, po/sr.mo,
  po/sr.po:

  sync with translationproject.org
  [[935367260]](https://git.sudo.ws/sudo/commit/?id=935367260)

2016-02-27 Todd C. Miller

* NEWS:

  [Bug #738](https://bugzilla.sudo.ws/show_bug.cgi?id=738)
  [[f5b8ad480]](https://git.sudo.ws/sudo/commit/?id=f5b8ad480)

2016-02-26 Todd C. Miller

* plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po, po/nb.mo, po/nb.po:

  sync with translationproject.org
  [[514c62fc2]](https://git.sudo.ws/sudo/commit/?id=514c62fc2)

* lib/util/regress/fnmatch/fnm\_test.in:

  Better test for negated character classes.
  [[70f2f4eee]](https://git.sudo.ws/sudo/commit/?id=70f2f4eee)

* lib/util/regress/fnmatch/fnm\_test.in:

  Add test for negated character class
  [[f222a20b1]](https://git.sudo.ws/sudo/commit/?id=f222a20b1)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po, po/cs.mo, po/cs.po,
  po/de.mo, po/de.po, po/fr.mo, po/fr.po, po/pl.mo, po/pl.po, po/pt\_BR.mo,
  po/pt\_BR.po, po/uk.mo, po/uk.po, po/vi.mo, po/vi.po, po/zh\_CN.mo,
  po/zh\_CN.po:

  sync with translationproject.org
  [[159aa2ba6]](https://git.sudo.ws/sudo/commit/?id=159aa2ba6)

* NEWS:

  sync
  [[d1a3da417]](https://git.sudo.ws/sudo/commit/?id=d1a3da417)

* lib/util/fnmatch.c:

  Fix negation of character classes.
  [[547a9b7d9]](https://git.sudo.ws/sudo/commit/?id=547a9b7d9)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Fix the check for whether a user is allowed to lists another user’s
  privileges. The “matched” variable is not boolean, it can also have the
  value UNSPEC so we need to check explicitly for true. [Bug
  #738](https://bugzilla.sudo.ws/show_bug.cgi?id=738)
  [[95dd64ea7]](https://git.sudo.ws/sudo/commit/?id=95dd64ea7)

* plugins/sudoers/auth/pam.c:

  Log the number of PAM messages in the conversation function at debug
  level.
  [[5dd7ac20e]](https://git.sudo.ws/sudo/commit/?id=5dd7ac20e)

2016-02-24 Todd C. Miller

* configure, configure.ac:

  Don’t check for posix\_spawn() or posix\_spawnp() if we were unable to
  find spawn.h. This should only be a problem on systems with broken
  headers. [Bug #730](https://bugzilla.sudo.ws/show_bug.cgi?id=730)
  [[4b079ee7e]](https://git.sudo.ws/sudo/commit/?id=4b079ee7e)

2016-02-22 Todd C. Miller

* NEWS:

  update for 1.8.16
  [[1d796d629]](https://git.sudo.ws/sudo/commit/?id=1d796d629)

* doc/CONTRIBUTORS, plugins/sudoers/sudoers2ldif:

  Fix documented bug with duplicate role names and turn on perl warnings.
  Based on a diff from Aaron Peschel
  [[99978e4a7]](https://git.sudo.ws/sudo/commit/?id=99978e4a7)

2016-02-20 Todd C. Miller

* lib/util/aix.c:

  Add declaration of getauthdb() for AIX 5.1
  [[47adf0d3c]](https://git.sudo.ws/sudo/commit/?id=47adf0d3c)

2016-02-19 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[6848a7f1a]](https://git.sudo.ws/sudo/commit/?id=6848a7f1a)

* plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po:

  sync with translationproject.org
  [[fafbc9a55]](https://git.sudo.ws/sudo/commit/?id=fafbc9a55)

* INSTALL:

  Add a note that –with-solaris-audit is only for Solaris 11 and above.
  [Bug #737](https://bugzilla.sudo.ws/show_bug.cgi?id=737)
  [[8509229eb]](https://git.sudo.ws/sudo/commit/?id=8509229eb)

2016-02-18 Todd C. Miller

* configure, configure.ac:

  Remove last remnants of the deprecated –with-stow option.
  [[4f7b0b115]](https://git.sudo.ws/sudo/commit/?id=4f7b0b115)

* src/Makefile.in:

  src/load\_plugins.c needs \_PATH\_SUDO\_CONF so allow it to be overridden
  via the Makefile like other consumers of \_PATH\_SUDO\_CONF. [Bug
  #735](https://bugzilla.sudo.ws/show_bug.cgi?id=735)
  [[42548a1b0]](https://git.sudo.ws/sudo/commit/?id=42548a1b0)

2016-02-01 Todd C. Miller

* configure, configure.ac, include/sudo\_util.h, lib/util/aix.c,
  lib/util/getgrouplist.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil.h, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/set\_perms.c, src/sudo.c:

  Add an administrative domain to the passwd/group cache key for AIX which
  can have different name <-> ID mappings depending on whether the
  database is local, LDAP, etc.
  [[6cbba7d66]](https://git.sudo.ws/sudo/commit/?id=6cbba7d66)

* mkpkg, sudo.pp:

  Fedora dropped “core” from the name some time ago so just match on
  f[0-9] for the rpm distro name provided by pp. Since the version numbers
  of Fedora and RHEL are so different switch to defining variables to
  indicate which features should be enabled. Works for Fedora 23.
  [[9b19ea440]](https://git.sudo.ws/sudo/commit/?id=9b19ea440)

2016-01-31 Todd C. Miller

* mkpkg, sudo.pp:

  Treat fedora core like centos/rhel for package building.
  [[25abb7218]](https://git.sudo.ws/sudo/commit/?id=25abb7218)

2016-01-29 Todd C. Miller

* plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/parser/check\_fill.c:

  Plug some memory leaks in the tests.
  [[73163c750]](https://git.sudo.ws/sudo/commit/?id=73163c750)

* plugins/sudoers/toke\_util.c:

  If realloc of sudoerslval.command.args fails, reset
  sudoerslval.command.args as well as arg\_len and arg\_size after freeing
  sudoerslval.command.args.
  [[2224cfd00]](https://git.sudo.ws/sudo/commit/?id=2224cfd00)

* src/exec\_pty.c:

  When freeing the iobs after pty tear-down, also free the associated
  event structures. Quiets a memory leak warnings from address sanitizer
  and valgrind.
  [[a7e5ae1e5]](https://git.sudo.ws/sudo/commit/?id=a7e5ae1e5)

2016-01-28 Todd C. Miller

* plugins/sudoers/iolog.c:

  iolog\_compress should be bool, not int
  [[5cbe1edcf]](https://git.sudo.ws/sudo/commit/?id=5cbe1edcf)

* plugins/sudoers/visudo.c:

  Quiet address sanitizer leak detector.
  [[3bebdfea7]](https://git.sudo.ws/sudo/commit/?id=3bebdfea7)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/env.c,
  plugins/sudoers/gc.c, plugins/sudoers/sudoers.h:

  Simple garbage collection (really a to-be-freed list) for the sudoers
  plugin. Almost identical to what sudo.c uses. Currenly only the
  environment strings are collected at exit time which is enough to quiet
  address sanitizer’s leak detector.
  [[21d6fc3d8]](https://git.sudo.ws/sudo/commit/?id=21d6fc3d8)

* src/sudo.c:

  Rename gc\_cleanup to gc\_run and remove I/O plugins from the plugin list
  when freeing them.
  [[7b2fbed45]](https://git.sudo.ws/sudo/commit/?id=7b2fbed45)

* src/sudo.c:

  Free up the garbage via an atexit() handler instead of requiring a call
  to gc\_exit.
  [[23aeb0b5e]](https://git.sudo.ws/sudo/commit/?id=23aeb0b5e)

* src/sudo\_edit.c:

  Plug a memory leak in sudo\_edit.
  [[78ac87cd9]](https://git.sudo.ws/sudo/commit/?id=78ac87cd9)

2016-01-27 Todd C. Miller

* INSTALL:

  mention –enable-asan
  [[fd9f01006]](https://git.sudo.ws/sudo/commit/?id=fd9f01006)

* plugins/sudoers/auth/sudo\_auth.c:

  Try to deconfuse static analyzers a bit.
  [[873d5cc5f]](https://git.sudo.ws/sudo/commit/?id=873d5cc5f)

* plugins/sudoers/sssd.c:

  Avoid possible NULL deref found by clang analyzer.
  [[23a82ab2e]](https://git.sudo.ws/sudo/commit/?id=23a82ab2e)

* config.h.in, configure, configure.ac:

  Add –enable-asan configure flag to enable address sanitizer
  [[3d0b0f061]](https://git.sudo.ws/sudo/commit/?id=3d0b0f061)

* src/sudo.c, src/sudo\_plugin\_int.h, src/ttyname.c:

  Add support for garbage collecting info passed to the plugin before exit
  to appease address sanitizer’s leak detector (and valgrind’s leak
  checker). We can’t free these sooner since the plugin may be using the
  memory. For plugin API 2.0 it should be make clear that the plugin must
  make a copy of the data in the arrays passed in to the plugin’s open()
  function. Only enabled if NO\_LEAKS is defined.
  [[9b3ef072f]](https://git.sudo.ws/sudo/commit/?id=9b3ef072f)

* plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c:

  auth\_getpass() returns a dynamically allocated copy of the plaintext
  password which needs to be freed after checking (and clearing) it.
  [[ab11cdde2]](https://git.sudo.ws/sudo/commit/?id=ab11cdde2)

* src/sudo.c:

  Remove sudo\_fatalx() calls from format\_plugin\_settings().
  [[91bce65e2]](https://git.sudo.ws/sudo/commit/?id=91bce65e2)

* plugins/sudoers/sssd.c:

  fn\_free\_result() (aka sss\_sudo\_free\_result() in sss\_sudo.c) handles a
  NULL poiner so there’s no need to check before calling it. Add missing
  initialization of sss\_sudo\_result to NULL in sudo\_sss\_setdefs().
  [[e48ceebf1]](https://git.sudo.ws/sudo/commit/?id=e48ceebf1)

* plugins/sudoers/sssd.c:

  Add missing return when user is not found in sudo\_sss\_result\_get().
  Previously we fell through to the default case which just logged a debug
  message and returned so this just avoids the extra (generic) debug
  message.
  [[60ea106cc]](https://git.sudo.ws/sudo/commit/?id=60ea106cc)

2016-01-26 Todd C. Miller

* lib/util/gettime.c:

  Fix a warning on AIX.
  [[6635f97b3]](https://git.sudo.ws/sudo/commit/?id=6635f97b3)

* src/sudo.c:

  Pass updated user\_env\_out, not envp, to the I/O open function.
  [[5507b2328]](https://git.sudo.ws/sudo/commit/?id=5507b2328)

* src/sudo.c:

  Pass updated argv/envp to the I/O open function like the plugin API
  documents.
  [[ca330adad]](https://git.sudo.ws/sudo/commit/?id=ca330adad)

2016-01-25 Todd C. Miller

* plugins/sudoers/iolog.c:

  Add check for I/O log file handle being NULL. This could only happen if
  the front-end calls iolog\_open with argc == 0 but actually runs a
  command.
  [[a6886d234]](https://git.sudo.ws/sudo/commit/?id=a6886d234)

2016-01-22 Todd C. Miller

* plugins/sudoers/pwutil.c:

  Additional debugging for pwutil functions.
  [[c28f59271]](https://git.sudo.ws/sudo/commit/?id=c28f59271)

* config.h.in, configure, configure.ac, lib/util/aix.c:

  When calling setauthdb(), save the old registry value so we can restore
  it properly. Previously we were setting the registry to unrestricted
  instead of actually restoring it.
  [[41a32a1c5]](https://git.sudo.ws/sudo/commit/?id=41a32a1c5)

* plugins/sudoers/sudoers.c:

  Use SUDOERS\_DEBUG\_UTIL not SUDO\_DEBUG\_UTIL in the plugin.
  [[578be4f39]](https://git.sudo.ws/sudo/commit/?id=578be4f39)

2016-01-21 Todd C. Miller

* lib/util/sudo\_debug.c:

  When parsing debug entries, don’t make a lower value override a higher
  one. For example, for “pcomm@debug,all@warn” the “all@warn” should
  not set pcomm to “warn” when it is already at “debug”.
  [[5016fa23d]](https://git.sudo.ws/sudo/commit/?id=5016fa23d)

2016-01-20 Todd C. Miller

* plugins/sudoers/policy.c:

  Set sudoedit\_checkdir=false in command\_details when it is disabled in
  sudoers.
  [[7ed519125]](https://git.sudo.ws/sudo/commit/?id=7ed519125)

* include/sudo\_compat.h, lib/util/strtobool.c, plugins/sudoers/ldap.c,
  plugins/sudoers/sssd.c, src/sudo\_edit.c:

  Update copyright year
  [[f4e5b135b]](https://git.sudo.ws/sudo/commit/?id=f4e5b135b)

* src/sudo\_edit.c:

  If the user runs “sudoedit /” we will receive ENOENT from openat(2) and
  sudoedit will try to create a file with the null string. If path is
  empty, open the cwd instead so sudoedit can give a sensible error
  message.
  [[726b4dc96]](https://git.sudo.ws/sudo/commit/?id=726b4dc96)

* lib/util/strtobool.c:

  Log an error for invalid boolean strings.
  [[399ec8b2b]](https://git.sudo.ws/sudo/commit/?id=399ec8b2b)

* src/sudo.c:

  Fix off by one error in new SET\_FLAG macro.
  [[5bae35c05]](https://git.sudo.ws/sudo/commit/?id=5bae35c05)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document the race with sudoedit\_checkdir in 1.8.15.
  [[ec37504df]](https://git.sudo.ws/sudo/commit/?id=ec37504df)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Document sudoedit\_checkdir
  [[42671f6b9]](https://git.sudo.ws/sudo/commit/?id=42671f6b9)

2016-01-19 Todd C. Miller

* src/sudo\_edit.c:

  There are no systems that support O\_SEARCH/O\_PATH that do not also
  support O\_DIRECTORY so simplify the definition of DIR\_OPEN\_FLAGS a bit.
  [[5e300f1e4]](https://git.sudo.ws/sudo/commit/?id=5e300f1e4)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[5dae4d3f3]](https://git.sudo.ws/sudo/commit/?id=5dae4d3f3)

* NEWS, doc/UPGRADE:

  Add 1.8.16 changes
  [[647bfa4a9]](https://git.sudo.ws/sudo/commit/?id=647bfa4a9)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/defaults.c,
  src/sudo.c:

  Make sudoedit\_checkdir the default and update the documentation
  accordingly.
  [[de0208a01]](https://git.sudo.ws/sudo/commit/?id=de0208a01)

* src/sudo.c:

  Add a SET\_FLAG macro to simplify parsing command details boolean flags.
  Previously, flags were only set and never cleared even if the boolean
  value was false. This was not a problem as there were no default flags
  for the plugin to enable. That will change in the future.
  [[e719d954e]](https://git.sudo.ws/sudo/commit/?id=e719d954e)

2016-01-18 Todd C. Miller

* src/sudo\_edit.c:

  Need to be root when switching to a different user.
  [[4b96e94f3]](https://git.sudo.ws/sudo/commit/?id=4b96e94f3)

* src/sudo\_edit.c:

  Use O\_SEARCH on systems without O\_PATH if present. It can be used for a
  similar purpose.
  [[9f481f128]](https://git.sudo.ws/sudo/commit/?id=9f481f128)

* config.h.in, configure, configure.ac, src/sudo\_edit.c:

  Use faccessat(2) for directory writability instead of doing the checks
  manually where possible. This also allows us to remove the #ifdef
  **linux** bits since we no longer use fstat(2) on Linux with an O\_PATH
  fd.
  [[c1b148120]](https://git.sudo.ws/sudo/commit/?id=c1b148120)

2016-01-16 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Add “I/O LOG FILES” section to the manual and move many of the details
  from the log\_input and log\_output descriptions to it.
  [[7f8a29dfc]](https://git.sudo.ws/sudo/commit/?id=7f8a29dfc)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Use “Nm sudoers” when talking about the plugin and “Em sudoers” when
  talking about the sudoers file.
  [[ad8c96403]](https://git.sudo.ws/sudo/commit/?id=ad8c96403)

2016-01-13 Todd C. Miller

* lib/zlib/zlib.exp:

  Remove gzopen\_w which is only defined on Windows.
  [[12a8becd7]](https://git.sudo.ws/sudo/commit/?id=12a8becd7)

* config.h.in, configure, configure.ac, include/sudo\_compat.h:

  Work around the buggy pread(2) on 32-bit HP-UX 11.00 by using pread64()
  on that platform.
  [[4bcef637f]](https://git.sudo.ws/sudo/commit/?id=4bcef637f)

2016-01-12 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/ldap.c, plugins/sudoers/match.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/sssd.c, plugins/sudoers/testsudoers.c:

  Add support for matching the entire netgroup tuple (user, host, domain).
  [[5a77989a3]](https://git.sudo.ws/sudo/commit/?id=5a77989a3)

* plugins/sudoers/ldap.c:

  Use asprintf() to generate the netgroup filter instead of using lots of
  concatenation.
  [[9d7bc0311]](https://git.sudo.ws/sudo/commit/?id=9d7bc0311)

* lib/util/util.exp.in:

  Add missing sudo\_debug\_exit\_ssize\_t\_v1 symbol.
  [[f97eba71f]](https://git.sudo.ws/sudo/commit/?id=f97eba71f)

2016-01-11 Todd C. Miller

* plugins/sudoers/ldap.c:

  In sudo\_netgroup\_lookup() only build up the search filter once instead
  of once per netgroup\_base.
  [[55fdf66c1]](https://git.sudo.ws/sudo/commit/?id=55fdf66c1)

* plugins/sudoers/ldap.c:

  It is safe to pass ldap\_msgfree() a NULL pointer.
  [[7c454656d]](https://git.sudo.ws/sudo/commit/?id=7c454656d)

* plugins/sudoers/ldap.c:

  On overflow, warn before freeing anything.
  [[ae5a2f407]](https://git.sudo.ws/sudo/commit/?id=ae5a2f407)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Use user\_runhost and user\_srunhost instead of user\_host and user\_shost.
  Fixes “sudo -l -h other\_host” for LDAP and sssd.
  [[0f991ff78]](https://git.sudo.ws/sudo/commit/?id=0f991ff78)

* plugins/sudoers/match.c:

  Silence warning in digest\_matches() on systems with no fexecve(2).
  [[089b468de]](https://git.sudo.ws/sudo/commit/?id=089b468de)

* plugins/sudoers/sssd.c:

  Fix free() of invalid pointer introduced in the commit that stripped
  whitespace between a ‘!’ and the name in a sudoOption.
  [[9308d05e7]](https://git.sudo.ws/sudo/commit/?id=9308d05e7)

* plugins/sudoers/ldap.c:

  Fix free() of invalid pointer introduced in the commit that stripped
  whitespace between a ‘!’ and the name in a sudoOption.
  [[14b454cc0]](https://git.sudo.ws/sudo/commit/?id=14b454cc0)

* src/sudo\_edit.c:

  Add missing dfd argument to the version of sudo\_edit\_openat\_nofollow()
  for systems without O\_NOFOLLOW.
  [[051fe2d4c]](https://git.sudo.ws/sudo/commit/?id=051fe2d4c)

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in:

  Update description of sudoedit\_checkdir. Reported by Sander Bos.
  [[8ed9f6172]](https://git.sudo.ws/sudo/commit/?id=8ed9f6172)

* src/sudo\_edit.c:

  No need to check whether the fd we opened is really a directory in
  sudo\_edit\_open\_nonwritable() since if not, the openat() will fail with
  ENOTDIR anyway.
  [[c7c80913e]](https://git.sudo.ws/sudo/commit/?id=c7c80913e)

2016-01-10 Todd C. Miller

* doc/CONTRIBUTORS, doc/UPGRADE, doc/sudoers.cat, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, include/sudo\_compat.h, src/sudo\_edit.c:

  Rewritten sudoedit\_checkdir support that checks all the dirs in the path
  and refuses to follow symlinks in writable directories. This is a better
  fix for CVE-2015-5602. Adapted from a diff by Ben Hutchings. [Bug
  #707](https://bugzilla.sudo.ws/show_bug.cgi?id=707)
  [[68c1073fe]](https://git.sudo.ws/sudo/commit/?id=68c1073fe)

2016-01-04 Todd C. Miller

* MANIFEST, plugins/sudoers/po/ca.mo, plugins/sudoers/po/ca.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po, po/ca.mo, po/ca.po,
  po/fi.mo, po/fi.po, po/hu.mo, po/hu.po, po/sr.mo, po/sr.po:

  sync with translationproject.org
  [[39db87e62]](https://git.sudo.ws/sudo/commit/?id=39db87e62)

* configure, configure.ac, doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in,
  doc/sudo\_plugin.mdoc.in, doc/sudoers.cat, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, include/sudo\_plugin.h, plugins/sudoers/match.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.h, src/exec.c,
  src/exec\_common.c, src/selinux.c, src/sesh.c, src/sudo.c, src/sudo.h,
  src/sudo\_exec.h:

  Add support for using fexecve() if supported on commands that are
  checksummed.
  [[b20977d44]](https://git.sudo.ws/sudo/commit/?id=b20977d44)

2015-12-29 Todd C. Miller

* src/sudo\_edit.c:

  Call openat() with the basename not the full path. From Ben Hutchings.
  [[97e86c74f]](https://git.sudo.ws/sudo/commit/?id=97e86c74f)

2015-12-24 Todd C. Miller

* plugins/sudoers/group\_plugin.c, plugins/sudoers/policy.c:

  Fix compilation with –disable-shared
  [[330a20969]](https://git.sudo.ws/sudo/commit/?id=330a20969)

2015-12-20 Todd C. Miller

* src/exec\_common.c:

  Check for existing dso in LD\_PRELOAD and only add it if it is not
  already present.
  [[88a634b7f]](https://git.sudo.ws/sudo/commit/?id=88a634b7f)

2015-12-18 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Clarify when SIGINT and SIGQUIT are relayed by sudo to the command.
  [[584aebe73]](https://git.sudo.ws/sudo/commit/?id=584aebe73)

* plugins/sudoers/group\_plugin.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h, src/load\_plugins.c:

  Actually use the plugin\_dir Path setting in sudo.conf.
  [[ad1068c1e]](https://git.sudo.ws/sudo/commit/?id=ad1068c1e)

* lib/util/sudo\_conf.c:

  The Path setting for the plugin directory is “plugin\_dir” not “plugin”.
  [[0123cf63f]](https://git.sudo.ws/sudo/commit/?id=0123cf63f)

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in,
  lib/util/sudo\_conf.c, src/exec\_common.c:

  Allow sudo.conf Path settings to disable path names (by setting the
  value of NULL).
  [[55531958d]](https://git.sudo.ws/sudo/commit/?id=55531958d)

2015-12-16 Todd C. Miller

* src/selinux.c, src/sudo.h:

  Change noexec flag in selinux\_execve() from int to bool.
  [[7a57bae1e]](https://git.sudo.ws/sudo/commit/?id=7a57bae1e)

* src/exec\_common.c, src/sudo\_exec.h:

  Refactor code to set LD\_PRELOAD (or the equivalent) in the environment
  into a preload\_dso() function. Also avoid allocating a new copy of the
  environment array if the size of the array does not change.
  [[453648080]](https://git.sudo.ws/sudo/commit/?id=453648080)

* configure, configure.ac:

  Add missing square brackets in configure option descriptions.
  [[3b338830c]](https://git.sudo.ws/sudo/commit/?id=3b338830c)

2015-12-11 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document the names of the I/O log files and mention buffering. Document
  that I/O logs are in gzip format by default.
  [[a6f8994a5]](https://git.sudo.ws/sudo/commit/?id=a6f8994a5)

2015-12-10 Todd C. Miller

* plugins/sudoers/env.c:

  Add BASHOPTS to initial\_badenv\_table[]; from Stephane Chazelas
  [[290dafda3]](https://git.sudo.ws/sudo/commit/?id=290dafda3)

2015-12-09 Todd C. Miller

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  When parsing sudoOptions that include an operator (!, +, +=, -=) strip
  out any whitespace on either side of the operator.
  [[d46d0fbc6]](https://git.sudo.ws/sudo/commit/?id=d46d0fbc6)

2015-12-08 Todd C. Miller

* plugins/sudoers/sudoers2ldif:

  Strip whitespace around ‘!’, ‘=’, ‘+=’ and ‘-=’ in Defaults entries.
  [[e2add4ae2]](https://git.sudo.ws/sudo/commit/?id=e2add4ae2)

2015-12-06 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document the race condition between the digest check and command
  execution.
  [[96201a275]](https://git.sudo.ws/sudo/commit/?id=96201a275)

2015-12-02 Todd C. Miller

* plugins/sudoers/ldap.c:

  When checking the query results, don’t set user\_matches in the netgroup
  pass unless sudo\_ldap\_check\_non\_unix\_group() returns true. This was
  preventing the mail\_no\_user sudoOption from being effective.
  [[29e9273a4]](https://git.sudo.ws/sudo/commit/?id=29e9273a4)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  In list mode, we always want to clear FLAG\_NO\_USER and FLAG\_NO\_HOST
  regardless of whether or not there was an actual match. Otherwise,
  warning mail may be sent which is not what we want in list mode. This is
  consistent with what the sudoers file backend does.
  [[9c9b487b0]](https://git.sudo.ws/sudo/commit/?id=9c9b487b0)

2015-11-22 Todd C. Miller

* plugins/sudoers/toke.h, plugins/sudoers/toke\_util.c:

  Use size\_t for length parameters in the fill functions used by the
  lexer.
  [[604d35034]](https://git.sudo.ws/sudo/commit/?id=604d35034)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Use yy\_size\_t for digest\_len since newer flex uses yy\_size\_t for yyleng.
  Old flex uses int for yyleng so we need to use a cast to avoid a sign
  compare warning.
  [[90e6bf318]](https://git.sudo.ws/sudo/commit/?id=90e6bf318)

2015-11-20 Todd C. Miller

* Makefile.in, README, configure, configure.ac,
  plugins/sudoers/regress/sudoers/test1.in, sudo.pp:

  Use https in sudo.ws urls
  [[d13bb39d1]](https://git.sudo.ws/sudo/commit/?id=d13bb39d1)

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.cat, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Use https in urls.
  [[79be007bd]](https://git.sudo.ws/sudo/commit/?id=79be007bd)

* configure, configure.ac:

  sudo 1.8.16
  [[48a95973a]](https://git.sudo.ws/sudo/commit/?id=48a95973a)

* plugins/sudoers/env.c:

  When preserving variables from the invoking user’s environment, if there
  are duplicates only keep the first instance.
  [[9c0354730]](https://git.sudo.ws/sudo/commit/?id=9c0354730)

2015-11-01 Todd C. Miller

* include/sudo\_debug.h, lib/util/parseln.c, lib/util/sudo\_debug.c,
  plugins/sudoers/timestamp.c:

  Add debug\_return\_ssize\_t
  [[8b12390ab]](https://git.sudo.ws/sudo/commit/?id=8b12390ab)

* plugins/sudoers/timestamp.c:

  Avoid compilation error on Solaris 10 with Stun Studio 12. [Bug
  #727](https://bugzilla.sudo.ws/show_bug.cgi?id=727)
  [[c6dad0001]](https://git.sudo.ws/sudo/commit/?id=c6dad0001)

2015-10-31 Todd C. Miller

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po, po/da.mo, po/da.po:

  sync with translationproject.org
  [[c752d91a3]](https://git.sudo.ws/sudo/commit/?id=c752d91a3)

* NEWS:

  Mention ssp configure fix.
  [[7fd8a7df3]](https://git.sudo.ws/sudo/commit/?id=7fd8a7df3)

2015-10-30 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/nl.mo, plugins/sudoers/po/nl.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/cs.mo,
  po/cs.po, po/de.mo, po/de.po, po/fr.mo, po/fr.po, po/it.mo, po/it.po,
  po/ja.mo, po/ja.po, po/nb.mo, po/nb.po, po/pl.mo, po/pl.po, po/pt\_BR.mo,
  po/pt\_BR.po, po/uk.mo, po/uk.po, po/vi.mo, po/vi.po, po/zh\_CN.mo,
  po/zh\_CN.po:

  sync with translationproject.org
  [[a012fba17]](https://git.sudo.ws/sudo/commit/?id=a012fba17)

* configure, configure.ac:

  Don’t use CPPFLAGS for the -fstack-protector check. Otherwise on systems
  with \_FORTIFY\_SOURCE support we’ll get an error due to the lack of
  optimization flags. [Bug
  #725](https://bugzilla.sudo.ws/show_bug.cgi?id=725)
  [[640e867db]](https://git.sudo.ws/sudo/commit/?id=640e867db)

* configure, configure.ac:

  When checking for stack protector support we need to actually link the
  test program.
  [[448f7f25f]](https://git.sudo.ws/sudo/commit/?id=448f7f25f)

2015-10-29 Todd C. Miller

* configure, configure.ac:

  Preserve LDFLAGS when checking for stack protector as they may include
  rpath settings to allow the stack protector lib to be found. Avoid using
  existing CFLAGS since we don’t want the compiler to optimize away the
  stack variable.
  [[b87ac0f0a]](https://git.sudo.ws/sudo/commit/?id=b87ac0f0a)

* configure, configure.ac:

  Better configure test for -fstack-protector. Some gcc installations may
  be missing the ssp library even though the compiler supports it.
  [[bdcb83be9]](https://git.sudo.ws/sudo/commit/?id=bdcb83be9)

2015-10-25 Todd C. Miller

* src/sudo\_edit.c:

  Set errno to EISDIR instead of ENOTDIR if directory is writable since
  ENOTDIR can be a legitimate errno. This avoids a bogus “directory is
  writable” error in that case.
  [[9ecf12daa]](https://git.sudo.ws/sudo/commit/?id=9ecf12daa)

* mkpkg:

  Fix the check for whether to include 32-bit arch in Mac OS X packages.
  [[e244b0cda]](https://git.sudo.ws/sudo/commit/?id=e244b0cda)

2015-10-24 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[202dd1ccf]](https://git.sudo.ws/sudo/commit/?id=202dd1ccf)

* NEWS, src/sudo\_edit.c:

  When creating a new file, sudoedit will now check that the file’s parent
  directory exists before running the editor.
  [[5d66b840d]](https://git.sudo.ws/sudo/commit/?id=5d66b840d)

* NEWS, doc/UPGRADE, doc/sudoers.cat, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/match.c:

  Add always\_query\_group\_plugin
  [[7761af6d7]](https://git.sudo.ws/sudo/commit/?id=7761af6d7)

2015-10-23 Todd C. Miller

* ABOUT-NLS, MANIFEST:

  Add ABOUT-NLS from GNU gettext.
  [[4f1912148]](https://git.sudo.ws/sudo/commit/?id=4f1912148)

* NEWS, config.h.in, configure, configure.ac, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers\_version.h, src/sudo.c,
  src/sudo.h, src/sudo\_edit.c:

  Add directory writability checks for sudoedit.
  [[c50cead83]](https://git.sudo.ws/sudo/commit/?id=c50cead83)

2015-10-06 Todd C. Miller

* NEWS:

  Latest.
  [[54a10726c]](https://git.sudo.ws/sudo/commit/?id=54a10726c)

* src/conversation.c:

  Ignore the SUDO\_CONV\_PROMPT\_ECHO\_OK flag when echo is enabled. This was
  preventing a match of SUDO\_CONV\_PROMPT\_ECHO\_ON which resulted in a
  masked password instead of an echoed one.
  [[e91a10ce4]](https://git.sudo.ws/sudo/commit/?id=e91a10ce4)

* plugins/sudoers/auth/bsdauth.c:

  Repair challenge/response prompting for BSD authentication which got
  broken while it was converted to use the conversation function.
  [[2afb2f204]](https://git.sudo.ws/sudo/commit/?id=2afb2f204)

* plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h:

  Use the auth\_getpass (and the plugin conversation fuction) for Tru64
  SIA. This prevents sudo from sleeping while holding the tty ticket lock.
  [[2ecda6d65]](https://git.sudo.ws/sudo/commit/?id=2ecda6d65)

* NEWS, doc/UPGRADE, plugins/sudoers/env.c:

  For env\_reset, SHELL should be set based on the target user, not the
  invoking user unless preserved via env\_keep.
  [[588460405]](https://git.sudo.ws/sudo/commit/?id=588460405)

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po:

  sync with translationproject.org
  [[e21a5a1cf]](https://git.sudo.ws/sudo/commit/?id=e21a5a1cf)

2015-10-05 Todd C. Miller

* NEWS:

  Hungarian and Slovak translations
  [[507150d8f]](https://git.sudo.ws/sudo/commit/?id=507150d8f)

* MANIFEST, doc/CONTRIBUTORS, plugins/sudoers/po/hu.mo,
  plugins/sudoers/po/hu.po, plugins/sudoers/po/sk.mo,
  plugins/sudoers/po/sk.po, po/sk.mo, po/sk.po:

  Add new Slovak and Hungarian translations from translationproject.org
  [[4c7431ecb]](https://git.sudo.ws/sudo/commit/?id=4c7431ecb)

2015-10-02 Todd C. Miller

* src/sudo\_edit.c:

  Remove S\_ISREG check from sudo\_edit\_open(), it is already done in the
  caller.
  [[6dc5151d5]](https://git.sudo.ws/sudo/commit/?id=6dc5151d5)

* src/sudo\_edit.c:

  Open sudoedit files with O\_NONBLOCK and fail if they are not regular
  files.
  [[37dff5fbc]](https://git.sudo.ws/sudo/commit/?id=37dff5fbc)

* plugins/sudoers/logging.c, plugins/sudoers/visudo.c, src/tgetpass.c:

  It is possible for WIFSTOPPED to be true even if waitpid() is not given
  WUNTRACED if the child is ptraced. Don’t exit the waitpid() loop if
  WIFSTOPPED is true, just in case.
  [[5ad68edd6]](https://git.sudo.ws/sudo/commit/?id=5ad68edd6)

2015-09-30 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/de.mo,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/it.mo,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/nb.mo,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pt\_BR.mo,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/vi.mo,
  plugins/sudoers/po/zh\_CN.mo, po/cs.mo, po/de.mo, po/fi.mo, po/fr.mo,
  po/gl.mo, po/it.mo, po/ja.mo, po/nb.mo, po/pl.mo, po/pt\_BR.mo, po/uk.mo,
  po/vi.mo, po/zh\_CN.mo:

  rebuild .mo files
  [[3f883a80a]](https://git.sudo.ws/sudo/commit/?id=3f883a80a)

* plugins/sudoers/po/pt\_BR.po, po/pt\_BR.po:

  sync with translationproject.org
  [[f98b2b260]](https://git.sudo.ws/sudo/commit/?id=f98b2b260)

2015-09-28 Todd C. Miller

* config.h.in, configure, configure.ac, src/sudo\_noexec.c:

  There’s no point in trying to interpose protected versions of the exec
  family of functions. Many modern C libraries use hidden symbols for the
  functions and syscalls defined in libc such that they cannot be
  overridden inside libc itself. We have to just wrap all the exec
  variants plus system and popen.
  [[37abc1b7e]](https://git.sudo.ws/sudo/commit/?id=37abc1b7e)

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  List all the functions wrapped by sudo\_noexec.so.
  [[d5086dfde]](https://git.sudo.ws/sudo/commit/?id=d5086dfde)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  The section is now called “EXEC and NOEXEC” and it is above, not below.
  [[6b81f0b88]](https://git.sudo.ws/sudo/commit/?id=6b81f0b88)

* src/sudo\_noexec.c:

  Also wrap popen(3).
  [[282b92133]](https://git.sudo.ws/sudo/commit/?id=282b92133)

* src/sudo\_noexec.c:

  Also interpose system(3). On glibc systems you cannot interpose the
  syscalls used internally by libc.
  [[8695ae104]](https://git.sudo.ws/sudo/commit/?id=8695ae104)

* src/conversation.c:

  Set active debug instance to sudo\_debug\_instance() during the
  conversation function.
  [[04457ecee]](https://git.sudo.ws/sudo/commit/?id=04457ecee)

2015-09-27 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  LOGNAME and USERNAME are set the same way as USER
  [[52ec12f52]](https://git.sudo.ws/sudo/commit/?id=52ec12f52)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Document behavior when the command dies from a signal in EXIT STATUS.
  [[4be48e784]](https://git.sudo.ws/sudo/commit/?id=4be48e784)

2015-09-26 Todd C. Miller

* NEWS:

  [Bug #722](https://bugzilla.sudo.ws/show_bug.cgi?id=722)
  [[99322bcf3]](https://git.sudo.ws/sudo/commit/?id=99322bcf3)

* src/sudo.c:

  When the command sudo is running is killed by a signal, sudo will now
  send itself the same signal with the default signal handler instead of
  exiting. The bash shell appears to ignore some signals, e.g. SIGINT,
  unless the command is killed by that signal. This makes the behavior of
  commands run under sudo the same as without sudo when bash is the shell.
  [Bug #722](https://bugzilla.sudo.ws/show_bug.cgi?id=722)
  [[9486afb4e]](https://git.sudo.ws/sudo/commit/?id=9486afb4e)

2015-09-25 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Adjust set\_logname description to new behavior when any of LOGNAME, USER
  or USERNAME are preserved.
  [[7b7db55db]](https://git.sudo.ws/sudo/commit/?id=7b7db55db)

* NEWS, plugins/sudoers/env.c:

  If some, but not all, of the LOGNAME, USER or USERNAME environment
  variables have been preserved from the invoking user’s environment, sudo
  will now use the preserved value to set the remaining variables instead
  of using the runas user. This ensures that if, for example, only LOGNAME
  is present in the env\_keep list, that sudo will not set USER and
  USERNAME to the runas user.
  [[29a3fcd06]](https://git.sudo.ws/sudo/commit/?id=29a3fcd06)

2015-09-24 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  Fix passing of the callback pointer to the conversation function. This
  was preventing the on\_suspend and on\_resume functions from being called
  on PAM systems.
  [[0649a261e]](https://git.sudo.ws/sudo/commit/?id=0649a261e)

* include/sudo\_plugin.h:

  Explicitly mark large hex constants unsigned.
  [[2c7ff33ea]](https://git.sudo.ws/sudo/commit/?id=2c7ff33ea)

* plugins/sudoers/timestamp.c:

  Cast sizeof(entry) to off\_t before making it a negative offset for
  lseek(). Fixes “sudo -k” on Solaris and probably others.
  [[118680eab]](https://git.sudo.ws/sudo/commit/?id=118680eab)

2015-09-21 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Add explicit mention of sudo’s netgroup semantics since they differ from
  most other netgroup consumers.
  [[824021b51]](https://git.sudo.ws/sudo/commit/?id=824021b51)

* plugins/sudoers/po/fi.po, po/fi.po:

  sync with translationproject.org
  [[80673750c]](https://git.sudo.ws/sudo/commit/?id=80673750c)

* plugins/sudoers/check.c:

  Fix potential double free of the cookie when sudo is suspended at the
  password prompt.
  [[0cfce655b]](https://git.sudo.ws/sudo/commit/?id=0cfce655b)

2015-09-16 Todd C. Miller

* plugins/sudoers/po/cs.po, plugins/sudoers/po/zh\_CN.po, po/cs.po,
  po/zh\_CN.po:

  sync with translationproject.org
  [[71d024632]](https://git.sudo.ws/sudo/commit/?id=71d024632)

2015-09-15 Todd C. Miller

* plugins/sudoers/po/de.po, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.po, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.po, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.po, po/de.po, po/fr.po, po/gl.po, po/it.po,
  po/ja.po, po/nb.po, po/pl.po, po/uk.po, po/vi.po:

  sync with translationproject.org
  [[51c2ef7ae]](https://git.sudo.ws/sudo/commit/?id=51c2ef7ae)

* NEWS:

  [Bug #719](https://bugzilla.sudo.ws/show_bug.cgi?id=719)
  [[43fd191cf]](https://git.sudo.ws/sudo/commit/?id=43fd191cf)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  SIGHUP is now relayed to the command. [Bug
  #719](https://bugzilla.sudo.ws/show_bug.cgi?id=719)
  [[3ac17b302]](https://git.sudo.ws/sudo/commit/?id=3ac17b302)

* src/exec.c:

  When a terminal device is closed, SIGHUP is sent to the controlling
  process associated with that terminal. It is not sent to the entire
  process group so sudo needs to relay SIGHUP to the command when it is
  not being run in a new pty. [Bug
  #719](https://bugzilla.sudo.ws/show_bug.cgi?id=719)
  [[3f6f1cd15]](https://git.sudo.ws/sudo/commit/?id=3f6f1cd15)

* NEWS:

  Mention visudo bug in 1.8.14
  [[b12500993]](https://git.sudo.ws/sudo/commit/?id=b12500993)

* plugins/sudoers/visudo.c:

  We reserved two slots at the end of the editor argv for the line number
  and the file name. However, resolve\_editor() adds “–” before the file
  names so the +line\_number is interpreted as a file name, not a line
  number so we need to overwrite the “–” as well.
  [[b6cb1b65c]](https://git.sudo.ws/sudo/commit/?id=b6cb1b65c)

2015-09-10 Todd C. Miller

* config.h.in, configure, configure.ac, lib/util/sig2str.c,
  lib/util/strsignal.c:

  Remove checks for \_\_sys\_siglist and \_\_sys\_signame. They are internal to
  libc and there are no known systems that export those symbols that do
  not already export the single underbar or no-underbar versions.
  [[a2979ed80]](https://git.sudo.ws/sudo/commit/?id=a2979ed80)

* plugins/sudoers/po/ru.mo, plugins/sudoers/po/ru.po, po/es.mo, po/es.po:

  Sync with translationproject.org
  [[9ff93c307]](https://git.sudo.ws/sudo/commit/?id=9ff93c307)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[4132f184e]](https://git.sudo.ws/sudo/commit/?id=4132f184e)

2015-09-09 Todd C. Miller

* src/tgetpass.c:

  Restore old signal handlers before tty settings. That way SIGTTOU is at
  its original value if sudo\_term\_restore() should fail.
  [[38b7aea6b]](https://git.sudo.ws/sudo/commit/?id=38b7aea6b)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Document what happens when the on\_suspend/on\_resume callbacks return an
  error.
  [[241174ea2]](https://git.sudo.ws/sudo/commit/?id=241174ea2)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h, plugins/group\_file/group\_file.c,
  plugins/group\_file/plugin\_test.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/policy.c, plugins/system\_group/system\_group.c,
  src/hooks.c:

  No need to have version macros for hooks, callbacks and the sudoers
  group plugin. We can just use the main sudo API macros. The sudoers
  group plugin macros are preserved for source compatibility but are not
  documented.
  [[edfeee6a7]](https://git.sudo.ws/sudo/commit/?id=edfeee6a7)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Properly escape the backslash before a comma in an example so the
  example rule is parsable by visudo.
  [[c45559e6c]](https://git.sudo.ws/sudo/commit/?id=c45559e6c)

* src/tgetpass.c:

  Ignore callbacks if major version doesn’t match.
  [[2f1d67505]](https://git.sudo.ws/sudo/commit/?id=2f1d67505)

* MANIFEST, config.h.in, configure, configure.ac,
  include/compat/timespec.h, lib/util/Makefile.in, lib/util/gettime.c,
  lib/util/utimens.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/visudo.c, src/Makefile.in, src/sudo\_edit.c:

  Remove include/compat/timespec.h. Systems old enough to lack struct
  timespec are too old to build a modern sudo.
  [[67183d74f]](https://git.sudo.ws/sudo/commit/?id=67183d74f)

* NEWS:

  [Bug #713](https://bugzilla.sudo.ws/show_bug.cgi?id=713)
  [[69d51b759]](https://git.sudo.ws/sudo/commit/?id=69d51b759)

* src/exec.c:

  Fill in cstat if exec\_setup() fails. Previously it was only filled in
  for an execve() failure. Fixes an unkillable sudo process when
  exec\_setup() fails and I/O logging is enabled.
  [[d08faa73a]](https://git.sudo.ws/sudo/commit/?id=d08faa73a)

* src/sudo.c:

  Fix running commands as non-root when neither setresuid() not setreuid()
  are available. At this point we are already root so setuid() must
  succeed. [Bug #713](https://bugzilla.sudo.ws/show_bug.cgi?id=713)
  [[27c2a3d15]](https://git.sudo.ws/sudo/commit/?id=27c2a3d15)

* src/sudo.c:

  Cast uid\_t to unsigned int when printing as %u
  [[0dbfbee03]](https://git.sudo.ws/sudo/commit/?id=0dbfbee03)

* doc/UPGRADE:

  Mention time stamp file locking changes, fix some spelling.
  [[2042aa2b7]](https://git.sudo.ws/sudo/commit/?id=2042aa2b7)

* NEWS:

  Update with latest changes.
  [[3fd97f6ba]](https://git.sudo.ws/sudo/commit/?id=3fd97f6ba)

2015-09-07 Todd C. Miller

* plugins/sudoers/check.c:

  Avoid touching the time stamp directory for “sudo -k command”
  [[9dedc65a7]](https://git.sudo.ws/sudo/commit/?id=9dedc65a7)

* plugins/sudoers/timestamp.c:

  Bring back the check for time stamp files that predate the boot time.
  Instead of truncating we now unlink the file since another process may
  be sleeping on the lock.
  [[69050f934]](https://git.sudo.ws/sudo/commit/?id=69050f934)

* config.h.in, configure, configure.ac, plugins/sudoers/iolog.c,
  plugins/sudoers/timestamp.c:

  Use pread(2) and pwrite(2) where possible.
  [[7d0a623fd]](https://git.sudo.ws/sudo/commit/?id=7d0a623fd)

* src/exec\_pty.c:

  sudo\_term\_\* already restart themselve for all but SIGTTOU so we don’t
  need to use our own restart loops.
  [[70914b332]](https://git.sudo.ws/sudo/commit/?id=70914b332)

* lib/util/locking.c:

  Set errno to EINVAL if sudo\_lock\_\* is called with a bad type.
  [[448b18de2]](https://git.sudo.ws/sudo/commit/?id=448b18de2)

* plugins/sudoers/timestamp.c:

  Adjust new locking to work when tty\_tickets is disabled. We need to use
  per-tty/ppid locking to gain exclusive access to the tty for the
  password prompt but use a separate (short term) lock that is shared
  among all sudo processes for the user.
  [[0487b6da9]](https://git.sudo.ws/sudo/commit/?id=0487b6da9)

* plugins/sudoers/timestamp.c:

  Allow the time stamp lock to be interrupted by signals.
  [[f9b8a4381]](https://git.sudo.ws/sudo/commit/?id=f9b8a4381)

* lib/util/term.c, plugins/sudoers/check.c, plugins/sudoers/sudoreplay.c,
  src/tgetpass.c:

  Implement suspend/resume callbacks for the conversation function. If
  suspended, close the timestamp file (dropping all locks). On resume,
  lock the record before reading the password.

  For this to work properly we need to be able to run th callback when
  tsetattr() suspends us, not just when the user does. To accomplish this
  the term\_\* functions now return EINTR if SIGTTOU would be generated. The
  caller now has to restart the term\_\* function (and send itself SIGTTOU)
  instead of it being done automatically.
  [[0c70df5de]](https://git.sudo.ws/sudo/commit/?id=0c70df5de)

* config.h.in, configure, configure.ac, include/sudo\_util.h,
  lib/util/locking.c, lib/util/util.exp.in, plugins/sudoers/check.c,
  plugins/sudoers/check.h, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/timestamp.c:

  Lock individual records in the timestamp file instead of the entire
  file. This will make it possible for multiple sudo processes using the
  same tty to serialize their timestamp lookups.
  [[00142c91f]](https://git.sudo.ws/sudo/commit/?id=00142c91f)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  include/sudo\_fatal.h, include/sudo\_plugin.h, lib/util/fatal.c,
  plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/auth/sudo\_auth.h,
  plugins/sudoers/check.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudoers.h, src/conversation.c, src/sudo.c, src/sudo.h,
  src/sudo\_plugin\_int.h, src/tgetpass.c:

  Add a struct sudo\_conv\_callback that contains on\_suspend and on\_resume
  function pointer args plus a closure pointer and at it to the
  conversation function.
  [[98a15d987]](https://git.sudo.ws/sudo/commit/?id=98a15d987)

2015-09-02 Todd C. Miller

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h:

  Make hook\_version and hook\_type unsigned.
  [[af4729380]](https://git.sudo.ws/sudo/commit/?id=af4729380)

2015-09-01 Todd C. Miller

* plugins/sudoers/base64.c, plugins/sudoers/match.c,
  plugins/sudoers/regress/parser/check\_base64.c:

  When decoding base64, avoid using ‘=’ in the decoded temporary array as
  a sentinel as it can legitimately be present. Instead, just use the
  count of bytes stored in the temp array to determine which bytes to fold
  into the destination.
  [[bfb1cead6]](https://git.sudo.ws/sudo/commit/?id=bfb1cead6)

2015-08-21 Todd C. Miller

* NEWS, plugins/sudoers/sudoers.c, plugins/sudoers/visudo.c:

  When parsing def\_editor, break out of the loop when we find the first
  valid editor. [Bug #714](https://bugzilla.sudo.ws/show_bug.cgi?id=714)
  [[333faa20e]](https://git.sudo.ws/sudo/commit/?id=333faa20e)

2015-08-18 Todd C. Miller

* plugins/sudoers/visudo.c:

  The condition for adding a missing newline at the end of sudoers was
  never reached. Keep track of the last character and write a newline
  character if when copying to the temp file. Found by Radovan Sroka.
  [[7df248716]](https://git.sudo.ws/sudo/commit/?id=7df248716)

* plugins/sudoers/sudoers.c, plugins/sudoers/visudo.c:

  Remove extraneous while() from botched do {} while() loop conversion to
  use sudo\_strsplit. Noticed by Radovan Sroka.
  [[7ef9b5827]](https://git.sudo.ws/sudo/commit/?id=7ef9b5827)

2015-08-10 Todd C. Miller

* plugins/sudoers/auth/pam.c, plugins/sudoers/auth/sudo\_auth.c:

  In sudo\_pam\_begin\_session() and sudo\_pam\_end\_session() return AUTH\_FATAL
  on error, not AUTH\_FAILURE. In sudo\_auth\_begin\_session() treat anything
  other than AUTH\_SUCCESS as a fatal error.
  [[2b6085760]](https://git.sudo.ws/sudo/commit/?id=2b6085760)

* doc/CONTRIBUTORS, src/exec.c, src/exec\_pty.c:

  Linux sets si\_pid in struct siginfo to 0 when the process that sent the
  signal is in a different container since the PID namespaces in different
  conatiners are separate. Avoid looking up the process group by id when
  si\_pid is 0 since getpgid(0) returns the process group of the current
  process. Since sudo ignores signals sent by processes in its own process
  group, this had the effect of ignoring signals sent from other
  containers. From Maarten de Vries
  [[13869d349]](https://git.sudo.ws/sudo/commit/?id=13869d349)

* plugins/sudoers/auth/pam.c:

  Sprinkle some debugging.
  [[db5376001]](https://git.sudo.ws/sudo/commit/?id=db5376001)

2015-08-09 Todd C. Miller

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.man.in,
  doc/sudo.mdoc.in:

  Document that sudo uses the real uid to map from uid to passwd file user
  name.
  [[ad9a51bd9]](https://git.sudo.ws/sudo/commit/?id=ad9a51bd9)

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in:

  disable\_coredump can be set to no on modern OSes without security
  consequences.
  [[b2f1bbfb0]](https://git.sudo.ws/sudo/commit/?id=b2f1bbfb0)

2015-08-07 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Emphasis on the never.
  [[f1053af3b]](https://git.sudo.ws/sudo/commit/?id=f1053af3b)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Explicitly tell people not to grant sudoedit to directories the user can
  write to. While sudoedit will no longer open symbolic links, hard links
  are still an issue.
  [[d4f1aeb19]](https://git.sudo.ws/sudo/commit/?id=d4f1aeb19)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Add warning about writable directories and sudo/sudoedit.
  [[c12dd68d1]](https://git.sudo.ws/sudo/commit/?id=c12dd68d1)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Emphasize that wildcards are not regexps. [Bug
  #692](https://bugzilla.sudo.ws/show_bug.cgi?id=692)
  [[796911b3f]](https://git.sudo.ws/sudo/commit/?id=796911b3f)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Emphasize that wildcards in command line arguments are dangerous.
  Document the failings of the passwd example on GNU systems. [Bug
  #691](https://bugzilla.sudo.ws/show_bug.cgi?id=691)
  [[329a8dee8]](https://git.sudo.ws/sudo/commit/?id=329a8dee8)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Escape the colons in [[:alpha:]] as required by sudoers.
  [[dc5ccf473]](https://git.sudo.ws/sudo/commit/?id=dc5ccf473)

* po/sudo.pot, src/sudo\_edit.c:

  Change warning when user tries to sudoedit a symbolic link.
  [[2fbce103f]](https://git.sudo.ws/sudo/commit/?id=2fbce103f)

2015-08-06 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[531bcc8aa]](https://git.sudo.ws/sudo/commit/?id=531bcc8aa)

* doc/sudo.conf.cat, doc/sudoers.ldap.cat, doc/sudoreplay.cat,
  doc/visudo.cat:

  regen
  [[5b2ea42d4]](https://git.sudo.ws/sudo/commit/?id=5b2ea42d4)

* doc/UPGRADE, doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  include/sudo\_compat.h, include/sudo\_plugin.h,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/gram.c,
  plugins/sudoers/gram.h, plugins/sudoers/gram.y, plugins/sudoers/ldap.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/policy.c, plugins/sudoers/regress/sudoers/test1.in,
  plugins/sudoers/regress/sudoers/test1.json.ok,
  plugins/sudoers/regress/sudoers/test1.out.ok,
  plugins/sudoers/regress/sudoers/test1.toke.ok,
  plugins/sudoers/sudoers\_version.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/visudo\_json.c, src/sesh.c, src/sudo.c, src/sudo.h,
  src/sudo\_edit.c:

  Do not follow symbolic links in sudoedit by default. This behavior can
  be controlled by the sudoedit\_follow Defaults flag as well as the
  FOLLOW/NOFOLLOW tags.
  [[3354d27a1]](https://git.sudo.ws/sudo/commit/?id=3354d27a1)

* NEWS, aclocal.m4, configure, configure.ac:

  Sudo 1.8.15
  [[079167d2c]](https://git.sudo.ws/sudo/commit/?id=079167d2c)

* MANIFEST:

  add .json regress files to MANIFEST
  [[f11e02ddd]](https://git.sudo.ws/sudo/commit/?id=f11e02ddd)

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/sudoers/test1.json.ok,
  plugins/sudoers/regress/sudoers/test10.json.ok,
  plugins/sudoers/regress/sudoers/test11.json.ok,
  plugins/sudoers/regress/sudoers/test12.json.ok,
  plugins/sudoers/regress/sudoers/test13.json.ok,
  plugins/sudoers/regress/sudoers/test14.json.ok,
  plugins/sudoers/regress/sudoers/test15.json.ok,
  plugins/sudoers/regress/sudoers/test16.json.ok,
  plugins/sudoers/regress/sudoers/test2.json.ok,
  plugins/sudoers/regress/sudoers/test3.json.ok,
  plugins/sudoers/regress/sudoers/test4.json.ok,
  plugins/sudoers/regress/sudoers/test5.json.ok,
  plugins/sudoers/regress/sudoers/test6.json.ok,
  plugins/sudoers/regress/sudoers/test7.json.ok,
  plugins/sudoers/regress/sudoers/test8.json.ok,
  plugins/sudoers/regress/sudoers/test9.json.ok:

  Check JSON output of sudoers test files too.
  [[4501b7416]](https://git.sudo.ws/sudo/commit/?id=4501b7416)

2015-08-04 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Move comment to match moved code.
  [[4abc13bfc]](https://git.sudo.ws/sudo/commit/?id=4abc13bfc)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  maxseq is an int not a string
  [[e0969c162]](https://git.sudo.ws/sudo/commit/?id=e0969c162)

2015-08-02 Todd C. Miller

* src/preserve\_fds.c:

  Include sys/types.h for id\_t. [Bug
  #711](https://bugzilla.sudo.ws/show_bug.cgi?id=711)
  [[918190fce]](https://git.sudo.ws/sudo/commit/?id=918190fce)

2015-07-31 Todd C. Miller

* lib/util/fnmatch.c:

  Avoid a potential out of bounds read found by enh while fuzzing with
  address sanitizer enabled.
  [[1965da8c3]](https://git.sudo.ws/sudo/commit/?id=1965da8c3)

2015-07-27 Todd C. Miller

* mkpkg:

  Set sssd lib location to /usr/lib64 on 64-bit RHEL/Centos. [Bug
  #710](https://bugzilla.sudo.ws/show_bug.cgi?id=710)
  [[d536626b1]](https://git.sudo.ws/sudo/commit/?id=d536626b1)

2015-07-08 Todd C. Miller

* doc/CONTRIBUTORS:

  Add Jakub Wilk
  [[01bfae5ba]](https://git.sudo.ws/sudo/commit/?id=01bfae5ba)

2015-07-24 Todd C. Miller

* doc/CONTRIBUTORS, src/Makefile.in:

  The init.d files are generated from a .in file so we need to install
  from top\_builddir not top\_srcdir. From Ross Burton. [Bug
  #708](https://bugzilla.sudo.ws/show_bug.cgi?id=708)
  [[ddd35459c]](https://git.sudo.ws/sudo/commit/?id=ddd35459c)

2015-07-22 Todd C. Miller

* lib/util/term.c:

  Replace two “return 0” with debug\_return\_bool(false).
  [[e941f97eb]](https://git.sudo.ws/sudo/commit/?id=e941f97eb)

* src/ttyname.c:

  fix typo in previous commit
  [[0765f5fe7]](https://git.sudo.ws/sudo/commit/?id=0765f5fe7)

* NEWS, configure, configure.ac:

  Sudo 1.8.14p3
  [[620f8a33e]](https://git.sudo.ws/sudo/commit/?id=620f8a33e)

2015-07-21 Todd C. Miller

* src/ttyname.c:

  Fix errno value from get\_process\_ttyname() when no tty is present.
  [[83d8cbf81]](https://git.sudo.ws/sudo/commit/?id=83d8cbf81)

* src/ttyname.c:

  On AIX, only convert the tty device number from dev64\_t to dev32\_t if
  dev\_t is 32-bits.
  [[aeaa6a611]](https://git.sudo.ws/sudo/commit/?id=aeaa6a611)

2015-07-20 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.8.14p2
  [[ef47c692c]](https://git.sudo.ws/sudo/commit/?id=ef47c692c)

* plugins/sudoers/timestamp.c:

  Fix creation of the timestamp file; bug #704
  [[8f8485797]](https://git.sudo.ws/sudo/commit/?id=8f8485797)

2015-07-19 Todd C. Miller

* src/regress/ttyname/check\_ttyname.c, src/sudo.c, src/sudo.h,
  src/ttyname.c:

  Avoid needless memory allocation when resolving the tty name.
  [[d96f8bcab]](https://git.sudo.ws/sudo/commit/?id=d96f8bcab)

2015-07-17 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.8.14p1
  [[c0b8e7148]](https://git.sudo.ws/sudo/commit/?id=c0b8e7148)

* plugins/sudoers/sssd.c:

  Fix typo in sudo\_sss\_attrcpy() that caused a memory allocation error.
  [[db8607fe4]](https://git.sudo.ws/sudo/commit/?id=db8607fe4)

2015-07-15 Todd C. Miller

* plugins/sudoers/po/ja.mo, plugins/sudoers/po/uk.mo,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/zh\_CN.mo:

  rebuild
  [[6eb4d142e]](https://git.sudo.ws/sudo/commit/?id=6eb4d142e)

2015-07-14 Todd C. Miller

* lib/util/lbuf.c, plugins/sudoers/env.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/interfaces.c,
  plugins/sudoers/match.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/redblack.c, src/hooks.c, src/net\_ifs.c, src/sudo.c:

  Add some debugging printfs when malloc fails and we don’t have an
  explicit call to sudo\_warnx().
  [[d4211081c]](https://git.sudo.ws/sudo/commit/?id=d4211081c)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c:

  Add missing warnings for memory allocation failure. Add function name to
  memory allocation warnings.
  [[108bfb7af]](https://git.sudo.ws/sudo/commit/?id=108bfb7af)

* lib/util/parseln.c:

  Return -1 if realloc() fails.
  [[3c644f5bc]](https://git.sudo.ws/sudo/commit/?id=3c644f5bc)

* lib/util/event.c, lib/util/event\_poll.c, lib/util/event\_select.c:

  Add line number to debug log for memory allocation errors.
  [[f2f5c2949]](https://git.sudo.ws/sudo/commit/?id=f2f5c2949)

* plugins/sudoers/auth/pam.c:

  Add warning if calloc() fails. Add debugging for other unexpected
  errors.
  [[7187c19c8]](https://git.sudo.ws/sudo/commit/?id=7187c19c8)

* plugins/sudoers/ldap.c:

  Add missing check for calloc(3) return value.
  [[ff5b6dbb6]](https://git.sudo.ws/sudo/commit/?id=ff5b6dbb6)

2015-07-13 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document that the values printed by “sudo -V” are affected by Defaults
  settings in sudoers.
  [[5125f82c4]](https://git.sudo.ws/sudo/commit/?id=5125f82c4)

2015-07-10 Todd C. Miller

* plugins/sudoers/group\_plugin.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/sssd.c, src/load\_plugins.c:

  Avoid calling dlerror() multiple times since it clear the error status
  after printing the error. Problem caused by sudo\_warn/sudo\_fatal being
  macros…
  [[374146f70]](https://git.sudo.ws/sudo/commit/?id=374146f70)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Attempt to clarify the conditions under which MAIL and HOME are set to
  the target user.
  [[42666204e]](https://git.sudo.ws/sudo/commit/?id=42666204e)

2015-07-09 Todd C. Miller

* mkpkg:

  Better checks for the libaudit package for Debian and error out if we
  can’t figure it out.
  [[4870060e9]](https://git.sudo.ws/sudo/commit/?id=4870060e9)

* mkpkg:

  Fix linux\_audit setting on non-multiarch Debian.
  [[d11ffce66]](https://git.sudo.ws/sudo/commit/?id=d11ffce66)

* sudo.pp:

  Fix typo that broke the linux\_audit dependency on Debian.
  [[246063609]](https://git.sudo.ws/sudo/commit/?id=246063609)

* NEWS:

  Mention /proc/stat btime fix.
  [[2f00f170f]](https://git.sudo.ws/sudo/commit/?id=2f00f170f)

* config.h.in, configure, configure.ac, lib/util/getaddrinfo.c,
  plugins/sudoers/interfaces.c, plugins/sudoers/match\_addr.c,
  src/net\_ifs.c:

  Solaris 2.6 has the prototypes for inet\_pton() and inet\_ntop() in
  resolv.h.
  [[43a57126e]](https://git.sudo.ws/sudo/commit/?id=43a57126e)

* plugins/sudoers/boottime.c:

  Sprinkle debugging for boottime.
  [[b73d96804]](https://git.sudo.ws/sudo/commit/?id=b73d96804)

* mkpkg:

  The old Solaris /bin/sh doesn’t support POSIX $( .. ) syntax, use
  backquotes instead.
  [[6c9e92aba]](https://git.sudo.ws/sudo/commit/?id=6c9e92aba)

2015-07-08 Todd C. Miller

* mkpkg, sudo.pp:

  Only use –with-sssd-lib on Debian/Ubuntu w/ multipackage. Use
  dpkg-query to determine the name of the audit package for proper
  dependencies.
  [[2d0699a07]](https://git.sudo.ws/sudo/commit/?id=2d0699a07)

* mkpkg, plugins/sudoers/sudoers.in, sudo.pp:

  Update Debian/Ubuntu packages to be more like the vendor ones. One
  notable exception is that sudo.ws packages use /var/run, not /var/lib
  for timestamp files.
  [[c3b4e4ce3]](https://git.sudo.ws/sudo/commit/?id=c3b4e4ce3)

* plugins/sudoers/boottime.c:

  Strip newline from /proc/stat btime line to avoid a strtonum() failure.
  From Jakub Wilk.
  [[06ad0f642]](https://git.sudo.ws/sudo/commit/?id=06ad0f642)

* src/exec\_pty.c:

  In io\_callback() service writes before reads. That way, if both
  SUDO\_EV\_READ and SUDO\_EV\_WRITE are set and read() returns 0 (EOF) we
  don’t close the fd before the write() is performed.

  If the write() returns EPIPE, ENXIO, EIO or EBADF, clear SUDO\_EV\_READ
  before we close the fd to avoid calling read() on a closed fd.
  [[61182c87e]](https://git.sudo.ws/sudo/commit/?id=61182c87e)

2015-07-07 Todd C. Miller

* lib/util/regress/sudo\_conf/conf\_test.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c, src/sesh.c,
  src/sudo.c:

  Check sudo\_conf\_read() return value and exit on fatal error (a warning
  was already printed by sudo\_conf\_read()).
  [[445e6f2e9]](https://git.sudo.ws/sudo/commit/?id=445e6f2e9)

* NEWS:

  Mention double-quoted sudoOption value support.
  [[4620bc31c]](https://git.sudo.ws/sudo/commit/?id=4620bc31c)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Add support for parsing quoted strings in a sudoOption just like sudoers
  Defaults settings.
  [[ea85db3ec]](https://git.sudo.ws/sudo/commit/?id=ea85db3ec)

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po, po/da.mo, po/da.po:

  Sync with translationproject.org
  [[e3586e2a4]](https://git.sudo.ws/sudo/commit/?id=e3586e2a4)

2015-07-06 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update year.
  [[d0be01517]](https://git.sudo.ws/sudo/commit/?id=d0be01517)

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po, po/de.mo, po/de.po,
  po/nb.mo, po/nb.po:

  Sync with translationproject.org
  [[d4dcc6505]](https://git.sudo.ws/sudo/commit/?id=d4dcc6505)

* src/sudo.c:

  Fix utmp setup broken by commit be0ca60facf8
  [[854c08495]](https://git.sudo.ws/sudo/commit/?id=854c08495)

2015-07-03 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/ja.po, plugins/sudoers/po/pl.mo,
  plugins/sudoers/po/pl.po, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.po, plugins/sudoers/po/zh\_CN.po, po/cs.mo,
  po/cs.po, po/fr.mo, po/fr.po, po/it.mo, po/it.po, po/pl.mo, po/pl.po:

  Sync with translationproject.org
  [[ef69b7c73]](https://git.sudo.ws/sudo/commit/?id=ef69b7c73)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[b3353b99d]](https://git.sudo.ws/sudo/commit/?id=b3353b99d)

* plugins/sudoers/logging.c:

  Fix typo in error message.
  [[701534c63]](https://git.sudo.ws/sudo/commit/?id=701534c63)

2015-07-02 Todd C. Miller

* NEWS:

  [Bug #702](https://bugzilla.sudo.ws/show_bug.cgi?id=702) is the AIX
  timespec issue.
  [[7583e8d76]](https://git.sudo.ws/sudo/commit/?id=7583e8d76)

* config.h.in, configure, configure.ac, lib/util/closefrom.c,
  lib/util/getcwd.c, lib/util/glob.c, plugins/sudoers/match.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, src/ttyname.c:

  We require POSIX so no need to conditionally include dirent.h. Add a
  check for d\_namlen and use the result in the NAMLEN macro.
  [[d77941c2b]](https://git.sudo.ws/sudo/commit/?id=d77941c2b)

* lib/util/event.c, lib/util/event\_poll.c, lib/util/event\_select.c,
  lib/util/getcwd.c, lib/util/gettime.c, lib/util/glob.c, lib/util/lbuf.c,
  lib/util/locking.c, lib/util/mktemp.c, lib/util/parseln.c,
  lib/util/secure\_path.c, lib/util/setgroups.c, lib/util/sudo\_conf.c,
  lib/util/sudo\_debug.c, lib/util/ttysize.c,
  plugins/group\_file/group\_file.c, plugins/sample/sample\_plugin.c,
  plugins/sudoers/alias.c, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/check.c, plugins/sudoers/defaults.c,
  plugins/sudoers/editor.c, plugins/sudoers/env.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/getspwuid.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/interfaces.c, plugins/sudoers/iolog.c,
  plugins/sudoers/ldap.c, plugins/sudoers/logging.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers\_debug.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c,
  plugins/sudoers/visudo\_json.c, plugins/system\_group/system\_group.c,
  src/conversation.c, src/exec.c, src/exec\_common.c, src/exec\_pty.c,
  src/get\_pty.c, src/hooks.c, src/load\_plugins.c, src/net\_ifs.c,
  src/openbsd.c, src/parse\_args.c, src/preserve\_fds.c, src/signal.c,
  src/solaris.c, src/sudo.c, src/sudo\_edit.c, src/sudo\_noexec.c,
  src/tgetpass.c, src/ttyname.c, src/utmp.c:

  There’s no need to conditionalize the #include <unistd.h>, we require
  a POSIX system.
  [[0b241088b]](https://git.sudo.ws/sudo/commit/?id=0b241088b)

* include/sudo\_compat.h:

  Remove some compatibilty defines that should no longer be needed.
  [[540b09b32]](https://git.sudo.ws/sudo/commit/?id=540b09b32)

2015-06-30 Todd C. Miller

* NEWS:

  Final changes in 1.8.14
  [[a89dd2f46]](https://git.sudo.ws/sudo/commit/?id=a89dd2f46)

* include/sudo\_compat.h:

  Need to include stddef.h to get rsize\_t on Mac OS X for sudo\_memset\_s()
  prototype.
  [[8f9aa5af2]](https://git.sudo.ws/sudo/commit/?id=8f9aa5af2)

* lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c:

  Add missing exit value.
  [[5e695d4cd]](https://git.sudo.ws/sudo/commit/?id=5e695d4cd)

* lib/util/regress/mktemp/mktemp\_test.c:

  Add missing fcntl.h include.
  [[662f9ec56]](https://git.sudo.ws/sudo/commit/?id=662f9ec56)

* configure, configure.ac:

  Do check for inet\_pton before inet\_ntop since we may need to record
  dependent libraries for inet\_pton when linking our getaddrinfo
  replacement.
  [[433c3dca5]](https://git.sudo.ws/sudo/commit/?id=433c3dca5)

* include/sudo\_debug.h, lib/util/sudo\_debug.c:

  Fix build on compilers w/o **func** or **FUNCTION**
  [[105f199f6]](https://git.sudo.ws/sudo/commit/?id=105f199f6)

* lib/util/util.exp.in:

  Remove sudo\_evasprintf\_v1, missed during alloc.c removal.
  [[44f7ed3b1]](https://git.sudo.ws/sudo/commit/?id=44f7ed3b1)

* lib/util/snprintf.c:

  Add missing fcntl.h include.
  [[b756b6a11]](https://git.sudo.ws/sudo/commit/?id=b756b6a11)

* config.h.in, configure, configure.ac:

  Add check for inline support.
  [[d87a0a4aa]](https://git.sudo.ws/sudo/commit/?id=d87a0a4aa)

2015-06-29 Todd C. Miller

* doc/LICENSE:

  Add reallocarray.c license.
  [[032729f1b]](https://git.sudo.ws/sudo/commit/?id=032729f1b)

2015-06-27 Todd C. Miller

* doc/CONTRIBUTORS:

  Fix entry for Joel Pelaez Jorge.
  [[2b4e44f33]](https://git.sudo.ws/sudo/commit/?id=2b4e44f33)

2015-06-26 Todd C. Miller

* include/sudo\_lbuf.h, lib/util/lbuf.c, lib/util/util.exp.in,
  plugins/sudoers/ldap.c, plugins/sudoers/parse.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.c:

  Add an error flag to the lbuf struct to simplify error checking. Callers
  of the lbuf functions now check the error flag to tell if a memory
  allocation error ocurred.
  [[54f9de6cc]](https://git.sudo.ws/sudo/commit/?id=54f9de6cc)

* plugins/sudoers/parse.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudo\_nss.h, plugins/sudoers/sudoers.h:

  display\_privs() and display\_cmnd() may need to return -1 on error.
  [[275141346]](https://git.sudo.ws/sudo/commit/?id=275141346)

2015-06-25 Todd C. Miller

* plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Return -1, not 0 from sudoers when there is an error (as opposed to a
  policy denial).
  [[d3bc17a61]](https://git.sudo.ws/sudo/commit/?id=d3bc17a61)

* plugins/sudoers/check.c, plugins/sudoers/check.h,
  plugins/sudoers/ldap.c, plugins/sudoers/logging.c,
  plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/timestamp.c:

  Check restore\_perms() return value in all cases, pushing the return
  value back up the call stack.
  [[81f94499b]](https://git.sudo.ws/sudo/commit/?id=81f94499b)

* doc/CONTRIBUTORS:

  Add Joel Pelaez Jorge
  [[c5ed416a7]](https://git.sudo.ws/sudo/commit/?id=c5ed416a7)

* plugins/sudoers/auth/pam.c:

  When checking whether the PAM prompt matches “Password:”, also check for
  the untranslated version. The PAM module might not be using the
  localized string even though it exists. From Joel Pelaez Jorge. Fixes
  [Bug #701](https://bugzilla.sudo.ws/show_bug.cgi?id=701)
  [[ea5ce39c9]](https://git.sudo.ws/sudo/commit/?id=ea5ce39c9)

2015-06-24 Todd C. Miller

* plugins/sudoers/ldap.c:

  Silence clang analyzer warning on glibc systems where the first argument
  to qsort() is marked as non-NULL. Also change some counters from into to
  unsigned int and two flags from int to bool.
  [[d84757951]](https://git.sudo.ws/sudo/commit/?id=d84757951)

2015-06-23 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Silence clang analyzer warning on glibc systems where the first argument
  to qsort() is marked as non-NULL.
  [[aedaac8cc]](https://git.sudo.ws/sudo/commit/?id=aedaac8cc)

* include/sudo\_compat.h, include/sudo\_debug.h, include/sudo\_util.h,
  src/preserve\_fds.c:

  Use our own bitmap macros instead of borrowing the ones from select.
  [[a76b93e23]](https://git.sudo.ws/sudo/commit/?id=a76b93e23)

* src/ttyname.c:

  Quiet clang analyzer false positive.
  [[7b086b684]](https://git.sudo.ws/sudo/commit/?id=7b086b684)

* src/sesh.c:

  Fix uninitialized variables warnings in error case when src file cannot
  be opened. At least one of these is a false positive.
  [[2aeeb54f3]](https://git.sudo.ws/sudo/commit/?id=2aeeb54f3)

* lib/util/sudo\_debug.c:

  Must call round\_nfds() with fd+1 since it takes a count not the fd
  number. In other words, the lowest value is 1, not 0.
  [[d36e46cb6]](https://git.sudo.ws/sudo/commit/?id=d36e46cb6)

2015-06-20 Todd C. Miller

* lib/util/getline.c, plugins/sudoers/toke\_util.c:

  It’s safe to rely on C89 semantics for realloc(NULL, size).
  [[d7224ea50]](https://git.sudo.ws/sudo/commit/?id=d7224ea50)

* plugins/sudoers/env.c:

  malloc() sets errno to ENOMEM on failure so we don’t need to set it
  explicitly.
  [[887a76489]](https://git.sudo.ws/sudo/commit/?id=887a76489)

* include/sudo\_compat.h:

  No longer need \_\_malloc\_like
  [[f6627e70b]](https://git.sudo.ws/sudo/commit/?id=f6627e70b)

* lib/util/util.exp.in:

  Remove symbols from the now-removed alloc.c.
  [[4da6468d5]](https://git.sudo.ws/sudo/commit/?id=4da6468d5)

* include/sudo\_compat.h, lib/util/aix.c, lib/util/closefrom.c,
  lib/util/event.c, lib/util/event\_poll.c, lib/util/event\_select.c,
  lib/util/getaddrinfo.c, lib/util/getcwd.c, lib/util/getgrouplist.c,
  lib/util/gethostname.c, lib/util/getline.c, lib/util/getopt\_long.c,
  lib/util/gettime.c, lib/util/gidlist.c, lib/util/glob.c,
  lib/util/key\_val.c, lib/util/lbuf.c, lib/util/locking.c,
  lib/util/mksiglist.c, lib/util/mksigname.c, lib/util/parseln.c,
  lib/util/progname.c, lib/util/pw\_dup.c, lib/util/reallocarray.c,
  lib/util/regress/atofoo/atofoo\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c, lib/util/setgroups.c,
  lib/util/sha2.c, lib/util/sig2str.c, lib/util/snprintf.c,
  lib/util/strndup.c, lib/util/strsplit.c, lib/util/strtobool.c,
  lib/util/strtoid.c, lib/util/strtomode.c, lib/util/strtonum.c,
  lib/util/sudo\_conf.c, lib/util/sudo\_debug.c, lib/util/sudo\_dso.c,
  lib/util/term.c, lib/util/ttysize.c, plugins/group\_file/getgrent.c,
  plugins/group\_file/group\_file.c, plugins/group\_file/plugin\_test.c,
  plugins/sample/sample\_plugin.c, plugins/sudoers/alias.c,
  plugins/sudoers/audit.c, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/base64.c, plugins/sudoers/boottime.c,
  plugins/sudoers/check.c, plugins/sudoers/defaults.c,
  plugins/sudoers/editor.c, plugins/sudoers/env.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/getdate.c,
  plugins/sudoers/getdate.y, plugins/sudoers/getspwuid.c,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/interfaces.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/locale.c,
  plugins/sudoers/logging.c, plugins/sudoers/logwrap.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/redblack.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/regress/parser/check\_hexchar.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudo\_printf.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers\_debug.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestamp.c, plugins/sudoers/timestr.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/visudo.c, plugins/sudoers/visudo\_json.c,
  plugins/system\_group/system\_group.c, src/conversation.c,
  src/env\_hooks.c, src/exec.c, src/exec\_common.c, src/exec\_pty.c,
  src/get\_pty.c, src/hooks.c, src/load\_plugins.c, src/net\_ifs.c,
  src/openbsd.c, src/parse\_args.c, src/preserve\_fds.c,
  src/regress/ttyname/check\_ttyname.c, src/selinux.c, src/signal.c,
  src/solaris.c, src/sudo.c, src/sudo\_edit.c, src/tgetpass.c,
  src/ttyname.c, src/utmp.c:

  Only include stddef.h where it is needed.
  [[4a07b472f]](https://git.sudo.ws/sudo/commit/?id=4a07b472f)

2015-06-19 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[941bfe309]](https://git.sudo.ws/sudo/commit/?id=941bfe309)

* lib/util/sudo\_conf.c, plugins/sudoers/locale.c:

  Better handling of setlocale() returning NULL.
  [[d8dd6512c]](https://git.sudo.ws/sudo/commit/?id=d8dd6512c)

* lib/util/aix.c, lib/util/gidlist.c, lib/util/sudo\_conf.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/defaults.c, plugins/sudoers/editor.c,
  plugins/sudoers/env.c, plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/ldap.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.c,
  plugins/sudoers/policy.c, plugins/sudoers/prompt.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers\_debug.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c,
  src/conversation.c, src/exec.c, src/exec\_common.c, src/exec\_pty.c,
  src/load\_plugins.c, src/parse\_args.c, src/preserve\_fds.c, src/selinux.c,
  src/sesh.c, src/sudo.c, src/sudo\_edit.c:

  Add function name to “unable to allocate memory” warnings.
  [[c36415417]](https://git.sudo.ws/sudo/commit/?id=c36415417)

* configure, configure.ac, include/sudo\_compat.h, lib/util/aix.c,
  lib/util/closefrom.c, lib/util/event.c, lib/util/event\_poll.c,
  lib/util/event\_select.c, lib/util/getaddrinfo.c, lib/util/getcwd.c,
  lib/util/getgrouplist.c, lib/util/gethostname.c, lib/util/getline.c,
  lib/util/getopt\_long.c, lib/util/gettime.c, lib/util/gidlist.c,
  lib/util/glob.c, lib/util/key\_val.c, lib/util/lbuf.c,
  lib/util/locking.c, lib/util/mksiglist.c, lib/util/mksigname.c,
  lib/util/parseln.c, lib/util/progname.c, lib/util/pw\_dup.c,
  lib/util/reallocarray.c, lib/util/regress/atofoo/atofoo\_test.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c, lib/util/setgroups.c,
  lib/util/sha2.c, lib/util/sig2str.c, lib/util/snprintf.c,
  lib/util/strndup.c, lib/util/strsplit.c, lib/util/strtobool.c,
  lib/util/strtoid.c, lib/util/strtomode.c, lib/util/strtonum.c,
  lib/util/sudo\_conf.c, lib/util/sudo\_debug.c, lib/util/sudo\_dso.c,
  lib/util/term.c, lib/util/ttysize.c, plugins/group\_file/getgrent.c,
  plugins/group\_file/group\_file.c, plugins/sample/sample\_plugin.c,
  plugins/sudoers/alias.c, plugins/sudoers/audit.c,
  plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/base64.c,
  plugins/sudoers/boottime.c, plugins/sudoers/check.c,
  plugins/sudoers/defaults.c, plugins/sudoers/editor.c,
  plugins/sudoers/env.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/getspwuid.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/interfaces.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/ldap.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/locale.c,
  plugins/sudoers/logging.c, plugins/sudoers/logwrap.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/redblack.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/regress/parser/check\_hexchar.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudo\_printf.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers\_debug.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestamp.c, plugins/sudoers/timestr.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/visudo.c, plugins/sudoers/visudo\_json.c,
  plugins/system\_group/system\_group.c, src/conversation.c,
  src/env\_hooks.c, src/exec.c, src/exec\_common.c, src/exec\_pty.c,
  src/get\_pty.c, src/hooks.c, src/load\_plugins.c, src/net\_ifs.c,
  src/openbsd.c, src/parse\_args.c, src/preserve\_fds.c,
  src/regress/ttyname/check\_ttyname.c, src/signal.c, src/solaris.c,
  src/sudo.c, src/sudo\_edit.c, src/tgetpass.c, src/ttyname.c, src/utmp.c:

  We require ANSI C so stop using the obsolete STDC\_HEADERS.
  [[dc883f245]](https://git.sudo.ws/sudo/commit/?id=dc883f245)

* config.h.in, configure, configure.ac:

  Add back \_REENTRANT define on HP-UX to expose strtok\_r on some versions.
  We may need to define it on other systems too.
  [[09b07fe21]](https://git.sudo.ws/sudo/commit/?id=09b07fe21)

* lib/util/getgrouplist.c, lib/util/regress/glob/globtest.c,
  lib/util/sudo\_debug.c, plugins/group\_file/getgrent.c,
  plugins/group\_file/plugin\_test.c, plugins/sample/sample\_plugin.c,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/interfaces.c,
  plugins/sudoers/ldap.c, plugins/sudoers/logging.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/tsgetgrpw.c:

  Use strtok\_r() instead of strtok()
  [[e2328479d]](https://git.sudo.ws/sudo/commit/?id=e2328479d)

* configure, configure.ac:

  Fix check for strnlen() when cross-compiling.
  [[048e251ae]](https://git.sudo.ws/sudo/commit/?id=048e251ae)

* plugins/sudoers/interfaces.c:

  Use sudo\_strsplit() in dump\_interfaces.
  [[69a4af9e7]](https://git.sudo.ws/sudo/commit/?id=69a4af9e7)

2015-06-18 Todd C. Miller

* lib/util/inet\_pton.c, lib/util/key\_val.c, lib/util/lbuf.c,
  lib/util/locking.c, lib/util/parseln.c,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/progname/progname\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c, lib/util/sha2.c,
  lib/util/snprintf.c, lib/util/strtobool.c, lib/util/term.c,
  plugins/group\_file/getgrent.c, plugins/group\_file/group\_file.c,
  plugins/sample/sample\_plugin.c, plugins/sudoers/boottime.c,
  plugins/sudoers/editor.c, plugins/sudoers/getdate.c,
  plugins/sudoers/getdate.y, plugins/sudoers/interfaces.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/policy.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_hexchar.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/tsgetgrpw.c, plugins/system\_group/system\_group.c,
  src/conversation.c, src/exec\_pty.c, src/net\_ifs.c, src/openbsd.c,
  src/preserve\_fds.c, src/regress/ttyname/check\_ttyname.c, src/solaris.c,
  src/sudo.c, src/tgetpass.c, src/ttyname.c, src/utmp.c:

  Remove obsolete memory.h include.
  [[4f9cabd00]](https://git.sudo.ws/sudo/commit/?id=4f9cabd00)

* config.h.in, configure, configure.ac, lib/util/getcwd.c,
  lib/util/gethostname.c, lib/util/glob.c, lib/util/locking.c,
  lib/util/parseln.c, lib/util/pw\_dup.c, lib/util/reallocarray.c,
  lib/util/snprintf.c, lib/util/strndup.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/toke\_util.c, src/env\_hooks.c:

  Remove support for the obsolete malloc.h header.
  [[a50555faa]](https://git.sudo.ws/sudo/commit/?id=a50555faa)

* config.h.in, configure, configure.ac, plugins/sudoers/defaults.c,
  plugins/sudoers/logging.c:

  Remove BROKEN\_SYSLOG define which was for obsolete versions of HP-UX.
  Remove last remnants of 4.2BSD syslog support.
  [[138aa2ccd]](https://git.sudo.ws/sudo/commit/?id=138aa2ccd)

* lib/util/sudo\_conf.c:

  Use sudo\_strsplit() instead of doing the equivalent manually.
  [[86fb8e15a]](https://git.sudo.ws/sudo/commit/?id=86fb8e15a)

* lib/util/regress/strsplit/strsplit\_test.c:

  Test strsplit behavior with an empty string.
  [[db3012645]](https://git.sudo.ws/sudo/commit/?id=db3012645)

* lib/util/Makefile.in, lib/zlib/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  Allow “make LIBTOOL=/path/to/libtool” to work properly.
  [[ea744042e]](https://git.sudo.ws/sudo/commit/?id=ea744042e)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/editor.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/goodpath.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/visudo.c:

  Use a common function for resolviong the user’s editor in sudoedit and
  visudo. The find\_path() function now returns a dynamically allocated
  path instead of using a static string.
  [[ac13264b4]](https://git.sudo.ws/sudo/commit/?id=ac13264b4)

* config.h.in, configure, configure.ac, lib/util/Makefile.in,
  lib/zlib/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Replace use of OSDEFS with config.h defines. Rename DEFS in Makefile.in
  to CPPDEFS and include in CPPFLAGS. Bring back \_BSD\_SOURCE as a config.h
  define. Remove obsolescent \_REENTRANT define.
  [[a38253b10]](https://git.sudo.ws/sudo/commit/?id=a38253b10)

2015-06-17 Todd C. Miller

* MANIFEST, include/sudo\_alloc.h, lib/util/Makefile.in, lib/util/alloc.c:

  Remove now-unused sudo\_alloc.h and alloc.c
  [[4be97a6c4]](https://git.sudo.ws/sudo/commit/?id=4be97a6c4)

* plugins/sudoers/Makefile.in, src/Makefile.in, src/conversation.c,
  src/env\_hooks.c, src/exec.c, src/exec\_common.c, src/exec\_pty.c,
  src/hooks.c, src/load\_plugins.c, src/net\_ifs.c, src/parse\_args.c,
  src/preserve\_fds.c, src/regress/ttyname/check\_ttyname.c, src/selinux.c,
  src/sesh.c, src/sudo.c, src/sudo.h, src/sudo\_edit.c, src/ttyname.c:

  Avoid using exiting allocators in the front end.
  [[cb63ca701]](https://git.sudo.ws/sudo/commit/?id=cb63ca701)

* include/sudo\_conf.h, include/sudo\_lbuf.h, lib/util/Makefile.in,
  lib/util/aix.c, lib/util/gidlist.c, lib/util/lbuf.c,
  lib/util/sudo\_conf.c, lib/util/sudo\_debug.c:

  Use non-exiting allocators in libsudo\_util.
  [[5ce50a885]](https://git.sudo.ws/sudo/commit/?id=5ce50a885)

* plugins/sudoers/ldap.c, plugins/sudoers/logging.c:

  Remove asprintf() return value warnings.
  [[ec7e467c5]](https://git.sudo.ws/sudo/commit/?id=ec7e467c5)

* config.h.in, configure, configure.ac:

  Use AC\_FUNC\_STRNLEN to check for broken strnlen() on AIX. This requires
  that we use AC\_USE\_SYSTEM\_EXTENSIONS so remove things from OSDEFS that
  are enabled by AC\_USE\_SYSTEM\_EXTENSIONS.
  [[4c7a264f1]](https://git.sudo.ws/sudo/commit/?id=4c7a264f1)

* plugins/sudoers/ldap.c:

  Remove extraneous semicolons in CHECK\_\* macros.
  [[f02874fe5]](https://git.sudo.ws/sudo/commit/?id=f02874fe5)

* plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Remove remaining SUDO\_MAIN remnants.
  [[07f981445]](https://git.sudo.ws/sudo/commit/?id=07f981445)

* plugins/sudoers/Makefile.in, plugins/sudoers/alias.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/check.c, plugins/sudoers/defaults.c,
  plugins/sudoers/defaults.h, plugins/sudoers/env.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/getspwuid.c,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/interfaces.c,
  plugins/sudoers/interfaces.h, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/locale.c, plugins/sudoers/logging.h,
  plugins/sudoers/match.c, plugins/sudoers/parse.c,
  plugins/sudoers/policy.c, plugins/sudoers/prompt.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/parser/check\_addr.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoers\_debug.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Use non-exiting allocatings in the sudoers plugin.
  [[d004b02fc]](https://git.sudo.ws/sudo/commit/?id=d004b02fc)

2015-06-16 Todd C. Miller

* plugins/sudoers/sssd.c:

  Use non-exiting allocators in the sudoers SSSD backend.
  [[6da04821d]](https://git.sudo.ws/sudo/commit/?id=6da04821d)

* plugins/sudoers/ldap.c:

  Use non-exiting allocators in the sudoers LDAP backend.
  [[5413637ae]](https://git.sudo.ws/sudo/commit/?id=5413637ae)

* lib/util/Makefile.in:

  regen dependencies
  [[2c63f1b5b]](https://git.sudo.ws/sudo/commit/?id=2c63f1b5b)

2015-06-15 Todd C. Miller

* configure, lib/util/Makefile.in, mkdep.pl:

  Add missing dependency info for reallocarray.lo in lib/util/Makefile.in
  and regen configure to match last configure.ac change.
  [[23d72149b]](https://git.sudo.ws/sudo/commit/?id=23d72149b)

* plugins/sudoers/ldap.c:

  Use \28 and \29 instead of ( and ) in the ldap query as per RFC 2254.
  Fixes netgroup queries on AIX. From Steven Soulen.
  [[ea34d0101]](https://git.sudo.ws/sudo/commit/?id=ea34d0101)

2015-06-13 Todd C. Miller

* lib/util/glob.c:

  Move pattern length check until after we have initialized the glob\_t so
  we can call globfree() even on error. From Frank Denis.
  [[f43f53098]](https://git.sudo.ws/sudo/commit/?id=f43f53098)

2015-06-12 Todd C. Miller

* plugins/sudoers/sudoers.c, src/sudo.c:

  We need to unlimit RLIMIT\_NPROC in sudoers as well as the sudo front end
  since set\_perms() and restore\_perms change the read uid and may fail
  with EAGAIN on Linux kernels prior to 3.1.
  [[25917e435]](https://git.sudo.ws/sudo/commit/?id=25917e435)

2015-06-08 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Fix underlining of “root” in -u option descriptions. [Bug
  #699](https://bugzilla.sudo.ws/show_bug.cgi?id=699)
  [[db8aae12e]](https://git.sudo.ws/sudo/commit/?id=db8aae12e)

* doc/UPGRADE, src/load\_plugins.c:

  Remove support for converting plugin.so -> plugin.sl on HP-UX when
  plugin.so can not be found. This was a temporary hack for using an older
  (pre 1.8.7) sudoers plugin with a newer sudo front-end.
  [[7107ce4d1]](https://git.sudo.ws/sudo/commit/?id=7107ce4d1)

2015-06-05 Todd C. Miller

* lib/util/event.c, lib/util/event\_select.c:

  Add debugging output on memory alloc failure. Add missing checks in
  event\_select.c for reallocarray() failure.
  [[c0fa0e248]](https://git.sudo.ws/sudo/commit/?id=c0fa0e248)

* lib/util/event\_poll.c:

  Use non-exiting allocators.
  [[564eb7e7d]](https://git.sudo.ws/sudo/commit/?id=564eb7e7d)

2015-06-04 Todd C. Miller

* plugins/sudoers/logging.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Bring back VALIDATE\_ERROR which will be used in the case of memory
  allocation errors.
  [[8eff57f07]](https://git.sudo.ws/sudo/commit/?id=8eff57f07)

2015-06-03 Todd C. Miller

* lib/util/snprintf.c:

  If asprintf() or vasprintf() fail, set the dest pointer to NULL like BSD
  and Solaris do. This appears to be the direction glibc is going as well.
  [[9884df8c9]](https://git.sudo.ws/sudo/commit/?id=9884df8c9)

2015-05-28 Todd C. Miller

* plugins/sudoers/env.c:

  Use a stack buffer for the validate\_env\_vars() error message.
  [[7a1cf7f53]](https://git.sudo.ws/sudo/commit/?id=7a1cf7f53)

2015-05-27 Todd C. Miller

* lib/util/fatal.c:

  Fix typo/thinko in static buffer conversion; use vsnprintf() not
  snprintf()
  [[1100d91e8]](https://git.sudo.ws/sudo/commit/?id=1100d91e8)

* plugins/sudoers/ldap.c:

  Fix old gcc2 variadic macro support.
  [[dee7a6dda]](https://git.sudo.ws/sudo/commit/?id=dee7a6dda)

* plugins/sudoers/visudo.c:

  Restore old behavior where visudo prevents you from making the main
  sudoers file zero length.
  [[21f5753b7]](https://git.sudo.ws/sudo/commit/?id=21f5753b7)

* plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/sudoers.c:

  Non-exiting allocators for log functions. If log\_allowed() fails the
  user may not run the command. We don’t try to return early for
  log\_failure(), log\_auth\_failure() or log\_denial() as we would not run
  the command in that case.
  [[9d1c408b7]](https://git.sudo.ws/sudo/commit/?id=9d1c408b7)

* plugins/sudoers/alias.c, plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c:

  Use non-exiting allocators in the parser (much of it already did).
  [[4da9e1097]](https://git.sudo.ws/sudo/commit/?id=4da9e1097)

* lib/util/aix.c, plugins/sudoers/pwutil.c, plugins/sudoers/pwutil\_impl.c:
  Use non-existing allocators in the passwd/group cache functions.
  [[6b7be032a]](https://git.sudo.ws/sudo/commit/?id=6b7be032a)

* MANIFEST, configure.ac, lib/util/alloc.c, lib/util/reallocarray.c:

  Add standalone reallocarray.c from OpenBSD instead of rolling our own.
  [[40d72f26e]](https://git.sudo.ws/sudo/commit/?id=40d72f26e)

* plugins/sudoers/alias.c, plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/iolog.c, plugins/sudoers/parse.h,
  plugins/sudoers/pwutil.c, plugins/sudoers/redblack.c,
  plugins/sudoers/redblack.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Use non-exiting allocators in the redblack tree and fix the fallout.
  Also switch to non-exiting allocators in affected code blocks.
  [[2bf454b74]](https://git.sudo.ws/sudo/commit/?id=2bf454b74)

* plugins/sudoers/alias.c, plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/parse.h:

  The error string returned by alias\_add should be const.
  [[46770c958]](https://git.sudo.ws/sudo/commit/?id=46770c958)

* plugins/sudoers/policy.c:

  Fix typo, efree vs. free.
  [[c5e4c3055]](https://git.sudo.ws/sudo/commit/?id=c5e4c3055)

* plugins/sudoers/policy.c, src/exec\_common.c, src/sudo.c:

  Add a few missing sudo\_new\_key\_val() return value checks. Also use
  non-exiting allocators for consistency.
  [[4131449ff]](https://git.sudo.ws/sudo/commit/?id=4131449ff)

2015-05-26 Todd C. Miller

* MANIFEST, lib/util/Makefile.in,
  lib/util/regress/parse\_gids/parse\_gids\_test.c,
  lib/util/regress/strsplit/strsplit\_test.c:

  Add unit tests for strsplit and parse\_gid\_list.
  [[8c3fd195d]](https://git.sudo.ws/sudo/commit/?id=8c3fd195d)

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in,
  lib/util/strsplit.c, lib/util/util.exp.in, plugins/sudoers/sudoers.c:

  Add sudo\_strsplit(), similar to strtok\_r() but non-destructive and
  operates on non-C strings (requires a length parameter).
  [[8d1708434]](https://git.sudo.ws/sudo/commit/?id=8d1708434)

2015-05-20 Todd C. Miller

* plugins/sudoers/auth/sia.c:

  Use reallocarray() instead of sudo\_emallocarray() and return an error on
  allocation failure.
  [[69e62f316]](https://git.sudo.ws/sudo/commit/?id=69e62f316)

* plugins/sudoers/auth/kerb5.c:

  In our krb5\_get\_init\_creds\_opt\_alloc() replacement use malloc() instead
  of sudo\_emalloc() and return KRB5\_CC\_NOMEM on allocation failure. Only
  old versions of Kerberos V will need this.
  [[212ff5d96]](https://git.sudo.ws/sudo/commit/?id=212ff5d96)

* lib/util/event.c, lib/util/event\_select.c:

  Use non-exiting allocators.
  [[6741fb537]](https://git.sudo.ws/sudo/commit/?id=6741fb537)

2015-05-26 Todd C. Miller

* lib/util/fatal.c:

  Use a static buffer for sudo\_warn/sudo\_fatal messages where possible.
  [[f18aa478d]](https://git.sudo.ws/sudo/commit/?id=f18aa478d)

* include/sudo\_compat.h:

  Fix sudo\_strnlen() prototype.
  [[11840308c]](https://git.sudo.ws/sudo/commit/?id=11840308c)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/strndup.c, mkdep.pl:

  Add strndup() for those without it. As strndup.c uses strnlen(), use our
  own if it is missing.
  [[82286d8b7]](https://git.sudo.ws/sudo/commit/?id=82286d8b7)

* lib/util/strnlen.c:

  Add missing sudo\_ prefix and include sudo\_compat.h.
  [[8437e3606]](https://git.sudo.ws/sudo/commit/?id=8437e3606)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/strnlen.c:

  Add strnlen() replacement needed for glob.c. Only used if no glob() and
  no strnlen().
  [[49d56f323]](https://git.sudo.ws/sudo/commit/?id=49d56f323)

2015-05-21 Todd C. Miller

* plugins/sudoers/logging.h, plugins/sudoers/sudoers.h:

  Get rid of SUDO\_MAIN. Modern compilers don’t warn about mixing extern
  and auto declarations unless they conflict.
  [[04128f598]](https://git.sudo.ws/sudo/commit/?id=04128f598)

* config.h.in, configure.ac, include/compat/endian.h,
  include/compat/fnmatch.h, include/compat/getaddrinfo.h,
  include/compat/getopt.h, include/compat/glob.h,
  include/compat/nss\_dbdefs.h, include/compat/sha2.h,
  include/compat/stdbool.h, include/compat/timespec.h,
  include/sudo\_alloc.h, include/sudo\_compat.h, include/sudo\_conf.h,
  include/sudo\_debug.h, include/sudo\_dso.h, include/sudo\_event.h,
  include/sudo\_fatal.h, include/sudo\_gettext.h, include/sudo\_lbuf.h,
  include/sudo\_plugin.h, include/sudo\_queue.h, include/sudo\_util.h,
  lib/util/fatal.c, plugins/sudoers/bsm\_audit.h, plugins/sudoers/check.h,
  plugins/sudoers/defaults.h, plugins/sudoers/ins\_2001.h,
  plugins/sudoers/ins\_classic.h, plugins/sudoers/ins\_csops.h,
  plugins/sudoers/ins\_goons.h, plugins/sudoers/insults.h,
  plugins/sudoers/interfaces.h, plugins/sudoers/iolog.h,
  plugins/sudoers/linux\_audit.h, plugins/sudoers/logging.h,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/pwutil.h, plugins/sudoers/redblack.c,
  plugins/sudoers/redblack.h,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/solaris\_audit.h, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.h, plugins/sudoers/sudo\_printf.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoers\_debug.h, plugins/sudoers/sudoers\_version.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/visudo.c, src/net\_ifs.c, src/sudo.h, src/sudo\_exec.h,
  src/sudo\_plugin\_int.h, src/sudo\_usage.h.in:

  Avoid using a leading underbar in defines as they are reserved in ISO C.
  [[05a01d4c5]](https://git.sudo.ws/sudo/commit/?id=05a01d4c5)

* Makefile.in, doc/Makefile.in, examples/Makefile.in, include/Makefile.in,
  lib/util/Makefile.in, lib/zlib/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/solaris\_audit.c, plugins/sudoers/sssd.c,
  plugins/system\_group/Makefile.in, src/Makefile.in, src/selinux.c:

  Add target for “make splint”. A few files need extra guards to avoid
  errors on systems where they would not otherwise be compiled. No
  warnings from splint.
  [[1298ea910]](https://git.sudo.ws/sudo/commit/?id=1298ea910)

2015-05-18 Todd C. Miller

* config.h.in, configure, configure.ac, src/sudo.c:

  There should be no need to check for tzset() as it is POSIX.
  [[a40cf3e28]](https://git.sudo.ws/sudo/commit/?id=a40cf3e28)

* configure, configure.ac:

  Add sudo\_reallocarrary to util.exp.in if reallocarray is not found.
  [[f1491fe13]](https://git.sudo.ws/sudo/commit/?id=f1491fe13)

2015-05-15 Todd C. Miller

* NEWS:

  NLS now works on Mac OS X properly.
  [[5c03b6b45]](https://git.sudo.ws/sudo/commit/?id=5c03b6b45)

* configure, configure.ac, src/Makefile.in:

  Force flat namespace on darwin to make the getenv() hooking work as it
  does on ELF.
  [[0b1e027b1]](https://git.sudo.ws/sudo/commit/?id=0b1e027b1)

2015-05-14 Todd C. Miller

* lib/util/alloc.c, lib/util/snprintf.c, plugins/sample/sample\_plugin.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/redblack.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke\_util.c:

  No need to cast malloc() return value.
  [[cbcaaa299]](https://git.sudo.ws/sudo/commit/?id=cbcaaa299)

* lib/util/getcwd.c, lib/util/getline.c, lib/util/glob.c,
  plugins/sudoers/env.c, plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Use reallocarray where possible.
  [[c75eb5bf0]](https://git.sudo.ws/sudo/commit/?id=c75eb5bf0)

* config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/alloc.c:

  Add reallocarray() for those without it.
  [[3595807f4]](https://git.sudo.ws/sudo/commit/?id=3595807f4)

2015-05-13 Todd C. Miller

* NEWS:

  The getenv() hook still doesn’t work on Mac OS X.
  [[0d418df03]](https://git.sudo.ws/sudo/commit/?id=0d418df03)

2015-05-12 Todd C. Miller

* include/sudo\_fatal.h, lib/util/fatal.c:

  In sudo\_warn\_gettext\_v1() call dgettext() not gettext() to make sure the
  domain is set correctly. The sudoers plugin uses its own text domain.
  [[80cb630bc]](https://git.sudo.ws/sudo/commit/?id=80cb630bc)

2015-05-11 Todd C. Miller

* doc/Makefile.in:

  man pages should explicitly depend on config.status since it is used to
  substitute in variables/settings.
  [[336b99ade]](https://git.sudo.ws/sudo/commit/?id=336b99ade)

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo\_plugin.cat, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoers.man.in, doc/sudoreplay.cat,
  doc/visudo.cat:

  regen
  [[c525c5ca7]](https://git.sudo.ws/sudo/commit/?id=c525c5ca7)

* NEWS, configure, configure.ac:

  Sudo 1.8.14
  [[051bf0d55]](https://git.sudo.ws/sudo/commit/?id=051bf0d55)

* INSTALL, MANIFEST, aclocal.m4, config.h.in, configure, configure.ac,
  include/sudo\_fatal.h, lib/util/Makefile.in, lib/util/fatal.c,
  lib/util/locale\_weak.c, lib/util/util.exp.in, m4/ax\_sys\_weak\_alias.m4,
  mkdep.pl, plugins/sudoers/Makefile.in, plugins/sudoers/locale.c,
  plugins/sudoers/logging.h, plugins/sudoers/sudoers.c, src/Makefile.in,
  src/locale\_stub.c:

  Instead of trying to make weak functions work on all platforms, just use
  a registration function for a plugin-specific setlocale function. The
  sudoers version just wraps sudoers\_setlocale().
  [[8bc70a635]](https://git.sudo.ws/sudo/commit/?id=8bc70a635)

* src/parse\_args.c:

  Fix indentation of -a flag help line.
  [[fc7143760]](https://git.sudo.ws/sudo/commit/?id=fc7143760)

* include/sudo\_compat.h:

  Fix compilation when HAVE\_DECL\_SIG2STR\_MAX is not defined.
  [[6ab599415]](https://git.sudo.ws/sudo/commit/?id=6ab599415)

* doc/Makefile.in:

  Add lint target to run “mandoc -Tlint” over the manuals.
  [[0c77de559]](https://git.sudo.ws/sudo/commit/?id=0c77de559)

2015-05-08 Todd C. Miller

* include/sudo\_compat.h:

  HAVE\_DECL\_SIG2STR\_MAX is always defined so use a !HAVE\_DECL\_SIG2STR\_MAX
  check instead of #ifndef.
  [[4ae1bdf9c]](https://git.sudo.ws/sudo/commit/?id=4ae1bdf9c)

2015-05-07 Todd C. Miller

* src/tgetpass.c:

  Sync tty\_present() with sudoers version.
  [[166ee6879]](https://git.sudo.ws/sudo/commit/?id=166ee6879)

* src/load\_plugins.c:

  sudo\_check\_plugin() returns bool.
  [[253008e62]](https://git.sudo.ws/sudo/commit/?id=253008e62)

* plugins/sudoers/match.c:

  In usergr\_matches() matched should be bool but we have to take care to
  handle group\_plugin\_query() returning a value other than 0/1.
  [[c80b9c945]](https://git.sudo.ws/sudo/commit/?id=c80b9c945)

* plugins/sudoers/ldap.c:

  sudo\_ldap\_check\_non\_unix\_group() returns bool, not int.
  [[d16434f97]](https://git.sudo.ws/sudo/commit/?id=d16434f97)

* plugins/sudoers/logging.c:

  Convert two debug\_return\_int to debug\_return\_bool.
  [[eea4e1afd]](https://git.sudo.ws/sudo/commit/?id=eea4e1afd)

* include/sudo\_debug.h, lib/util/sudo\_debug.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/check.c, plugins/sudoers/env.c,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/iolog.c,
  plugins/sudoers/ldap.c, plugins/sudoers/match.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.c, src/sudo.c:

  Previously, debug\_return\_bool was the same as debug\_return\_int except
  that it logged true/false for 1/0. However, this appears to trigger a
  bug in some compilers. To avoid this, debug\_return\_bool now uses bool,
  not int. Callers that were passing it an int have been converted to use
  debug\_return\_int instead.
  [[caf5d45e0]](https://git.sudo.ws/sudo/commit/?id=caf5d45e0)

* src/get\_pty.c, src/sudo.h:

  get\_pty() should return bool
  [[9c9ff3dc4]](https://git.sudo.ws/sudo/commit/?id=9c9ff3dc4)

* src/sudo.h, src/tgetpass.c:

  Make tty\_present static to tgetpass.c
  [[d2624ffa9]](https://git.sudo.ws/sudo/commit/?id=d2624ffa9)

* config.h.in, configure, configure.ac, include/sudo\_compat.h:

  Add configure check for SIG2STR\_MAX, which may be missing on UnixWare.
  [[5647736ef]](https://git.sudo.ws/sudo/commit/?id=5647736ef)

* m4/ax\_sys\_weak\_alias.m4:

  Need to quote $GCC as it may include arguments. From Tim Rice.
  [[e1b67e617]](https://git.sudo.ws/sudo/commit/?id=e1b67e617)

* MANIFEST:

  Add missing m4/ax\_sys\_weak\_alias.m4
  [[ff806216f]](https://git.sudo.ws/sudo/commit/?id=ff806216f)

2015-04-28 Todd C. Miller

* mkpkg:

  There’s no point in building i386 binaries for Mac OS X 10.7 and higher.
  [[f5f5e17cb]](https://git.sudo.ws/sudo/commit/?id=f5f5e17cb)

2015-04-27 Todd C. Miller

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/fr.mo, plugins/sudoers/po/fr.po, po/ja.mo, po/ja.po:

  Sync with translationproject.org
  [[ff89dde11]](https://git.sudo.ws/sudo/commit/?id=ff89dde11)

2015-04-26 Todd C. Miller

* plugins/sudoers/bsm\_audit.c:

  Only fall back on AUE\_DARWIN\_sudo if au\_preselect() fails.
  [[8930db0e0]](https://git.sudo.ws/sudo/commit/?id=8930db0e0)

2015-04-25 Todd C. Miller

* plugins/sudoers/bsm\_audit.c:

  Work around a problem on Mac OS X 10.10 which defines AUE\_sudo but where
  au\_preselect() only accepts AUE\_DARWIN\_sudo (the old value).
  [[8a1838364]](https://git.sudo.ws/sudo/commit/?id=8a1838364)

2015-04-22 Todd C. Miller

* src/env\_hooks.c:

  Don’t use dlsym() to find the libc getenv() since this may allocate
  memory on some systems (glibc) which leads to a hang if malloc() calls
  getenv() (jemalloc).
  [[3715ab57d]](https://git.sudo.ws/sudo/commit/?id=3715ab57d)

* src/sudo.c:

  Defer conversation initialization until right before plugins are
  initialized.
  [[41f3666a1]](https://git.sudo.ws/sudo/commit/?id=41f3666a1)

* include/sudo\_debug.h, src/sudo.c:

  Split variable declaration out of debug\_decl into debug\_decl\_vars() so
  we can use it in main() when we know sudo\_debug\_enter() cannot succeed.
  [[6f8af4d26]](https://git.sudo.ws/sudo/commit/?id=6f8af4d26)

2015-04-16 Todd C. Miller

* plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c:

  When creating a passwd struct from a uid that is not in the passwd
  database, set pw\_gid to the user’s gid instead of whatever the user
  specified via the -g flag (or 0 if no -g).
  [[e98778b2a]](https://git.sudo.ws/sudo/commit/?id=e98778b2a)

2015-04-14 Todd C. Miller

* plugins/sudoers/ldap.c:

  Add some ldap\_err2string() debugging when the LDAP search fails. Adapted
  from a diff from Steven Soulen.
  [[3de14196c]](https://git.sudo.ws/sudo/commit/?id=3de14196c)

2015-04-13 Todd C. Miller

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po, po/sr.mo, po/sr.po:

  Sync with translationproject.org
  [[db7404898]](https://git.sudo.ws/sudo/commit/?id=db7404898)

2015-04-10 Todd C. Miller

* doc/CONTRIBUTORS:

  Add David Michael and Andrey Klyachkin.
  [[28b64d296]](https://git.sudo.ws/sudo/commit/?id=28b64d296)

* sudo.pp:

  Sync tmpfiles.d/sudo.conf with init.d/sudo.conf.in
  [[02aa57c16]](https://git.sudo.ws/sudo/commit/?id=02aa57c16)

* include/sudo\_util.h:

  Avoid struct assignment when stashing mtime since AIX at least uses a
  struct st\_timespec that differs from struct timespec. From Andrey
  Klyachkin.
  [[9240018ce]](https://git.sudo.ws/sudo/commit/?id=9240018ce)

2015-04-09 Todd C. Miller

* sudo.pp:

  Work around a bug in pp that caused a warning when exampledir is a
  subdir of docdir.
  [[68339fa9c]](https://git.sudo.ws/sudo/commit/?id=68339fa9c)

* plugins/sudoers/solaris\_audit.c:

  Add sys/types.h
  [[a79f3790e]](https://git.sudo.ws/sudo/commit/?id=a79f3790e)

* lib/util/getopt\_long.c, lib/util/mksiglist.c, lib/util/mksigname.c,
  lib/util/regress/fnmatch/fnm\_test.c, lib/util/regress/glob/globtest.c,
  lib/util/sha2.c, plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_hexchar.c:

  Include sys/types.h instead of unistd.h to get uid\_t and gid\_t. Add
  missing include of sys/types.h to a few places.
  [[eeca3b0ca]](https://git.sudo.ws/sudo/commit/?id=eeca3b0ca)

2015-04-08 Todd C. Miller

* mkpkg:

  Remove unintended commit
  [[7e1c2fa00]](https://git.sudo.ws/sudo/commit/?id=7e1c2fa00)

* init.d/sudo.conf.in:

  Add tmpfiles.d/sudo.conf template.
  [[cfe7a4cb3]](https://git.sudo.ws/sudo/commit/?id=cfe7a4cb3)

2015-04-07 Todd C. Miller

* .hgignore, INSTALL, MANIFEST, Makefile.in, configure, configure.ac,
  mkpkg, src/Makefile.in, sudo.pp:

  Create template tmpfiles.d/sudo.conf for installation instead of
  creating one via echo commands in the Makefile.

  Add –enable-tmpfiles.d configure option to enable/disable use of
  tmpfiles.d and override the default directory.

  Use –disable-tmpfiles.d in mkpkg so we no longer need to ignore
  tmpfiles.d/sudo.conf in sudo.pp.
  [[fa3552fa7]](https://git.sudo.ws/sudo/commit/?id=fa3552fa7)

2015-04-06 Todd C. Miller

* INSTALL, Makefile.in, configure, configure.ac, doc/sudoers.mdoc.in,
  examples/Makefile.in, mkpkg, sudo.pp:

  Make exampledir configurable and default to DATAROOTDIR/examples/sudo on
  BSD systems.
  [[d297f5fd8]](https://git.sudo.ws/sudo/commit/?id=d297f5fd8)

2015-04-07 Todd C. Miller

* sudo.pp:

  Fix setting of pp\_rpm\_version when there is no patchlevel present. Also
  tighten up the regexp for pp\_rpm\_release.
  [[6d63ca32f]](https://git.sudo.ws/sudo/commit/?id=6d63ca32f)

2015-04-06 Todd C. Miller

* src/Makefile.in, sudo.pp:

  Install /usr/lib/tmpfiles.d/sudo.conf on systems with systemd but do not
  package it. For packages we create /usr/lib/tmpfiles.d/sudo.conf as
  needed in the postinstall script.
  [[f63896e7d]](https://git.sudo.ws/sudo/commit/?id=f63896e7d)

2015-03-22 Todd C. Miller

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.cat, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Fix “mandoc -Tlint” warnings. Sync AUTHORS section in man pages.
  Regenerate all man pages.
  [[cd669526e]](https://git.sudo.ws/sudo/commit/?id=cd669526e)

* lib/util/Makefile.in, plugins/sudoers/Makefile.in, src/Makefile.in:

  Make libsudo\_util depend on libintl instead of requiring users of
  libsudo\_util to link with libintl directly. [Bug
  #690](https://bugzilla.sudo.ws/show_bug.cgi?id=690)
  [[15037d3b7]](https://git.sudo.ws/sudo/commit/?id=15037d3b7)

2015-03-21 Todd C. Miller

* plugins/sudoers/logging.c:

  Use saved errno in vlog\_warning() before calling sudo\_vwarn\_nodebug().
  Fixes the error message printed if set\_perms() fails.
  [[3b3098440]](https://git.sudo.ws/sudo/commit/?id=3b3098440)

2015-03-18 Todd C. Miller

* NEWS:

  Update for 1.8.13 final.
  [[cfeda97b0]](https://git.sudo.ws/sudo/commit/?id=cfeda97b0)

2015-03-16 Todd C. Miller

* plugins/sudoers/env.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  For sudoedit, run the editor with the user’s original environment as per
  the documentation (and as in sudo 1.7.x). [Bug
  #688](https://bugzilla.sudo.ws/show_bug.cgi?id=688)
  [[be4872f69]](https://git.sudo.ws/sudo/commit/?id=be4872f69)

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po, po/fr.mo, po/fr.po:

  Sync with translationproject.org
  [[d8d6fae79]](https://git.sudo.ws/sudo/commit/?id=d8d6fae79)

2015-03-10 Todd C. Miller

* lib/util/term.c:

  Update function names in debug\_decl.
  [[8088806bd]](https://git.sudo.ws/sudo/commit/?id=8088806bd)

* lib/util/term.c:

  Use TCSAFLUSH instead of TCSANOW in sudo\_term\_copy(). Be consistent with
  where we put TCSASOFT in the action flags.
  [[ef1b2c3be]](https://git.sudo.ws/sudo/commit/?id=ef1b2c3be)

2015-03-09 Todd C. Miller

* plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/da.mo,
  po/da.po, po/fi.mo, po/fi.po, po/zh\_CN.mo, po/zh\_CN.po:

  Sync with translationproject.org
  [[0600a0d0a]](https://git.sudo.ws/sudo/commit/?id=0600a0d0a)

2015-03-08 Todd C. Miller

* lib/util/sha2.c:

  Include unistd.h since sudo\_compat.h uses gid\_t.
  [[9f2241693]](https://git.sudo.ws/sudo/commit/?id=9f2241693)

2015-03-05 Todd C. Miller

* INSTALL, configure, configure.ac:

  Add –disable-weak-symbols option to disable use of weak symbols in
  libsudo\_util.
  [[5cfd0cff9]](https://git.sudo.ws/sudo/commit/?id=5cfd0cff9)

* configure:

  regen
  [[1e724eac8]](https://git.sudo.ws/sudo/commit/?id=1e724eac8)

* m4/ax\_sys\_weak\_alias.m4:

  When checking for weak aliases, check the gcc attribute format last
  since some C compilers just ignore unsupported attributes.
  [[26f0d6d80]](https://git.sudo.ws/sudo/commit/?id=26f0d6d80)

* sudo.pp:

  Update copyright year.
  [[da092640b]](https://git.sudo.ws/sudo/commit/?id=da092640b)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po, po/cs.mo, po/cs.po,
  po/de.mo, po/de.po, po/eo.mo, po/eo.po, po/it.mo, po/it.po, po/nb.mo,
  po/nb.po, po/pl.mo, po/pl.po, po/pt\_BR.mo, po/pt\_BR.po, po/uk.mo,
  po/uk.po, po/vi.mo, po/vi.po:

  Sync with translationproject.org
  [[9896b2243]](https://git.sudo.ws/sudo/commit/?id=9896b2243)

* configure, configure.ac, include/compat/sha2.h:

  Fix symbol name collision with systems that have their own sha2
  implementation. This can result in PAM using the wrong sha2
  implementation on Solaris systems configured to use SHA512 for
  passwords.
  [[35dcb05a5]](https://git.sudo.ws/sudo/commit/?id=35dcb05a5)

* src/Makefile.in:

  Use SSP\_LDFLAGS when linking sudo\_noexec.la
  [[2dd0540ad]](https://git.sudo.ws/sudo/commit/?id=2dd0540ad)

2015-03-03 Todd C. Miller

* MANIFEST, config.h.in, configure, configure.ac, include/compat/utime.h,
  lib/util/Makefile.in, lib/util/utimens.c:

  Remove compat/utime.h, it was only useful for ancient systems that are
  no longer capable of compiling sudo.
  [[a7edf7d98]](https://git.sudo.ws/sudo/commit/?id=a7edf7d98)

2015-03-02 Todd C. Miller

* configure, configure.ac, lib/util/Makefile.in:

  Link libsudo\_util with -lrt on systems where clock\_gettime is in -lrt.
  [[1592192ce]](https://git.sudo.ws/sudo/commit/?id=1592192ce)

* NEWS:

  Update.
  [[480d26711]](https://git.sudo.ws/sudo/commit/?id=480d26711)

* lib/util/strlcat.c, lib/util/strlcpy.c:

  Update OpenBSD CVS Ids
  [[30adf83b1]](https://git.sudo.ws/sudo/commit/?id=30adf83b1)

* lib/util/strlcat.c:

  Make comment match code.
  [[5647a1ac4]](https://git.sudo.ws/sudo/commit/?id=5647a1ac4)

* lib/util/utimens.c:

  Fix compilation error on systems without futimes().
  [[3c79ea75b]](https://git.sudo.ws/sudo/commit/?id=3c79ea75b)

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  include/sudo\_util.h, lib/util/Makefile.in, lib/util/gettime.c,
  lib/util/util.exp.in, lib/util/utimens.c, lib/util/utimes.c, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/boottime.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/timestamp.c,
  plugins/sudoers/visudo.c, src/Makefile.in, src/sesh.c, src/sudo\_edit.c:

  Use futimens() and utimensat() instead of futimes() and utimes().
  [[ee72cba93]](https://git.sudo.ws/sudo/commit/?id=ee72cba93)

* plugins/sudoers/visudo.c:

  Fix compiler warning on systems where mode\_t is not unsigned int, such
  as 32-bit Solaris.
  [[ea514dc39]](https://git.sudo.ws/sudo/commit/?id=ea514dc39)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Fix logic for verifypw/listpw all in sudoers LDAP and sssd.
  [[c9d4e1084]](https://git.sudo.ws/sudo/commit/?id=c9d4e1084)

* src/tgetpass.c:

  Fix cut & pasto that prevented the SIGPIPE handler from being restored
  before returning from tgetpass(). From mancha
  [[b78a985bf]](https://git.sudo.ws/sudo/commit/?id=b78a985bf)

2015-02-28 Todd C. Miller

* src/sesh.c, src/sudo\_edit.c:

  Our utimes() emulation support futime() too.
  [[f25cf9967]](https://git.sudo.ws/sudo/commit/?id=f25cf9967)

2015-02-27 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[74d3745cc]](https://git.sudo.ws/sudo/commit/?id=74d3745cc)

* plugins/sudoers/testsudoers.c:

  Define YYDEBUG to 0 if not already defined so we can protect use of
  sudoersdebug with “#if YYDEBUG” like the generated parser does. From
  David Michael.
  [[233783511]](https://git.sudo.ws/sudo/commit/?id=233783511)

2015-02-26 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document that Aliases may not be redefined and that “sudo -f
  /etc/sudo.d/foo” will not catch the redefinition.
  [[f95d76258]](https://git.sudo.ws/sudo/commit/?id=f95d76258)

* sudo.pp:

  Only create /usr/lib/tmpfiles.d/sudo.conf if
  /usr/lib/tmpfiles.d/systemd.conf also exists. Some other package may
  have created /usr/lib/tmpfiles.d even though it is not used.
  [[8e1ceb5a7]](https://git.sudo.ws/sudo/commit/?id=8e1ceb5a7)

* plugins/sudoers/Makefile.in:

  regen
  [[d09a83893]](https://git.sudo.ws/sudo/commit/?id=d09a83893)

* sudo.pp:

  Clear the ts dir instead of just making sure it exists.
  [[a056794e9]](https://git.sudo.ws/sudo/commit/?id=a056794e9)

* configure, configure.ac:

  Only substiture init.d scripts that we are going to use.
  [[083f59a75]](https://git.sudo.ws/sudo/commit/?id=083f59a75)

2015-02-25 Todd C. Miller

* plugins/sudoers/Makefile.in, sudo.pp:

  Create /usr/lib/tmpfiles.d/sudo.conf when systemd is used.
  [[8fdc46433]](https://git.sudo.ws/sudo/commit/?id=8fdc46433)

* plugins/sudoers/iolog.c, plugins/sudoers/visudo.c, src/sudo\_edit.c,
  src/utmp.c:

  Check the return value of gettimeofday(), even though it should never
  fail.
  [[973286c7a]](https://git.sudo.ws/sudo/commit/?id=973286c7a)

2015-02-24 Todd C. Miller

* MANIFEST, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/clock\_gettime.c, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/gettime.c,
  plugins/sudoers/po/sudoers.pot, plugins/sudoers/sudoers.h,
  plugins/sudoers/timestamp.c:

  We cannot (easily) use clock\_gettime(CLOCK\_MONOTONIC) directly as it may
  be present but not implemented. Add sudo\_gettime\_real() and
  sudo\_gettime\_mono() functions to get the real and monotonic times
  respectively. Now sudo\_gettime\_mono() checks the value of
  sysconf(\_SC\_MONOTONIC\_CLOCK) before calling
  clock\_gettime(CLOCK\_MONOTONIC) and falls back on sudo\_gettime\_real() as
  needed. The Mach version of sudo\_gettime\_mono() uses
  mach\_absolute\_time().

  This should fix problems with timestamp files on systems where the
  CLOCK\_MONOTONIC is defined but not actually implemented.
  [[5d2e9426b]](https://git.sudo.ws/sudo/commit/?id=5d2e9426b)

* include/sudo\_compat.h, plugins/sudoers/timestamp.c:

  Check clock\_gettime() return value and warn if it fails. Currently, the
  timestamp will be ignored if clock\_gettime() fails.
  [[01a4d6ccb]](https://git.sudo.ws/sudo/commit/?id=01a4d6ccb)

2015-02-23 Todd C. Miller

* lib/util/sudo\_debug.c:

  Plug memory leak when debug file cannot be opened. Use %zu printf format
  now that our snprintf support it.
  [[23f4e49f4]](https://git.sudo.ws/sudo/commit/?id=23f4e49f4)

* plugins/sudoers/auth/pam.c:

  Pam conversation function changes: o use PAM\_BUF\_ERR as the return value
  when calloc() fails. o sanity check the value of num\_msg o remove the
  workaround for old Apple PAM o PAM\_AUTH\_ERR is not a valid PAM
  conversation function return value

  If getpass\_error is set after a call to pam\_verify (usually because the
  user pressed ^C), return AUTH\_INTR immediately instead of checking the
  pam\_verify return value.
  [[a604f0f02]](https://git.sudo.ws/sudo/commit/?id=a604f0f02)

* INSTALL, NEWS, configure, configure.ac, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/auth/sudo\_auth.h:

  On AIX use the value of auth\_type in /etc/security/login.cfg to
  determine whether to use LAM or PAM unless the user specified the
  –with-pam or –with-aixauth configure flags.
  [[e11f32fd4]](https://git.sudo.ws/sudo/commit/?id=e11f32fd4)

* lib/util/parseln.c:

  Fix cast.
  [[1ce9dd5e0]](https://git.sudo.ws/sudo/commit/?id=1ce9dd5e0)

2015-02-21 Todd C. Miller

* config.h.in, configure, configure.ac, lib/util/snprintf.c:

  Update snprintf.c from OpenBSD. The floating point and wide character
  code has been retained but is not compiled by default.
  [[b5831d55d]](https://git.sudo.ws/sudo/commit/?id=b5831d55d)

2015-02-20 Todd C. Miller

* plugins/sudoers/regress/sudoers/test1.in,
  plugins/sudoers/regress/sudoers/test1.out.ok,
  plugins/sudoers/regress/sudoers/test1.toke.ok:

  Update the regression test that check that all tags are parsed.
  [[1ca3e1834]](https://git.sudo.ws/sudo/commit/?id=1ca3e1834)

* MANIFEST, configure, configure.ac, lib/util/Makefile.in,
  lib/util/mktemp.c, lib/util/regress/mktemp/mktemp\_test.c, mkdep.pl:

  Add regress for mkdtemp and mkstemps from OpenBSD
  [[49128a79e]](https://git.sudo.ws/sudo/commit/?id=49128a79e)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[bd8eebd6f]](https://git.sudo.ws/sudo/commit/?id=bd8eebd6f)

* plugins/sudoers/po/nl.mo, plugins/sudoers/po/nl.po, po/tr.mo, po/tr.po:

  Sync with translationproject.org
  [[bb5093f40]](https://git.sudo.ws/sudo/commit/?id=bb5093f40)

* config.h.in, configure.ac:

  Correct SECURE\_PATH comment.
  [[f9af2bc99]](https://git.sudo.ws/sudo/commit/?id=f9af2bc99)

* NEWS, configure, configure.ac:

  Sudo 1.8.13
  [[93b52daab]](https://git.sudo.ws/sudo/commit/?id=93b52daab)

2015-02-19 Todd C. Miller

* MANIFEST, config.h.in, configure, configure.ac, include/sudo\_compat.h,
  include/sudo\_util.h, lib/util/Makefile.in, lib/util/gethostname.c,
  lib/util/util.exp.in, plugins/sudoers/match.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c, src/sudo.c:

  Avoid using HOST\_NAME\_MAX directly and use sysconf(\_SC\_HOST\_NAME\_MAX)
  instead.
  [[be8dbeb22]](https://git.sudo.ws/sudo/commit/?id=be8dbeb22)

* plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/secureware.c:

  Historically, crypt() returned the empty string on error, which ensured
  that crypt(””, “”) would return “”, which supported matcing empty
  encrypted passwords with no additional code. Some modern versions of
  crypt() (such as glibc) return NULL on error so we need an explicit test
  to match an empty plaintext password and an empty encrypted password.
  [[9b514ed83]](https://git.sudo.ws/sudo/commit/?id=9b514ed83)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Sort tags lexically in the sudoers manual
  [[615aee9d1]](https://git.sudo.ws/sudo/commit/?id=615aee9d1)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/ldap.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/regress/sudoers/test1.out.ok,
  plugins/sudoers/sssd.c, plugins/sudoers/sudoers\_version.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/visudo\_json.c:

  Add support for MAIL and NOMAIL command tags to toggle mail sending
  behavior on a per-command (or Cmnd\_Alias) basis.
  [[45548cf04]](https://git.sudo.ws/sudo/commit/?id=45548cf04)

2015-02-15 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/logging.c:

  Add mail\_all\_cmnds to always mail when a user runs a command (or tries
  to) including sudoedit. The mail\_always flag goes back to its old
  semantic of always mailing when sudo is run.
  [[53ac30b63]](https://git.sudo.ws/sudo/commit/?id=53ac30b63)

2015-02-19 Todd C. Miller

* lib/util/getline.c, plugins/group\_file/getgrent.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/tsgetgrpw.c:

  All modern systems should have LINE\_MAX.
  [[8bb589709]](https://git.sudo.ws/sudo/commit/?id=8bb589709)

* config.h.in, configure, configure.ac, include/sudo\_compat.h,
  lib/util/closefrom.c, lib/util/setgroups.c,
  plugins/sudoers/pwutil\_impl.c, src/sudo.c:

  Almost no systems actually define OPEN\_MAX since it is dynamic on modern
  OSes. If sysconf(\_SC\_OPEN\_MAX) ever fails, fall back on *POSIX\_OPEN\_MAX
  instead. We can assume modern systems have sysconf(). Also remove checks
  for strrchr() and strtoll() for which the HAVE*\* defines are no longer
  used.
  [[96eddddc1]](https://git.sudo.ws/sudo/commit/?id=96eddddc1)

* Makefile.in, sudo.pp:

  Don’t need to pass exampledir to polypkg now that it is just under
  docdir.
  [[7d1ee7713]](https://git.sudo.ws/sudo/commit/?id=7d1ee7713)

2015-02-18 Todd C. Miller

* sudo.pp:

  Fix packaging of the example dir.
  [[2ed7f2dd9]](https://git.sudo.ws/sudo/commit/?id=2ed7f2dd9)

* lib/util/mktemp.c:

  Fix mkstemps() extension handling. Sudoedit will now preserve the
  extension properly when the system libc lacks mkstemps().
  [[1ae2e5514]](https://git.sudo.ws/sudo/commit/?id=1ae2e5514)

2015-02-17 Todd C. Miller

* MANIFEST, aclocal.m4, config.h.in, configure, configure.ac,
  lib/util/Makefile.in, lib/util/locale\_weak.c, m4/ax\_sys\_weak\_alias.m4,
  mkdep.pl, src/Makefile.in, src/locale\_stub.c:

  Use weak symbols for sudo\_warn\_gettext() and sudo\_warn\_strerror() so
  distros using “-Wl,–no-undefined” in LDFLAGS don’t run into problems.
  [[166db8eeb]](https://git.sudo.ws/sudo/commit/?id=166db8eeb)

* lib/util/mksiglist.c, lib/util/mksigname.c:

  Include unistd.h in siglist.c and signame.c to get gid\_t which is used
  by sudo\_compat.h. [Bug
  #686](https://bugzilla.sudo.ws/show_bug.cgi?id=686)
  [[8cae9876f]](https://git.sudo.ws/sudo/commit/?id=8cae9876f)

2015-02-10 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Minor change in description of TZ path handling.
  [[915e08eec]](https://git.sudo.ws/sudo/commit/?id=915e08eec)

* Makefile.in, examples/Makefile.in:

  Move example dir under the doc dir to conform to Debian guidelines. [Bug
  #682](https://bugzilla.sudo.ws/show_bug.cgi?id=682).
  [[117a30fac]](https://git.sudo.ws/sudo/commit/?id=117a30fac)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document that a leading ‘:’ is skipped when checking TZ for a
  fully-qualified path name.
  [[00f663d54]](https://git.sudo.ws/sudo/commit/?id=00f663d54)

2015-02-09 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Typo.
  [[9669abdaf]](https://git.sudo.ws/sudo/commit/?id=9669abdaf)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Fix typos.
  [[0414ea457]](https://git.sudo.ws/sudo/commit/?id=0414ea457)

* plugins/sample/sample\_plugin.c:

  Fix compilation on systems w/o \_\_dso\_public
  [[2e32bb10f]](https://git.sudo.ws/sudo/commit/?id=2e32bb10f)

2015-02-07 Todd C. Miller

* NEWS, plugins/sudoers/po/ru.mo, plugins/sudoers/po/ru.po:

  Russian translation for sudoers from translationproject.org.
  [[9206ba54c]](https://git.sudo.ws/sudo/commit/?id=9206ba54c)

2015-02-06 Todd C. Miller

* MANIFEST, doc/CONTRIBUTORS, plugins/sudoers/po/ru.mo,
  plugins/sudoers/po/ru.po:

  Russian translation for sudoers from translationproject.org.
  [[cecdd7e72]](https://git.sudo.ws/sudo/commit/?id=cecdd7e72)

* config.h.in, configure, configure.ac, include/sudo\_compat.h:

  Add check for getresuid() declaration, which may be missing on HP-UX.
  When checking for getdomainname() prototype, look in netdb.h too.
  [[3eb9a854d]](https://git.sudo.ws/sudo/commit/?id=3eb9a854d)

* INSTALL, NEWS, configure, configure.ac, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, m4/sudo.m4, pathnames.h.in,
  plugins/sudoers/env.c:

  Sanity check the TZ environment variable by special casing it in
  env\_check. The –with-tzdir configure option can be used to specify the
  zoneinfo directory if configure doesn’t find it.
  [[c3c28773f]](https://git.sudo.ws/sudo/commit/?id=c3c28773f)

* NEWS:

  Mention crash fixes.
  [[de1181619]](https://git.sudo.ws/sudo/commit/?id=de1181619)

* src/parse\_args.c:

  Bail with usage() early if argc <= 0.
  [[0008747be]](https://git.sudo.ws/sudo/commit/?id=0008747be)

2015-02-05 Todd C. Miller

* plugins/sudoers/pwutil.c:

  Remove extraneous casts of node->data (which is void \*).
  [[c299cdd66]](https://git.sudo.ws/sudo/commit/?id=c299cdd66)

* doc/CONTRIBUTORS:

  Add Stephane Chazelas
  [[5218f74e8]](https://git.sudo.ws/sudo/commit/?id=5218f74e8)

* plugins/sudoers/pwutil.c:

  Fix a potential crash when getpwnam() of the running user fails and we
  don’t replace the negative cached entry with a faked up one. From
  Stephane Chazelas
  [[cebd92a88]](https://git.sudo.ws/sudo/commit/?id=cebd92a88)

* src/parse\_args.c, src/sudo.c:

  Don’t assume argv[0] is set without first checking argc.
  [[67eba7e53]](https://git.sudo.ws/sudo/commit/?id=67eba7e53)

* plugins/sudoers/set\_perms.c:

  Handle sudo\_get\_grlist() returning NULL which can happen if
  getgrouplist() fails even after allocating the appropriate amount of
  memory. From Stephane Chazelas
  [[b727d4309]](https://git.sudo.ws/sudo/commit/?id=b727d4309)

* lib/util/progname.c:

  Call setprogname(“sudo”) if getprogname() returns NULL or the empty
  string.
  [[6d71b488b]](https://git.sudo.ws/sudo/commit/?id=6d71b488b)

* config.h.in, configure, configure.ac:

  Remove configure checks for strrchr() and strtoll() for which the HAVE\_\*
  defines are no longer used.
  [[88f79588e]](https://git.sudo.ws/sudo/commit/?id=88f79588e)

* config.h.in, configure, configure.ac, doc/sudoreplay.cat,
  doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  plugins/sudoers/sudoreplay.c:

  Require POSIX regular expression support for sudoreplay.
  [[a3435e7d1]](https://git.sudo.ws/sudo/commit/?id=a3435e7d1)

* plugins/sudoers/policy.c:

  The plugin no longer needs to call initprogname() now that it links with
  the same libsudo\_util as sudo.
  [[1e30824a1]](https://git.sudo.ws/sudo/commit/?id=1e30824a1)

* config.h.in, configure, configure.ac, include/sudo\_compat.h:

  Check whether getdomainname(), innetgr(), setresuid() and setresgid()
  are declared and add prototypes in sudo\_compat.h as needed.
  [[1bb633a21]](https://git.sudo.ws/sudo/commit/?id=1bb633a21)

2015-02-04 Todd C. Miller

* sudo.pp:

  Add /usr/local/share/examples/ directory to parentdirs so it is
  explicitly added to the package.
  [[3f82c8e57]](https://git.sudo.ws/sudo/commit/?id=3f82c8e57)

2015-02-02 Todd C. Miller

* NEWS, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/logging.c:

  Don’t send mail about pseudo-command failure unless it is an
  authentication failure.
  [[ed4ffa626]](https://git.sudo.ws/sudo/commit/?id=ed4ffa626)

2015-02-04 Todd C. Miller

* plugins/sudoers/po/da.mo, po/da.mo:

  Sync with translationproject.org
  [[dfb369198]](https://git.sudo.ws/sudo/commit/?id=dfb369198)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/nl.mo, plugins/sudoers/po/nl.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/nl.mo,
  po/nl.po:

  Sync with translationproject.org
  [[d1ce08369]](https://git.sudo.ws/sudo/commit/?id=d1ce08369)

2015-02-03 Todd C. Miller

* plugins/sudoers/getdate.c, plugins/sudoers/gram.c:

  Regen with yacc skeleton that the clang analyzer doesn’t complain about.
  [[2033be83c]](https://git.sudo.ws/sudo/commit/?id=2033be83c)

* configure, configure.ac, lib/util/alloc.c, lib/util/glob.c,
  plugins/sudoers/env.c, plugins/sudoers/getdate.c,
  plugins/sudoers/getdate.y, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y:

  Use stdint.h to get SIZE\_MAX as inttypes.h on some pre-C99 HP-UX systems
  doesn’t include stdint.h itself.
  [[a9bf105ed]](https://git.sudo.ws/sudo/commit/?id=a9bf105ed)

* configure, configure.ac:

  SIZE\_MAX may be in limits.h on pre-C99 compilers.
  [[a17d562fd]](https://git.sudo.ws/sudo/commit/?id=a17d562fd)

* config.h.in, configure, configure.ac, lib/util/aix.c:

  Add missing prototypes for usrinfo() and setauthdb() for AIX.
  [[f2a554f29]](https://git.sudo.ws/sudo/commit/?id=f2a554f29)

* config.h.in, configure, configure.ac, plugins/sudoers/match.c:

  Solaris uses sysinfo(SI\_SRPC\_DOMAIN) instead of getdomainname() to get
  the host’s NIS domain.
  [[536c83cec]](https://git.sudo.ws/sudo/commit/?id=536c83cec)

2015-02-02 Todd C. Miller

* configure, configure.ac:

  Remove AC\_PROG\_GCC\_TRADITIONAL and add AC\_PROG\_CC\_STDC since we need
  C99.
  [[7fdbbf16a]](https://git.sudo.ws/sudo/commit/?id=7fdbbf16a)

* plugins/sudoers/match.c:

  Actually use the check for prior initialization in sudo\_getdomainname().
  [[15717c518]](https://git.sudo.ws/sudo/commit/?id=15717c518)

* configure, configure.ac:

  We need to add OSDEFS to CFLAGS to expose LLONG\_MAX et al on glibc when
  not explicitly asking for c99.
  [[109a866fb]](https://git.sudo.ws/sudo/commit/?id=109a866fb)

* configure, configure.ac:

  Fix check for SIZE\_MAX, which should be in stdint.h not limits.h.
  [[bb19428fc]](https://git.sudo.ws/sudo/commit/?id=bb19428fc)

* lib/util/glob.c:

  Need to include inttypes.h for SIZE\_MAX
  [[fd149e632]](https://git.sudo.ws/sudo/commit/?id=fd149e632)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[fde8776d5]](https://git.sudo.ws/sudo/commit/?id=fde8776d5)

2015-02-01 Todd C. Miller

* include/sudo\_debug.h, lib/util/aix.c, lib/util/event.c,
  lib/util/event\_poll.c, lib/util/event\_select.c, lib/util/gidlist.c,
  lib/util/key\_val.c, lib/util/lbuf.c, lib/util/locking.c,
  lib/util/parseln.c, lib/util/secure\_path.c, lib/util/setgroups.c,
  lib/util/strtobool.c, lib/util/strtoid.c, lib/util/strtomode.c,
  lib/util/sudo\_conf.c, lib/util/sudo\_debug.c, lib/util/term.c,
  lib/util/ttysize.c, lib/util/util.exp.in, plugins/sudoers/alias.c,
  plugins/sudoers/audit.c, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/base64.c, plugins/sudoers/boottime.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/check.c,
  plugins/sudoers/defaults.c, plugins/sudoers/env.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/getspwuid.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/hexchar.c, plugins/sudoers/interfaces.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/ldap.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/logging.c, plugins/sudoers/logwrap.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/redblack.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoers\_debug.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestamp.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/toke\_util.c,
  plugins/sudoers/visudo.c, plugins/sudoers/visudo\_json.c, src/exec.c,
  src/exec\_common.c, src/exec\_pty.c, src/get\_pty.c, src/hooks.c,
  src/load\_plugins.c, src/net\_ifs.c, src/parse\_args.c, src/preserve\_fds.c,
  src/selinux.c, src/sesh.c, src/signal.c, src/solaris.c, src/sudo.c,
  src/sudo\_edit.c, src/tgetpass.c, src/ttyname.c, src/utmp.c:

  Go back to a 2 args debug\_decl and just use the “default” instance, now
  renamed “active”.
  [[59ab26dbc]](https://git.sudo.ws/sudo/commit/?id=59ab26dbc)

2015-01-31 Todd C. Miller

* doc/LICENSE:

  Update copyright year.
  [[e71726d0f]](https://git.sudo.ws/sudo/commit/?id=e71726d0f)

2015-01-30 Todd C. Miller

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  plugins/sudoers/ldap.c, plugins/sudoers/match.c,
  plugins/sudoers/parse.h:

  When querying LDAP netgroups, use the NIS domain if it is sent but also
  match nisNetgroupTriple entries that have no domain.
  [[7ec9cfb49]](https://git.sudo.ws/sudo/commit/?id=7ec9cfb49)

* plugins/sudoers/sudoreplay.c:

  Avoid setting the tty to non-blocking mode so “sudoreplay | cat” (for
  example) works as expected. We only read a single byte from the keyboard
  and only when interactive anyway so this should be fine.
  [[97469c243]](https://git.sudo.ws/sudo/commit/?id=97469c243)

* lib/zlib/Makefile.in, plugins/sudoers/Makefile.in:

  regen
  [[00e7dbd64]](https://git.sudo.ws/sudo/commit/?id=00e7dbd64)

* plugins/sudoers/sudoreplay.c:

  Avoid a cppcheck warning about undefined behavior (using the address of
  a stack buffer - 1) and fix a memory leak of the iov when doing
  nl->crnl conversion.
  [[0ac881ba4]](https://git.sudo.ws/sudo/commit/?id=0ac881ba4)

* doc/CONTRIBUTORS:

  Add Steven Soulen
  [[1517d18b1]](https://git.sudo.ws/sudo/commit/?id=1517d18b1)

* plugins/sudoers/sudoreplay.c:

  Fix handling of partial writes from writev() which can occur with large
  output buffers.
  [[770e6ca19]](https://git.sudo.ws/sudo/commit/?id=770e6ca19)

2015-01-29 Todd C. Miller

* NEWS, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in, plugins/sudoers/ldap.c:

  Add support for querying netgroups directly via LDAP since there is no
  other way to look up all the netgroups for a user (unlike regular
  groups). This introduces netgroup\_base and netgroup\_search\_filter
  options to ldap.conf. Based on a diff from Steven Soulen.
  [[4dd2a3c6b]](https://git.sudo.ws/sudo/commit/?id=4dd2a3c6b)

2015-01-27 Todd C. Miller

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  Sort ldap.conf options.
  [[4ae3ab43c]](https://git.sudo.ws/sudo/commit/?id=4ae3ab43c)

2015-01-22 Todd C. Miller

* plugins/sudoers/ldap.c:

  Add macros to ease the checking of strlcpy, strlcat and
  sudo\_ldap\_value\_cat return values.
  [[741bb8ec7]](https://git.sudo.ws/sudo/commit/?id=741bb8ec7)

2015-01-21 Todd C. Miller

* plugins/sudoers/check.c, plugins/sudoers/ldap.c,
  plugins/sudoers/logging.c, plugins/sudoers/parse.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Rename VALIDATE\_OK -> VALIDATE\_SUCCESS Rename VALIDATE\_NOT\_OK ->
  VALIDATE\_FAILURE
  [[57553fffd]](https://git.sudo.ws/sudo/commit/?id=57553fffd)

* plugins/sudoers/logging.c, plugins/sudoers/sudoers.h:

  Remove now-unused VALIDATE\_ERROR define.
  [[399d364a9]](https://git.sudo.ws/sudo/commit/?id=399d364a9)

* plugins/sudoers/logging.c:

  should\_mail() now returns bool.
  [[5415b3d2a]](https://git.sudo.ws/sudo/commit/?id=5415b3d2a)

* lib/util/sudo\_debug.c:

  If sudo\_debug\_register() fails return SUDO\_DEBUG\_INSTANCE\_INITIALIZER,
  not -1. Otherwise we could end up setting the instance to -1 which is
  invalid.
  [[2188c83a2]](https://git.sudo.ws/sudo/commit/?id=2188c83a2)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Fix typo.
  [[721cab85e]](https://git.sudo.ws/sudo/commit/?id=721cab85e)

* doc/Makefile.in:

  Use “mandoc -Tascii” to generate .cat pages to avoid locale-specific
  characters.
  [[716e6a991]](https://git.sudo.ws/sudo/commit/?id=716e6a991)

2015-01-19 Todd C. Miller

* configure, m4/sudo.m4:

  Use AC\_PATH\_PROG to find programs instead of checking the path manually.
  [[a33d88c99]](https://git.sudo.ws/sudo/commit/?id=a33d88c99)

2015-01-16 Todd C. Miller

* lib/util/strlcat.c, lib/util/strlcpy.c:

  Sync with OpenBSD version
  [[d2d9e6fcc]](https://git.sudo.ws/sudo/commit/?id=d2d9e6fcc)

2015-01-15 Todd C. Miller

* configure, configure.ac:

  Use AC\_CHECK\_HEADERS\_ONCE and AC\_CHECK\_FUNCS\_ONCE where possible and
  quote the first args in AC\_CHECK\_FUNCS calls.
  [[f80ffcc91]](https://git.sudo.ws/sudo/commit/?id=f80ffcc91)

* config.h.in, configure, configure.ac, include/sudo\_compat.h:

  Avoid inadvertantly defining things like PATH\_MAX simply because the
  source file doesn’t include limits.h.
  [[55a34e694]](https://git.sudo.ws/sudo/commit/?id=55a34e694)

2015-01-14 Todd C. Miller

* configure, ltmain.sh, m4/libtool.m4, m4/ltoptions.m4, m4/ltversion.m4:

  Update to libtool 2.4.4 + HP-UX patches
  [[078ba3806]](https://git.sudo.ws/sudo/commit/?id=078ba3806)

* src/ttyname.c:

  Document why we need sys/param.h.
  [[acea28b9a]](https://git.sudo.ws/sudo/commit/?id=acea28b9a)

* configure, m4/sudo.m4:

  Don’t need sys/param.h.
  [[532a0e6cc]](https://git.sudo.ws/sudo/commit/?id=532a0e6cc)

* lib/util/closefrom.c:

  Don’t appear to need sys/param.h for pstat\_getproc() on HP-UX even
  though the man page lists it.
  [[19a8a69a9]](https://git.sudo.ws/sudo/commit/?id=19a8a69a9)

* lib/util/inet\_ntop.c, lib/util/inet\_pton.c:

  Should not need sys/param.h here.
  [[6bd40c622]](https://git.sudo.ws/sudo/commit/?id=6bd40c622)

2014-12-31 Todd C. Miller

* plugins/sudoers/match\_addr.c:

  Use standard CIDR -> netmask conversion and disallow 0-bit CIDRs.
  [[cb09010da]](https://git.sudo.ws/sudo/commit/?id=cb09010da)

2014-12-24 Todd C. Miller

* README.LDAP:

  Update link to gq LDAP editor, now on sourceforge.
  [[86fbde75b]](https://git.sudo.ws/sudo/commit/?id=86fbde75b)

2014-12-16 Todd C. Miller

* include/compat/glob.h, lib/util/glob.c:

  Add support for GLOB\_LIMIT from OpenBSD (not currently used) and also a
  limit on the max recursion depth for glob().
  [[237f3c9df]](https://git.sudo.ws/sudo/commit/?id=237f3c9df)

* lib/util/glob.c:

  Quiet compiler sign compare warning.
  [[b633e88c1]](https://git.sudo.ws/sudo/commit/?id=b633e88c1)

2014-12-10 Todd C. Miller

* NEWS:

  fnmatch fix
  [[88c4a9668]](https://git.sudo.ws/sudo/commit/?id=88c4a9668)

* lib/util/fnmatch.c:

  Remove artificial limit on length of pattern and string. It is possible
  to use fnmatch() on things other than paths (such as arguments) so a
  limit of PATH\_MAX does not make sense. Fixes a bug where rules would
  fail to match if the length of the arguments were larger than PATH\_MAX
  (usually 1024).
  [[d0c333969]](https://git.sudo.ws/sudo/commit/?id=d0c333969)

2014-12-04 Todd C. Miller

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.cat, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Remove the extra /sudo in sudo.ws urls
  [[b1dc5c54d]](https://git.sudo.ws/sudo/commit/?id=b1dc5c54d)

2014-11-27 Todd C. Miller

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.cat, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Reference bugzilla.sudo.ws
  [[9d3fe082f]](https://git.sudo.ws/sudo/commit/?id=9d3fe082f)

2014-11-20 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  sync
  [[e0d927a98]](https://git.sudo.ws/sudo/commit/?id=e0d927a98)

2014-11-19 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Require that a digest be specified with a real command, not an alias or
  pseudo-command. Found via a crash by afl.
  [[c28741978]](https://git.sudo.ws/sudo/commit/?id=c28741978)

* NEWS:

  sync
  [[034ad90e1]](https://git.sudo.ws/sudo/commit/?id=034ad90e1)

* MANIFEST, doc/CONTRIBUTORS, plugins/sudoers/po/fr.mo,
  plugins/sudoers/po/fr.po:

  French translation for sudoers from translationproject.org.
  [[02b3fa2fd]](https://git.sudo.ws/sudo/commit/?id=02b3fa2fd)

2014-11-18 Todd C. Miller

* src/exec.c, src/exec\_pty.c, src/tgetpass.c:

  Defer registration of the SIGCHLD handler until just before we exec the
  command. Fixes a problem where pam\_gnome\_keyring installs its own
  SIGCHLD handler and may not restore the original one. As a result, we
  now have to explicitly wait for the askpass helper to finish. [Bug
  #657](https://bugzilla.sudo.ws/show_bug.cgi?id=657)
  [[29039859b]](https://git.sudo.ws/sudo/commit/?id=29039859b)

2014-11-17 Todd C. Miller

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  Mention sssd support in the sudoers.ldap manual and cross-reference
  sssd-sudo(5).
  [[552dbe525]](https://git.sudo.ws/sudo/commit/?id=552dbe525)

2014-11-16 Todd C. Miller

* doc/CONTRIBUTORS:

  Reorder an entry.
  [[eab8a28ab]](https://git.sudo.ws/sudo/commit/?id=eab8a28ab)

2014-11-15 Todd C. Miller

* Makefile.in, lib/util/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Prevent cppcheck from getting confused by our compat definition of the
  va\_copy macro for pre-C99.
  [[bc6269e58]](https://git.sudo.ws/sudo/commit/?id=bc6269e58)

2014-11-14 Todd C. Miller

* plugins/sudoers/iolog\_path.c:

  Fix potential NULL pointer deref found by cppcheck.
  [[3870fdf62]](https://git.sudo.ws/sudo/commit/?id=3870fdf62)

* plugins/sudoers/alias.c:

  Quiet a cppcheck false positive.
  [[0c88ecd3b]](https://git.sudo.ws/sudo/commit/?id=0c88ecd3b)

* lib/util/sudo\_debug.c:

  If there are multiple outputs, ap will be re-used so make a copy and
  operate on it instead.
  [[cbe917c54]](https://git.sudo.ws/sudo/commit/?id=cbe917c54)

* src/hooks.c:

  Fix typo in hook return value check.
  [[1c96c5ec3]](https://git.sudo.ws/sudo/commit/?id=1c96c5ec3)

* NEWS:

  Mention visudo use of sudoers plugin args to set default sudoers file
  name and owner/mode.
  [[cafd7baa2]](https://git.sudo.ws/sudo/commit/?id=cafd7baa2)

* NEWS:

  Mention fix for bug #678
  [[d956785e9]](https://git.sudo.ws/sudo/commit/?id=d956785e9)

2014-11-10 Todd C. Miller

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/cs.mo,
  po/cs.po, po/da.mo, po/da.po, po/de.mo, po/de.po, po/eo.mo, po/eo.po,
  po/fi.mo, po/fi.po, po/it.mo, po/it.po, po/nb.mo, po/nb.po, po/pl.mo,
  po/pl.po, po/pt\_BR.mo, po/pt\_BR.po, po/ru.mo, po/ru.po, po/uk.mo,
  po/uk.po, po/vi.mo, po/vi.po, po/zh\_CN.mo, po/zh\_CN.po:

  Sync with translationproject.org
  [[b4432df5e]](https://git.sudo.ws/sudo/commit/?id=b4432df5e)

2014-11-12 Todd C. Miller

* plugins/sudoers/sudoers.c:

  In set\_fqdn() we neeed to set user\_runhost/user\_srunhost at the same
  time we set user\_host/user\_shost since that is what hostlist\_matches()
  uses. [Bug #678](https://bugzilla.sudo.ws/show_bug.cgi?id=678)
  [[832a4dee6]](https://git.sudo.ws/sudo/commit/?id=832a4dee6)

2014-11-11 Todd C. Miller

* src/hooks.c:

  Do not call sudo\_warnx() on invalid value from the env hook functions as
  the printf() family may call getenv() for locale reasons.
  [[ae00eb719]](https://git.sudo.ws/sudo/commit/?id=ae00eb719)

* doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.man.in, doc/sudoers.cat, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, doc/sudoreplay.mdoc.in, doc/visudo.cat,
  doc/visudo.man.in, doc/visudo.mdoc.in:

  No need to keep specifying “.Nm foo” since the Nm macro remembers the
  argument it was first called with and uses it if none is specified. Also
  fix a few minor formatting errors and regen bulleted lists in the
  .man.in files.
  [[4d04c5644]](https://git.sudo.ws/sudo/commit/?id=4d04c5644)

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Add sudo.conf to SEE ALSO and rename section on sudo.conf
  [[fbac05467]](https://git.sudo.ws/sudo/commit/?id=fbac05467)

* doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in:

  Mention sudo.conf use for debugging
  [[328429832]](https://git.sudo.ws/sudo/commit/?id=328429832)

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo\_plugin.cat, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoers.man.in, doc/sudoreplay.cat:

  regen
  [[e71c646c9]](https://git.sudo.ws/sudo/commit/?id=e71c646c9)

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Document sudo.conf usage now that visudo will parse the sudoers
  arguments.
  [[bc7cbcb55]](https://git.sudo.ws/sudo/commit/?id=bc7cbcb55)

2014-11-10 Todd C. Miller

* plugins/sudoers/visudo.c:

  Use sudoers.so args from sudo.conf to set sudoers\_file, sudoers\_uid,
  sudoers\_gid, and sudoers\_mode in visudo.
  [[5c13889f2]](https://git.sudo.ws/sudo/commit/?id=5c13889f2)

* plugins/sudoers/visudo.c:

  Use sudoers\_file, sudoers\_uid, sudoers\_gid, and sudoers\_mode symbols
  from toke.l instead of the upper case defines.
  [[9d4589abd]](https://git.sudo.ws/sudo/commit/?id=9d4589abd)

* lib/util/Makefile.in, lib/zlib/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in:

  Use SSP\_LDFLAGS when creating shared objects.
  [[04d803c79]](https://git.sudo.ws/sudo/commit/?id=04d803c79)

* lib/util/Makefile.in:

  We only build .lo (not .o) files for libsudo\_util
  [[d00142f55]](https://git.sudo.ws/sudo/commit/?id=d00142f55)

2014-11-06 Todd C. Miller

* NEWS:

  sync
  [[57b50b470]](https://git.sudo.ws/sudo/commit/?id=57b50b470)

2014-11-04 Todd C. Miller

* src/exec.c, src/exec\_pty.c:

  Make sure that SIGCHLD is not treated as a user-generated signal in
  which case it could be ignored. [Bug
  #676](https://bugzilla.sudo.ws/show_bug.cgi?id=676)
  [[21166d4da]](https://git.sudo.ws/sudo/commit/?id=21166d4da)

2014-10-30 Todd C. Miller

* configure, ltmain.sh, m4/libtool.m4, m4/ltoptions.m4, m4/ltsugar.m4,
  m4/ltversion.m4, m4/lt~obsolete.m4:

  Update to libtool 2.4.3 + HP-UX patches
  [[be2de71df]](https://git.sudo.ws/sudo/commit/?id=be2de71df)

2014-10-31 Todd C. Miller

* config.h.in, configure, configure.ac, lib/util/mktemp.c:

  Use arc4random() for mkstemp/mkdtemp if available. If not, try to seed
  from /dev/urandom before falling back to the gettimeofday seed.
  [[2040d4dde]](https://git.sudo.ws/sudo/commit/?id=2040d4dde)

2014-10-29 Todd C. Miller

* configure, configure.ac, include/sudo\_compat.h, lib/util/mktemp.c:

  If a system lacks mkdtemp() or mkstemps(), use our own mkdtemp() and
  mkstemps(). Previously we only exposed the missing one but since the
  guts are the same we might as well use them.
  [[ccc210edd]](https://git.sudo.ws/sudo/commit/?id=ccc210edd)

2014-10-31 Todd C. Miller

* lib/util/sudo\_debug.c:

  Use a static buffer for sudo\_debug\_execve2() if possible.
  [[2eed95639]](https://git.sudo.ws/sudo/commit/?id=2eed95639)

2014-10-29 Todd C. Miller

* src/env\_hooks.c:

  Mark the putenv(), setenv() and unsetenv() symbols as global, not
  hidden. Fixes a mismatch where a plugin (or its loaded dso) would call
  setenv() to set a variables but be unable to find it later with
  getenv().
  [[55098ff6e]](https://git.sudo.ws/sudo/commit/?id=55098ff6e)

2014-10-28 Todd C. Miller

* Makefile.in:

  Fix install-nls target from builddir.
  [[bbf3c0832]](https://git.sudo.ws/sudo/commit/?id=bbf3c0832)

* Makefile.in:

  Fix dependency on sudo.pp, it needs to relative to srcdir.
  [[53d4a02a4]](https://git.sudo.ws/sudo/commit/?id=53d4a02a4)

* src/sesh.c:

  Adapt to new debug subsystem registration.
  [[ef6dfb3ce]](https://git.sudo.ws/sudo/commit/?id=ef6dfb3ce)

2014-10-27 Todd C. Miller

* lib/zlib/Makefile.in, lib/zlib/zlib.exp:

  Add missing zlib.exp file and common LT\_LDFLAGS Makefile.in.
  [[67c7c7f9d]](https://git.sudo.ws/sudo/commit/?id=67c7c7f9d)

* lib/util/sudo\_conf.c:

  Fix path settings broken in rev 9731.
  [[1be81d572]](https://git.sudo.ws/sudo/commit/?id=1be81d572)

* MANIFEST, lib/util/regress/sudo\_conf/test4.err.ok:

  Adjust regress test now that boolean settings display an error for
  invalid input.
  [[f730b28ce]](https://git.sudo.ws/sudo/commit/?id=f730b28ce)

* plugins/sudoers/iolog.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoers\_debug.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Add sudoers\_debug\_deregister() and use it instead of calling
  sudo\_debug\_deregister() directly.
  [[9d6e1a57d]](https://git.sudo.ws/sudo/commit/?id=9d6e1a57d)

* configure, configure.ac, lib/util/Makefile.in, lib/zlib/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in:

  Use AC\_PROG\_AWK
  [[0982f7838]](https://git.sudo.ws/sudo/commit/?id=0982f7838)

* NEWS:

  Mention shared zlib.
  [[640c9d7ec]](https://git.sudo.ws/sudo/commit/?id=640c9d7ec)

* MANIFEST:

  Add lib/zlib/zlib.exp
  [[2be376aae]](https://git.sudo.ws/sudo/commit/?id=2be376aae)

* INSTALL, configure, configure.ac, lib/zlib/Makefile.in,
  lib/zlib/zconf.h.in:

  Add support for installing a shared zlib
  [[9a9e86537]](https://git.sudo.ws/sudo/commit/?id=9a9e86537)

* lib/util/Makefile.in:

  fix comment typo
  [[0d6895cbd]](https://git.sudo.ws/sudo/commit/?id=0d6895cbd)

* configure, configure.ac, lib/zlib/Makefile.in:

  Newer zlib uses HAVE\_HIDDEN to turn on symbol hiding so we don’t need to
  disable it with NO\_VIS.
  [[7c295e40d]](https://git.sudo.ws/sudo/commit/?id=7c295e40d)

* po/sudo.pot:

  regen
  [[11feb6bfa]](https://git.sudo.ws/sudo/commit/?id=11feb6bfa)

* configure.ac, include/sudo\_debug.h, lib/util/sudo\_debug.c,
  lib/util/util.exp.in:

  Version the symbols for sudo\_debug.c now that the API is stable.
  [[adfdad9ae]](https://git.sudo.ws/sudo/commit/?id=adfdad9ae)

2014-10-26 Todd C. Miller

* lib/util/sudo\_conf.c:

  Go back to parsing sudo.conf in place for settings and paths and improve
  debugging info for unsupported entries and parse errors.
  [[d5fdd1ea0]](https://git.sudo.ws/sudo/commit/?id=d5fdd1ea0)

* include/sudo\_conf.h, lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/sudo\_conf.c, lib/util/util.exp.in,
  plugins/sudoers/sudoers\_debug.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c,
  src/load\_plugins.c, src/sudo.c, src/sudo\_plugin\_int.h:

  Add a flag argument to sudo\_conf\_read() so we can decide which bits get
  parsed. This lets us parse Debug statements first and init the debug
  subsystem early.
  [[6b1b734ff]](https://git.sudo.ws/sudo/commit/?id=6b1b734ff)

2014-10-24 Todd C. Miller

* lib/zlib/gzguts.h:

  Include stdio.h after zlib.h, not before. We need the large file defines
  to come first.
  [[f8bd2af4d]](https://git.sudo.ws/sudo/commit/?id=f8bd2af4d)

* doc/LICENSE, lib/zlib/compress.c, lib/zlib/crc32.c, lib/zlib/crc32.h,
  lib/zlib/deflate.c, lib/zlib/deflate.h, lib/zlib/gzguts.h,
  lib/zlib/gzlib.c, lib/zlib/gzread.c, lib/zlib/gzwrite.c,
  lib/zlib/infback.c, lib/zlib/inffast.c, lib/zlib/inflate.c,
  lib/zlib/inftrees.c, lib/zlib/trees.c, lib/zlib/uncompr.c,
  lib/zlib/zconf.h.in, lib/zlib/zlib.h, lib/zlib/zutil.c,
  lib/zlib/zutil.h:

  Update zlib to version 1.2.8
  [[c783f01ad]](https://git.sudo.ws/sudo/commit/?id=c783f01ad)

* configure, configure.ac:

  Don’t add -Wold-style-definition to CFLAGS as it causes problems with
  3rd party libraries such as zlib.
  [[d5a2d0f2d]](https://git.sudo.ws/sudo/commit/?id=d5a2d0f2d)

* src/load\_plugins.c:

  Free up plugin info structs after converting to plugin containers.
  [[4c8573ac2]](https://git.sudo.ws/sudo/commit/?id=4c8573ac2)

* INSTALL, MANIFEST, Makefile.in, configure, configure.ac,
  doc/Makefile.in, doc/TROUBLESHOOTING, doc/UPGRADE, examples/Makefile.in,
  examples/pam.conf, examples/sudo.conf, examples/sudoers,
  examples/syslog.conf, sudo.pp:

  Move sample.\* files to a sudo examples dir
  [[b91a91d28]](https://git.sudo.ws/sudo/commit/?id=b91a91d28)

* sudo.pp:

  Fix a packaging problem with the sudoedit man page link on Debian.
  [[6e8b84fda]](https://git.sudo.ws/sudo/commit/?id=6e8b84fda)

* plugins/sudoers/iolog.c, plugins/sudoers/policy.c:

  Initialize the debug subsystem in sudoers early. Currently this means
  iterating over the settings list twice.
  [[34d9cfe1c]](https://git.sudo.ws/sudo/commit/?id=34d9cfe1c)

* lib/util/sudo\_debug.c:

  No need to convert sudoedit -> sudo in sudo\_debug\_get\_instance() as we
  store the actual program name and only do the sudoedit -> sudo
  conversion when reading the sudo.conf file. Fixes debugging when invoked
  as sudoedit.
  [[fd8cf2c89]](https://git.sudo.ws/sudo/commit/?id=fd8cf2c89)

* lib/util/sudo\_conf.c, lib/util/sudo\_debug.c, plugins/sudoers/iolog.c,
  plugins/sudoers/policy.c, src/exec\_pty.c, src/load\_plugins.c,
  src/sudo.c, src/sudo\_plugin\_int.h:

  In the plugin registers with the debug framework at open time, the sudo
  front-end will now set the default debug instance appropriately before
  calling into the plugin. This means the plugin no longer needs to do the
  sudo\_debug\_set\_default\_instance() dance.
  [[4bf641df6]](https://git.sudo.ws/sudo/commit/?id=4bf641df6)

* Makefile.in:

  Remove duplicate -U\_\_NBBY in CPPCHECK\_OPTS
  [[a2e9d66be]](https://git.sudo.ws/sudo/commit/?id=a2e9d66be)

2014-10-23 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Older shells don’t support unset.
  [[6c6f50283]](https://git.sudo.ws/sudo/commit/?id=6c6f50283)

* configure, configure.ac, include/sudo\_compat.h, lib/util/inet\_ntop.c,
  src/net\_ifs.c:

  Fix inet\_ntop() replacement on older systems without it. We only expose
  the prototype for net\_ifs.c due to the use of socklen\_t.
  [[d0cc4d9e4]](https://git.sudo.ws/sudo/commit/?id=d0cc4d9e4)

* lib/util/sudo\_debug.c:

  Dynamically allocate debug\_fds bitmap and realloc as needed.
  [[7dc2c8fa1]](https://git.sudo.ws/sudo/commit/?id=7dc2c8fa1)

* Makefile.in, include/sudo\_debug.h, lib/util/Makefile.in,
  lib/util/sudo\_debug.c, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/sudoers\_debug.c, plugins/sudoers/sudoers\_debug.h,
  plugins/system\_group/Makefile.in, src/Makefile.in, src/exec.c:

  Use generic bitmap macros instead of select-style fd\_set.
  [[17a2a27e4]](https://git.sudo.ws/sudo/commit/?id=17a2a27e4)

* lib/util/sudo\_debug.c:

  Replace sudo\_debug\_num\_instances with sudo\_debug\_max\_instance
  [[4baa7e6d2]](https://git.sudo.ws/sudo/commit/?id=4baa7e6d2)

* plugins/sudoers/iolog.c, plugins/sudoers/policy.c:

  Don’t call into the debug subsystem after we’ve deregistered the
  plugin’s instance.
  [[935e48c6e]](https://git.sudo.ws/sudo/commit/?id=935e48c6e)

* lib/util/sudo\_debug.c:

  Only fill in subsystem\_ids[] for the instance if the caller passed in an
  array for it. If the caller only wants the default subsystems we don’t
  actually need ids[].
  [[2a47abad2]](https://git.sudo.ws/sudo/commit/?id=2a47abad2)

* lib/util/Makefile.in:

  Link with -ldl if needed when built with –disable-shared-libutil/
  [[f2eb6dcc0]](https://git.sudo.ws/sudo/commit/?id=f2eb6dcc0)

* src/regress/ttyname/check\_ttyname.c:

  Fix includes order.
  [[119c13d8b]](https://git.sudo.ws/sudo/commit/?id=119c13d8b)

* lib/util/util.exp.in:

  Remove extra newline mistakenly introduced in rev 9682.
  [[2968ce060]](https://git.sudo.ws/sudo/commit/?id=2968ce060)

* plugins/sudoers/Makefile.in:

  Fix typo in unset.
  [[386055271]](https://git.sudo.ws/sudo/commit/?id=386055271)

* plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c, src/sesh.c:

  Set debug instance for standalone programs.
  [[fe9e035cc]](https://git.sudo.ws/sudo/commit/?id=fe9e035cc)

* plugins/sudoers/bsm\_audit.c, plugins/sudoers/linux\_audit.c,
  src/net\_ifs.c:

  Fix compilation issues, fallout from the debug changes.
  [[1ca52382a]](https://git.sudo.ws/sudo/commit/?id=1ca52382a)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  regen
  [[6d2be1fd6]](https://git.sudo.ws/sudo/commit/?id=6d2be1fd6)

* configure, configure.ac:

  Sudo 1.8.12
  [[fbc54368c]](https://git.sudo.ws/sudo/commit/?id=fbc54368c)

* NEWS:

  Update with debug system changes and revent bug fixes.
  [[323b4a814]](https://git.sudo.ws/sudo/commit/?id=323b4a814)

* include/sudo\_debug.h, lib/util/sudo\_conf.c, lib/util/sudo\_debug.c,
  plugins/sudoers/sudoers\_debug.c, plugins/sudoers/sudoers\_debug.h:

  When registering with the debug subsystem, the caller now passes in an
  arrary of ints that gets filled in with the subsytem IDs to be used in
  debug\_decl.
  [[5270ebf1f]](https://git.sudo.ws/sudo/commit/?id=5270ebf1f)

* plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  sudoers\_debug\_instance is now included in libparsesudoers so we don’t
  need to declare it here.
  [[8db5f2939]](https://git.sudo.ws/sudo/commit/?id=8db5f2939)

2014-10-22 Todd C. Miller

* MANIFEST, include/sudo\_debug.h, lib/util/sudo\_debug.c,
  lib/util/ttysize.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/alias.c, plugins/sudoers/audit.c,
  plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/base64.c,
  plugins/sudoers/boottime.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/check.c, plugins/sudoers/defaults.c,
  plugins/sudoers/env.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/getspwuid.c, plugins/sudoers/goodpath.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/hexchar.c,
  plugins/sudoers/interfaces.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/ldap.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/logwrap.c, plugins/sudoers/match.c,
  plugins/sudoers/match\_addr.c, plugins/sudoers/parse.c,
  plugins/sudoers/policy.c, plugins/sudoers/prompt.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/redblack.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoers\_debug.c, plugins/sudoers/sudoers\_debug.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c,
  plugins/sudoers/visudo\_json.c:

  The sudoers plugin now defines its own list of debugging subsystem names
  and defines.
  [[e9914a91b]](https://git.sudo.ws/sudo/commit/?id=e9914a91b)

* MANIFEST, include/sudo\_debug.h, lib/util/aix.c, lib/util/event.c,
  lib/util/event\_poll.c, lib/util/event\_select.c, lib/util/gidlist.c,
  lib/util/key\_val.c, lib/util/lbuf.c, lib/util/locking.c,
  lib/util/parseln.c, lib/util/secure\_path.c, lib/util/setgroups.c,
  lib/util/strtobool.c, lib/util/strtoid.c, lib/util/strtomode.c,
  lib/util/sudo\_conf.c, lib/util/sudo\_debug.c, lib/util/term.c,
  lib/util/ttysize.c, lib/util/util.exp.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/alias.c, plugins/sudoers/audit.c,
  plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/base64.c,
  plugins/sudoers/boottime.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/check.c, plugins/sudoers/defaults.c,
  plugins/sudoers/env.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/getspwuid.c, plugins/sudoers/goodpath.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/hexchar.c,
  plugins/sudoers/interfaces.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/ldap.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/logwrap.c, plugins/sudoers/match.c,
  plugins/sudoers/match\_addr.c, plugins/sudoers/parse.c,
  plugins/sudoers/policy.c, plugins/sudoers/prompt.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/redblack.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoers\_debug.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c,
  plugins/sudoers/visudo\_json.c, src/Makefile.in, src/exec.c,
  src/exec\_common.c, src/exec\_pty.c, src/get\_pty.c, src/hooks.c,
  src/load\_plugins.c, src/net\_ifs.c, src/parse\_args.c, src/preserve\_fds.c,
  src/regress/ttyname/check\_ttyname.c, src/selinux.c, src/sesh.c,
  src/signal.c, src/solaris.c, src/sudo.c, src/sudo.h, src/sudo\_edit.c,
  src/tgetpass.c, src/ttyname.c, src/utmp.c:

  Add support for multiple Debug lines per program. Callers may register
  arbitrary debug facilities or use built-in defaults. We now use separate
  Debug statements for plugins and programs.
  [[866cfc4fc]](https://git.sudo.ws/sudo/commit/?id=866cfc4fc)

* MANIFEST, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in,
  doc/sudo\_plugin.mdoc.in, include/sudo\_conf.h, include/sudo\_debug.h,
  lib/util/Makefile.in, lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_conf/test7.in,
  lib/util/regress/sudo\_conf/test7.out.ok, lib/util/sudo\_conf.c,
  lib/util/sudo\_debug.c, lib/util/util.exp.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/solaris\_audit.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudoers.h, src/hooks.c,
  src/load\_plugins.c, src/parse\_args.c, src/sudo.c, src/sudo\_plugin\_int.h:
  Change how sudo.conf is parsed. We now do a quick parse and then set the
  values after the entire file has been parsed. This lets us init the
  debug system earlier. Plugin-specific debug flags are now stored in
  struct plugin\_info and struct plugin\_container and passed to the plugin
  via one or more debug\_flags settings.
  [[a7e724b75]](https://git.sudo.ws/sudo/commit/?id=a7e724b75)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h, src/load\_plugins.c, src/sudo.c,
  src/sudo\_plugin\_int.h:

  Pass plugin path in the settings array.
  [[346ff6766]](https://git.sudo.ws/sudo/commit/?id=346ff6766)

* src/parse\_args.c, src/sudo.c, src/sudo.h:

  Return settings from parse\_args as struct sudo\_settings and format for
  the plugin at plugin open time. This will allow for additional,
  plugin-specific settings to be added to the array.
  [[1e0b8903f]](https://git.sudo.ws/sudo/commit/?id=1e0b8903f)

* plugins/sudoers/parse.c:

  Remove an unneeded NULL check to quiet a cppcheck warning.
  [[f71d4abd7]](https://git.sudo.ws/sudo/commit/?id=f71d4abd7)

2014-10-14 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Set locale to C for visudo and testsudoers regression tests. [Bug
  #672](https://bugzilla.sudo.ws/show_bug.cgi?id=672)
  [[15f5af06d]](https://git.sudo.ws/sudo/commit/?id=15f5af06d)

2014-10-13 Todd C. Miller

* plugins/sudoers/linux\_audit.c:

  Fix logic bug. We only want to return -1 from linux\_audit\_open() when
  audit\_open() fails and errno is not one of EINVAL, EPROTONOSUPPORT, or
  EAFNOSUPPORT. For those errno values, we return AUDIT\_NOT\_CONFIGURED
  which is not a fatal error. [Bug
  #671](https://bugzilla.sudo.ws/show_bug.cgi?id=671)
  [[38c7d7abc]](https://git.sudo.ws/sudo/commit/?id=38c7d7abc)

2014-10-11 Todd C. Miller

* NEWS:

  Add back fix for [Bug
  #663](https://bugzilla.sudo.ws/show_bug.cgi?id=663)
  [[2c5239a3a]](https://git.sudo.ws/sudo/commit/?id=2c5239a3a)

2014-10-10 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  The older style bash function exporting is not used by post-shellshock
  versions of bash.
  [[8f1fb89d5]](https://git.sudo.ws/sudo/commit/?id=8f1fb89d5)

* plugins/sudoers/env.c:

  Apple uses a different variant of the BASH\_FUNC prefix for bash
  functions.
  [[7a901d4c0]](https://git.sudo.ws/sudo/commit/?id=7a901d4c0)

2014-10-07 Todd C. Miller

* NEWS:

  Remove change that is part of 1.8.12 not 1.8.11p1
  [[0be86df4d]](https://git.sudo.ws/sudo/commit/?id=0be86df4d)

* NEWS, configure, configure.ac:

  Update for sudo 1.8.11p1
  [[a50e72b81]](https://git.sudo.ws/sudo/commit/?id=a50e72b81)

* src/regress/ttyname/check\_ttyname.c:

  Only check stdin for the tty and avoid the check entirely if we don’t
  have a way to get the tty from the kernel. [Bug
  #643](https://bugzilla.sudo.ws/show_bug.cgi?id=643)
  [[837fb1f81]](https://git.sudo.ws/sudo/commit/?id=837fb1f81)

* lib/util/sudo\_debug.c:

  Make a copy of ap in sudo\_debug\_vprintf2() in case the static buffer is
  not big enough and we need to call vasprintf().
  [[1dd96778e]](https://git.sudo.ws/sudo/commit/?id=1dd96778e)

* src/sudo.c:

  Avoid comparing new cwd with old one if getcwd() failed. [Bug
  #670](https://bugzilla.sudo.ws/show_bug.cgi?id=670)
  [[dc6744215]](https://git.sudo.ws/sudo/commit/?id=dc6744215)

* plugins/sudoers/env.c:

  Fix debugging printout output for env\_should\_keep()
  [[1890f0fcd]](https://git.sudo.ws/sudo/commit/?id=1890f0fcd)

2014-10-06 Todd C. Miller

* Makefile.in, include/Makefile.in:

  Use INSTALL\_OWNER instead of -O/-G flags so we can work with the
  autotools install-sh too. [Bug
  #669](https://bugzilla.sudo.ws/show_bug.cgi?id=669)
  [[d7574a344]](https://git.sudo.ws/sudo/commit/?id=d7574a344)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c:

  Move sudo\_printf to policy.c to match sudo\_conv.
  [[79f4471e4]](https://git.sudo.ws/sudo/commit/?id=79f4471e4)

2014-10-05 Todd C. Miller

* MANIFEST, include/sudo\_fatal.h, lib/util/Makefile.in, lib/util/fatal.c,
  lib/util/util.exp.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/sudo\_printf.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, src/conversation.c, src/sudo.c,
  src/sudo\_plugin\_int.h:

  Add sudo\_warn\_set\_conversation() to specify a conversation function to
  use for warn/fatal. If no conversation function is specified, the
  standard error will be used. We now only need sudo\_printf() for things
  that use the parser.
  [[bd99dcc02]](https://git.sudo.ws/sudo/commit/?id=bd99dcc02)

2014-10-03 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Use correct names when referring to subsections in the sudoers manual.
  [[29be09364]](https://git.sudo.ws/sudo/commit/?id=29be09364)

2014-10-02 Todd C. Miller

* MANIFEST, config.h.in, configure, configure.ac, lib/util/inet\_ntop.c,
  src/net\_ifs.c:

  Use inet\_ntop() instead of inet\_ntoa() and include a version for systems
  that are missing it.
  [[5f9e84ea5]](https://git.sudo.ws/sudo/commit/?id=5f9e84ea5)

2014-10-01 Todd C. Miller

* configure, configure.ac:

  Fix detection of functions in network libs like -lsocket, -lnsl and
  -linet when we have already added those libs to NET\_LIBS. Fixes a
  problem where inet\_pton() was not detected on Solaris.
  [[1d7bab504]](https://git.sudo.ws/sudo/commit/?id=1d7bab504)

* NEWS:

  Mention –disable-shared-libutil fix.
  [[1faf2b595]](https://git.sudo.ws/sudo/commit/?id=1faf2b595)

* src/Makefile.in:

  Always use –tag=disable-static to avoid installing a static
  sudo\_noexec.
  [[2f3ebce11]](https://git.sudo.ws/sudo/commit/?id=2f3ebce11)

* configure, configure.ac, lib/util/Makefile.in,
  plugins/sudoers/Makefile.in:

  Instead of building libutil statically for –disable-shared-libutil,
  just treat it as a convenience library. Do the same with sudoers for
  –enable-static-sudoers. Fixes link errors on Solaris among others when
  –disable-shared-libutil is used.
  [[0b0481fa3]](https://git.sudo.ws/sudo/commit/?id=0b0481fa3)

* configure, configure.ac, lib/util/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in:

  Remove LT\_LDMAP and LT\_LDOPT and just use LT\_LDEXPORTS for the
  compiler-specific option to restrict symbol exporting.
  [[05d3a4c5e]](https://git.sudo.ws/sudo/commit/?id=05d3a4c5e)

* src/preload.c:

  Include sys/types.h to get gid\_t, etc used in sudo\_compat.h. Fixes a
  build issue on Solaris.
  [[1d0b5422a]](https://git.sudo.ws/sudo/commit/?id=1d0b5422a)

2014-09-29 Todd C. Miller

* src/regress/ttyname/check\_ttyname.c:

  Fix cust & pasto in error message when there is a mismatch between the
  sudo and libc ttys. From Diego Elio Petteno’. [Bug
  #643](https://bugzilla.sudo.ws/show_bug.cgi?id=643)
  [[b2e138bde]](https://git.sudo.ws/sudo/commit/?id=b2e138bde)

2014-09-27 Todd C. Miller

* plugins/sudoers/env.c:

  Add BASH\_FUNC\_\* to environment blacklist for newer-style bash functions.
  [[c823eb3ef]](https://git.sudo.ws/sudo/commit/?id=c823eb3ef)

* Makefile.in:

  Pull additional password prompts out of mkpkg instead of hard-coding
  them.
  [[a62662fa3]](https://git.sudo.ws/sudo/commit/?id=a62662fa3)

* NEWS:

  Add post-1.8.11 changes
  [[38df51ffe]](https://git.sudo.ws/sudo/commit/?id=38df51ffe)

* Makefile.in, configure.ac, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/po/sudoers.pot:

  Add a space after “Password:” in default password prompt so it is easier
  to read when pwfeedback is enabled.
  [[496c2e287]](https://git.sudo.ws/sudo/commit/?id=496c2e287)

* plugins/sudoers/auth/sudo\_auth.c:

  Simplify how we count the password tries
  [[b7444e0f8]](https://git.sudo.ws/sudo/commit/?id=b7444e0f8)

* plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c:

  Block SIGINT and SIGQUIT while verifying passwords so that
  authentication modules that use sleep() are not interrupted. If the user
  interrupted authentication, exit the loop.
  [[355834c76]](https://git.sudo.ws/sudo/commit/?id=355834c76)

* configure, configure.ac:

  Remove Convex support; it is not modern enough to run sudo 1.8.
  [[0660d88b2]](https://git.sudo.ws/sudo/commit/?id=0660d88b2)

* configure, configure.ac:

  Only check for -lshadow if we haven’t already found getspnam() in libc.
  Rather than treat this specially, just add -lshadow as another place to
  search in addition to -lgen.
  [[27943df34]](https://git.sudo.ws/sudo/commit/?id=27943df34)

2014-09-26 Todd C. Miller

* plugins/sudoers/auth/sudo\_auth.c:

  If all authentication methods fail init/setup, fail with an error.
  [[d28c525ed]](https://git.sudo.ws/sudo/commit/?id=d28c525ed)

* plugins/sudoers/auth/sudo\_auth.c:

  Move pass\_warn() so that it is defined before it is called().
  [[410573474]](https://git.sudo.ws/sudo/commit/?id=410573474)

2014-09-24 Todd C. Miller

* pp:

  Remove duplicate Requires: line in generated rpm spec file.
  [[b6432173c]](https://git.sudo.ws/sudo/commit/?id=b6432173c)

* pp:

  In pp\_files\_expand() set \_target to be empty. Fixes a problem with
  Solaris sh where simply using typeset doesn’t causes the variable to be
  treated as local so we can inadvertantly inherit a value from a previous
  call.
  [[d92df7974]](https://git.sudo.ws/sudo/commit/?id=d92df7974)

2014-09-23 Todd C. Miller

* configure, configure.ac:

  Fix version for release.
  [[1073df76c]](https://git.sudo.ws/sudo/commit/?id=1073df76c)

2014-09-20 Todd C. Miller

* configure, configure.ac, pathnames.h.in:

  Only redefine \_PATH\_BSHELL on AIX if we included paths.h.
  [[8f75f65bb]](https://git.sudo.ws/sudo/commit/?id=8f75f65bb)

* NEWS:

  Bug 661
  [[6be0a820d]](https://git.sudo.ws/sudo/commit/?id=6be0a820d)

* pathnames.h.in, src/exec\_common.c, src/sudo.c:

  On AIX, \_PATH\_BSHELL is /usr/bin/bsh but we want to use /usr/bin/sh
  (which is usually ksh). This makes sudo’s behavior when executing a
  shell without the #! magic number match execvp() on AIX.
  [[7ab40be5c]](https://git.sudo.ws/sudo/commit/?id=7ab40be5c)

* pathnames.h.in:

  Whitespace changes.
  [[d4d724b88]](https://git.sudo.ws/sudo/commit/?id=d4d724b88)

* configure, m4/sudo.m4:

  Prefer /usr/bin/sh to /bin/sh to match modern systems.
  [[c952155b7]](https://git.sudo.ws/sudo/commit/?id=c952155b7)

* NEWS, lib/util/Makefile.in:

  Don’t use SSP\_CFLAGS or PIE\_CFLAGS when building mksiglist/mksigname as
  they are built with the host compiler which may be different when
  cross-compiling. From Gustavo Zacarias. Bug 662.
  [[f5647654d]](https://git.sudo.ws/sudo/commit/?id=f5647654d)

2014-09-17 Todd C. Miller

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po, po/cs.mo, po/cs.po,
  po/de.mo, po/de.po, po/eo.mo, po/eo.po, po/fi.mo, po/fi.po, po/nb.mo,
  po/nb.po, po/pl.mo, po/pl.po, po/pt\_BR.mo, po/pt\_BR.po, po/ru.mo,
  po/ru.po, po/sr.mo, po/sr.po, po/uk.mo, po/uk.po, po/vi.mo, po/vi.po,
  po/zh\_CN.mo, po/zh\_CN.po:

  Sync with translationproject.org
  [[ae137ba55]](https://git.sudo.ws/sudo/commit/?id=ae137ba55)

2014-09-16 Todd C. Miller

* plugins/sudoers/sudo\_nss.c:

  Make sure we can’t insert an nss entry in the list that has already been
  used before.
  [[09a876ced]](https://git.sudo.ws/sudo/commit/?id=09a876ced)

* plugins/sudoers/visudo\_json.c:

  Use correct gettext macro with sudo\_warnx()
  [[e7de8f66f]](https://git.sudo.ws/sudo/commit/?id=e7de8f66f)

* NEWS:

  Make nsswitch.conf bug fix description more accurrate. It affects the
  “files” nsswitch source too.
  [[109b2116c]](https://git.sudo.ws/sudo/commit/?id=109b2116c)

* NEWS:

  Mention nsswitch.conf duplicate entry fix.
  [[52b675d74]](https://git.sudo.ws/sudo/commit/?id=52b675d74)

2014-09-15 Todd C. Miller

* plugins/sudoers/parse.c, plugins/sudoers/sudoers.h:

  Make sudoers file nsswitch functions static to parse.c since they are
  self-contained.
  [[15dee8745]](https://git.sudo.ws/sudo/commit/?id=15dee8745)

* plugins/sudoers/sudo\_nss.c:

  Fix infinite loop when mulitple sudoers entries are present in
  nsswitch.conf. From Daniel Kopecek.
  [[f9ac17776]](https://git.sudo.ws/sudo/commit/?id=f9ac17776)

2014-09-10 Todd C. Miller

* NEWS:

  Fix for bug #660
  [[326167bad]](https://git.sudo.ws/sudo/commit/?id=326167bad)

* src/get\_pty.c:

  Fix compilation on systems without openpty(), \_getpty() or grantpt().
  From Vasilyy Balyasnyy
  [[d1fe802f0]](https://git.sudo.ws/sudo/commit/?id=d1fe802f0)

2014-09-08 Todd C. Miller

* src/conversation.c:

  Remove remaining use of SUDO\_CONV\_DEBUG\_MSG.
  [[398a16c6a]](https://git.sudo.ws/sudo/commit/?id=398a16c6a)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h:

  SUDO\_CONV\_DEBUG\_MSG is no longer supported.
  [[4913e02b4]](https://git.sudo.ws/sudo/commit/?id=4913e02b4)

* doc/sudo.conf.cat, doc/sudoers.cat:

  regen
  [[393e57b82]](https://git.sudo.ws/sudo/commit/?id=393e57b82)

* include/sudo\_debug.h, lib/util/sudo\_debug.c, lib/util/sudo\_printf.c,
  plugins/sudoers/iolog.c, plugins/sudoers/policy.c:

  There is no longer a reason for the plugin to init the debug subsystem
  itself. It will always be initialized by the front-end if needed.
  [[e20475922]](https://git.sudo.ws/sudo/commit/?id=e20475922)

* include/sudo\_alloc.h, include/sudo\_compat.h, include/sudo\_fatal.h:

  Add function arg names to prototypes where missing.
  [[0f735f658]](https://git.sudo.ws/sudo/commit/?id=0f735f658)

* lib/util/alloc.c:

  Remove obsolete definition of SIZE\_T which is now handled by
  sudo\_compat.h and rename the format arg to fmt in sudo\_evasprintf\_v1()
  for consistency with sudo\_easprintf\_v1().
  [[d557aee1e]](https://git.sudo.ws/sudo/commit/?id=d557aee1e)

* src/parse\_args.c:

  If we were invoked with any name ending in “edit”, treat as sudoedit.
  [[1cc243342]](https://git.sudo.ws/sudo/commit/?id=1cc243342)

2014-09-04 Todd C. Miller

* po/sudo.pot:

  regen
  [[5fcc7a8f2]](https://git.sudo.ws/sudo/commit/?id=5fcc7a8f2)

* src/exec.c, src/exec\_pty.c, src/signal.c:

  Check return value of sigaction(), even though it should never fail.
  [[328c56379]](https://git.sudo.ws/sudo/commit/?id=328c56379)

2014-09-03 Todd C. Miller

* lib/util/Makefile.in, src/Makefile.in:

  regen
  [[111136dc8]](https://git.sudo.ws/sudo/commit/?id=111136dc8)

* MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/parser/check\_hexchar.c:

  Add hexchar unit test
  [[2cc8ac30a]](https://git.sudo.ws/sudo/commit/?id=2cc8ac30a)

* plugins/sudoers/regress/parser/check\_addr.c:

  Avoid division by zero if there was no test data.
  [[b3586c46e]](https://git.sudo.ws/sudo/commit/?id=b3586c46e)

2014-09-02 Todd C. Miller

* lib/util/event.c:

  Remove confusing comment.
  [[f95ca8d4f]](https://git.sudo.ws/sudo/commit/?id=f95ca8d4f)

* lib/util/sudo\_debug.c:

  Use a stack buffer for the debug message when possible, most are small.
  [[4fa58d697]](https://git.sudo.ws/sudo/commit/?id=4fa58d697)

2014-09-01 Todd C. Miller

* plugins/sudoers/po/ca.mo, plugins/sudoers/po/ca.po, po/ca.mo, po/ca.po:

  Sync with translationproject.org
  [[f6e738fee]](https://git.sudo.ws/sudo/commit/?id=f6e738fee)

2014-08-31 Todd C. Miller

* src/exec.c:

  Convert a debug printf to a user-visible warning.
  [[0546f0b6a]](https://git.sudo.ws/sudo/commit/?id=0546f0b6a)

* include/sudo\_fatal.h, include/sudo\_util.h, lib/util/fatal.c:

  Move sudo\_printf extern to sudo\_util.h
  [[8bc688188]](https://git.sudo.ws/sudo/commit/?id=8bc688188)

* include/sudo\_fatal.h, include/sudo\_lbuf.h, lib/util/fatal.c,
  lib/util/lbuf.c:

  Some versions of the HP C Compiler don’t export functions that take
  function pointers as arguments unless a typedef is used.
  [[a07ce849f]](https://git.sudo.ws/sudo/commit/?id=a07ce849f)

* include/sudo\_lbuf.h:

  Work around a bug in the HP C compiler.
  [[73d5fb33e]](https://git.sudo.ws/sudo/commit/?id=73d5fb33e)

* lib/util/lbuf.c:

  Don’t need sudo\_fatal.h
  [[152178e4b]](https://git.sudo.ws/sudo/commit/?id=152178e4b)

2014-08-30 Todd C. Miller

* po/da.mo, po/da.po:

  Sync with translationproject.org
  [[6fdf9028e]](https://git.sudo.ws/sudo/commit/?id=6fdf9028e)

* src/exec.c:

  Remove signal\_event from evbase before calling sudo\_ev\_loopexit() when
  the command has exited or been killed. It is possible that we could
  receive another signal on the pipe if they are delivered out of order.
  [[cfa4cebf1]](https://git.sudo.ws/sudo/commit/?id=cfa4cebf1)

2014-08-29 Todd C. Miller

* src/exec\_pty.c:

  Treat EOF on signal pipe (which should never happen) as ECONNRESET.
  [[26e61adc5]](https://git.sudo.ws/sudo/commit/?id=26e61adc5)

* include/sudo\_event.h, lib/util/event.c, src/exec\_pty.c:

  Don’t allow sudo\_ev\_loopcont() to override sudo\_ev\_loopexit()
  [[2b849b268]](https://git.sudo.ws/sudo/commit/?id=2b849b268)

* include/sudo\_event.h, lib/util/event.c, lib/util/event\_poll.c,
  lib/util/event\_select.c:

  Add some internal convenience functions.
  [[e9370718f]](https://git.sudo.ws/sudo/commit/?id=e9370718f)

2014-08-26 Todd C. Miller

* sudo.pp:

  Fix osrelease sed expression. It wasn’t matching distros with a single
  digit version such as sles9.
  [[ef11361ee]](https://git.sudo.ws/sudo/commit/?id=ef11361ee)

* plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, po/cs.mo,
  po/cs.po, po/de.mo, po/de.po, po/eo.mo, po/eo.po, po/fi.mo, po/fi.po,
  po/it.mo, po/it.po, po/nb.mo, po/nb.po, po/pl.mo, po/pl.po, po/pt\_BR.mo,
  po/pt\_BR.po, po/ru.mo, po/ru.po, po/uk.mo, po/uk.po, po/vi.mo, po/vi.po,
  po/zh\_CN.mo, po/zh\_CN.po:

  Sync with translationproject.org
  [[191a0569f]](https://git.sudo.ws/sudo/commit/?id=191a0569f)

* plugins/sudoers/iolog.c:

  Return -1 from logging functions if we get a write error.
  [[af9306cd8]](https://git.sudo.ws/sudo/commit/?id=af9306cd8)

* NEWS:

  Mention I/O plugin changes.
  [[1345ebbcc]](https://git.sudo.ws/sudo/commit/?id=1345ebbcc)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  include/sudo\_plugin.h, src/exec\_pty.c:

  Change behavior when plugin I/O logging function returns 0 or -1. For -1
  (error) return, we now kill the command and disable the I/O logging
  function that returned the error. For a 0 (reject) return, we no longer
  display the rejected output to the user’s terminal. The plugin API
  revision is now 1.6.
  [[acdb6d369]](https://git.sudo.ws/sudo/commit/?id=acdb6d369)

* doc/sudoers.cat:

  regen to fix version.
  [[3e13662f3]](https://git.sudo.ws/sudo/commit/?id=3e13662f3)

* plugins/sample/sample\_plugin.c:

  Add trivial dirty word check to the sample output logging function.
  [[136e6e616]](https://git.sudo.ws/sudo/commit/?id=136e6e616)

2014-08-25 Todd C. Miller

* NEWS:

  Update for 1.8.11b2
  [[f0af3bb6b]](https://git.sudo.ws/sudo/commit/?id=f0af3bb6b)

* src/sudo\_edit.c:

  Fix restoration of effective uid/gid in command\_details. This masked the
  effects an unset (really zero) egid. Bug 656
  [[79f209dbd]](https://git.sudo.ws/sudo/commit/?id=79f209dbd)

* src/sudo.c:

  Set runas egid to the same value as runas gid if egid not specified by
  the plugin. Only affects new files created by sudoedit. [Bug
  #656](https://bugzilla.sudo.ws/show_bug.cgi?id=656)
  [[4f1deee57]](https://git.sudo.ws/sudo/commit/?id=4f1deee57)

* src/sudo\_edit.c:

  Don’t leak temp fd in sudo\_edit\_copy\_tfiles(). Fix fd leak in error path
  in sudo\_edit\_copy\_tfiles().
  [[5676d9874]](https://git.sudo.ws/sudo/commit/?id=5676d9874)

2014-08-22 Todd C. Miller

* NEWS:

  fix typo
  [[8ad53f458]](https://git.sudo.ws/sudo/commit/?id=8ad53f458)

* src/signal.c:

  We write an unsigned char, not an int, to the signal pipe.
  [[db494700d]](https://git.sudo.ws/sudo/commit/?id=db494700d)

2014-08-21 Todd C. Miller

* src/sudo\_edit.c:

  Sprinkle some debugging around uid/gid setting in sudoedit.
  [[a8f63191e]](https://git.sudo.ws/sudo/commit/?id=a8f63191e)

* src/sesh.c, src/sudo.c, src/sudo.h, src/sudo\_edit.c, src/sudo\_exec.h:

  Make sudoedit work with SELinux RBAC. Adapted from RedHat patches
  (Daniel Kopecek) but made to behave a bit more like the non-SELinux
  bits.
  [[db35c7c0e]](https://git.sudo.ws/sudo/commit/?id=db35c7c0e)

* src/sudo\_edit.c:

  Refactor code that copies temp files into separate functions.
  [[a147330f3]](https://git.sudo.ws/sudo/commit/?id=a147330f3)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Fix typo, .em should be .Em
  [[ffbc003b7]](https://git.sudo.ws/sudo/commit/?id=ffbc003b7)

2014-08-18 Todd C. Miller

* src/sesh.c:

  Add missing call to initprogname().
  [[2c542178a]](https://git.sudo.ws/sudo/commit/?id=2c542178a)

* lib/util/sudo\_debug.c, lib/util/sudo\_printf.c:

  Don’t recurse infinitely until we blow the stack when the debug file
  can’t be opened in the front-end. The conversation-type debug mode will
  be removed in the future.
  [[2246b1827]](https://git.sudo.ws/sudo/commit/?id=2246b1827)

2014-08-15 Todd C. Miller

* sudo.pp:

  Only use the first two digits of the version number. Fixes a problem on
  RHEL 7 which has version numbers like 7.0.1406
  [[dbe0b213d]](https://git.sudo.ws/sudo/commit/?id=dbe0b213d)

* plugins/sudoers/linux\_audit.c:

  Fix return value when kernel has no audit support.
  [[fb82e823f]](https://git.sudo.ws/sudo/commit/?id=fb82e823f)

* lib/util/progname.c:

  remove unused label
  [[6d8c6ed37]](https://git.sudo.ws/sudo/commit/?id=6d8c6ed37)

2014-08-14 Todd C. Miller

* aclocal.m4, autogen.sh:

  Update to automake 1.14 (no code changes).
  [[b0faa6da1]](https://git.sudo.ws/sudo/commit/?id=b0faa6da1)

2014-08-11 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document the interaction between sudoers environment handling and the
  pam\_env module.
  [[2d22d0dca]](https://git.sudo.ws/sudo/commit/?id=2d22d0dca)

* plugins/sudoers/env.c:

  Don’t allow pam\_env to overwrite existing variables when env\_reset is
  disabled unless the variables match the black list and would normally be
  removed. It may just be better to never overwrite when env\_reset is
  disabled.
  [[c49ca1d31]](https://git.sudo.ws/sudo/commit/?id=c49ca1d31)

2014-08-09 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Update year range to include 2014
  [[2f472d596]](https://git.sudo.ws/sudo/commit/?id=2f472d596)

2014-08-08 Todd C. Miller

* lib/util/Makefile.in:

  Remove regress .err files in distclean target.
  [[dcd505d0c]](https://git.sudo.ws/sudo/commit/?id=dcd505d0c)

* lib/util/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in:

  Remove generated files for linker as part of distclean.
  [[69762d888]](https://git.sudo.ws/sudo/commit/?id=69762d888)

* .hgignore:

  Ignore .out and .err files in lib/util regress
  [[bd57aad60]](https://git.sudo.ws/sudo/commit/?id=bd57aad60)

* NEWS:

  Add additional 1.8.11 changes and fix typos.
  [[53a251dc0]](https://git.sudo.ws/sudo/commit/?id=53a251dc0)

* configure, configure.ac, plugins/sudoers/Makefile.in:

  Avoid building/running the check\_symbols test program unless we are
  building a shared sudoers plugin.
  [[696080917]](https://git.sudo.ws/sudo/commit/?id=696080917)

* plugins/sudoers/Makefile.in, src/Makefile.in:

  Remove two instances of -no-fast-install that were missed before.
  [[dd43530f0]](https://git.sudo.ws/sudo/commit/?id=dd43530f0)

* INSTALL, NEWS, configure, configure.ac, lib/util/Makefile.in:

  Add –disable-shared-libutil configure option. It may only be used in
  conjunction with the –enable-static-sudoers option.
  [[76a6dad42]](https://git.sudo.ws/sudo/commit/?id=76a6dad42)

2014-08-07 Todd C. Miller

* doc/Makefile.in:

  Remove noop man.sed files Use full path instead of $@.in when calling
  config.status with –file=-
  [[779946ea3]](https://git.sudo.ws/sudo/commit/?id=779946ea3)

* src/preserve\_fds.c:

  Fix “sudo -C” when we have internal fds to preserve from closefrom().
  [[703263bf0]](https://git.sudo.ws/sudo/commit/?id=703263bf0)

2014-08-06 Todd C. Miller

* NEWS, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/env.c:

  Add explicit support for matching the full environment string
  (name=value). Bash functions may now be preserved for full matches, but
  not for name-only matches.
  [[df0fd4153]](https://git.sudo.ws/sudo/commit/?id=df0fd4153)

2014-08-05 Todd C. Miller

* .hgignore:

  Ignore lib/util/util.exp
  [[84fa5a505]](https://git.sudo.ws/sudo/commit/?id=84fa5a505)

2014-07-30 Todd C. Miller

* configure, configure.ac:

  Fix exporting of asprintf/vasprintf symbols.
  [[d75d22e98]](https://git.sudo.ws/sudo/commit/?id=d75d22e98)

* configure, configure.ac:

  Don’t export getaddrinfo symbols if we found the function in a library.
  [[0a9e9016f]](https://git.sudo.ws/sudo/commit/?id=0a9e9016f)

* src/sudo\_edit.c:

  It is now sudo\_efree() not efree(). Don’t try to free a pointer to
  garbage on error.
  [[7a988d489]](https://git.sudo.ws/sudo/commit/?id=7a988d489)

* plugins/sudoers/po/sudoers.pot, po/sudo.pot:

  Regen .pot files
  [[080d0e650]](https://git.sudo.ws/sudo/commit/?id=080d0e650)

2014-07-29 Todd C. Miller

* src/sudo\_edit.c:

  Plug memory leak, even though we are headed for exit.
  [[edf0d3970]](https://git.sudo.ws/sudo/commit/?id=edf0d3970)

* configure, configure.ac, lib/util/Makefile.in,
  plugins/sudoers/Makefile.in:

  If getaddrinfo() is missing libsudoutil may need to pull in networking
  libraries.
  [[f29880c1c]](https://git.sudo.ws/sudo/commit/?id=f29880c1c)

* MANIFEST, configure, configure.ac, include/sudo\_compat.h,
  lib/util/Makefile.in, lib/util/util.exp.in, m4/sudo.m4:

  Only include functions in util.exp that are actually in the library.
  Fixes a problem on Solaris where undefined functions that are listed as
  exported in the map file result in a link error. Also make sure we use
  our glob.c if the system is missing glob().
  [[daf634b72]](https://git.sudo.ws/sudo/commit/?id=daf634b72)

* configure, configure.ac:

  Make sure shadow libs don’t end up in LIBS, only SUDOERS\_LIBS (and
  SUDO\_LIBS if set\_auth\_parameters() or initprivs() are present.
  [[f99a91023]](https://git.sudo.ws/sudo/commit/?id=f99a91023)

* configure.ac:

  No need to AC\_SUBST HAVE\_BSM\_AUDIT and HAVE\_SOLARIS\_AUDIT
  [[58a59896b]](https://git.sudo.ws/sudo/commit/?id=58a59896b)

2014-07-28 Todd C. Miller

* src/exec.c, src/exec\_pty.c, src/sudo\_exec.h:

  Attempt to handle systems with SA\_SIGINFO but that lack SI\_USER.
  [[ae0014d6f]](https://git.sudo.ws/sudo/commit/?id=ae0014d6f)

* config.h.in, configure, configure.ac, include/sudo\_compat.h:

  Replace use of HAVE\_GETCWD with PREFER\_PORTABLE\_GETCWD. It is safe to
  assume getcwd() exists, we just need to handle broken ones.
  [[99ae71452]](https://git.sudo.ws/sudo/commit/?id=99ae71452)

* config.h.in, configure, configure.ac, plugins/sudoers/Makefile.in:

  Add check for inet\_ntoa() since it may live in libnsl. Make getcwd()
  replacement private to the SunOS 4 section.
  [[b0a09fb67]](https://git.sudo.ws/sudo/commit/?id=b0a09fb67)

* plugins/sudoers/match.c:

  Avoid mixing declarations and code for non-C99 compilers.
  [[014edc20a]](https://git.sudo.ws/sudo/commit/?id=014edc20a)

* include/sudo\_debug.h:

  For C89, use “const char **func**[]” instead of “const char \***func**”.
  [[120f0684b]](https://git.sudo.ws/sudo/commit/?id=120f0684b)

* plugins/sudoers/match.c:

  Fix compilation on systems w/o netgroups.
  [[d058611bd]](https://git.sudo.ws/sudo/commit/?id=d058611bd)

2014-07-26 Todd C. Miller

* src/preserve\_fds.c:

  Back out old workaround for sudoedit hang when debugging was enabled.
  [[787a89ed0]](https://git.sudo.ws/sudo/commit/?id=787a89ed0)

* src/sudo\_edit.c:

  Don’t memcpy() the preserved\_fds TAILQ as the pointers into the head
  will be wrong. All we need to do is save the old command details and
  restore them after calling run\_command(). Fixes a hang with sudoedit
  when debugging is enabled.
  [[6f77ffd7c]](https://git.sudo.ws/sudo/commit/?id=6f77ffd7c)

2014-07-25 Todd C. Miller

* src/sudo.c:

  The default policy close function should only print an error message if
  the error\_code is non-zero.
  [[32a837623]](https://git.sudo.ws/sudo/commit/?id=32a837623)

* src/preserve\_fds.c:

  If there the preserved fds list is empty, add a new element with
  TAILQ\_INSERT\_HEAD instead of TAILQ\_INSERT\_TAIL to avoid an infinite loop
  on AIX, Solaris and possibly others when debug mode is active.
  [[7e5a23974]](https://git.sudo.ws/sudo/commit/?id=7e5a23974)

* lib/util/progname.c:

  Remove support for getting program name via /proc as pr\_fname is usually
  filled in after symbolic links have been processed, even on Solaris.
  [[8c86e5c11]](https://git.sudo.ws/sudo/commit/?id=8c86e5c11)

* lib/util/Makefile.in:

  Use shlib\_enable instead of soext when determining whether to install
  the library.
  [[ceb1f6eae]](https://git.sudo.ws/sudo/commit/?id=ceb1f6eae)

* lib/util/regress/atofoo/atofoo\_test.c:

  Avoid potential division by zero
  [[cd56a8759]](https://git.sudo.ws/sudo/commit/?id=cd56a8759)

* lib/util/Makefile.in:

  Don’t link progname test with libsudo\_util, just link in progname.lo
  directly since that is all we need. Avoid a linker issue on darwin.
  [[ebbd62eac]](https://git.sudo.ws/sudo/commit/?id=ebbd62eac)

* lib/util/progname.c:

  Remove pstat\_getproc() path as pst\_ucomm on HP-UX will return the target
  of a symbolic link and not the name of the link itself. Avoid using
  pr\_fname on AIX for the same reason. Bug 654
  [[742152447]](https://git.sudo.ws/sudo/commit/?id=742152447)

* MANIFEST, lib/util/Makefile.in,
  lib/util/regress/progname/progname\_test.c:

  Add test for getprogname() and symbolic links; bug 654
  [[f6fec0603]](https://git.sudo.ws/sudo/commit/?id=f6fec0603)

2014-07-24 Todd C. Miller

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  Document tracing
  [[5ff2c8025]](https://git.sudo.ws/sudo/commit/?id=5ff2c8025)

2014-07-23 Todd C. Miller

* lib/util/util.exp:

  sudo\_term\_{erase,kill} are regular symbols not functions.
  [[536e5f418]](https://git.sudo.ws/sudo/commit/?id=536e5f418)

2014-07-22 Todd C. Miller

* plugins/sudoers/ldap.c:

  Fix NULL deref if base64\_decode returns -1.
  [[28f6ee5f9]](https://git.sudo.ws/sudo/commit/?id=28f6ee5f9)

* MANIFEST, include/sudo\_compat.h, lib/util/Makefile.in, lib/util/aix.c,
  lib/util/alloc.c, lib/util/clock\_gettime.c, lib/util/closefrom.c,
  lib/util/event.c, lib/util/event\_poll.c, lib/util/event\_select.c,
  lib/util/fatal.c, lib/util/fnmatch.c, lib/util/getaddrinfo.c,
  lib/util/getcwd.c, lib/util/getgrouplist.c, lib/util/getline.c,
  lib/util/getopt\_long.c, lib/util/gidlist.c, lib/util/glob.c,
  lib/util/inet\_pton.c, lib/util/isblank.c, lib/util/key\_val.c,
  lib/util/lbuf.c, lib/util/locking.c, lib/util/memrchr.c,
  lib/util/memset\_s.c, lib/util/mksiglist.c, lib/util/mksigname.c,
  lib/util/mktemp.c, lib/util/parseln.c, lib/util/progname.c,
  lib/util/pw\_dup.c, lib/util/regress/atofoo/atofoo\_test.c,
  lib/util/regress/fnmatch/fnm\_test.c, lib/util/regress/glob/globtest.c,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/tailq/hltq\_test.c, lib/util/secure\_path.c,
  lib/util/setgroups.c, lib/util/sha2.c, lib/util/sig2str.c,
  lib/util/snprintf.c, lib/util/strlcat.c, lib/util/strlcpy.c,
  lib/util/strsignal.c, lib/util/strtobool.c, lib/util/strtoid.c,
  lib/util/strtomode.c, lib/util/strtonum.c, lib/util/sudo\_conf.c,
  lib/util/sudo\_debug.c, lib/util/sudo\_dso.c, lib/util/sudo\_printf.c,
  lib/util/term.c, lib/util/ttysize.c, lib/util/utimes.c,
  plugins/group\_file/Makefile.in, plugins/group\_file/getgrent.c,
  plugins/group\_file/group\_file.c, plugins/sample/Makefile.in,
  plugins/sample/sample\_plugin.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/audit.c, plugins/sudoers/base64.c,
  plugins/sudoers/boottime.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/hexchar.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/locale.c, plugins/sudoers/redblack.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_fill.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/timestr.c,
  plugins/system\_group/Makefile.in, plugins/system\_group/system\_group.c,
  src/Makefile.in, src/locale\_stub.c, src/net\_ifs.c, src/preload.c,
  src/regress/ttyname/check\_ttyname.c, src/sesh.c, src/sudo.h,
  src/sudo\_noexec.c:

  Rename missing.h -> sudo\_compat.h
  [[47835ff28]](https://git.sudo.ws/sudo/commit/?id=47835ff28)

* MANIFEST, include/secure\_path.h, include/sudo\_util.h,
  lib/util/Makefile.in, lib/util/secure\_path.c, lib/util/sudo\_conf.c,
  plugins/sudoers/Makefile.in, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Merge secure\_path.h -> sudo\_util.h
  [[ecaecdc1f]](https://git.sudo.ws/sudo/commit/?id=ecaecdc1f)

* include/secure\_path.h, include/sudo\_alloc.h, include/sudo\_conf.h,
  include/sudo\_dso.h, include/sudo\_event.h, include/sudo\_fatal.h,
  include/sudo\_lbuf.h, include/sudo\_util.h, lib/util/aix.c,
  lib/util/alloc.c, lib/util/event.c, lib/util/fatal.c,
  lib/util/gidlist.c, lib/util/key\_val.c, lib/util/lbuf.c,
  lib/util/locking.c, lib/util/parseln.c, lib/util/secure\_path.c,
  lib/util/setgroups.c, lib/util/strtobool.c, lib/util/strtoid.c,
  lib/util/strtomode.c, lib/util/sudo\_conf.c, lib/util/sudo\_dso.c,
  lib/util/term.c, lib/util/ttysize.c, lib/util/util.exp,
  plugins/sudoers/locale.c, src/locale\_stub.c:

  Version the functions in libsudo\_util
  [[844a28539]](https://git.sudo.ws/sudo/commit/?id=844a28539)

2014-07-21 Todd C. Miller

* include/sudo\_gettext.h, lib/util/Makefile.in, lib/util/aix.c,
  lib/util/alloc.c, lib/util/fatal.c, lib/util/gidlist.c,
  lib/util/strsignal.c, lib/util/strtoid.c, lib/util/strtomode.c,
  lib/util/strtonum.c, lib/util/sudo\_conf.c, lib/util/sudo\_debug.c,
  plugins/sudoers/Makefile.in, plugins/sudoers/audit.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/locale.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c, src/Makefile.in, src/locale\_stub.c,
  src/net\_ifs.c, src/sesh.c, src/sudo.h:

  Rename gettext.h -> sudo\_gettext.h
  [[127ba1354]](https://git.sudo.ws/sudo/commit/?id=127ba1354)

* include/sudo\_fatal.h, lib/util/Makefile.in, lib/util/aix.c,
  lib/util/alloc.c, lib/util/event.c, lib/util/event\_poll.c,
  lib/util/event\_select.c, lib/util/fatal.c, lib/util/getopt\_long.c,
  lib/util/gidlist.c, lib/util/lbuf.c,
  lib/util/regress/atofoo/atofoo\_test.c,
  lib/util/regress/tailq/hltq\_test.c, lib/util/sudo\_conf.c,
  lib/util/sudo\_debug.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/locale.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/logging/check\_wrap.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c, src/Makefile.in, src/locale\_stub.c,
  src/net\_ifs.c, src/regress/ttyname/check\_ttyname.c, src/sesh.c,
  src/sudo.h:

  Rename fatal.h -> sudo\_fatal.h
  [[3687b665c]](https://git.sudo.ws/sudo/commit/?id=3687b665c)

* include/sudo\_conf.h, include/sudo\_event.h, include/sudo\_queue.h,
  lib/util/Makefile.in, lib/util/fatal.c,
  lib/util/regress/tailq/hltq\_test.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/parser/check\_fill.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c, src/Makefile.in, src/hooks.c:

  Rename queue.h -> sudo\_queue.h to avoid collisions with the system
  version.
  [[b45727cef]](https://git.sudo.ws/sudo/commit/?id=b45727cef)

* include/sudo\_debug.h, lib/util/sudo\_debug.c:

  Conver sudo\_debug\_write() to a macro
  [[d7c309f70]](https://git.sudo.ws/sudo/commit/?id=d7c309f70)

2014-07-17 Todd C. Miller

* doc/fixman.sh, doc/fixmdoc.sh:

  Fix man page post-processing; it was deleting more than intended.
  [[2b104d6b3]](https://git.sudo.ws/sudo/commit/?id=2b104d6b3)

2014-07-16 Todd C. Miller

* doc/Makefile.in:

  Remove double $(srcdir) when running sed scripts.
  [[c6879683a]](https://git.sudo.ws/sudo/commit/?id=c6879683a)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  “an EXEC tag” not “a EXEC tag”
  [[a1da1d1e4]](https://git.sudo.ws/sudo/commit/?id=a1da1d1e4)

* doc/sudoers.cat:

  Document that I/O logging is not enabled by default.
  [[0d6e81ee5]](https://git.sudo.ws/sudo/commit/?id=0d6e81ee5)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document that exec\_background is off by default.
  [[64005c2e0]](https://git.sudo.ws/sudo/commit/?id=64005c2e0)

2014-07-14 Todd C. Miller

* src/sesh.c:

  Error out if sesh is run as a login shell but the shell it needs to run
  has no slash. This shouldn’t happen in practice.
  [[fb96eb244]](https://git.sudo.ws/sudo/commit/?id=fb96eb244)

* MANIFEST, lib/util/Makefile.in, lib/util/mksiglist.c,
  lib/util/mksiglist.h, lib/util/mksigname.c, lib/util/mksigname.h:

  Move mksiglist.h and mksigname.h to lib/util where they belong.
  [[9071e9508]](https://git.sudo.ws/sudo/commit/?id=9071e9508)

* config.h.in, configure, configure.ac, include/missing.h,
  lib/util/progname.c, lib/util/util.exp, plugins/sudoers/Makefile.in:

  Avoid passing -no-fast-install to libtool as this results in the build
  dir being left in the library path of the installed executable. Instead,
  we remove the “lt-” prefix from the program name in initprogname() so
  that the regress test output is unaffected by libtool’s binary wrapper.
  [[96d1967ab]](https://git.sudo.ws/sudo/commit/?id=96d1967ab)

* sudo.pp:

  Fix syntax error with some shells.
  [[4bc4522ed]](https://git.sudo.ws/sudo/commit/?id=4bc4522ed)

2014-07-13 Todd C. Miller

* configure, configure.ac:

  Force libtool to use runtime linking on AIX so that it installs the
  plugins as .so files and not .a files.
  [[00bac387b]](https://git.sudo.ws/sudo/commit/?id=00bac387b)

* plugins/sudoers/ldap.c:

  Be sure to NUL-terminate the decoded secret when converting from base64.
  [[430ad0fa8]](https://git.sudo.ws/sudo/commit/?id=430ad0fa8)

* plugins/sudoers/ldap.c:

  Fix a pointer signednes warning calling base64\_decode().
  [[b5a6037a6]](https://git.sudo.ws/sudo/commit/?id=b5a6037a6)

* lib/util/getgrouplist.c:

  Use sudo\_strtoid() now that it is located in the same library.
  [[9f3caa5a6]](https://git.sudo.ws/sudo/commit/?id=9f3caa5a6)

* lib/util/strtoid.c:

  Skip leading space (ala strtol) so that we can pick up the sign even if
  it is not the first character of the string.
  [[c10c9cd5e]](https://git.sudo.ws/sudo/commit/?id=c10c9cd5e)

2014-07-12 Todd C. Miller

* plugins/sudoers/sudoers.c:

  For sudoedit, audit the actual editor being run, not just the sudoedit
  command.
  [[cedc34561]](https://git.sudo.ws/sudo/commit/?id=cedc34561)

* src/selinux.c:

  Audit failed user role changes. RedHat bz #665131
  [[d5ecc1590]](https://git.sudo.ws/sudo/commit/?id=d5ecc1590)

* plugins/sudoers/Makefile.in:

  Avoid running check\_symbols for static sudoers
  [[de56eb8b9]](https://git.sudo.ws/sudo/commit/?id=de56eb8b9)

* plugins/sudoers/regress/visudo/test3.err.ok,
  plugins/sudoers/regress/visudo/test3.sh:

  Adapt to unused alias changes.
  [[be9149f6c]](https://git.sudo.ws/sudo/commit/?id=be9149f6c)

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in,
  plugins/sudoers/visudo.c:

  An unused alias is not really an error, even in strict mode. RedHat bz
  #604297
  [[e64f1198b]](https://git.sudo.ws/sudo/commit/?id=e64f1198b)

* src/sesh.c:

  When running a login shell via sesh, make new argv[0] -shell, not
  /path/to-shell. RedHat bz #1065418
  [[3f216cc2b]](https://git.sudo.ws/sudo/commit/?id=3f216cc2b)

2014-07-11 Todd C. Miller

* sudo.pp:

  The RHEL sudo package allows users in group wheel to run sudo.
  [[691421011]](https://git.sudo.ws/sudo/commit/?id=691421011)

* Makefile.in, sudo.pp:

  Avoid packaging parent directories when they are system directories.
  Currently we just skip this when prefix is /usr
  [[d86df074d]](https://git.sudo.ws/sudo/commit/?id=d86df074d)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Fix typo: sudo.d -> sudoers.d. From RedHat bz #726634
  [[81a989fd1]](https://git.sudo.ws/sudo/commit/?id=81a989fd1)

* mkpkg:

  RHEL 6 and above use /etc/sudo-ldap.conf not /etc/ldap.conf
  [[06076e445]](https://git.sudo.ws/sudo/commit/?id=06076e445)

* pp:

  For rpm, do not specify a mode in %attr for symbolic links. Avoids the
  warning “Explicit %attr() mode not applicaple to symlink”
  [[16b9aed75]](https://git.sudo.ws/sudo/commit/?id=16b9aed75)

2014-07-10 Todd C. Miller

* include/sudo\_alloc.h, lib/util/aix.c, lib/util/event.c,
  lib/util/event\_poll.c, lib/util/event\_select.c, lib/util/fatal.c,
  lib/util/lbuf.c, lib/util/sudo\_conf.c, plugins/sudoers/alias.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/check.c, plugins/sudoers/defaults.c,
  plugins/sudoers/env.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/interfaces.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/ldap.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/locale.c, plugins/sudoers/logging.c,
  plugins/sudoers/match.c, plugins/sudoers/policy.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/redblack.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c, src/exec.c,
  src/exec\_common.c, src/exec\_pty.c, src/hooks.c, src/load\_plugins.c,
  src/net\_ifs.c, src/preserve\_fds.c, src/regress/ttyname/check\_ttyname.c,
  src/selinux.c, src/sudo.c, src/ttyname.c:

  efree -> sudo\_efree for consistency
  [[36a5767e3]](https://git.sudo.ws/sudo/commit/?id=36a5767e3)

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo\_plugin.cat, doc/sudoers.cat,
  doc/sudoreplay.cat, doc/visudo.cat:

  regen
  [[1996777cd]](https://git.sudo.ws/sudo/commit/?id=1996777cd)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  plugins/sudoers/ldap.c:

  Add support for base64 secrets in ldap.conf and ldap.secret. Based on an
  idea from anthony AT rlost DOT com
  [[c35d7f2b0]](https://git.sudo.ws/sudo/commit/?id=c35d7f2b0)

2014-07-09 Todd C. Miller

* mkpkg:

  Don’t use the HP compiler in preference to gcc. Some versions have
  trouble compiling lbuf.c.
  [[bd0787b68]](https://git.sudo.ws/sudo/commit/?id=bd0787b68)

2014-07-08 Todd C. Miller

* configure, configure.ac, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Remove @SOEXT@ and @SHLIB\_EXT@ now that we use libtool to install
  shared objects. Instead, use the new @SHLIB\_ENABLE@ that is set to the
  value of $enable\_dlopen. For sudo\_noexec.so there is nothing special to
  do since the install-noexec target is only called when noexec is enabled
  by configure.
  [[78d2b42b7]](https://git.sudo.ws/sudo/commit/?id=78d2b42b7)

* configure, configure.ac:

  Make dynamic shared objects non-writable on HP-UX. Using writable DSOs
  can substantially increase the load time.
  [[e806b9651]](https://git.sudo.ws/sudo/commit/?id=e806b9651)

* include/fatal.h, lib/util/fatal.c, lib/util/util.exp,
  plugins/sudoers/locale.c, src/locale\_stub.c:

  Add sudo\_warn\_strerror() that wraps strerror() with calls to setlocale()
  in sudoers so we always get the error string in the user’s locale. Also
  change \_warning() to take the error number as a parameter instead of
  examining errno.
  [[12c3b456d]](https://git.sudo.ws/sudo/commit/?id=12c3b456d)

2014-07-03 Todd C. Miller

* Makefile.in, lib/util/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Avoid a cppcheck warning when NSIG is not defined.
  [[2bad71754]](https://git.sudo.ws/sudo/commit/?id=2bad71754)

* include/missing.h:

  Fix typos in utimes/futimes macros.
  [[5c117d480]](https://git.sudo.ws/sudo/commit/?id=5c117d480)

2014-07-01 Todd C. Miller

* configure:

  regen
  [[4ad98300d]](https://git.sudo.ws/sudo/commit/?id=4ad98300d)

* configure.ac:

  Fix sudo when –disable-shared configure option was specified.
  [[fb2b6e59f]](https://git.sudo.ws/sudo/commit/?id=fb2b6e59f)

2014-06-29 Todd C. Miller

* configure, configure.ac, lib/util/Makefile.in,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  Use libtool to install/uninstall the plugins and sudo\_noexec.
  [[4e1e76a4b]](https://git.sudo.ws/sudo/commit/?id=4e1e76a4b)

2014-07-01 Todd C. Miller

* configure, m4/libtool.m4:

  Do not set an internal name for HP-UX modules, only archives. This works
  around a problem with some versions of HP-UX ld where setting an
  internal name that doesn’t end in .sl causes link errors.
  [[da13a1430]](https://git.sudo.ws/sudo/commit/?id=da13a1430)

* plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/system\_group/Makefile.in:

  Never build build static versions of other plugins.
  [[fd7646bce]](https://git.sudo.ws/sudo/commit/?id=fd7646bce)

* lib/util/Makefile.in:

  Don’t build a static libsudo\_util.a unless we are linking sudoers
  statically.
  [[2ab61a128]](https://git.sudo.ws/sudo/commit/?id=2ab61a128)

2014-06-29 Todd C. Miller

* configure, ltmain.sh, m4/libtool.m4:

  Fix my typos in the HP-UX libtool patch
  [[67efcf092]](https://git.sudo.ws/sudo/commit/?id=67efcf092)

2014-06-27 Todd C. Miller

* NEWS:

  Mention Solaris audit.
  [[fb60fd863]](https://git.sudo.ws/sudo/commit/?id=fb60fd863)

* INSTALL, MANIFEST, config.h.in, configure, configure.ac, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/audit.c,
  plugins/sudoers/solaris\_audit.c, plugins/sudoers/solaris\_audit.h:

  Add Solaris audit support; from Gary Winiger at Oracle.
  [[18dbc52e4]](https://git.sudo.ws/sudo/commit/?id=18dbc52e4)

* MANIFEST:

  Sync MANIFEST with file name changes.
  [[6df640411]](https://git.sudo.ws/sudo/commit/?id=6df640411)

* plugins/sudoers/toke.c:

  regen
  [[6217df4c1]](https://git.sudo.ws/sudo/commit/?id=6217df4c1)

* include/sudo\_util.h, lib/util/Makefile.in, lib/util/getgrouplist.c,
  lib/util/gidlist.c, lib/util/regress/atofoo/atofoo\_test.c,
  lib/util/strtobool.c, lib/util/strtoid.c, lib/util/strtomode.c,
  lib/util/sudo\_conf.c, lib/util/util.exp, plugins/group\_file/getgrent.c,
  plugins/sudoers/defaults.c, plugins/sudoers/iolog.c,
  plugins/sudoers/ldap.c, plugins/sudoers/match.c,
  plugins/sudoers/policy.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/tsgetgrpw.c, plugins/sudoers/visudo\_json.c,
  plugins/system\_group/system\_group.c, src/sudo.c:

  atobool -> sudo\_strtobool atoid-> sudo\_strtoid atomode ->
  sudo\_strtomode
  [[a8fa112a5]](https://git.sudo.ws/sudo/commit/?id=a8fa112a5)

* lib/util/alloc.c, lib/util/event\_select.c:

  Fix regexp damage when renaming erecalloc() -> sudo\_erecalloc()
  [[d6948f5a4]](https://git.sudo.ws/sudo/commit/?id=d6948f5a4)

* src/sudo\_edit.c:

  Handle systems like AIX that lack a way to set the modification time on
  open fds.
  [[2be0929f2]](https://git.sudo.ws/sudo/commit/?id=2be0929f2)

* MANIFEST:

  update MANIFEST for alloc.h -> sudo\_alloc.h change
  [[1ee8afe1b]](https://git.sudo.ws/sudo/commit/?id=1ee8afe1b)

* include/sudo\_alloc.h, lib/util/Makefile.in, lib/util/aix.c,
  lib/util/alloc.c, lib/util/event.c, lib/util/event\_poll.c,
  lib/util/event\_select.c, lib/util/fatal.c, lib/util/gidlist.c,
  lib/util/lbuf.c, lib/util/sudo\_conf.c, lib/util/sudo\_debug.c,
  lib/util/util.exp, plugins/sudoers/Makefile.in, plugins/sudoers/alias.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/defaults.c,
  plugins/sudoers/env.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/getspwuid.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/interfaces.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/ldap.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/locale.c,
  plugins/sudoers/logging.c, plugins/sudoers/match.c,
  plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/redblack.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c,
  src/Makefile.in, src/conversation.c, src/env\_hooks.c, src/exec.c,
  src/exec\_common.c, src/exec\_pty.c, src/hooks.c, src/load\_plugins.c,
  src/net\_ifs.c, src/parse\_args.c, src/preserve\_fds.c,
  src/regress/ttyname/check\_ttyname.c, src/selinux.c, src/sesh.c,
  src/sudo.c, src/sudo.h, src/sudo\_edit.c, src/ttyname.c:

  Add sudo\_ prefix to alloc.c functions and rename alloc.h ->
  sudo\_alloc.h
  [[2d61d38c2]](https://git.sudo.ws/sudo/commit/?id=2d61d38c2)

* lib/util/fatal.c:

  Remove extra sudo\_ prefix from vfatalxnodebug and vfatalx\_nodebug.
  [[c4c253847]](https://git.sudo.ws/sudo/commit/?id=c4c253847)

* MANIFEST, include/fileops.h, include/sudo\_util.h, lib/util/Makefile.in,
  lib/util/locking.c, lib/util/parseln.c,
  lib/util/regress/sudo\_parseln/parseln\_test.c, lib/util/sudo\_conf.c,
  plugins/sudoers/Makefile.in, plugins/sudoers/sudoers.h, src/Makefile.in,
  src/sudo.h:

  Split fileops.c into parseln.c and locking.c
  [[8e088e65c]](https://git.sudo.ws/sudo/commit/?id=8e088e65c)

* include/fatal.h, include/gettext.h, lib/util/aix.c, lib/util/alloc.c,
  lib/util/fatal.c, lib/util/getopt\_long.c, lib/util/gidlist.c,
  lib/util/regress/atofoo/atofoo\_test.c,
  lib/util/regress/tailq/hltq\_test.c, lib/util/sudo\_conf.c,
  lib/util/util.exp, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/defaults.c,
  plugins/sudoers/env.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/locale.c,
  plugins/sudoers/logging.c, plugins/sudoers/match.c,
  plugins/sudoers/policy.c, plugins/sudoers/prompt.c,
  plugins/sudoers/pwutil.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c,
  plugins/sudoers/visudo\_json.c, src/exec.c, src/exec\_common.c,
  src/exec\_pty.c, src/hooks.c, src/load\_plugins.c, src/locale\_stub.c,
  src/net\_ifs.c, src/parse\_args.c, src/selinux.c, src/sesh.c,
  src/signal.c, src/solaris.c, src/sudo.c, src/sudo\_edit.c,
  src/tgetpass.c, src/ttyname.c, src/utmp.c:

  Rename warning/fatal -> sudo\_warn/sudo\_fatal to avoid namespace
  pollution in libsudo\_util.so.
  [[aecef4aa1]](https://git.sudo.ws/sudo/commit/?id=aecef4aa1)

2014-06-26 Todd C. Miller

* include/sudo\_util.h, lib/util/term.c, lib/util/ttysize.c,
  lib/util/util.exp, plugins/sudoers/sudoreplay.c, src/exec\_pty.c,
  src/sudo.c, src/tgetpass.c:

  Reduce name space pollution in libsudo\_util.so
  [[d36846a69]](https://git.sudo.ws/sudo/commit/?id=d36846a69)

* src/solaris.c:

  Use sudo\_dso\_load() from libsudo\_util.so instead of dlopen() since we no
  longer link sudo directly with libdl.so.
  [[9b3c19cc3]](https://git.sudo.ws/sudo/commit/?id=9b3c19cc3)

* MANIFEST, Makefile.in, include/sudo\_lbuf.h, lib/util/Makefile.in,
  lib/util/lbuf.c, lib/util/util.exp, plugins/sudoers/Makefile.in,
  plugins/sudoers/ldap.c, plugins/sudoers/parse.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudo\_nss.h,
  plugins/sudoers/sudoers.h, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, src/Makefile.in, src/parse\_args.c:

  Don’t pollute the namespace with lbuf struct and functions
  [[7bafa63c1]](https://git.sudo.ws/sudo/commit/?id=7bafa63c1)

* include/sudo\_util.h, lib/util/gidlist.c, lib/util/util.exp,
  plugins/sudoers/policy.c, src/sudo.c:

  Rename parse\_gid\_list -> sudo\_parse\_gids to avoid namespace pollution.
  [[6bdee0488]](https://git.sudo.ws/sudo/commit/?id=6bdee0488)

* MANIFEST, include/sudo\_util.h, lib/util/Makefile.in, lib/util/key\_val.c,
  lib/util/util.exp, plugins/sample/sample\_plugin.c,
  plugins/sudoers/policy.c, src/Makefile.in, src/exec\_common.c,
  src/parse\_args.c, src/sudo.c:

  Rename fmt\_string -> sudo\_new\_key\_val to better describe its function.
  [[9ba5d8292]](https://git.sudo.ws/sudo/commit/?id=9ba5d8292)

* include/fileops.h, lib/util/fileops.c, lib/util/util.exp,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/logging.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/visudo.c, src/sudo\_edit.c:

  Remove touch() from fileops.c and just call utimes/futimes directly.
  Rename lock\_file -> sudo\_lock\_file to avoid namespace pollution
  [[f029e3e74]](https://git.sudo.ws/sudo/commit/?id=f029e3e74)

* NEWS, configure, configure.ac:

  Sudo 1.8.11
  [[36e828b59]](https://git.sudo.ws/sudo/commit/?id=36e828b59)

* include/fatal.h, lib/util/fatal.c, lib/util/util.exp,
  plugins/sudoers/iolog.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c:

  Remove use of setjmp/longjmp in the sudoers plugin. We no longer call
  fatal() except in the malloc wrappers and due to libsudo\_util there is
  now a single copy of fatal/fatalx.
  [[2166a6afe]](https://git.sudo.ws/sudo/commit/?id=2166a6afe)

* MANIFEST, Makefile.in, doc/Makefile.in, include/alloc.h,
  include/compat/fnmatch.h, include/compat/getaddrinfo.h,
  include/compat/getopt.h, include/compat/glob.h, include/compat/sha2.h,
  include/fatal.h, include/fileops.h, include/lbuf.h, include/missing.h,
  include/secure\_path.h, include/sudo\_conf.h, include/sudo\_debug.h,
  include/sudo\_dso.h, include/sudo\_event.h, include/sudo\_util.h,
  install-sh, lib/util/Makefile.in, lib/util/fatal.c,
  lib/util/getaddrinfo.c, lib/util/pw\_dup.c,
  lib/util/regress/fnmatch/fnm\_test.c, lib/util/sudo\_dso.c,
  lib/util/sudo\_printf.c, lib/util/term.c, lib/util/util.exp,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/match.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/visudo.c,
  plugins/system\_group/Makefile.in, src/Makefile.in, src/parse\_args.c,
  src/preload.c:

  Add exported libsudo\_util functions to util.exp and mark in headers
  using \_\_dso\_public.
  [[088edcb6f]](https://git.sudo.ws/sudo/commit/?id=088edcb6f)

* config.h.in, configure, configure.ac, include/compat/fnmatch.h,
  include/compat/getaddrinfo.h, include/compat/getopt.h,
  include/compat/glob.h, include/missing.h, lib/util/clock\_gettime.c,
  lib/util/closefrom.c, lib/util/fnmatch.c, lib/util/getaddrinfo.c,
  lib/util/getcwd.c, lib/util/getgrouplist.c, lib/util/getline.c,
  lib/util/getopt\_long.c, lib/util/glob.c, lib/util/inet\_pton.c,
  lib/util/memrchr.c, lib/util/memset\_s.c, lib/util/mktemp.c,
  lib/util/pw\_dup.c, lib/util/sig2str.c, lib/util/snprintf.c,
  lib/util/strlcat.c, lib/util/strlcpy.c, lib/util/strsignal.c,
  lib/util/strtonum.c, lib/util/utimes.c:

  Prefix all libc replacements with sudo\_ and #define the real name to the
  sudo\_ version. That way we don’t pollute the libc namespace.
  [[87c2fe5a3]](https://git.sudo.ws/sudo/commit/?id=87c2fe5a3)

* .hgignore, MANIFEST, Makefile.in, common/Makefile.in,
  compat/Makefile.in, configure, configure.ac, include/compat/charclass.h,
  include/compat/endian.h, include/compat/fnmatch.h,
  include/compat/getaddrinfo.h, include/compat/getopt.h,
  include/compat/glob.h, include/compat/mksiglist.h,
  include/compat/mksigname.h, include/compat/nss\_dbdefs.h,
  include/compat/sha2.h, include/compat/stdbool.h,
  include/compat/timespec.h, include/compat/utime.h, lib/util/Makefile.in,
  lib/util/aix.c, lib/util/alloc.c, lib/util/atobool.c, lib/util/atoid.c,
  lib/util/atomode.c, lib/util/clock\_gettime.c, lib/util/closefrom.c,
  lib/util/event.c, lib/util/event\_poll.c, lib/util/event\_select.c,
  lib/util/fatal.c, lib/util/fileops.c, lib/util/fmt\_string.c,
  lib/util/fnmatch.c, lib/util/getaddrinfo.c, lib/util/getcwd.c,
  lib/util/getgrouplist.c, lib/util/getline.c, lib/util/getopt\_long.c,
  lib/util/gidlist.c, lib/util/glob.c, lib/util/inet\_pton.c,
  lib/util/isblank.c, lib/util/lbuf.c, lib/util/memrchr.c,
  lib/util/memset\_s.c, lib/util/mksiglist.c, lib/util/mksigname.c,
  lib/util/mktemp.c, lib/util/progname.c, lib/util/pw\_dup.c,
  lib/util/regress/atofoo/atofoo\_test.c,
  lib/util/regress/fnmatch/fnm\_test.c,
  lib/util/regress/fnmatch/fnm\_test.in, lib/util/regress/glob/files,
  lib/util/regress/glob/globtest.c, lib/util/regress/glob/globtest.in,
  lib/util/regress/sudo\_conf/conf\_test.c,
  lib/util/regress/sudo\_conf/test1.in,
  lib/util/regress/sudo\_conf/test1.out.ok,
  lib/util/regress/sudo\_conf/test2.in,
  lib/util/regress/sudo\_conf/test2.out.ok,
  lib/util/regress/sudo\_conf/test3.in,
  lib/util/regress/sudo\_conf/test3.out.ok,
  lib/util/regress/sudo\_conf/test4.in,
  lib/util/regress/sudo\_conf/test4.out.ok,
  lib/util/regress/sudo\_conf/test5.err.ok,
  lib/util/regress/sudo\_conf/test5.in,
  lib/util/regress/sudo\_conf/test5.out.ok,
  lib/util/regress/sudo\_conf/test6.in,
  lib/util/regress/sudo\_conf/test6.out.ok,
  lib/util/regress/sudo\_parseln/parseln\_test.c,
  lib/util/regress/sudo\_parseln/test1.in,
  lib/util/regress/sudo\_parseln/test1.out.ok,
  lib/util/regress/sudo\_parseln/test2.in,
  lib/util/regress/sudo\_parseln/test2.out.ok,
  lib/util/regress/sudo\_parseln/test3.in,
  lib/util/regress/sudo\_parseln/test3.out.ok,
  lib/util/regress/sudo\_parseln/test4.in,
  lib/util/regress/sudo\_parseln/test4.out.ok,
  lib/util/regress/sudo\_parseln/test5.in,
  lib/util/regress/sudo\_parseln/test5.out.ok,
  lib/util/regress/sudo\_parseln/test6.in,
  lib/util/regress/sudo\_parseln/test6.out.ok,
  lib/util/regress/tailq/hltq\_test.c, lib/util/secure\_path.c,
  lib/util/setgroups.c, lib/util/sha2.c, lib/util/sig2str.c,
  lib/util/siglist.in, lib/util/snprintf.c, lib/util/strlcat.c,
  lib/util/strlcpy.c, lib/util/strsignal.c, lib/util/strtonum.c,
  lib/util/sudo\_conf.c, lib/util/sudo\_debug.c, lib/util/sudo\_dso.c,
  lib/util/sudo\_printf.c, lib/util/term.c, lib/util/ttysize.c,
  lib/util/utimes.c, lib/zlib/Makefile.in, lib/zlib/adler32.c,
  lib/zlib/compress.c, lib/zlib/crc32.c, lib/zlib/crc32.h,
  lib/zlib/deflate.c, lib/zlib/deflate.h, lib/zlib/gzclose.c,
  lib/zlib/gzguts.h, lib/zlib/gzlib.c, lib/zlib/gzread.c,
  lib/zlib/gzwrite.c, lib/zlib/infback.c, lib/zlib/inffast.c,
  lib/zlib/inffast.h, lib/zlib/inffixed.h, lib/zlib/inflate.c,
  lib/zlib/inflate.h, lib/zlib/inftrees.c, lib/zlib/inftrees.h,
  lib/zlib/trees.c, lib/zlib/trees.h, lib/zlib/uncompr.c,
  lib/zlib/zconf.h.in, lib/zlib/zlib.h, lib/zlib/zutil.c,
  lib/zlib/zutil.h, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, po/README, po/ca.mo, po/ca.po,
  po/cs.mo, po/cs.po, po/da.mo, po/da.po, po/de.mo, po/de.po, po/eo.mo,
  po/eo.po, po/es.mo, po/es.po, po/eu.mo, po/eu.po, po/fi.mo, po/fi.po,
  po/fr.mo, po/fr.po, po/gl.mo, po/gl.po, po/hr.mo, po/hr.po, po/it.mo,
  po/it.po, po/ja.mo, po/ja.po, po/nb.mo, po/nb.po, po/nl.mo, po/nl.po,
  po/pl.mo, po/pl.po, po/pt\_BR.mo, po/pt\_BR.po, po/ru.mo, po/ru.po,
  po/sl.mo, po/sl.po, po/sr.mo, po/sr.po, po/sudo.pot, po/sv.mo, po/sv.po,
  po/tr.mo, po/tr.po, po/uk.mo, po/uk.po, po/vi.mo, po/vi.po, po/zh\_CN.mo,
  po/zh\_CN.po, src/Makefile.in:

  Top level directory reorg Move src/po -> po Combine common and compat
  -> lib/util Move zlib -> lib/zlib
  [[4d37a4a16]](https://git.sudo.ws/sudo/commit/?id=4d37a4a16)

* configure, ltmain.sh, m4/libtool.m4:

  libtool patches for HP-UX to support DESTDIR
  [[d41276f17]](https://git.sudo.ws/sudo/commit/?id=d41276f17)

* pp:

  Update polypkg from trunk.
  [[976836a3d]](https://git.sudo.ws/sudo/commit/?id=976836a3d)

* plugins/sudoers/sssd.c, plugins/sudoers/sudo\_nss.c:

  Fix sssd compiler warnings and fix the sha2 digest support.
  [[fdda9b109]](https://git.sudo.ws/sudo/commit/?id=fdda9b109)

2014-06-17 Todd C. Miller

* plugins/sudoers/ldap.c:

  Don’t call gss\_krb5\_ccache\_name() with a NULL pointer when restoring the
  old credential cache file name. This can happen if there was no old name
  returned by gss\_krb5\_ccache\_name(). Fixes a crash on kerberized LDAP on
  some platforms.
  [[b5b75b2d8]](https://git.sudo.ws/sudo/commit/?id=b5b75b2d8)

2014-06-04 Todd C. Miller

* MANIFEST, doc/CONTRIBUTORS, plugins/sudoers/po/el.mo,
  plugins/sudoers/po/el.po:

  Add Greek PO file for sudoers from translationproject.org
  [[7e24b8e65]](https://git.sudo.ws/sudo/commit/?id=7e24b8e65)

2014-05-28 Todd C. Miller

* src/exec.c, src/exec\_pty.c:

  Ignore signals sent by the command’s process group, not just the command
  itself. If we cannot determine the process group ID of the sender (as it
  may no longer exist), just check the process ID.
  [[826e190f3]](https://git.sudo.ws/sudo/commit/?id=826e190f3)

2014-05-27 Todd C. Miller

* src/exec.c:

  In handler\_user\_only() only forward the signal if it was not generated
  by the command. This should fix a problem with programs that catch
  SIGTSTP, perform cleanup, and then re-send the signal to their process
  group (of which sudo is the leader).
  [[b121da2e2]](https://git.sudo.ws/sudo/commit/?id=b121da2e2)

* src/exec.c, src/exec\_pty.c, src/signal.c:

  Handle EINTR from write(2) when writing to pipes and socket pairs.
  [[d628e17ea]](https://git.sudo.ws/sudo/commit/?id=d628e17ea)

2014-05-24 Todd C. Miller

* MANIFEST, plugins/sudoers/po/nb.mo, plugins/sudoers/po/nb.po:

  Norwegian Bokmaal translation for sudoers from translationproject.com
  [[9e5a68627]](https://git.sudo.ws/sudo/commit/?id=9e5a68627)

2014-05-23 Todd C. Miller

* MANIFEST, doc/CONTRIBUTORS, src/po/nb.mo, src/po/nb.po:

  Norwegian Bokmaal translation for sudo from translationproject.com
  [[4eb0122e9]](https://git.sudo.ws/sudo/commit/?id=4eb0122e9)

2014-05-13 Todd C. Miller

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in,
  plugins/sudoers/visudo.c:

  Try to be clearer about which are the input and output files in export
  mode.
  [[b0e6977c3]](https://git.sudo.ws/sudo/commit/?id=b0e6977c3)

* plugins/sudoers/visudo\_json.c:

  In -x mode, require that the input and output files be different. This
  won’t currently catch collisions between the output file and an include
  file.
  [[372e30851]](https://git.sudo.ws/sudo/commit/?id=372e30851)

* plugins/sudoers/bsm\_audit.h, plugins/sudoers/linux\_audit.h:

  BSM and Linux audit do not yet use the argc function argument.
  [[eb5a36732]](https://git.sudo.ws/sudo/commit/?id=eb5a36732)

* plugins/sudoers/audit.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/bsm\_audit.h, plugins/sudoers/linux\_audit.h,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/sudoers.c:

  Pass argc to audit functions too. Will be needed for Solaris audit
  support.
  [[337a71274]](https://git.sudo.ws/sudo/commit/?id=337a71274)

2014-05-12 Todd C. Miller

* common/fatal.c, include/fatal.h, plugins/sudoers/policy.c:

  Do not allow the same callback function to be registered more that once
  in fatal\_callback\_register(). Add fatal\_callback\_deregister() to
  deregister a callback.
  [[ffb07443c]](https://git.sudo.ws/sudo/commit/?id=ffb07443c)

* MANIFEST, plugins/sudoers/regress/sudoers/test15.in,
  plugins/sudoers/regress/sudoers/test15.out.ok,
  plugins/sudoers/regress/sudoers/test15.toke.ok,
  plugins/sudoers/regress/sudoers/test16.in,
  plugins/sudoers/regress/sudoers/test16.out.ok,
  plugins/sudoers/regress/sudoers/test16.toke.ok:

  Add trivial sudoedit parsing tests.
  [[2e3fbaa2c]](https://git.sudo.ws/sudo/commit/?id=2e3fbaa2c)

* MANIFEST, plugins/sudoers/po/ca.mo, plugins/sudoers/po/ca.po:

  Catalan translation for sudoers from translationproject.org.
  [[3c5353c2b]](https://git.sudo.ws/sudo/commit/?id=3c5353c2b)

2014-05-10 Todd C. Miller

* plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, src/po/ca.mo,
  src/po/ca.po, src/po/gl.mo, src/po/gl.po:

  Sync with translationproject.org
  [[70f624976]](https://git.sudo.ws/sudo/commit/?id=70f624976)

2014-05-09 Todd C. Miller

* configure, configure.ac:

  lockf() is broken on the Hurd – use flock instead [Bug
  #647](https://bugzilla.sudo.ws/show_bug.cgi?id=647)
  [[e2efec5b3]](https://git.sudo.ws/sudo/commit/?id=e2efec5b3)

* plugins/sudoers/visudo.c:

  Don’t try to install the temporary sudoers file if we didn’t edit it. By
  default, visudo does not edit files in a #includedir. Fixes a NULL
  pointer defef on GNU hurd; [Bug
  #647](https://bugzilla.sudo.ws/show_bug.cgi?id=647)
  [[45ff42eb9]](https://git.sudo.ws/sudo/commit/?id=45ff42eb9)

2014-05-07 Todd C. Miller

* src/regress/ttyname/check\_ttyname.c:

  When comparing tty names, resolve the tty for fds 0-3 and compare each
  one instead of just using the first that resolves.
  [[9cdf7797c]](https://git.sudo.ws/sudo/commit/?id=9cdf7797c)

* compat/getgrouplist.c, configure, configure.ac:

  Solaris 8 doesn’t export \_nss\_initf\_group() so we need to provide out
  own for getgrouplist().
  [[4902f4e3e]](https://git.sudo.ws/sudo/commit/?id=4902f4e3e)

2014-05-06 Todd C. Miller

* compat/getgrouplist.c, plugins/group\_file/group\_file.c,
  plugins/system\_group/system\_group.c:

  deal with NULL gr\_mem here too
  [[17cbfea8b]](https://git.sudo.ws/sudo/commit/?id=17cbfea8b)

* NEWS, configure, configure.ac:

  Sudo 1.8.10p3
  [[e54fe5a26]](https://git.sudo.ws/sudo/commit/?id=e54fe5a26)

2014-05-02 Todd C. Miller

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/check.c,
  plugins/sudoers/env.c, plugins/sudoers/iolog.c,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/parse.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/timestamp.c:

  Rename log\_warning flags and only send mail if SLOG\_SEND\_MAIL is set
  instead of mailing by default like we used to.
  [[b0f1fa7d0]](https://git.sudo.ws/sudo/commit/?id=b0f1fa7d0)

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/check.c,
  plugins/sudoers/env.c, plugins/sudoers/iolog.c,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/parse.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/timestamp.c:

  Add log\_warningx
  [[954a3e77b]](https://git.sudo.ws/sudo/commit/?id=954a3e77b)

* src/exec\_pty.c:

  Add debugging info for when we delete I/O events that still have
  buffered data in them.
  [[7f0b9eca0]](https://git.sudo.ws/sudo/commit/?id=7f0b9eca0)

* common/event.c:

  Fix non-blocking mode. We only want to exit the event loop when poll()
  or select() returns 0 and there are no active events. This fixes a
  problem on some systems where the last buffer was not being written when
  the command exited.
  [[4e333c516]](https://git.sudo.ws/sudo/commit/?id=4e333c516)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Change return value of switch\_dir() to an int so we can distinguish
  between an error and an empty dir in push\_includedir().
  [[a53946b02]](https://git.sudo.ws/sudo/commit/?id=a53946b02)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Move code to fill in the list of dirs out of switch\_dir and into its own
  function. Quiets a false positive from cppcheck which got confused due
  to variable reuse.
  [[480a94d07]](https://git.sudo.ws/sudo/commit/?id=480a94d07)

* plugins/sudoers/audit.c:

  Avoid unused variable warning if auditing is not supported.
  [[983ab1d16]](https://git.sudo.ws/sudo/commit/?id=983ab1d16)

2014-05-01 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Fix library order when linking binaries.
  [[a297a19fb]](https://git.sudo.ws/sudo/commit/?id=a297a19fb)

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y:

  Include limits.h and inttypes.h for SIZE\_MAX define.
  [[ffbe7d1da]](https://git.sudo.ws/sudo/commit/?id=ffbe7d1da)

* include/missing.h, plugins/sudoers/env.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y:

  Move SIZE\_MAX compat define into missing.h where it belongs.
  [[0a9a8d956]](https://git.sudo.ws/sudo/commit/?id=0a9a8d956)

2014-04-30 Todd C. Miller

* plugins/sudoers/iolog.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c:

  Remove now-unused log\_fatal()
  [[cbee9cc8c]](https://git.sudo.ws/sudo/commit/?id=cbee9cc8c)

* plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/env.c, plugins/sudoers/ldap.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Eliminate calls to fatal()/fatalx()/log\_fatal() in env.c and just pass
  back a return value.
  [[5086194c6]](https://git.sudo.ws/sudo/commit/?id=5086194c6)

2014-04-28 Todd C. Miller

* plugins/sudoers/boottime.c, plugins/sudoers/sudoers.h:

  Make get\_boottime() return bool.
  [[e45b388a3]](https://git.sudo.ws/sudo/commit/?id=e45b388a3)

* doc/CONTRIBUTORS, plugins/sudoers/boottime.c:

  Fix fd leak on Linux when determing boot time. This is usually masked by
  the closefrom() call in sudo. From Jamie Anderson. [Bug
  #645](https://bugzilla.sudo.ws/show_bug.cgi?id=645)
  [[e61af9e6d]](https://git.sudo.ws/sudo/commit/?id=e61af9e6d)

2014-04-24 Todd C. Miller

* plugins/sudoers/audit.c:

  Handle the (currently impossible) case where both BSM and Linux auditing
  are supported. Pacifies cppcheck.
  [[d3b432671]](https://git.sudo.ws/sudo/commit/?id=d3b432671)

* plugins/sudoers/iolog.c:

  Don’t call ferror() on a closed stream, just check the return value of
  fclose() instead. Found by cppcheck.
  [[bd86ced96]](https://git.sudo.ws/sudo/commit/?id=bd86ced96)

2014-04-22 Todd C. Miller

* doc/CONTRIBUTORS, plugins/sudoers/auth/pam.c:

  Use calloc() instead of malloc(n \* s) followed by memset(). From
  Jean-Philippe Ouellet.
  [[e8bb08cc4]](https://git.sudo.ws/sudo/commit/?id=e8bb08cc4)

* plugins/sudoers/sudoers.c:

  Format string safety in error path.
  [[62a278183]](https://git.sudo.ws/sudo/commit/?id=62a278183)

* common/alloc.c, common/event\_poll.c, common/gidlist.c,
  common/sudo\_conf.c, include/alloc.h, plugins/sudoers/auth/sia.c,
  plugins/sudoers/env.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/ldap.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/visudo.c, src/env\_hooks.c,
  src/exec\_common.c, src/parse\_args.c, src/selinux.c, src/sudo.c,
  src/sudo\_edit.c, src/ttyname.c:

  Rename emalloc2() -> emallocarray() and erealloc3() ->
  ereallocarray().
  [[134b2a422]](https://git.sudo.ws/sudo/commit/?id=134b2a422)

* compat/Makefile.in, mkdep.pl, plugins/sudoers/Makefile.in:

  Add missing rule for building sha2.lo when not supported by libc or
  libmd.
  [[28b564daa]](https://git.sudo.ws/sudo/commit/?id=28b564daa)

2014-04-15 Todd C. Miller

* plugins/sudoers/sudoers.in:

  Disable I/O logging for halt and poweroff in addition to reboot in
  commented out example.
  [[b4262391e]](https://git.sudo.ws/sudo/commit/?id=b4262391e)

* doc/CONTRIBUTORS, plugins/sudoers/auth/pam.c:

  Use PAM\_REINITIALIZE\_CRED instead of PAM\_ESTABLISH\_CRED when changing
  the user. This is the correct flag to use with a program that changes
  the uid like su or sudo and fixes a role problem on Solaris. From Gary
  Winiger; [Bug #642](https://bugzilla.sudo.ws/show_bug.cgi?id=642)
  [[7d91691e1]](https://git.sudo.ws/sudo/commit/?id=7d91691e1)

* plugins/sudoers/defaults.c:

  pam\_setcred should default to true; from Gary Winiger [Bug
  #642](https://bugzilla.sudo.ws/show_bug.cgi?id=642)
  [[278a8ba39]](https://git.sudo.ws/sudo/commit/?id=278a8ba39)

2014-04-10 Todd C. Miller

* plugins/sudoers/ldap.c, plugins/sudoers/logging.c,
  plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestamp.c:

  Make set\_perms() and restore\_perms() return an error instead of calling
  exit() on failure.
  [[a78da3748]](https://git.sudo.ws/sudo/commit/?id=a78da3748)

* plugins/sudoers/sudoers.c:

  Eliminate calls to fatal() in sudoers.c and just pass back a return
  value.
  [[40375a626]](https://git.sudo.ws/sudo/commit/?id=40375a626)

* plugins/sudoers/logging.c:

  Elimate calls to fatal() in the logging code.
  [[a48c00dc3]](https://git.sudo.ws/sudo/commit/?id=a48c00dc3)

2014-04-09 Todd C. Miller

* common/regress/atofoo/atofoo\_test.c:

  Quiet a compiler warning on Solaris.
  [[db831ace3]](https://git.sudo.ws/sudo/commit/?id=db831ace3)

* MANIFEST, common/Makefile.in, compat/Makefile.in, compat/sha2.c,
  compat/sha2.h, config.h.in, configure, configure.ac, m4/sudo.m4,
  plugins/sudoers/Makefile.in, plugins/sudoers/gram.c,
  plugins/sudoers/gram.h, plugins/sudoers/gram.y, plugins/sudoers/match.c,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/sudoers/test14.toke.ok, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Move the sha2 code into libreplace and add configure checks for
  SHA224Update in libc and libmd. Solaris uses “void \*” where we use
  “unsigned char \*” so we need a check for that too. Solaris sha2.h
  defines SHA224, SHA256, SHA384, and SHA512 so rename those tokens.
  Adapted from changes from Vladimir Marek in bug #641.
  [[218aa1e59]](https://git.sudo.ws/sudo/commit/?id=218aa1e59)

* MANIFEST, plugins/sudoers/match.c,
  plugins/sudoers/regress/testsudoers/test6.out.ok,
  plugins/sudoers/regress/testsudoers/test6.sh,
  plugins/sudoers/regress/testsudoers/test7.out.ok,
  plugins/sudoers/regress/testsudoers/test7.sh:

  Fix matching of uids and gids broken in sudo 1.8.9.
  [[27aff732f]](https://git.sudo.ws/sudo/commit/?id=27aff732f)

* plugins/sudoers/testsudoers.c:

  Fix -P option in usage()
  [[ecae6b4f9]](https://git.sudo.ws/sudo/commit/?id=ecae6b4f9)

2014-04-07 Todd C. Miller

* plugins/sudoers/check.c, plugins/sudoers/prompt.c,
  plugins/sudoers/set\_perms.c:

  Remove a few more unnecessary uses of fatal().
  [[b1cdb3708]](https://git.sudo.ws/sudo/commit/?id=b1cdb3708)

* plugins/sudoers/auth/sudo\_auth.c:

  Use log\_warning() not log\_fatal() for the “Invalid authentication
  methods compiled into sudo” message. We return -1 on error anyway.
  [[d702ee981]](https://git.sudo.ws/sudo/commit/?id=d702ee981)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Return MODE\_ERROR from sudoers\_policy\_deserialize\_info() instead of
  calling fatalx().
  [[2a290f812]](https://git.sudo.ws/sudo/commit/?id=2a290f812)

* common/gidlist.c, src/sudo.c:

  parse\_gid\_list() now returns -1 on error instead of calling fatalx().
  [[ac3ffde5e]](https://git.sudo.ws/sudo/commit/?id=ac3ffde5e)

2014-04-04 Todd C. Miller

* src/exec.c:

  Forward SIGINFO to running command if supported. If the command is being
  run in the background (or exec\_background is set in sudoers), it is the
  sudo process, not the actual command, that receives the ^T.
  [[36b991348]](https://git.sudo.ws/sudo/commit/?id=36b991348)

* plugins/sudoers/defaults.h, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c:

  Remove calls to log\_fatal() in I/O log functions and just pass an error
  back to the caller.
  [[9b7dfa752]](https://git.sudo.ws/sudo/commit/?id=9b7dfa752)

2014-04-01 Todd C. Miller

* common/alloc.c, plugins/sudoers/env.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/policy.c, plugins/sudoers/prompt.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c:

  Make “internal error, %s overflow” arguments consistent, using **func**
  where possible (when debugging is allowed).
  [[6a295400b]](https://git.sudo.ws/sudo/commit/?id=6a295400b)

2014-03-31 Todd C. Miller

* plugins/sudoers/toke\_util.c, src/net\_ifs.c:

  Use common printf format when warning of buffer overflow prevention.
  [[a1240a541]](https://git.sudo.ws/sudo/commit/?id=a1240a541)

* Makefile.in:

  Remove init.d/\*.sh in distclean
  [[e0415632e]](https://git.sudo.ws/sudo/commit/?id=e0415632e)

* .hgignore:

  Correctly ignore init.d/\*.sh
  [[275b2edbd]](https://git.sudo.ws/sudo/commit/?id=275b2edbd)

* plugins/sudoers/ldap.c:

  Remove remaining calls to fatalx(); just pass the error to the caller.
  [[7d994b503]](https://git.sudo.ws/sudo/commit/?id=7d994b503)

2014-03-26 Todd C. Miller

* plugins/sudoers/pwutil.c, plugins/sudoers/sudoers.h:

  Make a password/group cache collision a warning rather than fatal. This
  should not be possible in practice and we can safely return the new
  (potentially duplicate) item as it will be freed by the caller. Make
  sudo\_set\_grlist() return an error on failure instead of calling
  fatalx().
  [[2d1484fe8]](https://git.sudo.ws/sudo/commit/?id=2d1484fe8)

* plugins/sudoers/timestamp.c:

  Use log\_warning() instead of log\_fatal() if the ticket or lecture path
  is too long and just return an error. This can only happen from a
  misconfiguration so just ignoring the ticket/lecture file is safe.
  [[db5481599]](https://git.sudo.ws/sudo/commit/?id=db5481599)

* plugins/sudoers/find\_path.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  In find\_path(), return NOT\_FOUND\_ERROR instead of calling fatal() if the
  path is too long. Remove an extraneous check against PATH\_MAX in
  set\_cmnd() since find\_path() already contains such a check.
  [[639ac92e6]](https://git.sudo.ws/sudo/commit/?id=639ac92e6)

* plugins/sudoers/sudoers.h:

  Remove unused MODE\_LISTDEFS define and correct a comment.
  [[4848b5691]](https://git.sudo.ws/sudo/commit/?id=4848b5691)

* plugins/sudoers/hexchar.c, plugins/sudoers/match.c,
  plugins/sudoers/toke\_util.c:

  Make hexchar() return -1 on invalid input instead of calling fatalx().
  Callers used to check that the string was hex before calling hexchar().
  Now callers must check for a -1 return value instead.
  [[9ff3b1b57]](https://git.sudo.ws/sudo/commit/?id=9ff3b1b57)

* plugins/sudoers/audit.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/bsm\_audit.h, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/logging.h, plugins/sudoers/sudoers.c:

  Propagate errors in audit code to caller instead of using fatal(). If we
  fail to audit an otherwise successful command, return an error from the
  policy. For Linux audit, sudo may be compiled with audit support but
  auditing may not be setup, so we don’t consider that an error.
  [[2220f55ae]](https://git.sudo.ws/sudo/commit/?id=2220f55ae)

* plugins/sudoers/boottime.c:

  Remove unused variable on Linux.
  [[7d7f9cb55]](https://git.sudo.ws/sudo/commit/?id=7d7f9cb55)

* plugins/sudoers/timestamp.c:

  Fix warning on systems where mode\_t is not unsigned int (Solaris).
  [[2dfc10830]](https://git.sudo.ws/sudo/commit/?id=2dfc10830)

2014-03-25 Todd C. Miller

* plugins/sudoers/env.c, plugins/sudoers/sudoers.c:

  Audit path too long errror. Add comments about non-audit events and
  placeholders for future audit hooks.
  [[1017ad4e2]](https://git.sudo.ws/sudo/commit/?id=1017ad4e2)

2014-02-27 Todd C. Miller

* plugins/sudoers/auth/API, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h:

  Remove unused FLAG\_USER auth flag. We have no auth methods that require
  that authentication be run as the invoking user.
  [[4e3e5077e]](https://git.sudo.ws/sudo/commit/?id=4e3e5077e)

2014-03-25 Todd C. Miller

* src/net\_ifs.c:

  Fix aliasing warning in old-style interface probe code.
  [[6a7ebd280]](https://git.sudo.ws/sudo/commit/?id=6a7ebd280)

* plugins/sudoers/set\_perms.c:

  Fix some sign comparision warnings.
  [[a5aeaf20d]](https://git.sudo.ws/sudo/commit/?id=a5aeaf20d)

* common/aix.c, common/gidlist.c, compat/getgrouplist.c,
  include/sudo\_util.h, src/sudo.c:

  Don’t call fatal/fatalx in common/\*.c
  [[250e8e750]](https://git.sudo.ws/sudo/commit/?id=250e8e750)

2014-03-19 Todd C. Miller

* plugins/sudoers/check.c, plugins/sudoers/prompt.c,
  plugins/sudoers/sudoers.h:

  Fix expansion of %p in the prompt for “sudo -l” when rootpw, runaspw or
  targetpw is set. [Bug
  #639](https://bugzilla.sudo.ws/show_bug.cgi?id=639)
  [[3cdb944de]](https://git.sudo.ws/sudo/commit/?id=3cdb944de)

2014-03-17 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.8.10p2
  [[122257e09]](https://git.sudo.ws/sudo/commit/?id=122257e09)

* plugins/sudoers/timestamp.c:

  Don’t write an empty timestamp record when timestamp\_timeout is zero. If
  we find an empty record in the timestamp file, overwrite it with a good
  one, truncating the file as needed.
  [[4d712aa90]](https://git.sudo.ws/sudo/commit/?id=4d712aa90)

2014-03-15 Todd C. Miller

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Fix typos in description of the -x option. [Bug
  #637](https://bugzilla.sudo.ws/show_bug.cgi?id=637)
  [[60cf68ad1]](https://git.sudo.ws/sudo/commit/?id=60cf68ad1)

2014-03-13 Todd C. Miller

* NEWS, configure, configure.ac:

  Sudo 1.8.10p1
  [[01cf646a7]](https://git.sudo.ws/sudo/commit/?id=01cf646a7)

* plugins/sudoers/timestamp.c:

  Fix typo/thinko that prevented “Defaults !tty\_tickets” from working.
  [[403a48da4]](https://git.sudo.ws/sudo/commit/?id=403a48da4)

* plugins/sudoers/parse.c:

  Fix “sudo -l command” output when the matching command is negated. [Bug
  #636](https://bugzilla.sudo.ws/show_bug.cgi?id=636)
  [[35c41deb4]](https://git.sudo.ws/sudo/commit/?id=35c41deb4)

2014-03-11 Todd C. Miller

* MANIFEST, common/Makefile.in, common/regress/atofoo/atofoo\_test.c,
  common/regress/sudo\_conf/test5.err.ok, common/regress/tailq/hltq\_test.c:
  The atofoo\_test and hltq\_test tests now display their own test error
  rate. Display pass/fail count separately for sudo\_conf and sudo\_parseln
  tests. Check stderr output for the sudo\_conf test.
  [[967fda0fb]](https://git.sudo.ws/sudo/commit/?id=967fda0fb)

* src/Makefile.in:

  Don’t run the check\_ttyname test if cross compiling.
  [[f12a546a5]](https://git.sudo.ws/sudo/commit/?id=f12a546a5)

* plugins/sudoers/Makefile.in:

  CWD no longer used.
  [[5c6d2ad68]](https://git.sudo.ws/sudo/commit/?id=5c6d2ad68)

* plugins/sudoers/Makefile.in:

  Fix diff of toke and err output files in “make check”
  [[ee135ea26]](https://git.sudo.ws/sudo/commit/?id=ee135ea26)

2014-03-07 Todd C. Miller

* src/po/de.mo, src/po/de.po:

  sync with translationproject.org
  [[7dec05d7d]](https://git.sudo.ws/sudo/commit/?id=7dec05d7d)

2014-03-06 Todd C. Miller

* configure, configure.ac:

  Check whether ber.h is needed before ldap.h even if we are not using any
  ber functions. Needed for older versions of nss ldap.
  [[0cf7f404a]](https://git.sudo.ws/sudo/commit/?id=0cf7f404a)

* plugins/sudoers/sssd.c:

  Fix compiler warning in debug code.
  [[8461dc6e2]](https://git.sudo.ws/sudo/commit/?id=8461dc6e2)

* MANIFEST, NEWS, doc/CONTRIBUTORS, src/po/ca.mo, src/po/ca.po:

  Catalan translation for sudo from translationproject.org.
  [[ed87af2ae]](https://git.sudo.ws/sudo/commit/?id=ed87af2ae)

2014-03-05 Todd C. Miller

* NEWS:

  Document negation fix in JSON output.
  [[23e7f606a]](https://git.sudo.ws/sudo/commit/?id=23e7f606a)

2014-03-04 Todd C. Miller

* plugins/sudoers/visudo\_json.c:

  Fix handling of ‘!’ operator when converting sudoers. We now add a
  “negated” boolean flag to objects that have the ‘!’ operator.
  [[0030bfe7d]](https://git.sudo.ws/sudo/commit/?id=0030bfe7d)

2014-03-01 Todd C. Miller

* MANIFEST, NEWS, plugins/sudoers/po/cs.mo, plugins/sudoers/po/cs.po:

  Czech translation for sudoers from translationproject.org
  [[c934882c3]](https://git.sudo.ws/sudo/commit/?id=c934882c3)

2014-02-28 Todd C. Miller

* configure, configure.ac:

  Try -libmldap before -lldap in case there is no link from libibmldap.so
  to libldap.so. Since IBM ldap is installed under /opt we should only be
  able to reach it if –with-ldap was given an explicit path.

  Only check for ber\_set\_option() if LBER\_OPT\_DEBUG\_LEVEL is defined.
  [[9c17914bf]](https://git.sudo.ws/sudo/commit/?id=9c17914bf)

2014-02-27 Todd C. Miller

* plugins/sudoers/set\_perms.c:

  Fix typo in setreuid() PERM\_ROOT error message.
  [[d75e5f6fe]](https://git.sudo.ws/sudo/commit/?id=d75e5f6fe)

* mkpkg:

  No longer need to disable setresuid() on debian.
  [[d8f94bdfd]](https://git.sudo.ws/sudo/commit/?id=d8f94bdfd)

2014-02-26 Todd C. Miller

* plugins/sudoers/timestamp.c:

  Fix conversion of timestamp\_timeout from double to struct timeval. Also
  quiet a printf format warning on 32-bit systems.
  [[f2f96d849]](https://git.sudo.ws/sudo/commit/?id=f2f96d849)

2014-02-25 Todd C. Miller

* MANIFEST, NEWS, plugins/sudoers/po/sr.mo, plugins/sudoers/po/sr.po:

  Serbian translation for sudoers from translationproject.org.
  [[b41f5c2d3]](https://git.sudo.ws/sudo/commit/?id=b41f5c2d3)

2014-02-24 Todd C. Miller

* doc/CONTRIBUTORS:

  Add Ingo Schwarze
  [[addef6224]](https://git.sudo.ws/sudo/commit/?id=addef6224)

* NEWS, plugins/sudoers/visudo\_json.c:

  When exporting sudoers in JSON format, use the same type of Options
  object for both Defaults and Cmnd\_Specs.
  [[58341a8bf]](https://git.sudo.ws/sudo/commit/?id=58341a8bf)

2014-02-17 Todd C. Miller

* compat/inet\_pton.c:

  Silence cppcheck false positive.
  [[c38207138]](https://git.sudo.ws/sudo/commit/?id=c38207138)

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po:

  sync with translationproject.org
  [[0cdf4407d]](https://git.sudo.ws/sudo/commit/?id=0cdf4407d)

* NEWS, doc/UPGRADE:

  Mention init.d scripts on AIX and HP-UX Mention sudoers group mismatch
  fix
  [[6bffa9a4a]](https://git.sudo.ws/sudo/commit/?id=6bffa9a4a)

* INSTALL:

  Talk about clearing files at boot time, not reboot time since it happens
  when the system comes up, not down.
  [[53d9429b8]](https://git.sudo.ws/sudo/commit/?id=53d9429b8)

* plugins/sudoers/sudoers.c:

  We also need to open the sudoers file as root if there is a GID
  mismatch.
  [[c6e310b94]](https://git.sudo.ws/sudo/commit/?id=c6e310b94)

* sudo.pp:

  Install /etc/rc.d/init.d/sudo and /etc/rc.d/rc2.d/S90sudo for AIX rpm
  packages.
  [[2b4bc87c0]](https://git.sudo.ws/sudo/commit/?id=2b4bc87c0)

2014-02-16 Todd C. Miller

* src/Makefile.in:

  Remove init.d file and link in uninstall target.
  [[0e9b4d30c]](https://git.sudo.ws/sudo/commit/?id=0e9b4d30c)

* configure, configure.ac, sudo.pp:

  Fix INIT\_DIR for real this time.
  [[cb3cea3fa]](https://git.sudo.ws/sudo/commit/?id=cb3cea3fa)

* configure, configure.ac, sudo.pp:

  Use correct init.d dir on HP-UX. Fix pp warnings from rc.d and init.d
  dirs.
  [[0bf299c69]](https://git.sudo.ws/sudo/commit/?id=0bf299c69)

* .hgignore, MANIFEST, configure, configure.ac, init.d/aix.sh.in,
  init.d/hpux.sh.in, src/Makefile.in, sudo.pp:

  First cut add installing an init.d file for HP-UX and AIX to remove old
  sudo timestamp files at boot time.
  [[96d87d55d]](https://git.sudo.ws/sudo/commit/?id=96d87d55d)

2014-02-15 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Use .Ar macro instead of “file …” Use “.Cm -” instead of “.Li -” for
  the default login class. From Ingo Schwarze.
  [[a61935c2b]](https://git.sudo.ws/sudo/commit/?id=a61935c2b)

* doc/sudo.conf.mdoc.in, doc/sudo.mdoc.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.ldap.mdoc.in, doc/sudoers.mdoc.in, doc/sudoreplay.mdoc.in,
  doc/visudo.mdoc.in:

  Remove some extraneous markup; from Ingo Schwarze \* No need to
  explicitly end a macro with No before | because | counts as middle
  punctuation and falls out of the macro, anyway. \* No need to explicitly
  re-open in-line macros after | because | counts as middle punctuation
  and the macros resume afterwards, anyway. \* Simplify the mnemonic
  remarks regarding the option letters, no need for manual font and
  spacing control with No and Ns. \* Trim Ns No to just Ns, it already
  implies No.
  [[f909c0d13]](https://git.sudo.ws/sudo/commit/?id=f909c0d13)

* doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Move zerowidth space in :alpha: after the colon for consistency.
  [[d6397e27c]](https://git.sudo.ws/sudo/commit/?id=d6397e27c)

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.man.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudoers.cat,
  doc/sudoers.ldap.man.in, doc/sudoers.man.in, doc/sudoreplay.cat,
  doc/sudoreplay.man.in, doc/visudo.cat, doc/visudo.man.in:

  regen
  [[0ec92dae8]](https://git.sudo.ws/sudo/commit/?id=0ec92dae8)

* doc/sudo.mdoc.in, doc/sudoreplay.mdoc.in, doc/visudo.mdoc.in:

  Remove extraneous keeps in SYNOPSIS now that mandoc does implied keeps
  when converting from mdoc to man.
  [[a9cfe4fc4]](https://git.sudo.ws/sudo/commit/?id=a9cfe4fc4)

* doc/sudoers.mdoc.in:

  Properly escape the : in :alpha:
  [[94d448223]](https://git.sudo.ws/sudo/commit/?id=94d448223)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Replace some uses of .Sy with .Ar, .Ev and .Pa as appropriate. From Jan
  Stary.
  [[28c49748a]](https://git.sudo.ws/sudo/commit/?id=28c49748a)

2014-02-12 Todd C. Miller

* plugins/sudoers/visudo\_json.c:

  Fix indentation of Defaults entries. The initial indent should be
  outside the loop iterating over the entries.
  [[0a6ec9615]](https://git.sudo.ws/sudo/commit/?id=0a6ec9615)

2014-02-11 Todd C. Miller

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po:

  sync with translationproject.org
  [[198e73b5c]](https://git.sudo.ws/sudo/commit/?id=198e73b5c)

* common/aix.c, common/alloc.c, common/atoid.c, common/atomode.c,
  common/fatal.c, common/gidlist.c, common/sudo\_conf.c,
  common/sudo\_debug.c, compat/strsignal.c, compat/strtonum.c,
  plugins/sudoers/audit.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/locale.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/visudo.c, plugins/sudoers/visudo\_json.c,
  src/locale\_stub.c, src/net\_ifs.c, src/sesh.c, src/sudo.h:

  We must include gettext.h before missing.h as it includes system
  headers. Also add missing DEFAULT\_TEXT\_DOMAIN defines in sudoers audit
  code that does not include sudoers.h.
  [[12a1b672c]](https://git.sudo.ws/sudo/commit/?id=12a1b672c)

* common/sudo\_dso.c:

  When emulating DSO\_NEXT with shl\_get() we need to skip the program’s
  handle. This used to be documented as being index -2 but now it seems to
  be index 0. As this is not guaranteed we need to look up the real handle
  value for PROG\_HANDLE and skip it when interating through all the DSOs.
  Fixes infinite recursion on HP-UX in the getenv() replacement.
  [[02d86aafe]](https://git.sudo.ws/sudo/commit/?id=02d86aafe)

* src/env\_hooks.c:

  Export getenv() so it is visible to shared objects we link with.
  [[151f001d8]](https://git.sudo.ws/sudo/commit/?id=151f001d8)

2014-02-08 Todd C. Miller

* common/regress/atofoo/atofoo\_test.c,
  common/regress/sudo\_conf/conf\_test.c,
  common/regress/sudo\_parseln/parseln\_test.c,
  common/regress/tailq/hltq\_test.c,
  plugins/sudoers/regress/parser/check\_fill.c:

  Add some initprogname() calls to the test programs.
  [[d748ebe48]](https://git.sudo.ws/sudo/commit/?id=d748ebe48)

2014-02-07 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  regen
  [[8b94d558d]](https://git.sudo.ws/sudo/commit/?id=8b94d558d)

* doc/UPGRADE:

  Mention that there is now a default LDAP search filter.
  [[414edf65e]](https://git.sudo.ws/sudo/commit/?id=414edf65e)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  Minor word choice change.
  [[a54e52d58]](https://git.sudo.ws/sudo/commit/?id=a54e52d58)

* NEWS, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/ldap.c, plugins/sudoers/match.c:

  Add use\_netgroups sudoers option. For LDAP-based sudoers, netgroup
  support requires an expensive substring match on the server. If
  netgroups are not needed, this option can be disabled to reduce the load
  on the LDAP server.
  [[8287e21d3]](https://git.sudo.ws/sudo/commit/?id=8287e21d3)

2014-02-06 Todd C. Miller

* plugins/sudoers/ldap.c:

  Update copyright year.
  [[7a1cd11c0]](https://git.sudo.ws/sudo/commit/?id=7a1cd11c0)

* NEWS:

  Mention LDAP changes.
  [[4727c52e1]](https://git.sudo.ws/sudo/commit/?id=4727c52e1)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  plugins/sudoers/ldap.c:

  Use a default LDAP search filter of (objectClass=sudoRole). When
  constructing the netgroup query, add (sudoUser=\*) to the query so we
  don’t fall below the 3 character OpenLDAP substring threshold. Otherwise
  the index for sudoUser will never be used for that query. Pointed out by
  Michael Stroeder.
  [[f7a419b5f]](https://git.sudo.ws/sudo/commit/?id=f7a419b5f)

* plugins/sudoers/timestamp.c:

  Don’t warn about an insecure lecture dir twice. Display warnings in the
  user’s locale.
  [[b299763e3]](https://git.sudo.ws/sudo/commit/?id=b299763e3)

2014-02-05 Todd C. Miller

* NEWS:

  Mention the fix for ^Z at the password prompt when sudo was started in
  the background.
  [[4e733589e]](https://git.sudo.ws/sudo/commit/?id=4e733589e)

* common/term.c, src/exec\_pty.c:

  In term\_restore(), only restores the terminal if we are in the foregroup
  process group. Instead of calling tcgetpgrp(), which is racy, we set a
  temporary handler for SIGTTOU and check whether it was received after a
  failed call to tcsetattr().
  [[135c85e15]](https://git.sudo.ws/sudo/commit/?id=135c85e15)

* MANIFEST, compat/getaddrinfo.c, compat/inet\_pton.c, config.h.in,
  configure, configure.ac, doc/LICENSE, include/missing.h, mkdep.pl,
  plugins/sudoers/interfaces.c, plugins/sudoers/match\_addr.c:

  Use inet\_pton() instead of inet\_aton() and include a version from BIND
  for those without it.
  [[85598f77b]](https://git.sudo.ws/sudo/commit/?id=85598f77b)

* common/regress/atofoo/atofoo\_test.c:

  Quiet a gcc warning.
  [[91141e5cc]](https://git.sudo.ws/sudo/commit/?id=91141e5cc)

* compat/getaddrinfo.c:

  Need to include limits.h for USHRT\_MAX.
  [[fbfe7caba]](https://git.sudo.ws/sudo/commit/?id=fbfe7caba)

2014-02-04 Todd C. Miller

* common/term.c, include/sudo\_util.h:

  Use bool for function return values instead of 1 or 0.
  [[08af9d051]](https://git.sudo.ws/sudo/commit/?id=08af9d051)

* configure, configure.ac:

  Warn the user if the rundir needs to be cleared in the rc files. Neither
  AIX not HP-UX clear /var/run (if it even exists).
  [[249becb1a]](https://git.sudo.ws/sudo/commit/?id=249becb1a)

* NEWS:

  Update for sudo 1.8.9p5
  [[b1851f693]](https://git.sudo.ws/sudo/commit/?id=b1851f693)

* src/preserve\_fds.c:

  When the closefrom limit is greater than any of the preserved fds, the
  pfds list will be non-empty but lastfd will be -1 triggering an
  ecalloc(0) assertion. Instead, test for lastfd being -1 and make sure we
  always update it, even if dup() fails. Also restore initial value of
  lowfd after we are done relocating. Fixes bug #633
  [[31858894c]](https://git.sudo.ws/sudo/commit/?id=31858894c)

* common/term.c:

  Document function return values.
  [[c8984598e]](https://git.sudo.ws/sudo/commit/?id=c8984598e)

2014-02-03 Todd C. Miller

* src/exec\_pty.c:

  term\_restore() now restarts itself so we don’t need to do it ourselves.
  [[b1de1bce3]](https://git.sudo.ws/sudo/commit/?id=b1de1bce3)

* common/term.c:

  syscall restarting is broken on Mac OS X when interrupted by a tty
  signal so restart tcsetattr() by hand. For details, see.
  [http://openradar.appspot.com/radar?id=6402578615107584](https://openradar.appspot.com/radar?id=6402578615107584)
  [[a61abeb36]](https://git.sudo.ws/sudo/commit/?id=a61abeb36)

* MANIFEST, common/Makefile.in, common/regress/atofoo/atofoo\_test.c:

  Add regress for atobool(), atoid() and atomode()
  [[26f2dd3b9]](https://git.sudo.ws/sudo/commit/?id=26f2dd3b9)

* plugins/sudoers/Makefile.in:

  Add back boottime.lo
  [[efd31a31e]](https://git.sudo.ws/sudo/commit/?id=efd31a31e)

* INSTALL:

  Mention that rundir and vardir may be the same and what to do if they
  are.
  [[7292e607f]](https://git.sudo.ws/sudo/commit/?id=7292e607f)

* MANIFEST, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/boottime.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/timestamp.c:

  Bring back boot time checking code and zero out time stamp files that
  predate the boot time. This should help systems w/o /var/run where the
  admin has setup rc.d to clear the timestamp directory.
  [[7155fc526]](https://git.sudo.ws/sudo/commit/?id=7155fc526)

* configure, configure.ac:

  Check libraries for inet\_pton() if not in libc.
  [[b590182ab]](https://git.sudo.ws/sudo/commit/?id=b590182ab)

2014-02-02 Todd C. Miller

* configure, configure.ac:

  Fix clock\_gettime() detection when it lives in librt. Some systems have
  inet\_aton() in libresolv (older Solaris).
  [[719e58740]](https://git.sudo.ws/sudo/commit/?id=719e58740)

* sudo.pp:

  Avoid duplicate directories if vardir and rundir are the same.
  [[4831eeaac]](https://git.sudo.ws/sudo/commit/?id=4831eeaac)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[a9a7768d5]](https://git.sudo.ws/sudo/commit/?id=a9a7768d5)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Elaborate on time stamp error message causes.
  [[5502051eb]](https://git.sudo.ws/sudo/commit/?id=5502051eb)

2014-02-01 Todd C. Miller

* sudo.pp:

  Remove the time stamp dir and its contents when uninstalling. We
  currently leave the lecture status files installed until there is a
  better way to detect upgrades.
  [[17ab16824]](https://git.sudo.ws/sudo/commit/?id=17ab16824)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Update time stamp error messages and regen.
  [[23c224953]](https://git.sudo.ws/sudo/commit/?id=23c224953)

* plugins/sudoers/timestamp.c:

  Restore warning when sudoers is unable to update the time stamp file.
  [[32b897ac6]](https://git.sudo.ws/sudo/commit/?id=32b897ac6)

* INSTALL, Makefile.in, configure, configure.ac, doc/sudoers.mdoc.in,
  m4/sudo.m4, plugins/sudoers/Makefile.in, sudo.pp:

  Replace –with-timedir and –with-lecture\_dir with –with-rundir and
  –with-vardir which are the parent directories of the time stamp and
  lecture dirs. These directories need to be searchable by non-root so
  that the timestampowner setting can function.
  [[aeb5ceead]](https://git.sudo.ws/sudo/commit/?id=aeb5ceead)

* plugins/sudoers/timestamp.c:

  Fix use of timestampowner in the new time stamp world order. Parent
  directories for timestampdir and lecture\_dir are now created with the
  execute bit set so that we can traverse them as non-root.
  [[fb29e91ef]](https://git.sudo.ws/sudo/commit/?id=fb29e91ef)

2014-01-31 Todd C. Miller

* common/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in:

  Regen Makefiles.
  [[a2dc10ece]](https://git.sudo.ws/sudo/commit/?id=a2dc10ece)

* common/sudo\_debug.c, config.h.in, include/sudo\_util.h,
  plugins/sample/sample\_plugin.c:

  Move ctim\_get and mtim\_get to sudo\_util.h
  [[d0f343ba2]](https://git.sudo.ws/sudo/commit/?id=d0f343ba2)

* plugins/sudoers/timestamp.c:

  sprinkle some debug printfs and add function header comments
  [[32b4713d6]](https://git.sudo.ws/sudo/commit/?id=32b4713d6)

* plugins/sudoers/timestamp.c:

  Properly handle the case where /var/run/sudo/ts doesn’t exist.
  [[d7257a63e]](https://git.sudo.ws/sudo/commit/?id=d7257a63e)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  fix typo
  [[b15b03560]](https://git.sudo.ws/sudo/commit/?id=b15b03560)

* NEWS:

  Mention “sudo -K” change.
  [[f04f6eeb4]](https://git.sudo.ws/sudo/commit/?id=f04f6eeb4)

* doc/UPGRADE:

  Upgrade info for 1.8.10
  [[51cab5679]](https://git.sudo.ws/sudo/commit/?id=51cab5679)

2014-01-30 Todd C. Miller

* plugins/sudoers/timestamp.c:

  Warn on ftruncate failure().
  [[596fc68ac]](https://git.sudo.ws/sudo/commit/?id=596fc68ac)

* plugins/sudoers/timestamp.c:

  Fix checking of lecture status.
  [[63e7aa994]](https://git.sudo.ws/sudo/commit/?id=63e7aa994)

* mkpkg:

  Do not override timedir on Debian.
  [[f4e037a0d]](https://git.sudo.ws/sudo/commit/?id=f4e037a0d)

* common/event.c, common/event\_select.c, include/missing.h,
  plugins/sudoers/iolog.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/visudo.c, src/sudo\_edit.c:

  Use sudo\_timeval macros and remove compat macros from missing.h
  [[b813c4de4]](https://git.sudo.ws/sudo/commit/?id=b813c4de4)

* INSTALL, MANIFEST, NEWS, compat/Makefile.in, compat/clock\_gettime.c,
  config.h.in, configure, configure.ac, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, include/missing.h,
  include/sudo\_util.h, m4/sudo.m4, mkdep.pl, pathnames.h.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/boottime.c,
  plugins/sudoers/check.h, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/timestamp.c, src/Makefile.in:

  Switch to new time stamp file format. Each user now has a single file
  which may contain multiple records when per-tty time stamps are in use
  (the default). The time stamps use a monotonic timer where available and
  are once again stored in /var/run/sudo. The lecture status is now stored
  separately from the time stamps in a different directory.
  [[659b1f0e3]](https://git.sudo.ws/sudo/commit/?id=659b1f0e3)

2014-01-29 Todd C. Miller

* NEWS, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/check.c:

  When listing a user’s privileges, always prompt the user for their own
  password, regardless of the value of target\_pw, root\_pw or runas\_pw.
  [[db3b77627]](https://git.sudo.ws/sudo/commit/?id=db3b77627)

2014-01-30 Todd C. Miller

* common/atomode.c:

  Zero out errstr when there is no error; fixes bug #632
  [[5a636f2ea]](https://git.sudo.ws/sudo/commit/?id=5a636f2ea)

2014-01-26 Todd C. Miller

* configure, configure.ac, plugins/sudoers/interfaces.c,
  plugins/sudoers/match\_addr.c:

  Use inet\_aton() instead of inet\_addr() as it allows us to distinguish
  between the address (or mask 255.255.255.255) and an error. In the
  future we may consider switching to inet\_pton() for IPv4 too.
  [[aaecd326e]](https://git.sudo.ws/sudo/commit/?id=aaecd326e)

2014-01-24 Todd C. Miller

* include/missing.h:

  Fix typo, ULONG\_MAX vs. ULLONG\_MAX
  [[7e008eb67]](https://git.sudo.ws/sudo/commit/?id=7e008eb67)

* plugins/sudoers/sudo\_nss.c:

  Fix typo in the AIX case.
  [[f6542e90f]](https://git.sudo.ws/sudo/commit/?id=f6542e90f)

* plugins/sudoers/sudo\_nss.c:

  Size pointer for sudo\_parseln() should be size\_t not ssize\_t. This was
  already correct for the nsswitch.conf case.
  [[7e88cc27b]](https://git.sudo.ws/sudo/commit/?id=7e88cc27b)

2014-01-23 Todd C. Miller

* NEWS, common/sudo\_conf.c, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, include/sudo\_conf.h, src/net\_ifs.c:

  It is now possible to disable network interface probing in sudo.conf by
  changing the value of the probe\_interfaces setting.
  [[1a42e5f63]](https://git.sudo.ws/sudo/commit/?id=1a42e5f63)

2014-01-22 Todd C. Miller

* plugins/sudoers/match\_addr.c:

  If inet\_addr() returns INADDR\_NONE, return false instead of iterating
  through the interfaces looking for a match that will never happen.
  [[4c9650f78]](https://git.sudo.ws/sudo/commit/?id=4c9650f78)

* configure, configure.ac, src/Makefile.in:

  Add explicit dependency on sudoers.la to sudo target when sudoers is
  compiled statically into the sudo binary.
  [[cf6bca139]](https://git.sudo.ws/sudo/commit/?id=cf6bca139)

2014-01-21 Todd C. Miller

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/logging.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/timestr.c:

  Do not assume localtime(), gmtime() and ctime() always return non-NULL.
  [[ae6fb933f]](https://git.sudo.ws/sudo/commit/?id=ae6fb933f)

2014-01-15 Todd C. Miller

* Makefile.in, common/Makefile.in, compat/Makefile.in, doc/Makefile.in,
  include/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in, zlib/Makefile.in:

  Update copyright years
  [[5a6db565c]](https://git.sudo.ws/sudo/commit/?id=5a6db565c)

* plugins/sudoers/visudo\_json.c:

  Eliminate dead store found by clang checker.
  [[5f88e95bc]](https://git.sudo.ws/sudo/commit/?id=5f88e95bc)

* NEWS, configure, configure.ac:

  Update for sudo 1.8.9p4
  [[2de0115cb]](https://git.sudo.ws/sudo/commit/?id=2de0115cb)

* common/sudo\_debug.c, include/sudo\_debug.h, src/preserve\_fds.c:

  When relocating fds, update the debug fd if it is set so we are
  guaranteed to get debugging output.
  [[8ca711ee1]](https://git.sudo.ws/sudo/commit/?id=8ca711ee1)

2014-01-14 Todd C. Miller

* src/exec.c:

  If the event loop exits due to an error and we are not logging I/O, kill
  the command if still running. Fixes a bug where sudo could exit while
  the command was still running.
  [[640a5ddb4]](https://git.sudo.ws/sudo/commit/?id=640a5ddb4)

* src/preserve\_fds.c:

  When relocating preserved fds, start with the highest ones first to
  avoid moving fds around more than we have to. Now uses a bitmap to keep
  track of which fds are being preserved. Fixes a bug where the debugging
  fd could be relocated to the same fd as the error backchannel
  temporarily, resulting in debugging output being printed to the
  backchannel if util@debug was enabled.
  [[77b126acc]](https://git.sudo.ws/sudo/commit/?id=77b126acc)

* src/preserve\_fds.c:

  When restoring fds traverse list from high -> low, not low -> high to
  avoid implicitly closing an fd we want to relocate.
  [[26cff8bcb]](https://git.sudo.ws/sudo/commit/?id=26cff8bcb)

* src/exec.c:

  If not logging I/O we may get EOF when the command is executed and the
  other end of the backchannel is closed. Just remove the backchannel
  event in this case or we will continue to receive the event. [Bug
  #631](https://bugzilla.sudo.ws/show_bug.cgi?id=631)
  [[d7277fc96]](https://git.sudo.ws/sudo/commit/?id=d7277fc96)

* src/po/sr.mo, src/po/sr.po:

  sync with translationproject.org
  [[6a76d1a1c]](https://git.sudo.ws/sudo/commit/?id=6a76d1a1c)

2014-01-13 Todd C. Miller

* src/ttyname.c:

  Fix strtonum() usage when parsing /proc/self/stat on Linux. [Bug
  #630](https://bugzilla.sudo.ws/show_bug.cgi?id=630)
  [[d99b4f090]](https://git.sudo.ws/sudo/commit/?id=d99b4f090)

* NEWS, configure, configure.ac:

  Update for sudo 1.8.9p3
  [[50c7e759d]](https://git.sudo.ws/sudo/commit/?id=50c7e759d)

* plugins/sudoers/logwrap.c:

  Remove dead store; found by cppcheck
  [[bec5786e5]](https://git.sudo.ws/sudo/commit/?id=bec5786e5)

2014-01-08 Todd C. Miller

* src/sesh.c:

  Quiet a cppcheck warning about a negative subscript.
  [[73f6e56c5]](https://git.sudo.ws/sudo/commit/?id=73f6e56c5)

* src/exec\_common.c, src/selinux.c, src/sesh.c, src/sudo\_exec.h:

  Make noexec parameter to sudo\_execve() bool.
  [[bb9775879]](https://git.sudo.ws/sudo/commit/?id=bb9775879)

* plugins/sudoers/sudoreplay.c:

  Quiet a few innocuous cppcheck warnings.
  [[aa93ef78a]](https://git.sudo.ws/sudo/commit/?id=aa93ef78a)

* plugins/sudoers/sssd.c:

  Handle in\_res being NULL for sudo\_debug\_printf() in
  sudo\_sss\_filter\_result().
  [[57113a536]](https://git.sudo.ws/sudo/commit/?id=57113a536)

* plugins/sudoers/iolog.c:

  When writing length to timing file, use %u not %d as it is unsigned.
  [[12fc51060]](https://git.sudo.ws/sudo/commit/?id=12fc51060)

* plugins/sudoers/visudo\_json.c:

  Close export\_fp in the error path too, but do not close stdout.
  [[4b5ad37b4]](https://git.sudo.ws/sudo/commit/?id=4b5ad37b4)

* plugins/sudoers/auth/secureware.c:

  Move right brace outside #ifdef HAVE\_DISPCRYPT; found by cppcheck.
  [[7ace435d4]](https://git.sudo.ws/sudo/commit/?id=7ace435d4)

2014-01-13 Todd C. Miller

* plugins/group\_file/plugin\_test.c:

  Make this compile again
  [[cadba501e]](https://git.sudo.ws/sudo/commit/?id=cadba501e)

* common/term.c:

  Add suppression line to quiet a bogus (inconclusive) cppcheck warning.
  [[f7421f769]](https://git.sudo.ws/sudo/commit/?id=f7421f769)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Do not leak old istack if realloc fails; found by cppcheck. Also modify
  yyless() to avoid a harmless cppcheck warning every time it is used.
  [[b75bb6991]](https://git.sudo.ws/sudo/commit/?id=b75bb6991)

* Makefile.in, common/Makefile.in, compat/Makefile.in, doc/Makefile.in,
  include/Makefile.in, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in, zlib/Makefile.in:

  Add cppcheck target to run cppcheck on all source files.
  [[78355e618]](https://git.sudo.ws/sudo/commit/?id=78355e618)

2014-01-09 Todd C. Miller

* NEWS, configure, configure.ac:

  Update for sudo 1.8.9p2
  [[bf7a51389]](https://git.sudo.ws/sudo/commit/?id=bf7a51389)

* config.h.in, configure, ltmain.sh, m4/libtool.m4, m4/ltoptions.m4,
  m4/ltsugar.m4, m4/ltversion.m4, m4/lt~obsolete.m4:

  Update to libtool-2.4.2.418
  [[a2a029ecf]](https://git.sudo.ws/sudo/commit/?id=a2a029ecf)

* config.guess, config.sub:

  Update from <http://git.savannah.gnu.org/gitweb/?p=config.git>
  [[11b1fe60d]](https://git.sudo.ws/sudo/commit/?id=11b1fe60d)

2014-01-08 Todd C. Miller

* NEWS:

  Sudo 1.8.9 also fixes bug #617
  [[d94a35709]](https://git.sudo.ws/sudo/commit/?id=d94a35709)

2014-01-07 Todd C. Miller

* NEWS:

  The fix for the hang was already in the 1.8.9 tarballs.
  [[2c2ab9c32]](https://git.sudo.ws/sudo/commit/?id=2c2ab9c32)

* NEWS, configure, configure.ac:

  Update for sudo 1.8.9p1
  [[a3d88b9db]](https://git.sudo.ws/sudo/commit/?id=a3d88b9db)

* common/atobool.c, common/event.c, plugins/sudoers/iolog.c,
  plugins/sudoers/parse.h, src/exec.c, src/preserve\_fds.c:

  Update copyright year.
  [[27598bc0a]](https://git.sudo.ws/sudo/commit/?id=27598bc0a)

* plugins/sudoers/parse.h:

  Go back to making the bit fields in struct cmndtag explicitly signed.
  This fixes a problem on gcc 4.8 (at least) which appears to be treating
  the value as unsigned by default.
  [[f57beb1af]](https://git.sudo.ws/sudo/commit/?id=f57beb1af)

* common/atobool.c:

  Use debug\_return\_int() instead of bare return for debugging support.
  [[1bd694362]](https://git.sudo.ws/sudo/commit/?id=1bd694362)

2014-01-06 Todd C. Miller

* common/event.c:

  Fix infinite loop that could be triggered by sudo\_ev\_loopbreak() and
  sudo\_ev\_loopcontinue().
  [[5a6d211d6]](https://git.sudo.ws/sudo/commit/?id=5a6d211d6)

* NEWS:

  Update for 1.8.9 final.
  [[d3fd43fd2]](https://git.sudo.ws/sudo/commit/?id=d3fd43fd2)

2014-01-04 Todd C. Miller

* plugins/sudoers/iolog.c:

  Handle a sequence file with no trailing newline.
  [[0e1d726aa]](https://git.sudo.ws/sudo/commit/?id=0e1d726aa)

2014-01-03 Todd C. Miller

* plugins/sudoers/iolog.c:

  Truncate io log and timing files on open when recycling them. Only an
  issue when the sequence number wraps around.
  [[391bc02e2]](https://git.sudo.ws/sudo/commit/?id=391bc02e2)

* plugins/sudoers/iolog.c:

  Repair reading of the iolog sequence number that got broken when adding
  stricter strtoul() checks.
  [[6fe419423]](https://git.sudo.ws/sudo/commit/?id=6fe419423)

* src/exec.c:

  If invoked as sudoedit we can’t just exec the command directly since the
  temporary files need to be updated before sudo exits.
  [[d013b23ce]](https://git.sudo.ws/sudo/commit/?id=d013b23ce)

* src/preserve\_fds.c:

  Fix restoration of the close-on-exec flag when moving a relocated fd
  back into its original position.
  [[38bf95a76]](https://git.sudo.ws/sudo/commit/?id=38bf95a76)

2014-01-02 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Add “see below” to reference “Secure editing” section in “Preventing
  shell escapes”.
  [[ed029f9a6]](https://git.sudo.ws/sudo/commit/?id=ed029f9a6)

2014-01-01 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Add initial “Secure editing” section.
  [[9bbf4c728]](https://git.sudo.ws/sudo/commit/?id=9bbf4c728)

* doc/LICENSE:

  Update copyright year.
  [[76fb02390]](https://git.sudo.ws/sudo/commit/?id=76fb02390)

2013-12-31 Todd C. Miller

* plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po, src/po/eo.mo,
  src/po/eo.po, src/po/fi.mo, src/po/fi.po:

  sync with translationproject.org
  [[929d8a38e]](https://git.sudo.ws/sudo/commit/?id=929d8a38e)

* plugins/sudoers/policy.c:

  Make user\_cwd and user\_tty dynamically allocated even for the “unknown”
  case.
  [[1943396d7]](https://git.sudo.ws/sudo/commit/?id=1943396d7)

2013-12-30 Todd C. Miller

* configure, configure.ac:

  Use -fstack-protector-strong in preference to -fstack-protector-all or
  -fstack-protector.
  [[483e6972f]](https://git.sudo.ws/sudo/commit/?id=483e6972f)

* doc/HISTORY:

  Dell acquired Quest
  [[cd77926e1]](https://git.sudo.ws/sudo/commit/?id=cd77926e1)

2013-12-29 Todd C. Miller

* plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po, src/po/ru.mo,
  src/po/ru.po, src/po/vi.mo, src/po/vi.po:

  sync with translationproject.org
  [[42dbe7f4b]](https://git.sudo.ws/sudo/commit/?id=42dbe7f4b)

2013-12-28 Todd C. Miller

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, src/po/cs.mo,
  src/po/cs.po, src/po/da.mo, src/po/da.po, src/po/it.mo, src/po/it.po,
  src/po/pl.mo, src/po/pl.po, src/po/pt\_BR.mo, src/po/pt\_BR.po,
  src/po/uk.mo, src/po/uk.po, src/po/zh\_CN.mo, src/po/zh\_CN.po:

  sync with translationproject.org
  [[72cd57dea]](https://git.sudo.ws/sudo/commit/?id=72cd57dea)

* doc/sudoers.ldap.cat:

  regen
  [[11babdaab]](https://git.sudo.ws/sudo/commit/?id=11babdaab)

* NEWS:

  Update for recent changes.
  [[bb87b3abf]](https://git.sudo.ws/sudo/commit/?id=bb87b3abf)

* plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Fix typo; we want setlocale(LC\_ALL, “”) since we are setting the locale
  for the first time.
  [[a6e1766dd]](https://git.sudo.ws/sudo/commit/?id=a6e1766dd)

2013-12-27 Todd C. Miller

* plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Use sudoers\_initlocale() in main() startup, not sudoers\_setlocal() as
  the latter assumes we are already in the user’s locale which may not be
  the case. For sudoreplay, we can just use setlocale() directly as there
  is no sudoers locale.
  [[91db1efe9]](https://git.sudo.ws/sudo/commit/?id=91db1efe9)

2013-12-24 Todd C. Miller

* src/preserve\_fds.c, src/sudo.c, src/sudo.h:

  Redo preserve\_fds support to remap high fds so we can get the most out
  of closefrom(). The fds are then restored after closefrom().
  [[4d80e7cea]](https://git.sudo.ws/sudo/commit/?id=4d80e7cea)

* plugins/sudoers/Makefile.in:

  Fix install-plugin when sudoers is compiled statically.
  [[76544011e]](https://git.sudo.ws/sudo/commit/?id=76544011e)

2013-12-20 Todd C. Miller

* MANIFEST, common/sudo\_debug.c, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, include/sudo\_debug.h,
  include/sudo\_plugin.h, src/Makefile.in, src/exec.c, src/exec\_pty.c,
  src/preserve\_fds.c, src/sudo.c, src/sudo.h, src/sudo\_exec.h:

  Add support for preventing fds from getting clobbered by closefrom().
  [[1adeda54e]](https://git.sudo.ws/sudo/commit/?id=1adeda54e)

2013-12-19 Todd C. Miller

* plugins/sudoers/Makefile.in:

  regen
  [[388ad69f0]](https://git.sudo.ws/sudo/commit/?id=388ad69f0)

2013-12-18 Todd C. Miller

* common/alloc.c:

  Need to include limits.h here too.
  [[291f88d2b]](https://git.sudo.ws/sudo/commit/?id=291f88d2b)

2013-12-17 Todd C. Miller

* config.h.in, configure, configure.ac, plugins/sudoers/parse.h:

  No need to use \_\_signed.
  [[eb44a5ba5]](https://git.sudo.ws/sudo/commit/?id=eb44a5ba5)

* plugins/sudoers/regress/logging/check\_wrap.c:

  Need limits.h here too.
  [[a0204080e]](https://git.sudo.ws/sudo/commit/?id=a0204080e)

* compat/closefrom.c:

  Still need limits.h here.
  [[a18395a90]](https://git.sudo.ws/sudo/commit/?id=a18395a90)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[0cfe027b5]](https://git.sudo.ws/sudo/commit/?id=0cfe027b5)

* compat/closefrom.c:

  Go back to using /proc/self/fd instead of /proc/$$/fd as only AIX lacks
  /proc/self and it has F\_CLOSEM.
  [[aa849ed94]](https://git.sudo.ws/sudo/commit/?id=aa849ed94)

2013-12-16 Todd C. Miller

* plugins/sudoers/visudo\_json.c:

  Use a switch to map digest type to name instead of an array of strings.
  [[65012dd66]](https://git.sudo.ws/sudo/commit/?id=65012dd66)

* compat/closefrom.c:

  Use /dev/fd in closefrom() on FreeBSD < 8.0 and Mac OS X.
  [[1c3f2ac1e]](https://git.sudo.ws/sudo/commit/?id=1c3f2ac1e)

* compat/snprintf.c:

  Remove \_MAX and \_MIN compat; we rely on missing.h for that. We already
  require the compiler handle long long so there’s no need to use
  HAVE\_LONG\_LONG\_INT everywhere.
  [[8c184dcec]](https://git.sudo.ws/sudo/commit/?id=8c184dcec)

* common/ttysize.c, include/missing.h:

  Remove \_MAX and \_MIN defines that any system from the last 20 years
  should have. Add ULLONG\_MAX in case it is missing.
  [[f689a8635]](https://git.sudo.ws/sudo/commit/?id=f689a8635)

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in,
  plugins/sudoers/visudo.c, plugins/sudoers/visudo\_json.c:

  Change visudo -x to take a file name argument, which may be ‘-’ to write
  the exported sudoers file to stdout.
  [[68f6e23b0]](https://git.sudo.ws/sudo/commit/?id=68f6e23b0)

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/parse.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/visudo.c,
  plugins/sudoers/visudo\_json.c, src/regress/ttyname/check\_ttyname.c:

  Move symbol extern defs into sudoers.h
  [[b2c456341]](https://git.sudo.ws/sudo/commit/?id=b2c456341)

* plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/logging/check\_wrap.c:

  Add missing sudo\_util.h
  [[624f4fdb1]](https://git.sudo.ws/sudo/commit/?id=624f4fdb1)

2013-12-14 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Warn if the time stamp in the I/O log file does not fit in time\_t. Warn
  if the info line is not well-formed instead of silently ignoring it.
  [[cf47b156f]](https://git.sudo.ws/sudo/commit/?id=cf47b156f)

2013-12-13 Todd C. Miller

* common/Makefile.in, plugins/sudoers/Makefile.in, src/Makefile.in:

  Rename libcommon libsudo\_util
  [[62b559db1]](https://git.sudo.ws/sudo/commit/?id=62b559db1)

2013-12-12 Todd C. Miller

* MANIFEST, common/Makefile.in, common/aix.c, common/atobool.c,
  common/atoid.c, common/atomode.c, common/fmt\_string.c, common/gidlist.c,
  common/progname.c, common/setgroups.c, common/sudo\_conf.c,
  common/term.c, common/ttysize.c, include/missing.h, include/sudo\_util.h,
  plugins/group\_file/Makefile.in, plugins/group\_file/getgrent.c,
  plugins/sudoers/Makefile.in, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c, plugins/system\_group/Makefile.in,
  plugins/system\_group/system\_group.c, src/Makefile.in, src/sudo.h:

  Move prototypes for functions provided by libcommon that don’t have
  their own header files into sudo\_util.h.
  [[3e2d818ed]](https://git.sudo.ws/sudo/commit/?id=3e2d818ed)

2013-12-11 Todd C. Miller

* plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/mkdefaults:

  Now that we have proper number parsing functions we should store T\_UINT
  defaults values as unsigned int, not int.
  [[ef2cff1d3]](https://git.sudo.ws/sudo/commit/?id=ef2cff1d3)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h:

  Don’t use int where we really mean enum def\_tuple. When this code was
  written it was assumed that we may have multiple tuple types. However,
  that hasn’t happened and probably never will.
  [[3e4f5c584]](https://git.sudo.ws/sudo/commit/?id=3e4f5c584)

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  Regen after string parsing changes.
  [[03b013ab2]](https://git.sudo.ws/sudo/commit/?id=03b013ab2)

* common/atoid.c, common/atomode.c, compat/strtonum.c, configure,
  configure.ac, include/missing.h, plugins/sudoers/defaults.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/sudoreplay.c, src/parse\_args.c, src/ttyname.c:

  The OpenBSD strtonum() uses very short error strings that can’t be
  translated usefully. Convert them to longer strings on error. Also use
  the longer strings for atomode() and atoid().
  [[cbf41b8b9]](https://git.sudo.ws/sudo/commit/?id=cbf41b8b9)

2013-12-10 Todd C. Miller

* MANIFEST, common/Makefile.in, common/atoid.c, common/atomode.c,
  plugins/sudoers/defaults.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h, src/sudo.c, src/sudo.h:

  Add atomode() function for parsing a file mode.
  [[d83bfb9fe]](https://git.sudo.ws/sudo/commit/?id=d83bfb9fe)

* common/sudo\_conf.c, common/ttysize.c, compat/Makefile.in,
  compat/closefrom.c, compat/getaddrinfo.c, compat/strtonum.c, configure,
  configure.ac, include/missing.h, plugins/sudoers/boottime.c,
  plugins/sudoers/defaults.c, plugins/sudoers/iolog.c,
  plugins/sudoers/ldap.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/policy.c, plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/sudoreplay.c, plugins/system\_group/system\_group.c,
  src/parse\_args.c, src/sudo.c, src/ttyname.c:

  Use strtonum() instead of atoi(), strtol() or strtoul() where possible.
  [[8f9ce7249]](https://git.sudo.ws/sudo/commit/?id=8f9ce7249)

* MANIFEST, compat/Makefile.in, compat/strtonum.c, config.h.in, configure,
  configure.ac, include/missing.h, mkdep.pl:

  Add strtonum.c to compat for simpler number parsing.
  [[f83eac40e]](https://git.sudo.ws/sudo/commit/?id=f83eac40e)

2013-12-09 Todd C. Miller

* src/exec\_common.c:

  Fix a warning on Solaris, we need to use debug\_return\_const\_ptr.
  [[7dabe334b]](https://git.sudo.ws/sudo/commit/?id=7dabe334b)

* plugins/sudoers/Makefile.in:

  check\_symbols needs to link with SUDO\_LIBS in order to get -lpthread on
  HP-UX for libldap (which uses threads). It would be better to have a
  separate variable for the pthread library but this is no worse than it
  used to be.
  [[b7c647a4f]](https://git.sudo.ws/sudo/commit/?id=b7c647a4f)

2013-12-08 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  add missing comma
  [[8e04c592a]](https://git.sudo.ws/sudo/commit/?id=8e04c592a)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Make -c option description more accurate.
  [[47dbe189f]](https://git.sudo.ws/sudo/commit/?id=47dbe189f)

2013-12-07 Todd C. Miller

* doc/CONTRIBUTORS, plugins/sudoers/sudoers.c:

  When checking whether a user may change the login class, just check
  pw\_uid of the runas user, which was passed in to set\_loginclass().
  [[8bdf3d9a2]](https://git.sudo.ws/sudo/commit/?id=8bdf3d9a2)

2013-12-06 Todd C. Miller

* plugins/sudoers/visudo\_json.c:

  Use atoid() when parsing user/group IDs and print them as unsigned int.
  [[acdff2d99]](https://git.sudo.ws/sudo/commit/?id=acdff2d99)

2013-12-05 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Correctly parse 64-bit times in I/O log files.
  [[e964aa4d8]](https://git.sudo.ws/sudo/commit/?id=e964aa4d8)

* compat/getgrouplist.c, plugins/group\_file/getgrent.c,
  plugins/sudoers/pwutil.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c:

  Use atoid() not atoi() when parsing uids/gids.
  [[e1ac1a2ff]](https://git.sudo.ws/sudo/commit/?id=e1ac1a2ff)

* plugins/sudoers/match.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/parse.h, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil.h, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/sudoers.h:

  Better match debugging. Sprinkle const in match functions.
  [[2508da6f6]](https://git.sudo.ws/sudo/commit/?id=2508da6f6)

2013-12-04 Todd C. Miller

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Document that plugins can be compiled statically into the sudo binary.
  [[1739350e2]](https://git.sudo.ws/sudo/commit/?id=1739350e2)

2013-12-03 Todd C. Miller

* plugins/sudoers/sssd.c:

  sudo\_sss\_filter\_user\_netgroup(): fix comment typos, break out of loop
  early if we match ALL or netgroup.
  [[9e964a8c0]](https://git.sudo.ws/sudo/commit/?id=9e964a8c0)

* plugins/sudoers/sssd.c:

  When filtering netgroups, use the passwd struct stashed in the handle,
  not user\_name since we may be listing another users privileges.
  [[302d3273a]](https://git.sudo.ws/sudo/commit/?id=302d3273a)

* mkpkg:

  RHEL 6 and above builds sudo with SSSD support
  [[af72b1ad5]](https://git.sudo.ws/sudo/commit/?id=af72b1ad5)

* plugins/sudoers/sssd.c:

  Avoid passing NULL domainname to sudo\_debug\_printf().
  [[f477b343f]](https://git.sudo.ws/sudo/commit/?id=f477b343f)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document sssd debug subsystem.
  [[ede55a2f7]](https://git.sudo.ws/sudo/commit/?id=ede55a2f7)

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  Document “event” debug subsystem.
  [[5b491573e]](https://git.sudo.ws/sudo/commit/?id=5b491573e)

* plugins/sudoers/match.c:

  Use atoid() instead of atoi() when parsing uids/gids so we get proper
  range checking.
  [[878ddb178]](https://git.sudo.ws/sudo/commit/?id=878ddb178)

* plugins/sudoers/sssd.c:

  Add user netgroup filtering for SSSD. Previously, rules for a netgroup
  were applied to all even when they did not belong to the specified
  netgroup. RedHat Bugzilla 880150.
  [[f56eca805]](https://git.sudo.ws/sudo/commit/?id=f56eca805)

* plugins/sudoers/sssd.c:

  Fix several issues found by the clang static analyzer; Daniel Kopecek
  [[543d3b701]](https://git.sudo.ws/sudo/commit/?id=543d3b701)

2013-12-02 Todd C. Miller

* README.LDAP:

  Mention how to dump sudoers info from LDAP.
  [[dc69e5af5]](https://git.sudo.ws/sudo/commit/?id=dc69e5af5)

* src/exec\_common.c:

  On Solaris, disabling the proc\_exec privilege appears to interfere with
  DAC file permissions. Adding DAC override permissions to the inheritable
  set works around this for commands run as root without giving extra
  permissions to other users. [Bug
  #626](https://bugzilla.sudo.ws/show_bug.cgi?id=626)
  [[b082a614f]](https://git.sudo.ws/sudo/commit/?id=b082a614f)

2013-12-01 Todd C. Miller

* MANIFEST, common/Makefile.in, common/progname.c, compat/Makefile.in,
  compat/getprogname.c, configure, configure.ac, include/missing.h,
  mkdep.pl, plugins/sample/sample\_plugin.c, plugins/sudoers/policy.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c, src/parse\_args.c,
  src/regress/ttyname/check\_ttyname.c, src/sudo.c:

  Instead of setprogname(), add initprogname() which gets the program name
  for getprogname() using /proc or pstat() if possible.
  [[0d81263e2]](https://git.sudo.ws/sudo/commit/?id=0d81263e2)

2013-11-30 Todd C. Miller

* src/ttyname.c:

  Ignore EOVERFLOW from pstat\_getproc(). The HP-UX kernel appears to
  return this in certain situations but it appears to be harmless at least
  insofar as retrieving the tty goes.
  [[902215a8c]](https://git.sudo.ws/sudo/commit/?id=902215a8c)

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, src/po/cs.mo,
  src/po/cs.po, src/po/eo.mo, src/po/eo.po, src/po/fi.mo, src/po/fi.po,
  src/po/it.mo, src/po/it.po, src/po/pl.mo, src/po/pl.po, src/po/pt\_BR.mo,
  src/po/pt\_BR.po, src/po/ru.mo, src/po/ru.po, src/po/uk.mo, src/po/uk.po,
  src/po/vi.mo, src/po/vi.po, src/po/zh\_CN.mo, src/po/zh\_CN.po:

  Sync with translationproject.org
  [[fdf56ee94]](https://git.sudo.ws/sudo/commit/?id=fdf56ee94)

2013-11-28 Todd C. Miller

* plugins/sudoers/visudo.c:

  Add missing newline in help message after export option.
  [[188e92156]](https://git.sudo.ws/sudo/commit/?id=188e92156)

2013-11-26 Todd C. Miller

* configure, configure.ac, plugins/sudoers/Makefile.in, src/Makefile.in:

  Do not add LIBDL to SUDO\_LIBS or SUDOERS\_LIBS in configure, do it in
  Makefile.in so we can make it last. Fixes a linking problem on Ubuntu
  precise.
  [[4247c1741]](https://git.sudo.ws/sudo/commit/?id=4247c1741)

2013-11-25 Todd C. Miller

* configure, m4/ax\_func\_getaddrinfo.m4:

  Do not rely on NULL being defined for getaddrinfo() test. Fixes the
  check on HP-UX 11.23.
  [[94ad47ff9]](https://git.sudo.ws/sudo/commit/?id=94ad47ff9)

2013-11-24 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  Regen for sudo 1.8.9b1
  [[58a0540b9]](https://git.sudo.ws/sudo/commit/?id=58a0540b9)

* src/po/de.mo, src/po/de.po, src/po/sr.mo, src/po/sr.po:

  Sync with translationproject.org
  [[853384124]](https://git.sudo.ws/sudo/commit/?id=853384124)

2013-11-22 Todd C. Miller

* INSTALL, MANIFEST, NEWS, common/Makefile.in, common/sudo\_dso.c,
  compat/Makefile.in, compat/dlfcn.h, compat/dlopen.c, config.h.in,
  configure, configure.ac, include/sudo\_dso.h, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/ldap.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/sssd.c, plugins/system\_group/Makefile.in,
  plugins/system\_group/system\_group.c, src/Makefile.in, src/env\_hooks.c,
  src/load\_plugins.c, src/preload.c, src/sudo.c, src/sudo.h:

  Add wrapper functions for dlopen() et al so that we can support
  statically compiling in the sudoers plugin but still allow other plugins
  to be loaded. The new –enable-static-sudoers configure option will
  cause the sudoers plugin to be compiled statically into the sudo binary.
  This does not prevent other plugins from being loaded as per sudo.conf.
  [[12f3bdf60]](https://git.sudo.ws/sudo/commit/?id=12f3bdf60)

2013-11-21 Todd C. Miller

* plugins/sudoers/visudo\_json.c:

  Handle non-unix groups correctly. Get rid of runasuser and runasgroup
  types and use username and usergroup instead. The fact that the user or
  group is inside a Runas\_List doesn’t affect its underlying type.
  [[0fb17059a]](https://git.sudo.ws/sudo/commit/?id=0fb17059a)

2013-11-20 Todd C. Miller

* plugins/sudoers/visudo\_json.c:

  Simplify Defaults list option object. The name and value strings are
  superfluous.
  [[bf700fdd5]](https://git.sudo.ws/sudo/commit/?id=bf700fdd5)

* compat/dlopen.c:

  Back out unintended change.
  [[627099136]](https://git.sudo.ws/sudo/commit/?id=627099136)

* MANIFEST, aclocal.m4, configure, configure.ac,
  m4/ax\_func\_getaddrinfo.m4:

  Add dedicated test for getaddrinfo(). Tru64 UNIX contains two versions
  of getaddrinfo and we must include netdb.h to get the proper definition.
  [[6a1d1e148]](https://git.sudo.ws/sudo/commit/?id=6a1d1e148)

* compat/dlopen.c, plugins/sudoers/regress/check\_symbols/check\_symbols.c:

  Define RTLD\_GLOBAL for older systems without it. [Bug
  #621](https://bugzilla.sudo.ws/show_bug.cgi?id=621)
  [[ba40be9dd]](https://git.sudo.ws/sudo/commit/?id=ba40be9dd)

2013-11-19 Todd C. Miller

* compat/snprintf.c, include/missing.h:

  Rename snprintf replacement rpl\_snprintf since we may now replace the
  libc version and #define rpl\_snprintf snprintf in missing.h so we get
  our version when needed. This is consistent with how we replace glob and
  fnmatch.
  [[192cbbb49]](https://git.sudo.ws/sudo/commit/?id=192cbbb49)

* common/Makefile.in, common/regress/sudo\_conf/conf\_test.c,
  common/regress/sudo\_parseln/parseln\_test.c,
  common/regress/tailq/hltq\_test.c, src/Makefile.in:

  libcommon tests need locale\_stub.lo to link.
  [[4075ee77c]](https://git.sudo.ws/sudo/commit/?id=4075ee77c)

* MANIFEST, aclocal.m4, compat/snprintf.c, config.h.in, configure,
  configure.ac, m4/ax\_func\_snprintf.m4:

  Add check for C99 compliant (v)snprintf function.
  [[42b1e4a9c]](https://git.sudo.ws/sudo/commit/?id=42b1e4a9c)

* compat/sig2str.c, configure, configure.ac:

  Include unistd.h in sig2str.c for Tru64 as it defines SIGRTMIN and
  SIGRTMAX in terms of sysconf(), which is prototyped in unistd.h. [Bug
  #621](https://bugzilla.sudo.ws/show_bug.cgi?id=621); from Daniel Richard
  G.
  [[0a47860ef]](https://git.sudo.ws/sudo/commit/?id=0a47860ef)

* include/gettext.h, plugins/sudoers/locale.c, src/locale\_stub.c:

  Add definition of U\_ for –disable-nsl Don’t define warning\_gettext if
  –disable-nsl [Bug #621](https://bugzilla.sudo.ws/show_bug.cgi?id=621);
  from Daniel Richard G.
  [[054a94e6c]](https://git.sudo.ws/sudo/commit/?id=054a94e6c)

2013-11-18 Todd C. Miller

* plugins/sudoers/visudo\_json.c:

  When merging Defaults entries we need to check the type of the next
  entry and not just assume it is the same as the previous one.
  [[0a7ebf8b2]](https://git.sudo.ws/sudo/commit/?id=0a7ebf8b2)

* plugins/sudoers/visudo\_json.c:

  runasgroups not runasgroup in the Cmnd\_Spec.
  [[f16ce9714]](https://git.sudo.ws/sudo/commit/?id=f16ce9714)

* plugins/sudoers/visudo\_json.c:

  Fix some syntax errors and change how lists are handled.
  [[a1b1c80b2]](https://git.sudo.ws/sudo/commit/?id=a1b1c80b2)

* common/sudo\_debug.c, config.h.in, configure, configure.ac,
  include/fatal.h, include/sudo\_debug.h:

  Allow sudo to compile without variadic macro support in cpp. Debugging
  support will be limited (no file info from warnings.) From Daniel
  Richard G.; [Bug #621](https://bugzilla.sudo.ws/show_bug.cgi?id=621)
  [[3dab6bd8e]](https://git.sudo.ws/sudo/commit/?id=3dab6bd8e)

* Makefile.in, common/aix.c, common/fatal.c, common/gidlist.c,
  common/sudo\_conf.c, include/fatal.h, include/gettext.h,
  include/missing.h, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/defaults.c,
  plugins/sudoers/env.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/locale.c,
  plugins/sudoers/logging.c, plugins/sudoers/match.c,
  plugins/sudoers/policy.c, plugins/sudoers/prompt.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sssd.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestamp.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/toke\_util.c,
  plugins/sudoers/visudo.c, plugins/sudoers/visudo\_json.c, src/exec.c,
  src/exec\_common.c, src/exec\_pty.c, src/load\_plugins.c,
  src/locale\_stub.c, src/net\_ifs.c, src/parse\_args.c, src/selinux.c,
  src/sesh.c, src/signal.c, src/solaris.c, src/sudo.c, src/sudo\_edit.c,
  src/tgetpass.c, src/utmp.c:

  Add warning\_gettext() wrapper function that changes to the user locale,
  then calls gettext(). Add U\_ macro that calls warning\_gettext() instead
  of gettext(). Rename warning2()/error2() back to
  warning\_nodebug()/error\_nodebug().
  [[96eb2c4f8]](https://git.sudo.ws/sudo/commit/?id=96eb2c4f8)

2013-11-17 Todd C. Miller

* common/fileops.c, compat/getaddrinfo.c, compat/mktemp.c,
  compat/utimes.c, configure.ac, plugins/sudoers/boottime.c,
  plugins/sudoers/check.c, plugins/sudoers/getdate.c,
  plugins/sudoers/getdate.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/logging.h, plugins/sudoers/sssd.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/visudo.c, src/exec.c, src/exec\_pty.c, src/preload.c,
  src/sudo.c, src/sudo\_edit.c, src/ttyname.c, src/utmp.c:

  Fix some #if vs. #ifdef and remove an extraneous semicolon. [Bug
  #624](https://bugzilla.sudo.ws/show_bug.cgi?id=624); from Daniel Richard
  G.
  [[99b7351de]](https://git.sudo.ws/sudo/commit/?id=99b7351de)

* include/sudo\_debug.h, plugins/sudoers/defaults.c,
  plugins/sudoers/ldap.c, src/exec\_common.c:

  Add debug\_return\_const\_str and debug\_return\_const\_ptr for returning a
  const string or pointer. Using const for the normal versions produces
  warnings with the Tru64 compiler.
  [[6c71ad5c1]](https://git.sudo.ws/sudo/commit/?id=6c71ad5c1)

* common/event\_poll.c, compat/getaddrinfo.c, config.h.in, configure,
  configure.ac, m4/sudo.m4:

  Fixes for building under Tru64; from Daniel Richard G. [Bug
  #624](https://bugzilla.sudo.ws/show_bug.cgi?id=624)
  [[bf65cc041]](https://git.sudo.ws/sudo/commit/?id=bf65cc041)

2013-11-16 Todd C. Miller

* plugins/sudoers/logging.c:

  log\_{fatal,warning} now logs to the debug file itself.
  log\_{fatal,warning} now calls warningx2() after setting the locale
  itself instead of using the wrapper macros. This removes the only use of
  warningx(ngettext(…)).
  [[7017c904c]](https://git.sudo.ws/sudo/commit/?id=7017c904c)

2013-11-15 Todd C. Miller

* configure, configure.ac:

  Add -Wpointer-arith to –enable-warnings
  [[942f732a5]](https://git.sudo.ws/sudo/commit/?id=942f732a5)

* configure, configure.ac:

  Fix more instances of #include directives where the ‘#’ was not in
  column 1. From Daniel Richard G. (bug #622)
  [[e684f6a09]](https://git.sudo.ws/sudo/commit/?id=e684f6a09)

* MANIFEST, doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/visudo.c,
  plugins/sudoers/visudo\_json.c:

  Add support to visudo to export sudoers in JSON format.
  [[6d8b078e2]](https://git.sudo.ws/sudo/commit/?id=6d8b078e2)

2013-11-13 Todd C. Miller

* plugins/sudoers/parse.h:

  Remove unused digest field from struct cmndspec, the digest really lives
  in struct sudo\_command.
  [[bba91c008]](https://git.sudo.ws/sudo/commit/?id=bba91c008)

* config.h.in, configure:

  Regen with autoconf 2.69
  [[362080220]](https://git.sudo.ws/sudo/commit/?id=362080220)

* MANIFEST, Makefile.in, config.h.in, configure.ac, doc/Makefile.in:

  Rename configure.in -> configure.ac
  [[e31b2ba6a]](https://git.sudo.ws/sudo/commit/?id=e31b2ba6a)

* MANIFEST, aclocal.m4, autogen.sh, config.h.in, configure, configure.in,
  ltmain.sh, m4/sudo.m4:

  From Daniel Richard G. (bug #622) Add an autogen.sh script that rebuilds
  the autoconf world. Move old aclocal.m4 contents to m4/sudo.m4. New
  (generayed) aclocal.m4 contains the m4\_include directives. Some tests
  had #include directives where the ‘#’ was not in column 1. Updated
  obsolete macro usage via autoupdate.
  [[97b60e3eb]](https://git.sudo.ws/sudo/commit/?id=97b60e3eb)

2013-11-12 Todd C. Miller

* src/sudo\_exec.h:

  Very old systems (pre XPG 4.2) may not support MSG\_WAITALL. The
  likelihood of receiving a partial message is quite low so this is not a
  big deal.
  [[bb45f8e84]](https://git.sudo.ws/sudo/commit/?id=bb45f8e84)

* configure, configure.in:

  HP-UX may require \_XOPEN\_SOURCE\_EXTENDED to be defined for MSG\_WAITALL
  to be visible.
  [[142fff6db]](https://git.sudo.ws/sudo/commit/?id=142fff6db)

* MANIFEST, plugins/sudoers/regress/visudo/test5.out.ok,
  plugins/sudoers/regress/visudo/test5.sh:

  Add regress test for bug #623
  [[69f7ed79c]](https://git.sudo.ws/sudo/commit/?id=69f7ed79c)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Cope with a comment on the last line of the file with no newline. [Bug
  #623](https://bugzilla.sudo.ws/show_bug.cgi?id=623)
  [[a3aa40b0f]](https://git.sudo.ws/sudo/commit/?id=a3aa40b0f)

* compat/getaddrinfo.c:

  Include arpa/inet.h for HP-UX; from Daniel Richard G.
  [[9d9d8e852]](https://git.sudo.ws/sudo/commit/?id=9d9d8e852)

* doc/Makefile.in:

  Add missing $(mansrcdir) to visudo.mdoc and visudo.man. From Daniel
  Richard G.
  [[89c162ec6]](https://git.sudo.ws/sudo/commit/?id=89c162ec6)

2013-11-11 Todd C. Miller

* include/fatal.h:

  In v{warning,fatal}x?() make a new copy of ap for the debug functions.
  It is not legal to use ap twice without reinitializing it. Noticed by
  Daniel Richard G.
  [[237ae0b77]](https://git.sudo.ws/sudo/commit/?id=237ae0b77)

* include/fatal.h:

  Remove errant warning\_restore\_locale() call.
  [[31e83c3e7]](https://git.sudo.ws/sudo/commit/?id=31e83c3e7)

* include/missing.h, plugins/sudoers/logging.c:

  Move va\_copy compat macro to missing.h
  [[702ec173d]](https://git.sudo.ws/sudo/commit/?id=702ec173d)

* common/Makefile.in, compat/Makefile.in, mkdep.pl,
  plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in, zlib/Makefile.in:

  Uniquify header dependencies so we don’t end up with duplicates when a
  header file includes other headers. The header dependencies are sorted
  so the generated order is stable.
  [[87e1ae76a]](https://git.sudo.ws/sudo/commit/?id=87e1ae76a)

* compat/Makefile.in, configure, configure.in, doc/CONTRIBUTORS, mkdep.pl:
  Add getaddrinfo.lo to LTLIBOBJS for systems that need it. From Daniel
  Richard G.
  [[88a57822e]](https://git.sudo.ws/sudo/commit/?id=88a57822e)

* plugins/sudoers/testsudoers.c:

  Fix pasto
  [[906eba927]](https://git.sudo.ws/sudo/commit/?id=906eba927)

2013-11-07 Todd C. Miller

* doc/sudoers.mdoc.in:

  Fix typo.
  [[a69ed4a2d]](https://git.sudo.ws/sudo/commit/?id=a69ed4a2d)

2013-11-04 Todd C. Miller

* plugins/sudoers/getdate.c, plugins/sudoers/gram.c:

  regen
  [[e8dac0e4a]](https://git.sudo.ws/sudo/commit/?id=e8dac0e4a)

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/toke.c:

  Fix warnings from -Wold-style-definition
  [[8e503a229]](https://git.sudo.ws/sudo/commit/?id=8e503a229)

* configure, configure.in:

  Add -Wold-style-definition to –enable-warnings
  [[3b65249bd]](https://git.sudo.ws/sudo/commit/?id=3b65249bd)

* common/event\_poll.c:

  Extra debugging for ready fds.
  [[b616a0431]](https://git.sudo.ws/sudo/commit/?id=b616a0431)

* common/event\_select.c:

  When deleting an event, check ev->events to determine whether to remove
  from readfds or writefds instead of blinding removing from both. Also
  fix highfd adjustment.
  [[60d58f3a6]](https://git.sudo.ws/sudo/commit/?id=60d58f3a6)

2013-11-02 Todd C. Miller

* common/event\_select.c:

  Only check an fd that is >= 0. Timeout-only events may have a negative
  fd.
  [[0eb38a228]](https://git.sudo.ws/sudo/commit/?id=0eb38a228)

2013-11-01 Todd C. Miller

* common/event.c:

  Don’t call sudo\_ev\_{add,del}\_impl() for timeout-only events. This makes
  it possible to pass sudo\_ev\_alloc() an fd of -1 for events only use
  SUDO\_EV\_TIMEOUT.
  [[1a548a5dd]](https://git.sudo.ws/sudo/commit/?id=1a548a5dd)

2013-10-31 Todd C. Miller

* common/alloc.c, common/event\_select.c, include/sudo\_event.h:

  Make a copy of readfds/writefds before calling select() instead of
  calculating it each time. Keep track of high fd in the base.
  [[adef363d0]](https://git.sudo.ws/sudo/commit/?id=adef363d0)

2013-10-30 Todd C. Miller

* doc/CONTRIBUTORS:

  Add Stephen Gelman
  [[7af8c3484]](https://git.sudo.ws/sudo/commit/?id=7af8c3484)

* plugins/sudoers/getdate.c, plugins/sudoers/gram.c:

  Fix sign comparison warning.
  [[1202e54cd]](https://git.sudo.ws/sudo/commit/?id=1202e54cd)

* plugins/sudoers/sudoreplay.c:

  Fix potential NULL dereference in non-interactive mode.
  [[9f761dc44]](https://git.sudo.ws/sudo/commit/?id=9f761dc44)

2013-10-29 Todd C. Miller

* src/exec.c, src/exec\_pty.c:

  Use MSG\_WAITALL when receiving struct command\_status over the Unix
  domain socket since we no longer use datagrams. This should avoid the
  need to handle incomplete reads, though in theory it is still possible.
  [[fd88ed42c]](https://git.sudo.ws/sudo/commit/?id=fd88ed42c)

* plugins/sudoers/sudoreplay.c:

  SIGKILL is not catchable
  [[abe0314e0]](https://git.sudo.ws/sudo/commit/?id=abe0314e0)

* common/event.c, include/sudo\_event.h, plugins/sudoers/sudoreplay.c:

  Add sudo\_ev\_get\_timeleft() to get the amount of time left before an
  event times out and use it in sudoreplay.
  [[449c4a290]](https://git.sudo.ws/sudo/commit/?id=449c4a290)

2013-10-28 Todd C. Miller

* doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in,
  plugins/sudoers/sudoreplay.c:

  If the user presses <return> or <enter> in sudoreplay, skip to the
  next event. Useful for skipping past long pauses in the data.
  [[f4cd08ef6]](https://git.sudo.ws/sudo/commit/?id=f4cd08ef6)

* common/event.c, common/event\_poll.c, common/event\_select.c:

  Fix sudo\_ev\_scan\_impl() return value in event\_poll.c. Make sure we clear
  active flag from unprocessed events if sudo\_ev\_loopbreak() or
  sudo\_ev\_loopcontinue() are used. Remove bogus optimization when the
  timeout is zero or negative; it could prevent an I/O event from being
  triggered.
  [[1bc2901a2]](https://git.sudo.ws/sudo/commit/?id=1bc2901a2)

* plugins/sudoers/sudoreplay.c:

  Move session replay into its own function.
  [[b8f5d3edf]](https://git.sudo.ws/sudo/commit/?id=b8f5d3edf)

* common/event.c, common/event\_poll.c, common/event\_select.c,
  include/sudo\_event.h:

  Get rid of cur and pending pointers in struct sudo\_event\_base. We now
  pop the first event off the active queue instead of using a foreach loop
  with deferred removal of the event. Add SUDO\_EVQ\_INSERTED and
  SUDO\_EVQ\_TIMEOUTS flags to indicate that the event on the event queue
  and timeouts queue respectively. No longer need to compare the timeout
  to {0,0} or compare the event’s base pointer to NULL to determine queue
  membership.
  [[4d1f91274]](https://git.sudo.ws/sudo/commit/?id=4d1f91274)

* common/event\_poll.c:

  rename sudo\_ev\_loop\_impl() -> sudo\_ev\_scan\_impl()
  [[4413f89bd]](https://git.sudo.ws/sudo/commit/?id=4413f89bd)

* MANIFEST, common/event.c, common/event\_poll.c, common/event\_select.c,
  compat/Makefile.in, compat/nanosleep.c, config.h.in, configure,
  configure.in, include/missing.h, include/sudo\_event.h, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/sudoreplay.c, src/exec.c,
  src/exec\_pty.c:

  Add support for libevent-style timed events. Adding a timed event is
  currently O(n). The only consumer of timed events is sudoreplay which
  only used a singled one so O(n) == O(1) for now. This also allows us to
  remove the nanosleep compat function as we now use a timeout event
  instead.
  [[8861e01d1]](https://git.sudo.ws/sudo/commit/?id=8861e01d1)

2013-10-26 Todd C. Miller

* src/exec.c, src/exec\_pty.c:

  Now that sudo\_ev\_base\_free() removes all events before freeing we don’t
  need to do this by hand.
  [[d8b368b50]](https://git.sudo.ws/sudo/commit/?id=d8b368b50)

* common/event.c, common/event\_poll.c, common/event\_select.c,
  include/sudo\_event.h:

  Add a list of active events in the base that the back end sets when it
  calls poll or select. This allows the front end to iterate over the
  events instead of having that code in both back ends. It will also
  simplify support for timeout events. Also make sure we can’t touch freed
  memory if a callback frees its own event.
  [[e16c99cd2]](https://git.sudo.ws/sudo/commit/?id=e16c99cd2)

* common/event.c:

  Remove any existing events before freeing the event base.
  [[f68ca0168]](https://git.sudo.ws/sudo/commit/?id=f68ca0168)

2013-10-25 Todd C. Miller

* src/exec\_pty.c:

  mon\_handler() should be static
  [[60d20f1e6]](https://git.sudo.ws/sudo/commit/?id=60d20f1e6)

2013-10-24 Todd C. Miller

* plugins/sudoers/ldap.c:

  If user specified start\_tls and ldaps, display a warning and ignore
  start\_tls. There’s no reason to make this a fatal error.
  [[e2bfbe603]](https://git.sudo.ws/sudo/commit/?id=e2bfbe603)

* src/exec\_pty.c:

  Add missing else when the connection from the monitor to the parent sudo
  process is broken (due to the parent dying). Prevents a spurious
  “unexpected reply type on backchannel” warning.
  [[07e0a068d]](https://git.sudo.ws/sudo/commit/?id=07e0a068d)

* src/exec\_pty.c:

  When flushing output we don’t care whether we are the foreground process
  or not, we still need to flush to /dev/tty. If we are in the background,
  it is OK to get SIGTTOU.
  [[a090d0678]](https://git.sudo.ws/sudo/commit/?id=a090d0678)

* plugins/sudoers/ldap.c:

  Should not attempt start\_tls on an ldaps connection.
  [[38a5b0a65]](https://git.sudo.ws/sudo/commit/?id=38a5b0a65)

2013-10-23 Todd C. Miller

* plugins/sudoers/regress/parser/check\_fill.c:

  Fix sign compare warning.
  [[548efb83d]](https://git.sudo.ws/sudo/commit/?id=548efb83d)

* doc/Makefile.in:

  Eliminate warning about circular dependency from GNU make.
  [[8dfe0b605]](https://git.sudo.ws/sudo/commit/?id=8dfe0b605)

* plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.c, src/ttyname.c:

  More sign compare fixes. On Solaris id\_t is signed so use uid\_t in the
  set\_perms.c ID macro instead.
  [[081742958]](https://git.sudo.ws/sudo/commit/?id=081742958)

* common/fileops.c, common/lbuf.c, common/secure\_path.c,
  common/sudo\_debug.c, include/secure\_path.h, plugins/sudoers/find\_path.c,
  plugins/sudoers/getdate.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/interfaces.h, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/ldap.c,
  plugins/sudoers/logging.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/parse.h, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/timestamp.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/toke\_util.c, src/load\_plugins.c,
  src/sudo.c, src/ttyname.c:

  Quiet sign comparision warnings.
  [[07a804caf]](https://git.sudo.ws/sudo/commit/?id=07a804caf)

* configure, configure.in:

  Add -Wsign-compare to –enable-warnings
  [[f4d2978f3]](https://git.sudo.ws/sudo/commit/?id=f4d2978f3)

* plugins/sudoers/ldap.c:

  Ignore SIGPIPE when connecting to the LDAP server so we can get a proper
  error message with the IBM LDAP libs. Also return LDAP\_SUCCESS instead
  of 0 from most sudo\_ldap\_\* functions that return an int.
  [[994879c04]](https://git.sudo.ws/sudo/commit/?id=994879c04)

* plugins/sudoers/regress/parser/check\_base64.c,
  plugins/sudoers/regress/parser/check\_digest.c:

  Quiet compiler warnings.
  [[340fc0a58]](https://git.sudo.ws/sudo/commit/?id=340fc0a58)

2013-10-22 Todd C. Miller

* plugins/sudoers/ldap.c:

  sudo\_ldap\_parse\_uri() should join multiple URIs in the string list
  together but it was clearing the host entry each time through the loop.
  Fixes a bug with multiple URI entries in ldap.conf where only the last
  one was being honored.
  [[29361ec00]](https://git.sudo.ws/sudo/commit/?id=29361ec00)

* src/exec\_pty.c:

  Avoid a double free introduced when plugging a memory leak in
  safe\_close(). A new ev\_free\_by\_fd() function is used to remove and free
  any events sharing the specified fd. This can be used after safe\_close()
  to make sure we don’t try to select() on a closed fd.
  [[d825a5894]](https://git.sudo.ws/sudo/commit/?id=d825a5894)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, src/exec.c:

  Quiet some llvm check false positives. The common idiom of using
  TAILQ\_FIRST, TAILQ\_REMOVE and free in a loop to free each entry in a
  TAILQ confuses llvm. Use TAILQ\_FOREACH\_SAFE instead (which is probably
  faster anyway).
  [[e8ce021e7]](https://git.sudo.ws/sudo/commit/?id=e8ce021e7)

* plugins/sudoers/auth/pam.c:

  If pam\_open\_session() fails don’t call pam\_getenvlist() with a NULL pam
  handle.
  [[65c6f34aa]](https://git.sudo.ws/sudo/commit/?id=65c6f34aa)

* plugins/sudoers/defaults.c:

  Fix newly introduced use after frees found by llvm checker.
  [[798e82bd6]](https://git.sudo.ws/sudo/commit/?id=798e82bd6)

* common/event\_select.c:

  Remove an errant list\_next() call that should have been removed in the
  TAILQ conversion.
  [[b2cba8368]](https://git.sudo.ws/sudo/commit/?id=b2cba8368)

* MANIFEST, common/Makefile.in, common/list.c,
  common/regress/tailq/hltq\_test.c, include/list.h, include/queue.h,
  plugins/sudoers/Makefile.in, plugins/sudoers/alias.c,
  plugins/sudoers/defaults.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/match.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Add “headless” tail queues and use them in place of the semi-circular
  lists in sudoers. Once the headless tail queue is built up it is
  converted to a normal TAILQ. This removes the last consumer of list.c
  and list.h so those can now be removed.
  [[b38d253e9]](https://git.sudo.ws/sudo/commit/?id=b38d253e9)

* common/Makefile.in, common/fatal.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/env.c, plugins/sudoers/interfaces.c,
  plugins/sudoers/interfaces.h, plugins/sudoers/ldap.c,
  plugins/sudoers/match\_addr.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/visudo.c, src/Makefile.in, src/exec\_pty.c, src/hooks.c:

  Use SLIST and STAILQ macros instead of doing headless singly linked
  lists manually. As a bonus we now use a tail queue for ldap.c and
  sudoreplay.c.
  [[f85106ea6]](https://git.sudo.ws/sudo/commit/?id=f85106ea6)

* MANIFEST, common/Makefile.in, common/event.c, common/event\_poll.c,
  common/event\_select.c, common/list.c,
  common/regress/sudo\_conf/conf\_test.c, common/sudo\_conf.c, doc/LICENSE,
  include/list.h, include/missing.h, include/queue.h, include/sudo\_conf.h,
  include/sudo\_event.h, plugins/sudoers/Makefile.in,
  plugins/sudoers/ldap.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudo\_nss.h,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/visudo.c, src/Makefile.in, src/exec.c, src/exec\_pty.c,
  src/load\_plugins.c, src/sudo.c, src/sudo.h, src/sudo\_plugin\_int.h:

  Convert sudo to use BSD TAILQ macros instead of home ground tail queue
  functions. This includes a private queue.h header derived from FreeBSD.
  It is simpler to just use our own header rather than try to deal with
  macros that may or may not be present in various queue.h incarnations.
  [[923edabe6]](https://git.sudo.ws/sudo/commit/?id=923edabe6)

2013-10-21 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Fix AND operator broken by changes to fix OR.
  [[fe0e953e9]](https://git.sudo.ws/sudo/commit/?id=fe0e953e9)

2013-10-19 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Fix OR operator.
  [[2c8d5add8]](https://git.sudo.ws/sudo/commit/?id=2c8d5add8)

2013-10-18 Todd C. Miller

* src/exec\_pty.c:

  Fix memory leak of I/O buffer events in safe\_close().
  [[04588f613]](https://git.sudo.ws/sudo/commit/?id=04588f613)

2013-10-16 Todd C. Miller

* common/sudo\_debug.c:

  Don’t allow the debug subsystem to be initialized twice. Otherwise we
  can exhuast our stack when built in static mode.
  [[69ab48f16]](https://git.sudo.ws/sudo/commit/?id=69ab48f16)

* common/event\_poll.c:

  Make sure we do not try to usie index -1 in base->pfds[].
  [[6a5d6f9e9]](https://git.sudo.ws/sudo/commit/?id=6a5d6f9e9)

2013-10-14 Todd C. Miller

* NEWS, configure, configure.in:

  Bump version to 1.8.9
  [[58f71c00e]](https://git.sudo.ws/sudo/commit/?id=58f71c00e)

2013-10-12 Todd C. Miller

* src/exec\_pty.c:

  Convert the monitor process to the event subsystem.
  [[b985948e7]](https://git.sudo.ws/sudo/commit/?id=b985948e7)

* src/exec.c, src/exec\_pty.c, src/sudo\_exec.h:

  Convert the main sudo event loop to use the event subsystem. Read events
  for I/O buffers are added before the loop starts. Write events are added
  on demand as the buffers are filled.
  [[83d2d25c4]](https://git.sudo.ws/sudo/commit/?id=83d2d25c4)

* INSTALL, MANIFEST, common/Makefile.in, common/event.c,
  common/event\_poll.c, common/event\_select.c, common/list.c,
  common/sudo\_debug.c, config.h.in, configure, configure.in,
  include/list.h, include/sudo\_debug.h, include/sudo\_event.h, mkdep.pl,
  plugins/sudoers/Makefile.in, src/Makefile.in, src/exec\_pty.c:

  Simple event subsystem that uses poll() or select(). Basically a
  simplied subset of libevent2. Currently only fd events are supported
  (since that’s all we need). The poll() backend is used by default,
  except on Mac OS X where poll() is broken for devices (including
  /dev/tty and ptys).
  [[79acd5db4]](https://git.sudo.ws/sudo/commit/?id=79acd5db4)

* src/exec.c, src/exec\_pty.c:

  Use SOCK\_STREAM for socketpair, not SOCK\_DGRAM so we get consistent
  semantics when the other end closes. This should make the conversion to
  poll() less problematic.
  [[ff18c6586]](https://git.sudo.ws/sudo/commit/?id=ff18c6586)

2013-10-06 Todd C. Miller

* common/sudo\_debug.c:

  Fix removal of trailing newlines in a debug message.
  [[a6b4f4110]](https://git.sudo.ws/sudo/commit/?id=a6b4f4110)

2013-10-04 Todd C. Miller

* plugins/sudoers/visudo.c:

  When checking for unused Runas\_Aliases, count those used as part of a
  Runas Group too. Fixes a false positive warning.
  [[020fb0094]](https://git.sudo.ws/sudo/commit/?id=020fb0094)

2013-09-29 Todd C. Miller

* include/missing.h:

  Include stddef.h for rsize\_t and errno\_t on systems that support it
  natively.
  [[e223df690]](https://git.sudo.ws/sudo/commit/?id=e223df690)

* MANIFEST:

  Fix braino.
  [[48d7c407e]](https://git.sudo.ws/sudo/commit/?id=48d7c407e)

* plugins/sudoers/po/da.mo, plugins/sudoers/po/de.mo,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/fi.mo,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/pl.mo,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/uk.mo,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/zh\_CN.mo:

  Rebuild message catalog files.
  [[fc332461e]](https://git.sudo.ws/sudo/commit/?id=fc332461e)

* src/po/da.mo, src/po/eo.mo, src/po/fi.mo, src/po/it.mo, src/po/pl.mo,
  src/po/pt\_BR.mo, src/po/ru.mo, src/po/uk.mo, src/po/vi.mo,
  src/po/zh\_CN.mo:

  Rebuild message catalog files.
  [[4b5021fed]](https://git.sudo.ws/sudo/commit/?id=4b5021fed)

* MANIFEST, NEWS, doc/CONTRIBUTORS, src/po/cs.mo, src/po/cs.po:

  Czech translation for sudo from translationproject.org.
  [[aff3320f3]](https://git.sudo.ws/sudo/commit/?id=aff3320f3)

2013-09-18 Todd C. Miller

* plugins/sudoers/po/da.po, plugins/sudoers/po/de.po,
  plugins/sudoers/po/eo.po, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/it.po, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.po, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.po, plugins/sudoers/po/zh\_CN.po, src/po/da.po,
  src/po/eo.po, src/po/fi.po, src/po/it.po, src/po/pl.po, src/po/pt\_BR.po,
  src/po/ru.po, src/po/uk.po, src/po/vi.po, src/po/zh\_CN.po:

  Sync with translationproject.org
  [[4b10880f8]](https://git.sudo.ws/sudo/commit/?id=4b10880f8)

* NEWS, plugins/sudoers/getdate.c, plugins/sudoers/getdate.y:

  Change “next” back to 2. In the context of “next Friday” we really do
  want the friday of the upcoming (not current) week. Unfortunately, this
  means that things like “next week” and “next year” will match one more
  than we really want. Fixing this will require some fairly major changes
  to the grammar.
  [[9a657e884]](https://git.sudo.ws/sudo/commit/?id=9a657e884)

* doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in:

  Mention that relative times don’t always do what you might expect.
  [[d197e42d4]](https://git.sudo.ws/sudo/commit/?id=d197e42d4)

2013-09-17 Todd C. Miller

* doc/CONTRIBUTORS:

  Add diacritical for Zdenek Behan.
  [[e6833bed7]](https://git.sudo.ws/sudo/commit/?id=e6833bed7)

2013-09-11 Todd C. Miller

* src/regress/ttyname/check\_ttyname.c:

  Do not fail if ttyname() cannot determine the tty but sudo can. Should
  fix problems with running “make check” under pbuilder.
  [[c91c5343e]](https://git.sudo.ws/sudo/commit/?id=c91c5343e)

* plugins/sudoers/Makefile.in:

  Remove extraneous $$CWD; from Bdale Garbee
  [[5d56fd5f8]](https://git.sudo.ws/sudo/commit/?id=5d56fd5f8)

2013-09-09 Todd C. Miller

* NEWS, plugins/sudoers/getdate.c, plugins/sudoers/getdate.y:

  Make “this” and “next” qualifiers work a bit better. There is still room
  for improvement as “this week” will use the current time instead of the
  beginning of the week. That’s a separate issue though.
  [[e59d5624d]](https://git.sudo.ws/sudo/commit/?id=e59d5624d)

2013-09-06 Todd C. Miller

* common/regress/sudo\_conf/conf\_test.c,
  common/regress/sudo\_parseln/parseln\_test.c:

  Mark main() public to silence a warning on HP-UX.
  [[4fbcde304]](https://git.sudo.ws/sudo/commit/?id=4fbcde304)

2013-09-03 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, plugins/sudoers/timestamp.c:

  Be specific that we are talking about the Unix epoch; bug #615
  [[bd5286905]](https://git.sudo.ws/sudo/commit/?id=bd5286905)

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/po/sudoers.pot,
  src/po/sudo.pot, src/selinux.c:

  Do not use “setup” as a verb; bug #614
  [[6b0a909d9]](https://git.sudo.ws/sudo/commit/?id=6b0a909d9)

* plugins/sudoers/iolog.c:

  Fix logic goof when checking open() status.
  [[6b57ef4f6]](https://git.sudo.ws/sudo/commit/?id=6b57ef4f6)

* plugins/sudoers/po/nl.mo, plugins/sudoers/po/nl.po, src/po/nl.mo,
  src/po/nl.po, src/po/ru.mo, src/po/ru.po:

  Sync with translationproject.org
  [[13fd13e17]](https://git.sudo.ws/sudo/commit/?id=13fd13e17)

* NEWS, plugins/sudoers/sudoreplay.c:

  Work around a bug in sudo 1.8.7 timing files where the indexes are off
  by two.
  [[b2d0bdee2]](https://git.sudo.ws/sudo/commit/?id=b2d0bdee2)

* MANIFEST, plugins/sudoers/iolog.c, plugins/sudoers/iolog.h,
  plugins/sudoers/sudoreplay.c:

  Repair writing of the I/O log file indices broken in sudo 1.8.7.
  [[422115d72]](https://git.sudo.ws/sudo/commit/?id=422115d72)

2013-08-31 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Try to improve the PAGERS noexec example a bit.
  [[92a3e13e6]](https://git.sudo.ws/sudo/commit/?id=92a3e13e6)

2013-08-30 Todd C. Miller

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  Document comment character in ldap.conf Clarify what is and is not
  supported in TLS\_KEYPW Mention that gsk8capicmd can be used to create a
  stash file
  [[55ea043a9]](https://git.sudo.ws/sudo/commit/?id=55ea043a9)

2013-08-26 Todd C. Miller

* NEWS:

  New bugs fixed for 1.8.8.
  [[596d94dc6]](https://git.sudo.ws/sudo/commit/?id=596d94dc6)

* plugins/sudoers/visudo.c:

  Fix setting of quiet flag when -q / –quiet is specified. Do not print
  “sudoers: parsed OK” in quiet mode.
  [[de566ac2c]](https://git.sudo.ws/sudo/commit/?id=de566ac2c)

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po, src/po/fi.mo,
  src/po/fi.po, src/po/it.mo, src/po/it.po:

  Updated translations from translationproject.org
  [[316fe3612]](https://git.sudo.ws/sudo/commit/?id=316fe3612)

* plugins/sudoers/check.c:

  Don’t allow root to change its SELinux role without a password. [Bug
  #611](https://bugzilla.sudo.ws/show_bug.cgi?id=611)
  [[3389108f1]](https://git.sudo.ws/sudo/commit/?id=3389108f1)

2013-08-21 Todd C. Miller

* NEWS:

  Mention new Mac OS X symbol interposition.
  [[95d41437d]](https://git.sudo.ws/sudo/commit/?id=95d41437d)

* plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po, src/po/eo.mo,
  src/po/eo.po, src/po/fr.mo, src/po/fr.po:

  Updated translations from translationproject.org
  [[6d1ee8cf2]](https://git.sudo.ws/sudo/commit/?id=6d1ee8cf2)

* config.h.in, configure, configure.in, src/sudo\_noexec.c:

  Add configure checks for the exec functions we will dummy out. This is
  only really needed on Mac OS X when symbol interposition is being
  performed but won’t hurt elsewhere.
  [[40b24c5da]](https://git.sudo.ws/sudo/commit/?id=40b24c5da)

2013-08-20 Todd C. Miller

* config.h.in, configure, configure.in, src/Makefile.in,
  src/sudo\_noexec.c:

  Fix installation of sudo\_noexec on Mac OS X. Use library symbol
  interposition on Mac OS X 10.4 and higher so we don’t need to set
  DYLD\_FORCE\_FLAT\_NAMESPACE=1.
  [[b0f5c498f]](https://git.sudo.ws/sudo/commit/?id=b0f5c498f)

2013-08-17 Todd C. Miller

* plugins/sudoers/ldap.c:

  Fix error display from ldap\_ssl\_client\_init(). There are two error
  codes. The return value can be decoded via ldap\_err2string() but the ssl
  reason code cannot (you have to look it up in a table online).
  [[925984d88]](https://git.sudo.ws/sudo/commit/?id=925984d88)

2013-08-19 Todd C. Miller

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  Fix typo in tls\_key example for Tivoli
  [[dbdd328f4]](https://git.sudo.ws/sudo/commit/?id=dbdd328f4)

* src/parse\_args.c:

  Don’t escape ‘$’ when running “sudo -i command”. [Bug
  #564](https://bugzilla.sudo.ws/show_bug.cgi?id=564)
  [[6484574f9]](https://git.sudo.ws/sudo/commit/?id=6484574f9)

* plugins/sudoers/iolog\_path.c:

  Fix typo in comment.
  [[e507c05bb]](https://git.sudo.ws/sudo/commit/?id=e507c05bb)

* plugins/sudoers/auth/pam.c:

  Fix comment.
  [[e54f11ae4]](https://git.sudo.ws/sudo/commit/?id=e54f11ae4)

* plugins/sudoers/timestr.c, plugins/sudoers/visudo.c:

  Quiet some gcc -Wformat=2 false positives
  [[bd589f234]](https://git.sudo.ws/sudo/commit/?id=bd589f234)

2013-08-18 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  Remove now-obsolete arg to env\_merge()
  [[ebbdee421]](https://git.sudo.ws/sudo/commit/?id=ebbdee421)

* plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/pt\_BR.mo, plugins/sudoers/po/pt\_BR.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, src/po/pl.mo,
  src/po/pl.po, src/po/pt\_BR.mo, src/po/pt\_BR.po, src/po/uk.mo,
  src/po/uk.po, src/po/vi.mo, src/po/vi.po, src/po/zh\_CN.mo,
  src/po/zh\_CN.po:

  Updated translations from translationproject.org
  [[ffef732ac]](https://git.sudo.ws/sudo/commit/?id=ffef732ac)

* MANIFEST, NEWS, doc/CONTRIBUTORS, src/po/fr.mo, src/po/fr.po:

  French translation for sudo from translationproject.org.
  [[1624e8987]](https://git.sudo.ws/sudo/commit/?id=1624e8987)

* plugins/sudoers/logging.h:

  Add \_\_printflike to audit\_failure.
  [[0f091f478]](https://git.sudo.ws/sudo/commit/?id=0f091f478)

* include/missing.h:

  Use **nonnull** attribute in \_\_printflike.
  [[5caa61d68]](https://git.sudo.ws/sudo/commit/?id=5caa61d68)

2013-08-17 Todd C. Miller

* plugins/sudoers/env.c, plugins/sudoers/sudoers.h:

  When merging the PAM environment, allow environment variables set in PAM
  to override ones set by sudo as long as they do not match the env\_keep
  or env\_check lists.
  [[7a76844d9]](https://git.sudo.ws/sudo/commit/?id=7a76844d9)

* plugins/sudoers/auth/pam.c:

  Call pam\_getenvlist() after we’ve opened the session to get the
  session-specific environment variables.
  [[f72f47aa1]](https://git.sudo.ws/sudo/commit/?id=f72f47aa1)

2013-08-16 Todd C. Miller

* NEWS:

  option not flag
  [[1a652757c]](https://git.sudo.ws/sudo/commit/?id=1a652757c)

* compat/getopt\_long.c, config.h.in, configure, configure.in:

  Don’t redefine opterr, optind, optopt, optarg in getopt\_long.c. Add a
  check for optreset which is a BSD extension and provide a definition in
  getopt\_long.c if it is not present.
  [[3c2a9b994]](https://git.sudo.ws/sudo/commit/?id=3c2a9b994)

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  regen
  [[082c73338]](https://git.sudo.ws/sudo/commit/?id=082c73338)

* plugins/sudoers/sudoreplay.c, plugins/sudoers/visudo.c:

  Use lower case for the long option arguments to match the manual. This
  is inconsistent with GNU but it is better to match the sudo
  documentation.
  [[acac6ae2a]](https://git.sudo.ws/sudo/commit/?id=acac6ae2a)

* NEWS:

  Sudo 1.8.8
  [[752418ffe]](https://git.sudo.ws/sudo/commit/?id=752418ffe)

* src/parse\_args.c:

  Use lower card for the long option arguments to match the manual. This
  is inconsistent with GNU but it is better to match the sudo
  documentation.
  [[a5b64a1d2]](https://git.sudo.ws/sudo/commit/?id=a5b64a1d2)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Describe how remote command execution can be implemented.
  [[87ec2dd6e]](https://git.sudo.ws/sudo/commit/?id=87ec2dd6e)

* doc/sudoers.ldap.cat:

  Bump version.
  [[f76bd772e]](https://git.sudo.ws/sudo/commit/?id=f76bd772e)

2013-08-15 Todd C. Miller

* src/sudo.c:

  Make it a fatal error if the plugin returns invalid or out of range
  command info.
  [[d40b30284]](https://git.sudo.ws/sudo/commit/?id=d40b30284)

* plugins/sudoers/policy.c:

  Use strtol() instead of atoi() and perform error checking of parameters
  passed from the sudo front-end.
  [[b8d539984]](https://git.sudo.ws/sudo/commit/?id=b8d539984)

* plugins/sudoers/auth/pam.c:

  It is not possible for auth to be NULL here.
  [[91ec1c476]](https://git.sudo.ws/sudo/commit/?id=91ec1c476)

* plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Initialize user\_runhost and user\_srunhost to user\_host and user\_shost in
  visudo and testsudoers.
  [[ea65c82b6]](https://git.sudo.ws/sudo/commit/?id=ea65c82b6)

* MANIFEST, common/Makefile.in, common/aix.c, common/alloc.c,
  common/fatal.c, common/gidlist.c, common/lbuf.c, common/list.c,
  common/sudo\_conf.c, common/sudo\_debug.c, compat/Makefile.in,
  compat/getopt\_long.c, include/fatal.h, plugins/sudoers/Makefile.in,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/hexchar.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/locale.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/logging/check\_wrap.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c, src/Makefile.in, src/locale\_stub.c,
  src/net\_ifs.c, src/regress/ttyname/check\_ttyname.c, src/sesh.c,
  src/sudo.h:

  Rename error.h -> fatal.h now that there is no error() function.
  [[99352d673]](https://git.sudo.ws/sudo/commit/?id=99352d673)

* common/sudo\_debug.c, include/sudo\_debug.h:

  Add support to the debug subsystem for zero-length strings. This can
  happen for things like warning(NULL) or fatal(NULL) where we just want
  to log the errno string.
  [[bec394dc1]](https://git.sudo.ws/sudo/commit/?id=bec394dc1)

* include/error.h:

  Add \_\_printflike for vfatal, vfatalx, vwarning and vwarningx.
  [[a44d82763]](https://git.sudo.ws/sudo/commit/?id=a44d82763)

* plugins/sudoers/audit.c:

  Need to include gettext.h for BSM audit.
  [[1b39c3758]](https://git.sudo.ws/sudo/commit/?id=1b39c3758)

* common/alloc.c, plugins/sudoers/env.c, src/exec\_common.c,
  src/parse\_args.c, src/sudo.c:

  Change some fatalx(NULL) that should be fatal(NULL).
  [[85fc5792d]](https://git.sudo.ws/sudo/commit/?id=85fc5792d)

* include/error.h, include/missing.h:

  Use \_\_printf0like for warning() and fatal() since the fmt string may be
  NULL.
  [[4928c8c72]](https://git.sudo.ws/sudo/commit/?id=4928c8c72)

* compat/pw\_dup.c:

  Quiet a gcc “used uninitialized in this function” false positive.
  [[e5f0e1f75]](https://git.sudo.ws/sudo/commit/?id=e5f0e1f75)

* mkpkg:

  Enable bsm audit on Mac OS X and Solaris >= 11.
  [[e34fe030b]](https://git.sudo.ws/sudo/commit/?id=e34fe030b)

* plugins/sudoers/bsm\_audit.c:

  Fix compilation on Solaris 11.
  [[2f251caf4]](https://git.sudo.ws/sudo/commit/?id=2f251caf4)

* plugins/sudoers/bsm\_audit.c:

  Add missing missing.h
  [[251c79a77]](https://git.sudo.ws/sudo/commit/?id=251c79a77)

* plugins/sudoers/sudoers.c:

  Move the -C (user\_closefrom) check until after set\_cmnd() so that
  closefrom\_override can be used in a command-specific Defaults line.
  Fixes bug #610 from Mengtao Sun.
  [[c376c7161]](https://git.sudo.ws/sudo/commit/?id=c376c7161)

2013-08-14 Todd C. Miller

* src/exec.c:

  If not using a pty and the child process gets SIGTTOU or SIGTTIN and
  sudo is the foreground process, make the child the foreground process
  and continue it.
  [[299a881fe]](https://git.sudo.ws/sudo/commit/?id=299a881fe)

* src/sudo.c:

  If sudo is not setuid and was not invoked with a full path, look in the
  user’s PATH for the sudo binary to give a better error message.
  [[c909f6100]](https://git.sudo.ws/sudo/commit/?id=c909f6100)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in,
  plugins/sudoers/logging.c, plugins/sudoers/match.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudoers.h:

  Add limited support for “sudo -l -h other\_host”. Since group lookups are
  done on the local host, rules that use group membership may be incorrect
  if the group database is not synchronized between hosts.
  [[d0e386758]](https://git.sudo.ws/sudo/commit/?id=d0e386758)

* src/parse\_args.c:

  Fix parsing of “-h host” when used in conjunction with the -l flag.
  [[79104ce75]](https://git.sudo.ws/sudo/commit/?id=79104ce75)

* configure, configure.in, doc/fixman.sh, doc/fixmdoc.sh, doc/sudo.cat,
  doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoreplay.cat,
  doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in, doc/visudo.cat,
  doc/visudo.man.in, doc/visudo.mdoc.in, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/visudo.c, src/parse\_args.c, src/sudo.c,
  src/sudo\_usage.h.in:

  Simplify usage messages a bit and make –help output more closely
  resemble GNU usage wrt long options. Sync usage and man page SYNOPSYS
  sections and improve long options in the manual pages. Now that we have
  long options we don’t need to give the mnemonic for the single-character
  options in the description.
  [[8b1d64553]](https://git.sudo.ws/sudo/commit/?id=8b1d64553)

2013-08-13 Todd C. Miller

* plugins/sudoers/logging.c:

  Fix setting of mailer argv[0] to basename of mailerpath. No need to
  strdup() mailerpath as it is not modified.
  [[91e66c481]](https://git.sudo.ws/sudo/commit/?id=91e66c481)

* plugins/sudoers/logging.c:

  Make sure the mailer exists and is a regular file before trying to exec
  it.
  [[04b290e38]](https://git.sudo.ws/sudo/commit/?id=04b290e38)

* plugins/sudoers/timestamp.c:

  If tty\_tickets are enabled but there is no tty, use a ticket file based
  on the parent pid.
  [[39d630f2f]](https://git.sudo.ws/sudo/commit/?id=39d630f2f)

* common/sudo\_conf.c, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, include/sudo\_conf.h, src/parse\_args.c:

  Allow default plugin dir to be configured in sudo.conf.
  [[d9fd6281e]](https://git.sudo.ws/sudo/commit/?id=d9fd6281e)

* doc/CONTRIBUTORS:

  UTF8 for Ruusamae, Elan; from Tae Wong
  [[d10641cdb]](https://git.sudo.ws/sudo/commit/?id=d10641cdb)

2013-08-12 Todd C. Miller

* MANIFEST, common/regress/sudo\_conf/test5.in,
  common/regress/sudo\_conf/test5.out.ok,
  common/regress/sudo\_conf/test6.in,
  common/regress/sudo\_conf/test6.out.ok, common/sudo\_conf.c,
  doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in,
  plugins/sudoers/policy.c, plugins/sudoers/pwutil\_impl.c, src/sudo.c:

  Don’t allow max\_groups to be set to zero, it just complicates things
  needlessly. Fixes an assertion in visudo when there is a group-based
  Defaults entry.
  [[9b2fb418c]](https://git.sudo.ws/sudo/commit/?id=9b2fb418c)

2013-08-08 Todd C. Miller

* MANIFEST, common/Makefile.in, common/gidlist.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.h, src/sudo.c,
  src/sudo.h:

  Refactor code to parse list of gids into its own function that is shared
  by the sudo front-end and the sudoers module. Make uid/gid parse error
  be fatal, not just a warning.
  [[8b4fbc5cc]](https://git.sudo.ws/sudo/commit/?id=8b4fbc5cc)

* common/atoid.c:

  Add function comment block.
  [[6126c08f7]](https://git.sudo.ws/sudo/commit/?id=6126c08f7)

* common/atoid.c:

  Default text domain is now sudo, not sudoers.
  [[141f91e77]](https://git.sudo.ws/sudo/commit/?id=141f91e77)

* common/Makefile.in:

  Update dependency for atoid.lo
  [[5556a0f21]](https://git.sudo.ws/sudo/commit/?id=5556a0f21)

* common/atoid.c, plugins/sudoers/iolog.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/tsgetgrpw.c, src/sudo.c,
  src/sudo.h:

  Add endpointer and separator args to atoid()
  [[fe23e7c03]](https://git.sudo.ws/sudo/commit/?id=fe23e7c03)

2013-08-07 Todd C. Miller

* compat/getgrouplist.c:

  Use private version of atoid() to avoid a dependency on libcommon.a
  (since that already depends on libreplace.a).
  [[39cbfcd40]](https://git.sudo.ws/sudo/commit/?id=39cbfcd40)

* doc/CONTRIBUTORS:

  More UTF8 in names; from Tae Wong
  [[03fc668e5]](https://git.sudo.ws/sudo/commit/?id=03fc668e5)

* compat/getgrouplist.c, plugins/sudoers/iolog.c,
  plugins/sudoers/tsgetgrpw.c, src/sudo.c, src/sudo.h:

  Use atoid() in more places.
  [[dde7331a0]](https://git.sudo.ws/sudo/commit/?id=dde7331a0)

* MANIFEST, common/Makefile.in, common/atoid.c,
  plugins/sudoers/Makefile.in:

  Move atoid() to common so it can be used in src and compat too.
  [[40cb480f0]](https://git.sudo.ws/sudo/commit/?id=40cb480f0)

* compat/closefrom.c:

  Avoid a crash on Mac OS X 10.8 (at least) when we close libdispatch’s
  fds out from under it before executing the command. Switch to just
  setting the close on exec flag instead.
  [[2c6e68df0]](https://git.sudo.ws/sudo/commit/?id=2c6e68df0)

* doc/CONTRIBUTORS:

  Convert to last, first for easier sorting and use UTF8 (including a
  BOM).
  [[30adf33ea]](https://git.sudo.ws/sudo/commit/?id=30adf33ea)

* plugins/sudoers/atoid.c:

  Add atoid() function to convert a string to an id\_t (uid, gid or pid).
  We have to be careful to choose() either strtol() or strtoul() depending
  on whether the string appears to be signed or unsigned. Always using
  strtoul() is unsafe on 64-bit platforms since the uid might be
  represented as a negative number and (unsigned long)-1 on a 64-bit
  system is 0xffffffffffffffff not 0xffffffff. Fixes a problem with uids
  larger than 0x7fffffff on 32-bit platforms.
  [[c3fb47a88]](https://git.sudo.ws/sudo/commit/?id=c3fb47a88)

* MANIFEST, config.h.in, configure, configure.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h:

  Add atoid() function to convert a string to an id\_t (uid, gid or pid).
  We have to be careful to choose() either strtol() or strtoul() depending
  on whether the string appears to be signed or unsigned. Always using
  strtoul() is unsafe on 64-bit platforms since the uid might be
  represented as a negative number and (unsigned long)-1 on a 64-bit
  system is 0xffffffffffffffff not 0xffffffff. Fixes a problem with uids
  larger than 0x7fffffff on 32-bit platforms.
  [[5dc56ea81]](https://git.sudo.ws/sudo/commit/?id=5dc56ea81)

* plugins/sudoers/sudoers.c:

  Avoid “perm stack underflow” error when logging the unknown uid error.
  [[972ee9a0f]](https://git.sudo.ws/sudo/commit/?id=972ee9a0f)

* plugins/sudoers/set\_perms.c:

  In rewind\_perms() there is nothing to do if perm\_stack\_depth == 0.
  [[23a2bdbcb]](https://git.sudo.ws/sudo/commit/?id=23a2bdbcb)

2013-08-06 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/auth/pam.c, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in:

  Add pam\_setcred sudoers option to allow the user to control whether
  pam\_setcred() is called on the user’s behalf.
  [[3898f5d7f]](https://git.sudo.ws/sudo/commit/?id=3898f5d7f)

* configure, configure.in, doc/sudoers.cat, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, plugins/sudoers/auth/pam.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c:

  Add pam\_service and pam\_login\_service sudoers settings to control the
  service name passed to pam\_start.
  [[52954481e]](https://git.sudo.ws/sudo/commit/?id=52954481e)

* mkpkg:

  Newer Xcode places the SDKs under Xcode.app
  [[385e20c7b]](https://git.sudo.ws/sudo/commit/?id=385e20c7b)

2013-08-03 Todd C. Miller

* MANIFEST, common/Makefile.in, common/zero\_bytes.c, compat/Makefile.in,
  compat/memset\_s.c, config.h.in, configure, configure.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  include/missing.h, include/sudo\_plugin.h, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/defaults.c, plugins/sudoers/logging.c,
  plugins/sudoers/sha2.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/visudo.c, src/Makefile.in, src/conversation.c,
  src/sudo.h, src/sudo\_edit.c, src/tgetpass.c:

  Implement memset\_s() and use it instead of zero\_bytes(). A new constant,
  SUDO\_CONV\_REPL\_MAX, is defined by the plugin API as the max conversation
  reply length. This constant can be used as a max value for memset\_s()
  when clearing passwords filled in by the conversation function.
  [[1f3ea50af]](https://git.sudo.ws/sudo/commit/?id=1f3ea50af)

2013-08-01 Todd C. Miller

* plugins/group\_file/Makefile.in, plugins/sample/Makefile.in,
  plugins/system\_group/Makefile.in:

  Do not try to install plugins when shared modules are disabled (sudoers
  already had the check).
  [[8c867be41]](https://git.sudo.ws/sudo/commit/?id=8c867be41)

* plugins/sudoers/Makefile.in:

  Update dependencies to take into account compat/getopt.h and
  compat/dlfcn.h.
  [[d882303b8]](https://git.sudo.ws/sudo/commit/?id=d882303b8)

* src/Makefile.in:

  Update dependencies now that sudo\_usage.h is always included from the
  build dir.
  [[235d32c99]](https://git.sudo.ws/sudo/commit/?id=235d32c99)

2013-07-31 Todd C. Miller

* plugins/sudoers/ldap.c:

  Add some warnings and debugging to sasl ccname handling.
  [[62da46a9c]](https://git.sudo.ws/sudo/commit/?id=62da46a9c)

* plugins/sudoers/ldap.c:

  Fix write loop invariant in sudo\_krb5\_copy\_cc\_file()
  [[c0c782ae1]](https://git.sudo.ws/sudo/commit/?id=c0c782ae1)

2013-07-30 Todd C. Miller

* plugins/sudoers/ldap.c:

  Strip off leading FILE: or WRFILE: prefix before trying to copy the
  user’s credential cache.
  [[09e752274]](https://git.sudo.ws/sudo/commit/?id=09e752274)

2013-07-29 Todd C. Miller

* src/sudo.c:

  Instead of setting RLIMIT\_NPROC to unlimited when sudo initializes, just
  save RLIMIT\_NPROC in exec\_setup() before the final setuid() and restore
  it immediately after. We don’t need to modify RLIMIT\_NPROC for simple
  euid changes, just for changing the real (and saved) uids before we
  exec. This also means we no longer need to worry about \_SC\_CHILD\_MAX
  returning -1. [Bug #565](https://bugzilla.sudo.ws/show_bug.cgi?id=565)
  [[3582ad340]](https://git.sudo.ws/sudo/commit/?id=3582ad340)

2013-07-28 Todd C. Miller

* plugins/sudoers/ldap.c, src/preload.c:

  Now that the ldap code runs with the real and effective uid set to 0, it
  is not possible for the gssapi libs to find the user’s krb5 credential
  cache file. To work around this, we make a temporary copy of the user’s
  credential cache specified by KRB5CCNAME (opened with the user’s
  effective uid) and point gssapi to it. To set the credential cache file
  name, we dynamically look up gss\_krb5\_ccache\_name() and use it if
  available, otherwise fall back to setting KRB5CCNAME.
  [[b1c8f0575]](https://git.sudo.ws/sudo/commit/?id=b1c8f0575)

2013-07-19 Todd C. Miller

* doc/sudo.man.in, doc/sudoreplay.cat, doc/sudoreplay.man.in,
  doc/sudoreplay.mdoc.in, doc/visudo.cat, doc/visudo.man.in,
  doc/visudo.mdoc.in, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/visudo.c:

  Long option support for visudo and sudoreplay.
  [[39575aecf]](https://git.sudo.ws/sudo/commit/?id=39575aecf)

2013-07-18 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, src/Makefile.in,
  src/parse\_args.c, src/sudo.c, src/sudo\_usage.h.in:

  Add support for long options and fix inclusion of sudo\_usage.h with
  modern gcc broken in 8597:1fcb7ba13018.
  [[6e56e6d8c]](https://git.sudo.ws/sudo/commit/?id=6e56e6d8c)

* src/Makefile.in:

  Add rule to rebuild sudo\_usage.h when the .in file changes.
  [[fbfd0ad63]](https://git.sudo.ws/sudo/commit/?id=fbfd0ad63)

* compat/Makefile.in, mkdep.pl, src/Makefile.in:

  Add make rules for building getopt\_long.c
  [[deb384495]](https://git.sudo.ws/sudo/commit/?id=deb384495)

* src/parse\_args.c:

  Make “-h hostname” work. Optional args in GNU getopt() only work when
  there is no space between the option flag and the argument.
  [[db05b9ae0]](https://git.sudo.ws/sudo/commit/?id=db05b9ae0)

2013-07-17 Todd C. Miller

* MANIFEST, compat/getopt.h, compat/getopt\_long.c, config.h.in, configure,
  configure.in, doc/LICENSE, src/parse\_args.c:

  Use getopt\_long() so we can make the -h flag take an optional argument.
  Includes a version for those without it.
  [[9309c9eab]](https://git.sudo.ws/sudo/commit/?id=9309c9eab)

2013-07-16 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Document that the -h option can be used specify a host name for future
  plugins.
  [[29908cb6d]](https://git.sudo.ws/sudo/commit/?id=29908cb6d)

* include/sudo\_plugin.h, src/parse\_args.c, src/sudo\_usage.h.in:

  Overload -h option to specify an optional hostname for remote access.
  This is future-proofing; no policy plugins currently support this.
  [[c2860cce5]](https://git.sudo.ws/sudo/commit/?id=c2860cce5)

* configure, configure.in:

  Bump version to 1.8.8
  [[1e4497331]](https://git.sudo.ws/sudo/commit/?id=1e4497331)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Document the remote\_host setting (-h host)
  [[1d20a0ab6]](https://git.sudo.ws/sudo/commit/?id=1d20a0ab6)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  fix “the the”
  [[ba615bd58]](https://git.sudo.ws/sudo/commit/?id=ba615bd58)

* src/parse\_args.c, src/sudo.c, src/sudo.h:

  Do not error out if arg to -U option cannot be resolved, that is for the
  plugin to decide. There is no need for runas\_user and runas\_group to be
  global, make them local to parse\_args() instead.
  [[b4e1f7c44]](https://git.sudo.ws/sudo/commit/?id=b4e1f7c44)

* MANIFEST, doc/CONTRIBUTORS, plugins/sudoers/po/pt\_BR.mo,
  plugins/sudoers/po/pt\_BR.po, src/po/es.mo, src/po/es.po,
  src/po/pt\_BR.mo, src/po/pt\_BR.po:

  Sync with translationproject.org
  [[e53e80187]](https://git.sudo.ws/sudo/commit/?id=e53e80187)

2013-07-11 Todd C. Miller

* doc/TROUBLESHOOTING:

  Remove old bits about sudo setuid problems that should have been cleaned
  up in changeset 7917:fa4894896d8a. Also update the mode of sudo to 04755
  to match current packaging.
  [[adce34358]](https://git.sudo.ws/sudo/commit/?id=adce34358)

* plugins/sudoers/auth/pam.c:

  Go back to ignoring the return value of pam\_setcred() since with stacked
  PAM auth modules a failure from one module may override PAM\_SUCCESS from
  another. If the first module in the stack fails, the others may be run
  (and succeed) but an error will be returned. This can cause a spurious
  warning on systems with non-local users (e.g. pam\_ldap or pam\_sss) where
  pam\_unix is consulted first.
  [[6dff70db0]](https://git.sudo.ws/sudo/commit/?id=6dff70db0)

* src/net\_ifs.c:

  Remove unused variable.
  [[f32a1c7ed]](https://git.sudo.ws/sudo/commit/?id=f32a1c7ed)

* NEWS:

  Fix typo
  [[a72d04c39]](https://git.sudo.ws/sudo/commit/?id=a72d04c39)

2013-07-09 Todd C. Miller

* plugins/sudoers/sssd.c:

  Fix pasto; sudo\_sss\_extract\_digest() not sudo\_ldap\_extract\_digest().
  From Dan Harnett.
  [[4d6cb6eff]](https://git.sudo.ws/sudo/commit/?id=4d6cb6eff)

2013-06-18 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Fix formatting typo; from Eric S. Raymond
  [[bf9d823c2]](https://git.sudo.ws/sudo/commit/?id=bf9d823c2)

2013-06-17 Todd C. Miller

* mkpkg:

  Use -gxcoff on aix so dbx can be used to debug sudo.
  [[0799e9679]](https://git.sudo.ws/sudo/commit/?id=0799e9679)

2013-06-12 Todd C. Miller

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Fix typo; bug 605
  [[e8046e4be]](https://git.sudo.ws/sudo/commit/?id=e8046e4be)

2013-06-04 Todd C. Miller

* src/po/da.mo, src/po/eo.mo, src/po/es.mo, src/po/it.mo, src/po/tr.mo:

  Regen .mo files that were out of date.
  [[8b44c5d42]](https://git.sudo.ws/sudo/commit/?id=8b44c5d42)

2013-05-30 Todd C. Miller

* NEWS, configure, configure.in:

  On Solaris 11 and higher, tag binaries for ASLR if supported by the
  linker.
  [[c057692da]](https://git.sudo.ws/sudo/commit/?id=c057692da)

* mkpkg:

  No longer need to disable PIE on Solaris.
  [[d962673a7]](https://git.sudo.ws/sudo/commit/?id=d962673a7)

2013-05-28 Todd C. Miller

* INSTALL, NEWS, configure, configure.in, doc/TROUBLESHOOTING:

  Restrict default creation of PIE binaries (-fPIE and -pie) to Linux.
  OpenBSD also supports PIE but enables it by default so we don’t need to
  do anything. This fixes problems on systems with a version of GNU ld
  that accepts -pie but where the run-time linker doesn’t actually support
  PIE. Also verify that a trivial PIE binary works unless PIE is
  explicitly enabled.
  [[67d8af4be]](https://git.sudo.ws/sudo/commit/?id=67d8af4be)

2013-05-24 Todd C. Miller

* aclocal.m4, configure, configure.in:

  Attempt to detect PIE failure on Solaris 10 with GNU as and GNU ld where
  we can end up crashing due to malloc() failures. Sems OK when Using Sun
  as and ld.
  [[521e17b13]](https://git.sudo.ws/sudo/commit/?id=521e17b13)

* NEWS:

  Update with final changes.
  [[a6ee84b0a]](https://git.sudo.ws/sudo/commit/?id=a6ee84b0a)

2013-05-23 Todd C. Miller

* configure, configure.in:

  Add -fPIE to PIE\_LDFLAGS as per gcc manual.
  [[62c7945c0]](https://git.sudo.ws/sudo/commit/?id=62c7945c0)

2013-05-22 Todd C. Miller

* common/Makefile.in, compat/Makefile.in:

  Add missing $(PIE\_LDFLAGS) $(SSP\_LDFLAGS) for test programs
  [[f9c4fb69d]](https://git.sudo.ws/sudo/commit/?id=f9c4fb69d)

* MANIFEST, plugins/sudoers/alias.c, plugins/sudoers/match.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/visudo/test4.out.ok,
  plugins/sudoers/regress/visudo/test4.sh, plugins/sudoers/visudo.c:

  Replace sequence number-based cycle detection in visudo with a “used”
  flag in struct alias. The caller is required to call alias\_put() when it
  is done with the alias. Inspired by a patch from Daniel Kopecek.
  [[ab61c0254]](https://git.sudo.ws/sudo/commit/?id=ab61c0254)

2013-05-20 Todd C. Miller

* plugins/sudoers/iolog.c:

  Eliminate a few relocations related to sudoers\_io.
  [[8a57f129a]](https://git.sudo.ws/sudo/commit/?id=8a57f129a)

* plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po:

  Sync with translationproject.org
  [[32a29d596]](https://git.sudo.ws/sudo/commit/?id=32a29d596)

2013-05-18 Todd C. Miller

* src/ttyname.c:

  Clarify a comment.
  [[586991653]](https://git.sudo.ws/sudo/commit/?id=586991653)

2013-05-16 Todd C. Miller

* src/ttyname.c:

  Handle d\_type == DT\_UNKNOWN when resolving the device to a name and
  sprinkle some more debugging.
  [[5549e44cd]](https://git.sudo.ws/sudo/commit/?id=5549e44cd)

2013-05-03 Todd C. Miller

* doc/TROUBLESHOOTING:

  Add message about disabling PIE if sudo gets SIGSEGV.
  [[2dd71e838]](https://git.sudo.ws/sudo/commit/?id=2dd71e838)

* plugins/sudoers/check.h, plugins/sudoers/timestamp.c:

  No longer store the ctime of a devpts tty. The handling of ctime on
  devpts in Linux has been changed to conform to POSIX. As a result we can
  no longer assume that the ctime will stay unchanged throughout the life
  of the session. We store the session ID in the time stamp file so there
  is a much smaller chance of the time stamp file being reused by a new
  login. While here, store the uid/gid in the timestamp file too for good
  measure.
  [[1e5e5fb44]](https://git.sudo.ws/sudo/commit/?id=1e5e5fb44)

* configure, configure.in:

  PIE is broken on FreeBSD/arm
  [[ca4f8d949]](https://git.sudo.ws/sudo/commit/?id=ca4f8d949)

* mkpkg:

  Add explicit sendmail path for Linux since we may not have sendmail
  installed in the build chroot.
  [[04f9cedef]](https://git.sudo.ws/sudo/commit/?id=04f9cedef)

2013-05-01 Todd C. Miller

* common/sudo\_debug.c, plugins/sudoers/iolog.c,
  plugins/sudoers/set\_perms.c, src/sudo.c, src/tgetpass.c:

  Quiet a few -Wunused-result compiler warnings.
  [[f6e8fb8b1]](https://git.sudo.ws/sudo/commit/?id=f6e8fb8b1)

2013-04-30 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Mention what SHA-2 formats are supported.
  [[874d84f26]](https://git.sudo.ws/sudo/commit/?id=874d84f26)

* doc/CONTRIBUTORS:

  List code and translations separately.
  [[61c0a24c8]](https://git.sudo.ws/sudo/commit/?id=61c0a24c8)

2013-04-29 Todd C. Miller

* MANIFEST, plugins/sudoers/po/de.mo, plugins/sudoers/po/de.po,
  plugins/sudoers/po/tr.mo, plugins/sudoers/po/tr.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po:

  Sync with translationproject.org
  [[a971ac423]](https://git.sudo.ws/sudo/commit/?id=a971ac423)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[8aaea60a7]](https://git.sudo.ws/sudo/commit/?id=8aaea60a7)

* Makefile.in:

  Fix c-format for fatal/fatalx
  [[cf5f505fb]](https://git.sudo.ws/sudo/commit/?id=cf5f505fb)

2013-04-26 Todd C. Miller

* Makefile.in, plugins/sudoers/iolog.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/visudo.c, src/exec\_pty.c, src/sudo.h:

  Change some error/errorx -> fatal/fatalx in comments and xgettext
  flags.
  [[368a6558c]](https://git.sudo.ws/sudo/commit/?id=368a6558c)

* NEWS:

  There is now a Turkish translation of sudoers.
  [[08506b66a]](https://git.sudo.ws/sudo/commit/?id=08506b66a)

* MANIFEST, plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/tr.mo, plugins/sudoers/po/tr.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po:

  Updated translations from translationproject.org including new Turkish
  translation.
  [[e17e4c951]](https://git.sudo.ws/sudo/commit/?id=e17e4c951)

2013-04-25 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document that sudoers will re-use existing I/O log paths unless they are
  mktemp-style with trailing X’s.
  [[7c9aaa2f2]](https://git.sudo.ws/sudo/commit/?id=7c9aaa2f2)

* NEWS, doc/sudoers.cat, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/ldap.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h:

  Allow ldap\_conf and ldap\_secret to be specified as plugin arguments in
  sudo.conf
  [[fa6c85711]](https://git.sudo.ws/sudo/commit/?id=fa6c85711)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  sudoers\_debug is now deprecated in favor of the sudo debugging
  framework.
  [[67dad9a83]](https://git.sudo.ws/sudo/commit/?id=67dad9a83)

* plugins/sudoers/ldap.c:

  Replace DPRINTF with DPRINTF1 and DPRINTF2 macros that use
  SUDO\_DEBUG\_DIAG and SUDO\_DEBUG\_INFO respectively for logging to the
  debug file with the ldap subsystem. The sudoers\_debug setting in
  ldap.conf is still honored for now but will be removed in a future
  release.
  [[a40de4135]](https://git.sudo.ws/sudo/commit/?id=a40de4135)

2013-04-24 Todd C. Miller

* plugins/sudoers/sudoers2ldif:

  Add support for converting sudoers files with SHA-2 command digests.
  [[8248fb329]](https://git.sudo.ws/sudo/commit/?id=8248fb329)

* doc/fixman.sh, doc/fixmdoc.sh, mkdep.pl, mkpkg,
  plugins/sudoers/sudoers2ldif:

  Add copyright notice to scripts
  [[e05d2732a]](https://git.sudo.ws/sudo/commit/?id=e05d2732a)

* MANIFEST, plugins/sudoers/regress/sudoers/test14.in,
  plugins/sudoers/regress/sudoers/test14.out.ok,
  plugins/sudoers/regress/sudoers/test14.toke.ok:

  Add regress for SHA-2 digests.
  [[5a7e54d37]](https://git.sudo.ws/sudo/commit/?id=5a7e54d37)

* compat/getgrouplist.c:

  Solaris maps negative gids to GID\_NOBODY.
  [[c5971524f]](https://git.sudo.ws/sudo/commit/?id=c5971524f)

* plugins/sudoers/visudo.c:

  Clear up an llvm checker warning which appears to be a false positive
  and fix an old XXX while I’m at it.
  [[50bdd5f13]](https://git.sudo.ws/sudo/commit/?id=50bdd5f13)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoreplay.cat,
  doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in:

  Correct last change date
  [[7ab68a35d]](https://git.sudo.ws/sudo/commit/?id=7ab68a35d)

* plugins/sudoers/po/sudoers.pot, plugins/sudoers/sudoreplay.c:

  No need to translate this error message.
  [[8ca50e13b]](https://git.sudo.ws/sudo/commit/?id=8ca50e13b)

* doc/UPGRADE:

  Mention .sl vs. .so extension handling on HP-UX Mention group membership
  changes Fix typos
  [[ad019da9e]](https://git.sudo.ws/sudo/commit/?id=ad019da9e)

* aclocal.m4, common/aix.c, common/alloc.c, common/atobool.c,
  common/error.c, common/fmt\_string.c, common/lbuf.c, common/list.c,
  common/setgroups.c, common/term.c, common/ttysize.c, compat/Makefile.in,
  compat/dlopen.c, compat/endian.h, compat/getline.c,
  compat/getprogname.c, compat/isblank.c, compat/memrchr.c,
  compat/mksiglist.c, compat/mktemp.c, compat/nanosleep.c,
  compat/pw\_dup.c, compat/sig2str.c, compat/snprintf.c, compat/strlcat.c,
  compat/strlcpy.c, compat/strsignal.c, compat/utimes.c, doc/Makefile.in,
  include/Makefile.in, include/alloc.h, include/fileops.h,
  include/gettext.h, include/lbuf.h, include/missing.h,
  include/sudo\_plugin.h, pathnames.h.in, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sample/sample\_plugin.c,
  plugins/sudoers/Makefile.in, plugins/sudoers/alias.c,
  plugins/sudoers/audit.c, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.h,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/bsm\_audit.h,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/env.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/getspwuid.c, plugins/sudoers/goodpath.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/interfaces.c,
  plugins/sudoers/interfaces.h, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/linux\_audit.h,
  plugins/sudoers/locale.c, plugins/sudoers/logging.h,
  plugins/sudoers/match.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil.h,
  plugins/sudoers/redblack.c, plugins/sudoers/redblack.h,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudo\_nss.h, plugins/sudoers/sudoers\_version.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/visudo.c, plugins/system\_group/Makefile.in,
  plugins/system\_group/system\_group.c, src/Makefile.in,
  src/conversation.c, src/exec.c, src/exec\_common.c, src/get\_pty.c,
  src/net\_ifs.c, src/parse\_args.c, src/preload.c, src/selinux.c,
  src/sesh.c, src/signal.c, src/sudo\_edit.c, src/sudo\_exec.h,
  src/sudo\_noexec.c, src/sudo\_plugin\_int.h, src/tgetpass.c, src/utmp.c:

  Update copyright years.
  [[d6282d154]](https://git.sudo.ws/sudo/commit/?id=d6282d154)

* plugins/sudoers/mon\_systrace.h:

  Systrace support was removed long ago.
  [[7b4f990d1]](https://git.sudo.ws/sudo/commit/?id=7b4f990d1)

2013-04-23 Todd C. Miller

* MANIFEST, plugins/sudoers/regress/sudoers/test10.toke.out.ok,
  plugins/sudoers/regress/sudoers/test9.toke.out.ok:

  Remove some files that were mistakenly added.
  [[2923a6652]](https://git.sudo.ws/sudo/commit/?id=2923a6652)

* common/sudo\_debug.c, config.h.in, configure, configure.in,
  plugins/sudoers/boottime.c, plugins/sudoers/iolog.c,
  plugins/sudoers/ldap.c, plugins/sudoers/logging.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/timestamp.c:

  Use time(&now) instead of now = time(NULL) when storing the current time
  in a time\_t (better compiler error checking). Better parsing and
  printing of 64-bit time\_t on 32-bit platforms.
  [[95b50f84a]](https://git.sudo.ws/sudo/commit/?id=95b50f84a)

2013-04-21 Todd C. Miller

* src/ttyname.c:

  Don’t check the tty of the parent process. Now that we get the
  controlling tty device number from the kernel there is no need. If the
  process has really disassociated from the tty then reporting “unknown”
  is appropriate.
  [[2b1b9ae72]](https://git.sudo.ws/sudo/commit/?id=2b1b9ae72)

2013-04-20 Todd C. Miller

* common/error.c:

  Use EXIT\_FAILURE instead of 1 as the fatal() exit value.
  [[7ac5730a4]](https://git.sudo.ws/sudo/commit/?id=7ac5730a4)

* src/sesh.c:

  Change remaining errorx -> fatalx
  [[8b0c6c508]](https://git.sudo.ws/sudo/commit/?id=8b0c6c508)

2013-04-19 Todd C. Miller

* plugins/sudoers/pwutil.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Replace sudo\_fakepwnamid() with sudo\_mkpwent() and don’t return an error
  if the entry already exists in the cache.
  [[5337da144]](https://git.sudo.ws/sudo/commit/?id=5337da144)

* plugins/sudoers/bsm\_audit.c, plugins/sudoers/po/sudoers.pot:

  Change “foo: failed” to just “foo” since we print the string form of
  errno. Gets rids of some useless translations.
  [[d913fe69c]](https://git.sudo.ws/sudo/commit/?id=d913fe69c)

2013-04-18 Todd C. Miller

* plugins/sudoers/match.c:

  Fix pasto in debug\_decl
  [[40772f5aa]](https://git.sudo.ws/sudo/commit/?id=40772f5aa)

* plugins/sudoers/Makefile.in:

  regen
  [[71f9fe33d]](https://git.sudo.ws/sudo/commit/?id=71f9fe33d)

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/parse.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/timestamp.c:

  Rename log\_error() -> log\_warning() for consistency with
  warning()/fatal()
  [[1162b5504]](https://git.sudo.ws/sudo/commit/?id=1162b5504)

* plugins/sudoers/auth/API:

  The NO\_EXIT flag was removed a while ago.
  [[2c3a4e035]](https://git.sudo.ws/sudo/commit/?id=2c3a4e035)

* common/aix.c, common/alloc.c, common/error.c, include/error.h,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/env.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/hexchar.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/policy.c, plugins/sudoers/prompt.c,
  plugins/sudoers/pwutil.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestamp.c, plugins/sudoers/visudo.c, src/exec.c,
  src/exec\_common.c, src/exec\_pty.c, src/net\_ifs.c, src/parse\_args.c,
  src/selinux.c, src/signal.c, src/sudo.c, src/sudo\_edit.c,
  src/tgetpass.c, src/utmp.c:

  Rename error/errorx -> fatal/fatalx and remove the exit value as it was
  always 1.
  [[39acd2fcb]](https://git.sudo.ws/sudo/commit/?id=39acd2fcb)

* NEWS:

  digests are supported in sudoers ldap too
  [[0fe2c3eb9]](https://git.sudo.ws/sudo/commit/?id=0fe2c3eb9)

* plugins/sudoers/regress/check\_symbols/check\_symbols.c:

  Print test failures to stdout like the final count so the outputis not
  displayed out of order.
  [[fbcff81cd]](https://git.sudo.ws/sudo/commit/?id=fbcff81cd)

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/eo.po, plugins/sudoers/po/hr.mo,
  plugins/sudoers/po/hr.po, plugins/sudoers/po/it.po, src/po/da.mo,
  src/po/da.po, src/po/eo.po, src/po/hr.mo, src/po/hr.po, src/po/it.po,
  src/po/tr.po:

  Sync with translationproject.org
  [[904428dd5]](https://git.sudo.ws/sudo/commit/?id=904428dd5)

* Makefile.in:

  Check for any uncommitted changes in dist target and add force-dist
  target that omit check-dist.
  [[dc618b991]](https://git.sudo.ws/sudo/commit/?id=dc618b991)

2013-04-17 Todd C. Miller

* src/regress/ttyname/check\_ttyname.c:

  Fix logic bug when checking tty via ttyname().
  [[6c9c2b242]](https://git.sudo.ws/sudo/commit/?id=6c9c2b242)

* compat/endian.h:

  Fix check for \_BIG\_ENDIAN and \_LITTLE\_ENDIAN (Solaris) and
  **BIG\_ENDIAN** and **LITTLE\_ENDIAN** (HP-UX)
  [[5d7579816]](https://git.sudo.ws/sudo/commit/?id=5d7579816)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[e8cd84c35]](https://git.sudo.ws/sudo/commit/?id=e8cd84c35)

* NEWS, doc/sample.sudoers, doc/sudoers.cat, doc/sudoers.ldap.cat,
  doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in,
  doc/sudoers.mdoc.in:

  Document digest support.
  [[ed6d6963d]](https://git.sudo.ws/sudo/commit/?id=ed6d6963d)

* MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/parser/check\_base64.c:

  Simple bas64 decode unit test.
  [[e91e30b4b]](https://git.sudo.ws/sudo/commit/?id=e91e30b4b)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/base64.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.h:

  Move base64\_decode into its own source file.
  [[9c1ee1fe7]](https://git.sudo.ws/sudo/commit/?id=9c1ee1fe7)

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y:

  Only check year against 2038 if time\_t is 32-bit.
  [[d32cb3d65]](https://git.sudo.ws/sudo/commit/?id=d32cb3d65)

2013-04-16 Todd C. Miller

* plugins/sudoers/ldap.c, plugins/sudoers/parse.h, plugins/sudoers/sssd.c:
  Add digest support for sudoers in ldap and sss.
  [[cc3c76b85]](https://git.sudo.ws/sudo/commit/?id=cc3c76b85)

* INSTALL, configure, configure.in:

  Error out in configure if the compiler doesn’t support “long long”.
  [[d1580ff59]](https://git.sudo.ws/sudo/commit/?id=d1580ff59)

* plugins/sudoers/match.c, plugins/sudoers/toke.c, plugins/sudoers/toke.l:
  Include stdint.h or inttypes.h before sha2.h
  [[26a256260]](https://git.sudo.ws/sudo/commit/?id=26a256260)

* common/lbuf.c:

  Simplify lbuf append functions by moving the realloc code into
  lbuf\_expand(). We now expand as needed each time bytes need to be
  written to the lbuf. Also handle a NULL pointer being passed in for
  paranoia’s sake.
  [[19d094602]](https://git.sudo.ws/sudo/commit/?id=19d094602)

* plugins/sudoers/iolog.c:

  Zero out struct iolog\_details early to avoid a potential (though
  unlikely) dereference of stack garbage if we hit a fatal error before
  iolog\_deserialize\_info() is called.
  [[6c737f043]](https://git.sudo.ws/sudo/commit/?id=6c737f043)

2013-04-15 Todd C. Miller

* sudo.pp:

  Update copyright year.
  [[f2a007fb9]](https://git.sudo.ws/sudo/commit/?id=f2a007fb9)

* plugins/sudoers/sudoers\_version.h:

  Bump SUDOERS\_GRAMMAR\_VERSION for new digest support.
  [[b0df32a77]](https://git.sudo.ws/sudo/commit/?id=b0df32a77)

* plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/match.c, plugins/sudoers/toke.c, plugins/sudoers/toke.l:
  Sanity check digest in parser so visudo can catch errors. Add base64
  support
  [[e715841fc]](https://git.sudo.ws/sudo/commit/?id=e715841fc)

* MANIFEST, compat/endian.h, config.h.in, configure, configure.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/sha2.c:

  For big endian architectures just use memcpy() instead of BE macros in a
  loop.
  [[89759fa36]](https://git.sudo.ws/sudo/commit/?id=89759fa36)

2013-04-14 Todd C. Miller

* MANIFEST, config.h.in, configure, configure.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/gram.c,
  plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/hexchar.c, plugins/sudoers/ldap.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.h,
  plugins/sudoers/regress/parser/check\_digest.c,
  plugins/sudoers/regress/parser/check\_digest.out.ok,
  plugins/sudoers/sha2.h, plugins/sudoers/sssd.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/toke\_util.c:

  Initial implementation of checksum support in sudoers. Currently
  supports SHA-224, SHA-256, SHA-384, SHA-512. TODO: checksum format
  validation in parser and base64 support. checksum support for ldap
  sudoers
  [[35375a2b7]](https://git.sudo.ws/sudo/commit/?id=35375a2b7)

2013-04-13 Todd C. Miller

* doc/CONTRIBUTORS, plugins/sudoers/sha2.c, plugins/sudoers/sha2.h:

  SHA-224, SHA-256, SHA-384 and SHA-512. Derived from the public domain
  SHA-1 and SHA-2 implementations by Steve Reid and Wei Dai respectively.
  [[1aa490352]](https://git.sudo.ws/sudo/commit/?id=1aa490352)

2013-04-11 Todd C. Miller

* NEWS:

  Add sudo 1.8.6p8
  [[22c8c1217]](https://git.sudo.ws/sudo/commit/?id=22c8c1217)

* plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/po/sudoers.pot:

  Add missing “not” in error message when mixing standalone and
  non-standalone authentication methods.
  [[bce9a96a6]](https://git.sudo.ws/sudo/commit/?id=bce9a96a6)

* plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/secureware.c:

  Check for crypt() returning NULL. Traditionally, crypt() never returned
  NULL but newer versions of eglibc have a crypt() that does. [Bug
  #598](https://bugzilla.sudo.ws/show_bug.cgi?id=598)
  [[6f718ee3c]](https://git.sudo.ws/sudo/commit/?id=6f718ee3c)

* plugins/sudoers/auth/pam.c:

  Better PAM error messages
  [[e9726e597]](https://git.sudo.ws/sudo/commit/?id=e9726e597)

* plugins/sudoers/auth/kerb5.c:

  Better error messages
  [[c00cc3bfe]](https://git.sudo.ws/sudo/commit/?id=c00cc3bfe)

* plugins/sudoers/bsm\_audit.c:

  Use same error message for getauid() failure.
  [[8d2c79180]](https://git.sudo.ws/sudo/commit/?id=8d2c79180)

* plugins/sudoers/sssd.c:

  Start warning with a lower case letter for consistency and to match
  existing translated strings.
  [[236f306a2]](https://git.sudo.ws/sudo/commit/?id=236f306a2)

2013-04-10 Todd C. Miller

* mkpkg:

  Disable PIE on Solaris where it is not really supported.
  [[8ffac2aa6]](https://git.sudo.ws/sudo/commit/?id=8ffac2aa6)

* src/ttyname.c:

  AIX may have a 64-bit pr\_ttydev that we need to convert to 32-bit before
  we try to match it against st\_rdev.
  [[42313adc0]](https://git.sudo.ws/sudo/commit/?id=42313adc0)

* src/ttyname.c:

  Break out of the loop if sudo\_ttyname\_scan() returns non-NULL. Fixes a
  problem finding the tty name when it is not in /dev/pts.
  [[54f092c3e]](https://git.sudo.ws/sudo/commit/?id=54f092c3e)

* compat/snprintf.c:

  Support %lld and %llu
  [[e3b61c11f]](https://git.sudo.ws/sudo/commit/?id=e3b61c11f)

* .hgignore, MANIFEST, src/Makefile.in,
  src/regress/ttyname/check\_ttyname.c:

  Add ttyname test.
  [[ec3219415]](https://git.sudo.ws/sudo/commit/?id=ec3219415)

2013-04-09 Todd C. Miller

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/sl.mo, plugins/sudoers/po/sl.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, src/po/de.mo,
  src/po/de.po, src/po/fi.mo, src/po/fi.po, src/po/pl.mo, src/po/pl.po,
  src/po/ru.mo, src/po/ru.po, src/po/sl.mo, src/po/sl.po, src/po/uk.mo,
  src/po/uk.po, src/po/vi.mo, src/po/vi.po, src/po/zh\_CN.mo,
  src/po/zh\_CN.po:

  Sync with translationproject.org
  [[c3b9c94e8]](https://git.sudo.ws/sudo/commit/?id=c3b9c94e8)

* plugins/sudoers/timestamp.c:

  Log timestampfile to debug file.
  [[5555b86d7]](https://git.sudo.ws/sudo/commit/?id=5555b86d7)

* plugins/sudoers/auth/pam.c, plugins/sudoers/po/sudoers.pot:

  Don’t add the “Password: " string we look up in the PAM text domain to
  the sudoers.pot file.
  [[9914cd8a7]](https://git.sudo.ws/sudo/commit/?id=9914cd8a7)

2013-04-08 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  Synce with regcomp() error message change.
  [[e2ed8cc9f]](https://git.sudo.ws/sudo/commit/?id=e2ed8cc9f)

* plugins/sudoers/sudoreplay.c:

  Be consistent with error message when regcomp() fails.
  [[b6d644b30]](https://git.sudo.ws/sudo/commit/?id=b6d644b30)

2013-04-05 Todd C. Miller

* plugins/sudoers/regress/testsudoers/test5.out.ok,
  plugins/sudoers/regress/testsudoers/test5.sh:

  Use group -1 instead of 1 as the invalid group since the running user
  might have group 1 as their default group.
  [[e17267b5e]](https://git.sudo.ws/sudo/commit/?id=e17267b5e)

* plugins/sudoers/Makefile.in:

  PWD may be a shell builtin, use CWD instead.
  [[f1aed773e]](https://git.sudo.ws/sudo/commit/?id=f1aed773e)

2013-04-04 Todd C. Miller

* plugins/sudoers/check.c:

  Split up check\_user().
  [[faf150c4d]](https://git.sudo.ws/sudo/commit/?id=faf150c4d)

2013-04-03 Todd C. Miller

* config.h.in, configure.in:

  Cosmetic fixes in the comments.
  [[baa9041fe]](https://git.sudo.ws/sudo/commit/?id=baa9041fe)

2013-04-02 Todd C. Miller

* configure, configure.in:

  Use AC\_LINK\_IFELSE instead of AC\_TRY\_LINK Fix printing of status message
  for visibility checks when the test fails.
  [[e003c793b]](https://git.sudo.ws/sudo/commit/?id=e003c793b)

* config.h.in:

  regen
  [[9438c8ab3]](https://git.sudo.ws/sudo/commit/?id=9438c8ab3)

* configure, configure.in:

  We no longer use mbr\_check\_membership() and setrlimit64() is
  AIX-specific.
  [[4bd1b5e35]](https://git.sudo.ws/sudo/commit/?id=4bd1b5e35)

* Makefile.in:

  The first (all) target must be by itself or some makes will choose the
  run the entire target list.
  [[09754a11a]](https://git.sudo.ws/sudo/commit/?id=09754a11a)

* configure, configure.in:

  Do exec\_prefix expansion when enable\_shared even if noexec is not
  enabled.
  [[7364f0ce9]](https://git.sudo.ws/sudo/commit/?id=7364f0ce9)

* compat/getgrouplist.c:

  Use free() not efree() since we don’t include alloc.h here
  [[b9bb50ff5]](https://git.sudo.ws/sudo/commit/?id=b9bb50ff5)

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  regen
  [[382640839]](https://git.sudo.ws/sudo/commit/?id=382640839)

* plugins/sudoers/regress/testsudoers/test2.sh,
  plugins/sudoers/regress/testsudoers/test3.sh,
  plugins/sudoers/regress/testsudoers/test5.sh:

  Pass in expected gid to testsudoers in addition to the uid that matches
  the test sudoers files.
  [[46db7a20e]](https://git.sudo.ws/sudo/commit/?id=46db7a20e)

2013-04-01 Todd C. Miller

* include/missing.h:

  Tru64 5.x does declare innetgr() and getdomainname().
  [[414fc377c]](https://git.sudo.ws/sudo/commit/?id=414fc377c)

* plugins/sudoers/match.c:

  Fix compilation when getdomainame() is not present.
  [[cd980f0b4]](https://git.sudo.ws/sudo/commit/?id=cd980f0b4)

* config.h.in, configure.in, include/missing.h:

  Move SET/CLR/ISSET from config.h.in to missing.h
  [[f7b62e8dc]](https://git.sudo.ws/sudo/commit/?id=f7b62e8dc)

* configure, configure.in:

  Fix getgrouplist() check.
  [[3a83dbafb]](https://git.sudo.ws/sudo/commit/?id=3a83dbafb)

* MANIFEST:

  No more timestamp.h
  [[159664ad7]](https://git.sudo.ws/sudo/commit/?id=159664ad7)

* plugins/sudoers/check.c:

  Neded sys/time.h for struct timeval in struct sudo\_tty\_info.
  [[073989aa6]](https://git.sudo.ws/sudo/commit/?id=073989aa6)

* plugins/sudoers/Makefile.in:

  regen depends
  [[e7e739f65]](https://git.sudo.ws/sudo/commit/?id=e7e739f65)

* NEWS:

  Mention libibmldap on HP-UX
  [[87e191787]](https://git.sudo.ws/sudo/commit/?id=87e191787)

* NEWS, plugins/sudoers/match.c:

  Instead of checking the domain name explicitly for “(none)”, just check
  for illegal characters.
  [[e23ebd53c]](https://git.sudo.ws/sudo/commit/?id=e23ebd53c)

* plugins/sudoers/visudo.c:

  Only warn once when we are unable to open the sudoers file.
  [[328994740]](https://git.sudo.ws/sudo/commit/?id=328994740)

* plugins/sudoers/sudoers.c:

  Fall back to opening /dev/tty to determine whether there is a tty if the
  system doesn’t have kernel support for determing the tty.
  [[41ab8da22]](https://git.sudo.ws/sudo/commit/?id=41ab8da22)

* compat/getprogname.c:

  Update guard to take \_\_progname into account
  [[afc95dd11]](https://git.sudo.ws/sudo/commit/?id=afc95dd11)

* compat/snprintf.c:

  Some older systems have inttypes.h but not stdint.h
  [[d7ea8fead]](https://git.sudo.ws/sudo/commit/?id=d7ea8fead)

* compat/closefrom.c, compat/dlopen.c, compat/fnmatch.c,
  compat/getaddrinfo.c, compat/getcwd.c, compat/getgrouplist.c,
  compat/getline.c, compat/getprogname.c, compat/glob.c, compat/isblank.c,
  compat/memrchr.c, compat/mktemp.c, compat/nanosleep.c, compat/pw\_dup.c,
  compat/sig2str.c, compat/snprintf.c, compat/strlcat.c, compat/strlcpy.c,
  compat/strsignal.c, compat/utimes.c:

  Add guards in compat source files. Not really needed since we only
  include them in the Makefile if they are needed but should not hurt
  either.
  [[98ffa5154]](https://git.sudo.ws/sudo/commit/?id=98ffa5154)

2013-03-31 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Don’t include gram.h in gram.y, its contents are already included. Move
  sudoerserror to the end of gram.y so COMMENT is declared when we need to
  use it.
  [[d30008d58]](https://git.sudo.ws/sudo/commit/?id=d30008d58)

2013-03-29 Todd C. Miller

* config.h.in, configure.in:

  Remove some pre-ANSI cruft.
  [[6b2a085a2]](https://git.sudo.ws/sudo/commit/?id=6b2a085a2)

* plugins/sudoers/match.c:

  Rename NAME\_MATCH -> SUDOERS\_NAME\_MATCH and avoid pulling in glob.h
  when it is set.
  [[7796d6456]](https://git.sudo.ws/sudo/commit/?id=7796d6456)

* NEWS, plugins/sudoers/iolog\_path.c:

  We still want to recognize %{seq} for the SUDOERS\_NO\_SEQ case but just
  leave it as-is.
  [[a17d17115]](https://git.sudo.ws/sudo/commit/?id=a17d17115)

2013-03-28 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Add missing semicolon in rule.
  [[a2ce6fd29]](https://git.sudo.ws/sudo/commit/?id=a2ce6fd29)

* plugins/sudoers/sudoers.c:

  Now that we can determine the terminal even when file descriptors are
  redirected we can check user\_ttypath rather than opening /dev/tty when
  enforcing requiretty.
  [[37b4b5d15]](https://git.sudo.ws/sudo/commit/?id=37b4b5d15)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Stash umask in struct sudo\_user so we don’t need to look it up later.
  [[38dac1e0a]](https://git.sudo.ws/sudo/commit/?id=38dac1e0a)

* plugins/sudoers/sudoers.c:

  Minor cosmetic change
  [[5bac16f5c]](https://git.sudo.ws/sudo/commit/?id=5bac16f5c)

* plugins/sudoers/regress/parser/check\_addr.c:

  No longer need to declare interfaces
  [[d482b00ec]](https://git.sudo.ws/sudo/commit/?id=d482b00ec)

* plugins/sudoers/logging.c:

  Fix compilation in SUDOERS\_NO\_SEQ case
  [[b7e351683]](https://git.sudo.ws/sudo/commit/?id=b7e351683)

* plugins/sudoers/regress/parser/check\_addr.c:

  No longer need to define sudo\_printf
  [[155669cfe]](https://git.sudo.ws/sudo/commit/?id=155669cfe)

* plugins/sudoers/check.c, plugins/sudoers/check.h,
  plugins/sudoers/timestamp.c:

  Pass auth\_pw to the timestamp functions.
  [[4d3fc204f]](https://git.sudo.ws/sudo/commit/?id=4d3fc204f)

* plugins/sudoers/iolog\_path.c:

  Fix SUDOERS\_NO\_SEQ
  [[254125769]](https://git.sudo.ws/sudo/commit/?id=254125769)

* plugins/sudoers/locale.c:

  Don’t need all of sudoers.h in here
  [[7eb2394b4]](https://git.sudo.ws/sudo/commit/?id=7eb2394b4)

* plugins/sudoers/sudoers.c:

  Don’t need to include sudoers\_version.h here.
  [[213f7ff11]](https://git.sudo.ws/sudo/commit/?id=213f7ff11)

2013-03-27 Todd C. Miller

* plugins/sudoers/check.c:

  DEFAULT\_LECTURE is no longer used.
  [[ec19ea97f]](https://git.sudo.ws/sudo/commit/?id=ec19ea97f)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.c:

  Move sudo\_conv into policy.c
  [[13dbba174]](https://git.sudo.ws/sudo/commit/?id=13dbba174)

* plugins/sudoers/pwutil.c:

  cosmetic fixes
  [[c66cf7c87]](https://git.sudo.ws/sudo/commit/?id=c66cf7c87)

* plugins/sudoers/match.c:

  RHEL (and perhaps other Linux distros) use the string “(none)” instead
  of an empty string when there is no actual NIS-style domain name. [Bug
  #596](https://bugzilla.sudo.ws/show_bug.cgi?id=596)
  [[ddc1d36a0]](https://git.sudo.ws/sudo/commit/?id=ddc1d36a0)

* plugins/sudoers/match.c:

  Fix return values when NAME\_MATCH is defined.
  [[64e558bcf]](https://git.sudo.ws/sudo/commit/?id=64e558bcf)

2013-03-26 Todd C. Miller

* plugins/sudoers/pwutil.c, plugins/sudoers/pwutil.h:

  Update copyright year.
  [[b729284df]](https://git.sudo.ws/sudo/commit/?id=b729284df)

* plugins/sudoers/pwutil.c, plugins/sudoers/pwutil.h,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/sudoers.h:

  Add sudo\_set\_grlist(), currently unused by the back end.
  [[6e5008701]](https://git.sudo.ws/sudo/commit/?id=6e5008701)

* plugins/sudoers/pwutil.c:

  Remove unused macros, fix a debug\_decl
  [[cee83cbf2]](https://git.sudo.ws/sudo/commit/?id=cee83cbf2)

* include/missing.h:

  Tru64 Unix doesn’t prototype innetgr() or getdomainname().
  [[608394793]](https://git.sudo.ws/sudo/commit/?id=608394793)

* include/missing.h:

  Whitespace fixes
  [[d710f1b41]](https://git.sudo.ws/sudo/commit/?id=d710f1b41)

* common/error.c:

  Don’t need to include setjmp.h here, error.h already includes it.
  [[adee3cded]](https://git.sudo.ws/sudo/commit/?id=adee3cded)

2013-03-25 Todd C. Miller

* compat/Makefile.in, plugins/sudoers/Makefile.in:

  regen depends
  [[837cda0c5]](https://git.sudo.ws/sudo/commit/?id=837cda0c5)

* plugins/sudoers/check.h:

  Rename guard define.
  [[84ff871a5]](https://git.sudo.ws/sudo/commit/?id=84ff871a5)

* plugins/sudoers/check.c, plugins/sudoers/check.h,
  plugins/sudoers/timestamp.c, plugins/sudoers/timestamp.h:

  Move contents of timestamp.h into check.h.
  [[8b4c19205]](https://git.sudo.ws/sudo/commit/?id=8b4c19205)

* plugins/sudoers/sudoers.h:

  expand\_prompt() is now in prompt.c sudo\_printf extern is now in error.h
  [[d6b5ffbbd]](https://git.sudo.ws/sudo/commit/?id=d6b5ffbbd)

* plugins/sudoers/bsm\_audit.h, plugins/sudoers/defaults.h,
  plugins/sudoers/ins\_2001.h, plugins/sudoers/ins\_classic.h,
  plugins/sudoers/ins\_csops.h, plugins/sudoers/ins\_goons.h,
  plugins/sudoers/insults.h, plugins/sudoers/interfaces.h,
  plugins/sudoers/linux\_audit.h, plugins/sudoers/logging.h,
  plugins/sudoers/parse.h, plugins/sudoers/pwutil.h,
  plugins/sudoers/redblack.h, plugins/sudoers/sudo\_nss.h,
  plugins/sudoers/sudoers.h, plugins/sudoers/timestamp.h,
  plugins/sudoers/toke.h:

  Change multiple inclusion guards to be \_SUDOERS\_FOO\_H
  [[a803b4d2e]](https://git.sudo.ws/sudo/commit/?id=a803b4d2e)

2013-03-23 Todd C. Miller

* MANIFEST, plugins/sudoers/po/nl.mo, plugins/sudoers/po/nl.po,
  src/po/nl.mo, src/po/nl.po, src/po/tr.mo, src/po/tr.po:

  New Dutch translation for sudo and sudoers New Turkish translation for
  sudo From translationproject.org
  [[b507f0a85]](https://git.sudo.ws/sudo/commit/?id=b507f0a85)

2013-03-21 Todd C. Miller

* config.h.in, configure, configure.in:

  Fix a typo in a comment and make sure we don’t mistakenly include
  \_PATH\_SUDO\_ASKPASS and \_PATH\_SUDO\_SESH in config.h.in
  [[b4ca9535b]](https://git.sudo.ws/sudo/commit/?id=b4ca9535b)

2013-03-19 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Don’t build check\_symbols if we are linking sudoers in statically.
  [[17c5f8b15]](https://git.sudo.ws/sudo/commit/?id=17c5f8b15)

* configure, configure.in:

  Use $host\_os not $host when we only care about the os name and version.
  [[575466027]](https://git.sudo.ws/sudo/commit/?id=575466027)

* aclocal.m4, configure, configure.in:

  Suppress duplicate -L and -I flags.
  [[017c7a15d]](https://git.sudo.ws/sudo/commit/?id=017c7a15d)

* common/Makefile.in, compat/regress/fnmatch/fnm\_test.c:

  Fix regress tests on non-OpenBSD platforms.
  [[c078614b4]](https://git.sudo.ws/sudo/commit/?id=c078614b4)

* configure, configure.in:

  If we find sasl/sasl.h there’s no need to check for sasl.h too
  [[3c139fa3c]](https://git.sudo.ws/sudo/commit/?id=3c139fa3c)

* aclocal.m4, configure, configure.in:

  Add -R flags at the very end after configure link tests are done since
  we can only count on libtool to accept -R, the compiler front end may
  not. Also unify the libldap and libibmldap tests using AC\_SEARCH\_LIBS
  and check for -lCsup on HP-UX which is needed by libibmldap (but is not
  an explicit dependency).
  [[46da6159d]](https://git.sudo.ws/sudo/commit/?id=46da6159d)

2013-03-18 Todd C. Miller

* configure, configure.in:

  Back out changes that broke detection of skey, opie and ldap libraries.
  [[0b9967927]](https://git.sudo.ws/sudo/commit/?id=0b9967927)

* plugins/sudoers/regress/testsudoers/test1.sh,
  plugins/sudoers/regress/testsudoers/test2.sh,
  plugins/sudoers/regress/testsudoers/test3.sh,
  plugins/sudoers/regress/testsudoers/test4.sh,
  plugins/sudoers/regress/testsudoers/test5.sh,
  plugins/sudoers/regress/visudo/test1.sh,
  plugins/sudoers/regress/visudo/test2.sh,
  plugins/sudoers/regress/visudo/test3.sh:

  Add explicit “exit 0” to prevent the check target from ending
  prematurely.
  [[2f86c1c09]](https://git.sudo.ws/sudo/commit/?id=2f86c1c09)

* plugins/sudoers/Makefile.in:

  Fix exit values in check target so we don’t have to ignore errors.
  [[b0ab02854]](https://git.sudo.ws/sudo/commit/?id=b0ab02854)

* plugins/sudoers/Makefile.in:

  Fail a test if there is unexpected stderr output.
  [[ae7679a31]](https://git.sudo.ws/sudo/commit/?id=ae7679a31)

* MANIFEST:

  Fix path to sudo.conf manuals; remove non-existant test2.err.ok
  [[6bd884860]](https://git.sudo.ws/sudo/commit/?id=6bd884860)

* src/load\_plugins.c:

  Fix compilation in dynamic mode.
  [[ce502e2ae]](https://git.sudo.ws/sudo/commit/?id=ce502e2ae)

* configure, configure.in:

  On HP-UX, libibmldap has a hidden dependency on libCsup
  [[1a51a993d]](https://git.sudo.ws/sudo/commit/?id=1a51a993d)

* compat/dlopen.c:

  Pass BIND\_VERBOSE to shl\_load()
  [[7109e46de]](https://git.sudo.ws/sudo/commit/?id=7109e46de)

* configure, configure.in:

  Only create static helper libs when –disable-shared is specified.
  [[eef31be22]](https://git.sudo.ws/sudo/commit/?id=eef31be22)

* src/load\_plugins.c:

  Ubreak static build.
  [[e78381e7c]](https://git.sudo.ws/sudo/commit/?id=e78381e7c)

* INSTALL, aclocal.m4, configure, configure.in:

  Replace –with-rpath and –with-blibpath with –disable-rpath. Now that
  we use libtool for linking we can just use the -R flag and have libtool
  translate it to the proper linker flag.
  [[c8f630c06]](https://git.sudo.ws/sudo/commit/?id=c8f630c06)

2013-03-15 Todd C. Miller

* src/exec\_pty.c:

  Bump I/O buffer size 32K
  [[5cda642eb]](https://git.sudo.ws/sudo/commit/?id=5cda642eb)

2013-03-14 Todd C. Miller

* configure, configure.in, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in:

  Document sesh Path setting.
  [[1614c3cad]](https://git.sudo.ws/sudo/commit/?id=1614c3cad)

* src/exec.c, src/exec\_common.c:

  Move exec\_cmnd to exec.c to fix a compilation issue with sesh.c
  [[eb2259bc1]](https://git.sudo.ws/sudo/commit/?id=eb2259bc1)

* common/sudo\_conf.c, configure, configure.in, include/sudo\_conf.h,
  src/selinux.c:

  Make sesh path configurable in sudo.conf
  [[7f32d1ca4]](https://git.sudo.ws/sudo/commit/?id=7f32d1ca4)

* configure, configure.in:

  Use -fno-pie and -nopie if supported when –disable-pie is specified.
  [[449355429]](https://git.sudo.ws/sudo/commit/?id=449355429)

2013-03-13 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Document direct execution of the command if the policy plugin has no
  close function.
  [[2e84f169c]](https://git.sudo.ws/sudo/commit/?id=2e84f169c)

2013-03-07 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  Only delete creds if we actually established them. Print an error if
  pam\_setcred() fails and we actually authenticated.
  [[1791721ef]](https://git.sudo.ws/sudo/commit/?id=1791721ef)

* common/Makefile.in, plugins/group\_file/Makefile.in:

  regen
  [[496dc384a]](https://git.sudo.ws/sudo/commit/?id=496dc384a)

* common/alloc.c, include/alloc.h:

  Convert efree() to a macro that just casts to void \* and does free(). If
  the system free() can’t handle free(NULL) this may crash but C89 was a
  long time ago.
  [[d26c0d87f]](https://git.sudo.ws/sudo/commit/?id=d26c0d87f)

* configure, configure.in:

  Define \_REENTRANT for HP-UX when we add -lpthread to SUDO\_LIBS. Fixes a
  problem with errno sometimes not being set on error on HP-UX.
  [[d07d453ab]](https://git.sudo.ws/sudo/commit/?id=d07d453ab)

* common/sudo\_debug.c:

  Fix debug logging from the plugin when there is no error number. This
  was broken in the big debugging reorg for 1.8.7.
  [[1e0a7d511]](https://git.sudo.ws/sudo/commit/?id=1e0a7d511)

2013-03-06 Todd C. Miller

* configure, configure.in, plugins/group\_file/Makefile.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/load\_plugins.c:

  Always install plugins with a .so extension regardless of what extension
  the system uses for shared libraries. That way the group\_plugin sudoers
  setting can be shared between heterogenous systems.
  [[9722784e1]](https://git.sudo.ws/sudo/commit/?id=9722784e1)

* plugins/sudoers/match.c:

  Mac OS X has netgroup functions in netdb.h.
  [[e051df657]](https://git.sudo.ws/sudo/commit/?id=e051df657)

* plugins/sudoers/parse.h:

  Tags in struct cmndtag can be set to IMPLIED as well.
  [[8f7657943]](https://git.sudo.ws/sudo/commit/?id=8f7657943)

* plugins/sudoers/parse.c:

  Quiet a compiler warning.
  [[b0595e6e2]](https://git.sudo.ws/sudo/commit/?id=b0595e6e2)

* plugins/sudoers/testsudoers.c:

  Quiet an llvm checker warning.
  [[4bfeed221]](https://git.sudo.ws/sudo/commit/?id=4bfeed221)

* plugins/sudoers/parse.c:

  Quiet gcc -Wuninitialized false positive
  [[56d45003e]](https://git.sudo.ws/sudo/commit/?id=56d45003e)

2013-03-05 Todd C. Miller

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document group\_file and system\_group plugins.
  [[7d3ce01a0]](https://git.sudo.ws/sudo/commit/?id=7d3ce01a0)

* NEWS:

  Sudo 1.8.7
  [[d695d7be9]](https://git.sudo.ws/sudo/commit/?id=d695d7be9)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Try to clarify that sudoedit in sudoers should not include a leading
  pathname.
  [[8397297de]](https://git.sudo.ws/sudo/commit/?id=8397297de)

* plugins/sudoers/pwutil\_impl.c:

  Make sure groupname\_len is at least 32 just to be on the safe side. It
  is better to allocate a little extra and not need it than to have to
  reallocate and start over.
  [[593832152]](https://git.sudo.ws/sudo/commit/?id=593832152)

* include/alloc.h, include/missing.h:

  Add \_\_malloc\_like macro to apply **malloc** attribute to emalloc,
  ecalloc and estrdup. It cannot be applied to realloc since that may
  return the same pointer.
  [[4e5baccb9]](https://git.sudo.ws/sudo/commit/?id=4e5baccb9)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Fix potential double free in an error path.
  [[c47f5f7ab]](https://git.sudo.ws/sudo/commit/?id=c47f5f7ab)

* src/exec\_pty.c:

  When running the command in a pty, defer the call to exec\_setup() until
  just before we exec the command. This is consistent with the non-pty
  path. As a side effect, the monitor process runs as root and not the
  runas user.
  [[19f37400d]](https://git.sudo.ws/sudo/commit/?id=19f37400d)

2013-03-02 Todd C. Miller

* compat/closefrom.c:

  Update copyright year.
  [[a43318959]](https://git.sudo.ws/sudo/commit/?id=a43318959)

2013-03-01 Todd C. Miller

* compat/closefrom.c:

  Use pst\_highestfd from pstat\_getproc() on HP-UX.
  [[f524c515e]](https://git.sudo.ws/sudo/commit/?id=f524c515e)

2013-02-28 Todd C. Miller

* Makefile.in, common/Makefile.in, doc/Makefile.in,
  plugins/sudoers/Makefile.in:

  Clean up generated test files and other minor housekeeping.
  [[3e6843383]](https://git.sudo.ws/sudo/commit/?id=3e6843383)

* plugins/sudoers/iolog.c:

  Add back gettimeofday() call inadvertantly removed in e1abb9810a83
  [[fa93dede3]](https://git.sudo.ws/sudo/commit/?id=fa93dede3)

* config.h.in, configure, configure.in, src/ttyname.c:

  Use pstat() on HP-UX to determine the tty device.
  [[e30b0bd12]](https://git.sudo.ws/sudo/commit/?id=e30b0bd12)

* plugins/sudoers/auth/pam.c:

  Fix PAM compilation: def\_pam\_session, not just pam\_session.
  [[9a4bd3cce]](https://git.sudo.ws/sudo/commit/?id=9a4bd3cce)

* doc/fixmdoc.sh:

  Don’t remove the -S option description when trimming out selinux. [Bug
  #592](https://bugzilla.sudo.ws/show_bug.cgi?id=592)
  [[af2d4dbfb]](https://git.sudo.ws/sudo/commit/?id=af2d4dbfb)

2013-02-25 Todd C. Miller

* NEWS:

  Update for Sudo 1.8.6p7
  [[1c30fbb71]](https://git.sudo.ws/sudo/commit/?id=1c30fbb71)

2013-02-24 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Document when sudo may exec the command directly instead of forking.
  [[30f63386d]](https://git.sudo.ws/sudo/commit/?id=30f63386d)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Document that close and version be NULL for plugin API >= 1.3 and that
  sudo may execute the command directly if there is no close, or pty or
  timeout needed.
  [[d946fdaa7]](https://git.sudo.ws/sudo/commit/?id=d946fdaa7)

* plugins/sudoers/auth/sudo\_auth.c:

  Fix debug\_decl for sudo\_auth\_begin\_session and sudo\_auth\_end\_session.
  [[0eef336ed]](https://git.sudo.ws/sudo/commit/?id=0eef336ed)

* configure, configure.in, doc/sudoers.cat, doc/sudoers.man.in,
  doc/sudoers.mdoc.in, plugins/sudoers/auth/pam.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c:

  Add pam\_session sudoers option.
  [[59692ad28]](https://git.sudo.ws/sudo/commit/?id=59692ad28)

* plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.h:

  Dummy out close function if there is no end\_session for the auth method
  and the front-end can handle a NULL close function. Avoids the extra
  sudo process when we don’t actually need it.
  [[d3ff0f31e]](https://git.sudo.ws/sudo/commit/?id=d3ff0f31e)

2013-02-23 Todd C. Miller

* Makefile.in, aclocal.m4:

  Add m4/ to paths m4\_include parameters so we don’t need to use
  autoconf’s -I flag.
  [[2b8cb9898]](https://git.sudo.ws/sudo/commit/?id=2b8cb9898)

* src/exec.c, src/exec\_common.c, src/exec\_pty.c, src/sudo\_exec.h,
  src/sudo\_plugin\_int.h:

  If the policy plugin does not provide a close function, there is no
  command timeout and no pty is required, skip the event loop and just
  exec the command directly.
  [[5cb928c51]](https://git.sudo.ws/sudo/commit/?id=5cb928c51)

* src/sudo.c:

  Do not crash if the plugin close and version functions are not defined.
  If there is no policy close function, simply print a warning that the
  command was not found.
  [[5e674a790]](https://git.sudo.ws/sudo/commit/?id=5e674a790)

2013-02-21 Todd C. Miller

* plugins/sudoers/parse.c:

  Fix typos in selinux/solaris privs specific code.
  [[2228763ff]](https://git.sudo.ws/sudo/commit/?id=2228763ff)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  src/parse\_args.c:

  Pass the default plugin directory to the plugin via the settings list.
  Could be used by a stacking plugin.
  [[af4d3489f]](https://git.sudo.ws/sudo/commit/?id=af4d3489f)

* plugins/sudoers/timestamp.c:

  Completely ignore time stamp file if it is set to the epoch, regardless
  of what gettimeofday() returns.
  [[04b25a8bc]](https://git.sudo.ws/sudo/commit/?id=04b25a8bc)

* doc/CONTRIBUTORS:

  Add Nikolai Kondrashov
  [[f336580bb]](https://git.sudo.ws/sudo/commit/?id=f336580bb)

* plugins/sudoers/ldap.c, plugins/sudoers/sssd.c:

  Use userpw\_matches() for username matching so #uid works for
  sudoRunAsUser.
  [[1da8739c3]](https://git.sudo.ws/sudo/commit/?id=1da8739c3)

* plugins/sudoers/sssd.c:

  Avoid calling realloc3() with a zero size parameter when all retrieved
  sssd rules fail. Otherwise we’ll get a run-time error due to malloc(0)
  checking.
  [[b929dd3c4]](https://git.sudo.ws/sudo/commit/?id=b929dd3c4)

* plugins/sudoers/sssd.c:

  Do not send error mail if a user is not found in SSSD. Local users can
  run sudo too. From Nikolai Kondrashov
  [[c80603eac]](https://git.sudo.ws/sudo/commit/?id=c80603eac)

2013-02-20 Todd C. Miller

* MANIFEST, common/regress/sudo\_conf/test4.in,
  common/regress/sudo\_conf/test4.out.ok:

  Test setting disable\_coredump to illegal value.
  [[5d7925b24]](https://git.sudo.ws/sudo/commit/?id=5d7925b24)

* common/sudo\_conf.c:

  Fix atobool() usage.
  [[a17fb1de7]](https://git.sudo.ws/sudo/commit/?id=a17fb1de7)

* common/regress/sudo\_conf/conf\_test.c:

  Remove unused variable.
  [[299298ae4]](https://git.sudo.ws/sudo/commit/?id=299298ae4)

* plugins/sudoers/sudoers.c:

  Make “sudo -l non\_existent\_command” warn that non\_existent\_command
  doesn’t exist, not the “list” pseudo-command.
  [[29becec0e]](https://git.sudo.ws/sudo/commit/?id=29becec0e)

* plugins/sudoers/parse.c:

  Make sudoers file long list output better match the format used by ldap
  sudoers. Tags are now converted to options and there is a single command
  per line.
  [[fa924d09b]](https://git.sudo.ws/sudo/commit/?id=fa924d09b)

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in,
  doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Use the correct the sudoers policy symbol names and undo an editor goof
  committed when adding max\_groups to sudo.conf.
  [[05e53aea0]](https://git.sudo.ws/sudo/commit/?id=05e53aea0)

* plugins/sudoers/parse.c, plugins/sudoers/sudo\_nss.c:

  For “sudo -l” start a new line if the runas list changes to make the
  output easier to read.
  [[064cb0ced]](https://git.sudo.ws/sudo/commit/?id=064cb0ced)

2013-02-19 Todd C. Miller

* plugins/sudoers/parse.c, plugins/sudoers/sudo\_nss.c:

  For “sudo -l” and “sudo -ll” only print the runas info for subsequent
  commands in a list if the runas info has changed. If we have new runas
  info, print out the tags again so as to be less confusing to the user.
  For “sudo -ll” set the line continuation indent to 8.
  [[d00ad3bbe]](https://git.sudo.ws/sudo/commit/?id=d00ad3bbe)

2013-02-18 Todd C. Miller

* MANIFEST, Makefile.in, configure, configure.in, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, plugins/group\_file/Makefile.in,
  plugins/group\_file/getgrent.c, plugins/group\_file/group\_file.c,
  plugins/group\_file/group\_file.exp, plugins/group\_file/plugin\_test.c:

  Rename sample\_group plugin to group\_file. Install group\_file and
  system\_group plugins by default.
  [[e07280eee]](https://git.sudo.ws/sudo/commit/?id=e07280eee)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/iolog.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Add maxseq sudoers option to limit the max number of I/O log files.
  [[b9159ecb2]](https://git.sudo.ws/sudo/commit/?id=b9159ecb2)

2013-02-16 Todd C. Miller

* plugins/sudoers/iolog.c:

  Log lines and columns in the iolog file.
  [[618871a33]](https://git.sudo.ws/sudo/commit/?id=618871a33)

2013-02-15 Todd C. Miller

* MANIFEST, common/Makefile.in, common/regress/sudo\_conf/conf\_test.c,
  common/regress/sudo\_conf/test1.in,
  common/regress/sudo\_conf/test1.out.ok,
  common/regress/sudo\_conf/test2.in,
  common/regress/sudo\_conf/test2.out.ok,
  common/regress/sudo\_conf/test3.in,
  common/regress/sudo\_conf/test3.out.ok, common/sudo\_conf.c,
  include/sudo\_conf.h, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c, src/sesh.c,
  src/sudo.c:

  Add simple regress tests for sudo.conf parsing.
  [[0c40e82c1]](https://git.sudo.ws/sudo/commit/?id=0c40e82c1)

* src/sudo.c:

  Always display the I/O plugin version as long as its open functions
  doesn’t return an error. Previously it was only displayed if the plugin
  open returned 1.
  [[790304789]](https://git.sudo.ws/sudo/commit/?id=790304789)

* plugins/sudoers/pwutil\_impl.c:

  Use sysconf(\_SC\_LOGIN\_NAME\_MAX) to find max username length instead of
  poking around in struct utmpx.
  [[791b75142]](https://git.sudo.ws/sudo/commit/?id=791b75142)

* plugins/sudoers/pwutil\_impl.c, src/parse\_args.c, src/sudo.c:

  #include “sudo\_usage.h” not <sudo\_usage.h> so we get the one in the
  build directory and not the src dir when using a separate build
  directory.
  [[2d9da6588]](https://git.sudo.ws/sudo/commit/?id=2d9da6588)

2013-02-14 Todd C. Miller

* common/fileops.c:

  If a line was longer that 0x80000000 the bit hack to round to the next
  power of two would roll over to zero.
  [[0f0ef228a]](https://git.sudo.ws/sudo/commit/?id=0f0ef228a)

* plugins/sudoers/policy.c, plugins/sudoers/pwutil\_impl.c,
  plugins/sudoers/sudoers.h, src/sudo.c:

  Use max\_groups in front-end and plugin.
  [[d83770034]](https://git.sudo.ws/sudo/commit/?id=d83770034)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  src/parse\_args.c:

  Pass max\_groups to plugin in settings list.
  [[35548ae4e]](https://git.sudo.ws/sudo/commit/?id=35548ae4e)

* common/sudo\_conf.c, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, include/sudo\_conf.h:

  Add max\_groups setting to sudo.conf (currently unused) and remove unused
  return value from setters.
  [[67fed118b]](https://git.sudo.ws/sudo/commit/?id=67fed118b)

2013-02-12 Todd C. Miller

* INSTALL:

  Reorganize configure options
  [[c715df98f]](https://git.sudo.ws/sudo/commit/?id=c715df98f)

2013-02-11 Todd C. Miller

* NEWS:

  Add Sudo 1.8.6p7
  [[6871b25df]](https://git.sudo.ws/sudo/commit/?id=6871b25df)

2013-02-10 Todd C. Miller

* INSTALL.configure:

  Sync with autoconf 2.68
  [[a72c8d7ac]](https://git.sudo.ws/sudo/commit/?id=a72c8d7ac)

* INSTALL, README:

  Remove obsolete OS notes and move build requirements to INSTALL.
  [[d18e05045]](https://git.sudo.ws/sudo/commit/?id=d18e05045)

2013-02-08 Todd C. Miller

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Sort elements of the settings, user\_info and command\_info lists.
  [[987d62ec5]](https://git.sudo.ws/sudo/commit/?id=987d62ec5)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Remove trailing white space
  [[6ba6a454e]](https://git.sudo.ws/sudo/commit/?id=6ba6a454e)

* plugins/sudoers/policy.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/timestamp.c, plugins/sudoers/timestamp.h:

  Store the session ID in the tty ticket file too. A tty may only be in
  one session at a time so if the session ID doesn’t match we ignore the
  ticket.
  [[2e08777f2]](https://git.sudo.ws/sudo/commit/?id=2e08777f2)

2013-02-07 Todd C. Miller

* plugins/sudoers/sudoers.c, src/sudo.c:

  Move tzset() call from sudoers plugin to sudo front end.
  [[af0bb5528]](https://git.sudo.ws/sudo/commit/?id=af0bb5528)

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in,
  doc/sudoers.cat, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in:

  Mention line continuation
  [[74881843e]](https://git.sudo.ws/sudo/commit/?id=74881843e)

* MANIFEST, common/Makefile.in, common/fileops.c,
  common/regress/sudo\_parseln/parseln\_test.c,
  common/regress/sudo\_parseln/test1.in,
  common/regress/sudo\_parseln/test1.out.ok,
  common/regress/sudo\_parseln/test2.in,
  common/regress/sudo\_parseln/test2.out.ok,
  common/regress/sudo\_parseln/test3.in,
  common/regress/sudo\_parseln/test3.out.ok,
  common/regress/sudo\_parseln/test4.in,
  common/regress/sudo\_parseln/test4.out.ok,
  common/regress/sudo\_parseln/test5.in,
  common/regress/sudo\_parseln/test5.out.ok,
  common/regress/sudo\_parseln/test6.in,
  common/regress/sudo\_parseln/test6.out.ok, common/sudo\_conf.c,
  include/fileops.h, plugins/sudoers/env.c, plugins/sudoers/ldap.c,
  plugins/sudoers/sudo\_nss.c:

  Add line continuation support to sudo\_parseln() and make it use
  getline() instead of fgets() internally.
  [[7aae6bd6e]](https://git.sudo.ws/sudo/commit/?id=7aae6bd6e)

2013-02-06 Todd C. Miller

* plugins/sample/sample\_plugin.c:

  Fix memory leak in error path; found by llvm checker
  [[2d6095420]](https://git.sudo.ws/sudo/commit/?id=2d6095420)

* plugins/sudoers/sudoreplay.c:

  Remove useless store detected by llvm checker.
  [[11e04d30d]](https://git.sudo.ws/sudo/commit/?id=11e04d30d)

* configure, configure.in, doc/UPGRADE, mkpkg, src/Makefile.in,
  src/load\_plugins.c, sudo.pp:

  Sudo now stores its libexec files in a “sudo” subdirectory instead of in
  libexec itself. For backwards compatibility, if the plugin is not found
  in the default plugin directory, sudo will check the parent directory
  default directory ends in “/sudo”.
  [[6b09c76a2]](https://git.sudo.ws/sudo/commit/?id=6b09c76a2)

* plugins/sample/sample\_plugin.c, plugins/sample\_group/sample\_group.c,
  plugins/system\_group/system\_group.c:

  Add missing \_\_dso\_public to plugin structs so they are exported.
  [[becc5fca7]](https://git.sudo.ws/sudo/commit/?id=becc5fca7)

* doc/sudo.conf.cat, doc/sudo.conf.man.in, doc/sudo.conf.mdoc.in:

  Mention that sudoers has its own plugins too.
  [[fbb8ea504]](https://git.sudo.ws/sudo/commit/?id=fbb8ea504)

2013-02-05 Todd C. Miller

* doc/visudo.cat, doc/visudo.man.in, doc/visudo.mdoc.in:

  Correct last change date.
  [[b51d1a9f6]](https://git.sudo.ws/sudo/commit/?id=b51d1a9f6)

* doc/sudo.cat, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Remove duplicated sudo.conf info in the sudo, sudoers and sudo\_plugin
  manuals and cross-reference the new sudo.conf manual.
  [[14bf23c4a]](https://git.sudo.ws/sudo/commit/?id=14bf23c4a)

* doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in:

  Fix typos
  [[5debfeeaf]](https://git.sudo.ws/sudo/commit/?id=5debfeeaf)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in:
  Fix some typos.
  [[f6e61640d]](https://git.sudo.ws/sudo/commit/?id=f6e61640d)

* MANIFEST, doc/Makefile.in, doc/sudo.conf.cat, doc/sudo.conf.man.in,
  doc/sudo.conf.mdoc.in:

  Add standalone sudo.conf manual page.
  [[c5816ca6a]](https://git.sudo.ws/sudo/commit/?id=c5816ca6a)

* doc/sample.sudo.conf:

  add group\_source example
  [[f0fdf41d2]](https://git.sudo.ws/sudo/commit/?id=f0fdf41d2)

* configure, configure.in, doc/sample.sudo.conf, doc/sudo.man.in,
  doc/sudo.mdoc.in, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Use PLUGINDIR in the manuals and fix a typo in the sample sudo.conf.
  [[0bd79612b]](https://git.sudo.ws/sudo/commit/?id=0bd79612b)

* plugins/sudoers/po/it.mo, plugins/sudoers/po/it.po, src/po/it.mo,
  src/po/it.po:

  Sync with translationproject.org
  [[380fa828d]](https://git.sudo.ws/sudo/commit/?id=380fa828d)

2013-02-03 Todd C. Miller

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/vi.mo, plugins/sudoers/po/vi.po, src/po/fi.mo,
  src/po/fi.po, src/po/gl.mo, src/po/gl.po, src/po/vi.mo, src/po/vi.po:

  Sync with translationproject.org
  [[e96d58304]](https://git.sudo.ws/sudo/commit/?id=e96d58304)

2013-02-01 Todd C. Miller

* plugins/sudoers/po/da.po, plugins/sudoers/po/eo.mo,
  plugins/sudoers/po/eo.po, src/po/da.po, src/po/eo.mo, src/po/eo.po,
  src/po/es.po, src/po/gl.po:

  Sync with translationproject.org
  [[78ca828a3]](https://git.sudo.ws/sudo/commit/?id=78ca828a3)

2013-01-31 Todd C. Miller

* NEWS:

  Clarify ttyname changes.
  [[9a76946cd]](https://git.sudo.ws/sudo/commit/?id=9a76946cd)

* NEWS:

  Add 1.8.6p6
  [[5fb8749bf]](https://git.sudo.ws/sudo/commit/?id=5fb8749bf)

* src/ttyname.c:

  Remove ttyname() fall back code on systems where we can query the kernel
  for the tty device via /proc or sysctl(). If there is no controlling
  tty, it is better to just treat the tty as unknown rather than to
  blindly use what is hooked up to std{in,out,err}.
  [[23649bef1]](https://git.sudo.ws/sudo/commit/?id=23649bef1)

2013-01-27 Todd C. Miller

* common/sudo\_conf.c, include/sudo\_conf.h, src/sudo.c:

  Add group\_source setting in sudo.conf to allow the admin to specify how
  a user’s groups are looked up. Legal values are static (just the kernel
  list from getgroups), dynamic (whatever the group database includes) and
  adaptive (only use group db if kernel group list is full).
  [[630b47e22]](https://git.sudo.ws/sudo/commit/?id=630b47e22)

* plugins/sudoers/policy.c:

  Pass back exec\_background to front end if it is enabled in sudoers.
  [[8ab7cf61b]](https://git.sudo.ws/sudo/commit/?id=8ab7cf61b)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Mention that exec\_background is for 1.8.7 and higher only.
  [[9ed1f0287]](https://git.sudo.ws/sudo/commit/?id=9ed1f0287)

2013-01-24 Todd C. Miller

* MANIFEST:

  Add missing test files.
  [[479cd25b2]](https://git.sudo.ws/sudo/commit/?id=479cd25b2)

* plugins/sudoers/regress/visudo/test3.err.ok,
  plugins/sudoers/regress/visudo/test3.out.ok,
  plugins/sudoers/regress/visudo/test3.sh:

  Add regress test for bug 361
  [[c2e678d73]](https://git.sudo.ws/sudo/commit/?id=c2e678d73)

* plugins/sudoers/iolog.c:

  Add \_\_dso\_public to extern declaration of declaration to match actual
  definition.
  [[f2beaaa89]](https://git.sudo.ws/sudo/commit/?id=f2beaaa89)

* NEWS:

  Add 1.8.6p5
  [[210ab2449]](https://git.sudo.ws/sudo/commit/?id=210ab2449)

2013-01-23 Todd C. Miller

* MANIFEST, plugins/sudoers/regress/visudo/test2.err.ok,
  plugins/sudoers/regress/visudo/test2.out.ok,
  plugins/sudoers/regress/visudo/test2.sh:

  Add test for visudo cycle check core dump; test case from Daniel Kopecek
  [[db7ea4123]](https://git.sudo.ws/sudo/commit/?id=db7ea4123)

* plugins/sudoers/visudo.c:

  Fix potential stack overflow due to infinite recursion in alias cycle
  detection. From Daniel Kopecek.
  [[6fe6ccb04]](https://git.sudo.ws/sudo/commit/?id=6fe6ccb04)

* common/sudo\_conf.c, include/sudo\_conf.h, src/load\_plugins.c:

  Ignore duplicate entries in sudo.conf and report the line number when
  there is an error. Warn, don’t abort if there is more than one policy
  plugin.
  [[ef8e14124]](https://git.sudo.ws/sudo/commit/?id=ef8e14124)

* plugins/sudoers/tsgetgrpw.c:

  Use strtoul() not atoi().
  [[c00c96801]](https://git.sudo.ws/sudo/commit/?id=c00c96801)

2013-01-22 Todd C. Miller

* compat/Makefile.in:

  regen depends for to add compat/nss\_dbdefs.h for getgrouplist.lo
  [[0fdb89e3b]](https://git.sudo.ws/sudo/commit/?id=0fdb89e3b)

* compat/nss\_dbdefs.h:

  Fix typo that breaks the build on HP-UX.
  [[e1859cac1]](https://git.sudo.ws/sudo/commit/?id=e1859cac1)

* MANIFEST, compat/getgrouplist.c, compat/nss\_dbdefs.h, config.h.in,
  configure, configure.in:

  Use nss\_search() to implement getgrouplist() where available. Tested on
  Solaris and HP-UX. We need to include a compatibility header for HP-UX
  which uses the Solaris nsswitch implementation but doesn’t ship
  nss\_dbdefs.h.
  [[6bc3d4aed]](https://git.sudo.ws/sudo/commit/?id=6bc3d4aed)

2013-01-19 Todd C. Miller

* src/exec.c, src/exec\_pty.c, src/signal.c, src/sudo.h:

  Remove extra flag to sudo\_sigaction(). We want to trap the signal
  regardless of whether or not it is ignored by the underlying command
  since there’s no way to know what signal handlers the command will
  install. Now we just use sudo\_sigaction() to set a flag in
  saved\_signals[] to indicate whether a signal needs to be restored before
  exec.
  [[e76460448]](https://git.sudo.ws/sudo/commit/?id=e76460448)

2013-01-18 Todd C. Miller

* compat/getgrouplist.c, config.h.in, configure, configure.in:

  Use \_getgroupsbymember() on Solaris to get the groups list. Fixes
  performance problems with the getgroupslist() compat on Solaris systems
  with network-based group databases.
  [[a06a14838]](https://git.sudo.ws/sudo/commit/?id=a06a14838)

2013-01-17 Todd C. Miller

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Document signal handler behavior in plugin API 1.3
  [[872e16883]](https://git.sudo.ws/sudo/commit/?id=872e16883)

* MANIFEST, include/sudo\_plugin.h, src/Makefile.in, src/exec.c,
  src/exec\_pty.c, src/signal.c, src/sudo.c, src/sudo.h:

  Move signal code into its own source file and add sudo\_sigaction()
  wrapper that has an extra flag to check the saved\_signals list to only
  install the handler if the signal is not already ignored. Bump plugin
  API version for the new front-end signal behavior.
  [[855a11af2]](https://git.sudo.ws/sudo/commit/?id=855a11af2)

* plugins/sudoers/sudoers.c, src/exec.c, src/sudo.c, src/sudo.h,
  src/sudo\_exec.h:

  Catch SIGINT, SIGQUIT and SIGTSTP in the front end before we execute the
  command. If we get SIGINT or SIGQUIT, call the plugin close() functions
  as if the command was interrupted. If we get SIGTSTP, uninstall the
  handler and deliver SIGTSTP to ourselves.
  [[99704cc10]](https://git.sudo.ws/sudo/commit/?id=99704cc10)

* src/exec.c, src/exec\_pty.c:

  Rename handle\_signals() to dispatch\_signals(). Block other signals in
  handler() so we don’t have to worry about the write() being interrupted.
  [[541315212]](https://git.sudo.ws/sudo/commit/?id=541315212)

2013-01-16 Todd C. Miller

* src/tgetpass.c:

  Rename signal handler to avoid name clash with one in exec.c
  [[2be741d8a]](https://git.sudo.ws/sudo/commit/?id=2be741d8a)

2013-01-13 Todd C. Miller

* src/sudo.c:

  Add missing call to save\_signals().
  [[90c6ace77]](https://git.sudo.ws/sudo/commit/?id=90c6ace77)

2013-01-11 Todd C. Miller

* Makefile.in, plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  Fill in the comment block at the top of the .pot files and preserve it
  when regenerating them.
  [[70976f30e]](https://git.sudo.ws/sudo/commit/?id=70976f30e)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in,
  doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/sudoers.c, src/exec\_pty.c,
  src/sudo.c, src/sudo.h:

  Add exec\_background option in plugin command info and a sudoers option
  to match. When set, commands are started in the background and
  automatically foregrounded as needed. There are issues with some
  ill-mannered programs (like Linux su) so this is not the default.
  [[9479bb623]](https://git.sudo.ws/sudo/commit/?id=9479bb623)

* common/Makefile.in:

  regen
  [[a6f3517f2]](https://git.sudo.ws/sudo/commit/?id=a6f3517f2)

* src/Makefile.in:

  Add SESH\_OBJS variable for sesh object files.
  [[64bf4bb05]](https://git.sudo.ws/sudo/commit/?id=64bf4bb05)

* configure.in, doc/LICENSE, plugins/sudoers/redblack.c:

  Update copyright year.
  [[4bc616b67]](https://git.sudo.ws/sudo/commit/?id=4bc616b67)

* src/exec\_pty.c:

  Always resume the command in the foreground if sudo itself is the
  foreground process. This helps work around poorly behaved programs that
  catch SIGTTOU/SIGTTIN but suspend themselves with SIGSTOP. At worst,
  sudo will go into the background but upon resume the command will be
  runnable. Otherwise, we can get into a situation where the command will
  immediately suspend itself.
  [[8b3edcc4a]](https://git.sudo.ws/sudo/commit/?id=8b3edcc4a)

* configure, configure.in:

  Use -fstack-protector-all in preference to -fstack-protector where
  supported.
  [[adbc8a574]](https://git.sudo.ws/sudo/commit/?id=adbc8a574)

2013-01-10 Todd C. Miller

* configure, configure.in:

  Only test for -fstack-protector and -fvisibility=hidden on GNU
  compatible compilers.
  [[34d018fb9]](https://git.sudo.ws/sudo/commit/?id=34d018fb9)

2013-01-03 Todd C. Miller

* NEWS:

  Add Sudo 1.8.6p4
  [[726a7daa6]](https://git.sudo.ws/sudo/commit/?id=726a7daa6)

* common/Makefile.in, compat/Makefile.in, configure, configure.in,
  plugins/sample/Makefile.in, plugins/sample\_group/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/system\_group/Makefile.in,
  src/Makefile.in:

  Break out stack smashing protector options into SSP\_CFLAGS and
  SSP\_LDFLAGS so we can use it everywhere (unlike LT\_LDFLAGS).
  [[6e560f2ba]](https://git.sudo.ws/sudo/commit/?id=6e560f2ba)

2013-01-01 Todd C. Miller

* doc/CONTRIBUTORS, plugins/sudoers/redblack.c:

  In rbrepair(), make sure we never try to change the color of the
  sentinel node, which is the first entry, not the root. From Michael King
  [[90d58685f]](https://git.sudo.ws/sudo/commit/?id=90d58685f)

2012-12-28 Todd C. Miller

* src/exec\_pty.c:

  No need to restore default signal handler for SIGSTOP as it is not
  catchable. Attempting to do so is harmless but sigaction() will fail and
  set errno to EINVAL which makes it looks like there is an error.
  [[782da0aa8]](https://git.sudo.ws/sudo/commit/?id=782da0aa8)

* src/exec.c:

  Print SIGCONT\_FG and SIGCONT\_BG properly in debug output.
  [[d129290ec]](https://git.sudo.ws/sudo/commit/?id=d129290ec)

2012-12-27 Todd C. Miller

* configure, configure.in:

  Disable PIE on FreeBSD/ia64, otherwise sudo will segfault.
  [[948253a15]](https://git.sudo.ws/sudo/commit/?id=948253a15)

2012-12-20 Todd C. Miller

* include/missing.h:

  Add howmany() macro since some systems have this in sys/param.h which we
  no longer include.
  [[a449e8b3e]](https://git.sudo.ws/sudo/commit/?id=a449e8b3e)

2012-12-07 Todd C. Miller

* plugins/sudoers/regress/sudoers/test11.toke.out.ok:

  Remove errant file.
  [[652d0de98]](https://git.sudo.ws/sudo/commit/?id=652d0de98)

2012-12-04 Todd C. Miller

* plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_fill.c:

  Remove obsolete sudoers\_cleanup() stubs.
  [[3391038d4]](https://git.sudo.ws/sudo/commit/?id=3391038d4)

* common/alloc.c, common/atobool.c, common/fileops.c, common/fmt\_string.c,
  common/lbuf.c, common/secure\_path.c, common/sudo\_conf.c,
  common/sudo\_debug.c, common/term.c, compat/closefrom.c, compat/getcwd.c,
  compat/glob.c, compat/snprintf.c, include/missing.h,
  plugins/sample/sample\_plugin.c, plugins/sample\_group/getgrent.c,
  plugins/sample\_group/plugin\_test.c, plugins/sample\_group/sample\_group.c,
  plugins/sudoers/alias.c, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/boottime.c, plugins/sudoers/check.c,
  plugins/sudoers/defaults.c, plugins/sudoers/env.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/getspwuid.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/interfaces.c, plugins/sudoers/iolog.c,
  plugins/sudoers/ldap.c, plugins/sudoers/logging.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/parse.c, plugins/sudoers/policy.c,
  plugins/sudoers/prompt.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil\_impl.c, plugins/sudoers/redblack.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestamp.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/toke\_util.c,
  plugins/sudoers/tsgetgrpw.c, plugins/sudoers/visudo.c,
  plugins/system\_group/system\_group.c, src/conversation.c, src/exec.c,
  src/exec\_common.c, src/exec\_pty.c, src/get\_pty.c, src/load\_plugins.c,
  src/net\_ifs.c, src/parse\_args.c, src/sudo.c, src/sudo\_edit.c,
  src/tgetpass.c, src/ttyname.c, src/utmp.c:

  Don’t include <sys/param.h>. We only needed it for MAXPATHLEN,
  MAXHOSTNAMELEN and the MIN/MAX macros. We now use PATH\_MAX and
  HOST\_NAME\_MAX throughout without falling back on MAXPATHLEN or
  MAXHOSTNAMELEN and define our own MIN/MAX macros as needed.
  [[1d7072fe0]](https://git.sudo.ws/sudo/commit/?id=1d7072fe0)

* include/missing.h, plugins/sudoers/match.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c, src/sudo.c:

  Use MAX\_HOST\_NAME+1 (limits.h) instead of MAXHOSTNAMELEN (sys/param.h or
  netdb.h).
  [[3c9da162e]](https://git.sudo.ws/sudo/commit/?id=3c9da162e)

2012-11-30 Todd C. Miller

* plugins/sudoers/logging.c:

  Move debug\_decl() in log\_failure() to be after the variable declarations
  for C89.
  [[9a1889a61]](https://git.sudo.ws/sudo/commit/?id=9a1889a61)

2012-11-29 Todd C. Miller

* common/error.c, include/error.h, plugins/sudoers/iolog.c,
  plugins/sudoers/logging.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Cannot wrap sigsetjmp() or we end up returning to the wrong place. Use a
  macro instead.
  [[b7ae7977a]](https://git.sudo.ws/sudo/commit/?id=b7ae7977a)

2012-11-28 Todd C. Miller

* plugins/sudoers/policy.c:

  Fix return in sudoers\_policy\_open that should be debug\_return.
  [[02ad501ec]](https://git.sudo.ws/sudo/commit/?id=02ad501ec)

2012-11-27 Todd C. Miller

* src/ttyname.c:

  Define sudo\_ttyname\_dev() for the HAVE\_STRUCT\_PSINFO\_PR\_TTYDEV case too.
  [[d3ab8b080]](https://git.sudo.ws/sudo/commit/?id=d3ab8b080)

* src/solaris.c:

  Quiet a gcc warning and add comment about needing to keep the handle
  open.
  [[dd5d0eada]](https://git.sudo.ws/sudo/commit/?id=dd5d0eada)

2012-11-26 Todd C. Miller

* INSTALL:

  mention –disable-shared
  [[a94e94cf8]](https://git.sudo.ws/sudo/commit/?id=a94e94cf8)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Add missing command\_info argument in I/O plugin open() prototype. [Bug
  #579](https://bugzilla.sudo.ws/show_bug.cgi?id=579)
  [[94e2b1fbd]](https://git.sudo.ws/sudo/commit/?id=94e2b1fbd)

2012-11-25 Todd C. Miller

* plugins/sudoers/gram.c:

  Regen for proper line numbers.
  [[1660c2692]](https://git.sudo.ws/sudo/commit/?id=1660c2692)

* configure, configure.in:

  Add locale\_stub.o to SUDO\_OBJS, not locale\_stub.lo.
  [[415dc8297]](https://git.sudo.ws/sudo/commit/?id=415dc8297)

* common/sudo\_printf.c:

  Include missing.h for \_\_printflike.
  [[14e5f35d4]](https://git.sudo.ws/sudo/commit/?id=14e5f35d4)

* plugins/sudoers/iolog.c:

  Saner loop invariant in io\_mkdirs (cosmetic only).
  [[727be2989]](https://git.sudo.ws/sudo/commit/?id=727be2989)

* MANIFEST, common/Makefile.in, common/error.c, common/sudo\_printf.c,
  configure, configure.in, include/error.h, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/locale.c,
  plugins/sudoers/logging.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c, src/Makefile.in, src/error.c, src/exec\_pty.c,
  src/locale\_stub.c, src/sesh.c:

  Move warn/error into common and make static builds work.
  [[2632ec7e6]](https://git.sudo.ws/sudo/commit/?id=2632ec7e6)

* MANIFEST, common/Makefile.in, common/sudo\_debug.c, common/sudo\_printf.c,
  include/error.h, plugins/sudoers/Makefile.in, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/iolog.c,
  plugins/sudoers/plugin\_error.c, plugins/sudoers/policy.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_fill.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c, src/Makefile.in, src/conversation.c,
  src/sesh.c:

  Move \_sudo\_printf from src/conversation.c to common/sudo\_printf.c. Add
  sudo\_printf function pointer that is initialized to \_sudo\_printf()
  instead of requiring a sudo\_conv function pointer everywhere. The plugin
  will reset sudo\_printf to point to the version passed in via the plugin
  open function. Now plugin\_error.c can just call sudo\_printf in all
  cases. The sudoers binaries no longer need their own version of
  sudo\_printf.
  [[c2c6616a0]](https://git.sudo.ws/sudo/commit/?id=c2c6616a0)

* plugins/sudoers/iolog.c, plugins/sudoers/logging.c,
  plugins/sudoers/plugin\_error.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Add plugin\_setjmp() wrapper for siglongjmp(error\_jmp, 1) so we don’t
  need error\_jmp to be extern. Also add plugin\_clearjmp() that clears a
  flag so error()/errorx() knows when to call exit() vs. longjmp().
  [[5496ffe1e]](https://git.sudo.ws/sudo/commit/?id=5496ffe1e)

* plugins/sudoers/set\_perms.c:

  Let warning() call gettext() for us.
  [[d658d1219]](https://git.sudo.ws/sudo/commit/?id=d658d1219)

* include/error.h, plugins/sudoers/plugin\_error.c, src/error.c:

  Do locale swapping in the warning()/error() macros themselves instead of
  in the underlying functions.
  [[88c6446da]](https://git.sudo.ws/sudo/commit/?id=88c6446da)

* common/alloc.c, common/list.c, include/error.h, plugins/sudoers/env.c,
  plugins/sudoers/plugin\_error.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/visudo.c, src/error.c,
  src/hooks.c:

  Rename warning2()/error2() -> warning\_nodebug()/error\_nodebug().
  [[4bde57b8b]](https://git.sudo.ws/sudo/commit/?id=4bde57b8b)

* common/sudo\_conf.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/defaults.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/ldap.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/logging.c, plugins/sudoers/plugin\_error.c,
  plugins/sudoers/policy.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c, src/error.c,
  src/exec.c, src/exec\_common.c, src/exec\_pty.c, src/load\_plugins.c,
  src/net\_ifs.c, src/parse\_args.c, src/selinux.c, src/sesh.c,
  src/solaris.c, src/sudo.c, src/sudo\_edit.c, src/tgetpass.c:

  Call gettext() on parameters for warning()/warningx() instead of having
  warning() do it for us.
  [[7b3d26868]](https://git.sudo.ws/sudo/commit/?id=7b3d26868)

* Makefile.in, plugins/sudoers/alias.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c:

  Call gettext() in sudoerserror() in the user’s locale and pass the
  untranslated string to it.
  [[15c69e0e3]](https://git.sudo.ws/sudo/commit/?id=15c69e0e3)

* plugins/sudoers/Makefile.in, plugins/sudoers/locale.c,
  plugins/sudoers/logging.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Allow sudoers programs (visudo, sudoreplay, visudo) to use
  plugin\_error.c instead of the error.c from the front-end. This means
  sudoers\_setlocale() needs to be independent of the sudo\_user struct and
  the defaults table. The sudoers locale is now updated via a callback.
  [[90147bb60]](https://git.sudo.ws/sudo/commit/?id=90147bb60)

* plugins/sudoers/iolog.c, plugins/sudoers/logging.c,
  plugins/sudoers/plugin\_error.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Include setjmp.h in sudoers.h Move error\_jmp into plugin\_error.c Rename
  sudoers\_plugin\_cleanup sudoers\_cleanup Make sudoers warning/error
  functions work when sudo\_conv is NULL
  [[3e5bd8dc5]](https://git.sudo.ws/sudo/commit/?id=3e5bd8dc5)

* src/error.c:

  No need to change locale in front-end warning()/error().
  [[3b5f78699]](https://git.sudo.ws/sudo/commit/?id=3b5f78699)

* plugins/sudoers/tsgetgrpw.c:

  Ignore bad lines in passwd/group file instead if stopping processing
  when we hit one.
  [[e81eb5b00]](https://git.sudo.ws/sudo/commit/?id=e81eb5b00)

* plugins/sudoers/regress/testsudoers/test2.sh,
  plugins/sudoers/regress/testsudoers/test3.sh,
  plugins/sudoers/regress/testsudoers/test5.sh:

  Bash doesn’t let you set UID to use MYUID instead.
  [[cca915e39]](https://git.sudo.ws/sudo/commit/?id=cca915e39)

* plugins/sudoers/visudo.c:

  Avoid NULL deref for unknown Defaults in strict mode.
  [[056c08a5b]](https://git.sudo.ws/sudo/commit/?id=056c08a5b)

* common/sudo\_conf.c, common/sudo\_debug.c:

  See DEFAULT\_TEXT\_DOMAIN
  [[6849fff4d]](https://git.sudo.ws/sudo/commit/?id=6849fff4d)

2012-11-13 Todd C. Miller

* .hgignore:

  Add signame.c and mksigname.
  [[6e3965160]](https://git.sudo.ws/sudo/commit/?id=6e3965160)

* plugins/sudoers/Makefile.in:

  Fold preinstall into install-plugin and pass the path to the plugin
  binary to the preinstall command.
  [[5e09ae9b7]](https://git.sudo.ws/sudo/commit/?id=5e09ae9b7)

* pp:

  sync with upstream
  [[c46a6a5b2]](https://git.sudo.ws/sudo/commit/?id=c46a6a5b2)

* src/sudo.h:

  repair spacing
  [[8195fe1bd]](https://git.sudo.ws/sudo/commit/?id=8195fe1bd)

2012-11-12 Todd C. Miller

* common/sudo\_debug.c:

  Set group on sudo\_debug when creating it to gid 0 so systems without BSD
  group semantics don’t get the invoking user’s group.
  [[0178d5ae0]](https://git.sudo.ws/sudo/commit/?id=0178d5ae0)

* plugins/sudoers/iolog.c:

  Rename mkdir\_parents() io\_mkdirs() and add a flag to specify whether
  path is a temporary, in which case the final component is created via
  mkdtemp() instead of mkdir().
  [[edf088182]](https://git.sudo.ws/sudo/commit/?id=edf088182)

* plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.h:

  For PERM\_ROOT set egid to 0 so log files are not created with the gid of
  the user.
  [[cab6b976d]](https://git.sudo.ws/sudo/commit/?id=cab6b976d)

* plugins/sudoers/logging.c:

  Add calls to set\_perms(PERM\_ROOT) becore logging to a file. We should
  already be root but since we cache the current permission status it is
  basically free. That way, if more of sudoers runs as non-root in the
  future logging will still work correctly.
  [[02aa965a2]](https://git.sudo.ws/sudo/commit/?id=02aa965a2)

* common/sudo\_conf.c, config.h.in, configure, configure.in,
  include/gettext.h, plugins/sudoers/locale.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c, src/error.c, src/exec.c, src/sesh.c,
  src/sudo.c:

  #unifdef HAVE\_SETLOCALE, it is C89 so no need to check for it.
  [[acf8af9aa]](https://git.sudo.ws/sudo/commit/?id=acf8af9aa)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in:

  Mention that sudo.conf is parsed in the C locale.
  [[648590658]](https://git.sudo.ws/sudo/commit/?id=648590658)

* common/sudo\_conf.c:

  Parse sudo.conf in the “C” locale.
  [[4bd4a9171]](https://git.sudo.ws/sudo/commit/?id=4bd4a9171)

* plugins/sudoers/locale.c, plugins/sudoers/logging.h,
  plugins/sudoers/sudoers.h:

  Fix compilation on systems w/o setlocale()
  [[336021a9c]](https://git.sudo.ws/sudo/commit/?id=336021a9c)

* doc/TROUBLESHOOTING:

  Sudo now includes a workaround for the Solaris 11 locale issue.
  [[5957c88f4]](https://git.sudo.ws/sudo/commit/?id=5957c88f4)

2012-11-11 Todd C. Miller

* include/gettext.h, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/locale.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c, src/error.c,
  src/exec.c, src/sesh.c, src/sudo.c, src/sudo.h:

  Always include locale.h from gettext.h so we no longer need to include
  locale.h from the .c files.
  [[c1db4b154]](https://git.sudo.ws/sudo/commit/?id=c1db4b154)

* MANIFEST, config.h.in, configure, configure.in, mkdep.pl,
  plugins/sudoers/Makefile.in, src/Makefile.in, src/openbsd.c,
  src/solaris.c, src/sudo.c, src/sudo.h:

  Add os-specific initialization functions for solaris (workaround setuid
  locale problem in Solaris 11) and openbsd (set malloc\_options if
  SUDO\_DEVEL). Also move set\_project() to solaris.c.
  [[83dde2fbb]](https://git.sudo.ws/sudo/commit/?id=83dde2fbb)

2012-11-09 Todd C. Miller

* plugins/sudoers/find\_path.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/iolog.c, plugins/sudoers/policy.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/timestamp.c:

  Avoid strerror() when possible and just rely on warning/error to handle
  errno in the proper locale.
  [[56de023de]](https://git.sudo.ws/sudo/commit/?id=56de023de)

* plugins/sudoers/logging.c:

  Set sudoers locale in log\_allowed()
  [[e28ce01fe]](https://git.sudo.ws/sudo/commit/?id=e28ce01fe)

* plugins/sudoers/check.c:

  Make the sudo lecture translatable.
  [[69cb0c321]](https://git.sudo.ws/sudo/commit/?id=69cb0c321)

* Makefile.in:

  Add the values of badpass\_message, passprompt and mailsub to sudoers.pot
  so they can be translated.
  [[5e637ad83]](https://git.sudo.ws/sudo/commit/?id=5e637ad83)

* plugins/sudoers/logging.c:

  Expand the FMT\_FIRST anf FMT\_CONTD macros inline so they get picked up
  by xgettext.
  [[693e6767f]](https://git.sudo.ws/sudo/commit/?id=693e6767f)

2012-11-08 Todd C. Miller

* plugins/sudoers/check.c, plugins/sudoers/prompt.c,
  plugins/sudoers/sudoers.h:

  Make expand\_prompt() args const and free the prompt when we are done
  with it.
  [[6a7884d47]](https://git.sudo.ws/sudo/commit/?id=6a7884d47)

* plugins/sudoers/policy.c:

  Fix cut and pasto
  [[e88c8941d]](https://git.sudo.ws/sudo/commit/?id=e88c8941d)

* plugins/sudoers/defaults.c, plugins/sudoers/logging.c:

  Expand def\_mailsub in the sudoers locale, not the user’s.
  [[cac7ca6a6]](https://git.sudo.ws/sudo/commit/?id=cac7ca6a6)

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/check.c,
  plugins/sudoers/env.c, plugins/sudoers/iolog.c,
  plugins/sudoers/locale.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/parse.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/timestamp.c:

  Call gettext inside log\_error et al instead of having the caller do it.
  This way we can display any messages to the user in their own locale but
  log in the sudoers local.
  [[a0c53bd75]](https://git.sudo.ws/sudo/commit/?id=a0c53bd75)

* common/sudo\_conf.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/defaults.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/ldap.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/logging.c, plugins/sudoers/plugin\_error.c,
  plugins/sudoers/policy.c, plugins/sudoers/sssd.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/visudo.c, src/error.c, src/exec.c, src/exec\_common.c,
  src/exec\_pty.c, src/load\_plugins.c, src/net\_ifs.c, src/parse\_args.c,
  src/selinux.c, src/sesh.c, src/sudo.c, src/sudo\_edit.c, src/tgetpass.c:

  Display warning/error messages in the user’s locale.
  [[595d3b265]](https://git.sudo.ws/sudo/commit/?id=595d3b265)

* plugins/sudoers/audit.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/logging.c, plugins/sudoers/sudoers.c:

  audit\_failure() now calls gettext itself using the sudoers locale.
  [[f454a852c]](https://git.sudo.ws/sudo/commit/?id=f454a852c)

* plugins/sudoers/iolog\_path.c, plugins/sudoers/logging.c,
  plugins/sudoers/sudoers.c:

  Convert setlocale() to sudoers\_setlocale() in the sudoers module. This
  only converts existing uses, there are more places where we need to
  sprinkle sudoers\_setlocale() calls.
  [[3f82a3407]](https://git.sudo.ws/sudo/commit/?id=3f82a3407)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/env.c,
  plugins/sudoers/locale.c, plugins/sudoers/logging.h,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Add simple locale switching to make it easy to switch from the user’s
  locale to the sudoers locale without making excessive setlocale() calls
  when we don’t need to.
  [[4207589fe]](https://git.sudo.ws/sudo/commit/?id=4207589fe)

* common/sudo\_debug.c, include/error.h, include/sudo\_debug.h,
  plugins/sudoers/plugin\_error.c, src/error.c:

  Add variants of warn/error and sudo\_debug\_printf that take a va\_list
  instead of a variable number of args.
  [[f8660f998]](https://git.sudo.ws/sudo/commit/?id=f8660f998)

* INSTALL, doc/TROUBLESHOOTING:

  Document Solaris 11 locale issues and workarounds.
  [[56857f7f0]](https://git.sudo.ws/sudo/commit/?id=56857f7f0)

* Makefile.in, configure, configure.in:

  Solaris gettext() looks in lang.UTF-8, not just lang for UTF-8 locales.
  Make links from localdir/lang -> localdir/lang.UTF-8
  [[9d2dc4c30]](https://git.sudo.ws/sudo/commit/?id=9d2dc4c30)

2012-11-06 Todd C. Miller

* plugins/sudoers/audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/sudoers.c:

  Do not inform the user that the command was not permitted by the policy
  if they do not successfully authenticate. This is a regression
  introduced in sudo 1.8.6.
  [[5d052aeb6]](https://git.sudo.ws/sudo/commit/?id=5d052aeb6)

* plugins/sudoers/Makefile.in:

  Add preinstall target that runs SUDO\_PREINSTALL\_CMD. Used to fixup the
  rpath in HP-UX SOM shared libraries for the LDAP libs.
  [[941d759c5]](https://git.sudo.ws/sudo/commit/?id=941d759c5)

* src/parse\_args.c:

  The -a option should be #ifdef HAVE\_BSD\_AUTH\_H, not -A.
  [[e6207003b]](https://git.sudo.ws/sudo/commit/?id=e6207003b)

2012-10-28 Todd C. Miller

* INSTALL, configure, configure.in:

  Allow the user to specify and alternate libtool
  [[0586a5e28]](https://git.sudo.ws/sudo/commit/?id=0586a5e28)

2012-10-26 Todd C. Miller

* doc/CONTRIBUTORS, plugins/sudoers/sudo\_nss.c:

  Allow sudo to be build with sss support without also including ldap
  support. From Stephane Graber.
  [[68376c138]](https://git.sudo.ws/sudo/commit/?id=68376c138)

2012-10-25 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/logging.c, plugins/sudoers/plugin\_error.c,
  plugins/sudoers/policy.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Refactor policy plugin interface code from sudoers.c into policy.c
  [[475662aaa]](https://git.sudo.ws/sudo/commit/?id=475662aaa)

* plugins/sudoers/iolog.c, plugins/sudoers/sudoers.c:

  Refactor command\_info setting into its own function.
  [[3651377e1]](https://git.sudo.ws/sudo/commit/?id=3651377e1)

* plugins/sudoers/interfaces.c, plugins/sudoers/interfaces.h,
  plugins/sudoers/match\_addr.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Make interfaces pointer private to interfaces.c and add get\_interfaces()
  accessor.
  [[929aef075]](https://git.sudo.ws/sudo/commit/?id=929aef075)

2012-10-24 Todd C. Miller

* plugins/sudoers/iolog\_path.c, plugins/sudoers/logging.c,
  plugins/sudoers/sudoers.h:

  Make user\_cwd const since it is either a string literal or passed in
  from the front-end.
  [[319fe95d0]](https://git.sudo.ws/sudo/commit/?id=319fe95d0)

* configure, configure.in:

  sudo 1.8.7
  [[8aca292b2]](https://git.sudo.ws/sudo/commit/?id=8aca292b2)

* plugins/sudoers/sudoers.c:

  Avoid nested strtok() calls.
  [[4134b24ec]](https://git.sudo.ws/sudo/commit/?id=4134b24ec)

2012-10-23 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/check.c,
  plugins/sudoers/prompt.c, plugins/sudoers/sudoers.h:

  Move expand\_prompt() into its own source file for easier unit testing.
  [[2b23d2b12]](https://git.sudo.ws/sudo/commit/?id=2b23d2b12)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/check.c,
  plugins/sudoers/check.h, plugins/sudoers/sudoers.h,
  plugins/sudoers/timestamp.c, plugins/sudoers/timestamp.h:

  Make check.c independent of the underlying timestamp implementation.
  [[0a7af2303]](https://git.sudo.ws/sudo/commit/?id=0a7af2303)

* plugins/sudoers/iolog\_path.c:

  Add SUDOERS\_NO\_SEQ define to allow ${seq} to be disabled.
  [[fb037caff]](https://git.sudo.ws/sudo/commit/?id=fb037caff)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Use a list for the possible values of Tag\_Spec with a minimal indent to
  improve readability. In the pod version, these were =head3. Also use .St
  -p1003.1 instead of just POSIX when talking about glob() and fnmatch().
  [[3442a0aea]](https://git.sudo.ws/sudo/commit/?id=3442a0aea)

2012-10-02 Todd C. Miller

* src/ttyname.c:

  sudo\_ttyname\_dev() is unused if there is no /proc or sysctl().
  [[84eedd3f7]](https://git.sudo.ws/sudo/commit/?id=84eedd3f7)

* compat/mksiglist.c, compat/mksigname.c,
  compat/regress/fnmatch/fnm\_test.c, compat/regress/glob/globtest.c,
  plugins/sample\_group/plugin\_test.c,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c, src/sesh.c, src/sudo.c:

  Explicitly mark main() as public in executables to avoid an HP-UX ld
  warning.
  [[a3a1574cd]](https://git.sudo.ws/sudo/commit/?id=a3a1574cd)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in:

  Remove grep from SEE ALSO section.
  [[09140fd1a]](https://git.sudo.ws/sudo/commit/?id=09140fd1a)

* common/alloc.c:

  If vasprintf() fails, just use the errno it sets instead of assuming
  ENOMEM.
  [[1cf3def4b]](https://git.sudo.ws/sudo/commit/?id=1cf3def4b)

2012-09-28 Todd C. Miller

* doc/TROUBLESHOOTING:

  Mention HP-UX pam.conf settings.
  [[acb9c6298]](https://git.sudo.ws/sudo/commit/?id=acb9c6298)

2012-09-27 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/check.c,
  plugins/sudoers/defaults.c, plugins/sudoers/timestamp.c,
  plugins/sudoers/timestamp.h:

  Split off timestamp functions into their own source file.
  [[0fa33ccf0]](https://git.sudo.ws/sudo/commit/?id=0fa33ccf0)

2012-09-26 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Mention how !foo is not the same as ALL,!foo
  [[05896f9cf]](https://git.sudo.ws/sudo/commit/?id=05896f9cf)

2012-09-25 Todd C. Miller

* src/exec\_pty.c:

  Start commands in the background when I/O logging is enabled. We can’t
  do this on Mac OS X due to a kernel bug in tc[gs]etattr(2) which returns
  EINTR on signal instead of restarting automatically.
  [[592f6fefb]](https://git.sudo.ws/sudo/commit/?id=592f6fefb)

* src/exec\_pty.c:

  Handle SIGCONT\_FG and SIGCONT\_BG when converting signal number to string
  in deliver\_signal().
  [[616d713e9]](https://git.sudo.ws/sudo/commit/?id=616d713e9)

2012-09-24 Todd C. Miller

* src/exec\_pty.c:

  Fix running commands that need the terminal in the background when I/O
  logging is enabled. E.g. “sudo vi &”. When the command is foregrounded,
  it will now resume properly.
  [[0e94e8ca9]](https://git.sudo.ws/sudo/commit/?id=0e94e8ca9)

* plugins/sudoers/match.c:

  Add rudimentary support for name-based matching as a compile-time
  option. This unsafe when used in conjunction with the ‘!’ operator.
  [[6a25affb4]](https://git.sudo.ws/sudo/commit/?id=6a25affb4)

2012-09-21 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/pwutil.c,
  plugins/sudoers/pwutil.h, plugins/sudoers/pwutil\_impl.c:

  Split out implementation-specific back end code out of pwutil.c into
  pwutil\_impl.c. This will allow the main pwutil code to be used for
  lookup methods other than getpw\* and getgr\*.
  [[883e0ec3c]](https://git.sudo.ws/sudo/commit/?id=883e0ec3c)

2012-09-18 Todd C. Miller

* NEWS, configure, configure.in:

  sudo 1.8.6p3
  [[a7ce1909f]](https://git.sudo.ws/sudo/commit/?id=a7ce1909f)

2012-09-17 Todd C. Miller

* doc/fixman.sh:

  Don’t use embedded newline when matching, use \n. This got expanded at
  some point. [Bug #573](https://bugzilla.sudo.ws/show_bug.cgi?id=573)
  [[4446e22a9]](https://git.sudo.ws/sudo/commit/?id=4446e22a9)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Rename yyerror() to sudoerserror() to match yacc prefix changes. Not
  really needed due to the #defines that yacc makes but it is less
  confusing this way as the lexer calls sudoerserror().
  [[7f36643a6]](https://git.sudo.ws/sudo/commit/?id=7f36643a6)

* common/alloc.c, plugins/sample\_group/plugin\_test.c,
  plugins/sudoers/env.c, plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, src/exec\_common.c, src/parse\_args.c,
  src/sudo.c:

  No need to translate “unable to allocate memory” when we can just use
  the system translation via strerror().
  [[1d90c0ad7]](https://git.sudo.ws/sudo/commit/?id=1d90c0ad7)

* plugins/sudoers/sudoreplay.c:

  Fall back on lstat(2) if d\_type in struct dirent is DT\_UNKNOWN. Not all
  file systems support d\_type. [Bug
  #572](https://bugzilla.sudo.ws/show_bug.cgi?id=572)
  [[f808fead0]](https://git.sudo.ws/sudo/commit/?id=f808fead0)

* plugins/sudoers/sudoreplay.c:

  Avoid calling fclose(NULL) in the error path when we cannot open an I/O
  log file.
  [[37d70a999]](https://git.sudo.ws/sudo/commit/?id=37d70a999)

2012-09-16 Todd C. Miller

* NEWS, configure, configure.in:

  Sudo 1.8.6p2
  [[0c94a95ef]](https://git.sudo.ws/sudo/commit/?id=0c94a95ef)

* src/exec.c:

  When setting the signal handler for SIGTSTP to the default value in
  non-I/O log mode, store the old handler value for when we restore it
  after resume.
  [[885b6e7cd]](https://git.sudo.ws/sudo/commit/?id=885b6e7cd)

* plugins/sudoers/env.c:

  Replace the guts of sudo\_setenv\_nodebug() with our old setenv.c which
  supports non-standard BSD and glibc semantics. sudo\_setenv() now simply
  calls sudo\_setenv2().
  [[faf112c53]](https://git.sudo.ws/sudo/commit/?id=faf112c53)

2012-09-15 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.mdoc.in, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document non-Unix group support in LDAP sudoers.
  [[3c34c0a4b]](https://git.sudo.ws/sudo/commit/?id=3c34c0a4b)

* plugins/sudoers/ldap.c:

  Enable non-Unix group support for LDAP sudoers. We now check for
  non-Unix groups and netgroups with the same query in the second pass.
  [Bug #571](https://bugzilla.sudo.ws/show_bug.cgi?id=571)
  [[bdf93e8d3]](https://git.sudo.ws/sudo/commit/?id=bdf93e8d3)

2012-09-14 Todd C. Miller

* plugins/sudoers/Makefile.in, plugins/sudoers/gram.c,
  plugins/sudoers/gram.h, plugins/sudoers/parse.c,
  plugins/sudoers/regress/parser/check\_fill.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c:

  Set yacc prefix to “sudoers” to avoid conflicts other yacc parsers.
  [[5276ab3a5]](https://git.sudo.ws/sudo/commit/?id=5276ab3a5)

2012-09-12 Todd C. Miller

* NEWS:

  Mention support for SUCCESS=return in /etc/nsswitch.conf
  [[0c9083b14]](https://git.sudo.ws/sudo/commit/?id=0c9083b14)

* NEWS, configure, configure.in:

  sudo 1.8.6p1
  [[824092b88]](https://git.sudo.ws/sudo/commit/?id=824092b88)

2012-09-11 Todd C. Miller

* plugins/sudoers/env.c:

  Avoid setting LOGNAME, USER and USERNAME variables twice when
  set\_logname is enabled.
  [[40d0492a4]](https://git.sudo.ws/sudo/commit/?id=40d0492a4)

* plugins/sudoers/env.c:

  Fix duplicate detection in sudo\_putenv(), do not prune out the variable
  we just set when overwriting an existing instance. Fixes bug #570
  [[6beab1914]](https://git.sudo.ws/sudo/commit/?id=6beab1914)

* plugins/sudoers/env.c:

  Add some debuggging
  [[d2a46c0f8]](https://git.sudo.ws/sudo/commit/?id=d2a46c0f8)

2012-09-04 Todd C. Miller

* plugins/sudoers/sudo\_nss.c:

  Disable word wrap in list mode when stdout is a pipe to make “sudo -l |
  grep …” more useful. Adapted from a diff by Daniel Kopecek.
  [[3af7a0daf]](https://git.sudo.ws/sudo/commit/?id=3af7a0daf)

* common/lbuf.c:

  Print a trailing newline in lbuf\_print() when there is not enough space
  to do word wrapping and the lbuf does not end with a newline.
  [[e5257d48d]](https://git.sudo.ws/sudo/commit/?id=e5257d48d)

* plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c:

  Add support for [SUCCESS=return] in nsswitch.conf; from Daniel Kopecek
  [[d787df3c1]](https://git.sudo.ws/sudo/commit/?id=d787df3c1)

* MANIFEST:

  Add sssd.c
  [[2068d941b]](https://git.sudo.ws/sudo/commit/?id=2068d941b)

2012-09-01 Todd C. Miller

* plugins/sudoers/po/da.mo, plugins/sudoers/po/fi.mo,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/sl.mo,
  plugins/sudoers/po/uk.mo, src/po/fi.mo, src/po/hr.mo, src/po/it.mo,
  src/po/ru.mo, src/po/sl.mo, src/po/uk.mo, src/po/vi.mo:

  regen .po files
  [[a71e685aa]](https://git.sudo.ws/sudo/commit/?id=a71e685aa)

* MANIFEST, plugins/sudoers/po/vi.mo:

  Add Vietnamese sudoers translation from translationproject.org
  [[8de12a2bc]](https://git.sudo.ws/sudo/commit/?id=8de12a2bc)

* NEWS:

  mention PIE
  [[cab82ddcf]](https://git.sudo.ws/sudo/commit/?id=cab82ddcf)

* MANIFEST, plugins/sudoers/po/vi.po:

  Add Vietnamese sudoers translation from translationproject.org
  [[4380a60a9]](https://git.sudo.ws/sudo/commit/?id=4380a60a9)

2012-08-29 Todd C. Miller

* Makefile.in, compat/Makefile.in, mkdep.pl:

  Add missing signame dependency
  [[4017e63b9]](https://git.sudo.ws/sudo/commit/?id=4017e63b9)

* src/exec.c, src/ttyname.c:

  Silence compiler warnings.
  [[ae21fb299]](https://git.sudo.ws/sudo/commit/?id=ae21fb299)

* MANIFEST, compat/Makefile.in, compat/sig2str.c, config.h.in, configure,
  configure.in, include/missing.h, mkdep.pl, src/exec.c, src/exec\_pty.c:

  Replace strsigname() with sig2str(), emulating it as needed.
  [[ab7dda035]](https://git.sudo.ws/sudo/commit/?id=ab7dda035)

* config.h.in, configure, configure.in, src/utmp.c:

  Use fseeko() for legacy utmp handling if available.
  [[71e2d8290]](https://git.sudo.ws/sudo/commit/?id=71e2d8290)

2012-08-28 Todd C. Miller

* compat/strsigname.c, config.h.in, configure, configure.in:

  Detect sys\_sigabbrev[] and use it in place of sys\_signame[] if present.
  For some reason glibc does not declare sys\_sigabbrev so we must add an
  extern definition of our own.
  [[f44afdc42]](https://git.sudo.ws/sudo/commit/?id=f44afdc42)

* compat/strsignal.c, compat/strsigname.c:

  Handle NULL entries in sys\_siglist and sys\_signame.
  [[af4f02d3e]](https://git.sudo.ws/sudo/commit/?id=af4f02d3e)

* compat/mksiglist.c, compat/mksiglist.h, compat/mksigname.c,
  compat/mksigname.h, compat/strsignal.c, compat/strsigname.c:

  Convert my\_sys\_sig{list,name} -> sudo\_sys\_sig{list,name}
  [[24991069f]](https://git.sudo.ws/sudo/commit/?id=24991069f)

2012-08-27 Todd C. Miller

* NEWS:

  sync
  [[a371c50f0]](https://git.sudo.ws/sudo/commit/?id=a371c50f0)

* src/exec.c:

  Pass on SIGTSTP to the command if it was sent by a user process (not the
  kernel or the terminal) when we are not I/O logging and set the default
  SIGTSTP handler when we re-send the signal to ourself, restoring our
  handler after we resume.
  [[37269d662]](https://git.sudo.ws/sudo/commit/?id=37269d662)

* src/exec.c:

  Shells typically change their process group when they start up so that
  they can implement job control. Most well-behaved shells change the pgrp
  back to its original value before suspending so we must not try to
  restore in that case, lest we race with the child upon resume,
  potentially stopping sudo with SIGTTOU while the command continues to
  run. Some shells, such as pdksh, just suspend the shell by sending
  SIGSTOP to themselves without restoring the pgrp. In this case we need
  to change the pgrp back for them. Should fix bug #568
  [[29907e357]](https://git.sudo.ws/sudo/commit/?id=29907e357)

2012-08-26 Todd C. Miller

* MANIFEST, compat/Makefile.in, compat/mksigname.c, compat/mksigname.h,
  compat/strsignal.c, compat/strsigname.c, config.h.in, configure,
  configure.in, include/missing.h, mkdep.pl, src/exec.c, src/exec\_pty.c:

  Use strsigname() to print signal names in the debug output. If the
  system has no strsigname(), use our own.
  [[537dc94b9]](https://git.sudo.ws/sudo/commit/?id=537dc94b9)

2012-08-23 Todd C. Miller

* plugins/sudoers/regress/testsudoers/test5.inc,
  plugins/sudoers/regress/testsudoers/test5.sh:

  Remove generated file and change path for temporary include file.
  [[ac4b21b3e]](https://git.sudo.ws/sudo/commit/?id=ac4b21b3e)

* plugins/sudoers/Makefile.in:

  When running regress tests, list pass/fail rate for each dir
  (testsudoers and visudo) instead of the total. Also prevent the result
  files from clobbering each other by keeping them in the relevant
  directories.
  [[6d08c4b40]](https://git.sudo.ws/sudo/commit/?id=6d08c4b40)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Don’t print an error message in yyerror() if open\_sudoers() fails, we’ve
  already printed an error message. Also restore the check for
  sudoers\_warnings in yyerror().
  [[e498bab4c]](https://git.sudo.ws/sudo/commit/?id=e498bab4c)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l:

  Avoid printing the >>> parse error <<< message for testsudoers
  when the -t flag is specified.
  [[0c8c3c0cd]](https://git.sudo.ws/sudo/commit/?id=0c8c3c0cd)

2012-08-22 Todd C. Miller

* plugins/sudoers/parse.c:

  Fix NULL deref when an entry has no Runas\_Entry
  [[793426106]](https://git.sudo.ws/sudo/commit/?id=793426106)

* plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, src/po/ja.mo,
  src/po/ja.po, src/po/pl.mo, src/po/pl.po, src/po/zh\_CN.mo,
  src/po/zh\_CN.po:

  sync with translationproject.org
  [[81d42ae4e]](https://git.sudo.ws/sudo/commit/?id=81d42ae4e)

* NEWS:

  sync
  [[f82515a8c]](https://git.sudo.ws/sudo/commit/?id=f82515a8c)

* plugins/sudoers/check.c:

  Correct the check\_user() comment header.
  [[778895adf]](https://git.sudo.ws/sudo/commit/?id=778895adf)

* plugins/sudoers/auth/sudo\_auth.c:

  Change a log\_fatal() into log\_error() when no auth methods are
  configured. The caller already checks the return value.
  [[60ba36979]](https://git.sudo.ws/sudo/commit/?id=60ba36979)

* plugins/sudoers/logging.c:

  Add missing debug\_return
  [[2b5d43b8a]](https://git.sudo.ws/sudo/commit/?id=2b5d43b8a)

2012-08-21 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Make the capitalization consistent for .Ss and .Sx
  [[2d3a0d14d]](https://git.sudo.ws/sudo/commit/?id=2d3a0d14d)

* doc/Makefile.in, doc/fixman.sh, doc/fixmdoc.sh, doc/sudo.cat,
  doc/sudo.man.in, doc/sudo.mdoc.in:

  Add COMMAND EXECUTION section that describes how sudo runs the command,
  the extra sudo processes and signal handling.
  [[8f3232ee6]](https://git.sudo.ws/sudo/commit/?id=8f3232ee6)

2012-08-18 Todd C. Miller

* Makefile.in:

  Happy Easter
  [[c1d6e86d6]](https://git.sudo.ws/sudo/commit/?id=c1d6e86d6)

2012-08-17 Todd C. Miller

* compat/Makefile.in:

  Don’t echo the awk command when building siglist.in
  [[2cdd315a0]](https://git.sudo.ws/sudo/commit/?id=2cdd315a0)

* doc/fixman.sh, doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in,
  doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Cosmetic changes.
  [[7afcef8ee]](https://git.sudo.ws/sudo/commit/?id=7afcef8ee)

* doc/Makefile.in:

  The HISTORY, LICENSE and CONTRIBUTORS files are not longer generated.
  [[3bef51c62]](https://git.sudo.ws/sudo/commit/?id=3bef51c62)

* MANIFEST, plugins/sudoers/po/da.po, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/hr.po, plugins/sudoers/po/it.mo,
  plugins/sudoers/po/it.po, plugins/sudoers/po/sl.po,
  plugins/sudoers/po/uk.po, src/po/de.mo, src/po/de.po, src/po/fi.po,
  src/po/hr.po, src/po/it.po, src/po/ru.po, src/po/sl.po, src/po/uk.po,
  src/po/vi.po:

  Sync with translationproject.org and add Italian sudoers translation.
  [[57f1c7fe0]](https://git.sudo.ws/sudo/commit/?id=57f1c7fe0)

2012-08-16 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Expand description of fqdn to talk about systems where the hosts file is
  searched before DNS.
  [[82115dfa1]](https://git.sudo.ws/sudo/commit/?id=82115dfa1)

2012-08-15 Todd C. Miller

* doc/Makefile.in:

  For cat pages there is nothing to make unless DEVEL is set.
  [[c2b6033c7]](https://git.sudo.ws/sudo/commit/?id=c2b6033c7)

* configure, configure.in, doc/Makefile.in:

  Always use mandoc to format cat pages and remove now-extraneous nroff
  configure tests.
  [[1e43242b3]](https://git.sudo.ws/sudo/commit/?id=1e43242b3)

* pp:

  sync polypkg from git
  [[35d51f3b5]](https://git.sudo.ws/sudo/commit/?id=35d51f3b5)

* plugins/sudoers/sudoers.c:

  Use AI\_FQDN instead of AI\_CANONNAME if available since “canonical” is
  not always the same as “fully qualified”.
  [[6260a7589]](https://git.sudo.ws/sudo/commit/?id=6260a7589)

2012-08-14 Todd C. Miller

* doc/sudoers.mdoc.in:

  Fix some typos. Describe error messages not related to policy
  permissions.
  [[e01886ed2]](https://git.sudo.ws/sudo/commit/?id=e01886ed2)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/visudo.c:

  Add new check\_defaults() function to check (but not update) the Defaults
  entries. Visudo can now use this instead of update\_defaults to check all
  the defaults regardless instead of just the global Defaults entries.
  [[7aeadbd5b]](https://git.sudo.ws/sudo/commit/?id=7aeadbd5b)

2012-08-13 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Document sudoers log format.
  [[d764db707]](https://git.sudo.ws/sudo/commit/?id=d764db707)

* NEWS:

  Update for sudo 1.8.5p3
  [[d312b241d]](https://git.sudo.ws/sudo/commit/?id=d312b241d)

* src/load\_plugins.c:

  Add missing check for I/O plugin API version when checking for the
  presence of I/O plugin hooks.
  [[805039bec]](https://git.sudo.ws/sudo/commit/?id=805039bec)

* src/hooks.c:

  Can’t call debug code in the process\_hooks\_xxx functions() since ctime()
  may look up the timezone via the TZ environment variable.
  [[f32aaed29]](https://git.sudo.ws/sudo/commit/?id=f32aaed29)

2012-08-10 Todd C. Miller

* src/exec\_common.c, src/sesh.c, src/utmp.c:

  Include signal.h before sudo\_exec.h since it uses sigset\_t \* in the
  fork\_pty prototype.
  [[e4e815dd8]](https://git.sudo.ws/sudo/commit/?id=e4e815dd8)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudoreplay.cat,
  doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in, doc/visudo.cat,
  doc/visudo.man.in, doc/visudo.mdoc.in:

  Remove OPTIONS section; options now go inside DESCRIPTION
  [[50eae1c22]](https://git.sudo.ws/sudo/commit/?id=50eae1c22)

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  regen
  [[66ad86594]](https://git.sudo.ws/sudo/commit/?id=66ad86594)

* MANIFEST, NEWS, plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/hr.mo, plugins/sudoers/po/hr.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/sl.mo, plugins/sudoers/po/sl.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, src/po/da.mo,
  src/po/da.po, src/po/hr.mo, src/po/hr.po, src/po/sl.mo, src/po/sl.po,
  src/po/vi.mo, src/po/vi.po:

  Sync with translationproject.org and add new Slovenian translation.
  [[ef33ee45d]](https://git.sudo.ws/sudo/commit/?id=ef33ee45d)

* common/alloc.c, plugins/sudoers/check.c, plugins/sudoers/env.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c:

  Reduce the number of “internal error, foo overflow” messages that need
  to be translated.
  [[241b2395c]](https://git.sudo.ws/sudo/commit/?id=241b2395c)

* NEWS:

  Mention HP-UX reboot fix.
  [[afaf5e07f]](https://git.sudo.ws/sudo/commit/?id=afaf5e07f)

* INSTALL, NEWS, common/sudo\_debug.c, configure, configure.in,
  doc/CONTRIBUTORS, include/sudo\_debug.h, mkdep.pl, pathnames.h.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/sssd.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c:

  Support for using SSSD ([http://fedorahosted.org/sssd/](https://fedorahosted.org/sssd/)) as a sudoers data
  source. From Daniel Kopecek and Pavel Brezina.
  [[d89b1a6be]](https://git.sudo.ws/sudo/commit/?id=d89b1a6be)

2012-08-09 Todd C. Miller

* common/sudo\_conf.c, src/load\_plugins.c:

  If sudo.conf contains an I/O plugin but no policy plugin, use sudoers
  for the policy plugin. If a policy plugin is specified without an I/O
  plugin, only the policy plugin will be loaded.
  [[a7424cc00]](https://git.sudo.ws/sudo/commit/?id=a7424cc00)

* doc/Makefile.in, doc/sudoers.man.in:

  Do not modify the .Os section when building the .man.in file from
  .mdoc.in.
  [[9ad4d4804]](https://git.sudo.ws/sudo/commit/?id=9ad4d4804)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Add a note about wildcards matching multiple words and include an
  example. Also mention that for sudoedit, a wildcard in command line args
  does not match a slash.
  [[507df9d5c]](https://git.sudo.ws/sudo/commit/?id=507df9d5c)

2012-08-07 Todd C. Miller

* src/exec\_pty.c, src/sudo\_exec.h:

  Fix a comment, update a variable name in a prototype; all cosmetic.
  [[0655deab5]](https://git.sudo.ws/sudo/commit/?id=0655deab5)

* plugins/sudoers/iolog.c:

  Cast 2nd argument of lseek() to off\_t if it is a constant for systems
  with 64-bit off\_t but without a proper lseek() prototype.
  [[3ba8da4ab]](https://git.sudo.ws/sudo/commit/?id=3ba8da4ab)

* compat/getline.c, plugins/sudoers/check.c, plugins/sudoers/env.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/visudo.c:

  Fix some warnings from clang checker-267
  [[7d255e42c]](https://git.sudo.ws/sudo/commit/?id=7d255e42c)

* plugins/sample/sample\_plugin.c:

  Fix memory leak found by clang checker-267
  [[487c8abb0]](https://git.sudo.ws/sudo/commit/?id=487c8abb0)

2012-08-06 Todd C. Miller

* src/exec.c, src/exec\_pty.c, src/sudo.h, src/sudo\_exec.h:

  If we receive a signal from the command we executed, do not forward it
  back to the command. This fixes a problem with BSD-derived versions of
  the reboot command which send SIGTERM to all other processes, including
  the sudo process. Sudo would then deliver SIGTERM to reboot which would
  die before calling the reboot() system call, effectively leaving the
  system in single user mode.
  [[dc08cf3c9]](https://git.sudo.ws/sudo/commit/?id=dc08cf3c9)

2012-08-03 Todd C. Miller

* doc/fixman.sh, doc/fixmdoc.sh:

  Remove section about Solaris 10 on other systems. Add missing
  sudoers.man.in bit to fixman.sh.
  [[d10fb81fe]](https://git.sudo.ws/sudo/commit/?id=d10fb81fe)

2012-08-02 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in:

  Expand section on Solaris privileges.
  [[61dfad9c5]](https://git.sudo.ws/sudo/commit/?id=61dfad9c5)

* NEWS:

  Expand a bit on the Solaris priv set changes.
  [[e7d1f8d54]](https://git.sudo.ws/sudo/commit/?id=e7d1f8d54)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  The second argument to init\_parser() is now bool.
  [[355d40aa8]](https://git.sudo.ws/sudo/commit/?id=355d40aa8)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Fix printing of parse error message to stderr.
  [[80597710c]](https://git.sudo.ws/sudo/commit/?id=80597710c)

* plugins/sudoers/check.c, plugins/sudoers/defaults.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c:

  If a command matches using an empty Runas\_List (i.e. Runas\_List is
  present but empty) and the -u option was not specified, set runas\_pw to
  user\_pw instead of using runas\_default. This is intended to be used in
  conjunction with the Solaris Privilege Set support for rules that grant
  privileges without changing the user.
  [[57699c553]](https://git.sudo.ws/sudo/commit/?id=57699c553)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.mdoc.in,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/match.c, plugins/sudoers/parse.c,
  plugins/sudoers/sudoers\_version.h:

  Add support for parsing an empty Runas\_List, which only allows the
  command to be run as the invoking user. This can be used in conjunction
  with the Solaris Privilege Set support to grant privileges without
  changing the user.
  [[e2d210a34]](https://git.sudo.ws/sudo/commit/?id=e2d210a34)

2012-08-01 Todd C. Miller

* doc/fixman.sh:

  Fix HP-UX, just use “.TH name section” like the vendor manuals.
  [[acba09fbb]](https://git.sudo.ws/sudo/commit/?id=acba09fbb)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Fix compilation on Solaris
  [[b1d1d8989]](https://git.sudo.ws/sudo/commit/?id=b1d1d8989)

* .hgignore, MANIFEST, doc/Makefile.in, doc/fixman.sh, doc/fixmdoc.sh,
  doc/sudo.man.sh, doc/sudo.mdoc.sh, doc/sudoers.man.sh,
  doc/sudoers.mdoc.sh:

  Generate a sed script file when munging \*.mdoc or \*.man instead of
  passing sed expressions on the command line. Older seds do not support
  \n in a replacement so generate and run a sed script instead.
  [[602510f1b]](https://git.sudo.ws/sudo/commit/?id=602510f1b)

* doc/Makefile.in, doc/sudo.man.in, doc/sudo\_plugin.man.in,
  doc/sudoers.ldap.man.in, doc/sudoers.man.in, doc/sudoreplay.man.in,
  doc/visudo.man.in:

  Use “Sudo VERSION” as the 4th arg to .TH instead of just “VERSION”
  [[37cfbc8ea]](https://git.sudo.ws/sudo/commit/?id=37cfbc8ea)

2012-07-31 Todd C. Miller

* src/exec.c:

  When checking whether a signal is user-generated, compare si\_code
  against SI\_USER instead of <= 0 since on HP-UX, terminal-related
  signals get a code of 0.
  [[5e502bd6d]](https://git.sudo.ws/sudo/commit/?id=5e502bd6d)

* src/sudo.c:

  SuSE Enterprise Linux uses RLIMIT\_NPROC and \_SC\_CHILD\_MAX
  interchangably. This causes problems when setting RLIMIT\_NPROC to
  RLIM\_INFINITY due to a bug in bash where bash tries to honor the value
  of \_SC\_CHILD\_MAX but treats a value of -1 as an error, and uses a
  default value of 32 instead.

  Previously, we just checked RLIMIT\_NPROC and, if it was unlimited,
  restored the previous value of RLIMIT\_NPROC. However, that makes it
  impossible to set nproc to unlimited. We now only restore the nproc
  resource limit if sysconf(\_SC\_CHILD\_MAX) is negative. In most cases,
  pam\_limits will set RLIMIT\_NPROC for us.
  [[9c321baa7]](https://git.sudo.ws/sudo/commit/?id=9c321baa7)

2012-07-30 Todd C. Miller

* plugins/sudoers/ldap.c:

  Active Directory apparently requires that tenths of a second be present
  in a date so append .0 to the “now” value in the time filter. Also
  remove space for the global AND from TIMEFILTER\_LENGTH since it was not
  being used consistently. Buffers of TIMEFILTER\_LENGTH now need to
  account for the terminating NUL byte.
  [[f205243bd]](https://git.sudo.ws/sudo/commit/?id=f205243bd)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Fix SELinux build
  [[a9623c29c]](https://git.sudo.ws/sudo/commit/?id=a9623c29c)

2012-07-29 Todd C. Miller

* MANIFEST:

  Remove pod versinons of HISTORY, CONTRIBUTORS and LICENSE as they were
  not being kept in sync.
  [[82c808c7c]](https://git.sudo.ws/sudo/commit/?id=82c808c7c)

* doc/HISTORY, doc/Makefile.in, doc/contributors.pod, doc/history.pod,
  doc/license.pod:

  Remove pod versinons of HISTORY, CONTRIBUTORS and LICENSE as they were
  not being kept in sync.
  [[e470b86cb]](https://git.sudo.ws/sudo/commit/?id=e470b86cb)

2012-07-27 Todd C. Miller

* plugins/sudoers/logging.c:

  Fix printing of the permission denied message to standard error when a
  user is not allowed to run a command. This got broken by the recent
  logging changes.
  [[383e0c860]](https://git.sudo.ws/sudo/commit/?id=383e0c860)

* plugins/sudoers/sudoers\_version.h:

  Bump grammar version for Solaris privs.
  [[2c7df2925]](https://git.sudo.ws/sudo/commit/?id=2c7df2925)

* doc/schema.ActiveDirectory:

  Fix errors introduced when sudoNotBefore, sudoNotAfter and sudoOrder
  were added. From David Hicks.
  [[ab64e36e5]](https://git.sudo.ws/sudo/commit/?id=ab64e36e5)

2012-07-26 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Remove lex.yy.c when building toke.c
  [[6ce246f0b]](https://git.sudo.ws/sudo/commit/?id=6ce246f0b)

* doc/Makefile.in:

  Fix building docs in a build dir.
  [[ecb74d3e2]](https://git.sudo.ws/sudo/commit/?id=ecb74d3e2)

* doc/sudo.man.pl, doc/sudo.pod, doc/sudo\_plugin.pod,
  doc/sudoers.ldap.pod, doc/sudoers.man.pl, doc/sudoers.pod,
  doc/sudoreplay.pod, doc/visudo.pod:

  Remove pod versions of the manual; we now use mdoc.
  [[12bad90ba]](https://git.sudo.ws/sudo/commit/?id=12bad90ba)

* MANIFEST, doc/Makefile.in, doc/sudo.man.sh, doc/sudo.mdoc.sh,
  doc/sudoers.man.sh, doc/sudoers.mdoc.sh:

  Add post-processing scripts to strip out login class, BSD auth, SELinux
  and privilege set bits when they are not supported.
  [[336233c2e]](https://git.sudo.ws/sudo/commit/?id=336233c2e)

* NEWS, configure.in, doc/CONTRIBUTORS, doc/Makefile.in,
  doc/contributors.pod, doc/sudoers.cat, doc/sudoers.man.in,
  doc/sudoers.man.pl, doc/sudoers.mdoc.in, doc/sudoers.pod,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/gram.c,
  plugins/sudoers/gram.h, plugins/sudoers/gram.y, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l, src/sudo.c, src/sudo.h:

  Merge in Solaris privilege support by Darren Moffat and John Zolnowsky
  [[4abd2a6cf]](https://git.sudo.ws/sudo/commit/?id=4abd2a6cf)

2012-07-25 Todd C. Miller

* doc/contributors.pod:

  Sync with CONTRIBUTORS file
  [[a726a1ccf]](https://git.sudo.ws/sudo/commit/?id=a726a1ccf)

* doc/sudo.man.in, doc/sudo\_plugin.man.in, doc/sudoers.ldap.man.in,
  doc/sudoers.man.in, doc/sudoreplay.man.in:

  Regen .man.in files with my private mandoc.
  [[d29991f41]](https://git.sudo.ws/sudo/commit/?id=d29991f41)

* doc/Makefile.in:

  add MANDOC variable
  [[84a8573aa]](https://git.sudo.ws/sudo/commit/?id=84a8573aa)

2012-07-20 Todd C. Miller

* doc/sudo.man.in, doc/sudo\_plugin.man.in, doc/sudoers.ldap.man.in,
  doc/sudoers.man.in, doc/sudoreplay.man.in, doc/visudo.man.in:

  Regen .man.in files with hacked mandoc to avoid issues with historic
  nroff.
  [[a06f7540f]](https://git.sudo.ws/sudo/commit/?id=a06f7540f)

2012-07-19 Todd C. Miller

* doc/sudo.mdoc.in, doc/sudoers.mdoc.in:

  Fix groff warnings.
  [[05e7cac89]](https://git.sudo.ws/sudo/commit/?id=05e7cac89)

* doc/Makefile.in:

  Fix dependencies for .man.in files.
  [[909f3da4d]](https://git.sudo.ws/sudo/commit/?id=909f3da4d)

* .hgignore:

  Add doc/\*.mdoc to ignore file
  [[42e6496ed]](https://git.sudo.ws/sudo/commit/?id=42e6496ed)

* INSTALL, MANIFEST, NEWS, configure, configure.in, doc/Makefile.in,
  doc/sudo.cat, doc/sudo.man.in, doc/sudo.mdoc.in, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.mdoc.in, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.mdoc.in,
  doc/sudoers.man.in, doc/sudoers.mdoc.in, doc/sudoreplay.cat,
  doc/sudoreplay.man.in, doc/sudoreplay.mdoc.in, doc/visudo.cat,
  doc/visudo.man.in, doc/visudo.mdoc.in:

  Build .man.in and .cat files from .mdoc.in files. Add new –with-man and
  –with-mdoc configure options.
  [[90f2cfa58]](https://git.sudo.ws/sudo/commit/?id=90f2cfa58)

2012-07-18 Todd C. Miller

* doc/sudo.mdoc.in, doc/sudo\_plugin.mdoc.in, doc/sudoers.ldap.mdoc.in,
  doc/sudoers.mdoc.in, doc/sudoreplay.mdoc.in, doc/visudo.mdoc.in:

  Sudo manuals formatted in mdoc, to replace the pod versions.
  [[0d8aa46bb]](https://git.sudo.ws/sudo/commit/?id=0d8aa46bb)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod,
  doc/sudoers.cat, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.pod, doc/sudoers.man.in, doc/sudoers.pod,
  doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.pod,
  doc/visudo.cat, doc/visudo.man.in, doc/visudo.pod:

  More minor costmetic fixes.
  [[c5b374fac]](https://git.sudo.ws/sudo/commit/?id=c5b374fac)

2012-07-12 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.pod:

  Minor cosmetic fixes.
  [[f31f58a96]](https://git.sudo.ws/sudo/commit/?id=f31f58a96)

2012-07-11 Todd C. Miller

* plugins/sudoers/logging.c, plugins/sudoers/po/sudoers.pot:

  Use “a password is required” instead of “password required” when the -n
  flag is used and we need to read a password.
  [[f7dc1d849]](https://git.sudo.ws/sudo/commit/?id=f7dc1d849)

2012-07-10 Todd C. Miller

* NEWS:

  Mention logging changes.
  [[7aaa10173]](https://git.sudo.ws/sudo/commit/?id=7aaa10173)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[5f83d35f7]](https://git.sudo.ws/sudo/commit/?id=5f83d35f7)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  Document that other mail\_\* flags have precedence over mail\_badpass.
  [[6cc8c161a]](https://git.sudo.ws/sudo/commit/?id=6cc8c161a)

* plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/check.c,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Move log\_denial() calls and logic to log\_failure(). Move authentication
  failure logging to log\_auth\_failure(). Both of these call
  audit\_failure() for us.

  This subtly changes logging for commands that are denied by sudoers but
  where the user failed to enter the correct password. Previously, these
  would be logged as “N incorrect password attempts” but now are logged as
  “command not allowed”. Fixes bug #563
  [[8b03f3e7d]](https://git.sudo.ws/sudo/commit/?id=8b03f3e7d)

2012-07-06 Todd C. Miller

* common/aix.c:

  Do not set a resource limit to zero when we are unable to fetch a value
  from /etc/security/limits.
  [[9c9cf9da4]](https://git.sudo.ws/sudo/commit/?id=9c9cf9da4)

2012-07-05 Todd C. Miller

* sudo.pp:

  Add “Provides: sudo” to debian sudo-ldap package
  [[5904f7ede]](https://git.sudo.ws/sudo/commit/?id=5904f7ede)

2012-07-02 Todd C. Miller

* configure, configure.in, zlib/Makefile.in:

  Define NO\_VIZ for zlib when gcc doesn’t support symbol visibility
  attributes.
  [[958e39fc6]](https://git.sudo.ws/sudo/commit/?id=958e39fc6)

* configure, configure.in:

  Use the autoconf cache when checking for symbol export control support.
  [[f38349a02]](https://git.sudo.ws/sudo/commit/?id=f38349a02)

* INSTALL, common/Makefile.in, compat/Makefile.in, configure,
  configure.in, mkpkg, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in:

  Add configure check for building PIE executables instead of doing it in
  mkpkg.
  [[f8f002171]](https://git.sudo.ws/sudo/commit/?id=f8f002171)

* sudo.pp:

  MacOS pp backend doesn’t like modes longer than 4 characters.
  [[aab4b3589]](https://git.sudo.ws/sudo/commit/?id=aab4b3589)

2012-07-01 Todd C. Miller

* configure, configure.in:

  Add -Wc,-fstack-protector to LT\_LDFLAGS instead of adding
  -fstack-protector to LDFLAGS so it doesn’t get stripped out. Libtool
  will strip -fstack-protector from the linker flags and we always link
  with libtool.
  [[effd6cd91]](https://git.sudo.ws/sudo/commit/?id=effd6cd91)

2012-06-29 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudoers.cat, doc/sudoers.ldap.cat,
  doc/sudoers.ldap.man.in, doc/sudoers.man.in, doc/sudoreplay.cat,
  doc/sudoreplay.man.in, doc/visudo.cat, doc/visudo.man.in:

  Regen for sudo 1.8.6
  [[2e36b1ef2]](https://git.sudo.ws/sudo/commit/?id=2e36b1ef2)

* NEWS, doc/sudoers.ldap.pod:

  Document improved Tivoli Directory Server support.
  [[80502c3bc]](https://git.sudo.ws/sudo/commit/?id=80502c3bc)

* config.h.in, configure, configure.in, plugins/sudoers/ldap.c:

  Add support for ldaps using Tivoli LDAP libraries. Add ldap.conf option
  to specify Tivoli key db password. Allow TLS ciphers to be configured
  for Tivoli.
  [[3c57d6a06]](https://git.sudo.ws/sudo/commit/?id=3c57d6a06)

2012-06-28 Todd C. Miller

* plugins/sudoers/ldap.c:

  Tivoli Directory Server 6.3 libs always return a (bogus) error when
  setting LDAP\_OPT\_CONNECT\_TIMEOUT.
  [[f56bada40]](https://git.sudo.ws/sudo/commit/?id=f56bada40)

* NEWS:

  Update
  [[06637e528]](https://git.sudo.ws/sudo/commit/?id=06637e528)

* plugins/sudoers/ldap.c:

  Treat LDAP\_OPT\_CONNECT\_TIMEOUT (Tivoli Directory Server 6.3) the same as
  LDAP\_OPT\_CONNECT\_TIMEOUT (OpenSSH). Don’t make failure to a set an ldap
  option fatal.
  [[cfe0034cd]](https://git.sudo.ws/sudo/commit/?id=cfe0034cd)

2012-06-27 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Zero pointers in sudo\_user struct after freeing, just in case.
  [[7d5048a5b]](https://git.sudo.ws/sudo/commit/?id=7d5048a5b)

* plugins/sudoers/sudoers.c:

  Free user\_gids in close function if it has not already been freed.
  [[899fcc05a]](https://git.sudo.ws/sudo/commit/?id=899fcc05a)

* plugins/sudoers/pwutil.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Defer group ID to name resolution until we actually need it.
  [[1cd50d0bc]](https://git.sudo.ws/sudo/commit/?id=1cd50d0bc)

* src/sudo.c:

  It is safe to read in sudo.conf before calling user\_info().
  [[faf89fc79]](https://git.sudo.ws/sudo/commit/?id=faf89fc79)

* plugins/sudoers/env.c, plugins/sudoers/ldap.c:

  Use MAX\_UID\_T\_LEN + 1 for uid/gid buffers, not MAX\_UID\_T\_LEN to prevent
  potential truncation. [Bug
  #562](https://bugzilla.sudo.ws/show_bug.cgi?id=562).
  [[e9f5a3839]](https://git.sudo.ws/sudo/commit/?id=e9f5a3839)

2012-06-25 Todd C. Miller

* sudo.pp:

  If installing with installp, error out if there is already an instance
  of the rpm package installed.
  [[386ba7b06]](https://git.sudo.ws/sudo/commit/?id=386ba7b06)

* mkpkg:

  Add –disable-nls for AIX
  [[bcd8549a9]](https://git.sudo.ws/sudo/commit/?id=bcd8549a9)

2012-06-22 Todd C. Miller

* sudo.pp:

  Debian sudo-ldap packages should now depend on libldap-2.4-2, not
  libldap2.
  [[5c1ba0b49]](https://git.sudo.ws/sudo/commit/?id=5c1ba0b49)

2012-06-21 Todd C. Miller

* sudo.pp:

  Add Homepage and Bugs to debian control file.
  [[e571d6ff6]](https://git.sudo.ws/sudo/commit/?id=e571d6ff6)

2012-06-20 Todd C. Miller

* mkpkg:

  fix typo when setting aix\_freeware
  [[6103bbc67]](https://git.sudo.ws/sudo/commit/?id=6103bbc67)

* common/Makefile.in, compat/Makefile.in, configure, configure.in,
  doc/Makefile.in, include/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in, zlib/Makefile.in:

  Don’t run regress tests or sudoers sanity check (using the newly-built
  visudo) when cross compiling. [Bug
  #560](https://bugzilla.sudo.ws/show_bug.cgi?id=560)
  [[9497df293]](https://git.sudo.ws/sudo/commit/?id=9497df293)

* MANIFEST, configure, configure.in, plugins/sample/Makefile.in,
  plugins/sample/sample\_plugin.exp, plugins/sample/sample\_plugin.map,
  plugins/sample\_group/Makefile.in, plugins/sample\_group/sample\_group.exp,
  plugins/sample\_group/sample\_group.map, plugins/sudoers/Makefile.in,
  plugins/sudoers/sudoers.exp, plugins/sudoers/sudoers.map,
  plugins/system\_group/Makefile.in, plugins/system\_group/system\_group.exp,
  plugins/system\_group/system\_group.map:

  Rename foo.sym -> foo.exp Remove foo.map from the repo and generate it
  on demand Use a loader option file for HP-UX ld to explicitly export
  symbols
  [[bcfeddc99]](https://git.sudo.ws/sudo/commit/?id=bcfeddc99)

* src/Makefile.in:

  Remove extraneous backslash
  [[b0475b59d]](https://git.sudo.ws/sudo/commit/?id=b0475b59d)

* plugins/sudoers/regress/check\_symbols/check\_symbols.c:

  Don’t check for errorx as an exported symbols as it is now a macro.
  Check for user\_in\_group() instead.
  [[a49238e3f]](https://git.sudo.ws/sudo/commit/?id=a49238e3f)

2012-06-19 Todd C. Miller

* configure, configure.in:

  Adjust ld map file support to use an anonymous scope to match the
  updated .map files.
  [[b567282f8]](https://git.sudo.ws/sudo/commit/?id=b567282f8)

2012-06-18 Todd C. Miller

* config.h.in, configure, configure.in, include/gettext.h:

  Older versions of Solaris lack ngettext()
  [[c74d40631]](https://git.sudo.ws/sudo/commit/?id=c74d40631)

* configure, configure.in:

  Move the check for -static-libgcc until after AC\_LANG\_WERROR has been
  called and use AX\_CHECK\_COMPILE\_FLAG().
  [[af8a211e4]](https://git.sudo.ws/sudo/commit/?id=af8a211e4)

* include/gettext.h:

  Sudo defines HAVE\_SETLOCALE not HAVE\_LOCALE\_H
  [[2ef0cc73f]](https://git.sudo.ws/sudo/commit/?id=2ef0cc73f)

* include/error.h, include/sudo\_debug.h:

  Fix gcc 2.x variant macro support.
  [[5ac272c03]](https://git.sudo.ws/sudo/commit/?id=5ac272c03)

* plugins/sudoers/logging.c, plugins/sudoers/sudoreplay.c:

  Fix compilation on gcc 2.95 and other compilers that only allow variable
  declarations at the beginning of a block.
  [[45fea137f]](https://git.sudo.ws/sudo/commit/?id=45fea137f)

* configure, configure.in, plugins/sudoers/Makefile.in:

  Link check\_symbols with SUDO\_LIBS to make sure we link with the
  requisite libraries to successfully dlopen sudoers.so. This is needed on
  HP-UX where a program dlopen()ing a shared object that uses pthreads
  must also be linked with pthreads (and HP-UX LDAP uses pthreads).
  [[fdcc8e1fc]](https://git.sudo.ws/sudo/commit/?id=fdcc8e1fc)

* plugins/sudoers/regress/check\_symbols/check\_symbols.c:

  Add check for exported local symbols. This will cause a “make check”
  failure on systems where we don’t support symbol hiding.
  [[86cececc1]](https://git.sudo.ws/sudo/commit/?id=86cececc1)

* configure, configure.in:

  Additional ${foo} -> $(foo) Makefile tweaks.
  [[7e67a9153]](https://git.sudo.ws/sudo/commit/?id=7e67a9153)

* plugins/sample/sample\_plugin.map, plugins/sample\_group/sample\_group.map,
  plugins/sudoers/sudoers.map, plugins/system\_group/system\_group.map:

  No need to provide a name for the scope in the map file since we don’t
  use the it for versioning.
  [[437978bd3]](https://git.sudo.ws/sudo/commit/?id=437978bd3)

2012-06-17 Todd C. Miller

* MANIFEST, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/check\_symbols/check\_symbols.c:

  Add regress test for symbol visibility.
  [[2a83d1c6d]](https://git.sudo.ws/sudo/commit/?id=2a83d1c6d)

2012-06-15 Todd C. Miller

* NEWS, configure, configure.in:

  sudo 1.8.6
  [[0888101bb]](https://git.sudo.ws/sudo/commit/?id=0888101bb)

* configure, configure.in, include/missing.h:

  Add support for controlling symbol visibility using the HP and Solaris C
  compilers.
  [[60a301948]](https://git.sudo.ws/sudo/commit/?id=60a301948)

* plugins/sudoers/iolog.c, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/sudoers.h:

  Use the expanded io log dir when updating the sequence number. Includes
  a workaround for older versions of sudo where the sequence number was
  stored in the unexpanded io log dir.
  [[203abd98b]](https://git.sudo.ws/sudo/commit/?id=203abd98b)

2012-06-14 Todd C. Miller

* src/parse\_args.c:

  Simplify “sudo -s” argv rewriting.
  [[85c607865]](https://git.sudo.ws/sudo/commit/?id=85c607865)

* MANIFEST, configure, configure.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in, src/sudo\_noexec.map:

  Don’t use a map file for sudo\_noexec.so since Solaris ld doesn’t allow
  ‘\*’ in the global section. The libtool export flag is now added to
  LT\_LDFLAGS instead of commenting/uncommenting lines.
  [[47abbb90a]](https://git.sudo.ws/sudo/commit/?id=47abbb90a)

2012-06-13 Todd C. Miller

* config.h.in, configure, configure.in, include/missing.h:

  The visibility attribute was actually added in gcc 3.3.x, not 4.0. Just
  assume that if -fvisibility=hidden works that the attribute is usable.
  [[1fe3f9f40]](https://git.sudo.ws/sudo/commit/?id=1fe3f9f40)

* plugins/sudoers/check.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/ldap.c,
  plugins/sudoers/match.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoers.map,
  plugins/sudoers/sudoers.sym, plugins/sudoers/testsudoers.c,
  plugins/system\_group/system\_group.c:

  Export group cache from sudoers.so for system\_group.so to use.
  [[649edc319]](https://git.sudo.ws/sudo/commit/?id=649edc319)

* MANIFEST, configure, configure.in, include/missing.h,
  plugins/sample/Makefile.in, plugins/sample/sample\_plugin.map,
  plugins/sample\_group/Makefile.in, plugins/sample\_group/sample\_group.map,
  plugins/sudoers/Makefile.in, plugins/sudoers/iolog.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.map,
  plugins/system\_group/Makefile.in, plugins/system\_group/system\_group.map,
  src/sudo\_noexec.c, src/sudo\_noexec.map:

  Use gcc’s visibility attribute to specify when symbols are visible or
  hidden, if available. If not available, use an ELF version script if it
  is supported. If all else fails, fall back to using libtool’s
  -export-symbols.
  [[6f6b0dec6]](https://git.sudo.ws/sudo/commit/?id=6f6b0dec6)

2012-06-12 Todd C. Miller

* sudo.pp:

  Add mode for installed locale files but leave the directories with
  default mode and owner.
  [[60eafc971]](https://git.sudo.ws/sudo/commit/?id=60eafc971)

2012-06-11 Todd C. Miller

* mkpkg, sudo.pp:

  Install AIX packages under /opt/freeware with links in /usr/bin and
  /usr/sbin. This matches the layout of the sudo package from AIX
  freeware.
  [[c49823557]](https://git.sudo.ws/sudo/commit/?id=c49823557)

* Makefile.in, configure, configure.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in, src/Makefile.in, sudo.pp:

  Install shared objects with mode 0644 except on HP-UX which needs the
  executable bit set.
  [[a8e0687ca]](https://git.sudo.ws/sudo/commit/?id=a8e0687ca)

* Makefile.in, doc/Makefile.in, include/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Make installed file modes consistent with the file modes in the sudo
  package.
  [[c131cb36f]](https://git.sudo.ws/sudo/commit/?id=c131cb36f)

2012-06-08 Todd C. Miller

* doc/sudoers.pod:

  Add “%:” prefix when talking about QAS non-Unix group support.
  [[642b7e887]](https://git.sudo.ws/sudo/commit/?id=642b7e887)

* pp, sudo.pp:

  Fix packaging of symbolic links on HP-UX when the link source already
  exists in the filesystem.
  [[f5948149e]](https://git.sudo.ws/sudo/commit/?id=f5948149e)

* mkpkg:

  Only specify prefix if we are overriding the default value. Fixes the
  man dir (/usr/local/man vs. /usr/local/share/man).
  [[db9f50f13]](https://git.sudo.ws/sudo/commit/?id=db9f50f13)

* sudo.pp:

  Fix setting of sudoedit\_man variable.
  [[94049aa53]](https://git.sudo.ws/sudo/commit/?id=94049aa53)

* doc/Makefile.in:

  Echo the command when linking the sudoedit manual.
  [[afbf68d6a]](https://git.sudo.ws/sudo/commit/?id=afbf68d6a)

2012-06-07 Todd C. Miller

* mkpkg, sudo.pp:

  Build .deb packages with selinux support.
  [[4c88e08c8]](https://git.sudo.ws/sudo/commit/?id=4c88e08c8)

2012-06-04 Todd C. Miller

* sudo.pp:

  Don’t list paths for unstripped binaries in the lintial overrides.
  [[13472d7a8]](https://git.sudo.ws/sudo/commit/?id=13472d7a8)

* pp:

  Add support for Installed-Size header in control file, required by newer
  debian versions.
  [[37db1a4dc]](https://git.sudo.ws/sudo/commit/?id=37db1a4dc)

* pp:

  Fix extended description in .deb files.
  [[0a66c2439]](https://git.sudo.ws/sudo/commit/?id=0a66c2439)

* sudo.pp:

  Add Depends, Replaces and Conflicts headers for .deb packages.
  [[dab474b93]](https://git.sudo.ws/sudo/commit/?id=dab474b93)

2012-06-01 Todd C. Miller

* plugins/sudoers/sudo\_nss.c:

  If there are no privs to print, write the message to the lbuf instead of
  printing it directly.
  [[54cfac04d]](https://git.sudo.ws/sudo/commit/?id=54cfac04d)

2012-05-31 Todd C. Miller

* sudo.pp:

  Set -e in %pos and %preun for debian to quiet a lintian warning.
  [[f6f64ce04]](https://git.sudo.ws/sudo/commit/?id=f6f64ce04)

* doc/Makefile.in, src/Makefile.in, sudo.pp:

  Install sudoedit and the sudoedit manual as symbolic links, not hard
  links and package them as such.
  [[61a3ed1c1]](https://git.sudo.ws/sudo/commit/?id=61a3ed1c1)

* sudo.pp:

  Make sudo binary permissions 755 instead of 111 Add lintian overrides
  file for .deb files.
  [[3076dc2a4]](https://git.sudo.ws/sudo/commit/?id=3076dc2a4)

* configure, configure.in, doc/Makefile.in, mkpkg:

  Replace out of date MAN\_POSTINSTALL with MANCOMPRESS and MANCOMPRESSEXT
  which can be used to compress the installed manual pages. Compress the
  man pages for .deb files to appease lintian.
  [[8d4c6bbbd]](https://git.sudo.ws/sudo/commit/?id=8d4c6bbbd)

* sudo.pp:

  Debian fixes: \* fix modes to be more in line with what Debian expects \*
  add section \* install LICENSE as copyright and ChangeLog as changelog \*
  create stub changelog.debian
  [[b5ee0ab91]](https://git.sudo.ws/sudo/commit/?id=b5ee0ab91)

* pp:

  Fix find command to properly skip files in the DEBIAN dir when building
  md5sums.
  [[8b38f4584]](https://git.sudo.ws/sudo/commit/?id=8b38f4584)

* pp, sudo.pp:

  Use a debian-compliant package maintainer field.
  [[7391c7562]](https://git.sudo.ws/sudo/commit/?id=7391c7562)

2012-05-30 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  No need to loop over atomic\_writev(), it guarantees to write all data or
  return an error.

  Fix handling of stdout/stderr that contains “\r\n” and handle a “\r\n”
  pair that spans a buffer.
  [[b406b51da]](https://git.sudo.ws/sudo/commit/?id=b406b51da)

2012-05-29 Todd C. Miller

* NEWS:

  Update for sudo 1.8.5p2
  [[01da61379]](https://git.sudo.ws/sudo/commit/?id=01da61379)

* plugins/sudoers/sudoreplay.c:

  Instead of doing extra write()s when replaying stdout, build up a vector
  for writev() instead. This results in far fewer system calls.
  [[12be3e7f5]](https://git.sudo.ws/sudo/commit/?id=12be3e7f5)

2012-05-27 Todd C. Miller

* src/env\_hooks.c, src/sudo.h, src/tgetpass.c:

  Provide unhooked version of getenv() and use it when looking up DISPLAY
  and SUDO\_ASKPASS in the environment.
  [[af9492d11]](https://git.sudo.ws/sudo/commit/?id=af9492d11)

2012-05-25 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  When replaying a log of stdout or stderr, do newline to carriage return
  + linefeed conversion. We cannot have termios do this for us since we’ve
    disabled output postprocessing (POST) when setting raw mode.
    [[7a6cad502]](https://git.sudo.ws/sudo/commit/?id=7a6cad502)

2012-05-24 Todd C. Miller

* configure, configure.in:

  When checking for -fstack-protector, treat warnings as fatal errors.
  [[7720a7fc8]](https://git.sudo.ws/sudo/commit/?id=7720a7fc8)

2012-05-22 Todd C. Miller

* configure, configure.in:

  Fix test for -z relro
  [[e54a00726]](https://git.sudo.ws/sudo/commit/?id=e54a00726)

* MANIFEST:

  Add m4/ax\_check\_compile\_flag.m4 and m4/ax\_check\_link\_flag.m4
  [[ca89eb59e]](https://git.sudo.ws/sudo/commit/?id=ca89eb59e)

* INSTALL, aclocal.m4, configure, configure.in,
  m4/ax\_check\_compile\_flag.m4, m4/ax\_check\_link\_flag.m4:

  Build with -fstack-protector and link with -zrelo where supported. Added
  –disable-hardening option to disable hardening options.
  [[e417fb3da]](https://git.sudo.ws/sudo/commit/?id=e417fb3da)

2012-05-21 Todd C. Miller

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/testsudoers/test1.sh,
  plugins/sudoers/regress/testsudoers/test2.sh,
  plugins/sudoers/regress/testsudoers/test3.sh,
  plugins/sudoers/regress/testsudoers/test4.out.ok,
  plugins/sudoers/regress/testsudoers/test4.sh,
  plugins/sudoers/regress/testsudoers/test5.inc,
  plugins/sudoers/regress/testsudoers/test5.out.ok,
  plugins/sudoers/regress/testsudoers/test5.sh,
  plugins/sudoers/testsudoers.c:

  Add tests for sudoers mode, owner and group checks.
  [[ca9331d49]](https://git.sudo.ws/sudo/commit/?id=ca9331d49)

* plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.c:

  If sudoers\_mode is group-readable but the actual sudoers file is not,
  open the file as uid 0, not uid 1. This fixes a problem when sudoers has
  a more restrictive mode than what sudo expects to find. In older
  versions, sudo would silently chmod the file to add the group-readable
  bit.
  [[0d82c4c7e]](https://git.sudo.ws/sudo/commit/?id=0d82c4c7e)

* INSTALL, common/secure\_path.c, config.h.in, configure, configure.in:

  No longer throw an error if sudoers is a symbolic link. Deprecated the
  –with-stow option as that is now (effectively) the default.
  [[d29aede20]](https://git.sudo.ws/sudo/commit/?id=d29aede20)

2012-05-18 Todd C. Miller

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/testsudoers/test2.inc,
  plugins/sudoers/regress/testsudoers/test2.out.ok,
  plugins/sudoers/regress/testsudoers/test2.sh,
  plugins/sudoers/regress/testsudoers/test3.d/root,
  plugins/sudoers/regress/testsudoers/test3.out.ok,
  plugins/sudoers/regress/testsudoers/test3.sh:

  Add basic tests for #include and #includedir
  [[4f296fe21]](https://git.sudo.ws/sudo/commit/?id=4f296fe21)

* plugins/sudoers/testsudoers.c:

  Add -U sudoers\_uid option to testsudoers.
  [[b35cd7553]](https://git.sudo.ws/sudo/commit/?id=b35cd7553)

2012-05-17 Todd C. Miller

* NEWS, configure, configure.in:

  Update for 1.8.5p1
  [[fe5bf0306]](https://git.sudo.ws/sudo/commit/?id=fe5bf0306)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Fix #includedir; from Mike Frysinger
  [[8a7ac4459]](https://git.sudo.ws/sudo/commit/?id=8a7ac4459)

* plugins/sudoers/check.c:

  Don’t prompt for a password if the user is in the exempt group, is root,
  or is running the command as themselves even if the -k option was
  specified. This makes “sudo -k command” consistent with the behavior one
  would get if the user ran “sudo -k” immediately before running the
  command.
  [[2b7659f70]](https://git.sudo.ws/sudo/commit/?id=2b7659f70)

2012-05-15 Todd C. Miller

* INSTALL:

  Fix capitalization
  [[025a30902]](https://git.sudo.ws/sudo/commit/?id=025a30902)

* mkpkg:

  Build PIE executable on Mac OS X 10.5 and above.
  [[071256a83]](https://git.sudo.ws/sudo/commit/?id=071256a83)

2012-05-14 Todd C. Miller

* NEWS:

  Update for sudo 1.8.4p5
  [[3d55aaa8b]](https://git.sudo.ws/sudo/commit/?id=3d55aaa8b)

* plugins/sudoers/match\_addr.c:

  Add missing break between AF\_INET and AF\_INET6 in
  addr\_matches\_if\_netmask()
  [[0d5a94131]](https://git.sudo.ws/sudo/commit/?id=0d5a94131)

* plugins/sudoers/mon\_systrace.c:

  Move systrace monitor code to the attic
  [[d841ae9cd]](https://git.sudo.ws/sudo/commit/?id=d841ae9cd)

2012-05-11 Todd C. Miller

* src/exec.c:

  The pointer to the siginfo\_t struct in a signal handler may be NULL.
  [[466a126c6]](https://git.sudo.ws/sudo/commit/?id=466a126c6)

2012-05-10 Todd C. Miller

* plugins/sudoers/pwutil.c:

  Fix an alignment problem on NetBSD systems with a 64-bit time\_t and
  strict alignment. Based on a patch from Martin Husemann.
  [[0d6958077]](https://git.sudo.ws/sudo/commit/?id=0d6958077)

* include/missing.h:

  Add offsetof macro for those without it.
  [[4e0ffceac]](https://git.sudo.ws/sudo/commit/?id=4e0ffceac)

* MANIFEST:

  add system\_group plugin
  [[63e1ab974]](https://git.sudo.ws/sudo/commit/?id=63e1ab974)

2012-05-09 Todd C. Miller

* compat/dlopen.c:

  Implement RTLD\_NEXT and fix RTLD\_DEFAULT for HP-UX.
  [[aa7ac09fa]](https://git.sudo.ws/sudo/commit/?id=aa7ac09fa)

2012-05-08 Todd C. Miller

* NEWS:

  Mention system\_group plugin
  [[340ae1323]](https://git.sudo.ws/sudo/commit/?id=340ae1323)

* Makefile.in, plugins/sudoers/Makefile.in,
  plugins/system\_group/Makefile.in:

  update depends
  [[c690ac207]](https://git.sudo.ws/sudo/commit/?id=c690ac207)

* plugins/system\_group/system\_group.c:

  Only call gr\_delref() when use sudo’s password caching functions.
  [[aa3defa3f]](https://git.sudo.ws/sudo/commit/?id=aa3defa3f)

* plugins/sample\_group/Makefile.in, plugins/system\_group/Makefile.in:

  Add missing dependency on libreplace.la
  [[75d70b334]](https://git.sudo.ws/sudo/commit/?id=75d70b334)

* compat/dlopen.c:

  Emulate RTLD\_DEFAULT and RTLD\_SELF w/ shl\_findsym() using NULL and
  PROG\_HANDLE.
  [[6467b7b81]](https://git.sudo.ws/sudo/commit/?id=6467b7b81)

* Makefile.in, configure, configure.in, plugins/system\_group/Makefile.in,
  plugins/system\_group/system\_group.c,
  plugins/system\_group/system\_group.sym:

  Add group plugin that does lookups by name using the system group
  database.
  [[994d2ff69]](https://git.sudo.ws/sudo/commit/?id=994d2ff69)

* plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po, src/po/pl.mo,
  src/po/pl.po:

  sync with translationproject.org
  [[4455139d5]](https://git.sudo.ws/sudo/commit/?id=4455139d5)

2012-05-03 Todd C. Miller

* plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, src/po/de.mo,
  src/po/de.po, src/po/eo.mo, src/po/eo.po, src/po/fi.mo, src/po/fi.po,
  src/po/ja.mo, src/po/ja.po, src/po/ru.mo, src/po/ru.po, src/po/sr.mo,
  src/po/sr.po, src/po/uk.mo, src/po/uk.po, src/po/vi.mo, src/po/vi.po,
  src/po/zh\_CN.mo, src/po/zh\_CN.po:

  sync with translationproject.org
  [[64178f8b6]](https://git.sudo.ws/sudo/commit/?id=64178f8b6)

2012-05-01 Todd C. Miller

* sudo.pp:

  Add mode for docdir and use ‘-’ (default) for localedir mode. Fixes a
  problem on Linux when building in a directory with the setgid bit set.
  [[e828a1d7a]](https://git.sudo.ws/sudo/commit/?id=e828a1d7a)

2012-04-30 Todd C. Miller

* pp:

  Match CentOS 6.0
  [[d9c13139d]](https://git.sudo.ws/sudo/commit/?id=d9c13139d)

2012-04-24 Todd C. Miller

* NEWS:

  Update with recent changes
  [[8722cd07a]](https://git.sudo.ws/sudo/commit/?id=8722cd07a)

* pp:

  Fix version check on AIX
  [[30bddced2]](https://git.sudo.ws/sudo/commit/?id=30bddced2)

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  regen
  [[4b8982ebd]](https://git.sudo.ws/sudo/commit/?id=4b8982ebd)

* plugins/sudoers/ldap.c:

  Need to call ldapssl\_clientauth\_init() for start\_tls on Mozilla LDAP
  SDK.
  [[e82b67314]](https://git.sudo.ws/sudo/commit/?id=e82b67314)

* plugins/sudoers/ldap.c:

  Fix printing of invalid uri
  [[28268ed99]](https://git.sudo.ws/sudo/commit/?id=28268ed99)

* plugins/sudoers/auth/pam.c:

  Pass PAM\_SILENT when deleting creds to remove an annoying warning
  message on Solaris.
  [[989361c27]](https://git.sudo.ws/sudo/commit/?id=989361c27)

2012-04-23 Todd C. Miller

* src/utmp.c:

  Fix the setutxent and endutxent compatibility defines (this time
  correctly) when only setutent and endutent are available.
  [[0fbd5e1bc]](https://git.sudo.ws/sudo/commit/?id=0fbd5e1bc)

* plugins/sudoers/ldap.c:

  sudo\_ldap\_set\_options\_global() should not take an LDAP handle as an
  argument since the options affect the global settings.
  [[f6c7ae251]](https://git.sudo.ws/sudo/commit/?id=f6c7ae251)

* mkpkg:

  Debian sudo has not been built with –with-exempt=sudo since 1.6.8.
  [[5f513b832]](https://git.sudo.ws/sudo/commit/?id=5f513b832)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod,
  plugins/sudoers/auth/pam.c, src/exec.c, src/exec\_pty.c, src/sudo.c,
  src/sudo.h:

  Call the policy’s init\_session() function before we fork the child. That
  way, the session is created and destroyed in the same process, which is
  needed by some modules, such as pam\_mount.
  [[23b7a1fa5]](https://git.sudo.ws/sudo/commit/?id=23b7a1fa5)

* doc/TROUBLESHOOTING:

  Add entry for SSL LDAP errors on Mozilla SDKs when the cert dir is not
  specified.
  [[1480bb88b]](https://git.sudo.ws/sudo/commit/?id=1480bb88b)

* plugins/sudoers/auth/pam.c:

  Delete creds after closing the PAM session.
  [[cf4562c03]](https://git.sudo.ws/sudo/commit/?id=cf4562c03)

* plugins/sudoers/ldap.c:

  Provide a more useful error message if using a Mozilla-style LDAP SDK
  and you forgot to specify TLS\_CERT in ldap.conf.
  [[cde9f8aa1]](https://git.sudo.ws/sudo/commit/?id=cde9f8aa1)

* src/exec\_pty.c:

  Add missing initialization of a sigaction structure when I/O logging.
  Fixes a potential problem when suspending the command.
  [[ce9863358]](https://git.sudo.ws/sudo/commit/?id=ce9863358)

* plugins/sudoers/ldap.c:

  Split global and per-connection LDAP options into separate arrays. Set
  global LDAP options before calling ldap\_initialize() or ldap\_init().
  After we have an LDAP handle, set the per-connection options. Fixes a
  problem with OpenLDAP using the nss crypto backend; bug #342
  [[9f461efd5]](https://git.sudo.ws/sudo/commit/?id=9f461efd5)

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, src/po/de.mo,
  src/po/de.po, src/po/hr.mo, src/po/hr.po, src/po/vi.mo, src/po/vi.po,
  src/po/zh\_CN.mo, src/po/zh\_CN.po:

  sync with translationproject.org
  [[3491dd818]](https://git.sudo.ws/sudo/commit/?id=3491dd818)

2012-04-21 Todd C. Miller

* src/sudo.c, src/sudo.h:

  Move struct passwd pointer into struct command details.
  [[886ee3360]](https://git.sudo.ws/sudo/commit/?id=886ee3360)

2012-04-20 Todd C. Miller

* pp:

  Sync with upstream for Mac OS X (and other) fixes.
  [[cc07164d9]](https://git.sudo.ws/sudo/commit/?id=cc07164d9)

* mkpkg:

  Only built Mac intel universal binary on an intel machine.
  [[c19ec8f9f]](https://git.sudo.ws/sudo/commit/?id=c19ec8f9f)

* src/Makefile.in:

  Do not pass libtool the -static-libtool-libs option when building sudo
  and sesh. Otherwise, libtool may prefer a static version of an installed
  library over a dynamic one when linking.
  [[f490ff228]](https://git.sudo.ws/sudo/commit/?id=f490ff228)

2012-04-19 Todd C. Miller

* MANIFEST, NEWS, doc/CONTRIBUTORS, plugins/sudoers/po/hr.mo,
  plugins/sudoers/po/hr.po, src/po/de.mo, src/po/de.po:

  Add German translation for sudo Add Croatian translation for sudoers
  [[4c36371ee]](https://git.sudo.ws/sudo/commit/?id=4c36371ee)

* plugins/sudoers/iolog.c:

  typo fix in comment
  [[f3ab15b11]](https://git.sudo.ws/sudo/commit/?id=f3ab15b11)

2012-04-16 Todd C. Miller

* NEWS:

  Update with recent changes
  [[15a974936]](https://git.sudo.ws/sudo/commit/?id=15a974936)

* Makefile.in, plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  Sort xgettext output by file name.
  [[0ed675391]](https://git.sudo.ws/sudo/commit/?id=0ed675391)

* doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.pod:

  Clarify what “sudoreplay -l” displays and mention that it is sorted.
  [[b3f750b75]](https://git.sudo.ws/sudo/commit/?id=b3f750b75)

* config.h.in, configure, configure.in, src/ttyname.c:

  Use AC\_HEADER\_MAJOR to determine where major/minor are defined.
  [[cf3fce665]](https://git.sudo.ws/sudo/commit/?id=cf3fce665)

* config.h.in, configure, configure.in, src/ttyname.c:

  Include sys/mkdev.h if present instead of sys/sysmacros.h for minor().
  This is needed on Solaris (at least) where the makedev macros in
  sysmacros.h are obsolete and library functions should be used instead.
  [[dbcd7222a]](https://git.sudo.ws/sudo/commit/?id=dbcd7222a)

* mkpkg:

  When building on Mac OS X, only set SDK\_FLAGS if specified osversion
  doesn’t match host.
  [[a714eb56f]](https://git.sudo.ws/sudo/commit/?id=a714eb56f)

2012-04-15 Todd C. Miller

* src/ttyname.c:

  Add back buf and tty variables for \_ttyname() case that were
  inadvertantly removed.
  [[21eddb5d6]](https://git.sudo.ws/sudo/commit/?id=21eddb5d6)

2012-04-13 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  regen
  [[28688e70a]](https://git.sudo.ws/sudo/commit/?id=28688e70a)

* configure, configure.in:

  Remove b8 from version number.
  [[05eec0c62]](https://git.sudo.ws/sudo/commit/?id=05eec0c62)

* src/ttyname.c:

  remove some XXX
  [[8db20e6ae]](https://git.sudo.ws/sudo/commit/?id=8db20e6ae)

* src/ttyname.c:

  When looking for a device match, do a breadth-first search instead of
  depth-first. We already special case /dev/pts/ so chances are good that
  if it is not a pseudo-tty it is in the base of /dev/. Also avoid a
  stat(2) when possible if struct dirent has d\_type.
  [[48d3b5aad]](https://git.sudo.ws/sudo/commit/?id=48d3b5aad)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod,
  src/sudo.c, src/sudo.h:

  Pass pid, ppid, sid, pgid and tcpgid to plugin in user\_info list.
  [[5f969cc12]](https://git.sudo.ws/sudo/commit/?id=5f969cc12)

* src/po/eo.mo, src/po/es.mo, src/po/es.po, src/po/fi.mo, src/po/ja.mo,
  src/po/pl.mo, src/po/ru.mo, src/po/uk.mo, src/po/vi.mo:

  sync with translationproject.org
  [[89b90fa4c]](https://git.sudo.ws/sudo/commit/?id=89b90fa4c)

* MANIFEST, NEWS, doc/CONTRIBUTORS, src/po/gl.mo, src/po/gl.po,
  src/po/hr.mo, src/po/hr.po:

  New Croatian and Galician translations from translationproject.org
  [[8f8ede3d2]](https://git.sudo.ws/sudo/commit/?id=8f8ede3d2)

* src/ttyname.c:

  Add depth-first traversal of /dev/ for the /proc case when not
  /dev/pts/N
  [[08ad578b7]](https://git.sudo.ws/sudo/commit/?id=08ad578b7)

* config.h.in, configure, configure.in, plugins/sudoers/sudoreplay.c:

  If struct dirent has d\_type, use it to avoid an extra stat().
  [[b0993d877]](https://git.sudo.ws/sudo/commit/?id=b0993d877)

* plugins/sudoers/sudoreplay.c:

  Sort output of “sudoreplay -l”
  [[45fcc29dd]](https://git.sudo.ws/sudo/commit/?id=45fcc29dd)

2012-04-12 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Fix duplicate free introduced in last rev
  [[dffaeb9cb]](https://git.sudo.ws/sudo/commit/?id=dffaeb9cb)

2012-04-11 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  Instead of treating ^C from tgetpass() specially, always return
  AUTH\_INTR if tgetpass() returned NULL. Treat PAM\_AUTHINFO\_UNAVAIL like
  PAM\_AUTH\_ERR which Mac OS X returns this when there is no tty.
  [[dfc90ff0b]](https://git.sudo.ws/sudo/commit/?id=dfc90ff0b)

* config.h.in, configure, configure.in, src/ttyname.c:

  Rototill code to determine the tty. For Linux, we now look up the tty
  device in /proc/pid/stat instead of trying to open /proc/pid/fd/[0-2].
  The sudo\_ttyname\_dev() function maps the given device number to a
  string. On BSD, we can use devname(). On Solaris, \_ttyname\_dev() does
  what we want. TODO: write /dev/ traversal code for the generic
  sudo\_ttyname\_dev().
  [[83fc02bc9]](https://git.sudo.ws/sudo/commit/?id=83fc02bc9)

2012-04-10 Todd C. Miller

* src/ttyname.c:

  Define PRNODEV for those w/o it.
  [[271f3e205]](https://git.sudo.ws/sudo/commit/?id=271f3e205)

* config.h.in, configure, configure.in, src/ttyname.c:

  Check for SVR4-style struct psinfo.pr\_ttydev and use that to determine
  the tty if std{in,out,err} are not ttys.
  [[11f13be0d]](https://git.sudo.ws/sudo/commit/?id=11f13be0d)

* src/ttyname.c:

  Better support for SVR4-style /proc entries where we can’t use ttyname()
  on the /proc/pid/fd/[0-2] entries. We can, however, attempt to map the
  device number back to the correct pseudo-tty slave device.
  [[2e59eafba]](https://git.sudo.ws/sudo/commit/?id=2e59eafba)

* src/ttyname.c:

  When trying to determine the tty name, check parent’s stderr in addition
  to its stdin and stdout.
  [[329e224db]](https://git.sudo.ws/sudo/commit/?id=329e224db)

* src/exec\_pty.c:

  Treat a tty read failure like EOF as it usually means the pty has gone
  away. Handle write() on the tty returning EIO.
  [[eb8274bdc]](https://git.sudo.ws/sudo/commit/?id=eb8274bdc)

* src/exec.c, src/exec\_pty.c:

  Linux select() may return ENOMEM if there is a kernel resource shortage.
  Older Solaris select() may return EIO instead of EBADF when the tty goes
  away. If we get an unhandled select() failure, kill the child and exit
  cleanly.
  [[df04ccb20]](https://git.sudo.ws/sudo/commit/?id=df04ccb20)

* src/ttyname.c:

  Open /proc/pid/fd/[0-2] in non-blocking mode just in case we might block
  in open.
  [[30fee3aad]](https://git.sudo.ws/sudo/commit/?id=30fee3aad)

2012-04-09 Todd C. Miller

* plugins/sudoers/set\_perms.c:

  Fix restoration of AIX permissions.
  [[53357633f]](https://git.sudo.ws/sudo/commit/?id=53357633f)

* src/parse\_args.c:

  Allow the -k flag to be used along with the -i and -s flags.
  [[df067cac4]](https://git.sudo.ws/sudo/commit/?id=df067cac4)

* plugins/sudoers/sudoreplay.c:

  Plug memory leak in parse\_logfile() in the error path.
  [[5029c3cdc]](https://git.sudo.ws/sudo/commit/?id=5029c3cdc)

* plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, src/po/da.mo,
  src/po/da.po, src/po/eo.po, src/po/es.po, src/po/fi.po, src/po/it.mo,
  src/po/it.po, src/po/ja.po, src/po/pl.po, src/po/ru.po, src/po/uk.po,
  src/po/vi.po, src/po/zh\_CN.mo, src/po/zh\_CN.po:

  sync with translationproject.org
  [[21f3e0deb]](https://git.sudo.ws/sudo/commit/?id=21f3e0deb)

2012-04-08 Todd C. Miller

* compat/regress/glob/globtest.c, config.h.in, configure, configure.in,
  plugins/sudoers/match.c:

  Do not use GLOB\_BRACE or GLOB\_TILDE flags to glob()–we want the glob()
  and fnmatch() results to be consistent.
  [[0d108287b]](https://git.sudo.ws/sudo/commit/?id=0d108287b)

2012-04-06 Todd C. Miller

* MANIFEST, common/Makefile.in, common/ttysize.c, src/Makefile.in:

  Move ttysize.c to common so sudoreplay can use it.
  [[38ea65203]](https://git.sudo.ws/sudo/commit/?id=38ea65203)

* plugins/sudoers/sudoreplay.c:

  If I/O log file includes rows + cols, warn if the user’s tty is not big
  enough.
  [[7a6664e2e]](https://git.sudo.ws/sudo/commit/?id=7a6664e2e)

* plugins/sudoers/sudoreplay.c:

  Fix printing of TSID in “sudoreplay -l”
  [[ce8fd0ea3]](https://git.sudo.ws/sudo/commit/?id=ce8fd0ea3)

* common/sudo\_debug.c, include/sudo\_debug.h, plugins/sudoers/logging.c,
  plugins/sudoers/visudo.c, src/exec.c, src/exec\_pty.c:

  Log the process id in the debug file output. Since we don’t want to keep
  calling getpid(), stash the value at init time and when we fork().
  [[c8ce3a0a8]](https://git.sudo.ws/sudo/commit/?id=c8ce3a0a8)

* src/exec\_pty.c:

  Ignore SIGTTIN and SIGTTOU in main sudo process when I/O logging. It is
  better to receive EIO from read()/write() than to be suspended when we
  don’t expect it. Fixes a problem when our terminal is revoked which can
  happen when, e.g. our sshd is killed unceremoniously. Also, only change
  the value of “alive” from true to false, never from false to true. It is
  possible for us to receive notification of the child having stopped
  after it is already dead. This does not mean it has risen from the
  grave.
  [[bb898cd5d]](https://git.sudo.ws/sudo/commit/?id=bb898cd5d)

* src/exec\_pty.c:

  Distinguish between signals we received from the parent vs. those
  delivered explicitly to the monitor process in debugging info.
  [[b4acbc9fe]](https://git.sudo.ws/sudo/commit/?id=b4acbc9fe)

2012-04-05 Todd C. Miller

* plugins/sudoers/check.c:

  In Solaris 11, /dev/pts under the “dev” filesystem, not “devices”.
  Update tty\_is\_devpts() to match so we can determine when the tty has
  been reused.
  [[087059b29]](https://git.sudo.ws/sudo/commit/?id=087059b29)

* common/sudo\_debug.c, include/error.h, include/sudo\_debug.h:

  Always pass **func**, **FILE** and **LINE** in sudo\_debug\_printf() and
  use a new flag, SUDO\_DEBUG\_FILENO to specify when to use it. This allows
  consumers of sudo\_debug\_printf() to log that data without having to
  specify it manually.
  [[abdff2570]](https://git.sudo.ws/sudo/commit/?id=abdff2570)

* src/exec\_pty.c:

  Make this compile after last change.
  [[2311fed45]](https://git.sudo.ws/sudo/commit/?id=2311fed45)

* src/exec\_pty.c:

  Don’t try to restore the terminal if we are not the foreground process.
  Otherwise, we may be stopped by SIGTTOU when we try to update the
  terminal settings when cleaning up.
  [[c0a75ce9d]](https://git.sudo.ws/sudo/commit/?id=c0a75ce9d)

* src/exec.c:

  If select() return EBADF in the main event loop, one of the ttys must
  have gone away so perform any I/O we can and close the bad fds.
  [[6f4afc665]](https://git.sudo.ws/sudo/commit/?id=6f4afc665)

* common/sudo\_debug.c, include/error.h, include/sudo\_debug.h,
  plugins/sudoers/toke.c, plugins/sudoers/toke.h, plugins/sudoers/toke.l:

  Log warning() at SUDO\_DEBUG\_WARN not SUDO\_DEBUG\_ERROR. Log the function,
  file and line number in the debug log for warning() and error().
  [[2c84bd4d0]](https://git.sudo.ws/sudo/commit/?id=2c84bd4d0)

2012-04-04 Todd C. Miller

* common/sudo\_debug.c, include/error.h, include/sudo\_debug.h,
  src/conversation.c:

  Add SUDO\_DEBUG\_ERRNO flag to debug functions so we can log errno. Use
  this flag when wrapping error() and warning() so the debug output
  includes the error string.
  [[2fe41248a]](https://git.sudo.ws/sudo/commit/?id=2fe41248a)

2012-03-30 Todd C. Miller

* NEWS:

  Update for sudo 1.8.5
  [[a94855f56]](https://git.sudo.ws/sudo/commit/?id=a94855f56)

* plugins/sudoers/po/sudoers.pot:

  regen
  [[2965dbfcc]](https://git.sudo.ws/sudo/commit/?id=2965dbfcc)

* doc/CONTRIBUTORS:

  sync
  [[9d874182f]](https://git.sudo.ws/sudo/commit/?id=9d874182f)

* plugins/sudoers/pwutil.c:

  Use ecalloc()
  [[d00c2f34e]](https://git.sudo.ws/sudo/commit/?id=d00c2f34e)

* src/exec\_pty.c:

  Don’t need zero\_bytes() after ecalloc()
  [[7e6d00ed1]](https://git.sudo.ws/sudo/commit/?id=7e6d00ed1)

* config.h.in, configure, configure.in, src/sudo\_noexec.c:

  Add execvpe(), exect(), posix\_spawn() and posix\_spawnp() wrappers to
  sudo\_noexec.c.
  [[9ceea5cb7]](https://git.sudo.ws/sudo/commit/?id=9ceea5cb7)

* src/utmp.c:

  Fix compat setutxent and endutxent macros for systems with setutent()
  but not setutxent(). From Gustavo Zacarias
  [[5eb61122a]](https://git.sudo.ws/sudo/commit/?id=5eb61122a)

2012-03-29 Todd C. Miller

* configure.in:

  Add ignore\_result definition to AH\_BOTTOM
  [[2a6842e4b]](https://git.sudo.ws/sudo/commit/?id=2a6842e4b)

* common/sudo\_debug.c, config.h.in, plugins/sample/sample\_plugin.c,
  plugins/sudoers/iolog.c, plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/visudo.c, src/env\_hooks.c, src/exec.c, src/exec\_pty.c,
  src/tgetpass.c:

  Fix compiler warnings on some platforms and provide a better method of
  defeating gcc’s warn\_unused\_result attribute.
  [[aecb5206e]](https://git.sudo.ws/sudo/commit/?id=aecb5206e)

* configure, configure.in:

  Fix building the builtin zlib from a build dir. When a zlib dir was
  specified, prepend its include path instead of appending so we get the
  right zlib headers.
  [[8393ec050]](https://git.sudo.ws/sudo/commit/?id=8393ec050)

* doc/LICENSE, zlib/adler32.c, zlib/crc32.c, zlib/crc32.h, zlib/deflate.c,
  zlib/deflate.h, zlib/gzguts.h, zlib/gzlib.c, zlib/gzread.c,
  zlib/gzwrite.c, zlib/infback.c, zlib/inffixed.h, zlib/inflate.c,
  zlib/inftrees.c, zlib/trees.c, zlib/zconf.h.in, zlib/zlib.h,
  zlib/zutil.c, zlib/zutil.h:

  Update zlib to version 1.2.6
  [[af0f5cb62]](https://git.sudo.ws/sudo/commit/?id=af0f5cb62)

2012-03-28 Todd C. Miller

* include/missing.h:

  g/c \_\_unused which is no longer used
  [[1e7afbd53]](https://git.sudo.ws/sudo/commit/?id=1e7afbd53)

* src/env\_hooks.c:

  Fix compilation if RTLD\_NEXT is not defined.
  [[0a230feae]](https://git.sudo.ws/sudo/commit/?id=0a230feae)

* src/po/sr.mo, src/po/sr.po:

  sync with translationproject.org
  [[739ea68d0]](https://git.sudo.ws/sudo/commit/?id=739ea68d0)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudoers.cat,
  doc/sudoers.man.in:

  regen
  [[bab4f2ce7]](https://git.sudo.ws/sudo/commit/?id=bab4f2ce7)

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  regen
  [[8cc1507bb]](https://git.sudo.ws/sudo/commit/?id=8cc1507bb)

* Makefile.in:

  Ignore Project-Id-Version when comparing pot files.
  [[e04e66137]](https://git.sudo.ws/sudo/commit/?id=e04e66137)

* plugins/sudoers/bsm\_audit.c:

  Use error() instead of log\_fatal()
  [[5ff23fb85]](https://git.sudo.ws/sudo/commit/?id=5ff23fb85)

* plugins/sudoers/env.c:

  Fix signedness of didvar in env\_update\_didvar()
  [[b78ca957a]](https://git.sudo.ws/sudo/commit/?id=b78ca957a)

* plugins/sudoers/iolog.c:

  Quiet a compiler warning on some platforms.
  [[e3e2397cb]](https://git.sudo.ws/sudo/commit/?id=e3e2397cb)

* compat/fnmatch.c:

  cast ctype(3) function/macro arguments from char to unsigned char to
  avoid potential negative subscripting.
  [[e05576607]](https://git.sudo.ws/sudo/commit/?id=e05576607)

* common/setgroups.c:

  Quiet a warning on systems where the gids array in setgroups() is not
  prototyped as being const, even though it really is.
  [[78429a90d]](https://git.sudo.ws/sudo/commit/?id=78429a90d)

* src/env\_hooks.c:

  Quiet a compiler warning on systems where the argument to putenv(3) is
  const.
  [[e8251a077]](https://git.sudo.ws/sudo/commit/?id=e8251a077)

* plugins/sudoers/sudoreplay.c:

  Undo an incorrect int -> bool conversion.
  [[ea2fd83b3]](https://git.sudo.ws/sudo/commit/?id=ea2fd83b3)

* MANIFEST, NEWS, plugins/sudoers/po/sv.mo, plugins/sudoers/po/sv.po,
  src/po/sv.mo, src/po/sv.po:

  Add Swedish sudo and sudoers translations from translationproject.org
  [[a142d780c]](https://git.sudo.ws/sudo/commit/?id=a142d780c)

* plugins/sudoers/env.c:

  No need to preserve ODMDIR on AIX now that we always read
  /etc/environment.
  [[cfdc45ea6]](https://git.sudo.ws/sudo/commit/?id=cfdc45ea6)

2012-03-27 Todd C. Miller

* doc/sudoers.pod, plugins/sudoers/env.c:

  When initializing the environment for env\_reset, start out with the
  contents of /etc/environment on AIX and login.conf on BSD.
  [[caf01d98c]](https://git.sudo.ws/sudo/commit/?id=caf01d98c)

* doc/TROUBLESHOOTING, src/sudo.c:

  If we are not running with an effective uid of 0, try to give the user
  enough information to debug the problem.
  [[2f30694b8]](https://git.sudo.ws/sudo/commit/?id=2f30694b8)

* plugins/sudoers/getdate.c, plugins/sudoers/gram.c:

  Quiet a clang-analyzer false positive.
  [[12422f928]](https://git.sudo.ws/sudo/commit/?id=12422f928)

* src/tgetpass.c:

  If there is nothing to read from the askpass program, set errno to
  EINTR. This makes the cancel button behave like the user entered ^C at
  the password prompt when PAM is used.
  [[9be74cac4]](https://git.sudo.ws/sudo/commit/?id=9be74cac4)

* src/sudo.h, src/tgetpass.c:

  Fetch the value of “askpass” from the sudo conf struct.
  [[d35a8b4de]](https://git.sudo.ws/sudo/commit/?id=d35a8b4de)

* common/sudo\_conf.c:

  Fix matching of “Path askpass” and “Path noexec”
  [[8b3d118f6]](https://git.sudo.ws/sudo/commit/?id=8b3d118f6)

2012-03-26 Todd C. Miller

* plugins/sudoers/visudo.c:

  Quiet a clang-analyzer dead store warning.
  [[238186abc]](https://git.sudo.ws/sudo/commit/?id=238186abc)

* plugins/sudoers/sudoers.c:

  If the “timestampowner” user cannot be resolved, use ROOT\_UID instead of
  exiting with a fatal error.
  [[d9e5ea481]](https://git.sudo.ws/sudo/commit/?id=d9e5ea481)

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/check.c, plugins/sudoers/env.c, plugins/sudoers/iolog.c,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/parse.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudoers.c:

  Remove the NO\_EXIT flag to log\_error() and add a log\_fatal() function
  that exits and is marked no\_return. Fixes false positives from static
  analyzers and is easier for humans to read too.
  [[44ce5720d]](https://git.sudo.ws/sudo/commit/?id=44ce5720d)

2012-03-24 Todd C. Miller

* plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po, src/po/eo.mo,
  src/po/eo.po:

  sync with translationproject.org
  [[413c2accd]](https://git.sudo.ws/sudo/commit/?id=413c2accd)

2012-03-20 Todd C. Miller

* src/po/da.mo, src/po/da.po:

  sync with translationproject.org
  [[2569f943d]](https://git.sudo.ws/sudo/commit/?id=2569f943d)

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po:

  sync with translationproject.org
  [[048a4e3f8]](https://git.sudo.ws/sudo/commit/?id=048a4e3f8)

2012-03-19 Todd C. Miller

* src/po/it.mo, src/po/it.po:

  sync with translationproject.org
  [[e0e81674c]](https://git.sudo.ws/sudo/commit/?id=e0e81674c)

* common/sudo\_conf.c, plugins/sudoers/alias.c, plugins/sudoers/defaults.c,
  plugins/sudoers/env.c, plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/interfaces.c, plugins/sudoers/ldap.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/visudo.c, src/exec.c, src/exec\_pty.c, src/hooks.c,
  src/load\_plugins.c:

  Use ecalloc() when allocating structs.
  [[55d1a1a79]](https://git.sudo.ws/sudo/commit/?id=55d1a1a79)

* common/alloc.c, include/alloc.h:

  Add ecalloc() and commented out recalloc(). Use inline strnlen() instead
  of strlen() in estrndup().
  [[dbbb48c45]](https://git.sudo.ws/sudo/commit/?id=dbbb48c45)

2012-03-18 Todd C. Miller

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po, src/po/fi.mo,
  src/po/fi.po, src/po/ja.mo, src/po/ja.po, src/po/pl.mo, src/po/pl.po,
  src/po/ru.mo, src/po/ru.po, src/po/uk.mo, src/po/uk.po, src/po/vi.mo,
  src/po/vi.po, src/po/zh\_CN.mo, src/po/zh\_CN.po:

  sync with translationproject.org
  [[9eeacad6d]](https://git.sudo.ws/sudo/commit/?id=9eeacad6d)

2012-03-16 Todd C. Miller

* plugins/sudoers/set\_perms.c:

  Remove unused label
  [[c85afe4b9]](https://git.sudo.ws/sudo/commit/?id=c85afe4b9)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Document what changed in each plugin API revision
  [[ec7767978]](https://git.sudo.ws/sudo/commit/?id=ec7767978)

* plugins/sudoers/set\_perms.c:

  Remove bogus optimization that could lead to a double free of the group
  list.
  [[2ff9d0318]](https://git.sudo.ws/sudo/commit/?id=2ff9d0318)

2012-03-15 Todd C. Miller

* doc/TROUBLESHOOTING:

  Expand AIX /etc/security/privcmds entry.
  [[ced34a6e2]](https://git.sudo.ws/sudo/commit/?id=ced34a6e2)

* NEWS:

  Update for sudo 1.8.5
  [[db40f6b1b]](https://git.sudo.ws/sudo/commit/?id=db40f6b1b)

* common/sudo\_conf.c, doc/sample.sudo.conf, doc/sudo.cat, doc/sudo.man.in,
  doc/sudo.pod, doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in,
  doc/sudo\_plugin.pod, doc/sudoers.cat, doc/sudoers.man.in,
  doc/sudoers.pod, include/sudo\_conf.h, include/sudo\_plugin.h,
  src/load\_plugins.c, src/sudo.c, src/sudo\_plugin\_int.h:

  Rename plugin “args” to “options”
  [[96f046c1c]](https://git.sudo.ws/sudo/commit/?id=96f046c1c)

* doc/CONTRIBUTORS:

  Add Lithuanian and Vietnamese translators
  [[741f57e68]](https://git.sudo.ws/sudo/commit/?id=741f57e68)

* Makefile.in:

  Ignore comments when comparing new and old pot files.
  [[039c21487]](https://git.sudo.ws/sudo/commit/?id=039c21487)

* src/Makefile.in:

  regen
  [[1234d08c9]](https://git.sudo.ws/sudo/commit/?id=1234d08c9)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in:

  regen
  [[d73ed51c5]](https://git.sudo.ws/sudo/commit/?id=d73ed51c5)

* doc/sudo\_plugin.pod, include/sudo\_plugin.h, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/auth/sudo\_auth.h,
  plugins/sudoers/env.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, src/hooks.c, src/sudo.c, src/sudo.h:

  Pass a pointer to user\_env in to the init\_session policy plugin function
  so session setup can modify the user environment as needed. For PAM
  authentication, merge the PAM environment with the user environment at
  init\_session time. We no longer need to swap in the user\_env for environ
  during session init, nor do we need to disable the env hooks at
  init\_session time.
  [[6d1090994]](https://git.sudo.ws/sudo/commit/?id=6d1090994)

* plugins/sample/sample\_plugin.c:

  Add explicit NULL entries for init\_session, register\_hooks and
  deregister\_hooks with appropriate comments.
  [[0b1baf07e]](https://git.sudo.ws/sudo/commit/?id=0b1baf07e)

* compat/pw\_dup.c:

  Quiet a gcc “used uninitialized in this function” false positive.
  [[f587fa153]](https://git.sudo.ws/sudo/commit/?id=f587fa153)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  We should always call warning() with a format string or a string
  literal. In this case, the argument (path) is not user-controlled.
  [[b330cbbed]](https://git.sudo.ws/sudo/commit/?id=b330cbbed)

2012-03-14 Todd C. Miller

* src/selinux.c:

  Include sudo\_exec.h for the sudo\_execve() prototype.
  [[b3da8ccd8]](https://git.sudo.ws/sudo/commit/?id=b3da8ccd8)

* config.h.in, configure, configure.in:

  Add check for pam\_getenvlist()
  [[9cd65dafc]](https://git.sudo.ws/sudo/commit/?id=9cd65dafc)

* common/sudo\_conf.c:

  Set args to NULL in default plugin info struct when there is no Plugin
  line in sudo.conf.
  [[83459e13b]](https://git.sudo.ws/sudo/commit/?id=83459e13b)

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  regen
  [[c3ea638b3]](https://git.sudo.ws/sudo/commit/?id=c3ea638b3)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudoers.cat, doc/sudoers.ldap.cat,
  doc/sudoers.ldap.man.in, doc/sudoers.man.in, doc/sudoreplay.cat,
  doc/sudoreplay.man.in, doc/visudo.cat, doc/visudo.man.in:

  regen
  [[b61c0ab47]](https://git.sudo.ws/sudo/commit/?id=b61c0ab47)

* configure, configure.in:

  Bump version to 1.8.5
  [[ed774f2b1]](https://git.sudo.ws/sudo/commit/?id=ed774f2b1)

* doc/sudo\_plugin.pod:

  Document hooks API
  [[e852b3ab0]](https://git.sudo.ws/sudo/commit/?id=e852b3ab0)

2012-03-13 Todd C. Miller

* sudo.pp:

  Make sudoersdir relative to PKG\_INSTALL\_ROOT for Solaris.
  [[ca0d9c4be]](https://git.sudo.ws/sudo/commit/?id=ca0d9c4be)

* include/sudo\_plugin.h:

  Use sudo\_hook\_fn\_t in struct sudo\_hook.
  [[7e1106993]](https://git.sudo.ws/sudo/commit/?id=7e1106993)

* doc/TROUBLESHOOTING:

  If cross compiling, –host must include the OS in the tuple. E.g. –host
  powerpc-unknown-linux
  [[779b6c8e0]](https://git.sudo.ws/sudo/commit/?id=779b6c8e0)

2012-03-12 Todd C. Miller

* plugins/sudoers/parse.c:

  Fix bogus int -> bool conversion; tags can have a value of -1.
  [[d539c606e]](https://git.sudo.ws/sudo/commit/?id=d539c606e)

* plugins/sudoers/env.c:

  Add env\_should\_keep() and env\_should\_delete() wrapper functions to
  simplify things a bit and hide the fact that matches\_env\_check() is not
  bool.
  [[19fc56462]](https://git.sudo.ws/sudo/commit/?id=19fc56462)

* sudo.pp:

  Fix application of debian-specific sudoers mods when building packages
  as non-root.
  [[fa99904b2]](https://git.sudo.ws/sudo/commit/?id=fa99904b2)

* plugins/sudoers/env.c:

  matches\_env\_check() returns int, not boolean
  [[749784ea5]](https://git.sudo.ws/sudo/commit/?id=749784ea5)

* src/sudo\_edit.c:

  Fix compilation when seteuid() is not available.
  [[dc727ff6d]](https://git.sudo.ws/sudo/commit/?id=dc727ff6d)

* src/ttyname.c:

  Simply move the free of ki\_proc outside the realloc() loop.
  [[4bd136e11]](https://git.sudo.ws/sudo/commit/?id=4bd136e11)

* src/ttyname.c:

  Bring back the erealloc() for the ENOMEM loop and just zero the pointer
  after we free it.
  [[1ca500956]](https://git.sudo.ws/sudo/commit/?id=1ca500956)

* src/ttyname.c:

  Don’t try to erealloc() a potentially freed pointer; Mateusz Guzik
  [[9052833f7]](https://git.sudo.ws/sudo/commit/?id=9052833f7)

2012-03-10 Todd C. Miller

* plugins/sudoers/set\_perms.c:

  Use normal error path if unable to set sudoers gid.
  [[1e8f5d4aa]](https://git.sudo.ws/sudo/commit/?id=1e8f5d4aa)

* plugins/sudoers/set\_perms.c:

  Make this work again on systems w/o seteuid().
  [[7971a5e49]](https://git.sudo.ws/sudo/commit/?id=7971a5e49)

2012-03-09 Todd C. Miller

* plugins/sudoers/set\_perms.c:

  Fix compilation if no seteuid/setreuid/setresuid available.
  [[9c2dd5eec]](https://git.sudo.ws/sudo/commit/?id=9c2dd5eec)

* plugins/sudoers/set\_perms.c:

  Better error messages, and added debugging throughout. Fixed seteuid()
  version of set\_perms()/restore\_perms(). Fixed logic bug in AIX version
  of restore\_perms(). Added checks to avoid changing uid/gid when we don’t
  have to. Never set gid/uid state to -1, use the old value instead.
  [[b49bb17c3]](https://git.sudo.ws/sudo/commit/?id=b49bb17c3)

* src/exec\_pty.c, src/ttyname.c:

  Fix format string warning on Solaris with gcc 3.4.3.
  [[f745a041e]](https://git.sudo.ws/sudo/commit/?id=f745a041e)

* src/sudo.c:

  Always declare environ now that we swap it around unilaterally.
  [[4d1752d4d]](https://git.sudo.ws/sudo/commit/?id=4d1752d4d)

* src/Makefile.in:

  Honor LDFLAGS when linking sesh; from Vita Cizek
  [[b455bccc5]](https://git.sudo.ws/sudo/commit/?id=b455bccc5)

* src/sesh.c:

  Include alloc.h for estrdup() prototype; from Vita Cizek
  [[f5f3d4cf3]](https://git.sudo.ws/sudo/commit/?id=f5f3d4cf3)

2012-03-08 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Don’t read /etc/environment on Linux when using PAM, PAM should set the
  environment variables as needed via pam\_env.
  [[08c6c776c]](https://git.sudo.ws/sudo/commit/?id=08c6c776c)

* INSTALL:

  Fix editor goof.
  [[d4259ef2c]](https://git.sudo.ws/sudo/commit/?id=d4259ef2c)

* src/hooks.c, src/sudo.c, src/sudo.h:

  Disable environment hooks after we get user\_env back to make sure a
  plugin can’t to modify user\_env after we “own” it. This is kind of a
  hack but we don’t want the init\_session plugin function to modify
  user\_env.
  [[20a7633a3]](https://git.sudo.ws/sudo/commit/?id=20a7633a3)

* src/hooks.c, src/sudo.c:

  Add support for deregistering hooks. If an I/O log plugin fails to
  initialize, deregister its hooks (if any).
  [[9b58120c3]](https://git.sudo.ws/sudo/commit/?id=9b58120c3)

2012-03-07 Todd C. Miller

* plugins/sudoers/sudoers.c, src/sudo.c:

  Move LOGIN\_PATH and LOGIN\_SETENV handling to plugin now that we hook
  setenv.
  [[d4a3a5d8b]](https://git.sudo.ws/sudo/commit/?id=d4a3a5d8b)

* MANIFEST, aclocal.m4, common/sudo\_debug.c, compat/Makefile.in,
  compat/setenv.c, compat/unsetenv.c, config.h.in, configure,
  configure.in, include/sudo\_debug.h, include/sudo\_plugin.h, mkdep.pl,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/env.c,
  plugins/sudoers/ldap.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, src/Makefile.in, src/env\_hooks.c,
  src/hooks.c, src/load\_plugins.c, src/sudo.c, src/sudo.h,
  src/sudo\_plugin\_int.h:

  Initial cut at a hooks implementation. The plugin can register hooks for
  getenv, putenv, setenv and unsetenv. This makes it possible for the
  plugin to trap changes to the environment made by authentication methods
  such as PAM or BSD auth so that such changes are reflected in the
  environment passed back to sudo for execve().
  [[37770ecf1]](https://git.sudo.ws/sudo/commit/?id=37770ecf1)

2012-03-05 Todd C. Miller

* MANIFEST, src/po/vi.mo, src/po/vi.po:

  Add Vietnamese sudo translation from translationproject.org
  [[150425613]](https://git.sudo.ws/sudo/commit/?id=150425613)

2012-03-02 Todd C. Miller

* doc/sample.sudo.conf, doc/sudo.pod, doc/sudo\_plugin.pod,
  doc/sudoers.pod:

  List sudo\_noexec.so not noexec.so in the sample sudo.conf
  [[bfb6f7910]](https://git.sudo.ws/sudo/commit/?id=bfb6f7910)

* common/sudo\_conf.c, doc/sample.sudo.conf, doc/sudo.pod,
  doc/sudo\_plugin.pod, doc/sudoers.pod, include/sudo\_conf.h,
  include/sudo\_plugin.h, plugins/sample/sample\_plugin.c,
  plugins/sudoers/iolog.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/toke.l, src/load\_plugins.c, src/sudo.c,
  src/sudo\_plugin\_int.h:

  Add support for plugin args at the end of a Plugin line in sudo.conf.
  Bump the minor number accordingly and update the documentation. A plugin
  must check the sudo front end’s version before using the plugin\_args
  parameter since it is only supported for API version 1.2 and higher.
  [[a16dee915]](https://git.sudo.ws/sudo/commit/?id=a16dee915)

2012-03-01 Todd C. Miller

* plugins/sudoers/Makefile.in:

  update depends
  [[c623857fc]](https://git.sudo.ws/sudo/commit/?id=c623857fc)

* MANIFEST:

  secure\_path.c is in common, not compat
  [[c7635121d]](https://git.sudo.ws/sudo/commit/?id=c7635121d)

* configure, configure.in:

  Add check for variadic macro support in cpp.
  [[06e390a56]](https://git.sudo.ws/sudo/commit/?id=06e390a56)

2012-02-29 Todd C. Miller

* common/secure\_path.c, common/sudo\_conf.c, include/secure\_path.h,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Add type param to sudo\_secure\_path() and add sudo\_secure\_file() and
  sudo\_secure\_dir() wrappers which get by #includedir in sudoers.
  [[8d05f0d1b]](https://git.sudo.ws/sudo/commit/?id=8d05f0d1b)

2012-02-28 Todd C. Miller

* doc/visudo.pod, plugins/sudoers/visudo.c:

  Check the owner and mode in -c (check) mode unless the -f option is
  specified. Previously, the owner and mode were checked on the main
  sudoers file when the -s (strict) option was given, but this was not
  documented.
  [[35280a843]](https://git.sudo.ws/sudo/commit/?id=35280a843)

* config.h.in, configure, configure.in, src/ttyname.c:

  Prefer KERN\_PROC2 over KERN\_PROC. Fixes compilation on some versions of
  OpenBSD versions that have KERN\_PROC2 but not KERN\_PROC.
  [[966fa83a9]](https://git.sudo.ws/sudo/commit/?id=966fa83a9)

2012-02-27 Todd C. Miller

* doc/CONTRIBUTORS:

  Add Eric Lakin for patch in bug #538
  [[5fe6e4993]](https://git.sudo.ws/sudo/commit/?id=5fe6e4993)

* src/exec\_pty.c:

  Fix typo in safe\_close() made while converting to debug framework that
  prevented it from actually closing anything.
  [[6a37b4bf7]](https://git.sudo.ws/sudo/commit/?id=6a37b4bf7)

* src/exec\_pty.c:

  Add some more debugging.
  [[cc97c2e75]](https://git.sudo.ws/sudo/commit/?id=cc97c2e75)

* common/Makefile.in, compat/Makefile.in, doc/Makefile.in,
  include/Makefile.in:

  We need sysconfdir in compat/Makfile to get the proper sudo.conf path.
  Add standard prefix and foodir expansion in all Makefiles to avoid this
  problem in the future.
  [[28db1fbbe]](https://git.sudo.ws/sudo/commit/?id=28db1fbbe)

2012-02-25 Todd C. Miller

* MANIFEST, plugins/sudoers/po/lt.mo, plugins/sudoers/po/lt.po:

  New Lithuanian sudoers translation from translationproject.org
  [[5c970b217]](https://git.sudo.ws/sudo/commit/?id=5c970b217)

* plugins/sudoers/po/ja.po:

  Update from translationproject.org
  [[580208337]](https://git.sudo.ws/sudo/commit/?id=580208337)

2012-02-24 Todd C. Miller

* plugins/sudoers/ldap.c:

  When adding gids to the LDAP filter, only add the primary gid once. This
  is consistent with the space computation/allocation. From Eric Lakin
  [[4f9da8fda]](https://git.sudo.ws/sudo/commit/?id=4f9da8fda)

* doc/TROUBLESHOOTING:

  Add entry for AIX enhanced RBAC config.
  [[5a941fb41]](https://git.sudo.ws/sudo/commit/?id=5a941fb41)

* mkpkg:

  Target Mac OS X 10.5 when building packages.
  [[640c229b5]](https://git.sudo.ws/sudo/commit/?id=640c229b5)

2012-02-22 Todd C. Miller

* MANIFEST, common/Makefile.in, common/secure\_path.c, common/sudo\_conf.c,
  include/secure\_path.h, plugins/sudoers/Makefile.in,
  plugins/sudoers/sudoers.c:

  Relax the user/group/mode checks on sudoers files. As long as the file
  is owned by the right user, not world-writable and not writable by a
  group other than the one specified at configure time (gid 0 by default),
  the file is considered OK. Note that visudo will still set the mode to
  the value specified at configure time.
  [[415454ff5]](https://git.sudo.ws/sudo/commit/?id=415454ff5)

2012-02-21 Todd C. Miller

* plugins/sudoers/set\_perms.c:

  Add AIX-specific version of permission setting code to make sure that
  the saved uid gets restored properly.
  [[98486afbd]](https://git.sudo.ws/sudo/commit/?id=98486afbd)

* config.h.in, configure, configure.in, src/exec\_common.c:

  Check for LD\_PRELOAD variants in configure instead of checkign cpp
  symbols. In disable\_execute(), compute the length of the new envp and
  allocate it once instead of reallocating on demand. Also append old
  value of LD\_PRELOAD (if any) to the new value.
  [[22f4f10a3]](https://git.sudo.ws/sudo/commit/?id=22f4f10a3)

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in:

  Fix the description of noexec.
  [[6fb0090db]](https://git.sudo.ws/sudo/commit/?id=6fb0090db)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h:

  The “op” parameter to set\_default() must be int, not bool since it is
  set to ‘+’ or ‘-’ for list add and subtract.
  [[f6fdc909b]](https://git.sudo.ws/sudo/commit/?id=f6fdc909b)

* sudo.pp:

  Make sure sudoers is writable before calling ed script.
  [[0370e129f]](https://git.sudo.ws/sudo/commit/?id=0370e129f)

2012-02-17 Todd C. Miller

* doc/CONTRIBUTORS, doc/contributors.pod:

  Update contributors. Now includes translators and authors of compat
  code.
  [[f38afb532]](https://git.sudo.ws/sudo/commit/?id=f38afb532)

2012-02-16 Todd C. Miller

* src/po/sudo.pot:

  regen
  [[dfaf44368]](https://git.sudo.ws/sudo/commit/?id=dfaf44368)

* pp, sudo.pp:

  Build flat packages, not package bundles, on Mac OS X.
  [[1ceadea52]](https://git.sudo.ws/sudo/commit/?id=1ceadea52)

2012-02-10 Todd C. Miller

* sudo.pp:

  Move macos section to be with the other OS-specific sections.
  [[4ef2006eb]](https://git.sudo.ws/sudo/commit/?id=4ef2006eb)

* plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po:

  Sync with translationproject.org
  [[d439d8b48]](https://git.sudo.ws/sudo/commit/?id=d439d8b48)

* configure, configure.in:

  Don’t permanently add -D\_FORTIFY\_SOURCE=2 to CPPFLAGS
  [[054e44808]](https://git.sudo.ws/sudo/commit/?id=054e44808)

* sudo.pp:

  Add Mac OS X support, printing the latest chunk of the NEWS file and the
  license text in the installer.
  [[ef7dcd519]](https://git.sudo.ws/sudo/commit/?id=ef7dcd519)

* sudo.pp:

  Add explicit file modes that match those used by “make install”
  [[37570290c]](https://git.sudo.ws/sudo/commit/?id=37570290c)

* pp:

  Sync with upstream for Mac OS X fixes.
  [[86f809ab4]](https://git.sudo.ws/sudo/commit/?id=86f809ab4)

* plugins/sudoers/Makefile.in, src/Makefile.in:

  Got back to using “install-sh -M” for files installed as non-readable by
  owner. This fixes “make install” as non-root for package building.
  [[dfbd6e429]](https://git.sudo.ws/sudo/commit/?id=dfbd6e429)

2012-02-09 Todd C. Miller

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po,
  plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po:

  Sync with translationproject.org
  [[5c941edc9]](https://git.sudo.ws/sudo/commit/?id=5c941edc9)

* Makefile.in, doc/Makefile.in, include/Makefile.in,
  plugins/sample/Makefile.in, plugins/sample\_group/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Use -m not -M for install-sh for everything except setuid. Install
  locale .mo files mode 0444, not 0644. If timedir parent doesn’t exist,
  use default dir mode, not 0700.
  [[cb66fc6f1]](https://git.sudo.ws/sudo/commit/?id=cb66fc6f1)

2012-02-07 Todd C. Miller

* pp:

  Re-sync with upstream; no longer need a local patch.
  [[12eba56fd]](https://git.sudo.ws/sudo/commit/?id=12eba56fd)

* mkpkg:

  Add support for building Mac OS X packages.
  [[5afbdab23]](https://git.sudo.ws/sudo/commit/?id=5afbdab23)

* pp:

  Sync with upstream
  [[8891688e6]](https://git.sudo.ws/sudo/commit/?id=8891688e6)

* src/Makefile.in:

  No longer need to define \_PATH\_SUDO\_CONF here.
  [[c4d3f289f]](https://git.sudo.ws/sudo/commit/?id=c4d3f289f)

* src/exec\_common.c:

  Fix noexec for Mac OS X.
  [[cd0e10e1b]](https://git.sudo.ws/sudo/commit/?id=cd0e10e1b)

2012-02-06 Todd C. Miller

* common/Makefile.in:

  Move \_PATH\_SUDO\_CONF override to common to match sudo\_debug.c
  [[d35f50bd6]](https://git.sudo.ws/sudo/commit/?id=d35f50bd6)

* plugins/sudoers/set\_perms.c:

  More complete fix for LDR\_PRELOAD on AIX. The addition of
  set\_perm(PERM\_ROOT) before calling the nss open functions (needed to
  avoid a GNU TLS bug) also broke LDR\_PRELOAD. Setting the effective and
  then real uid to 0 for PERM\_ROOT works around the issue.
  [[e066ff5ca]](https://git.sudo.ws/sudo/commit/?id=e066ff5ca)

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  regen
  [[8dd16b63d]](https://git.sudo.ws/sudo/commit/?id=8dd16b63d)

* src/sudo.c:

  Set real uid to root before calling sudo\_edit() or run\_command() so that
  the monitor process is owned by root and not by the user. Otherwise, on
  AIX at least, the monitor process shows up in ps as belonging to the
  user (and can be killed by the user).
  [[c6ef58010]](https://git.sudo.ws/sudo/commit/?id=c6ef58010)

* plugins/sudoers/set\_perms.c:

  For PERM\_ROOT when using setreuid(), only set the euid to 0 prior to the
  call to setuid(0) if the current euid is non-zero. This effectively
  restores the state of things prior to rev 7bfeb629fccb. Fixes a problem
  on AIX where LDR\_PRELOAD was not being honored for the command being
  executed.
  [[656807823]](https://git.sudo.ws/sudo/commit/?id=656807823)

* MANIFEST, compat/pw\_dup.c, config.h.in, configure, configure.in,
  include/missing.h, src/sudo.c:

  Make a copy of the struct passwd in exec\_setup() to make sure nothing in
  the policy init modifies it.
  [[8c1d8a7b1]](https://git.sudo.ws/sudo/commit/?id=8c1d8a7b1)

2012-02-05 Todd C. Miller

* doc/sudoers.pod:

  update copyright
  [[b28dfa501]](https://git.sudo.ws/sudo/commit/?id=b28dfa501)

* common/sudo\_debug.c, include/sudo\_debug.h:

  g/c now-unused debug subsystems
  [[e16ae617e]](https://git.sudo.ws/sudo/commit/?id=e16ae617e)

* doc/sudo.pod, doc/sudoers.pod:

  Enumerate the debug subsystems used by sudo and sudoers.
  [[c32bd3db5]](https://git.sudo.ws/sudo/commit/?id=c32bd3db5)

2012-02-03 Todd C. Miller

* NEWS, common/sudo\_conf.c, doc/sample.sudo.conf, doc/sudo.pod,
  include/sudo\_conf.h, src/sudo.c:

  Normally, sudo disables core dumps while it is running. This behavior
  can now be modified at run time with a line in sudo.conf like “Set
  disable\_coredumps false”
  [[c970d464c]](https://git.sudo.ws/sudo/commit/?id=c970d464c)

* NEWS:

  Mention Spanish translation
  [[e6fbba698]](https://git.sudo.ws/sudo/commit/?id=e6fbba698)

* common/sudo\_debug.c:

  Make sure we don’t try to fall back to using the conversation function
  for debugging in the main sudo process if we are unable to open the
  debug file.
  [[c91f5ee68]](https://git.sudo.ws/sudo/commit/?id=c91f5ee68)

* MANIFEST, src/po/es.mo, src/po/es.po:

  Add sudo Spanish translation from translationproject.org
  [[2a2d2c4cd]](https://git.sudo.ws/sudo/commit/?id=2a2d2c4cd)

2012-02-02 Todd C. Miller

* plugins/sudoers/iolog.c:

  Better debug subsystem usage
  [[3da971ba3]](https://git.sudo.ws/sudo/commit/?id=3da971ba3)

* src/sudo.c:

  Remove duplicate function prototypes
  [[f5f9aadcc]](https://git.sudo.ws/sudo/commit/?id=f5f9aadcc)

2012-02-01 Todd C. Miller

* configure, configure.in:

  Error out if user specified –with-pam but we can’t find the headers or
  library. Also throw an error if the headers are present but the library
  is not and vice versa.
  [[f1fef17d8]](https://git.sudo.ws/sudo/commit/?id=f1fef17d8)

2012-01-31 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Fix the sudoers permission check when the expected sudoers mode is
  owner-writable.
  [[491b4495f]](https://git.sudo.ws/sudo/commit/?id=491b4495f)

2012-01-30 Todd C. Miller

* configure, configure.in:

  Verify that we can link executables built with -D\_FORTIFY\_SOURCE before
  using it.
  [[c894f802d]](https://git.sudo.ws/sudo/commit/?id=c894f802d)

* src/exec\_common.c:

  Fix potential off-by-one when making a copy of the environment for
  LD\_PRELOAD insertion. Fixes bug #534
  [[ca4a338c4]](https://git.sudo.ws/sudo/commit/?id=ca4a338c4)

* configure, configure.in:

  Add rudimentary check for \_FORTIFY\_SOURCE support by checking for
  \_\_sprintf\_chk, one of the functions used by gcc to support it.
  [[7908621ba]](https://git.sudo.ws/sudo/commit/?id=7908621ba)

* compat/stdbool.h, config.h.in, configure, configure.in:

  Use AC\_HEADER\_STDBOOL instead of checking for stdbool.h ourselves.
  [[da6fe1230]](https://git.sudo.ws/sudo/commit/?id=da6fe1230)

2012-01-29 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  regen
  [[f3f986c75]](https://git.sudo.ws/sudo/commit/?id=f3f986c75)

2012-01-25 Todd C. Miller

* src/exec.c, src/sudo.c:

  The change in 818e82ecbbfc that caused to exit when the monitor dies
  created a race condition between the monitor exiting and the status
  being read. All we really want to do is make sure that select() notifies
  us that there is a status change when the monitor dies unexpectedly so
  shutdown the socketpair connected to the monitor for writing when it
  dies. That way we can still read the status that is pending on the
  socket and select() on Linux will tell us that the fd is ready.
  [[1877c455d]](https://git.sudo.ws/sudo/commit/?id=1877c455d)

* MANIFEST, src/Makefile.in, src/exec.c, src/exec\_common.c,
  src/exec\_pty.c, src/selinux.c, src/sesh.c, src/sudo.c, src/sudo.h,
  src/sudo\_exec.h:

  Refactor disable\_execute() and my\_execve() into exec\_common.c for use by
  sesh.c. This fixes NOEXEC when SELinux is used. Instead of disabling
  exec in exec\_setup(), disable it immediately before executing the
  command. Adapted from a diff by Arno Schuring.
  [[d11e7febb]](https://git.sudo.ws/sudo/commit/?id=d11e7febb)

2012-01-20 Todd C. Miller

* aclocal.m4, configure, configure.in:

  Add custom version of AC\_CHECK\_LIB that uses the extra libs in the cache
  value name. With this we no longer need to rely on a modified version of
  autoconf.
  [[e852bf437]](https://git.sudo.ws/sudo/commit/?id=e852bf437)

2012-01-19 Todd C. Miller

* configure, configure.in:

  Better handling of network functions that need -lsocket -lnsl
  [[d337a532a]](https://git.sudo.ws/sudo/commit/?id=d337a532a)

* src/sudo.c:

  When setting up the execution environment, set groups before gid/egid
  like sudo 1.7 did.
  [[66a66729a]](https://git.sudo.ws/sudo/commit/?id=66a66729a)

* configure, configure.in:

  Remove “WARNING: unable to find foo() trying -lsocket -lnsl”
  [[8e3691c38]](https://git.sudo.ws/sudo/commit/?id=8e3691c38)

* plugins/sudoers/sudoers.c:

  For “sudo -g” prepend the specified group ID to the beginning of the
  groups list. This matches BSD convention where the effective gid is the
  first entry in the group list. This is required on newer FreeBSD where
  the effective gid is not tracked separately and thus setgroups() changes
  the egid if this convention is not followed. Fixes bug #532
  [[a5dfea7cd]](https://git.sudo.ws/sudo/commit/?id=a5dfea7cd)

2012-01-17 Todd C. Miller

* configure, configure.in:

  Fix sh warning; use “test” instead of “[”
  [[7747b481d]](https://git.sudo.ws/sudo/commit/?id=7747b481d)

* src/exec.c:

  When not logging I/O, use a signal handler that only forwards SIGINT,
  SIGQUIT and SIGHUP when they are user-generated signals. Fixes a race in
  the non-I/O logging path where the command may receive two
  keyboard-generated signals; one from the kernel and one from the sudo
  process.
  [[2fd77381a]](https://git.sudo.ws/sudo/commit/?id=2fd77381a)

* src/exec.c:

  Back out change that put the command in its own pgrp when not logging
  I/O. It causes problems with pipelines.
  [[97cecaf6e]](https://git.sudo.ws/sudo/commit/?id=97cecaf6e)

2012-01-16 Todd C. Miller

* compat/Makefile.in, configure, configure.in:

  Only run compat regress tests on compat objects we actually build. Fixes
  “make check” in the compat dir for systems that don’t implement
  character classes in fnmatch() or glob(). [Bug
  #531](https://bugzilla.sudo.ws/show_bug.cgi?id=531)
  [[40badb50e]](https://git.sudo.ws/sudo/commit/?id=40badb50e)

2012-01-14 Todd C. Miller

* plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po:

  Update po files from translationproject.org
  [[0df60d8ec]](https://git.sudo.ws/sudo/commit/?id=0df60d8ec)

2012-01-13 Todd C. Miller

* sudo.pp:

  Include parent directories in case they don’t already exist. This fixes
  a directory permissions problem with the AIX package when the /usr/local
  directories don’t already exist.
  [[4baffc780]](https://git.sudo.ws/sudo/commit/?id=4baffc780)

* pp:

  sync with git version
  [[4d8a8e015]](https://git.sudo.ws/sudo/commit/?id=4d8a8e015)

* common/Makefile.in, plugins/sudoers/Makefile.in, src/Makefile.in:

  regen dependencies
  [[ee0fb36d8]](https://git.sudo.ws/sudo/commit/?id=ee0fb36d8)

* MANIFEST, src/Makefile.in, src/sudo.c, src/sudo.h, src/ttyname.c:

  Move tty name lookup code to its own file.
  [[106bbebba]](https://git.sudo.ws/sudo/commit/?id=106bbebba)

2012-01-12 Todd C. Miller

* NEWS:

  Update with latest sudo 1.8.4 changes.
  [[83006b000]](https://git.sudo.ws/sudo/commit/?id=83006b000)

* config.h.in, configure, configure.in:

  Remove obsolete template for HAVE\_TIMESPEC
  [[760cdb00d]](https://git.sudo.ws/sudo/commit/?id=760cdb00d)

* src/sudo.c:

  Add a check for devname() returning a fully-qualified pathname. None of
  the devname() implementations do this today but you never know when this
  might change.
  [[1c038be41]](https://git.sudo.ws/sudo/commit/?id=1c038be41)

2012-01-11 Todd C. Miller

* plugins/sudoers/visudo.c:

  For “visudo -c” also list include files that were checked when
  everything is OK.
  [[315b998a6]](https://git.sudo.ws/sudo/commit/?id=315b998a6)

* src/sudo.c:

  The device name returned by devname() does not include the /dev/ prefix
  so we need to add it ourselves.
  [[f05de3f3f]](https://git.sudo.ws/sudo/commit/?id=f05de3f3f)

* src/sudo.c:

  Add debug warning if KERN\_PROC sysctl fails or devname() can’t resolve
  the tty device to a name.
  [[f7b04c32a]](https://git.sudo.ws/sudo/commit/?id=f7b04c32a)

* common/sudo\_debug.c:

  The result of writev() is never checked so just cast to NULL.
  [[fa15fc765]](https://git.sudo.ws/sudo/commit/?id=fa15fc765)

* plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po:

  Update Esperanto, Finnish, Polish and Ukrainian translations from
  translationproject.org.
  [[8fd2b8b93]](https://git.sudo.ws/sudo/commit/?id=8fd2b8b93)

2012-01-10 Todd C. Miller

* config.h.in, configure, configure.in, src/sudo.c:

  Add support for determining tty via sysctl on other BSD variants.
  [[528258aff]](https://git.sudo.ws/sudo/commit/?id=528258aff)

* configure, configure.in:

  Only check for struct kinfo\_proc.ki\_tdev on systems that support sysctl.
  [[5c59576ea]](https://git.sudo.ws/sudo/commit/?id=5c59576ea)

* src/sudo.c:

  For FreeBSD, try the KERN\_PROC\_PID sysctl() first, falling back on
  ttyname() of std{in,out,err}.
  [[832c4c9d5]](https://git.sudo.ws/sudo/commit/?id=832c4c9d5)

2012-01-09 Todd C. Miller

* config.h.in, configure, configure.in, src/sudo.c:

  On newer FreeBSD we can get the parent’s tty name via sysctl().
  [[974e50dcf]](https://git.sudo.ws/sudo/commit/?id=974e50dcf)

* plugins/sudoers/testsudoers.c:

  Include locale.h
  [[c30872260]](https://git.sudo.ws/sudo/commit/?id=c30872260)

* src/sudo.c:

  Silence a gcc warning.
  [[c142a52f5]](https://git.sudo.ws/sudo/commit/?id=c142a52f5)

* plugins/sudoers/bsm\_audit.c:

  Need to include gettext.h and sudo\_debug.h; from John Hein
  [[d5571aa1e]](https://git.sudo.ws/sudo/commit/?id=d5571aa1e)

* plugins/sudoers/iolog.c:

  Initialize the debug framework from the I/O plugin too.
  [[373043b4d]](https://git.sudo.ws/sudo/commit/?id=373043b4d)

2012-01-08 Todd C. Miller

* plugins/sudoers/testsudoers.c:

  Enable debugging via sudo.conf.
  [[5dd3f0ec5]](https://git.sudo.ws/sudo/commit/?id=5dd3f0ec5)

2012-01-07 Todd C. Miller

* plugins/sudoers/visudo.c:

  Use SUDO\_DEBUG\_ALIAS for alias checking functions.
  [[efbf020d4]](https://git.sudo.ws/sudo/commit/?id=efbf020d4)

* configure, configure.in:

  More complete test for getaddrinfo() that doesn’t rely on the network
  libraries already being added to LIBS.
  [[b1882a794]](https://git.sudo.ws/sudo/commit/?id=b1882a794)

2012-01-06 Todd C. Miller

* common/aix.c:

  Add debug support.
  [[13561805d]](https://git.sudo.ws/sudo/commit/?id=13561805d)

* configure, configure.in:

  Need -lsocket -lnsl for getaddrinfo(3) on Solaris at least.
  [[c1a9cc9ab]](https://git.sudo.ws/sudo/commit/?id=c1a9cc9ab)

* compat/getaddrinfo.c:

  Include errno.h and missing.h
  [[e7ae9dbba]](https://git.sudo.ws/sudo/commit/?id=e7ae9dbba)

* .hgignore:

  ignore doc/varsub
  [[1cfd09c88]](https://git.sudo.ws/sudo/commit/?id=1cfd09c88)

* configure.in, doc/visudo.pod, plugins/sudoers/Makefile.in,
  plugins/sudoers/gram.y, plugins/sudoers/match.c,
  plugins/sudoers/parse.c, plugins/sudoers/testsudoers.c, src/exec.c,
  src/parse\_args.c, src/sudo.c, src/sudo.h:

  Update copyright year.
  [[0771c981d]](https://git.sudo.ws/sudo/commit/?id=0771c981d)

* NEWS:

  Update for sudo 1.8.4
  [[a9a3cbd41]](https://git.sudo.ws/sudo/commit/?id=a9a3cbd41)

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  regen pot files
  [[6021ad08c]](https://git.sudo.ws/sudo/commit/?id=6021ad08c)

* plugins/sudoers/sudoreplay.c:

  Enable debugging via sudo.conf.
  [[ae43a19ad]](https://git.sudo.ws/sudo/commit/?id=ae43a19ad)

* plugins/sudoers/visudo.c:

  Enable debugging via sudo.conf.
  [[38526ca14]](https://git.sudo.ws/sudo/commit/?id=38526ca14)

* plugins/sudoers/visudo.c:

  Allow “visudo -c” to work when we only have read-only access to the
  sudoers include files.
  [[baa9273dd]](https://git.sudo.ws/sudo/commit/?id=baa9273dd)

* doc/sudo.pod, doc/visudo.pod:

  Mention the CONTRIBUTORS file, not HISTORY in AUTHOR section. Add
  HISTORY section in sudo that points to HISTORY file.
  [[37fe423cd]](https://git.sudo.ws/sudo/commit/?id=37fe423cd)

* doc/sudo.pod, doc/sudo\_plugin.pod:

  Document Debug setting in sudo.conf and debug\_flags in plugin.
  [[45e1623b5]](https://git.sudo.ws/sudo/commit/?id=45e1623b5)

2012-01-05 Todd C. Miller

* plugins/sudoers/match.c:

  Do not include GLOB\_MARK in the flags we pass to glob(3). Fixes a bug
  where a pattern like “/usr/\*” include /usr/bin/ in the results, which
  would be incorrectly be interpreted as if the sudoers file had specified
  a directory. From Vitezslav Cizek.
  [[c4ba51161]](https://git.sudo.ws/sudo/commit/?id=c4ba51161)

* INSTALL, config.h.in, configure, configure.in,
  plugins/sudoers/auth/kerb5.c:

  Add –enable-kerb5-instance configure option to allow people using
  Kerberos V authentication to use a custom instance. Adapted from a diff
  by Michael E Burr.
  [[241b1db87]](https://git.sudo.ws/sudo/commit/?id=241b1db87)

* doc/sudo.pod, src/parse\_args.c, src/sudo.c, src/sudo.h:

  Remove -D debug\_level option.
  [[72a4e0943]](https://git.sudo.ws/sudo/commit/?id=72a4e0943)

* doc/LICENSE:

  Update copyright year.
  [[9c27e91b5]](https://git.sudo.ws/sudo/commit/?id=9c27e91b5)

2012-01-04 Todd C. Miller

* plugins/sudoers/parse.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  parse\_error is now bool, not int
  [[47bcaf57b]](https://git.sudo.ws/sudo/commit/?id=47bcaf57b)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.c:
  Print a more sensible error if yyparse() returns non-zero but yyerror()
  was not called.
  [[0f5eaa17f]](https://git.sudo.ws/sudo/commit/?id=0f5eaa17f)

* plugins/sudoers/Makefile.in, plugins/sudoers/getdate.c,
  plugins/sudoers/gram.c:

  Replace y.tab.c with the correct filename in #line directives.
  [[a1815e17c]](https://git.sudo.ws/sudo/commit/?id=a1815e17c)

2012-01-03 Todd C. Miller

* src/sudo.c:

  When trying to determine the tty, fall back on /proc/ppid/fd/{0,1,2} if
  the main process’s fds 0-2 are not hooked up to a tty. Adapted from a
  diff by Zdenek Behan.
  [[4da65677b]](https://git.sudo.ws/sudo/commit/?id=4da65677b)

* src/exec.c:

  When not logging I/O, put command in its own pgrp and make that the
  controlling pgrp if the command is in the foreground. Fixes a race in
  the non-I/O logging path where the command may receive two
  keyboard-generated signals; one from the kernel and one from the sudo
  process.
  [[5bc075640]](https://git.sudo.ws/sudo/commit/?id=5bc075640)

2011-12-20 Todd C. Miller

* src/sudo\_edit.c:

  Quiet a bogus gcc warning.
  [[7799d01cf]](https://git.sudo.ws/sudo/commit/?id=7799d01cf)

* src/parse\_args.c, src/sudo.h:

  Fix warnings related to sudo.conf accessors.
  [[089ee4222]](https://git.sudo.ws/sudo/commit/?id=089ee4222)

* common/sudo\_conf.c, include/sudo\_conf.h:

  Separate sudo.conf parsing from plugin loading and move the parse
  functions into the common lib so that visudo, etc. can use them.
  [[fa1f781a0]](https://git.sudo.ws/sudo/commit/?id=fa1f781a0)

* MANIFEST, common/Makefile.in, src/Makefile.in, src/load\_plugins.c,
  src/parse\_args.c, src/sudo.c, src/sudo\_plugin\_int.h:

  Separate sudo.conf parsing from plugin loading and move the parse
  functions into the common lib so that visudo, etc. can use them.
  [[1c3965f53]](https://git.sudo.ws/sudo/commit/?id=1c3965f53)

* doc/sudoers.pod, plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/sudoers.c, src/sudo.c:

  Remove support for noexec\_file in sudoers and the plugin API
  [[fb3c9f2ca]](https://git.sudo.ws/sudo/commit/?id=fb3c9f2ca)

* plugins/sudoers/sudoers.c:

  Don’t dump interfaces if there are none.
  [[4aa0ccb22]](https://git.sudo.ws/sudo/commit/?id=4aa0ccb22)

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in:

  Add missing %s printf escape to the group\_plugin, iolog\_dir and
  iolog\_file descriptions.
  [[91839036d]](https://git.sudo.ws/sudo/commit/?id=91839036d)

2011-12-18 Todd C. Miller

* plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.in, src/exec.c:

  Fix typo in visiblepw description; from Joel Pickett
  [[1f97735fb]](https://git.sudo.ws/sudo/commit/?id=1f97735fb)

2011-12-08 Todd C. Miller

* MANIFEST, configure, configure.in, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/env.c,
  plugins/sudoers/login\_class.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, src/sudo.c:

  When running a login shell with a login\_class specified, use
  LOGIN\_SETENV instead of rolling our own login.conf setenv support since
  FreeBSD’s login.conf has more than just setenv capabilities. This
  requires us to swap the plugin-provided envp for the global environ
  before calling setusercontext() and then stash the resulting environ
  pointer back into the command details, which is kind of a hack.
  [[a24d86b32]](https://git.sudo.ws/sudo/commit/?id=a24d86b32)

* plugins/sudoers/Makefile.in:

  If srcdir is “.” just use the basename of the yacc/lex file when
  generating the C version. This matches the generated files currently in
  the repo.
  [[27616d1f3]](https://git.sudo.ws/sudo/commit/?id=27616d1f3)

* doc/Makefile.in, plugins/sudoers/Makefile.in:

  Clean up the DEVEL noise
  [[31c08fca3]](https://git.sudo.ws/sudo/commit/?id=31c08fca3)

* src/exec.c:

  Handle different Unix domain socket (actually socketpair) semantics in
  BSD vs. Linux. In BSD if one end of the socketpair goes away select()
  returns the fd as readable and the read will fail with ECONNRESET. This
  doesn’t appear to happen on Linux so if we notice that the monitor
  process has died when I/O logging is enabled, behave like the command
  has exited. This means we log the wait status of the monitor, not the
  command, but there is nothing else we can do at that point. This should
  only be an issue if SIGKILL is sent to the monitor process.
  [[98c77b5b9]](https://git.sudo.ws/sudo/commit/?id=98c77b5b9)

* src/exec\_pty.c:

  Catch common signals in the monitor process so they get passed to the
  command. Fixes a problem when the entire login session is killed when
  ssh is disconnected or the terminal window is closed. Previously, the
  monitor would exit and plugin’s close method would not be called.
  [[6bcf470fe]](https://git.sudo.ws/sudo/commit/?id=6bcf470fe)

* INSTALL, configure, configure.in:

  Mention how to configure pam\_hpsec on HP-UX to play nicely with sudo.
  [[edd32aa8d]](https://git.sudo.ws/sudo/commit/?id=edd32aa8d)

2011-12-07 Todd C. Miller

* plugins/sudoers/ldap.c:

  Escape values in the search expression as per RFC 4515.
  [[666d8d635]](https://git.sudo.ws/sudo/commit/?id=666d8d635)

* doc/Makefile.in, include/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  src/Makefile.in:

  No need for install target to depend explicitly on install-dirs, the
  install-foo targets all depend on it.
  [[1cec1f477]](https://git.sudo.ws/sudo/commit/?id=1cec1f477)

2011-12-05 Todd C. Miller

* .hgignore:

  ignore src/sesh
  [[faa10aa82]](https://git.sudo.ws/sudo/commit/?id=faa10aa82)

* MANIFEST, common/Makefile.in, configure, configure.in, mkdep.pl,
  plugins/sample/Makefile.in, plugins/sample\_group/Makefile.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/env.c,
  plugins/sudoers/login\_class.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, src/Makefile.in:

  Add support for setenv entries in login.conf. We can’t use LOGIN\_SETENV
  since the plugin sets up the envp the command is executed with. Also
  regen the Makefile.in files while here. Fixes bug #527
  [[9f0abb469]](https://git.sudo.ws/sudo/commit/?id=9f0abb469)

2011-12-02 Todd C. Miller

* MANIFEST, aclocal.m4, compat/getaddrinfo.c, compat/getaddrinfo.h,
  config.h.in, configure, configure.in, plugins/sudoers/sudoers.c,
  src/net\_ifs.c:

  Add getaddrinfo() for those without it, written by Russ Allbery
  [[38a4990e4]](https://git.sudo.ws/sudo/commit/?id=38a4990e4)

* doc/Makefile.in:

  Restore PACKAGE\_TARNAME, it is used in docdir
  [[62011b677]](https://git.sudo.ws/sudo/commit/?id=62011b677)

* MANIFEST, compat/stdbool.h:

  SunPro C Compiler also has a \_Bool builtin. Also add stdbool.h to the
  MANIFEST
  [[feaad3aff]](https://git.sudo.ws/sudo/commit/?id=feaad3aff)

* common/atobool.c, common/term.c, src/exec.c:

  Remove duplicate return statements.
  [[0e26e43b9]](https://git.sudo.ws/sudo/commit/?id=0e26e43b9)

* plugins/sudoers/auth/bsdauth.c:

  Remove inaccurate comment
  [[db3fd558b]](https://git.sudo.ws/sudo/commit/?id=db3fd558b)

* plugins/sudoers/auth/bsdauth.c, plugins/sudoers/sudoers.c:

  Fetch the login class for the user we authenticate specifically when
  using BSD authentication. That user may have a different login class
  than what we will use to run the command. When setting the login class
  for the command, use the target user’s struct passwd, not the invoking
  user’s. Fixes bug 526
  [[199eeb38d]](https://git.sudo.ws/sudo/commit/?id=199eeb38d)

* compat/Makefile.in, configure, configure.in, doc/Makefile.in,
  plugins/sudoers/Makefile.in:

  Replace @DEV@ prefix with DEVEL variable so we can do “make DEVEL=1”
  [[01147eda3]](https://git.sudo.ws/sudo/commit/?id=01147eda3)

* plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_fill.c:

  Fix “make check” fallout from the sudo\_conv changes in sudo\_debug.
  [[b58c1ff6e]](https://git.sudo.ws/sudo/commit/?id=b58c1ff6e)

* common/fileops.c, common/sudo\_debug.c, configure, configure.in,
  include/fileops.h, plugins/sample/Makefile.in,
  plugins/sample/sample\_plugin.c, plugins/sample\_group/Makefile.in,
  plugins/sample\_group/sample\_group.c, plugins/sudoers/alias.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/check.c,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/env.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/ldap.c, plugins/sudoers/match.c,
  plugins/sudoers/match\_addr.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/pwutil.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c, src/exec.c,
  src/exec\_pty.c, src/load\_plugins.c, src/sudo.c, src/sudo.h,
  src/sudo\_exec.h, src/sudo\_plugin\_int.h, src/utmp.c:

  Use stdbool.h instead of rolling our own TRUE/FALSE macros.
  [[21a2f9582]](https://git.sudo.ws/sudo/commit/?id=21a2f9582)

2011-12-01 Todd C. Miller

* compat/stdbool.h, config.h.in, configure, configure.in:

  Add stdbool.h for systems without it.
  [[86c86183a]](https://git.sudo.ws/sudo/commit/?id=86c86183a)

* aclocal.m4, config.h.in, configure, configure.in:

  No longer need SUDO\_CHECK\_TYPE and SUDO\_TYPE\_\* now that the default
  includes have unistd.h in them. Add check for socklen\_t for upcoming
  getaddrinfo compat.
  [[e54fc4eb3]](https://git.sudo.ws/sudo/commit/?id=e54fc4eb3)

* common/fileops.c, compat/nanosleep.c, config.h.in, configure,
  configure.in, plugins/sudoers/interfaces.c,
  plugins/sudoers/interfaces.h, plugins/sudoers/match\_addr.c,
  plugins/sudoers/sudoreplay.c, src/net\_ifs.c:

  Use HAVE\_STRUCT\_TIMESPEC and HAVE\_STRUCT\_IN6\_ADDR instead of
  HAVE\_TIMESPEC and HAVE\_IN6\_ADDR respectively.
  [[51e45647a]](https://git.sudo.ws/sudo/commit/?id=51e45647a)

* src/sudo\_noexec.c:

  No longer need to include time.h here as missing.h does not use time\_t.
  [[3f4b68dd1]](https://git.sudo.ws/sudo/commit/?id=3f4b68dd1)

2011-11-30 Todd C. Miller

* plugins/sudoers/visudo.c:

  Fix mode on sudoers as needed when the -f option is not specified.
  [[21a1460d4]](https://git.sudo.ws/sudo/commit/?id=21a1460d4)

* MANIFEST, src/po/sr.mo, src/po/sr.po:

  Add Serbian translation for sudo from translationproject.org
  [[f7925b588]](https://git.sudo.ws/sudo/commit/?id=f7925b588)

* common/sudo\_debug.c, plugins/sudoers/sudoers.c, src/load\_plugins.c,
  src/parse\_args.c:

  No longer pass debug\_file to plugin, plugins must now use CONV\_DEBUG\_MSG
  [[ab887a6fb]](https://git.sudo.ws/sudo/commit/?id=ab887a6fb)

* mkpkg:

  Build PIE executables for newer Debian and Ubuntu
  [[13514ec03]](https://git.sudo.ws/sudo/commit/?id=13514ec03)

* common/sudo\_debug.c:

  Include time.h for ctime() prototype.
  [[8fa6ab037]](https://git.sudo.ws/sudo/commit/?id=8fa6ab037)

2011-11-29 Todd C. Miller

* common/sudo\_debug.c, include/sudo\_debug.h, src/exec.c, src/exec\_pty.c:

  Do not close error pipe or debug fd via closefrom() as we need them to
  report an exec error should one occur.
  [[a64f1eaea]](https://git.sudo.ws/sudo/commit/?id=a64f1eaea)

* doc/sudoers.ldap.pod:

  Document that a sudoUser may now be a group ID.
  [[3b2998d55]](https://git.sudo.ws/sudo/commit/?id=3b2998d55)

* plugins/sudoers/ldap.c:

  Add support for permitting access by group ID in addition to group name.
  [[b12b4fdc7]](https://git.sudo.ws/sudo/commit/?id=b12b4fdc7)

* plugins/sudoers/ldap.c:

  Older Netscape LDAP SDKs don’t prototype ldapssl\_set\_strength()
  [[627e485c0]](https://git.sudo.ws/sudo/commit/?id=627e485c0)

* compat/fnmatch.c, compat/fnmatch.h, doc/LICENSE:

  Replace UCB fnmatch.c with a non-recursive version written by William A.
  Rowe Jr.
  [[e9e4a8452]](https://git.sudo.ws/sudo/commit/?id=e9e4a8452)

* plugins/sudoers/auth/pam.c:

  Fix typo, return\_debug vs. debug\_return
  [[dd2fcf16d]](https://git.sudo.ws/sudo/commit/?id=dd2fcf16d)

2011-11-23 Todd C. Miller

* plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po:

  Update Japanese sudoers translation from translationproject.org
  [[6dbf8cc23]](https://git.sudo.ws/sudo/commit/?id=6dbf8cc23)

* doc/sudoers.pod:

  Make the env\_reset descriptions consistent.
  [[e43b726e9]](https://git.sudo.ws/sudo/commit/?id=e43b726e9)

2011-11-22 Todd C. Miller

* configure, configure.in:

  Do multiple expansion when expanding paths to the noexec file, sesh and
  the plugin directory. Adapted from a diff by Mike Frysinger
  [[1b9f2cdbc]](https://git.sudo.ws/sudo/commit/?id=1b9f2cdbc)

* common/Makefile.in:

  regen
  [[12352244b]](https://git.sudo.ws/sudo/commit/?id=12352244b)

2011-11-21 Todd C. Miller

* .hgignore:

  Add ignore file; from Mike Frysinger
  [[0cd56fa29]](https://git.sudo.ws/sudo/commit/?id=0cd56fa29)

* mkdep.pl:

  no longer save old Makefile.in to .old
  [[ec0c924e0]](https://git.sudo.ws/sudo/commit/?id=ec0c924e0)

* plugins/sudoers/Makefile.in, src/Makefile.in:

  regen
  [[55166914c]](https://git.sudo.ws/sudo/commit/?id=55166914c)

* config.guess, config.sub, configure, ltmain.sh, m4/libtool.m4,
  m4/ltoptions.m4, m4/ltversion.m4:

  Update to libtool 2.4.2
  [[b27eeb41b]](https://git.sudo.ws/sudo/commit/?id=b27eeb41b)

2011-11-18 Todd C. Miller

* plugins/sudoers/sudoers\_version.h:

  Bump grammar version for #include and #includedir relative path support.
  [[ea2a7b48b]](https://git.sudo.ws/sudo/commit/?id=ea2a7b48b)

2011-11-17 Todd C. Miller

* doc/sudoers.pod, plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Add support for relative paths in #include and #includedir
  [[481877e3b]](https://git.sudo.ws/sudo/commit/?id=481877e3b)

* plugins/sudoers/Makefile.in:

  Fix install-plugin when shared objects are unsupported or disabled.
  [[012440794]](https://git.sudo.ws/sudo/commit/?id=012440794)

* plugins/sudoers/goodpath.c:

  Don’t write to sbp if it is NULL
  [[c189fa5f5]](https://git.sudo.ws/sudo/commit/?id=c189fa5f5)

2011-11-16 Todd C. Miller

* Makefile.in:

  Remove all sudo/sudoers .mo files on uninstall If LINGUAS is set, only
  install matching .mo files
  [[eb687d2a4]](https://git.sudo.ws/sudo/commit/?id=eb687d2a4)

2011-11-13 Todd C. Miller

* plugins/sudoers/group\_plugin.c, plugins/sudoers/plugin\_error.c,
  plugins/sudoers/sudoers.c, src/conversation.c:

  Fix non-dynamic (no dlopen) sudo build.
  [[f689afb5e]](https://git.sudo.ws/sudo/commit/?id=f689afb5e)

* configure, configure.in:

  Don’t error out if the user specified –disable-shared
  [[19c98b62b]](https://git.sudo.ws/sudo/commit/?id=19c98b62b)

* common/sudo\_debug.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c,
  src/conversation.c:

  Use SUDO\_CONV\_DEBUG\_MSG in the plugin instead of writing directly to the
  debug file.
  [[65b781a2e]](https://git.sudo.ws/sudo/commit/?id=65b781a2e)

* plugins/sudoers/find\_path.c, plugins/sudoers/goodpath.c,
  plugins/sudoers/sudoers.h:

  Make sudo\_goodpath() return value bolean
  [[f3ae31185]](https://git.sudo.ws/sudo/commit/?id=f3ae31185)

* INSTALL, MANIFEST, configure, configure.in, mkdep.pl,
  plugins/sudoers/Makefile.in, plugins/sudoers/auth/securid.c:

  Remove obsolete securid auth method.
  [[5c29710f3]](https://git.sudo.ws/sudo/commit/?id=5c29710f3)

* plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h:

  Prefix authentication functions with a “sudo\_” prefix to avoid namespace
  problems.
  [[6fd3e0385]](https://git.sudo.ws/sudo/commit/?id=6fd3e0385)

* INSTALL, MANIFEST, config.h.in, configure, configure.in,
  doc/TROUBLESHOOTING, mkdep.pl, plugins/sudoers/Makefile.in,
  plugins/sudoers/auth/kerb4.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/env.c:

  Remove the old Kerberos IV support
  [[c86561e50]](https://git.sudo.ws/sudo/commit/?id=c86561e50)

2011-11-12 Todd C. Miller

* plugins/sudoers/check.c:

  Don’t print garbage at the end of the custom lecture.
  [[f190bcf94]](https://git.sudo.ws/sudo/commit/?id=f190bcf94)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Add lexer tracing as debug@parser
  [[ab437ae6c]](https://git.sudo.ws/sudo/commit/?id=ab437ae6c)

* plugins/sudoers/alias.c, plugins/sudoers/defaults.c,
  plugins/sudoers/defaults.h, plugins/sudoers/gram.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.c,
  plugins/sudoers/regress/parser/check\_fill.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/toke\_util.c,
  plugins/sudoers/visudo.c:

  Revert 003bdb078a15. We need to #include <gram.h> not “gram.h” and
  <def\_data.h> and not “def\_data.h” when generating the parser in a
  build dir.
  [[09beba825]](https://git.sudo.ws/sudo/commit/?id=09beba825)

2011-11-08 Todd C. Miller

* mkdep.pl, plugins/sudoers/Makefile.in:

  Better devdir support in mkdep.pl
  [[f375ee5f0]](https://git.sudo.ws/sudo/commit/?id=f375ee5f0)

* plugins/sudoers/Makefile.in:

  Add devdir before srcdir in include path and fix up dependecies
  accordingly.
  [[98790cd0c]](https://git.sudo.ws/sudo/commit/?id=98790cd0c)

* plugins/sudoers/alias.c, plugins/sudoers/defaults.c,
  plugins/sudoers/defaults.h, plugins/sudoers/match.c,
  plugins/sudoers/parse.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c:

  #include “gram.h” not <gram.h> and “def\_data.h” and not
  <def\_data.h>.
  [[0bf68d210]](https://git.sudo.ws/sudo/commit/?id=0bf68d210)

* sudo.pp:

  Mark libexec files as optional. If we build without shared object
  support, libexec is not used.
  [[1d7722a54]](https://git.sudo.ws/sudo/commit/?id=1d7722a54)

* src/load\_plugins.c:

  Change Debug sudo.conf setting to take a program name as the first
  argument. In the future, this will allow visudo and sudoreplay to use
  their own Debug entries.
  [[e58b23274]](https://git.sudo.ws/sudo/commit/?id=e58b23274)

* src/sudo.c:

  fix sudo\_debug\_printf priority
  [[5d2c01e3d]](https://git.sudo.ws/sudo/commit/?id=5d2c01e3d)

* plugins/sudoers/sudoers.c:

  add missing debug\_return\_int
  [[6fa91f569]](https://git.sudo.ws/sudo/commit/?id=6fa91f569)

2011-11-07 Todd C. Miller

* common/sudo\_debug.c, include/error.h, include/sudo\_debug.h,
  plugins/sudoers/logging.c, src/exec.c, src/exec\_pty.c:

  Fold SUDO\_DEBUG\_PROGERR and SUDO\_DEBUG\_SYSERR into SUDO\_DEBUG\_ERROR
  [[3ee9cef0d]](https://git.sudo.ws/sudo/commit/?id=3ee9cef0d)

* doc/UPGRADE:

  Add missing word in HOME security note.
  [[d0eb3ae6a]](https://git.sudo.ws/sudo/commit/?id=d0eb3ae6a)

* plugins/sudoers/testsudoers.c:

  Prevent “testsudoers -d username” from trying to malloc(0).
  [[cf7ad29f4]](https://git.sudo.ws/sudo/commit/?id=cf7ad29f4)

2011-11-06 Todd C. Miller

* plugins/sudoers/regress/sudoers/test10.in,
  plugins/sudoers/regress/sudoers/test10.out.ok,
  plugins/sudoers/regress/sudoers/test10.toke.ok,
  plugins/sudoers/regress/sudoers/test10.toke.out.ok,
  plugins/sudoers/regress/sudoers/test11.in,
  plugins/sudoers/regress/sudoers/test11.out.ok,
  plugins/sudoers/regress/sudoers/test11.toke.ok,
  plugins/sudoers/regress/sudoers/test11.toke.out.ok,
  plugins/sudoers/regress/sudoers/test12.in,
  plugins/sudoers/regress/sudoers/test12.out.ok,
  plugins/sudoers/regress/sudoers/test12.toke.ok,
  plugins/sudoers/regress/sudoers/test13.in,
  plugins/sudoers/regress/sudoers/test13.out.ok,
  plugins/sudoers/regress/sudoers/test13.toke.ok,
  plugins/sudoers/regress/sudoers/test9.in,
  plugins/sudoers/regress/sudoers/test9.out.ok,
  plugins/sudoers/regress/sudoers/test9.toke.ok,
  plugins/sudoers/regress/sudoers/test9.toke.out.ok:

  Tests for empty sudoers (should parse OK) and syntax errors within a
  line (should report correct line number) both with and without the
  trailing newline.
  [[a83507ccd]](https://git.sudo.ws/sudo/commit/?id=a83507ccd)

* plugins/sudoers/regress/sudoers/test4.out.ok,
  plugins/sudoers/regress/sudoers/test5.out.ok,
  plugins/sudoers/regress/sudoers/test7.out.ok,
  plugins/sudoers/regress/sudoers/test8.out.ok,
  plugins/sudoers/testsudoers.c:

  Print line number when there is a parser error.
  [[9fddb9eed]](https://git.sudo.ws/sudo/commit/?id=9fddb9eed)

2011-11-05 Todd C. Miller

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Keep track of the last token returned. On error, if the last token was
  COMMENT, decrement sudolineno since the error most likely occurred on
  the preceding line. Previously we always uses sudolineno-1 which will
  give the wrong line number for errors within a line.
  [[bd881c26e]](https://git.sudo.ws/sudo/commit/?id=bd881c26e)

2011-11-03 Todd C. Miller

* NEWS:

  update with sudo 1.8.3p1 info
  [[d2963dda7]](https://git.sudo.ws/sudo/commit/?id=d2963dda7)

* plugins/sudoers/sudoers.c:

  Fix crash when “sudo -g group -i” is run. Fixes bug 521
  [[ab803d88b]](https://git.sudo.ws/sudo/commit/?id=ab803d88b)

2011-10-26 Todd C. Miller

* plugins/sudoers/visudo.c:

  Make alias\_remove\_recursive() return TRUE/FALSE as its callers expect
  and remove two unused arguments. Fixes bug 519.
  [[922add780]](https://git.sudo.ws/sudo/commit/?id=922add780)

* plugins/sudoers/regress/visudo/test1.out.ok,
  plugins/sudoers/regress/visudo/test1.sh:

  Add regress test for bugzilla 519
  [[c55b5c9e1]](https://git.sudo.ws/sudo/commit/?id=c55b5c9e1)

* plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_fill.c:

  Disable warning/error wrapping in regress tests.
  [[300265019]](https://git.sudo.ws/sudo/commit/?id=300265019)

2011-10-25 Todd C. Miller

* Makefile.in:

  Do compile-po as part of sync-po so that the .mo files get rebuild
  automatically when we sync with translationproject.org
  [[4b3efd497]](https://git.sudo.ws/sudo/commit/?id=4b3efd497)

* plugins/sudoers/Makefile.in:

  check\_addr needs to link with the network libraries on Solaris
  [[85cd642d3]](https://git.sudo.ws/sudo/commit/?id=85cd642d3)

* plugins/sudoers/match.c:

  When matching a RunasAlias for a runas group, pass the alias in as the
  group\_list, not the user\_list. From Daniel Kopecek.
  [[6973ed5eb]](https://git.sudo.ws/sudo/commit/?id=6973ed5eb)

* plugins/sudoers/check.c, plugins/sudoers/sudoers.c:

  We need to init the auth system regardless of whether we need a password
  since we will be closing the PAM session in the monitor process. Fixes a
  crash in the monitor on Solaris; bugzilla #518
  [[9b2c88981]](https://git.sudo.ws/sudo/commit/?id=9b2c88981)

2011-10-24 Todd C. Miller

* src/exec.c:

  Get rid of done: label. If the child exits we still need to close the
  pty, update utmp and restore the SELinux tty context.
  [[ab75dd2e3]](https://git.sudo.ws/sudo/commit/?id=ab75dd2e3)

2011-10-22 Todd C. Miller

* common/Makefile.in, common/atobool.c, common/fileops.c,
  common/fmt\_string.c, common/lbuf.c, common/list.c, common/setgroups.c,
  common/term.c, plugins/sudoers/Makefile.in, plugins/sudoers/alias.c,
  plugins/sudoers/audit.c, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb4.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/boottime.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/check.c, plugins/sudoers/defaults.c,
  plugins/sudoers/env.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/getspwuid.c, plugins/sudoers/goodpath.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/interfaces.c,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/ldap.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/logging.c, plugins/sudoers/logwrap.c,
  plugins/sudoers/match.c, plugins/sudoers/match\_addr.c,
  plugins/sudoers/parse.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/redblack.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, src/Makefile.in, src/conversation.c,
  src/exec.c, src/exec\_pty.c, src/get\_pty.c, src/load\_plugins.c,
  src/net\_ifs.c, src/parse\_args.c, src/selinux.c, src/sudo.c, src/sudo.h,
  src/sudo\_edit.c, src/tgetpass.c, src/ttysize.c, src/utmp.c:

  Add debug\_decl/debug\_return (almost) everywhere. Remove old sudo\_debug()
  and convert users to sudo\_debug\_printf().
  [[839919566]](https://git.sudo.ws/sudo/commit/?id=839919566)

* common/alloc.c, include/error.h, plugins/sudoers/plugin\_error.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c, src/error.c:

  Wrap error/errorx and warning/warningx functions with debug statements.
  Disable wrapping for standalone sudoers programs as well as memory
  allocation functions (to avoid infinite recursion).
  [[9923464d9]](https://git.sudo.ws/sudo/commit/?id=9923464d9)

* README, config.h.in, configure, configure.in:

  Add checks for **func** and **FUNCTION** and mention that we now require
  a cpp that supports variadic macros.
  [[749a7695d]](https://git.sudo.ws/sudo/commit/?id=749a7695d)

* MANIFEST, common/Makefile.in, common/sudo\_debug.c, include/sudo\_debug.h,
  include/sudo\_plugin.h, src/conversation.c, src/load\_plugins.c,
  src/parse\_args.c, src/sudo.c, src/sudo\_plugin\_int.h:

  New debug framework for sudo and plugins using /etc/sudo.conf that also
  supports function call tracing.
  [[53e3ad11b]](https://git.sudo.ws/sudo/commit/?id=53e3ad11b)

2011-10-21 Todd C. Miller

* plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po:

  Update Japanese sudoers translation from translationproject.org
  [[697caf8df]](https://git.sudo.ws/sudo/commit/?id=697caf8df)

2011-10-12 Todd C. Miller

* configure, configure.in:

  Override and ignore the –disable-static option. Sudo already runs
  libtool with -tag=disable-static where applicable and we need non-PIC
  objects to build the executables.
  [[8ef560b85]](https://git.sudo.ws/sudo/commit/?id=8ef560b85)

2011-10-10 Todd C. Miller

* NEWS:

  Add sudoedit fix
  [[ce8b4e53a]](https://git.sudo.ws/sudo/commit/?id=ce8b4e53a)

* plugins/sudoers/po/sudoers.pot:

  regen pot files
  [[3f526029a]](https://git.sudo.ws/sudo/commit/?id=3f526029a)

* plugins/sudoers/env.c:

  Ignore set\_logname (which is now the default) for sudoedit since we want
  the LOGNAME, USER and USERNAME environment variables to refer to the
  calling user since that is who the editor runs as. This allows the
  editor to find the user’s startup files. Fixes bugzilla #515
  [[b7a610770]](https://git.sudo.ws/sudo/commit/?id=b7a610770)

* plugins/sudoers/pwutil.c:

  Instead of trying to grow the buffer in make\_grlist\_item(), simply
  increase the total length, free the old buffer and allocate a new one.
  This is less error prone and saves us from having to adjust all the
  pointers in the buffer. This code path is only taken when there are
  groups longer than the length of the user field in struct utmp or utmpx,
  which should be quite rare.
  [[a6602fa0e]](https://git.sudo.ws/sudo/commit/?id=a6602fa0e)

* src/po/it.mo:

  Add Italian translation for sudo from translationproject.org
  [[dd3902e11]](https://git.sudo.ws/sudo/commit/?id=dd3902e11)

* MANIFEST, NEWS, plugins/sudoers/po/ja.mo, plugins/sudoers/po/ja.po,
  src/po/ja.mo, src/po/ja.po:

  Japanese translation for sudo and sudoers from translationproject.org
  [[82dd8f65f]](https://git.sudo.ws/sudo/commit/?id=82dd8f65f)

2011-10-07 Todd C. Miller

* plugins/sudoers/Makefile.in:

  sudoreplay depends on timestr.lo too; from Mike Frysinger
  [[fb49b16e4]](https://git.sudo.ws/sudo/commit/?id=fb49b16e4)

2011-10-04 Todd C. Miller

* plugins/sudoers/po/sudoers.pot:

  Regen sudoers pot file.
  [[063c6ee60]](https://git.sudo.ws/sudo/commit/?id=063c6ee60)

* NEWS:

  Update with latest sudo 1.8.3 news
  [[a4378bd94]](https://git.sudo.ws/sudo/commit/?id=a4378bd94)

* plugins/sudoers/sudoers.c:

  It appears that LDAP or NSS may modify the euid so we need to be root
  for the open(). We restore the old perms at the end of
  sudoers\_policy\_open().
  [[930122d34]](https://git.sudo.ws/sudo/commit/?id=930122d34)

* plugins/sudoers/set\_perms.c:

  Better warning message on setuid() failure for the setreuid() version of
  set\_perms().
  [[b743b77a0]](https://git.sudo.ws/sudo/commit/?id=b743b77a0)

2011-09-27 Todd C. Miller

* plugins/sudoers/check.c:

  Delref auth\_pw at the end of check\_user() instead of getting a ref
  twice.
  [[45ad681cd]](https://git.sudo.ws/sudo/commit/?id=45ad681cd)

* plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/check.c:

  Make sudo\_auth\_{init,cleanup} return TRUE on success and check for
  sudo\_auth\_init() return value in check\_user().
  [[1e93d1fbb]](https://git.sudo.ws/sudo/commit/?id=1e93d1fbb)

* plugins/sudoers/auth/sudo\_auth.c:

  Do not return without restoring permissions.
  [[4540a7525]](https://git.sudo.ws/sudo/commit/?id=4540a7525)

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  regen pot files
  [[de684e5d2]](https://git.sudo.ws/sudo/commit/?id=de684e5d2)

* plugins/sudoers/auth/API, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb4.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/auth/sudo\_auth.h,
  plugins/sudoers/check.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Modify the authentication API such that the init and cleanup functions
  are always called, regardless of whether or not we are going to verify a
  password. This is needed for proper PAM session support.
  [[bceb5df15]](https://git.sudo.ws/sudo/commit/?id=bceb5df15)

* compat/Makefile.in, mkdep.pl, plugins/sudoers/Makefile.in:

  Add missing dependency for getspwuid.lo and regen other depends.
  [[c21595044]](https://git.sudo.ws/sudo/commit/?id=c21595044)

* plugins/sudoers/auth/pam.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/sudoers.c:

  Fix a PAM\_USER mismatch in session open/close. We update PAM\_USER to the
  target user immediately before setting resource limits, which is after
  the monitor process has forked (so it has the old value). Also, if the
  user did not authenticate, there is no pamh in the monitor so we need to
  init pam here too. This means we end up calling pam\_start() twice, which
  should be fixed, but at least the session is always properly closed now.
  [[c5f8dc95c]](https://git.sudo.ws/sudo/commit/?id=c5f8dc95c)

* src/utmp.c:

  Add check for old being NULL in utmp\_setid(); from Steven McDonald
  [[7304bc744]](https://git.sudo.ws/sudo/commit/?id=7304bc744)

2011-09-25 Todd C. Miller

* plugins/sudoers/pwutil.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  If the invoking user cannot be resolved by uid fake the struct passwd
  and store it in the cache so we can delref it on exit.
  [[05bfd6669]](https://git.sudo.ws/sudo/commit/?id=05bfd6669)

2011-09-24 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Don’t error out if the group plugin cannot be loaded, just warn.
  [[842526d71]](https://git.sudo.ws/sudo/commit/?id=842526d71)

2011-09-23 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Quiet a false positive found by several static analysis tools. These
  tools don’t know that log\_error() does not return (it longjmps to
  error\_jmp which returns to the sudo front-end).
  [[077514789]](https://git.sudo.ws/sudo/commit/?id=077514789)

2011-09-22 Todd C. Miller

* MANIFEST, plugins/sudoers/po/da.mo, plugins/sudoers/po/eo.mo,
  plugins/sudoers/po/fi.mo, plugins/sudoers/po/pl.mo,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/zh\_CN.mo, src/po/it.po:

  Add Italian translation for sudo from translationproject.org Regen .mo
  files
  [[6028afae8]](https://git.sudo.ws/sudo/commit/?id=6028afae8)

2011-09-21 Todd C. Miller

* doc/TROUBLESHOOTING:

  Update to current reality and add bit about ssh auth
  [[a898356b1]](https://git.sudo.ws/sudo/commit/?id=a898356b1)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Make “verbose” static; fixes a namespace clash with pam\_ssh\_agent\_auth
  (and it doesn’t need to be extern these days).
  [[de33689ae]](https://git.sudo.ws/sudo/commit/?id=de33689ae)

* config.h.in, configure, configure.in, src/get\_pty.c:

  FreeBSD has libutil.h not util.h
  [[4724e313e]](https://git.sudo.ws/sudo/commit/?id=4724e313e)

* configure, configure.in:

  Define \_BSD\_SOURCE on FreeBSD, OpenBSD and DragonflyBSD
  [[441abee4e]](https://git.sudo.ws/sudo/commit/?id=441abee4e)

2011-09-20 Todd C. Miller

* plugins/sudoers/po/da.po, plugins/sudoers/po/eo.po,
  plugins/sudoers/po/fi.po, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/uk.po, plugins/sudoers/po/zh\_CN.po:

  Update po files from translationproject.org
  [[32c1ae8f7]](https://git.sudo.ws/sudo/commit/?id=32c1ae8f7)

2011-09-16 Todd C. Miller

* doc/sudoers.ldap.pod, plugins/sudoers/ldap.c:

  Add support for DEREF in ldap.conf.
  [[3bcc9048c]](https://git.sudo.ws/sudo/commit/?id=3bcc9048c)

* Makefile.in:

  install target should depend on ChangeLog too, not just install-doc
  [[0f95023e9]](https://git.sudo.ws/sudo/commit/?id=0f95023e9)

* doc/sudoers.pod:

  Only iolog\_file (not iolog\_dir) supports mktemp-style suffixes.
  [[e5e1bb24f]](https://git.sudo.ws/sudo/commit/?id=e5e1bb24f)

* NEWS:

  Sync with 1.8 branch for sudo 1.8.2 and 1.8.3 changes.
  [[62991b0cf]](https://git.sudo.ws/sudo/commit/?id=62991b0cf)

* doc/UPGRADE:

  Document group lookup change and possible side effects.
  [[ed26d7a59]](https://git.sudo.ws/sudo/commit/?id=ed26d7a59)

* configure, configure.in:

  Fix some square brackets in case statements that needed to be doubled
  up. While here, use $OSMAJOR when it makes sense.
  [[647e087cd]](https://git.sudo.ws/sudo/commit/?id=647e087cd)

* plugins/sudoers/pwutil.c:

  Fix a crash in make\_grlist\_item() on 64-bit machines with strict
  alignment.
  [[fd2d709bd]](https://git.sudo.ws/sudo/commit/?id=fd2d709bd)

* plugins/sudoers/defaults.c, plugins/sudoers/defaults.h:

  Remove list\_options() function that is no longer used now that “sudo -L”
  is gone.
  [[cab1968da]](https://git.sudo.ws/sudo/commit/?id=cab1968da)

* configure, configure.in:

  Error message if user tries –with-CC
  [[523492af5]](https://git.sudo.ws/sudo/commit/?id=523492af5)

* configure, configure.in:

  Check for -libmldap too when looking for ldap libs, which is the Tivoli
  Directory Server client library.
  [[ba331ebfb]](https://git.sudo.ws/sudo/commit/?id=ba331ebfb)

2011-09-09 Todd C. Miller

* plugins/sudoers/parse.c:

  Honor NOPASSWD tag for denied commands too.
  [[dacb1e47f]](https://git.sudo.ws/sudo/commit/?id=dacb1e47f)

2011-09-08 Todd C. Miller

* INSTALL, configure, configure.in:

  Remove –with-CC option; it doesn’t work correctly now that we use
  libtool. Users can get the same effect by setting the CC environment
  variable when running configure.
  [[b3b268c3a]](https://git.sudo.ws/sudo/commit/?id=b3b268c3a)

2011-08-31 Todd C. Miller

* config.h.in, configure, configure.in, plugins/sudoers/visudo.c,
  src/sudo\_edit.c:

  Assume all modern systems support fstat(2).
  [[f730cb787]](https://git.sudo.ws/sudo/commit/?id=f730cb787)

2011-08-30 Todd C. Miller

* compat/regress/glob/globtest.c, config.h.in, configure, configure.in,
  include/missing.h, plugins/sudoers/sudoers.h, src/sudo.h,
  src/sudo\_noexec.c:

  Add configure test for missing errno declaration and only declare it
  ourselves if it is missing.
  [[47af0fc2b]](https://git.sudo.ws/sudo/commit/?id=47af0fc2b)

* plugins/sudoers/alias.c:

  Include errno.h before sudo.h to avoid conflicting with the system
  definition of errno.
  [[55896f636]](https://git.sudo.ws/sudo/commit/?id=55896f636)

2011-08-29 Todd C. Miller

* plugins/sudoers/regress/parser/check\_addr.c:

  Only print individual check status when there is a failure.
  [[0cd464809]](https://git.sudo.ws/sudo/commit/?id=0cd464809)

* plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/parser/check\_addr.c:

  Add calls to setprogname() for test programs.
  [[f478f8406]](https://git.sudo.ws/sudo/commit/?id=f478f8406)

* configure, configure.in:

  Add -Wall and -Werror after all tests so they don’t cause failures.
  [[3e0e0fc38]](https://git.sudo.ws/sudo/commit/?id=3e0e0fc38)

* plugins/sudoers/Makefile.in:

  Actually run check\_addr in the check target
  [[7945166bb]](https://git.sudo.ws/sudo/commit/?id=7945166bb)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/match.c,
  plugins/sudoers/match\_addr.c,
  plugins/sudoers/regress/parser/check\_addr.c,
  plugins/sudoers/regress/parser/check\_addr.in:

  Split out address matching into its own file and add regression tests
  for it.
  [[1a259de17]](https://git.sudo.ws/sudo/commit/?id=1a259de17)

2011-08-27 Todd C. Miller

* plugins/sudoers/match.c:

  When matching an address with a netmask in sudoers, AND the mask and
  addr before checking against the local addresses.
  [[a47f00543]](https://git.sudo.ws/sudo/commit/?id=a47f00543)

2011-08-26 Todd C. Miller

* plugins/sudoers/match.c:

  Fix netmask matching.
  [[526a61004]](https://git.sudo.ws/sudo/commit/?id=526a61004)

* plugins/sudoers/visudo.c:

  Don’t assume all editors support the +linenumber command line argument,
  use a whitelist of known good editors.
  [[e3cda8020]](https://git.sudo.ws/sudo/commit/?id=e3cda8020)

2011-08-23 Todd C. Miller

* plugins/sudoers/set\_perms.c, plugins/sudoers/visudo.c, src/exec.c,
  src/exec\_pty.c, src/sudo.c:

  Silence compiler warnings on Solaris with gcc 3.4.3
  [[d81c14005]](https://git.sudo.ws/sudo/commit/?id=d81c14005)

* mkpkg:

  Fix building on RHEL 3
  [[335901388]](https://git.sudo.ws/sudo/commit/?id=335901388)

* INSTALL, configure, configure.in:

  Add –enable-werror configure option.
  [[e4956d22e]](https://git.sudo.ws/sudo/commit/?id=e4956d22e)

* common/setgroups.c:

  setgroups() proto lives in grp.h on RHEL4, perhaps others.
  [[da95b0ea5]](https://git.sudo.ws/sudo/commit/?id=da95b0ea5)

* configure, configure.in:

  Use PAM by default on AIX 6 and higher.
  [[64a57a2ee]](https://git.sudo.ws/sudo/commit/?id=64a57a2ee)

2011-08-22 Todd C. Miller

* MANIFEST, plugins/sudoers/po/eo.mo, plugins/sudoers/po/eo.po,
  src/po/eo.mo, src/po/eo.po:

  Add new Esperanto translation from translationproject.org
  [[8fb53f5e4]](https://git.sudo.ws/sudo/commit/?id=8fb53f5e4)

2011-08-19 Todd C. Miller

* plugins/sudoers/iolog\_path.c:

  Quiet an innocuous valgrind warning.
  [[5a13dd2b7]](https://git.sudo.ws/sudo/commit/?id=5a13dd2b7)

2011-08-18 Todd C. Miller

* plugins/sudoers/iolog\_path.c, plugins/sudoers/regress/iolog\_path/data:

  Fix expansion of strftime() escapes in log\_dir and add a regress test
  that exhibited the problem.
  [[bfc84b01f]](https://git.sudo.ws/sudo/commit/?id=bfc84b01f)

* plugins/sudoers/Makefile.in:

  Fix “make check” return value.
  [[367b65900]](https://git.sudo.ws/sudo/commit/?id=367b65900)

2011-08-17 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  Regen pot files
  [[a6224a734]](https://git.sudo.ws/sudo/commit/?id=a6224a734)

* Makefile.in:

  Fix logic inversion in pot file up to date check.
  [[27257d9cf]](https://git.sudo.ws/sudo/commit/?id=27257d9cf)

2011-08-15 Todd C. Miller

* configure, configure.in:

  Add caching for gettext() checks.
  [[366cb1927]](https://git.sudo.ws/sudo/commit/?id=366cb1927)

* configure, configure.in:

  Better handling of libintl header and library mismatch.
  [[8f8738ff3]](https://git.sudo.ws/sudo/commit/?id=8f8738ff3)

2011-08-13 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Also check sudoers gid if sudoers is group writable.
  [[d56a17165]](https://git.sudo.ws/sudo/commit/?id=d56a17165)

2011-08-12 Todd C. Miller

* configure, configure.in:

  If dlopen is present but libtool doesn’t find it, error out since it
  probably means that libtool doesn’t support the system.
  [[6b9d80b10]](https://git.sudo.ws/sudo/commit/?id=6b9d80b10)

* mkpkg:

  configure args on the command line should override builtin defaults.
  Disable NLS for non-Linux/Solaris unless explicitly enabled.
  [[13591340b]](https://git.sudo.ws/sudo/commit/?id=13591340b)

* plugins/sudoers/auth/aix\_auth.c:

  Fix loop that calls authenticate(). If there was an error message from
  authenticate(), display it.
  [[7f4a0d095]](https://git.sudo.ws/sudo/commit/?id=7f4a0d095)

2011-08-11 Todd C. Miller

* m4/libtool.m4, m4/ltversion.m4:

  Update to autoconf 2.68 and libtool 2.4
  [[027cd522c]](https://git.sudo.ws/sudo/commit/?id=027cd522c)

* config.guess, config.sub, configure, configure.in, ltmain.sh:

  Update to autoconf 2.68 and libtool 2.4
  [[c8fb44084]](https://git.sudo.ws/sudo/commit/?id=c8fb44084)

* doc/sudoers.pod:

  Fix typo; OPT should be OTP
  [[6b1e75252]](https://git.sudo.ws/sudo/commit/?id=6b1e75252)

* plugins/sudoers/Makefile.in:

  Rename libsudoers convenience library to libparsesudoers to avoid
  libtool confusion.
  [[179b34d9e]](https://git.sudo.ws/sudo/commit/?id=179b34d9e)

2011-08-10 Todd C. Miller

* MANIFEST, plugins/sudoers/po/da.mo, plugins/sudoers/po/da.po:

  Add Danish sudoers translation from translationproject.org
  [[1adef5ec3]](https://git.sudo.ws/sudo/commit/?id=1adef5ec3)

* plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c:

  Add dedicated callback function for runas\_default sudoers setting that
  only sets runas\_pw if no runas user or group was specified by the user.
  [[6099e1bc4]](https://git.sudo.ws/sudo/commit/?id=6099e1bc4)

2011-08-09 Todd C. Miller

* plugins/sudoers/po/fi.mo, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po,
  plugins/sudoers/po/uk.mo, plugins/sudoers/po/uk.po, src/po/ru.mo,
  src/po/ru.po:

  Update Finish, Polish, Russian and Ukrainian translations from
  translationproject.org.
  [[aaaa5d05d]](https://git.sudo.ws/sudo/commit/?id=aaaa5d05d)

* plugins/sudoers/defaults.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c:

  Go back to using a callback for runas\_default to keep runas\_pw in sync.
  This is needed to make per-entry runas\_default settings work with
  LDAP-based sudoers. Instead of declaring it a callback in def\_data.in,
  sudo and testsudoers poke sudo\_defs\_table[] which is a bit naughty, but
  avoids requiring stub functions in visudo and the tests.
  [[01ae3d477]](https://git.sudo.ws/sudo/commit/?id=01ae3d477)

2011-08-05 Todd C. Miller

* Makefile.in:

  Add check for out of date message catalogs when doing “make dist”.
  [[53656020f]](https://git.sudo.ws/sudo/commit/?id=53656020f)

2011-08-02 Todd C. Miller

* configure:

  regen
  [[f92267836]](https://git.sudo.ws/sudo/commit/?id=f92267836)

* configure.in:

  Make sure compiler supports static-libgcc before using it.
  [[00b846cd1]](https://git.sudo.ws/sudo/commit/?id=00b846cd1)

2011-08-01 Todd C. Miller

* src/Makefile.in:

  Link libsudo\_noexec.la with LDLDFLAGS for -static-libgcc
  [[fecb39734]](https://git.sudo.ws/sudo/commit/?id=fecb39734)

2011-07-30 Todd C. Miller

* MANIFEST, plugins/sudoers/po/fi.mo, plugins/sudoers/po/pl.mo,
  plugins/sudoers/po/pl.po, plugins/sudoers/po/uk.mo,
  plugins/sudoers/po/zh\_CN.mo, src/po/ru.mo, src/po/ru.po,
  src/po/zh\_CN.mo:

  Add new Russian sudo translation from translationproject.org and rebuild
  the other translation files.
  [[eb09c303a]](https://git.sudo.ws/sudo/commit/?id=eb09c303a)

2011-07-29 Todd C. Miller

* plugins/sudoers/po/fi.po, plugins/sudoers/po/pl.po:

  Update Finish and Polish translations from translationproject.org
  [[4f726ddcd]](https://git.sudo.ws/sudo/commit/?id=4f726ddcd)

* plugins/sudoers/sudoers.c, src/parse\_args.c, src/sudo.c:

  Go back to escaping the command args for “sudo -i” and “sudo -s” before
  calling the plugin. Otherwise, spaces in the command args are not
  treated properly. The sudoers plugin will unescape non-spaces to make
  matching easier.
  [[8255ed69b]](https://git.sudo.ws/sudo/commit/?id=8255ed69b)

2011-07-28 Todd C. Miller

* plugins/sudoers/check.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/ldap.c, plugins/sudoers/parse.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Fix some potential problems found by the clang static analyzer, none
  serious.
  [[4f9a93f65]](https://git.sudo.ws/sudo/commit/?id=4f9a93f65)

* plugins/sudoers/po/uk.po, plugins/sudoers/po/zh\_CN.po, src/po/zh\_CN.po:

  Updated Ukranian and Chinese (simplified) po files from
  translationproject.org
  [[6365c779c]](https://git.sudo.ws/sudo/commit/?id=6365c779c)

2011-07-27 Todd C. Miller

* plugins/sudoers/po/pl.po:

  Updated Polish translation from translationproject.org
  [[bd6ce7ee3]](https://git.sudo.ws/sudo/commit/?id=bd6ce7ee3)

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  Rebuild pot files
  [[3606fc441]](https://git.sudo.ws/sudo/commit/?id=3606fc441)

* plugins/sudoers/audit.c, plugins/sudoers/sudoers.c:

  Don’t try to audit failure if the runas user does not exist. We don’t
  have the user’s command at this point so there is nothing to audit. Add
  a NULL check in audit\_success() and audit\_failure() just to be on the
  safe side.
  [[35d26ae34]](https://git.sudo.ws/sudo/commit/?id=35d26ae34)

* mkpkg:

  Add -g to CFLAG for PIE builds.
  [[8ebf7a95c]](https://git.sudo.ws/sudo/commit/?id=8ebf7a95c)

2011-07-25 Todd C. Miller

* plugins/sudoers/pwutil.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, src/sudo.c:

  Remove fallback to per-group lookup when matching groups in sudoers. The
  sudo front-end will now use getgrouplist() to get the user’s list of
  groups if getgroups() fails or returns zero groups so we always have a
  list of the user’s groups. For systems with mbr\_check\_membership() which
  support more that NGROUPS\_MAX groups (Mac OS X), skip the call to
  getgroups() and use getgrouplist() so we get all the groups.
  [[80138c88b]](https://git.sudo.ws/sudo/commit/?id=80138c88b)

2011-07-22 Todd C. Miller

* common/setgroups.c:

  Fix setgroups() fallback code on EINVAL.
  [[cb63967bf]](https://git.sudo.ws/sudo/commit/?id=cb63967bf)

* plugins/sudoers/set\_perms.c:

  Fix two PERM\_INITIAL cases that were still using user\_gids.
  [[1f9fb7609]](https://git.sudo.ws/sudo/commit/?id=1f9fb7609)

* MANIFEST:

  Add Polish sudo message catalog
  [[043b976c6]](https://git.sudo.ws/sudo/commit/?id=043b976c6)

* plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  user\_group is no longer used, remove it
  [[3dde167cf]](https://git.sudo.ws/sudo/commit/?id=3dde167cf)

2011-07-20 Todd C. Miller

* MANIFEST, plugins/sudoers/po/pl.mo, plugins/sudoers/po/pl.po:

  Add Polish translation from translationproject.org
  [[0b9107395]](https://git.sudo.ws/sudo/commit/?id=0b9107395)

* MANIFEST, common/Makefile.in, common/setgroups.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.h, src/sudo.c,
  src/sudo.h, src/sudo\_edit.c:

  Add a wrapper for setgroups() that trims off extra groups and retries if
  setgroups() fails. Also add some missing addrefs for PERM\_USER and
  PERM\_FULL\_USER.
  [[022591f4b]](https://git.sudo.ws/sudo/commit/?id=022591f4b)

* MANIFEST, compat/Makefile.in, compat/getgrouplist.c, config.h.in,
  configure, configure.in, include/missing.h, mkdep.pl,
  plugins/sudoers/ldap.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h, src/sudo.c:

  Instead of keeping separate groups and gids arrays, create struct
  group\_info and use it to store both, along with a count for each. Cache
  group info on a per-user basis using getgrouplist() to get the groups.
  We no longer need special to special case the user or list user for
  user\_in\_group() and thus no longer need to reset the groups list when
  listing another user.
  [[b124635b0]](https://git.sudo.ws/sudo/commit/?id=b124635b0)

* src/preload.c:

  Don’t rely on NULL since we don’t include a header for it.
  [[906cede7a]](https://git.sudo.ws/sudo/commit/?id=906cede7a)

2011-07-19 Todd C. Miller

* doc/sudoers.pod:

  Fix typo
  [[9e7c364ed]](https://git.sudo.ws/sudo/commit/?id=9e7c364ed)

2011-07-18 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Do not shadow global sudo\_mode with a local variable in set\_cmnd()
  [[6d8788a6c]](https://git.sudo.ws/sudo/commit/?id=6d8788a6c)

2011-07-17 Todd C. Miller

* plugins/sudoers/sudoers.c:

  bash 2.x doesd not support the -l flag and exits with an error if it is
  specified so use –login instead. This causes an error with bash 1.x
  (which uses -login instead) but this version is hopefully less used than
  2.x.
  [[54bf162e6]](https://git.sudo.ws/sudo/commit/?id=54bf162e6)

* src/po/pl.mo, src/po/pl.po:

  Add Polish translation from translationproject.org
  [[27316e6c5]](https://git.sudo.ws/sudo/commit/?id=27316e6c5)

2011-07-13 Todd C. Miller

* plugins/sudoers/set\_perms.c:

  Make error strings translatable.
  [[37873051a]](https://git.sudo.ws/sudo/commit/?id=37873051a)

* mkpkg:

  Only run configure with –with-pam-login for RHEL 5 and above.
  [[94f7c4a29]](https://git.sudo.ws/sudo/commit/?id=94f7c4a29)

* sudo.pp:

  Fix typo in summary
  [[d090d6786]](https://git.sudo.ws/sudo/commit/?id=d090d6786)

2011-07-11 Todd C. Miller

* plugins/sudoers/logwrap.c:

  Add missing logwrap.c
  [[d7c079886]](https://git.sudo.ws/sudo/commit/?id=d7c079886)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/regress/logging/check\_wrap.c,
  plugins/sudoers/regress/logging/check\_wrap.in,
  plugins/sudoers/regress/logging/check\_wrap.out.ok:

  Split out log file word wrap code into its own file and add unit tests.
  Fixes an off-by one in the word wrap when the log line length matches
  loglinelen.
  [[f90731596]](https://git.sudo.ws/sudo/commit/?id=f90731596)

2011-07-05 Todd C. Miller

* mkpkg:

  For SuSE, only use /usr/lib64 as libexec if generating 64-bit binaries.
  [[ee1b41f84]](https://git.sudo.ws/sudo/commit/?id=ee1b41f84)

* src/load\_plugins.c, src/sudo.c:

  Fix build error when –without-noexec configure option is used.
  [[76f427e8d]](https://git.sudo.ws/sudo/commit/?id=76f427e8d)

* configure, configure.in:

  Disable noexec for AIX < 5. LDR\_PRELOAD is only available in AIX 5.3
  and above.
  [[ae3405254]](https://git.sudo.ws/sudo/commit/?id=ae3405254)

2011-07-01 Todd C. Miller

* plugins/sudoers/ldap.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Resolve the list of gids passed in from the sudo frontend (the result of
  getgroups()) to names and store both the group names and ids in the
  sudo\_user struct. When matching groups in the sudoers file, match based
  on the names in the groups list first and only do a gid-based match when
  we absolutely have to. By matching on the group name (as it is listed in
  sudoers) instead of id (which we would have to resolve) we save a lot of
  group lookups for sudoers files with a lot of groups in them.
  [[56321ec77]](https://git.sudo.ws/sudo/commit/?id=56321ec77)

2011-06-26 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Workaround for “sudo -i command” and newer versions of bash which don’t
  go into login mode when -c is specified unless -l is too.
  [[20972da41]](https://git.sudo.ws/sudo/commit/?id=20972da41)

2011-06-23 Todd C. Miller

* plugins/sudoers/logging.c:

  Rewrite logfile word wrapping code to be more straight-forward and
  actually wrap at the correct place.
  [[9ba98ef7b]](https://git.sudo.ws/sudo/commit/?id=9ba98ef7b)

2011-06-22 Todd C. Miller

* doc/CONTRIBUTORS, doc/contributors.pod, plugins/sudoers/sudoers.c:

  Set use\_pty=true in command details when use\_pty is set in sudoers. From
  Ludwig Nussel
  [[39be82e32]](https://git.sudo.ws/sudo/commit/?id=39be82e32)

2011-06-20 Todd C. Miller

* plugins/sudoers/po/zh\_CN.mo, plugins/sudoers/po/zh\_CN.po,
  src/po/zh\_CN.mo, src/po/zh\_CN.po:

  Sync Chinese (simplified) PO files from translationproject.org
  [[2bd874feb]](https://git.sudo.ws/sudo/commit/?id=2bd874feb)

2011-06-18 Todd C. Miller

* MANIFEST, plugins/sudoers/po/eu.mo, plugins/sudoers/po/fi.mo,
  plugins/sudoers/po/uk.mo, src/po/da.mo, src/po/da.po, src/po/eu.mo:

  Add Danish translation from translationproject.org and add missing
  Basque mo files.
  [[26ec20f8b]](https://git.sudo.ws/sudo/commit/?id=26ec20f8b)

* Makefile.in, configure, configure.in:

  No longer need to specify LINGUAS in configure, “make install-nls” now
  just installs all the .mo files it finds.
  [[210e091d8]](https://git.sudo.ws/sudo/commit/?id=210e091d8)

2011-06-17 Todd C. Miller

* MANIFEST, doc/CONTRIBUTORS, doc/Makefile.in, doc/contributors.pod:

  Build CONTRIBUTORS from newly-added contributors.pod
  [[de6df7cc8]](https://git.sudo.ws/sudo/commit/?id=de6df7cc8)

* doc/CONTRIBUTORS:

  Rework the wording in the leading paragraph
  [[aeac9c738]](https://git.sudo.ws/sudo/commit/?id=aeac9c738)

2011-06-14 Todd C. Miller

* MANIFEST, doc/CONTRIBUTORS:

  Add a CONTRIBUTORS file with the names of folks who have contributed
  code or patches to sudo since I started maintaining it (plus the
  original authors).
  [[7de94d3a2]](https://git.sudo.ws/sudo/commit/?id=7de94d3a2)

2011-06-13 Todd C. Miller

* plugins/sudoers/env.c:

  Preserve SHELL variable for “sudo -s”. Otherwise we can end up with a
  situation where the SHELL variable and the actual shell being run do not
  match.
  [[7a06f32cb]](https://git.sudo.ws/sudo/commit/?id=7a06f32cb)

2011-06-10 Todd C. Miller

* configure, configure.in:

  Only enable Solaris project support when setproject() is present in
  libproject.
  [[b4a48510c]](https://git.sudo.ws/sudo/commit/?id=b4a48510c)

* sudo.pp:

  Explicitly set mode and owner of /etc/sudoers instead of relying on “cp
  -p” to work in the postinstall script. On AIX 6.1 at least the
  postinstall script runs before the final file permissions are set.
  [[f0e941a39]](https://git.sudo.ws/sudo/commit/?id=f0e941a39)

2011-06-09 Todd C. Miller

* doc/sudo.pod, doc/sudoers.pod:

  Refer the user to the “Command Environment” section in description of
  sudo’s -i option.
  [[0c292a56b]](https://git.sudo.ws/sudo/commit/?id=0c292a56b)

* doc/sudo.pod:

  Fix typo
  [[47d908aba]](https://git.sudo.ws/sudo/commit/?id=47d908aba)

2011-06-08 Todd C. Miller

* mkdep.pl:

  If there is no old dependency for an object file, use the MANIFEST to
  find its source.
  [[9fd93f433]](https://git.sudo.ws/sudo/commit/?id=9fd93f433)

* compat/Makefile.in:

  Remove dependency for getgrouplist.lo as we don’t ship that source file.
  [[44ab717ac]](https://git.sudo.ws/sudo/commit/?id=44ab717ac)

2011-06-07 Todd C. Miller

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y:

  Do not declare yyparse() static as the actual function generated by yacc
  is extern.
  [[2c4a5e905]](https://git.sudo.ws/sudo/commit/?id=2c4a5e905)

2011-06-06 Todd C. Miller

* Makefile.in:

  Remove locale files in “make uninstall”
  [[900de1bde]](https://git.sudo.ws/sudo/commit/?id=900de1bde)

* configure.in, plugins/sudoers/po/eu.po, plugins/sudoers/po/fi.po,
  plugins/sudoers/po/uk.po, src/po/eu.po:

  Add Basque translation and sync Finish and Ukranian translations.
  [[e95c7130d]](https://git.sudo.ws/sudo/commit/?id=e95c7130d)

* configure, configure.in:

  FreeBSD no longer needs the main sudo binary to link with -lpam now that
  plug-ins are loaded with RTLD\_GLOBAL.
  [[0562e492a]](https://git.sudo.ws/sudo/commit/?id=0562e492a)

* plugins/sudoers/group\_plugin.c, src/load\_plugins.c:

  Load plugins with RTLD\_GLOBAL instead of RTLD\_LOCAL. This fixes problems
  with pam modules not having access to symbols provided by libpam on some
  platforms. Affects FreeBSD and SLES 10 at least.
  [[4f22a3980]](https://git.sudo.ws/sudo/commit/?id=4f22a3980)

* Makefile.in:

  Move xgettext invocation out of update-po target into update-pot
  [[878c77000]](https://git.sudo.ws/sudo/commit/?id=878c77000)

2011-06-04 Todd C. Miller

* plugins/sudoers/po/sudoers.pot, src/po/sudo.pot:

  Regenerate .pot files for 1.8.2rc2
  [[750c0d2eb]](https://git.sudo.ws/sudo/commit/?id=750c0d2eb)

* Makefile.in, common/Makefile.in, compat/Makefile.in, doc/Makefile.in,
  include/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  src/Makefile.in, zlib/Makefile.in:

  Move nls targets to the top level Makefile so the paths in the pot file
  are saner
  [[e66169b3e]](https://git.sudo.ws/sudo/commit/?id=e66169b3e)

* src/po/fi.mo:

  Add compiled version of sudo Finish translation
  [[e8064e25d]](https://git.sudo.ws/sudo/commit/?id=e8064e25d)

* MANIFEST, plugins/sudoers/po/fi.mo, plugins/sudoers/po/uk.mo:

  Update MANIFEST with .po and .mo files Rebuild sudoers fi and uk .mo
  files
  [[5fdfefb9d]](https://git.sudo.ws/sudo/commit/?id=5fdfefb9d)

* configure, configure.in, plugins/sudoers/po/fi.po:

  Add Finish translation from translationproject.org
  [[707bad44d]](https://git.sudo.ws/sudo/commit/?id=707bad44d)

2011-06-03 Todd C. Miller

* doc/sudoers.pod:

  The group named by exempt\_group should not have a % prefix.
  [[f77403d06]](https://git.sudo.ws/sudo/commit/?id=f77403d06)

2011-06-01 Todd C. Miller

* doc/sudoers.pod:

  Fix typo; “Defaults group\_plugin” not “Defaults sudo\_plugin”
  [[977dfd316]](https://git.sudo.ws/sudo/commit/?id=977dfd316)

2011-05-31 Todd C. Miller

* src/exec.c, src/exec\_pty.c:

  Fix compressed io log corruption in background mode by using \_exit()
  instead of exit() to avoid flushing buffers twice.

  Improved background mode support. When not allocating a pty, the command
  is run in its own process group. This prevents write access to the tty.
  When running in a pty, stdin is not hooked up and we never read from
  /dev/tty, which results in similar behavior.
  [[3c9e5f28f]](https://git.sudo.ws/sudo/commit/?id=3c9e5f28f)

* compat/Makefile.in, mkdep.pl, plugins/sudoers/Makefile.in:

  Clean up regress files Generate proper dependencies for regress objs in
  compat
  [[7199afec8]](https://git.sudo.ws/sudo/commit/?id=7199afec8)

* plugins/sudoers/Makefile.in:

  Add missing dependency for check\_fill.o.
  [[43fef79b0]](https://git.sudo.ws/sudo/commit/?id=43fef79b0)

2011-05-29 Todd C. Miller

* INSTALL, configure, configure.in:

  Add support for –enable-nls[=location]
  [[88cfbd51a]](https://git.sudo.ws/sudo/commit/?id=88cfbd51a)

2011-05-28 Todd C. Miller

* plugins/sudoers/linux\_audit.c:

  Include gettext.h
  [[d5e1cbbfa]](https://git.sudo.ws/sudo/commit/?id=d5e1cbbfa)

* plugins/sudoers/ldap.c, plugins/sudoers/parse.c:

  Quiet gcc warnings.
  [[ab3b3eb83]](https://git.sudo.ws/sudo/commit/?id=ab3b3eb83)

* configure, configure.in:

  Don’t install .mo files if gettext was not found.
  [[97214c448]](https://git.sudo.ws/sudo/commit/?id=97214c448)

2011-05-27 Todd C. Miller

* src/exec.c:

  Always allocate a pty when running a command in the background but call
  setsid() after forking to make sure we don’t end up with a controlling
  tty.
  [[1b67009ca]](https://git.sudo.ws/sudo/commit/?id=1b67009ca)

* plugins/sudoers/iolog.c:

  Add missing space between command name and the first command line
  argument.
  [[8513c4818]](https://git.sudo.ws/sudo/commit/?id=8513c4818)

* plugins/sudoers/sudoreplay.c:

  Quiet a compiler warning on some platforms.
  [[3e2f4037c]](https://git.sudo.ws/sudo/commit/?id=3e2f4037c)

* plugins/sudoers/po/README, src/po/README:

  README file that directs people to translationproject.org
  [[9b7cd235e]](https://git.sudo.ws/sudo/commit/?id=9b7cd235e)

* plugins/sudoers/po/uk.po, src/po/fi.po:

  Sync translations with TP
  [[6fccd6bfd]](https://git.sudo.ws/sudo/commit/?id=6fccd6bfd)

* Makefile.in:

  Add ‘sync-po’ target to top-level Makefile to rsync the po files from
  translationproject.org.
  [[a7d96a334]](https://git.sudo.ws/sudo/commit/?id=a7d96a334)

* plugins/sudoers/Makefile.in:

  install nls files from install target
  [[4ab4114c4]](https://git.sudo.ws/sudo/commit/?id=4ab4114c4)

* Makefile.in, plugins/sudoers/Makefile.in, src/Makefile.in, sudo.pp:

  Include .mo files in sudo binary packags.
  [[38db44b80]](https://git.sudo.ws/sudo/commit/?id=38db44b80)

* configure, configure.in, plugins/sudoers/po/zh\_CN.mo,
  plugins/sudoers/po/zh\_CN.po, src/po/zh\_CN.mo, src/po/zh\_CN.po:

  Add simplified chinese translation
  [[47adbf8d3]](https://git.sudo.ws/sudo/commit/?id=47adbf8d3)

2011-05-26 Todd C. Miller

* configure, configure.in, plugins/sudoers/po/uk.mo,
  plugins/sudoers/po/uk.po, src/po/uk.mo, src/po/uk.po:

  Add ukranian translation
  [[c202c4e6d]](https://git.sudo.ws/sudo/commit/?id=c202c4e6d)

* compat/Makefile.in:

  refer to siglist.c, not ./siglist.c since not all makes will treat foo
  and ./foo the same.
  [[e9f44f788]](https://git.sudo.ws/sudo/commit/?id=e9f44f788)

* plugins/sudoers/sudoers.c:

  Set def\_preserve\_groups before searching for the command when the -P
  flag is specified.
  [[67e8e5653]](https://git.sudo.ws/sudo/commit/?id=67e8e5653)

* Makefile.in, compat/Makefile.in, mkdep.pl, plugins/sudoers/Makefile.in:

  Add dependency for siglist.lo in compat. This is a generated file so
  “make depend” needs to depend on it.
  [[f7cb73abd]](https://git.sudo.ws/sudo/commit/?id=f7cb73abd)

* compat/Makefile.in:

  More dependency fixes.
  [[336ab7077]](https://git.sudo.ws/sudo/commit/?id=336ab7077)

* compat/Makefile.in:

  Fix a few dependencies.
  [[79098fd96]](https://git.sudo.ws/sudo/commit/?id=79098fd96)

* plugins/sudoers/Makefile.in, src/Makefile.in:

  Place compiled mo files in the src dir, not the build dir. When
  installing compiled mo files, display a status message.
  [[6c13614a5]](https://git.sudo.ws/sudo/commit/?id=6c13614a5)

2011-05-25 Todd C. Miller

* doc/sudoers.ldap.pod, plugins/sudoers/ldap.c:

  Tivoli Directory Server requires that seconds be present in a timestamp,
  even though RFC 4517 states that they are optional.
  [[086cbfe37]](https://git.sudo.ws/sudo/commit/?id=086cbfe37)

* plugins/sudoers/sudo\_nss.h:

  Add missing bit of copyright
  [[b463d026b]](https://git.sudo.ws/sudo/commit/?id=b463d026b)

* doc/visudo.pod:

  Mention cycle detection warnings
  [[4c370f9f6]](https://git.sudo.ws/sudo/commit/?id=4c370f9f6)

* plugins/sudoers/visudo.c:

  When checking aliases, also check the contents of the alias in case
  there are problems with an alias that is referenced inside another.
  Replace the self reference check with real alias cycle detection.
  [[5b7e231dd]](https://git.sudo.ws/sudo/commit/?id=5b7e231dd)

* plugins/sudoers/alias.c:

  Set errno to ELOOP in alias\_find() if there is a cycle. Set errno to
  ENOENT in alias\_find() and alias\_remove() if the entry could not be
  found.
  [[2b9849287]](https://git.sudo.ws/sudo/commit/?id=2b9849287)

* plugins/sudoers/visudo.c:

  Increment alias\_seqno before calls to alias\_remove\_recursive() to avoid
  false positives with the alias loop detection. Fixes spurious warnings
  about unused aliases when they are nested.
  [[682333ae2]](https://git.sudo.ws/sudo/commit/?id=682333ae2)

* MANIFEST:

  add mkdep.pl
  [[9089c7ddf]](https://git.sudo.ws/sudo/commit/?id=9089c7ddf)

* plugins/sudoers/Makefile.in:

  Add dependency on convenience libs to binaries
  [[c8dda2b85]](https://git.sudo.ws/sudo/commit/?id=c8dda2b85)

* Makefile.in:

  mkdep.pl only works when run from the src dir
  [[d1e5e3b44]](https://git.sudo.ws/sudo/commit/?id=d1e5e3b44)

* Makefile.in, common/Makefile.in, compat/Makefile.in, mkdep.pl,
  plugins/sample/Makefile.in, plugins/sample\_group/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in, zlib/Makefile.in:

  Auto-generate Makefile dependencies with a perl script.
  [[78e235945]](https://git.sudo.ws/sudo/commit/?id=78e235945)

2011-05-23 Todd C. Miller

* plugins/sudoers/match.c:

  If the user specifies a runas group via sudo’s -g option that matches
  the runas user’s group in the passwd database and that group is not
  denied in the Runas\_Spec, allow it. Thus, if user root’s gid in
  /etc/passwd is 0, then “sudo -u root -g root id” is allow even if no
  groups are present in the Runas\_Spec.
  [[d9e807b26]](https://git.sudo.ws/sudo/commit/?id=d9e807b26)

2011-05-22 Todd C. Miller

* plugins/sudoers/Makefile.in, src/Makefile.in:

  Add dependencies on gettext.h
  [[3833efaf0]](https://git.sudo.ws/sudo/commit/?id=3833efaf0)

* plugins/sudoers/Makefile.in, src/Makefile.in:

  Fix install-nls target with HP-UX sh when gettext is not present.
  [[9b3653fca]](https://git.sudo.ws/sudo/commit/?id=9b3653fca)

2011-05-20 Todd C. Miller

* plugins/sudoers/Makefile.in, plugins/sudoers/po/sudoers.pot,
  src/Makefile.in, src/po/sudo.pot:

  regenerate .pot files for lbuf changes
  [[f8df14034]](https://git.sudo.ws/sudo/commit/?id=f8df14034)

* configure, configure.in:

  Add missing “checking” message for gettext when using the cache.
  [[724b64e2c]](https://git.sudo.ws/sudo/commit/?id=724b64e2c)

* common/lbuf.c, include/lbuf.h, plugins/sudoers/ldap.c,
  plugins/sudoers/parse.c, plugins/sudoers/sudo\_nss.c, src/parse\_args.c:

  Add primitive format string support to the lbuf code to make
  translations simpler.
  [[bd36d4f2a]](https://git.sudo.ws/sudo/commit/?id=bd36d4f2a)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/po/sudoers.pot,
  src/Makefile.in, src/po/sudo.pot:

  Add message catalog template files for sudo and the sudoers module.
  [[681547c5f]](https://git.sudo.ws/sudo/commit/?id=681547c5f)

* MANIFEST, common/aix.c, common/alloc.c, compat/strsignal.c, config.h.in,
  configure.in, doc/Makefile.in, include/gettext.h,
  plugins/sudoers/iolog.c, plugins/sudoers/plugin\_error.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/visudo.c, src/error.c,
  src/net\_ifs.c, src/sesh.c, src/sudo.c, src/sudo.h:

  Add gettext.h convenience header. This is similar to but distinct from
  the one included with the gettext package.
  [[bf7e7b575]](https://git.sudo.ws/sudo/commit/?id=bf7e7b575)

2011-05-19 Todd C. Miller

* configure, configure.in:

  Add checks for nroff -c and -Tascii flags
  [[a05e96369]](https://git.sudo.ws/sudo/commit/?id=a05e96369)

* configure, configure.in:

  Add check for HP bundled C Compiler (which cannot create shared libs)
  [[e2aef4f52]](https://git.sudo.ws/sudo/commit/?id=e2aef4f52)

* plugins/sudoers/sudoreplay.c:

  Fix C format warnings.
  [[645b5c1c7]](https://git.sudo.ws/sudo/commit/?id=645b5c1c7)

* include/error.h:

  Add \_\_printflike
  [[f4a4cbeab]](https://git.sudo.ws/sudo/commit/?id=f4a4cbeab)

* plugins/sudoers/ldap.c, plugins/sudoers/parse.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/visudo.c, src/parse\_args.c:

  Translate help / usage strings.
  [[67cc4ff02]](https://git.sudo.ws/sudo/commit/?id=67cc4ff02)

* plugins/sudoers/Makefile.in, src/Makefile.in:

  Set –msgid-bugs-address to the bugzilla url
  [[d2384297a]](https://git.sudo.ws/sudo/commit/?id=d2384297a)

* Makefile.in, common/Makefile.in, compat/Makefile.in, configure,
  configure.in, doc/Makefile.in, include/Makefile.in,
  plugins/sample/Makefile.in, plugins/sample\_group/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in, zlib/Makefile.in:

  Add scaffolding to update .po files and install .mo files.
  [[3164f5814]](https://git.sudo.ws/sudo/commit/?id=3164f5814)

* doc/license.pod:

  update copyright year
  [[8985ba0d6]](https://git.sudo.ws/sudo/commit/?id=8985ba0d6)

* INSTALL, README:

  No need to include version number at the top of these files.
  [[6b856c779]](https://git.sudo.ws/sudo/commit/?id=6b856c779)

2011-05-18 Todd C. Miller

* plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/env.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/visudo.c:

  Minor warning/error cleanup
  [[42a3966a8]](https://git.sudo.ws/sudo/commit/?id=42a3966a8)

* config.h.in, configure.in:

  Emulate ngettext for the non-nls case
  [[0954a1b1c]](https://git.sudo.ws/sudo/commit/?id=0954a1b1c)

* plugins/sudoers/ldap.c:

  Do not mark untranslatable strings for translation
  [[27cb58514]](https://git.sudo.ws/sudo/commit/?id=27cb58514)

* plugins/sudoers/check.c:

  Use ROOT\_UID not 0.
  [[6c28af155]](https://git.sudo.ws/sudo/commit/?id=6c28af155)

* plugins/sudoers/check.c, plugins/sudoers/iolog.c,
  plugins/sudoers/logging.c, src/exec.c, src/exec\_pty.c,
  src/load\_plugins.c, src/sudo.c, src/sudo\_edit.c:

  Minor warning/error message cleanup
  [[7960bde2d]](https://git.sudo.ws/sudo/commit/?id=7960bde2d)

* plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/logging.c, plugins/sudoers/mon\_systrace.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/visudo.c, src/exec.c,
  src/exec\_pty.c, src/net\_ifs.c, src/selinux.c:

  cannot -> “unable to” in warning/error messages
  [[fce0b906e]](https://git.sudo.ws/sudo/commit/?id=fce0b906e)

* plugins/sudoers/check.c, plugins/sudoers/mon\_systrace.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/visudo.c, src/exec\_pty.c,
  src/sudo.c, src/utmp.c:

  can’t -> “unable to” in warning/error messages
  [[6f8cd9192]](https://git.sudo.ws/sudo/commit/?id=6f8cd9192)

* configure, configure.in:

  FreeBSD needs the main sudo executable to link with -lpam when loading
  dynaic pam modules for some reason.
  [[159d7e393]](https://git.sudo.ws/sudo/commit/?id=159d7e393)

2011-05-17 Todd C. Miller

* plugins/sudoers/ldap.c, src/exec.c, src/exec\_pty.c, src/sudo.c:

  We don’t want to translate debugging messages.
  [[917c8d48a]](https://git.sudo.ws/sudo/commit/?id=917c8d48a)

* configure, configure.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/iolog.c, plugins/sudoers/plugin\_error.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/visudo.c, src/Makefile.in,
  src/sesh.c, src/sudo.c:

  Add calls to bindtextdomain() and textdomain() Currently there are two
  domains, one for the sudo front-end and one for the sudoers plugin and
  its associated utilities.
  [[c3a259f5e]](https://git.sudo.ws/sudo/commit/?id=c3a259f5e)

* configure, configure.in:

  Fix caching of libc gettext check.
  [[19a81af6b]](https://git.sudo.ws/sudo/commit/?id=19a81af6b)

* plugins/sudoers/def\_data.c, plugins/sudoers/defaults.c,
  plugins/sudoers/mkdefaults:

  Mark defaults descriptions for translation
  [[4810662e9]](https://git.sudo.ws/sudo/commit/?id=4810662e9)

* NEWS:

  Update for sudo 1.8.1p2
  [[1a75992b8]](https://git.sudo.ws/sudo/commit/?id=1a75992b8)

2011-05-16 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Quiet compiler warning when SELinux is enabled.
  [[f6aea1072]](https://git.sudo.ws/sudo/commit/?id=f6aea1072)

* plugins/sudoers/plugin\_error.c, plugins/sudoers/sudoreplay.c,
  src/error.c, src/net\_ifs.c, src/sesh.c:

  Add missing includes of libintl.h.
  [[c23436356]](https://git.sudo.ws/sudo/commit/?id=c23436356)

* plugins/sudoers/auth/pam.c:

  Fix gettext marker.
  [[d006b00a4]](https://git.sudo.ws/sudo/commit/?id=d006b00a4)

* common/aix.c, common/alloc.c, compat/strsignal.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/sudoers.h, src/sudo.h:

  Include libint.h where needed.
  [[15bc74bd6]](https://git.sudo.ws/sudo/commit/?id=15bc74bd6)

* plugins/sudoers/alias.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/securid.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/check.c,
  plugins/sudoers/defaults.c, plugins/sudoers/env.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/interfaces.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/ldap.c,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/logging.c,
  plugins/sudoers/parse.c, plugins/sudoers/plugin\_error.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke.c, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c, plugins/sudoers/visudo.c:

  Prepare sudoers module messages for translation.
  [[b643b190a]](https://git.sudo.ws/sudo/commit/?id=b643b190a)

* plugins/sudoers/sudoers.c:

  Only check gid of sudoers file if it is group-readable.
  [[24a087709]](https://git.sudo.ws/sudo/commit/?id=24a087709)

* plugins/sudoers/auth/aix\_auth.c:

  For AIX, keep calling authenticate() until reenter reaches 0.
  [[7708d5ce8]](https://git.sudo.ws/sudo/commit/?id=7708d5ce8)

2011-05-09 Todd C. Miller

* configure, configure.in:

  Cache the status of the initial gettext() check.
  [[4ff045b26]](https://git.sudo.ws/sudo/commit/?id=4ff045b26)

* INSTALL, configure, configure.in:

  Add –disable-nls flag and improve checks for gettext.
  [[1994db70d]](https://git.sudo.ws/sudo/commit/?id=1994db70d)

* configure, configure.in:

  When building with gcc on HP-UX, use -march=1.1 to produce portable
  binaries on a pa-risc2 host. Previously, the +Dportable option was used
  for the HP-UX C compiler but gcc always produced native binaries.
  [[411737cf2]](https://git.sudo.ws/sudo/commit/?id=411737cf2)

2011-05-06 Todd C. Miller

* common/aix.c, common/alloc.c, compat/strsignal.c, src/error.c,
  src/exec.c, src/exec\_pty.c, src/load\_plugins.c, src/net\_ifs.c,
  src/parse\_args.c, src/selinux.c, src/sesh.c, src/sudo.c,
  src/sudo\_edit.c, src/tgetpass.c, src/utmp.c:

  Prepare sudo front end messages for translation.
  [[c865a462c]](https://git.sudo.ws/sudo/commit/?id=c865a462c)

2011-05-04 Todd C. Miller

* config.h.in, configure, configure.in, plugins/sudoers/auth/pam.c:

  Add initial scaffolding to support localization via gettext()
  [[96b7c1f0f]](https://git.sudo.ws/sudo/commit/?id=96b7c1f0f)

* compat/fnmatch.h, compat/glob.h:

  Don’t let the fnmatch/glob macros expand the function prototype.
  [[5c3fbfd73]](https://git.sudo.ws/sudo/commit/?id=5c3fbfd73)

2011-05-03 Todd C. Miller

* compat/fnmatch.c, compat/fnmatch.h, compat/glob.c, compat/glob.h:

  Resolve namespace collisions on HP-UX ia64 and possibly others by adding
  a rpl\_ prefix to our fnmatch and glob replacements and #defining rpl\_foo
  to foo in the header files.
  [[a1f6db3a0]](https://git.sudo.ws/sudo/commit/?id=a1f6db3a0)

2011-04-29 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Split ALL, ROLE and TYPE into their own actions. Since you can only have
  #ifdefs inside of braces, ROLE and TYPE use a naughty goto in the
  non-SELinux case. This is safe because the actions are in one big
  switch() statement.
  [[4dd3440cb]](https://git.sudo.ws/sudo/commit/?id=4dd3440cb)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Fix regexp for matching a CIDR-style IPv4 netmask. From Marc Espie.
  [[189817a31]](https://git.sudo.ws/sudo/commit/?id=189817a31)

2011-04-27 Todd C. Miller

* doc/UPGRADE, doc/sudoers.pod:

  askpass moved from sudoers to sudo.conf in sudo 1.8.0
  [[8a76ddfef]](https://git.sudo.ws/sudo/commit/?id=8a76ddfef)

* doc/sudoers.pod:

  Remove obsolete warning about runas\_default and ordering. Move syslog
  facility and priority lists into the section where the relevant options
  are described.
  [[38f7dd359]](https://git.sudo.ws/sudo/commit/?id=38f7dd359)

2011-04-26 Todd C. Miller

* plugins/sudoers/auth/sia.c:

  Fix SIA support; we no longer have access to the real argc and argv so
  allocate space for a fake one and use the argv passed to the plugin with
  “sudo” for argv[0].
  [[435d8413b]](https://git.sudo.ws/sudo/commit/?id=435d8413b)

2011-04-23 Todd C. Miller

* src/net\_ifs.c:

  Remove useless realloc when trying to get the buffer size right.
  [[7dfb27fb3]](https://git.sudo.ws/sudo/commit/?id=7dfb27fb3)

* plugins/sudoers/set\_perms.c:

  Be explicit when setting euid to 0 before call to setreuid(0, 0)
  [[7c35601cf]](https://git.sudo.ws/sudo/commit/?id=7c35601cf)

2011-04-18 Todd C. Miller

* configure, configure.in:

  Need to do checks for krb5\_verify\_user, krb5\_init\_secure\_context and
  krb5\_get\_init\_creds\_opt\_alloc regardless of whether or not krb5-config
  is present.
  [[f1bea0a21]](https://git.sudo.ws/sudo/commit/?id=f1bea0a21)

2011-04-15 Todd C. Miller

* plugins/sudoers/set\_perms.c:

  Work around weird AIX saved uid semantics on setuid() and setreuid(). On
  AIX, setuid() will only set the saved uid if the euid is already 0.
  [[b08ad6083]](https://git.sudo.ws/sudo/commit/?id=b08ad6083)

2011-04-14 Todd C. Miller

* sudo.pp:

  update copyright year
  [[2f24216e8]](https://git.sudo.ws/sudo/commit/?id=2f24216e8)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Treat a missing includedir like an empty one and do not return an error.
  [[c6ad6d29e]](https://git.sudo.ws/sudo/commit/?id=c6ad6d29e)

2011-04-12 Todd C. Miller

* pp:

  Fix ARCH setting in cross-compile Solaris packages.
  [[55c3dfe39]](https://git.sudo.ws/sudo/commit/?id=55c3dfe39)

* sudo.pp:

  Fix aix version setting.
  [[cf5e8d9b7]](https://git.sudo.ws/sudo/commit/?id=cf5e8d9b7)

* plugins/sudoers/ldap.c:

  Remove extraneous parens in LDAP filter when sudoers\_search\_filter is
  enabled that causes a search error. From Matthew Thomas.
  [[b00cf92ef]](https://git.sudo.ws/sudo/commit/?id=b00cf92ef)

2011-04-11 Todd C. Miller

* plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c:

  Correct sizeof() to fix test failure.
  [[2af217409]](https://git.sudo.ws/sudo/commit/?id=2af217409)

* plugins/sudoers/Makefile.in:

  “install” target should depend on “install-dirs”. Fixes “make -j”
  problem and closes bz #487. From Chris Coleman.
  [[365bd63e6]](https://git.sudo.ws/sudo/commit/?id=365bd63e6)

2011-04-07 Todd C. Miller

* config.h.in:

  Add HAVE\_RFC1938\_SKEYCHALLENGE
  [[1e72fa912]](https://git.sudo.ws/sudo/commit/?id=1e72fa912)

2011-04-06 Todd C. Miller

* NEWS:

  Mention plugin loading and libgcc changes
  [[11b133232]](https://git.sudo.ws/sudo/commit/?id=11b133232)

* src/load\_plugins.c, src/sudo.c, src/sudo\_plugin\_int.h:

  Load plugins after parsing arguments and potentially printing the
  version. That way, an error loading or initializing a plugin doesn’t
  break “sudo -h” or “sudo -V”.
  [[b6d0a28ef]](https://git.sudo.ws/sudo/commit/?id=b6d0a28ef)

* Makefile.in:

  When using a sub-shell to invoke the sub-make, exec make instead of
  running it inside the shell to avoid an extra process.
  [[4b4f5bf32]](https://git.sudo.ws/sudo/commit/?id=4b4f5bf32)

* compat/regress/fnmatch/fnm\_test.in, compat/regress/glob/globtest.c:

  Stop testing unspecified behavior in fnmatch Make glob test more
  portable
  [[60e9e4dd8]](https://git.sudo.ws/sudo/commit/?id=60e9e4dd8)

* compat/Makefile.in:

  No need to add current dir to include path and having it breaks the test
  programs that expect to get the system glob.h and fnmatch.h
  [[8720363f3]](https://git.sudo.ws/sudo/commit/?id=8720363f3)

* INSTALL, configure, configure.in:

  Fix and document –with-plugindir; partially from Diego Elio Petteno
  [[f52a6ccae]](https://git.sudo.ws/sudo/commit/?id=f52a6ccae)

* compat/Makefile.in, compat/regress/fnmatch/fnm\_test.c,
  compat/regress/fnmatch/fnm\_test.in, compat/regress/glob/globtest.c,
  compat/regress/glob/globtest.in:

  Fix fnmatch and glob tests to not use hard-coded flag values in the
  input file. Link test programs with libreplace so we get our replacement
  verions as needed.
  [[f949dbcc5]](https://git.sudo.ws/sudo/commit/?id=f949dbcc5)

* Makefile.in:

  If make in a subdir fails, fail the target in the upper level Makefile
  too. Adapted from a patch from Diego Elio Petteno
  [[698c5002d]](https://git.sudo.ws/sudo/commit/?id=698c5002d)

* configure, configure.in, plugins/sudoers/auth/rfc1938.c:

  Add check for NetBSD-style 4-argument skeychallenge() as Gentoo also has
  this. Adapted from a patch from Diego Elio Petteno
  [[233d90f2c]](https://git.sudo.ws/sudo/commit/?id=233d90f2c)

* plugins/sudoers/Makefile.in:

  Make SUDOERS\_LDFLAGS reference $(LDFLAGS) instead of using @LDFLAGS@
  directly.
  [[f6ffc8adf]](https://git.sudo.ws/sudo/commit/?id=f6ffc8adf)

* configure, configure.in:

  Fix warnings when -without-skey, –without-opie, –without-kerb4,
  –without-kerb5 or –without-SecurID were specified.
  [[dcc4ec843]](https://git.sudo.ws/sudo/commit/?id=dcc4ec843)

* MANIFEST:

  Add plugins/sudoers/sudoers\_version.h
  [[3a54719a6]](https://git.sudo.ws/sudo/commit/?id=3a54719a6)

* configure, configure.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in:

  Back out the –with-libpath addition to SUDOERS\_LDFLAGS since that now
  include LDFLAGS in the sudoers Makefile.in. Add missing settng of
  @LDFLAGS@ in plugin Makefile.in files.
  [[89cd8c2ff]](https://git.sudo.ws/sudo/commit/?id=89cd8c2ff)

2011-04-05 Todd C. Miller

* NEWS:

  Mention %#gid support in User\_List and Runas\_List
  [[dc19e4dff]](https://git.sudo.ws/sudo/commit/?id=dc19e4dff)

* plugins/sudoers/sudoers.c, plugins/sudoers/sudoers\_version.h,
  plugins/sudoers/visudo.c:

  Keep track of sudoers grammar version and report it in the -V output.
  [[f1078bd28]](https://git.sudo.ws/sudo/commit/?id=f1078bd28)

* plugins/sudoers/sudo\_nss.h:

  Add multiple inclusion guard
  [[b9d15e825]](https://git.sudo.ws/sudo/commit/?id=b9d15e825)

* configure, configure.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in:

  The –with-libpath option now adds to SUDOERS\_LDFLAGS as well as
  LDFLAGS. Remove old -static hack for HP-UX < 9. Add LTLDFLAGS and set
  it to -Wc,-static-libgcc if not using GNU ld so we don’t have a
  dependency on the shared libgcc in sudoers.so.
  [[021e2a94b]](https://git.sudo.ws/sudo/commit/?id=021e2a94b)

* doc/sudoers.pod:

  Fix typo; from Petr Uzel
  [[e55bbb183]](https://git.sudo.ws/sudo/commit/?id=e55bbb183)

2011-04-01 Todd C. Miller

* plugins/sudoers/testsudoers.c:

  In dump-only mode, use “root” as the default username instead of
  “nobody” as the latter may not be available on all systems.
  [[3ffb64986]](https://git.sudo.ws/sudo/commit/?id=3ffb64986)

2011-03-31 Todd C. Miller

* plugins/sudoers/testsudoers.c:

  Remove NewArgv/NewArgc, they are no longer needed.
  [[129ccecd3]](https://git.sudo.ws/sudo/commit/?id=129ccecd3)

* plugins/sudoers/testsudoers.c:

  Fix setting of user\_args
  [[987e1dbe6]](https://git.sudo.ws/sudo/commit/?id=987e1dbe6)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Add ‘!’ token to lex tracing
  [[c82e29f27]](https://git.sudo.ws/sudo/commit/?id=c82e29f27)

* plugins/sudoers/regress/testsudoers/test1.sh:

  Use group bin in test, not wheel as most systems have the bin group but
  the same is no longer true of wheel.
  [[0e2d58863]](https://git.sudo.ws/sudo/commit/?id=0e2d58863)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Avoid using pre or post increment in a parameter to a ctype(3) function
  as it might be a macro that causes the increment to happen more than
  once.
  [[ca32055fd]](https://git.sudo.ws/sudo/commit/?id=ca32055fd)

2011-03-30 Todd C. Miller

* sudo.pp:

  Strip off the beta or release candidate version when building AIX
  packages.
  [[02f0775fe]](https://git.sudo.ws/sudo/commit/?id=02f0775fe)

* configure, configure.in:

  We need to include OSDEFS in CFLAGS when doing the utmp/utmpx structure
  checks for glibc which only has \_\_e\_termination visible when \_GNU\_SOURCE
  is *not* defined.
  [[2534672f6]](https://git.sudo.ws/sudo/commit/?id=2534672f6)

* common/aix.c:

  getuserattr(user, …) will fall back to the “default” entry
  automatically, there’s no need to check “default” manually.
  [[e42331fd5]](https://git.sudo.ws/sudo/commit/?id=e42331fd5)

2011-03-29 Todd C. Miller

* doc/UPGRADE:

  Document parser changes.
  [[51c812386]](https://git.sudo.ws/sudo/commit/?id=51c812386)

* Makefile.in, common/Makefile.in, compat/Makefile.in, doc/Makefile.in,
  include/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  src/Makefile.in, zlib/Makefile.in:

  If there is an existing sudoers file, only install if it passes a syntax
  check.
  [[44c763c72]](https://git.sudo.ws/sudo/commit/?id=44c763c72)

* plugins/sudoers/regress/sudoers/test6.out.ok,
  plugins/sudoers/testsudoers.c:

  Add runasgroup support to testsudoers
  [[8b9d773ba]](https://git.sudo.ws/sudo/commit/?id=8b9d773ba)

* plugins/sudoers/Makefile.in:

  For “make check”, keep going even if a test fails.
  [[5e067b273]](https://git.sudo.ws/sudo/commit/?id=5e067b273)

* plugins/sudoers/testsudoers.c:

  More useful exit codes: \* 0 - parsed OK and command matched. \* 1 - parse
  error \* 2 - command not matched \* 3 - command denied
  [[b87465b56]](https://git.sudo.ws/sudo/commit/?id=b87465b56)

* doc/sudoers.pod:

  Document %#gid, and %:#nonunix\_gid syntax.
  [[335abe3a1]](https://git.sudo.ws/sudo/commit/?id=335abe3a1)

* plugins/sudoers/pwutil.c:

  Add support to user\_in\_group() for treating group names that begin with
  a ‘#’ as gids.
  [[b0be8d20c]](https://git.sudo.ws/sudo/commit/?id=b0be8d20c)

* config.h.in, configure, configure.in, src/utmp.c:

  Add explicit check for struct utmpx.ut\_exit.e\_termination and struct
  utmpx.ut\_exit.\_\_e\_termination. HP-UX uses the latter. Only update
  ut\_exit if we detect one or the other.
  [[53d183c38]](https://git.sudo.ws/sudo/commit/?id=53d183c38)

2011-03-28 Todd C. Miller

* plugins/sudoers/toke.c:

  Add back missing #include of config.h
  [[041b1a896]](https://git.sudo.ws/sudo/commit/?id=041b1a896)

* plugins/sudoers/iolog\_path.c, plugins/sudoers/regress/iolog\_path/data:

  Avoid a NULL deref on unrecognized escapes. Collapse %% -> % like
  strftime() does.
  [[353f31751]](https://git.sudo.ws/sudo/commit/?id=353f31751)

* aclocal.m4:

  Quote first argument to AC\_DEFUN(); from Elan Ruusamae
  [[c739a7052]](https://git.sudo.ws/sudo/commit/?id=c739a7052)

2011-03-27 Todd C. Miller

* MANIFEST:

  add new sudoers tests
  [[8c975b278]](https://git.sudo.ws/sudo/commit/?id=8c975b278)

* plugins/sudoers/regress/sudoers/test8.in,
  plugins/sudoers/regress/sudoers/test8.out.ok,
  plugins/sudoers/regress/sudoers/test8.toke.ok:

  Add test for a newline in the middle of a string when no line
  continuation character is used.
  [[b485739ed]](https://git.sudo.ws/sudo/commit/?id=b485739ed)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Use bitwise AND instead of modulus to check for length being odd. A
  newline in the middle of a string is an error unless a line continuation
  character is used.
  [[e3ff59e50]](https://git.sudo.ws/sudo/commit/?id=e3ff59e50)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Move lexer globals initialization into init\_lexer.
  [[45b82039b]](https://git.sudo.ws/sudo/commit/?id=45b82039b)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Fix a potential crash when a non-regular file is present in an
  includedir. Fixes bz #452
  [[aed50b4d7]](https://git.sudo.ws/sudo/commit/?id=aed50b4d7)

* pp:

  On some Linux systems, “uname -p” contains detailed processor info so
  check “uname -m” first and then “uname -p” if needed. Recognize PLD
  Linux.
  [[03f949cf1]](https://git.sudo.ws/sudo/commit/?id=03f949cf1)

2011-03-25 Todd C. Miller

* plugins/sudoers/redblack.c:

  Don’t need all sudoers.h here.
  [[ba50e99cb]](https://git.sudo.ws/sudo/commit/?id=ba50e99cb)

* src/sudo.c:

  Print sudo version early, in case policy plugin init fails.
  [[e07ca146d]](https://git.sudo.ws/sudo/commit/?id=e07ca146d)

2011-03-24 Todd C. Miller

* plugins/sudoers/regress/sudoers/test4.toke.ok:

  Update to match change in input.
  [[e9f89d796]](https://git.sudo.ws/sudo/commit/?id=e9f89d796)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Make an empty group or netgroup a syntax error.
  [[31c164dae]](https://git.sudo.ws/sudo/commit/?id=31c164dae)

* plugins/sudoers/regress/sudoers/test7.in,
  plugins/sudoers/regress/sudoers/test7.out.ok,
  plugins/sudoers/regress/sudoers/test7.toke.ok:

  An empty group or netgroup should be a syntax error.
  [[c5cc89da1]](https://git.sudo.ws/sudo/commit/?id=c5cc89da1)

* plugins/sudoers/regress/sudoers/test6.in,
  plugins/sudoers/regress/sudoers/test6.out.ok,
  plugins/sudoers/regress/sudoers/test6.toke.ok:

  Check that uids work in per-user and per-runas Defaults Check that uids
  and gids work in a Command\_Spec
  [[5438a0be6]](https://git.sudo.ws/sudo/commit/?id=5438a0be6)

* plugins/sudoers/regress/sudoers/test5.in,
  plugins/sudoers/regress/sudoers/test5.out.ok,
  plugins/sudoers/regress/sudoers/test5.toke.ok:

  Test empty string in User\_Alias and Command\_Spec
  [[bc333ae44]](https://git.sudo.ws/sudo/commit/?id=bc333ae44)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Allow a group ID in the User\_Spec.
  [[784d0dda3]](https://git.sudo.ws/sudo/commit/?id=784d0dda3)

2011-03-23 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Return an error for the empty string when a word is expected. Allow an
  ID for per-user or per-runas Defaults.
  [[fe1bc681b]](https://git.sudo.ws/sudo/commit/?id=fe1bc681b)

* plugins/sudoers/testsudoers.c:

  Fix printing “User\_Alias FOO = ALL”
  [[cf8caed3b]](https://git.sudo.ws/sudo/commit/?id=cf8caed3b)

2011-03-22 Todd C. Miller

* src/parse\_args.c:

  Better error message about invalid -C argument
  [[71fa43ec4]](https://git.sudo.ws/sudo/commit/?id=71fa43ec4)

* NEWS:

  fix typo
  [[48d67f0df]](https://git.sudo.ws/sudo/commit/?id=48d67f0df)

* doc/sudoers.pod:

  Fix placement of equal size (’=’) in user specification summary.
  [[97b8dc7fe]](https://git.sudo.ws/sudo/commit/?id=97b8dc7fe)

2011-03-21 Todd C. Miller

* MANIFEST:

  update to match sudoers regress
  [[85e86d6ea]](https://git.sudo.ws/sudo/commit/?id=85e86d6ea)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Restore ability to define TRACELEXER and have trace output go to stderr.
  [[06bf685b3]](https://git.sudo.ws/sudo/commit/?id=06bf685b3)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Restore old behavior of setting sawspace = TRUE for command line args
  when a line continuation character is hit to avoid causing problems for
  existing sudoers files.
  [[a2297743a]](https://git.sudo.ws/sudo/commit/?id=a2297743a)

* plugins/sudoers/regress/sudoers/test4.in,
  plugins/sudoers/regress/sudoers/test4.out.ok,
  plugins/sudoers/regress/sudoers/test4.toke.ok:

  Add test for line continuation and aliases
  [[0a4c00085]](https://git.sudo.ws/sudo/commit/?id=0a4c00085)

* plugins/sudoers/Makefile.in:

  Make test output line up nicely for parse vs. toke
  [[2f6c096fb]](https://git.sudo.ws/sudo/commit/?id=2f6c096fb)

* plugins/sudoers/Makefile.in, plugins/sudoers/regress/sudoers/test1.in,
  plugins/sudoers/regress/sudoers/test1.out.ok,
  plugins/sudoers/regress/sudoers/test1.toke.ok,
  plugins/sudoers/regress/sudoers/test2.in,
  plugins/sudoers/regress/sudoers/test2.out.ok,
  plugins/sudoers/regress/sudoers/test2.toke.ok,
  plugins/sudoers/regress/sudoers/test3.in,
  plugins/sudoers/regress/sudoers/test3.out.ok,
  plugins/sudoers/regress/sudoers/test3.toke.ok,
  plugins/sudoers/regress/testsudoers/test1.out.ok,
  plugins/sudoers/regress/testsudoers/test1.sh,
  plugins/sudoers/regress/testsudoers/test3.sh,
  plugins/sudoers/regress/visudo/test1.ok:

  Move parser tests to sudoers directory and test the tokenizer output
  too.
  [[830fce0f1]](https://git.sudo.ws/sudo/commit/?id=830fce0f1)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  If we match a rule anchored to the beginning of a line after parsing a
  line continuation character, return an ERROR token. It would be nicer to
  use REJECT instead but that substantially slows down the lexer.
  [[c7dd8399e]](https://git.sudo.ws/sudo/commit/?id=c7dd8399e)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l:

  Move LEXTRACE macro to toke.h so we can use it in yyerror().
  [[edfb5cd7a]](https://git.sudo.ws/sudo/commit/?id=edfb5cd7a)

2011-03-20 Todd C. Miller

* plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  Make lex tracing settable at run-time in testsudoers via the -t flag.
  Trace output goes to stderr. Will be used by regress tests to check
  lexer.
  [[a27b3f340]](https://git.sudo.ws/sudo/commit/?id=a27b3f340)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Allow whitespace after the modifier in a Defaults entry. E.g. “Defaults:
  username set\_home”
  [[f083e72a5]](https://git.sudo.ws/sudo/commit/?id=f083e72a5)

2011-03-18 Todd C. Miller

* mkpkg:

  Don’t set CC when cross-compiling.
  [[3e41e39be]](https://git.sudo.ws/sudo/commit/?id=3e41e39be)

* NEWS:

  Credit Matthew Thomas for the sudoers\_search\_filter changes.
  [[b87bd95d5]](https://git.sudo.ws/sudo/commit/?id=b87bd95d5)

* MANIFEST:

  Add the .sym files to the MANIFEST
  [[f7db83d9b]](https://git.sudo.ws/sudo/commit/?id=f7db83d9b)

* NEWS:

  Update for sudo 1.8.1 beta
  [[cc4e1a372]](https://git.sudo.ws/sudo/commit/?id=cc4e1a372)

* doc/sudo\_plugin.pod, plugins/sudoers/sudoers.c, src/parse\_args.c:

  user\_shell -> run\_shell to avoid confusion with the user’s SHELL
  variable.
  [[33516ed82]](https://git.sudo.ws/sudo/commit/?id=33516ed82)

* src/exec\_pty.c:

  Save the controlling tty process group before suspending in pty mode.
  Previously, we assumed that the child pgrp == child pid (which is
  usually, but not always, the case).
  [[5d7889c0d]](https://git.sudo.ws/sudo/commit/?id=5d7889c0d)

* doc/sudoers.ldap.pod, plugins/sudoers/ldap.c:

  Add support for sudoers\_search\_filter setting in ldap.conf. This can be
  used to restrict the set of records returned by the LDAP query.
  [[e8776da73]](https://git.sudo.ws/sudo/commit/?id=e8776da73)

2011-03-17 Todd C. Miller

* configure, configure.in:

  Remove the hack to disable -g in CFLAGS unless –with-devel
  [[13b9c7b17]](https://git.sudo.ws/sudo/commit/?id=13b9c7b17)

* doc/sudoers.pod:

  The ‘@’ character does not normally need to be quoted.
  [[c91d2a08a]](https://git.sudo.ws/sudo/commit/?id=c91d2a08a)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  We normaly transition from GOTDEFS to STARTDEFS on whitespace, but if
  that whitespace is followed by a comma, we want to treat it as part of a
  list and not transition.
  [[6170002e6]](https://git.sudo.ws/sudo/commit/?id=6170002e6)

* plugins/sudoers/regress/testsudoers/test3.ok,
  plugins/sudoers/regress/testsudoers/test3.sh:

  Add check for whitespace when a User\_List is used for a per-user
  Defaults entry.
  [[b7487ae48]](https://git.sudo.ws/sudo/commit/?id=b7487ae48)

* plugins/sudoers/regress/testsudoers/test2.out,
  plugins/sudoers/regress/testsudoers/test2.sh:

  Expand quoted name checks to cover recent fixes.
  [[1c0917aa3]](https://git.sudo.ws/sudo/commit/?id=1c0917aa3)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Fix parsing of double-quoted names in Defaultd and Aliases which was
  broken in 601d97ea8792.
  [[88e35a193]](https://git.sudo.ws/sudo/commit/?id=88e35a193)

* plugins/sudoers/Makefile.in:

  toke\_util.c lives in $(srcdir) not $(devdir)
  [[95bf62441]](https://git.sudo.ws/sudo/commit/?id=95bf62441)

2011-03-16 Todd C. Miller

* configure, configure.in:

  Change trunk version to 1.8.x to distinguish from real 1.8.0.
  [[27dbaa8de]](https://git.sudo.ws/sudo/commit/?id=27dbaa8de)

* NEWS, doc/UPGRADE:

  Document major changes in 1.8.1 and add upgrade notes.
  [[53ddb01f3]](https://git.sudo.ws/sudo/commit/?id=53ddb01f3)

* plugins/sudoers/match.c:

  Be careful not to deref user\_stat if it is NULL. This cannot currently
  happen in sudo but might in other programs using the parser.
  [[092b4b4d0]](https://git.sudo.ws/sudo/commit/?id=092b4b4d0)

* mkpkg:

  configure will not add -O2 to CFLAGS if it is already defined to add -O2
  to the CFLAGS we pass in when PIE is being used.
  [[de0df45cc]](https://git.sudo.ws/sudo/commit/?id=de0df45cc)

* doc/sudoers.pod:

  Warn about the dangers of log\_input and mention iolog\_file and iolog\_dir
  in the log\_input and log\_output descriptions.
  [[aa29582ac]](https://git.sudo.ws/sudo/commit/?id=aa29582ac)

* pp:

  sync with git version
  [[5c228d424]](https://git.sudo.ws/sudo/commit/?id=5c228d424)

* doc/sudoers.pod:

  It seems that h comes after i
  [[639903f13]](https://git.sudo.ws/sudo/commit/?id=639903f13)

* doc/sudoers.pod:

  Move log\_input and log\_output to their proper, sorted, location.
  Document set\_utmp and utmp\_runas.
  [[09f9796ea]](https://git.sudo.ws/sudo/commit/?id=09f9796ea)

* src/exec.c:

  Save the controlling tty process group before suspending so we can
  restore it when we resume. Fixes job control problems on Linux caused by
  the previous attemp to fix resuming a shell when I/O logging not
  enabled.
  [[240642399]](https://git.sudo.ws/sudo/commit/?id=240642399)

* common/lbuf.c:

  Fix printing of the remainder after a newline. Fixes “sudo -l” output
  corruption that could occur in some cases.
  [[9e65afc15]](https://git.sudo.ws/sudo/commit/?id=9e65afc15)

2011-03-15 Todd C. Miller

* config.h.in, configure, configure.in, src/exec\_pty.c, src/sudo\_exec.h,
  src/utmp.c:

  Add support for ut\_exit
  [[2041d39db]](https://git.sudo.ws/sudo/commit/?id=2041d39db)

* doc/sudo\_plugin.pod, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/sudoers.c, src/exec.c,
  src/exec\_pty.c, src/sudo.c, src/sudo.h, src/sudo\_exec.h, src/utmp.c:

  Add support for controlling whether utmp is updated and which user is
  listed in the entry.
  [[3506f0107]](https://git.sudo.ws/sudo/commit/?id=3506f0107)

* plugins/sudoers/def\_data.h, plugins/sudoers/defaults.h,
  plugins/sudoers/ldap.c, plugins/sudoers/mkdefaults,
  plugins/sudoers/parse.c:

  Fix typo; tupple vs. tuple
  [[cf7ec7a3c]](https://git.sudo.ws/sudo/commit/?id=cf7ec7a3c)

* src/utmp.c:

  For legacy utmp, strip the /dev/ prefix before trying to determine slot
  since the ttys file does not include the /dev/ prefix.
  [[07968755a]](https://git.sudo.ws/sudo/commit/?id=07968755a)

* aclocal.m4, configure, configure.in, pathnames.h.in:

  Add check for \_PATH\_UTMP
  [[5e6bc4017]](https://git.sudo.ws/sudo/commit/?id=5e6bc4017)

2011-03-14 Todd C. Miller

* plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c:

  Adapt check\_iolog\_path to sessid changes
  [[bf5f17bd6]](https://git.sudo.ws/sudo/commit/?id=bf5f17bd6)

* config.h.in, configure, configure.in, src/Makefile.in, src/exec\_pty.c,
  src/sudo\_exec.h, src/utmp.c:

  Redo utmp handling. If no getutent()/getutxent() is available, assume a
  ttyslot-based utmp. If getttyent() is available, use that directly
  instead of ttyslot() so we don’t have to do the stdin dup2 dance.
  [[8653ccc80]](https://git.sudo.ws/sudo/commit/?id=8653ccc80)

2011-03-11 Todd C. Miller

* MANIFEST, src/Makefile.in, src/exec\_pty.c, src/sudo\_exec.h, src/utmp.c:

  Move utmp handling into utmp.c
  [[1e9def1ef]](https://git.sudo.ws/sudo/commit/?id=1e9def1ef)

* common/aix.c, common/alloc.c, common/fileops.c, common/fmt\_string.c,
  common/lbuf.c, common/list.c, compat/isblank.c, compat/memrchr.c,
  compat/mksiglist.c, compat/nanosleep.c, compat/snprintf.c,
  compat/strlcat.c, compat/strlcpy.c, compat/strsignal.c, compat/utimes.c,
  doc/sudo.pod, doc/visudo.pod, include/sudo\_plugin.h,
  plugins/sample/sample\_plugin.c, plugins/sample\_group/getgrent.c,
  plugins/sample\_group/plugin\_test.c, plugins/sudoers/alias.c,
  plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb4.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/boottime.c, plugins/sudoers/bsm\_audit.c,
  plugins/sudoers/env.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/logging.c,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/redblack.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/timestr.c, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/visudo.c, src/exec.c, src/exec\_pty.c, src/get\_pty.c,
  src/parse\_args.c, src/sudo.c, src/sudo.h, src/sudo\_edit.c,
  src/sudo\_exec.h, src/sudo\_noexec.c, src/sudo\_plugin\_int.h,
  src/tgetpass.c:

  Update copyright years.
  [[53da5e8cd]](https://git.sudo.ws/sudo/commit/?id=53da5e8cd)

* doc/sudo\_plugin.pod, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, src/parse\_args.c:

  Add “user\_shell” boolean as a way to indicate to the plugin that the -s
  flag was given.
  [[cde2cb00f]](https://git.sudo.ws/sudo/commit/?id=cde2cb00f)

* plugins/sudoers/iolog\_path.c, plugins/sudoers/logging.c,
  plugins/sudoers/sudoers.h:

  Move sessid out of sudo\_user.
  [[6e2778eb2]](https://git.sudo.ws/sudo/commit/?id=6e2778eb2)

* plugins/sudoers/iolog.c, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/logging.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Log the TSID even if it is not a simple session ID.
  [[383aef00b]](https://git.sudo.ws/sudo/commit/?id=383aef00b)

* doc/sample.sudo.conf, doc/sudo.pod, doc/sudoers.pod:

  Document noexec in sample.sudo.conf and add back noexec\_file section in
  sudoers with a note that it is deprecated.
  [[9660f08e3]](https://git.sudo.ws/sudo/commit/?id=9660f08e3)

* plugins/sudoers/set\_perms.c:

  Fix running commands as non-root on systems where setreuid() changes the
  saved uid based on the effective uid we are changing to.
  [[6bea3f524]](https://git.sudo.ws/sudo/commit/?id=6bea3f524)

2011-03-10 Todd C. Miller

* plugins/sudoers/defaults.c, src/load\_plugins.c, src/sudo.c, src/sudo.h:

  Move noexec path into sudo.conf now that sudo itself handles noexec.
  Currently can be configured in sudoers too but is now undocumented and
  will be removed in a future release.
  [[7debf4474]](https://git.sudo.ws/sudo/commit/?id=7debf4474)

* doc/sudo.pod, doc/sudoers.pod:

  Document “Path noexec …” in sudo.conf. No longer document noexec\_file
  in sudoers, it will be removed in a future release.
  [[dc8012265]](https://git.sudo.ws/sudo/commit/?id=dc8012265)

* plugins/sudoers/env.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, src/sudo.c, src/sudo.h:

  Move noexec handling to sudo front-end where it is documented as being.
  [[a092d2fdc]](https://git.sudo.ws/sudo/commit/?id=a092d2fdc)

* config.h.in, configure, configure.in, plugins/sudoers/sudoers.c,
  src/exec.c, src/exec\_pty.c, src/sudo.c, src/sudo.h, src/sudo\_edit.c,
  src/sudo\_exec.h:

  Add support for disabling exec via solaris privileges. Includes
  preparation for moving noexec support out of sudoers and into front end
  as documented.
  [[c7a7d3190]](https://git.sudo.ws/sudo/commit/?id=c7a7d3190)

* plugins/sample/Makefile.in, plugins/sample/sample\_plugin.sym,
  plugins/sample\_group/Makefile.in, plugins/sample\_group/sample\_group.sym,
  plugins/sudoers/Makefile.in, plugins/sudoers/sudoers.sym:

  Only export the symbols corresponding to the plugin structs.
  [[7599034e6]](https://git.sudo.ws/sudo/commit/?id=7599034e6)

* configure, configure.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in:

  Install plugins manually instead of using libtool. This works around a
  problem on AIX where libtool will install a .a file containing the .so
  file instead of the .so file itself.
  [[498248d1f]](https://git.sudo.ws/sudo/commit/?id=498248d1f)

* Makefile.in:

  Move check into its own rule since some versions of make will run both
  targets as the default rule.
  [[c6f0c59bc]](https://git.sudo.ws/sudo/commit/?id=c6f0c59bc)

* configure, ltmain.sh, m4/libtool.m4, m4/ltoptions.m4, m4/ltversion.m4,
  m4/lt~obsolete.m4:

  Update to libtool 2.2.10
  [[62edd57ab]](https://git.sudo.ws/sudo/commit/?id=62edd57ab)

2011-03-09 Todd C. Miller

* src/exec.c:

  In handle\_signals(), restart the read() on EINTR to make sure we keep up
  with the signal pipe. Don’t return -1 on EAGAIN, it just means we have
  emptied the pipe.
  [[caefd1abd]](https://git.sudo.ws/sudo/commit/?id=caefd1abd)

* compat/mktemp.c:

  Reorder functions to quiet a compiler warning.
  [[da24fe8c3]](https://git.sudo.ws/sudo/commit/?id=da24fe8c3)

* mkpkg:

  Use the Sun Studio C compiler on Solaris if possible
  [[1c633bb2b]](https://git.sudo.ws/sudo/commit/?id=1c633bb2b)

2011-03-08 Todd C. Miller

* mkpkg:

  Fix default setting of osversion variable.
  [[206f5ff31]](https://git.sudo.ws/sudo/commit/?id=206f5ff31)

* doc/sudo\_plugin.pod:

  Make two login\_class entris consistent.
  [[32cfe08a1]](https://git.sudo.ws/sudo/commit/?id=32cfe08a1)

* config.h.in, configure, configure.in, src/exec.c, src/exec\_pty.c,
  src/sudo\_exec.h:

  Add support for adding a utmp entry when allocating a new pty. Requires
  the BSD login(3) or SYSV/POSIX getutent()/getutxent(). Currently only
  creates a new entry if the existing tty has a utmp entry.
  [[1496bfed6]](https://git.sudo.ws/sudo/commit/?id=1496bfed6)

* plugins/sudoers/boottime.c:

  Avoid pulling in headers we don’t need on Linux For getutx?id(), call
  setutx?ent() first and always call endutx?ent().
  [[9c9c0223e]](https://git.sudo.ws/sudo/commit/?id=9c9c0223e)

* configure, configure.in:

  Add some more libs to SUDOERS\_LIBS instead of relying on them to be
  pulled in by SUDO\_LIBS.
  [[2241947b3]](https://git.sudo.ws/sudo/commit/?id=2241947b3)

* plugins/sudoers/sudoers.c:

  Fix return value of “sudo -l command” when command is not allowed,
  broken in [c7097ea22111]. The default return value is now TRUE and a
  bad: label is used when permission is denied. Also fixed missing
  permissions restoration on certain errors. On error()/errorx(), the
  password and group files are now closed before returning.
  [[d6252de20]](https://git.sudo.ws/sudo/commit/?id=d6252de20)

2011-03-07 Todd C. Miller

* plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.c:

  Fix passing of login class back to sudo front end.
  [[47968912a]](https://git.sudo.ws/sudo/commit/?id=47968912a)

* mkpkg:

  Add –osversion flag to specify OS instead of running “pp –probeonly”
  [[7e1098734]](https://git.sudo.ws/sudo/commit/?id=7e1098734)

* sudo.pp:

  Fix expr usage w/ GNU expr
  [[b54425e04]](https://git.sudo.ws/sudo/commit/?id=b54425e04)

2011-03-06 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Fix exit value for validate and list mode.
  [[e65bc35c6]](https://git.sudo.ws/sudo/commit/?id=e65bc35c6)

* plugins/sudoers/sudoers.c:

  Fix non-interactive mode with sudoers plugin.
  [[a0ba30869]](https://git.sudo.ws/sudo/commit/?id=a0ba30869)

2011-03-05 Todd C. Miller

* doc/sudoreplay.pod:

  sudoreplay can now find IDs other than %{seq} and display the session.
  [[6968367cb]](https://git.sudo.ws/sudo/commit/?id=6968367cb)

2011-03-04 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Add support for replaying sessions when iolog\_file is set to something
  other than %{seq}.
  [[85e8e584a]](https://git.sudo.ws/sudo/commit/?id=85e8e584a)

* plugins/sudoers/visudo.c:

  If we are killed by a signal, display the name of the signal that got
  us.
  [[f5e356ed4]](https://git.sudo.ws/sudo/commit/?id=f5e356ed4)

* configure, configure.in:

  Move libs used for authentication from SUDO\_LIBS to SUDOERS\_LIBS where
  they belong.
  [[3cc46dd70]](https://git.sudo.ws/sudo/commit/?id=3cc46dd70)

* configure.in:

  Fix bug in skey/opie check that could cause a shell warning.
  [[06a39eefb]](https://git.sudo.ws/sudo/commit/?id=06a39eefb)

* plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  No longer need sudo\_getepw() stubs.
  [[95512ae05]](https://git.sudo.ws/sudo/commit/?id=95512ae05)

2011-03-03 Todd C. Miller

* plugins/sudoers/sudo\_nss.c:

  Fix exit value of “sudo -l command” in sudoers module.
  [[8ee8a0d87]](https://git.sudo.ws/sudo/commit/?id=8ee8a0d87)

2011-03-02 Todd C. Miller

* compat/regress/glob/globtest.c:

  Use fgets() not fgetln() for portability.
  [[ca86faac9]](https://git.sudo.ws/sudo/commit/?id=ca86faac9)

* sudo.pp:

  Don’t use the beta or release candidate version as the rpm release.
  [[9d7a12e75]](https://git.sudo.ws/sudo/commit/?id=9d7a12e75)

2011-02-25 Todd C. Miller

* configure, configure.in:

  version 1.8.0
  [[4333b0691]](https://git.sudo.ws/sudo/commit/?id=4333b0691)

* NEWS:

  update sudo 1.8 section
  [[c30fecb83]](https://git.sudo.ws/sudo/commit/?id=c30fecb83)

2011-02-23 Todd C. Miller

* plugins/sudoers/regress/testsudoers/test2.sh:

  fix test description
  [[4688f1ce6]](https://git.sudo.ws/sudo/commit/?id=4688f1ce6)

* plugins/sudoers/regress/testsudoers/test2.out,
  plugins/sudoers/regress/testsudoers/test2.sh,
  plugins/sudoers/regress/visudo/test2.out:

  convert test2 to use testsudoers
  [[a64bd36b3]](https://git.sudo.ws/sudo/commit/?id=a64bd36b3)

* include/sudo\_plugin.h, src/sudo\_plugin\_int.h:

  Move struct generic\_plugin to sudo\_plugin\_int.h
  [[e558b79e8]](https://git.sudo.ws/sudo/commit/?id=e558b79e8)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Allow sudoers file name, mode, uid and gid to be specified in the
  settings list. The sudo front end does not currently set these but may
  in the future.
  [[3c0672e2e]](https://git.sudo.ws/sudo/commit/?id=3c0672e2e)

2011-02-21 Todd C. Miller

* configure, configure.in, doc/sudo.cat, doc/sudo.man.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.man.in,
  doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/visudo.cat,
  doc/visudo.man.in:

  1.8.0rc1
  [[74c4252c1]](https://git.sudo.ws/sudo/commit/?id=74c4252c1)

* doc/sudo.pod, doc/sudoreplay.pod, doc/visudo.pod,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/visudo.c,
  src/parse\_args.c, src/sudo.h:

  add help text to sudo, visudo and sudoreplay for the -h option
  [[59515a4a6]](https://git.sudo.ws/sudo/commit/?id=59515a4a6)

2011-02-19 Todd C. Miller

* compat/snprintf.c:

  avoid using “howmany” for a parameter name since it is a select-related
  macro
  [[7b622a8ca]](https://git.sudo.ws/sudo/commit/?id=7b622a8ca)

* doc/sudoers.pod:

  mention group\_plugin when describing nonunix\_group
  [[315e54fd6]](https://git.sudo.ws/sudo/commit/?id=315e54fd6)

* doc/sudo\_plugin.pod:

  Add missing period at end of sentence
  [[0122e3be2]](https://git.sudo.ws/sudo/commit/?id=0122e3be2)

* Makefile.in, doc/Makefile.in, include/Makefile.in,
  plugins/sample/Makefile.in, plugins/sample\_group/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  add localstatedir; closes bug 471
  [[435e44808]](https://git.sudo.ws/sudo/commit/?id=435e44808)

* config.h.in, configure, configure.in, plugins/sudoers/sudoreplay.c,
  src/exec.c, src/exec\_pty.c:

  The howmany macro lives in sys/sysmacros.h on SVR5 systems Closes Bug
  470
  [[39d9feb43]](https://git.sudo.ws/sudo/commit/?id=39d9feb43)

* configure.in:

  add missing AH\_TEMPLATE for ENV\_RESET
  [[6e312fee0]](https://git.sudo.ws/sudo/commit/?id=6e312fee0)

* src/exec.c:

  SVR5 systems return non-zero for success on socketpair(), check for -1
  instead. Closes Bug 469
  [[a099aa7f2]](https://git.sudo.ws/sudo/commit/?id=a099aa7f2)

2011-02-16 Todd C. Miller

* configure, configure.in:

  1.8.0b5
  [[554833c58]](https://git.sudo.ws/sudo/commit/?id=554833c58)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudoers.cat, doc/sudoers.ldap.cat,
  doc/sudoers.ldap.man.in, doc/sudoers.man.in, doc/sudoreplay.cat,
  doc/sudoreplay.man.in, doc/visudo.cat, doc/visudo.man.in:

  regen
  [[6983d782c]](https://git.sudo.ws/sudo/commit/?id=6983d782c)

* doc/sudo.pod:

  Document that a sudo.conf file with no Pligin lines uses the default
  sudoers plugins.
  [[b0d0e163c]](https://git.sudo.ws/sudo/commit/?id=b0d0e163c)

* src/load\_plugins.c:

  If sudo.conf contains no Plugin lines, use the default sudoers policy
  and I/O plugins.
  [[011ba5511]](https://git.sudo.ws/sudo/commit/?id=011ba5511)

2011-02-14 Todd C. Miller

* plugins/sudoers/sudo\_nss.c:

  Avoid printing empty “Runas and Command-specific defaults for user”
  line.
  [[c3d795ff9]](https://git.sudo.ws/sudo/commit/?id=c3d795ff9)

* common/lbuf.c:

  Truncate the buffer at buf.len before printing in the non-wordwrap case.
  [[151af9302]](https://git.sudo.ws/sudo/commit/?id=151af9302)

* common/lbuf.c:

  Remove extra newline when the tty width is very small or unavailable
  [[ec00a1b58]](https://git.sudo.ws/sudo/commit/?id=ec00a1b58)

2011-02-11 Todd C. Miller

* plugins/sudoers/alias.c:

  Remove unneeded variable.
  [[289afc301]](https://git.sudo.ws/sudo/commit/?id=289afc301)

2011-02-09 Todd C. Miller

* configure, configure.in:

  Prefer getutxid over getutid
  [[d66105838]](https://git.sudo.ws/sudo/commit/?id=d66105838)

* plugins/sudoers/boottime.c:

  Include utmp.h / utmpx.h before missing.h as apparently including it
  afterwards causes a compilation problem on GNU Hurd.
  [[63449de85]](https://git.sudo.ws/sudo/commit/?id=63449de85)

2011-02-07 Todd C. Miller

* plugins/sudoers/sudoreplay.c, plugins/sudoers/toke\_util.c:

  #include “foo.h”, not <foo.h> for local includes.
  [[429465003]](https://git.sudo.ws/sudo/commit/?id=429465003)

* src/parse\_args.c:

  remove bogus XXX
  [[2d88a0988]](https://git.sudo.ws/sudo/commit/?id=2d88a0988)

* compat/mksiglist.c:

  Fix typo
  [[2603e2ce8]](https://git.sudo.ws/sudo/commit/?id=2603e2ce8)

* compat/glob.c, plugins/sudoers/ldap.c, plugins/sudoers/logging.c,
  plugins/sudoers/match.c:

  return foo not return(foo)
  [[21d8f01fa]](https://git.sudo.ws/sudo/commit/?id=21d8f01fa)

2011-02-06 Todd C. Miller

* src/exec.c:

  Remove duplicate FD\_SET of signal\_pipe[0]
  [[056cb8a5d]](https://git.sudo.ws/sudo/commit/?id=056cb8a5d)

2011-02-05 Todd C. Miller

* compat/mksiglist.c:

  Use “missing.h” not <missing.h> in generated code.
  [[c8bb84806]](https://git.sudo.ws/sudo/commit/?id=c8bb84806)

2011-02-04 Todd C. Miller

* aclocal.m4, configure:

  fix –with-iologdir=no
  [[cd6abe1d3]](https://git.sudo.ws/sudo/commit/?id=cd6abe1d3)

* aclocal.m4, configure:

  fix typo that broke –with-iologdir
  [[e78e91282]](https://git.sudo.ws/sudo/commit/?id=e78e91282)

2011-02-03 Todd C. Miller

* configure, configure.in, doc/sudo.cat, doc/sudo.man.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.man.in,
  doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/visudo.cat,
  doc/visudo.man.in:

  Bump version to 1.8.0b4
  [[7f277d155]](https://git.sudo.ws/sudo/commit/?id=7f277d155)

* NEWS:

  sync
  [[d341cad4e]](https://git.sudo.ws/sudo/commit/?id=d341cad4e)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  Attempt to clarify how users and groups interact in Runas\_Specs
  [[521ee9c53]](https://git.sudo.ws/sudo/commit/?id=521ee9c53)

* plugins/sudoers/regress/visudo/test2.out,
  plugins/sudoers/regress/visudo/test2.sh:

  Add test for quoted group that contains escaped double quotes
  [[310867e4e]](https://git.sudo.ws/sudo/commit/?id=310867e4e)

* src/exec.c, src/exec\_pty.c:

  Pass SIGUSR1/SIGUSR2 through to the child.
  [[5fc2f8f45]](https://git.sudo.ws/sudo/commit/?id=5fc2f8f45)

* src/exec\_pty.c, src/sudo\_exec.h:

  Use special values SIGCONT\_FG and SIGCONT\_BG instead of SIGUSR1 and
  SIGUSR2 to indicate whether the child should be continued in the
  foreground or background.
  [[2959d5dad]](https://git.sudo.ws/sudo/commit/?id=2959d5dad)

* src/exec.c:

  Use pid\_t not int and check the return value of kill()
  [[34a087acf]](https://git.sudo.ws/sudo/commit/?id=34a087acf)

2011-02-02 Todd C. Miller

* src/exec\_pty.c:

  Remove obsolete comment
  [[82c85571c]](https://git.sudo.ws/sudo/commit/?id=82c85571c)

* src/exec.c:

  In non-pty mode before continuing the child, make it the foreground pgrp
  if possible. Fixes resuming a shell.
  [[29f9e23c8]](https://git.sudo.ws/sudo/commit/?id=29f9e23c8)

* src/exec\_pty.c:

  If we get a signal other than SIGCHLD in the monitor, pass it directly
  to the child.
  [[8a64a8c79]](https://git.sudo.ws/sudo/commit/?id=8a64a8c79)

* src/exec.c, src/exec\_pty.c, src/sudo.h:

  Save signal state before changing handlers and restore before we execute
  the command.
  [[c18468d1a]](https://git.sudo.ws/sudo/commit/?id=c18468d1a)

2011-02-01 Todd C. Miller

* plugins/sudoers/iolog.c:

  Use a char array to map a number to a base36 digit.
  [[af2ac7ccc]](https://git.sudo.ws/sudo/commit/?id=af2ac7ccc)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.pod:

  Be clear about what versions of sudo support new LDAP attributes. Fix up
  some formatting of attribute names. Minor other tweaks.
  [[6fd9d853a]](https://git.sudo.ws/sudo/commit/?id=6fd9d853a)

2011-01-31 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  match quoted strings the same way whether in a Defaults line or as a
  user/group/netgroup name. Fixes escaped double quotes in quoted
  user/group/netgroup names.
  [[342e351d5]](https://git.sudo.ws/sudo/commit/?id=342e351d5)

* plugins/sudoers/Makefile.in:

  ‘make check’ depends on visudo and testsudoers
  [[4ce8e4b3f]](https://git.sudo.ws/sudo/commit/?id=4ce8e4b3f)

* plugins/sudoers/sudoers2ldif:

  Add sudoOrder attribute to each entry Parse LOG\_{INPUT,OUTPUT} tags
  [[68e492179]](https://git.sudo.ws/sudo/commit/?id=68e492179)

2011-01-30 Todd C. Miller

* doc/UPGRADE:

  Mention LDAP attribute compatibility status.
  [[d9c72b224]](https://git.sudo.ws/sudo/commit/?id=d9c72b224)

2011-01-28 Todd C. Miller

* README.LDAP:

  Mention phpQLAdmin
  [[3b112a17c]](https://git.sudo.ws/sudo/commit/?id=3b112a17c)

* INSTALL, NEWS, config.h.in, configure, configure.in, doc/sudoers.man.in,
  doc/sudoers.pod, plugins/sudoers/defaults.c:

  Add –disable-env-reset configure option.
  [[ed8e30cf6]](https://git.sudo.ws/sudo/commit/?id=ed8e30cf6)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  Document that sudoers\_locale also affects logging and email.
  [[180b31764]](https://git.sudo.ws/sudo/commit/?id=180b31764)

* NEWS, config.h.in, configure, configure.in, plugins/sudoers/logging.c:

  Do logging and email sending in the locale specified by the
  “sudoers\_locale” setting (“C” by default). Email send by sudo includes
  MIME headers when the sudoers locale is not “C”.
  [[807a9ca94]](https://git.sudo.ws/sudo/commit/?id=807a9ca94)

2011-01-27 Todd C. Miller

* plugins/sudoers/check.c:

  Fix indentation
  [[39b9b97db]](https://git.sudo.ws/sudo/commit/?id=39b9b97db)

2011-01-25 Todd C. Miller

* NEWS, src/parse\_args.c, src/sudo.c:

  Perform command escaping for “sudo -s” and “sudo -i” after validating
  sudoers so the sudoers entries don’t need to have all the backslashes.
  [[fc3848166]](https://git.sudo.ws/sudo/commit/?id=fc3848166)

2011-01-24 Todd C. Miller

* plugins/sudoers/logging.c:

  Prepend “list " to the command logged when “sudo -l command” is used to
  make it clear that the command was listed, not run.
  [[51515c6c0]](https://git.sudo.ws/sudo/commit/?id=51515c6c0)

* plugins/sudoers/parse.c:

  cosmetic change
  [[1f5c1dda1]](https://git.sudo.ws/sudo/commit/?id=1f5c1dda1)

* common/aix.c, common/alloc.c, common/fileops.c, common/fmt\_string.c,
  common/list.c, common/term.c, compat/fnmatch.c, compat/getcwd.c,
  compat/glob.c, compat/isblank.c, compat/memrchr.c, compat/mktemp.c,
  compat/nanosleep.c, compat/regress/glob/globtest.c, compat/snprintf.c,
  compat/strlcat.c, compat/strlcpy.c, compat/strsignal.c, compat/utimes.c,
  plugins/sample/sample\_plugin.c, plugins/sample\_group/getgrent.c,
  plugins/sample\_group/plugin\_test.c, plugins/sudoers/alias.c,
  plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb4.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/check.c,
  plugins/sudoers/defaults.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/match.c, plugins/sudoers/mon\_systrace.c,
  plugins/sudoers/parse.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/redblack.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestr.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/toke\_util.c,
  plugins/sudoers/tsgetgrpw.c, plugins/sudoers/visudo.c, src/exec\_pty.c,
  src/get\_pty.c, src/load\_plugins.c, src/parse\_args.c, src/sudo\_noexec.c,
  src/tgetpass.c:

  standardize on “return foo;” rather than “return(foo);” or “return
  (foo);”
  [[ae2f7638f]](https://git.sudo.ws/sudo/commit/?id=ae2f7638f)

* plugins/sudoers/sudoers.c:

  Do not reject sudoers file just because it is root-writable.
  [[3316ac8eb]](https://git.sudo.ws/sudo/commit/?id=3316ac8eb)

2011-01-21 Todd C. Miller

* NEWS:

  sync
  [[48990e211]](https://git.sudo.ws/sudo/commit/?id=48990e211)

* plugins/sudoers/sudo\_nss.c:

  For “sudo -U user -l” if user is not authorized on the host, say so.
  [[fbbd0603d]](https://git.sudo.ws/sudo/commit/?id=fbbd0603d)

* plugins/sudoers/ldap.c:

  In sudo\_ldap\_lookup(), always do the initial sudoers check as the
  invoking user. If we are listing another user’s privs we will do a
  separate lookup using list\_pw later.
  [[be034d5e7]](https://git.sudo.ws/sudo/commit/?id=be034d5e7)

2011-01-20 Todd C. Miller

* MANIFEST:

  add parser fill tests
  [[dbb830c79]](https://git.sudo.ws/sudo/commit/?id=dbb830c79)

* compat/regress/glob/globtest.c, compat/regress/glob/globtest.in:

  Don’t test features not supported by the bundled glob()
  [[4cc54e4b8]](https://git.sudo.ws/sudo/commit/?id=4cc54e4b8)

* Makefile.in, aclocal.m4, common/Makefile.in, common/term.c,
  compat/Makefile.in, configure.in, doc/LICENSE, doc/Makefile.in,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.pod, doc/sudoers.man.in, doc/sudoers.pod,
  include/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/check.c, plugins/sudoers/defaults.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/ldap.c,
  plugins/sudoers/match.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/toke\_util.c, src/Makefile.in,
  zlib/Makefile.in:

  Update copyright year to 2011
  [[f7f8b6867]](https://git.sudo.ws/sudo/commit/?id=f7f8b6867)

* plugins/sudoers/sudo\_nss.c:

  When listing, use separate lbufs for the defaults and the privileges and
  only print something if the number of privileges is non-zero. Fixes
  extraneous Defaults output for “sudo -U unauthorized\_user -l”.
  [[96767abfe]](https://git.sudo.ws/sudo/commit/?id=96767abfe)

* plugins/sudoers/ldap.c:

  Stash pointer to user group vector in LDAP handle and only reuse the
  query if it has not changed. We always allocate a new buffer when we
  reset the group vector so a simple pointer check is sufficient.
  [[215500bb5]](https://git.sudo.ws/sudo/commit/?id=215500bb5)

* plugins/sudoers/sudo\_nss.c:

  Check initgroups() return value.
  [[165dcfa37]](https://git.sudo.ws/sudo/commit/?id=165dcfa37)

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/parser/check\_fill.c:

  Add tests for the fill functions in toke\_util.c
  [[7cbd1ff72]](https://git.sudo.ws/sudo/commit/?id=7cbd1ff72)

2011-01-19 Todd C. Miller

* plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c:

  fix copyright year
  [[79dff677d]](https://git.sudo.ws/sudo/commit/?id=79dff677d)

* NEWS:

  sync
  [[6565899ba]](https://git.sudo.ws/sudo/commit/?id=6565899ba)

2011-01-18 Todd C. Miller

* common/term.c:

  Clear, don’t set, OPOST in c\_oflag as was intended in 506ad5ae9b4e.
  [[4f953d839]](https://git.sudo.ws/sudo/commit/?id=4f953d839)

2011-01-14 Todd C. Miller

* mkpkg, sudo.pp:

  Add Requires line for audit-libs >= 1.4 for RHEL5+
  [[5b5a173ff]](https://git.sudo.ws/sudo/commit/?id=5b5a173ff)

* pp:

  sync with git version
  [[add7f327e]](https://git.sudo.ws/sudo/commit/?id=add7f327e)

2011-01-13 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  fix typo
  [[0726c8fe2]](https://git.sudo.ws/sudo/commit/?id=0726c8fe2)

2011-01-12 Todd C. Miller

* NEWS:

  Update for sudo 1.7.4p5
  [[3792df2bd]](https://git.sudo.ws/sudo/commit/?id=3792df2bd)

* doc/schema.OpenLDAP, doc/schema.iPlanet:

  Add sudoNotBefore and sudoNotAfter attributes as optional attributes to
  the sudoRole object class. From Andreas Mueller
  [[12895f77a]](https://git.sudo.ws/sudo/commit/?id=12895f77a)

2011-01-11 Todd C. Miller

* NEWS:

  Mention “sudo -g group” password check fix.
  [[5b0a50d51]](https://git.sudo.ws/sudo/commit/?id=5b0a50d51)

* plugins/sudoers/sudoers.c:

  Fix “sudo -g” support in the sudoers module.
  [[e7a4529cf]](https://git.sudo.ws/sudo/commit/?id=e7a4529cf)

* plugins/sudoers/check.c:

  If the user is running sudo as himself but as a different group we need
  to prompt for a password.
  [[2d74e9567]](https://git.sudo.ws/sudo/commit/?id=2d74e9567)

2011-01-10 Todd C. Miller

* NEWS, config.h.in, configure, configure.in, doc/sudoers.ldap.cat,
  doc/sudoers.ldap.man.in, doc/sudoers.ldap.pod, plugins/sudoers/ldap.c:

  Add support for TIMEOUT in ldap.conf, mapping to the OpenLDAP
  LDAP\_OPT\_TIMEOUT. There is no corresponding option for mozilla-derived
  LDAP SDKs but we can pass the timeout parameter to ldap\_search\_ext\_s()
  or ldap\_search\_st() when possible.
  [[49409b7c5]](https://git.sudo.ws/sudo/commit/?id=49409b7c5)

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in:

  regen
  [[a628fee98]](https://git.sudo.ws/sudo/commit/?id=a628fee98)

* NEWS, doc/sudoers.ldap.pod, plugins/sudoers/ldap.c:

  Add NETWORK\_TIMEOUT as an alias for BIND\_TIMELIMIT for compatibility
  with OpenLDAP ldap.conf files.
  [[823e81272]](https://git.sudo.ws/sudo/commit/?id=823e81272)

* plugins/sudoers/pwutil.c:

  If user has no supplementary groups, fall back on checking the group
  file expliticly.
  [[8a043ca56]](https://git.sudo.ws/sudo/commit/?id=8a043ca56)

2011-01-08 Todd C. Miller

* plugins/sudoers/toke.h, plugins/sudoers/toke\_util.c:

  constify
  [[e63849afb]](https://git.sudo.ws/sudo/commit/?id=e63849afb)

* plugins/sudoers/toke.c, plugins/sudoers/toke.h, plugins/sudoers/toke.l:

  Move fill macro to toke.h
  [[4cc6322b4]](https://git.sudo.ws/sudo/commit/?id=4cc6322b4)

* MANIFEST, plugins/sudoers/Makefile.in, plugins/sudoers/toke.c,
  plugins/sudoers/toke.h, plugins/sudoers/toke.l,
  plugins/sudoers/toke\_util.c:

  Split tokenizer utility functions out into toke\_util.c
  [[400b6ffe2]](https://git.sudo.ws/sudo/commit/?id=400b6ffe2)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l:

  ANSIfy
  [[866ffd0bd]](https://git.sudo.ws/sudo/commit/?id=866ffd0bd)

2011-01-07 Todd C. Miller

* MANIFEST:

  sync
  [[385eeeb13]](https://git.sudo.ws/sudo/commit/?id=385eeeb13)

* plugins/sudoers/Makefile.in:

  Add visudo tests to check target
  [[e8cc22c0c]](https://git.sudo.ws/sudo/commit/?id=e8cc22c0c)

* compat/Makefile.in, compat/regress/fnmatch/fnm\_test.c,
  compat/regress/fnmatch/fnm\_test.in, compat/regress/glob/files,
  compat/regress/glob/globtest.c, compat/regress/glob/globtest.in:

  Add my regress tests for fnmatch() and glob() from OpenBSD.
  [[ac857d6e9]](https://git.sudo.ws/sudo/commit/?id=ac857d6e9)

* plugins/sudoers/regress/testsudoers/test1.sh,
  plugins/sudoers/regress/visudo/test1.ok,
  plugins/sudoers/regress/visudo/test1.sh:

  Add regress test for command tags using visudo -c
  [[460f760ca]](https://git.sudo.ws/sudo/commit/?id=460f760ca)

* plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/testsudoers/test1.ok,
  plugins/sudoers/regress/testsudoers/test1.sh:

  Add support for regress tests using testsudoers
  [[b679e0319]](https://git.sudo.ws/sudo/commit/?id=b679e0319)

* plugins/sudoers/testsudoers.c:

  Need to set user\_name explicitly due to internal changes made when
  converting sudoers to a plugin.
  [[217d29611]](https://git.sudo.ws/sudo/commit/?id=217d29611)

2011-01-06 Todd C. Miller

* MANIFEST, Makefile.in, common/Makefile.in, compat/Makefile.in,
  doc/Makefile.in, include/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/regress/iolog\_path/check\_iolog\_path.c,
  plugins/sudoers/regress/iolog\_path/data, src/Makefile.in,
  zlib/Makefile.in:

  Add regression tests for iolog\_path()
  [[1defd7b45]](https://git.sudo.ws/sudo/commit/?id=1defd7b45)

* Makefile.in, common/Makefile.in, compat/Makefile.in, doc/Makefile.in,
  include/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  src/Makefile.in, zlib/Makefile.in:

  Add support for “make Makefile” to regenerate Makefile from Makefile.in
  [[f8de3f632]](https://git.sudo.ws/sudo/commit/?id=f8de3f632)

* plugins/sudoers/iolog\_path.c:

  Quiest a bogus compiler warning.
  [[d2596e3f7]](https://git.sudo.ws/sudo/commit/?id=d2596e3f7)

2011-01-05 Todd C. Miller

* plugins/sudoers/iolog\_path.c:

  Protect call to setlocale() with HAVE\_SETLOCALE
  [[f09bbcb6b]](https://git.sudo.ws/sudo/commit/?id=f09bbcb6b)

2011-01-04 Todd C. Miller

* MANIFEST:

  mkstemps.c was renamed mktemp.c
  [[42f7a6c25]](https://git.sudo.ws/sudo/commit/?id=42f7a6c25)

* NEWS:

  Update from 1.7 branch
  [[f3552b061]](https://git.sudo.ws/sudo/commit/?id=f3552b061)

* Makefile.in:

  Use “mv -f” when regenerating ChangeLog
  [[d6013eb96]](https://git.sudo.ws/sudo/commit/?id=d6013eb96)

* plugins/sudoers/match.c:

  Fix NULL dereference with “sudo -g group” when the sudoers rule has no
  runas user or group listed. Fixes RedHat bug Bug 667103.
  [[b92b745ea]](https://git.sudo.ws/sudo/commit/?id=b92b745ea)

2011-01-03 Todd C. Miller

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Correct the default sudo.conf example
  [[33201c04e]](https://git.sudo.ws/sudo/commit/?id=33201c04e)

2010-12-31 Todd C. Miller

* plugins/sudoers/iolog\_path.c:

  Reset slashp if we allocate a new buffer for strftime()
  [[b76c79885]](https://git.sudo.ws/sudo/commit/?id=b76c79885)

* plugins/sudoers/iolog\_path.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Add extra out parameter to expand\_iolog\_path() to allow the caller to
  split the path into dir and file components if needed.
  [[1bb3518b3]](https://git.sudo.ws/sudo/commit/?id=1bb3518b3)

2010-12-30 Todd C. Miller

* plugins/sudoers/iolog.c:

  mkdir\_iopath() returns size\_t now that it uses strlcpy() and not
  snprintf()
  [[755e3ef0a]](https://git.sudo.ws/sudo/commit/?id=755e3ef0a)

* plugins/sudoers/iolog.c, plugins/sudoers/iolog\_path.c:

  Trim leading slashes from iolog\_file and trailing slashes from iolog\_dir
  [[7f580397e]](https://git.sudo.ws/sudo/commit/?id=7f580397e)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod,
  plugins/sudoers/iolog.c, plugins/sudoers/iolog\_path.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Pass a single I/O log file name in command\_details instead of separate
  dir + file parameters.
  [[25036d7a7]](https://git.sudo.ws/sudo/commit/?id=25036d7a7)

* plugins/sudoers/sudoreplay.c:

  change an error() to errorx()
  [[2fb085dfa]](https://git.sudo.ws/sudo/commit/?id=2fb085dfa)

* plugins/sudoers/iolog.c:

  Add missing cwd line to I/O log info file that got dropped when
  iolog\_deserialize\_info() was added
  [[83de9e28f]](https://git.sudo.ws/sudo/commit/?id=83de9e28f)

2010-12-29 Todd C. Miller

* plugins/sudoers/iolog.c:

  Avoid relying on globals filled in by the sudoers policy module for the
  sudoers I/O log module. The I/O log open function now pulls the bits it
  needs out of user\_info and command\_info.
  [[fec059a89]](https://git.sudo.ws/sudo/commit/?id=fec059a89)

* plugins/sudoers/iolog.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  If no iolog file is specified by the policy plugin, use io\_nextid() to
  determine the next file in the sequence.
  [[97b7ae889]](https://git.sudo.ws/sudo/commit/?id=97b7ae889)

2010-12-28 Todd C. Miller

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Document iolog\_compress in command\_info
  [[3f6f61f85]](https://git.sudo.ws/sudo/commit/?id=3f6f61f85)

* plugins/sudoers/iolog.c, plugins/sudoers/sudoers.c:

  Add support for the iolog\_compress variable in command\_info.
  [[02ed3d5b3]](https://git.sudo.ws/sudo/commit/?id=02ed3d5b3)

* plugins/sudoers/iolog.c, plugins/sudoers/sudoers.c:

  Add sigsetjmp() calls to all plugin entry points just to be safe.
  [[bff14f60e]](https://git.sudo.ws/sudo/commit/?id=bff14f60e)

* src/sudo.c, src/sudo.h:

  Don’t need iolog variables in struct command\_details, they are for the
  I/O log plugins to handle.
  [[5966b67dd]](https://git.sudo.ws/sudo/commit/?id=5966b67dd)

2010-12-27 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  Document use of mkdtemp() for iolog path teplates
  [[21dd6af79]](https://git.sudo.ws/sudo/commit/?id=21dd6af79)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudoers.cat, doc/sudoers.ldap.cat,
  doc/sudoers.ldap.man.in, doc/sudoers.man.in, doc/sudoreplay.cat,
  doc/sudoreplay.man.in, doc/visudo.cat, doc/visudo.man.in:

  regen
  [[e3cd512bf]](https://git.sudo.ws/sudo/commit/?id=e3cd512bf)

* doc/sudo\_plugin.pod, doc/sudoers.pod:

  Document iolog\_file and supported escape sequences for sudoers. Clarify
  that iolog\_file can contain directories.
  [[05807cf5e]](https://git.sudo.ws/sudo/commit/?id=05807cf5e)

* compat/Makefile.in, configure, configure.in:

  Fix building of mkstemps/mkdtemp replacements.
  [[b8499baaa]](https://git.sudo.ws/sudo/commit/?id=b8499baaa)

* compat/mktemp.c, config.h.in, configure, configure.in,
  include/missing.h:

  Provide mkdtemp() for systems without it.
  [[5cf56a77e]](https://git.sudo.ws/sudo/commit/?id=5cf56a77e)

* plugins/sudoers/iolog\_path.c:

  Fix typo
  [[36d8fbb90]](https://git.sudo.ws/sudo/commit/?id=36d8fbb90)

* plugins/sudoers/iolog.c:

  Only use mkdtemp() if the path ends in at least 6 Xs since otherwise
  glibc mkdtemp() returns EINVAL.
  [[4c1aecd48]](https://git.sudo.ws/sudo/commit/?id=4c1aecd48)

* plugins/sudoers/Makefile.in, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/iolog.c,
  plugins/sudoers/iolog\_path.c, plugins/sudoers/plugin\_error.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Allow sudoers to specify the iolog file in addition to the iolog dir.
  Add escape sequence support to iolog file and dir: sequence number,
  user, group, runas\_user, runas\_group, hostname and command in addition
  to any escape sequence recognized by strftime(3).
  [[fba58fa3f]](https://git.sudo.ws/sudo/commit/?id=fba58fa3f)

* plugins/sudoers/iolog.c:

  Add missing sigsetjmp() call in I/O plugin open function. Fixes a crash
  when the I/O plugin calls error(), errorx() or log\_error().
  [[524021a37]](https://git.sudo.ws/sudo/commit/?id=524021a37)

2010-12-21 Todd C. Miller

* doc/sudo\_plugin.pod, plugins/sudoers/iolog.c, plugins/sudoers/sudoers.c:
  Give the policy module fine-grained control over what the I/O plugin
  logs.
  [[5d59c10b9]](https://git.sudo.ws/sudo/commit/?id=5d59c10b9)

* common/term.c:

  Clear OPOST from c\_oflag like we used to. Fixes screen-based editors
  such as vi.
  [[6505d10cc]](https://git.sudo.ws/sudo/commit/?id=6505d10cc)

* doc/sudoers.pod:

  Clarify umask option description. From Reuben Thomas.
  [[ad41fb497]](https://git.sudo.ws/sudo/commit/?id=ad41fb497)

2010-12-20 Todd C. Miller

* doc/sudoers.ldap.pod, plugins/sudoers/ldap.c:

  Pick last match in LDAP sudoers too
  [[93e963584]](https://git.sudo.ws/sudo/commit/?id=93e963584)

* doc/sudo\_plugin.pod:

  Document iolog\_file, iolog\_dir and use\_pty
  [[4294e4db8]](https://git.sudo.ws/sudo/commit/?id=4294e4db8)

* plugins/sample/sample\_plugin.c, plugins/sudoers/iolog.c,
  plugins/sudoers/sudoers.c:

  Adapt plugins to version I/O logging ABI 1.1
  [[a10f21679]](https://git.sudo.ws/sudo/commit/?id=a10f21679)

* src/exec.c, src/sudo.h:

  Add use\_pty command\_info flag for policies to indicate that a pty should
  be allocated even if no I/O logging is performed.
  [[c833ff02b]](https://git.sudo.ws/sudo/commit/?id=c833ff02b)

* src/sudo.c:

  Add remaining plugin convenience functions
  [[c1a22ff15]](https://git.sudo.ws/sudo/commit/?id=c1a22ff15)

* include/sudo\_plugin.h, src/sudo.c, src/sudo.h, src/sudo\_plugin\_int.h:

  Change I/O log API to pass in command info to the I/O log open function.
  Add iolog\_file and iolog\_dir parameters to command info. This allows the
  policy plugin to specify the I/O log pathname. Add convenience functions
  for calling plugin functions that handle ABI backwards compatibility.
  [[9948dae70]](https://git.sudo.ws/sudo/commit/?id=9948dae70)

* compat/dlopen.c:

  Remove useless cast
  [[30797ab8a]](https://git.sudo.ws/sudo/commit/?id=30797ab8a)

2010-12-17 Todd C. Miller

* configure, configure.in:

  Bump version to 1.8.0b3
  [[6649afddb]](https://git.sudo.ws/sudo/commit/?id=6649afddb)

2010-12-13 Todd C. Miller

* configure.in:

  Remove extraneous newline
  [[aa8a996d5]](https://git.sudo.ws/sudo/commit/?id=aa8a996d5)

2010-12-10 Todd C. Miller

* doc/sudoers.pod, plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/iolog.c:

  Make I/O log dir configurable.
  [[b2a698460]](https://git.sudo.ws/sudo/commit/?id=b2a698460)

* aclocal.m4, configure, configure.in, doc/sudoers.pod:

  Rename io\_logdir to iolog\_dir
  [[6c2368851]](https://git.sudo.ws/sudo/commit/?id=6c2368851)

2010-12-07 Todd C. Miller

* pp:

  Add missing ‘\*’ that prevented the generic ELF case from matching.
  [[14d792dff]](https://git.sudo.ws/sudo/commit/?id=14d792dff)

* pp:

  If file(1) can’t identify the ELF binary type, try readelf(1).
  [[d734f6b41]](https://git.sudo.ws/sudo/commit/?id=d734f6b41)

2010-11-30 Todd C. Miller

* plugins/sudoers/auth/kerb4.c, plugins/sudoers/check.c,
  plugins/sudoers/env.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/sudoers.c, src/sudo.c:

  Use %u to print uid/gid, not %lu and adjust casts to match.
  [[4527bdd9b]](https://git.sudo.ws/sudo/commit/?id=4527bdd9b)

* doc/sudoers.ldap.pod:

  Clarify ordering of entries and attributes.
  [[3f605ebfa]](https://git.sudo.ws/sudo/commit/?id=3f605ebfa)

* doc/sudoers.ldap.pod:

  Fix typo and editing goof.
  [[23df0b6fa]](https://git.sudo.ws/sudo/commit/?id=23df0b6fa)

* doc/schema.ActiveDirectory, doc/schema.OpenLDAP, doc/schema.iPlanet,
  doc/sudoers.ldap.pod:

  Merge in ordered LDAP entry support from Andreas Mueller.
  [[feb02ed40]](https://git.sudo.ws/sudo/commit/?id=feb02ed40)

* plugins/sudoers/ldap.c:

  Make sure we don’t dereference a NULL handle.
  [[7e59d4c5c]](https://git.sudo.ws/sudo/commit/?id=7e59d4c5c)

2010-11-24 Todd C. Miller

* pp:

  Add support for RHEL 6 file modes that include a trailing dot on files
  with an SELinux security context
  [[7e087f09d]](https://git.sudo.ws/sudo/commit/?id=7e087f09d)

2010-11-23 Todd C. Miller

* src/sudo.c:

  exec\_setup() does not need to setuid(0), the Ubuntu issue was in the
  sudoers module.
  [[d0d0e1b9f]](https://git.sudo.ws/sudo/commit/?id=d0d0e1b9f)

* plugins/sudoers/sudoers.c:

  create\_admin\_success\_flag() should use restore\_perms() rather than
  set\_perms() to restore the uid.
  [[8f4b21521]](https://git.sudo.ws/sudo/commit/?id=8f4b21521)

* src/sudo.c:

  In exec\_setup() call setuid(0) to make certain the subsequent uid and
  gid changes will succeed. Fixes a problem on Ubuntu.
  [[d39747e6a]](https://git.sudo.ws/sudo/commit/?id=d39747e6a)

* src/sudo\_edit.c:

  Error out if we cannot change to root’s uid so we catch the failure
  early.
  [[d869ca1f9]](https://git.sudo.ws/sudo/commit/?id=d869ca1f9)

2010-11-22 Todd C. Miller

* doc/sudoers.pod:

  fix typo; from Michael T Hunter
  [[bb4a8a4dc]](https://git.sudo.ws/sudo/commit/?id=bb4a8a4dc)

* plugins/sudoers/match.c:

  In sudoedit mode, assume command line arguments are paths and pass
  FNM\_PATHNAME to fnmatch().
  [[70cf50fd2]](https://git.sudo.ws/sudo/commit/?id=70cf50fd2)

2010-11-20 Todd C. Miller

* configure, configure.in:

  Add workaround for an error in sys/types.h on HP-UX 11.23 when large
  file support is enabled. Defining \_XOPEN\_SOURCE\_EXTENDED avoids the
  broken bits of the header file.
  [[81da78ff3]](https://git.sudo.ws/sudo/commit/?id=81da78ff3)

* aclocal.m4:

  Fix SUDO\_MAILDIR usage of AC\_LANG\_PROGRAM
  [[5bd089776]](https://git.sudo.ws/sudo/commit/?id=5bd089776)

* sudo.pp:

  For Tru64, strip off beta version.
  [[494bd14de]](https://git.sudo.ws/sudo/commit/?id=494bd14de)

* MANIFEST, plugins/sudoers/testsudoers.c, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/tsgetgrpw.h:

  Avoid conflicts with system definitions in grp.h and pwd.h
  [[5a0f2164e]](https://git.sudo.ws/sudo/commit/?id=5a0f2164e)

* zlib/gzguts.h:

  Include stdio.h after zlib.h, not before. We need the large file defines
  to come first.
  [[5a4762b2b]](https://git.sudo.ws/sudo/commit/?id=5a4762b2b)

2010-11-19 Todd C. Miller

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in:

  regen
  [[901ca2a12]](https://git.sudo.ws/sudo/commit/?id=901ca2a12)

* Makefile.in:

  Don’t clean ChangeLog
  [[45da48440]](https://git.sudo.ws/sudo/commit/?id=45da48440)

* plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Add prototype for cleanup()
  [[51f401fa3]](https://git.sudo.ws/sudo/commit/?id=51f401fa3)

2010-11-18 Todd C. Miller

* plugins/sudoers/group\_plugin.c:

  Avoid deferencing group\_plugin if it is NULL in group\_plugin\_query().
  This should not happen.
  [[c73306983]](https://git.sudo.ws/sudo/commit/?id=c73306983)

* plugins/sudoers/group\_plugin.c:

  group plugin init function return TRUE when successful
  [[4b2fb225c]](https://git.sudo.ws/sudo/commit/?id=4b2fb225c)

2010-11-17 Todd C. Miller

* plugins/sudoers/ldap.c:

  Enlarge the array of entry wrappers int blocks of 100 entries to save on
  allocation time. From Andreas Mueller
  [[ef5f73a49]](https://git.sudo.ws/sudo/commit/?id=ef5f73a49)

* plugins/sudoers/ldap.c:

  Add back call to sudo\_ldap\_timefilter() in sudo\_ldap\_build\_pass2() that
  was mistakenly dropped.
  [[f9353d95c]](https://git.sudo.ws/sudo/commit/?id=f9353d95c)

2010-11-16 Todd C. Miller

* doc/TROUBLESHOOTING:

  Mention that sudo needs “ar” to build.
  [[ab651135d]](https://git.sudo.ws/sudo/commit/?id=ab651135d)

* configure, configure.in:

  Fail with a more useful error if “ar” is not found.
  [[4c2dcaa10]](https://git.sudo.ws/sudo/commit/?id=4c2dcaa10)

2010-11-14 Todd C. Miller

* plugins/sudoers/ldap.c:

  Merge in ordered LDAP entry support from Andreas Mueller and add local
  changes from the 1.7 branch.
  [[8940f361e]](https://git.sudo.ws/sudo/commit/?id=8940f361e)

2010-11-12 Todd C. Miller

* doc/schema.ActiveDirectory, doc/schema.OpenLDAP, doc/schema.iPlanet,
  doc/sudoers.ldap.pod, plugins/sudoers/ldap.c:

  Add timed entry support from Andreas Mueller.
  [[2b0fca31c]](https://git.sudo.ws/sudo/commit/?id=2b0fca31c)

* plugins/sudoers/group\_plugin.c:

  Don’t try to unload if group\_plugin is NULL. Don’t call dlclose() if
  group\_handle is NULL
  [[82453cfde]](https://git.sudo.ws/sudo/commit/?id=82453cfde)

* plugins/sudoers/sudoers.h:

  It is now plugin\_cleanup(), not cleanup()
  [[26d71ded7]](https://git.sudo.ws/sudo/commit/?id=26d71ded7)

* plugins/sudoers/logging.c, plugins/sudoers/sudoers.c:

  Call plugin\_cleanup(), not cleanup()
  [[5536ea49f]](https://git.sudo.ws/sudo/commit/?id=5536ea49f)

2010-11-11 Todd C. Miller

* plugins/sudoers/ldap.c:

  Use efree() not free() and remove malloc.h include since we never
  directly call malloc() or free().
  [[8597c3919]](https://git.sudo.ws/sudo/commit/?id=8597c3919)

2010-11-09 Todd C. Miller

* sudo.pp:

  set PSTAMP for Solaris and move the backend-specific bits to their own
  %if [xxx] %endif blocks in %set.
  [[4733872cb]](https://git.sudo.ws/sudo/commit/?id=4733872cb)

* pp:

  sync with git repo
  [[f6c8ba107]](https://git.sudo.ws/sudo/commit/?id=f6c8ba107)

* configure, configure.in:

  Only substitute file zlib files when using the builtin zlib
  [[d4e323c11]](https://git.sudo.ws/sudo/commit/?id=d4e323c11)

* common/Makefile.in, compat/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  src/Makefile.in, zlib/Makefile.in:

  Give up on using VPATH to find sources as it is implemented
  inconsistenly in different versions of make.
  [[47323843a]](https://git.sudo.ws/sudo/commit/?id=47323843a)

* plugins/sudoers/Makefile.in, plugins/sudoers/getdate.c,
  plugins/sudoers/gram.c, plugins/sudoers/toke.c:

  Include config.h before any other includes to make sure we get the right
  value for \_FILE\_OFFSET\_BITS.
  [[39d1167f3]](https://git.sudo.ws/sudo/commit/?id=39d1167f3)

* MANIFEST:

  Add zlib
  [[aef91eb1d]](https://git.sudo.ws/sudo/commit/?id=aef91eb1d)

* zlib/Makefile.in:

  Add missing targets
  [[19c1675be]](https://git.sudo.ws/sudo/commit/?id=19c1675be)

* src/Makefile.in:

  g/c unused $(GENERATED)
  [[c6965a530]](https://git.sudo.ws/sudo/commit/?id=c6965a530)

2010-11-08 Todd C. Miller

* plugins/sudoers/group\_plugin.c:

  Zero out group\_plugin on unload just to be safe.
  [[452d8765b]](https://git.sudo.ws/sudo/commit/?id=452d8765b)

* plugins/sudoers/group\_plugin.c:

  Unload group plugin if its init function fails.
  [[da35e5f42]](https://git.sudo.ws/sudo/commit/?id=da35e5f42)

* src/sudo.c:

  Only chdir to cwd if it is different from the current cwd or there is a
  new root (chroot).
  [[01dcbfce7]](https://git.sudo.ws/sudo/commit/?id=01dcbfce7)

* configure, configure.in, doc/sudo.cat, doc/sudo.man.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudoers.ldap.cat,
  doc/sudoers.ldap.man.in, doc/visudo.cat, doc/visudo.man.in:

  Bump version to 1.8.0b2
  [[852882750]](https://git.sudo.ws/sudo/commit/?id=852882750)

2010-10-28 Todd C. Miller

* INSTALL:

  Better –enable-zlib description
  [[d54dd245a]](https://git.sudo.ws/sudo/commit/?id=d54dd245a)

* mkpkg:

  Use system zlib on Linux Let configure decide on Solaris For all others,
  use builtin zlib
  [[1c0849853]](https://git.sudo.ws/sudo/commit/?id=1c0849853)

* zlib/zconf.h.in:

  Add large file support.
  [[3591af576]](https://git.sudo.ws/sudo/commit/?id=3591af576)

* config.h.in:

  Add large file support.
  [[6247b8546]](https://git.sudo.ws/sudo/commit/?id=6247b8546)

* Makefile.in, configure, configure.in, doc/LICENSE, doc/license.pod,
  zlib/Makefile.in, zlib/adler32.c, zlib/compress.c, zlib/crc32.c,
  zlib/crc32.h, zlib/deflate.c, zlib/deflate.h, zlib/gzclose.c,
  zlib/gzguts.h, zlib/gzlib.c, zlib/gzread.c, zlib/gzwrite.c,
  zlib/infback.c, zlib/inffast.c, zlib/inffast.h, zlib/inffixed.h,
  zlib/inflate.c, zlib/inflate.h, zlib/inftrees.c, zlib/inftrees.h,
  zlib/trees.c, zlib/trees.h, zlib/uncompr.c, zlib/zconf.h.in,
  zlib/zlib.h, zlib/zutil.c, zlib/zutil.h:

  Add local copy of zlib for systems that lack it.
  [[361cd2907]](https://git.sudo.ws/sudo/commit/?id=361cd2907)

2010-10-15 Todd C. Miller

* src/exec.c:

  If perform\_io() fails, kill the child before exiting so it doesn’t
  complain about connection reset. We can get an I/O error if, for
  example, and we get EIO reading from stdin.
  [[a11e4c8d7]](https://git.sudo.ws/sudo/commit/?id=a11e4c8d7)

2010-10-12 Todd C. Miller

* plugins/sudoers/sudoers.c, src/sudo.c:

  Fix complilation on systems with set\_auth\_parameters() Sprinkle volatile
  to quiet warnings from gcc 2.8.0
  [[93d2420de]](https://git.sudo.ws/sudo/commit/?id=93d2420de)

* compat/dlfcn.h, compat/dlopen.c:

  Avoid potential namespace issues with dlopen() emulation.
  [[e4abd86c6]](https://git.sudo.ws/sudo/commit/?id=e4abd86c6)

* MANIFEST:

  sync
  [[609c5db8f]](https://git.sudo.ws/sudo/commit/?id=609c5db8f)

* plugins/sudoers/interfaces.c:

  Use INADDR\_NONE instead of casting -1 to in\_addr\_t (which may not
  exist).
  [[c615ca742]](https://git.sudo.ws/sudo/commit/?id=c615ca742)

* Makefile.in:

  Mark ChangeLog as PHONY Don’t overwrite ChangeLog if we can’t run hg
  [[a178a430a]](https://git.sudo.ws/sudo/commit/?id=a178a430a)

* configure, configure.in:

  HP-UX 10.20 libc has an incompatible getline
  [[49d1142df]](https://git.sudo.ws/sudo/commit/?id=49d1142df)

* plugins/sudoers/visudo.c:

  Quiet an HP-UX compiler warning.
  [[1e01f2b7a]](https://git.sudo.ws/sudo/commit/?id=1e01f2b7a)

* configure, configure.in:

  Check for vi even with –with-editor specified; the sample plugin needs
  it.
  [[56bdfe941]](https://git.sudo.ws/sudo/commit/?id=56bdfe941)

2010-10-11 Todd C. Miller

* compat/dlopen.c:

  Fix remaining syntax errors.
  [[070446bc3]](https://git.sudo.ws/sudo/commit/?id=070446bc3)

* src/Makefile.in:

  sudo binary depends on the libtool-generated libs
  [[298d0cbe2]](https://git.sudo.ws/sudo/commit/?id=298d0cbe2)

* plugins/sudoers/group\_plugin.c, src/load\_plugins.c:

  Use HAVE\_DLOPEN instead of HAVE\_DLFCN\_H when determining whether to
  include the local or system dlfcn.h
  [[86a4a5232]](https://git.sudo.ws/sudo/commit/?id=86a4a5232)

* pp:

  Don’t use run\_as\_superuser=false on HP-UX
  [[798fc86a9]](https://git.sudo.ws/sudo/commit/?id=798fc86a9)

* src/net\_ifs.c:

  Use memset() instead of zero\_bytes() since we don’t include sudoers.h
  [[3ff8d5e78]](https://git.sudo.ws/sudo/commit/?id=3ff8d5e78)

* plugins/sudoers/interfaces.c:

  Fix pasto; AF\_INET not AF\_INET6
  [[06b0aa118]](https://git.sudo.ws/sudo/commit/?id=06b0aa118)

* compat/dlopen.c:

  Actually call shl\_load()
  [[de6853848]](https://git.sudo.ws/sudo/commit/?id=de6853848)

* pp:

  Update from git repo. Debian: version numbers now compliant with policy
  section 5.6.12 HP-UX: minimal changes needed to work on HP-UX 10.20
  [[e2e5cfe18]](https://git.sudo.ws/sudo/commit/?id=e2e5cfe18)

* configure, configure.in:

  Fix dlopen() detection for systems where dlopen() is in a separate
  library.
  [[443d18b11]](https://git.sudo.ws/sudo/commit/?id=443d18b11)

* plugins/sudoers/auth/pam.c:

  If pam\_acct\_mgmt() returns PAM\_AUTH\_ERR print a (hopefully) more useful
  message and return AUTH\_FATAL so sudo does not keep trying to validate
  the user.
  [[6a5205414]](https://git.sudo.ws/sudo/commit/?id=6a5205414)

* src/preload.c:

  sudo\_preload\_table is an array
  [[5fc7233d2]](https://git.sudo.ws/sudo/commit/?id=5fc7233d2)

* compat/dlopen.c:

  Quiet a compiler warning and fix sudo\_preload\_table external definition.
  [[86d3e4bf0]](https://git.sudo.ws/sudo/commit/?id=86d3e4bf0)

* compat/dlfcn.h:

  Fix multiple inclusion guard in dlfcn.h and fix dlerror() prototype.
  [[dc327471b]](https://git.sudo.ws/sudo/commit/?id=dc327471b)

* plugins/sudoers/group\_plugin.c:

  Make this compile correctly when no dlopen is available.
  [[751f597b2]](https://git.sudo.ws/sudo/commit/?id=751f597b2)

2010-10-07 Todd C. Miller

* plugins/sudoers/check.c:

  Having a timestamp file defined is no longer indicative of tty tickets
  being enabled. Check def\_tty\_tickets directly.
  [[66ea39985]](https://git.sudo.ws/sudo/commit/?id=66ea39985)

* src/exec\_pty.c, src/sudo.h, src/ttysize.c:

  Fix TCGETWINSZ compat.
  [[e2f253e51]](https://git.sudo.ws/sudo/commit/?id=e2f253e51)

2010-10-02 Todd C. Miller

* src/exec\_pty.c, src/ttysize.c:

  Prefer newer TIOCGWINSZ ioctl to old TIOCGSIZE
  [[1a4990f57]](https://git.sudo.ws/sudo/commit/?id=1a4990f57)

2010-10-01 Todd C. Miller

* plugins/sudoers/sudoers.c, src/sudo.c:

  Move set\_project() from sudoers module into sudo proper.
  [[6b4fe798d]](https://git.sudo.ws/sudo/commit/?id=6b4fe798d)

* configure, configure.in:

  Fix typo and regenerate
  [[e59fa31ba]](https://git.sudo.ws/sudo/commit/?id=e59fa31ba)

* plugins/sudoers/ldap.c:

  When iterating over returned LDAP entries, keep looking at remaining
  matches even if we have a positive match. This catches negative matches
  that may exist in other entries and more closely match the sudoers file
  behavior.
  [[a627c60de]](https://git.sudo.ws/sudo/commit/?id=a627c60de)

* pp:

  Add support for multiple package instances on Solaris.
  [[acaceb424]](https://git.sudo.ws/sudo/commit/?id=acaceb424)

* src/exec.c:

  Add missing signal\_pipe[0] to fdsr for the non-pty case.
  [[413b7b55d]](https://git.sudo.ws/sudo/commit/?id=413b7b55d)

* mkpkg:

  Add –with-project for Solaris
  [[d93df4e87]](https://git.sudo.ws/sudo/commit/?id=d93df4e87)

* README:

  Need ar and ranlib too
  [[2bae9e2cb]](https://git.sudo.ws/sudo/commit/?id=2bae9e2cb)

2010-09-27 Todd C. Miller

* plugins/sudoers/env.c:

  Preserve ODMDIR environment variable by default on AIX.
  [[614e2a642]](https://git.sudo.ws/sudo/commit/?id=614e2a642)

2010-09-26 Todd C. Miller

* Makefile.in, compat/Makefile.in, compat/dlfcn.h, compat/dlopen.c,
  config.h.in, configure, configure.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/group\_plugin.c, plugins/sudoers/plugin\_error.c,
  plugins/sudoers/sudoers.c, src/Makefile.in, src/load\_plugins.c,
  src/preload.c:

  Add dlopen() emulation for systems without it. For HP-UX 10, emulate
  using shl\_load(). For others, link sudoers plugin statically and use a
  lookup table to emulate dlsym().
  [[f538ed4e3]](https://git.sudo.ws/sudo/commit/?id=f538ed4e3)

2010-09-24 Todd C. Miller

* compat/fnmatch.c, compat/glob.c, compat/mksiglist.c, compat/nanosleep.c,
  compat/utimes.c:

  When including compat headers, use the compat dir as part of the path so
  we are sure to get the correct header.
  [[b0b57fbef]](https://git.sudo.ws/sudo/commit/?id=b0b57fbef)

2010-09-21 Todd C. Miller

* plugins/sudoers/linux\_audit.c:

  Ignore ECONNREFUSED from audit\_log\_user\_command() which will occur if
  auditd is not running.
  [[590eed3bd]](https://git.sudo.ws/sudo/commit/?id=590eed3bd)

2010-09-17 Todd C. Miller

* pp:

  Sync with git version
  [[89f161ad8]](https://git.sudo.ws/sudo/commit/?id=89f161ad8)

2010-09-16 Todd C. Miller

* common/fileops.c, plugins/sudoers/defaults.c:

  Cast isblank argument to unsigned char.
  [[48d7c7833]](https://git.sudo.ws/sudo/commit/?id=48d7c7833)

2010-09-14 Todd C. Miller

* INSTALL, config.h.in, configure, configure.in, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.pod, plugins/sudoers/defaults.c:

  Implement –with-umask-override configure flag.
  [[b51afe624]](https://git.sudo.ws/sudo/commit/?id=b51afe624)

* plugins/sudoers/env.c:

  Take MODE\_LOGIN\_SHELL into account when initially setting reset\_home
  instead of special-casing it later.
  [[ed45e68da]](https://git.sudo.ws/sudo/commit/?id=ed45e68da)

* plugins/sudoers/sudoers.c:

  In login mode, make a copy of the runas user’s pw\_shell for NewArgv[0]
  because 1) we modify it and 2) it will runas\_pw gets freed before exec.
  [[53f9cfe06]](https://git.sudo.ws/sudo/commit/?id=53f9cfe06)

* plugins/sudoers/env.c:

  Reset HOME for “sudo -i” even if HOME was listed in env\_keep.
  [[ce942f18c]](https://git.sudo.ws/sudo/commit/?id=ce942f18c)

* src/sudo.c:

  Use SIG\_SETMASK when resetting signal mask instead of SIG\_UNBLOCK.
  [[ece29bdea]](https://git.sudo.ws/sudo/commit/?id=ece29bdea)

* src/sudo.c:

  Reset signal mask at sudo startup time; we need to be able to rely on
  normal signal delivery to control the child process.
  [[01c7840dc]](https://git.sudo.ws/sudo/commit/?id=01c7840dc)

2010-09-13 Todd C. Miller

* install-sh:

  Use sed instead of expr to split a flag from its argument. Fixes a
  problem with expr interpreting its arguments as a flag when they start
  with a dash.
  [[607eab115]](https://git.sudo.ws/sudo/commit/?id=607eab115)

* common/lbuf.c:

  Do not need sys/time.h after all
  [[fdf877d53]](https://git.sudo.ws/sudo/commit/?id=fdf877d53)

* common/lbuf.c:

  Include sys/time.h for utimes() and struct timeval. No longer need
  ioctl.h or termios.h
  [[702a2bff2]](https://git.sudo.ws/sudo/commit/?id=702a2bff2)

* compat/snprintf.c:

  Quiet bogus compiler warnings.
  [[502555d2d]](https://git.sudo.ws/sudo/commit/?id=502555d2d)

* include/missing.h:

  Declare innetgr() for HP-UX which is missing a declaration. Declare
  domainname() for HP-UX and Solaris which are missing a declaration.
  [[da67324b1]](https://git.sudo.ws/sudo/commit/?id=da67324b1)

* plugins/sudoers/bsm\_audit.c:

  Use \_\_sun for consistency with the rest of the sources.
  [[77eb8cfe5]](https://git.sudo.ws/sudo/commit/?id=77eb8cfe5)

* plugins/sudoers/group\_plugin.c:

  Quiet a bogus compiler warning.
  [[4101f2eef]](https://git.sudo.ws/sudo/commit/?id=4101f2eef)

* plugins/sudoers/pwutil.c:

  Don’t try to delref a NULL group.
  [[933c71e9c]](https://git.sudo.ws/sudo/commit/?id=933c71e9c)

* common/alloc.c, common/lbuf.c:

  Include memory.h on systems that need it.
  [[149026989]](https://git.sudo.ws/sudo/commit/?id=149026989)

2010-09-11 Todd C. Miller

* src/exec.c:

  Quiet gcc warnings on glibc systems that use warn\_unused\_result for
  write(2).
  [[c04f48b4b]](https://git.sudo.ws/sudo/commit/?id=c04f48b4b)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  sudo\_plugin is in section 8; from Ted Percival
  [[bd1884bb4]](https://git.sudo.ws/sudo/commit/?id=bd1884bb4)

* plugins/sudoers/Makefile.in:

  testsudoers depends on libsudoers.la, not sudoreplay
  [[4ce8b35cd]](https://git.sudo.ws/sudo/commit/?id=4ce8b35cd)

2010-09-10 Todd C. Miller

* src/exec.c:

  Read as many signals on the signal pipe as we can before returning.
  [[66bea8c4c]](https://git.sudo.ws/sudo/commit/?id=66bea8c4c)

* src/exec.c, src/exec\_pty.c, src/sudo\_exec.h:

  Instead of using a array to store received signals, open a pipe and have
  the signal handler write the signal number to one end and select() on
  the other end. This makes it possible to handle signals similar to I/O
  without race conditions.
  [[59399d55c]](https://git.sudo.ws/sudo/commit/?id=59399d55c)

2010-09-09 Todd C. Miller

* doc/visudo.pod, plugins/sudoers/visudo.c:

  Make “visudo -c -f -” check the standard input.
  [[f601085de]](https://git.sudo.ws/sudo/commit/?id=f601085de)

* doc/sudoers.pod:

  set\_home and always\_set\_home have an effect if HOME is present in the
  env\_keep list.
  [[b91a12988]](https://git.sudo.ws/sudo/commit/?id=b91a12988)

* plugins/sudoers/env.c:

  Make -H flag work when HOME is listed in env\_keep. Also makes “set\_home”
  and “always\_set\_home” override override HOME in env\_keep.
  [[1b9ca115b]](https://git.sudo.ws/sudo/commit/?id=1b9ca115b)

2010-09-08 Todd C. Miller

* plugins/sudoers/Makefile.in, plugins/sudoers/interfaces.c,
  plugins/sudoers/interfaces.h, plugins/sudoers/match.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c, src/net\_ifs.c:

  Convert sudoers plugin to use interface list passed in settings.
  [[e069b74dc]](https://git.sudo.ws/sudo/commit/?id=e069b74dc)

* doc/sudo\_plugin.pod, src/Makefile.in, src/net\_ifs.c, src/parse\_args.c,
  src/sudo.h:

  Query local network interfaces in the main sudo driver and pass to the
  plugin as “network\_addrs” in the settings list.
  [[1009d7a3e]](https://git.sudo.ws/sudo/commit/?id=1009d7a3e)

* plugins/sudoers/bsm\_audit.c:

  Solaris BSM audit return EINVAL when auditing is not enabled, whereas
  OpenBSM returns ENOSYS.
  [[d9a352632]](https://git.sudo.ws/sudo/commit/?id=d9a352632)

2010-09-07 Todd C. Miller

* compat/fnmatch.c:

  missing.h should come before most local includes
  [[e74b6e6b1]](https://git.sudo.ws/sudo/commit/?id=e74b6e6b1)

* plugins/sudoers/sudoreplay.c:

  missing.h should come before most local includes
  [[d739608a8]](https://git.sudo.ws/sudo/commit/?id=d739608a8)

* plugins/sudoers/sudoers.h:

  Make local includes consistent; use double quotes for local includes
  except for generated ones where we use angle brackets.
  [[0c38f1460]](https://git.sudo.ws/sudo/commit/?id=0c38f1460)

* plugins/sudoers/sudoers.c:

  Always fill in NewArgv for audit code.
  [[1d37ab560]](https://git.sudo.ws/sudo/commit/?id=1d37ab560)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Add missing LOG\_INPUT/LOG\_OUTPUT support in the lexer.
  [[5403757ed]](https://git.sudo.ws/sudo/commit/?id=5403757ed)

* common/alloc.c, common/atobool.c, common/fileops.c, common/fmt\_string.c,
  common/lbuf.c, common/list.c, common/term.c, common/zero\_bytes.c,
  compat/closefrom.c, compat/fnmatch.c, compat/getcwd.c,
  compat/getgrouplist.c, compat/getline.c, compat/getprogname.c,
  compat/glob.c, compat/isblank.c, compat/memrchr.c, compat/mksiglist.c,
  compat/mkstemps.c, compat/nanosleep.c, compat/setenv.c,
  compat/snprintf.c, compat/strlcat.c, compat/strlcpy.c,
  compat/strsignal.c, compat/unsetenv.c, compat/utimes.c,
  include/compat.h, plugins/sample/sample\_plugin.c,
  plugins/sample\_group/getgrent.c, plugins/sample\_group/plugin\_test.c,
  plugins/sample\_group/sample\_group.c, plugins/sudoers/audit.c,
  plugins/sudoers/auth/afs.c, plugins/sudoers/boottime.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/linux\_audit.c, plugins/sudoers/match.c,
  plugins/sudoers/plugin\_error.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/timestr.c, src/error.c, src/sesh.c, src/sudo.h,
  src/sudo\_noexec.c, src/ttysize.c:

  Make local includes consistent; use double quotes for local includes
  except for generated ones where we use angle brackets. Also g/c unused
  compat.h.
  [[10c3bb62c]](https://git.sudo.ws/sudo/commit/?id=10c3bb62c)

2010-09-06 Todd C. Miller

* plugins/sudoers/match.c:

  When matching the runas user and runas group (-u and -g command line
  options), keep track of runas group and runas user matches separately.
  Only return a positive match if we have a match for both runas user and
  runas group (if specified).
  [[8ec596c7d]](https://git.sudo.ws/sudo/commit/?id=8ec596c7d)

2010-09-04 Todd C. Miller

* doc/sudoers.ldap.pod, plugins/sudoers/ldap.c:

  Add support for multiple URI lines by joining the contents and passing
  the result to ldap\_initialize.
  [[df8ec6fc2]](https://git.sudo.ws/sudo/commit/?id=df8ec6fc2)

* plugins/sudoers/ldap.c, plugins/sudoers/parse.c:

  Do not return -1 on error from the display functions; the caller expects
  a return value >= 0.
  [[27f6558df]](https://git.sudo.ws/sudo/commit/?id=27f6558df)

* plugins/sudoers/sudoers.c:

  Do not set both MODE\_EDIT and MODE\_RUN
  [[e7d56e16e]](https://git.sudo.ws/sudo/commit/?id=e7d56e16e)

2010-09-03 Todd C. Miller

* include/missing.h:

  Move includes to the top of the file.
  [[0d935f854]](https://git.sudo.ws/sudo/commit/?id=0d935f854)

2010-08-30 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Add missing definition of timedir
  [[c31210d66]](https://git.sudo.ws/sudo/commit/?id=c31210d66)

* compat/fnmatch.c, compat/getprogname.c, compat/isblank.c,
  compat/mksiglist.c, compat/strsignal.c, plugins/sudoers/plugin\_error.c,
  src/error.c, src/sudo\_noexec.c:

  Add #include of sys/types.h for .c files that include missing.h to be
  sure that size\_t and ssize\_t are defined.
  [[399381de9]](https://git.sudo.ws/sudo/commit/?id=399381de9)

* plugins/sudoers/Makefile.in:

  Install sudoers file from the build dir not hte src dir.
  [[7213f7205]](https://git.sudo.ws/sudo/commit/?id=7213f7205)

2010-08-26 Todd C. Miller

* plugins/sudoers/set\_perms.c:

  If runas\_pw changes, reset the stashed runas aux group vector.
  Otherwise, if runas\_default is set in a per-command Defaults statement,
  the command runs with root’s aux group vector (i.e. the one that was
  used when locating the command).
  [[94de54b19]](https://git.sudo.ws/sudo/commit/?id=94de54b19)

* plugins/sudoers/Makefile.in:

  Add target to generate sudoers file Remove generated sudoers file as
  part of distclean
  [[209a21051]](https://git.sudo.ws/sudo/commit/?id=209a21051)

2010-08-24 Todd C. Miller

* src/exec.c:

  When not logging I/O install a handler for SIGCONT and deliver it to the
  command upon resume. Fixes bugzilla #431
  [[2cef2bb5b]](https://git.sudo.ws/sudo/commit/?id=2cef2bb5b)

2010-08-21 Todd C. Miller

* plugins/sudoers/sudoers.h:

  g/c unused auth\_pw extern definition
  [[88f9fea40]](https://git.sudo.ws/sudo/commit/?id=88f9fea40)

* plugins/sudoers/check.c, plugins/sudoers/sudoers.c:

  Move get\_auth() into check.c where it is actually used.
  [[256ee25ab]](https://git.sudo.ws/sudo/commit/?id=256ee25ab)

2010-08-20 Todd C. Miller

* common/lbuf.c:

  Convert a remaining puts() and putchar() to use the output function.
  [[a68c31306]](https://git.sudo.ws/sudo/commit/?id=a68c31306)

* plugins/sudoers/plugin\_error.c:

  Plug memory leak
  [[a2694e9e2]](https://git.sudo.ws/sudo/commit/?id=a2694e9e2)

2010-08-18 Todd C. Miller

* plugins/sudoers/env.c:

  Set dupcheck to TRUE when setting new HOME value if !env\_reset but
  always\_set\_home is true. Prevents a duplicate HOME in the environment
  (old value plus the new one) introduced in f421f8827340.
  [[3d48cae18]](https://git.sudo.ws/sudo/commit/?id=3d48cae18)

* configure, configure.in, plugins/sudoers/sudoers.in:

  Substitute sysconfdir in the installed sudoers file to get the correct
  path for sudoers.d.
  [[598341d36]](https://git.sudo.ws/sudo/commit/?id=598341d36)

2010-08-17 Todd C. Miller

* src/get\_pty.c:

  Fix typo that prevented compilation on Irix; Friedrich Haubensak
  [[9706b4c50]](https://git.sudo.ws/sudo/commit/?id=9706b4c50)

2010-08-16 Todd C. Miller

* MANIFEST, common/Makefile.in, common/aix.c, common/alloc.c,
  common/atobool.c, common/fileops.c, common/fmt\_string.c, common/lbuf.c,
  common/list.c, common/term.c, common/zero\_bytes.c, compat/Makefile.in,
  compat/closefrom.c, compat/fnmatch.c, compat/getcwd.c,
  compat/getgrouplist.c, compat/getline.c, compat/getprogname.c,
  compat/glob.c, compat/isblank.c, compat/memrchr.c, compat/mksiglist.c,
  compat/mkstemps.c, compat/nanosleep.c, compat/setenv.c,
  compat/snprintf.c, compat/strlcat.c, compat/strlcpy.c,
  compat/strsignal.c, compat/unsetenv.c, compat/utimes.c,
  include/compat.h, include/missing.h, plugins/sample/sample\_plugin.c,
  plugins/sample\_group/getgrent.c, plugins/sample\_group/sample\_group.c,
  plugins/sudoers/Makefile.in, plugins/sudoers/audit.c,
  plugins/sudoers/boottime.c, plugins/sudoers/getdate.c,
  plugins/sudoers/getdate.y, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/plugin\_error.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/timestr.c,
  src/Makefile.in, src/error.c, src/sesh.c, src/sudo.h, src/sudo\_noexec.c,
  src/ttysize.c:

  Merge compat.h and missing.h into missing.h
  [[f454727bb]](https://git.sudo.ws/sudo/commit/?id=f454727bb)

2010-08-14 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  If the user hits ^C while a password is being read, error out before
  reading any further passwords in the pam conversation function.
  Otherwise, if multiple PAM auth methods are required, the user will have
  to hit ^C for each one.
  [[6ce5c4cd9]](https://git.sudo.ws/sudo/commit/?id=6ce5c4cd9)

2010-08-12 Todd C. Miller

* plugins/sudoers/check.c:

  Update comment
  [[151a2cab5]](https://git.sudo.ws/sudo/commit/?id=151a2cab5)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Document sudo\_conv\_t function and sudo\_printf\_t return values.
  [[4feaf3c26]](https://git.sudo.ws/sudo/commit/?id=4feaf3c26)

* src/conversation.c:

  Make \_sudo\_printf return the number of characters printed on success
  like printf(3).
  [[10637f6e0]](https://git.sudo.ws/sudo/commit/?id=10637f6e0)

2010-08-10 Todd C. Miller

* plugins/sudoers/sudoers.c:

  sudoers.h includes sudo\_plugin.h for us
  [[129cf8d99]](https://git.sudo.ws/sudo/commit/?id=129cf8d99)

* common/Makefile.in, common/gettime.c, compat/mkstemps.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/visudo.c, src/sudo.h,
  src/sudo\_edit.c:

  Use gettimeofday() directly instead of via the gettime() wrapper.
  [[6bcd9efc0]](https://git.sudo.ws/sudo/commit/?id=6bcd9efc0)

* common/gettime.c, compat/snprintf.c, compat/strcasecmp.c,
  compat/strerror.c, config.h.in, configure, configure.in,
  include/compat.h, include/missing.h, plugins/sudoers/logging.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/visudo.c, src/sudo.c:

  Remove some obsolete configure tests, ancient Unix systems are no longer
  supported.
  [[8dd8aa000]](https://git.sudo.ws/sudo/commit/?id=8dd8aa000)

2010-08-07 Todd C. Miller

* sudo.pp:

  Set pp\_kit\_version and strip off patch level
  [[29efdc50a]](https://git.sudo.ws/sudo/commit/?id=29efdc50a)

* sudo.pp:

  Better handling of versions with a patchlevel. For rpm and deb, use the
  patchlevel+1 as the release. For AIX, use the patchlevel as the 4th
  version number. For the rest, just leave the patchlevel in the version
  string.
  [[ee2bdd248]](https://git.sudo.ws/sudo/commit/?id=ee2bdd248)

2010-08-06 Todd C. Miller

* plugins/sudoers/auth/sudo\_auth.c:

  For non-standalone auth methods, stop reading the password if the user
  enters ^C at the prompt.
  [[d2cc4740c]](https://git.sudo.ws/sudo/commit/?id=d2cc4740c)

* configure, configure.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/auth/sudo\_auth.h,
  plugins/sudoers/pwutil.c:

  No need to look up shadow password unless we are doing password-style
  authentication. This moves the shadow password lookup to the auth
  functions that need it.
  [[96cb890d5]](https://git.sudo.ws/sudo/commit/?id=96cb890d5)

* plugins/sudoers/sudoers.c:

  Retain final passwd/group refs until the policy close() function. Note
  that this doesn’t get called in all cases so putting this in a cleanup
  function is probably better.
  [[cb1848fab]](https://git.sudo.ws/sudo/commit/?id=cb1848fab)

* plugins/sudoers/check.c:

  Fix mismerge
  [[9f2740135]](https://git.sudo.ws/sudo/commit/?id=9f2740135)

* plugins/sudoers/check.c:

  When removing/resetting the timestamp file ignore the tty ticket
  contents.
  [[640f79e13]](https://git.sudo.ws/sudo/commit/?id=640f79e13)

* plugins/sudoers/sudoers.c:

  delref sudo\_user.pw, runas\_pw and runas\_gr immediately before we return.
  [[26526e667]](https://git.sudo.ws/sudo/commit/?id=26526e667)

2010-08-04 Todd C. Miller

* plugins/sudoers/check.c, plugins/sudoers/ldap.c,
  plugins/sudoers/match.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Reference count cached passwd and group structs. The cache holds one
  reference itself and another is added by sudo\_getgr{gid,nam} and
  sudo\_getpw{uid,nam}. The final ref on the runas and user passwd and
  group structs are persistent for now.
  [[0186018d3]](https://git.sudo.ws/sudo/commit/?id=0186018d3)

* doc/UPGRADE:

  fix typo
  [[7b011cf15]](https://git.sudo.ws/sudo/commit/?id=7b011cf15)

2010-08-03 Todd C. Miller

* plugins/sudoers/check.c:

  Do not produce a warning for “sudo -k” if the ticket file does not
  exist.
  [[ec5722101]](https://git.sudo.ws/sudo/commit/?id=ec5722101)

* plugins/sudoers/pwutil.c:

  Instead of caching struct passwd and struct group in the red-black tree,
  store a struct cache\_item which includes both the key and datum. This
  allows us to user the actual name that was looked up as the key instead
  of the contents of struct passwd or struct group. This matters because
  the name in the database may not match what we looked up, due either to
  case folding or truncation (historically at 8 characters). Also mark the
  disabled calls to sudo\_freepwcache() and sudo\_freegrcache() as broken
  since we use cached data for things like set\_perms() and the logging
  functions. Fixing this would require making a copy of the structs for
  user and runas or adding a reference count (better).
  [[65eec19bd]](https://git.sudo.ws/sudo/commit/?id=65eec19bd)

* plugins/sudoers/Makefile.in:

  Fix path to mkinstalldirs
  [[4e74b389c]](https://git.sudo.ws/sudo/commit/?id=4e74b389c)

* plugins/sudoers/check.c, plugins/sudoers/logging.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/visudo.c, src/exec\_pty.c,
  src/get\_pty.c, src/tgetpass.c:

  Quiet gcc warnings on glibc systems that use warn\_unused\_result for
  write(2) and others.
  [[420db2371]](https://git.sudo.ws/sudo/commit/?id=420db2371)

2010-08-02 Todd C. Miller

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Add %option noinput
  [[122940672]](https://git.sudo.ws/sudo/commit/?id=122940672)

* aclocal.m4, configure, configure.in:

  Add cross-compile defaults for remaining AC\_TRY\_RUN usage. Also add back
  getgroups() check since AC\_FUNC\_GETGROUPS defaults to “no” when
  cross-compiling.
  [[ea79ea446]](https://git.sudo.ws/sudo/commit/?id=ea79ea446)

2010-07-31 Todd C. Miller

* aclocal.m4, compat/snprintf.c, config.h.in, configure, configure.in:

  Use AC\_CHECK\_MEMBER in SUDO\_SOCK\_SA\_LEN Use AC\_TYPE\_LONG\_LONG\_INT and
  AC\_CHECK\_SIZEOF([long int]) instead of rolling our own.
  [[24a755bfe]](https://git.sudo.ws/sudo/commit/?id=24a755bfe)

2010-07-29 Todd C. Miller

* pp:

  Update to latest version
  [[7861b4afd]](https://git.sudo.ws/sudo/commit/?id=7861b4afd)

2010-07-28 Todd C. Miller

* sudo.pp:

  Let pp determine pp\_aix\_version itself.
  [[e4ff63bd3]](https://git.sudo.ws/sudo/commit/?id=e4ff63bd3)

* INSTALL, config.h.in, configure, configure.in, mkpkg,
  plugins/sudoers/sudoers.c:

  Add support for Ubuntu admin flag file and enable it when building
  Ubuntu packages.
  [[6d0395ee6]](https://git.sudo.ws/sudo/commit/?id=6d0395ee6)

* plugins/sudoers/sudoers, sudo.pp:

  Add commented out SuSE-like targetpw settings
  [[76ce69057]](https://git.sudo.ws/sudo/commit/?id=76ce69057)

* configure, configure.in:

  Only try to use +DAportable for non-GCC on hppa
  [[036a9d81b]](https://git.sudo.ws/sudo/commit/?id=036a9d81b)

* configure, configure.in:

  Prevent configure from adding the -g flag unless in devel mode
  [[5c7335e23]](https://git.sudo.ws/sudo/commit/?id=5c7335e23)

2010-07-27 Todd C. Miller

* sudo.pp:

  Go back to sudo-flavor to match existing packages and only use an
  underscore for those that need it.
  [[1ae6145d4]](https://git.sudo.ws/sudo/commit/?id=1ae6145d4)

* sudo.pp:

  Use sudo\_$flavor instead of sudo-$flavor since that causes the least
  amount of trouble for the various package managers.
  [[a4b333bc4]](https://git.sudo.ws/sudo/commit/?id=a4b333bc4)

* mkpkg:

  Fix handling of the ldap flavor Remove destdir unless –debug was
  specified Make distclean before running configure if there is a Makefile
  present
  [[a6265c54c]](https://git.sudo.ws/sudo/commit/?id=a6265c54c)

* sudo.pp:

  Add back include file.
  [[0fbe7a674]](https://git.sudo.ws/sudo/commit/?id=0fbe7a674)

* mkpkg:

  Pass extra args on to configure on HP-UX, if we don’t have the HP C
  compiler, disable zlib to prevent gcc from finding it in /usr/local/lib.
  [[707246a34]](https://git.sudo.ws/sudo/commit/?id=707246a34)

* mkpkg:

  Use the HP ANSI C compiler on HP-UX if possible
  [[01e547bd1]](https://git.sudo.ws/sudo/commit/?id=01e547bd1)

* plugins/sudoers/sudoreplay.c:

  Some getline() implementations (FreeBSD 8.0) do not ignore the length
  pointer when the line pointer is NULL as they should.
  [[5d06ad3b6]](https://git.sudo.ws/sudo/commit/?id=5d06ad3b6)

* plugins/sudoers/sudoreplay.c:

  Don’t need to check for \*cp being non-zero, isdigit() will do that.
  [[c33bf9350]](https://git.sudo.ws/sudo/commit/?id=c33bf9350)

* plugins/sudoers/sudoreplay.c:

  Add setlocale() so the command line arguments that use floating point
  work in different locales. Since sudo now logs the timing data in the C
  locale we must Parse the seconds in the timing file manually instead of
  using strtod(). Furthermore, sudo 1.7.3 logged the number of seconds
  with the user’s locale so if the decimal point is not ‘.’ try using the
  locale-specific version.
  [[18d25e96f]](https://git.sudo.ws/sudo/commit/?id=18d25e96f)

* src/exec.c:

  Do I/O logging in the C locale so the floating point numbers in the
  timing file are not locale-dependent.
  [[e11e4efb8]](https://git.sudo.ws/sudo/commit/?id=e11e4efb8)

* plugins/sudoers/sudoreplay.c:

  Use errorx() not error() for thingsthat don’t set errno.
  [[a3e4db124]](https://git.sudo.ws/sudo/commit/?id=a3e4db124)

2010-07-26 Todd C. Miller

* pp:

  Better support for 1.2.3 style versions in Tru64 kits
  [[14909efc6]](https://git.sudo.ws/sudo/commit/?id=14909efc6)

* sudo.pp:

  Add Tru64 kit support
  [[2e66c22a3]](https://git.sudo.ws/sudo/commit/?id=2e66c22a3)

* pp:

  Remove apparently unnecessary use of sudo
  [[af182aed7]](https://git.sudo.ws/sudo/commit/?id=af182aed7)

* Makefile.in, plugins/sudoers/Makefile.in:

  Create timedir as part of install-dirs target.
  [[c59ad3596]](https://git.sudo.ws/sudo/commit/?id=c59ad3596)

* src/exec\_pty.c:

  Handle ENXIO from read/write which can occur when reading/writing a pty
  that has gone away.
  [[23c96fbc2]](https://git.sudo.ws/sudo/commit/?id=23c96fbc2)

* plugins/sudoers/pwutil.c:

  sudo\_pwdup() was not expanding an empty pw\_shell to \_PATH\_BSHELL
  [[4168fcf2d]](https://git.sudo.ws/sudo/commit/?id=4168fcf2d)

* mkpkg:

  platform is a pp flag not a variable
  [[1eebebeec]](https://git.sudo.ws/sudo/commit/?id=1eebebeec)

* Makefile.in, mkpkg, sudo.pp:

  Add simple arg parsing for mkpkg so we can set debug, flavor or
  platform.
  [[551791a51]](https://git.sudo.ws/sudo/commit/?id=551791a51)

* pp:

  Make rpm backend work on AIX 5.x
  [[d02489ff4]](https://git.sudo.ws/sudo/commit/?id=d02489ff4)

2010-07-25 Todd C. Miller

* plugins/sudoers/sudoers:

  Add commented out Defaults entry for log\_output
  [[a346ba8df]](https://git.sudo.ws/sudo/commit/?id=a346ba8df)

2010-07-23 Todd C. Miller

* doc/Makefile.in:

  Remove sudo docdir completely
  [[a4b3a6d96]](https://git.sudo.ws/sudo/commit/?id=a4b3a6d96)

* doc/sample.sudo.conf:

  Add sample sudo.conf
  [[084ae523a]](https://git.sudo.ws/sudo/commit/?id=084ae523a)

2010-07-22 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Add PACKAGE\_TARNAME for docdir
  [[aeac8822b]](https://git.sudo.ws/sudo/commit/?id=aeac8822b)

2010-07-23 Todd C. Miller

* src/Makefile.in:

  Pass install-sh -b~ here too.
  [[06a918b88]](https://git.sudo.ws/sudo/commit/?id=06a918b88)

* plugins/sample/Makefile.in, plugins/sample\_group/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Install binary files with -b~ to make a backup. Fixes “text file busy”
  error on HP-UX during install.
  [[092a6935e]](https://git.sudo.ws/sudo/commit/?id=092a6935e)

* install-sh:

  “mv -f” on HP-UX doesn’t unlink the destination first so add an explicit
  rm before moving the temporary into place.
  [[49d82a04e]](https://git.sudo.ws/sudo/commit/?id=49d82a04e)

* configure, configure.in:

  Some more ${foo} -> $(foo) conversion for consistent Makefiles.
  [[5ba4a35a7]](https://git.sudo.ws/sudo/commit/?id=5ba4a35a7)

* doc/Makefile.in, plugins/sudoers/Makefile.in:

  Install sudoers2ldif in the doc dir
  [[c016ecf00]](https://git.sudo.ws/sudo/commit/?id=c016ecf00)

2010-07-22 Todd C. Miller

* pathnames.h.in:

  Add missing include of maillock.h for Solaris
  [[258a26d39]](https://git.sudo.ws/sudo/commit/?id=258a26d39)

* NEWS, configure, configure.in, doc/TROUBLESHOOTING, doc/UPGRADE,
  doc/sample.syslog.conf, doc/sudoers.cat:

  Change the default syslog facility from local2 to authpriv (or auth if
  the operating system doesn’t support authpriv).
  [[8660b5ea3]](https://git.sudo.ws/sudo/commit/?id=8660b5ea3)

* Makefile.in, sudo.pp:

  Install sudoers as /etc/sudoers on RPM and debian systems where the
  package manager will not replace a user-modified configuration file.
  This fixes upgrades from the vendor sudo packages.
  [[481a389e6]](https://git.sudo.ws/sudo/commit/?id=481a389e6)

* pp:

  RPM: use %config(noreplace) instead of %config for volatile This results
  in the new file being installed with a .rpmnew suffix instead of the
  file being replaced and the old one renamed with a .rpmsave suffix.
  [[b0e282b50]](https://git.sudo.ws/sudo/commit/?id=b0e282b50)

2010-07-21 Todd C. Miller

* compat/mkstemps.c, plugins/sudoers/boottime.c:

  Include time.h for struct timeval
  [[5183d6e59]](https://git.sudo.ws/sudo/commit/?id=5183d6e59)

* src/exec\_pty.c:

  The return value of strsignal() may be const and should be treated as
  const regardless.
  [[c9e86ab3b]](https://git.sudo.ws/sudo/commit/?id=c9e86ab3b)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  Mention that 127.0.0.1 will not match, nor will localhost unless that is
  the actual host name.
  [[bdecb14ea]](https://git.sudo.ws/sudo/commit/?id=bdecb14ea)

* MANIFEST, NEWS, README, doc/Makefile.in, doc/UPGRADE:

  Rename WHATSNEW -> NEWS
  [[a72965e64]](https://git.sudo.ws/sudo/commit/?id=a72965e64)

* pp:

  Updated pp with latest patches
  [[3f2263ae4]](https://git.sudo.ws/sudo/commit/?id=3f2263ae4)

* WHATSNEW:

  Sync with 1.7.4
  [[cb0d7cdb8]](https://git.sudo.ws/sudo/commit/?id=cb0d7cdb8)

* doc/UPGRADE, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod,
  plugins/sudoers/sudoers:

  Add commented out line to add HOME to env\_keep and add a warning to the
  note about the HOME change in UPGRADE.
  [[f45f57dca]](https://git.sudo.ws/sudo/commit/?id=f45f57dca)

2010-07-20 Todd C. Miller

* plugins/sudoers/sudoreplay.c:

  Add LINE\_MAX define for those without it.
  [[d8acd3403]](https://git.sudo.ws/sudo/commit/?id=d8acd3403)

* INSTALL, WHATSNEW, config.h.in, configure, configure.in, doc/UPGRADE,
  doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod,
  plugins/sudoers/defaults.c:

  The tty\_tickets option is now on by default.
  [[2675524c3]](https://git.sudo.ws/sudo/commit/?id=2675524c3)

* WHATSNEW:

  Mention that AIX authdb support has been fixed.
  [[9006c79ba]](https://git.sudo.ws/sudo/commit/?id=9006c79ba)

* common/aix.c:

  setauthdb() only sets the “old” registry if it was set by a previous
  call to setauthdb(). To restore the original value, passing NULL (or an
  empty string) to setauthdb() is sufficient.
  [[f3b397be0]](https://git.sudo.ws/sudo/commit/?id=f3b397be0)

2010-07-19 Todd C. Miller

* WHATSNEW, doc/UPGRADE, doc/sudo.cat, doc/sudo.man.in, doc/sudo.pod,
  doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod,
  plugins/sudoers/env.c:

  Reset HOME when env\_reset is enabled unless it is in env\_keep
  [[ee7221f1f]](https://git.sudo.ws/sudo/commit/?id=ee7221f1f)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  The default for set\_logname has been “true” for some time now.
  [[c31e1227f]](https://git.sudo.ws/sudo/commit/?id=c31e1227f)

* plugins/sudoers/boottime.c:

  Add missing include of time.h
  [[4382c30c0]](https://git.sudo.ws/sudo/commit/?id=4382c30c0)

* plugins/sudoers/logging.c:

  Fix check for dup2() return value.
  [[10e6e572e]](https://git.sudo.ws/sudo/commit/?id=10e6e572e)

* plugins/sudoers/env.c:

  Add PYTHONUSERBASE to initial\_badenv\_table
  [[2eb1879fd]](https://git.sudo.ws/sudo/commit/?id=2eb1879fd)

* plugins/sudoers/visudo.c:

  Treat an unknown defaults entry as a parse error.
  [[32e896f33]](https://git.sudo.ws/sudo/commit/?id=32e896f33)

* plugins/sudoers/defaults.c, plugins/sudoers/sudoers.c:

  Check return value of setdefs() but don’t stop setting defaults if we
  hit an unknown one.
  [[f7f65cfb9]](https://git.sudo.ws/sudo/commit/?id=f7f65cfb9)

* WHATSNEW, aclocal.m4, config.h.in, configure, configure.in,
  doc/sudo.cat, doc/sudo.man.in, doc/sudo.pod, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.pod, pathnames.h.in,
  plugins/sudoers/env.c:

  If env\_reset is enabled, set the MAIL environment variable based on the
  target user unless MAIL is explicitly preserved in sudoers.
  [[69ecb3458]](https://git.sudo.ws/sudo/commit/?id=69ecb3458)

2010-07-17 Todd C. Miller

* pp:

  decode debian code names
  [[0f3c1b590]](https://git.sudo.ws/sudo/commit/?id=0f3c1b590)

* WHATSNEW:

  fix typo
  [[a3c3602c1]](https://git.sudo.ws/sudo/commit/?id=a3c3602c1)

2010-07-16 Todd C. Miller

* WHATSNEW:

  Merge with 1.7.4
  [[a7fbdbe69]](https://git.sudo.ws/sudo/commit/?id=a7fbdbe69)

* src/sudo.c:

  Restore RLIMIT\_NPROC after the uid switch if it appears that
  runas\_setup() did not do it for us. Fixes a bash script problem on SuSE
  with RLIMIT\_NPROC set to RLIM\_INFINITY.
  [[006427345]](https://git.sudo.ws/sudo/commit/?id=006427345)

2010-07-15 Todd C. Miller

* mkpkg, pp, sudo.pp:

  Restore the dot removal in the os version reported by polypkg. Adapt
  mkpkg and sudo.pp to the change.
  [[3907d4363]](https://git.sudo.ws/sudo/commit/?id=3907d4363)

2010-07-16 Todd C. Miller

* INSTALL:

  document –with-pam-login
  [[33c029c8c]](https://git.sudo.ws/sudo/commit/?id=33c029c8c)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  The tag is NOSETENV, not UNSETENV. From Petr Uzel.
  [[225de6063]](https://git.sudo.ws/sudo/commit/?id=225de6063)

2010-07-15 Todd C. Miller

* sudo.pp:

  Include flavor in solaris package name
  [[6575013a1]](https://git.sudo.ws/sudo/commit/?id=6575013a1)

* mkpkg:

  Older shells don’t support IFS= so set explictly to space, tab, newline.
  [[8fd2e2564]](https://git.sudo.ws/sudo/commit/?id=8fd2e2564)

* mkpkg:

  Use ‘=’ not ‘==’ in test
  [[df1ed5f3e]](https://git.sudo.ws/sudo/commit/?id=df1ed5f3e)

* mkpkg:

  Fix typo that prevented debian from matching
  [[338331186]](https://git.sudo.ws/sudo/commit/?id=338331186)

* mkpkg:

  Add missing prefix setting for debian
  [[d6dfa43d2]](https://git.sudo.ws/sudo/commit/?id=d6dfa43d2)

* sudo.pp:

  Use tab indents to reduce the chance of problem with <<- Fix the
  debian %set section, pp does not set pp\_deb\_distro Uncomment %sudo line
  in sudoers for debian Uncomment some env\_keep lines for RHEL, SLES and
  debian to more closely match the vendor sudoers files. Add /etc/pam.d to
  %files Remove the /etc/sudo-ldap.conf symlink on debian for ldap flavor
  [[8a837375d]](https://git.sudo.ws/sudo/commit/?id=8a837375d)

* plugins/sudoers/sudoers:

  Add commented out env\_keep entries, sample Aliases and a %sudo line for
  debian.
  [[af0bac430]](https://git.sudo.ws/sudo/commit/?id=af0bac430)

* configure, configure.in:

  Move zlib check later on in the script to avoid a strange shell problem
  on SLES11.
  [[3ea95dae3]](https://git.sudo.ws/sudo/commit/?id=3ea95dae3)

* configure.in:

  Remove check for egrep; configure has its own
  [[77d3b8d09]](https://git.sudo.ws/sudo/commit/?id=77d3b8d09)

2010-07-14 Todd C. Miller

* mkpkg:

  Enable zlib for linux distros
  [[98650c9a2]](https://git.sudo.ws/sudo/commit/?id=98650c9a2)

* mkpkg:

  Add ldap flavor to default build
  [[402b35a79]](https://git.sudo.ws/sudo/commit/?id=402b35a79)

* mkpkg, sudo.pp:

  Simplify rpm linux distro settings
  [[f440808e5]](https://git.sudo.ws/sudo/commit/?id=f440808e5)

* aclocal.m4, configure, configure.in, doc/UPGRADE, doc/sudoers.cat:

  Move time stamp files from /var/run/sudo to /var/{db,lib,adm}/sudo.
  [[c2c15aa4e]](https://git.sudo.ws/sudo/commit/?id=c2c15aa4e)

* Makefile.in:

  Fix ChangeLog creation from build dir
  [[669ca7899]](https://git.sudo.ws/sudo/commit/?id=669ca7899)

* plugins/sudoers/sudoers.c:

  Handle getcwd() failure.
  [[482f9cfc8]](https://git.sudo.ws/sudo/commit/?id=482f9cfc8)

* doc/Makefile.in, mkpkg, sudo.pp:

  Add ldap “flavor” for debian, controlled by the SUDO\_FLAVOR environment
  variable.
  [[eccbde77d]](https://git.sudo.ws/sudo/commit/?id=eccbde77d)

* sudo.pp:

  Create sudo group on debian
  [[3910c8fb5]](https://git.sudo.ws/sudo/commit/?id=3910c8fb5)

* mkpkg, sudo.pp:

  Add debian 4/5/6 and use the dot when doing version matches
  [[a7dac1fc2]](https://git.sudo.ws/sudo/commit/?id=a7dac1fc2)

* aclocal.m4, configure:

  Use a loop when searching for mv, sendmail and sh
  [[09a6f4651]](https://git.sudo.ws/sudo/commit/?id=09a6f4651)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  Remove spurious “and”; from debian
  [[de3cfa25f]](https://git.sudo.ws/sudo/commit/?id=de3cfa25f)

* aclocal.m4, configure, configure.in, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.pod, doc/visudo.cat, doc/visudo.man.in,
  doc/visudo.pod:

  Substitute the value of EDITOR into the sudoers and visudo manuals.
  [[26ca852a9]](https://git.sudo.ws/sudo/commit/?id=26ca852a9)

2010-07-13 Todd C. Miller

* mkpkg, pp, sudo.pp:

  Initial support for debian 4.0
  [[fde091cc0]](https://git.sudo.ws/sudo/commit/?id=fde091cc0)

* mkpkg:

  Some platforms need -fPIE instead of -fpie
  [[781788e2e]](https://git.sudo.ws/sudo/commit/?id=781788e2e)

* plugins/sudoers/auth/pam.c:

  Only set PAM\_RHOST for Solaris, where it is needed to avoid a bug. On
  Linux it causes a DNS lookup via libaudit.
  [[efbc7f1d5]](https://git.sudo.ws/sudo/commit/?id=efbc7f1d5)

* MANIFEST:

  Update MANIFEST to match packaging changes
  [[594fb3c55]](https://git.sudo.ws/sudo/commit/?id=594fb3c55)

* sudo.psf:

  We now use pp to generate HP-UX packages
  [[0544939f5]](https://git.sudo.ws/sudo/commit/?id=0544939f5)

* INSTALL.binary, plugins/sudoers/Makefile.binary.in:

  Remove vestiges of old binary package bits.
  [[ab7a1c5ce]](https://git.sudo.ws/sudo/commit/?id=ab7a1c5ce)

* INSTALL, Makefile.in, common/Makefile.in, compat/Makefile.in,
  doc/Makefile.in, include/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  src/Makefile.in:

  install-man -> install-doc
  [[a33996e74]](https://git.sudo.ws/sudo/commit/?id=a33996e74)

* Makefile.in, doc/Makefile.in, include/Makefile.in, mkpkg,
  plugins/sudoers/Makefile.in, pp, src/Makefile.in, sudo.pp:

  Use <http://rc.quest.com/topics/polypkg/> for packaging
  [[7bcbce207]](https://git.sudo.ws/sudo/commit/?id=7bcbce207)

* install-sh:

  Just ignore the -c option, it is the default Add support for -d option
  [[69400709d]](https://git.sudo.ws/sudo/commit/?id=69400709d)

2010-07-12 Todd C. Miller

* pathnames.h.in, plugins/sudoers/env.c, plugins/sudoers/logging.c:

  Use \_PATH\_STDPATH instead of \_PATH\_DEFPATH
  [[5b9e39ac8]](https://git.sudo.ws/sudo/commit/?id=5b9e39ac8)

* plugins/sudoers/Makefile.in, src/Makefile.in:

  Do not strip binaries.
  [[151db86e3]](https://git.sudo.ws/sudo/commit/?id=151db86e3)

* INSTALL, configure, configure.in:

  Add –insults=disabled configure option to allow people to build in
  insult support but have the insults disabled unless explicitly enabled
  in sudoers.
  [[791028169]](https://git.sudo.ws/sudo/commit/?id=791028169)

* compat/mkstemps.c:

  Add prototype for gettime()
  [[2b7410074]](https://git.sudo.ws/sudo/commit/?id=2b7410074)

* config.h.in, configure, configure.in, plugins/sudoers/auth/pam.c,
  plugins/sudoers/env.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Add support for a sudo-i pam.d file to be used for “sudo -i”. Adapted
  from a RedHat patch.
  [[d9de7b5f8]](https://git.sudo.ws/sudo/commit/?id=d9de7b5f8)

2010-07-09 Todd C. Miller

* include/missing.h:

  Fix mkstemps() prototype
  [[684d1fd9f]](https://git.sudo.ws/sudo/commit/?id=684d1fd9f)

* MANIFEST, compat/Makefile.in, compat/mkstemps.c, config.h.in, configure,
  configure.in, include/missing.h, src/sudo\_edit.c:

  Use mkstemps() instead of mkstemp() in sudoedit. This allows sudoedit to
  preserve the file extension (if any) which may be used by the editor
  (like emacs) to choose the editing mode.
  [[ea4298bb5]](https://git.sudo.ws/sudo/commit/?id=ea4298bb5)

2010-07-08 Todd C. Miller

* doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.ldap.pod,
  plugins/sudoers/ldap.c:

  TLS\_CACERT is now an alias for TLS\_CACERTFILE. OpenLDAP uses TLS\_CACERT,
  not TLS\_CACERTFILE in its ldap.conf. Other LDAP client code, such as
  nss\_ldap, uses TLS\_CACERTFILE. Also document why you should avoid
  disabling TLS\_CHECKPEER is possible.
  [[432d27573]](https://git.sudo.ws/sudo/commit/?id=432d27573)

2010-07-07 Todd C. Miller

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Make sudo\_plugin format a bit more like a man page
  [[5b1420b6d]](https://git.sudo.ws/sudo/commit/?id=5b1420b6d)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Add suport for negated user/host/command lists in a Defaults entry. E.g.
  Defaults:!baduser noexec
  [[fd6b72f48]](https://git.sudo.ws/sudo/commit/?id=fd6b72f48)

* Makefile.in, common/Makefile.in, compat/Makefile.in, doc/Makefile.in,
  include/Makefile.in, plugins/sample/Makefile.in,
  plugins/sample\_group/Makefile.in, plugins/sudoers/Makefile.in,
  src/Makefile.in:

  Add uninstall target
  [[3f33f75b7]](https://git.sudo.ws/sudo/commit/?id=3f33f75b7)

* common/Makefile.in, compat/Makefile.in:

  Remove unused AR, SED and RANLIB variables
  [[98ce6c94c]](https://git.sudo.ws/sudo/commit/?id=98ce6c94c)

* Makefile.in:

  Do not install sample plugins
  [[ff7835722]](https://git.sudo.ws/sudo/commit/?id=ff7835722)

2010-07-06 Todd C. Miller

* MANIFEST, aclocal.m4, compat/setenv.c, compat/unsetenv.c, configure,
  configure.in, plugins/sudoers/env.c:

  Now that sudoers is a dynamically loaded module we cannot override the
  libc environment functions because the symbols may already have been
  resolved via libc. Remove getenv/putenv/setenv/unsetenv replacements
  from sudoers and add replacements for setenv/unsetenv for systems that
  lack them.
  [[6229c0e20]](https://git.sudo.ws/sudo/commit/?id=6229c0e20)

* configure, configure.in, plugins/sudoers/Makefile.in:

  Link testsudoers with -ldl when needed
  [[ff4a61b92]](https://git.sudo.ws/sudo/commit/?id=ff4a61b92)

* plugins/sample\_group/plugin\_test.c:

  Remove unused time.h and add limits.h for PATH\_MAX
  [[e3f444747]](https://git.sudo.ws/sudo/commit/?id=e3f444747)

* doc/sudoers.ldap.pod:

  Fix typo.
  [[390696777]](https://git.sudo.ws/sudo/commit/?id=390696777)

2010-07-05 Todd C. Miller

* plugins/sample\_group/plugin\_test.c:

  Do not depend on strlcpy/strlcat
  [[47c28e7ec]](https://git.sudo.ws/sudo/commit/?id=47c28e7ec)

* plugins/sample\_group/plugin\_test.c:

  Standalone test driver for sudoers group plugin.
  [[6a058e4af]](https://git.sudo.ws/sudo/commit/?id=6a058e4af)

2010-07-02 Todd C. Miller

* plugins/sudoers/group\_plugin.c, src/load\_plugins.c:

  Use RTLD\_LAZY instead of RTLD\_NOW; was using RTLD\_NOW as a debugging
  aid.
  [[17dbb33e5]](https://git.sudo.ws/sudo/commit/?id=17dbb33e5)

* plugins/sample\_group/sample\_group.c:

  Fix style nit in function declarations
  [[7e91ebff1]](https://git.sudo.ws/sudo/commit/?id=7e91ebff1)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  Document group\_plugin syntax.
  [[2822c6c8c]](https://git.sudo.ws/sudo/commit/?id=2822c6c8c)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Document the sudoers group plugin.
  [[9d1731261]](https://git.sudo.ws/sudo/commit/?id=9d1731261)

* INSTALL, MANIFEST, Makefile.in, config.h.in, configure, configure.in,
  doc/LICENSE, doc/license.pod, include/sudo\_plugin.h,
  plugins/sample\_group/Makefile.in, plugins/sample\_group/getgrent.c,
  plugins/sample\_group/sample\_group.c, plugins/sudoers/Makefile.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/group\_plugin.c,
  plugins/sudoers/match.c, plugins/sudoers/nonunix.h,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/vasgroups.c, plugins/sudoers/visudo.c, src/sudo.c:

  Replace built-in non-unix group support with a sudoers group plugin.
  Include a sample plugin that can read Unix-format group files.
  [[e6b48d415]](https://git.sudo.ws/sudo/commit/?id=e6b48d415)

* configure, configure.in, src/load\_plugins.c:

  Add a trailing slash to \_PATH\_SUDO\_PLUGIN\_DIR to simplify usage.
  [[66eafd099]](https://git.sudo.ws/sudo/commit/?id=66eafd099)

2010-07-01 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.pod, doc/sudoers.cat,
  doc/sudoers.man.in, doc/sudoers.pod:

  Move sudoers-specific bits out of sudo(8) and into sudoers(5)
  [[454534eff]](https://git.sudo.ws/sudo/commit/?id=454534eff)

* aclocal.m4, configure, configure.in:

  Substitute @io\_logdir@ for the sudoers I/O log directory.
  [[9e60378c4]](https://git.sudo.ws/sudo/commit/?id=9e60378c4)

2010-06-29 Todd C. Miller

* MANIFEST, common/Makefile.in, common/aix.c, common/alloc.c,
  common/atobool.c, common/fileops.c, common/fmt\_string.c, common/lbuf.c,
  common/term.c, compat/fnmatch.c, compat/getcwd.c, compat/getgrouplist.c,
  compat/getline.c, compat/glob.c, compat/snprintf.c, config.h.in,
  configure, configure.in, include/fileops.h,
  plugins/sample/sample\_plugin.c, plugins/sudoers/alias.c,
  plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb4.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/boottime.c,
  plugins/sudoers/check.c, plugins/sudoers/defaults.c,
  plugins/sudoers/env.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/getspwuid.c, plugins/sudoers/goodpath.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/interfaces.c, plugins/sudoers/iolog.c,
  plugins/sudoers/ldap.c, plugins/sudoers/logging.c,
  plugins/sudoers/match.c, plugins/sudoers/parse.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/visudo.c, src/Makefile.in, src/conversation.c,
  src/exec.c, src/exec\_pty.c, src/get\_pty.c, src/load\_plugins.c,
  src/parse\_args.c, src/sudo.c, src/sudo.h, src/sudo\_edit.c,
  src/tgetpass.c:

  Set usrinfo for AIX Set adminstrative domain for the process when
  looking up user’s password or group info and when preparing for
  execve(). Include strings.h even if string.h exists since they may
  define different things. Fixes warnings on AIX and others.
  [[30fe4a067]](https://git.sudo.ws/sudo/commit/?id=30fe4a067)

* Makefile.in:

  Add a separate all target for AIX make which was using the entire LHS
  (not just the first entry) of the first target as the implicit target.
  [[fd40be626]](https://git.sudo.ws/sudo/commit/?id=fd40be626)

* plugins/sudoers/env.c:

  Do not rely on env.env\_len when unsetting a variable, just use the NULL
  terminator.
  [[862d1675c]](https://git.sudo.ws/sudo/commit/?id=862d1675c)

* plugins/sudoers/env.c:

  In unsetenv() check for NULL or empty name as per POSIX 1003.1-2008
  [[0c0a02dfd]](https://git.sudo.ws/sudo/commit/?id=0c0a02dfd)

2010-06-25 Todd C. Miller

* plugins/sudoers/vasgroups.c:

  Use warningx() instead of log\_error() since the latter is not available
  to visudo or testsudoers. This does mean that they don’t end up in
  syslog.
  [[895e30184]](https://git.sudo.ws/sudo/commit/?id=895e30184)

* plugins/sudoers/sudoers.c:

  Defer call to sudo\_nonunix\_groupcheck\_cleanup() until after we have
  closed the sudoers sources. From Quest sudo.
  [[189b43fed]](https://git.sudo.ws/sudo/commit/?id=189b43fed)

* plugins/sudoers/pwutil.c:

  Ignore case when matching user/group names in the cache. From Quest
  sudo.
  [[8f58fd36b]](https://git.sudo.ws/sudo/commit/?id=8f58fd36b)

2010-06-24 Todd C. Miller

* config.h.in, configure, configure.in, src/selinux.c:

  Add check for setkeycreatecon() when –with-selinux is specified.
  [[867ba48db]](https://git.sudo.ws/sudo/commit/?id=867ba48db)

* configure, configure.in:

  Error out if libaudit.h is missing or ununable when –with-linux-audit
  was specified
  [[d63f49bca]](https://git.sudo.ws/sudo/commit/?id=d63f49bca)

* doc/HISTORY, doc/history.pod:

  Add =head3 entries, mostly for the html version
  [[175760a44]](https://git.sudo.ws/sudo/commit/?id=175760a44)

2010-06-22 Todd C. Miller

* doc/HISTORY, doc/history.pod:

  Mention when LDAP was incorporate.
  [[e87364437]](https://git.sudo.ws/sudo/commit/?id=e87364437)

2010-06-21 Todd C. Miller

* configure, configure.in:

  Define \_LINUX\_SOURCE\_COMPAT on AIX for strsignal() prototype, it is not
  covered by \_ALL\_SOURCE.
  [[39bccab39]](https://git.sudo.ws/sudo/commit/?id=39bccab39)

2010-06-18 Todd C. Miller

* plugins/sudoers/iolog.c:

  Add a cast to quiet a compiler warning.
  [[d69e4fd42]](https://git.sudo.ws/sudo/commit/?id=d69e4fd42)

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y:

  Quiet a compiler warning.
  [[41b15ae81]](https://git.sudo.ws/sudo/commit/?id=41b15ae81)

* plugins/sudoers/defaults.c, plugins/sudoers/sudoers.c:

  Call set\_fqdn() after sudoers has parsed instead of inline as a
  callback.
  [[d1bf11db3]](https://git.sudo.ws/sudo/commit/?id=d1bf11db3)

* WHATSNEW, plugins/sudoers/sudoers.c:

  Do not call set\_fqdn() until sudoers parses (where is gets run as a
  callback).
  [[d79b0ece1]](https://git.sudo.ws/sudo/commit/?id=d79b0ece1)

* WHATSNEW:

  mention the change in tty ticket behavior when there is no tty
  [[677a0be85]](https://git.sudo.ws/sudo/commit/?id=677a0be85)

* plugins/sudoers/check.c:

  Do not update tty ticket if there is no tty.
  [[f5c5a9bf6]](https://git.sudo.ws/sudo/commit/?id=f5c5a9bf6)

* doc/LICENSE, doc/license.pod:

  Update copyright year
  [[c4da73db1]](https://git.sudo.ws/sudo/commit/?id=c4da73db1)

* doc/Makefile.in:

  Do not rely on BSD make’s $>
  [[cf1d8359c]](https://git.sudo.ws/sudo/commit/?id=cf1d8359c)

* configure, configure.in:

  Set timedir to /var/db/sudo for darwin to match Apple sudo’s location
  [[7c1e75824]](https://git.sudo.ws/sudo/commit/?id=7c1e75824)

2010-06-16 Todd C. Miller

* plugins/sudoers/sudoers.h:

  Add stub declarations for struct stat and struct timeval
  [[9a16dc514]](https://git.sudo.ws/sudo/commit/?id=9a16dc514)

* MANIFEST:

  Remove compat/sigaction.c
  [[87281cf28]](https://git.sudo.ws/sudo/commit/?id=87281cf28)

* config.h.in, configure, configure.in, plugins/sudoers/defaults.c,
  plugins/sudoers/iolog.c, plugins/sudoers/sudoreplay.c:

  Check for zlib.h in addition to libz.
  [[ebc152ce8]](https://git.sudo.ws/sudo/commit/?id=ebc152ce8)

* MANIFEST, src/Makefile.in, src/exec.c, src/exec\_pty.c, src/sudo.h,
  src/sudo\_exec.h:

  Move functions and symbols shared between exec.c and exec\_pty.c into
  sudo\_exec.h.
  [[d018936b4]](https://git.sudo.ws/sudo/commit/?id=d018936b4)

* doc/Makefile.in:

  Comment out rules to build .man.in and .cat files unless –with-devel
  [[ede8a5fad]](https://git.sudo.ws/sudo/commit/?id=ede8a5fad)

* doc/Makefile.in:

  Comment out rules to build .man.in and .cat files unless –with-devel
  [[c1bd1dd60]](https://git.sudo.ws/sudo/commit/?id=c1bd1dd60)

* src/parse\_args.c:

  Quote any non-alphanumeric characters other than ‘\_’ or ‘-’ when passing
  a command to be run via the shell for the -s and -i options.
  [[46355186b]](https://git.sudo.ws/sudo/commit/?id=46355186b)

* doc/Makefile.in:

  Add back .man suffix
  [[6363305b3]](https://git.sudo.ws/sudo/commit/?id=6363305b3)

* INSTALL, MANIFEST, WHATSNEW, config.h.in, configure, configure.in,
  plugins/sudoers/Makefile.in, plugins/sudoers/audit.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/linux\_audit.c,
  plugins/sudoers/linux\_audit.h, plugins/sudoers/logging.h, src/selinux.c:
  Add Linux audit support.
  [[2cd108304]](https://git.sudo.ws/sudo/commit/?id=2cd108304)

2010-06-15 Todd C. Miller

* plugins/sudoers/iolog.c:

  Remove an XXX
  [[fdd480543]](https://git.sudo.ws/sudo/commit/?id=fdd480543)

* doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.pod,
  plugins/sudoers/sudoreplay.c:

  Add -f (filter) option to sudoreplay to allow certain streams to be
  replayed and others ignored.
  [[1025a2ec0]](https://git.sudo.ws/sudo/commit/?id=1025a2ec0)

* src/load\_plugins.c, src/parse\_args.c, src/sudo.c, src/sudo.h,
  src/tgetpass.c:

  Fix -A flag when askpass is specified in sudo.conf or if sudo doesn’t
  need to read a password.
  [[4fb8a83e6]](https://git.sudo.ws/sudo/commit/?id=4fb8a83e6)

* src/exec.c, src/exec\_pty.c, src/parse\_args.c, src/sudo.c, src/sudo.h,
  src/sudo\_edit.c, src/tgetpass.c:

  Clean up some XXXs
  [[f64bb67c6]](https://git.sudo.ws/sudo/commit/?id=f64bb67c6)

* WHATSNEW, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.ldap.pod, plugins/sudoers/ldap.c:

  Add support for multiple sudoers\_base entries in ldap.conf. From Joachim
  Henke
  [[d92c82ea3]](https://git.sudo.ws/sudo/commit/?id=d92c82ea3)

* config.h.in, configure, configure.in, plugins/sudoers/logging.c,
  src/exec\_pty.c:

  remove setsid check, we require a POSIX system
  [[54ffb19cc]](https://git.sudo.ws/sudo/commit/?id=54ffb19cc)

* plugins/sudoers/logging.c, src/exec\_pty.c, src/selinux.c, src/sudo.c,
  src/tgetpass.c:

  Check for dup2() failure.
  [[c2f8d24f2]](https://git.sudo.ws/sudo/commit/?id=c2f8d24f2)

* config.h.in, configure, configure.in:

  Remove dup2() check, it is not optional.
  [[59718c32e]](https://git.sudo.ws/sudo/commit/?id=59718c32e)

2010-06-14 Todd C. Miller

* WHATSNEW:

  sync with sudo 1.7.3
  [[754c3939d]](https://git.sudo.ws/sudo/commit/?id=754c3939d)

* INSTALL:

  SunOS does not ship with an ANSI compiler
  [[65307f89b]](https://git.sudo.ws/sudo/commit/?id=65307f89b)

* INSTALL:

  Update OS specific notes. Delete some really ancient ones and move older
  ones to the end of the list.
  [[96e4b0e20]](https://git.sudo.ws/sudo/commit/?id=96e4b0e20)

* README:

  Sudo can be downloaded from the web site too Mention “OS dependent
  notes” section in INSTALL
  [[8eed6962b]](https://git.sudo.ws/sudo/commit/?id=8eed6962b)

* src/exec\_pty.c, src/selinux.c:

  Call selinux\_restore\_tty() as part of cleanup() so it gets called from
  error()/errorx()
  [[d27223b4c]](https://git.sudo.ws/sudo/commit/?id=d27223b4c)

* MANIFEST, doc/PORTING:

  Remove obsolete porting guide
  [[e1e0ac22b]](https://git.sudo.ws/sudo/commit/?id=e1e0ac22b)

* plugins/sudoers/interfaces.h, plugins/sudoers/match.c:

  Move union sudo\_in\_addr\_un into interfaces.h
  [[fe49f161a]](https://git.sudo.ws/sudo/commit/?id=fe49f161a)

* doc/Makefile.in:

  Remove useless circular dependencies
  [[748467670]](https://git.sudo.ws/sudo/commit/?id=748467670)

* plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb4.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c:

  Convert to ANSI C function declarations
  [[8e2631253]](https://git.sudo.ws/sudo/commit/?id=8e2631253)

* common/alloc.c, common/fileops.c, common/gettime.c, common/list.c,
  common/zero\_bytes.c, compat/charclass.h, compat/closefrom.c,
  compat/fnmatch.c, compat/glob.c, compat/isblank.c, compat/memrchr.c,
  compat/mkstemp.c, compat/nanosleep.c, compat/snprintf.c,
  compat/strcasecmp.c, compat/strerror.c, compat/strlcat.c,
  compat/strlcpy.c, compat/timespec.h, compat/utime.h, compat/utimes.c,
  doc/HISTORY, doc/history.pod, doc/license.pod, include/alloc.h,
  include/error.h, include/lbuf.h, include/list.h, include/missing.h,
  pathnames.h.in, plugins/sudoers/alias.c, plugins/sudoers/audit.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/boottime.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/bsm\_audit.h,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/find\_path.c, plugins/sudoers/getspwuid.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.y,
  plugins/sudoers/interfaces.c, plugins/sudoers/interfaces.h,
  plugins/sudoers/logging.c, plugins/sudoers/logging.h,
  plugins/sudoers/match.c, plugins/sudoers/parse.h,
  plugins/sudoers/plugin\_error.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/redblack.c, plugins/sudoers/redblack.h,
  plugins/sudoers/sudo\_nss.h, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestr.c, plugins/sudoers/toke.l,
  plugins/sudoers/visudo.c, src/aix.c, src/conversation.c, src/error.c,
  src/load\_plugins.c, src/parse\_args.c, src/sesh.c, src/sudo.h,
  src/sudo\_noexec.c, src/sudo\_plugin\_int.h, src/sudo\_usage.h.in,
  src/tgetpass.c:

  Update copyright year
  [[b72a530fd]](https://git.sudo.ws/sudo/commit/?id=b72a530fd)

* doc/Makefile.in:

  Fix commented DEVDOCS when not in devel mode.
  [[a7a4ec6fb]](https://git.sudo.ws/sudo/commit/?id=a7a4ec6fb)

* plugins/sudoers/match.c:

  Quiet a compiler warning.
  [[b09a643ff]](https://git.sudo.ws/sudo/commit/?id=b09a643ff)

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y:

  Quiet a compiler warning.
  [[848b636f2]](https://git.sudo.ws/sudo/commit/?id=848b636f2)

* plugins/sudoers/ldap.c, plugins/sudoers/sudoers.h:

  Make all functions in ldap.c static
  [[3430618c7]](https://git.sudo.ws/sudo/commit/?id=3430618c7)

* doc/schema.ActiveDirectory:

  Updates from Alain Roy to provide better examples for importing the
  schema and to fix problems caused by Windows validating attributes which
  have not yet been added before committing the changes.
  [[93d48cfc6]](https://git.sudo.ws/sudo/commit/?id=93d48cfc6)

2010-06-11 Todd C. Miller

* configure, configure.in, doc/Makefile.in, doc/sudo.cat, doc/sudo.man.in,
  doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudoers.cat,
  doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in, doc/sudoers.man.in,
  doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/visudo.cat,
  doc/visudo.man.in:

  Leave rules to build .man.in and .cat files uncommented but only make
  them part of the “all” rule in devel mode. Generate .cat files directly
  from .man.in instead of .man using default values in configure.in
  [[ec77318e3]](https://git.sudo.ws/sudo/commit/?id=ec77318e3)

* configure, configure.in:

  Bump sudo version to 1.8.0b1
  [[608a3e7a2]](https://git.sudo.ws/sudo/commit/?id=608a3e7a2)

* configure, configure.in, src/sudo.c, src/sudo\_usage.h.in:

  Print configure args with verbose version information.
  [[a28a4764e]](https://git.sudo.ws/sudo/commit/?id=a28a4764e)

* TODO, plugins/sudoers/visudo.c:

  Remove tfd from struct sudoersfile; it is not used. Add prev pointer to
  struct sudoersfile. Declare list of sudoersfile using TQ\_DECLARE. Use
  tq\_append to append sudoers entries to the tail queue.
  [[3516d7f0e]](https://git.sudo.ws/sudo/commit/?id=3516d7f0e)

2010-06-10 Todd C. Miller

* WHATSNEW:

  Describe tty timestamp improvements
  [[6d0b74cf1]](https://git.sudo.ws/sudo/commit/?id=6d0b74cf1)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  A comment character may not be part of a command line argument unless it
  is quoted with a backslash. Fixes parsing of: testuser ALL=NOPASSWD:
  /usr/bin/wl #comment foo bar closes bz #441
  [[27a94faf7]](https://git.sudo.ws/sudo/commit/?id=27a94faf7)

* doc/sudoers.pod:

  Make this read a little bit better when passwd\_timeout is 0.
  [[f67ac02af]](https://git.sudo.ws/sudo/commit/?id=f67ac02af)

* doc/sudo.man.in, doc/sudo.man.pl, doc/sudo.pod:

  Attempt to handle a default password prompt timeout of zero more
  gracefully.
  [[10d83e2cb]](https://git.sudo.ws/sudo/commit/?id=10d83e2cb)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  Do not override value of keepopen global, instead restore it to the
  value we pushed onto the stack when popping.
  [[32d4697a8]](https://git.sudo.ws/sudo/commit/?id=32d4697a8)

* plugins/sudoers/Makefile.in:

  Add dependency for utility programs on libreplace and libcommon
  [[17a8bd807]](https://git.sudo.ws/sudo/commit/?id=17a8bd807)

* compat/sigaction.c, config.h.in, configure.in, include/compat.h,
  plugins/sudoers/logging.c, plugins/sudoers/mon\_systrace.c, src/exec.c,
  src/exec\_pty.c, src/tgetpass.c:

  Remove sigaction emulation Use SA\_INTERRUPT in sa\_flags
  [[047fc3876]](https://git.sudo.ws/sudo/commit/?id=047fc3876)

* MANIFEST, config.h.in, configure, configure.in, include/missing.h:

  We don’t use getgrouplist() at the moment so there’s no need to provide
  a compat version.
  [[e54cfc9bd]](https://git.sudo.ws/sudo/commit/?id=e54cfc9bd)

* TODO:

  sync with reality
  [[779528487]](https://git.sudo.ws/sudo/commit/?id=779528487)

* include/sudo\_plugin.h, plugins/sudoers/auth/sudo\_auth.c,
  src/conversation.c, src/sudo.h, src/tgetpass.c:

  Fix visiblepw sudoers option; the plugin API portion still needs
  documenting
  [[e146aaaa2]](https://git.sudo.ws/sudo/commit/?id=e146aaaa2)

* src/sudo.c:

  Print sudo version as well.
  [[879d01796]](https://git.sudo.ws/sudo/commit/?id=879d01796)

* plugins/sudoers/iolog.c, plugins/sudoers/sudoers.c:

  Use sudo\_printf for I/O log version Clarify policy plugin version string
  [[1fbb1819e]](https://git.sudo.ws/sudo/commit/?id=1fbb1819e)

* plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/ldap.c, plugins/sudoers/sudoreplay.c:

  Silence some compiler warnings
  [[c6371aa48]](https://git.sudo.ws/sudo/commit/?id=c6371aa48)

* src/load\_plugins.c, src/tgetpass.c:

  Store askpass path in a global instead of uses setenv() which many
  systems lack.
  [[b91b65722]](https://git.sudo.ws/sudo/commit/?id=b91b65722)

2010-06-09 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.pod, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod, plugins/sudoers/check.c,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  src/load\_plugins.c, src/parse\_args.c, src/tgetpass.c:

  Move askpass path specification from sudoers to sudo.conf.
  [[eec336115]](https://git.sudo.ws/sudo/commit/?id=eec336115)

* src/exec.c, src/exec\_pty.c, src/sudo.c, src/sudo.h:

  Use a flag bit in struct command\_details for selinux instead of a
  separate field.
  [[34613c846]](https://git.sudo.ws/sudo/commit/?id=34613c846)

* src/exec.c, src/exec\_pty.c, src/sudo.c, src/sudo.h:

  Implement background mode. If I/O logging we use pipes instead of a pty.
  [[4c1ef1264]](https://git.sudo.ws/sudo/commit/?id=4c1ef1264)

* compat/mksiglist.c, compat/strsignal.c, include/compat.h, src/exec.c,
  src/exec\_pty.c, src/tgetpass.c:

  Move compat definition of NSIG to compat.h
  [[c5a6ca998]](https://git.sudo.ws/sudo/commit/?id=c5a6ca998)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.pod, doc/sudo\_plugin.cat,
  doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Mention plugins in the sudo manual and add some missing path
  substitution in the sudo\_plugin manual.
  [[9d09966aa]](https://git.sudo.ws/sudo/commit/?id=9d09966aa)

* src/Makefile.in:

  Set \_PATH\_SUDO\_CONF based on $(sysconfdir)
  [[474392821]](https://git.sudo.ws/sudo/commit/?id=474392821)

* common/lbuf.c, common/term.c, config.h.in, configure, configure.in,
  src/exec.c, src/exec\_pty.c, src/ttysize.c:

  Require POSIX termios to build sudo
  [[e5283b2f9]](https://git.sudo.ws/sudo/commit/?id=e5283b2f9)

* src/tgetpass.c:

  Ignore SIGPIPE for “sudo -S”
  [[82a56e421]](https://git.sudo.ws/sudo/commit/?id=82a56e421)

* src/tgetpass.c:

  Fix uninitialized variable in TGP\_ECHO case and print a newline if the
  user interrupted password input.
  [[afb3f9dbf]](https://git.sudo.ws/sudo/commit/?id=afb3f9dbf)

* src/tgetpass.c:

  Make TGP\_ECHO override TGP\_MASK and don’t try to restore the terminal if
  we didn’t modify it.
  [[3e9ecaf1e]](https://git.sudo.ws/sudo/commit/?id=3e9ecaf1e)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod,
  include/sudo\_plugin.h, plugins/sudoers/auth/sudo\_auth.c,
  src/conversation.c, src/sudo.h, src/tgetpass.c:

  Add SUDO\_CONV\_PROMPT\_MASK define which corresponds to the “pwfeedback”
  sudoers option. Do not disable echo if TGP\_ECHO is set.
  [[a4a6620b2]](https://git.sudo.ws/sudo/commit/?id=a4a6620b2)

* src/exec\_pty.c:

  Use POSIX tcgetpgrp() instead of BSD TIOCGPGRP ioctl
  [[51f70f204]](https://git.sudo.ws/sudo/commit/?id=51f70f204)

2010-06-08 Todd C. Miller

* src/exec.c, src/exec\_pty.c, src/selinux.c, src/sudo.c, src/sudo.h:

  Add selinux\_enabled flag into struct command\_details and set it in
  command\_info\_to\_details(). Return an error from selinux\_setup() instead
  of exiting. Call selinux\_setup() from exec\_setup().
  [[edd34a2d7]](https://git.sudo.ws/sudo/commit/?id=edd34a2d7)

2010-06-09 Todd C. Miller

* src/exec\_pty.c:

  Remove commented out copy of old sudo\_execve() function.
  [[ecfb70b05]](https://git.sudo.ws/sudo/commit/?id=ecfb70b05)

2010-06-08 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Fix setting selinux type on command line.
  [[bcaf51ce6]](https://git.sudo.ws/sudo/commit/?id=bcaf51ce6)

* plugins/sudoers/iolog.c:

  In sudoers\_io\_close(), skip NULL io\_fds[] elements.
  [[9b4203606]](https://git.sudo.ws/sudo/commit/?id=9b4203606)

* include/compat.h:

  No longer need NGROUPS\_MAX define
  [[16da9fe80]](https://git.sudo.ws/sudo/commit/?id=16da9fe80)

* compat/nanosleep.c, config.h.in, configure, configure.in,
  include/compat.h, plugins/sudoers/check.c, plugins/sudoers/iolog.c,
  plugins/sudoers/visudo.c, src/sudo\_edit.c:

  Replace timerfoo macros with timevalfoo since the timer macros are known
  to be busted on some systems.
  [[79f178923]](https://git.sudo.ws/sudo/commit/?id=79f178923)

* src/exec\_pty.c:

  Remove duplicate call to selinux\_setup().
  [[0be6bab05]](https://git.sudo.ws/sudo/commit/?id=0be6bab05)

* plugins/sudoers/auth/pam.c:

  If pam\_open\_session() fails, pass its status to pam\_end.
  [[426435c12]](https://git.sudo.ws/sudo/commit/?id=426435c12)

* plugins/sudoers/toke.c, plugins/sudoers/toke.l:

  If a file in a #includedir has improper permissions or owner just skip
  it. This prevents packages that incorrectly install a file into
  /etc/sudoers.d from breaking sudo so easily. Syntax errors in
  #includedir files still result in a parse error (for now).
  [[303da7b82]](https://git.sudo.ws/sudo/commit/?id=303da7b82)

* WHATSNEW, doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/iolog.c:

  Add use\_pty sudoers option to force use of a pty even when not logging
  I/O.
  [[6f05b565c]](https://git.sudo.ws/sudo/commit/?id=6f05b565c)

* plugins/sudoers/env.c, plugins/sudoers/sudoers.h:

  Make env\_init() void as it never fails.
  [[39e072c71]](https://git.sudo.ws/sudo/commit/?id=39e072c71)

* plugins/sudoers/env.c:

  No longer use \_NSGetEnviron so don’t need crt\_externs.h
  [[280afece3]](https://git.sudo.ws/sudo/commit/?id=280afece3)

* plugins/sudoers/env.c:

  Remove unused VNULL define
  [[26b501423]](https://git.sudo.ws/sudo/commit/?id=26b501423)

2010-06-07 Todd C. Miller

* plugins/sudoers/iolog.c:

  Add #define for maximum session id
  [[3aad38118]](https://git.sudo.ws/sudo/commit/?id=3aad38118)

* MANIFEST, src/Makefile.in, src/exec.c, src/exec\_pty.c, src/sudo.h:

  Split exec.c into exec.c and exec\_pty.c
  [[6717c59d7]](https://git.sudo.ws/sudo/commit/?id=6717c59d7)

* MANIFEST:

  Sync with source file moves.
  [[d417d4e4e]](https://git.sudo.ws/sudo/commit/?id=d417d4e4e)

* src/Makefile.in, src/get\_pty.c:

  Rename pty.c -> get\_pty.c
  [[d6e7face2]](https://git.sudo.ws/sudo/commit/?id=d6e7face2)

2010-06-06 Todd C. Miller

* plugins/sudoers/iolog.c:

  Only use I/O input log file if def\_log\_input is set and output file if
  def\_log\_output is set.
  [[38138e7d1]](https://git.sudo.ws/sudo/commit/?id=38138e7d1)

2010-06-04 Todd C. Miller

* compat/strsignal.c:

  Update copyright year
  [[5099b68b0]](https://git.sudo.ws/sudo/commit/?id=5099b68b0)

* src/pty.c:

  uid -> ttyuid
  [[5aa2c7dcc]](https://git.sudo.ws/sudo/commit/?id=5aa2c7dcc)

* plugins/sudoers/sudoers.c:

  For sudoedit, make a local copy of editor string si become part of argv.
  If no editor environment variable, split def\_editor on ‘:’ since it may
  be a colon-delimited path.
  [[afa3589d5]](https://git.sudo.ws/sudo/commit/?id=afa3589d5)

* src/sudo\_edit.c:

  Remove unneeded endpwent()/endgrent()
  [[e3ac18f51]](https://git.sudo.ws/sudo/commit/?id=e3ac18f51)

* doc/Makefile.in:

  Use value of nroff from configure
  [[4ecb00566]](https://git.sudo.ws/sudo/commit/?id=4ecb00566)

* src/exec.c:

  Add missing const to I/O log action function
  [[3fbd83478]](https://git.sudo.ws/sudo/commit/?id=3fbd83478)

* plugins/sudoers/check.c:

  Update copyright year and fix whitespace
  [[8fa9464d0]](https://git.sudo.ws/sudo/commit/?id=8fa9464d0)

* configure, configure.in:

  Fix typo
  [[b97d47424]](https://git.sudo.ws/sudo/commit/?id=b97d47424)

* plugins/sudoers/iolog.c:

  Remove redundant tty signal blocking in log function.
  [[fe5723222]](https://git.sudo.ws/sudo/commit/?id=fe5723222)

2010-06-03 Todd C. Miller

* plugins/sudoers/iolog.c:

  Place static keyword where it belongs
  [[4a7fc9a82]](https://git.sudo.ws/sudo/commit/?id=4a7fc9a82)

* plugins/sudoers/logging.c:

  Always use a printf format string for send\_mail()
  [[8ebd90998]](https://git.sudo.ws/sudo/commit/?id=8ebd90998)

* common/atobool.c, plugins/sudoers/ldap.c:

  Extend atobool() so we can use it in the LDAP code.
  [[40e591c30]](https://git.sudo.ws/sudo/commit/?id=40e591c30)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.pod:

  Sudo now stashes tty ctime for tty\_tickets on Solaris too.
  [[59e292537]](https://git.sudo.ws/sudo/commit/?id=59e292537)

* plugins/sudoers/boottime.c:

  Fix dummy version of get\_boottime()
  [[fd1765b56]](https://git.sudo.ws/sudo/commit/?id=fd1765b56)

2010-06-02 Todd C. Miller

* plugins/sudoers/check.c:

  Enable tty\_is\_devpts() support for Solaris with the “devices”
  filesystem.
  [[7ce0dfc61]](https://git.sudo.ws/sudo/commit/?id=7ce0dfc61)

* src/exec.c:

  Unbreak the non-io logging case.
  [[cd26d2891]](https://git.sudo.ws/sudo/commit/?id=cd26d2891)

* src/conversation.c, src/sudo.c, src/sudo\_plugin\_int.h:

  Fix symbol name conflict with sudo\_printf.
  [[2b8fc46e2]](https://git.sudo.ws/sudo/commit/?id=2b8fc46e2)

* plugins/sudoers/auth/pam.c:

  Fix OpenPAM detection for newer versions.
  [[41436a786]](https://git.sudo.ws/sudo/commit/?id=41436a786)

* plugins/sudoers/vasgroups.c:

  Sync with Quest sudo git repo
  [[78e7c649f]](https://git.sudo.ws/sudo/commit/?id=78e7c649f)

* aclocal.m4, configure, configure.in:

  HP-UX ld uses +b instead or -R or -rpath Fix typo in libvas check Add
  missing template for ENV\_DEBUG Adapted from Quest sudo
  [[572c88541]](https://git.sudo.ws/sudo/commit/?id=572c88541)

* README.LDAP:

  Fix typos; from Quest Sudo
  [[c24e6277f]](https://git.sudo.ws/sudo/commit/?id=c24e6277f)

2010-06-01 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Add back -I$(top\_srcdir); we need it for including compat/foo.h since we
  cannot rely on “foo.h” being found relative to the source file when the
  cwd is different.
  [[1afba5165]](https://git.sudo.ws/sudo/commit/?id=1afba5165)

* src/exec.c:

  Fix a bug where we could treat EAGAIN as a permanent error. Also set
  cstat if perform\_io() returns an error.
  [[1eafb30a4]](https://git.sudo.ws/sudo/commit/?id=1eafb30a4)

* common/alloc.c, plugins/sudoers/boottime.c, plugins/sudoers/sudoers.c:

  Add casts to quiet compiler warnings.
  [[2ee752410]](https://git.sudo.ws/sudo/commit/?id=2ee752410)

* plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Fix typo in ternary operator usage.
  [[be3b7d615]](https://git.sudo.ws/sudo/commit/?id=be3b7d615)

2010-05-30 Todd C. Miller

* INSTALL, configure, configure.in:

  Add –enable-warnings and fix typo in SUDO\_IO\_LOGDIR
  [[942552798]](https://git.sudo.ws/sudo/commit/?id=942552798)

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod,
  doc/sudoreplay.cat, doc/sudoreplay.man.in, doc/sudoreplay.pod:

  Update docs to match sudoers I/O logging changes
  [[4230d8562]](https://git.sudo.ws/sudo/commit/?id=4230d8562)

* INSTALL, WHATSNEW, aclocal.m4, configure, configure.in, pathnames.h.in,
  plugins/sudoers/def\_data.c, plugins/sudoers/def\_data.h,
  plugins/sudoers/def\_data.in, plugins/sudoers/defaults.c,
  plugins/sudoers/gram.c, plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/iolog.c, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c:

  Break sudoers transcript feature up into log\_input and log\_output.
  [[2dd29bf64]](https://git.sudo.ws/sudo/commit/?id=2dd29bf64)

* plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/visudo.c:

  Use setprogname() as needed.
  [[1a217bcc2]](https://git.sudo.ws/sudo/commit/?id=1a217bcc2)

* plugins/sudoers/iolog.c, plugins/sudoers/sudoreplay.c:

  Adapt sudoreplay to iolog changes.
  [[0e2d33b5f]](https://git.sudo.ws/sudo/commit/?id=0e2d33b5f)

2010-05-29 Todd C. Miller

* plugins/sudoers/iolog.c:

  Log all input and output into separate files and store a number on each
  timing file line to indicate which file the data is in.
  [[e51fd3ab7]](https://git.sudo.ws/sudo/commit/?id=e51fd3ab7)

* plugins/sudoers/iolog.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Make sudoers\_io functions static to iolog.c
  [[b6f02f38c]](https://git.sudo.ws/sudo/commit/?id=b6f02f38c)

2010-05-28 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.pod, src/parse\_args.c,
  src/sudo\_usage.h.in:

  Completely remove the -L flag from the sudo front end.
  [[73b630fa9]](https://git.sudo.ws/sudo/commit/?id=73b630fa9)

* plugins/sudoers/sudoreplay.c:

  Fix EAGAIN handling when writing to stdout.
  [[1ffb76178]](https://git.sudo.ws/sudo/commit/?id=1ffb76178)

* plugins/sudoers/sudoers.c:

  Eliminate unused variables
  [[e952c8c7f]](https://git.sudo.ws/sudo/commit/?id=e952c8c7f)

* plugins/sudoers/sudoers.c, src/exec.c, src/sudo.c:

  Re-enable cleanup functions in sudoers plugin and sudo driver for
  error()/errorx().
  [[d2d68aa24]](https://git.sudo.ws/sudo/commit/?id=d2d68aa24)

* plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/defaults.c,
  plugins/sudoers/interfaces.c, plugins/sudoers/iolog.c,
  plugins/sudoers/parse.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c:

  Use sudo\_printf to display verbose version information.
  [[34e1a0676]](https://git.sudo.ws/sudo/commit/?id=34e1a0676)

* common/Makefile.in, compat/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Minor Makefile cleanup: fix a typo, change the removal order in the
  clean targets, and remove a superfluous include path for the sudoers
  plugin.
  [[303d85606]](https://git.sudo.ws/sudo/commit/?id=303d85606)

* plugins/sudoers/env.c:

  Handle duplicate variables in the environment. For unsetenv(), keep
  looking even after remove the first instance. For sudo\_putenv(), check
  for and remove dupes after we replace an existing value.
  [[c31ed2cd2]](https://git.sudo.ws/sudo/commit/?id=c31ed2cd2)

2010-05-27 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Use explicit path to source file instead of $< for files that live in
  devdir and top\_srcdir.
  [[12aedc675]](https://git.sudo.ws/sudo/commit/?id=12aedc675)

* plugins/sudoers/Makefile.in:

  Add explicit rules to compile gram.c and toke.c for HP-UX Pevent ending
  LIBSUDOERS\_OBJS with a backslash
  [[a8bb0ea0a]](https://git.sudo.ws/sudo/commit/?id=a8bb0ea0a)

* plugins/sudoers/Makefile.in, src/Makefile.in:

  Link libcommon before libreplace since libcommon may use functions only
  present in libreplace.
  [[62f470a57]](https://git.sudo.ws/sudo/commit/?id=62f470a57)

* common/Makefile.in:

  Move code common to sudo and the sudoers plugin to a convenience
  library, libcommon. Removes the need to make links in the sudoers plugin
  dir and reduces re-compilation of duplicate object files.
  [[c4feed1cc]](https://git.sudo.ws/sudo/commit/?id=c4feed1cc)

* Makefile.in, common/alloc.c, common/atobool.c, common/fileops.c,
  common/fmt\_string.c, common/gettime.c, common/lbuf.c, common/list.c,
  common/term.c, common/zero\_bytes.c, configure, configure.in,
  plugins/sample/Makefile.in, plugins/sudoers/Makefile.in,
  src/Makefile.in:

  Move code common to sudo and the sudoers plugin to a convenience
  library, libcommon. Removes the need to make links in the sudoers plugin
  dir and reduces re-compilation of duplicate object files.
  [[b8b006a88]](https://git.sudo.ws/sudo/commit/?id=b8b006a88)

* src/exec.c, src/sudo.c, src/sudo.h:

  Rename script\_execve to sudo\_execve and rename script\_foo in exec.c
  [[9773ba3f7]](https://git.sudo.ws/sudo/commit/?id=9773ba3f7)

* MANIFEST, src/Makefile.in, src/exec.c:

  rename script.c exec.c and fix up the MANIFEST file
  [[4248a11ef]](https://git.sudo.ws/sudo/commit/?id=4248a11ef)

* src/script.c, src/sudo.c, src/sudo.h:

  Rename script\_setup() to pty\_setup() and call from script\_execve()
  directly.
  [[f8f82ffa8]](https://git.sudo.ws/sudo/commit/?id=f8f82ffa8)

* configure, configure.in:

  bump version to 1.8.0a2
  [[349fedb02]](https://git.sudo.ws/sudo/commit/?id=349fedb02)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Document init\_session
  [[0b6a687bf]](https://git.sudo.ws/sudo/commit/?id=0b6a687bf)

* plugins/sudoers/auth/API, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h:

  Clean up the sudoers auth API a bit and update the docs.
  [[b2ed46652]](https://git.sudo.ws/sudo/commit/?id=b2ed46652)

* include/sudo\_plugin.h, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, src/script.c, src/sudo.c:

  Add init\_session function to struct policy\_plugin that gets called
  before the uid/gid/etc changes. A struct passwd pointer is passed
  in,which may be NULL if the user does not exist in the passwd
  database.The sudoers module uses init\_session to open the pam session as
  needed.
  [[7e6d1d1f7]](https://git.sudo.ws/sudo/commit/?id=7e6d1d1f7)

2010-05-26 Todd C. Miller

* plugins/sudoers/auth/pam.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Add open/close session to sudo auth, only used by PAM. This allows us to
  open (and close) the PAM session from sudoers.
  [[27be96c9c]](https://git.sudo.ws/sudo/commit/?id=27be96c9c)

* plugins/sudoers/Makefile.in:

  Add explicit rule to build getdate.o for HP-UX make.
  [[a0646aa4a]](https://git.sudo.ws/sudo/commit/?id=a0646aa4a)

* plugins/sudoers/Makefile.in:

  Back out most of change 45e406ebdea2. Create dummy .l.c and .y.c rules
  as an alternate way to prevent HP-UX make (and others) from trying to
  rebuild the parser in non-dev mode.
  [[f14d3dca1]](https://git.sudo.ws/sudo/commit/?id=f14d3dca1)

* plugins/sudoers/sudoers.c:

  Re-enable PATH\_MAX check for command
  [[4695dd1b7]](https://git.sudo.ws/sudo/commit/?id=4695dd1b7)

* Makefile.in:

  For distclean, clean the main directory last since the subdirs need to
  be able to run libtool to clean things.
  [[c7d685b90]](https://git.sudo.ws/sudo/commit/?id=c7d685b90)

* compat/Makefile.in:

  Fix generation of mksiglist.h
  [[acc60712e]](https://git.sudo.ws/sudo/commit/?id=acc60712e)

* src/script.c:

  Now that we defer sending cstat until the end of script\_child() we
  cannot reuse cstat when reading command status from parent.
  [[efa908448]](https://git.sudo.ws/sudo/commit/?id=efa908448)

2010-05-25 Todd C. Miller

* configure, configure.in, doc/sudo.man.in, doc/sudo.man.pl,
  doc/sudoers.cat, doc/sudoers.ldap.cat, doc/sudoers.ldap.man.in,
  doc/sudoers.man.in, doc/sudoers.man.pl, doc/sudoreplay.cat,
  doc/sudoreplay.man.in, doc/visudo.cat, doc/visudo.man.in:

  Use numeric registers to handle conditionals instead of trying to do it
  all with text processing.
  [[807d1313a]](https://git.sudo.ws/sudo/commit/?id=807d1313a)

* doc/sudoers.pod:

  Document per-command SELinux settings
  [[5dd8e98ec]](https://git.sudo.ws/sudo/commit/?id=5dd8e98ec)

* plugins/sudoers/sudoers.c:

  Repair “sudo -l -U username”
  [[45923111e]](https://git.sudo.ws/sudo/commit/?id=45923111e)

* plugins/sudoers/sudoers.c:

  Set selinux role and type in command details.
  [[937b5f166]](https://git.sudo.ws/sudo/commit/?id=937b5f166)

* src/script.c, src/selinux.c, src/sudo.h:

  Rework SELinux support.
  [[2942edcbd]](https://git.sudo.ws/sudo/commit/?id=2942edcbd)

2010-05-24 Todd C. Miller

* src/script.c, src/selinux.c, src/sudo.h:

  Make SELinux support compile again. Needs more work to be complete.
  [[5f857e6e5]](https://git.sudo.ws/sudo/commit/?id=5f857e6e5)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h, src/parse\_args.c,
  src/script.c, src/selinux.c, src/sudo.c, src/sudo.h:

  Bring back closefrom settings.
  [[0487aee6b]](https://git.sudo.ws/sudo/commit/?id=0487aee6b)

* plugins/sudoers/iolog.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  If running a command or sudoedit in transcript mode, call io\_nextid()
  before log\_allowed() so the session id is logged.
  [[60e0e496e]](https://git.sudo.ws/sudo/commit/?id=60e0e496e)

* configure, configure.in:

  Use mandoc(1) if nroff(1) is not present.
  [[79cb53c62]](https://git.sudo.ws/sudo/commit/?id=79cb53c62)

* doc/Makefile.in:

  Use the –file argument to config.status instead of setting CONFIG\_FILES
  in the environment.
  [[b519f7a09]](https://git.sudo.ws/sudo/commit/?id=b519f7a09)

* plugins/sudoers/Makefile.in:

  We cannot conditionally update gram.h or the dependency ordering gets
  messed up in devel mode.
  [[5dd7fd430]](https://git.sudo.ws/sudo/commit/?id=5dd7fd430)

2010-05-21 Todd C. Miller

* Makefile.in, compat/Makefile.in, configure, configure.in,
  doc/Makefile.in, include/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Substitute @SHELL@ into Makefiles
  [[8a8830e34]](https://git.sudo.ws/sudo/commit/?id=8a8830e34)

* config.sub:

  Fix typo
  [[222a4f7c8]](https://git.sudo.ws/sudo/commit/?id=222a4f7c8)

* config.guess, config.sub, configure, configure.in:

  Update to autoconf 2.65
  [[755752c6b]](https://git.sudo.ws/sudo/commit/?id=755752c6b)

* Makefile.in:

  Fix libtool target (space vs. tabs)
  [[815e40128]](https://git.sudo.ws/sudo/commit/?id=815e40128)

* config.h.in, plugins/sudoers/logging.h, plugins/sudoers/visudo.c:

  Remove use of RETSIGTYPE; all modern systems have signal handlers that
  return void.
  [[8ae8e8442]](https://git.sudo.ws/sudo/commit/?id=8ae8e8442)

* Makefile.in, aclocal.m4, acsite.m4, configure, configure.in, ltmain.sh,
  m4/libtool.m4, m4/ltoptions.m4, m4/ltsugar.m4, m4/ltversion.m4,
  m4/lt~obsolete.m4, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Update to libtool-2.2.6b. I haven’t made any local modifications this
  time, which should be OK since we install sudo\_noexec.so by hand now.
  [[51b558e75]](https://git.sudo.ws/sudo/commit/?id=51b558e75)

* compat/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Use libtool to clean objects
  [[6b370cb02]](https://git.sudo.ws/sudo/commit/?id=6b370cb02)

* include/Makefile.in:

  Install sudo\_plugin.h as part of “make install” and make other install
  targets callable from the top-level Makefile
  [[a60f268a7]](https://git.sudo.ws/sudo/commit/?id=a60f268a7)

* configure, configure.in:

  regen with autoupdate to eliminate AC\_TRY\_LINK
  [[60b532155]](https://git.sudo.ws/sudo/commit/?id=60b532155)

* Makefile.in, compat/Makefile.in, configure, configure.in,
  doc/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Install sudo\_plugin.h as part of “make install” and make other install
  targets callable from the top-level Makefile
  [[95d939f9b]](https://git.sudo.ws/sudo/commit/?id=95d939f9b)

* plugins/sample/sample\_plugin.c:

  The sample plugin doesn’t support being run with no args so return a
  usage error in this case.
  [[b628e15dc]](https://git.sudo.ws/sudo/commit/?id=b628e15dc)

* plugins/sudoers/iolog.c:

  Set close on exec flag for descriptors used for I/O logging so they are
  not present in the command being run.
  [[f59669fc2]](https://git.sudo.ws/sudo/commit/?id=f59669fc2)

* plugins/sudoers/tsgetgrpw.c:

  Set close on exec flag in private versions of setpwent() and setgrent().
  [[d3d8364d4]](https://git.sudo.ws/sudo/commit/?id=d3d8364d4)

* src/script.c:

  Close the I/O pipes aftering dup2()ing them to std{in,out,err}. Fixes
  extra fds being present in the command when it is part of a pipeline.
  [[16c2769ed]](https://git.sudo.ws/sudo/commit/?id=16c2769ed)

* plugins/sudoers/sudoers.c:

  Set user\_tty to “unknown” if there is no tty, like sudo 1.7 does (it is
  used when logging). Note that user\_ttypath will still be NULL if there
  is no tty.
  [[529bfcf67]](https://git.sudo.ws/sudo/commit/?id=529bfcf67)

* src/script.c, src/sudo.h:

  Cosmetic changes: add comments, remove orphaned prototype and make a
  global static.
  [[064cffd57]](https://git.sudo.ws/sudo/commit/?id=064cffd57)

2010-05-20 Todd C. Miller

* src/script.c:

  Move check for maxfd == -1 to flush\_output where it belongs.
  [[a9a16d733]](https://git.sudo.ws/sudo/commit/?id=a9a16d733)

* src/script.c:

  Break out of select loop if all the fds we want to select on are -1.
  [[d18b458e1]](https://git.sudo.ws/sudo/commit/?id=d18b458e1)

* src/sudo.c:

  Avoid possible malloc(0) if plugin returns an empty groups list.
  [[20c125297]](https://git.sudo.ws/sudo/commit/?id=20c125297)

* src/sudo.c:

  Add debugging info when calling plugin close function
  [[9360e67a3]](https://git.sudo.ws/sudo/commit/?id=9360e67a3)

* src/script.c:

  Avoid closing stdin/stdout/stderr when we are piping output.
  [[882fe3ac4]](https://git.sudo.ws/sudo/commit/?id=882fe3ac4)

* src/script.c:

  When execve() of the command fails, it is possible to receive SIGCHLD
  before we’ve read the error status from the pipe. Re-order things such
  that we send the final status at the very end and prefer error status
  over wait status.
  [[f8ff26831]](https://git.sudo.ws/sudo/commit/?id=f8ff26831)

2010-05-19 Todd C. Miller

* plugins/sudoers/auth/sudo\_auth.c:

  Fix compilation for non PAM/BSD auth/AIX auth
  [[d2b8bad2a]](https://git.sudo.ws/sudo/commit/?id=d2b8bad2a)

2010-05-18 Todd C. Miller

* src/script.c:

  Additional checks to make sure we don’t close /dev/tty by mistake. When
  flushing, sleep in select as long as we have buffers that need to be
  written out.
  [[0eec7335a]](https://git.sudo.ws/sudo/commit/?id=0eec7335a)

* src/script.c:

  Now that we can use pipes for stdin/stdout/stderr there is no longer a
  need to error out when there is no tty. We just need to make sure we
  don’t try to use the tty fd if it is -1.
  [[6a2a182e0]](https://git.sudo.ws/sudo/commit/?id=6a2a182e0)

2010-05-17 Todd C. Miller

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod,
  include/sudo\_plugin.h, plugins/sample/sample\_plugin.c,
  plugins/sudoers/iolog.c, plugins/sudoers/sudoers.h, src/sudo.c:

  Add argc and argv to I/O logger open function.
  [[55ef027d8]](https://git.sudo.ws/sudo/commit/?id=55ef027d8)

* doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod, include/sudo\_plugin.h,
  plugins/sample/sample\_plugin.c, plugins/sudoers/sudoers.c,
  src/parse\_args.c, src/sudo.c, src/sudo\_edit.c:

  Remove check\_sudoedit function pointer in struct sudo\_policy. Instead,
  sudo will set sudoedit=true in the settings array. The plugin should
  check for this and modify argv\_out as appropriate in check\_policy.
  [[fa717176b]](https://git.sudo.ws/sudo/commit/?id=fa717176b)

2010-05-16 Todd C. Miller

* plugins/sample/sample\_plugin.c, src/sudo.c, src/sudo.h, src/sudo\_edit.c:
  If plugin sets “sudoedit=true” in the command info, enable sudoedit mode
  even if not invoked as sudoedit. This allows a plugin to enable sudoedit
  when the user runs an editor.
  [[3ac9aee52]](https://git.sudo.ws/sudo/commit/?id=3ac9aee52)

2010-05-15 Todd C. Miller

* plugins/sudoers/Makefile.in:

  gram.h must not depend on gram.y if we want to avoid unnecessary
  rebuilding of targets dependent on gram.h when gram.y changes.
  [[285ccb152]](https://git.sudo.ws/sudo/commit/?id=285ccb152)

* plugins/sample/sample\_plugin.c:

  Refactor common bits of check\_policy and check\_edit
  [[2d785a795]](https://git.sudo.ws/sudo/commit/?id=2d785a795)

* plugins/sample/sample\_plugin.c:

  Add sudoedit support
  [[31087fdcd]](https://git.sudo.ws/sudo/commit/?id=31087fdcd)

2010-05-14 Todd C. Miller

* plugins/sudoers/Makefile.in:

  Rely more on VPATH; fixes a dependency issue with the parser.
  [[3efb055c8]](https://git.sudo.ws/sudo/commit/?id=3efb055c8)

* include/compat.h:

  Fix typo introduced in last commit
  [[d7f238ffa]](https://git.sudo.ws/sudo/commit/?id=d7f238ffa)

* include/compat.h:

  Emulate seteuid using setreuid() or setresuid() as needed. There are
  still a few places that call seteuid() directly.
  [[553361aca]](https://git.sudo.ws/sudo/commit/?id=553361aca)

* src/parse\_args.c, src/sudo\_edit.c:

  Attempt to fix building on systems that only have setuid.
  [[e336dac87]](https://git.sudo.ws/sudo/commit/?id=e336dac87)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Clarify sudoedit a tad.
  [[9a6cbe03b]](https://git.sudo.ws/sudo/commit/?id=9a6cbe03b)

2010-05-13 Todd C. Miller

* src/sudo\_edit.c:

  Fix compilation on HP-UX
  [[39652bf75]](https://git.sudo.ws/sudo/commit/?id=39652bf75)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Document sudoedit
  [[c8a62b1ec]](https://git.sudo.ws/sudo/commit/?id=c8a62b1ec)

* plugins/sudoers/sudoers.c, src/sudo.c, src/sudo.h, src/sudo\_edit.c:

  Change how we handle the sudoedit argv. We now require that there be a
  “–” in argv to separate the editor and any command line arguments from
  the files to be edited.
  [[7c9c5855f]](https://git.sudo.ws/sudo/commit/?id=7c9c5855f)

* include/sudo\_plugin.h, plugins/sample/sample\_plugin.c,
  plugins/sudoers/Makefile.in, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudoers.c, src/Makefile.in, src/gettime.c,
  src/parse\_args.c, src/sudo.c, src/sudo.h, src/sudo\_edit.c:

  Work in progress support for sudoedit. The actual interface used by the
  plugin for sudoedit is likely to change.
  [[fdd28d411]](https://git.sudo.ws/sudo/commit/?id=fdd28d411)

* plugins/sudoers/find\_path.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/visudo.c:

  Make find\_path() a little more generic by not checking def\_foo variables
  inside it. Instead, pass in ignore\_dot as a function argument.
  [[d5bfd148d]](https://git.sudo.ws/sudo/commit/?id=d5bfd148d)

* plugins/sudoers/env.c:

  Add version of getenv(3) that uses our own environ pointer.
  [[832ce341e]](https://git.sudo.ws/sudo/commit/?id=832ce341e)

2010-05-12 Todd C. Miller

* src/script.c:

  Avoid a potential race condition if SIGCHLD is received immediately
  before we call select().
  [[396317ffe]](https://git.sudo.ws/sudo/commit/?id=396317ffe)

* plugins/sudoers/sudoers.c:

  Call env\_init() before we open the sudoers sources as those may call our
  setenv() replacement.
  [[1487026b0]](https://git.sudo.ws/sudo/commit/?id=1487026b0)

* plugins/sudoers/env.c:

  Initialize env\_len in env\_init()
  [[754c1a16d]](https://git.sudo.ws/sudo/commit/?id=754c1a16d)

2010-05-11 Todd C. Miller

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.pod:

  Document time stamp shortcomings under SECURITY NOTES Use “time stamp”
  instead of timestamp.
  [[21ba4a468]](https://git.sudo.ws/sudo/commit/?id=21ba4a468)

* doc/Makefile.in:

  Make sed substitution of mansectsu and mansectform global.
  [[ad4700e7a]](https://git.sudo.ws/sudo/commit/?id=ad4700e7a)

* plugins/sudoers/check.c:

  If the tty lives on a devpts filesystem, stash the ctime in the tty
  ticket file, as it is not updated when the tty is written to. This helps
  us determine when a tty has been reused without the user authenticating
  again with sudo.
  [[a331dcb46]](https://git.sudo.ws/sudo/commit/?id=a331dcb46)

* src/tgetpass.c:

  Fix pasto in mulitple signal fix and use \_NSIG not NSIG since that is
  what our compat checks set.
  [[8ea8de47f]](https://git.sudo.ws/sudo/commit/?id=8ea8de47f)

* configure, configure.in:

  Add check for whether sudo need to link with -ldl to get dlopen(). This
  is a bit of a hack that will get reworked when libtool is updated.
  [[06e650a45]](https://git.sudo.ws/sudo/commit/?id=06e650a45)

* plugins/sudoers/check.c:

  Fix timestamp removal with -k/-K
  [[b89980ac6]](https://git.sudo.ws/sudo/commit/?id=b89980ac6)

* plugins/sudoers/Makefile.in:

  audit.c is now private to the sudoers plugin
  [[e324082d5]](https://git.sudo.ws/sudo/commit/?id=e324082d5)

* configure, configure.in:

  Link with -lpthread on HP-UX since a plugin may be linked with -lpthread
  and dlopen() will fail if the shared object has a dependency on
  -lpthread but the main program is not linked with it.
  [[7502a3d71]](https://git.sudo.ws/sudo/commit/?id=7502a3d71)

* config.h.in, configure, configure.in, plugins/sudoers/set\_perms.c:

  Add separate test for getresuid() since HP-UX has setresuid() but no
  getresuid().
  [[f38afc977]](https://git.sudo.ws/sudo/commit/?id=f38afc977)

* doc/Makefile.in:

  Remove errant backslash
  [[c76e6aa1e]](https://git.sudo.ws/sudo/commit/?id=c76e6aa1e)

* src/script.c:

  Fix SIGPIPE handling. Now that we use may use pipes for stdin/stdout we
  need to pass any SIGPIPE we receive to the running command.
  [[cafc6a4f6]](https://git.sudo.ws/sudo/commit/?id=cafc6a4f6)

* src/script.c:

  Also start the command in the background if stdin is not a tty.
  [[02f8c187a]](https://git.sudo.ws/sudo/commit/?id=02f8c187a)

2010-05-10 Todd C. Miller

* plugins/sudoers/sudoreplay.c, src/script.c, src/sudo.h, src/term.c:

  No need to use pseudo-cbreak mode now that we use pipes when stdout is
  not a tty. Instead, check whether stdin is a tty and if not, delay
  setting the tty to raw mode until the command tries to access it itself
  (and receives SIGTTIN or SIGTTOU).
  [[c2d0888bf]](https://git.sudo.ws/sudo/commit/?id=c2d0888bf)

* src/tgetpass.c:

  Use an array for signals received instead of a single variable so we
  don’t lose any when there are multiple different signals.
  [[cbb3010d7]](https://git.sudo.ws/sudo/commit/?id=cbb3010d7)

* src/tgetpass.c:

  Do signal setup after turning off echo, not before. If we are using a
  tty but are not the foreground pgrp this will generate SIGTTOU so we
  want the default action to be taken (suspend process).
  [[5adda153a]](https://git.sudo.ws/sudo/commit/?id=5adda153a)

2010-05-07 Todd C. Miller

* src/script.c:

  Flush the iobufs on suspend or child exit using the same logic as the
  main event loop.
  [[23a9bf2c0]](https://git.sudo.ws/sudo/commit/?id=23a9bf2c0)

* src/script.c:

  Free memory after we are done with it.
  [[b08a96eea]](https://git.sudo.ws/sudo/commit/?id=b08a96eea)

2010-05-06 Todd C. Miller

* doc/HISTORY:

  Quest now sponsors Sudo development
  [[247f7acaa]](https://git.sudo.ws/sudo/commit/?id=247f7acaa)

2010-05-05 Todd C. Miller

* doc/Makefile.in:

  Install sudo\_plugin man page.
  [[75f63d998]](https://git.sudo.ws/sudo/commit/?id=75f63d998)

* src/script.c:

  Go back to reseting io\_buffer offset and length (and now also the EOF
  handling) in the loop we do the FD\_SET, not after we drain the buffer
  after write() since we don’t know what order reads and writes will occur
  in.
  [[3cbbf27e9]](https://git.sudo.ws/sudo/commit/?id=3cbbf27e9)

* MANIFEST:

  audit files moved to sudoers plugin directory
  [[0af98f2e9]](https://git.sudo.ws/sudo/commit/?id=0af98f2e9)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Document plugin\_printf and new logging functions.
  [[7da9e1a91]](https://git.sudo.ws/sudo/commit/?id=7da9e1a91)

* src/script.c:

  Add support for logging stdin when it is not a tty. There is still a bug
  where “cat | sudo cat” has problems because both cat and sudo are trying
  to read from the tty.
  [[b4d16ae1a]](https://git.sudo.ws/sudo/commit/?id=b4d16ae1a)

* include/sudo\_plugin.h, plugins/sample/sample\_plugin.c,
  plugins/sudoers/sudoers.c, src/script.c:

  Add separate I/O logging functions for tty in/out and
  stdin/stdout/stderr. NOTE: stdin logging does not currently work and is
  disabled for now.
  [[782f49400]](https://git.sudo.ws/sudo/commit/?id=782f49400)

2010-05-04 Todd C. Miller

* include/sudo\_plugin.h, plugins/sample/sample\_plugin.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/logging.c, plugins/sudoers/plugin\_error.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  src/conversation.c, src/sudo.c, src/sudo\_plugin\_int.h:

  Add pointer to a printf like function to plugin open functon. This can
  be used instead of the conversation function to display info and error
  messages.
  [[9fbec34fe]](https://git.sudo.ws/sudo/commit/?id=9fbec34fe)

* Makefile.in:

  Stop if make in a subdir fails
  [[b60b28abd]](https://git.sudo.ws/sudo/commit/?id=b60b28abd)

* src/script.c:

  Only set user’s tty to blocking mode when doing the final flush. Flush
  pipes as well as pty master when the process is done.
  [[e3f561668]](https://git.sudo.ws/sudo/commit/?id=e3f561668)

2010-05-03 Todd C. Miller

* plugins/sudoers/ldap.c:

  Use print\_error() when displaying ldap config info in debugging mode.
  [[dc72c27b1]](https://git.sudo.ws/sudo/commit/?id=dc72c27b1)

* compat/Makefile.in, compat/strdup.c, compat/strndup.c:

  No longer need strdup() or strndup() replacements.
  [[9166c156e]](https://git.sudo.ws/sudo/commit/?id=9166c156e)

* plugins/sudoers/logging.c, plugins/sudoers/plugin\_error.c,
  plugins/sudoers/sudoers.h:

  Add print\_error() function that uses the conversation function to print
  a variable number of error strings and use it in log\_error().
  [[13966481c]](https://git.sudo.ws/sudo/commit/?id=13966481c)

* src/script.c, src/sudo.h, src/term.c:

  Do not need the opost flag to term\_copy() now that we use pipes for
  stdout/stderr when they are not a tty.
  [[0eda64b23]](https://git.sudo.ws/sudo/commit/?id=0eda64b23)

* src/script.c:

  Use pipes to the sudo process if stdout or stderr is not a tty. Still
  needs some polishing and a decision as to whether it is desirable to add
  additonal entry points for logging stdout/stderr/stdin when they are not
  ttys. That would allow a replay program to keep things separate and to
  know whether the terminal needs to be in raw mode at replay time.
  [[dd256f25c]](https://git.sudo.ws/sudo/commit/?id=dd256f25c)

2010-04-30 Todd C. Miller

* plugins/sudoers/Makefile.in, plugins/sudoers/audit.c,
  plugins/sudoers/bsm\_audit.c, plugins/sudoers/bsm\_audit.h:

  Move audit sources into the sudoers plugin dir; the driver does not use
  them.
  [[547502056]](https://git.sudo.ws/sudo/commit/?id=547502056)

* compat/getline.c, compat/mksiglist.c, compat/nanosleep.c,
  compat/strdup.c, compat/strndup.c, plugins/sample/sample\_plugin.c,
  plugins/sudoers/boottime.c, plugins/sudoers/getdate.c,
  plugins/sudoers/match.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/timestr.c, plugins/sudoers/vasgroups.c, src/alloc.c,
  src/atobool.c, src/audit.c, src/lbuf.c, src/list.c, src/sesh.c,
  src/term.c, src/ttysize.c:

  Use angle brackets when including headers that can only be found when an
  -I flag is specified. The files in the compat dir could get away with
  double quotes here but I’ve converted all the source files to use angle
  brackets for consistency.
  [[d346e5090]](https://git.sudo.ws/sudo/commit/?id=d346e5090)

* plugins/sudoers/Makefile.in:

  Add missing -I$(top\_srcdir) to CPPFLAGS so includes in the compat dir
  can be found when building outside the source tree.
  [[143866404]](https://git.sudo.ws/sudo/commit/?id=143866404)

* plugins/sudoers/Makefile.in:

  Clean up links in distclean
  [[1473d7863]](https://git.sudo.ws/sudo/commit/?id=1473d7863)

* plugins/sudoers/Makefile.in:

  Hack around VPATH semantic differences by symlinking files we need from
  ../../src into the current directory and build those. A better fix would
  be to either make a .a or .la file with those files in it or simply use
  a single, flat, Makefile instead of per-subdirs Makefiles.
  [[8cfde4f9d]](https://git.sudo.ws/sudo/commit/?id=8cfde4f9d)

* plugins/sudoers/Makefile.in, src/Makefile.in, src/fmt\_string.c:

  fmt\_string is used by the sudoers plugin too so do not include sudo.h
  (which is not really needed here anyway)
  [[23f9bb59e]](https://git.sudo.ws/sudo/commit/?id=23f9bb59e)

* compat/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Fix building with non-BSD versions of make such as GNU make. Requires
  VPATH support, which should be in any non-neolithic make.
  [[5e9ec6a36]](https://git.sudo.ws/sudo/commit/?id=5e9ec6a36)

* configure, configure.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/sudoers.c,
  src/Makefile.in:

  Re-enable bsm audit. Currently auditing is done within the sudoers
  plugin itself. If possible, this should really be done in the main
  driver but we don’t presently have the needed data to do that. This will
  be re-evaluated when Linux audit support is added.
  [[f42cf76d8]](https://git.sudo.ws/sudo/commit/?id=f42cf76d8)

* compat/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Remove extraneous $srcdir and use more .c.lo and .c.o rules instead of
  explicit rules in the dependency.
  [[0c7e3235f]](https://git.sudo.ws/sudo/commit/?id=0c7e3235f)

* plugins/sudoers/visudo.c:

  Fix mismerge; alias\_remove\_recursive() now returns int
  [[8b832576e]](https://git.sudo.ws/sudo/commit/?id=8b832576e)

2010-04-29 Todd C. Miller

* plugins/sudoers/visudo.c:

  Fix a crash when checking a sudoers file that has aliases that reference
  themselves. Based on a diff from David Wood.
  [[d26d942c2]](https://git.sudo.ws/sudo/commit/?id=d26d942c2)

* src/script.c:

  Print signal info after restoring the tty mode, not before.
  [[8fc1ebd4f]](https://git.sudo.ws/sudo/commit/?id=8fc1ebd4f)

* src/script.c:

  Defer call to alarm() until after we fork the child. Pass correct pid to
  terminate\_child() If the command exits due to signal, set alive to false
  like we do when it exits normally. Add missing check for errpipe[0] !=
  -1 before using it in FD\_ISSET
  [[f45b1e82e]](https://git.sudo.ws/sudo/commit/?id=f45b1e82e)

2010-04-28 Todd C. Miller

* plugins/sudoers/boottime.c:

  Use 1/0 instead of TRUE/FALSE so we don’t need sudoers.h
  [[2ee651df7]](https://git.sudo.ws/sudo/commit/?id=2ee651df7)

2010-04-27 Todd C. Miller

* src/Makefile.in:

  Simplify dependencies by using .c.o and .c.lo rules.
  [[935aef498]](https://git.sudo.ws/sudo/commit/?id=935aef498)

* configure, configure.in, plugins/sudoers/Makefile.in, src/Makefile.in:

  Substitute in @PROGS@ into src/Makefile to add sesh
  [[1c67169b9]](https://git.sudo.ws/sudo/commit/?id=1c67169b9)

2010-04-26 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Add back calls to log\_denial() if sudoers does not allow the command.
  [[b0b6b4cf5]](https://git.sudo.ws/sudo/commit/?id=b0b6b4cf5)

* plugins/sudoers/sudoers.c:

  Pass in correct pwflag for list and validate.
  [[e1a9e5aec]](https://git.sudo.ws/sudo/commit/?id=e1a9e5aec)

* plugins/sudoers/env.c:

  Add missing check for NULL in validate\_env\_vars
  [[ac06e777f]](https://git.sudo.ws/sudo/commit/?id=ac06e777f)

* src/Makefile.in:

  Add sudo\_noexec.la to “all” target, otherwise it only gets built at
  install time.
  [[c8733dbc6]](https://git.sudo.ws/sudo/commit/?id=c8733dbc6)

* plugins/sudoers/sudoers.c:

  Only set sudo\_user.env\_vars if the env\_add list is empty.
  [[1abb3b7f5]](https://git.sudo.ws/sudo/commit/?id=1abb3b7f5)

* plugins/sudoers/sudoers.c:

  Set sudo\_user.env\_vars so that environment variables specified on the
  command line get logged correctly.
  [[90f8bf348]](https://git.sudo.ws/sudo/commit/?id=90f8bf348)

* plugins/sudoers/env.c, plugins/sudoers/logging.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Re-enable environment files and setting environment variables on the
  command line.
  [[b041c91ca]](https://git.sudo.ws/sudo/commit/?id=b041c91ca)

2010-04-24 Todd C. Miller

* plugins/sudoers/check.c:

  Fix typo in last commit (ifndef vs ifdef) Make sure we pass ctime() a
  pointer to time\_t as tv\_sec in struct timeval may be long.
  [[af092dc40]](https://git.sudo.ws/sudo/commit/?id=af092dc40)

* plugins/sudoers/check.c:

  Don’t stash ctime in on-disk tty ticket info for now; on many (most?)
  systems the ctime is updated when the tty is written to. Once I have a
  better idea of what systems do not update ctime on ttys (and have a way
  to test for this) the ctime stash will be conditionally re-enabled.
  [[17220f44d]](https://git.sudo.ws/sudo/commit/?id=17220f44d)

2010-04-23 Todd C. Miller

* MANIFEST, Makefile.in:

  Add back “dist” target, this time using a MANIFEST file
  [[1b6f3fda2]](https://git.sudo.ws/sudo/commit/?id=1b6f3fda2)

* Makefile.in:

  Remove Makefile in distclean target
  [[6b6375108]](https://git.sudo.ws/sudo/commit/?id=6b6375108)

* Makefile.in, src/Makefile.in:

  Update clean and cleandir targets
  [[03536ca93]](https://git.sudo.ws/sudo/commit/?id=03536ca93)

* include/fileops.h, plugins/sudoers/sudoers.h, src/fileops.c, src/sudo.h:
  Move fileops.c defines and prototypes to filesops.h
  [[4b04e875e]](https://git.sudo.ws/sudo/commit/?id=4b04e875e)

* plugins/sudoers/check.c:

  Lock the tty timestamp when writing. We shouldn’t have to lock when
  reading since the file is updated via a single write system call.
  [[f7f9def5e]](https://git.sudo.ws/sudo/commit/?id=f7f9def5e)

2010-04-22 Todd C. Miller

* plugins/sudoers/alias.c, plugins/sudoers/check.c,
  plugins/sudoers/defaults.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/getspwuid.c, plugins/sudoers/gettime.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/interfaces.c,
  plugins/sudoers/iolog.c, plugins/sudoers/ldap.c,
  plugins/sudoers/logging.c, plugins/sudoers/match.c,
  plugins/sudoers/nonunix.h, plugins/sudoers/parse.c,
  plugins/sudoers/pwutil.c, plugins/sudoers/redblack.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestr.c, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/vasgroups.c, plugins/sudoers/visudo.c:

  Convert to ANSI C function declarations
  [[05ae3ea6c]](https://git.sudo.ws/sudo/commit/?id=05ae3ea6c)

* plugins/sudoers/sudoers.h:

  Remove extraneous bits and classify by source file.
  [[c17d3e061]](https://git.sudo.ws/sudo/commit/?id=c17d3e061)

* include/compat.h:

  Add timercmp macro for systems without it
  [[2bc52eb39]](https://git.sudo.ws/sudo/commit/?id=2bc52eb39)

* plugins/sudoers/boottime.c, plugins/sudoers/check.c,
  plugins/sudoers/sudoers.h:

  get\_boottime() now fills in a timeval struct
  [[6a27866c3]](https://git.sudo.ws/sudo/commit/?id=6a27866c3)

* plugins/sudoers/check.c:

  Store info from stat(2)ing the tty in the tty ticket when tty tickets
  are in use. On most systems, this closes the loophole whereby a user can
  log out of a tty, log back in and still have the timestamp be valid.
  [[7d6941a82]](https://git.sudo.ws/sudo/commit/?id=7d6941a82)

* config.h.in, configure.in:

  Add timespec2timeval and use it when getting ctime/mtime
  [[f19ffcc6b]](https://git.sudo.ws/sudo/commit/?id=f19ffcc6b)

2010-04-20 Todd C. Miller

* plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/testsudoers.c:

  Convert perm setting to push/pop model; still needs some work Use the
  stashed runas groups instead of using getgrouplist() Reset perms to the
  initial value on error
  [[1bb9f6214]](https://git.sudo.ws/sudo/commit/?id=1bb9f6214)

* config.h.in, configure.in:

  fix ctim\_get and mtim\_get macros
  [[ab00ce995]](https://git.sudo.ws/sudo/commit/?id=ab00ce995)

* config.h.in, configure, configure.in, include/compat.h,
  plugins/sudoers/check.c, plugins/sudoers/gettime.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/visudo.c, src/fileops.c:

  Use timeval directly instead of converting to timespec when dealing with
  file times and time of day.
  [[b4a26b769]](https://git.sudo.ws/sudo/commit/?id=b4a26b769)

* plugins/sudoers/Makefile.in:

  Don’t like sudoreplay with libsudoers.la due to a yacc symbol conflict.
  [[0a3a849ef]](https://git.sudo.ws/sudo/commit/?id=0a3a849ef)

2010-04-18 Todd C. Miller

* configure, configure.in:

  Darwin >= 9.x has real setreuid(2)
  [[c47ab0273]](https://git.sudo.ws/sudo/commit/?id=c47ab0273)

2010-04-17 Todd C. Miller

* plugins/sudoers/env.c, plugins/sudoers/sudoers.h:

  Ansify env.c
  [[257133328]](https://git.sudo.ws/sudo/commit/?id=257133328)

* plugins/sudoers/env.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Remove remaining references to the environ pointer.
  [[0df204052]](https://git.sudo.ws/sudo/commit/?id=0df204052)

2010-04-16 Todd C. Miller

* config.h.in, configure, configure.in, plugins/sudoers/env.c:

  Don’t change the environ directly in the sudoers plugin
  [[b71844daf]](https://git.sudo.ws/sudo/commit/?id=b71844daf)

2010-04-15 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Fix typo
  [[9f0b8f7aa]](https://git.sudo.ws/sudo/commit/?id=9f0b8f7aa)

* plugins/sudoers/alias.c:

  Fix use after free in error message when a duplicate alias exists.
  [[399aa0d5c]](https://git.sudo.ws/sudo/commit/?id=399aa0d5c)

2010-04-14 Todd C. Miller

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod,
  src/parse\_args.c:

  Add a “noninteractive” boolean to the settings passed in to the plugin’s
  open function that is set when the user specifies the -n flag.
  [[bc813db52]](https://git.sudo.ws/sudo/commit/?id=bc813db52)

* config.h.in, configure, configure.in, plugins/sudoers/env.c:

  Add workaround for the lack of the environ pointer on Mac OS X in
  dlopen()ed modules. Use of environ in the sudoers plugin should
  ultimately be removed but this will do for the moment.
  [[fb87c040c]](https://git.sudo.ws/sudo/commit/?id=fb87c040c)

* plugins/sudoers/visudo.c:

  Set errorfile to the sudoers path if we set parse\_error manually. This
  prevents a NULL dereference in printf() when checking a sudoers file in
  strict mode when alias errors are present.
  [[2b7f0ca95]](https://git.sudo.ws/sudo/commit/?id=2b7f0ca95)

* plugins/sudoers/sudoers.c:

  Main sudo no longer print “unable to execute” on exec failure so do it
  here.
  [[6aecf3fb1]](https://git.sudo.ws/sudo/commit/?id=6aecf3fb1)

2010-04-13 Todd C. Miller

* src/script.c:

  Use a pipe to pass back errno to the parent if execve() fails. If we get
  an error in script\_child(), kill the command and exit.
  [[ea523b17a]](https://git.sudo.ws/sudo/commit/?id=ea523b17a)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod,
  src/parse\_args.c, src/sudo.c:

  Handle plugin’s open function returning -2 (usage error).
  [[f19be6da3]](https://git.sudo.ws/sudo/commit/?id=f19be6da3)

* src/script.c:

  If execve() fails, leave it to the plugin to print an error string.
  [[40533f381]](https://git.sudo.ws/sudo/commit/?id=40533f381)

* src/script.c:

  If execve fails in logging mode, pass the errno directly to the
  grandparent on the backchannel and exit. The immediate parent will get
  SIGCHLD and try to report that status but its parent will no longer be
  listening. It would probably be cleaner to pass this over a pipe in
  script\_child().
  [[e472e4ae0]](https://git.sudo.ws/sudo/commit/?id=e472e4ae0)

* plugins/sudoers/sudoers.c:

  Don’t override rval with results of check\_user() unless it failed.
  [[f321a8581]](https://git.sudo.ws/sudo/commit/?id=f321a8581)

2010-04-12 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  Fix typo
  [[fa2f5f53d]](https://git.sudo.ws/sudo/commit/?id=fa2f5f53d)

* src/parse\_args.c:

  NULL-terminate env\_add
  [[7ce802792]](https://git.sudo.ws/sudo/commit/?id=7ce802792)

2010-04-11 Todd C. Miller

* src/sudo.c:

  Call the I/O log open function before the I/O version function.
  [[0494774f3]](https://git.sudo.ws/sudo/commit/?id=0494774f3)

* plugins/sudoers/iolog.c:

  Remove io\_conv and just use sudo\_conv
  [[7c344181d]](https://git.sudo.ws/sudo/commit/?id=7c344181d)

* plugins/sudoers/set\_perms.c:

  Fix set/restore perms for systems w/o setresuid
  [[0d2524e68]](https://git.sudo.ws/sudo/commit/?id=0d2524e68)

2010-04-10 Todd C. Miller

* plugins/sudoers/check.c, plugins/sudoers/logging.c,
  plugins/sudoers/parse.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h:

  Primitive set/restore permissions. Will be replaced by a push/pop model.
  [[744eae82e]](https://git.sudo.ws/sudo/commit/?id=744eae82e)

* src/script.c:

  Only need to take action on SIGCHLD in parent if no I/O logger. If there
  is an I/O logger we will receive ECONNRESET or EPIPE when we try to read
  from the socketpair.
  [[711b8d1c0]](https://git.sudo.ws/sudo/commit/?id=711b8d1c0)

2010-04-09 Todd C. Miller

* :

  Merge fb4d571495fa from the 1.7 branch to trunk.
  [[32672c1f1]](https://git.sudo.ws/sudo/commit/?id=32672c1f1)

* find\_path.c:

  Qualify the command even if it is in the current working directory, e.g.
  “./foo” instead of just returning “foo”. This removes an ambiguity
  between real commands and possible pseudo-commands in command matching.
  [[96fdf201f]](https://git.sudo.ws/sudo/commit/?id=96fdf201f)

2010-04-08 Todd C. Miller

* src/script.c:

  Don’t set SA\_RESTART when registering SIGALRM handler. Do set SA\_RESTART
  when registering SIGWINCH handler.
  [[93126eb5a]](https://git.sudo.ws/sudo/commit/?id=93126eb5a)

* doc/Makefile.in:

  Add dev targets for \*.man.in and \*.cat that don’t specfify the $(srcdir)
  prefix.
  [[7ebcbf102]](https://git.sudo.ws/sudo/commit/?id=7ebcbf102)

* src/script.c:

  If log\_input or log\_output returns false, terminate the command.
  [[b457f1371]](https://git.sudo.ws/sudo/commit/?id=b457f1371)

* src/script.c:

  Better signal handling. Instead of using a single variable to store the
  received signal, use an array so we can’t lose a signal when multiple
  are sent. Fix process termination by SIGALRM in non-I/O logger mode. Fix
  relaying terminal signals to the child in non-I/O logger mode.
  [[5b3d15093]](https://git.sudo.ws/sudo/commit/?id=5b3d15093)

* src/script.c:

  Fix a race between when we get the child pid in the parent and when the
  child process exits. The problem exhibited as a hang after a short-lived
  process, e.g. “sudo id” when no IO logger was enabled.
  [[a3f427838]](https://git.sudo.ws/sudo/commit/?id=a3f427838)

2010-04-07 Todd C. Miller

* doc/sudoers.cat, doc/sudoers.man.in, doc/sudoers.pod:

  Add a note about the security implications of the fast\_glob option.
  [[29f22dba2]](https://git.sudo.ws/sudo/commit/?id=29f22dba2)

* sudoers.cat, sudoers.man.in, sudoers.pod:

  Add a note about the security implications of the fast\_glob option.
  [[99f3be056]](https://git.sudo.ws/sudo/commit/?id=99f3be056)

* memrchr.c:

  Remove duplicate includes
  [[348fb6219]](https://git.sudo.ws/sudo/commit/?id=348fb6219)

2010-04-06 Todd C. Miller

* config.h.in, configure, configure.in:

  Fix up some AC\_DEFINE descriptions and regen config.h.in
  [[6a5ea5be0]](https://git.sudo.ws/sudo/commit/?id=6a5ea5be0)

2010-04-05 Todd C. Miller

* include/missing.h:

  No longer check for strdup or strndup for LIBOBJ replacement.
  [[5770391ec]](https://git.sudo.ws/sudo/commit/?id=5770391ec)

* src/script.c:

  Avoid installing signal handlers that are io-logger specific. Fixes job
  control when no io logger is enabled.
  [[2634cf08c]](https://git.sudo.ws/sudo/commit/?id=2634cf08c)

* doc/Makefile.in:

  Only regen man pages from pod when configured with –with-devel
  [[81819d0c0]](https://git.sudo.ws/sudo/commit/?id=81819d0c0)

2010-04-04 Todd C. Miller

* Makefile.in, configure, configure.in:

  Top-level Makefile.in. Nothing is currently substituted but this is
  needed for separate build dirs.
  [[717da12e9]](https://git.sudo.ws/sudo/commit/?id=717da12e9)

* compat/Makefile.in, doc/Makefile.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Fix out-of-tree builds
  [[43b6359df]](https://git.sudo.ws/sudo/commit/?id=43b6359df)

* :

  Merge
  [[fb55653a4]](https://git.sudo.ws/sudo/commit/?id=fb55653a4)

* doc/Makefile.in:

  We always install sudoreplay in 1.8
  [[d710ea091]](https://git.sudo.ws/sudo/commit/?id=d710ea091)

* plugins/sudoers/iolog.c, plugins/sudoers/sudoers.c:

  Free str after using it in the version method. Use sudo\_conv, not
  io\_conv since we don’t have the IO conversation function pointer in the
  I/O version method anymore now that io\_open is delayed.
  [[3242c1091]](https://git.sudo.ws/sudo/commit/?id=3242c1091)

2010-04-03 Todd C. Miller

* compat/siglist.in:

  SIGPOLL is sometimes the same as SIGIO (like on HP-UX)
  [[0716ab38a]](https://git.sudo.ws/sudo/commit/?id=0716ab38a)

2010-04-02 Todd C. Miller

* configure, configure.in:

  No need to provide strdup() or strndup(), sudo uses estrdup() and
  estrndup()
  [[c2eeceaa1]](https://git.sudo.ws/sudo/commit/?id=c2eeceaa1)

* compat/Makefile.in, compat/mksiglist.c, compat/mksiglist.h,
  compat/siglist.in:

  Add license to mksiglist.c and note that the bits from pdksh are public
  domain
  [[8ca928740]](https://git.sudo.ws/sudo/commit/?id=8ca928740)

* compat/Makefile.in:

  Fix LIBOBJDIR vs. srcdir wrt the siglist bits
  [[7539f636b]](https://git.sudo.ws/sudo/commit/?id=7539f636b)

* plugins/sudoers/Makefile.in:

  Add sudoreplay testsudoers and visudo to clean target
  [[ee52f3c39]](https://git.sudo.ws/sudo/commit/?id=ee52f3c39)

* compat/Makefile.in, compat/mksiglist.c, compat/mksiglist.h,
  compat/siglist.in, compat/strsignal.c, configure, configure.in,
  include/missing.h, src/script.c:

  Create our own sys\_siglist for systems without it for use by strsignal()
  [[8c91f0a30]](https://git.sudo.ws/sudo/commit/?id=8c91f0a30)

* compat/Makefile.in:

  Remove duplicate $(LIBOBJDIR)
  [[d83ebba56]](https://git.sudo.ws/sudo/commit/?id=d83ebba56)

2010-04-01 Todd C. Miller

* plugins/sudoers/sudoers.c, src/sudo.c, src/sudo\_edit.c:

  Main sudo should not block signals; the plugin should do this in
  check\_policy.
  [[44341c9c1]](https://git.sudo.ws/sudo/commit/?id=44341c9c1)

2010-03-31 Todd C. Miller

* src/script.c:

  Fix a sizeof(ptr) vs. sizeof(\*ptr)
  [[ca2eee07b]](https://git.sudo.ws/sudo/commit/?id=ca2eee07b)

* src/script.c:

  Unlike most operating systems, HP-UX select() is not interrupted by
  SIGCHLD when the signal is registered with SA\_RESTART. If we clear
  SA\_RESTART when calling sigaction() for SIGCHLD we get the expected
  behavior and the code in the select() loops already handles EINTR
  correctly.
  [[c3e87c2db]](https://git.sudo.ws/sudo/commit/?id=c3e87c2db)

* compat/getprogname.c:

  progname should be const
  [[8cde6d699]](https://git.sudo.ws/sudo/commit/?id=8cde6d699)

* plugins/sudoers/Makefile.in:

  Move –tag=disable-static to when we link sudoers.la, not when we
  install.
  [[3a9896711]](https://git.sudo.ws/sudo/commit/?id=3a9896711)

* src/load\_plugins.c:

  Load the sudoers I/O plugin by default too now that it is hooked up.
  [[6c71d6afa]](https://git.sudo.ws/sudo/commit/?id=6c71d6afa)

2010-03-30 Todd C. Miller

* src/pty.c:

  It looks like AIX doesn’t need to push STREAMS modules for ptys.
  [[5d6f19671]](https://git.sudo.ws/sudo/commit/?id=5d6f19671)

2010-03-28 Todd C. Miller

* src/parse\_args.c, src/sudo.c:

  Delay calling the I/O plugin open function until the policy plugin
  returns success.
  [[e17f1e5cb]](https://git.sudo.ws/sudo/commit/?id=e17f1e5cb)

2010-03-27 Todd C. Miller

* plugins/sudoers/Makefile.in, plugins/sudoers/iolog.c,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Add back io logging (transcript) support. Currently, the open function
  runs too early and it is not possible to use the io module independently
  of the policy module.
  [[05e8023e7]](https://git.sudo.ws/sudo/commit/?id=05e8023e7)

* plugins/sudoers/set\_perms.c:

  Comment out dead code; will be removed when set\_perms is rewritten.
  [[681c6faf3]](https://git.sudo.ws/sudo/commit/?id=681c6faf3)

2010-03-23 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Fix off by one error when allocating user\_groups.
  [[eae881b5a]](https://git.sudo.ws/sudo/commit/?id=eae881b5a)

2010-03-22 Todd C. Miller

* configure, configure.in, plugins/sudoers/Makefile.in:

  Add REPLAY\_LIBS for sudoreplay and add -lrt to it on Solaris.
  [[0ea0d60cb]](https://git.sudo.ws/sudo/commit/?id=0ea0d60cb)

* plugins/sudoers/sudoers.c:

  Fix typo in preserve groups case
  [[e12858ee9]](https://git.sudo.ws/sudo/commit/?id=e12858ee9)

* plugins/sudoers/sudoers.c:

  In command\_info it is “runas\_groups” not “groups”.
  [[fc63d106f]](https://git.sudo.ws/sudo/commit/?id=fc63d106f)

* src/sudo.c:

  Fix iteration over runas\_groups list.
  [[43ea59f64]](https://git.sudo.ws/sudo/commit/?id=43ea59f64)

* :

  Merge 5177a284b9ff 549f8f7c2463 88f3181692fe from 1.7 branch.
  [[8df6ba9fe]](https://git.sudo.ws/sudo/commit/?id=8df6ba9fe)

* compat/getgrouplist.c:

  getgrouplist(3) for those without it
  [[617fb0e31]](https://git.sudo.ws/sudo/commit/?id=617fb0e31)

* configure, configure.in:

  Fix installation of sudoers.ldap in “make install” when –with-ldap was
  specified without a directory. From Prof. Dr. Andreas Mueller
  [[c2905815e]](https://git.sudo.ws/sudo/commit/?id=c2905815e)

* plugins/sudoers/sudoers.c:

  Set preserve\_groups or groups list in command\_info
  [[a72669d8a]](https://git.sudo.ws/sudo/commit/?id=a72669d8a)

* src/sudo.c:

  Fix setting of groups list
  [[7af5cdfaf]](https://git.sudo.ws/sudo/commit/?id=7af5cdfaf)

* config.h.in, configure, configure.in, include/compat.h,
  include/missing.h:

  Add checks for getgrset and getgrouplist and use replacement
  getgrouplist if the system doesn’t support it.
  [[8db39a858]](https://git.sudo.ws/sudo/commit/?id=8db39a858)

* src/parse\_args.c:

  Pass in preserve\_groups when the -P flag is specified as per the design
  [[4b3665778]](https://git.sudo.ws/sudo/commit/?id=4b3665778)

* plugins/sudoers/sudoers.c:

  Check preserve\_groups and ignore\_ticket args with atobool instead of
  assuming they are true if present.
  [[0ea44bcba]](https://git.sudo.ws/sudo/commit/?id=0ea44bcba)

2010-03-21 Todd C. Miller

* plugins/sudoers/Makefile.in, plugins/sudoers/plugin\_error.c:

  Rename plugin-specific error.c to plugin\_error.c Wire up visudo,
  sudoreplay and testsudoers in the build
  [[066e6a7e8]](https://git.sudo.ws/sudo/commit/?id=066e6a7e8)

* src/Makefile.in, src/term.c:

  term.c does not needto include sudo.h
  [[74ce00482]](https://git.sudo.ws/sudo/commit/?id=74ce00482)

* TODO, doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Document the -2 return in the check\_policy section too
  [[9edc09609]](https://git.sudo.ws/sudo/commit/?id=9edc09609)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h, src/parse\_args.c,
  src/sudo.c, src/sudo.h:

  Fix the -s and -i flags and add support for the “implied\_shell” option.
  If the user does not specify a command, sudo will now pass in the path
  to the user’s shell and set impied\_shell=true. The plugin can them
  either check the command normally or return -2 to cause sudo to print a
  usage message and exit.
  [[6b180d24d]](https://git.sudo.ws/sudo/commit/?id=6b180d24d)

2010-03-19 Todd C. Miller

* config.h.in, configure, configure.in, src/load\_plugins.c:

  Bring back SUDOERS\_PLUGIN but add .dylib -> .so conversion for Darwin
  where libraries end in .dylib but modules end in .so
  [[2e27226a0]](https://git.sudo.ws/sudo/commit/?id=2e27226a0)

* plugins/sudoers/parse.c:

  Better prefix determination now that we can’t rely on len==0 to tell the
  beginning on an entry.
  [[8c9db4ef6]](https://git.sudo.ws/sudo/commit/?id=8c9db4ef6)

* plugins/sudoers/ldap.c:

  display\_bound\_defaults() stub should return 0, not 1 since it is a
  count, not a boolean.
  [[5fb6784ab]](https://git.sudo.ws/sudo/commit/?id=5fb6784ab)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Document progname in settings
  [[18cd91d56]](https://git.sudo.ws/sudo/commit/?id=18cd91d56)

* compat/getprogname.c, include/compat.h, plugins/sample/sample\_plugin.c,
  plugins/sudoers/sudoers.c, src/parse\_args.c, src/sudo.c:

  Rewrite compat/getprogname.c and add setprogname(). The progname is now
  passed to the plugin via the settings array.
  [[eec5235d1]](https://git.sudo.ws/sudo/commit/?id=eec5235d1)

* configure, configure.in, plugins/sudoers/Makefile.in:

  Fix –with-ldap
  [[0dbf4362d]](https://git.sudo.ws/sudo/commit/?id=0dbf4362d)

* plugins/sudoers/sudo\_nss.c:

  Add missing whitespace for Runas and Command-specific defaults
  [[71baab8ac]](https://git.sudo.ws/sudo/commit/?id=71baab8ac)

* plugins/sudoers/ldap.c, plugins/sudoers/parse.c,
  plugins/sudoers/sudo\_nss.c:

  Use embedded newlines in lbuf instead of multiple calls to lbuf\_print.
  [[38937dca5]](https://git.sudo.ws/sudo/commit/?id=38937dca5)

* src/lbuf.c:

  Add support for embedded newlines.
  [[6f771f39b]](https://git.sudo.ws/sudo/commit/?id=6f771f39b)

2010-03-18 Todd C. Miller

* compat/getprogname.c:

  If system doesn’t support getprogname or \_\_programe and we are building
  a shared object don’t bother with Argc/Argv, just return “sudo”
  [[623fc34dd]](https://git.sudo.ws/sudo/commit/?id=623fc34dd)

* config.h.in, configure, configure.in, src/load\_plugins.c:

  Hard-code sudoers.so instead of using SUDOERS\_PLUGIN since libtool
  appears to always install a shared object with the .so suffix.
  [[5be1b8016]](https://git.sudo.ws/sudo/commit/?id=5be1b8016)

* compat/Makefile.in, configure, configure.in, plugins/sample/Makefile.in,
  plugins/sudoers/Makefile.in, src/Makefile.in:

  Play more nicely with libtool and let it build libreplace (was
  libmissing) for us.
  [[ba9d2f5bb]](https://git.sudo.ws/sudo/commit/?id=ba9d2f5bb)

* include/missing.h:

  Include stdarg.h for va\_list rather than requiring all consumers of
  missing.h to include stdarg.h themselves.
  [[fdbc4ecff]](https://git.sudo.ws/sudo/commit/?id=fdbc4ecff)

* include/lbuf.h, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/check.c, plugins/sudoers/sudo\_nss.c,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h, src/lbuf.c,
  src/parse\_args.c:

  Pass in output function to lbuf\_init() instead of writing to stdout. A
  side effect is that the usage info can now go to stderr as it should.
  [[b4f4afdf6]](https://git.sudo.ws/sudo/commit/?id=b4f4afdf6)

2010-03-17 Todd C. Miller

* include/lbuf.h, plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, src/lbuf.c, src/parse\_args.c, src/sudo.c:

  Use number of tty columns that is passed in user\_info instead of getting
  it directly in the lbuf code.
  [[038ec569d]](https://git.sudo.ws/sudo/commit/?id=038ec569d)

* plugins/sudoers/alias.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.h,
  plugins/sudoers/check.c, plugins/sudoers/defaults.c,
  plugins/sudoers/defaults.h, plugins/sudoers/env.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/gram.c, plugins/sudoers/gram.y,
  plugins/sudoers/interfaces.h, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/match.c,
  plugins/sudoers/mon\_systrace.h, plugins/sudoers/parse.c,
  plugins/sudoers/parse.h, plugins/sudoers/pwutil.c,
  plugins/sudoers/redblack.c, plugins/sudoers/redblack.h,
  plugins/sudoers/set\_perms.c, plugins/sudoers/sudo\_nss.h,
  plugins/sudoers/sudoers.c, plugins/sudoers/sudoers.h,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestr.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/visudo.c:

  Kill \_\_P in sudoers
  [[d5ae4c7d8]](https://git.sudo.ws/sudo/commit/?id=d5ae4c7d8)

* config.h.in, configure, configure.in, src/load\_plugins.c:

  Set the sudoers plugin name in configure so we get the extension right.
  [[5a2a2d193]](https://git.sudo.ws/sudo/commit/?id=5a2a2d193)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Document lines/cols in user\_info
  [[81949e89d]](https://git.sudo.ws/sudo/commit/?id=81949e89d)

* src/Makefile.in, src/sudo.c, src/sudo.h, src/ttysize.c:

  Add tty size to user info
  [[96a98bed4]](https://git.sudo.ws/sudo/commit/?id=96a98bed4)

* src/script.c:

  Use TIOCGSIZE/TIOCSSIZE instead of TIOCGWINSZ/TIOCSWINSZ
  [[f08479f19]](https://git.sudo.ws/sudo/commit/?id=f08479f19)

2010-03-16 Todd C. Miller

* plugins/sudoers/sudoers.c:

  Kill dead code Add missing sigsetjmp in sudo\_policy\_invalidate Error out
  if we fail to lookup the user’s name that is passed in
  [[a5d2775f7]](https://git.sudo.ws/sudo/commit/?id=a5d2775f7)

* plugins/sudoers/error.c:

  Pass the error value back via siglongjmp.
  [[0d8159fa2]](https://git.sudo.ws/sudo/commit/?id=0d8159fa2)

* plugins/sudoers/check.c:

  Use conversation function for lecture.
  [[51c55cd48]](https://git.sudo.ws/sudo/commit/?id=51c55cd48)

* plugins/sudoers/check.c:

  Don’t update ticket file if verify\_user returns FALSE.
  [[cbf298bfc]](https://git.sudo.ws/sudo/commit/?id=cbf298bfc)

2010-03-15 Todd C. Miller

* plugins/sudoers/sudoers.c, src/sudo.c:

  Wire up invalidate and validate methods for sudoers
  [[ee223889c]](https://git.sudo.ws/sudo/commit/?id=ee223889c)

* plugins/sudoers/check.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h:

  Add support for -k flag with a command.
  [[248bae4e5]](https://git.sudo.ws/sudo/commit/?id=248bae4e5)

* src/parse\_args.c:

  Allow -k to be specified with a command.
  [[36701e123]](https://git.sudo.ws/sudo/commit/?id=36701e123)

* plugins/sudoers/sudoers.c:

  Wire up policy\_list
  [[e8eec3402]](https://git.sudo.ws/sudo/commit/?id=e8eec3402)

* plugins/sudoers/error.c:

  Add newline at the end of message and space after the colon in warning
  message
  [[718073e27]](https://git.sudo.ws/sudo/commit/?id=718073e27)

* plugins/sudoers/auth/sudo\_auth.c:

  Add missing newline after pass password warning
  [[88a0244dd]](https://git.sudo.ws/sudo/commit/?id=88a0244dd)

* plugins/sudoers/sudoers.c:

  Set user\_groups and user\_ngroups based on user\_info
  [[7b024c53c]](https://git.sudo.ws/sudo/commit/?id=7b024c53c)

* plugins/sudoers/error.c:

  Make this compile
  [[5113f8489]](https://git.sudo.ws/sudo/commit/?id=5113f8489)

* plugins/sudoers/error.c, plugins/sudoers/sudoers.c:

  Make \_warning in error.c use the conversation function and remove
  commented out warning/warningx in sudoers.c.
  [[5e2f61a09]](https://git.sudo.ws/sudo/commit/?id=5e2f61a09)

* plugins/sudoers/logging.c:

  Use siglongjmp() in log\_error for fatal errors
  [[dbbc0cea5]](https://git.sudo.ws/sudo/commit/?id=dbbc0cea5)

* plugins/sample/Makefile.in, plugins/sudoers/Makefile.in:

  Quiet a libtool warning
  [[d1d6afaef]](https://git.sudo.ws/sudo/commit/?id=d1d6afaef)

* Makefile:

  Build sudoers plugin
  [[6527c92da]](https://git.sudo.ws/sudo/commit/?id=6527c92da)

* plugins/sudoers/gram.c, plugins/sudoers/gram.y:

  Use warningx in yyerror() so the conversation function gets used when
  built as part of sudoers.
  [[d54cedfab]](https://git.sudo.ws/sudo/commit/?id=d54cedfab)

2010-03-14 Todd C. Miller

* plugins/sudoers/auth/pam.c:

  Rename sudo\_conv to conversation to avoid a namespace conflict.
  [[748ce5538]](https://git.sudo.ws/sudo/commit/?id=748ce5538)

* plugins/sudoers/Makefile.in, plugins/sudoers/alias.c,
  plugins/sudoers/auth/afs.c, plugins/sudoers/auth/aix\_auth.c,
  plugins/sudoers/auth/bsdauth.c, plugins/sudoers/auth/dce.c,
  plugins/sudoers/auth/fwtk.c, plugins/sudoers/auth/kerb4.c,
  plugins/sudoers/auth/kerb5.c, plugins/sudoers/auth/pam.c,
  plugins/sudoers/auth/passwd.c, plugins/sudoers/auth/rfc1938.c,
  plugins/sudoers/auth/secureware.c, plugins/sudoers/auth/securid.c,
  plugins/sudoers/auth/securid5.c, plugins/sudoers/auth/sia.c,
  plugins/sudoers/auth/sudo\_auth.c, plugins/sudoers/auth/sudo\_auth.h,
  plugins/sudoers/check.c, plugins/sudoers/defaults.c,
  plugins/sudoers/env.c, plugins/sudoers/error.c,
  plugins/sudoers/find\_path.c, plugins/sudoers/getspwuid.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.y, plugins/sudoers/interfaces.c,
  plugins/sudoers/ldap.c, plugins/sudoers/logging.c,
  plugins/sudoers/match.c, plugins/sudoers/mon\_systrace.c,
  plugins/sudoers/parse.c, plugins/sudoers/pwutil.c,
  plugins/sudoers/redblack.c, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/testsudoers.c,
  plugins/sudoers/toke.c, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/vasgroups.c, plugins/sudoers/visudo.c:

  Initial bits of sudoers plugin; still needs work.
  [[9b0205846]](https://git.sudo.ws/sudo/commit/?id=9b0205846)

* config.h.in:

  Add HAVE\_STRDUP and HAVE\_STRNDUP
  [[3116e254b]](https://git.sudo.ws/sudo/commit/?id=3116e254b)

* compat/Makefile.in, configure, configure.in:

  Build libmissing in two flavors (one PIC one non-PIC) and link with the
  appropriate one.
  [[90ec11254]](https://git.sudo.ws/sudo/commit/?id=90ec11254)

* Makefile, compat/fnmatch.c, compat/glob.c, compat/nanosleep.c,
  compat/utimes.c, plugins/sample/Makefile.in, src/Makefile.in:

  Build libmissing in two flavors (one PIC one non-PIC) and link with the
  appropriate one.
  [[b883670a3]](https://git.sudo.ws/sudo/commit/?id=b883670a3)

2010-03-13 Todd C. Miller

* include/missing.h:

  Add strdup and strndup and fix strsignal
  [[fc598f8e1]](https://git.sudo.ws/sudo/commit/?id=fc598f8e1)

2010-03-12 Todd C. Miller

* compat/strdup.c, compat/strndup.c, configure, configure.in,
  plugins/sample/Makefile.in, src/Makefile.in:

  Add strdup and strndup to compat
  [[6b4d97ebc]](https://git.sudo.ws/sudo/commit/?id=6b4d97ebc)

* plugins/sample/sample\_plugin.c:

  Need to include compat.h before missing.h
  [[8003cb2f3]](https://git.sudo.ws/sudo/commit/?id=8003cb2f3)

* compat/strsignal.c:

  Must check HAVE\_DECL\_SYS\_SIGLIST == 1 (not just if defined) since if it
  doesn’t exist configure will set it to 0.
  [[301fb7d8e]](https://git.sudo.ws/sudo/commit/?id=301fb7d8e)

* compat/glob.c:

  Fix botched ANSI C coversion of globexp2()
  [[93ae94f9d]](https://git.sudo.ws/sudo/commit/?id=93ae94f9d)

* configure, configure.in:

  Remove redundant getgroups check
  [[1dcebf901]](https://git.sudo.ws/sudo/commit/?id=1dcebf901)

* configure, configure.in, src/lbuf.c, src/script.c, src/term.c:

  Require either termios or termio, no more sgtty.
  [[0795ef846]](https://git.sudo.ws/sudo/commit/?id=0795ef846)

* compat/strsignal.c, config.h.in, configure, configure.in:

  Change the sys\_siglist check to use AC\_CHECK\_DECLS and also check for
  \_sys\_siglist and\_\_sys\_siglist
  [[cb8696d67]](https://git.sudo.ws/sudo/commit/?id=cb8696d67)

2010-03-11 Todd C. Miller

* configure, configure.in, src/Makefile.in:

  Change SUDO\_LDFLAGS to SUDOERS\_LDFLAGS and add SUDOERS\_OBJS. We now use
  SUDO\_OBJS for the main driver as part of OBJS.
  [[5775026a5]](https://git.sudo.ws/sudo/commit/?id=5775026a5)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Mention in the conversation function section that a newline is not
  implicit.
  [[f0f803e33]](https://git.sudo.ws/sudo/commit/?id=f0f803e33)

* include/compat.h:

  Add definition of WCOREDUMP for systems without it. This is known to
  work on AIX and SunOS 4, but may be incorrect on other systems that lack
  WCOREDUMP.
  [[af62ffe6f]](https://git.sudo.ws/sudo/commit/?id=af62ffe6f)

2010-03-09 Todd C. Miller

* plugins/sample/sample\_plugin.c, src/conversation.c:

  conversation function no longer puts a newline at the end of info or
  error messages.
  [[f211213dc]](https://git.sudo.ws/sudo/commit/?id=f211213dc)

* match.c:

  When doing a glob match, short circuit if gl.gl\_pathc is 0. From Mark
  Kettenis.
  [[09900584f]](https://git.sudo.ws/sudo/commit/?id=09900584f)

2010-03-08 Todd C. Miller

* script.c:

  Use parent process group id instead of parent process id when checking
  foreground status and suspending parent. Fixes an issue when running
  commands under /usr/bin/time and others.
  [[7d0630823]](https://git.sudo.ws/sudo/commit/?id=7d0630823)

* env.c:

  In setenv(), if the var is empty, return 1 and set errno to EINVAL
  instead of returning EINVAL directly.
  [[731a6e850]](https://git.sudo.ws/sudo/commit/?id=731a6e850)

2010-03-07 Todd C. Miller

* src/script.c:

  Use parent process group id instead of parent process id when checking
  foreground status and suspending parent. Fixes an issue when running
  commands under /usr/bin/time and others.
  [[c8c4d6a13]](https://git.sudo.ws/sudo/commit/?id=c8c4d6a13)

2010-03-06 Todd C. Miller

* aclocal.m4:

  transcript option is now –with not –enable
  [[8ca261fc7]](https://git.sudo.ws/sudo/commit/?id=8ca261fc7)

* plugins/sample/sample\_plugin.c:

  Add support to -u and -g flags Check fmt\_string retval Add timeout for
  debugging purposes
  [[b814a0d74]](https://git.sudo.ws/sudo/commit/?id=b814a0d74)

* src/script.c, src/sudo.c:

  Wire up SIGALRM handler Set close on exec flag for child side of the
  socketpair Fix signal handling when not doing I/O logging
  [[4e938c007]](https://git.sudo.ws/sudo/commit/?id=4e938c007)

* src/sudo.c:

  g/c unused SIGCHLD handler
  [[d73f580f5]](https://git.sudo.ws/sudo/commit/?id=d73f580f5)

* src/fmt\_string.c, src/parse\_args.c, src/sudo.c:

  Don’t use emalloc() in fmt\_string(); we want to be able to use it from a
  plugin.
  [[cc23068c2]](https://git.sudo.ws/sudo/commit/?id=cc23068c2)

* include/list.h:

  tq\_remove not list\_remove
  [[847a7c1b2]](https://git.sudo.ws/sudo/commit/?id=847a7c1b2)

* configure, configure.in:

  AUTH\_OBJS should contain .lo files not .o files.
  [[c7b382a90]](https://git.sudo.ws/sudo/commit/?id=c7b382a90)

2010-03-05 Todd C. Miller

* src/parse\_args.c:

  Simplify conversion of command line args to name=value pairs.
  [[5ff6832e1]](https://git.sudo.ws/sudo/commit/?id=5ff6832e1)

* plugins/sample/sample\_plugin.c:

  Handle NULL reply from conversation function
  [[1e131d427]](https://git.sudo.ws/sudo/commit/?id=1e131d427)

* compat/getline.c:

  Don’t depend on emalloc/erealloc
  [[3384abd2b]](https://git.sudo.ws/sudo/commit/?id=3384abd2b)

* plugins/sample/Makefile.in:

  Use $(OBJS) instead of sample\_plugin.lo
  [[c81a62df3]](https://git.sudo.ws/sudo/commit/?id=c81a62df3)

* plugins/sample/sample\_plugin.c:

  runas\_user is in settings not user\_info
  [[064eb3536]](https://git.sudo.ws/sudo/commit/?id=064eb3536)

* src/parse\_args.c:

  Fix a mismatch between sudo\_settings and settings\_pairs that causes some
  settings to get the wrong values.
  [[a1b7526e3]](https://git.sudo.ws/sudo/commit/?id=a1b7526e3)

2010-03-04 Todd C. Miller

* src/Makefile.in, src/aix.c, src/alloc.c, src/atobool.c, src/error.c,
  src/fileops.c, src/lbuf.c, src/list.c, src/pty.c, src/sesh.c,
  src/sudo.c, src/sudo\_edit.c, src/term.c, src/zero\_bytes.c:

  Convert to ANSI C
  [[c857c74e3]](https://git.sudo.ws/sudo/commit/?id=c857c74e3)

* src/load\_plugins.c:

  Fix strlcpy() return value check.
  [[6470a057e]](https://git.sudo.ws/sudo/commit/?id=6470a057e)

* INSTALL, configure, configure.in:

  No longer need to substitute in script.o and pty.o; I/O logging support
  is always built.
  [[cf07bde70]](https://git.sudo.ws/sudo/commit/?id=cf07bde70)

2010-02-28 Todd C. Miller

* src/script.c:

  Add fallback to /bin/sh when execve() fails with ENOEXEC.
  [[19b17c750]](https://git.sudo.ws/sudo/commit/?id=19b17c750)

* include/alloc.h, src/alloc.c:

  Add estrndup()
  [[76c90bc30]](https://git.sudo.ws/sudo/commit/?id=76c90bc30)

2010-02-27 Todd C. Miller

* src/script.c, src/sudo.c:

  Refactor script\_execve() a bit so that it can be used in non-script
  mode. Needs more cleanup.
  [[f145264ee]](https://git.sudo.ws/sudo/commit/?id=f145264ee)

* src/sudo.c:

  Ignore empty entries in command\_info list
  [[157b7805c]](https://git.sudo.ws/sudo/commit/?id=157b7805c)

* include/list.h, src/list.c:

  Add tq\_remove
  [[25d3b4e51]](https://git.sudo.ws/sudo/commit/?id=25d3b4e51)

* src/conversation.c:

  Pass timeout to tgetpass()
  [[289dc98d9]](https://git.sudo.ws/sudo/commit/?id=289dc98d9)

* Makefile:

  Add ChangeLog target
  [[d53f352c4]](https://git.sudo.ws/sudo/commit/?id=d53f352c4)

* README, WHATSNEW:

  Bump version and update things slightly for sudo 1.8.0
  [[186ef7e68]](https://git.sudo.ws/sudo/commit/?id=186ef7e68)

* configure, configure.in:

  Sudo now requires an ANSI/ISO C compiler
  [[ca3ee9de1]](https://git.sudo.ws/sudo/commit/?id=ca3ee9de1)

* src/alloc.c, src/audit.c, src/error.c, src/lbuf.c, src/sudo\_noexec.c:

  Convert to ANSI C
  [[7ec040b54]](https://git.sudo.ws/sudo/commit/?id=7ec040b54)

* include/alloc.h, include/compat.h, include/error.h, include/lbuf.h,
  include/list.h, include/missing.h:

  Convert to ANSI C
  [[841807dd6]](https://git.sudo.ws/sudo/commit/?id=841807dd6)

* compat/charclass.h, compat/closefrom.c, compat/fnmatch.c,
  compat/fnmatch.h, compat/getcwd.c, compat/getline.c,
  compat/getprogname.c, compat/glob.c, compat/glob.h, compat/isblank.c,
  compat/memrchr.c, compat/mkstemp.c, compat/nanosleep.c,
  compat/sigaction.c, compat/snprintf.c, compat/strcasecmp.c,
  compat/strerror.c, compat/strlcat.c, compat/strlcpy.c,
  compat/strsignal.c, compat/utime.h, compat/utimes.c:

  Convert to ANSI C
  [[488c1531e]](https://git.sudo.ws/sudo/commit/?id=488c1531e)

2010-02-24 Todd C. Miller

* src/sudo.c, src/tgetpass.c:

  Make user\_details extern so tgetpass can get at the uid and gid. Set
  uid/gid to user before executing askpass program. Check environment for
  SUDO\_ASKPASS and use that if set. TODO: a way for the policy to set the
  askpass program itself
  [[9e5ff964a]](https://git.sudo.ws/sudo/commit/?id=9e5ff964a)

* src/sudo.c:

  No longer need sudo\_usage.h in sudo.c
  [[f3b2c9ac1]](https://git.sudo.ws/sudo/commit/?id=f3b2c9ac1)

* doc/sudo.cat, doc/sudo.man.in, doc/sudo.pod, doc/sudo\_plugin.man.in,
  doc/sudo\_plugin.pod, src/Makefile.in, src/parse\_args.c,
  src/sudo\_usage.h.in:

  Document -D level command line flag which maps to the debug\_level
  setting.
  [[07bf968c4]](https://git.sudo.ws/sudo/commit/?id=07bf968c4)

* doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in, doc/sudo\_plugin.pod:

  Document debug\_level in plugin doc. Still need to document the -D flag
  in sudo itself.
  [[9eb3e63c5]](https://git.sudo.ws/sudo/commit/?id=9eb3e63c5)

2010-02-22 Todd C. Miller

* match.c:

  Check for pseudo-command by looking at the first character of the
  command in sudoers instead of checking the user-supplied command for a
  slash.
  [[2a236bd21]](https://git.sudo.ws/sudo/commit/?id=2a236bd21)

2010-02-21 Todd C. Miller

* plugins/sample/sample\_plugin.c:

  include missing,h for vasprintf
  [[fac0743e8]](https://git.sudo.ws/sudo/commit/?id=fac0743e8)

* doc/Makefile.in, doc/sudo\_plugin.cat, doc/sudo\_plugin.man.in,
  doc/sudo\_plugin.pod:

  Rename plugin.pod -> sudo\_plugin.pod and wire into Makefile
  [[bcd021da5]](https://git.sudo.ws/sudo/commit/?id=bcd021da5)

* plugins/sample/sample\_plugin.c:

  Need to include limits.h
  [[80fae46be]](https://git.sudo.ws/sudo/commit/?id=80fae46be)

* compat/glob.c:

  No more sudo\_getpw\*
  [[edd5184ac]](https://git.sudo.ws/sudo/commit/?id=edd5184ac)

* plugins/sample/Makefile.in, src/Makefile.in:

  Add missing compat bits
  [[7200af0ce]](https://git.sudo.ws/sudo/commit/?id=7200af0ce)

* compat/closefrom.c, compat/mkstemp.c, plugins/sample/Makefile.in:

  compat files should not include sudo.h wire up compat in sample plugin
  [[b3176134c]](https://git.sudo.ws/sudo/commit/?id=b3176134c)

* Makefile, configure, configure.in, doc/Makefile.in, src/Makefile.in:

  Fix up compat dependencies. Fix distclean target in doc/Makefile.in
  [[fadb324f1]](https://git.sudo.ws/sudo/commit/?id=fadb324f1)

* configure, configure.in:

  Fix typo
  [[51131cdb8]](https://git.sudo.ws/sudo/commit/?id=51131cdb8)

* plugins/sample/sample\_plugin.c:

  Log input and output to temp files for proof of concept.
  [[781a054ab]](https://git.sudo.ws/sudo/commit/?id=781a054ab)

* Makefile, configure, configure.in, doc/Makefile.in:

  Add doc Makefile.in and wire it up
  [[279cf1e95]](https://git.sudo.ws/sudo/commit/?id=279cf1e95)

* src/script.c:

  Handle SIGSTOP in addition to SIGTSTP. Fixes a problem with suspending a
  shell with the “suspend” builtint.
  [[ad4a07a44]](https://git.sudo.ws/sudo/commit/?id=ad4a07a44)

* src/script.c:

  In child, handle parent side of the pipe going away.
  [[d73e870e6]](https://git.sudo.ws/sudo/commit/?id=d73e870e6)

* src/script.c:

  No longer need to check for explicit death of the child (process #2)
  since if it dies we will get EPIPE from the socketpair. Fix a sizeof()
  that was causing a spurious error. Convert SCRIPT\_DEBUG to sudo\_debug.
  [[32ea572f2]](https://git.sudo.ws/sudo/commit/?id=32ea572f2)

* src/sudo.c:

  Make sudo\_debug do a single vfprintf() which will result in a single
  write call on most systems. Avoids problems with interleaved debug
  printf from different processes. Also remove an extraneous error case
  since recv() can’t return a short read and add some more XXX.
  [[c2aaf8fbf]](https://git.sudo.ws/sudo/commit/?id=c2aaf8fbf)

2010-02-20 Todd C. Miller

* src/script.c:

  Fix uninitialized variable.
  [[afcac0824]](https://git.sudo.ws/sudo/commit/?id=afcac0824)

* src/Makefile.in:

  Fix sudo install target
  [[121c54705]](https://git.sudo.ws/sudo/commit/?id=121c54705)

* src/parse\_args.c, src/sudo.c, src/sudo.h:

  Wire up debug\_level
  [[abb431b36]](https://git.sudo.ws/sudo/commit/?id=abb431b36)

* src/Makefile.in:

  Fix dependencies
  [[b4e0f503e]](https://git.sudo.ws/sudo/commit/?id=b4e0f503e)

* configure, configure.in:

  Fix setting of plugin dir
  [[3327db217]](https://git.sudo.ws/sudo/commit/?id=3327db217)

* Makefile:

  add clean targets
  [[6dccb419f]](https://git.sudo.ws/sudo/commit/?id=6dccb419f)

* src/atobool.c:

  Add missing source for sudo front end
  [[4b88f1a7e]](https://git.sudo.ws/sudo/commit/?id=4b88f1a7e)

* plugins/sample/Makefile.in, plugins/sample/sample\_plugin.c:

  Sample plugin demonstrating the sudo plugin API
  [[3b354e36f]](https://git.sudo.ws/sudo/commit/?id=3b354e36f)

* Makefile, configure, configure.in, install-sh, pathnames.h.in,
  src/Makefile.in, src/conversation.c, src/fileops.c, src/fmt\_string.c,
  src/load\_plugins.c, src/parse\_args.c, src/pty.c, src/script.c,
  src/sudo.c, src/sudo.h, src/sudo\_plugin\_int.h, src/sudo\_usage.h.in,
  src/tgetpass.c:

  Modular sudo front-end which loads policy and I/O plugins that do most
  the actual work. Currently relies on dynamic loading using dlopen(). See
  doc/plugin.pod for the plugin API.
  [[b6a4cf723]](https://git.sudo.ws/sudo/commit/?id=b6a4cf723)

* doc/plugin.pod, include/sudo\_plugin.h:

  Sudo plugin API
  [[90c06ad7f]](https://git.sudo.ws/sudo/commit/?id=90c06ad7f)

* compat/fnmatch.c, compat/glob.c, compat/nanosleep.c, compat/utimes.c,
  plugins/sudoers/check.c, plugins/sudoers/gettime.c,
  plugins/sudoers/match.c, plugins/sudoers/sudoreplay.c,
  plugins/sudoers/testsudoers.c, plugins/sudoers/visudo.c, src/fileops.c,
  src/sudo\_edit.c:

  Replace emul/include.h with compat/include.h to match new source tree
  layout.
  [[d6187f5ad]](https://git.sudo.ws/sudo/commit/?id=d6187f5ad)

* src/lbuf.c:

  Include missing.h for memrchr() proto
  [[dc525d258]](https://git.sudo.ws/sudo/commit/?id=dc525d258)

* compat/charclass.h, compat/closefrom.c, compat/fnmatch.c,
  compat/fnmatch.h, compat/getcwd.c, compat/getline.c,
  compat/getprogname.c, compat/glob.c, compat/glob.h, compat/isblank.c,
  compat/memrchr.c, compat/mkstemp.c, compat/nanosleep.c,
  compat/sigaction.c, compat/snprintf.c, compat/strcasecmp.c,
  compat/strerror.c, compat/strlcat.c, compat/strlcpy.c,
  compat/strsignal.c, compat/timespec.h, compat/utime.h, compat/utimes.c,
  doc/HISTORY, doc/LICENSE, doc/PORTING, doc/TROUBLESHOOTING, doc/UPGRADE,
  doc/history.pod, doc/license.pod, doc/sample.pam, doc/sample.sudoers,
  doc/sample.syslog.conf, doc/schema.ActiveDirectory, doc/schema.OpenLDAP,
  doc/schema.iPlanet, doc/sudo.cat, doc/sudo.man.in, doc/sudo.man.pl,
  doc/sudo.pod, doc/sudoers.cat, doc/sudoers.ldap.cat,
  doc/sudoers.ldap.man.in, doc/sudoers.ldap.pod, doc/sudoers.man.in,
  doc/sudoers.man.pl, doc/sudoers.pod, doc/sudoreplay.cat,
  doc/sudoreplay.man.in, doc/sudoreplay.pod, doc/visudo.cat,
  doc/visudo.man.in, doc/visudo.pod, include/alloc.h, include/compat.h,
  include/error.h, include/lbuf.h, include/list.h, include/missing.h,
  plugins/sudoers/Makefile.binary.in, plugins/sudoers/Makefile.in,
  plugins/sudoers/aixcrypt.exp, plugins/sudoers/alias.c,
  plugins/sudoers/auth/API, plugins/sudoers/auth/afs.c,
  plugins/sudoers/auth/aix\_auth.c, plugins/sudoers/auth/bsdauth.c,
  plugins/sudoers/auth/dce.c, plugins/sudoers/auth/fwtk.c,
  plugins/sudoers/auth/kerb4.c, plugins/sudoers/auth/kerb5.c,
  plugins/sudoers/auth/pam.c, plugins/sudoers/auth/passwd.c,
  plugins/sudoers/auth/rfc1938.c, plugins/sudoers/auth/secureware.c,
  plugins/sudoers/auth/securid.c, plugins/sudoers/auth/securid5.c,
  plugins/sudoers/auth/sia.c, plugins/sudoers/auth/sudo\_auth.c,
  plugins/sudoers/auth/sudo\_auth.h, plugins/sudoers/boottime.c,
  plugins/sudoers/check.c, plugins/sudoers/def\_data.c,
  plugins/sudoers/def\_data.h, plugins/sudoers/def\_data.in,
  plugins/sudoers/defaults.c, plugins/sudoers/defaults.h,
  plugins/sudoers/env.c, plugins/sudoers/find\_path.c,
  plugins/sudoers/getdate.c, plugins/sudoers/getdate.y,
  plugins/sudoers/getspwuid.c, plugins/sudoers/gettime.c,
  plugins/sudoers/goodpath.c, plugins/sudoers/gram.c,
  plugins/sudoers/gram.h, plugins/sudoers/gram.y,
  plugins/sudoers/ins\_2001.h, plugins/sudoers/ins\_classic.h,
  plugins/sudoers/ins\_csops.h, plugins/sudoers/ins\_goons.h,
  plugins/sudoers/install-sh, plugins/sudoers/insults.h,
  plugins/sudoers/interfaces.c, plugins/sudoers/interfaces.h,
  plugins/sudoers/ldap.c, plugins/sudoers/logging.c,
  plugins/sudoers/logging.h, plugins/sudoers/match.c,
  plugins/sudoers/mkdefaults, plugins/sudoers/mon\_systrace.c,
  plugins/sudoers/mon\_systrace.h, plugins/sudoers/nonunix.h,
  plugins/sudoers/parse.c, plugins/sudoers/parse.h,
  plugins/sudoers/pwutil.c, plugins/sudoers/redblack.c,
  plugins/sudoers/redblack.h, plugins/sudoers/set\_perms.c,
  plugins/sudoers/sudo\_nss.c, plugins/sudoers/sudo\_nss.h,
  plugins/sudoers/sudoers, plugins/sudoers/sudoers.c,
  plugins/sudoers/sudoers.h, plugins/sudoers/sudoers2ldif,
  plugins/sudoers/sudoreplay.c, plugins/sudoers/testsudoers.c,
  plugins/sudoers/timestr.c, plugins/sudoers/toke.c,
  plugins/sudoers/toke.l, plugins/sudoers/tsgetgrpw.c,
  plugins/sudoers/vasgroups.c, plugins/sudoers/visudo.c, src/aix.c,
  src/alloc.c, src/audit.c, src/bsm\_audit.c, src/bsm\_audit.h, src/error.c,
  src/fileops.c, src/lbuf.c, src/list.c, src/pty.c, src/script.c,
  src/selinux.c, src/sesh.c, src/sudo\_edit.c, src/sudo\_noexec.c,
  src/term.c, src/tgetpass.c, src/zero\_bytes.c:

  Rework source layout in preparation for modular sudo.
  [[e90fa482f]](https://git.sudo.ws/sudo/commit/?id=e90fa482f)

2010-02-13 Todd C. Miller

* :

  Avoid a duplicate fclose() of the sudoers file.
  [[28c24027e]](https://git.sudo.ws/sudo/commit/?id=28c24027e)

* :

  Fix size arg when realloc()ing include stack. From Daniel Kopecek
  [[60adef2e3]](https://git.sudo.ws/sudo/commit/?id=60adef2e3)

* :

  Use setrlimit64(), if available, instead of setrlimit() when setting AIX
  resource limits since rlim\_t is 32bits.
  [[6b02fe5ea]](https://git.sudo.ws/sudo/commit/?id=6b02fe5ea)

* :

  Fix use after free when sending error messages. From Timo Juhani
  Lindfors
  [[7f59ba20b]](https://git.sudo.ws/sudo/commit/?id=7f59ba20b)

* :

  Generate the ChangeLog as part of “make dist” instead of having it in
  the repo.
  [[280a51cda]](https://git.sudo.ws/sudo/commit/?id=280a51cda)

2010-02-09 Todd C. Miller

* toke.l:

  Avoid a duplicate fclose() of the sudoers file.
  [[a40de29cb]](https://git.sudo.ws/sudo/commit/?id=a40de29cb)

* toke.l:

  Fix size arg when realloc()ing include stack. From Daniel Kopecek
  [[01240ab71]](https://git.sudo.ws/sudo/commit/?id=01240ab71)

2010-02-06 Todd C. Miller

* aix.c, config.h.in, configure, configure.in:

  Use setrlimit64(), if available, instead of setrlimit() when setting AIX
  resource limits since rlim\_t is 32bits.
  [[fd37f5c59]](https://git.sudo.ws/sudo/commit/?id=fd37f5c59)

* logging.c:

  Fix use after free when sending error messages. From Timo Juhani
  Lindfors
  [[d4d13c1ca]](https://git.sudo.ws/sudo/commit/?id=d4d13c1ca)

2010-01-18 Todd C. Miller

* ChangeLog, Makefile.in:

  Generate the ChangeLog as part of “make dist” instead of having it in
  the repo.
  [[c0f149b53]](https://git.sudo.ws/sudo/commit/?id=c0f149b53)

2010-01-17 Todd C. Miller

* Makefile.in:

  Generate correct ChangeLog for 1.7 branch.
  [[924daf022]](https://git.sudo.ws/sudo/commit/?id=924daf022)

* Makefile.binary.in, Makefile.in, aix.c, alias.c, alloc.c, alloc.h,
  auth/afs.c, auth/aix\_auth.c, auth/bsdauth.c, auth/dce.c, auth/fwtk.c,
  auth/kerb4.c, auth/kerb5.c, auth/pam.c, auth/passwd.c, auth/rfc1938.c,
  auth/secureware.c, auth/securid.c, auth/securid5.c, auth/sia.c,
  auth/sudo\_auth.c, auth/sudo\_auth.h, check.c, closefrom.c, compat.h,
  configure.in, defaults.c, defaults.h, emul/charclass.h, emul/timespec.h,
  env.c, error.c, error.h, fileops.c, find\_path.c, getcwd.c,
  getprogname.c, getspwuid.c, gettime.c, goodpath.c, gram.c, gram.y,
  ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h, insults.h,
  interfaces.c, interfaces.h, isblank.c, lbuf.c, lbuf.h, ldap.c, list.c,
  list.h, logging.c, logging.h, match.c, memrchr.c, missing.h,
  mkinstalldirs, mkstemp.c, mon\_systrace.c, nanosleep.c, parse.c, parse.h,
  pathnames.h.in, pty.c, pwutil.c, redblack.c, redblack.h, sample.pam,
  sample.sudoers, sample.syslog.conf, script.c, selinux.c, sesh.c,
  set\_perms.c, sigaction.c, snprintf.c, strcasecmp.c, strerror.c,
  strlcat.c, strlcpy.c, strsignal.c, sudo.c, sudo.h, sudo.man.in,
  sudo.pod, sudo\_edit.c, sudo\_noexec.c, sudo\_nss.c, sudo\_nss.h,
  sudo\_usage.h.in, sudoers.ldap.man.in, sudoers.ldap.pod, sudoers.man.in,
  sudoers.pod, sudoers2ldif, sudoreplay.c, sudoreplay.man.in,
  sudoreplay.pod, term.c, testsudoers.c, tgetpass.c, timestr.c, toke.c,
  toke.l, utimes.c, visudo.c, visudo.man.in, visudo.pod, zero\_bytes.c:

  Remove CVS $Sudo$ tags.
  [[3bb69ffe8]](https://git.sudo.ws/sudo/commit/?id=3bb69ffe8)

2010-01-18 convert-repo

* .hgtags:

  update tags
  [[4a50fafc1]](https://git.sudo.ws/sudo/commit/?id=4a50fafc1)

2009-12-26 Todd C. Miller

* sudo\_usage.h.in:

  make this match sudoers SYNOPSIS
  [[fb0e20802]](https://git.sudo.ws/sudo/commit/?id=fb0e20802)

* lbuf.c, parse.c:

  Print a newline between Runas and Command-specific defaults in sudo -l.
  [[8ca8f2400]](https://git.sudo.ws/sudo/commit/?id=8ca8f2400)

* term.c:

  Use SET and CLR macros in term\_raw
  [[d0b2086a6]](https://git.sudo.ws/sudo/commit/?id=d0b2086a6)

* sudoreplay.c:

  Set stdin to non-blocking mode early instead of in check\_input. Use
  term\_raw instead of term\_cbreak since the data we get has already been
  expanded via OPOST.
  [[8fbdbde2f]](https://git.sudo.ws/sudo/commit/?id=8fbdbde2f)

2009-12-23 Todd C. Miller

* script.c, term.c:

  Enable/disable all postprocessing instead of just nl->crnl processing
  since things like tab expansion matter too. However, if stdout is a tty
  leave postprocessing on in the pty since we run into problems doing it
  only on the real stdout with .e.g nvi.
  [[7a759cd2a]](https://git.sudo.ws/sudo/commit/?id=7a759cd2a)

2009-12-19 Todd C. Miller

* check.c:

  If tty\_tickets is enabled and there is no tty, prompt for a password. Do
  not lecture user for “sudo -k command” if user has a timestamp.
  [[ce63ab506]](https://git.sudo.ws/sudo/commit/?id=ce63ab506)

* INSTALL:

  Document missing options: –with-efence and –with-bsm-audit
  [[2df5bd857]](https://git.sudo.ws/sudo/commit/?id=2df5bd857)

* sudo.cat, sudo.man.in, sudo.pod, sudoers.cat, sudoers.ldap.cat,
  sudoers.ldap.man.in, sudoers.ldap.pod, sudoers.man.in, sudoers.pod,
  sudoreplay.cat, sudoreplay.man.in, sudoreplay.pod, visudo.cat,
  visudo.man.in, visudo.pod:

  username -> user name groupname -> group name hostname -> host name
  [[e007e2ad4]](https://git.sudo.ws/sudo/commit/?id=e007e2ad4)

* INSTALL, README.LDAP, sudoers.pod:

  filename -> file name like the rest of the docs
  [[00c89f014]](https://git.sudo.ws/sudo/commit/?id=00c89f014)

2009-12-17 Todd C. Miller

* parse.c:

  Fix printing of entries with multiple host entries on a single line.
  [[73dccdf93]](https://git.sudo.ws/sudo/commit/?id=73dccdf93)

2009-12-14 Todd C. Miller

* sudoers.pod:

  Mention that targetpw affects the timestamp file name.
  [[2bc6801ca]](https://git.sudo.ws/sudo/commit/?id=2bc6801ca)

* def\_data.c, def\_data.h, def\_data.in, defaults.c, script.c, sudoers.pod:

  Add compress\_transcript option.
  [[180785567]](https://git.sudo.ws/sudo/commit/?id=180785567)

2009-12-13 Todd C. Miller

* configure, configure.in:

  bump to 1.7.3b2
  [[6810071e8]](https://git.sudo.ws/sudo/commit/?id=6810071e8)

* pwutil.c, set\_perms.c, sudo.c, sudo\_nss.c:

  Better split of membership vs. traditional group check in
  user\_in\_group(). Allow user\_ngroups to be < 0 if getgroups() fails.
  [[d20335136]](https://git.sudo.ws/sudo/commit/?id=d20335136)

2009-12-12 Todd C. Miller

* pwutil.c:

  Fix pasto and add default return value.
  [[0d054f897]](https://git.sudo.ws/sudo/commit/?id=0d054f897)

* check.c, match.c, pwutil.c, sudo.h:

  refactor group member checking into user\_in\_group()
  [[ab72e242b]](https://git.sudo.ws/sudo/commit/?id=ab72e242b)

* check.c, config.h.in, configure, configure.in, match.c, sudo.c, sudo.h:

  Add support for mbr\_check\_membership() as present in darwin.
  [[b8239bb34]](https://git.sudo.ws/sudo/commit/?id=b8239bb34)

2009-12-10 Todd C. Miller

* match.c:

  Rename label to be accurate
  [[02ae5fd96]](https://git.sudo.ws/sudo/commit/?id=02ae5fd96)

* Makefile.in, boottime.c, check.c, config.h.in, configure, configure.in,
  sudo.h:

  Treat timestamp files from before we booted as old. Idea from and Apple
  patch.
  [[600ce3dfa]](https://git.sudo.ws/sudo/commit/?id=600ce3dfa)

2009-12-09 Todd C. Miller

* sudo.c, sudo.pod, sudo\_usage.h.in:

  Allow the -u flag to be used in conjunction with the -v flag as per
  older versions of sudo.
  [[8b48ab71e]](https://git.sudo.ws/sudo/commit/?id=8b48ab71e)

* logging.c:

  fix typo in last commit
  [[f325cfac8]](https://git.sudo.ws/sudo/commit/?id=f325cfac8)

2009-12-08 Todd C. Miller

* logging.c:

  Convert fmt\_first and fmt\_confd into macros.
  [[2a9810bfd]](https://git.sudo.ws/sudo/commit/?id=2a9810bfd)

* sudoers.pod:

  timeouts can be floats now
  [[a61c1806a]](https://git.sudo.ws/sudo/commit/?id=a61c1806a)

* WHATSNEW, def\_data.c, def\_data.h, def\_data.in, defaults.c, defaults.h,
  mkdefaults:

  Add support for floating point timeout values (e.g. 2.5 minutes).
  [[186d836eb]](https://git.sudo.ws/sudo/commit/?id=186d836eb)

2009-12-07 Todd C. Miller

* sudo.pod:

  The -L flag will be removed in sudo 1.7.4
  [[d92b6c5d9]](https://git.sudo.ws/sudo/commit/?id=d92b6c5d9)

2009-12-06 Todd C. Miller

* sudoreplay.c:

  Fix a bug due to order of operators.
  [[aa03d9cac]](https://git.sudo.ws/sudo/commit/?id=aa03d9cac)

2009-11-23 Todd C. Miller

* match.c:

  cmnd\_matches() already deals with negation so \_cmndlist\_matches() does
  not need to do so itself. Fixes a bug with negated entries in a
  Cmnd\_List.
  [[803dd9a7c]](https://git.sudo.ws/sudo/commit/?id=803dd9a7c)

2009-11-22 Todd C. Miller

* sudo.c:

  Don’t exit() from open\_sudoers, just return NULL for all errors.
  [[a86896a1c]](https://git.sudo.ws/sudo/commit/?id=a86896a1c)

* script.c:

  Can’t rely on the shell sending us SIGCONT when transitioning from
  backgroup to foreground process.
  [[453d055b4]](https://git.sudo.ws/sudo/commit/?id=453d055b4)

* toke.c, toke.l:

  Add missing extern def for parse\_error
  [[850990b88]](https://git.sudo.ws/sudo/commit/?id=850990b88)

2009-11-21 Todd C. Miller

* toke.c, toke.l:

  Avoid a parse error when #includedir doesn’t find any files. Closes bug
  #375
  [[22e333fc5]](https://git.sudo.ws/sudo/commit/?id=22e333fc5)

* Makefile.in:

  Include sudo.man.pl and sudoers.man.pl in the distribution tarball.
  [[41c3dc733]](https://git.sudo.ws/sudo/commit/?id=41c3dc733)

2009-11-15 Todd C. Miller

* script.c:

  Start command out in foreground mode if stdout is a tty. Works around
  issues with some curses-based programs that don’t handle tcsetattr
  getting interrupted by a signal. Still allows us to avoid hogging the
  tty if the command is part of a pipeline.
  [[84d4bc2df]](https://git.sudo.ws/sudo/commit/?id=84d4bc2df)

* script.c, sudo.c, sudo.h, sudoreplay.c, term.c, tgetpass.c:

  Use a socketpair to pass signals from parent to child. Child will now
  pass command status change info back via the socketpair. This allows the
  parent to distinguish between signals it has been sent directly and
  signals the command has received. It also means the parent can once
  again print the signal notifications to the tty so all writes to the pty
  master occur in the parent. The command is now always started in
  background mode with tty signals handled by the parent.
  [[dcf6602da]](https://git.sudo.ws/sudo/commit/?id=dcf6602da)

2009-11-04 Todd C. Miller

* configure, configure.in:

  Fix a few typos in the descriptions; from Jeff Makey Only do the check
  for krb5\_get\_init\_creds\_opt\_free() taking two arguments if we find
  krb5\_get\_init\_creds\_opt\_alloc(). Otherwise we will get a false positive
  when using our own krb5\_get\_init\_creds\_opt\_free which takes only a
  single argument.
  [[871b3fb12]](https://git.sudo.ws/sudo/commit/?id=871b3fb12)

2009-11-03 Todd C. Miller

* configure, configure.in:

  Remove a spurious comma in the kerb5 bits.
  [[d0fdeb12a]](https://git.sudo.ws/sudo/commit/?id=d0fdeb12a)

* auth/kerb5.c:

  Call krb5\_get\_init\_creds\_opt\_init() in our emulated
  krb5\_get\_init\_creds\_opt\_alloc() for MIT kerberos.
  [[ce0fdd554]](https://git.sudo.ws/sudo/commit/?id=ce0fdd554)

2009-11-01 Todd C. Miller

* config.h.in:

  Add HAVE\_ZLIB
  [[63fee4708]](https://git.sudo.ws/sudo/commit/?id=63fee4708)

* script.c:

  Need to ignore SIGTT{IN,OU} in child when running the command in the
  background. Also some minor cleanup.
  [[febc3cbb1]](https://git.sudo.ws/sudo/commit/?id=febc3cbb1)

2009-10-31 Todd C. Miller

* script.c:

  Instead of calling sigsuspend when waiting for SIGUSR[12] from parent,
  install the signal handlers w/o SA\_RESTART and let them interrupt
  waitpid().
  [[78cd63e07]](https://git.sudo.ws/sudo/commit/?id=78cd63e07)

* script.c:

  Pass along SIGHUP and SIGTERM from parent to child.
  [[94370b319]](https://git.sudo.ws/sudo/commit/?id=94370b319)

* script.c:

  Close unused bits of script\_fds in processes that don’t need them.
  Restore default SIGCONT handler in child.
  [[e6567f46b]](https://git.sudo.ws/sudo/commit/?id=e6567f46b)

* script.c:

  Update foreground/background status in SIGCONT handler in parent
  process.
  [[aee3382ed]](https://git.sudo.ws/sudo/commit/?id=aee3382ed)

2009-10-25 Todd C. Miller

* script.c:

  Defer setting terminal into raw mode until just before we fork() and
  only do it if sudo is the foreground process. If we get SIGTT{IN,OU} and
  sudo is already in the foreground be sure to set raw mode before
  continuing the child.
  [[e62dd7645]](https://git.sudo.ws/sudo/commit/?id=e62dd7645)

2009-10-24 Todd C. Miller

* script.c:

  Fix handling of SIGTTOU/SIGTTIN in program being run. We now only give
  the command the controlling tty if the main sudo process is the
  foreground process.
  [[c77ef16fc]](https://git.sudo.ws/sudo/commit/?id=c77ef16fc)

* script.c:

  Don’t bother with sudo\_waitpid() here for now.
  [[61b57817a]](https://git.sudo.ws/sudo/commit/?id=61b57817a)

* script.c:

  fix non-zlib case
  [[50f5d5516]](https://git.sudo.ws/sudo/commit/?id=50f5d5516)

2009-10-23 Todd C. Miller

* script.c:

  Remove non-wroking code that crept into rev 1.55
  [[470d3a192]](https://git.sudo.ws/sudo/commit/?id=470d3a192)

2009-10-22 Todd C. Miller

* INSTALL, configure, configure.in, script.c, sudoreplay.c:

  First pass at zlib support for transcript data files
  [[602a62c01]](https://git.sudo.ws/sudo/commit/?id=602a62c01)

* Makefile.in:

  remove vestiges of ZLDFLAGS
  [[aaa2f89ea]](https://git.sudo.ws/sudo/commit/?id=aaa2f89ea)

* script.c:

  Add missing variable declaration for when TIOCSCTTY is not defined. Need
  to include sys/termio.h for TIOCSCTTY on some systems.
  [[db502bb58]](https://git.sudo.ws/sudo/commit/?id=db502bb58)

* script.c:

  when resuming command, send SIGCONT to its pgrp not just pid
  [[03e0e4c74]](https://git.sudo.ws/sudo/commit/?id=03e0e4c74)

* selinux.c:

  remove unused variable
  [[777c82a4d]](https://git.sudo.ws/sudo/commit/?id=777c82a4d)

* script.c:

  include selinux.h for is\_selinux\_enabled() proto
  [[8fa5a519a]](https://git.sudo.ws/sudo/commit/?id=8fa5a519a)

* script.c:

  Don’t use log\_error() in the child process.
  [[b231f074a]](https://git.sudo.ws/sudo/commit/?id=b231f074a)

* script.c:

  Do I/O in parent instead of child since the parent can have both
  /dev/tty as well as the pty fds open. The child just sets things up and
  waits for its grandchild and writes the signal description to the pty
  master if the command was killed by a signal.
  [[425026fa1]](https://git.sudo.ws/sudo/commit/?id=425026fa1)

2009-10-18 Todd C. Miller

* missing.h, sudo.h:

  Move two struct forward declarations from sudo.h to missing.h
  [[773865eb1]](https://git.sudo.ws/sudo/commit/?id=773865eb1)

* script.c:

  Make comment at the top of script\_exec() match reality.
  [[27b221e43]](https://git.sudo.ws/sudo/commit/?id=27b221e43)

* sudo.c:

  if neither stdin nor stdout is a tty, check stderr
  [[7281ad3bc]](https://git.sudo.ws/sudo/commit/?id=7281ad3bc)

* Makefile.in:

  Add back dependecy of gram.h on gram.y
  [[c6ba8ebdd]](https://git.sudo.ws/sudo/commit/?id=c6ba8ebdd)

* script.c:

  Make transcript mode work as long as we can figure out our tty, even if
  it is not stdin. We’d like to use /dev/tty but that won’t be valid after
  the setsid().
  [[1a5afcbb1]](https://git.sudo.ws/sudo/commit/?id=1a5afcbb1)

2009-10-17 Todd C. Miller

* config.h.in, configure, configure.in, pty.c:

  Add support for IRIX-style dynamic ptys
  [[e5087b726]](https://git.sudo.ws/sudo/commit/?id=e5087b726)

* Makefile.in, alloc.h, getline.c, sudo.h, sudoreplay.c:

  Move alloc.c protos into alloc.h
  [[8cb463ade]](https://git.sudo.ws/sudo/commit/?id=8cb463ade)

* missing.h:

  Move prototypes for missing libc functions to missing.h
  [[335b895c1]](https://git.sudo.ws/sudo/commit/?id=335b895c1)

* Makefile.in, sudo.h, sudoreplay.c:

  Move prototypes for missing libc functions to missing.h
  [[8c6960e7a]](https://git.sudo.ws/sudo/commit/?id=8c6960e7a)

2009-10-16 Todd C. Miller

* config.h.in, configure, configure.in:

  Disable transcript support if no tcsetpgrp until we support older
  BSD-style job control.
  [[52b2762f7]](https://git.sudo.ws/sudo/commit/?id=52b2762f7)

* configure, configure.in, pty.c, script.c:

  Break out pty code into pty.c
  [[9544845ef]](https://git.sudo.ws/sudo/commit/?id=9544845ef)

* compat.h, config.h.in, configure, configure.in:

  add killpg macro if no killpg function
  [[e443ee9ff]](https://git.sudo.ws/sudo/commit/?id=e443ee9ff)

* config.h.in, configure, configure.in, script.c:

  Push ptem and ldterm for STERAMS-based systems when allocating a pty.
  [[babf9292d]](https://git.sudo.ws/sudo/commit/?id=babf9292d)

2009-10-15 Todd C. Miller

* script.c:

  Sprinkle some more O\_NOCTTY and call grantpt() before unlockpt()
  [[7d79b1da3]](https://git.sudo.ws/sudo/commit/?id=7d79b1da3)

* script.c:

  Call tcgetpgrp() in the parent, not the child and have the child spin
  until it is granted. Fixes a race on darwin.
  [[3ece4c837]](https://git.sudo.ws/sudo/commit/?id=3ece4c837)

* script.c:

  Only use TIOCNOTTY in the non-setsid case. If no TIOCSCTTY, just reopen
  slave.
  [[52f3374ce]](https://git.sudo.ws/sudo/commit/?id=52f3374ce)

2009-10-14 Todd C. Miller

* script.c:

  In script mode, if the command is killed by a signal, print the signal
  description as well as a core dump notification like the shell does.
  [[7411b071e]](https://git.sudo.ws/sudo/commit/?id=7411b071e)

* Makefile.in, config.h.in, configure, configure.in, strsignal.c, sudo.h:

  Add check for strsignal() and a simple implementation if it is not there
  but sys\_siglist is
  [[233377a8b]](https://git.sudo.ws/sudo/commit/?id=233377a8b)

* script.c:

  Add missing WUNTRACED and store the signal that stopped the grandchild
  in suspended, not signo.
  [[7bfe0fe95]](https://git.sudo.ws/sudo/commit/?id=7bfe0fe95)

* script.c:

  g/c unused code
  [[cd8ba1219]](https://git.sudo.ws/sudo/commit/?id=cd8ba1219)

* script.c:

  Associate the grandchild’s pgrp with the tty instead of the child’s and
  just get suspend notifications via SIGCHLD instead of directly. This
  fixes a hang with programs that try to set terminal attributes and is
  more consistent with how the shell handles things.
  [[0d04ffc40]](https://git.sudo.ws/sudo/commit/?id=0d04ffc40)

2009-10-12 Todd C. Miller

* script.c:

  Move setpgid() of child into the parent side of the fork() where it
  belongs.
  [[d72afb29a]](https://git.sudo.ws/sudo/commit/?id=d72afb29a)

2009-10-11 Todd C. Miller

* script.c:

  fix typo
  [[bc1769df2]](https://git.sudo.ws/sudo/commit/?id=bc1769df2)

* script.c:

  Run command in its own pgrp (like the shell does) for easier signalling.
  No need to relay SIGINT or SIGQUIT to parent, just send to grandchild.
  Don’t want grandchild stopped events in the child (only termination).
  Flush output after suspending grandchild before signalling parent.
  [[88b93973f]](https://git.sudo.ws/sudo/commit/?id=88b93973f)

* script.c:

  Back out revision 1.34; the problem lies elsewhere.
  [[a3185d3e2]](https://git.sudo.ws/sudo/commit/?id=a3185d3e2)

* script.c:

  Don’t set stdout to blocking mode when flushing remaining output. It can
  cause us to hang when trying to exit. Need to investigate why.
  [[f44c2261f]](https://git.sudo.ws/sudo/commit/?id=f44c2261f)

* script.c:

  Handle SIGTTOU and remove some debugging.
  [[03e3ca08d]](https://git.sudo.ws/sudo/commit/?id=03e3ca08d)

* term.c:

  Back out revision 1.10 as the signal that interrupts us may be SIGTTOU
  or SIGTTIN which the caller must handle.
  [[9afe6a842]](https://git.sudo.ws/sudo/commit/?id=9afe6a842)

* script.c:

  Apparently we need to send SIGSTOP to the command as well as ourself
  when we get SIGTSTP, the kernel doesn’t automatically stop the process
  for us.
  [[09a7bb78f]](https://git.sudo.ws/sudo/commit/?id=09a7bb78f)

* script.c:

  Use an extra process to act as the glue bewteen the sessions associated
  with the user’s controlling tty (what the shell uses) and the tty that
  sudo is using to do its logging. Basically, this means that if we get,
  e.g. SIGTSTP from the process sudo is running, we relay the signal to
  the parent so it’s shell can do the job control.
  [[2cf1b81ab]](https://git.sudo.ws/sudo/commit/?id=2cf1b81ab)

* term.c:

  Handle getting/setting terminal attributes when the fd is in
  non-blocking mode.
  [[3a343d499]](https://git.sudo.ws/sudo/commit/?id=3a343d499)

2009-10-07 Todd C. Miller

* sudoreplay.c, sudoreplay.cat, sudoreplay.man.in, sudoreplay.pod:

  Add support for pausing and changing the speed in interactive mode.
  [[55434759f]](https://git.sudo.ws/sudo/commit/?id=55434759f)

* script.c:

  Already define O\_NOCTTY in compat.h, don’t need it here
  [[50b62b694]](https://git.sudo.ws/sudo/commit/?id=50b62b694)

2009-10-06 Todd C. Miller

* sudoreplay.c:

  Add missing protos
  [[c8e048c20]](https://git.sudo.ws/sudo/commit/?id=c8e048c20)

2009-09-30 Todd C. Miller

* sudo\_edit.c:

  Always update the stashed mtime of the temp file instead of using what
  we have for the original because the time resolution of the filesystem
  the temporary is on may not match that of the filesystem that holds the
  original. Should fix bz #371 found by Philippe Levan.
  [[378d15f8f]](https://git.sudo.ws/sudo/commit/?id=378d15f8f)

* sudoreplay.c:

  Use cbreak mode instead of raw mode and add signal handlers to restore
  the tty on interrupt.
  [[5636a93f5]](https://git.sudo.ws/sudo/commit/?id=5636a93f5)

* script.c, sudo.h, term.c:

  Retain NL to NLCR conversion on the real tty and skip it on the pty we
  allocate. That way, if stdout is not a pty there are no extra carriage
  returns.
  [[fe9fc5ad1]](https://git.sudo.ws/sudo/commit/?id=fe9fc5ad1)

* script.c:

  Fix log\_output(); just pass in a string and a length.
  [[e6331c077]](https://git.sudo.ws/sudo/commit/?id=e6331c077)

2009-09-28 Todd C. Miller

* script.c:

  do not use errno when complaining out lack of a tty
  [[8e4379b26]](https://git.sudo.ws/sudo/commit/?id=8e4379b26)

2009-09-27 Todd C. Miller

* Makefile.in, sudoreplay.c, term.c:

  Instead of messing with line endings, just set terminal to raw mode in
  sudoreplay.
  [[0d9e1e7b6]](https://git.sudo.ws/sudo/commit/?id=0d9e1e7b6)

* term.c:

  When copying the terminal attributes to the pty, be sure not to set
  ONLCR. This prevents extra carriage returns from ending up in the script
  output file.
  [[929f13fdf]](https://git.sudo.ws/sudo/commit/?id=929f13fdf)

* script.c:

  Convert a do {} while into a while
  [[577fb346f]](https://git.sudo.ws/sudo/commit/?id=577fb346f)

* Makefile.in:

  Use if then instead of test && when installing binaries that may not
  exist.
  [[672d0f592]](https://git.sudo.ws/sudo/commit/?id=672d0f592)

* script.c:

  Add O\_NOCTTY when opening a tty device. Explicitly disconnect from old
  tty before associatng with new one.
  [[4283bbcb2]](https://git.sudo.ws/sudo/commit/?id=4283bbcb2)

* script.c, selinux.c, sudo.c, sudo.h:

  First cut at refactoring some of the selinux code so it can be used in
  conjunction with sudo’s transcript support.
  [[7d1947850]](https://git.sudo.ws/sudo/commit/?id=7d1947850)

2009-09-26 Todd C. Miller

* aclocal.m4, configure, configure.in:

  Fix default case of transcript\_enabled being unset.
  [[c6a8c71d2]](https://git.sudo.ws/sudo/commit/?id=c6a8c71d2)

* script.c, sudoreplay.c:

  Use \_PATH\_SUDO\_TRANSCRIPT instead of \_PATH\_SUDO\_SESSDIR
  [[d111b0d9b]](https://git.sudo.ws/sudo/commit/?id=d111b0d9b)

* INSTALL, Makefile.in, aclocal.m4, configure, configure.in, sudo.c:

  Hook up –disable-transcript and –enable-transcript=DIR
  [[8a6dcebd8]](https://git.sudo.ws/sudo/commit/?id=8a6dcebd8)

2009-09-25 Todd C. Miller

* aclocal.m4, configure, configure.in, pathnames.h.in:

  \_PATH\_SUDO\_SESSDIR -> \_PATH\_SUDO\_TRANSCRIPT Add –enable-transcript=DIR
  option to specify the directory
  [[0e823cdad]](https://git.sudo.ws/sudo/commit/?id=0e823cdad)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in:

  regen
  [[c4fa5baa1]](https://git.sudo.ws/sudo/commit/?id=c4fa5baa1)

* configure, configure.in, sudoers.man.pl, sudoers.pod:

  Substitute in default value for secure\_path
  [[104a402b6]](https://git.sudo.ws/sudo/commit/?id=104a402b6)

* sudo.pod:

  Mention that the password must be followed by a newline with the -S
  option.
  [[d8422c4ff]](https://git.sudo.ws/sudo/commit/?id=d8422c4ff)

2009-09-20 Todd C. Miller

* script.c:

  Go back to dropping out of the select() loop when the process dies;
  Linux ptys apparently don’t behave the same as BSD in regards to
  select(). No need to flush remaining output to the transcript, only to
  stdout. Add back code to check the master pty for additional data when
  we exit the main select loop.
  [[7bb38284b]](https://git.sudo.ws/sudo/commit/?id=7bb38284b)

2009-09-19 Todd C. Miller

* Makefile.in:

  Add getline.o to COMMON\_OBJS
  [[b008f3fda]](https://git.sudo.ws/sudo/commit/?id=b008f3fda)

* Makefile.in:

  sudoreplay depends on libsudo.a
  [[16a495c6c]](https://git.sudo.ws/sudo/commit/?id=16a495c6c)

* Makefile.in:

  More pwutil.o into COMMON\_OBJS
  [[6c4eea59e]](https://git.sudo.ws/sudo/commit/?id=6c4eea59e)

* pwutil.c, testsudoers.c, tsgetgrpw.c:

  Remove my\_\* redirection in pwutil.c for testsudoers and just use the
  normal libc get{pw,gr}\* names.
  [[e56d4af8f]](https://git.sudo.ws/sudo/commit/?id=e56d4af8f)

* sudoreplay.cat, sudoreplay.man.in, sudoreplay.pod:

  More time and date examples
  [[2950b0c75]](https://git.sudo.ws/sudo/commit/?id=2950b0c75)

* Makefile.in, configure, configure.in, nanosleep.c, sudoreplay.c:

  Move nanosleep() emulation into its own file Check librt.a for nanosleep
  if we don’t find it in libc
  [[6794ef532]](https://git.sudo.ws/sudo/commit/?id=6794ef532)

* Makefile.in, configure, configure.in:

  Build libsudo with the common bits and link things against that.
  [[2752268c9]](https://git.sudo.ws/sudo/commit/?id=2752268c9)

* script.c:

  Fix final flush.
  [[f68a24fb3]](https://git.sudo.ws/sudo/commit/?id=f68a24fb3)

* script.c:

  Keep reading from the pty master -> log file until read returns <= 0.
  Do our best to write everything to stdout when flushing any remaining
  bits.
  [[3223231b1]](https://git.sudo.ws/sudo/commit/?id=3223231b1)

* sudoreplay.c:

  Use unbuffered I/O when writing to stdout and make sure we write the
  entire buffer.
  [[7de6bbcfd]](https://git.sudo.ws/sudo/commit/?id=7de6bbcfd)

2009-09-18 Todd C. Miller

* sudoreplay.c:

  Only use max\_wait if it is non-zero
  [[6744c573b]](https://git.sudo.ws/sudo/commit/?id=6744c573b)

* getdate.c, getdate.y, getline.c:

  Need compat.h here
  [[b241a9e2d]](https://git.sudo.ws/sudo/commit/?id=b241a9e2d)

* sudoreplay.c:

  Fix nanosleep emulation
  [[680351cb9]](https://git.sudo.ws/sudo/commit/?id=680351cb9)

* script.c:

  Fix comment after #endif
  [[3cc02be8a]](https://git.sudo.ws/sudo/commit/?id=3cc02be8a)

* sudoreplay.c:

  Add protos for missing libc bits
  [[b9f4db895]](https://git.sudo.ws/sudo/commit/?id=b9f4db895)

* configure, configure.in:

  add missing line continuation char
  [[54e38658d]](https://git.sudo.ws/sudo/commit/?id=54e38658d)

* config.h.in, configure, configure.in, getline.c:

  Implement getline() in terms of fgetln() if we have it.
  [[f17c6df8e]](https://git.sudo.ws/sudo/commit/?id=f17c6df8e)

* sudoreplay.c:

  Print year when formatting log line
  [[89fa08f7e]](https://git.sudo.ws/sudo/commit/?id=89fa08f7e)

* sudoreplay.pod:

  Document cwd, attempt to document time/date formats.
  [[7011be08e]](https://git.sudo.ws/sudo/commit/?id=7011be08e)

* sudoreplay.c:

  Fix getline return value check.
  [[fb0fb0380]](https://git.sudo.ws/sudo/commit/?id=fb0fb0380)

* Makefile.in, config.h.in, configure, configure.in, getline.c,
  sudoreplay.c:

  Use getline() if the system has it, else use provide our own for
  sudoreplay.
  [[40114c9ba]](https://git.sudo.ws/sudo/commit/?id=40114c9ba)

* script.c:

  Refactor code to update output and timing files.
  [[798867ed2]](https://git.sudo.ws/sudo/commit/?id=798867ed2)

2009-09-17 Todd C. Miller

* sudoreplay.c:

  Make sudo\_getln() behave more like glibc getline.
  [[1a537514d]](https://git.sudo.ws/sudo/commit/?id=1a537514d)

* script.c:

  When flushing remaining output, also update timing file.
  [[74844b178]](https://git.sudo.ws/sudo/commit/?id=74844b178)

* sudoreplay.c:

  Use get\_timestr() and make the -l output look like the regular sudo log.
  [[4421db631]](https://git.sudo.ws/sudo/commit/?id=4421db631)

* logging.c, sudo.h, timestr.c:

  Make get\_timestr() take a time\_t so we can use it properly in
  sudoreplay.
  [[3fe7ac2b9]](https://git.sudo.ws/sudo/commit/?id=3fe7ac2b9)

* script.c:

  Create session dir earlier now that we update the seq number early.
  [[88a063b04]](https://git.sudo.ws/sudo/commit/?id=88a063b04)

2009-09-16 Todd C. Miller

* sudoreplay.c:

  Use fromdate and todate as the keywords instead of from and to; the
  short forms will still be accepted.
  [[705d23073]](https://git.sudo.ws/sudo/commit/?id=705d23073)

* sudoreplay.c:

  Fix reading long liensin sudo\_getln()
  [[f2b3a0e6c]](https://git.sudo.ws/sudo/commit/?id=f2b3a0e6c)

* script.c, sudoreplay.c:

  Log the cwd in the script log file. Add sudo\_getln() to read arbitrarily
  long lines.
  [[a418f7811]](https://git.sudo.ws/sudo/commit/?id=a418f7811)

* Makefile.in, logging.c, sudo.h, timestr.c:

  Move get\_timestr() into its own source file so sudoreplay can use it.
  [[28b3a1813]](https://git.sudo.ws/sudo/commit/?id=28b3a1813)

2009-09-15 Todd C. Miller

* sudoreplay.c:

  Add to and from perdicates (date ranges); needs documentation
  [[789d71601]](https://git.sudo.ws/sudo/commit/?id=789d71601)

2009-09-14 Todd C. Miller

* Makefile.in, getdate.c, getdate.y:

  Fix warning and add generated getdate.c
  [[8589fccae]](https://git.sudo.ws/sudo/commit/?id=8589fccae)

* Makefile.in, getdate.y:

  Add getdate.y to be used for sudoreplay date parsing.
  [[8c7750931]](https://git.sudo.ws/sudo/commit/?id=8c7750931)

2009-09-13 Todd C. Miller

* sudoreplay.c:

  Check more than just the first character of a predicate
  [[65500fa95]](https://git.sudo.ws/sudo/commit/?id=65500fa95)

* sudoreplay.cat, sudoreplay.man.in, sudoreplay.pod:

  Add examples, sort predicates
  [[5acbff40a]](https://git.sudo.ws/sudo/commit/?id=5acbff40a)

* Makefile.in, sudoreplay.c, sudoreplay.cat, sudoreplay.man.in,
  sudoreplay.pod:

  Implement search expressions in sudoreplay similar in concept to what
  find or tcpdump uses. TODO: date ranges
  [[3724c2e90]](https://git.sudo.ws/sudo/commit/?id=3724c2e90)

2009-09-07 Todd C. Miller

* script.c:

  Remove vhangup as it was hanging up the wrong tty. Should really vhangup
  in the child after it as set its tty.
  [[10fa87dfa]](https://git.sudo.ws/sudo/commit/?id=10fa87dfa)

* sudoers.pod:

  Fix cut at documenting transcript support.
  [[bd9854db5]](https://git.sudo.ws/sudo/commit/?id=bd9854db5)

* logging.c:

  ID= -> TSID= for transcript ID
  [[0040571c9]](https://git.sudo.ws/sudo/commit/?id=0040571c9)

2009-09-06 Todd C. Miller

* sudoers.pod:

  Move fast\_glob description to where it belongs in sorted order
  [[95c41c897]](https://git.sudo.ws/sudo/commit/?id=95c41c897)

* def\_data.c, def\_data.h, def\_data.in, gram.c, gram.h, gram.y, parse.c,
  parse.h, sudo.c:

  Rename script -> transcript
  [[927e98e29]](https://git.sudo.ws/sudo/commit/?id=927e98e29)

2009-09-03 Todd C. Miller

* compat.h:

  Add timeradd and timersub for those without them
  [[c8fc35b0a]](https://git.sudo.ws/sudo/commit/?id=c8fc35b0a)

* script.c:

  Sanity check sessid before using it.
  [[c1fe4492f]](https://git.sudo.ws/sudo/commit/?id=c1fe4492f)

* sudo.c:

  Only set the session id if we are running a command or editing a file.
  [[f80fa34e7]](https://git.sudo.ws/sudo/commit/?id=f80fa34e7)

* script.c:

  Actually. qsort is fine since most versions fal back to a cheaper sort
  when the number of elements to sort is small (like in our case).
  [[568c99b09]](https://git.sudo.ws/sudo/commit/?id=568c99b09)

* config.h.in, configure, configure.in, script.c:

  Check for dup2 and use dup instead if we don’t have it.
  [[2935e2a5b]](https://git.sudo.ws/sudo/commit/?id=2935e2a5b)

* script.c, sudo.c, sudo.h:

  Move the code to dup2 the script fds to low numbered descriptors into
  script\_duplow() and fix the fd sorting.
  [[c57b8bb7b]](https://git.sudo.ws/sudo/commit/?id=c57b8bb7b)

* script.c, sudo.c, sudo.h:

  Move script\_setup() back to immediately before we drop privs and call
  the new script\_nextid() in its place, which will set sudo\_user.sessid
  for the logging functions.
  [[ad9ab8dab]](https://git.sudo.ws/sudo/commit/?id=ad9ab8dab)

2009-09-01 Todd C. Miller

* Makefile.in:

  Install sudoreplay
  [[932914903]](https://git.sudo.ws/sudo/commit/?id=932914903)

* sudoreplay.c:

  remove unused variable
  [[f798228a7]](https://git.sudo.ws/sudo/commit/?id=f798228a7)

2009-08-30 Todd C. Miller

* logging.c, script.c, sudo.c, sudo.h:

  Log the session ID, if there is one. Currently logs ID=XXXXXX, perhaps
  should be SESSIONID or SESSID.
  [[6184eb946]](https://git.sudo.ws/sudo/commit/?id=6184eb946)

* Makefile.in, configure, configure.in, sudoreplay.cat, sudoreplay.man.in,
  sudoreplay.pod:

  Add sudoreplay docs
  [[5181d496c]](https://git.sudo.ws/sudo/commit/?id=5181d496c)

* sudoreplay.c:

  add -V (version) flag
  [[7ae1dae37]](https://git.sudo.ws/sudo/commit/?id=7ae1dae37)

* sudoreplay.c:

  Hook up max\_wait.
  [[5dd8fe2fe]](https://git.sudo.ws/sudo/commit/?id=5dd8fe2fe)

* script.c, sudoreplay.c:

  Use base36 number for the ID and store script files with paths like
  /var/log/sudo-session/00/00/00{,.tim,.scr}. This gives us 36^6
  (2,176,782,336) unique IDs.
  [[b9f38b2ac]](https://git.sudo.ws/sudo/commit/?id=b9f38b2ac)

2009-08-23 Todd C. Miller

* config.h.in, configure.in:

  Add check for regcomp
  [[6ae9dae82]](https://git.sudo.ws/sudo/commit/?id=6ae9dae82)

* sudoreplay.c:

  Add support for selecting by pattern and tty when listing.
  [[9efd18b1b]](https://git.sudo.ws/sudo/commit/?id=9efd18b1b)

2009-08-17 Todd C. Miller

* sudoreplay.c:

  The beginnings of a list mode.
  [[30cfb7160]](https://git.sudo.ws/sudo/commit/?id=30cfb7160)

2009-08-16 Todd C. Miller

* Makefile.in:

  fix pasto
  [[051eab750]](https://git.sudo.ws/sudo/commit/?id=051eab750)

* Makefile.in, config.h.in, configure.in:

  Add scaffolding for building sudoreplay
  [[7a00c5257]](https://git.sudo.ws/sudo/commit/?id=7a00c5257)

* sudoreplay.c:

  include error.h first arg to nanotime is const
  [[20ad41f4d]](https://git.sudo.ws/sudo/commit/?id=20ad41f4d)

* sudoreplay.c:

  Initial cut at sudoreplay; replay a sudo session.
  [[e4be17511]](https://git.sudo.ws/sudo/commit/?id=e4be17511)

2009-08-08 Todd C. Miller

* script.c:

  Fix wait() usage and use correct wait status.
  [[946ea4c97]](https://git.sudo.ws/sudo/commit/?id=946ea4c97)

* sudo.c, sudo.h, tgetpass.c:

  Add protos for term\_\* to sudo.h
  [[0ab5c31ee]](https://git.sudo.ws/sudo/commit/?id=0ab5c31ee)

* script.c:

  Fix detection of the child process exiting. Since the child is in its
  own session we should only ever get SIGCHLD for that process but better
  safe than sorry.
  [[40a21a6c7]](https://git.sudo.ws/sudo/commit/?id=40a21a6c7)

* config.h.in:

  Add UNIX98 pty support.
  [[834e817fa]](https://git.sudo.ws/sudo/commit/?id=834e817fa)

* configure, configure.in, script.c:

  Add UNIX98 pty support.
  [[c3c6c299e]](https://git.sudo.ws/sudo/commit/?id=c3c6c299e)

2009-08-07 Todd C. Miller

* term.c:

  For raw mode, don’t bother clearing BRKINT or PARMRK and clear IUCLC if
  it is defined.
  [[92dcfa896]](https://git.sudo.ws/sudo/commit/?id=92dcfa896)

* auth/pam.c:

  Set PAM\_RUSER and PAM\_RHOST early so they can be used during
  authentication. Based on a patch from Jamie Beverly.
  [[3bc3a2e85]](https://git.sudo.ws/sudo/commit/?id=3bc3a2e85)

* match.c:

  Close dir before returning if strlcpy() reports overflow. From Martynas
  Venckus.
  [[fde79c46f]](https://git.sudo.ws/sudo/commit/?id=fde79c46f)

* config.h.in, configure, configure.in, script.c:

  On Linux, the openpty proto libes in pty.h
  [[ee20527bf]](https://git.sudo.ws/sudo/commit/?id=ee20527bf)

* script.c:

  Call vhangup on exit if the system has it Use setpgrp() if no setsid()
  [[51793254e]](https://git.sudo.ws/sudo/commit/?id=51793254e)

2009-08-06 Todd C. Miller

* config.h.in, configure, configure.in:

  Add checks for revoke and vhangup if we don’t have openpty
  [[b3458ec09]](https://git.sudo.ws/sudo/commit/?id=b3458ec09)

* script.c:

  Session logging guts that got forgotten in the previous commit.
  [[ee45ce4db]](https://git.sudo.ws/sudo/commit/?id=ee45ce4db)

* Makefile.in, aclocal.m4, compat.h, config.h.in, configure, configure.in,
  def\_data.c, def\_data.h, def\_data.in, gram.c, gram.h, gram.y, parse.c,
  parse.h, pathnames.h.in, sudo.c, sudo.h, term.c, tgetpass.c:

  First cut at session logging for sudo. Still need to write get\_pty() for
  Unix 98 and old-style BSD ptys. Also needs documentation and general
  cleanup.
  [[3bfce30a8]](https://git.sudo.ws/sudo/commit/?id=3bfce30a8)

2009-08-05 Todd C. Miller

* sudo.c, sudo\_edit.c:

  Fix a bug introduced with def\_closefrom. The value of def\_closefrom
  already includes the +1.
  [[334c19a40]](https://git.sudo.ws/sudo/commit/?id=334c19a40)

2009-07-29 Todd C. Miller

* Makefile.in:

  Generate sudo distributions with pax in ustar mode. No longer need to
  use a temp file or have the source dir name match the version.
  [[477f895ec]](https://git.sudo.ws/sudo/commit/?id=477f895ec)

2009-07-18 Todd C. Miller

* toke.c, toke.l:

  Fix expansion of %h in #include names. Fixes bugzilla 363
  [[b8ca82fee]](https://git.sudo.ws/sudo/commit/?id=b8ca82fee)

2009-07-12 Todd C. Miller

* mkdefaults:

  If no arg assume def\_data.in
  [[51e292a47]](https://git.sudo.ws/sudo/commit/?id=51e292a47)

* README, WHATSNEW:

  Update for 1.7.2
  [[2b80daae9]](https://git.sudo.ws/sudo/commit/?id=2b80daae9)

* ChangeLog:

  sync
  [[dd52fff16]](https://git.sudo.ws/sudo/commit/?id=dd52fff16)

2009-06-30 Todd C. Miller

* sudoers.cat, sudoers.man.in, sudoers.pod:

  Add missing single quotes around a colon in Runas\_Spec definition. From
  Elias Benali.
  [[0d73e1924]](https://git.sudo.ws/sudo/commit/?id=0d73e1924)

2009-06-29 Todd C. Miller

* sudo.man.in, sudoers.man.in:

  regen
  [[29ca85390]](https://git.sudo.ws/sudo/commit/?id=29ca85390)

* redblack.c:

  In rbrepair, re-color the root or the first non-block node we find to be
  black. Re-coloring the root is probably not needed but won’t hurt.
  [[02dd5d998]](https://git.sudo.ws/sudo/commit/?id=02dd5d998)

* sudo.cat, sudoers.cat:

  regen
  [[4764730f7]](https://git.sudo.ws/sudo/commit/?id=4764730f7)

2009-06-26 Todd C. Miller

* redblack.c:

  When repairing the tree, don’t touch the root node.
  [[ca2e91126]](https://git.sudo.ws/sudo/commit/?id=ca2e91126)

2009-06-25 Todd C. Miller

* set\_perms.c:

  Protect call to setegid in runas\_setup with #ifdef HAVE\_SETEUID.
  Reported by Josef Schmid.
  [[4e0200a33]](https://git.sudo.ws/sudo/commit/?id=4e0200a33)

2009-06-23 Todd C. Miller

* sudoers.pod:

  Document that we accept env\_pam-style environment files
  [[b2189fede]](https://git.sudo.ws/sudo/commit/?id=b2189fede)

* env.c:

  Adapt to accept pam\_env-style /etc/environment which allows shell-style
  lines such as: export EDITOR="/usr/bin/vi”
  [[0c669eda2]](https://git.sudo.ws/sudo/commit/?id=0c669eda2)

* sudoers.pod:

  Make it clear that env\_delete only works when !env\_reset. From LoÃÂ¯c
  Minier
  [[8f1643467]](https://git.sudo.ws/sudo/commit/?id=8f1643467)

2009-06-15 Todd C. Miller

* sudo.pod, sudoers.pod:

  Add non-unix group bits, adapted from Quest
  [[d2efb0a55]](https://git.sudo.ws/sudo/commit/?id=d2efb0a55)

* Makefile.in:

  build the .cat page in the current working dir, not the src dir
  [[3086f937f]](https://git.sudo.ws/sudo/commit/?id=3086f937f)

* env.c:

  Return EINVAL in setenv() if var is NULL or the empty string to match
  glibc behavior.
  [[44ace7735]](https://git.sudo.ws/sudo/commit/?id=44ace7735)

2009-06-13 Todd C. Miller

* configure, configure.in:

  Use AS\_HELP\_STRING for AC\_ARG\_WITH and AC\_ARG\_ENABLE
  [[633357448]](https://git.sudo.ws/sudo/commit/?id=633357448)

2009-06-11 Todd C. Miller

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.ldap.cat,
  sudoers.ldap.man.in, sudoers.man.in, visudo.cat, visudo.man.in:

  regen
  [[e939739aa]](https://git.sudo.ws/sudo/commit/?id=e939739aa)

2009-06-09 Todd C. Miller

* INSTALL:

  Document –with-libvas and –with-libvas-rpath
  [[54c599d71]](https://git.sudo.ws/sudo/commit/?id=54c599d71)

2009-05-29 Todd C. Miller

* ldap.c, sudoers.ldap.pod:

  For netscape-derived LDAP SDKs the cert and key paths may be a directory
  or a file. However, version 5.0 of the SDK only seems to support using a
  directory. If ldapssl\_clientauth\_init fails and the cert or key paths
  look like they could be files, strip off the last path element and try
  again.
  [[9606d2165]](https://git.sudo.ws/sudo/commit/?id=9606d2165)

* Makefile.in:

  Add non-Unix group .o to COMMON\_OBJS and substitute in path to flex.
  [[073981ea8]](https://git.sudo.ws/sudo/commit/?id=073981ea8)

2009-05-27 Todd C. Miller

* configure, configure.in, match.c, sudo.c, vasgroups.c:

  Update non-Unix group support from Quest, as reworked by me.
  [[7b7ae44ea]](https://git.sudo.ws/sudo/commit/?id=7b7ae44ea)

* toke.c:

  regen
  [[3ea51f226]](https://git.sudo.ws/sudo/commit/?id=3ea51f226)

* toke.l:

  Add support for escaped hex chars in names, e.g. \x20 for space.
  [[c70841395]](https://git.sudo.ws/sudo/commit/?id=c70841395)

2009-05-25 Todd C. Miller

* LICENSE, Makefile.in, aclocal.m4, alias.c, auth/aix\_auth.c, auth/pam.c,
  auth/sudo\_auth.c, auth/sudo\_auth.h, check.c, env.c, fileops.c, glob.c,
  gram.y, interfaces.c, lbuf.c, ldap.c, logging.c, logging.h, match.c,
  parse.c, parse.h, pathnames.h.in, pwutil.c, set\_perms.c, sudo.c, sudo.h,
  sudo.pod, sudo\_nss.c, sudo\_nss.h, sudo\_usage.h.in, sudoers.ldap.pod,
  sudoers.pod, testsudoers.c, tgetpass.c, toke.l, visudo.c:

  Update copyright years.
  [[62b89f9df]](https://git.sudo.ws/sudo/commit/?id=62b89f9df)

2009-05-24 Todd C. Miller

* interfaces.c, lbuf.c:

  Minor fixes for Minix-3
  [[4341ce6cd]](https://git.sudo.ws/sudo/commit/?id=4341ce6cd)

2009-05-22 Todd C. Miller

* set\_perms.c:

  Handle getgroups() returning 0. Also add missing check for
  HAVE\_GETGROUPS.
  [[896508077]](https://git.sudo.ws/sudo/commit/?id=896508077)

2009-05-19 Todd C. Miller

* Makefile.in, config.h.in, configure, configure.in, sudo.c, version.h,
  visudo.c:

  Replace version.h with PACKAGE\_VERSION set via AC\_INIT in configure.
  [[f54b69b0c]](https://git.sudo.ws/sudo/commit/?id=f54b69b0c)

2009-05-18 Todd C. Miller

* set\_perms.c:

  Remove group setting code in setusercontext case, we will do it
  ourselves later on in runas\_setup. Set the gid after
  initgroups/setgroups is called, since on Mac OS X it seems to change the
  egid.
  [[5f9f29a23]](https://git.sudo.ws/sudo/commit/?id=5f9f29a23)

2009-05-17 Todd C. Miller

* LICENSE, Makefile.in, config.h.in, match.c, nonunix.h, sudo.c,
  vasgroups.c:

  Initial bits of non-unix group support using Quest Authentication
  Services
  [[d98536623]](https://git.sudo.ws/sudo/commit/?id=d98536623)

* toke.c, toke.l:

  Accept %:foo as a non-Unix group
  [[f3407d869]](https://git.sudo.ws/sudo/commit/?id=f3407d869)

* toke.c, toke.l:

  Allow user/group to be double quoted in the case of non-Unix groups
  which contain spaces.
  [[e74bea762]](https://git.sudo.ws/sudo/commit/?id=e74bea762)

2009-05-11 Todd C. Miller

* match.c:

  Don’t allow the user to specify the default runas user if their sudoers
  entry only allows them to run as a group.
  [[8d3491356]](https://git.sudo.ws/sudo/commit/?id=8d3491356)

2009-05-10 Todd C. Miller

* sudo.c:

  Must call audit\_success before we change uids.
  [[c0ac222c3]](https://git.sudo.ws/sudo/commit/?id=c0ac222c3)

* logging.c, set\_perms.c, sudo.h, testsudoers.c:

  Add option for set\_perm to not exit on failure and use this in the
  logging routines.
  [[755a81e94]](https://git.sudo.ws/sudo/commit/?id=755a81e94)

* parse.c:

  In -l mode, if the user is only allowed to run as a group, display the
  user’s name, not root’s before the allowed group.
  [[2a609b467]](https://git.sudo.ws/sudo/commit/?id=2a609b467)

* sudo.c:

  Fix -g mode, broken by rev 1.503 which had the side effect of setting
  the runas user to root unilaterally.
  [[3332ee984]](https://git.sudo.ws/sudo/commit/?id=3332ee984)

2009-05-08 Todd C. Miller

* fileops.c:

  When unlocking a file with fcntl, use F\_SETLK, not F\_SETLKW.
  [[9251cf24a]](https://git.sudo.ws/sudo/commit/?id=9251cf24a)

* pwutil.c:

  Only cache by the method we fetched for pwd and grp lookups. Previously
  we cached both by namd and id but this can cause problems for entries
  that share the same id. Also add more info in the error message in case
  the insert fails (which should now be impossible).
  [[03f4a2e70]](https://git.sudo.ws/sudo/commit/?id=03f4a2e70)

2009-04-30 Todd C. Miller

* sudoers.pod:

  Add a clarification from Nick Sieger
  [[2b8994112]](https://git.sudo.ws/sudo/commit/?id=2b8994112)

2009-04-25 Todd C. Miller

* env.c:

  Inline the setting of the environment string.
  [[8d7518a18]](https://git.sudo.ws/sudo/commit/?id=8d7518a18)

2009-04-24 Todd C. Miller

* env.c:

  setenv(3) in Linux treats a NUL value as the empty string setenv(3) in
  BSD doesn’t return an error if the name has ‘=’ in it, it just treats
  the ‘=’ as end of string.
  [[c0c7180bb]](https://git.sudo.ws/sudo/commit/?id=c0c7180bb)

2009-04-22 Todd C. Miller

* toke.c, toke.l:

  Not all systems have d\_namlen
  [[182711e34]](https://git.sudo.ws/sudo/commit/?id=182711e34)

2009-04-20 Todd C. Miller

* sudoers.pod:

  Fix up some pod2html issues.
  [[db9860aa3]](https://git.sudo.ws/sudo/commit/?id=db9860aa3)

2009-04-19 Todd C. Miller

* interfaces.c:

  Check for NULL ifa\_addr and ifa\_netmask. Adapted from a diff from Quest
  Software.
  [[78c347990]](https://git.sudo.ws/sudo/commit/?id=78c347990)

* sudoers.pod:

  Ignore files ending in ‘~’ in sudo.d (emacs backup files)
  [[0509ce3f6]](https://git.sudo.ws/sudo/commit/?id=0509ce3f6)

* toke.c, toke.l:

  Ignore files ending in ‘~’ in sudo.d (emacs backup files)
  [[72a1d8241]](https://git.sudo.ws/sudo/commit/?id=72a1d8241)

2009-04-18 Todd C. Miller

* sudoers.cat, sudoers.man.in, sudoers.pod, toke.c, toke.l:

  For #includedir, ignore any file containing a dot
  [[95de5670a]](https://git.sudo.ws/sudo/commit/?id=95de5670a)

* Makefile.in, version.h:

  Bump version
  [[392edea92]](https://git.sudo.ws/sudo/commit/?id=392edea92)

* gram.c, gram.y, parse.c, parse.h, sudo.c, sudo.h, sudoers.cat,
  sudoers.man.in, sudoers.pod, testsudoers.c, toke.c, toke.l, visudo.c:

  Implement #includedir directive. Files in an includedir are not edited
  by visudo unless they contain a syntax error.
  [[3be603aa4]](https://git.sudo.ws/sudo/commit/?id=3be603aa4)

* ChangeLog:

  sync
  [[e65ec1438]](https://git.sudo.ws/sudo/commit/?id=e65ec1438)

* WHATSNEW:

  Forgot umask\_override
  [[584a14555]](https://git.sudo.ws/sudo/commit/?id=584a14555)

* ChangeLog, TODO:

  sync
  [[bfce2852f]](https://git.sudo.ws/sudo/commit/?id=bfce2852f)

2009-04-16 Todd C. Miller

* visudo.c:

  Rewind stream if we fdopen sudoers since it may not be at the beginning.
  Set the keepopen flag on already-open files too so the lexer doesn’t
  close them out from under us.
  [[68ab808ac]](https://git.sudo.ws/sudo/commit/?id=68ab808ac)

* visudo.c:

  Print the proper file name when there is a parse error in an include
  file.
  [[c7c8554cf]](https://git.sudo.ws/sudo/commit/?id=c7c8554cf)

2009-04-11 Todd C. Miller

* WHATSNEW:

  Sync
  [[e4c408392]](https://git.sudo.ws/sudo/commit/?id=e4c408392)

2009-04-10 Todd C. Miller

* configure, configure.in:

  Fix a warning when –without-ldap is specified.
  [[8eae33753]](https://git.sudo.ws/sudo/commit/?id=8eae33753)

2009-04-05 Todd C. Miller

* alias.c, parse.h, visudo.c:

  Store aliases that we remove during check\_aliases in a freelist and free
  them at the end so we don’t leak memory.
  [[d9708f9c2]](https://git.sudo.ws/sudo/commit/?id=d9708f9c2)

2009-03-28 Todd C. Miller

* visudo.c:

  Check aliases in -c mode too.
  [[9703224b8]](https://git.sudo.ws/sudo/commit/?id=9703224b8)

* alias.c, parse.h, visudo.c:

  Make alias\_remove return the alias struct instead of freeing it
  directly. Fixes a use after free in alias\_remove\_recursive, the only
  consumer.
  [[7bf7af941]](https://git.sudo.ws/sudo/commit/?id=7bf7af941)

* alias.c, match.c, parse.c, parse.h, visudo.c:

  Rename find\_alias -> alias\_find for consistency.
  [[065662998]](https://git.sudo.ws/sudo/commit/?id=065662998)

2009-03-27 Todd C. Miller

* visudo.c:

  When checking for unused aliases, recurse if the alias points to another
  alias.
  [[b65831d4b]](https://git.sudo.ws/sudo/commit/?id=b65831d4b)

2009-03-16 Todd C. Miller

* ldap.c:

  Back out rev 1.105 for now. Real ldapux\_client.conf support will be done
  later after some refactoring.
  [[322abc61e]](https://git.sudo.ws/sudo/commit/?id=322abc61e)

2009-03-14 Todd C. Miller

* ldap.c:

  Treat ldap\_hostport the same as “host” for ldapux.
  [[c07c11f6b]](https://git.sudo.ws/sudo/commit/?id=c07c11f6b)

* configure, configure.in:

  Only check for ldap\_sasl\_interactive\_bind\_s if we can find sasl.h. Fixes
  compilation with ldapux.
  [[28ce9e96e]](https://git.sudo.ws/sudo/commit/?id=28ce9e96e)

2009-03-12 Todd C. Miller

* fileops.c:

  fix char subscript
  [[cd900bdc2]](https://git.sudo.ws/sudo/commit/?id=cd900bdc2)

2009-03-11 Todd C. Miller

* Makefile.in:

  remove errant carriage returns
  [[55ddfd48a]](https://git.sudo.ws/sudo/commit/?id=55ddfd48a)

* audit.c, env.c:

  fix K&R compilation
  [[2012ce9ea]](https://git.sudo.ws/sudo/commit/?id=2012ce9ea)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.ldap.cat,
  sudoers.ldap.man.in, sudoers.man.in, visudo.cat, visudo.man.in:

  regen
  [[fc0ca59db]](https://git.sudo.ws/sudo/commit/?id=fc0ca59db)

2009-03-10 Todd C. Miller

* config.h.in:

  Add missing HAVE\_BSM\_AUDIT
  [[45334b209]](https://git.sudo.ws/sudo/commit/?id=45334b209)

* WHATSNEW:

  Add 1.7.1 features
  [[870fd4073]](https://git.sudo.ws/sudo/commit/?id=870fd4073)

* INSTALL:

  Mention –with-netsvc
  [[5dec26b06]](https://git.sudo.ws/sudo/commit/?id=5dec26b06)

* sudoers.ldap.pod:

  Document netsvc.conf support
  [[f50deedc3]](https://git.sudo.ws/sudo/commit/?id=f50deedc3)

* configure, configure.in, pathnames.h.in, sudo.c, sudo\_nss.c, sudo\_nss.h:
  Add support for AIX netsvc.conf (like nsswitch.conf).
  [[838cb6108]](https://git.sudo.ws/sudo/commit/?id=838cb6108)

2009-03-08 Todd C. Miller

* config.h.in, configure, configure.in, env.c:

  Add –enable-env-debug flag to enable environment sanity checks.
  [[91f04dc3b]](https://git.sudo.ws/sudo/commit/?id=91f04dc3b)

* sudoers.ldap.pod, sudoers.pod:

  Work around some pod2html issue.
  [[9e85f3754]](https://git.sudo.ws/sudo/commit/?id=9e85f3754)

2009-03-07 Todd C. Miller

* env.c:

  Only sync environ for putenv, setenv, and unsetenv. We need to make sure
  that sudo\_putenv and sudo\_setenv only modify env.envp, not environ.
  [[f64125368]](https://git.sudo.ws/sudo/commit/?id=f64125368)

2009-03-02 Todd C. Miller

* env.c:

  Really fix UNSETENV\_VOID
  [[0fee90c19]](https://git.sudo.ws/sudo/commit/?id=0fee90c19)

* env.c:

  Fix unsetenv when UNSETENV\_VOID
  [[a7a53b5f4]](https://git.sudo.ws/sudo/commit/?id=a7a53b5f4)

* aclocal.m4, configure:

  Fix SUDO\_FUNC\_PUTENV\_CONST
  [[e43e319ae]](https://git.sudo.ws/sudo/commit/?id=e43e319ae)

* ldap.c:

  tivoli-based ldap does not have ldapssl\_err2string
  [[4210f536c]](https://git.sudo.ws/sudo/commit/?id=4210f536c)

* configure:

  regen
  [[237d4e922]](https://git.sudo.ws/sudo/commit/?id=237d4e922)

2009-03-01 Todd C. Miller

* config.h.in, configure, configure.in, ldap.c:

  Add support for Tivoli-based LDAP start TLS as seen in AIX. Untested.
  [[ef071fa65]](https://git.sudo.ws/sudo/commit/?id=ef071fa65)

* env.c:

  Add sanity checks for setenv/unsetenv
  [[3c8acdd64]](https://git.sudo.ws/sudo/commit/?id=3c8acdd64)

* Makefile.in:

  Include bsm\_audit.h in the tarball
  [[aafea55f2]](https://git.sudo.ws/sudo/commit/?id=aafea55f2)

* Makefile.in, version.h:

  bump version for sudo 1.7.1
  [[dff0b6b52]](https://git.sudo.ws/sudo/commit/?id=dff0b6b52)

* aclocal.m4, auth/aix\_auth.c, config.h.in, configure, configure.in,
  env.c, ldap.c, sudo.h:

  Replace sudo\_setenv/sudo\_unsetenv with calls to setenv/unsetenv and
  provide our own setenv/unsetenv/putenv that operates on own env pointer.
  Make sync\_env() inline in setenv/unsetenv/putenv functions.
  [[6fed38f32]](https://git.sudo.ws/sudo/commit/?id=6fed38f32)

2009-02-25 Todd C. Miller

* sudo.c:

  Make “sudoedit -h” work as expected
  [[a25aee9cb]](https://git.sudo.ws/sudo/commit/?id=a25aee9cb)

* auth/pam.c:

  Make sure def\_prompt is always defined. This is a workaround for pam
  configs that prompt for a password in the session but don’t have an auth
  line. A better fix is to expand the sudo prompt earlier and set
  def\_prompt to that when initializing.
  [[536ba5e23]](https://git.sudo.ws/sudo/commit/?id=536ba5e23)

* sudo.pod:

  Mention that the helper for -A may be graphical.
  [[0c0560975]](https://git.sudo.ws/sudo/commit/?id=0c0560975)

* TROUBLESHOOTING:

  Document what happens if there is no tty.
  [[4929b5160]](https://git.sudo.ws/sudo/commit/?id=4929b5160)

* sudo.c:

  cosmetic changes
  [[0390504c3]](https://git.sudo.ws/sudo/commit/?id=0390504c3)

* term.c:

  Fix term\_restore
  [[2e8d722ae]](https://git.sudo.ws/sudo/commit/?id=2e8d722ae)

* sudo.c:

  Fix “sudo -k” with no other args
  [[710e72ecb]](https://git.sudo.ws/sudo/commit/?id=710e72ecb)

2009-02-24 Todd C. Miller

* check.c, sudo.c, sudo.pod, sudo\_usage.h.in:

  Allow the -k flag to be specified in conjunction with a command or
  another option that may require authentication.
  [[15975b83c]](https://git.sudo.ws/sudo/commit/?id=15975b83c)

2009-02-23 Todd C. Miller

* configure, configure.in:

  Remove unneeded AC\_CANONICAL\_TARGET; from Diego E. ‘Flameeyes’
  [[e7ee38d62]](https://git.sudo.ws/sudo/commit/?id=e7ee38d62)

* Makefile.in:

  Parallel make fix. From Diego E. ‘Flameeyes’
  [[c5513388e]](https://git.sudo.ws/sudo/commit/?id=c5513388e)

2009-02-21 Todd C. Miller

* def\_data.c, def\_data.h, def\_data.in, sudo.c, sudoers.pod:

  Implement umask\_override
  [[f96b0a743]](https://git.sudo.ws/sudo/commit/?id=f96b0a743)

* toke.c:

  regen
  [[030b39958]](https://git.sudo.ws/sudo/commit/?id=030b39958)

* sudoers.pod, toke.l, visudo.c:

  Implement %h escape in sudoers include filenames.
  [[0d7f77177]](https://git.sudo.ws/sudo/commit/?id=0d7f77177)

* audit.c:

  Need to include compat.h
  [[ceaa7a38c]](https://git.sudo.ws/sudo/commit/?id=ceaa7a38c)

* Makefile.in, audit.c, bsm\_audit.c, bsm\_audit.h, logging.h, sudo.c:

  Make audit\_success and audit\_failure generic functions in preparation
  for integrating linux audit support.
  [[6491696ca]](https://git.sudo.ws/sudo/commit/?id=6491696ca)

* term.c:

  remove duplicate include
  [[380c953e6]](https://git.sudo.ws/sudo/commit/?id=380c953e6)

2009-02-20 Todd C. Miller

* bsm\_audit.c:

  Add missing include
  [[c29881ef1]](https://git.sudo.ws/sudo/commit/?id=c29881ef1)

* sudo.c:

  May need to update the runas user after parsing command-based defaults.
  [[f4bc42d63]](https://git.sudo.ws/sudo/commit/?id=f4bc42d63)

2009-02-18 Todd C. Miller

* glob.c:

  Add missing pair of braces introduced with character class support.
  [[a9caa4380]](https://git.sudo.ws/sudo/commit/?id=a9caa4380)

2009-02-15 Todd C. Miller

* def\_data.c, def\_data.h, def\_data.in, sudoers.pod, tgetpass.c:

  Rename pwstars to pwfeedback
  [[dd56fbadb]](https://git.sudo.ws/sudo/commit/?id=dd56fbadb)

2009-02-11 Todd C. Miller

* bsm\_audit.c, bsm\_audit.h:

  Add const to make MacOS happy.
  [[d1bbb48f1]](https://git.sudo.ws/sudo/commit/?id=d1bbb48f1)

* Makefile.in, auth/sudo\_auth.c, bsm\_audit.c, bsm\_audit.h, configure,
  configure.in, sudo.c:

  Add bsm audit support from Christian S.J. Peron
  [[f492e5305]](https://git.sudo.ws/sudo/commit/?id=f492e5305)

* term.c:

  This is new code, no DARPA notice.
  [[bd05b56a8]](https://git.sudo.ws/sudo/commit/?id=bd05b56a8)

2009-02-10 Todd C. Miller

* def\_data.c, def\_data.h, def\_data.in, match.c, sudoers.pod:

  Rename simple\_glob -> fast\_glob
  [[108d53548]](https://git.sudo.ws/sudo/commit/?id=108d53548)

* match.c:

  g/c unused var
  [[cfb9ec7ba]](https://git.sudo.ws/sudo/commit/?id=cfb9ec7ba)

* def\_data.c, def\_data.h, def\_data.in, match.c, sudoers.pod:

  Add simple\_glob option to use fnmatch() instead of glob(). This is
  useful when you need to specify patterns that reference network file
  systems.
  [[7207b4cd6]](https://git.sudo.ws/sudo/commit/?id=7207b4cd6)

* tgetpass.c:

  add term\_\* proto
  [[5df16f86b]](https://git.sudo.ws/sudo/commit/?id=5df16f86b)

* sudoers.pod:

  mention glob()
  [[eec86958b]](https://git.sudo.ws/sudo/commit/?id=eec86958b)

2009-02-09 Todd C. Miller

* tgetpass.c:

  Delete any pwstars we wrote after the user hits return. That way there
  is no record on screen as to the user’s password length.
  [[e58df973a]](https://git.sudo.ws/sudo/commit/?id=e58df973a)

2009-02-08 Todd C. Miller

* term.c:

  Move terminal setting bits from tgetpass.c to term.c
  [[2c8e1a45e]](https://git.sudo.ws/sudo/commit/?id=2c8e1a45e)

* Makefile.in, def\_data.c, def\_data.h, def\_data.in, sudoers.pod,
  tgetpass.c:

  Add pwstars sudoers option that causes sudo to print a star every time
  the user presses a key.
  [[38c225af0]](https://git.sudo.ws/sudo/commit/?id=38c225af0)

2009-02-03 Todd C. Miller

* Makefile.in:

  Fix up F<> brokenness for visudo.man.in and sudoers.ldap.man.in.
  [[6d88a04a0]](https://git.sudo.ws/sudo/commit/?id=6d88a04a0)

2009-01-27 Todd C. Miller

* ldap.c:

  For ldap\_search\_ext\_s() the sizelimit param should be 0, not -1, to
  indicate no limit. From Mark Janssen.
  [[da769cd42]](https://git.sudo.ws/sudo/commit/?id=da769cd42)

2009-01-17 Todd C. Miller

* toke.c, toke.l:

  Comments that begin with #- should not be parsed as uids.
  [[2d4aebed6]](https://git.sudo.ws/sudo/commit/?id=2d4aebed6)

2009-01-09 Todd C. Miller

* sudo.c:

  Do not try to set the close on exec flag if we didn’t actually open
  sudoers.
  [[77794f27a]](https://git.sudo.ws/sudo/commit/?id=77794f27a)

2008-12-19 Todd C. Miller

* ChangeLog:

  regen
  [[930f3ac48]](https://git.sudo.ws/sudo/commit/?id=930f3ac48)

2008-12-14 Todd C. Miller

* TODO:

  sync
  [[36ba7133c]](https://git.sudo.ws/sudo/commit/?id=36ba7133c)

2008-12-09 Todd C. Miller

* auth/pam.c:

  Return PAM\_AUTH\_ERR instead of PAM\_CONV\_ERR if user enters ^C at the
  password prompt.
  [[743c62495]](https://git.sudo.ws/sudo/commit/?id=743c62495)

* configure, configure.in:

  Don’t try to build sudo\_noexec.so on HP-UX with the bundled compiler as
  it cannot generate shared objects.
  [[0bfb3394b]](https://git.sudo.ws/sudo/commit/?id=0bfb3394b)

* emul/charclass.h, glob.c, lbuf.c, tgetpass.c:

  K&R compilation fixes
  [[761066ab0]](https://git.sudo.ws/sudo/commit/?id=761066ab0)

* parse.c:

  Use tq\_foreach\_fwd when checking pseudo-commands to make it clear that
  we are not short-circuiting on last match. When pwcheck is ‘all’,
  initialize nopass to TRUE and override it with the first non-TRUE entry.
  [[a93344d2b]](https://git.sudo.ws/sudo/commit/?id=a93344d2b)

2008-12-08 Todd C. Miller

* parse.c:

  Do not short circuit pseudo commands when we get a match since,
  depending on the settings, we may need to examine all commands for tags.
  [[96f1ea470]](https://git.sudo.ws/sudo/commit/?id=96f1ea470)

2008-12-03 Todd C. Miller

* sudoers.cat, sudoers.man.in:

  regen
  [[d488f2a03]](https://git.sudo.ws/sudo/commit/?id=d488f2a03)

* sudoers.pod:

  hostnames may also contain wildcards
  [[3f92c8740]](https://git.sudo.ws/sudo/commit/?id=3f92c8740)

* Makefile.in:

  remove stamp-\* files and linux core files in clean target
  [[613b889ee]](https://git.sudo.ws/sudo/commit/?id=613b889ee)

2008-12-02 Todd C. Miller

* auth/sudo\_auth.h, config.h.in, configure, configure.in:

  Use HAVE\_SIA\_SES\_INIT instead of HAVE\_SIA for Digital UNIX
  [[02a894a09]](https://git.sudo.ws/sudo/commit/?id=02a894a09)

2008-11-26 Todd C. Miller

* configure, configure.in:

  correctly enable SIA on Digital UNIX
  [[2464ba1f5]](https://git.sudo.ws/sudo/commit/?id=2464ba1f5)

* TODO:

  checkpoint
  [[498e00374]](https://git.sudo.ws/sudo/commit/?id=498e00374)

* ChangeLog:

  sync
  [[bc1466519]](https://git.sudo.ws/sudo/commit/?id=bc1466519)

2008-11-25 Todd C. Miller

* check.c, sudo.h, tgetpass.c:

  Even if neither stdin nor stdout are ttys we may still have /dev/tty
  available to us.
  [[b18eede62]](https://git.sudo.ws/sudo/commit/?id=b18eede62)

2008-11-24 Todd C. Miller

* sudoers.cat, sudoers.man.in:

  regen
  [[30296d050]](https://git.sudo.ws/sudo/commit/?id=30296d050)

* sudoers.pod:

  fix typos; Markus Lude
  [[42771539e]](https://git.sudo.ws/sudo/commit/?id=42771539e)

* ChangeLog:

  sync
  [[de66ff1af]](https://git.sudo.ws/sudo/commit/?id=de66ff1af)

* toke.c:

  regen
  [[13968b685]](https://git.sudo.ws/sudo/commit/?id=13968b685)

* toke.l:

  Fix matching of a line that only consists of a comment char
  [[1c79dd537]](https://git.sudo.ws/sudo/commit/?id=1c79dd537)

2008-11-22 Todd C. Miller

* auth/pam.c:

  MacOS pam will retry conversation function if it fails so just treat ^C
  as an empty password.
  [[c3d3db62f]](https://git.sudo.ws/sudo/commit/?id=c3d3db62f)

* visudo.c:

  When checking for alias use, also check defaults bindings.
  [[c1a62bf88]](https://git.sudo.ws/sudo/commit/?id=c1a62bf88)

* redblack.c:

  unused var
  [[8811643f9]](https://git.sudo.ws/sudo/commit/?id=8811643f9)

* redblack.c:

  Replace my rbdelete with Emin’s version (which actually works ;-)
  [[b5a12039a]](https://git.sudo.ws/sudo/commit/?id=b5a12039a)

2008-11-19 Todd C. Miller

* testsudoers.c:

  malloc debugging
  [[1939859a2]](https://git.sudo.ws/sudo/commit/?id=1939859a2)

* visudo.c:

  malloc options in devel mode for visudo too
  [[4ed783719]](https://git.sudo.ws/sudo/commit/?id=4ed783719)

2008-11-18 Todd C. Miller

* sudo.c:

  fix compilation on non-C99; from Theo
  [[68baa6346]](https://git.sudo.ws/sudo/commit/?id=68baa6346)

* visudo.c:

  fix check\_aliases
  [[d27ceff8e]](https://git.sudo.ws/sudo/commit/?id=d27ceff8e)

* alias.c:

  when destroying an alias, free the correct data pointer
  [[ea81e0446]](https://git.sudo.ws/sudo/commit/?id=ea81e0446)

* auth/sudo\_auth.h:

  add proto for aixauth\_cleanup; from Dale King
  [[875b888da]](https://git.sudo.ws/sudo/commit/?id=875b888da)

2008-11-15 Todd C. Miller

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in, visudo.cat,
  visudo.man.in:

  regen
  [[d1a43dbe3]](https://git.sudo.ws/sudo/commit/?id=d1a43dbe3)

* sudo.pod, sudoers.pod, visudo.pod:

  standardize on the term ‘option’ for command line options (not flag)
  [[59302128d]](https://git.sudo.ws/sudo/commit/?id=59302128d)

2008-11-14 Todd C. Miller

* INSTALL:

  Add note on configuring HP-UX pam
  [[7af30b75e]](https://git.sudo.ws/sudo/commit/?id=7af30b75e)

2008-11-11 Todd C. Miller

* check.c, sudo.c:

  Move tty checks into check\_user() so we only do them if we actually need
  a password.
  [[3cc3114d9]](https://git.sudo.ws/sudo/commit/?id=3cc3114d9)

* sudo.c:

  Don’t error out if no tty or askpass unless we actually need to
  authenticate.
  [[8e480f4ae]](https://git.sudo.ws/sudo/commit/?id=8e480f4ae)

2008-11-10 Todd C. Miller

* ChangeLog:

  regen
  [[8141061bf]](https://git.sudo.ws/sudo/commit/?id=8141061bf)

* pathnames.h.in, sudo.c:

  s/overriden/overridden/; from Tobias Stoeckmann
  [[43c98580f]](https://git.sudo.ws/sudo/commit/?id=43c98580f)

2008-11-09 Todd C. Miller

* WHATSNEW, visudo.c:

  check sudoers owner and mode in strict mode
  [[235dc7ad0]](https://git.sudo.ws/sudo/commit/?id=235dc7ad0)

* gram.c, toke.c:

  regen
  [[a33e988df]](https://git.sudo.ws/sudo/commit/?id=a33e988df)

* sudo.man.in, sudoers.man.in, visudo.man.in:

  Update copyright years.
  [[5f934f10f]](https://git.sudo.ws/sudo/commit/?id=5f934f10f)

* LICENSE, alias.c, alloc.c, auth/afs.c, auth/aix\_auth.c, auth/bsdauth.c,
  auth/fwtk.c, auth/kerb4.c, auth/kerb5.c, auth/pam.c, auth/securid.c,
  auth/securid5.c, auth/sia.c, auth/sudo\_auth.h, closefrom.c, compat.h,
  defaults.c, defaults.h, env.c, fileops.c, gettime.c, gram.y,
  ins\_csops.h, insults.h, interfaces.c, interfaces.h, lbuf.c, license.pod,
  list.c, logging.c, logging.h, parse.c, parse.h, pwutil.c, redblack.c,
  redblack.h, snprintf.c, sudo.c, sudo.pod, sudo\_edit.c, sudo\_nss.h,
  sudoers.pod, testsudoers.c, toke.l, tsgetgrpw.c, utimes.c, version.h,
  visudo.c, visudo.pod, zero\_bytes.c:

  Update copyright years.
  [[840acbd3a]](https://git.sudo.ws/sudo/commit/?id=840acbd3a)

* emul/charclass.h, fnmatch.c, glob.c:

  add my copyright
  [[4baa2f90c]](https://git.sudo.ws/sudo/commit/?id=4baa2f90c)

2008-11-08 Todd C. Miller

* toke.c, toke.l:

  The loop in fill\_cmnd() was going one byte too far past the end,
  resulting in a NUL being written immediately after the buffer end.
  [[b0c1c7979]](https://git.sudo.ws/sudo/commit/?id=b0c1c7979)

* UPGRADE, WHATSNEW:

  add sections on tgetpass changes
  [[b8742114c]](https://git.sudo.ws/sudo/commit/?id=b8742114c)

* tgetpass.c:

  Treat EOF w/o newline as an error.
  [[80ca3a972]](https://git.sudo.ws/sudo/commit/?id=80ca3a972)

2008-11-07 Todd C. Miller

* parse.c:

  Fix “sudo -v” when NOPASSWD is set.
  [[54a07b5e8]](https://git.sudo.ws/sudo/commit/?id=54a07b5e8)

* auth/bsdauth.c, auth/fwtk.c, auth/pam.c, auth/sudo\_auth.c,
  auth/sudo\_auth.h:

  No longer treat an empty password at the prompt as special. To quit out
  of sudo you now need to hit ^C at the password prompt.
  [[ff175f7f0]](https://git.sudo.ws/sudo/commit/?id=ff175f7f0)

* sudoers.cat, sudoers.man.in:

  regen
  [[213eaef4c]](https://git.sudo.ws/sudo/commit/?id=213eaef4c)

* def\_data.c, def\_data.h, def\_data.in, sudo.c, sudoers.pod:

  Sudo will now refuse to run if no tty is present unless the new
  visiblepw sudoers flag is set.
  [[535ed3817]](https://git.sudo.ws/sudo/commit/?id=535ed3817)

2008-11-06 Todd C. Miller

* aix.c:

  just use RLIM\_INFINITY for RLIM\_SAVED\_MAX if RLIM\_SAVED\_MAX not defined
  [[5c4840365]](https://git.sudo.ws/sudo/commit/?id=5c4840365)

* aix.c:

  fix fallback value for RLIM\_SAVED\_MAX
  [[c60c4c71c]](https://git.sudo.ws/sudo/commit/?id=c60c4c71c)

* auth/aix\_auth.c, auth/sudo\_auth.h:

  Move clearing of AUTHSTATE into aixauth\_cleanup.
  [[51fae2c9c]](https://git.sudo.ws/sudo/commit/?id=51fae2c9c)

* auth/aix\_auth.c, env.c:

  Unset AUTHSTATE after calling authenticate() as it may not be correct
  for the user we are running the command as.
  [[50d897475]](https://git.sudo.ws/sudo/commit/?id=50d897475)

* isblank.c:

  Add isblank() function for systems without it. Needed for POSIX
  character class matching in fnmatch.c and glob.c.
  [[8654dec3c]](https://git.sudo.ws/sudo/commit/?id=8654dec3c)

2008-11-05 Todd C. Miller

* TROUBLESHOOTING:

  expound on sudo and cd
  [[b909652ad]](https://git.sudo.ws/sudo/commit/?id=b909652ad)

2008-11-04 Todd C. Miller

* ChangeLog:

  regen
  [[e94d951ac]](https://git.sudo.ws/sudo/commit/?id=e94d951ac)

* sudoers.cat, sudoers.man.in:

  regen
  [[fd4065a83]](https://git.sudo.ws/sudo/commit/?id=fd4065a83)

* sudoers.pod:

  mention defauts parse order
  [[e2fb6dbb0]](https://git.sudo.ws/sudo/commit/?id=e2fb6dbb0)

2008-11-03 Todd C. Miller

* Makefile.in, aclocal.m4, compat.h, configure:

  Add isblank() function for systems without it. Needed for POSIX
  character class matching in fnmatch.c and glob.c.
  [[48329f0e4]](https://git.sudo.ws/sudo/commit/?id=48329f0e4)

* Makefile.in:

  add emul/charclass.h to HDRS
  [[49611b132]](https://git.sudo.ws/sudo/commit/?id=49611b132)

2008-11-02 Todd C. Miller

* TODO:

  checkpoint
  [[ffb9f65b2]](https://git.sudo.ws/sudo/commit/?id=ffb9f65b2)

* defaults.c, parse.c, testsudoers.c, visudo.c:

  Move update\_defaults into defaults.c and call it properly from visudo
  and testsudoers.
  [[f201db90f]](https://git.sudo.ws/sudo/commit/?id=f201db90f)

* defaults.c, interfaces.c, pwutil.c, sudo.c, sudo\_edit.c, tgetpass.c,
  tsgetgrpw.c:

  use zero\_bytes() instead of memset() for consistency
  [[3cb9d538f]](https://git.sudo.ws/sudo/commit/?id=3cb9d538f)

* logging.c, mon\_systrace.c, parse.c, sudo.c, sudo\_edit.c, tgetpass.c,
  visudo.c:

  Zero out sigaction\_t before use in case it has non-standard entries.
  [[4afceb8e9]](https://git.sudo.ws/sudo/commit/?id=4afceb8e9)

* match.c:

  quiet gcc
  [[1cc431c42]](https://git.sudo.ws/sudo/commit/?id=1cc431c42)

* match.c:

  Short circuit glob() checks if basename(pattern) != basename(command).
  Refactor code that checks for a command in a directory and use it in the
  glob case if the resolved pattern ends in a ‘/’.
  [[4c7a96ba1]](https://git.sudo.ws/sudo/commit/?id=4c7a96ba1)

2008-11-01 Todd C. Miller

* defaults.h, parse.c, sudo.c, testsudoers.c, visudo.c:

  Defer setting runas defaults until after runaspw/gr is setup.
  [[8ba6fa2ae]](https://git.sudo.ws/sudo/commit/?id=8ba6fa2ae)

2008-10-29 Todd C. Miller

* match.c, sudo.c, testsudoers.c:

  Use MAXHOSTNAMELEN+1 when allocating host/domain name since some systems
  do not include space for the NUL in the size. Also manually
  NUL-terminate buffer from gethostname() since POSIX is wishy-washy on
  this.
  [[efb510a9d]](https://git.sudo.ws/sudo/commit/?id=efb510a9d)

2008-10-26 Todd C. Miller

* sudo.c, sudoers.pod:

  When setting the umask, use the union of the user’s umask and the
  default value set in sudoers so that we never lower the user’s umask
  when running a command.
  [[9b5e94cef]](https://git.sudo.ws/sudo/commit/?id=9b5e94cef)

* sudo.c:

  Don’t try to read from a zero-length sudoers file. Remove the bogus
  Solaris work-around for EAGAIN. Since we now use fgetc() it should not
  be a problem.
  [[aa54053ad]](https://git.sudo.ws/sudo/commit/?id=aa54053ad)

2008-10-25 Todd C. Miller

* parse.c:

  In update\_defaults() check the return value of user\*\_matches against
  ALLOW so we don’t inadvertantly match on UNSPEC.
  [[ab32ede12]](https://git.sudo.ws/sudo/commit/?id=ab32ede12)

2008-10-24 Todd C. Miller

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.ldap.cat,
  sudoers.ldap.man.in, sudoers.man.in, visudo.cat, visudo.man.in:

  regen man pages; no more hyphenation
  [[b3349ed6b]](https://git.sudo.ws/sudo/commit/?id=b3349ed6b)

* sudo.c:

  Don’t error out on a zero-length sudoers file. With the advent of
  #include the user could create a situation where sudo is unusable.
  [[18e764403]](https://git.sudo.ws/sudo/commit/?id=18e764403)

2008-10-23 Todd C. Miller

* auth/kerb5.c, config.h.in, configure, configure.in:

  Newer heimdal has 2-argument krb5\_get\_init\_creds\_opt\_free() like MIT
  krb5. Really old heimdal has no krb5\_get\_init\_creds\_opt\_alloc() at all.
  Add configure tests to handle all the cases.
  [[13e2ccea6]](https://git.sudo.ws/sudo/commit/?id=13e2ccea6)

2008-10-08 Todd C. Miller

* sudo.pod:

  resort ENVIRONMENT
  [[cf9fa33eb]](https://git.sudo.ws/sudo/commit/?id=cf9fa33eb)

* sudoers.pod:

  document sudoers\_locale
  [[ce67f2249]](https://git.sudo.ws/sudo/commit/?id=ce67f2249)

* sudo.pod, sudo\_edit.c:

  add SUDO\_EDITOR variable that sudoedit uses in preference to VISUAL or
  EDITOR
  [[7bb516039]](https://git.sudo.ws/sudo/commit/?id=7bb516039)

* toke.c, toke.l:

  In fill\_cmnd(), collapse any escaped sudo-specific characters. Allows
  character classes to be used in pathnames.
  [[240339c05]](https://git.sudo.ws/sudo/commit/?id=240339c05)

2008-10-03 Todd C. Miller

* lbuf.c:

  fix typo in non-C89 function declaration
  [[55ed6f2c1]](https://git.sudo.ws/sudo/commit/?id=55ed6f2c1)

* sudoers.pod:

  Mention POSIX characters classes now that out fnmatch() and glob()
  support them.
  [[22103775c]](https://git.sudo.ws/sudo/commit/?id=22103775c)

* sample.sudoers, sudoers.pod:

  Replace [A-z] (which won’t match in UTF8) with [A-Za-z] which is locale
  agnostic.
  [[5446cd3ae]](https://git.sudo.ws/sudo/commit/?id=5446cd3ae)

* parse.h:

  use \_\_signed char if we are going to assign a negative value since on
  Power, char is unsigned by default
  [[a71667af5]](https://git.sudo.ws/sudo/commit/?id=a71667af5)

* config.h.in, configure, configure.in:

  Add tests for \_\_signed char and signed char.
  [[99cdf6dc8]](https://git.sudo.ws/sudo/commit/?id=99cdf6dc8)

* aix.c:

  Fix AIX limit setting. getuserattr() returns values in disk blocks
  rather than bytes. The default hard stack size in newer AIX is
  RLIM\_SAVED\_MAX. From Dale King.
  [[ad4dd3b22]](https://git.sudo.ws/sudo/commit/?id=ad4dd3b22)

2008-09-26 Todd C. Miller

* emul/charclass.h, fnmatch.c, glob.c:

  Add character class support to included glob(3) and fnmatch(3).
  [[0372d7dc2]](https://git.sudo.ws/sudo/commit/?id=0372d7dc2)

2008-09-16 Todd C. Miller

* emul/fnmatch.h:

  Remove UCB advertising clause and some compatibility defines.
  [[8c1e64b7d]](https://git.sudo.ws/sudo/commit/?id=8c1e64b7d)

2008-09-14 Todd C. Miller

* sudo\_edit.c:

  Check EDITOR/VISUAL to make sure sudoedit is not re-invoking itself or
  sudo. This allows one to set EDITOR to sudoedit without getting into an
  infinite loop of sudoedit running itself until the path gets too big.
  [[8fa4ef591]](https://git.sudo.ws/sudo/commit/?id=8fa4ef591)

* def\_data.c, def\_data.h, def\_data.in, defaults.c, sudo.c:

  Add sudoers\_locale Defaults option to override the default sudoers
  locale of “C”.
  [[b02daa827]](https://git.sudo.ws/sudo/commit/?id=b02daa827)

2008-09-13 Todd C. Miller

* sudo.c:

  Set locale to system default except for during sudoers parse.
  [[508295b1f]](https://git.sudo.ws/sudo/commit/?id=508295b1f)

2008-09-12 Todd C. Miller

* match.c:

  Redo change in 1.34 to use pointer arithmetic.
  [[65bce6555]](https://git.sudo.ws/sudo/commit/?id=65bce6555)

2008-09-11 Todd C. Miller

* match.c:

  Fix a dereference (read) of a freed pointer. Reported by Patrick
  Williams.
  [[d0a44e437]](https://git.sudo.ws/sudo/commit/?id=d0a44e437)

2008-08-23 Todd C. Miller

* sudo.c:

  Set locale to “C” to avoid interpretation issues with character ranges
  in sudoers. May want to make the locale a sudoers option in the future.
  [[a5245c235]](https://git.sudo.ws/sudo/commit/?id=a5245c235)

2008-08-20 Todd C. Miller

* config.h.in:

  we no longer use setproctitle
  [[194d57b96]](https://git.sudo.ws/sudo/commit/?id=194d57b96)

* sudo.h:

  remove #if 1
  [[1954d6811]](https://git.sudo.ws/sudo/commit/?id=1954d6811)

* LICENSE, mkstemp.c:

  Use my replacement mkstemp() from the mktemp package.
  [[da6ffd067]](https://git.sudo.ws/sudo/commit/?id=da6ffd067)

2008-07-12 Todd C. Miller

* gram.c:

  regen with yacc skeleton bug fixed
  [[ed3cc2b33]](https://git.sudo.ws/sudo/commit/?id=ed3cc2b33)

* sudoers.pod:

  Remove duplicate “as root”. From Martin Toft.
  [[8f38cfbe9]](https://git.sudo.ws/sudo/commit/?id=8f38cfbe9)

2008-07-02 Todd C. Miller

* pwutil.c, sudo.c, sudo.h, testsudoers.c:

  Flesh out the fake passwd entry used for running commands as a uid not
  listed in the passwd database. Fixes an issue with some PAM modules.
  [[e439faeeb]](https://git.sudo.ws/sudo/commit/?id=e439faeeb)

2008-07-01 Todd C. Miller

* sudo.c:

  Error out in -i mode if the user has no shell. This can happen when
  running commands as a uid with no password entry.
  [[0cf7172b1]](https://git.sudo.ws/sudo/commit/?id=0cf7172b1)

2008-06-26 Todd C. Miller

* toke.c, toke.l:

  Better fix for line continuation inside double quotes. Now accepts
  whitespace between the backslash and the newline like the main lexer.
  [[3bf94ded8]](https://git.sudo.ws/sudo/commit/?id=3bf94ded8)

2008-06-25 Todd C. Miller

* toke.c, toke.l:

  Fix line continuation in strings. It was only being honored if preceded
  by whitespace.
  [[bd8e38a0c]](https://git.sudo.ws/sudo/commit/?id=bd8e38a0c)

2008-06-22 Todd C. Miller

* config.h.in, configure, configure.in, logging.c:

  Replace the double fork with a fork + daemonize.
  [[ca6eddf0d]](https://git.sudo.ws/sudo/commit/?id=ca6eddf0d)

2008-06-21 Todd C. Miller

* env.c, sudo.c:

  The -i flag should imply env\_reset. This got broken in sudo 1.6.9.
  [[4578548c4]](https://git.sudo.ws/sudo/commit/?id=4578548c4)

* logging.c, sudo.c, sudo\_edit.c, visudo.c:

  Change how the mailer is waited for. Instead of having a SIGCHLD
  handler, use the double fork trick to orphan the child that opens the
  pipe to sendmail. Fixes a problem running su on some Linux distros.
  [[5756ddfbe]](https://git.sudo.ws/sudo/commit/?id=5756ddfbe)

2008-06-20 Todd C. Miller

* configure, configure.in:

  Fix configure test for dirfd() on Linux where DIR is opaque.
  [[c372928c3]](https://git.sudo.ws/sudo/commit/?id=c372928c3)

2008-06-17 Todd C. Miller

* tgetpass.c:

  Get rid of the QNX TCSAFLUSH -> TCSADRAIN hack. If QNX still has this
  problem we’ll need to revisit this again.
  [[e37c901cd]](https://git.sudo.ws/sudo/commit/?id=e37c901cd)

2008-06-11 Todd C. Miller

* logging.c:

  Ignore SIGPIPE instead of blocking it when piping to the mailer. If we
  only block the signal it may be delivered later when we unblock. Also,
  there is no need to block SIGCHLD since we no longer do the double fork.
  The normal SIGCHLD handler is sufficient.
  [[552eca0d0]](https://git.sudo.ws/sudo/commit/?id=552eca0d0)

2008-06-08 Todd C. Miller

* configure, configure.in:

  Add description for NO\_PAM\_SESSION, from a redhat patch.
  [[cfb45078b]](https://git.sudo.ws/sudo/commit/?id=cfb45078b)

2008-06-06 Todd C. Miller

* sudo.cat, sudo.man.in, sudo.pod:

  Fix typos in -i usage
  [[06a4e1402]](https://git.sudo.ws/sudo/commit/?id=06a4e1402)

2008-05-18 Todd C. Miller

* configure, configure.in:

  Redo the test for dgettext() in a way that hopefully will work around
  the libintl\_dgettext() undefined problem.
  [[e2cbaa50a]](https://git.sudo.ws/sudo/commit/?id=e2cbaa50a)

2008-05-11 Todd C. Miller

* schema.ActiveDirectory:

  change filename in comment
  [[2aadaaded]](https://git.sudo.ws/sudo/commit/?id=2aadaaded)

2008-05-10 Todd C. Miller

* Makefile.in, README.LDAP, sudoers.ldap.cat, sudoers.ldap.man.in,
  sudoers.ldap.pod:

  Reference schema.ActiveDirectory
  [[64c5738ec]](https://git.sudo.ws/sudo/commit/?id=64c5738ec)

2008-05-09 Todd C. Miller

* schema.OpenLDAP, schema.iPlanet:

  Mark sudoRunAs as deprecated.
  [[1da320979]](https://git.sudo.ws/sudo/commit/?id=1da320979)

* schema.ActiveDirectory:

  add sudoRunAsUser and sudoRunAsGroup
  [[236fd128d]](https://git.sudo.ws/sudo/commit/?id=236fd128d)

* schema.ActiveDirectory:

  Active Directory schema by Chantal Paradis and Eric Paquet
  [[2860716ba]](https://git.sudo.ws/sudo/commit/?id=2860716ba)

2008-05-08 Todd C. Miller

* parse.c:

  remove an XXX that was fixed
  [[f0db3ecfb]](https://git.sudo.ws/sudo/commit/?id=f0db3ecfb)

* ChangeLog:

  sync
  [[fbc4aea0e]](https://git.sudo.ws/sudo/commit/?id=fbc4aea0e)

* parse.c:

  Initialize tags to UNSPEC instead of def\_\* in “sudo -l” mode. This fixes
  a problem where the tag value printed was influenced by defaults set in
  the first pass through the parser.
  [[88b932722]](https://git.sudo.ws/sudo/commit/?id=88b932722)

2008-05-04 Todd C. Miller

* Makefile.in, sudo.psf:

  No point in packaging the TODO file
  [[5c58a7e96]](https://git.sudo.ws/sudo/commit/?id=5c58a7e96)

* ChangeLog:

  sync
  [[d529c35bf]](https://git.sudo.ws/sudo/commit/?id=d529c35bf)

2008-05-03 Todd C. Miller

* WHATSNEW, def\_data.c, def\_data.h, def\_data.in, env.c, sudo.c, sudo.h,
  sudoers.cat, sudoers.man.in, sudoers.pod:

  Add env\_file Defaults option that is similar to /etc/environment on some
  systems.
  [[b85a28aba]](https://git.sudo.ws/sudo/commit/?id=b85a28aba)

2008-05-02 Todd C. Miller

* Makefile.in, README, TODO, WHATSNEW, sudo.cat, sudo.man.in, sudoers.cat,
  sudoers.ldap.cat, sudoers.ldap.man.in, sudoers.man.in, version.h,
  visudo.cat, visudo.man.in:

  change version to 1.7.0
  [[c3470aa58]](https://git.sudo.ws/sudo/commit/?id=c3470aa58)

* UPGRADE:

  initial valgrind pass done
  [[bfc826872]](https://git.sudo.ws/sudo/commit/?id=bfc826872)

2008-04-23 Todd C. Miller

* ldap.c:

  Fix typo/think in sudo\_ldap\_read\_secret() when storing the secret.
  [[25aa1b5bf]](https://git.sudo.ws/sudo/commit/?id=25aa1b5bf)

2008-04-11 Todd C. Miller

* ldap.c:

  define LDAPS\_PORT if the system headers do not
  [[3fa2f3292]](https://git.sudo.ws/sudo/commit/?id=3fa2f3292)

2008-04-10 Todd C. Miller

* gram.c, gram.y:

  Fix another memory leak in init\_parser().
  [[a890d723d]](https://git.sudo.ws/sudo/commit/?id=a890d723d)

* configure, configure.in:

  There was a missing space before the ldap libs in SUDO\_LIBS for some
  configurations.
  [[f0a6827fe]](https://git.sudo.ws/sudo/commit/?id=f0a6827fe)

* alias.c, gram.c, gram.y, toke.c, toke.l:

  Clean up some memory leaks pointed out by valgrind.
  [[b06e2f9d6]](https://git.sudo.ws/sudo/commit/?id=b06e2f9d6)

2008-04-07 Todd C. Miller

* sudo.c:

  fix “sudo -s” broken by mode/flags breakout
  [[cb8bc538d]](https://git.sudo.ws/sudo/commit/?id=cb8bc538d)

* configure, configure.in:

  remove duplicate check for dgettext
  [[7fe25e284]](https://git.sudo.ws/sudo/commit/?id=7fe25e284)

2008-04-05 Todd C. Miller

* aix.c:

  Fall back to default stanza if no user-specific limit is found.
  [[7ddbc66eb]](https://git.sudo.ws/sudo/commit/?id=7ddbc66eb)

2008-04-02 Todd C. Miller

* snprintf.c:

  include stdint.h if present
  [[00d499348]](https://git.sudo.ws/sudo/commit/?id=00d499348)

* snprintf.c:

  Use LLONG\_MAX, not the old QUAD\_MAX
  [[66d388c3d]](https://git.sudo.ws/sudo/commit/?id=66d388c3d)

2008-04-01 Todd C. Miller

* sudoers.ldap.pod:

  fix cut and pasto
  [[0715e45e7]](https://git.sudo.ws/sudo/commit/?id=0715e45e7)

2008-03-31 Todd C. Miller

* pwutil.c:

  Add #ifdef PURITY
  [[82ba4c72e]](https://git.sudo.ws/sudo/commit/?id=82ba4c72e)

2008-03-30 Todd C. Miller

* auth/bsdauth.c:

  remove useless cast
  [[d43f00c18]](https://git.sudo.ws/sudo/commit/?id=d43f00c18)

2008-03-27 Todd C. Miller

* ChangeLog:

  sync
  [[a19527614]](https://git.sudo.ws/sudo/commit/?id=a19527614)

* TODO:

  sync
  [[27fa3e97d]](https://git.sudo.ws/sudo/commit/?id=27fa3e97d)

* sudo.h:

  Split MODE\_\* defines into primary and flags.
  [[6ca2fd6b5]](https://git.sudo.ws/sudo/commit/?id=6ca2fd6b5)

2008-03-26 Todd C. Miller

* aix.c:

  It turns out the logic for getting AIX limits is more convoluted than I
  realized and differs depending on whether the soft and/or hard limits
  are defined.
  [[d7b4d7bc2]](https://git.sudo.ws/sudo/commit/?id=d7b4d7bc2)

2008-03-23 Todd C. Miller

* Makefile.in, configure, configure.in:

  Back out AIX-specific change to set the sudo\_noexec path to the .a file,
  we do really want to use the .so file. Since libtool doesn’t do that
  correctly, just install the .so file ourselves in the Makefile.
  [[241d0750f]](https://git.sudo.ws/sudo/commit/?id=241d0750f)

* install-sh:

  If the file given to install is a path, only use the basename of the
  file when building the destination path.
  [[1efe9a900]](https://git.sudo.ws/sudo/commit/?id=1efe9a900)

2008-03-18 Todd C. Miller

* sudo.c:

  parse\_args() cleanup: Sort command line options in the getopt() switch
  The -U option requires a parameter Normalize a few ISSET calls Split
  mode into mode and flags and retire the now-obsolete excl variable
  [[938f79172]](https://git.sudo.ws/sudo/commit/?id=938f79172)

* WHATSNEW, check.c, sudo.c, sudo.cat, sudo.h, sudo.man.in, sudo.pod,
  sudo\_usage.h.in:

  Add -n (non-interactive) flag.
  [[c352187cf]](https://git.sudo.ws/sudo/commit/?id=c352187cf)

* sudo.c:

  Move version printing, etc. into a separate function.
  [[f2c84d5a6]](https://git.sudo.ws/sudo/commit/?id=f2c84d5a6)

* sudo.c:

  Don’t try to cleanup nsswitch if it has not been initialized.
  [[4b46531e4]](https://git.sudo.ws/sudo/commit/?id=4b46531e4)

2008-03-17 Todd C. Miller

* logging.c:

  Block SIGPIPE in send\_mail() so sudo is not killed by a problem
  executing the mailer.
  [[b7b807e10]](https://git.sudo.ws/sudo/commit/?id=b7b807e10)

2008-03-14 Todd C. Miller

* configure, configure.in:

  AIX shared libs end in .a, not .so.
  [[52710ce51]](https://git.sudo.ws/sudo/commit/?id=52710ce51)

2008-03-13 Todd C. Miller

* env.c:

  Preserve HOME by default too. Matches documentation and previous
  behavior.
  [[daba1995f]](https://git.sudo.ws/sudo/commit/?id=daba1995f)

2008-03-12 Todd C. Miller

* sudo.c:

  Use getopt() to parse the command line. We need to be able to
  intersperse env variables and options yet still honor “–”” which
  complicates things slightly.
  [[d11cb3d14]](https://git.sudo.ws/sudo/commit/?id=d11cb3d14)

2008-03-06 Todd C. Miller

* ChangeLog:

  sync
  [[299fe04af]](https://git.sudo.ws/sudo/commit/?id=299fe04af)

* acsite.m4, configure, ltmain.sh:

  update to libtool-1.5.26
  [[229a79b6b]](https://git.sudo.ws/sudo/commit/?id=229a79b6b)

* config.guess, config.sub:

  update from libtool-1.5.26 distribution
  [[af2555357]](https://git.sudo.ws/sudo/commit/?id=af2555357)

* aix.c, sudo.h:

  attempt to fix compilation errors on AIX
  [[59c1ac153]](https://git.sudo.ws/sudo/commit/?id=59c1ac153)

* Makefile.in:

  fix typo in last commit
  [[d2a05f214]](https://git.sudo.ws/sudo/commit/?id=d2a05f214)

* Makefile.in:

  Add WHATSNEW file to the distribution
  [[094c79a20]](https://git.sudo.ws/sudo/commit/?id=094c79a20)

* visudo.c:

  use warningx instead of fprintf(stderr, …)
  [[459013247]](https://git.sudo.ws/sudo/commit/?id=459013247)

* list.c:

  add DEBUG to list2tq
  [[3fbd32170]](https://git.sudo.ws/sudo/commit/?id=3fbd32170)

* ChangeLog, TODO:

  sync
  [[e87d5f845]](https://git.sudo.ws/sudo/commit/?id=e87d5f845)

* WHATSNEW:

  mention mailfrom
  [[06053753d]](https://git.sudo.ws/sudo/commit/?id=06053753d)

* Makefile.in, aix.c, config.h.in, configure, configure.in, set\_perms.c,
  sudo.h:

  Add aix\_setlimits() to set resource limits on AIX using a combination of
  getuserattr() and setrlimit(). Currently untested.
  [[897239afe]](https://git.sudo.ws/sudo/commit/?id=897239afe)

2008-03-05 Todd C. Miller

* def\_data.c, def\_data.h, def\_data.in, logging.c, sudoers.cat,
  sudoers.man.in, sudoers.pod:

  Add mailfrom Defaults option that sets the value of the From: field in
  the warning/error mail. If unset the login name of the invoking user is
  used.
  [[0f9e7f96f]](https://git.sudo.ws/sudo/commit/?id=0f9e7f96f)

* defaults.c:

  store a copy of \_PATH\_SUDO\_ASKPASS in def\_askpass that is freeable
  [[2314fd903]](https://git.sudo.ws/sudo/commit/?id=2314fd903)

* gram.c, gram.y:

  When adding a default, only call list2tq() once to do the list to tq
  conversion. It is not legal to call list2tq multiple times on the same
  list since list2tq consumes and modifies the list argument.
  [[cb1a3be9d]](https://git.sudo.ws/sudo/commit/?id=cb1a3be9d)

* sudoers.ldap.cat, sudoers.ldap.man.in, sudoers.ldap.pod:

  comment out XXXs for now
  [[c880b55b8]](https://git.sudo.ws/sudo/commit/?id=c880b55b8)

* WHATSNEW:

  mention askpass
  [[9c1b476df]](https://git.sudo.ws/sudo/commit/?id=9c1b476df)

2008-03-04 Todd C. Miller

* sudo.c:

  Error out if both -A and -S are specified Error out if -A is specified
  but no askpass is configured
  [[0c6a760fc]](https://git.sudo.ws/sudo/commit/?id=0c6a760fc)

* configure, configure.in:

  we are not going to ship a sudo-specific askpass
  [[64d226e1d]](https://git.sudo.ws/sudo/commit/?id=64d226e1d)

2008-03-03 Todd C. Miller

* sudo.h:

  fix definition of TGP\_ASKPASS
  [[5d86a9d6f]](https://git.sudo.ws/sudo/commit/?id=5d86a9d6f)

* def\_data.c, def\_data.in:

  make askpass boolean-capable
  [[cbf038c61]](https://git.sudo.ws/sudo/commit/?id=cbf038c61)

* INSTALL:

  document –with-askpass
  [[9a6917851]](https://git.sudo.ws/sudo/commit/?id=9a6917851)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.ldap.cat, sudoers.man.in,
  visudo.cat:

  regen
  [[c0773d037]](https://git.sudo.ws/sudo/commit/?id=c0773d037)

2008-03-02 Todd C. Miller

* sudo.pod, sudo\_usage.h.in, sudoers.pod:

  document -A and askpass
  [[143691e6d]](https://git.sudo.ws/sudo/commit/?id=143691e6d)

* auth/sudo\_auth.c, check.c, configure, configure.in, def\_data.c,
  def\_data.h, def\_data.in, defaults.c, pathnames.h.in, sudo.c, sudo.h,
  sudo\_usage.h.in, tgetpass.c:

  Add support for running a helper program to read the password when no
  tty is present (or when specified with the -A flag). TODO: docs.
  [[ee0491416]](https://git.sudo.ws/sudo/commit/?id=ee0491416)

* def\_data.c, def\_data.in:

  add missing printf format to SELinux role and type strings
  [[5b248a076]](https://git.sudo.ws/sudo/commit/?id=5b248a076)

2008-02-27 Todd C. Miller

* INSTALL, configure, configure.in:

  Disable use of gss\_krb5\_ccache\_name() by default and add
  –enable-gss-krb5-ccache-name configure option to enable it. It seems
  that gss\_krb5\_ccache\_name() doesn’t work properly with some combinations
  of Heimdal and OpenLDAP.
  [[f20935284]](https://git.sudo.ws/sudo/commit/?id=f20935284)

2008-02-22 Todd C. Miller

* selinux.c:

  Ignore setexeccon() failing in permissive mode. Also add a call to
  setkeycreatecon() (though this is probably insufficient). From Dan
  Walsh.
  [[9c3a47892]](https://git.sudo.ws/sudo/commit/?id=9c3a47892)

* auth/pam.c:

  Only set std\_prompt for the PAM\_PROMPT\_\* cases. The conversation
  function may be called for non-password reading purposes so we must be
  careful not to use def\_prompt in cases where it may not be set.
  [[48eee67e5]](https://git.sudo.ws/sudo/commit/?id=48eee67e5)

2008-02-20 Todd C. Miller

* selinux.c:

  Don’t free the new tty context, we need to keep it around when we
  restore the tty context after the command completes
  [[1a347284e]](https://git.sudo.ws/sudo/commit/?id=1a347284e)

2008-02-19 Todd C. Miller

* selinux.c:

  s/newrole/sudo/
  [[361280501]](https://git.sudo.ws/sudo/commit/?id=361280501)

* sudo.man.pl, sudo.pod:

  Only put login\_cap(3) in SEE ALSO section if we have login.conf support
  [[c2378eb4d]](https://git.sudo.ws/sudo/commit/?id=c2378eb4d)

2008-02-18 Todd C. Miller

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.ldap.cat,
  sudoers.ldap.man.in, sudoers.man.in, visudo.cat, visudo.man.in:

  regen
  [[795a303ea]](https://git.sudo.ws/sudo/commit/?id=795a303ea)

* sudoers.pod:

  Substitute in comment characters for lines partaining to login.conf, BSD
  auth and SELinux and only enable them if pertinent.
  [[b07217919]](https://git.sudo.ws/sudo/commit/?id=b07217919)

* sudoers.man.pl:

  Substitute in comment characters for lines partaining to login.conf, BSD
  auth and SELinux and only enable them if pertinent.
  [[2b4e67ff8]](https://git.sudo.ws/sudo/commit/?id=2b4e67ff8)

* sudo.pod:

  Substitute in comment characters for lines partaining to login.conf, BSD
  auth and SELinux and only enable them if pertinent.
  [[ef16f80a3]](https://git.sudo.ws/sudo/commit/?id=ef16f80a3)

* sudo.man.pl:

  Substitute in comment characters for lines partaining to login.conf, BSD
  auth and SELinux and only enable them if pertinent.
  [[a228c7209]](https://git.sudo.ws/sudo/commit/?id=a228c7209)

* Makefile.in, configure, configure.in:

  Substitute in comment characters for lines partaining to login.conf, BSD
  auth and SELinux and only enable them if pertinent.
  [[cf6bca4b0]](https://git.sudo.ws/sudo/commit/?id=cf6bca4b0)

* Makefile.in, sudo.pod, sudoers.ldap.pod, sudoers.pod, visudo.pod:

  Remove the =cut on the first line (above the copyright notice) to quiet
  pod2man. Also remove the hackery in the FILES section and just deal with
  the fact that there will a newline between each pathname.
  [[7a1e2dfb5]](https://git.sudo.ws/sudo/commit/?id=7a1e2dfb5)

2008-02-17 Todd C. Miller

* Makefile.in:

  run sudo.man.pl when generating sudo.man.in
  [[07daaa390]](https://git.sudo.ws/sudo/commit/?id=07daaa390)

* configure, configure.in, sudo.man.pl:

  comment out SELinux manual bits unless –with-selinux was specified
  [[279ee07ee]](https://git.sudo.ws/sudo/commit/?id=279ee07ee)

* sudoers.pod:

  document role and type defaults for SELinux
  [[229b23146]](https://git.sudo.ws/sudo/commit/?id=229b23146)

* sudo.c, sudo.cat, sudo.man.in, sudo.pod, sudo\_usage.h.in:

  Document “sudo -ll” and make “sudo -l -l” be equivalent.
  [[211be00cc]](https://git.sudo.ws/sudo/commit/?id=211be00cc)

2008-02-15 Todd C. Miller

* configure, configure.in:

  Treat k*bsd*-gnu like Linux, not BSD. Fixes compilation problems on
  Debian GNU/kFreeBSD.
  [[506285209]](https://git.sudo.ws/sudo/commit/?id=506285209)

2008-02-13 Todd C. Miller

* auth/kerb5.c:

  Avoid Heimdal’isms introduced in the rev 1.32 rewrite of
  verify\_krb\_v5\_tgt()
  [[dd2c345be]](https://git.sudo.ws/sudo/commit/?id=dd2c345be)

* logging.c, logging.h, sudo.c:

  Remove dependence on VALIDATE\_NOT\_OK in logging functions. Split
  log\_auth() into log\_allowed() and log\_denial() Replace mail\_auth() with
  should\_mail() and a call to send\_mail()
  [[04bb8f00f]](https://git.sudo.ws/sudo/commit/?id=04bb8f00f)

2008-02-10 Todd C. Miller

* ldap.c:

  Add debugging so we can tell if the krb5 ccache is accessible
  [[4f5d9371a]](https://git.sudo.ws/sudo/commit/?id=4f5d9371a)

* INSTALL:

  mention –with-selinux
  [[ebae55854]](https://git.sudo.ws/sudo/commit/?id=ebae55854)

2008-02-09 Todd C. Miller

* configure:

  regen
  [[9635907f2]](https://git.sudo.ws/sudo/commit/?id=9635907f2)

* selinux.c:

  add Sudo tag
  [[cc47d67b4]](https://git.sudo.ws/sudo/commit/?id=cc47d67b4)

* sudo.c, sudo.cat, sudo.h, sudo.man.in, sudo.pod, sudo\_usage.h.in,
  sudoers.ldap.cat, sudoers.ldap.man.in, sudoers.ldap.pod, testsudoers.c,
  toke.c, toke.l:

  Add support for SELinux RBAC. Sudoers entries may specify a role and
  type. There are also role and type defaults that may be used. To make
  sure a transition occurs, when using RBAC commands are executed via the
  new sesh binary. Based on initial changes from Dan Walsh.
  [[4c992e190]](https://git.sudo.ws/sudo/commit/?id=4c992e190)

* sesh.c:

  Add support for SELinux RBAC. Sudoers entries may specify a role and
  type. There are also role and type defaults that may be used. To make
  sure a transition occurs, when using RBAC commands are executed via the
  new sesh binary. Based on initial changes from Dan Walsh.
  [[c7a2ef7a1]](https://git.sudo.ws/sudo/commit/?id=c7a2ef7a1)

* Makefile.in, config.h.in, configure.in, def\_data.c, def\_data.h,
  def\_data.in, gram.c, gram.h, gram.y, ldap.c, parse.c, parse.h,
  pathnames.h.in, selinux.c:

  Add support for SELinux RBAC. Sudoers entries may specify a role and
  type. There are also role and type defaults that may be used. To make
  sure a transition occurs, when using RBAC commands are executed via the
  new sesh binary. Based on initial changes from Dan Walsh.
  [[f2b70188b]](https://git.sudo.ws/sudo/commit/?id=f2b70188b)

2008-02-08 Todd C. Miller

* lbuf.c, ldap.c, parse.c, sudo.c, sudo.h, sudo\_nss.c:

  Add long list (sudo -ll) support for printing verbose LDAP and sudoers
  file entries. Still need to update manual.
  [[5d20923c2]](https://git.sudo.ws/sudo/commit/?id=5d20923c2)

2008-02-03 Todd C. Miller

* ldap.c, parse.c, sudo.h, sudo\_nss.c, sudo\_nss.h:

  Unify the -l output for file and ldap based sudoers and use lbufs for
  both. The ldap output does not currently include options that cannot be
  represented as tags. This will be remedied in a long list output mode to
  come.
  [[3c7b76bb5]](https://git.sudo.ws/sudo/commit/?id=3c7b76bb5)

2008-01-27 Todd C. Miller

* set\_perms.c:

  Use a specific error message for errno == EAGAIN when setuid() et al
  fails. On Linux systems setuid() will fail with errno set to EAGAIN if
  changing to the new uid would result in a resource limit violation.
  [[8e33f6348]](https://git.sudo.ws/sudo/commit/?id=8e33f6348)

* sudo.c:

  Unlimit nproc on Linux systems where calling the setuid() family of
  syscalls causes the nroc resource limit to be checked. The limits will
  be reset by pam\_limits.so when PAM is used. In the non-PAM case the
  nproc limit will remain unlimited but there doesn’t seem to be a way
  around that other than having sudo parse /etc/security/limits.conf
  directly.
  [[72656eaf3]](https://git.sudo.ws/sudo/commit/?id=72656eaf3)

* env.c, sudo.c, sudo.pod:

  Only read /etc/environment on Linux and AIX
  [[801860b29]](https://git.sudo.ws/sudo/commit/?id=801860b29)

2008-01-23 Todd C. Miller

* configure, configure.in:

  Use SUDO\_DEFINE\_UNQUOTED instead of AC\_DEFINE\_UNQUOTED to prevent
  ldap.conf and ldap.secret paths from going into config.h. Avoid single
  quotes in variable expansion when using SUDO\_DEFINE\_UNQUOTED since in
  some versions of bash they will end up literally in the resulting
  define.
  [[f0dc1caa4]](https://git.sudo.ws/sudo/commit/?id=f0dc1caa4)

2008-01-21 Todd C. Miller

* README.LDAP:

  mention –with-nsswitch=no
  [[cc346a5ec]](https://git.sudo.ws/sudo/commit/?id=cc346a5ec)

* configure, configure.in:

  ldap\_ssl.h depends on ldap.h being included first
  [[48df9c481]](https://git.sudo.ws/sudo/commit/?id=48df9c481)

* config.h.in, configure, configure.in, ldap.c:

  Include ldap\_ssl.h if we can find it. Needed for the
  ldapssl\_set\_strength defines on HP-UX at least.
  [[a3e6610e0]](https://git.sudo.ws/sudo/commit/?id=a3e6610e0)

* sudoers.ldap.pod:

  sync
  [[870334373]](https://git.sudo.ws/sudo/commit/?id=870334373)

* TODO:

  sync
  [[40fb31c0a]](https://git.sudo.ws/sudo/commit/?id=40fb31c0a)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.ldap.cat,
  sudoers.ldap.man.in, sudoers.man.in, visudo.cat, visudo.man.in:

  regen
  [[bc5772f79]](https://git.sudo.ws/sudo/commit/?id=bc5772f79)

* Makefile.in:

  Use 78n line length when formatting cat pages.
  [[b54eff661]](https://git.sudo.ws/sudo/commit/?id=b54eff661)

* README.LDAP:

  Remove redundant info that is now in sudoers.ldap.pod
  [[57a6ebde5]](https://git.sudo.ws/sudo/commit/?id=57a6ebde5)

2008-01-20 Todd C. Miller

* sudoers.ldap.cat, sudoers.ldap.man.in, sudoers.ldap.pod:

  Reorganize the first section a bit. Substitute the proper path for
  /etc/sudoers.
  [[a48e85e1a]](https://git.sudo.ws/sudo/commit/?id=a48e85e1a)

* sudoers.ldap.cat, sudoers.ldap.man.in, sudoers.ldap.pod:

  Substitute values for ldap.conf, ldap.secret and nsswitch.conf Move
  schema into EXAMPLES
  [[e1db0d126]](https://git.sudo.ws/sudo/commit/?id=e1db0d126)

* configure, configure.in:

  Substitute values for ldap.conf, ldap.secret and nsswitch.conf into
  sudoers.ldap.man.
  [[c268627f9]](https://git.sudo.ws/sudo/commit/?id=c268627f9)

* configure, configure.in:

  substitute for sudoers.ldap.man
  [[49f2264ad]](https://git.sudo.ws/sudo/commit/?id=49f2264ad)

* Makefile.in:

  Fix cut & pasto introduced when adding sudoers.ldap man page.
  [[32d57a928]](https://git.sudo.ws/sudo/commit/?id=32d57a928)

* sudoers.ldap.cat, sudoers.ldap.man.in, sudoers.ldap.pod:

  Fill in some of the missing pieces. Still needs some reorganization and
  editing.
  [[961a79b74]](https://git.sudo.ws/sudo/commit/?id=961a79b74)

2008-01-19 Todd C. Miller

* Makefile.in, sudoers.ldap.cat, sudoers.ldap.man.in, sudoers.ldap.pod:

  Beginnings of a sudoers.ldap man page. Currently, much of the
  information is adapted from README.LDAP.
  [[907be979c]](https://git.sudo.ws/sudo/commit/?id=907be979c)

2008-01-18 Todd C. Miller

* pwutil.c:

  When copying gr\_mem we must guarantee that the storage space for gr\_mem
  is properly aligned. The simplest way to do this is to simply store
  gr\_mem directly after struct group. This is not a problem for gr\_passwd
  or gr\_name as they are simple strings.
  [[2a5a01c22]](https://git.sudo.ws/sudo/commit/?id=2a5a01c22)

* ldap.c:

  Fix a typo/thinko in one of the calls to
  sudo\_ldap\_check\_user\_netgroup(). From Marco van Wieringen.
  [[09c1189d1]](https://git.sudo.ws/sudo/commit/?id=09c1189d1)

2008-01-17 Todd C. Miller

* config.h.in, configure, configure.in, ldap.c:

  include <mps/ldap\_ssl.h> in ldap.c if available
  [[0f6101bb2]](https://git.sudo.ws/sudo/commit/?id=0f6101bb2)

2008-01-16 Todd C. Miller

* gram.c, gram.y:

  Make sure we define SIZE\_MAX for yacc’s skeleton.c
  [[5fc4d8fa1]](https://git.sudo.ws/sudo/commit/?id=5fc4d8fa1)

* tgetpass.c:

  Use TCSAFLUSH when restoring terminal settings (and echo) to guarantee
  that any pending output is discarded
  [[ebcf3cf39]](https://git.sudo.ws/sudo/commit/?id=ebcf3cf39)

2008-01-15 Todd C. Miller

* sudoers:

  no longer need to specify SETENV when user has sudo ALL
  [[fb4b04978]](https://git.sudo.ws/sudo/commit/?id=fb4b04978)

* testsudoers.c:

  sync user\_args size calculation with sudo.c Add -g group option,
  renaming old -g to -G Add set\_runasgr() and set\_runaspw() and use them
  [[18d42bf8b]](https://git.sudo.ws/sudo/commit/?id=18d42bf8b)

* sudo.c, sudo.h:

  Make set\_runaspw static void
  [[7f05a4ff6]](https://git.sudo.ws/sudo/commit/?id=7f05a4ff6)

* testsudoers.c, visudo.c:

  g/c set\_runaspw stub
  [[6c1ef6839]](https://git.sudo.ws/sudo/commit/?id=6c1ef6839)

* configure, configure.in:

  Don’t add -llber twice.
  [[63f224f04]](https://git.sudo.ws/sudo/commit/?id=63f224f04)

2008-01-14 Todd C. Miller

* ldap.c:

  fix typo
  [[6131e9f36]](https://git.sudo.ws/sudo/commit/?id=6131e9f36)

2008-01-13 Todd C. Miller

* gram.c:

  regen
  [[2ff13a240]](https://git.sudo.ws/sudo/commit/?id=2ff13a240)

* configure, configure.in:

  Fix check that determines whether -llber is required.
  [[dde5143f0]](https://git.sudo.ws/sudo/commit/?id=dde5143f0)

* README.LDAP, config.h.in, configure, configure.in, ldap.c:

  For netscape-based LDAP, use ldapssl\_set\_strength() to implement the
  checkpeer ldap.conf option.
  [[9a07c1a7f]](https://git.sudo.ws/sudo/commit/?id=9a07c1a7f)

* auth/kerb5.c:

  Delay krb5\_cc\_initialize() until we actually need to use the cred cache,
  which is what krb5\_verify\_user() does. Better cleanup on failure.
  [[0851d77f1]](https://git.sudo.ws/sudo/commit/?id=0851d77f1)

2008-01-12 Todd C. Miller

* auth/kerb5.c:

  Rewrite verify\_krb\_v5\_tgt() based on what heimdal’s krb5\_verify\_user()
  does.
  [[584ab252d]](https://git.sudo.ws/sudo/commit/?id=584ab252d)

2008-01-09 Todd C. Miller

* gram.c:

  The U suffix on constants is an ANSI feature
  [[7a110f08c]](https://git.sudo.ws/sudo/commit/?id=7a110f08c)

* configure, configure.in:

  Add check for ber\_set\_option() in -llber
  [[1df9ca2dc]](https://git.sudo.ws/sudo/commit/?id=1df9ca2dc)

2008-01-07 Todd C. Miller

* README.LDAP:

  default if no nsswitch.conf is files only
  [[8db7b8e59]](https://git.sudo.ws/sudo/commit/?id=8db7b8e59)

2008-01-06 Todd C. Miller

* README.LDAP:

  don’t tell people to mail aaron about LDAP stuff
  [[1b6275a69]](https://git.sudo.ws/sudo/commit/?id=1b6275a69)

* README.LDAP:

  timelimit and bind\_timelimit
  [[0b11b7e71]](https://git.sudo.ws/sudo/commit/?id=0b11b7e71)

* ChangeLog:

  sync
  [[a9615943f]](https://git.sudo.ws/sudo/commit/?id=a9615943f)

* ldap.c:

  Move ldap.secret reading into a separate function.
  [[00030b9ad]](https://git.sudo.ws/sudo/commit/?id=00030b9ad)

* check.c:

  user\_runas -> runas\_pw
  [[43f740860]](https://git.sudo.ws/sudo/commit/?id=43f740860)

2008-01-05 Todd C. Miller

* TODO:

  sync
  [[990910665]](https://git.sudo.ws/sudo/commit/?id=990910665)

* check.c, sudo.pod, sudoers.pod:

  Add and document the %p escape in the password prompt. Based on a patch
  from Patrick Schoenfeld.
  [[0fc0e3c86]](https://git.sudo.ws/sudo/commit/?id=0fc0e3c86)

* ldap.c:

  Check strlcpy() return values.
  [[9998419d7]](https://git.sudo.ws/sudo/commit/?id=9998419d7)

* ldap.c:

  refactor ldap binding code into sudo\_ldap\_bind\_s()
  [[4bb216745]](https://git.sudo.ws/sudo/commit/?id=4bb216745)

* README.LDAP:

  Make it clear that host and uri can take multiple parameters. URI is now
  supported for more than just openldap nsswitch.conf does’t accept
  “compat”
  [[77d841e0e]](https://git.sudo.ws/sudo/commit/?id=77d841e0e)

* sudo.c:

  comment cleanup and update (c) year
  [[055bda626]](https://git.sudo.ws/sudo/commit/?id=055bda626)

* parse.c, sudo\_nss.c:

  Move display\_privs() and display\_cmnd() from parse.c to sudo\_nss.c. This
  should make it possible to build an LDAP-only sudo binary.
  [[fb0164887]](https://git.sudo.ws/sudo/commit/?id=fb0164887)

* ldap.c, parse.c, sudo.c, sudo.h, sudo\_nss.h:

  Improve chaining of multiple sudoers sources by passing in the previous
  return value to the next in the chain
  [[28ed51b44]](https://git.sudo.ws/sudo/commit/?id=28ed51b44)

* gram.y:

  Free up parser data structures in sudo\_file\_close().
  [[56d193b29]](https://git.sudo.ws/sudo/commit/?id=56d193b29)

* gram.c, parse.c:

  Free up parser data structures in sudo\_file\_close().
  [[53aec6601]](https://git.sudo.ws/sudo/commit/?id=53aec6601)

* ldap.c:

  Parse uri ourself if no ldap\_initialize() is present Use ldap\_create()
  instead of deprecated ldap\_init() Use ldap\_sasl\_bind\_s() instead of
  deprecated ldap\_simple\_bind\_s()
  [[e4370acaa]](https://git.sudo.ws/sudo/commit/?id=e4370acaa)

* config.h.in, configure, configure.in:

  Add check for ldap\_sasl\_bind\_s() Remove -DLDAP\_DEPRECATED from CFLAGS
  [[f1377429a]](https://git.sudo.ws/sudo/commit/?id=f1377429a)

2008-01-04 Todd C. Miller

* config.h.in, configure, configure.in:

  add check for ldap\_create
  [[b564d5186]](https://git.sudo.ws/sudo/commit/?id=b564d5186)

2008-01-03 Todd C. Miller

* config.h.in, configure, configure.in, ldap.c:

  Add sudo\_ldap\_get\_first\_rdn() to return the first rdn of an entry’s dn
  using the mechanism appropriate for the LDAP SDK in use. Use
  ldap\_unbind\_ext\_s() instead of deprecated ldap\_unbind\_s(). Emulate
  ldap\_unbind\_ext\_s() and ldap\_search\_ext\_s() for SDK’s without them.
  [[86bd55fc6]](https://git.sudo.ws/sudo/commit/?id=86bd55fc6)

* lbuf.c:

  include unistd.h
  [[179ec68f8]](https://git.sudo.ws/sudo/commit/?id=179ec68f8)

* config.h.in, configure.in:

  fix typo in mtim\_getnsec
  [[27efa3d25]](https://git.sudo.ws/sudo/commit/?id=27efa3d25)

2008-01-02 Todd C. Miller

* config.h.in, configure, configure.in:

  add check for st\_\_tim in struct stat as used by SCO
  [[32e4a98a6]](https://git.sudo.ws/sudo/commit/?id=32e4a98a6)

* ldap.c:

  use ldap\_search\_ext\_s instead of deprecated ldap\_search\_s
  [[e23813315]](https://git.sudo.ws/sudo/commit/?id=e23813315)

* Makefile.in, TODO, sudo.cat, sudo.man.in:

  add sudo\_nss.h to HDRS
  [[915fc493c]](https://git.sudo.ws/sudo/commit/?id=915fc493c)

* ldap.c:

  Replace deprecated ldap\_explode\_dn() with calls to ldap\_str2dn() and
  ldap\_rdn2str().
  [[5173bbb95]](https://git.sudo.ws/sudo/commit/?id=5173bbb95)

2008-01-01 Todd C. Miller

* ldap.c:

  Use ldap\_get\_values\_len()/ldap\_value\_free\_len() instead of the
  deprecated ldap\_get\_values()/ldap\_value\_free().
  [[8a2db8bd0]](https://git.sudo.ws/sudo/commit/?id=8a2db8bd0)

* ChangeLog:

  sync
  [[6771b3617]](https://git.sudo.ws/sudo/commit/?id=6771b3617)

* TODO:

  sync
  [[f738ef46f]](https://git.sudo.ws/sudo/commit/?id=f738ef46f)

* gettime.c, sudo.c:

  Remove some already fixed XXXs
  [[5a6ad03e5]](https://git.sudo.ws/sudo/commit/?id=5a6ad03e5)

* ldap.c:

  Same return value as non-existent sudoers if LDAP was unable to connect.
  [[aa562c8f6]](https://git.sudo.ws/sudo/commit/?id=aa562c8f6)

* sudo.pod:

  mention /etc/environment
  [[ab14071ec]](https://git.sudo.ws/sudo/commit/?id=ab14071ec)

* README.LDAP, UPGRADE, WHATSNEW:

  Update to reflect recent developments.
  [[685d9d2da]](https://git.sudo.ws/sudo/commit/?id=685d9d2da)

* sudo.c:

  Print nsswitch.conf, ldap.conf and ldap.secret paths in -V output.
  [[156c94975]](https://git.sudo.ws/sudo/commit/?id=156c94975)

* ldap.c:

  When building up a query don’t list groups in the aux group vector that
  are the same as the passwd file group. On most systems the first gid in
  the group vector is the same as the passwd entry gid.
  [[a7fb2f3e3]](https://git.sudo.ws/sudo/commit/?id=a7fb2f3e3)

* env.c, ldap.c:

  Define LDAPNOINIT before calling ldap\_init(), etc. to disable user
  ldaprc and system defaults that could affect how LDAP works.
  [[cd30e8474]](https://git.sudo.ws/sudo/commit/?id=cd30e8474)

* INSTALL, configure, configure.in, pathnames.h.in, sudo.c, sudo\_nss.c,
  sudo\_nss.h:

  Rename read\_nss -> sudo\_read\_nss Add –with-nsswitch to allow users to
  specify nsswitch.conf path or disable it. If –with-nsswitch=no but
  –with-ldap, order is LDAP, then sudoers. Fix –with-ldap-conf-file and
  –with-ldap-secret-file
  [[6f2cd1b18]](https://git.sudo.ws/sudo/commit/?id=6f2cd1b18)

* parse.c:

  Honor def\_ignore\_local\_sudoers
  [[d2de8d5fe]](https://git.sudo.ws/sudo/commit/?id=d2de8d5fe)

2007-12-31 Todd C. Miller

* ldap.c:

  no longer need to check def\_ignore\_local\_sudoers here
  [[d6e9445a6]](https://git.sudo.ws/sudo/commit/?id=d6e9445a6)

* parse.c:

  Refactor group vector resetting into a function and also call it from
  display\_cmnd. Stop after the first sucessful match in display\_cmnd.
  Print a newline between each display\_privs method.
  [[4d8f37f4b]](https://git.sudo.ws/sudo/commit/?id=4d8f37f4b)

* parse.c:

  fix double free introduced in rev 1.218
  [[36b221af2]](https://git.sudo.ws/sudo/commit/?id=36b221af2)

* ldap.c:

  belt and suspenders; zero out result after freeing it
  [[b28913068]](https://git.sudo.ws/sudo/commit/?id=b28913068)

* env.c, fileops.c, ldap.c, sudo.h, sudo\_nss.c:

  Refactor line reading into a separate function, sudo\_parseln(), which
  removes comments, leading/trailing whitespace and newlines. May want to
  rethink the use of sudo\_parseln() for /etc/ldap.secret
  [[926dcd0bc]](https://git.sudo.ws/sudo/commit/?id=926dcd0bc)

* parse.c, sudo.c:

  Make the inability to read the sudoers file a non-fatal error if there
  are other sudoers sources available. sudoers\_file\_lookup now returns
  “not OK” if sudoers was not present
  [[0a2166272]](https://git.sudo.ws/sudo/commit/?id=0a2166272)

* ldap.c:

  make it clear that the global options are from LDAP
  [[09439030f]](https://git.sudo.ws/sudo/commit/?id=09439030f)

* logging.c:

  allocate proper amount of space for error string
  [[e6d707b2d]](https://git.sudo.ws/sudo/commit/?id=e6d707b2d)

* sudo\_nss.c, sudo\_nss.h:

  actual sudo nss code
  [[de3bb5892]](https://git.sudo.ws/sudo/commit/?id=de3bb5892)

* ldap.c, parse.c, sudo.c, sudo.h:

  nss-ify display\_privs and display\_cmnd.
  [[adfaebdb4]](https://git.sudo.ws/sudo/commit/?id=adfaebdb4)

* defaults.c, parse.c, testsudoers.c, visudo.c:

  move update\_defaults() to parse.c
  [[3008bb494]](https://git.sudo.ws/sudo/commit/?id=3008bb494)

* Makefile.in, ldap.c, list.c, parse.c, parse.h, sudo.c, sudo.h:

  Use nsswitch to hide some sudoers vs. ldap implementation details and
  reduce the number of #ifdef LDAP TODO: fix display routines and error
  handling
  [[ae2ae3452]](https://git.sudo.ws/sudo/commit/?id=ae2ae3452)

2007-12-28 Todd C. Miller

* Makefile.in, README.LDAP, ldap.c, pathnames.h.in, sudo.c, sudo.h:

  First cut at nsswitch.conf support. Further reorganizaton and related
  changes are forthcoming.
  [[7f323157a]](https://git.sudo.ws/sudo/commit/?id=7f323157a)

2007-12-21 Todd C. Miller

* env.c, pathnames.h.in, sudo.c, sudo.h:

  Add support for reading and /etc/environment file. Still needs to be
  documented and should probably only applies to OSes that have it (AIX
  and Linux, maybe others).
  [[f8c52dc92]](https://git.sudo.ws/sudo/commit/?id=f8c52dc92)

* ldap.c:

  include limits.h
  [[1a69e42d9]](https://git.sudo.ws/sudo/commit/?id=1a69e42d9)

2007-12-20 Todd C. Miller

* WHATSNEW:

  reword LDAP SASL
  [[12b86ef41]](https://git.sudo.ws/sudo/commit/?id=12b86ef41)

2007-12-19 Todd C. Miller

* TODO:

  sync
  [[d7090332e]](https://git.sudo.ws/sudo/commit/?id=d7090332e)

* README.LDAP:

  Add an example sudoRole, clarify netscape vs. openldap a bit more
  [[e60093477]](https://git.sudo.ws/sudo/commit/?id=e60093477)

* README.LDAP:

  Be clear on what is OpenLDAP vs. Netscape-derived
  [[9dc049ccf]](https://git.sudo.ws/sudo/commit/?id=9dc049ccf)

* config.h.in, configure, configure.in, ldap.c:

  Use ldapssl\_init() for ldaps support instead of trying to do it manually
  with ldap\_init() + ldapssl\_install\_routines(). Use tls\_cert and tls\_key
  for cert7.db and key3.db respectively. Don’t print debugging info for
  options that are not set. Add warning if start\_tls specified when not
  supported.
  [[56729b9a6]](https://git.sudo.ws/sudo/commit/?id=56729b9a6)

* ldap.c:

  fix compilation on solaris
  [[f60e1d3cb]](https://git.sudo.ws/sudo/commit/?id=f60e1d3cb)

* Makefile.in:

  add missing .h and .c files for missing lib objs
  [[9ed999b7a]](https://git.sudo.ws/sudo/commit/?id=9ed999b7a)

2007-12-18 Todd C. Miller

* ldap.c:

  fix LDAP\_OPT\_NETWORK\_TIMEOUT setting
  [[dbe2b9e4f]](https://git.sudo.ws/sudo/commit/?id=dbe2b9e4f)

* ldap.c:

  fix compilation on Solaris
  [[3be9fcbed]](https://git.sudo.ws/sudo/commit/?id=3be9fcbed)

2007-12-17 Todd C. Miller

* configure, configure.in:

  fix typo
  [[72e1a2b54]](https://git.sudo.ws/sudo/commit/?id=72e1a2b54)

* README.LDAP:

  try to clear up which variables are for OpenLDAP and which are for
  netscape-derived SDKs
  [[6aa830875]](https://git.sudo.ws/sudo/commit/?id=6aa830875)

* config.h.in, configure, configure.in, ldap.c:

  Add support for “ssl on” in both netscape and openldap flavors. Only the
  OpenLDAP flavor has been tested.
  [[b40949930]](https://git.sudo.ws/sudo/commit/?id=b40949930)

* logging.c, sudo.c, sudo.h:

  Call cleanup() before exit in log\_error() instead of calling
  sudo\_ldap\_close() directly. ldap\_conn can now be static to sudo.c
  [[ff0a538d0]](https://git.sudo.ws/sudo/commit/?id=ff0a538d0)

* sudo.c:

  ld -> ldap\_conn
  [[ed88a812e]](https://git.sudo.ws/sudo/commit/?id=ed88a812e)

2007-12-16 Todd C. Miller

* logging.c, sudo.c, sudo.h:

  Better ldap cleanup.
  [[a68ab16dc]](https://git.sudo.ws/sudo/commit/?id=a68ab16dc)

* ldap.c:

  Distinguish between LDAP conf settings that are connection-specific
  (which take an ld pointer) and those that are default settings (which do
  not).
  [[c5b5f0cfd]](https://git.sudo.ws/sudo/commit/?id=c5b5f0cfd)

2007-12-14 Todd C. Miller

* ldap.c:

  Improved warnings on error.
  [[06e6097a4]](https://git.sudo.ws/sudo/commit/?id=06e6097a4)

* ldap.c:

  Make ldap config table driven and set the config *after* we open the
  connection.
  [[7c1889af1]](https://git.sudo.ws/sudo/commit/?id=7c1889af1)

2007-12-13 Todd C. Miller

* ldap.c:

  fix LDAP\_OPT\_X\_CONNECT\_TIMEOUT compat define
  [[6acbe1728]](https://git.sudo.ws/sudo/commit/?id=6acbe1728)

* configure, configure.in:

  some operating systems need to link with -lkrb5support when using krb5
  [[400309aa9]](https://git.sudo.ws/sudo/commit/?id=400309aa9)

2007-12-10 Todd C. Miller

* WHATSNEW:

  minor update
  [[5ae3bb2dd]](https://git.sudo.ws/sudo/commit/?id=5ae3bb2dd)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in:

  regen
  [[51d841654]](https://git.sudo.ws/sudo/commit/?id=51d841654)

2007-12-08 Todd C. Miller

* ChangeLog, TODO:

  sync
  [[3e7a467e8]](https://git.sudo.ws/sudo/commit/?id=3e7a467e8)

* ldap.c, schema.OpenLDAP, schema.iPlanet, sudoers2ldif:

  add -g support for LDAP
  [[ae98617df]](https://git.sudo.ws/sudo/commit/?id=ae98617df)

2007-12-03 Todd C. Miller

* WHATSNEW, sudo.c, sudo.pod, sudo\_usage.h.in:

  The -i and -s flags can now take an optional command.
  [[3592cc0b1]](https://git.sudo.ws/sudo/commit/?id=3592cc0b1)

2007-12-02 Todd C. Miller

* auth/pam.c, def\_data.c, def\_data.h, def\_data.in, sudo.c, sudo.pod,
  sudoers.pod:

  Add passprompt\_override flag to sudoers that will cause the prompt to be
  overridden in all cases. This flag is also set when the user specifies
  the -p flag.
  [[74c5dc4fa]](https://git.sudo.ws/sudo/commit/?id=74c5dc4fa)

* sudo.c:

  Move setting of login class until after sudoers has been parsed. Set
  NewArgv[0] for -i after runas\_pw has been set.
  [[4efd981d6]](https://git.sudo.ws/sudo/commit/?id=4efd981d6)

* configure, configure.in:

  Move the dgettext check.
  [[c148eb52d]](https://git.sudo.ws/sudo/commit/?id=c148eb52d)

2007-12-01 Todd C. Miller

* auth/pam.c, config.h.in, configure, configure.in:

  Add basic support for looking up the string “Password: " in the PAM
  localized text db. This allows us to determine whether the PAM prompt is
  the default “Password: " one even if it has been localized.

  TODO: concatenate non-std PAM prompts and user-specified sudo prompts.
  [[8694c7314]](https://git.sudo.ws/sudo/commit/?id=8694c7314)

2007-11-27 Todd C. Miller

* Makefile.in, config.h.in, configure, configure.in, parse.c, set\_perms.c,
  sudo.c, sudo.h:

  Use AC\_FUNC\_GETGROUPS instead of a home-grown attempt that was
  insufficient.
  [[908b8f64e]](https://git.sudo.ws/sudo/commit/?id=908b8f64e)

* acsite.m4, configure, interfaces.c, memrchr.c:

  Fix typos; Martynas Venckus
  [[a85dd4b86]](https://git.sudo.ws/sudo/commit/?id=a85dd4b86)

2007-11-26 Todd C. Miller

* set\_perms.c:

  Don’t assume runas\_pw is set; it may not be in the -g case.
  [[9c5696978]](https://git.sudo.ws/sudo/commit/?id=9c5696978)

2007-11-25 Todd C. Miller

* logging.c, set\_perms.c:

  Set aux group vector for PERM\_RUNAS and restore group vector for
  PERM\_ROOT if we previously changed it. Stash the runas group vector so
  we don’t have to call initgroups more than once. Also add no-op check to
  check\_perms.
  [[a76630000]](https://git.sudo.ws/sudo/commit/?id=a76630000)

2007-11-21 Todd C. Miller

* WHATSNEW, check.c, def\_data.in, defaults.c, gram.c, gram.h, gram.y,
  ldap.c, logging.c, match.c, mon\_systrace.c, parse.c, parse.h, pwutil.c,
  set\_perms.c, sudo.c, sudo.cat, sudo.h, sudo.man.in, sudo.pod,
  sudo\_usage.h.in, sudoers.cat, sudoers.man.in, sudoers.pod,
  testsudoers.c, visudo.c, visudo.cat, visudo.man.in:

  Add support for runas groups. This allows the user to run a command with
  a different effective group. If the -g option is specified without -u
  the command will be run as the current user (only the group will
  change). the -g and -u options may be used together. TODO: implement
  runas group for ldap improve runas group documentation add testsudoers
  support
  [[f9f4aca55]](https://git.sudo.ws/sudo/commit/?id=f9f4aca55)

* configure, configure.in:

  fix setting of mandir
  [[bfd781ff6]](https://git.sudo.ws/sudo/commit/?id=bfd781ff6)

* sudo.pod, sudoers.pod:

  document that ALL implies SETENV
  [[c9f393e4d]](https://git.sudo.ws/sudo/commit/?id=c9f393e4d)

* ldap.c:

  s/setenv\_ok/setenv\_implied/g
  [[e6c0ba72f]](https://git.sudo.ws/sudo/commit/?id=e6c0ba72f)

* ldap.c:

  hostname\_matches() returns TRUE on match in sudo 1.7.
  [[fff47a319]](https://git.sudo.ws/sudo/commit/?id=fff47a319)

* ldap.c:

  use strcmp, not strcasecmp when comparing ALL
  [[4a39e1beb]](https://git.sudo.ws/sudo/commit/?id=4a39e1beb)

* ldap.c:

  Make sudo ALL imply setenv. Note that unlike with file-based sudoers
  this does affect all the commands in the sudoRole.
  [[6751e9a9c]](https://git.sudo.ws/sudo/commit/?id=6751e9a9c)

* gram.c, gram.y, parse.c, parse.h:

  sudo “ALL” now implies the SETENV tag but, unlike an explicit tag, it is
  not passed on to other commands in the list.
  [[52b2861bb]](https://git.sudo.ws/sudo/commit/?id=52b2861bb)

* visudo.c:

  Add missing sudo\_setpwent() and sudo\_setgrent() calls. Also use
  sudo\_getpwuid() instead of getpwuid().
  [[87dc0bb2e]](https://git.sudo.ws/sudo/commit/?id=87dc0bb2e)

2007-11-15 Todd C. Miller

* sudoers:

  Expand on the dangers of not using visudo to edit sudoers.
  [[8b1ada4a8]](https://git.sudo.ws/sudo/commit/?id=8b1ada4a8)

2007-11-08 Todd C. Miller

* parse.c:

  Don’t quote \*?[]! on output since the lexer does not strip off the
  backslash when reading those in.
  [[7cd59baad]](https://git.sudo.ws/sudo/commit/?id=7cd59baad)

2007-11-07 Todd C. Miller

* glob.c:

  expand “u\_foo” types to “unsigned foo” to avoid compatibility issues.
  [[5c61e13db]](https://git.sudo.ws/sudo/commit/?id=5c61e13db)

2007-11-04 Todd C. Miller

* logging.c:

  Refactor log line generation in to new\_logline().
  [[8ff6b6cca]](https://git.sudo.ws/sudo/commit/?id=8ff6b6cca)

2007-10-25 Todd C. Miller

* TROUBLESHOOTING:

  fix typo
  [[c22d29597]](https://git.sudo.ws/sudo/commit/?id=c22d29597)

2007-10-24 Todd C. Miller

* config.h.in, configure, configure.in, interfaces.c, interfaces.h,
  match.c:

  Add configure check for struct in6\_addr instead of relying on AF\_INET6
  since some systems define AF\_INET6 but do not include IPv6 support.
  [[0d22c2f98]](https://git.sudo.ws/sudo/commit/?id=0d22c2f98)

2007-10-21 Todd C. Miller

* configure, configure.in:

  Fix block to add -lutil for FreeBSD and NetBSD when logincap is in use.
  [[c50e7d4c0]](https://git.sudo.ws/sudo/commit/?id=c50e7d4c0)

2007-10-20 Todd C. Miller

* configure, configure.in:

  POSIX states that struct timespec be declared in time.h so check there
  regardless of the value of TIME\_WITH\_SYS\_TIME.
  [[8ef458b59]](https://git.sudo.ws/sudo/commit/?id=8ef458b59)

2007-10-17 Todd C. Miller

* tgetpass.c:

  Instead of defining a macro to call the appropriate method for turning
  on/off echo, just define tc[gs]etattr() and the related defines that use
  the correct terminal ioctls if needed. Also go back to using TCSAFLUSH
  instead of TCSADRAIN on all but QNX.
  [[45a382bba]](https://git.sudo.ws/sudo/commit/?id=45a382bba)

2007-10-09 Todd C. Miller

* Makefile.in:

  g/c @ALLOCA@
  [[f28aa7f8c]](https://git.sudo.ws/sudo/commit/?id=f28aa7f8c)

* configure:

  regen
  [[c3f281841]](https://git.sudo.ws/sudo/commit/?id=c3f281841)

* INSTALL, auth/pam.c, config.h.in, configure.in:

  Add –disable-pam-session configure option to disable calling
  pam\_{open,close}\_session. May work around bugs in some PAM
  implementations.
  [[5a04b3ff9]](https://git.sudo.ws/sudo/commit/?id=5a04b3ff9)

2007-10-08 Todd C. Miller

* tgetpass.c:

  quiet gcc warnings
  [[f95160542]](https://git.sudo.ws/sudo/commit/?id=f95160542)

* tgetpass.c:

  Avoid printing the prompt if we are already backgrounded. E.g. if the
  user runs “sudo foo &” from the shell. In this case, the call to
  tcsetattr() will cause SIGTTOU to be delivered.
  [[c84ad2683]](https://git.sudo.ws/sudo/commit/?id=c84ad2683)

2007-09-15 Todd C. Miller

* def\_data.c, def\_data.h, def\_data.in:

  Reorder things such that the definition of env\_reset come right before
  the env variable lists.
  [[209e35027]](https://git.sudo.ws/sudo/commit/?id=209e35027)

* parse.h:

  Shrink type and seqno in struct alias from int to u\_short
  [[0b6ebf4d8]](https://git.sudo.ws/sudo/commit/?id=0b6ebf4d8)

* alias.c, match.c, parse.c, parse.h:

  Add a sequence number in the aliases for loop detection. If we find an
  alias with the seqno already set to the current (global) value we know
  we’ve visited it before so ignore it.
  [[76e5eb434]](https://git.sudo.ws/sudo/commit/?id=76e5eb434)

2007-09-13 Todd C. Miller

* TODO, auth/pam.c, sudo.c, sudo.h:

  PAM wants the full tty path so add user\_ttypath which holds the full
  path to the tty or is NULL if no tty was present.
  [[4f5e88532]](https://git.sudo.ws/sudo/commit/?id=4f5e88532)

* auth/pam.c:

  Set PAM\_RHOST to work around a bug in Solaris 7 and lower that results
  in a segv.
  [[bb07eea18]](https://git.sudo.ws/sudo/commit/?id=bb07eea18)

2007-09-11 Todd C. Miller

* gram.c:

  regen
  [[57ee080a0]](https://git.sudo.ws/sudo/commit/?id=57ee080a0)

* alias.c, defaults.c, gram.y, list.c, list.h, match.c, parse.c, parse.h,
  testsudoers.c, visudo.c:

  rename lh\_ -> tq\_
  [[a0f80d658]](https://git.sudo.ws/sudo/commit/?id=a0f80d658)

2007-09-10 Todd C. Miller

* alloc.c:

  remove some useless casts
  [[91526aaf7]](https://git.sudo.ws/sudo/commit/?id=91526aaf7)

* alloc.c:

  pull in inttypes.h for SIZE\_MAX; we avoid stdint.h since inttypes.h
  predates the final C99 spec and the standard specifies that it shall
  include stdint.h anyway
  [[fde060e84]](https://git.sudo.ws/sudo/commit/?id=fde060e84)

2007-09-06 Todd C. Miller

* Makefile.in, alloca.c, configure.in:

  Since we ship with a pre-generated parser there is no need to ship a
  bogus alloca implementation.
  [[2c59eea84]](https://git.sudo.ws/sudo/commit/?id=2c59eea84)

* configure:

  regen
  [[6cbee775b]](https://git.sudo.ws/sudo/commit/?id=6cbee775b)

* configure.in:

  remove initial setting of CHECKSIA, we require that it be unset if not
  used
  [[580348788]](https://git.sudo.ws/sudo/commit/?id=580348788)

* Makefile.in:

  add list.c to SRCS
  [[dda1fb26a]](https://git.sudo.ws/sudo/commit/?id=dda1fb26a)

* configure:

  regen
  [[638d039ae]](https://git.sudo.ws/sudo/commit/?id=638d039ae)

* configure.in:

  only do SIA checks on Digital Unix
  [[2c6287b71]](https://git.sudo.ws/sudo/commit/?id=2c6287b71)

2007-09-05 Todd C. Miller

* sudoers.cat, sudoers.man.in:

  regen
  [[a06ae77c5]](https://git.sudo.ws/sudo/commit/?id=a06ae77c5)

* ChangeLog, TODO:

  sync
  [[6e05465b9]](https://git.sudo.ws/sudo/commit/?id=6e05465b9)

* auth/kerb5.c:

  Remove call to krb5\_cc\_register() as it is not needed for modern kerb5.
  [[c572e31ff]](https://git.sudo.ws/sudo/commit/?id=c572e31ff)

* configure:

  regen
  [[32e97c5dc]](https://git.sudo.ws/sudo/commit/?id=32e97c5dc)

* aclocal.m4, configure.in:

  New method for setting the default authentication type and avoiding
  conflicts in auth types.
  [[72255c0ad]](https://git.sudo.ws/sudo/commit/?id=72255c0ad)

* match.c, parse.c, testsudoers.c:

  Each entry in a cmndlist now has an associated runaslist so no need to
  keep track of the most recent non-NULL one.
  [[21f0ea4d6]](https://git.sudo.ws/sudo/commit/?id=21f0ea4d6)

2007-09-04 Todd C. Miller

* ldap.c:

  back out partial ldaps support mistakenly committed
  [[19ff128f3]](https://git.sudo.ws/sudo/commit/?id=19ff128f3)

* ldap.c:

  Add support for unix groups and netgroups in sudoRunas
  [[84a22a2d5]](https://git.sudo.ws/sudo/commit/?id=84a22a2d5)

2007-09-03 Todd C. Miller

* sudo\_edit.c:

  Fix sudoedit of a non-existent file. From Tilo Stritzky.
  [[32403a2d8]](https://git.sudo.ws/sudo/commit/?id=32403a2d8)

2007-09-02 Todd C. Miller

* configure:

  regen
  [[2bff032c9]](https://git.sudo.ws/sudo/commit/?id=2bff032c9)

* INSTALL:

  update –passprompt escape info
  [[290eff4f5]](https://git.sudo.ws/sudo/commit/?id=290eff4f5)

* configure.in:

  remove now-bogus comment and update copyright date
  [[5ac0dc57b]](https://git.sudo.ws/sudo/commit/?id=5ac0dc57b)

* configure.in:

  Fix up use of with\_passwd
  [[237922518]](https://git.sudo.ws/sudo/commit/?id=237922518)

* acsite.m4, config.guess, config.sub, configure.in, ltmain.sh:

  Update to autoconf-2.61 andf libtool-1.5.24
  [[16871871d]](https://git.sudo.ws/sudo/commit/?id=16871871d)

* Makefile.in:

  “cmp -s” not just cmp Add @datarootdir@ to quiet autoconf-2.61
  [[0459e07d4]](https://git.sudo.ws/sudo/commit/?id=0459e07d4)

2007-09-01 Todd C. Miller

* gram.c:

  regen
  [[d8e1c8090]](https://git.sudo.ws/sudo/commit/?id=d8e1c8090)

* gram.y:

  move tags and runaslist propagation to be earlier
  [[b11b56deb]](https://git.sudo.ws/sudo/commit/?id=b11b56deb)

* visudo.c:

  If -f flag given use the permissions of the original file as a template
  [[dee39f572]](https://git.sudo.ws/sudo/commit/?id=dee39f572)

* gram.y:

  prevent a double free() when re-initing the parser
  [[cbe6be8f8]](https://git.sudo.ws/sudo/commit/?id=cbe6be8f8)

2007-08-31 Todd C. Miller

* configure:

  regen
  [[a7bfc5909]](https://git.sudo.ws/sudo/commit/?id=a7bfc5909)

* aclocal.m4, alias.c, alloc.c, auth/API, auth/afs.c, auth/bsdauth.c,
  auth/kerb4.c, auth/kerb5.c, auth/pam.c, auth/securid.c, auth/securid5.c,
  auth/sia.c, auth/sudo\_auth.h, config.h.in, configure.in, env.c, ldap.c,
  list.c, list.h, memrchr.c, parse.c, parse.h, pwutil.c, redblack.c,
  redblack.h, snprintf.c, sudo.c, sudo.h, testsudoers.c, visudo.c,
  zero\_bytes.c:

  Remove support for compilers that don’t support void \*
  [[19fa25948]](https://git.sudo.ws/sudo/commit/?id=19fa25948)

* gram.c:

  regen
  [[6b3157d80]](https://git.sudo.ws/sudo/commit/?id=6b3157d80)

* Makefile.in, alias.c, defaults.c, gram.y, list.c, list.h, match.c,
  parse.c, parse.h, testsudoers.c, visudo.c:

  Move list manipulation macros to list.h and create C versions of the
  more complex ones in list.c. The names have been down-cased so they
  appear more like normal functions.
  [[d72778832]](https://git.sudo.ws/sudo/commit/?id=d72778832)

* Makefile.in:

  Fix cmp command when regenerating parser. Make gram.o the first
  dependency for all programs so gram.h will be generated before anything
  that needs it.
  [[07ebde409]](https://git.sudo.ws/sudo/commit/?id=07ebde409)

* gram.y, parse.h:

  Convert NEW\_DEFAULT anf NEW\_MEMBER into static functions.
  [[d56d0b115]](https://git.sudo.ws/sudo/commit/?id=d56d0b115)

* match.c, parse.c, testsudoers.c:

  Use LH\_FOREACH\_REV when checking permission and short-circuit on the
  first non-UNSPEC hit we get for the command. This means that instead of
  cycling through the all the parsed sudoers entries we start at the end
  and work backwards and quit after the first positive or negative match.
  [[10e5d4e70]](https://git.sudo.ws/sudo/commit/?id=10e5d4e70)

* gram.c:

  regen
  [[270ba11db]](https://git.sudo.ws/sudo/commit/?id=270ba11db)

* defaults.c, gram.y, parse.c, parse.h, testsudoers.c, visudo.c:

  Change list head macros to take a pointer, not a struct.
  [[d1dbe2ece]](https://git.sudo.ws/sudo/commit/?id=d1dbe2ece)

* gram.c:

  regen
  [[4df703781]](https://git.sudo.ws/sudo/commit/?id=4df703781)

* gram.y:

  Propagate the runasspec from one command to the next in a cmndspec.
  [[470a710c3]](https://git.sudo.ws/sudo/commit/?id=470a710c3)

2007-08-30 Todd C. Miller

* match.c:

  Replace has\_meta() with a macro that calls strpbrk().
  [[1d69c0d63]](https://git.sudo.ws/sudo/commit/?id=1d69c0d63)

* :

  regen
  [[bb51d5210]](https://git.sudo.ws/sudo/commit/?id=bb51d5210)

* alias.c, defaults.c, gram.y, match.c, parse.c, parse.h, testsudoers.c,
  visudo.c:

  Use a list head struct when storing the semi-circular lists and convert
  to tail queues in the process. This will allow us to reverse foreach
  loops more easily and it makes it clearer which functions expect a list
  as opposed to a single member.

  Add macros for manipulating lists. Some of these should become
  functions.

  When freeing up a list, just pop off the last item in the queue instead
  of going from head to tail. This is simpler since we don’t have to stash
  a pointer to the next member, we always just use the last one in the
  queue until the queue is empty.

  Rename match functions that take a list to have list in the name. Break
  cmnd\_matches() into cmnd\_matches() and cmndlist\_matches.
  [[8cdea0b94]](https://git.sudo.ws/sudo/commit/?id=8cdea0b94)

* parse.c:

  Fix pasto, append “!” not negated (which is an int) for sudo -l output.
  [[a05abf5c8]](https://git.sudo.ws/sudo/commit/?id=a05abf5c8)

* Makefile.in:

  Remove the dependency of gram .h on gram.y, the .c dependency is enough.
  Only move y.tab.h to gram.h if it is different; avoids needless
  rebuilding.
  [[0e30ec199]](https://git.sudo.ws/sudo/commit/?id=0e30ec199)

2007-08-27 Todd C. Miller

* sudoers.pod:

  Defaults lines may be associated with lists of users, hosts, commands
  and runas users, not just single entries.
  [[aaacf16ee]](https://git.sudo.ws/sudo/commit/?id=aaacf16ee)

2007-08-26 Todd C. Miller

* Makefile.in:

  Revert the “cmp” portion of the last diff, it doesn’t make sense.
  [[cd6d9d7e1]](https://git.sudo.ws/sudo/commit/?id=cd6d9d7e1)

* Makefile.in:

  Remove \*.lo for clean: When generating the parser, only move the
  generated files into place if they differ from the existing ones.
  [[e90c32674]](https://git.sudo.ws/sudo/commit/?id=e90c32674)

2007-08-25 Todd C. Miller

* toke.c, toke.l:

  Replace IPV6 regexp with a much simpler (readable) one and add an extra
  check when it matches to make sure we have a valid address.
  [[51904f668]](https://git.sudo.ws/sudo/commit/?id=51904f668)

* match.c:

  Fix thinko introduced when merging IPV6 support.
  [[3fd33970c]](https://git.sudo.ws/sudo/commit/?id=3fd33970c)

2007-08-24 Todd C. Miller

* HISTORY, LICENSE:

  regen
  [[f9dd821b5]](https://git.sudo.ws/sudo/commit/?id=f9dd821b5)

* license.pod:

  add 2007
  [[eb8b3d6b5]](https://git.sudo.ws/sudo/commit/?id=eb8b3d6b5)

* UPGRADE:

  mention #uid vs. comment pitfall
  [[836d04019]](https://git.sudo.ws/sudo/commit/?id=836d04019)

* acsite.m4:

  Merge in a patch from the libtool cvs that fixes a problem with the
  latest autoconf. From Stepan Kasal.
  [[5f11011f0]](https://git.sudo.ws/sudo/commit/?id=5f11011f0)

* parse.h:

  Back out he XOR swap trick, it is slower than a temp variable on modern
  CPUs.
  [[b63a4c9db]](https://git.sudo.ws/sudo/commit/?id=b63a4c9db)

* gram.c:

  regen
  [[eb4b7b2e6]](https://git.sudo.ws/sudo/commit/?id=eb4b7b2e6)

* gram.y, parse.h:

  Convert the tail queue to a semi-circle queue and use the XOR swap trick
  to swap the prev pointers during append.
  [[6f732db02]](https://git.sudo.ws/sudo/commit/?id=6f732db02)

2007-08-23 Todd C. Miller

* parse.h:

  remove useless statement
  [[444e77946]](https://git.sudo.ws/sudo/commit/?id=444e77946)

* toke.c, toke.l:

  Refactor #include parsing into a separate function and return unparsed
  chars (such as newline or comment) back to the lexer.
  [[7cea15ef4]](https://git.sudo.ws/sudo/commit/?id=7cea15ef4)

2007-08-22 Todd C. Miller

* WHATSNEW:

  mention better uid support
  [[9cb10fc94]](https://git.sudo.ws/sudo/commit/?id=9cb10fc94)

* sudoers.pod:

  Users may now consist of a uid.
  [[94922dbae]](https://git.sudo.ws/sudo/commit/?id=94922dbae)

* gram.c, gram.h, toke.c:

  regen
  [[d65c8e827]](https://git.sudo.ws/sudo/commit/?id=d65c8e827)

* parse.c:

  Use lbuf\_append\_quoted() for sudo -l output to quote characters that
  would require quoting in sudoers.
  [[340831499]](https://git.sudo.ws/sudo/commit/?id=340831499)

* lbuf.c, lbuf.h:

  Add lbuf\_append\_quoted() which takes a set of characters which should be
  quoted with a backslash when displayed.
  [[14d1b79a4]](https://git.sudo.ws/sudo/commit/?id=14d1b79a4)

* toke.l:

  Require that the first character after a comment not be a digit or a
  dash. This allows us to remove the GOTRUNAS state and treat uid/gids
  similar to other words. It also means that we can now specify uids in
  User\_Lists and a User\_Spec may now contain a uid.
  [[0940a74e6]](https://git.sudo.ws/sudo/commit/?id=0940a74e6)

* gram.y, toke.l:

  Replace RUNAS token with ‘(’ and ‘)’ tokens to make the runas portion of
  the grammar more natural.
  [[add2fe024]](https://git.sudo.ws/sudo/commit/?id=add2fe024)

* BUGS:

  The BUGS file is history
  [[057d10a1e]](https://git.sudo.ws/sudo/commit/?id=057d10a1e)

* Makefile.in, README:

  The BUGS file is history
  [[58fd9b25b]](https://git.sudo.ws/sudo/commit/?id=58fd9b25b)

2007-08-21 Todd C. Miller

* toke.c, toke.l:

  Allow comments after a RunasAlias as long as the character after the
  pound sign isn’t a digit or a dash.
  [[53961224a]](https://git.sudo.ws/sudo/commit/?id=53961224a)

* WHATSNEW:

  Glob support was back-ported to 1.6.9
  [[fd0ea842f]](https://git.sudo.ws/sudo/commit/?id=fd0ea842f)

2007-08-20 Todd C. Miller

* Makefile.in:

  remove sudo\_usage.h in distclean
  [[68aac1b39]](https://git.sudo.ws/sudo/commit/?id=68aac1b39)

* parse.c:

  If a Defaults value contains a blank, double-quote the string.
  [[c6cf39cdf]](https://git.sudo.ws/sudo/commit/?id=c6cf39cdf)

* toke.c, toke.l:

  Properly deal with Defaults double-quoted strings that span multiple
  lines using the line continuation char. Previously, the entire thing,
  including the continuation char, newline, and spaces was stored as-is.
  [[9cf8213c2]](https://git.sudo.ws/sudo/commit/?id=9cf8213c2)

* sudo.c:

  Be consistent when using single quotes and backticks.
  [[fa6536920]](https://git.sudo.ws/sudo/commit/?id=fa6536920)

2007-08-19 Todd C. Miller

* Makefile.in, configure, configure.in, lbuf.c, lbuf.h, parse.c, sudo.c,
  sudo\_usage.h.in:

  Add new linebuf code to do appends of dynamically allocated strings and
  word-wrapped output. Currently used for sudo’s usage() and sudo -l
  output. Sudo usage strings are now in sudo\_usage.h which is generated at
  configure time.
  [[2315b317e]](https://git.sudo.ws/sudo/commit/?id=2315b317e)

2007-08-18 Todd C. Miller

* parse.c, sudo.c, sudo.h:

  Fix line wrapping in usage() and use the actual tty width instead of
  assuming 80.
  [[d28030c9f]](https://git.sudo.ws/sudo/commit/?id=d28030c9f)

2007-08-17 Todd C. Miller

* history.pod:

  some more info
  [[ccd780f99]](https://git.sudo.ws/sudo/commit/?id=ccd780f99)

* history.pod:

  Mentioned Chris Jepeway’s parser and also the new one that is in sudo
  1.7.
  [[0b43e9362]](https://git.sudo.ws/sudo/commit/?id=0b43e9362)

2007-08-16 Todd C. Miller

* sudo.pod, visudo.pod:

  For the options list, add flag args where appropriate and increase the
  indent level so there is room for them.
  [[28f814d12]](https://git.sudo.ws/sudo/commit/?id=28f814d12)

2007-08-15 Todd C. Miller

* parse.c:

  Fix some spacing in “sudo -l” and add a comment about some bogosity in
  the line wrapping.
  [[994036cf0]](https://git.sudo.ws/sudo/commit/?id=994036cf0)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in, visudo.cat,
  visudo.man.in:

  regen
  [[5ab2e0767]](https://git.sudo.ws/sudo/commit/?id=5ab2e0767)

* INSTALL, Makefile.in, WHATSNEW, config.h.in, configure.in, def\_data.c,
  def\_data.h, def\_data.in, gram.c, gram.h, gram.y, parse.c, parse.h,
  pathnames.h.in, sudo.c, sudo.h, sudoers.pod, testsudoers.c, toke.c,
  toke.l:

  Remove monitor support until there is a versino of systrace that uses a
  lookaside buffer (or we have a better mechanism to use).
  [[317e600f4]](https://git.sudo.ws/sudo/commit/?id=317e600f4)

* config.h.in, configure, configure.in, sudo.c:

  use getaddrinfo() instead of gethostbyname() if it is available
  [[72b36ddf5]](https://git.sudo.ws/sudo/commit/?id=72b36ddf5)

2007-08-14 Todd C. Miller

* parse.c, sudo.c:

  Deal with OSes where sizeof(gid\_t) < sizeof(int).
  [[c93969078]](https://git.sudo.ws/sudo/commit/?id=c93969078)

* interfaces.c:

  repair non-getifaddrs() code after ipv6 integration
  [[dd3e80180]](https://git.sudo.ws/sudo/commit/?id=dd3e80180)

* sudo.c:

  If we can open sudoers but fail to read the first byte, close the file
  stream before trying again.
  [[580be13e7]](https://git.sudo.ws/sudo/commit/?id=580be13e7)

2007-08-13 Todd C. Miller

* toke.c:

  regen
  [[b1845dcf1]](https://git.sudo.ws/sudo/commit/?id=b1845dcf1)

* gram.y, interfaces.c, interfaces.h, match.c, sudoers.pod, toke.l:

  Add IPv6 support; adapted from patches by YOSHIFUJI Hideaki
  [[d65602ca6]](https://git.sudo.ws/sudo/commit/?id=d65602ca6)

* sudo.pod, sudoers.pod, visudo.pod:

  Add some missing markup Update copyright
  [[0a96fe407]](https://git.sudo.ws/sudo/commit/?id=0a96fe407)

2007-08-12 Todd C. Miller

* configure, configure.in:

  fix sudo\_noexec extension which got broken in the libtool update
  [[f90beb2b2]](https://git.sudo.ws/sudo/commit/?id=f90beb2b2)

2007-08-10 Todd C. Miller

* Makefile.in:

  explicitly specify -Tascii to nroff
  [[cb68709a7]](https://git.sudo.ws/sudo/commit/?id=cb68709a7)

2007-08-08 Todd C. Miller

* logging.c:

  remove an ANSI-ism that crept in
  [[bcdddfc05]](https://git.sudo.ws/sudo/commit/?id=bcdddfc05)

2007-08-07 Todd C. Miller

* sudo.pod:

  Adjust list indents Prevent – from being turned into an em dash Use a
  list for the environment instead of a literal paragraph
  [[1ae60a557]](https://git.sudo.ws/sudo/commit/?id=1ae60a557)

* visudo.pod:

  Use a list for the environment instead of an indented literal paragraph.
  [[91f2696d1]](https://git.sudo.ws/sudo/commit/?id=91f2696d1)

* sudoers.pod:

  Adjust list indentation
  [[6c2448ed2]](https://git.sudo.ws/sudo/commit/?id=6c2448ed2)

* license.pod:

  add =head3
  [[977ff0d6a]](https://git.sudo.ws/sudo/commit/?id=977ff0d6a)

2007-08-06 Todd C. Miller

* sudo.pod:

  mention that when specifying a uid for the -u option the shell may
  require that the # be escaped
  [[1994a37c6]](https://git.sudo.ws/sudo/commit/?id=1994a37c6)

2007-08-02 Todd C. Miller

* match.c:

  Fix off by one in group matching.
  [[4fea71625]](https://git.sudo.ws/sudo/commit/?id=4fea71625)

2007-07-31 Todd C. Miller

* env.c:

  Fix typo: PYTHONINSPEC should be PYTHONINSPECT. From David Krause.
  [[17c8249fe]](https://git.sudo.ws/sudo/commit/?id=17c8249fe)

2007-07-30 Todd C. Miller

* configure, configure.in:

  Add missing define of HAVE\_GSS\_KRB5\_CCACHE\_NAME for the -lgssapi\_krb5
  case.
  [[4da496423]](https://git.sudo.ws/sudo/commit/?id=4da496423)

* aclocal.m4, configure, configure.in:

  Fix link tests such that new gcc doesn’t optimize away the test.
  [[e81f9efd1]](https://git.sudo.ws/sudo/commit/?id=e81f9efd1)

2007-07-29 Todd C. Miller

* sudo.pod, sudoers.pod, visudo.pod:

  add missing over/back
  [[a08b9a107]](https://git.sudo.ws/sudo/commit/?id=a08b9a107)

* sudo.pod, sudoers.pod, visudo.pod:

  Change FILES section to use =item
  [[c3a1e75b0]](https://git.sudo.ws/sudo/commit/?id=c3a1e75b0)

* env.c:

  Add back allocation of the env struct in rebuild\_env but save a copy of
  the old pointer and free it before returning.
  [[4b257e50c]](https://git.sudo.ws/sudo/commit/?id=4b257e50c)

* env.c:

  Don’t init the private environment in rebuild\_env() since it may have
  already been done implicitly sudo\_setenv/sudo\_unsetenv.

  Multiply length by sizeof(char \*) in memcpy/memmove when copying the
  environment so we copy the full thing.

  Add missing set of parens so we deref the right pointer in sudo\_unsetenv
  when searching for a matching variable.
  [[2304e1a4a]](https://git.sudo.ws/sudo/commit/?id=2304e1a4a)

2007-07-26 Todd C. Miller

* sudo.pod, sudoers.pod, visudo.pod:

  Use file markup for paths in the FILES section
  [[2e147dc73]](https://git.sudo.ws/sudo/commit/?id=2e147dc73)

* sudo.pod, sudoers.pod, visudo.pod:

  Don’t capitalize sudo/visudo
  [[e5cc89e01]](https://git.sudo.ws/sudo/commit/?id=e5cc89e01)

* sudoers.pod:

  Sort sudoers options; based on a diff from Igor Sobrado.
  [[b925712f9]](https://git.sudo.ws/sudo/commit/?id=b925712f9)

2007-07-25 Todd C. Miller

* sudo.pod, sudoers.pod, visudo.pod:

  Use 8 and 5 instead of @mansectsu@ and @mansectform@ since the
  latter confuses pod2man. The Makefile rules for the .man.in file will
  add @mansectsu@ and @mansectform@ back in after pod2man is done
  anyway.
  [[d947abaa3]](https://git.sudo.ws/sudo/commit/?id=d947abaa3)

2007-07-22 Todd C. Miller

* LICENSE, Makefile.in, license.pod:

  Move license info to pod format
  [[e0c31eef1]](https://git.sudo.ws/sudo/commit/?id=e0c31eef1)

* configure, configure.in, sudoers.pod:

  Substitute value of path\_info into sudoers man page.
  [[5c6880f1e]](https://git.sudo.ws/sudo/commit/?id=5c6880f1e)

* WHATSNEW:

  remove features that were back-ported to 1.6.9
  [[cd9aad660]](https://git.sudo.ws/sudo/commit/?id=cd9aad660)

* sudo.c, sudo.pod, visudo.c, visudo.pod:

  Sort SYNOPSIS and sync usage. From Igor Sobrado.
  [[5cd49e1e0]](https://git.sudo.ws/sudo/commit/?id=5cd49e1e0)

* env.c:

  Only need sudo\_setenv/sudo\_unsetenv if we are going to use
  ldap\_sasl\_interactive\_bind\_s() but don’t have gss\_krb5\_ccache\_name().
  [[c94a3d624]](https://git.sudo.ws/sudo/commit/?id=c94a3d624)

* ChangeLog:

  rebuild without branch info
  [[fd711b629]](https://git.sudo.ws/sudo/commit/?id=fd711b629)

* Makefile.in:

  Add ChangeLog target
  [[8aa5ba749]](https://git.sudo.ws/sudo/commit/?id=8aa5ba749)

* auth/pam.c:

  Run cleanup code if the user hits ^C at the password prompt.
  [[42ac4fb2c]](https://git.sudo.ws/sudo/commit/?id=42ac4fb2c)

* auth/pam.c:

  Some versions of pam\_lastlog have a bug that will cause a crash if
  PAM\_TTY is not set so if there is no tty, set PAM\_TTY to the empty
  string.
  [[b166928ba]](https://git.sudo.ws/sudo/commit/?id=b166928ba)

2007-07-20 Todd C. Miller

* Makefile.in:

  ChageLog not Changelog
  [[24ada438f]](https://git.sudo.ws/sudo/commit/?id=24ada438f)

* ChangeLog:

  sync
  [[5f0788597]](https://git.sudo.ws/sudo/commit/?id=5f0788597)

* Makefile.in:

  CHANGE -> Changelog
  [[1bbac967e]](https://git.sudo.ws/sudo/commit/?id=1bbac967e)

* TODO:

  sync
  [[641f34e30]](https://git.sudo.ws/sudo/commit/?id=641f34e30)

2007-07-19 Todd C. Miller

* config.h.in, configure, configure.in, ldap.c:

  Add configure hooks for gss\_krb5\_ccache\_name() and the gssapi headers.
  [[1f30bd424]](https://git.sudo.ws/sudo/commit/?id=1f30bd424)

2007-07-18 Todd C. Miller

* env.c, sudo.c:

  rebuild\_env() and insert\_env\_vars() no longer return environment
  pointer, they set environ directly.

  No longer need to pass around an envp pointer since we just operate on
  environ now.

  Add dosync argument to insert\_env() that indicates whether it should
  reset environ when realloc()ing env.envp.

  Use an initial size of 128 for the environment.
  [[8f0f4743f]](https://git.sudo.ws/sudo/commit/?id=8f0f4743f)

* env.c:

  Split sudo\_setenv() into an external version and a version only for use
  by rebuild\_env().
  [[8fa2eb187]](https://git.sudo.ws/sudo/commit/?id=8fa2eb187)

2007-07-16 Todd C. Miller

* ldap.c:

  Add support for using gss\_krb5\_ccache\_name() instead of setting
  KRB5CCNAME. Also use sudo\_unsetenv() in the non-gss\_krb5\_ccache\_name()
  case if there was no KRB5CCNAME in the original environment. TODO:
  configure setup for gss\_krb5\_ccache\_name()
  [[3a96b6de4]](https://git.sudo.ws/sudo/commit/?id=3a96b6de4)

* README.LDAP:

  add krb5\_ccname
  [[320ab55d5]](https://git.sudo.ws/sudo/commit/?id=320ab55d5)

* README.LDAP, ldap.c:

  Add support for sasl\_secprops in ldap.conf
  [[f5ad187ed]](https://git.sudo.ws/sudo/commit/?id=f5ad187ed)

* env.c, sudo.h:

  Add sudo\_unsetenv() and refactor private env syncing code into
  sync\_env().
  [[436e3b631]](https://git.sudo.ws/sudo/commit/?id=436e3b631)

* README.LDAP, ldap.c:

  The ldap.conf variable is sasl\_auth\_id not sasl\_authid.
  [[328a6b493]](https://git.sudo.ws/sudo/commit/?id=328a6b493)

2007-07-15 Todd C. Miller

* ldap.c, sudo.c, sudo.h:

  Add support for krb5\_ccname in ldap.conf. If specified, it will override
  the default value of KRB5CCNAME in the environment for the duration of
  the call to ldap\_sasl\_interactive\_bind\_s().
  [[af18ed5e9]](https://git.sudo.ws/sudo/commit/?id=af18ed5e9)

* env.c, sudo.h:

  Remove format\_env() Add sudo\_setenv() to replace most format\_env() +
  insert\_env() combinations. insert\_env() no longer takes a struct
  environment \*
  [[d1f6bdbcf]](https://git.sudo.ws/sudo/commit/?id=d1f6bdbcf)

* ldap.c:

  Fix use\_sasl vs. rootuse\_sasl logic.
  [[8cb8c55f9]](https://git.sudo.ws/sudo/commit/?id=8cb8c55f9)

* README.LDAP, config.h.in, configure, configure.in, ldap.c:

  Add support for SASL auth when connecting to an LDAP server. Adapted
  from a diff by Tom McLaughlin.
  [[5fdb0649b]](https://git.sudo.ws/sudo/commit/?id=5fdb0649b)

2007-07-14 Todd C. Miller

* configure, configure.in:

  Only enable AIX or BSD auth if no other exclusive auth method has been
  chosen. Allows people to e.g., use PAM on AIX without adding
  –without-aixauth. A better solution is needed to deal with default
  authentication since if a non-exclusive method is chosen we will still
  get an error.
  [[38b2dd0a5]](https://git.sudo.ws/sudo/commit/?id=38b2dd0a5)

2007-07-11 Todd C. Miller

* HISTORY, Makefile.in, history.pod:

  Generate HISTORY from history.pod (which is also used for web pages)
  [[39228bf9e]](https://git.sudo.ws/sudo/commit/?id=39228bf9e)

2007-07-09 Todd C. Miller

* sudo.man.in, sudoers.man.in:

  regen
  [[c0ffb8ce3]](https://git.sudo.ws/sudo/commit/?id=c0ffb8ce3)

* sudo.pod:

  Better explanation of environment handling in the sudo man page.
  [[e8dc37d79]](https://git.sudo.ws/sudo/commit/?id=e8dc37d79)

* env.c, sudo.c:

  Defer setting user-specified env vars until after authentication.
  [[6462c1edd]](https://git.sudo.ws/sudo/commit/?id=6462c1edd)

* env.c:

  honor def\_default\_path for PATH set on the command line
  [[25b624ce5]](https://git.sudo.ws/sudo/commit/?id=25b624ce5)

* env.c, sudo.c, sudo.pod, sudoers.pod:

  Allow user to set environment variables on the command line as long as
  they are allowed by env\_keep and env\_check. Ie: apply the same
  restrictions as normal environment variables. TODO: deal with
  secure\_path
  [[87a95bb3a]](https://git.sudo.ws/sudo/commit/?id=87a95bb3a)

2007-07-08 Todd C. Miller

* sudo.c, sudo\_edit.c:

  Call rebuild\_env() in call cases. Pass original envp to sudo\_edit().
  Don’t allow -E or env var setting in sudoedit mode. More accurate
  usage() when called as sudoedit.
  [[5919eb1fa]](https://git.sudo.ws/sudo/commit/?id=5919eb1fa)

* ldap.c:

  warn -> warning
  [[16166fc5e]](https://git.sudo.ws/sudo/commit/?id=16166fc5e)

* sudo.pod:

  add -c option to sudoedit synopsis
  [[c94ee11b6]](https://git.sudo.ws/sudo/commit/?id=c94ee11b6)

* TODO:

  udpate to reality
  [[b7927b2b3]](https://git.sudo.ws/sudo/commit/?id=b7927b2b3)

* parse.c:

  Use ALLOW/DENY instead of TRUE/FALSE when dealing with the return value
  from {user,host,runas,cmnd}\_matches(). Rename \*matches variables ->
  \*match. Purely cosmetic.
  [[888540a7b]](https://git.sudo.ws/sudo/commit/?id=888540a7b)

* parse.c:

  Move setting of FLAG\_NO\_CHECK into the if(pwflag) block. No change in
  behavior.
  [[1e9030d95]](https://git.sudo.ws/sudo/commit/?id=1e9030d95)

* sudoers:

  add SETENV tag
  [[b70cf25a3]](https://git.sudo.ws/sudo/commit/?id=b70cf25a3)

2007-07-06 Todd C. Miller

* parse.c:

  Make pwcheck local to the pwflag block. Use pwcheck even if user didn’t
  match since Defaults options may still apply.
  [[a26c783be]](https://git.sudo.ws/sudo/commit/?id=a26c783be)

* check.c, sudo.c:

  Do not update timestamp if user not validated by sudoers.
  [[6f1a9c0bc]](https://git.sudo.ws/sudo/commit/?id=6f1a9c0bc)

* set\_perms.c:

  for PERM\_RUNAS, set the egid to the runas user’s gid and restore to the
  user’s original in PERM\_ROOT
  [[988f44a60]](https://git.sudo.ws/sudo/commit/?id=988f44a60)

* logging.c, mon\_systrace.c, set\_perms.c, sudo.h:

  PERM\_FULL\_ROOT is now no different than PERM\_ROOT so remove
  PERM\_FULL\_ROOT
  [[f3ef73825]](https://git.sudo.ws/sudo/commit/?id=f3ef73825)

* check.c:

  don’t check timestamp mtime if we are just going to remove it
  [[af53e335a]](https://git.sudo.ws/sudo/commit/?id=af53e335a)

* sudoers.pod:

  Move sudoers defaults parameters into their own section.
  [[95df3fa67]](https://git.sudo.ws/sudo/commit/?id=95df3fa67)

* testsudoers.c:

  Reduce a level of indent by a few placed continue statements.
  [[45b311cfa]](https://git.sudo.ws/sudo/commit/?id=45b311cfa)

* parse.c:

  Make matching but negated commands/hosts/runas entries override a
  previous match as expected. Also reduce some levels of indent by a few
  placed continue statements.
  [[7f0bb4b1a]](https://git.sudo.ws/sudo/commit/?id=7f0bb4b1a)

2007-07-05 Todd C. Miller

* parse.c:

  Print default runas in “sudo -l” if sudoers don’t specify one.
  [[bdd5b43f7]](https://git.sudo.ws/sudo/commit/?id=bdd5b43f7)

* match.c:

  Less hacky way of testing whether the domain was set.
  [[6a8fb7115]](https://git.sudo.ws/sudo/commit/?id=6a8fb7115)

2007-07-04 Todd C. Miller

* INSTALL:

  Mention pam-devel and openldap-devel for Linux
  [[c21164d37]](https://git.sudo.ws/sudo/commit/?id=c21164d37)

2007-07-03 Todd C. Miller

* README.LDAP:

  or vs. are
  [[e5bb0bb97]](https://git.sudo.ws/sudo/commit/?id=e5bb0bb97)

2007-07-01 Todd C. Miller

* sudo.c:

  fix typo in Solaris project support
  [[3d321157a]](https://git.sudo.ws/sudo/commit/?id=3d321157a)

* HISTORY:

  update
  [[3c6c4677b]](https://git.sudo.ws/sudo/commit/?id=3c6c4677b)

* sudo.c:

  Make – on the command line match the manual page. The implied shell
  case has been simplified as a result.
  [[49b66be51]](https://git.sudo.ws/sudo/commit/?id=49b66be51)

2007-06-28 Todd C. Miller

* sudoers2ldif:

  add simplistic support for sudoRunas; note that if a sudoers entry
  contains multiple Runas users, all will apply to the sudoRole
  [[ad86ccfb1]](https://git.sudo.ws/sudo/commit/?id=ad86ccfb1)

* sudoers2ldif:

  honor SETENV and NOSETENV tags
  [[888a6d2e4]](https://git.sudo.ws/sudo/commit/?id=888a6d2e4)

2007-06-24 Todd C. Miller

* mon\_systrace.c:

  Redo setting of user\_args. We now build up a private copy of argv first
  and then replace the NULsÂ with spaces.
  [[9f49d28ea]](https://git.sudo.ws/sudo/commit/?id=9f49d28ea)

* mon\_systrace.c:

  getcwd() returns NULL on failure, not 0 on success
  [[a83e28b25]](https://git.sudo.ws/sudo/commit/?id=a83e28b25)

* mon\_systrace.c:

  allow chunksiz to reach 1 before erroring out
  [[2d76de6cd]](https://git.sudo.ws/sudo/commit/?id=2d76de6cd)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in, visudo.cat,
  visudo.man.in:

  regen
  [[b3b905ba5]](https://git.sudo.ws/sudo/commit/?id=b3b905ba5)

2007-06-23 Todd C. Miller

* def\_data.c, def\_data.h, def\_data.in, env.c, gram.c, gram.h, gram.y,
  logging.c, parse.c, parse.h, sudo.c, sudo.h, sudo.pod, sudoers.pod,
  toke.c, toke.l:

  Add support for setting environment variables on the command line. This
  is only allowed if the setenv sudoers options is enabled or if the
  command is prefixed with the SETENV tag.
  [[879c46e4d]](https://git.sudo.ws/sudo/commit/?id=879c46e4d)

* README.LDAP:

  replace Aaron’s email address with the sudo-workers list
  [[459c4bcd3]](https://git.sudo.ws/sudo/commit/?id=459c4bcd3)

* configure:

  regen
  [[0d4fe735a]](https://git.sudo.ws/sudo/commit/?id=0d4fe735a)

2007-06-22 Todd C. Miller

* schema.OpenLDAP, schema.iPlanet:

  Break schema out into separate files.
  [[ddeafc2bc]](https://git.sudo.ws/sudo/commit/?id=ddeafc2bc)

* Makefile.in, README.LDAP:

  Break schema out into separate files.
  [[d8d7657c5]](https://git.sudo.ws/sudo/commit/?id=d8d7657c5)

2007-06-21 Todd C. Miller

* auth/aix\_auth.c:

  free message if set by authenticate()
  [[fd7a9af87]](https://git.sudo.ws/sudo/commit/?id=fd7a9af87)

* match.c:

  deal with NULL gr\_mem
  [[ae2f7c77e]](https://git.sudo.ws/sudo/commit/?id=ae2f7c77e)

2007-06-20 Todd C. Miller

* config.h.in:

  regen
  [[f9a6950fb]](https://git.sudo.ws/sudo/commit/?id=f9a6950fb)

* configure.in:

  add template for HAVE\_PROJECT\_H
  [[5c22c694c]](https://git.sudo.ws/sudo/commit/?id=5c22c694c)

* closefrom.c:

  include fcntl.h
  [[2a8cda261]](https://git.sudo.ws/sudo/commit/?id=2a8cda261)

2007-06-19 Todd C. Miller

* INSTALL:

  mention –with-project
  [[ce963ef43]](https://git.sudo.ws/sudo/commit/?id=ce963ef43)

* config.h.in, configure.in, sudo.c:

  Add Solaris 10 “project” support. From Michael Brantley.
  [[60b7ac61b]](https://git.sudo.ws/sudo/commit/?id=60b7ac61b)

* sudoers.pod:

  fix typo
  [[459b9cb1d]](https://git.sudo.ws/sudo/commit/?id=459b9cb1d)

* configure:

  regen
  [[e0ae6e100]](https://git.sudo.ws/sudo/commit/?id=e0ae6e100)

* configure.in:

  Fix preservation of LDFLAGS in the LDAP case.
  [[d1702ca4c]](https://git.sudo.ws/sudo/commit/?id=d1702ca4c)

* memrchr.c:

  Remove dependecy on NULL
  [[5c59e9046]](https://git.sudo.ws/sudo/commit/?id=5c59e9046)

* configure:

  regen
  [[7f21fc74c]](https://git.sudo.ws/sudo/commit/?id=7f21fc74c)

* aclocal.m4, configure.in:

  Can’t use the regular autoconf fnmatch() check since we need
  FNM\_CASEFOLD so go back to our custom one.
  [[c154f0119]](https://git.sudo.ws/sudo/commit/?id=c154f0119)

* env.c:

  Fix preserving of variables in env\_keep.
  [[363a2f259]](https://git.sudo.ws/sudo/commit/?id=363a2f259)

* env.c:

  add XAUTHORIZATION
  [[f670ef29b]](https://git.sudo.ws/sudo/commit/?id=f670ef29b)

* UPGRADE:

  expand upon env resetting and mention that it began in 1.6.9 not 1.7.
  [[7d8b899e4]](https://git.sudo.ws/sudo/commit/?id=7d8b899e4)

* sudoers.pod:

  Update descriptions of env\_keep and env\_check to match current reality.
  [[a922ff68a]](https://git.sudo.ws/sudo/commit/?id=a922ff68a)

2007-06-18 Todd C. Miller

* env.c:

  Add LINGUAS to initial\_checkenv\_table. Add COLORS, HOSTNAME, LS\_COLORS,
  MAIL, PS1, PS2, XAUTHORITY to intial\_keepenv\_table.
  [[5ac9f1de5]](https://git.sudo.ws/sudo/commit/?id=5ac9f1de5)

* env.c, logging.c:

  Treat USERNAME environemnt variable like LOGNAME/USER
  [[c22566897]](https://git.sudo.ws/sudo/commit/?id=c22566897)

* env.c:

  Don’t need to populate keepenv table with the contents of the checkenv
  table.
  [[549c88d51]](https://git.sudo.ws/sudo/commit/?id=549c88d51)

* sudo.c:

  Don’t force sudo into the C locale.
  [[4dcaba90a]](https://git.sudo.ws/sudo/commit/?id=4dcaba90a)

* env.c:

  Make env\_check apply when env\_reset it true. Environment variables are
  passed through unless they contain ‘/’ or ‘%’. There is no need to have
  a variable in both env\_check and env\_keep.
  [[e096ae6f1]](https://git.sudo.ws/sudo/commit/?id=e096ae6f1)

2007-06-16 Todd C. Miller

* visudo.c:

  Remove an duplicate lock\_file() call and add a comment.
  [[db084676e]](https://git.sudo.ws/sudo/commit/?id=db084676e)

* UPGRADE:

  Add sudo 1.6.9 upgrade note.
  [[a162c1634]](https://git.sudo.ws/sudo/commit/?id=a162c1634)

2007-06-14 Todd C. Miller

* interfaces.c:

  Solaris will return EINVAL if the buffer used in SIOCGIFCONF is too
  small. From Klaus Wagner.
  [[f58f63770]](https://git.sudo.ws/sudo/commit/?id=f58f63770)

* logging.c, sudo.h:

  Redo the long syslog line splitting based on a patch from Eygene
  Ryabinkin. Include memrchr() for systems without it.
  [[49cb30aa5]](https://git.sudo.ws/sudo/commit/?id=49cb30aa5)

* memrchr.c:

  Redo the long syslog line splitting based on a patch from Eygene
  Ryabinkin. Include memrchr() for systems without it.
  [[889f928e5]](https://git.sudo.ws/sudo/commit/?id=889f928e5)

* Makefile.in, config.h.in, configure, configure.in:

  Redo the long syslog line splitting based on a patch from Eygene
  Ryabinkin. Include memrchr() for systems without it.
  [[c22096ac3]](https://git.sudo.ws/sudo/commit/?id=c22096ac3)

* configure.in:

  Since we need to be able to convert timespec to timeval for utimes() the
  last 3 digits in the tv\_nsec are not significant. This makes the
  sudoedit file date comparison work again.
  [[1f38301a5]](https://git.sudo.ws/sudo/commit/?id=1f38301a5)

2007-06-13 Todd C. Miller

* aclocal.m4, configure, configure.in:

  Add SUDO\_ADD\_AUTH macro to deal with adding things to AUTH\_OBJS. This
  deals with exclusive authentication methods in a simple way.
  [[4a7c81886]](https://git.sudo.ws/sudo/commit/?id=4a7c81886)

2007-06-12 Todd C. Miller

* LICENSE:

  mkstemp.c is BSD code too.
  [[927c229b9]](https://git.sudo.ws/sudo/commit/?id=927c229b9)

* sudo.pod, sudoers.pod, visudo.pod:

  No commercial support for now.
  [[3f2230617]](https://git.sudo.ws/sudo/commit/?id=3f2230617)

2007-06-11 Todd C. Miller

* sudo.c:

  cleanenv() is no more.
  [[7fb914ea0]](https://git.sudo.ws/sudo/commit/?id=7fb914ea0)

2007-06-10 Todd C. Miller

* ChangeLog:

  Display branch info in Changelog
  [[214f7d07f]](https://git.sudo.ws/sudo/commit/?id=214f7d07f)

* utimes.c:

  Include config.h early so we have it for TIME\_WITH\_SYS\_TIME
  [[ce92c1cf6]](https://git.sudo.ws/sudo/commit/?id=ce92c1cf6)

* ChangeLog:

  Fix Changelog generation and update.
  [[7b73bcbb8]](https://git.sudo.ws/sudo/commit/?id=7b73bcbb8)

2007-06-09 Todd C. Miller

* closefrom.c:

  Use /proc/self/fd instead of /proc/$$/fd

  Move old-style fd closing into closefrom\_fallback() and call that if
  /proc/self/fd doesn’t exist or the F\_CLOSEM fcntl() fails
  [[8ae409b8f]](https://git.sudo.ws/sudo/commit/?id=8ae409b8f)

* auth/kerb5.c, config.h.in, configure.in:

  o use krb5\_verify\_user() if available instead of doing it by hand o use
  krb5\_init\_secure\_context() if we have it o pass an encryption type of 0
  to krb5\_kt\_read\_service\_key() instead of ENCTYPE\_DES\_CBC\_MD5 to let
  kerberos choose.
  [[fc38e7c21]](https://git.sudo.ws/sudo/commit/?id=fc38e7c21)

* env.c:

  Check TERM and COLORTERM for ‘%’ and ‘/’ characters. From Debian.
  [[f221ba230]](https://git.sudo.ws/sudo/commit/?id=f221ba230)

* configure.in:

  Fix closefrom() substitution in the Makefile
  [[4d04baaee]](https://git.sudo.ws/sudo/commit/?id=4d04baaee)

* TROUBLESHOOTING:

  Mention alternate sudo pronunciation.
  [[7323cbb50]](https://git.sudo.ws/sudo/commit/?id=7323cbb50)

2007-06-07 Todd C. Miller

* env.c:

  Remove KRB5\_KTNAME from environment. Allow COLORTERM.
  [[30e57038d]](https://git.sudo.ws/sudo/commit/?id=30e57038d)

* auth/kerb5.c:

  If we cannot get a valid service key using the default keytab it is a
  fatal error. Fixes a bug where sudo could be tricked into allowing
  access when it should not by a fake KDC. From Thor Lancelot Simon.
  [[8d9732115]](https://git.sudo.ws/sudo/commit/?id=8d9732115)

2007-05-12 Todd C. Miller

* aclocal.m4, configure, configure.in:

  Update long long checks to use AC\_CHECK\_TYPES and to cache values.
  [[bd221e2eb]](https://git.sudo.ws/sudo/commit/?id=bd221e2eb)

* aclocal.m4, configure.in:

  Use AC\_FUNC\_FNMATCH instead of a homebrew fnmatch checker. We can’t use
  AC\_REPLACE\_FNMATCH since that assumes replacing with GNU fnmatch.
  [[1c824fb36]](https://git.sudo.ws/sudo/commit/?id=1c824fb36)

2007-05-11 Todd C. Miller

* configure, configure.in:

  Add closefrom() to LIB\_OBJS not SUDO\_OBJS if it is missing since we need
  it for visudo now too.
  [[1488331d7]](https://git.sudo.ws/sudo/commit/?id=1488331d7)

2007-04-24 Todd C. Miller

* sudoers.pod:

  Attempt to clarify the bit talking about network numbers w/o netmasks.
  [[0ea35c0d3]](https://git.sudo.ws/sudo/commit/?id=0ea35c0d3)

* sudo.pod:

  Clarify timestamp dir ownership sentence.
  [[af80a3e57]](https://git.sudo.ws/sudo/commit/?id=af80a3e57)

2007-04-20 Todd C. Miller

* auth/pam.c:

  Linux PAM now defines **LINUX\_PAM**, not \_\_LIBPAM\_VERSION. From Dmitry
  V. Levin.
  [[f2433e036]](https://git.sudo.ws/sudo/commit/?id=f2433e036)

2007-04-16 Todd C. Miller

* sudo.c:

  -i is also one of the mutually exclusive options to list it in the
  warning message. Noted by Chris Pepper.
  [[3f2b6b146]](https://git.sudo.ws/sudo/commit/?id=3f2b6b146)

2007-04-12 Todd C. Miller

* visudo.pod:

  The sudoers variable is env\_editor, not enveditor. From Jean-Francois
  Saucier.
  [[b679cb930]](https://git.sudo.ws/sudo/commit/?id=b679cb930)

2007-03-29 Todd C. Miller

* redblack.c:

  I tracked down the original author so credit him and include his license
  info.
  [[666c85dba]](https://git.sudo.ws/sudo/commit/?id=666c85dba)

2007-02-06 Todd C. Miller

* sudo.cat, sudo.man.in, sudo.pod, sudoers.cat, sudoers.man.in,
  sudoers.pod:

  Fix typos; from Jason McIntyre.
  [[7a96eb86e]](https://git.sudo.ws/sudo/commit/?id=7a96eb86e)

* logging.c:

  Restore signal mask before calling reapchild(). Fixes a possible race
  condition that could prevent sudo from properly waiting for the child.
  [[832f4c376]](https://git.sudo.ws/sudo/commit/?id=832f4c376)

2007-01-31 Todd C. Miller

* pwutil.c:

  Don’t declare pw\_free() if we are not going to use it.
  [[51d61f148]](https://git.sudo.ws/sudo/commit/?id=51d61f148)

* env.c:

  Add NOEXEC support for AIX 5.3 which supports LDR\_PRELOAD and
  LDR\_PRELOAD64. The 64-bit version is not currently supported. Remove
  zero\_env() prototype as it no longer exists.
  [[bf500a00d]](https://git.sudo.ws/sudo/commit/?id=bf500a00d)

2006-12-11 Todd C. Miller

* logging.c:

  Add “Auto-Submitted: auto-generated” line to sudo mail for rfc 3834.
  [[9d6695ed4]](https://git.sudo.ws/sudo/commit/?id=9d6695ed4)

2006-09-29 Todd C. Miller

* auth/pam.c:

  If the user enters ^C at the password prompt, abort instead of trying to
  authenticate with an empty password (which causes an annoying delay).
  [[8d97a8d20]](https://git.sudo.ws/sudo/commit/?id=8d97a8d20)

2006-08-17 Todd C. Miller

* closefrom.c, config.h.in, configure, configure.in:

  Add fcntl F\_CLOSEM support to closefrom(); adapted from a diff by Darren
  Tucker.
  [[cad6de7d7]](https://git.sudo.ws/sudo/commit/?id=cad6de7d7)

* pwutil.c:

  pw\_free() is only used by sudo\_freepwcache() so ifdef it out too.
  [[5994797e4]](https://git.sudo.ws/sudo/commit/?id=5994797e4)

2006-08-04 Todd C. Miller

* config.guess, config.sub:

  Update to latest versions from cvs.savannah.gnu.org
  [[6e9df267c]](https://git.sudo.ws/sudo/commit/?id=6e9df267c)

2006-07-31 Todd C. Miller

* pwutil.c, sudo\_edit.c:

  Move password/group cache cleaning out of sudo\_end{pw,grp}ent() so we
  can close the passwd/group files early.
  [[884b70acc]](https://git.sudo.ws/sudo/commit/?id=884b70acc)

* config.h.in, configure, configure.in, set\_perms.c:

  Add seteuid() flavor of set\_perms() for systems without setreuid() or
  setresuid() that have a working seteuid(). Tested on Darwin.
  [[ea8c5d5d2]](https://git.sudo.ws/sudo/commit/?id=ea8c5d5d2)

2006-07-30 Todd C. Miller

* mon\_systrace.c:

  systrace\_read() returns ssize\_t
  [[7276bf7b9]](https://git.sudo.ws/sudo/commit/?id=7276bf7b9)

* configure, configure.in:

  Fix typo, -lldap vs. -ldap; from Tim Knox.
  [[be3a220f7]](https://git.sudo.ws/sudo/commit/?id=be3a220f7)

2006-07-28 Todd C. Miller

* HISTORY:

  Fix typo; Matt Ackeret
  [[bbe7ab84b]](https://git.sudo.ws/sudo/commit/?id=bbe7ab84b)

2006-07-17 Todd C. Miller

* sudo.c:

  Print sudoers path in -V mode for root.
  [[c28a289f1]](https://git.sudo.ws/sudo/commit/?id=c28a289f1)

2006-06-15 Todd C. Miller

* ldap.c:

  Do a sub tree search instead of a base search (one level in the tree
  only) for sudo right objects. This allows system administrators to
  categorize the rights in a tree to make them easier to manage.
  [[296680928]](https://git.sudo.ws/sudo/commit/?id=296680928)

2005-12-28 Todd C. Miller

* sudo.pod:

  fix typo
  [[b6e3fb008]](https://git.sudo.ws/sudo/commit/?id=b6e3fb008)

2005-12-04 Todd C. Miller

* ldap.c:

  Convert GET\_OPT and GET\_OPTI to use just 2 args. Add timelimit and
  bind\_timelimit support; adapted from gentoo.
  [[7c588a014]](https://git.sudo.ws/sudo/commit/?id=7c588a014)

2005-11-23 Todd C. Miller

* ldap.c:

  Support comments that start in the middle of a line
  [[920c81168]](https://git.sudo.ws/sudo/commit/?id=920c81168)

* configure, configure.in:

  Define LDAP\_DEPRECATED until we start using ldap\_get\_values\_len()
  [[bce8fbdd6]](https://git.sudo.ws/sudo/commit/?id=bce8fbdd6)

2005-11-18 Todd C. Miller

* closefrom.c:

  Silence gcc -Wsign-compare; djm@…
  [[ab076942e]](https://git.sudo.ws/sudo/commit/?id=ab076942e)

* error.c, sudo.c, sudo.h, testsudoers.c, visudo.c:

  cleanup() now takes an int as an arg so it can be used as a signal
  handler too.
  [[2d282cd22]](https://git.sudo.ws/sudo/commit/?id=2d282cd22)

* sudo.c:

  Make a copy of the shell field in the passwd struct for NewArgv to avoid
  a use after free situation after sudo\_endpwent() is called.
  [[c7140895a]](https://git.sudo.ws/sudo/commit/?id=c7140895a)

2005-11-17 Todd C. Miller

* config.h.in, configure, configure.in:

  Add mkstemp() for those poor souls without it.
  [[8efcb4051]](https://git.sudo.ws/sudo/commit/?id=8efcb4051)

* mkstemp.c:

  Add mkstemp() for those poor souls without it.
  [[6ac7edb6e]](https://git.sudo.ws/sudo/commit/?id=6ac7edb6e)

* Makefile.in:

  Add mkstemp() for those poor souls without it.
  [[7a8ed8e07]](https://git.sudo.ws/sudo/commit/?id=7a8ed8e07)

2005-11-15 Todd C. Miller

* env.c:

  Add PERL5DB to list of environment variables to remove.
  [[be9d490e1]](https://git.sudo.ws/sudo/commit/?id=be9d490e1)

2005-11-13 Todd C. Miller

* mon\_systrace.c, mon\_systrace.h:

  Instead of calling the check function twice with a state cookie use
  separate check/log functions.

  Check more ioctl() calls for failure.

  systrace\_{read,write} now return the number of bytes read/written or -1
  on error.
  [[3553eee07]](https://git.sudo.ws/sudo/commit/?id=3553eee07)

* env.c:

  Add more environment variables to remove; from gentoo linux Add some
  comments about what bad env variables go to what (more to do)
  [[b9f34a5a3]](https://git.sudo.ws/sudo/commit/?id=b9f34a5a3)

2005-11-11 Todd C. Miller

* sudo.c, sudo\_edit.c:

  Move sudo\_end{gr,pw}ent() until just before the exec since they free up
  our cached copy of the passwd structs, including sudo\_user and
  sudo\_runas. Fixes a use-after-free bug.
  [[b2a32d13c]](https://git.sudo.ws/sudo/commit/?id=b2a32d13c)

* visudo.c:

  Close all fd’s before executing editor.
  [[0b3b32ab9]](https://git.sudo.ws/sudo/commit/?id=0b3b32ab9)

* sudo.c:

  Enable malloc debugging on OpenBSD when SUDO\_DEVEL is set.
  [[69c627658]](https://git.sudo.ws/sudo/commit/?id=69c627658)

* check.c:

  Fix fd leak when lecture file option is enabled. From Jerry Brown
  [[50004e00b]](https://git.sudo.ws/sudo/commit/?id=50004e00b)

2005-11-07 Todd C. Miller

* env.c:

  Add PERLLIB, PERL5LIB and PERL5OPT to the default list of environment
  variables to remove. From Charles Morris
  [[3c6d0cc87]](https://git.sudo.ws/sudo/commit/?id=3c6d0cc87)

2005-11-01 Todd C. Miller

* env.c:

  add JAVA\_TOOL\_OPTIONS to initial\_badenv\_table for java 5
  [[ce8f2b10e]](https://git.sudo.ws/sudo/commit/?id=ce8f2b10e)

2005-10-28 Todd C. Miller

* env.c:

  add PS4 and SHELLOPTS to initial\_badenv\_table for bash
  [[096a289d9]](https://git.sudo.ws/sudo/commit/?id=096a289d9)

2005-08-15 Todd C. Miller

* sudoers.pod:

  Fix typo; Toby Peterson
  [[2c3be532a]](https://git.sudo.ws/sudo/commit/?id=2c3be532a)

2005-08-02 Todd C. Miller

* tsgetgrpw.c:

  Make return buffers static so they don’t get clobbered
  [[f75830227]](https://git.sudo.ws/sudo/commit/?id=f75830227)

2005-07-28 Todd C. Miller

* auth/securid5.c:

  Fix securid5 authentication, was not checking for ACM\_OK. Also add
  default cases for the two switch()es. Problem noted by ccon at worldbank
  [[26523a7ce]](https://git.sudo.ws/sudo/commit/?id=26523a7ce)

2005-06-27 Todd C. Miller

* ldap.c:

  Remove ncat() in favor of just counting bytes and pre-allocating what is
  needed.
  [[4e86b1d74]](https://git.sudo.ws/sudo/commit/?id=4e86b1d74)

2005-06-26 Todd C. Miller

* ldap.c:

  Fix up some comments Add missing fclose() for the rootbinddn case
  [[73730b872]](https://git.sudo.ws/sudo/commit/?id=73730b872)

* ldap.c:

  align struct ldap\_config
  [[380d3c8c7]](https://git.sudo.ws/sudo/commit/?id=380d3c8c7)

* ldap.c:

  use LINE\_MAX for max conf file line size
  [[76f3c652d]](https://git.sudo.ws/sudo/commit/?id=76f3c652d)

* pathnames.h.in:

  add \_PATH\_LDAP\_SECRET
  [[e0ac56ae6]](https://git.sudo.ws/sudo/commit/?id=e0ac56ae6)

* README.LDAP:

  Mention rootbinddn Give example ou=SUDOers container
  [[69be47579]](https://git.sudo.ws/sudo/commit/?id=69be47579)

2005-06-25 Todd C. Miller

* INSTALL, configure, configure.in, ldap.c:

  Support rootbinddn in ldap.conf
  [[3b30d7514]](https://git.sudo.ws/sudo/commit/?id=3b30d7514)

* env.c, sudo.pod, sudoers.pod:

  Preserve DISPLAY environment variable by default.
  [[8f90cfbd8]](https://git.sudo.ws/sudo/commit/?id=8f90cfbd8)

* acsite.m4, configure:

  set need\_lib\_prefix=no for all cases; this is safe for LD\_PRELOAD
  [[485fa9b66]](https://git.sudo.ws/sudo/commit/?id=485fa9b66)

* acsite.m4, configure:

  set need\_version=no for all cases; this is safe for LD\_PRELOAD
  [[c09bfd638]](https://git.sudo.ws/sudo/commit/?id=c09bfd638)

* aclocal.m4:

  typo
  [[c8f360fd5]](https://git.sudo.ws/sudo/commit/?id=c8f360fd5)

* configure, configure.in:

  Add dragonfly
  [[1ddff1113]](https://git.sudo.ws/sudo/commit/?id=1ddff1113)

* auth/pam.c:

  Fix call to pam\_end() when pam\_open\_session() fails.
  [[d281ff77e]](https://git.sudo.ws/sudo/commit/?id=d281ff77e)

* configure:

  regen
  [[94ab74182]](https://git.sudo.ws/sudo/commit/?id=94ab74182)

* acsite.m4:

  rebuild acsite.m4 from libtool 1.9f libtool.m4 ltoptions.m4 ltsugar.m4
  ltversion.m4
  [[a2c030930]](https://git.sudo.ws/sudo/commit/?id=a2c030930)

* config.guess, config.sub, ltmain.sh:

  merge in local changes: config.guess: o better openbsd support
  config.sub: o hiuxmpp support ltmain.sh o remove requirement that libs
  must begin with “lib” o don’t print a bunch of crap about library
  installs o don’t run ldconfig
  [[f8b3770be]](https://git.sudo.ws/sudo/commit/?id=f8b3770be)

* config.guess, config.sub, ltmain.sh:

  libtool 1.9f
  [[37d8f4ee9]](https://git.sudo.ws/sudo/commit/?id=37d8f4ee9)

* configure.in:

  Update with autoupdate and make minor changes for libtool 1.9f
  [[95b9648ba]](https://git.sudo.ws/sudo/commit/?id=95b9648ba)

2005-06-23 Todd C. Miller

* parse.c:

  don’t call sudo\_ldap\_display\_cmnd if ldap not setup
  [[98931e0f8]](https://git.sudo.ws/sudo/commit/?id=98931e0f8)

* sudo\_edit.c, visudo.c:

  Move declatation of struct timespec to its own include files for systems
  without it since it needs time\_t defined.
  [[2566e6b7d]](https://git.sudo.ws/sudo/commit/?id=2566e6b7d)

* gettime.c:

  Move declatation of struct timespec to its own include files for systems
  without it since it needs time\_t defined.
  [[46230280c]](https://git.sudo.ws/sudo/commit/?id=46230280c)

* fileops.c:

  Move declatation of struct timespec to its own include files for systems
  without it since it needs time\_t defined.
  [[6cbaca026]](https://git.sudo.ws/sudo/commit/?id=6cbaca026)

* emul/timespec.h:

  Move declatation of struct timespec to its own include files for systems
  without it since it needs time\_t defined.
  [[ad5c04c90]](https://git.sudo.ws/sudo/commit/?id=ad5c04c90)

* check.c, compat.h:

  Move declatation of struct timespec to its own include files for systems
  without it since it needs time\_t defined.
  [[3bb5c181b]](https://git.sudo.ws/sudo/commit/?id=3bb5c181b)

* ldap.c:

  Don’t set safe\_cmnd for the “sudo ALL” case.
  [[9800e99ff]](https://git.sudo.ws/sudo/commit/?id=9800e99ff)

2005-05-27 Todd C. Miller

* auth/pam.c:

  Call pam\_open\_session() and pam\_close\_session() to give pam\_limits a
  chance to run. Idea from Karel Zak.
  [[d3b45ae3f]](https://git.sudo.ws/sudo/commit/?id=d3b45ae3f)

2005-04-24 Todd C. Miller

* check.c, sudo.c:

  Add explicit cast from mode\_t -> u\_int in printf to silence warnings on
  Solaris
  [[c7ea24f2c]](https://git.sudo.ws/sudo/commit/?id=c7ea24f2c)

* parse.c:

  include grp.h to silence a warning on Solaris
  [[7ce5994d6]](https://git.sudo.ws/sudo/commit/?id=7ce5994d6)

2005-04-23 Todd C. Miller

* parse.c:

  Fix printing of += and -= defaults.
  [[f1a095308]](https://git.sudo.ws/sudo/commit/?id=f1a095308)

2005-04-17 Todd C. Miller

* mon\_systrace.c:

  Sanity check number of syscall args with argsize. Not really needed but
  a little paranoia never hurts.
  [[56d72a3b8]](https://git.sudo.ws/sudo/commit/?id=56d72a3b8)

* mon\_systrace.c, mon\_systrace.h:

  Don’t do pointer arithmetic on void \* Use int, not size\_t/ssize\_t for
  systrace lengths (since it uses int)
  [[95c47e7f3]](https://git.sudo.ws/sudo/commit/?id=95c47e7f3)

2005-04-16 Todd C. Miller

* mon\_systrace.c:

  Add some memsets for paranoia Fix namespace collsion w/ error Check rval
  of decode\_args() and update\_env() Remove improper setting of validated
  variable
  [[fe9b65308]](https://git.sudo.ws/sudo/commit/?id=fe9b65308)

2005-04-12 Todd C. Miller

* parse.c, sudo.c, sudo.h:

  In -l mode, only check local sudoers file if def\_ignore\_sudoers is not
  set and call LDAP versions from display\_privs() and display\_cmnd()
  instead of directly from main(). Because of this we need to defer
  closing the ldap connection until after -l processing has ocurred and we
  must pass in the ldap pointer to display\_privs() and display\_cmnd().
  [[f261a99f2]](https://git.sudo.ws/sudo/commit/?id=f261a99f2)

* ldap.c:

  Reorganize LDAP code to better match normal sudoers parsing. Instead of
  storing strings for later printing in -l mode we do another query since
  the authenticating user and the user being listed may not be the same
  (the new -U flag). Also add support for “sudo -l command”.

  There is still a fair bit if duplicated code that can probably be
  refactored.
  [[fe4f33ab9]](https://git.sudo.ws/sudo/commit/?id=fe4f33ab9)

2005-04-11 Todd C. Miller

* ldap.c:

  Replace pass variable with do\_netgr for better readability.
  [[b8cbf50a3]](https://git.sudo.ws/sudo/commit/?id=b8cbf50a3)

* ldap.c:

  use DPRINTF macro
  [[3f84e1b18]](https://git.sudo.ws/sudo/commit/?id=3f84e1b18)

* ldap.c:

  estrdup, not strdup
  [[f1d67a9b3]](https://git.sudo.ws/sudo/commit/?id=f1d67a9b3)

2005-04-10 Todd C. Miller

* parse.c:

  Add macro to test if the tag changed to improve readability.
  [[d0df82a93]](https://git.sudo.ws/sudo/commit/?id=d0df82a93)

* parse.c:

  Avoid printing defaults header if there are no defaults to print…
  [[ce7708e09]](https://git.sudo.ws/sudo/commit/?id=ce7708e09)

* glob.c:

  Fix a warning on systems without strlcpy().
  [[132a79945]](https://git.sudo.ws/sudo/commit/?id=132a79945)

* pwutil.c:

  Use macros where possible for sudo\_grdup() like sudo\_pwdup().
  [[06a11acf1]](https://git.sudo.ws/sudo/commit/?id=06a11acf1)

2005-04-08 Todd C. Miller

* utimes.c:

  It is possible for tv\_usec to hold >= 1000000 usecs so add in tv\_usec /
  1000000.
  [[f057686d2]](https://git.sudo.ws/sudo/commit/?id=f057686d2)

2005-03-30 Todd C. Miller

* auth/kerb5.c:

  The component in krb5\_principal\_get\_comp\_string() should be 1, not 0 for
  Heimdal. From Alex Plotnick.
  [[d857334e6]](https://git.sudo.ws/sudo/commit/?id=d857334e6)

2005-03-29 Todd C. Miller

* alias.c, alloc.c, check.c, defaults.c, find\_path.c, gram.c, gram.y,
  interfaces.c, ldap.c, logging.c, match.c, mon\_systrace.c, pwutil.c,
  redblack.c, sudo.c, sudo.h, toke.c, toke.l, visudo.c:

  Add efree() for consistency with emalloc() et al. Allows us to rely on
  C89 behavior (free(NULL) is valid) even on K&R.
  [[304dc46d7]](https://git.sudo.ws/sudo/commit/?id=304dc46d7)

* parse.c, sudo.c:

  Move initgroups() for -U option into display\_privs() so group matching
  in sudoers works correctly.
  [[9efe91fa1]](https://git.sudo.ws/sudo/commit/?id=9efe91fa1)

2005-03-27 Todd C. Miller

* ldap.c:

  Removed duplicate call to ldap\_unbind\_s introduced along with
  sudo\_ldap\_close.
  [[e3c99d9c8]](https://git.sudo.ws/sudo/commit/?id=e3c99d9c8)

* parse.c:

  Add missing space in Defaults printing
  [[61413ca50]](https://git.sudo.ws/sudo/commit/?id=61413ca50)

2005-03-25 Todd C. Miller

* pwutil.c:

  Sync sudo\_pwdup with OpenBSD changes: use macros for size computaton and
  string copies.
  [[f78ce5517]](https://git.sudo.ws/sudo/commit/?id=f78ce5517)

2005-03-19 Todd C. Miller

* pwutil.c:

  Zero old pw\_passwd before replacing with version from shadow file.
  [[ca7c43574]](https://git.sudo.ws/sudo/commit/?id=ca7c43574)

* configure, configure.in:

  Only attempt shadow password detection if PAM is not being used Add
  shadow\_\* variables to make shadow password detection more generic.
  [[6666ca23d]](https://git.sudo.ws/sudo/commit/?id=6666ca23d)

* configure.in:

  Use OSDEFS for os-specific -D\_FOO\_BAR stuff rather than CPPFLAGS
  [[0a795b83d]](https://git.sudo.ws/sudo/commit/?id=0a795b83d)

2005-03-13 Todd C. Miller

* sudoers.pod:

  use a non-breaking space to avoid a double space after e.g.
  [[244eae916]](https://git.sudo.ws/sudo/commit/?id=244eae916)

* sudo.pod:

  commna, not colon after e.g.
  [[963ca5045]](https://git.sudo.ws/sudo/commit/?id=963ca5045)

2005-03-12 Todd C. Miller

* sudo\_noexec.c:

  Add \_\_ variants of the exec functions. GNU libc at least uses \_\_execve()
  internally.
  [[00bea5e74]](https://git.sudo.ws/sudo/commit/?id=00bea5e74)

* indent.pro:

  Match reality a bit more.
  [[5a7ab7e63]](https://git.sudo.ws/sudo/commit/?id=5a7ab7e63)

* pwutil.c:

  Missed piece from rev. 1.6, fix sudo\_getpwnam() too.
  [[bb63e0168]](https://git.sudo.ws/sudo/commit/?id=bb63e0168)

* pwutil.c:

  Store shadow password after making a local copy of struct passwd in case
  normal and shadow routines use the same internal buffer in libc.
  [[0ea568c7d]](https://git.sudo.ws/sudo/commit/?id=0ea568c7d)

2005-03-11 Todd C. Miller

* alloc.c, logging.c:

  Make varargs usage consistent with the rest of the code.
  [[e7dcda792]](https://git.sudo.ws/sudo/commit/?id=e7dcda792)

2005-03-10 Todd C. Miller

* sudo\_noexec.c:

  Wrap more of the exec family since on Linux the others do not appear to
  go through the normal execve() path.
  [[7362b7e98]](https://git.sudo.ws/sudo/commit/?id=7362b7e98)

* visudo.c:

  make print\_unused static like proto says
  [[d4b745759]](https://git.sudo.ws/sudo/commit/?id=d4b745759)

* glob.c:

  silence a warning on K&R systems
  [[b980f9588]](https://git.sudo.ws/sudo/commit/?id=b980f9588)

* alias.c, error.c:

  make this build in K&R land
  [[40b899b10]](https://git.sudo.ws/sudo/commit/?id=40b899b10)

* parse.c:

  make this build in K&R land
  [[f35ff3e32]](https://git.sudo.ws/sudo/commit/?id=f35ff3e32)

2005-03-08 Todd C. Miller

* toke.c:

  regen
  [[5e060faa3]](https://git.sudo.ws/sudo/commit/?id=5e060faa3)

2005-03-06 Todd C. Miller

* ldap.c:

  return(foo) not return foo optimize \_atobool() slightly
  [[ddb8c3d7d]](https://git.sudo.ws/sudo/commit/?id=ddb8c3d7d)

* ldap.c:

  Use TRUE/FALSE
  [[474768bd5]](https://git.sudo.ws/sudo/commit/?id=474768bd5)

* ldap.c:

  Reformat to match the rest of sudo’s code.
  [[3154a75b8]](https://git.sudo.ws/sudo/commit/?id=3154a75b8)

* sudo.pod:

  I am the primary author
  [[abc10fd9a]](https://git.sudo.ws/sudo/commit/?id=abc10fd9a)

2005-02-23 Todd C. Miller

* Makefile.in, README, RUNSON:

  The RUNSON file is toast–it confused too many people and really isn’t
  needed in a configure-oriented world.
  [[b5e92527c]](https://git.sudo.ws/sudo/commit/?id=b5e92527c)

* INSTALL:

  alternate -> alternative
  [[33d0e5128]](https://git.sudo.ws/sudo/commit/?id=33d0e5128)

* tgetpass.c:

  Use TCSADRAIN instead of TCSAFLUSH since some OSes have issues with
  TCSAFLUSH.
  [[7facbeeed]](https://git.sudo.ws/sudo/commit/?id=7facbeeed)

* toke.l:

  Allow leading blanks before Defaults and Foo\_Alias definitions
  [[470a4b549]](https://git.sudo.ws/sudo/commit/?id=470a4b549)

* Makefile.in:

  fix rules to build toke.o and gram.o in devel mode
  [[444b6fbf8]](https://git.sudo.ws/sudo/commit/?id=444b6fbf8)

2005-02-20 Todd C. Miller

* sudoers.pod:

  env\_keep overrides set\_logname
  [[9805bdd7f]](https://git.sudo.ws/sudo/commit/?id=9805bdd7f)

* env.c:

  Fix disabling set\_logname and make env\_keep override set\_logname.
  [[2791a1807]](https://git.sudo.ws/sudo/commit/?id=2791a1807)

* compat.h, config.h.in, configure, configure.in:

  No longer need memmove()
  [[c2f6b93ad]](https://git.sudo.ws/sudo/commit/?id=c2f6b93ad)

* env.c, sudo.c:

  Just clean the environment once. This assumes that any further
  setenv/putenv will be able to handle the fact that we replaced environ
  with our own malloc’d copy but all the implementations I’ve checked do.
  [[6bee8e377]](https://git.sudo.ws/sudo/commit/?id=6bee8e377)

2005-02-16 Todd C. Miller

* env.c, sudo.c:

  In -i mode, base the value of insert\_env()’s dupcheck flag on DID\_FOO
  flags. Move checks for $HOME resetting into rebuild\_env()
  [[87a8b5b48]](https://git.sudo.ws/sudo/commit/?id=87a8b5b48)

2005-02-13 Todd C. Miller

* env.c, sudo.c:

  Move setting of user\_path, user\_shell, user\_prompt and prev\_user into
  init\_vars() since user\_shell at least is needed there.
  [[74894ebf6]](https://git.sudo.ws/sudo/commit/?id=74894ebf6)

2005-02-12 Todd C. Miller

* Makefile.in:

  fix devel builds
  [[e2a517d88]](https://git.sudo.ws/sudo/commit/?id=e2a517d88)

* sudo.c:

  Fix some printf format mismatches on error.
  [[b7068a413]](https://git.sudo.ws/sudo/commit/?id=b7068a413)

* check.c:

  Fix some printf format mismatches on error.
  [[cc84c41fb]](https://git.sudo.ws/sudo/commit/?id=cc84c41fb)

* configure, gram.c, toke.c:

  regen
  [[889a0334e]](https://git.sudo.ws/sudo/commit/?id=889a0334e)

* Makefile.in, aclocal.m4, alias.c, alloc.c, auth/afs.c, auth/aix\_auth.c,
  auth/bsdauth.c, auth/dce.c, auth/fwtk.c, auth/kerb4.c, auth/kerb5.c,
  auth/pam.c, auth/passwd.c, auth/rfc1938.c, auth/secureware.c,
  auth/securid.c, auth/securid5.c, auth/sia.c, auth/sudo\_auth.c,
  auth/sudo\_auth.h, check.c, closefrom.c, compat.h, configure.in,
  defaults.c, defaults.h, emul/utime.h, env.c, error.c, fileops.c,
  find\_path.c, getprogname.c, getspwuid.c, gettime.c, goodpath.c, gram.y,
  interfaces.c, interfaces.h, ldap.c, logging.c, logging.h, match.c,
  mon\_systrace.c, parse.c, redblack.c, redblack.h, set\_perms.c,
  sigaction.c, snprintf.c, strcasecmp.c, strerror.c, strlcat.c, strlcpy.c,
  sudo.c, sudo.h, sudo.pod, sudo\_edit.c, sudo\_noexec.c, sudoers.pod,
  testsudoers.c, tgetpass.c, toke.l, utimes.c, version.h, visudo.c,
  visudo.pod, zero\_bytes.c:

  Update copyright years.
  [[778d58706]](https://git.sudo.ws/sudo/commit/?id=778d58706)

* Makefile.binary.in:

  Update copyright years.
  [[fd0c93bbe]](https://git.sudo.ws/sudo/commit/?id=fd0c93bbe)

* LICENSE:

  Update copyright years.
  [[f02f4b428]](https://git.sudo.ws/sudo/commit/?id=f02f4b428)

* BUGS, INSTALL, INSTALL.binary, Makefile.in, README, configure.in:

  version 1.7
  [[cd6a11b81]](https://git.sudo.ws/sudo/commit/?id=cd6a11b81)

* WHATSNEW:

  What’s new in sudo 1.7, based on the 1.7 CHANGES entries.
  [[93cc79642]](https://git.sudo.ws/sudo/commit/?id=93cc79642)

2005-02-11 Todd C. Miller

* compat.h, logging.h, sudo.h:

  Add \_\_printflike and use it with gcc to warn about printf-like format
  mismatches
  [[b3b65fb7f]](https://git.sudo.ws/sudo/commit/?id=b3b65fb7f)

2005-02-10 Todd C. Miller

* CHANGES, ChangeLog:

  Replaced CHANGES file with ChangeLog generated from cvs logs
  [[8d74dc1de]](https://git.sudo.ws/sudo/commit/?id=8d74dc1de)

* set\_perms.c:

  Use warning/error instead of perror/fatal.
  [[31968c368]](https://git.sudo.ws/sudo/commit/?id=31968c368)

* config.guess:

  Update OpenBSD section
  [[2b48e0dc4]](https://git.sudo.ws/sudo/commit/?id=2b48e0dc4)

* UPGRADE:

  Add upgrading noted for 1.7
  [[a50e709a3]](https://git.sudo.ws/sudo/commit/?id=a50e709a3)

* env.c, sudo.c, sudoers.pod:

  Instead of zeroing out the environment, just prune out entries based on
  the env\_delete and env\_check lists. Base building up the new environment
  on the current environment and the variables we removed initially.
  [[ab2e7bc26]](https://git.sudo.ws/sudo/commit/?id=ab2e7bc26)

* config.h.in, configure, configure.in, sudo.c:

  Set locale to “C” if locales are supported, just to be safe.
  [[0b315c10d]](https://git.sudo.ws/sudo/commit/?id=0b315c10d)

* toke.c, toke.l:

  CastÂ argument to ctype functions to unsigned char.
  [[ab2439a44]](https://git.sudo.ws/sudo/commit/?id=ab2439a44)

2005-02-08 Todd C. Miller

* env.c:

  correct value for DID\_USER
  [[f015a51b9]](https://git.sudo.ws/sudo/commit/?id=f015a51b9)

* error.c, fnmatch.c, getcwd.c, glob.c, snprintf.c:

  #include <compat.h> not “compat.h”
  [[b950f2807]](https://git.sudo.ws/sudo/commit/?id=b950f2807)

* defaults.c:

  Reset the environment by default.
  [[280540521]](https://git.sudo.ws/sudo/commit/?id=280540521)

* sudo.c:

  Alloc an extra slot in NewArgv. Removes the need to malloc an new vector
  if execve() fails.
  [[d27f06b5f]](https://git.sudo.ws/sudo/commit/?id=d27f06b5f)

2005-02-07 Todd C. Miller

* INSTALL, config.h.in, configure, configure.in, sudo.c:

  Use execve(2) and wrap the command in sh if we get ENOEXEC.
  [[9a890467a]](https://git.sudo.ws/sudo/commit/?id=9a890467a)

2005-02-06 Todd C. Miller

* sudo\_noexec.c:

  Only include time.h on systems that lack struct timespec which gets
  defind in compat.h (using time\_t).
  [[cea03b5e8]](https://git.sudo.ws/sudo/commit/?id=cea03b5e8)

* sudo\_noexec.c:

  Include time.h for time\_t in compat.h for systems w/o struct timespec.
  [[90d2f5f50]](https://git.sudo.ws/sudo/commit/?id=90d2f5f50)

* compat.h, config.h.in, configure, configure.in:

  use bcopy on systems w/o memmove
  [[f780611c3]](https://git.sudo.ws/sudo/commit/?id=f780611c3)

* compat.h:

  **attribute**((**unused**)) doesn’t work in gcc 2.7.2.1 so limit its use
  to gcc >= 2.8.
  [[8f0c64f67]](https://git.sudo.ws/sudo/commit/?id=8f0c64f67)

* Makefile.in:

  Add explicit rule to build sudo\_noexec.lo
  [[550e8f5a5]](https://git.sudo.ws/sudo/commit/?id=550e8f5a5)

2005-02-05 Todd C. Miller

* INSTALL.configure, Makefile.in:

  No longer depend on VPATH; pointed out a bunch of missed dependencies.
  [[c20f64d2f]](https://git.sudo.ws/sudo/commit/?id=c20f64d2f)

* TROUBLESHOOTING:

  Help for PAM when account section is missing
  [[b2f7e61ff]](https://git.sudo.ws/sudo/commit/?id=b2f7e61ff)

* auth/pam.c:

  Give user a clue when there is a missing “account” section in the PAM
  config.
  [[6548e82f2]](https://git.sudo.ws/sudo/commit/?id=6548e82f2)

* auth/pam.c:

  Better error handling.
  [[e6f51aa1a]](https://git.sudo.ws/sudo/commit/?id=e6f51aa1a)

* config.h.in, configure, configure.in:

  Move \_FOO\_SOURCE to CPPFLAGS so it takes effect as early as possible.
  Silences a warning about isblank() on linux.
  [[e166c1b11]](https://git.sudo.ws/sudo/commit/?id=e166c1b11)

* auth/pam.c:

  Fix typo (missing comma) that caused an incorrect number of args to be
  passed to log\_error().
  [[f7adbaddc]](https://git.sudo.ws/sudo/commit/?id=f7adbaddc)

2005-02-01 Todd C. Miller

* pwutil.c:

  Don’t try to destroy a tree we didn’t create.
  [[543fe6e7d]](https://git.sudo.ws/sudo/commit/?id=543fe6e7d)

2005-01-27 Todd C. Miller

* alias.c, alloc.c, auth/afs.c, auth/aix\_auth.c, auth/bsdauth.c,
  auth/dce.c, auth/fwtk.c, auth/kerb4.c, auth/kerb5.c, auth/pam.c,
  auth/passwd.c, auth/rfc1938.c, auth/secureware.c, auth/securid.c,
  auth/securid5.c, auth/sia.c, auth/sudo\_auth.c, check.c, closefrom.c,
  compat.h, defaults.c, env.c, error.c, fileops.c, find\_path.c, fnmatch.c,
  getcwd.c, getprogname.c, getspwuid.c, gettime.c, goodpath.c, gram.c,
  gram.y, interfaces.c, ldap.c, logging.c, match.c, mon\_systrace.c,
  parse.c, pwutil.c, set\_perms.c, sigaction.c, snprintf.c, strcasecmp.c,
  strerror.c, strlcat.c, strlcpy.c, sudo.c, sudo\_edit.c, sudo\_noexec.c,
  testsudoers.c, tgetpass.c, toke.c, toke.l, utimes.c, visudo.c,
  zero\_bytes.c:

  Add \_\_unused to rcsids
  [[3b8b88407]](https://git.sudo.ws/sudo/commit/?id=3b8b88407)

2005-01-21 Todd C. Miller

* configure, configure.in:

  Fix error message when mixing invalid auth types
  [[c2dad169f]](https://git.sudo.ws/sudo/commit/?id=c2dad169f)

* INSTALL:

  PAM, AIX auth, BSD auth and login\_cap are now on by default if the OS
  supports them.
  [[f751d934d]](https://git.sudo.ws/sudo/commit/?id=f751d934d)

* auth/sudo\_auth.h, config.h.in:

  s/HAVE\_AUTHENTICATE/HAVE\_AIXAUTH/g
  [[2dc559bf3]](https://git.sudo.ws/sudo/commit/?id=2dc559bf3)

* configure.in:

  Better checking for conflicting authentication methods Display the
  authentication methods used at the end of configure Rename
  –with-authenticate -> –with-aixauth Use –with-aixauth,
  –with-bsdauth, –with-pam, –with-logincap by default on systems that
  support them unless disabled. Add OSMAJOR variable that replaces old
  OSREV; now OSREV has full version number
  [[609a615f8]](https://git.sudo.ws/sudo/commit/?id=609a615f8)

2005-01-18 Todd C. Miller

* def\_data.c, def\_data.in, sudo.c, sudoers.pod:

  s/-O/-C/
  [[840d51a16]](https://git.sudo.ws/sudo/commit/?id=840d51a16)

2005-01-14 Todd C. Miller

* configure.in:

  Replace: test -n “$FOO” || FOO=“bar”

  With: : ${FOO=‘bar’}
  [[2e8e96346]](https://git.sudo.ws/sudo/commit/?id=2e8e96346)

2005-01-09 Todd C. Miller

* pwutil.c, testsudoers.c, tsgetgrpw.c:

  Use function pointers to only call private passwd/group routines when
  using a nonstandard passwd/group file.
  [[7ca844890]](https://git.sudo.ws/sudo/commit/?id=7ca844890)

2005-01-06 Todd C. Miller

* CHANGES:

  sync
  [[e7f2e2a19]](https://git.sudo.ws/sudo/commit/?id=e7f2e2a19)

* tsgetgrpw.c:

  Can’t use strtok() since it doesn’t handle empty fields so add
  getpwent()/getgrent() functions and call those.
  [[b8c4e2770]](https://git.sudo.ws/sudo/commit/?id=b8c4e2770)

2005-01-05 Todd C. Miller

* Makefile.in:

  Fix dummied out toke.c and gram.c dependencies.
  [[2fd0f3d4c]](https://git.sudo.ws/sudo/commit/?id=2fd0f3d4c)

* Makefile.in:

  Rename PARSESRCS -> GENERATED since it is only used in the clean target
  Add devdir variable and use it to specify the path to parser sources
  [[ba001795e]](https://git.sudo.ws/sudo/commit/?id=ba001795e)

* configure:

  regen
  [[031a3ef55]](https://git.sudo.ws/sudo/commit/?id=031a3ef55)

* configure.in:

  Add a devdir variables that defaults to $(srcdir) and is set to . if
  –devel was specified. Allows for proper dependecies building the
  parser.
  [[1fb59a25c]](https://git.sudo.ws/sudo/commit/?id=1fb59a25c)

* testsudoers.c:

  Add support for custom passwd/group files.
  [[5e475c85b]](https://git.sudo.ws/sudo/commit/?id=5e475c85b)

* Makefile.in:

  Build private copy of pwutil.o for testsudoers with MYPW defined so it
  uses our own passwd/group routines.
  [[66773d1b6]](https://git.sudo.ws/sudo/commit/?id=66773d1b6)

* visudo.c:

  Remove sudo\_*{pw,gr}* stubs and add sudo\_setspent/sudo\_endspent stubs
  instead. We can now just use the caching sudo\_*{pw,gr}* functions in
  pwutil.c Add comment about wanting to call sudo\_endpwent/sudo\_endgrent
  in cleanup()
  [[0ab0ad244]](https://git.sudo.ws/sudo/commit/?id=0ab0ad244)

* tsgetgrpw.c:

  Remove caching; we will just use what is in pwutil.c Use global buffers
  for passwd/group structs Rename functions from sudo\_\* to my\_\*
  [[13cc08779]](https://git.sudo.ws/sudo/commit/?id=13cc08779)

* logging.c, sudo.c:

  g/c pwcache\_init/pwcache\_destroy
  [[dfccf1933]](https://git.sudo.ws/sudo/commit/?id=dfccf1933)

* sudo.h:

  Undo last commit and add sudo\_setspent and sudo\_endspent instead.
  [[54db5e40b]](https://git.sudo.ws/sudo/commit/?id=54db5e40b)

* getspwuid.c, pwutil.c:

  Move all but the shadow stuff from getspwuid.c to pwutil.c and
  pwcache\_get and pwcache\_put as they are no longer needed. Also add
  preprocessor magic to use private versions of the passwd and group
  routines if MYPW is defined (for use by testsudoers).
  [[308b6fa11]](https://git.sudo.ws/sudo/commit/?id=308b6fa11)

* tsgetgrpw.c:

  zero out struct passwd/group before filling it in so if there are fields
  we don’t handle they end up as 0.
  [[516ff2977]](https://git.sudo.ws/sudo/commit/?id=516ff2977)

* logging.c, sudo.c, sudo.h, testsudoers.c, visudo.c:

  Adapt to pwutil.c
  [[a5d9296d2]](https://git.sudo.ws/sudo/commit/?id=a5d9296d2)

* Makefile.in:

  Add tsgetgrpw.c and pwutil.c Rename the \*OBJ variables for better
  readability.
  [[3c58acdc0]](https://git.sudo.ws/sudo/commit/?id=3c58acdc0)

* tsgetgrpw.c:

  Passwd and group lookup routines for testsudoers that support alternate
  passwd and group files.
  [[31fd279da]](https://git.sudo.ws/sudo/commit/?id=31fd279da)

* getspwuid.c, pwutil.c:

  Split off pw/gr cache and dup code into its own file. This allows visudo
  and testsudoers to use the pw/gr cache too.
  [[282c0bf36]](https://git.sudo.ws/sudo/commit/?id=282c0bf36)

2005-01-02 Todd C. Miller

* parse.c:

  Print Defaults info in “sudo -l” output and wrap lines based on the
  terminal width.
  [[ed4df3a94]](https://git.sudo.ws/sudo/commit/?id=ed4df3a94)

2005-01-01 Todd C. Miller

* match.c, testsudoers.c, visudo.c:

  Only check group vector in usergr\_matches() if we are matching the
  invoking or list user. Always check the group members, even if there was
  a group vector.
  [[a58012cff]](https://git.sudo.ws/sudo/commit/?id=a58012cff)

2004-12-17 Todd C. Miller

* LICENSE, Makefile.in, fnmatch.3:

  No longer bundle fnmatch.3
  [[39ddb7716]](https://git.sudo.ws/sudo/commit/?id=39ddb7716)

* CHANGES, TODO:

  checkpoint
  [[e05905dd1]](https://git.sudo.ws/sudo/commit/?id=e05905dd1)

2004-12-16 Todd C. Miller

* sudo.c:

  sort usage
  [[bb76440b4]](https://git.sudo.ws/sudo/commit/?id=bb76440b4)

* sudo.pod:

  Sort command line options
  [[0b1ef8ff5]](https://git.sudo.ws/sudo/commit/?id=0b1ef8ff5)

* def\_data.c, def\_data.h, def\_data.in, defaults.c, logging.c, sudo.c,
  sudo.pod, sudoers.pod:

  Add closefrom sudoers option to start closing at a point other than 3.
  Add closefrom\_override sudoers option and -C sudo flag to allow the user
  to specify a different closefrom starting point.
  [[051a2110a]](https://git.sudo.ws/sudo/commit/?id=051a2110a)

* pathnames.h.in:

  Add \_PATH\_DEVNULL for those without it.
  [[74c19b024]](https://git.sudo.ws/sudo/commit/?id=74c19b024)

* LICENSE:

  no more UCB strcasecmp
  [[2c9dc5a69]](https://git.sudo.ws/sudo/commit/?id=2c9dc5a69)

* strcasecmp.c:

  replace BSD licensed one with version derived from pdksh
  [[b9a727023]](https://git.sudo.ws/sudo/commit/?id=b9a727023)

2004-12-10 Todd C. Miller

* sudo.c:

  Fix last commit.
  [[f93cd1e97]](https://git.sudo.ws/sudo/commit/?id=f93cd1e97)

* sudo.c:

  Make sure stdin, stdout and stderr are open and dup them to /dev/null if
  not.
  [[07d74adfb]](https://git.sudo.ws/sudo/commit/?id=07d74adfb)

2004-12-03 Todd C. Miller

* ldap.c, mon\_systrace.c, sudo.c, sudo.h:

  add sudo\_ldap\_close
  [[1936aeb29]](https://git.sudo.ws/sudo/commit/?id=1936aeb29)

* fileops.c, gettime.c, sudo.c, sudo\_edit.c, utimes.c, visudo.c:

  Use TIME\_WITH\_SYS\_TIME
  [[7d488657f]](https://git.sudo.ws/sudo/commit/?id=7d488657f)

* config.h.in, configure, configure.in:

  Add TIME\_WITH\_SYS\_TIME\_H
  [[9884923a9]](https://git.sudo.ws/sudo/commit/?id=9884923a9)

2004-12-02 Todd C. Miller

* env.c:

  Add missing braces to avoid DYLD\_FORCE\_FLAT\_NAMESPACE being set
  unconditionally on darwin. From Toby Peterson.
  [[48dae86b8]](https://git.sudo.ws/sudo/commit/?id=48dae86b8)

* getspwuid.c:

  Check rbinsert() return value. In the case of faked up entries there is
  usually a negative response cached that we need to overwrite.

  In pwfree() don’t try to zero out a NULL pw\_passwd pointer.
  [[77a7ab659]](https://git.sudo.ws/sudo/commit/?id=77a7ab659)

* mon\_systrace.c:

  Use the double fork trick to avoid the monitor process being waited for
  by the main program run through sudo.
  [[d88e6523a]](https://git.sudo.ws/sudo/commit/?id=d88e6523a)

2004-11-29 Todd C. Miller

* sudo.c:

  Call initgroups() in -U mode so group matches work normally.
  [[68e54d2c8]](https://git.sudo.ws/sudo/commit/?id=68e54d2c8)

* def\_data.h, mkdefaults:

  Don’t print a trailing comma for the last entry in enum def\_tupple
  [[51fbe264f]](https://git.sudo.ws/sudo/commit/?id=51fbe264f)

2004-11-28 Todd C. Miller

* sudoers.cat, sudoers.man.in, sudoers.pod:

  Mention values when lecture, listpw and verifypw are used in boolean
  context.
  [[9c8844142]](https://git.sudo.ws/sudo/commit/?id=9c8844142)

* def\_data.c, def\_data.in:

  verifypw when used in a boolean TRUE context should be “all”, not “any”.
  [[f5c359ee0]](https://git.sudo.ws/sudo/commit/?id=f5c359ee0)

2004-11-26 Todd C. Miller

* def\_data.in, defaults.c:

  Allow tuples that can be used as booleans to be used as boolean TRUE. In
  this case the 2nd possible value of the tuple is used for TRUE.
  [[57ab7279b]](https://git.sudo.ws/sudo/commit/?id=57ab7279b)

2004-11-25 Todd C. Miller

* configure, configure.in:

  Correct the test for 2-parameter timespecsub
  [[8ed367de8]](https://git.sudo.ws/sudo/commit/?id=8ed367de8)

* sudo.h:

  Add strub struct definitions for passwd, timeval and timespec
  [[d72a4e9c2]](https://git.sudo.ws/sudo/commit/?id=d72a4e9c2)

* config.h.in, configure, configure.in, sudo\_edit.c, visudo.c:

  Add check for 2-argument form of timespecsub (FreeBSD and BSD/OS) and
  fix a typo in the gettimeofday check.
  [[33db4b2ed]](https://git.sudo.ws/sudo/commit/?id=33db4b2ed)

2004-11-24 Todd C. Miller

* match.c, testsudoers.c:

  Deal with user\_stat being NULL as it is for visudo and testsudoers.
  [[94f606fbf]](https://git.sudo.ws/sudo/commit/?id=94f606fbf)

* parse.c, sudo.c, sudo.cat, sudo.h, sudo.man.in, sudo.pod:

  Add -U option to use in conjunction with -l instead of -u. Add support
  for “sudo -l command” to test a specific command.
  [[5f06b19a6]](https://git.sudo.ws/sudo/commit/?id=5f06b19a6)

* gram.c, gram.y, sudo.c:

  Set safe\_cmnd after sudoers\_lookup() if it has not been set. Previously
  it was set by sudo “ALL” in the parser but at that point the
  fully-qualified pathname has not yet been found.
  [[f75a034f0]](https://git.sudo.ws/sudo/commit/?id=f75a034f0)

2004-11-23 Todd C. Miller

* parse.c, testsudoers.c:

  Correctly handle multiple privileges per userspec and runas inheritence.
  [[9c526bdc3]](https://git.sudo.ws/sudo/commit/?id=9c526bdc3)

2004-11-21 Todd C. Miller

* defaults.c:

  Zero out sd\_un for each entry in sudo\_defs\_table in init\_defaults.
  [[f2bdbda17]](https://git.sudo.ws/sudo/commit/?id=f2bdbda17)

2004-11-19 Todd C. Miller

* toke.c, toke.l:

  make per-command defaults work with sudoedit
  [[77cd81f41]](https://git.sudo.ws/sudo/commit/?id=77cd81f41)

* ldap.c, parse.c, sudo.c, sudo.h:

  Remove the FLAG\_NOPASS, FLAG\_NOEXEC and FLAG\_MONITOR flags. Instead, we
  just set the approriate defaults variable.
  [[e60507014]](https://git.sudo.ws/sudo/commit/?id=e60507014)

* sample.sudoers, sudoers.cat, sudoers.man.in, sudoers.pod:

  Document per-command Defaults.
  [[9c954d803]](https://git.sudo.ws/sudo/commit/?id=9c954d803)

* defaults.c, defaults.h, gram.c, gram.h, gram.y, mon\_systrace.c, sudo.c,
  testsudoers.c, toke.c, toke.l, visudo.c:

  Add support for command-specific Defaults entries. E.g.
  Defaults!/usr/bin/vi noexec
  [[fe869025c]](https://git.sudo.ws/sudo/commit/?id=fe869025c)

* defaults.c, match.c, parse.c, parse.h, testsudoers.c:

  Change an occurence of user\_matches() -> runas\_matches() missed
  previously runas\_matches(), host\_matches() and cmnd\_matches() only
  really need to pass in a list of members. user\_matches() still needs to
  pass in a passwd struct because of “sudo -l”
  [[0cddfc368]](https://git.sudo.ws/sudo/commit/?id=0cddfc368)

* parse.c:

  Check def\_authenticate, def\_noexec and def\_monitor when setting return
  flags. XXX May be better to just set the defaults directly and get rid
  of those flags.
  [[2c3cff170]](https://git.sudo.ws/sudo/commit/?id=2c3cff170)

* alias.c, alloc.c, auth/afs.c, auth/aix\_auth.c, auth/bsdauth.c,
  auth/dce.c, auth/fwtk.c, auth/kerb4.c, auth/kerb5.c, auth/pam.c,
  auth/passwd.c, auth/rfc1938.c, auth/secureware.c, auth/securid.c,
  auth/securid5.c, auth/sia.c, auth/sudo\_auth.c, check.c, closefrom.c,
  defaults.c, env.c, error.c, fileops.c, find\_path.c, fnmatch.c, getcwd.c,
  getprogname.c, getspwuid.c, gettime.c, glob.c, goodpath.c, gram.c,
  gram.y, interfaces.c, ldap.c, logging.c, match.c, mon\_systrace.c,
  parse.c, redblack.c, set\_perms.c, snprintf.c, strcasecmp.c, strerror.c,
  strlcat.c, strlcpy.c, sudo.c, sudo\_edit.c, sudo\_noexec.c, testsudoers.c,
  tgetpass.c, toke.c, toke.l, utimes.c, visudo.c, zero\_bytes.c:

  Use: #include <config.h> Not: #include “config.h” That way we get the
  correct config.h when build dir != src dir
  [[2c2daa8ec]](https://git.sudo.ws/sudo/commit/?id=2c2daa8ec)

* Makefile.in:

  Back out part of rev 1.263; fix -I order
  [[bb60da6bb]](https://git.sudo.ws/sudo/commit/?id=bb60da6bb)

* toke.c, toke.l:

  More robust parsing if #include; could be much better still.
  [[faa9a8972]](https://git.sudo.ws/sudo/commit/?id=faa9a8972)

* sudo\_edit.c, visudo.c:

  Make arg splitting in visudo and sudoedit consistent.
  [[6a78b9194]](https://git.sudo.ws/sudo/commit/?id=6a78b9194)

* Makefile.in, alias.c, gram.c, gram.y, parse.h:

  Split alias routines out into their own file.
  [[07139128f]](https://git.sudo.ws/sudo/commit/?id=07139128f)

* error.h:

  **attribute** is already defined in compat.h
  [[55d6af846]](https://git.sudo.ws/sudo/commit/?id=55d6af846)

* visudo.c:

  quit() should not be **noreturn** as it is non-void on some platforms.
  [[3f9ee04fb]](https://git.sudo.ws/sudo/commit/?id=3f9ee04fb)

* auth/fwtk.c, auth/rfc1938.c, auth/securid.c, auth/securid5.c:

  Add local error/warning functions like err/warn but that call an
  additional cleanup routine in the error case. This means we no longer
  need to compile a special version of alloc.o for visudo.
  [[a414762c4]](https://git.sudo.ws/sudo/commit/?id=a414762c4)

* parse.h:

  Clarify comments about the data structures
  [[f38c58574]](https://git.sudo.ws/sudo/commit/?id=f38c58574)

2004-11-18 Todd C. Miller

* visudo.c:

  Add support for VISUAL and EDITOR containing command line args. If
  env\_editor is not set any args in VISUAL and EDITOR are ignored.
  Arguments are also now supported in def\_editor.
  [[75ad6b81a]](https://git.sudo.ws/sudo/commit/?id=75ad6b81a)

2004-11-17 Todd C. Miller

* parse.h:

  alias\_matches() is no more
  [[cf02ff7f5]](https://git.sudo.ws/sudo/commit/?id=cf02ff7f5)

* CHANGES, TODO:

  sync
  [[0e71bf81a]](https://git.sudo.ws/sudo/commit/?id=0e71bf81a)

* Makefile.in:

  When regenerating the parser, don’t replace gram.h unless it has
  changed.
  [[81f558732]](https://git.sudo.ws/sudo/commit/?id=81f558732)

* Makefile.in:

  remove Makefile.binary for distclean
  [[761695f32]](https://git.sudo.ws/sudo/commit/?id=761695f32)

* env.c:

  Preserve KRB5CCNAME in zero\_env() and add a paranoia check to make sure
  we can’t overflow new\_env.
  [[b2ef18bbd]](https://git.sudo.ws/sudo/commit/?id=b2ef18bbd)

* sudo\_edit.c:

  paranoia when stripping trailing slashes from tempdir.
  [[88ce50751]](https://git.sudo.ws/sudo/commit/?id=88ce50751)

* sudo.c:

  Set user\_ngroups to 0 if getgroups() returns an error.
  [[d427384ae]](https://git.sudo.ws/sudo/commit/?id=d427384ae)

2004-11-16 Todd C. Miller

* config.h.in, configure, configure.in, sudo.c:

  Add configure check for getgroups()
  [[f7f282ba1]](https://git.sudo.ws/sudo/commit/?id=f7f282ba1)

* ldap.c:

  Use supplementary group vector in struct sudo\_user.
  [[fc85c6f02]](https://git.sudo.ws/sudo/commit/?id=fc85c6f02)

* match.c:

  Only do string comparisons on the group members if there is no
  supplemental group list.
  [[596d1ef5a]](https://git.sudo.ws/sudo/commit/?id=596d1ef5a)

* CHANGES, TODO:

  sync
  [[cfbf7768f]](https://git.sudo.ws/sudo/commit/?id=cfbf7768f)

* sudo\_edit.c:

  On Digital UNIX \_PATH\_VAR\_TMP doesn’t end with a trailing slash so chop
  off any trailing slashes we see and add an explicit one.
  [[900db20f7]](https://git.sudo.ws/sudo/commit/?id=900db20f7)

* match.c:

  remove bogus XXX comment
  [[0ed255795]](https://git.sudo.ws/sudo/commit/?id=0ed255795)

* match.c:

  Get rid of alias\_matches and correctly fall through to the non-alias
  cases when there is no alias with the specified name.
  [[3e97ace97]](https://git.sudo.ws/sudo/commit/?id=3e97ace97)

* getspwuid.c:

  Cache non-existent passwd/group entries too.
  [[4620e8fa6]](https://git.sudo.ws/sudo/commit/?id=4620e8fa6)

* gram.c:

  regen
  [[7679efc43]](https://git.sudo.ws/sudo/commit/?id=7679efc43)

* getspwuid.c:

  fix typo
  [[8680307db]](https://git.sudo.ws/sudo/commit/?id=8680307db)

* check.c, getspwuid.c, glob.c, ldap.c, logging.c, match.c,
  mon\_systrace.h, sudo.c, sudo.h, testsudoers.c, visudo.c:

  Implement group caching and use the passwd and group caches throughout.
  [[9846e562a]](https://git.sudo.ws/sudo/commit/?id=9846e562a)

2004-11-15 Todd C. Miller

* match.c:

  Properly negate the return value of alias\_matches() when appropriate.
  [[fd46c2c3e]](https://git.sudo.ws/sudo/commit/?id=fd46c2c3e)

* match.c:

  Make hostname\_matches() return TRUE for a match, else FALSE like the
  caller expects.
  [[61ba998ee]](https://git.sudo.ws/sudo/commit/?id=61ba998ee)

* Makefile.in:

  Add missing dependencies on gram.h
  [[cf356ed80]](https://git.sudo.ws/sudo/commit/?id=cf356ed80)

* match.c:

  Use runas\_matches in alias\_matches() now that we have it.
  [[814103ee2]](https://git.sudo.ws/sudo/commit/?id=814103ee2)

* parse.c, parse.h:

  Expand aliases in “sudo -l” mode
  [[74169a83e]](https://git.sudo.ws/sudo/commit/?id=74169a83e)

* gram.y, match.c:

  Use ALIAS for the member type when storing an alias instead of
  HOSTALIAS/RUNASALIAS/CMNDALIAS/USERALIAS since match.c relies on the
  more generic type. Expand runas\_matches instead of calling
  user\_matches() inside of it since user\_matches() looks up USERALIASes,
  not RUNASALIASes.
  [[d076091ab]](https://git.sudo.ws/sudo/commit/?id=d076091ab)

* CHANGES, getspwuid.c:

  Paranoia; zero out pw\_passwd before freeing passwd entry.
  [[77cb1b56a]](https://git.sudo.ws/sudo/commit/?id=77cb1b56a)

* LICENSE, Makefile.in, alloc.c, check.c, config.h.in, configure,
  configure.in, defaults.c, emul/err.h, env.c, err.c, error.c, error.h,
  find\_path.c, interfaces.c, logging.c, mon\_systrace.c, sudo.c, sudo.h,
  sudo\_edit.c, testsudoers.c, visudo.c:

  Add local error/warning functions like err/warn but that call an
  additional cleanup routine in the error case. This means we no longer
  need to compile a special version of alloc.o for visudo.
  [[51375f969]](https://git.sudo.ws/sudo/commit/?id=51375f969)

* match.c:

  Use userpw\_matches() to compare usernames, not strcmp(), since the
  latter checks for “#uid”.
  [[244eec5cd]](https://git.sudo.ws/sudo/commit/?id=244eec5cd)

* getspwuid.c, mon\_systrace.c, mon\_systrace.h, sudo.c:

  Cache passwd db entries in 2 reb-black trees; one indexed by uid, the
  other by user name. The data returned from the cache should be
  considered read-only and is destroyed by sudo\_endpwent().
  [[ae2e26fd2]](https://git.sudo.ws/sudo/commit/?id=ae2e26fd2)

* match.c:

  add cast to uid\_t
  [[99158cc7e]](https://git.sudo.ws/sudo/commit/?id=99158cc7e)

* gram.y:

  missing free in alias\_destroy
  [[7ee6d6815]](https://git.sudo.ws/sudo/commit/?id=7ee6d6815)

* redblack.c:

  Can’t use rbapply() for rbdestroy since the destructor is passed a data
  pointer, not a node pointer.
  [[ec431b4e3]](https://git.sudo.ws/sudo/commit/?id=ec431b4e3)

* getspwuid.c, logging.c, sudo.c, sudo.h:

  Create and use private versions of setpwent() and endpwent() that
  set/end the shadow password file too.
  [[0b34123a8]](https://git.sudo.ws/sudo/commit/?id=0b34123a8)

* gram.c, gram.h, gram.y, match.c, parse.h, testsudoers.c, visudo.c:

  Store aliases in a red-black tree.
  [[e26e40df8]](https://git.sudo.ws/sudo/commit/?id=e26e40df8)

* Makefile.in, redblack.c, redblack.h:

  red-black tree implementation
  [[72c6f3ba9]](https://git.sudo.ws/sudo/commit/?id=72c6f3ba9)

* visudo.c:

  Edit all sudoers file if there were unused or undefined aliases and we
  are in strict mode.
  [[f3839f1bf]](https://git.sudo.ws/sudo/commit/?id=f3839f1bf)

2004-11-12 Todd C. Miller

* CHANGES, def\_data.c, def\_data.h, def\_data.in, defaults.c, env.c,
  find\_path.c, sudoers.cat, sudoers.man.in, sudoers.pod, visudo.c:

  Bring back the “secure\_path” Defaults option now that Defaults take
  effect before the path is searched.
  [[a768dbc34]](https://git.sudo.ws/sudo/commit/?id=a768dbc34)

2004-11-11 Todd C. Miller

* logging.c, parse.c:

  A user can always list their own entries, even with -u. Better error
  message when failing to list another user’s entries.
  [[541908f1b]](https://git.sudo.ws/sudo/commit/?id=541908f1b)

* parse.c, sudo.c, sudo.h:

  The syntax to list another user’s entries is now “-u otheruser -l”. Only
  root or users with sudo “ALL” may list other user’s entries.
  [[a239e60a6]](https://git.sudo.ws/sudo/commit/?id=a239e60a6)

* sudo.cat, sudo.man.in, sudo.pod:

  Update env variable info in SECURITY NOTES
  [[85d1ca15a]](https://git.sudo.ws/sudo/commit/?id=85d1ca15a)

* env.c:

  strip CDPATH too
  [[74b4e439a]](https://git.sudo.ws/sudo/commit/?id=74b4e439a)

* env.c:

  strip exported bash functions from the environment.
  [[482526bde]](https://git.sudo.ws/sudo/commit/?id=482526bde)

2004-10-27 Todd C. Miller

* sudo.c:

  Only reset sudo\_user.pw based on SUDO\_USER environment variables for
  real commands and sudoedit. This avoids a confusing message when a user
  tries “sudo -l” or “sudo -v” and is denied.
  [[29fc2c947]](https://git.sudo.ws/sudo/commit/?id=29fc2c947)

* gram.c, gram.y, parse.h:

  Extend LIST\_APPEND to deal with appending lists too
  [[8ac791557]](https://git.sudo.ws/sudo/commit/?id=8ac791557)

2004-10-26 Todd C. Miller

* logging.c:

  Convert some bitwise AND to ISSET
  [[454998066]](https://git.sudo.ws/sudo/commit/?id=454998066)

* toke.c:

  toke.c replaces lex.yy.c
  [[7062fd28f]](https://git.sudo.ws/sudo/commit/?id=7062fd28f)

* CHANGES, TODO:

  sync
  [[b1d7ccde4]](https://git.sudo.ws/sudo/commit/?id=b1d7ccde4)

* BUGS:

  new parser fixes most of the outstanding bugs
  [[f3d8a1160]](https://git.sudo.ws/sudo/commit/?id=f3d8a1160)

* configure:

  regen
  [[5744a0bfd]](https://git.sudo.ws/sudo/commit/?id=5744a0bfd)

* visudo.c:

  Rework for the new parser. Now checks for unused aliases in sudoers.
  [[2c1da58a8]](https://git.sudo.ws/sudo/commit/?id=2c1da58a8)

* testsudoers.c:

  Rewrite for the new parser. Now supports a -d flag (dump) and adds a -h
  flag (host). It now defaults to the local hostname unless otherwise
  specified.
  [[987d5cf81]](https://git.sudo.ws/sudo/commit/?id=987d5cf81)

* sudo.h:

  Add new prototypes. Remove NOMATCH/UNSPEC (now in parse.h)
  [[e392b4d11]](https://git.sudo.ws/sudo/commit/?id=e392b4d11)

* sudo.c:

  Update for new parse. We now call find\_path() *after* we have updated
  the global defaults based on sudoers. Also adds support for listing
  other user’s privs if you are root.
  [[efbc9997a]](https://git.sudo.ws/sudo/commit/?id=efbc9997a)

* mon\_systrace.c:

  Working LDAP support; also remove a now-unneeded rewind().
  [[ce4b69f8b]](https://git.sudo.ws/sudo/commit/?id=ce4b69f8b)

* logging.c, logging.h:

  Add NO\_STDERR flag.
  [[899e22194]](https://git.sudo.ws/sudo/commit/?id=899e22194)

* ldap.c:

  Split sudo\_ldap\_check() into three pieces: sudo\_ldap\_open(),
  udo\_ldap\_update\_defaults() and sudo\_ldap\_check(). This allows us to
  connecto to LDAP, apply the default options, find the command in the
  user’s path, and then check whether the user is allowed to run it. The
  important thing here is that the default runas user may be specified as
  a default option and that needs to be set before we search for the
  command.
  [[6c5550d13]](https://git.sudo.ws/sudo/commit/?id=6c5550d13)

* ldap.c:

  Add casts to unsigned char for isspace() to quiet a gcc warning.
  [[0de1515d0]](https://git.sudo.ws/sudo/commit/?id=0de1515d0)

* defaults.h:

  Add prototype for update\_defaults()
  [[9c14a9998]](https://git.sudo.ws/sudo/commit/?id=9c14a9998)

* defaults.c:

  Don’t warn about line numbers now that we operate on a set of data
  structures (or LDAP) and not a file.
  [[50e00d2b0]](https://git.sudo.ws/sudo/commit/?id=50e00d2b0)

* config.h.in:

  No long use lsearch()
  [[ba12600db]](https://git.sudo.ws/sudo/commit/?id=ba12600db)

* Makefile.in:

  Update for new and changed file names.
  [[e777eb9dd]](https://git.sudo.ws/sudo/commit/?id=e777eb9dd)

* LICENSE:

  no more BSD lsearch.c
  [[306734c6b]](https://git.sudo.ws/sudo/commit/?id=306734c6b)

* match.c:

  foo\_matches() routines now live in match.c Added user\_matches(),
  runas\_matches(), host\_matches(), cmnd\_matches() and alias\_matches() that
  operate on the parsed sudoers file.
  [[56e8b2fcf]](https://git.sudo.ws/sudo/commit/?id=56e8b2fcf)

* toke.l:

  Move parse.lex -> toke.l Rename buffer\_frob() -> switch\_buffer() WORD
  no longer needs to exclude ‘@’ kill yywrap()
  [[2d1e360e8]](https://git.sudo.ws/sudo/commit/?id=2d1e360e8)

* gram.c, gram.h, gram.y, parse.c, parse.h, parse.yacc, sudo.tab.c:

  Rewritten parser that converts sudoers into a set of data structures.
  This eliminates ordering issues and makes it possible to apply sudoers
  Defaults entries before searching for the command.
  [[5becc0385]](https://git.sudo.ws/sudo/commit/?id=5becc0385)

* configure.in, emul/search.h, lsearch.c:

  We won’t be using lsearch() any longer.
  [[6725bb2e5]](https://git.sudo.ws/sudo/commit/?id=6725bb2e5)

* ldap.c:

  sudo should not send mail if someone who runs ‘sudo -l’ has no entry.
  [[f7d7a3d5f]](https://git.sudo.ws/sudo/commit/?id=f7d7a3d5f)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in, visudo.cat,
  visudo.man.in:

  regen
  [[8204723c8]](https://git.sudo.ws/sudo/commit/?id=8204723c8)

* visudo.pod:

  Update warnings to match new visudo
  [[ae0a788d9]](https://git.sudo.ws/sudo/commit/?id=ae0a788d9)

* sudoers.pod:

  The new parser doesn’t have the old ordering constraints.
  [[b7479ce1e]](https://git.sudo.ws/sudo/commit/?id=b7479ce1e)

* sudo.pod:

  Document that -l now takes an optional username argument
  [[92d0954bc]](https://git.sudo.ws/sudo/commit/?id=92d0954bc)

2004-10-25 Todd C. Miller

* RUNSON:

  AIX 5.2.0.0 works
  [[17bb4b138]](https://git.sudo.ws/sudo/commit/?id=17bb4b138)

* ldap.c:

  If LDAP\_OPT\_SUCCESS is not defined, use LDAP\_SUCCESS instead. Fixes a
  compilation problem with Solaris 9’s native LDAP.

  Set FLAG\_MONITOR when needed.
  [[66992e10e]](https://git.sudo.ws/sudo/commit/?id=66992e10e)

2004-10-23 Todd C. Miller

* mon\_systrace.c:

  Call sudo\_goodpath() *after* changing the cwd to match the traced
  process. Fixes relative paths.
  [[2c91a5814]](https://git.sudo.ws/sudo/commit/?id=2c91a5814)

2004-10-21 Todd C. Miller

* testsudoers.c:

  Kill set\_perms() stub–it is no longer needed.
  [[d9e4426cb]](https://git.sudo.ws/sudo/commit/?id=d9e4426cb)

2004-10-13 Todd C. Miller

* sudoers.cat, sudoers.man.in, sudoers.pod:

  stay\_setuid now requires set\_reuid() or setresuid()
  [[e455f848a]](https://git.sudo.ws/sudo/commit/?id=e455f848a)

* INSTALL, PORTING, TROUBLESHOOTING, config.h.in, configure, configure.in,
  set\_perms.c, sudo.c, sudo.h:

  Kill use of POSIX saved uids; they aren’t worth bothering with.
  [[48cdd1dec]](https://git.sudo.ws/sudo/commit/?id=48cdd1dec)

2004-10-07 Todd C. Miller

* glob.c:

  remove call to issetugid()
  [[55e1b220e]](https://git.sudo.ws/sudo/commit/?id=55e1b220e)

* sudoers.cat, sudoers.man.in, sudoers.pod:

  Remove warning about wildcards. Now that we use glob() the bug is fixed.
  [[d56b543a1]](https://git.sudo.ws/sudo/commit/?id=d56b543a1)

* parse.c:

  Use glob(3) instead of fnmatch(3) for matching pathnames and stat each
  result that matches the basename of the user’s command. This makes “cd
  /usr/bin ; sudo ./blah” work when sudoers allows /usr/bin/blah. Fixes
  bug #143.
  [[1b06f3e81]](https://git.sudo.ws/sudo/commit/?id=1b06f3e81)

* config.h.in, configure, configure.in:

  Define HAVE\_EXTENDED\_GLOB for extended glob (GLOB\_TILDE and GLOB\_BRACE)
  [[082b0f8b3]](https://git.sudo.ws/sudo/commit/?id=082b0f8b3)

* config.h.in, configure, configure.in:

  Check for a glob() that supports GLOB\_BRACE and GLOB\_TILDE
  [[e05c8441e]](https://git.sudo.ws/sudo/commit/?id=e05c8441e)

* LICENSE:

  reference glob
  [[b19c6c4e9]](https://git.sudo.ws/sudo/commit/?id=b19c6c4e9)

* glob.c:

  4.4BSD glob(3) with fixes from OpenBSD and some unneeded extensions
  removed.
  [[50ed391d1]](https://git.sudo.ws/sudo/commit/?id=50ed391d1)

* emul/glob.h:

  4.4BSD glob(3) with fixes from OpenBSD and some unneeded extensions
  removed.
  [[1ef398856]](https://git.sudo.ws/sudo/commit/?id=1ef398856)

2004-10-05 Todd C. Miller

* mon\_systrace.c:

  Just return if STRIOCINJECT or STRIOCREPLACE fail. It probably means we
  are out of space in the stack gap…
  [[163994c11]](https://git.sudo.ws/sudo/commit/?id=163994c11)

* CHANGES:

  sync
  [[a3367a715]](https://git.sudo.ws/sudo/commit/?id=a3367a715)

* mon\_systrace.c:

  Take a stab at ldap sudoers support here.
  [[a7d63df1f]](https://git.sudo.ws/sudo/commit/?id=a7d63df1f)

* mon\_systrace.c, mon\_systrace.h:

  Detach from tracee on SIGHUP, SIGINT and SIGTERM. Now “sudo reboot”
  doesn’t cause reboot to inadvertanly kill itself.
  [[385dfb269]](https://git.sudo.ws/sudo/commit/?id=385dfb269)

* mon\_systrace.c:

  put “monitor” in the proctitle, not “systrace”
  [[6e2fb232a]](https://git.sudo.ws/sudo/commit/?id=6e2fb232a)

* mon\_systrace.c:

  When modifying the environment, don’t replace envp when we can get away
  with just rewriting pointers in the traced process.
  [[f01c983f1]](https://git.sudo.ws/sudo/commit/?id=f01c983f1)

* mon\_systrace.c, mon\_systrace.h:

  Add environment updating via STRIOCINJECT (if available).
  [[dc368b59f]](https://git.sudo.ws/sudo/commit/?id=dc368b59f)

* sudoers.cat, sudoers.man.in:

  regen
  [[5c259f8b4]](https://git.sudo.ws/sudo/commit/?id=5c259f8b4)

2004-10-04 Todd C. Miller

* lex.yy.c:

  regen
  [[30f4a9c13]](https://git.sudo.ws/sudo/commit/?id=30f4a9c13)

* parse.lex:

  Fix bug introduced in unput() removal; want yyless(0) not yyless(1)
  [[7e36fc441]](https://git.sudo.ws/sudo/commit/?id=7e36fc441)

* mon\_systrace.c:

  Include file is now mon\_systrace.h
  [[d7e43093e]](https://git.sudo.ws/sudo/commit/?id=d7e43093e)

* Makefile.in, configure, configure.in, def\_data.c, def\_data.h,
  def\_data.in, lex.yy.c, parse.c, parse.h, parse.lex, parse.yacc, sudo.c,
  sudo.h, sudo.tab.c, sudo.tab.h, sudoers.pod:

  No longer call it tracing, it is now “monitoring” which should be more a
  obvious name to non-hackers.
  [[3c8145a92]](https://git.sudo.ws/sudo/commit/?id=3c8145a92)

2004-10-01 Todd C. Miller

* mon\_systrace.c, mon\_systrace.h:

  Fix some XXX
  [[5eb4895b5]](https://git.sudo.ws/sudo/commit/?id=5eb4895b5)

* mon\_systrace.c, mon\_systrace.h:

  No need to include syscall.h, use 1024 as the max # of entries (the max
  that systrace(4) allows).

  Only need to use SYSTR\_POLICY\_ASSIGN once

  Change check\_syscall() -> find\_handler() and have it return the handler
  instead of just running it. We need this since handler now have two
  parts: one part that generates and answer and another that gets called
  after the answer is accepted (to do logging).

  Add some missing check\_exec for emul execv
  [[e173a07c8]](https://git.sudo.ws/sudo/commit/?id=e173a07c8)

* sample.pam, sample.sudoers, sample.syslog.conf, sudoers:

  Add $Sudo$ tags.
  [[ebf22ee97]](https://git.sudo.ws/sudo/commit/?id=ebf22ee97)

* config.h.in:

  Add missing HAVE\_LINUX\_SYSTRACE\_H
  [[0035b30f9]](https://git.sudo.ws/sudo/commit/?id=0035b30f9)

* Makefile.in:

  add trace\_systrace.o dependency
  [[d94975937]](https://git.sudo.ws/sudo/commit/?id=d94975937)

2004-09-30 Todd C. Miller

* configure, configure.in:

  Also look for systrace.h in /usr/include/linux
  [[6f338fd77]](https://git.sudo.ws/sudo/commit/?id=6f338fd77)

* mon\_systrace.c, mon\_systrace.h:

  Move all struct defs and prototypes into trace\_systrace.h and mark all
  but systace\_attach() static.
  [[7edec1990]](https://git.sudo.ws/sudo/commit/?id=7edec1990)

* mon\_systrace.c, mon\_systrace.h:

  Add support for tracing emulations. At the moment, all emulations are
  compiled in. It might make sense to #ifdef them in the future, though
  this impeeds readability.
  [[33badbaea]](https://git.sudo.ws/sudo/commit/?id=33badbaea)

* Makefile.in, configure, configure.in:

  rename systrace.c -> trace\_systrace.c
  [[2cfa16a77]](https://git.sudo.ws/sudo/commit/?id=2cfa16a77)

* parse.yacc, sudo.tab.c:

  Allow this to build with a K&R compiler again
  [[6fa20c570]](https://git.sudo.ws/sudo/commit/?id=6fa20c570)

* TODO:

  sync
  [[9c15884b2]](https://git.sudo.ws/sudo/commit/?id=9c15884b2)

* compat.h, sudo.c, visudo.c:

  Use **attribute**((**noreturn**))
  [[8a3302598]](https://git.sudo.ws/sudo/commit/?id=8a3302598)

* visudo.c:

  Exit() takes a negative value to indicate it was not called via signal.
  [[1e65afba3]](https://git.sudo.ws/sudo/commit/?id=1e65afba3)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in, visudo.cat,
  visudo.man.in:

  regen
  [[abc7ac8ee]](https://git.sudo.ws/sudo/commit/?id=abc7ac8ee)

* Makefile.in, visudo.c:

  Define Err() and Errx() that are like err() and errx() but call Exit()
  instead of exit(). Build private copy of alloc.o for visudo that calls
  Err() and Errx().
  [[2b020f999]](https://git.sudo.ws/sudo/commit/?id=2b020f999)

2004-09-29 Todd C. Miller

* lex.yy.c, sudo.tab.c:

  regen
  [[b5d2fbb77]](https://git.sudo.ws/sudo/commit/?id=b5d2fbb77)

* CHANGES:

  sync
  [[bfaf67451]](https://git.sudo.ws/sudo/commit/?id=bfaf67451)

* visudo.c:

  Overhaul visudo for editing multiple files: o visudo has been broken out
  into functions (more work needed here) o each file is now edited before
  sudoers is re-parsed o if a #include line is added that file will be
  edited too

  TODO: o cleanup temp files when exiting via err() or errx() o continue
  breaking things out into separate functions
  [[f2ae53323]](https://git.sudo.ws/sudo/commit/?id=f2ae53323)

* parse.lex, sudo.c, sudo.h, testsudoers.c, visudo.c:

  Add keepopen arg to open\_sudoers that open\_sudoers can use to indicate
  to the caller that the fd should not be closed when it is done with it.
  To be used by visudo to keep locked fds from being closed prematurely
  (and thus losing the lock).
  [[cbcb60b18]](https://git.sudo.ws/sudo/commit/?id=cbcb60b18)

* parse.yacc, sudo.c:

  Add errorfile global that contains the name of the file that caused the
  error.
  [[e9b23cdee]](https://git.sudo.ws/sudo/commit/?id=e9b23cdee)

* parse.lex:

  return COMMENT to yacc grammar for a #include line
  [[f8f41d69a]](https://git.sudo.ws/sudo/commit/?id=f8f41d69a)

* parse.lex:

  Remove us of unput() in favor of yyless() which is cheaper.
  [[72894e693]](https://git.sudo.ws/sudo/commit/?id=72894e693)

* parse.yacc:

  Allow an empty sudoers file.
  [[9e975fafe]](https://git.sudo.ws/sudo/commit/?id=9e975fafe)

2004-09-28 Todd C. Miller

* mon\_systrace.c:

  Rewind sudoers\_fp now that sudoers\_lookup() doesn’t do it for us.
  [[27e83bacb]](https://git.sudo.ws/sudo/commit/?id=27e83bacb)

* lex.yy.c, sudo.tab.c:

  regen
  [[f4b1891e0]](https://git.sudo.ws/sudo/commit/?id=f4b1891e0)

* visudo.c:

  Do signal setup before calling edit\_sudoers(). Don’t shadow the “quiet”
  global.
  [[34269049b]](https://git.sudo.ws/sudo/commit/?id=34269049b)

* visudo.c:

  If a sudoers file includes other files, edit those too. Does not yes
  deal with creating the new includes files itself.
  [[97d800c91]](https://git.sudo.ws/sudo/commit/?id=97d800c91)

* testsudoers.c:

  init\_parser now takes a path
  [[01212e4eb]](https://git.sudo.ws/sudo/commit/?id=01212e4eb)

* parse.c, parse.h, parse.lex, parse.yacc:

  More scaffolding for dealing with multiple sudoers files: o
  init\_parser() now takes a path used to populate the sudoers global o the
  sudoers global is used to print the correct file in yyerror() o when
  switching to a new sudoers file, perserve old file name and line number
  [[db2a97fd0]](https://git.sudo.ws/sudo/commit/?id=db2a97fd0)

* Makefile.in, pathnames.h.in:

  Kill \_PATH\_SUDOERS\_TMP; it is not meaningful now that we can have
  multiple sudoers files.
  [[b99ad3ee2]](https://git.sudo.ws/sudo/commit/?id=b99ad3ee2)

* parse.c, sudo.c:

  Rewind sudoers\_fp in open\_sudoers() instead of sudoers\_lookup() so we
  start at the right file position when reading include files.
  [[4b75a0334]](https://git.sudo.ws/sudo/commit/?id=4b75a0334)

* sudoers.pod:

  document #include
  [[fbb62c680]](https://git.sudo.ws/sudo/commit/?id=fbb62c680)

* lex.yy.c:

  regen
  [[4aa29b5f2]](https://git.sudo.ws/sudo/commit/?id=4aa29b5f2)

* parse.lex:

  Add max depth of 128 for the include stack to avoid loops.

  Since yyerror() doesn’t stop parsing, pass return values back to yylex
  and call yyterminate() on error.
  [[8c039eac9]](https://git.sudo.ws/sudo/commit/?id=8c039eac9)

2004-09-27 Todd C. Miller

* sudoers.pod:

  document tracing
  [[d1f1af2bc]](https://git.sudo.ws/sudo/commit/?id=d1f1af2bc)

* sudo.pod:

  Mention PREVENTING SHELL ESCAPES section of sudoers man page
  [[a79c3af48]](https://git.sudo.ws/sudo/commit/?id=a79c3af48)

* lex.yy.c, sudo.tab.c:

  regen
  [[741177ad1]](https://git.sudo.ws/sudo/commit/?id=741177ad1)

* parse.lex:

  Add support for #include in sudoers (visudo support TBD)
  [[5691c513d]](https://git.sudo.ws/sudo/commit/?id=5691c513d)

* parse.yacc:

  make yyerror()’s argument const
  [[7f7358159]](https://git.sudo.ws/sudo/commit/?id=7f7358159)

* testsudoers.c, visudo.c:

  Add open\_sudoers() stubs.
  [[ec0ef3fcf]](https://git.sudo.ws/sudo/commit/?id=ec0ef3fcf)

* sudo.c, sudo.h:

  Rename check\_sudoers() open\_sudoers() and make it return a FILE \*
  [[7cf26298a]](https://git.sudo.ws/sudo/commit/?id=7cf26298a)

2004-09-26 Todd C. Miller

* BUGS, INSTALL, INSTALL.binary, Makefile.in, README, configure.in,
  version.h:

  Crank version
  [[22ad3cbc9]](https://git.sudo.ws/sudo/commit/?id=22ad3cbc9)

* Makefile.in, sudo.psf:

  Better HP-UX depot construction
  [[8b8ff2e45]](https://git.sudo.ws/sudo/commit/?id=8b8ff2e45)

2004-09-25 Todd C. Miller

* mon\_systrace.c:

  o Made children global so check\_exec() can lookup a child. o Replaced
  uid in struct childinfo with struct passwd \* (for runas) o new\_child()
  now takes a parent pid so the runas info can be inherited o Added
  find\_child() to lookup a child by its pid o update\_child() now fills in
  a struct passwd o Converted the big if/else mess in set\_policy to a
  switch o Syscalls that change uid are now “ask” so we get SYSTR\_MSG\_UGID
  events
  [[e4d64ce1d]](https://git.sudo.ws/sudo/commit/?id=e4d64ce1d)

* getspwuid.c:

  Add flag to sudo\_pwdup that indicates whether or not to lookup the
  shadow password. Will be used to a struct passwd that has the shadow
  password already filled in.
  [[ea5307a43]](https://git.sudo.ws/sudo/commit/?id=ea5307a43)

* mon\_systrace.c:

  add missing increment of addr in read\_string()
  [[28736eb55]](https://git.sudo.ws/sudo/commit/?id=28736eb55)

* mon\_systrace.c:

  Remove bogus call to update\_child() and some cosmetic fixes
  [[649e2dac1]](https://git.sudo.ws/sudo/commit/?id=649e2dac1)

* mon\_systrace.c:

  Don’t leak /dev/systrace fd to tracee Make initialized global for
  simplicity If STRIOCATTACH returns EBUSY we are already being traced
  Check for user\_args == NULL in setproctitle() call Add missing calls to
  STRIOCANSWER
  [[4e5c53e13]](https://git.sudo.ws/sudo/commit/?id=4e5c53e13)

* sudo.c:

  g/c sudo\_pwdup proto
  [[d4e3f175c]](https://git.sudo.ws/sudo/commit/?id=d4e3f175c)

* Makefile.in, sudo.psf:

  Add target for building a depot file
  [[007aff2b6]](https://git.sudo.ws/sudo/commit/?id=007aff2b6)

* mon\_systrace.c:

  trim includes
  [[1131db069]](https://git.sudo.ws/sudo/commit/?id=1131db069)

2004-09-24 Todd C. Miller

* lex.yy.c, sudo.tab.c, sudo.tab.h:

  regen
  [[2bb847298]](https://git.sudo.ws/sudo/commit/?id=2bb847298)

* INSTALL:

  document –with-systrace
  [[78ac046db]](https://git.sudo.ws/sudo/commit/?id=78ac046db)

* config.h.in, configure, configure.in:

  Add check for setproctitle
  [[35203ffe5]](https://git.sudo.ws/sudo/commit/?id=35203ffe5)

* mon\_systrace.c:

  pass struct str\_msg\_ask in to syscall checker so it can set the error
  code
  [[11edf288b]](https://git.sudo.ws/sudo/commit/?id=11edf288b)

* mon\_systrace.c:

  systrace(4) support for sudo. On systems with the systrace(4) kernel
  facility (OpenBSD, NetBSD, Linux w/ patches) sudo can intercept exec
  calls and check the exec args against the sudoers file. In other words,
  sudo can now control subcommands and shell escapes.
  [[d492138ff]](https://git.sudo.ws/sudo/commit/?id=d492138ff)

* sudo.c, sudo.h:

  Call systrace\_attach() if FLAG\_TRACE is set.
  [[aa8d212e3]](https://git.sudo.ws/sudo/commit/?id=aa8d212e3)

* parse.c, parse.h, parse.lex, parse.yacc, sudo.h:

  Add trace Defaults option and TRACE/NOTRACE tags and set FLAG\_TRACE
  [[e3391d597]](https://git.sudo.ws/sudo/commit/?id=e3391d597)

* parse.c, sudo.c:

  Don’t close sudoers\_fp, keep it open and set close on exec flag instead.
  [[0c2be0808]](https://git.sudo.ws/sudo/commit/?id=0c2be0808)

* def\_data.c, def\_data.h, def\_data.in:

  Add trace option
  [[ef874440a]](https://git.sudo.ws/sudo/commit/?id=ef874440a)

* Makefile.in:

  Add systrace
  [[84a3d101e]](https://git.sudo.ws/sudo/commit/?id=84a3d101e)

* INSTALL:

  SunOS /bin/sh blows up with configure
  [[7db351d7a]](https://git.sudo.ws/sudo/commit/?id=7db351d7a)

* configure, configure.in:

  Include sys/param.h before systrace.h
  [[ce559899e]](https://git.sudo.ws/sudo/commit/?id=ce559899e)

* configure:

  regen
  [[ec57f115f]](https://git.sudo.ws/sudo/commit/?id=ec57f115f)

* pathnames.h.in:

  \_PATH\_DEV\_SYSTRACE
  [[5431e1451]](https://git.sudo.ws/sudo/commit/?id=5431e1451)

* configure.in:

  line up options in –help
  [[35b33cc1b]](https://git.sudo.ws/sudo/commit/?id=35b33cc1b)

* config.h.in, configure.in:

  Add –with-systrace
  [[2af113f24]](https://git.sudo.ws/sudo/commit/?id=2af113f24)

2004-09-23 Todd C. Miller

* configure:

  regen
  [[fdaaeda58]](https://git.sudo.ws/sudo/commit/?id=fdaaeda58)

* aclocal.m4, configure.in:

  make this work with autoconf-2.59
  [[2306b4eb5]](https://git.sudo.ws/sudo/commit/?id=2306b4eb5)

2004-09-16 Todd C. Miller

* sudo\_edit.c:

  Simplify logic around open & stat of files and do sanity on edited file
  even if we lack fstat (still racable but worth doing).
  [[5ac82331b]](https://git.sudo.ws/sudo/commit/?id=5ac82331b)

2004-09-15 Todd C. Miller

* HISTORY:

  Add support url
  [[4bf59231e]](https://git.sudo.ws/sudo/commit/?id=4bf59231e)

* Makefile.in:

  versino 1.6.8p1
  [[075af35f9]](https://git.sudo.ws/sudo/commit/?id=075af35f9)

* CHANGES:

  more changes for 1.6.8p1
  [[98e8b1a15]](https://git.sudo.ws/sudo/commit/?id=98e8b1a15)

* version.h:

  1.6.8p1
  [[55be146f0]](https://git.sudo.ws/sudo/commit/?id=55be146f0)

* CHANGES, sudo\_edit.c:

  Add sanity check so we don’t try to edit something other than a regular
  file.
  [[12c78c0f6]](https://git.sudo.ws/sudo/commit/?id=12c78c0f6)

2004-09-15 Aaron Spangler

* CHANGES:

  sync
  [[bbfe3c0a6]](https://git.sudo.ws/sudo/commit/?id=bbfe3c0a6)

* INSTALL:

  document –with-ldap-conf-file
  [[beb677357]](https://git.sudo.ws/sudo/commit/?id=beb677357)

2004-09-14 Todd C. Miller

* CHANGES, ins\_csops.h:

  political correctness strikes again
  [[ec404a074]](https://git.sudo.ws/sudo/commit/?id=ec404a074)

* RUNSON:

  sync
  [[e3161b7a9]](https://git.sudo.ws/sudo/commit/?id=e3161b7a9)

2004-09-12 Todd C. Miller

* Makefile.binary.in, Makefile.in:

  Install sudoedit man link
  [[13a265e0e]](https://git.sudo.ws/sudo/commit/?id=13a265e0e)

* INSTALL:

  Update PAM note and mention where HP-UX users can download gcc binaries.
  [[e4dcb7919]](https://git.sudo.ws/sudo/commit/?id=e4dcb7919)

* Makefile.in:

  libtool wants to install stuff from .libs so fake one up for binary
  installations.
  [[4aa5447ab]](https://git.sudo.ws/sudo/commit/?id=4aa5447ab)

* Makefile.binary.in:

  rm -f old sudoedit link instead of using ln -f set LIBTOOL correctly
  [[3dcceccfc]](https://git.sudo.ws/sudo/commit/?id=3dcceccfc)

* Makefile.in:

  Deal with “uname -m” having slashes in it rm -f old sudoedit link
  instead of using ln -f
  [[75866326a]](https://git.sudo.ws/sudo/commit/?id=75866326a)

* Makefile.binary.in:

  Makefile.binary -> Makefile.binary.in for config.status substitution
  Add support for installing noexec bits
  [[5f8b2d646]](https://git.sudo.ws/sudo/commit/?id=5f8b2d646)

* Makefile.in:

  Copy noexec bits into binary dists too No longer use my old arch script
  for making binary dists
  [[b503734d0]](https://git.sudo.ws/sudo/commit/?id=b503734d0)

* Makefile.binary:

  Install sudoedit link.
  [[35e0ade7a]](https://git.sudo.ws/sudo/commit/?id=35e0ade7a)

2004-09-11 Todd C. Miller

* emul/utime.h:

  avoid \_\_P so there is no need for compat.h to be included
  [[9cc4d46d1]](https://git.sudo.ws/sudo/commit/?id=9cc4d46d1)

* utimes.c:

  Don’t use HAVE\_UTIME\_H before including config.h.
  [[6efac29fb]](https://git.sudo.ws/sudo/commit/?id=6efac29fb)

2004-09-10 Todd C. Miller

* compat.h:

  Fix Solatis futimes macro
  [[dc3bbe24c]](https://git.sudo.ws/sudo/commit/?id=dc3bbe24c)

2004-09-09 Todd C. Miller

* sudo\_edit.c:

  Rename ots -> omtim for improved readability.
  [[c93248273]](https://git.sudo.ws/sudo/commit/?id=c93248273)

2004-09-08 Todd C. Miller

* sudo\_edit.c:

  Redo changes in revision 1.7. Don’t really need to keep the temp file
  open; re-opening it with the invoking user’s euid is sufficient.
  [[611b0ca14]](https://git.sudo.ws/sudo/commit/?id=611b0ca14)

* CHANGES:

  sync
  [[4cde080f9]](https://git.sudo.ws/sudo/commit/?id=4cde080f9)

* sudo.cat, sudo.man.in:

  regen
  [[5e12b105f]](https://git.sudo.ws/sudo/commit/?id=5e12b105f)

* sudo.pod:

  back out revision 1.70; it is no long applicable
  [[a5e0ff864]](https://git.sudo.ws/sudo/commit/?id=a5e0ff864)

* env.c:

  Let the loader initialize nep
  [[01dbe19ba]](https://git.sudo.ws/sudo/commit/?id=01dbe19ba)

* config.h.in, configure, configure.in:

  Removed unneed check for fchown Add check for gettimeofday Move
  autoheader template stuff into separate AH\_TEMPLATE lines
  [[70d8f7832]](https://git.sudo.ws/sudo/commit/?id=70d8f7832)

* check.c, compat.h, fileops.c, sudo.h, sudo\_edit.c, visudo.c:

  Use timespec throughout.
  [[0f056c0d5]](https://git.sudo.ws/sudo/commit/?id=0f056c0d5)

* Makefile.in:

  gettime.[co]
  [[574866457]](https://git.sudo.ws/sudo/commit/?id=574866457)

* gettime.c:

  function to return the current time in a struct timespec
  [[8eb8badcc]](https://git.sudo.ws/sudo/commit/?id=8eb8badcc)

* utimes.c:

  Not a darpa-sponsored file.
  [[a8972c696]](https://git.sudo.ws/sudo/commit/?id=a8972c696)

2004-09-07 Todd C. Miller

* compat.h, config.h.in, configure, configure.in:

  Add a check for struct timespec and provide it for those without.
  [[54789c8fb]](https://git.sudo.ws/sudo/commit/?id=54789c8fb)

* config.h.in, configure, configure.in, sudo\_edit.c:

  Add checks for st\_mtim and st\_mtimespec and add macros for pulling the
  mtime sec and nsec out of struct stat. These are used in sudo\_edit() to
  better tell whether or not the file has changed.
  [[c0bfcc95c]](https://git.sudo.ws/sudo/commit/?id=c0bfcc95c)

* check.c, fileops.c, sudo.h, sudo\_edit.c, visudo.c:

  Add an extra param to touch() for nsec
  [[7f772c822]](https://git.sudo.ws/sudo/commit/?id=7f772c822)

* sudo\_edit.c:

  Call mkstemp() as the in invoking user so we don’t have to chown the
  file later. Only touch() the temp file if we can do it via the file
  descriptor. Don’t check for modification of the temp file if we lack
  fstat(). Catch errors read()ing the temp file.
  [[707c3c2cb]](https://git.sudo.ws/sudo/commit/?id=707c3c2cb)

* fileops.c:

  If path is NULL and fd == -1 return -1.
  [[b243b0ad3]](https://git.sudo.ws/sudo/commit/?id=b243b0ad3)

* sudo\_edit.c:

  closefrom() is overkill, the only extra fds are the ones we opened so
  just close those in the child.
  [[47d25da64]](https://git.sudo.ws/sudo/commit/?id=47d25da64)

* Makefile.in, aclocal.m4, check.c, compat.h, config.h.in, configure,
  configure.in, fileops.c, sudo.h, sudo\_edit.c, utimes.c, visudo.c:

  Use utimes() and futimes() instead of utime() in touch(), emulating as
  needed. Not all systems are able to support setting the times of an fd
  so touch() takes both an fd and a file name as arguments.
  [[1c20ff1a6]](https://git.sudo.ws/sudo/commit/?id=1c20ff1a6)

2004-09-07 Aaron Spangler

* env.c:

  Rare SEGV
  [[03b53b691]](https://git.sudo.ws/sudo/commit/?id=03b53b691)

2004-09-06 Todd C. Miller

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in, visudo.cat,
  visudo.man.in:

  regen
  [[1e0f96b91]](https://git.sudo.ws/sudo/commit/?id=1e0f96b91)

* sudo.pod, sudoers.pod, visudo.pod:

  Add SUPPORT section and re-order some of the sections to match the order
  we use in OpenBSD.
  [[eb49afe6c]](https://git.sudo.ws/sudo/commit/?id=eb49afe6c)

2004-09-06 Aaron Spangler

* env.c:

  Openldap ~/.ldaprc fix
  [[2102b561b]](https://git.sudo.ws/sudo/commit/?id=2102b561b)

2004-09-06 Todd C. Miller

* sudo.pod:

  Talk about how the editor must write its changes to the original file
  and not just use rename(2).
  [[c6d8ea8af]](https://git.sudo.ws/sudo/commit/?id=c6d8ea8af)

* CHANGES:

  sync
  [[ac3893910]](https://git.sudo.ws/sudo/commit/?id=ac3893910)

* sudo\_edit.c:

  Keep the temp file open instead of re-opening after the editor has
  exited.
  [[b701107b4]](https://git.sudo.ws/sudo/commit/?id=b701107b4)

* sample.pam:

  Update for current redhat/fedora core.
  [[e410bbb58]](https://git.sudo.ws/sudo/commit/?id=e410bbb58)

2004-09-03 Aaron Spangler

* README.LDAP:

  tls\_ examples
  [[fe020eca3]](https://git.sudo.ws/sudo/commit/?id=fe020eca3)

2004-09-02 Aaron Spangler

* ldap.c:

  config tls\_\* options
  [[646d43cf5]](https://git.sudo.ws/sudo/commit/?id=646d43cf5)

2004-08-29 Todd C. Miller

* configure, configure.in:

  No need for -lcrypt when using pam.
  [[2f153f222]](https://git.sudo.ws/sudo/commit/?id=2f153f222)

2004-08-27 Todd C. Miller

* configure:

  regen
  [[11fe0b0bf]](https://git.sudo.ws/sudo/commit/?id=11fe0b0bf)

2004-08-27 Aaron Spangler

* configure.in, ldap.c, pathnames.h.in:

  Allow –with-ldap-conf-file option to override LDAP\_CONF
  [[2ceb87bc5]](https://git.sudo.ws/sudo/commit/?id=2ceb87bc5)

* ldap.c:

  cleanup debug message
  [[b7ea12521]](https://git.sudo.ws/sudo/commit/?id=b7ea12521)

2004-08-26 Aaron Spangler

* README.LDAP:

  more config info
  [[2d3b307b9]](https://git.sudo.ws/sudo/commit/?id=2d3b307b9)

2004-08-24 Todd C. Miller

* TODO, find\_path.c, goodpath.c, parse.c, sudo.c, sudo.h, visudo.c:

  Add cmnd\_base to struct sudo\_user and set it in init\_vars(). Add
  cmnd\_stat to struct sudo\_user and set it in sudo\_goodpath(). No longer
  use gross statics in command\_matches(). Also rename some variables for
  improved clarity.
  [[f30ab72c4]](https://git.sudo.ws/sudo/commit/?id=f30ab72c4)

2004-08-21 Todd C. Miller

* INSTALL:

  document HP’s crippled compiler deficiency.
  [[badd06688]](https://git.sudo.ws/sudo/commit/?id=badd06688)

* INSTALL:

  Fix some thinkos in –with-editor and –with-env-editor descriptions.
  Noticed by Norihiko Murase.
  [[1e46c4d26]](https://git.sudo.ws/sudo/commit/?id=1e46c4d26)

* configure, configure.in:

  –with-noexec takes an optional PATH argument.
  [[a6ea92617]](https://git.sudo.ws/sudo/commit/?id=a6ea92617)

* INSTALL:

  document –with-noexec
  [[65d6b278b]](https://git.sudo.ws/sudo/commit/?id=65d6b278b)

2004-08-17 Todd C. Miller

* RUNSON, TODO:

  sync
  [[0c0dcf2e3]](https://git.sudo.ws/sudo/commit/?id=0c0dcf2e3)

* sudo\_edit.c:

  Better warning message when sudoedit is unable to write to the
  destination file.
  [[6acae1b3b]](https://git.sudo.ws/sudo/commit/?id=6acae1b3b)

* sudo.cat, sudo.man.in:

  regen
  [[2218f7827]](https://git.sudo.ws/sudo/commit/?id=2218f7827)

* sudo.pod:

  Don’t italicize the string “sudoedit”
  [[ecc1efce9]](https://git.sudo.ws/sudo/commit/?id=ecc1efce9)

2004-08-16 Todd C. Miller

* HISTORY:

  Mention GratiSoft.
  [[ad4b66e0e]](https://git.sudo.ws/sudo/commit/?id=ad4b66e0e)

2004-08-11 Todd C. Miller

* sudo.tab.c:

  regen
  [[4bc46dc93]](https://git.sudo.ws/sudo/commit/?id=4bc46dc93)

* parse.yacc:

  Reset used\_runas to FALSE when re-intializing the parser.
  [[4f03e9180]](https://git.sudo.ws/sudo/commit/?id=4f03e9180)

2004-08-09 Todd C. Miller

* config.guess:

  Correct OpenBSD mips support
  [[45805aa2b]](https://git.sudo.ws/sudo/commit/?id=45805aa2b)

* config.guess:

  Add OpenBSD/mips
  [[ef12124c9]](https://git.sudo.ws/sudo/commit/?id=ef12124c9)

2004-08-07 Aaron Spangler

* README.LDAP:

  More behavior notes
  [[f62576942]](https://git.sudo.ws/sudo/commit/?id=f62576942)

* README.LDAP:

  Updates on current behavior
  [[aafff3c21]](https://git.sudo.ws/sudo/commit/?id=aafff3c21)

2004-08-06 Todd C. Miller

* sudoers.pod:

  =back does not take an indentlevel (makes no difference to formatted
  files).
  [[0ad6600cc]](https://git.sudo.ws/sudo/commit/?id=0ad6600cc)

* sudo.pod:

  =back does not take an indentlevel (makes no difference to formatted
  files).
  [[6f44518f3]](https://git.sudo.ws/sudo/commit/?id=6f44518f3)

* CHANGES:

  new
  [[23c0e4ea1]](https://git.sudo.ws/sudo/commit/?id=23c0e4ea1)

* sudo.c:

  Consistency. Use same error for bad -u #uid when targetpw is set as we
  do when a bad -u username is specified.
  [[3c6bb6c79]](https://git.sudo.ws/sudo/commit/?id=3c6bb6c79)

* TODO:

  Add checksum idea from Steve Mancini
  [[8013ece9b]](https://git.sudo.ws/sudo/commit/?id=8013ece9b)

* sudoers.cat, sudoers.man.in:

  regen
  [[1e9dcd837]](https://git.sudo.ws/sudo/commit/?id=1e9dcd837)

* sudo.cat, sudo.man.in:

  regen
  [[95ef97652]](https://git.sudo.ws/sudo/commit/?id=95ef97652)

* sudo.pod, sudoers.pod:

  Document the restriction on uids specified via -u when targetpw is set.
  [[bc1b9cb80]](https://git.sudo.ws/sudo/commit/?id=bc1b9cb80)

* sudo.c:

  Error out when targetpw is enabled and sudo is run with -u #uid but #uid
  does not exist in the passwd database. We can’t do target authentication
  when the target is not in passwd!
  [[252093fa6]](https://git.sudo.ws/sudo/commit/?id=252093fa6)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in:

  regen
  [[e41a38e38]](https://git.sudo.ws/sudo/commit/?id=e41a38e38)

* TODO:

  Some more todo for the next release.
  [[e2bc02a1d]](https://git.sudo.ws/sudo/commit/?id=e2bc02a1d)

* INSTALL:

  Make it clear that PAM should be used for DCE support when possible.
  [[15222dbc1]](https://git.sudo.ws/sudo/commit/?id=15222dbc1)

* sudoers.pod:

  o Document problems with wildcards and relative paths. o Make the order
  requirements more prominent. o Change a “set” to “reset” for clarity.
  [[14be1c37d]](https://git.sudo.ws/sudo/commit/?id=14be1c37d)

2004-08-05 Todd C. Miller

* sudo.pod:

  Mention –with-secure-path, not SECURE\_PATH.
  [[0adaed9c9]](https://git.sudo.ws/sudo/commit/?id=0adaed9c9)

2004-08-03 Aaron Spangler

* ldap.c:

  reflect changes to parse.c
  [[02381e4c2]](https://git.sudo.ws/sudo/commit/?id=02381e4c2)

2004-08-02 Todd C. Miller

* sudo.tab.c:

  regen
  [[bf4f5913d]](https://git.sudo.ws/sudo/commit/?id=bf4f5913d)

* parse.c, parse.h, testsudoers.c, visudo.c:

  Don’t pass user\_cmnd and user\_args to command\_matches(), just use the
  globals there. Since we keep state with statics anyway it is misleading
  to pretend that passing in different cmnd and cmnd\_args will work.
  [[1a46dd74f]](https://git.sudo.ws/sudo/commit/?id=1a46dd74f)

* parse.yacc:

  Don’t pass user\_cmnd and user\_args to command\_matches(), just use the
  globals there. Since we keep state with statics anyway it is misleading
  to pretend that passing in different cmnd and cmnd\_args will work.
  [[600e9e394]](https://git.sudo.ws/sudo/commit/?id=600e9e394)

* parse.c:

  Fix a bug introduced in rev. 1.149. When checking for pseudo-commands
  check for a ‘/’ anywhere in cmnd, not just the first character.
  [[98fb55387]](https://git.sudo.ws/sudo/commit/?id=98fb55387)

2004-07-31 Aaron Spangler

* sudo.man.in, sudo.pod:

  Clarification thanks to Olivier Blin <oblin@…>
  [[5f3d569e3]](https://git.sudo.ws/sudo/commit/?id=5f3d569e3)

* sudoers.man.in, sudoers.pod:

  Add ignore\_local\_sudoers
  [[ed8a3eeed]](https://git.sudo.ws/sudo/commit/?id=ed8a3eeed)

* README.LDAP:

  Sun One schema definition by Andreas.Bussjaeger@… and
  janth@moldung.no
  [[d634a4e46]](https://git.sudo.ws/sudo/commit/?id=d634a4e46)

2004-07-29 Todd C. Miller

* CHANGES:

  typo
  [[44b6e87c9]](https://git.sudo.ws/sudo/commit/?id=44b6e87c9)

2004-07-23 Todd C. Miller

* CHANGES:

  sync
  [[e8aa17107]](https://git.sudo.ws/sudo/commit/?id=e8aa17107)

* parse.c:

  Parse sudoers file as PERM\_RUNAS not PERM\_ROOT and remove a useless
  PERM\_SUDOERS. Restore to PERM\_ROOT upon exit of the parse.
  [[8ce996770]](https://git.sudo.ws/sudo/commit/?id=8ce996770)

2004-07-08 Todd C. Miller

* CHANGES:

  PAM change
  [[8573f78c9]](https://git.sudo.ws/sudo/commit/?id=8573f78c9)

2004-07-08 Aaron Spangler

* ldap.c:

  Better debugging of ALL command
  [[921f74613]](https://git.sudo.ws/sudo/commit/?id=921f74613)

2004-07-08 Todd C. Miller

* parse.c:

  When matching for “sudoedit” in sudoers check both the command the user
  typed *and* the command that is listed in the sudoers entry.
  [[a6fe34784]](https://git.sudo.ws/sudo/commit/?id=a6fe34784)

2004-07-04 Aaron Spangler

* ldap.c:

  Added !command feature
  [[5e8d3f8f2]](https://git.sudo.ws/sudo/commit/?id=5e8d3f8f2)

2004-06-28 Todd C. Miller

* auth/pam.c:

  Use pam\_acct\_mgmt() to check for disabled accounts; Brian Farrell
  [[529d2d200]](https://git.sudo.ws/sudo/commit/?id=529d2d200)

2004-06-11 Todd C. Miller

* LICENSE:

  License is ISC-style, not BSD-style
  [[15fc7f686]](https://git.sudo.ws/sudo/commit/?id=15fc7f686)

* CHANGES:

  sync
  [[3e4144b0a]](https://git.sudo.ws/sudo/commit/?id=3e4144b0a)

2004-06-10 Todd C. Miller

* sudo.cat, sudo.man.in:

  regen
  [[5f7943db5]](https://git.sudo.ws/sudo/commit/?id=5f7943db5)

* sudo.pod:

  o Update some out of date bits to reality o Change the shell promt in
  examples to bourne-shell style o Clarify some details o Add a CAVEAT
  about “sudo cd /foo”
  [[18dae902b]](https://git.sudo.ws/sudo/commit/?id=18dae902b)

* check.c:

  Don’t ask for a password if invoking user == target user.
  [[31f98d84d]](https://git.sudo.ws/sudo/commit/?id=31f98d84d)

* sudo.c:

  typo in comment
  [[20815542a]](https://git.sudo.ws/sudo/commit/?id=20815542a)

2004-06-08 Todd C. Miller

* sudoers.cat, sudoers.man.in:

  regen
  [[ceb351fd9]](https://git.sudo.ws/sudo/commit/?id=ceb351fd9)

* sudoers.pod:

  Expand on NOEXEC a little.
  [[fc1dea2ed]](https://git.sudo.ws/sudo/commit/?id=fc1dea2ed)

* TODO:

  sync
  [[bf8eb4bca]](https://git.sudo.ws/sudo/commit/?id=bf8eb4bca)

* visudo.cat, visudo.man.in:

  regen
  [[88828092c]](https://git.sudo.ws/sudo/commit/?id=88828092c)

* sudo.tab.c:

  regen
  [[208736746]](https://git.sudo.ws/sudo/commit/?id=208736746)

* visudo.pod:

  Add a check in visudo for runas\_default being set after it has already
  been used.
  [[906c12c75]](https://git.sudo.ws/sudo/commit/?id=906c12c75)

* CHANGES, parse.yacc, visudo.c:

  Add a check in visudo for runas\_default being set after it has already
  been used.
  [[ce1b21d42]](https://git.sudo.ws/sudo/commit/?id=ce1b21d42)

* sudo.tab.c:

  regen
  [[517d8af5e]](https://git.sudo.ws/sudo/commit/?id=517d8af5e)

* parse.yacc:

  Add a MATCHED macro for testing whether foo\_matches has been set to TRUE
  or FALSE. This is more readable than checking for >=0 or < 0. Doesn’t
  change the actual code generated.
  [[13b0c693d]](https://git.sudo.ws/sudo/commit/?id=13b0c693d)

2004-06-07 Todd C. Miller

* sudoers.cat:

  regen
  [[34288539a]](https://git.sudo.ws/sudo/commit/?id=34288539a)

* sudoers.man.in:

  regen
  [[62732558c]](https://git.sudo.ws/sudo/commit/?id=62732558c)

* sudoers.pod:

  Correct description of where Defaults specs should go.
  [[213a92e2f]](https://git.sudo.ws/sudo/commit/?id=213a92e2f)

* sudoers:

  Correct description of where Defaults specs should go.
  [[f5b70b6b2]](https://git.sudo.ws/sudo/commit/?id=f5b70b6b2)

* testsudoers.c, visudo.c:

  update (c) year
  [[c01dbab98]](https://git.sudo.ws/sudo/commit/?id=c01dbab98)

* logging.h:

  update (c) year
  [[f9b934d8a]](https://git.sudo.ws/sudo/commit/?id=f9b934d8a)

* ldap.c:

  update (c) year
  [[ed7aee0e2]](https://git.sudo.ws/sudo/commit/?id=ed7aee0e2)

* find\_path.c:

  update (c) year
  [[1273bf257]](https://git.sudo.ws/sudo/commit/?id=1273bf257)

* auth/pam.c:

  update (c) year
  [[ecdfa6373]](https://git.sudo.ws/sudo/commit/?id=ecdfa6373)

* auth/bsdauth.c, auth/kerb5.c:

  update (c) year
  [[8268535cc]](https://git.sudo.ws/sudo/commit/?id=8268535cc)

2004-06-06 Todd C. Miller

* sudo.tab.c:

  regen
  [[0543ced78]](https://git.sudo.ws/sudo/commit/?id=0543ced78)

* auth/bsdauth.c, auth/kerb5.c, auth/pam.c, visudo.c:

  Remove trailing spaces, no actual code changes.
  [[77791e7ab]](https://git.sudo.ws/sudo/commit/?id=77791e7ab)

* tgetpass.c:

  Remove trailing spaces, no actual code changes.
  [[806fac889]](https://git.sudo.ws/sudo/commit/?id=806fac889)

* ldap.c, logging.h, parse.c, parse.yacc, sudo.c, testsudoers.c:

  Remove trailing spaces, no actual code changes.
  [[713e419fe]](https://git.sudo.ws/sudo/commit/?id=713e419fe)

* getcwd.c:

  Remove trailing spaces, no actual code changes.
  [[2154e5f09]](https://git.sudo.ws/sudo/commit/?id=2154e5f09)

* find\_path.c:

  Remove trailing spaces, no actual code changes.
  [[7ed41967a]](https://git.sudo.ws/sudo/commit/?id=7ed41967a)

* compat.h, defaults.c, env.c:

  Remove trailing spaces, no actual code changes.
  [[362d6f4eb]](https://git.sudo.ws/sudo/commit/?id=362d6f4eb)

* check.c:

  Remove trailing spaces, no actual code changes.
  [[ba803b6e1]](https://git.sudo.ws/sudo/commit/?id=ba803b6e1)

* sudo.tab.c:

  regen
  [[983bdcb22]](https://git.sudo.ws/sudo/commit/?id=983bdcb22)

* parse.yacc:

  Fix a >=0 that should be <0 that was improperly converted when UNSPEC
  was added.
  [[318cd646f]](https://git.sudo.ws/sudo/commit/?id=318cd646f)

* parse.yacc:

  Add do {} while(0) around pop macro Set cmnd\_matches to UNSPEC, not
  NOMATCH when resetting it.
  [[4e73e5c38]](https://git.sudo.ws/sudo/commit/?id=4e73e5c38)

* parse.yacc:

  Fix pastos introduced in SETNMATCH addition.
  [[a5c99554d]](https://git.sudo.ws/sudo/commit/?id=a5c99554d)

2004-06-05 Todd C. Miller

* README.LDAP:

  Update for configure changes
  [[2aa69afaa]](https://git.sudo.ws/sudo/commit/?id=2aa69afaa)

* sudo.tab.c:

  regen
  [[f8e2108d4]](https://git.sudo.ws/sudo/commit/?id=f8e2108d4)

* sudo.h:

  Add NOMATCH and UNSPEC defines (-1 and -2 respectively) and use these in
  parse.yacc. Also in parse.yacc initialize the \*\_matches vars to UNSPEC
  and add two macros, SETMATCH and SETNMATCH for use when setting
  \*\_matches to a value that may be NOMATCH/UNSPEC/TRUE/FALSE.
  [[a99f53e2f]](https://git.sudo.ws/sudo/commit/?id=a99f53e2f)

* parse.yacc:

  Add NOMATCH and UNSPEC defines (-1 and -2 respectively) and use these in
  parse.yacc. Also in parse.yacc initialize the \*\_matches vars to UNSPEC
  and add two macros, SETMATCH and SETNMATCH for use when setting
  \*\_matches to a value that may be NOMATCH/UNSPEC/TRUE/FALSE.
  [[46e37d41a]](https://git.sudo.ws/sudo/commit/?id=46e37d41a)

* parse.yacc:

  Initialize runas to -2, not -1 since we need to be able to distinguish
  between the initialized value and the value of a non-match when passing
  along the runas value to multiple commands.

  The result of this is that an unmatched runas is now set to -1, not 0.
  This is required now that parse.c treats a FALSE value for runas as
  being explicitly denied.
  [[385372b4d]](https://git.sudo.ws/sudo/commit/?id=385372b4d)

2004-06-03 Todd C. Miller

* sudo.c, visudo.c:

  Error out if argc < 1.
  [[3e1e279d2]](https://git.sudo.ws/sudo/commit/?id=3e1e279d2)

* getprogname.c:

  Error out if argc < 1.
  [[46fa00164]](https://git.sudo.ws/sudo/commit/?id=46fa00164)

* configure, configure.in:

  Add tests for what libs we need to link with for ldap and for whether or
  not lber.h needs to be explicitly included.
  [[24dd77986]](https://git.sudo.ws/sudo/commit/?id=24dd77986)

2004-06-03 Aaron Spangler

* ldap.c:

  Solaris native LDAP build fix
  [[115869110]](https://git.sudo.ws/sudo/commit/?id=115869110)

2004-06-01 Todd C. Miller

* ldap.c:

  Set edn to NULL is ldap\_get\_dn() fails to avoid potential use of an
  unset variable.
  [[23da57f9f]](https://git.sudo.ws/sudo/commit/?id=23da57f9f)

* sudo.h:

  Add prototype for sudo\_ldap\_list\_matches
  [[03d1a9ed4]](https://git.sudo.ws/sudo/commit/?id=03d1a9ed4)

* configure, configure.in:

  Better check for dirfd macro–we now set HAVE\_DIRFD for the macro
  version too. Added check for dd\_fd in `DIR’ if no dirfd is found; this
  is now used to confitionally define the dirfd macro in compat.h.
  [[e009af0c9]](https://git.sudo.ws/sudo/commit/?id=e009af0c9)

* config.h.in:

  Better check for dirfd macro–we now set HAVE\_DIRFD for the macro
  version too. Added check for dd\_fd in `DIR’ if no dirfd is found; this
  is now used to confitionally define the dirfd macro in compat.h.
  [[610da19a8]](https://git.sudo.ws/sudo/commit/?id=610da19a8)

* compat.h:

  Better check for dirfd macro–we now set HAVE\_DIRFD for the macro
  version too. Added check for dd\_fd in `DIR’ if no dirfd is found; this
  is now used to confitionally define the dirfd macro in compat.h.
  [[330d2ff42]](https://git.sudo.ws/sudo/commit/?id=330d2ff42)

* closefrom.c:

  Only check /proc/$$/fd if we have the dirfd function/macro.
  [[cebfa4c03]](https://git.sudo.ws/sudo/commit/?id=cebfa4c03)

* compat.h, config.h.in, configure, configure.in:

  Add a check for a dirfd() function (like Linux) and add a dirfd macro in
  compat.h if there is no dirfd() function or macro.
  [[54cb0921d]](https://git.sudo.ws/sudo/commit/?id=54cb0921d)

* closefrom.c, getcwd.c:

  dirfd() is now defined in compat.h as needed.
  [[a79bb7268]](https://git.sudo.ws/sudo/commit/?id=a79bb7268)

* CHANGES:

  Clarify closefrom() note.
  [[d55466c02]](https://git.sudo.ws/sudo/commit/?id=d55466c02)

* parse.c:

  When checking for a command in the directory, only copy the base dir
  once.
  [[b954f0bc9]](https://git.sudo.ws/sudo/commit/?id=b954f0bc9)

* closefrom.c:

  If there is a /proc/$$/fd directory, behave like the Solaris closefrom()
  and only close the descriptors listed therein.
  [[e2a573d6c]](https://git.sudo.ws/sudo/commit/?id=e2a573d6c)

* alloc.c:

  compat.h guarantees INT\_MAX is defined.
  [[5cb8b8349]](https://git.sudo.ws/sudo/commit/?id=5cb8b8349)

* compat.h:

  Add definitions of OPEN\_MAX and INT\_MAX for those without it and remove
  definition of RLIM\_INFINITY (now unused).
  [[397019519]](https://git.sudo.ws/sudo/commit/?id=397019519)

* CHANGES, alloc.c, check.c, compat.h, find\_path.c, getcwd.c, parse.c,
  sudo.c, sudo.h, visudo.c:

  Use PATH\_MAX, not MAXPATHLEN since the former is standardized.
  [[d33ad9520]](https://git.sudo.ws/sudo/commit/?id=d33ad9520)

2004-05-31 Todd C. Miller

* CHANGES:

  sync
  [[3bce9860f]](https://git.sudo.ws/sudo/commit/?id=3bce9860f)

* RUNSON:

  Add some entries that were mailed in a while ago
  [[13b900c84]](https://git.sudo.ws/sudo/commit/?id=13b900c84)

* closefrom.c:

  o sysconf returns a long, not an int. o check for negative return value
  from sysconf/getdtablesize and use OPEN\_MAX in this case. o define
  OPEN\_MAX to 256 for those without it (a fair guess…)
  [[2f323ada7]](https://git.sudo.ws/sudo/commit/?id=2f323ada7)

2004-05-30 Todd C. Miller

* UPGRADE:

  Mention change in parse order for RunAs entries.
  [[8d8bc778d]](https://git.sudo.ws/sudo/commit/?id=8d8bc778d)

* configure:

  regen
  [[2d8fab307]](https://git.sudo.ws/sudo/commit/?id=2d8fab307)

2004-05-29 Todd C. Miller

* INSTALL, README.LDAP, config.h.in, configure.in:

  o –with-ldap now takes an optional dir as a parameter o added check for
  ldap\_initialize() and start\_tls\_s()
  [[f64a92347]](https://git.sudo.ws/sudo/commit/?id=f64a92347)

* README.LDAP:

  Fix some typos, word choice and formatting issues.
  [[286f74780]](https://git.sudo.ws/sudo/commit/?id=286f74780)

2004-05-28 Todd C. Miller

* tgetpass.c:

  Use SA\_INTERRUPT so SunOS works correctly, avoid stdio and just use
  read/write as it is simpler.
  [[f8176ceda]](https://git.sudo.ws/sudo/commit/?id=f8176ceda)

* configure, configure.in:

  Remove hack overriding cross-compiler check. It should no longer be
  needed.
  [[1a76be42f]](https://git.sudo.ws/sudo/commit/?id=1a76be42f)

* compat.h:

  Remove select() compat bits since we no longer use select().
  [[c0ee2095b]](https://git.sudo.ws/sudo/commit/?id=c0ee2095b)

* CHANGES, tgetpass.c:

  Use alarm() instead of select() for the timeout for systems that don’t
  fully/properly implement select().
  [[47b833d4c]](https://git.sudo.ws/sudo/commit/?id=47b833d4c)

2004-05-27 Todd C. Miller

* CHANGES:

  synbc
  [[97f43c49f]](https://git.sudo.ws/sudo/commit/?id=97f43c49f)

* RUNSON:

  update
  [[051826c8c]](https://git.sudo.ws/sudo/commit/?id=051826c8c)

* set\_perms.c:

  Deal with systems that have no way of setting the effective uid such as
  nsr-tandem-nsk.
  [[b5376f8d2]](https://git.sudo.ws/sudo/commit/?id=b5376f8d2)

* configure, configure.in:

  Define NO\_SAVED\_IDS if we don’t find seteuid()
  [[e4506e81a]](https://git.sudo.ws/sudo/commit/?id=e4506e81a)

* config.h.in, configure, configure.in:

  Add back check for setreuid() since NSK doesn’t have it.
  [[224f05ad1]](https://git.sudo.ws/sudo/commit/?id=224f05ad1)

* sudoers.cat, sudoers.man.in:

  regen
  [[d94c6f36b]](https://git.sudo.ws/sudo/commit/?id=d94c6f36b)

* CHANGES:

  sync
  [[4ffe050bc]](https://git.sudo.ws/sudo/commit/?id=4ffe050bc)

* BUGS:

  sync
  [[76fa9ce50]](https://git.sudo.ws/sudo/commit/?id=76fa9ce50)

* parse.c:

  In sudoers\_lookup() return VALIDATE\_NOT\_OK if the runas user was
  explicitly denied and the command matched. This fixes a long-standing
  bug and makes: foo machine = (ALL) /usr/bin/blah foo machine = (!bar)
  /usr/bin/blah

  equivalent to: foo machine = (ALL, !bar) /usr/bin/blah
  [[5150db1db]](https://git.sudo.ws/sudo/commit/?id=5150db1db)

* sudoers.pod:

  Clarify mail\_noperm
  [[406db89f1]](https://git.sudo.ws/sudo/commit/?id=406db89f1)

2004-05-20 Aaron Spangler

* Makefile.in:

  Missing DESTDIR in make install for sudo\_noexec.la
  [[12411c9c0]](https://git.sudo.ws/sudo/commit/?id=12411c9c0)

2004-05-17 Todd C. Miller

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in, visudo.cat,
  visudo.man.in:

  regen
  [[1a998e47d]](https://git.sudo.ws/sudo/commit/?id=1a998e47d)

* TODO:

  sync
  [[034ae50b8]](https://git.sudo.ws/sudo/commit/?id=034ae50b8)

* sudoers.pod:

  Remove fastboot/fasthalt (who still remembers these?) and add a minimal
  sudoedit example.
  [[d0f638db7]](https://git.sudo.ws/sudo/commit/?id=d0f638db7)

* sample.sudoers:

  Remove fastboot/fasthalt (who still remembers these?) and add a minimal
  sudoedit example.
  [[46e6dcf79]](https://git.sudo.ws/sudo/commit/?id=46e6dcf79)

* UPGRADE, sudo.c, visudo.c:

  filesystem -> file system
  [[e6f074282]](https://git.sudo.ws/sudo/commit/?id=e6f074282)

* TROUBLESHOOTING:

  filesystem -> file system
  [[2778555f3]](https://git.sudo.ws/sudo/commit/?id=2778555f3)

* CHANGES, INSTALL:

  filesystem -> file system
  [[1ba185ee6]](https://git.sudo.ws/sudo/commit/?id=1ba185ee6)

* sudo.pod, sudoers.pod:

  Fix some minor typos and formatting goofs
  [[c7d5a998d]](https://git.sudo.ws/sudo/commit/?id=c7d5a998d)

* lex.yy.c:

  regen
  [[b96c5e559]](https://git.sudo.ws/sudo/commit/?id=b96c5e559)

* visudo.pod:

  remove my email addr
  [[e4e12a8fe]](https://git.sudo.ws/sudo/commit/?id=e4e12a8fe)

* sudo.pod, sudoers.pod, visudo.pod:

  Use @mansectform@ and @mansectsu@ everywhere Make man page
  references links with L<>
  [[d5e0c4d82]](https://git.sudo.ws/sudo/commit/?id=d5e0c4d82)

* parse.lex:

  Accept quoted globbing characters and pass them verbatim for fnmatch()
  [[53d91bcce]](https://git.sudo.ws/sudo/commit/?id=53d91bcce)

* UPGRADE:

  Document that /tmp/.odus is gone.
  [[f6f6c0b79]](https://git.sudo.ws/sudo/commit/?id=f6f6c0b79)

* pathnames.h.in:

  No longer use /tmp/.odus as a possible timestamp dir unless specifically
  configured to do so. Instead, if no /var/run exists, use /var/adm/sudo
  or /usr/adm/sudo.
  [[4467a95f4]](https://git.sudo.ws/sudo/commit/?id=4467a95f4)

* configure:

  No longer use /tmp/.odus as a possible timestamp dir unless specifically
  configured to do so. Instead, if no /var/run exists, use /var/adm/sudo
  or /usr/adm/sudo.
  [[ed9475a8c]](https://git.sudo.ws/sudo/commit/?id=ed9475a8c)

* aclocal.m4:

  No longer use /tmp/.odus as a possible timestamp dir unless specifically
  configured to do so. Instead, if no /var/run exists, use /var/adm/sudo
  or /usr/adm/sudo.
  [[233fdc787]](https://git.sudo.ws/sudo/commit/?id=233fdc787)

* CHANGES:

  No longer use /tmp/.odus as a possible timestamp dir unless specifically
  configured to do so. Instead, if no /var/run exists, use /var/adm/sudo
  or /usr/adm/sudo.
  [[13050dc4d]](https://git.sudo.ws/sudo/commit/?id=13050dc4d)

* set\_perms.c, sudo.c, tgetpass.c, visudo.c:

  Preliminary changes to support nsr-tandem-nsk. Based on patches from Tom
  Bates.
  [[a6849607c]](https://git.sudo.ws/sudo/commit/?id=a6849607c)

* logging.c:

  Preliminary changes to support nsr-tandem-nsk. Based on patches from Tom
  Bates.
  [[b0a49825e]](https://git.sudo.ws/sudo/commit/?id=b0a49825e)

* check.c, compat.h:

  Preliminary changes to support nsr-tandem-nsk. Based on patches from Tom
  Bates.
  [[51c9ed319]](https://git.sudo.ws/sudo/commit/?id=51c9ed319)

2004-05-16 Todd C. Miller

* CHANGES:

  There was no 1.6.7p6.
  [[1e7afec7f]](https://git.sudo.ws/sudo/commit/?id=1e7afec7f)

* BUGS, CHANGES:

  sync
  [[1862f550f]](https://git.sudo.ws/sudo/commit/?id=1862f550f)

* Makefile.in:

  add missing files to DISTFILES
  [[59de2968f]](https://git.sudo.ws/sudo/commit/?id=59de2968f)

* sudo.cat, sudoers.cat, visudo.cat:

  regen
  [[f4d073b89]](https://git.sudo.ws/sudo/commit/?id=f4d073b89)

* sudoers.man.in:

  regen
  [[7366ce4da]](https://git.sudo.ws/sudo/commit/?id=7366ce4da)

* Makefile.in:

  Fix some line wrap and update (c) year
  [[52d63d6d7]](https://git.sudo.ws/sudo/commit/?id=52d63d6d7)

2004-04-28 Aaron Spangler

* README.LDAP:

  Build Note
  [[93bf2196c]](https://git.sudo.ws/sudo/commit/?id=93bf2196c)

2004-04-07 Aaron Spangler

* Makefile.in:

  Fix install-dirs
  [[fe449ba2b]](https://git.sudo.ws/sudo/commit/?id=fe449ba2b)

2004-04-05 Todd C. Miller

* sudo.tab.c:

  regen
  [[a30d516f6]](https://git.sudo.ws/sudo/commit/?id=a30d516f6)

* visudo.c:

  In Exit() when used as a signal handler, emsg is a pointer so sizeof()
  is wrong so make it a #define instead. Also avoid using a negative exit
  value. Found by Aaron Campbell
  [[2e121633d]](https://git.sudo.ws/sudo/commit/?id=2e121633d)

2004-03-24 Todd C. Miller

* sudoers.pod:

  Remove bogus sentence about uids in a User\_List. Document usernames vs.
  uid parsing in a Runas\_List.
  [[3b8dbaf49]](https://git.sudo.ws/sudo/commit/?id=3b8dbaf49)

* parse.c, parse.h, parse.yacc, sudo.c, testsudoers.c, visudo.c:

  If the user specified a uid with the -u flag and the uid exists in the
  passwd file, set runas\_user to the name, not the uid.

  When comparing usernames in sudoers, if a name is really a uid (starts
  with ‘#’) compare it numerically to pw\_uid.
  [[6190f376c]](https://git.sudo.ws/sudo/commit/?id=6190f376c)

2004-03-22 Todd C. Miller

* auth/kerb5.c:

  krb5\_mcc\_ops should be const; Johnny C. Lam
  [[631cbc285]](https://git.sudo.ws/sudo/commit/?id=631cbc285)

2004-02-28 Aaron Spangler

* CHANGES, config.h.in, ldap.c:

  Added start\_tls support
  [[42cfd5612]](https://git.sudo.ws/sudo/commit/?id=42cfd5612)

2004-02-14 Todd C. Miller

* Makefile.in:

  Clean up libtool stuff for ‘make distclean’ and add def\_data.c,
  def\_data.h to PARSESRCS.
  [[88b2dd450]](https://git.sudo.ws/sudo/commit/?id=88b2dd450)

2004-02-14 Aaron Spangler

* strlcat.c, strlcpy.c:

  Un-Fix last license munge
  [[cbfbde616]](https://git.sudo.ws/sudo/commit/?id=cbfbde616)

2004-02-13 Todd C. Miller

* configure:

  regen
  [[dee266e4d]](https://git.sudo.ws/sudo/commit/?id=dee266e4d)

* CHANGES, RUNSON, TODO:

  checkpoint
  [[e938290a2]](https://git.sudo.ws/sudo/commit/?id=e938290a2)

* lex.yy.c, sudo.tab.c:

  regen
  [[a872ff046]](https://git.sudo.ws/sudo/commit/?id=a872ff046)

* auth/passwd.c, auth/rfc1938.c, auth/secureware.c, auth/securid.c,
  auth/securid5.c, auth/sia.c, auth/sudo\_auth.c, auth/sudo\_auth.h,
  emul/search.h, emul/utime.h:

  More to a less restrictive, ISC-style license.
  [[d2fa9af02]](https://git.sudo.ws/sudo/commit/?id=d2fa9af02)

* auth/kerb5.c, auth/pam.c:

  More to a less restrictive, ISC-style license.
  [[56b5cbc89]](https://git.sudo.ws/sudo/commit/?id=56b5cbc89)

* auth/dce.c, auth/fwtk.c, auth/kerb4.c:

  More to a less restrictive, ISC-style license.
  [[1a1009c06]](https://git.sudo.ws/sudo/commit/?id=1a1009c06)

* auth/bsdauth.c:

  More to a less restrictive, ISC-style license.
  [[d58c9f6f9]](https://git.sudo.ws/sudo/commit/?id=d58c9f6f9)

* auth/afs.c, auth/aix\_auth.c, zero\_bytes.c:

  More to a less restrictive, ISC-style license.
  [[a1fa5aec5]](https://git.sudo.ws/sudo/commit/?id=a1fa5aec5)

* sudoers.man.in, sudoers.pod, testsudoers.c, tgetpass.c, visudo.c,
  visudo.man.in, visudo.pod:

  More to a less restrictive, ISC-style license.
  [[5befe6ddf]](https://git.sudo.ws/sudo/commit/?id=5befe6ddf)

* sudo\_noexec.c:

  More to a less restrictive, ISC-style license.
  [[78fd7d420]](https://git.sudo.ws/sudo/commit/?id=78fd7d420)

* strlcat.c, strlcpy.c, sudo.c, sudo.h, sudo.man.in, sudo.pod,
  sudo\_edit.c:

  More to a less restrictive, ISC-style license.
  [[21e3ca9cf]](https://git.sudo.ws/sudo/commit/?id=21e3ca9cf)

* sigaction.c, strerror.c:

  More to a less restrictive, ISC-style license.
  [[476c05aca]](https://git.sudo.ws/sudo/commit/?id=476c05aca)

* ldap.c, logging.c, logging.h, parse.c, parse.h, pathnames.h.in,
  set\_perms.c:

  More to a less restrictive, ISC-style license.
  [[3a2282c92]](https://git.sudo.ws/sudo/commit/?id=3a2282c92)

* getspwuid.c, goodpath.c, ins\_2001.h, ins\_classic.h, ins\_csops.h,
  ins\_goons.h, insults.h, interfaces.c, interfaces.h:

  More to a less restrictive, ISC-style license.
  [[fa96e1c86]](https://git.sudo.ws/sudo/commit/?id=fa96e1c86)

* find\_path.c, getprogname.c:

  More to a less restrictive, ISC-style license.
  [[b8ae391a9]](https://git.sudo.ws/sudo/commit/?id=b8ae391a9)

* fileops.c:

  More to a less restrictive, ISC-style license.
  [[3e996375b]](https://git.sudo.ws/sudo/commit/?id=3e996375b)

* env.c:

  More to a less restrictive, ISC-style license.
  [[5a2e5144d]](https://git.sudo.ws/sudo/commit/?id=5a2e5144d)

* defaults.h:

  More to a less restrictive, ISC-style license.
  [[3be828f78]](https://git.sudo.ws/sudo/commit/?id=3be828f78)

* LICENSE, Makefile.in, alloc.c, check.c, closefrom.c, compat.h,
  defaults.c:

  More to a less restrictive, ISC-style license.
  [[5b217d36a]](https://git.sudo.ws/sudo/commit/?id=5b217d36a)

* utime.c, version.h:

  More to a less restrictive, ISC-style license.
  [[8dccf8fcc]](https://git.sudo.ws/sudo/commit/?id=8dccf8fcc)

* parse.lex, parse.yacc:

  More to a less restrictive, ISC-style license.
  [[5bc294b71]](https://git.sudo.ws/sudo/commit/?id=5bc294b71)

* Makefile.binary:

  More to a less restrictive, ISC-style license.
  [[dda192f90]](https://git.sudo.ws/sudo/commit/?id=dda192f90)

2004-02-13 Aaron Spangler

* sudoers2ldif:

  Merged in LDAP Support
  [[9f0dda088]](https://git.sudo.ws/sudo/commit/?id=9f0dda088)

* ldap.c, sudo.c, sudo.h:

  Merged in LDAP Support
  [[b0226e939]](https://git.sudo.ws/sudo/commit/?id=b0226e939)

* def\_data.c, def\_data.h, def\_data.in:

  Merged in LDAP Support
  [[240f4e031]](https://git.sudo.ws/sudo/commit/?id=240f4e031)

* CHANGES, Makefile.in, README.LDAP, config.h.in, configure.in:

  Merged in LDAP Support
  [[bd9be2cf0]](https://git.sudo.ws/sudo/commit/?id=bd9be2cf0)

2004-02-08 Todd C. Miller

* sudo.h, sudo\_noexec.c:

  Only do “extern int errno” if errno is not a macro.
  [[d80d2e29a]](https://git.sudo.ws/sudo/commit/?id=d80d2e29a)

2004-02-06 Todd C. Miller

* set\_perms.c:

  setreuid(0, 0) fails on QNX if the euid is not already 0 so set the euid
  first, then just call setuid(0) to set the real uid too.
  [[a622cb279]](https://git.sudo.ws/sudo/commit/?id=a622cb279)

* set\_perms.c:

  Use setresuid() and setreuid() for PERM\_RUNAS when appropriate instead
  of seteuid() which may not exist.
  [[7bc6df024]](https://git.sudo.ws/sudo/commit/?id=7bc6df024)

2004-02-04 Todd C. Miller

* LICENSE:

  2004
  [[c7f9bb024]](https://git.sudo.ws/sudo/commit/?id=c7f9bb024)

* INSTALL, config.h.in, configure, configure.in, ins\_classic.h:

  Add –with-pc-insults configure option
  [[3a4d28310]](https://git.sudo.ws/sudo/commit/?id=3a4d28310)

* visudo.man.in:

  Prefer VISUAL over EDITOR like old vipw did.
  [[ff092a1a1]](https://git.sudo.ws/sudo/commit/?id=ff092a1a1)

2004-02-01 Todd C. Miller

* sudo.man.in, sudoers.man.in:

  regen
  [[cb467e2a5]](https://git.sudo.ws/sudo/commit/?id=cb467e2a5)

* sudoers.pod:

  Add a note that noexec is not a cure-all.
  [[3a31bf974]](https://git.sudo.ws/sudo/commit/?id=3a31bf974)

* sudoers.pod:

  Mention that disabling “root\_sudo” is pretty pointless.
  [[c892061f0]](https://git.sudo.ws/sudo/commit/?id=c892061f0)

* configure, configure.in:

  Substitute for root\_sudo in sudoers.pod
  [[a7039ea7b]](https://git.sudo.ws/sudo/commit/?id=a7039ea7b)

* sudo.pod:

  Add sudoedit to the NAME section
  [[be4bcc99c]](https://git.sudo.ws/sudo/commit/?id=be4bcc99c)

* sudoers.pod:

  Document that fact that setting ignore\_dot in sudoers has no effect due
  to the fact that find\_path() is called *before* sudoers is read.
  [[3802623a0]](https://git.sudo.ws/sudo/commit/?id=3802623a0)

2004-01-30 Todd C. Miller

* sudo\_edit.c:

  Do not require \_PATH\_USRTMP to be set.
  [[4716ea988]](https://git.sudo.ws/sudo/commit/?id=4716ea988)

* BUGS, CHANGES, TODO:

  sync
  [[926d3f5b5]](https://git.sudo.ws/sudo/commit/?id=926d3f5b5)

* sudo.man.in:

  regen
  [[9763592ef]](https://git.sudo.ws/sudo/commit/?id=9763592ef)

* sudo.pod:

  Clarify that when sudo is run by root with the SUDO\_USER variable set,
  the sudoers lookup happens for root and not the SUDO\_USER user.
  [[f452989c9]](https://git.sudo.ws/sudo/commit/?id=f452989c9)

2004-01-29 Todd C. Miller

* auth/pam.c, auth/sudo\_auth.c, interfaces.c, logging.c, parse.c,
  set\_perms.c, sigaction.c, sudo.c, tgetpass.c:

  Use the SET, CLR and ISSET macros.
  [[c4a8ab8b9]](https://git.sudo.ws/sudo/commit/?id=c4a8ab8b9)

* fnmatch.c:

  Use the SET, CLR and ISSET macros.
  [[fb5a1aa3a]](https://git.sudo.ws/sudo/commit/?id=fb5a1aa3a)

* defaults.c, env.c:

  Use the SET, CLR and ISSET macros.
  [[262bb5e87]](https://git.sudo.ws/sudo/commit/?id=262bb5e87)

* interfaces.h:

  MAIN was replaced with \_SUDO\_MAIN some time ago.
  [[22c30e08d]](https://git.sudo.ws/sudo/commit/?id=22c30e08d)

* sudo.c:

  Don’t look at prev\_user until after we’ve parsed sudoers and done the
  password check. That way, if sudo/sudoedit is run from a root process
  that was invoked by sudo, we check sudoers for root, not the previous
  user. This makes sudoedit much more useful and means that for the sudo
  case, we get correct logging on who actually ran the command.
  [[7a07ad864]](https://git.sudo.ws/sudo/commit/?id=7a07ad864)

2004-01-23 Todd C. Miller

* sudo\_edit.c:

  Add a comment describing why we need to be notified about our child
  stopping.
  [[2af994ada]](https://git.sudo.ws/sudo/commit/?id=2af994ada)

2004-01-22 Todd C. Miller

* def\_data.c, def\_data.in:

  Update the noexec variable descriptions
  [[04b8f60ca]](https://git.sudo.ws/sudo/commit/?id=04b8f60ca)

* sudoers.man.in, sudoers.pod:

  noexec now replaces more than just execve()
  [[5a972df0b]](https://git.sudo.ws/sudo/commit/?id=5a972df0b)

* sudo\_noexec.c:

  Alas, all the world does not go through execve(2). Many systems still
  have an execv(2) system call, Linux 2.6 provides fexecve(2) and it is
  not uncommon for libc to have underscore (’\_’) versions of the functions
  to be used internally by the library. Instead of stubbing all these out
  by hand, define a macro and let it do the work. Extra exec functions
  pointed out by Reznic Valery.
  [[4ad4ba174]](https://git.sudo.ws/sudo/commit/?id=4ad4ba174)

* sudo.c, sudo\_edit.c:

  Fix suspending the editor in -e mode. Because we do a fork() first we
  need to be notified when the child has been stopped and then send that
  same signal to ourself so the shell can do its job control thing.
  [[5ccddf817]](https://git.sudo.ws/sudo/commit/?id=5ccddf817)

* visudo.c:

  Use WIFEXITED and WEXITSTATUS macros. If there are systems out there
  that want to run sudo that still don’t support these we can try to deal
  with that later.
  [[24155a405]](https://git.sudo.ws/sudo/commit/?id=24155a405)

* lex.yy.c:

  regen
  [[6f2cfc2bc]](https://git.sudo.ws/sudo/commit/?id=6f2cfc2bc)

* sudo.man.in, sudo.pod, sudoers.man.in, sudoers.pod:

  Document sudo -e / sudoedit
  [[be8c6acf6]](https://git.sudo.ws/sudo/commit/?id=be8c6acf6)

* configure, configure.in:

  fix typo
  [[63e1f3dd9]](https://git.sudo.ws/sudo/commit/?id=63e1f3dd9)

* config.h.in, configure.in:

  Add SET/CLR/ISSET
  [[2d21140a3]](https://git.sudo.ws/sudo/commit/?id=2d21140a3)

2004-01-21 Todd C. Miller

* sudo.c:

  Allow non-exclusive flags when invoked as sudoedit. Pretty print the
  long usage() line to not wrap (assumes 80 char display)
  [[d1798a06b]](https://git.sudo.ws/sudo/commit/?id=d1798a06b)

* Makefile.in, sudo.c:

  If sudo is invoked as “sudoedit” the -e flag is implied and no other
  flags are permitted.
  [[2be964efe]](https://git.sudo.ws/sudo/commit/?id=2be964efe)

* sudo.h:

  Add a new flag, -e, that makes it possible to give users the ability to
  edit files with the editor of their choice as the invoking user, not the
  runas user. Temporary files are used for the actual edit and the temp
  file is copied over the original after the editor is done.
  [[c7d74402f]](https://git.sudo.ws/sudo/commit/?id=c7d74402f)

* Makefile.in, parse.c, parse.lex, sudo.c, sudo\_edit.c:

  Add a new flag, -e, that makes it possible to give users the ability to
  edit files with the editor of their choice as the invoking user, not the
  runas user. Temporary files are used for the actual edit and the temp
  file is copied over the original after the editor is done.
  [[4dc5700a6]](https://git.sudo.ws/sudo/commit/?id=4dc5700a6)

* env.c, sudo.c:

  If real uid == 0 and the SUDO\_USER environment variables is set, use
  that to determine the invoking user’s true identity. That way the proper
  info gets logged by someone who has done “sudo su” but still uses sudo
  to as root. We can’t do this for non-root users since that would open up
  a security hole, though perhaps it would be acceptable to use
  getlogin(2) on OSes where this a system call (and doesn’t just look in
  the utmp file).
  [[8ab5b8c59]](https://git.sudo.ws/sudo/commit/?id=8ab5b8c59)

* pathnames.h.in:

  Add \_PATH\_TMP, \_PATH\_VARTMP and \_PATH\_USRTMP
  [[cc7cfa707]](https://git.sudo.ws/sudo/commit/?id=cc7cfa707)

* config.h.in, configure, configure.in:

  Add check for fchown(2)
  [[f4a4d4c66]](https://git.sudo.ws/sudo/commit/?id=f4a4d4c66)

2004-01-20 Todd C. Miller

* sudo.c:

  Back out portions of the -i commit that set NewArgv[0] in set\_runaspw.
  It is far to late to set NewArgv[0] there and will have no effect anyway
  as cmnd and safe\_cmnd have already been set.
  [[063c2812e]](https://git.sudo.ws/sudo/commit/?id=063c2812e)

* visudo.c, visudo.pod:

  Prefer VISUAL over EDITOR like old vipw did.
  [[f068ee01c]](https://git.sudo.ws/sudo/commit/?id=f068ee01c)

2004-01-19 Todd C. Miller

* env.c, sudo.c:

  In -i mode always set new environment based on the runas user’s passwd
  entry.
  [[3001e7f29]](https://git.sudo.ws/sudo/commit/?id=3001e7f29)

2004-01-18 Todd C. Miller

* sudo.man.in, sudo.pod:

  Document the new -i flag and sync SYNOPSIS section with usage() in
  sudo.c. Also sort the flags in the OPTIONS section.
  [[1b7cf30c7]](https://git.sudo.ws/sudo/commit/?id=1b7cf30c7)

* sudo.c, sudo.h:

  o Add -i that acts similar to “su -”, based on patches from David J.
  MacKenzie o Sort the flags in the usage message
  [[1ca6264df]](https://git.sudo.ws/sudo/commit/?id=1ca6264df)

* sudoers.man.in, sudoers.pod:

  Add a missing @runas\_default@ substitution.
  [[7471253e6]](https://git.sudo.ws/sudo/commit/?id=7471253e6)

2004-01-17 Todd C. Miller

* sudo.c:

  Change euid to runas user before calling find\_path(). Unfortunately,
  though runas\_user can be modified in sudoers we haven’t parsed sudoers
  yet.
  [[c82381727]](https://git.sudo.ws/sudo/commit/?id=c82381727)

* sudoers.man.in, sudoers.pod:

  Add missing defintion of Parameter\_List and use single pipes in the
  Defaults EBNF definition.
  [[6def750d0]](https://git.sudo.ws/sudo/commit/?id=6def750d0)

* sudo.c:

  Fix a bug when set\_runaspw() is used as a callback. We don’t want to
  reset the contents of runas\_pw if the user specified a user via the -u
  flag.

  Avoid unnecessary passwd lookups in set\_authpw(). In most cases we
  already have the info in runas\_pw.
  [[03f5f4087]](https://git.sudo.ws/sudo/commit/?id=03f5f4087)

2004-01-16 Todd C. Miller

* check.c:

  Add Stan Lee / Uncle Ben quote to the lecture from RedHat
  [[e404f54c2]](https://git.sudo.ws/sudo/commit/?id=e404f54c2)

* sudo.h:

  Update sudo\_getepw() proto and add one for set\_runaspw()
  [[18027fa58]](https://git.sudo.ws/sudo/commit/?id=18027fa58)

* parse.c:

  If we can’t stat the command as root, try as the runas user instead.
  [[69d47fe75]](https://git.sudo.ws/sudo/commit/?id=69d47fe75)

* testsudoers.c, visudo.c:

  Add stub set\_runaspw() function
  [[327729a7e]](https://git.sudo.ws/sudo/commit/?id=327729a7e)

* sudo.c:

  Add set\_runaspw() function to fill in runas\_pw. This will be used as a
  callback to update runas\_pw when the runas user changes.
  [[febc09e14]](https://git.sudo.ws/sudo/commit/?id=febc09e14)

* env.c, sudo.c:

  PERM\_RUNAS -> PERM\_FULL\_RUNAS
  [[ecfc81375]](https://git.sudo.ws/sudo/commit/?id=ecfc81375)

* set\_perms.c, sudo.h:

  Rename PERM\_RUNAS -> PERM\_FULL\_RUNAS and add a PERM\_RUNAS that just
  changes the euid.
  [[ceb3653d7]](https://git.sudo.ws/sudo/commit/?id=ceb3653d7)

* getspwuid.c:

  Make sudo\_pwdup() act like OpenBSD pw\_dup() and allocate memory in one
  chunk for easy free()ing. Also change it from static to extern.
  [[de6ff287e]](https://git.sudo.ws/sudo/commit/?id=de6ff287e)

* defaults.c, defaults.h:

  Add callback support
  [[fb65156a7]](https://git.sudo.ws/sudo/commit/?id=fb65156a7)

* mkdefaults:

  Add a callback field and use it for runas\_default
  [[175e9e472]](https://git.sudo.ws/sudo/commit/?id=175e9e472)

* def\_data.c, def\_data.in:

  Add a callback field and use it for runas\_default
  [[487cd96e0]](https://git.sudo.ws/sudo/commit/?id=487cd96e0)

2004-01-15 Todd C. Miller

* auth/fwtk.c:

  Add support for chalnecho and display server responses used by fwtk >=
  2.0
  [[ae1a984af]](https://git.sudo.ws/sudo/commit/?id=ae1a984af)

2004-01-12 Todd C. Miller

* sudoers.man.in, sudoers.pod:

  ld.so is ld.so.1 on solaris
  [[db1196a91]](https://git.sudo.ws/sudo/commit/?id=db1196a91)

* Makefile.in, config.h.in, configure, configure.in, sudo.c, sudo.h:

  Use closefrom() instead of doing the equivalent inline.
  [[d55c3f63c]](https://git.sudo.ws/sudo/commit/?id=d55c3f63c)

* closefrom.c:

  closefrom(3) for systems w/o it
  [[a34078ac3]](https://git.sudo.ws/sudo/commit/?id=a34078ac3)

2004-01-09 Todd C. Miller

* sudoers.man.in:

  Update from .pod file.
  [[c493bb6b6]](https://git.sudo.ws/sudo/commit/?id=c493bb6b6)

* configure, configure.in:

  Substitute noexec\_file for the sudoers man page
  [[5c16da4f2]](https://git.sudo.ws/sudo/commit/?id=5c16da4f2)

* sudo.man.in, sudo.pod:

  Mention noexec
  [[051943b68]](https://git.sudo.ws/sudo/commit/?id=051943b68)

* sudoers.man.in, sudoers.pod:

  Document noexec
  [[67ba09fcc]](https://git.sudo.ws/sudo/commit/?id=67ba09fcc)

* auth/pam.c, config.h.in, configure.in:

  Move PAM\_CONST macro definition from config.h to pam.c where it belongs.
  We can’t have this in config.h since that gets included too early.
  [[149862cd9]](https://git.sudo.ws/sudo/commit/?id=149862cd9)

* auth/pam.c, config.h.in, configure, configure.in:

  Some PAM implementations put their headers in /usr/include/pam instead
  of /usr/include/security.
  [[aa4eb97ed]](https://git.sudo.ws/sudo/commit/?id=aa4eb97ed)

* configure.in:

  I missed changing the EXEC macro -> EXECV here when I changed this in
  config.h.in and sudo.c a while ago.
  [[5459af61d]](https://git.sudo.ws/sudo/commit/?id=5459af61d)

* acsite.m4:

  OpenBSD vax/m88k/hppa don’t do shared libs
  [[fce2b7491]](https://git.sudo.ws/sudo/commit/?id=fce2b7491)

* configure, configure.in:

  o merge the hpux case entries into a single entry w/ its own sub-case
  statement. o HP-UX >= 11 support getspnam(), use it in preference to
  getprpwuid()
  [[cd2bd25a8]](https://git.sudo.ws/sudo/commit/?id=cd2bd25a8)

* configure, configure.in:

  eval $shrext so that it expands nicely on MacOS X
  [[0aaea9826]](https://git.sudo.ws/sudo/commit/?id=0aaea9826)

* Makefile.in:

  Don’t lie about making a module, it does the wrong thing on mach
  [[c18a2a32e]](https://git.sudo.ws/sudo/commit/?id=c18a2a32e)

* ltmain.sh:

  Remove requirement that libs must begin with “lib”. They don’t when we
  point directly at the lib using LD\_PRELOAD or its equivalent.
  [[5206defd6]](https://git.sudo.ws/sudo/commit/?id=5206defd6)

* acsite.m4:

  Disable support for c++, f77 and java. We don’t need it, it takes a lot
  of time, and it hosed our check for shared lib support.
  [[7e6fe46e9]](https://git.sudo.ws/sudo/commit/?id=7e6fe46e9)

* configure:

  regen
  [[a71e4f169]](https://git.sudo.ws/sudo/commit/?id=a71e4f169)

* configure.in:

  Call AC\_ENABLE\_SHARED and check the status of enable\_shared to know when
  shared libs are available.
  [[f64956333]](https://git.sudo.ws/sudo/commit/?id=f64956333)

* acsite.m4:

  Duh, OpenBSD suports shared libs too
  [[bede9b7b5]](https://git.sudo.ws/sudo/commit/?id=bede9b7b5)

* config.h.in, configure.in:

  Only OpenPAM and Linux PAM use const qualifiers.
  [[b106eabb4]](https://git.sudo.ws/sudo/commit/?id=b106eabb4)

* configure, configure.in:

  o No need to check for sed, libtool config does that for us o move check
  for –with-noexec until after libtool magic is run so we can use
  $can\_build\_shared and $shrext
  [[9f8f030c5]](https://git.sudo.ws/sudo/commit/?id=9f8f030c5)

* ltmain.sh:

  Don’t print a bunch of crap about library installs since we are not
  really installing a library.
  [[ad13250c2]](https://git.sudo.ws/sudo/commit/?id=ad13250c2)

* env.c:

  Make format\_env() varargs Add noexec support for Darwin, MacOS X, Irix,
  and Tru64
  [[230a54ebb]](https://git.sudo.ws/sudo/commit/?id=230a54ebb)

* acsite.m4, ltconfig, ltmain.sh:

  Update to libtool 1.5 with local changes: o no ldconfig in the finish
  step o assume no libprefix or version is needed
  [[f192682f6]](https://git.sudo.ws/sudo/commit/?id=f192682f6)

* sudo\_noexec.c:

  Fix compilation under K&R
  [[dd4acb880]](https://git.sudo.ws/sudo/commit/?id=dd4acb880)

2004-01-06 Todd C. Miller

* CHANGES:

  checkpoint
  [[63e8d52f5]](https://git.sudo.ws/sudo/commit/?id=63e8d52f5)

* sudo\_noexec.c:

  stub execve() that just returns EACCES; used for noexec functionality
  [[e17ee88eb]](https://git.sudo.ws/sudo/commit/?id=e17ee88eb)

* sudo.tab.h:

  Regen w/ updated byacc from OpenBSD; fixes a gcc 3.2 issue with
  generated code.
  [[bac45090a]](https://git.sudo.ws/sudo/commit/?id=bac45090a)

* sudo.tab.c:

  Regen w/ updated byacc from OpenBSD; fixes a gcc 3.2 issue with
  generated code.
  [[a39a63f4f]](https://git.sudo.ws/sudo/commit/?id=a39a63f4f)

2004-01-05 Todd C. Miller

* def\_data.c, def\_data.h, def\_data.in:

  Move the environment defaults to the end and shorten a few of the
  descriptions.
  [[0f6749fa2]](https://git.sudo.ws/sudo/commit/?id=0f6749fa2)

* configure, configure.in:

  no shared libs on ultris or convexos
  [[8e796b909]](https://git.sudo.ws/sudo/commit/?id=8e796b909)

* Makefile.in, configure, configure.in:

  Build sudo\_noexec shared object using libtool; could use some cleanup.
  [[d9b9d94c3]](https://git.sudo.ws/sudo/commit/?id=d9b9d94c3)

* acsite.m4, ltconfig, ltmain.sh:

  libtool scaffolding
  [[9019ee7b4]](https://git.sudo.ws/sudo/commit/?id=9019ee7b4)

* parse.yacc, sudo.tab.c:

  Merge the NOPASSWD/PASSWD and NOEXEC/EXEC rules so that order is not
  important.
  [[db230cc52]](https://git.sudo.ws/sudo/commit/?id=db230cc52)

* defaults.c, env.c, lex.yy.c, parse.c, parse.h, parse.lex, parse.yacc,
  pathnames.h.in, sudo.c, sudo.h, sudo.tab.c:

  update copyright year
  [[8e421c95b]](https://git.sudo.ws/sudo/commit/?id=8e421c95b)

* configure, configure.in, defaults.c, env.c, pathnames.h.in:

  Add \_PATH\_SUDO\_NOEXEC and corresponding –with-noexec configure option.
  The default value of noexec\_file is set to this.
  [[626e2cd20]](https://git.sudo.ws/sudo/commit/?id=626e2cd20)

* def\_data.c, def\_data.h, def\_data.in, env.c, lex.yy.c, parse.c, parse.h,
  parse.lex, parse.yacc, sudo.c, sudo.h, sudo.tab.c, sudo.tab.h:

  Add support for preloading a shared object containing a dummy execve()
  function that just sets error and returns -1. This adds a “noexec\_file”
  option to load the filename as well as a “noexec” flag to enable it
  unconditionally. There is also a NOEXEC tag that can be attached to
  specific commands and an EXEC tag to disable it.
  [[7536a781f]](https://git.sudo.ws/sudo/commit/?id=7536a781f)

* mkdefaults:

  add missing newline to usage statement
  [[4d5ce6761]](https://git.sudo.ws/sudo/commit/?id=4d5ce6761)

* config.h.in, sudo.c:

  Rename EXEC macro -> EXECV
  [[caf389c2f]](https://git.sudo.ws/sudo/commit/?id=caf389c2f)

* logging.c:

  Don’t truncate usernames to 8 characters in the log message.
  [[e987e1152]](https://git.sudo.ws/sudo/commit/?id=e987e1152)

* check.c, sudoers.man.in, sudoers.pod:

  Update copyright year
  [[9eba370a0]](https://git.sudo.ws/sudo/commit/?id=9eba370a0)

* check.c, def\_data.c, def\_data.h, def\_data.in, sudoers.man.in,
  sudoers.pod:

  Add a new option, lecture\_file, that can be used to point to a custom
  sudo lecture.
  [[b289f7387]](https://git.sudo.ws/sudo/commit/?id=b289f7387)

2003-12-31 Todd C. Miller

* auth/aix\_auth.c, auth/bsdauth.c, auth/fwtk.c, auth/pam.c,
  auth/sudo\_auth.c:

  Add a zero\_bytes() function to do the equivalent of bzero in such a way
  that will heopfully not be optimized away by sneaky compilers.
  [[394423748]](https://git.sudo.ws/sudo/commit/?id=394423748)

* zero\_bytes.c:

  Add a zero\_bytes() function to do the equivalent of bzero in such a way
  that will heopfully not be optimized away by sneaky compilers.
  [[de5e16b22]](https://git.sudo.ws/sudo/commit/?id=de5e16b22)

* Makefile.in, sudo.h:

  Add a zero\_bytes() function to do the equivalent of bzero in such a way
  that will heopfully not be optimized away by sneaky compilers.
  [[b2550741c]](https://git.sudo.ws/sudo/commit/?id=b2550741c)

* err.c:

  Use #ifdef **STDC**, not #if **STDC**.
  [[617ac8a3c]](https://git.sudo.ws/sudo/commit/?id=617ac8a3c)

2003-12-30 Todd C. Miller

* mkdefaults:

  Always put at least one space between the def\_\* macro name and its
  definition.
  [[1cb570327]](https://git.sudo.ws/sudo/commit/?id=1cb570327)

* configure, configure.in:

  Adjust code for –without-lecture to match new values.
  [[ffbc43afb]](https://git.sudo.ws/sudo/commit/?id=ffbc43afb)

* visudo.man.in:

  regen after pasto fix
  [[e34adcc2c]](https://git.sudo.ws/sudo/commit/?id=e34adcc2c)

* sudoers.man.in, sudoers.pod:

  Document that “lecture” has changed from a flag to a tuple.
  [[3062ac665]](https://git.sudo.ws/sudo/commit/?id=3062ac665)

* check.c, def\_data.c, def\_data.h, def\_data.in, defaults.c, defaults.h,
  logging.c, mkdefaults, parse.c, sudo.c, sudo.h:

  Add support for tuples in def\_data.in; these are implemented as an enum
  type. Currently there is only a single tuple enum but in the future we
  may have one tuple enum per T\_TUPLE entry in def\_data.in. Currently
  listpw, verifypw and lecture are tuples. This avoids the need to have
  two entries (one ival, one str) for pwflags and syslog values.

  lecture is now a tuple with the following values: never, once, always

  We no longer use both an int and string entry for syslog facilities and
  priorities. Instead, there are logfac2str() and logpri2str() functions
  that get used when we need to print the string values.
  [[02f37dc2d]](https://git.sudo.ws/sudo/commit/?id=02f37dc2d)

* auth/aix\_auth.c, auth/bsdauth.c, auth/fwtk.c, auth/pam.c,
  auth/rfc1938.c, auth/securid5.c, auth/sia.c, auth/sudo\_auth.c, check.c,
  def\_data.h, defaults.c, defaults.h, env.c, find\_path.c, logging.c,
  mkdefaults, parse.c, parse.yacc, set\_perms.c, sudo.c, sudo.tab.c,
  visudo.c:

  Create def\_\* macros for each defaults value so we no longer need the
  def\_{flag,ival,str,list,mode} macros (which have been removed). This is
  a step toward more flexible data types in def\_data.in.
  [[6ad252765]](https://git.sudo.ws/sudo/commit/?id=6ad252765)

* TODO:

  checkpoint
  [[45fe0a6cc]](https://git.sudo.ws/sudo/commit/?id=45fe0a6cc)

2003-12-23 Todd C. Miller

* sudo.c:

  If we are in -k/-K mode, just spew to stderr. It is not unusual for
  users to place “sudo -k” in a .logout file which can cause sudo to be
  run during reboot after the YP/NIS/NIS+/LDAP/etc daemon has died.
  Previously, this would result in useless mail and logging.
  [[7f773be1f]](https://git.sudo.ws/sudo/commit/?id=7f773be1f)

2003-12-16 Todd C. Miller

* visudo.pod:

  fix pasto in VISUAL description
  [[ccef4e334]](https://git.sudo.ws/sudo/commit/?id=ccef4e334)

2003-12-10 Todd C. Miller

* configure:

  regen
  [[0ce9403a4]](https://git.sudo.ws/sudo/commit/?id=0ce9403a4)

* CHANGES:

  checkpoint
  [[cb081ff5e]](https://git.sudo.ws/sudo/commit/?id=cb081ff5e)

* TROUBLESHOOTING:

  Some OSes (like Solaris) allow export w/ nosuid too
  [[53a38fc56]](https://git.sudo.ws/sudo/commit/?id=53a38fc56)

2003-08-12 Todd C. Miller

* compat.h:

  We don’t use FD\_ZERO anymore so just define FD\_SET (if not already
  there).
  [[769b205c0]](https://git.sudo.ws/sudo/commit/?id=769b205c0)

2003-06-29 Todd C. Miller

* auth/pam.c:

  Fix a core dump on Solaris by preserving the pam\_handle\_t we used during
  authentication for pam\_prep\_user(). If we didn’t authenticate (ie:
  ticket still valid), we call pam\_init() from pam\_prep\_user(). This is
  something of a hack; it may be better to change the auth API and add an
  auth\_final() function that acts like pam\_prep\_user().
  [[d619fd43a]](https://git.sudo.ws/sudo/commit/?id=d619fd43a)

2003-06-21 Todd C. Miller

* set\_perms.c:

  Add explicit declaration of printerr variable in function header (was
  defaulting to int which is OK but oh so K&R :-). From Theo.
  [[8cd9f4f1e]](https://git.sudo.ws/sudo/commit/?id=8cd9f4f1e)

2003-06-09 Todd C. Miller

* config.h.in, configure.in:

  s/HAVE\_STOW/USE\_STOW/
  [[e52feabd4]](https://git.sudo.ws/sudo/commit/?id=e52feabd4)

* logging.c:

  Also exit waitpid() loop when pid == 0. Fixes a problem where the sudo
  process would spin eating up CPU until sendmail finished when it has to
  send mail.
  [[27ad285a0]](https://git.sudo.ws/sudo/commit/?id=27ad285a0)

2003-05-30 Todd C. Miller

* fnmatch.c:

  Remove advertising clause, UCB has disavowed it
  [[7e53863e5]](https://git.sudo.ws/sudo/commit/?id=7e53863e5)

* fnmatch.3:

  Remove advertising clause, UCB has disavowed it
  [[bdb69602e]](https://git.sudo.ws/sudo/commit/?id=bdb69602e)

2003-05-22 Todd C. Miller

* parse.c:

  Don’t assume that getgrnam() calls don’t modify contents of struct
  passwd returned by getpwnam(). On FreeBSD w/ NIS this can happen. Based
  on a patch from Kirk Webb.
  [[40b63be2f]](https://git.sudo.ws/sudo/commit/?id=40b63be2f)

2003-05-06 Todd C. Miller

* configure.in:

  missing ;;
  [[61e7453f8]](https://git.sudo.ws/sudo/commit/?id=61e7453f8)

* configure.in:

  darwin has a broken setreuid() in at least some versions
  [[8dc823861]](https://git.sudo.ws/sudo/commit/?id=8dc823861)

* env.c:

  Fix an off by one error when reallocating the environment; Kevin Pye
  [[684f62dd0]](https://git.sudo.ws/sudo/commit/?id=684f62dd0)

2003-04-30 Todd C. Miller

* sudoers.pod:

  Fix User\_Spec definition; SEKINE Tatsuo
  [[c917da1cc]](https://git.sudo.ws/sudo/commit/?id=c917da1cc)

2003-04-28 Todd C. Miller

* HISTORY:

  More info on the early days from Coggs.
  [[04b402662]](https://git.sudo.ws/sudo/commit/?id=04b402662)

2003-04-21 Todd C. Miller

* auth/kerb5.c:

  remove errant semicolon that prevented compilation under heimdal
  [[c03ffb197]](https://git.sudo.ws/sudo/commit/?id=c03ffb197)

2003-04-16 Todd C. Miller

* testsudoers.c, tgetpass.c, visudo.c, visudo.man.in, visudo.pod:

  add DARPA credit on affected files
  [[4e74e8c53]](https://git.sudo.ws/sudo/commit/?id=4e74e8c53)

* sudoers.pod:

  add DARPA credit on affected files
  [[58db01577]](https://git.sudo.ws/sudo/commit/?id=58db01577)

* sigaction.c, strerror.c, sudo.c, sudo.h, sudo.man.in, sudo.pod,
  sudoers.man.in:

  add DARPA credit on affected files
  [[f13528b0b]](https://git.sudo.ws/sudo/commit/?id=f13528b0b)

* set\_perms.c:

  add DARPA credit on affected files
  [[69ac0e56c]](https://git.sudo.ws/sudo/commit/?id=69ac0e56c)

* pathnames.h.in:

  add DARPA credit on affected files
  [[58596112c]](https://git.sudo.ws/sudo/commit/?id=58596112c)

* logging.c, parse.c:

  add DARPA credit on affected files
  [[a76a79f6d]](https://git.sudo.ws/sudo/commit/?id=a76a79f6d)

* auth/passwd.c, auth/rfc1938.c, auth/secureware.c, auth/securid.c,
  auth/securid5.c, auth/sia.c, auth/sudo\_auth.c, fileops.c, find\_path.c,
  getprogname.c, getspwuid.c, goodpath.c, interfaces.c, interfaces.h:

  add DARPA credit on affected files
  [[505b424a5]](https://git.sudo.ws/sudo/commit/?id=505b424a5)

* auth/kerb5.c, auth/pam.c:

  add DARPA credit on affected files
  [[8b45d6459]](https://git.sudo.ws/sudo/commit/?id=8b45d6459)

* auth/afs.c, auth/aix\_auth.c, auth/bsdauth.c, auth/dce.c, auth/fwtk.c,
  auth/kerb4.c, parse.lex, parse.yacc, utime.c, version.h:

  add DARPA credit on affected files
  [[94567681a]](https://git.sudo.ws/sudo/commit/?id=94567681a)

* env.c:

  add DARPA credit on affected files
  [[c6c8c9951]](https://git.sudo.ws/sudo/commit/?id=c6c8c9951)

* defaults.c, defaults.h:

  add DARPA credit on affected files
  [[34479303a]](https://git.sudo.ws/sudo/commit/?id=34479303a)

* compat.h:

  add DARPA credit on affected files
  [[492367bd6]](https://git.sudo.ws/sudo/commit/?id=492367bd6)

* Makefile.in, alloc.c, check.c:

  add DARPA credit on affected files
  [[6c51ebd37]](https://git.sudo.ws/sudo/commit/?id=6c51ebd37)

* LICENSE:

  slightly different wording for the darpa credit
  [[f9b6bdba4]](https://git.sudo.ws/sudo/commit/?id=f9b6bdba4)

2003-04-15 Todd C. Miller

* LICENSE:

  Add DARPA credit
  [[2b7ed974d]](https://git.sudo.ws/sudo/commit/?id=2b7ed974d)

2003-04-14 Todd C. Miller

* auth/kerb5.c:

  Use krb5\_princ\_component() instead of krb5\_princ\_realm() for MIT
  Kerberos like we did before I messed things up ;-)

  Use krb5\_principal\_get\_comp\_string() to do the same thing w/ Heimdal.
  I’m not sure if the component should be 0 or 1 in this case.

  #define ENCTYPE\_DES\_CBC\_MD5 ETYPE\_DES\_CBC\_MD5 for Heimdal since older
  versions lack ENCTYPE\_DES\_CBC\_MD5. This is gross and there should be a
  configure check for this I guess.
  [[4a2da4c96]](https://git.sudo.ws/sudo/commit/?id=4a2da4c96)

2003-04-13 Todd C. Miller

* sample.sudoers:

  builtin -> built-in; Jason McIntyre
  [[86febe03a]](https://git.sudo.ws/sudo/commit/?id=86febe03a)

* TROUBLESHOOTING, config.h.in, configure, configure.in:

  builtin -> built-in; Jason McIntyre
  [[e6ec7f337]](https://git.sudo.ws/sudo/commit/?id=e6ec7f337)

* sudoers.pod:

  built in -> built-in; Jason McIntyre
  [[8d146fae7]](https://git.sudo.ws/sudo/commit/?id=8d146fae7)

2003-04-09 Todd C. Miller

* CHANGES:

  checkpoint for 1.6.7p3
  [[28eca61dd]](https://git.sudo.ws/sudo/commit/?id=28eca61dd)

* HISTORY:

  Update info on the early years @ SUNY-Buffalo from Cliff Spencer.
  Amazingly, sudo source from 1985 is available via groups.google.com
  [[6b941870e]](https://git.sudo.ws/sudo/commit/?id=6b941870e)

* sudo.c:

  Don’t change rl.rlim\_max for RLIMIT\_CORE. We need only set rl.rlim\_cur
  to 0 to turn off core dumps. This may be needed for the RLIMIT\_CORE
  restoration on some OSes.
  [[e15de8443]](https://git.sudo.ws/sudo/commit/?id=e15de8443)

2003-04-04 Todd C. Miller

* auth/kerb5.c:

  Make this compile on Heimdal and MIT Kerberos 5
  [[cfeec138e]](https://git.sudo.ws/sudo/commit/?id=cfeec138e)

* config.h.in, configure, configure.in:

  Check for heimdal even if we found krb5-config and define HAVE\_HEIMDAL.
  [[fab224f42]](https://git.sudo.ws/sudo/commit/?id=fab224f42)

* auth/kerb5.c:

  Replace ETYPE\_DES\_CBC\_MD5 with ENCTYPE\_DES\_CBC\_MD5. The former is no
  longer defined by MIT kerb5 (though it used to be and indeed remains so
  in Heimdal).
  [[d22075714]](https://git.sudo.ws/sudo/commit/?id=d22075714)

2003-04-03 Todd C. Miller

* mkinstalldirs:

  Remove newer stuff that passes multiple (possibly duplicate) directories
  to “mkdir -p” since that seems to break on Tru64 Unix at least. This
  basically brings back what shipped with sudo 1.6.6.
  [[941162deb]](https://git.sudo.ws/sudo/commit/?id=941162deb)

2003-04-02 Todd C. Miller

* auth/kerb5.c:

  Correct number of args to krb5\_principal\_get\_realm() and fix an unclosed
  comment that hid the bug.
  [[58887b76b]](https://git.sudo.ws/sudo/commit/?id=58887b76b)

* configure:

  regen
  [[ce070cdc6]](https://git.sudo.ws/sudo/commit/?id=ce070cdc6)

* configure.in:

  ++version
  [[c18486069]](https://git.sudo.ws/sudo/commit/?id=c18486069)

* README:

  ++version
  [[2a37e9d95]](https://git.sudo.ws/sudo/commit/?id=2a37e9d95)

* Makefile.in:

  ++version
  [[12694ed15]](https://git.sudo.ws/sudo/commit/?id=12694ed15)

* INSTALL.binary:

  ++version
  [[c8459f7d1]](https://git.sudo.ws/sudo/commit/?id=c8459f7d1)

* INSTALL:

  ++version
  [[50b48929c]](https://git.sudo.ws/sudo/commit/?id=50b48929c)

* CHANGES, version.h:

  ++version
  [[6cb95ca0b]](https://git.sudo.ws/sudo/commit/?id=6cb95ca0b)

* BUGS:

  ++version
  [[539a65cde]](https://git.sudo.ws/sudo/commit/?id=539a65cde)

* configure.in:

  use krb5-config to determine Kerberos V details if it exists
  [[7a15e5079]](https://git.sudo.ws/sudo/commit/?id=7a15e5079)

* alloc.c, auth/fwtk.c, auth/rfc1938.c, auth/securid.c, auth/securid5.c,
  auth/sia.c, check.c, compat.h, defaults.c, env.c, find\_path.c,
  interfaces.c, logging.c, parse.c, sudo.c, sudo.h, testsudoers.c,
  visudo.c:

  Use warn/err and getprogname() throughout. The main exception is
  openlog(). Since the admin may be filtering logs based on the program
  name in the log files, hard code this to “sudo”.
  [[dcf1a5acc]](https://git.sudo.ws/sudo/commit/?id=dcf1a5acc)

* Makefile.in:

  Add getprogname.c and err.c
  [[4afe01580]](https://git.sudo.ws/sudo/commit/?id=4afe01580)

* configure:

  regen
  [[fd5d6e943]](https://git.sudo.ws/sudo/commit/?id=fd5d6e943)

* config.h.in, configure.in:

  Add checks for getprognam(), \_\_progname and err.h
  [[d64a83b41]](https://git.sudo.ws/sudo/commit/?id=d64a83b41)

* emul/err.h:

  For systems withour err/warn functions.
  [[b51c12411]](https://git.sudo.ws/sudo/commit/?id=b51c12411)

* err.c:

  For systems withour err/warn functions.
  [[0eaddf3e8]](https://git.sudo.ws/sudo/commit/?id=0eaddf3e8)

* getprogname.c:

  For systems neither getprogname() nor \_\_progname; uses Argv[0].
  [[c5aa05992]](https://git.sudo.ws/sudo/commit/?id=c5aa05992)

2003-04-01 Todd C. Miller

* CHANGES:

  checkpoint for 1.6.7p1
  [[ad200188f]](https://git.sudo.ws/sudo/commit/?id=ad200188f)

* sudo.c, testsudoers.c:

  fix strlcpy() rval check (innocuous)
  [[632dbebef]](https://git.sudo.ws/sudo/commit/?id=632dbebef)

* check.c:

  oflow detection in expand\_prompt() was faulty (false positives). The
  count was based on strlcat() return value which includes the length of
  the entire string.
  [[f761cef5c]](https://git.sudo.ws/sudo/commit/?id=f761cef5c)

2003-03-31 Todd C. Miller

* RUNSON, TODO:

  checkpoint for the sudo 1.6.7 release
  [[d529fea7b]](https://git.sudo.ws/sudo/commit/?id=d529fea7b)

* CHANGES:

  checkpoint for the sudo 1.6.7 release
  [[ea6c2c1cc]](https://git.sudo.ws/sudo/commit/?id=ea6c2c1cc)

2003-03-24 Todd C. Miller

* logging.c:

  g/c unused variable
  [[fff31a8a5]](https://git.sudo.ws/sudo/commit/?id=fff31a8a5)

* configure:

  regen
  [[b16eb4722]](https://git.sudo.ws/sudo/commit/?id=b16eb4722)

* configure.in:

  use man sections 8 and 5 for csops
  [[aa698f905]](https://git.sudo.ws/sudo/commit/?id=aa698f905)

2003-03-21 Todd C. Miller

* configure:

  regen
  [[c827a73ae]](https://git.sudo.ws/sudo/commit/?id=c827a73ae)

* configure.in:

  Add -lskey or -lopie directly to SUDO\_LIBS instead of having
  AC\_CHECK\_LIB() add them to LIBS. Fixes visudo linkage.
  [[8cc257b59]](https://git.sudo.ws/sudo/commit/?id=8cc257b59)

* configure:

  regen
  [[cf8618c7a]](https://git.sudo.ws/sudo/commit/?id=cf8618c7a)

* configure.in:

  Add –with-blibpath for AIX. An alternate libpath may be specified or
  -blibpath support can be disabled. Also change conifgure such that
  -blibpath is not specified if no -L libpaths were added to SUDO\_LDFLAGS.
  [[ed7cfdc1c]](https://git.sudo.ws/sudo/commit/?id=ed7cfdc1c)

* aclocal.m4:

  Add –with-blibpath for AIX. An alternate libpath may be specified or
  -blibpath support can be disabled. Also change conifgure such that
  -blibpath is not specified if no -L libpaths were added to SUDO\_LDFLAGS.
  [[02b4fa769]](https://git.sudo.ws/sudo/commit/?id=02b4fa769)

* INSTALL:

  Add –with-blibpath for AIX. An alternate libpath may be specified or
  -blibpath support can be disabled. Also change conifgure such that
  -blibpath is not specified if no -L libpaths were added to SUDO\_LDFLAGS.
  [[936e8b501]](https://git.sudo.ws/sudo/commit/?id=936e8b501)

* configure.in:

  add AIX blibpath support
  [[0a2de952a]](https://git.sudo.ws/sudo/commit/?id=0a2de952a)

* INSTALL, configure.in:

  –with-skey and –with-opie now take an option directory argument This
  obsoletes a –with-csops hack (/tools/cs/skey)

  Also remove the remaining direct uses of “echo”
  [[e7759a8b0]](https://git.sudo.ws/sudo/commit/?id=e7759a8b0)

2003-03-20 Todd C. Miller

* configure.in:

  Detect KTH Kerberos IV and deal with it. Also make -lroken optional for
  KTH Kerberos IV and V.
  [[67837e50c]](https://git.sudo.ws/sudo/commit/?id=67837e50c)

* aclocal.m4:

  Add SUDO\_APPEND\_LIBPATH function that add -L/path/to/dir (and
  -R/path/to/dir if $with\_rpath) to the specified variable.
  [[4b1013f82]](https://git.sudo.ws/sudo/commit/?id=4b1013f82)

* INSTALL, configure.in:

  Add -R/path/to/libs for Solaris and SVR4. There is a new configure
  option, –with-rpath to control this behavior.
  [[9e6f38062]](https://git.sudo.ws/sudo/commit/?id=9e6f38062)

* configure.in:

  for kerb4 put libdes after libkrb on the link line
  [[a41cbc597]](https://git.sudo.ws/sudo/commit/?id=a41cbc597)

* auth/kerb4.c:

  typo
  [[c4dd20ab7]](https://git.sudo.ws/sudo/commit/?id=c4dd20ab7)

* configure.in:

  fix kerberos lib check when a path is specified
  [[0343559c5]](https://git.sudo.ws/sudo/commit/?id=0343559c5)

* logging.c:

  Fix boolean thinko in SIGCHLD reaper and call reapchild after sending
  mail instead of doing a conditional sudo\_waitpid.
  [[a7d746af2]](https://git.sudo.ws/sudo/commit/?id=a7d746af2)

2003-03-19 Todd C. Miller

* configure:

  regen
  [[2897c23e9]](https://git.sudo.ws/sudo/commit/?id=2897c23e9)

* configure.in:

  replace =DIR with [=DIR] where sensible
  [[a23a3d77b]](https://git.sudo.ws/sudo/commit/?id=a23a3d77b)

* configure.in:

  o Use AC\_MSG\_\* instead of “echo” o New Kerberos include/lib detection
  based on openssh’s configure.in
  [[02cde4645]](https://git.sudo.ws/sudo/commit/?id=02cde4645)

* INSTALL:

  –with-kerb4 and –with-kerb5 now take an optional argument.
  [[6aac4105f]](https://git.sudo.ws/sudo/commit/?id=6aac4105f)

2003-03-16 Todd C. Miller

* auth/securid.c:

  Kill remaining strcpy(), the programmer’s guide says username is 32
  bytes.
  [[ecee62038]](https://git.sudo.ws/sudo/commit/?id=ecee62038)

* auth/kerb4.c:

  trat uid\_t as unsigned long for printf and use snprintf, not sprintf
  [[d2ced184e]](https://git.sudo.ws/sudo/commit/?id=d2ced184e)

* auth/rfc1938.c:

  use snprintf
  [[dc39c5650]](https://git.sudo.ws/sudo/commit/?id=dc39c5650)

2003-03-15 Todd C. Miller

* auth/afs.c, auth/aix\_auth.c, auth/bsdauth.c, auth/dce.c, auth/fwtk.c,
  auth/kerb4.c, auth/kerb5.c, auth/pam.c, auth/passwd.c, auth/rfc1938.c,
  auth/sudo\_auth.c:

  update copyright year
  [[d6a9e16d9]](https://git.sudo.ws/sudo/commit/?id=d6a9e16d9)

* sudo.man.in, sudoers.man.in, visudo.man.in:

  update copyright year
  [[150aec798]](https://git.sudo.ws/sudo/commit/?id=150aec798)

* LICENSE, Makefile.in, aclocal.m4, alloc.c, check.c, compat.h,
  configure.in, env.c, find\_path.c, interfaces.c, logging.c, parse.c,
  parse.lex, parse.yacc, set\_perms.c, sudo.c, sudo.h, sudo.pod,
  sudoers.pod, testsudoers.c, version.h, visudo.c, visudo.pod:

  update copyright year
  [[48229cbac]](https://git.sudo.ws/sudo/commit/?id=48229cbac)

* check.c, env.c, sudo.c:

  Cast [ug]ids to unsigned long and printf with %lu
  [[b18a141ae]](https://git.sudo.ws/sudo/commit/?id=b18a141ae)

* configure:

  regen
  [[eafc58b26]](https://git.sudo.ws/sudo/commit/?id=eafc58b26)

* configure.in:

  correct error messages for –with-sudoers-{mode,uid,gid}
  [[bc400ffbf]](https://git.sudo.ws/sudo/commit/?id=bc400ffbf)

* alloc.c:

  make the malloc(0) error specific to each function to aid tracking down
  bugs.
  [[bb2c3323d]](https://git.sudo.ws/sudo/commit/?id=bb2c3323d)

* alloc.c:

  deal with platforms where size\_t is signed and there is no SIZE\_MAX or
  SIZE\_T\_MAX
  [[8d8b59796]](https://git.sudo.ws/sudo/commit/?id=8d8b59796)

* auth/kerb5.c:

  Make this compile w/ Heimdal and fix some gcc warnings.
  [[80013dd91]](https://git.sudo.ws/sudo/commit/?id=80013dd91)

* sudo.c:

  Use stat\_sudoers macro so –with-stow can work
  [[4b7b3c7f5]](https://git.sudo.ws/sudo/commit/?id=4b7b3c7f5)

* INSTALL, config.h.in, configure, configure.in:

  Add support for –with-stow based on patches from Robert Uhl
  [[7b124c5de]](https://git.sudo.ws/sudo/commit/?id=7b124c5de)

* env.c:

  fix indentation
  [[7e05ae7a3]](https://git.sudo.ws/sudo/commit/?id=7e05ae7a3)

* configure.in:

  back out rev 1.352
  [[18f3cfdf6]](https://git.sudo.ws/sudo/commit/?id=18f3cfdf6)

* lex.yy.c:

  regen
  [[37a1bfccd]](https://git.sudo.ws/sudo/commit/?id=37a1bfccd)

* parse.lex:

  use strlcpy, not strncpy
  [[cc5cc0765]](https://git.sudo.ws/sudo/commit/?id=cc5cc0765)

* set\_perms.c:

  Fix typo; check pw\_uid, not pw\_gid after setusercontext() failure.
  [[2aec2bd72]](https://git.sudo.ws/sudo/commit/?id=2aec2bd72)

* logging.c:

  use pid\_t
  [[f4b5af8da]](https://git.sudo.ws/sudo/commit/?id=f4b5af8da)

2003-03-14 Todd C. Miller

* strlcat.c, strlcpy.c:

  Make gcc shutup about unused rcsid
  [[4e1b157c5]](https://git.sudo.ws/sudo/commit/?id=4e1b157c5)

* interfaces.c:

  Move the n == 0 check for the non-getifaddrs cas
  [[0932bf305]](https://git.sudo.ws/sudo/commit/?id=0932bf305)

* auth/rfc1938.c:

  skeychallenge() on NetBSD take a size parameter
  [[27ffee8ac]](https://git.sudo.ws/sudo/commit/?id=27ffee8ac)

* configure:

  regen
  [[9cafae7a6]](https://git.sudo.ws/sudo/commit/?id=9cafae7a6)

* configure.in:

  put -ldl after -lpam, not before; fixes static linking on Linux
  [[50b049dcc]](https://git.sudo.ws/sudo/commit/?id=50b049dcc)

* interfaces.c:

  Avoid malloc(0) and fix the loop invariant for the getifaddrs() case.
  [[debf9f09c]](https://git.sudo.ws/sudo/commit/?id=debf9f09c)

* sudo.cat, sudoers.cat, visudo.cat:

  regen
  [[af7c4632f]](https://git.sudo.ws/sudo/commit/?id=af7c4632f)

* sudo.man.in, sudoers.man.in, visudo.man.in:

  regen
  [[7aa90a9bb]](https://git.sudo.ws/sudo/commit/?id=7aa90a9bb)

* Makefile.in:

  Preserve copyright notice from .pod file in .man.in file
  [[fc65ea65c]](https://git.sudo.ws/sudo/commit/?id=fc65ea65c)

* visudo.pod:

  Add sudoers(5) to SEE ALSO
  [[e0037d9ad]](https://git.sudo.ws/sudo/commit/?id=e0037d9ad)

2003-03-13 Todd C. Miller

* lex.yy.c:

  regen
  [[8656452ca]](https://git.sudo.ws/sudo/commit/?id=8656452ca)

* parse.lex:

  Don’t assume libc can realloc() a NULL string. If malloc/realloc fails,
  make sure we just return; yyerror() is not terminal.
  [[a01f25b5f]](https://git.sudo.ws/sudo/commit/?id=a01f25b5f)

* lex.yy.c:

  regen
  [[1725de877]](https://git.sudo.ws/sudo/commit/?id=1725de877)

* parse.lex:

  simplify fill\_args a little and use strlcpy for paranoia
  [[9ae8aadee]](https://git.sudo.ws/sudo/commit/?id=9ae8aadee)

* sudo.tab.c:

  regen
  [[a822179f5]](https://git.sudo.ws/sudo/commit/?id=a822179f5)

* check.c, env.c, find\_path.c, parse.c, parse.yacc, sudo.c, testsudoers.c:
  Use strlc{at,py} for paranoia’s sake and exit on overflow. In all cases
  the strings were either pre-allocated to the correct size of length
  checks were done before the copy but a little paranoia can go a long
  way.
  [[eebc763bd]](https://git.sudo.ws/sudo/commit/?id=eebc763bd)

* sudo.h:

  Add strlc{at,py} protos
  [[a54c8e66f]](https://git.sudo.ws/sudo/commit/?id=a54c8e66f)

* env.c, interfaces.c:

  Use erealloc3()
  [[7ce95c61c]](https://git.sudo.ws/sudo/commit/?id=7ce95c61c)

* configure:

  regen
  [[006e64f61]](https://git.sudo.ws/sudo/commit/?id=006e64f61)

* alloc.c:

  Oflow test of nmemb > SIZE\_MAX / size is fine (don’t need >=). Use
  memcpy() instead of strcpy() in estrdup() so this is strcpy()-free.
  [[5b40c964d]](https://git.sudo.ws/sudo/commit/?id=5b40c964d)

* sudo.c:

  snprintf() a uid as %lu, not %ld to match the MAX\_UID\_T\_LEN test in
  configure.
  [[96376b6d4]](https://git.sudo.ws/sudo/commit/?id=96376b6d4)

* aclocal.m4:

  In MAX\_UID\_T\_LEN test cast uid\_t to unsigned long, just unsigned.
  [[4df44eea5]](https://git.sudo.ws/sudo/commit/?id=4df44eea5)

2003-03-12 Todd C. Miller

* sudo.c:

  Use snprintf() for paranoia
  [[804caf395]](https://git.sudo.ws/sudo/commit/?id=804caf395)

* parse.yacc:

  Use emalloc2 and erealloc3
  [[35b2800a8]](https://git.sudo.ws/sudo/commit/?id=35b2800a8)

* Makefile.in:

  strlc{at,py} for those w/o it
  [[6cb46fd4e]](https://git.sudo.ws/sudo/commit/?id=6cb46fd4e)

* strlcat.c, strlcpy.c:

  stlc{at,py} for those w/o it.
  [[cfa77cede]](https://git.sudo.ws/sudo/commit/?id=cfa77cede)

* config.h.in, configure, configure.in:

  Add stlc{at,py} for those w/o it.
  [[285791c42]](https://git.sudo.ws/sudo/commit/?id=285791c42)

* alloc.c, sudo.h:

  Add erealloc3(), a realloc() version of emalloc2().
  [[838ec0a2c]](https://git.sudo.ws/sudo/commit/?id=838ec0a2c)

* interfaces.c, sudo.c:

  Use emalloc2() to allocate N things of a certain size.
  [[c96a62e26]](https://git.sudo.ws/sudo/commit/?id=c96a62e26)

* alloc.c, sudo.h:

  Add emalloc2() – like calloc() but w/o the bzero and with error/oflow
  checking.
  [[8b4248529]](https://git.sudo.ws/sudo/commit/?id=8b4248529)

* alloc.c:

  Error out on malloc(0); suggested by theo
  [[8e041c3f3]](https://git.sudo.ws/sudo/commit/?id=8e041c3f3)

2003-03-10 Todd C. Miller

* configure, configure.in:

  fix a typo; David Krause
  [[450a56193]](https://git.sudo.ws/sudo/commit/?id=450a56193)

2003-03-07 Todd C. Miller

* sudo.pod:

  fix typo
  [[fc387e982]](https://git.sudo.ws/sudo/commit/?id=fc387e982)

2003-03-04 Todd C. Miller

* env.c:

  Remove DYLD\_ from the environment for MacOS X; from bbraun
  [[466216fe8]](https://git.sudo.ws/sudo/commit/?id=466216fe8)

2003-03-01 Todd C. Miller

* config.h.in, configure.in:

  not not; Anil Madhavapeddy
  [[7a7a5fe2e]](https://git.sudo.ws/sudo/commit/?id=7a7a5fe2e)

2003-01-23 Todd C. Miller

* sudo.pod, sudoers.pod, visudo.pod:

  typos; jmc@…
  [[4a48a0f67]](https://git.sudo.ws/sudo/commit/?id=4a48a0f67)

2003-01-20 Todd C. Miller

* parse.yacc:

  Add some missing ‘;’ rule terminators that bison warns about.
  [[b34e37390]](https://git.sudo.ws/sudo/commit/?id=b34e37390)

* config.sub:

  fix typo I introduced in last merge
  [[5478ef4e2]](https://git.sudo.ws/sudo/commit/?id=5478ef4e2)

* configure:

  regenerate with autoconf 2.57
  [[f1b032925]](https://git.sudo.ws/sudo/commit/?id=f1b032925)

* config.h.in:

  Add missing “$HOME”
  [[dfd0d2829]](https://git.sudo.ws/sudo/commit/?id=dfd0d2829)

* configure.in:

  Add some more square backets to make autoconf 2.57 happy
  [[cf76450ae]](https://git.sudo.ws/sudo/commit/?id=cf76450ae)

* config.sub, mkinstalldirs:

  Updates from autoconf-2.57
  [[fe79cba0b]](https://git.sudo.ws/sudo/commit/?id=fe79cba0b)

* config.guess:

  Updates from autoconf-2.57
  [[e73dd504b]](https://git.sudo.ws/sudo/commit/?id=e73dd504b)

2003-01-17 Todd C. Miller

* sudo.tab.h:

  regen
  [[270e6cab7]](https://git.sudo.ws/sudo/commit/?id=270e6cab7)

* lex.yy.c, sudo.tab.c:

  regen
  [[26d9f4856]](https://git.sudo.ws/sudo/commit/?id=26d9f4856)

* parse.lex, parse.yacc, sudoers.pod:

  Add support for Defaults>RunasUser
  [[a8153f4d5]](https://git.sudo.ws/sudo/commit/?id=a8153f4d5)

2003-01-07 Todd C. Miller

* visudo.c:

  fclose() yyin after each yyparse() is done and use fopen() instead of
  using freopen().
  [[6e118c64b]](https://git.sudo.ws/sudo/commit/?id=6e118c64b)

* parse.lex:

  Better fix for sudoers files w/o a newline before EOF. It looks like the
  issue is that yyrestart() does not reset the start condition to INITIAL
  which is an issue since we parse sudoers multiple times.
  [[8b3c38d20]](https://git.sudo.ws/sudo/commit/?id=8b3c38d20)

2003-01-06 Todd C. Miller

* parse.lex:

  Work around what appears to be a flex bug when dealing with files that
  lack a final newline before EOF. This adds a rule to match EOF in the
  non-initial states which resets the state to INITIAL and throws an
  error.
  [[cce84a181]](https://git.sudo.ws/sudo/commit/?id=cce84a181)

* visudo.c:

  o The parser needs sudoers to end with a newline but some editors
  (emacs) may not add one. Check for a missing newline at EOF and add one
  if needed. o Set quiet flag during initial sudoers parse (to get
  options) o Move yyrestart() call and always use freopen() to open yyin
  after initial sudoers parse.
  [[35cf881d7]](https://git.sudo.ws/sudo/commit/?id=35cf881d7)

2002-12-15 Todd C. Miller

* set\_perms.c:

  Fix pasto/thinko in setresgid()/setregid() usage. Want to set effective
  gid, not real gid, when reading sudoers.
  [[e27e963f2]](https://git.sudo.ws/sudo/commit/?id=e27e963f2)

* set\_perms.c:

  don’t compile set\_perms\_posix if we have setreuid or setresuid
  [[1996179bf]](https://git.sudo.ws/sudo/commit/?id=1996179bf)

2002-12-14 Todd C. Miller

* sudo.pod, sudoers.pod:

  document new prompt escapes
  [[3bfbd4b1e]](https://git.sudo.ws/sudo/commit/?id=3bfbd4b1e)

* check.c:

  Add %U and %H escapes and redo prompt rewriting. “%%” now gets collapsed
  to “%” as was originally intended. This also gets rid of lastchar (does
  lookahead instead of lookback) which should simplify the logic slightly.
  [[0b0f8d6d3]](https://git.sudo.ws/sudo/commit/?id=0b0f8d6d3)

2002-12-13 Todd C. Miller

* tgetpass.c:

  Write the prompt *after* turning off echo to avoid some password
  characters being echoed on heavily-loaded machines with fast typists.
  [[4f9ed308f]](https://git.sudo.ws/sudo/commit/?id=4f9ed308f)

* config.sub:

  Add support for mipseb; wiz@danbala.tuwien.ac.at
  [[412151ce7]](https://git.sudo.ws/sudo/commit/?id=412151ce7)

* configure.in:

  Fix IRIX fallout from name changes in man dir/sect Makefile variables.
  Patch from erici AT motown DOT cc DOT utexas DOT edu
  [[c8fa23112]](https://git.sudo.ws/sudo/commit/?id=c8fa23112)

* auth/pam.c:

  Keep a local copy of tgetpass\_flags so we don’t add in TGP\_ECHO to the
  global copy. Problem noted by Peter Pentchev.
  [[b49046433]](https://git.sudo.ws/sudo/commit/?id=b49046433)

2002-11-28 Todd C. Miller

* sudo.tab.c:

  regen
  [[d26b60827]](https://git.sudo.ws/sudo/commit/?id=d26b60827)

* parse.yacc:

  Add missing yyerror() calls; YYERROR does not seem to call this for us.
  [[5bf742d28]](https://git.sudo.ws/sudo/commit/?id=5bf742d28)

2002-11-26 Todd C. Miller

* sudo.c:

  fix typo in comment; Pedro Bastos
  [[897b55137]](https://git.sudo.ws/sudo/commit/?id=897b55137)

2002-11-22 Todd C. Miller

* INSTALL:

  document –disable-setresuid
  [[f7e953201]](https://git.sudo.ws/sudo/commit/?id=f7e953201)

* auth/aix\_auth.c, auth/bsdauth.c, auth/fwtk.c, auth/pam.c,
  auth/sudo\_auth.c:

  Sprinkle some volatile qualifiers to prevent over-enthusiastic
  optimizers from removing memset() calls.
  [[abb4e1ad3]](https://git.sudo.ws/sudo/commit/?id=abb4e1ad3)

* logging.c, parse.yacc:

  minor sign fixes pointed out by gcc -Wsign-compare
  [[fd140ff5d]](https://git.sudo.ws/sudo/commit/?id=fd140ff5d)

* set\_perms.c, sudo.c, sudo.h:

  Revamp set\_perms. We now use a version based on setresuid() or
  setreuid() when possible since that allows us to support the stay\_setuid
  option and we always know exactly what the semantics will be (various
  Linux kernels have broken POSIX saved uid support).
  [[b152da4cd]](https://git.sudo.ws/sudo/commit/?id=b152da4cd)

* config.h.in, configure:

  regen from configure.in
  [[2de61320b]](https://git.sudo.ws/sudo/commit/?id=2de61320b)

* configure.in:

  Add checks for setresuid() and a way to disable using it
  [[736660571]](https://git.sudo.ws/sudo/commit/?id=736660571)

* compat.h:

  No long need to emulate set\*[ug]id() via setres[ug]id() or
  setre[ug]id(). The new set\_perms stuff only uses things it knows are
  there.
  [[351fcc138]](https://git.sudo.ws/sudo/commit/?id=351fcc138)

* sudo.c:

  Before exec, restore state of signal handlers to be the same as when we
  were initialy invoked instead of just reseting to SIG\_DFL. Fixes a
  problem when using sudo with nohup. Based on a patch from Paul Markham.
  [[faabf3bac]](https://git.sudo.ws/sudo/commit/?id=faabf3bac)

* sudo.c:

  o timestamp\_uid should be uid\_t, not int o clarify error message when
  sudo is run by root and no\_root\_sudo is set
  [[4f2d87e28]](https://git.sudo.ws/sudo/commit/?id=4f2d87e28)

2002-09-19 Todd C. Miller

* README:

  update ftp link for bison
  [[06cd79be8]](https://git.sudo.ws/sudo/commit/?id=06cd79be8)

2002-07-20 Todd C. Miller

* set\_perms.c:

  Error out if setusercontext() fails and the runas user is not root.
  [[d497949e6]](https://git.sudo.ws/sudo/commit/?id=d497949e6)

2002-05-20 Todd C. Miller

* auth/securid5.c:

  Fix rcsid
  [[3437e96a3]](https://git.sudo.ws/sudo/commit/?id=3437e96a3)

* configure.in:

  Fix SecurID API test
  [[9c2e0aeda]](https://git.sudo.ws/sudo/commit/?id=9c2e0aeda)

2002-05-17 Todd C. Miller

* env.c:

  typo in comment
  [[f3ddf66e0]](https://git.sudo.ws/sudo/commit/?id=f3ddf66e0)

* configure.in:

  securid5 stuff needs pthreads. Just adding -lpthread is suboptimal but I
  don’t see a better way at the moment.
  [[ef8c99a5f]](https://git.sudo.ws/sudo/commit/?id=ef8c99a5f)

* Makefile.in, auth/securid5.c:

  SecurID API version 5 support from Michael Stroucken
  [[16547b2ef]](https://git.sudo.ws/sudo/commit/?id=16547b2ef)

* configure.in:

  Add check for SecurID 5.0 API
  [[1039ff788]](https://git.sudo.ws/sudo/commit/?id=1039ff788)

2002-05-08 Todd C. Miller

* strerror.c:

  We actually do still need config.h to get the ‘const’ definition for K&R
  C.
  [[09f5d0a46]](https://git.sudo.ws/sudo/commit/?id=09f5d0a46)

2002-05-05 Todd C. Miller

* configure:

  regen with autoconf 2.5.3
  [[109155726]](https://git.sudo.ws/sudo/commit/?id=109155726)

* configure.in:

  Don’t set sysconfdir to ‘/etc’ if the user has specified a –prefix.
  [[80f50dbc4]](https://git.sudo.ws/sudo/commit/?id=80f50dbc4)

* configure.in:

  Some fixes for autoconf 2.53 from Robert Uhl o don’t AC\_SUBST LIBOBJS o
  force a 4th arg for AC\_CHECK\_HEADER() to workaround a bug
  [[ac8ca82f0]](https://git.sudo.ws/sudo/commit/?id=ac8ca82f0)

* env.c, sudo.c, sudo.h:

  No need for dump\_badenv() now that dump\_defaults() knows how to dump
  lists.
  [[0f60107a1]](https://git.sudo.ws/sudo/commit/?id=0f60107a1)

* BUGS, INSTALL, INSTALL.binary, Makefile.in, README, configure.in,
  version.h:

  ++version
  [[ed4f749c7]](https://git.sudo.ws/sudo/commit/?id=ed4f749c7)

* sudoers.pod:

  document timestampowner
  [[cd4ec1d2b]](https://git.sudo.ws/sudo/commit/?id=cd4ec1d2b)

* check.c:

  Don’t call set\_perms() when doing timestamp stuff unless timestamp\_uid
  != 0.
  [[982218c34]](https://git.sudo.ws/sudo/commit/?id=982218c34)

* auth/sudo\_auth.c, check.c, logging.c, parse.c, set\_perms.c, sudo.c,
  sudo.h, testsudoers.c:

  g/c second arg to set\_perms–it is no longer used
  [[c28915995]](https://git.sudo.ws/sudo/commit/?id=c28915995)

2002-05-03 Todd C. Miller

* check.c, set\_perms.c, sudo.c, sudo.h:

  Add support for non-root timestamp dirs. This allows the timestamp dir
  to be shared via NFS (though this is not recommended).
  [[a30951d34]](https://git.sudo.ws/sudo/commit/?id=a30951d34)

* def\_data.c, def\_data.h, def\_data.in:

  Add timestampowner, “Owner of the authentication timestamp dir”
  [[15965c2ce]](https://git.sudo.ws/sudo/commit/?id=15965c2ce)

2002-05-02 Todd C. Miller

* env.c:

  Don’t try to pre-compute the size of the new envp, just allocate space
  up front and realloc as needed. Changes to the new env pointer must all
  be made through insert\_env() which now keeps track of spaced used and
  allocates as needed.
  [[3f7d80188]](https://git.sudo.ws/sudo/commit/?id=3f7d80188)

2002-04-26 Todd C. Miller

* configure:

  regen
  [[4160f7eb7]](https://git.sudo.ws/sudo/commit/?id=4160f7eb7)

* configure.in:

  Fix two typo/pastos; from jrj@…
  [[e0a5ce978]](https://git.sudo.ws/sudo/commit/?id=e0a5ce978)

2002-04-25 Todd C. Miller

* INSTALL.binary, README:

  ++version
  [[cc8a177c9]](https://git.sudo.ws/sudo/commit/?id=cc8a177c9)

* configure, sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in,
  visudo.cat, visudo.man.in:

  regen
  [[da7384a0e]](https://git.sudo.ws/sudo/commit/?id=da7384a0e)

* CHANGES, RUNSON, TODO:

  Sync with 1.6.6
  [[853669984]](https://git.sudo.ws/sudo/commit/?id=853669984)

* check.c:

  The the loop used to expand %h and %u, the lastchar variable was not
  being initialized. This means that if the last char in the prompt is ‘%’
  and the first char is ‘h’ or ‘u’ a extra copy of the host or user name
  would be copied, for which space had not been allocated.
  [[db63aefb2]](https://git.sudo.ws/sudo/commit/?id=db63aefb2)

2002-04-18 Todd C. Miller

* BUGS, INSTALL, Makefile.in, configure.in, version.h:

  crank version to 1.6.6
  [[d9bb746df]](https://git.sudo.ws/sudo/commit/?id=d9bb746df)

* auth/afs.c:

  #undef VOID to get rid of an AFS warning
  [[763db0e63]](https://git.sudo.ws/sudo/commit/?id=763db0e63)

* env.c:

  Use easprintf instead of emalloc + sprintf for some things.
  [[a57620762]](https://git.sudo.ws/sudo/commit/?id=a57620762)

2002-03-16 Todd C. Miller

* lex.yy.c, sudo.tab.c:

  regen
  [[08ee411a6]](https://git.sudo.ws/sudo/commit/?id=08ee411a6)

* parse.c, parse.lex, parse.yacc, testsudoers.c:

  Remove Chris Jepeway’s email address so people don’t bug him ;-)
  [[7cc2f3b3e]](https://git.sudo.ws/sudo/commit/?id=7cc2f3b3e)

2002-03-12 Todd C. Miller

* sudo.c:

  Move endpwent() to be after set\_perms(PERM\_RUNAS, …) and also call
  endgrent() at the same time.
  [[99cc62452]](https://git.sudo.ws/sudo/commit/?id=99cc62452)

2002-02-22 Todd C. Miller

* INSTALL:

  Make it clear which configure options take arguments.
  [[1c23b1b68]](https://git.sudo.ws/sudo/commit/?id=1c23b1b68)

2002-01-25 Todd C. Miller

* compat.h:

  HP-UX 9.x has RLIMIT\_\* but no RLIM\_INFINITY. If there is no
  RLIM\_INFINITY, just pretend it is -1. This works because we only check
  for RLIM\_INFINITY and do not set anything to that value.
  [[d1bb1bc09]](https://git.sudo.ws/sudo/commit/?id=d1bb1bc09)

2002-01-22 Todd C. Miller

* auth/pam.c:

  Zero and free allocated memory when there is a conversation error.
  [[ef1f01874]](https://git.sudo.ws/sudo/commit/?id=ef1f01874)

* auth/bsdauth.c:

  Use sigaction() not signal()
  [[33efe1270]](https://git.sudo.ws/sudo/commit/?id=33efe1270)

* INSTALL:

  Mention that some linux kernels have broken POSIX saved ID support
  [[da6aa6157]](https://git.sudo.ws/sudo/commit/?id=da6aa6157)

* CHANGES:

  checkpoint for 1.6.5p2
  [[1ec9784be]](https://git.sudo.ws/sudo/commit/?id=1ec9784be)

* configure:

  regen
  [[7748f4b4e]](https://git.sudo.ws/sudo/commit/?id=7748f4b4e)

* configure.in:

  Add –disable-setreuid flag
  [[5a186c346]](https://git.sudo.ws/sudo/commit/?id=5a186c346)

* INSTALL:

  Document new –disable-setreuid option and change description for
  –disable-saved-ids to match new error message.
  [[2292a1d2f]](https://git.sudo.ws/sudo/commit/?id=2292a1d2f)

* set\_perms.c:

  fatal() now takes an argument that determines whether or not to call
  perror().
  [[bf0aa0ae7]](https://git.sudo.ws/sudo/commit/?id=bf0aa0ae7)

* TROUBLESHOOTING:

  Update for new error messages from set\_perms()
  [[86a50f8ca]](https://git.sudo.ws/sudo/commit/?id=86a50f8ca)

* PORTING:

  Update for new error messages from set\_perms()
  [[6dea05aa2]](https://git.sudo.ws/sudo/commit/?id=6dea05aa2)

2002-01-21 Todd C. Miller

* auth/pam.c:

  Make this compile w/o warnings
  [[d195bd7f1]](https://git.sudo.ws/sudo/commit/?id=d195bd7f1)

* auth/pam.c:

  Mention that we can’t use pam\_acct\_mgmt()
  [[a61088a43]](https://git.sudo.ws/sudo/commit/?id=a61088a43)

* auth/aix\_auth.c, auth/bsdauth.c, auth/fwtk.c, auth/pam.c:

  The user’s password was not zeroed after use when AIX authentication,
  BSD authentication, FWTK or PAM was in use.
  [[0ebe32423]](https://git.sudo.ws/sudo/commit/?id=0ebe32423)

2002-01-20 Todd C. Miller

* auth/pam.c:

  Avoid giving PAM a NULL password response, use the empty string instead.
  This avoids a log warning when the user hits ^C at the password prompt
  when PAM is in use.
  [[73979f1a2]](https://git.sudo.ws/sudo/commit/?id=73979f1a2)

* auth/pam.c:

  Don’t check the return value of pam\_setcred(). In Linux-PAM 0.75
  pam\_setcred() returns the last saved return code, not the return code
  for the setcred module. Because we haven’t called pam\_authenticate(),
  this is not set and so pam\_setcred() returns PAM\_PERM\_DENIED.
  [[3a6c0ea2e]](https://git.sudo.ws/sudo/commit/?id=3a6c0ea2e)

* Makefile.in:

  Don’t need a ‘/’ between $(DESTDIR) and a directory.
  [[3646887d5]](https://git.sudo.ws/sudo/commit/?id=3646887d5)

* Makefile.binary:

  Don’t need a ‘/’ between $(DESTDIR) and a directory.
  [[839cd24a8]](https://git.sudo.ws/sudo/commit/?id=839cd24a8)

2002-01-18 Todd C. Miller

* configure:

  regen
  [[c0eb8bfd9]](https://git.sudo.ws/sudo/commit/?id=c0eb8bfd9)

* configure.in:

  o BSDi also has a bogus setreuid() o Old FreeBSD has a bogus setreuid()
  o new NetBSD has a real setreuid() o add check for freeifaddrs() if
  getifaddrs() exists.
  [[1c9139457]](https://git.sudo.ws/sudo/commit/?id=1c9139457)

* config.h.in, interfaces.c:

  Older BSDi releases lack freeifaddrs() so add a test for that and if it
  is not present just use free().
  [[35014b44b]](https://git.sudo.ws/sudo/commit/?id=35014b44b)

2002-01-17 Todd C. Miller

* CHANGES, RUNSON:

  Checkpoint for 1.6.5p1
  [[10a86c771]](https://git.sudo.ws/sudo/commit/?id=10a86c771)

* auth/passwd.c:

  Return AUTH\_FAILURE in passwd\_init() if skeyaccess() denies access to
  normal passwords, not AUTH\_FATAL (which just causes an exit).
  [[05d1f0290]](https://git.sudo.ws/sudo/commit/?id=05d1f0290)

* visudo.c:

  Don’t use memory after it has been freed.
  [[1b6bfbf45]](https://git.sudo.ws/sudo/commit/?id=1b6bfbf45)

* auth/passwd.c:

  skeyaccess() wants a struct passwd \* not a char \*; Patch from Phillip E.
  Lobbes
  [[437464847]](https://git.sudo.ws/sudo/commit/?id=437464847)

* BUGS:

  ++version
  [[aba0e43da]](https://git.sudo.ws/sudo/commit/?id=aba0e43da)

* CHANGES, RUNSON, TODO:

  checkpoint for sudo 1.6.5
  [[ea2bfc5fd]](https://git.sudo.ws/sudo/commit/?id=ea2bfc5fd)

2002-01-16 Todd C. Miller

* configure:

  regen
  [[a7a5dc39f]](https://git.sudo.ws/sudo/commit/?id=a7a5dc39f)

* INSTALL, INSTALL.binary, Makefile.in, README, configure.in:

  version 1.6.5
  [[b72dadcb9]](https://git.sudo.ws/sudo/commit/?id=b72dadcb9)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in, visudo.cat,
  visudo.man.in:

  sudo version 1.6.5
  [[16472afa0]](https://git.sudo.ws/sudo/commit/?id=16472afa0)

* logging.c:

  o when invoking the mailer as root use a hard-coded environment that
  doesn’t include any info from the user’s environment. Basically
  paranoia.

  o Add support for the NO\_ROOT\_MAILER compile-time option and run the
  mailer as the user and not root if NO\_ROOT\_MAILER is defined.
  [[261f81907]](https://git.sudo.ws/sudo/commit/?id=261f81907)

* set\_perms.c, sudo.h:

  Bring back PERM\_FULL\_USER
  [[fec1b63ca]](https://git.sudo.ws/sudo/commit/?id=fec1b63ca)

* configure:

  regen
  [[7b2219c08]](https://git.sudo.ws/sudo/commit/?id=7b2219c08)

* version.h:

  version 1.6.5
  [[4d48d93a7]](https://git.sudo.ws/sudo/commit/?id=4d48d93a7)

* INSTALL, config.h.in, configure.in:

  Add –disable-root-mailer option to run the mailer as the user and not
  root.
  [[0aac4f03b]](https://git.sudo.ws/sudo/commit/?id=0aac4f03b)

* CHANGES:

  checkpoint for 1.6.4p2
  [[5694aa532]](https://git.sudo.ws/sudo/commit/?id=5694aa532)

* PORTING:

  Mention the “seteuid(0): Operation not permitted” problem here too just
  for good measure.
  [[c12bb733b]](https://git.sudo.ws/sudo/commit/?id=c12bb733b)

2002-01-15 Todd C. Miller

* env.c, getspwuid.c, sudo.c:

  The SHELL environment variable was preserved from the user’s environment
  instead of being reset based on the passwd database when the “env\_reset”
  option was used. Now it is reset as it should be.
  [[ea24bef19]](https://git.sudo.ws/sudo/commit/?id=ea24bef19)

* configure:

  regen
  [[5236ceedf]](https://git.sudo.ws/sudo/commit/?id=5236ceedf)

* INSTALL, TROUBLESHOOTING, config.h.in, configure.in, set\_perms.c,
  sudo.c:

  Add a configure option to turn off use of POSIX saved IDs
  [[f03942725]](https://git.sudo.ws/sudo/commit/?id=f03942725)

* configure:

  regen
  [[62233923e]](https://git.sudo.ws/sudo/commit/?id=62233923e)

* configure.in:

  add –with-efence option
  [[495dc9248]](https://git.sudo.ws/sudo/commit/?id=495dc9248)

* sudo.c:

  Only OR in MODE\_RESET\_HOME if MODE\_RUN is set. Fixes a problem where
  “sudo -l” would not work if always\_set\_home was set.
  [[eb97ce45e]](https://git.sudo.ws/sudo/commit/?id=eb97ce45e)

* lex.yy.c:

  regen
  [[8b7187483]](https://git.sudo.ws/sudo/commit/?id=8b7187483)

* parse.lex:

  Quoted commas were not being treated correctly in command line
  arguments.
  [[08b394dc3]](https://git.sudo.ws/sudo/commit/?id=08b394dc3)

* sudo.c:

  o Move the call to rebuild\_env() until after MODE\_RESET\_HOME is set.
  Otherwise, the set\_home option has no effect.

  o Fix use of freed memory when the “fqdn” flag is set. This was
  introduced by the fix for the “segv when gethostbynam() fails” bug.
  Also, we no longer call set\_fqdn() if the “fqdn” flag is not set so
  there is no need to check the “fqdn” flag in set\_fqdn() itself.
  [[26e835b09]](https://git.sudo.ws/sudo/commit/?id=26e835b09)

* env.c:

  Add ‘continue’ statements to optimize the switch statement. From Solar.
  [[1b6d4ad87]](https://git.sudo.ws/sudo/commit/?id=1b6d4ad87)

2002-01-13 Todd C. Miller

* sudoers.cat, sudoers.man.in:

  Regen from new sudoers.pod
  [[e869e0eb5]](https://git.sudo.ws/sudo/commit/?id=e869e0eb5)

* sudoers.pod:

  Add caveat about stay\_setuid flag
  [[017366ce4]](https://git.sudo.ws/sudo/commit/?id=017366ce4)

* sudo.c:

  If set\_perms == set\_perms\_posix and the stay\_setuid flag is not set, set
  all uids to 0 and use set\_perms\_fallback().
  [[9eac6eeaa]](https://git.sudo.ws/sudo/commit/?id=9eac6eeaa)

* set\_perms.c, sudo.h:

  Remove PERM\_FULL\_USER (which is no longer used) and add PERM\_FULL\_ROOT
  (used when exec’ing the mailer).
  [[26f2a9655]](https://git.sudo.ws/sudo/commit/?id=26f2a9655)

* logging.c:

  Use set\_perms(PERM\_FULL\_ROOT, 0) before exec’ing the mailer since we
  never want to run the mailer setuid.
  [[ddf96f301]](https://git.sudo.ws/sudo/commit/?id=ddf96f301)

2002-01-12 Todd C. Miller

* sudo.cat, sudo.man.in, sudo.pod, visudo.cat, visudo.man.in, visudo.pod:

  Use sudo.ws instead of courtesan.com in URLs
  [[2abe7d8e1]](https://git.sudo.ws/sudo/commit/?id=2abe7d8e1)

* Makefile.binary, Makefile.in:

  Fix mansect substitution
  [[96fc0545c]](https://git.sudo.ws/sudo/commit/?id=96fc0545c)

* Makefile.in:

  Substitute man sections in Makefile.binary
  [[43a65bb5c]](https://git.sudo.ws/sudo/commit/?id=43a65bb5c)

* Makefile.binary:

  Sync install targets with Makefile.in and substitute in man sections.
  [[a6be68c67]](https://git.sudo.ws/sudo/commit/?id=a6be68c67)

* INSTALL, INSTALL.binary:

  version is 1.6.4
  [[e1b65f1e6]](https://git.sudo.ws/sudo/commit/?id=e1b65f1e6)

* Makefile.in:

  Repair bindist target
  [[33336389e]](https://git.sudo.ws/sudo/commit/?id=33336389e)

* CHANGES:

  sync for 1.6.4
  [[81b534b29]](https://git.sudo.ws/sudo/commit/?id=81b534b29)

2002-01-10 Todd C. Miller

* install-sh:

  Fix case where neither whoami nor id are found
  [[2fe1bcd3d]](https://git.sudo.ws/sudo/commit/?id=2fe1bcd3d)

2002-01-09 Todd C. Miller

* install-sh:

  If neither whoami nor id exists, just assume we are root.
  [[0244c4ee6]](https://git.sudo.ws/sudo/commit/?id=0244c4ee6)

* alloc.c:

  Add explicit cast to (VOID \*) on malloc/realloc. Seems to be needed on
  AIX which for some reason isn’t pulling in the malloc prototype.
  [[b7da5ec51]](https://git.sudo.ws/sudo/commit/?id=b7da5ec51)

2002-01-08 Todd C. Miller

* Makefile.in, aclocal.m4, compat.h, parse.c, sudo.c:

  (c) 2002
  [[a82e7a8ef]](https://git.sudo.ws/sudo/commit/?id=a82e7a8ef)

* CHANGES:

  checkpoint
  [[d0847eb01]](https://git.sudo.ws/sudo/commit/?id=d0847eb01)

* sudo.c:

  Defer assigning new environment until right before the exec.
  [[53299b78a]](https://git.sudo.ws/sudo/commit/?id=53299b78a)

* parse.c:

  kill extra blank line
  [[bd74bbdfb]](https://git.sudo.ws/sudo/commit/?id=bd74bbdfb)

2002-01-07 Todd C. Miller

* configure:

  regen
  [[5849db069]](https://git.sudo.ws/sudo/commit/?id=5849db069)

* configure.in:

  Use -O not -O2 for m88k-motorola-sysv\* since motorola gcc-derived
  compiler doesn’t recognise -O2.
  [[de7c18845]](https://git.sudo.ws/sudo/commit/?id=de7c18845)

* HISTORY:

  Clarify origins of Root Group sudo a bit based on info from billp@…
  [[0910f8203]](https://git.sudo.ws/sudo/commit/?id=0910f8203)

2002-01-03 Todd C. Miller

* LICENSE:

  2002
  [[1ac8e6f38]](https://git.sudo.ws/sudo/commit/?id=1ac8e6f38)

* CHANGES:

  checkpoint for 1.6.4rc1
  [[45a28b58a]](https://git.sudo.ws/sudo/commit/?id=45a28b58a)

2002-01-02 Todd C. Miller

* config.h.in:

  now generated via autoheader
  [[ce95eb80b]](https://git.sudo.ws/sudo/commit/?id=ce95eb80b)

* configure:

  regen
  [[b05c753da]](https://git.sudo.ws/sudo/commit/?id=b05c753da)

* compat.h:

  Move in some stuff that was previously in config.h.
  [[a3e429aed]](https://git.sudo.ws/sudo/commit/?id=a3e429aed)

* aclocal.m4, configure.in:

  Add info for autoheader.
  [[5baef4dad]](https://git.sudo.ws/sudo/commit/?id=5baef4dad)

2002-01-01 Todd C. Miller

* Makefile.in:

  o Add DESTDIR support o Use -M, -O, and -G instead of -m, -o, and -g to
  facilitate non-root installs
  [[edbdf215f]](https://git.sudo.ws/sudo/commit/?id=edbdf215f)

* install-sh:

  Add -M option (like -m but only for root) If we can’t find “whoami”, use
  “id” w/ some sed.
  [[76b2f1a32]](https://git.sudo.ws/sudo/commit/?id=76b2f1a32)

* configure:

  regen
  [[ed6b129d8]](https://git.sudo.ws/sudo/commit/?id=ed6b129d8)

* configure.in:

  allow user to always override mansectsu and mansectform
  [[513605df4]](https://git.sudo.ws/sudo/commit/?id=513605df4)

2001-12-31 Todd C. Miller

* mkinstalldirs:

  update from autoconf 2.52
  [[eecc076ef]](https://git.sudo.ws/sudo/commit/?id=eecc076ef)

* config.guess, config.sub:

  Update from autoconf 2.52
  [[360f4d01f]](https://git.sudo.ws/sudo/commit/?id=360f4d01f)

* configure:

  regen with autoconf 2.52
  [[c0b31d588]](https://git.sudo.ws/sudo/commit/?id=c0b31d588)

* configure.in:

  o Call AC\_PROG\_CC\_STDC to find out how to run the compiler in ANSI mode
  o Remove compiler-specific checks for HP-UX now that we use
  AC\_PROG\_CC\_STDC
  [[1ae422826]](https://git.sudo.ws/sudo/commit/?id=1ae422826)

* RUNSON:

  Checkpoint
  [[24995ea37]](https://git.sudo.ws/sudo/commit/?id=24995ea37)

* auth/pam.c:

  o Add pam\_prep\_user function to call pam\_setcred() for the target user;
  on Linux this often sets resource limits. o When calling pam\_end(), try
  to convert the auth->result to a PAM\_FOO value. This is a hack–we
  really need to stash the last PAM\_FOO value received and use that
  instead.
  [[9a78f6e75]](https://git.sudo.ws/sudo/commit/?id=9a78f6e75)

* set\_perms.c, sudo.h:

  o Add pam\_prep\_user function to call pam\_setcred() for the target user;
  on Linux this often sets resource limits.
  [[a55e6898e]](https://git.sudo.ws/sudo/commit/?id=a55e6898e)

* env.c:

  Fix off by one error in number of bytes allocated via malloc (does not
  affected any released version of sudo).
  [[705c4c751]](https://git.sudo.ws/sudo/commit/?id=705c4c751)

2001-12-30 Todd C. Miller

* lex.yy.c:

  regen
  [[8aa5f6850]](https://git.sudo.ws/sudo/commit/?id=8aa5f6850)

* parse.lex:

  Allow ‘@’, ‘(’, ‘)’, ‘:’ in arguments to a defaults variable w/o
  requiring that they be quoted.
  [[5d5c6783d]](https://git.sudo.ws/sudo/commit/?id=5d5c6783d)

* sudoers.cat, sudoers.man.in, sudoers.pod:

  Mention that no double quotes are needed when adding/deleting/assigning
  a single value to a list.
  [[412819b40]](https://git.sudo.ws/sudo/commit/?id=412819b40)

* Makefile.in:

  Don’t rely on mkdefaults being executable, call perl explicitly.
  [[e69a33b47]](https://git.sudo.ws/sudo/commit/?id=e69a33b47)

* sudo.tab.c:

  regen
  [[e86de6496]](https://git.sudo.ws/sudo/commit/?id=e86de6496)

* parse.yacc:

  Remove some XXX that are no longer relevant.
  [[cf2952dd8]](https://git.sudo.ws/sudo/commit/?id=cf2952dd8)

* defaults.c:

  o Roll our own loop instead of using strpbrk() for better grokability o
  When adding to a list we must malloc() and use memcpy(), not strdup()
  since we must only copy len bytes from str.
  [[8dc87eeb2]](https://git.sudo.ws/sudo/commit/?id=8dc87eeb2)

2001-12-21 Todd C. Miller

* sudo.tab.c:

  regen
  [[53320cadd]](https://git.sudo.ws/sudo/commit/?id=53320cadd)

* parse.yacc:

  typo in comment
  [[ac4aa8115]](https://git.sudo.ws/sudo/commit/?id=ac4aa8115)

2001-12-19 Todd C. Miller

* CHANGES:

  checkpoint
  [[b961b88af]](https://git.sudo.ws/sudo/commit/?id=b961b88af)

* configure:

  regen
  [[7ceda8c9b]](https://git.sudo.ws/sudo/commit/?id=7ceda8c9b)

* configure.in:

  avoid the -g flag unless –with-devel was specified
  [[83c2e51ba]](https://git.sudo.ws/sudo/commit/?id=83c2e51ba)

* Makefile.in:

  mkdefaults, def\_data.in and sigaction.c were missing from the tarball
  [[e69dc38fd]](https://git.sudo.ws/sudo/commit/?id=e69dc38fd)

* Makefile.in:

  def\_data.c was missing
  [[21de57f54]](https://git.sudo.ws/sudo/commit/?id=21de57f54)

2001-12-18 Todd C. Miller

* env.c:

  Fix setting of $USER and $LOGNAME in the non-reset\_env case. Also allow
  HOME, SHELL, LOGNAME, and USER to be specified in keep\_env
  [[087f5a7d5]](https://git.sudo.ws/sudo/commit/?id=087f5a7d5)

* TODO:

  Another TODO item
  [[fdae7ed9d]](https://git.sudo.ws/sudo/commit/?id=fdae7ed9d)

* sudoers:

  Add comment for Default section so folks know where it should go.
  [[2403f24a2]](https://git.sudo.ws/sudo/commit/?id=2403f24a2)

2001-12-17 Todd C. Miller

* tgetpass.c:

  Use TCSETAF, not TCSETA to set terminal in termio case
  [[0cc2362d4]](https://git.sudo.ws/sudo/commit/?id=0cc2362d4)

* sudoers.cat, sudoers.man.in:

  regen from sudoers.pod
  [[a459e6a31]](https://git.sudo.ws/sudo/commit/?id=a459e6a31)

* sudoers.pod:

  o Typo, Runas\_User\_List should be Runas\_List o a User\_List can not
  contain a uid o mention that the Defaults section should come after
  Alias definitions but before the user specifications
  [[9a3300763]](https://git.sudo.ws/sudo/commit/?id=9a3300763)

2001-12-15 Todd C. Miller

* sudoers.cat, sudoers.man.in:

  regen
  [[b42400d77]](https://git.sudo.ws/sudo/commit/?id=b42400d77)

* sudoers.pod:

  Fix listpw and verifypw sections, they were not being formatted
  properly.
  [[16912179e]](https://git.sudo.ws/sudo/commit/?id=16912179e)

* sudoers.cat, sudoers.man.in:

  regen
  [[df7144394]](https://git.sudo.ws/sudo/commit/?id=df7144394)

* sudoers.pod:

  fix typos
  [[d24eac7fd]](https://git.sudo.ws/sudo/commit/?id=d24eac7fd)

* configure:

  regen
  [[b4b65750e]](https://git.sudo.ws/sudo/commit/?id=b4b65750e)

* config.h.in, configure.in:

  use AC\_SYS\_POSIX\_TERMIOS instead of rolling our own
  [[313bbae1d]](https://git.sudo.ws/sudo/commit/?id=313bbae1d)

* README:

  Reference sudo.ws not courtesan.com
  [[f3970677c]](https://git.sudo.ws/sudo/commit/?id=f3970677c)

* PORTING:

  Add notes on shadow passwords
  [[8dd7527bd]](https://git.sudo.ws/sudo/commit/?id=8dd7527bd)

* BUGS:

  In list mode (sudo -l), characters escaped with a backslash are shown
  verbatim with the backslash.
  [[81a4d81f8]](https://git.sudo.ws/sudo/commit/?id=81a4d81f8)

* sudoers:

  Add simple examples from OpenBSD (Marc Espie)
  [[c953644f6]](https://git.sudo.ws/sudo/commit/?id=c953644f6)

* tgetpass.c:

  Catch SIGTTIN and SIGTTOU too and treat them like SIGTSTP.
  [[540ba4287]](https://git.sudo.ws/sudo/commit/?id=540ba4287)

* CHANGES:

  minor prettyification
  [[a4e9f7cff]](https://git.sudo.ws/sudo/commit/?id=a4e9f7cff)

* CHANGES:

  Updated change log
  [[4c587ba66]](https://git.sudo.ws/sudo/commit/?id=4c587ba66)

* testsudoers.c:

  Fix CIDR handling here too.
  [[b083b9f92]](https://git.sudo.ws/sudo/commit/?id=b083b9f92)

* auth/pam.c:

  Apparently a NULL response is OK
  [[79df2fa42]](https://git.sudo.ws/sudo/commit/?id=79df2fa42)

* TODO:

  Checkpoint for upcoming beta release
  [[1e1e65807]](https://git.sudo.ws/sudo/commit/?id=1e1e65807)

* TROUBLESHOOTING:

  Many people believe that adding a runas spec should obviate the need for
  the -u flag. It does not.
  [[4450b82c8]](https://git.sudo.ws/sudo/commit/?id=4450b82c8)

* RUNSON:

  checkpoint update for upcoming 1.6.4 beta
  [[a138852ea]](https://git.sudo.ws/sudo/commit/?id=a138852ea)

* config.h.in:

  o Add HAVE\_STDLIB\_H and HAVE\_MEMORY\_H o Define HAVE\_STRINGS\_H even if
  HAVE\_STRING\_H is defined – this is safe now
  [[7be0cd14a]](https://git.sudo.ws/sudo/commit/?id=7be0cd14a)

* PORTING:

  Add signals section
  [[22d04a60b]](https://git.sudo.ws/sudo/commit/?id=22d04a60b)

* configure:

  regen
  [[ab70cc89b]](https://git.sudo.ws/sudo/commit/?id=ab70cc89b)

* configure.in:

  Fix check for sigaction\_t
  [[947573dbe]](https://git.sudo.ws/sudo/commit/?id=947573dbe)

* sudo.c:

  XXX - should call find\_path() as runas user, not root. Can’t do that
  until the parser changes though.
  [[afe8333fc]](https://git.sudo.ws/sudo/commit/?id=afe8333fc)

* sudo.c:

  If find\_path() fails as root, try again as the invoking user (useful for
  NFS). Idea from Chip Capelik.
  [[cfadcb173]](https://git.sudo.ws/sudo/commit/?id=cfadcb173)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in:

  Regenerate after pod file changes
  [[3dc5439c2]](https://git.sudo.ws/sudo/commit/?id=3dc5439c2)

* def\_data.c, def\_data.h, def\_data.in, set\_perms.c, sudo.c, sudo.h,
  sudo.pod, sudoers.pod:

  Add new sudoers option “preserve\_groups”. Previously sudo would not call
  initgroups() if the target user was root. Now it always calls
  initgroups() unless the -P command line option or the “preserve\_groups”
  sudoers option is set. Idea from TJ Saunders.
  [[761b119e2]](https://git.sudo.ws/sudo/commit/?id=761b119e2)

2001-12-14 Todd C. Miller

* compat.h, config.h.in:

  Use new HAVE\_SIGACTION\_T define
  [[66d801055]](https://git.sudo.ws/sudo/commit/?id=66d801055)

* logging.c:

  Fix compilation on K&C
  [[3d723eda8]](https://git.sudo.ws/sudo/commit/?id=3d723eda8)

* configure:

  regen
  [[82a1cba52]](https://git.sudo.ws/sudo/commit/?id=82a1cba52)

* configure.in:

  Add check for sigaction\_t – IRIX already defines this so don’t redefine
  it.
  [[1f20e80b9]](https://git.sudo.ws/sudo/commit/?id=1f20e80b9)

* snprintf.c:

  fix typo
  [[b3a5ef5b7]](https://git.sudo.ws/sudo/commit/?id=b3a5ef5b7)

* interfaces.c:

  need stdlib.h here too
  [[3b925f81a]](https://git.sudo.ws/sudo/commit/?id=3b925f81a)

* configure:

  regen
  [[df5df978d]](https://git.sudo.ws/sudo/commit/?id=df5df978d)

* configure.in:

  Remove redundant checks for string.h, strings.h and unistd.h
  [[06461973d]](https://git.sudo.ws/sudo/commit/?id=06461973d)

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in, visudo.cat,
  visudo.man.in:

  Regen from pod files
  [[5d0b523ae]](https://git.sudo.ws/sudo/commit/?id=5d0b523ae)

* BUGS:

  Update for 1.6.4
  [[ba0635bf5]](https://git.sudo.ws/sudo/commit/?id=ba0635bf5)

* configure, lex.yy.c, sudo.tab.c:

  regen
  [[722cebb5c]](https://git.sudo.ws/sudo/commit/?id=722cebb5c)

* strerror.c:

  Return EINVAL if errnum > sys\_nerr
  [[e0315c59e]](https://git.sudo.ws/sudo/commit/?id=e0315c59e)

* auth/sudo\_auth.h:

  o Update copyright year
  [[152e745d7]](https://git.sudo.ws/sudo/commit/?id=152e745d7)

* LICENSE, Makefile.binary, Makefile.in, aclocal.m4, compat.h,
  config.h.in, defaults.h, interfaces.h, pathnames.h.in, sudo.h, sudo.pod:
  o Update copyright year
  [[47dff3718]](https://git.sudo.ws/sudo/commit/?id=47dff3718)

* configure.in:

  o Don’t define STDC\_HEADERS unconditionally for IRIX o Update copyright
  year
  [[c2b2b6c3d]](https://git.sudo.ws/sudo/commit/?id=c2b2b6c3d)

* README:

  update version
  [[ea17e9fd6]](https://git.sudo.ws/sudo/commit/?id=ea17e9fd6)

* auth/afs.c, auth/aix\_auth.c, auth/bsdauth.c, auth/dce.c, auth/fwtk.c,
  auth/kerb4.c, auth/kerb5.c, auth/pam.c, auth/passwd.c, auth/rfc1938.c,
  auth/secureware.c, auth/securid.c, auth/sia.c, auth/sudo\_auth.c,
  logging.c, parse.c, parse.lex, parse.yacc, set\_perms.c, snprintf.c,
  sudo.c, testsudoers.c, tgetpass.c, utime.c, visudo.c:

  o Reorder some headers and use STDC\_HEADERS define properly o Update
  copyright year
  [[65fad4df3]](https://git.sudo.ws/sudo/commit/?id=65fad4df3)

* lsearch.c:

  o Reorder some headers and use STDC\_HEADERS define properly o Update
  copyright year
  [[31053cfac]](https://git.sudo.ws/sudo/commit/?id=31053cfac)

* getspwuid.c, goodpath.c, interfaces.c:

  o Reorder some headers and use STDC\_HEADERS define properly o Update
  copyright year
  [[f61723c47]](https://git.sudo.ws/sudo/commit/?id=f61723c47)

* getcwd.c:

  o Reorder some headers and use STDC\_HEADERS define properly o Update
  copyright year
  [[ca12a5bef]](https://git.sudo.ws/sudo/commit/?id=ca12a5bef)

* alloc.c, check.c, defaults.c, env.c, fileops.c, find\_path.c, fnmatch.c:

  o Reorder some headers and use STDC\_HEADERS define properly o Update
  copyright year
  [[46dd419cd]](https://git.sudo.ws/sudo/commit/?id=46dd419cd)

* configure:

  regen
  [[38a890097]](https://git.sudo.ws/sudo/commit/?id=38a890097)

* tgetpass.c:

  flags set in signal handlers should be volatile sig\_atomic\_t
  [[b1dd45403]](https://git.sudo.ws/sudo/commit/?id=b1dd45403)

* config.h.in, configure.in:

  Add checks for volatile and sig\_atomic\_t
  [[86743d987]](https://git.sudo.ws/sudo/commit/?id=86743d987)

* configure, lex.yy.c:

  regen
  [[b0095c2f9]](https://git.sudo.ws/sudo/commit/?id=b0095c2f9)

* def\_data.c, def\_data.h, def\_data.in, defaults.c, env.c, find\_path.c,
  sudo.c, sudoers.pod:

  Remove “secure\_path” Defaults option since it cannot work with the
  existing parser.
  [[2e677e102]](https://git.sudo.ws/sudo/commit/?id=2e677e102)

* find\_path.c, sudo.c:

  Unset “secure\_path” if user\_is\_exempt()
  [[f590093e4]](https://git.sudo.ws/sudo/commit/?id=f590093e4)

* env.c, pathnames.h.in:

  o Remove assumption that PATH and TERM are not listed in env\_keep o If
  no PATH is in the environment use a default value o If TERM is not set
  in the non-reset case also give it a default value.
  [[2cbd965d6]](https://git.sudo.ws/sudo/commit/?id=2cbd965d6)

* aclocal.m4, configure.in, defaults.c, pathnames.h.in:

  \_PATH\_SENDMAIL -> \_PATH\_SUDO\_SENDMAIL so –without-sendmail works on
  systems that define in paths.h
  [[be8422eed]](https://git.sudo.ws/sudo/commit/?id=be8422eed)

* auth/passwd.c, auth/sudo\_auth.c, auth/sudo\_auth.h:

  Add support for skeyaccess(3) if it is present in libskey.
  [[e299dee34]](https://git.sudo.ws/sudo/commit/?id=e299dee34)

2001-12-13 Todd C. Miller

* sudo.c:

  Only need to do ’lc = login\_getclass(NULL)’ if lc == NULL
  [[cf92836ec]](https://git.sudo.ws/sudo/commit/?id=cf92836ec)

* parse.lex:

  ‘\’ is a perfectly legal character to have in a command line argument.
  [[3f97a5e44]](https://git.sudo.ws/sudo/commit/?id=3f97a5e44)

* sudo.c:

  o Defer call to set\_fqdn() until it is safe to use log\_error() o Don’t
  print errno string value if gethostbyname fails, it is not relevant
  [[678f56e2e]](https://git.sudo.ws/sudo/commit/?id=678f56e2e)

* parse.c:

  Fix CIDR -> in\_addr\_t conversion.
  [[4572e8046]](https://git.sudo.ws/sudo/commit/?id=4572e8046)

2001-12-12 Todd C. Miller

* sudoers.pod:

  Remove an extra “User\_List” in the User\_Spec definition From ybertrand
  AT snoopymail.com
  [[bcdcc32a7]](https://git.sudo.ws/sudo/commit/?id=bcdcc32a7)

* parse.c:

  Make ’listpw=never’ work for users who are not explicitly mentioned in
  sudoers.
  [[afff0d56b]](https://git.sudo.ws/sudo/commit/?id=afff0d56b)

* sudoers.pod:

  Remove gratuitous ‘=’ in EBNF grammar; era AT iki.fi
  [[3d1344a71]](https://git.sudo.ws/sudo/commit/?id=3d1344a71)

* sudoers.pod:

  Document new list Defaults type and convert env\_keep and env\_delete to
  lists. Document new env\_check option.
  [[b1687838f]](https://git.sudo.ws/sudo/commit/?id=b1687838f)

* lex.yy.c, sudo.tab.c, sudo.tab.h:

  regen parser
  [[d684d37a9]](https://git.sudo.ws/sudo/commit/?id=d684d37a9)

* parse.lex:

  Don’t let ‘#’ appear in a {WORD} and restrict #foo in a Runas spec to
  #[0-9-]+.
  [[4447e04fa]](https://git.sudo.ws/sudo/commit/?id=4447e04fa)

* configure:

  regen
  [[40840e10c]](https://git.sudo.ws/sudo/commit/?id=40840e10c)

* aclocal.m4:

  Simpler SUDO\_FUNC\_ISBLANK that uses AC\_TRY\_LINK
  [[170eef964]](https://git.sudo.ws/sudo/commit/?id=170eef964)

* config.h.in, configure.in:

  Add check for skeyaccess(3)
  [[f66fcb464]](https://git.sudo.ws/sudo/commit/?id=f66fcb464)

* visudo.pod:

  Document new -c, -f, and -q options
  [[4632986cd]](https://git.sudo.ws/sudo/commit/?id=4632986cd)

* visudo.c:

  o Add -f option (alternate sudoers file) o Convert to use getopt(3)
  [[3c4691a1d]](https://git.sudo.ws/sudo/commit/?id=3c4691a1d)

* configure:

  regen
  [[4073b477f]](https://git.sudo.ws/sudo/commit/?id=4073b477f)

* aclocal.m4, config.h.in, configure.in:

  Add check for isblank and a replacement macro if it doesn’t exist.
  [[46be666b3]](https://git.sudo.ws/sudo/commit/?id=46be666b3)

2001-12-11 Todd C. Miller

* visudo.c:

  In check-only mode, don’t create sudoers if it does not already exist.
  [[8f896ec2e]](https://git.sudo.ws/sudo/commit/?id=8f896ec2e)

* parse.yacc:

  o Add a new token, DEFVAR, to indicate a Defaults variable name o Add
  support for “+=” and “-=” list operators o replace some 1 and 0 with
  TRUE and FALSE for greater legibility.
  [[548639078]](https://git.sudo.ws/sudo/commit/?id=548639078)

* parse.lex:

  o Use exclusive start conditions to remove some ambiguity in the lexer.
  Also reorder some things for clarity. o Add support for “+=” and “-=”
  list operators. o Use the new DEFVAR token to denote a Defaults variable
  name.
  [[cf2db3682]](https://git.sudo.ws/sudo/commit/?id=cf2db3682)

* sudo.h:

  Prototype init\_envtables()
  [[e63182a25]](https://git.sudo.ws/sudo/commit/?id=e63182a25)

* env.c:

  o Convert environment handling to use lists instead of strings. This
  greatly simplifies routines that need to do “foreach” type operations. o
  Add new init\_envtables() function to set env\_check and env\_delete
  defaults based on initial\_badenv\_table and initial\_checkenv\_table
  (formerly sudo\_badenv\_table).
  [[199a17436]](https://git.sudo.ws/sudo/commit/?id=199a17436)

* defaults.c, defaults.h:

  o Add a new LIST type and functions to manipulate it. o This is for use
  with environment handling variables. o Call new init\_envtables() routine
  inside init\_defaults() to initialize the environment lists.
  [[2f818e2c3]](https://git.sudo.ws/sudo/commit/?id=2f818e2c3)

* def\_data.c, def\_data.h, def\_data.in:

  Convert environment options to use the new LIST type and add a new one,
  env\_check that only deletes if the sanity check fails.
  [[93971de65]](https://git.sudo.ws/sudo/commit/?id=93971de65)

* testsudoers.c:

  Add dummy version of init\_envtables()
  [[7b93f51d5]](https://git.sudo.ws/sudo/commit/?id=7b93f51d5)

* parse.yacc:

  honor quiet mode
  [[f0e806a12]](https://git.sudo.ws/sudo/commit/?id=f0e806a12)

* visudo.c:

  Add check-only mode
  [[f7f91aff5]](https://git.sudo.ws/sudo/commit/?id=f7f91aff5)

* mkdefaults:

  Fix generation of entries with NULL descriptions.
  [[76ff0218c]](https://git.sudo.ws/sudo/commit/?id=76ff0218c)

2001-12-09 Todd C. Miller

* tgetpass.c:

  Use sigaction\_t and quiet a gcc warning.
  [[d38e57ef4]](https://git.sudo.ws/sudo/commit/?id=d38e57ef4)

* sudo.c:

  Must reset signal handlers before we exec
  [[4cad1daa7]](https://git.sudo.ws/sudo/commit/?id=4cad1daa7)

* auth/aix\_auth.c, auth/bsdauth.c, auth/fwtk.c, auth/pam.c,
  auth/sudo\_auth.c:

  Be carefule now that tgetpass() can return NULL (user hit ^C). PAM
  version needs testing. Set SIGTSTP to SIG\_DFL during password entry so
  user can suspend us.
  [[88951a3b9]](https://git.sudo.ws/sudo/commit/?id=88951a3b9)

* tgetpass.c:

  Add support for interrupting/suspending tgetpass via keyboard input. If
  you suspend sudo from the password prompt and resume it will re-prompt
  you.
  [[6d6d4628f]](https://git.sudo.ws/sudo/commit/?id=6d6d4628f)

* sudo.c:

  Don’t block keyboard interrupt signals, just set them to SIG\_IGN.
  [[60bbfa42d]](https://git.sudo.ws/sudo/commit/?id=60bbfa42d)

2001-12-08 Todd C. Miller

* config.h.in:

  add back HAVE\_SIGACTION
  [[e6545c86f]](https://git.sudo.ws/sudo/commit/?id=e6545c86f)

* configure:

  regen
  [[c570580e4]](https://git.sudo.ws/sudo/commit/?id=c570580e4)

* config.h.in, configure.in, logging.c, sudo.c, visudo.c:

  Kill POSIX\_SIGNALS define and old signal support now that we emulate
  POSIX ones Also be sure to correctly initialize struct sigaction.
  [[241cb64cc]](https://git.sudo.ws/sudo/commit/?id=241cb64cc)

* strerror.c:

  Don’t need config.h or “#ifndef HAVE\_STRERROR” wrapper.
  [[028a55fb2]](https://git.sudo.ws/sudo/commit/?id=028a55fb2)

* compat.h:

  Add scaffolding for POSIX signal emulation
  [[fb66a3315]](https://git.sudo.ws/sudo/commit/?id=fb66a3315)

* sigaction.c:

  o Add missing ‘;’ so this compiles o Can’t use NULL since we don’t
  include stdio.h
  [[0cee8304a]](https://git.sudo.ws/sudo/commit/?id=0cee8304a)

* sigaction.c:

  Emulate sigaction() using sigvec()
  [[9af30ba66]](https://git.sudo.ws/sudo/commit/?id=9af30ba66)

2001-11-13 Todd C. Miller

* sudoers.pod:

  Document new behavior of negative values of timestamp\_timeout Fix a typo
  [[78d67cfb5]](https://git.sudo.ws/sudo/commit/?id=78d67cfb5)

* sudo.pod:

  Add security note about command not being logged after ‘sudo su’ and
  friends.
  [[eac21ad7b]](https://git.sudo.ws/sudo/commit/?id=eac21ad7b)

* sudo.pod:

  Mention that -V prints default values when run as root, including the
  list of environment variables to clear.
  [[031b00921]](https://git.sudo.ws/sudo/commit/?id=031b00921)

* Makefile.in:

  Run pod2man with –quotes=none to avoid stupid quoting of C<> entries.
  [[fc5272531]](https://git.sudo.ws/sudo/commit/?id=fc5272531)

2001-11-12 Todd C. Miller

* auth/sudo\_auth.c, def\_data.c, def\_data.h, def\_data.in, sudoers.pod:

  Add mail\_badpass option Also modify mail\_always behavior to also send
  mail when the password is wrong
  [[de9d655ea]](https://git.sudo.ws/sudo/commit/?id=de9d655ea)

* env.c, sudo.c, sudo.h:

  Dump default bad env table when ‘sudo -V’ is run by root.
  [[63ae9ec2a]](https://git.sudo.ws/sudo/commit/?id=63ae9ec2a)

* sudoers.pod:

  document env\_delete
  [[c4c0f0046]](https://git.sudo.ws/sudo/commit/?id=c4c0f0046)

* env.c:

  Add support for ‘\*’ in env\_keep when not resetting the environment (ie:
  the normal case).
  [[65302649f]](https://git.sudo.ws/sudo/commit/?id=65302649f)

* env.c:

  Add env\_delete variable that lets the user replace/add to the
  bad\_env\_table. Allow ‘\*’ wildcard in env\_keep entries.
  [[ab020c056]](https://git.sudo.ws/sudo/commit/?id=ab020c056)

2001-11-06 Todd C. Miller

* mkinstalldirs:

  Force umask to 022 to guarantee sane directory permissions.
  [[07f5d7ae7]](https://git.sudo.ws/sudo/commit/?id=07f5d7ae7)

2001-11-02 Todd C. Miller

* Makefile.in:

  add sudo.tab.h and sudo.tab.c to sudo.tab.o dependency
  [[5133d4a34]](https://git.sudo.ws/sudo/commit/?id=5133d4a34)

* mkdefaults:

  fix breakage in last commit
  [[2d5486db9]](https://git.sudo.ws/sudo/commit/?id=2d5486db9)

* Makefile.in:

  acsite.m4 -> aclocal.m4
  [[1d232a6aa]](https://git.sudo.ws/sudo/commit/?id=1d232a6aa)

* check.c:

  fix I\_TS\_TIMEOUT vs. I\_TIMESTAMP\_TIMEOUT pasto in previous commit
  [[dea43637e]](https://git.sudo.ws/sudo/commit/?id=dea43637e)

* def\_data.c:

  regenerated from def\_data.in
  [[d50e2bb38]](https://git.sudo.ws/sudo/commit/?id=d50e2bb38)

* check.c, defaults.c, defaults.h:

  Add new T\_UINT type that most things use instead of T\_INT If
  timestamp\_timeout is < 0 then treat the ticket as never expiring (to be
  expired manually by the user).
  [[3550d52a9]](https://git.sudo.ws/sudo/commit/?id=3550d52a9)

* def\_data.in:

  change most T\_INT -> T\_UINT
  [[0906516df]](https://git.sudo.ws/sudo/commit/?id=0906516df)

* mkdefaults:

  fix warning when no args
  [[27a4c619b]](https://git.sudo.ws/sudo/commit/?id=27a4c619b)

* visudo.c:

  Change 2 Exit() -> exit() Avoid stdio in Exit() and call \_exit() if we
  are a signal handler. We no longer print the signal number but the user
  can just check the exit value for that.
  [[717eb3fdf]](https://git.sudo.ws/sudo/commit/?id=717eb3fdf)

2001-10-16 Todd C. Miller

* logging.c:

  when setting up pipes in child process check for case where stdin ==
  pipe fd 0
  [[1fbc786d6]](https://git.sudo.ws/sudo/commit/?id=1fbc786d6)

2001-10-11 Todd C. Miller

* visudo.c:

  Ignore editor exit value since XPG4 says vi’s exit value is the count of
  editing errors made (failed searches, etc).
  [[d6e0c7049]](https://git.sudo.ws/sudo/commit/?id=d6e0c7049)

2001-10-05 Todd C. Miller

* configure:

  regen
  [[d17da315a]](https://git.sudo.ws/sudo/commit/?id=d17da315a)

* configure.in:

  sco now is identified by config.guess as *-sco-*
  [[8fb718e7f]](https://git.sudo.ws/sudo/commit/?id=8fb718e7f)

* configure.in:

  Check for getspnam() in -lgen if not in -lc for UnixWare.
  [[89f2ab84d]](https://git.sudo.ws/sudo/commit/?id=89f2ab84d)

2001-09-18 Todd C. Miller

* sudoers.pod, visudo.pod:

  “upper case” -> “uppercase”
  [[ace935f8a]](https://git.sudo.ws/sudo/commit/?id=ace935f8a)

* sudoers.pod:

  fix typos and grammar; pjanzen@…
  [[51dd80bd7]](https://git.sudo.ws/sudo/commit/?id=51dd80bd7)

2001-08-28 Todd C. Miller

* sudoers.pod:

  Missing word (specify); krapht@…
  [[12a978331]](https://git.sudo.ws/sudo/commit/?id=12a978331)

2001-08-23 Todd C. Miller

* sudo.c:

  If we fail to lookup a login class, apply the default one.
  [[29871e442]](https://git.sudo.ws/sudo/commit/?id=29871e442)

* logging.c:

  In log\_error() free message, not logline unconditionally, then free
  logline if it is not the same as message. No function change but this
  mirrors how they are allocated.
  [[b31b73f07]](https://git.sudo.ws/sudo/commit/?id=b31b73f07)

2001-07-17 Todd C. Miller

* configure:

  regenerate
  [[944044e30]](https://git.sudo.ws/sudo/commit/?id=944044e30)

* configure.in:

  remove some backslash quotes that are unneeded
  [[7f8d2fb3e]](https://git.sudo.ws/sudo/commit/?id=7f8d2fb3e)

* configure.in:

  o Tweaks to make this work with autoconf-2.50 o Use AC\_LIBOBJ instead of
  changing LIBOBJS directly o Use AC\_REPLACE\_FUNCS where we can o Use
  AC\_CHECK\_FUNCS instead of AC\_CHECK\_FUNC so we don’t have to AC\_DEFINE
  things manually.
  [[4969fa536]](https://git.sudo.ws/sudo/commit/?id=4969fa536)

* config.guess, config.sub:

  Updated from autoconf-2.50
  [[cb79789ac]](https://git.sudo.ws/sudo/commit/?id=cb79789ac)

2001-05-22 Todd C. Miller

* README:

  Update mailing list section. We use mailman now, not majordomo.
  [[0c3273aaf]](https://git.sudo.ws/sudo/commit/?id=0c3273aaf)

2001-05-10 Todd C. Miller

* getspwuid.c, logging.c, sudo.c:

  Use setpwent()/endpwent() + all the shadow variants to make sure we
  don’t inadvertantly leak an fd to the child. Apparently Linux’s shadow
  routines leave the fd open even if you don’t call setspent(). Reported
  by mike@…; different patch used.
  [[11127e346]](https://git.sudo.ws/sudo/commit/?id=11127e346)

2001-04-13 Todd C. Miller

* sudoers.pod:

  s/eg./e.g./
  [[993409b90]](https://git.sudo.ws/sudo/commit/?id=993409b90)

* tgetpass.c:

  select() may return EAGAIN. If so, continue like we do for EINTR.
  [[2d9fb0a5a]](https://git.sudo.ws/sudo/commit/?id=2d9fb0a5a)

* logging.c:

  Fix a non-exploitable buffer overflow in the word splitting code. This
  should really be rewritten.
  [[9dd02e2fb]](https://git.sudo.ws/sudo/commit/?id=9dd02e2fb)

* Makefile.in:

  FAQ link goes away
  [[c70104020]](https://git.sudo.ws/sudo/commit/?id=c70104020)

* INSTALL:

  Tell people to look in sample.syslog.conf for examples, not FAQ
  [[224c77f5a]](https://git.sudo.ws/sudo/commit/?id=224c77f5a)

* TROUBLESHOOTING:

  Update list of env vars that are cleared
  [[af93a4422]](https://git.sudo.ws/sudo/commit/?id=af93a4422)

* sudo.c:

  remove struct env\_table decl since that stuff has all moved to env.c
  [[646bd7034]](https://git.sudo.ws/sudo/commit/?id=646bd7034)

2001-04-04 Todd C. Miller

* fileops.c:

  Fix a pasto in flock-style unlocking and include <sys/file.h> for
  flock on older systems; twetzel@gwdg.de
  [[a6b005f25]](https://git.sudo.ws/sudo/commit/?id=a6b005f25)

* configure:

  regen to get NeXT lockf/flock fix
  [[6fcf09f56]](https://git.sudo.ws/sudo/commit/?id=6fcf09f56)

* configure.in:

  force NeXT to use flock since lockf is broken
  [[a788475e5]](https://git.sudo.ws/sudo/commit/?id=a788475e5)

2001-03-30 Todd C. Miller

* check.c:

  Use stashed user\_gid when checking against exempt gid since sudo sets
  its gid to a a value that makes sudoers readable. Previously if you used
  gid 0 as the exempt group everyone would be exempt. From Paul Kranenburg
  <pk@cs.few.eur.nl>
  [[4f6906953]](https://git.sudo.ws/sudo/commit/?id=4f6906953)

2001-03-29 Todd C. Miller

* configure:

  regen
  [[4f1ff9a1e]](https://git.sudo.ws/sudo/commit/?id=4f1ff9a1e)

* aclocal.m4:

  #include stdio.h in SUDO\_CHECK\_TYPE since IRIX 6 aparently defines some
  types (such as ssize\_t) therein.
  [[e2282d3e4]](https://git.sudo.ws/sudo/commit/?id=e2282d3e4)

2001-03-02 Todd C. Miller

* defaults.c:

  Fix negation of paths in a boolean context. Problem found by apt@UH.EDU
  [[a64a6abd3]](https://git.sudo.ws/sudo/commit/?id=a64a6abd3)

2001-02-23 Todd C. Miller

* visudo.c:

  pasto
  [[132f59534]](https://git.sudo.ws/sudo/commit/?id=132f59534)

2001-02-17 Todd C. Miller

* visudo.c:

  SA\_RESETHAND means the opposite of what I was thinking–oops To block
  all signals in old-style signals use ~0, not 0xffffffff
  [[394ececcb]](https://git.sudo.ws/sudo/commit/?id=394ececcb)

2001-02-04 Todd C. Miller

* defaults.c:

  coerce difference of pointers to int when used in a string length printf
  format; deraadt@…
  [[422021aeb]](https://git.sudo.ws/sudo/commit/?id=422021aeb)

2001-01-17 Todd C. Miller

* visudo.c:

  Block all signals in Exit() to avoid a signal race. There is still a
  tiny window but I’m not going to worry about it.
  [[af80178b8]](https://git.sudo.ws/sudo/commit/?id=af80178b8)

2001-01-07 Todd C. Miller

* env.c:

  glibc uses the LANGUAGE env var so clear that too; Solar Designer
  [[aeb8cefc4]](https://git.sudo.ws/sudo/commit/?id=aeb8cefc4)

* lex.yy.c:

  Regenerate with a fix to flex.skl that preserves errno from clobbering
  by isatty().
  [[f0a75258b]](https://git.sudo.ws/sudo/commit/?id=f0a75258b)

2000-12-31 Todd C. Miller

* auth/aix\_auth.c, auth/bsdauth.c, auth/fwtk.c, auth/pam.c, auth/sia.c,
  auth/sudo\_auth.c:

  Some defaults I\_ defines got renamed.
  [[16e6a3b84]](https://git.sudo.ws/sudo/commit/?id=16e6a3b84)

* Makefile.in, check.c, def\_data.c, def\_data.h, def\_data.in, defaults.c,
  defaults.h, env.c, logging.c, mkdefaults, parse.yacc, set\_perms.c,
  sudo.c, sudo.tab.c:

  Move defaults info into its own files from which we generate .h and .c
  files. This makes adding or rearranging variables much simpler.
  [[d956d7752]](https://git.sudo.ws/sudo/commit/?id=d956d7752)

2000-12-30 Todd C. Miller

* configure, configure.in:

  fix typo in last commit
  [[4ca4d6515]](https://git.sudo.ws/sudo/commit/?id=4ca4d6515)

* compat.h, config.h.in, configure, configure.in:

  Add check + emulation for setegid (like seteuid).
  [[5481e2289]](https://git.sudo.ws/sudo/commit/?id=5481e2289)

* env.c:

  Make env\_keep override badenv\_table as documented Fix traversal of
  badenv\_table (broken in last commit)
  [[1875e4747]](https://git.sudo.ws/sudo/commit/?id=1875e4747)

* set\_perms.c, sudo.c, sudo.h:

  Don’t try and build saved uid version of set\_perms on systems w/o them.
  Rename set\_perms\_saved\_uid() -> set\_perms\_posix() Make
  set\_perms\_setreuid simply be set\_perms\_fallback() and simply include the
  appropriate function at compile time (setreuid() vs. setuid()).
  [[572b4cf39]](https://git.sudo.ws/sudo/commit/?id=572b4cf39)

* sudoers.cat, sudoers.man.in, sudoers.pod:

  PATH is also preserved when env\_reset is in effect
  [[9318379d8]](https://git.sudo.ws/sudo/commit/?id=9318379d8)

* CHANGES, Makefile.in, check.c, compat.h, config.h.in, configure,
  configure.in, defaults.c, defaults.h, env.c, find\_path.c, getspwuid.c,
  set\_perms.c, sudo.c, sudo.cat, sudo.h, sudo.man.in, sudo.pod,
  sudoers.cat, sudoers.man.in, sudoers.pod, testsudoers.c, visudo.c,
  visudo.cat, visudo.man.in:

  New Defaults options: o stay\_setuid - sudo will remain setuid if system
  has saved uids or setreuid(2) o env\_reset - reset the environment to a
  sane default o env\_keep - preserve environment variables that would
  otherwise be cleared

  No longer use getenv/putenv/setenv functions–do environment munging by
  hand. Potentially dangerous environment variables can be cleared only if
  they contain ‘/’ pr ‘%’ characters to protect buggy programs. Moved
  environment routines into env.c (new file)
  [[998631b73]](https://git.sudo.ws/sudo/commit/?id=998631b73)

* INSTALL:

  Clear up –without-passwd description
  [[f88c0c930]](https://git.sudo.ws/sudo/commit/?id=f88c0c930)

* putenv.c, sudo\_setenv.c:

  We now build up a new environment from scratch and assign it to
  “environ”.
  [[679fee0f5]](https://git.sudo.ws/sudo/commit/?id=679fee0f5)

2000-12-19 Todd C. Miller

* sudo.pod, visudo.pod:

  Grammatical fixes from Paul Janzen
  [[211d8c7de]](https://git.sudo.ws/sudo/commit/?id=211d8c7de)

2000-12-15 Todd C. Miller

* visudo.c:

  If there was a syntax error and the user just wants to quit, unlink
  sudoers if it is zero length.
  [[6448c3523]](https://git.sudo.ws/sudo/commit/?id=6448c3523)

* visudo.c:

  ‘Q’ means ignore parse error, not ‘q’
  [[f14cf7973]](https://git.sudo.ws/sudo/commit/?id=f14cf7973)

* visudo.c:

  Open sudoers for writing with mode SUDOERS\_MODE From Dimitry Andric
  <dim@xs4all.nl>
  [[02559d344]](https://git.sudo.ws/sudo/commit/?id=02559d344)

2000-12-13 Todd C. Miller

* set\_perms.c:

  Add missing #ifdef HAVE\_LOGIN\_CAP\_H; ayamura@…
  [[744917ed6]](https://git.sudo.ws/sudo/commit/?id=744917ed6)

2000-12-09 Todd C. Miller

* config.guess, config.sub:

  Darwin / Mac OS X support from Wilfredo Sanchez <wsanchez@…>
  [[21cdac6b0]](https://git.sudo.ws/sudo/commit/?id=21cdac6b0)

2000-11-03 Todd C. Miller

* sudo.c, visudo.c:

  Use exit(127), not exit(-1)
  [[7ce284a13]](https://git.sudo.ws/sudo/commit/?id=7ce284a13)

* Makefile.in, defaults.c, defaults.h, set\_perms.c, sudo.c:

  Move set\_perms() to its own file and use POSIX saved uid or setreuid()
  if available.

  Added stay\_setuid option for systems that have libraries that perform
  extra paranoia checks in system libraries for setuid programs (ie:
  anything with issetugid(2)).
  [[7ea65e54b]](https://git.sudo.ws/sudo/commit/?id=7ea65e54b)

* sudo.c:

  strip more bits from the environment and add a facility for stripping
  things only if they contain ‘/’ or ‘%’ to address printf format string
  vulnerabilities in other programs.
  [[70f16a284]](https://git.sudo.ws/sudo/commit/?id=70f16a284)

2000-11-02 Todd C. Miller

* configure:

  regen
  [[c3233194c]](https://git.sudo.ws/sudo/commit/?id=c3233194c)

* configure.in:

  For NCR, add -lc89 to LIBS, not SUDO\_LIBS and cache the existence of
  strcasecmp().
  [[8eb484858]](https://git.sudo.ws/sudo/commit/?id=8eb484858)

* configure:

  regen
  [[9ea228b39]](https://git.sudo.ws/sudo/commit/?id=9ea228b39)

* configure.in:

  Check for strcasecmp(3) in -lc89 for NCR Unix
  [[7e7efac42]](https://git.sudo.ws/sudo/commit/?id=7e7efac42)

2000-11-01 Todd C. Miller

* config.h.in:

  Define HAVE\_INNETGR #ifdef HAVE\_\_INNETGR
  [[43905f4d7]](https://git.sudo.ws/sudo/commit/?id=43905f4d7)

* configure:

  regen
  [[ff9bbf0bd]](https://git.sudo.ws/sudo/commit/?id=ff9bbf0bd)

* compat.h, config.h.in, configure.in:

  Add check for \_innetgr(3) since NCR systems have that instead of
  innetgr(3).
  [[4fdb825a0]](https://git.sudo.ws/sudo/commit/?id=4fdb825a0)

2000-10-31 Todd C. Miller

* auth/securid.c:

  check return value of creadcfg() call sd\_close() after sd\_auth() store
  username in sd->username so we don’t rely on the USER env variable
  [[92f5fad80]](https://git.sudo.ws/sudo/commit/?id=92f5fad80)

2000-10-30 Todd C. Miller

* INSTALL:

  document –with-bsdauth
  [[7e4985821]](https://git.sudo.ws/sudo/commit/?id=7e4985821)

* configure:

  regen
  [[60c1253c8]](https://git.sudo.ws/sudo/commit/?id=60c1253c8)

* configure.in:

  –with-bsdauth assumes –with-logincap
  [[e9d00a88b]](https://git.sudo.ws/sudo/commit/?id=e9d00a88b)

* auth/bsdauth.c, auth/fwtk.c:

  When prompting for a response to a challenge, if the user just hits
  return then reprompt with echo turned on.
  [[2ec9c6a45]](https://git.sudo.ws/sudo/commit/?id=2ec9c6a45)

2000-10-29 Todd C. Miller

* sudo.c:

  Remove debugging code that should not have been committed, oops.
  [[f31d6ce25]](https://git.sudo.ws/sudo/commit/?id=f31d6ce25)

* auth/bsdauth.c:

  Use lower-level routines and get the password ourselves. Checks for a
  challenge and if there is one echo is not turned off.
  [[84baa9127]](https://git.sudo.ws/sudo/commit/?id=84baa9127)

* auth/pam.c, auth/sudo\_auth.h:

  minor housekeeping, no real code changes
  [[7a93a4aa7]](https://git.sudo.ws/sudo/commit/?id=7a93a4aa7)

2000-10-27 Todd C. Miller

* sudo.c:

  Fix a coredump in the logging functions if gethostname(2) fails by
  deferring the call to log\_error() until things are better setup.

  Fix return value of set\_loginclass() in non-BSD-auth case.

  Hard-code ‘sudo’ in the usage message so we can fit more options on a
  line
  [[e23d30b91]](https://git.sudo.ws/sudo/commit/?id=e23d30b91)

* logging.c:

  Fix errant ‘;’ (typo) that broken MSG\_ONLY
  [[2ad0d64a1]](https://git.sudo.ws/sudo/commit/?id=2ad0d64a1)

2000-10-26 Todd C. Miller

* sudo.cat, sudo.man.in:

  regen
  [[dea1ce4d3]](https://git.sudo.ws/sudo/commit/?id=dea1ce4d3)

* sudo.pod:

  Document -a flag
  [[975a58f6c]](https://git.sudo.ws/sudo/commit/?id=975a58f6c)

* Makefile.in, auth/bsdauth.c, auth/sudo\_auth.h, config.h.in, configure,
  configure.in, getspwuid.c, sudo.c:

  Add support for BSD authentication.
  [[0208b2268]](https://git.sudo.ws/sudo/commit/?id=0208b2268)

2000-10-19 Todd C. Miller

* sudoers.pod:

  Fix typo; from sato@complex.eng.hokudai.ac.jp
  [[e7ee4f988]](https://git.sudo.ws/sudo/commit/?id=e7ee4f988)

2000-10-12 Todd C. Miller

* sudoers.pod:

  Mention negating umask
  [[2365c52b2]](https://git.sudo.ws/sudo/commit/?id=2365c52b2)

* defaults.c:

  Allow user to specify umask of 0777 (same as !umask)
  [[04777172c]](https://git.sudo.ws/sudo/commit/?id=04777172c)

2000-10-09 Todd C. Miller

* sudo.pod, visudo.pod:

  Fix a typo and give a URL for the sudo history.
  [[44b9e4d4b]](https://git.sudo.ws/sudo/commit/?id=44b9e4d4b)

2000-10-08 Todd C. Miller

* defaults.c, sudo.pod:

  fix typos; pepper@…
  [[ded7261fa]](https://git.sudo.ws/sudo/commit/?id=ded7261fa)

2000-09-14 Todd C. Miller

* sudo.c, sudo.h, sudo\_setenv.c:

  sudo\_setenv() now exits on memory alloc failure instead of returning -1.
  [[9745a3194]](https://git.sudo.ws/sudo/commit/?id=9745a3194)

2000-09-07 Todd C. Miller

* sudo.c:

  Strip out NLSPATH and PATH\_LOCALE from the environment for FreeBSD and
  possibly others.
  [[deb5b07f4]](https://git.sudo.ws/sudo/commit/?id=deb5b07f4)

* logging.c:

  Don’t use vsyslog(3) since HP-UX (and others?) lack it. This means that
  “%m” won’t be expanded but we don’t use that anyway since the logging
  routines may splat to stderr as well.
  [[2ff3a2315]](https://git.sudo.ws/sudo/commit/?id=2ff3a2315)

* defaults.c, defaults.h, sudo.c, sudoers.cat, sudoers.man.in,
  sudoers.pod:

  Add always\_set\_home variable
  [[ed7827dec]](https://git.sudo.ws/sudo/commit/?id=ed7827dec)

* configure, configure.in:

  Have to hard code default values in help since the defaults are set
  *after* the help stuff.
  [[4f743f06b]](https://git.sudo.ws/sudo/commit/?id=4f743f06b)

2000-08-31 Todd C. Miller

* lex.yy.c, parse.lex:

  Allow special characters (including ‘#’) to be embedded in pathnames if
  quoted by a ‘\’. The quoted chars will be dealt with by fnmatch().
  Unfortunately, ‘sudo -l’ still prints the ‘\’.
  [[d64ad7751]](https://git.sudo.ws/sudo/commit/?id=d64ad7751)

2000-08-13 Todd C. Miller

* install-sh:

  Better path searching for programs we need.
  [[641e30612]](https://git.sudo.ws/sudo/commit/?id=641e30612)

* TROUBLESHOOTING:

  Add section on “C compiler cannot create executables” errors.
  [[81cf72ec6]](https://git.sudo.ws/sudo/commit/?id=81cf72ec6)

* Makefile.binary, Makefile.in, version.h:

  Crank version
  [[87ccf62b7]](https://git.sudo.ws/sudo/commit/?id=87ccf62b7)

* aclocal.m4, configure, configure.in, sudo.cat, sudo.man.in, sudo.pod,
  sudoers.cat, sudoers.man.in, sudoers.pod, visudo.cat, visudo.man.in,
  visudo.pod:

  Substitute values from configure into man pages.
  [[fafefc1df]](https://git.sudo.ws/sudo/commit/?id=fafefc1df)

2000-08-12 Todd C. Miller

* parse.c, sudo.c:

  The listpw and verifypw sudoers options would not take effect because
  the value of the default was checked *before* sudoers was parsed.
  Instead of passing in the value of PWCHECK\_\* to sudoers\_lookup(), pass
  in the arg for def\_ival() so the check can be deferred until after
  sudoers is parsed.
  [[6525e882a]](https://git.sudo.ws/sudo/commit/?id=6525e882a)

2000-08-11 Todd C. Miller

* tgetpass.c:

  When writing prompt, no need to write the NUL as well; hag@…
  [[d76537718]](https://git.sudo.ws/sudo/commit/?id=d76537718)

2000-06-09 Todd C. Miller

* install-sh:

  When looking for chown, check in /sbin too
  [[8f9dfff26]](https://git.sudo.ws/sudo/commit/?id=8f9dfff26)

2000-06-05 Todd C. Miller

* visudo.c:

  Remove extraneous call to init\_defaults() and set runas\_user to NULL
  betweem parses so init\_defaults will reset it each time, thus avoiding a
  reference to free()d data.
  [[d9a645879]](https://git.sudo.ws/sudo/commit/?id=d9a645879)

2000-06-04 Todd C. Miller

* config.h.in, interfaces.c, interfaces.h, sudo.c:

  Add support for using getifaddrs() to get the list of ip addr / netmask
  pairs. Currently IPv4-only.
  [[d7050d561]](https://git.sudo.ws/sudo/commit/?id=d7050d561)

* visudo.c:

  Add a missing check for UserEditor == NULL Add missing ‘+’ before line
  number when invoking editor to fix a syntax error
  [[61048797f]](https://git.sudo.ws/sudo/commit/?id=61048797f)

2000-05-12 Todd C. Miller

* sudo.c:

  Call clean\_env very early in main() for paranoia’s sake. Idea from Marc
  Esipovich.
  [[7a2dfb77f]](https://git.sudo.ws/sudo/commit/?id=7a2dfb77f)

2000-05-10 Todd C. Miller

* sudo.h:

  Update proto for evasprintf and easprintf
  [[fc15c3dbd]](https://git.sudo.ws/sudo/commit/?id=fc15c3dbd)

* alloc.c:

  Make easprintf() and evasprintf() return an int.
  [[b00e117e3]](https://git.sudo.ws/sudo/commit/?id=b00e117e3)

* check.c:

  If the targetpw flag is set, use target username as part of the
  timestamp path. If tty tickets are in effect cat the tty and the target
  username with a ‘:’ as the separator.
  [[192b2ae6c]](https://git.sudo.ws/sudo/commit/?id=192b2ae6c)

2000-05-09 Todd C. Miller

* auth/pam.c:

  Backout part of last change; setting PAM\_USER to the invoking user
  breaks things like targetpw.
  [[7dce46e8c]](https://git.sudo.ws/sudo/commit/?id=7dce46e8c)

* auth/pam.c:

  set tty and username via pam\_set\_item
  [[b6becc577]](https://git.sudo.ws/sudo/commit/?id=b6becc577)

* auth/sudo\_auth.c, check.c, getspwuid.c, sudo.c, sudo.h:

  Fix root, runas, and target authentication for non-passwd file auth
  methods.
  [[165bd7faf]](https://git.sudo.ws/sudo/commit/?id=165bd7faf)

2000-04-22 Todd C. Miller

* sudo.cat, sudo.man.in, sudo.pod, sudoers.cat, sudoers.man.in,
  sudoers.pod, visudo.cat, visudo.man.in, visudo.pod:

  Use B<-Z> not C<-Z> for command line flags in all places. This is
  more consistent and works around a bug in Pod::Man.
  [[30daa8325]](https://git.sudo.ws/sudo/commit/?id=30daa8325)

* sudoers.cat, sudoers.man.in, sudoers.pod:

  Fix an occurence of ‘semicolon’ that should be ‘colon’
  [[2d50daad2]](https://git.sudo.ws/sudo/commit/?id=2d50daad2)

2000-04-19 Todd C. Miller

* configure, configure.in:

  Fix –with-badpri help line
  [[576ea0ed1]](https://git.sudo.ws/sudo/commit/?id=576ea0ed1)

2000-04-17 Todd C. Miller

* defaults.c, logging.c, sudo.c:

  Bracket calls to syslog with an openlog() and closelog() since some
  authentication methods (like PAM) may do their own logging via syslog.
  Since we don’t use syslog much (usually just once per session) this
  doesn’t really incur a performance penalty. It also Fixes a SEGV with
  pam\_kafs.
  [[455f27816]](https://git.sudo.ws/sudo/commit/?id=455f27816)

2000-04-15 Todd C. Miller

* sudo.c:

  Fix -H flag. runas\_homedir is only valid after set\_perms(PERM\_RUNAS,
  mode)
  [[978e3f8bc]](https://git.sudo.ws/sudo/commit/?id=978e3f8bc)

2000-04-12 Todd C. Miller

* INSTALL:

  Clarify the fact that insults are not enabled just by including them in
  the binary.
  [[aef6d6ddb]](https://git.sudo.ws/sudo/commit/?id=aef6d6ddb)

2000-04-07 Todd C. Miller

* sudo.cat, sudo.man.in, sudoers.cat, sudoers.man.in, visudo.cat,
  visudo.man.in:

  Regenerated with perl 5.6.0 pod2man
  [[dffa5b014]](https://git.sudo.ws/sudo/commit/?id=dffa5b014)

* Makefile.in:

  Give date string to pod2man since its default is ugly and it ain’t got
  no alibi.
  [[7e00f9c37]](https://git.sudo.ws/sudo/commit/?id=7e00f9c37)

* Makefile.in:

  Do section substitution on the output of pod2man and remove hack needed
  for old pod2man.
  [[0755c34a8]](https://git.sudo.ws/sudo/commit/?id=0755c34a8)

* sudo.pod, sudoers.pod, visudo.pod:

  Put back real man sections, we will do the substitution later.
  [[d4be49c5f]](https://git.sudo.ws/sudo/commit/?id=d4be49c5f)

2000-04-02 Todd C. Miller

* configure, configure.in:

  Don’t bother checking for the path to vi if user specified –with-editor
  [[fc6fe43af]](https://git.sudo.ws/sudo/commit/?id=fc6fe43af)

2000-04-01 Todd C. Miller

* CHANGES, visudo.c:

  Visudo now does its own fork/exec instead of calling system(3).
  [[0c061c037]](https://git.sudo.ws/sudo/commit/?id=0c061c037)

* CHANGES, INSTALL, Makefile.in, sudoers.cat, sudoers.man.in, sudoers.pod,
  visudo.c:

  Visudo now checks for the existence of an editor and gives a sensible
  error if it does not exist.

  The path to the editor for visudo is now a colon-separated list of
  allowable editors. If the user has $EDITOR set and it matches one of the
  allowed editors that editor will be used. If not, the first editor in
  the list that actually exists is used.
  [[6dd2d9592]](https://git.sudo.ws/sudo/commit/?id=6dd2d9592)

* sudo.cat, sudo.man.in, sudo.pod:

  Clear up confusion wrt sudo’s return value.
  [[2588aeaa5]](https://git.sudo.ws/sudo/commit/?id=2588aeaa5)

2000-03-27 Todd C. Miller

* Makefile.in:

  Strip sudo and visudo for bindist target
  [[aaa68a2b4]](https://git.sudo.ws/sudo/commit/?id=aaa68a2b4)

* sudo.cat, sudo.man.in, sudo.pod, sudoers.cat, sudoers.man.in,
  sudoers.pod, visudo.cat, visudo.man.in, visudo.pod:

  Use @mansectsu@ and @mansectform@ in the man page bodies as well.
  [[6c94d8d23]](https://git.sudo.ws/sudo/commit/?id=6c94d8d23)

* visudo.cat, visudo.man.in, visudo.pod:

  Typo: @sysconf@ -> @sysconfdir@
  [[92132436b]](https://git.sudo.ws/sudo/commit/?id=92132436b)

* Makefile.in:

  ‘make dist’ should not cause any files to be modified so remove its
  dependencies.
  [[a9a9e6601]](https://git.sudo.ws/sudo/commit/?id=a9a9e6601)

* CHANGES:

  Whoops, forgot to add release marker
  [[b2a1d4ee7]](https://git.sudo.ws/sudo/commit/?id=b2a1d4ee7)

2000-03-26 Todd C. Miller

* CHANGES:

  Final change for 1.6.3 (or so I hope)
  [[b7fdfdab4]](https://git.sudo.ws/sudo/commit/?id=b7fdfdab4)

* sudo.cat, sudoers.cat, visudo.cat:

  Use SYSV man sections since BSD systems will have nroff…
  [[6627448f5]](https://git.sudo.ws/sudo/commit/?id=6627448f5)

2000-03-24 Todd C. Miller

* parse.yacc, sudo.tab.c:

  When checking to see if the host/user matches in a defaults spec, check
  against TRUE, not just non-zero since it might be -1.
  [[1eeb9cb96]](https://git.sudo.ws/sudo/commit/?id=1eeb9cb96)

* configure, configure.in:

  OSF/1 puts file formats in section 4, not 5.
  [[e736ad4a5]](https://git.sudo.ws/sudo/commit/?id=e736ad4a5)

* CHANGES, INSTALL, sudo.c:

  Make login class support work on BSD/OS
  [[f32e054fe]](https://git.sudo.ws/sudo/commit/?id=f32e054fe)

* RUNSON:

  Update for 1.6.3
  [[5b84f2948]](https://git.sudo.ws/sudo/commit/?id=5b84f2948)

* configure, configure.in:

  If there is no inet\_addr but there *is* an \_\_inet\_addr that’s ok since
  inet\_addr is probably just a macro then. The better thing to do would be
  to look for the macro, but this is fine for now.
  [[1f343c7a0]](https://git.sudo.ws/sudo/commit/?id=1f343c7a0)

* configure, configure.in:

  Don’t use shlicc for BSD/OS 4.x
  [[6814458ab]](https://git.sudo.ws/sudo/commit/?id=6814458ab)

* Makefile.in, configure, configure.in:

  \*.man lives in cwd, \*.cat lives in $(srcdir), add a @mansrcdir@
  configure variable so we can deal with this. Also, only remove \*.man for
  ‘distclean’ not ‘clean’.
  [[b0bbcfc18]](https://git.sudo.ws/sudo/commit/?id=b0bbcfc18)

* sudo.c:

  set\_loginclass() should be static like the proto says
  [[fed49d49e]](https://git.sudo.ws/sudo/commit/?id=fed49d49e)

2000-03-23 Todd C. Miller

* fnmatch.c:

  Add #ifdef **STDC** around the rangematch function header to avoid
  promotion of test to int, thus violating the prototype. Gcc handles this
  gracefully but more std ANSI compilers will complain.
  [[7ffc5a9fa]](https://git.sudo.ws/sudo/commit/?id=7ffc5a9fa)

* emul/fnmatch.h:

  Pull in newer fnmatch(3) that supports FNM\_CASEFOLD
  [[9a41ebe72]](https://git.sudo.ws/sudo/commit/?id=9a41ebe72)

* aclocal.m4, configure, fnmatch.3, fnmatch.c:

  Pull in newer fnmatch(3) that supports FNM\_CASEFOLD Check for
  FNM\_CASEFOLD in configure
  [[4fc832c6c]](https://git.sudo.ws/sudo/commit/?id=4fc832c6c)

* CHANGES, TODO:

  update for 1.6.3
  [[e5bd3d968]](https://git.sudo.ws/sudo/commit/?id=e5bd3d968)

* sudo.tab.c, sudo.tab.h, testsudoers.c, visudo.c:

  Fully qualified hosts w/ wildcards were not matching the FQHOST token
  type. There’s really no need for a separate token for fully-qualified
  vs. unqualified anymore so FQHOST is now history and hostname\_matches
  now decides which hostname (short or long) to check based on whether or
  not the pattern contains a ‘.’.
  [[ffca544b6]](https://git.sudo.ws/sudo/commit/?id=ffca544b6)

* parse.h:

  Fully qualified hosts w/ wildcards were not matching the FQHOST token
  type. There’s really no need for a separate token for fully-qualified
  vs. unqualified anymore so FQHOST is now history and hostname\_matches
  now decides which hostname (short or long) to check based on whether or
  not the pattern contains a ‘.’.
  [[d72d7ec3f]](https://git.sudo.ws/sudo/commit/?id=d72d7ec3f)

* lex.yy.c, parse.c, parse.lex, parse.yacc:

  Fully qualified hosts w/ wildcards were not matching the FQHOST token
  type. There’s really no need for a separate token for fully-qualified
  vs. unqualified anymore so FQHOST is now history and hostname\_matches
  now decides which hostname (short or long) to check based on whether or
  not the pattern contains a ‘.’.
  [[9aeabf1b0]](https://git.sudo.ws/sudo/commit/?id=9aeabf1b0)

* parse.c, parse.h, parse.yacc, sudo.tab.c, sudoers.cat, sudoers.man.in,
  sudoers.pod, testsudoers.c, visudo.c:

  Add support for wildcards in the hostname.
  [[5ce1fa96f]](https://git.sudo.ws/sudo/commit/?id=5ce1fa96f)

* Makefile.in:

  Add targets for \*.man.in, using config.status to generate \*.man from
  \*.man.in
  [[c232acbfc]](https://git.sudo.ws/sudo/commit/?id=c232acbfc)

* sudoers.cat, sudoers.man.in, sudoers.pod:

  Document set\_logname option and enbolden refs to sudo and visudo.
  [[4c8b4fad5]](https://git.sudo.ws/sudo/commit/?id=4c8b4fad5)

* INSTALL, Makefile.in, aclocal.m4, configure, configure.in, sudo.cat,
  sudo.man.in, sudo.pod, sudoers.cat, sudoers.man.in, sudoers.pod,
  visudo.cat, visudo.man.in, visudo.pod:

  Add FreeBSD login.conf support (untested on BSD/OS) based on a patch
  from Michael D. Marchionna. configure now does substitution on the man
  pages, allowing us to fix up the paths and set the section correctly.
  Based on an idea from Michael D. Marchionna.
  [[d168a21ce]](https://git.sudo.ws/sudo/commit/?id=d168a21ce)

* auth/passwd.c:

  Better fix for handling HP-UX aging info.
  [[4d4ed8c16]](https://git.sudo.ws/sudo/commit/?id=4d4ed8c16)

* sudo.c:

  Add support for set\_logname run-time default
  [[78b6514e5]](https://git.sudo.ws/sudo/commit/?id=78b6514e5)

* sudo.man.in, sudoers.man.in, visudo.man.in:

  configure does substitution on these to produce \*.man
  [[7cd18cf36]](https://git.sudo.ws/sudo/commit/?id=7cd18cf36)

* sudo.man, sudoers.man, visudo.man:

  These files now get generated from \*.man.in at configure time.
  [[2a154e4ff]](https://git.sudo.ws/sudo/commit/?id=2a154e4ff)

2000-03-22 Todd C. Miller

* defaults.c, defaults.h:

  Add set\_logname option so users can turn off setting of LOGNAME/USER
  environment variables.
  [[f7ed0b0df]](https://git.sudo.ws/sudo/commit/?id=f7ed0b0df)

* lsearch.c, parse.c, testsudoers.c:

  kill register
  [[db2c55545]](https://git.sudo.ws/sudo/commit/?id=db2c55545)

2000-03-13 Todd C. Miller

* auth/passwd.c:

  HP-UX adds extra info at the end for password aging so when comparing
  the result of crypt to pw\_passwd we only compare the first len(epass)
  bytes *unless* the user entered an empty string for a password.
  [[cbd889868]](https://git.sudo.ws/sudo/commit/?id=cbd889868)

* logging.c:

  Get rid of grandchild hack, it was causing problems and there is really
  no need for it. This fixes a bug where we spin eating up CPU when the
  user runs a long-running process like a shell.
  [[a6ad7f071]](https://git.sudo.ws/sudo/commit/?id=a6ad7f071)

2000-03-07 Todd C. Miller

* sudo.c:

  User can always specify a login class if he/she is already root.
  [[568483159]](https://git.sudo.ws/sudo/commit/?id=568483159)

* config.h.in, configure, configure.in, defaults.c, defaults.h, sudo.c,
  sudo.h:

  FreeBSD login class (login.conf) support.
  [[935a51e76]](https://git.sudo.ws/sudo/commit/?id=935a51e76)

2000-03-06 Todd C. Miller

* auth/sudo\_auth.c:

  HAVE\_SECUREWARE -> HAVE\_GETPRPWNAM; fixes secureware support
  [[4ea67119e]](https://git.sudo.ws/sudo/commit/?id=4ea67119e)

2000-03-03 Todd C. Miller

* auth/passwd.c:

  Truncate unencrypted password to 8 chars if encrypted password is
  exactly 13 characters (indicateing standard a DES password). Many
  versions of crypt() do this for you, but not all (like HP-UX’s).
  [[8a7226ad7]](https://git.sudo.ws/sudo/commit/?id=8a7226ad7)

2000-03-02 Todd C. Miller

* INSTALL, RUNSON:

  Mention that gcc on dynix may have problems
  [[02cbda999]](https://git.sudo.ws/sudo/commit/?id=02cbda999)

2000-02-29 Todd C. Miller

* Makefile.in:

  Link visudo with NET\_LIBS since we now call syslog via defaults.c
  [[39e191bca]](https://git.sudo.ws/sudo/commit/?id=39e191bca)

* defaults.c:

  Use Argv[0] as the first arg to openlog() since visudo uses this too.
  [[f8b1e595a]](https://git.sudo.ws/sudo/commit/?id=f8b1e595a)

2000-02-28 Todd C. Miller

* sudo.c:

  Stash coredumpsize resource limit and retsore it before the exec()
  Otherwise the child ends up with a coredumpsize of 0.
  [[24f8ee880]](https://git.sudo.ws/sudo/commit/?id=24f8ee880)

2000-02-27 Todd C. Miller

* sudo.cat, sudo.man, sudo.pod:

  document -S flag
  [[f7fa52054]](https://git.sudo.ws/sudo/commit/?id=f7fa52054)

* sudo.c:

  fix usage string
  [[f1c2ba6aa]](https://git.sudo.ws/sudo/commit/?id=f1c2ba6aa)

* CHANGES, RUNSON, TODO, auth/aix\_auth.c, auth/fwtk.c, auth/pam.c,
  auth/sudo\_auth.c, sudo.c, sudo.h, tgetpass.c:

  Added -S flag (read passwd from stdin) and tgetpass\_flags global that
  holds flags to be passed in to tgetpass(). Change echo\_off param to
  tgetpass() into a flags field. There are currently 2 possible flags for
  tgetpass(): TGP\_ECHO and TGP\_STDIN. In tgetpass(), abstract the echo
  set/clear via macros and if (flags & TGP\_ECHO) but echo is not set on
  the terminal, but sure to set it.
  [[54fbe0854]](https://git.sudo.ws/sudo/commit/?id=54fbe0854)

* tgetpass.c:

  Fixed a bug that caused an infinite loop when the password timeout was
  disabled.
  [[de44c711b]](https://git.sudo.ws/sudo/commit/?id=de44c711b)

2000-02-18 Todd C. Miller

* CHANGES, defaults.c, defaults.h, getspwuid.c, sudo.c, sudo.h,
  sudoers.cat, sudoers.man, sudoers.pod, visudo.c:

  Add rootpw, runaspw, and targetpw options.
  [[09b23e7b4]](https://git.sudo.ws/sudo/commit/?id=09b23e7b4)

* CHANGES, defaults.c, sudoers.cat, sudoers.man, sudoers.pod, visudo.c:

  enveditor -> env\_editor
  [[44c5092fa]](https://git.sudo.ws/sudo/commit/?id=44c5092fa)

2000-02-16 Todd C. Miller

* BUGS, INSTALL, Makefile.in, README, configure, configure.in, sudo.cat,
  sudo.man, sudoers.cat, sudoers.man, version.h, visudo.cat, visudo.man:

  crank versino to 1.6.3
  [[73946622b]](https://git.sudo.ws/sudo/commit/?id=73946622b)

* INSTALL, TODO, defaults.c, defaults.h, sudoers.cat, sudoers.man,
  sudoers.pod, visudo.c:

  Add ’editor’ and ’enveditor’ sudoers defaults and make visudo honor
  them. This means that visudo will now parse the sudoers file *before* it
  is edited so a bogus sudoers file will cause a warning to go to stderr.
  Also, visudo checks the variables once–it does not check them after
  each editor run since that could be confusing.
  [[020125336]](https://git.sudo.ws/sudo/commit/?id=020125336)

2000-02-15 Todd C. Miller

* RUNSON:

  1.6.2 -> 1.6.2p1
  [[43050cc49]](https://git.sudo.ws/sudo/commit/?id=43050cc49)

* check.c, sudo.c, sudo.h:

  Move user\_is\_exempt prototype into sudo.h
  [[fc08d7004]](https://git.sudo.ws/sudo/commit/?id=fc08d7004)

2000-02-13 Todd C. Miller

* configure, configure.in:

  Fix thinko, some && should have been || in the last commit
  [[82b60ddc2]](https://git.sudo.ws/sudo/commit/?id=82b60ddc2)

* configure, configure.in:

  Don’t initialized Makefile variables to be NULL since the user may want
  to import variables from their environment.
  [[26b93e27f]](https://git.sudo.ws/sudo/commit/?id=26b93e27f)

2000-02-04 Todd C. Miller

* configure, configure.in:

  typo
  [[36a249399]](https://git.sudo.ws/sudo/commit/?id=36a249399)

2000-01-28 Todd C. Miller

* sudo.tab.c:

  fix a yacc (skeleton.c) warning
  [[30c5e442f]](https://git.sudo.ws/sudo/commit/?id=30c5e442f)

2000-01-27 Todd C. Miller

* INSTALL, RUNSON, configure, configure.in:

  Make pam work on HP-UX 11.0;jaearick@…
  [[a4f529eae]](https://git.sudo.ws/sudo/commit/?id=a4f529eae)

* CHANGES:

  recent changes; prepare for 1.6.2p1
  [[364a4bef7]](https://git.sudo.ws/sudo/commit/?id=364a4bef7)

* find\_path.c:

  Don’t apply SECURE\_PATH if user is example; jmknoble@…
  [[bffb27280]](https://git.sudo.ws/sudo/commit/?id=bffb27280)

2000-01-26 Todd C. Miller

* sudo.tab.c:

  Regen with yacc that has a memory leak plugged.
  [[9abb89750]](https://git.sudo.ws/sudo/commit/?id=9abb89750)

* sudoers.cat, sudoers.man, sudoers.pod:

  Expanded docs on sudoers ‘defaults’ options based on INSTALL file info.
  [[192d33832]](https://git.sudo.ws/sudo/commit/?id=192d33832)

* INSTALL:

  Fix some while lies
  [[1db208b99]](https://git.sudo.ws/sudo/commit/?id=1db208b99)

2000-01-24 Todd C. Miller

* Makefile.in:

  When making a bindist, link FAQ to TROUBLESHOOTING instead of copying.
  [[5d05fbe95]](https://git.sudo.ws/sudo/commit/?id=5d05fbe95)

* sudoers.cat, sudoers.man, sudoers.pod:

  Add netgroup caveat
  [[592bae1d7]](https://git.sudo.ws/sudo/commit/?id=592bae1d7)

* RUNSON:

  Last minute updates
  [[aa79e11f8]](https://git.sudo.ws/sudo/commit/?id=aa79e11f8)

* TROUBLESHOOTING:

  PAM entry
  [[2386a3f61]](https://git.sudo.ws/sudo/commit/?id=2386a3f61)

* auth/pam.c:

  correct a comment
  [[0ced99391]](https://git.sudo.ws/sudo/commit/?id=0ced99391)

* CHANGES, RUNSON:

  update for 1.6.2
  [[af9bee905]](https://git.sudo.ws/sudo/commit/?id=af9bee905)

* auth/pam.c:

  Better detection of PAM errors and fix custom prompts with PAM. Based on
  patches from “Cloyce D. Spradling” <cloyce@…>
  [[15a1669d5]](https://git.sudo.ws/sudo/commit/?id=15a1669d5)

2000-01-20 Todd C. Miller

* snprintf.c:

  Cast ULONG\_MAX to unsigned long long when comparing to an unsigned long
  long value.
  [[6e5f1c729]](https://git.sudo.ws/sudo/commit/?id=6e5f1c729)

2000-01-19 Todd C. Miller

* CHANGES, config.h.in, configure, configure.in, visudo.c:

  Fix sudoers locking in visudo. We now lock the sudoers file itself, not
  the temp file (since locking the temp file can foul up editors). The
  previous locking scheme didn’t work because the fd was closed too early.
  [[d9790399b]](https://git.sudo.ws/sudo/commit/?id=d9790399b)

* config.h.in, configure, configure.in:

  Don’t need test for ftruncate() any more.
  [[90371b1c0]](https://git.sudo.ws/sudo/commit/?id=90371b1c0)

* configure, configure.in:

  Add a test for the -Aa flag w/ HP-UX’s cc. Fixes compilation with the
  unbundled HP-UX cc.
  [[f63b8d321]](https://git.sudo.ws/sudo/commit/?id=f63b8d321)

2000-01-18 Todd C. Miller

* sudoers.cat, sudoers.man, sudoers.pod:

  “a a” -> “a”; Aaron Campbell <aaron@cs.dal.ca>
  [[e4f3853d7]](https://git.sudo.ws/sudo/commit/?id=e4f3853d7)

2000-01-17 Todd C. Miller

* LICENSE, Makefile.in, defaults.c, defaults.h, parse.c, parse.h,
  parse.yacc, sudo.c, sudo.h, sudoers.pod, testsudoers.c, tgetpass.c,
  version.h, visudo.c:

  update copyright year on changed files
  [[9e0bae9fc]](https://git.sudo.ws/sudo/commit/?id=9e0bae9fc)

* RUNSON:

  updates
  [[d26184f30]](https://git.sudo.ws/sudo/commit/?id=d26184f30)

* CHANGES:

  aix fix
  [[20e44882b]](https://git.sudo.ws/sudo/commit/?id=20e44882b)

* INSTALL:

  Crank version to 1.6.2
  [[0ab8ad3c6]](https://git.sudo.ws/sudo/commit/?id=0ab8ad3c6)

* configure:

  Crank version to 1.6.2
  [[5d24e69ba]](https://git.sudo.ws/sudo/commit/?id=5d24e69ba)

* sudo.c:

  When using rlimit check for RLIM\_INFINITY When computing the value of
  maxfd, use min(getdtablesize(), RLIMIT\_NOFILE)
  [[217cae528]](https://git.sudo.ws/sudo/commit/?id=217cae528)

* CHANGES:

  recent changes
  [[903bd6eca]](https://git.sudo.ws/sudo/commit/?id=903bd6eca)

* BUGS, Makefile.in, README, configure.in, sudo.cat, sudo.man,
  sudoers.cat, sudoers.man, version.h, visudo.cat, visudo.man:

  Crank version to 1.6.2
  [[6d6c22b4b]](https://git.sudo.ws/sudo/commit/?id=6d6c22b4b)

* INSTALL, defaults.c, defaults.h, sudo.c, sudo.h, sudoers.pod:

  Add ‘shell\_noargs’ runtime option back in. We have to defer checking
  until after the sudoers file has been parsed but since there are now
  other options that operate that way this one can too. Based on a patch
  from bguillory@….
  [[ccb808da3]](https://git.sudo.ws/sudo/commit/?id=ccb808da3)

* defaults.c, defaults.h, parse.c, sudo.c, sudo.h:

  Add “listpw” and “verifypw” options.
  [[f68cc2f62]](https://git.sudo.ws/sudo/commit/?id=f68cc2f62)

* sudoers.cat, sudoers.man, sudoers.pod:

  o Fix some typos/omissions o Add section on verifypw and listpw o Define
  how NOPASSWD interacts with the -v and -l flags
  [[a597c4ad5]](https://git.sudo.ws/sudo/commit/?id=a597c4ad5)

2000-01-14 Todd C. Miller

* configure, configure.in:

  For HP-UX cc, add -Aa to CPPFLAGS. For HP-UX always add -D\_HPUX\_SOURCE
  to CPPFLAGS.
  [[26f5aa6f2]](https://git.sudo.ws/sudo/commit/?id=26f5aa6f2)

* defaults.c, defaults.h:

  In struct sudo\_defs\_types, move the union to the end and don’t
  initialize the union member since that only works with an ANSI compiler.
  We set the value of the union by hand in init\_defaults() anyway. This
  allows sudo to compile on a K&R compiler again.
  [[b1a9b1e67]](https://git.sudo.ws/sudo/commit/?id=b1a9b1e67)

2000-01-11 Todd C. Miller

* parse.c, parse.h, parse.yacc, sudo.tab.c, testsudoers.c, visudo.c:

  netgr\_matches needs to check shost as well as host since they may be
  different.
  [[0b59a0974]](https://git.sudo.ws/sudo/commit/?id=0b59a0974)

* tgetpass.c:

  End on \r as well as \n
  [[58fb4fc86]](https://git.sudo.ws/sudo/commit/?id=58fb4fc86)

2000-01-03 Todd C. Miller

* sudo.c:

  Update statbuf.st\_mode based on SUDOERS\_MODE when we are chaning from
  0400 to whatever SUDOERS\_MODE is (converting from the old sudoers mode).
  Assumes that SUDOERS\_MODE is less restrictive than 0400 which should
  always be the case.
  [[038dea2d3]](https://git.sudo.ws/sudo/commit/?id=038dea2d3)

* parse.c, parse.yacc, sudo.c, sudo.h, sudo.tab.c:

  Make treatment of -l and -v sane wrt NOPASSWD flags. Now allow -l w/o a
  passwd if there is *any* entry for the user on the host with a NOPASSWD
  flag. For -v, only allow w/o a passwd if *all* entries for the user on
  the host w/ the specified runas user have the NOPASSWD flag set.
  [[625e3e46d]](https://git.sudo.ws/sudo/commit/?id=625e3e46d)

* Makefile.in:

  add check target
  [[df297922c]](https://git.sudo.ws/sudo/commit/?id=df297922c)

1999-12-16 Todd C. Miller

* visudo.c:

  Treat EOF at whatnow prompt like ‘x’ instead of looping.
  [[a720dfa30]](https://git.sudo.ws/sudo/commit/?id=a720dfa30)

1999-12-10 Todd C. Miller

* CHANGES:

  recent changes
  [[7db5ff9f5]](https://git.sudo.ws/sudo/commit/?id=7db5ff9f5)

1999-12-09 Todd C. Miller

* config.h.in, configure, configure.in, sudo.c:

  Add check for initgroups() since old SYSV lacks this.
  [[ac67ced55]](https://git.sudo.ws/sudo/commit/?id=ac67ced55)

* CHANGES, RUNSON, aclocal.m4, config.h.in, configure, configure.in,
  parse.c, testsudoers.c:

  o Kill HAVE\_FNMATCH\_H o Only define HAVE\_FNMATCH if <fnmatch.h>
  exists.
  [[957fa7941]](https://git.sudo.ws/sudo/commit/?id=957fa7941)

1999-12-06 Todd C. Miller

* auth/sudo\_auth.c:

  Don’t allow insults to be enabled if the insults[] array is empty.
  Otherwise there would be division by zero.
  [[8446da40f]](https://git.sudo.ws/sudo/commit/?id=8446da40f)

* insults.h:

  Don’t allow insults to be enabled if the insults[] array is empty.
  Otherwise there would be division by zero.
  [[423f6d5ab]](https://git.sudo.ws/sudo/commit/?id=423f6d5ab)

* CHANGES, RUNSON:

  Don’t allow insults to be enabled if the insults[] array is empty.
  Otherwise there would be division by zero.
  [[baf50ee07]](https://git.sudo.ws/sudo/commit/?id=baf50ee07)

* insults.h:

  Don’t care about USE\_INSULTS #define since the insult stuff may be
  overridden at runtime.
  [[06f517bac]](https://git.sudo.ws/sudo/commit/?id=06f517bac)

* auth/sudo\_auth.c:

  Honor insults flag.
  [[c85a0b9bc]](https://git.sudo.ws/sudo/commit/?id=c85a0b9bc)

* CHANGES, parse.c:

  Don’t ask the user for a password if the user is not allowed to run the
  command and the authenticate flag (in sudoers) is false.
  [[b937889e8]](https://git.sudo.ws/sudo/commit/?id=b937889e8)

* CHANGES, RUNSON, lex.yy.c, parse.lex:

  o Whenever we get a bare newline we change to the INITIAL state. o Enter
  GOTRUNAS when we see Runas\_Alias

  This allows #uid to work in a RunasAlias.
  [[2eb988233]](https://git.sudo.ws/sudo/commit/?id=2eb988233)

1999-12-05 Todd C. Miller

* CHANGES, parse.yacc, sudo.tab.c:

  fix parsing of runas lists: o oprunasuser and runaslist now return a
  value o in a runasspec, if a runaslist does not return TRUE, set
  runas\_matches to FALSE. Normally, a runaslist only returns FALSE for
  explicitly denied users. o since runaslist does not modify the stack
  there is no need for a push/pop in runasalias.
  [[34d793254]](https://git.sudo.ws/sudo/commit/?id=34d793254)

* check.c, sudo.c:

  Don’t kill the user’s tickets until after sudoers has been parsed since
  tty\_tickets and ticket\_dir could be set in sudoers.
  [[12f521609]](https://git.sudo.ws/sudo/commit/?id=12f521609)

* BUGS, CHANGES, Makefile.binary, Makefile.in, README, RUNSON, configure,
  configure.in, sudo.cat, sudo.man, sudoers.cat, sudoers.man, tgetpass.c,
  version.h, visudo.cat, visudo.man:

  crank version to 1.6
  [[c6136f976]](https://git.sudo.ws/sudo/commit/?id=c6136f976)

* testsudoers.c:

  add set\_fqdn() stub
  [[a183816d2]](https://git.sudo.ws/sudo/commit/?id=a183816d2)

1999-12-02 Todd C. Miller

* INSTALL, defaults.c, defaults.h, sudo.c, sudo.h, sudoers.cat,
  sudoers.man, sudoers.pod, visudo.c:

  o Kill shell\_noargs option, it cannot work since the command needs to be
  set before sudoers is parsed. o Fix the “set\_home” sudoers option (only
  worked at compile time). o Fix “fqdn” sudoers option. We now set
  host/shost via set\_fqdn which gets called when the “fqdn” option is set
  in sudoers. o Move the openlog() to store\_syslogfac() so this gets
  overridden correctly from the sudoers file.
  [[449f67f77]](https://git.sudo.ws/sudo/commit/?id=449f67f77)

* auth/securid.c:

  SecurID support should compile now.
  [[a6a2b564d]](https://git.sudo.ws/sudo/commit/?id=a6a2b564d)

1999-11-29 Todd C. Miller

* sudo.cat, sudo.man, sudo.pod, sudoers.cat, sudoers.man, visudo.cat,
  visudo.man, visudo.pod:

  fix some syntactic goofs
  [[df7c6e0bf]](https://git.sudo.ws/sudo/commit/?id=df7c6e0bf)

1999-11-28 Todd C. Miller

* Makefile.in, sudo.html, sudoers.html, visudo.html:

  No longer need the .html files as they are generated automatically on
  the web site.
  [[96ffd91ec]](https://git.sudo.ws/sudo/commit/?id=96ffd91ec)

* CHANGES, LICENSE:

  kill characters that made wml unhappy
  [[da14eb97d]](https://git.sudo.ws/sudo/commit/?id=da14eb97d)

* HISTORY:

  typo
  [[b47fea38a]](https://git.sudo.ws/sudo/commit/?id=b47fea38a)

1999-11-25 Todd C. Miller

* README:

  majordomo@… -> majordomo@…
  [[395e56a86]](https://git.sudo.ws/sudo/commit/?id=395e56a86)

* Makefile.in, configure:

  Wrap script execution w/ /bin/sh for the benefit of ctm
  [[22bb6197d]](https://git.sudo.ws/sudo/commit/?id=22bb6197d)

1999-11-24 Todd C. Miller

* sudo.c:

  Make the -s flag be exclusive too. Also reorder the flags in the
  exclusive usage message so they are alphabetical.
  [[6713b85dc]](https://git.sudo.ws/sudo/commit/?id=6713b85dc)

1999-11-23 Todd C. Miller

* auth/pam.c:

  make pam errors other than PAM\_PERM\_DENIED fatal
  [[1c5e61db4]](https://git.sudo.ws/sudo/commit/?id=1c5e61db4)

* auth/API:

  fix typo
  [[4fd3e643b]](https://git.sudo.ws/sudo/commit/?id=4fd3e643b)

* INSTALL:

  make it clear that /etc/pam.d/sudo is required on linux
  [[1fe397ae5]](https://git.sudo.ws/sudo/commit/?id=1fe397ae5)

* auth/pam.c:

  fix a warning on redhat and spew an error if pam\_authenticate() returns
  an error other than AUTH\_SUCCESS or PAM\_PERM\_DENIED
  [[dab213c3e]](https://git.sudo.ws/sudo/commit/?id=dab213c3e)

* sudo.cat, sudo.html, sudo.man, sudo.pod:

  Be very clear that the password required is the user’s not root’s
  [[1f0fa1814]](https://git.sudo.ws/sudo/commit/?id=1f0fa1814)

1999-11-20 Todd C. Miller

* Makefile.in:

  add sample.syslog.conf to DISTFILES and BINFILES
  [[c977b43ca]](https://git.sudo.ws/sudo/commit/?id=c977b43ca)

1999-11-19 Todd C. Miller

* RUNSON:

  updates from Brian Jackson + some formatting
  [[93cda3a23]](https://git.sudo.ws/sudo/commit/?id=93cda3a23)

1999-11-18 Todd C. Miller

* INSTALL.binary, Makefile.binary, README, RUNSON:

  o One RUNSon update o Changes for automating real binary releases
  [[c7dc5c099]](https://git.sudo.ws/sudo/commit/?id=c7dc5c099)

* Makefile.in:

  Add bindist target
  [[5e742c68d]](https://git.sudo.ws/sudo/commit/?id=5e742c68d)

1999-11-16 Todd C. Miller

* TROUBLESHOOTING:

  talk about run-time options in addition to compile-time options
  [[ee9af2974]](https://git.sudo.ws/sudo/commit/?id=ee9af2974)

* CHANGES:

  fix typos
  [[3e6f6697c]](https://git.sudo.ws/sudo/commit/?id=3e6f6697c)

* sudo.c:

  need sys/time.h if HAVE\_SETRLIMIT
  [[1976aec18]](https://git.sudo.ws/sudo/commit/?id=1976aec18)

* PORTING, README, RUNSON, sudo.c, sudo.cat, sudo.html, sudo.man,
  sudo.pod, visudo.cat, visudo.html, visudo.man, visudo.pod:

  get rid of references to sudo-bugs. Now mention the web site or the
  sudo@ alias
  [[d00a8de2f]](https://git.sudo.ws/sudo/commit/?id=d00a8de2f)

* sudoers.html:

  repair pod2html damage
  [[3299d72a5]](https://git.sudo.ws/sudo/commit/?id=3299d72a5)

* RUNSON, TODO:

  Update for 1.6 release
  [[d6a034cf7]](https://git.sudo.ws/sudo/commit/?id=d6a034cf7)

* sudoers.cat, sudoers.html, sudoers.man, sudoers.pod:

  Add warning about using ALL in a command context.
  [[42f7c6f3f]](https://git.sudo.ws/sudo/commit/?id=42f7c6f3f)

1999-11-09 Todd C. Miller

* visudo.c:

  Call yyrestart() on a parse error to reset the lexer state.
  [[bbc51dac5]](https://git.sudo.ws/sudo/commit/?id=bbc51dac5)

* lex.yy.c, parse.lex:

  Don’t need YY\_FLUSH\_BUFFER after all Move yyrestart() into visudo.c
  since it might not get called in yywrap if we get a parse error (and we
  only reread the file on error anyway).
  [[818bbacb5]](https://git.sudo.ws/sudo/commit/?id=818bbacb5)

* lex.yy.c, parse.lex:

  Call YY\_FLUSH\_BUFFER macro in yywrap() to clean up any buffers that
  might still exist. Call yyrestart() instead of using the deprecated
  YY\_NEW\_FILE macro.
  [[95eb54d99]](https://git.sudo.ws/sudo/commit/?id=95eb54d99)

* lex.yy.c, parse.lex:

  flex doesn’t need %N table size declarations
  [[f03cac3b8]](https://git.sudo.ws/sudo/commit/?id=f03cac3b8)

* sudoers.cat, sudoers.html, sudoers.man, sudoers.pod:

  Mention what characters need to be escaped in names.
  [[afe809a31]](https://git.sudo.ws/sudo/commit/?id=afe809a31)

1999-11-08 Todd C. Miller

* configure:

  regen
  [[701c55c08]](https://git.sudo.ws/sudo/commit/?id=701c55c08)

* INSTALL:

  clarify Mac OS X entry
  [[a5b437605]](https://git.sudo.ws/sudo/commit/?id=a5b437605)

* RUNSON:

  update
  [[c02b05acd]](https://git.sudo.ws/sudo/commit/?id=c02b05acd)

* configure.in:

  o Use AC\_MSG\_ERROR throughout o Check syslog configure options for
  danity
  [[75ca0c512]](https://git.sudo.ws/sudo/commit/?id=75ca0c512)

1999-11-05 Todd C. Miller

* defaults.c:

  Fix printing of type T\_MODE in dump\_defaults()
  [[9e834851b]](https://git.sudo.ws/sudo/commit/?id=9e834851b)

* strcasecmp.c:

  missing sys/types.h
  [[d44b9e29f]](https://git.sudo.ws/sudo/commit/?id=d44b9e29f)

* INSTALL:

  Break out options that may be overridden at run time into their own
  section. Add a not about Max OS X and correct some lies.
  [[3781244a9]](https://git.sudo.ws/sudo/commit/?id=3781244a9)

1999-11-04 Todd C. Miller

* CHANGES, config.h.in, configure, configure.in, sudo.c:

  o Now use getrlimit to find the highest fd when closing all non-std fd’s
  o Turn off core dumps via setrlimit for the sake of paranoia
  [[59666aca7]](https://git.sudo.ws/sudo/commit/?id=59666aca7)

* RUNSON:

  updates
  [[aa41fbec5]](https://git.sudo.ws/sudo/commit/?id=aa41fbec5)

1999-11-01 Todd C. Miller

* CHANGES:

  updates
  [[1b467e802]](https://git.sudo.ws/sudo/commit/?id=1b467e802)

* tgetpass.c:

  When read()‘ing, do a single character at a time to be sure we don’t go
  oast the newline.
  [[68fd7e74c]](https://git.sudo.ws/sudo/commit/?id=68fd7e74c)

* sudo.c:

  For the sudo\_root option, check against user\_uid, not getuid() since at
  this point, ruid == euid == 0.
  [[e08f3f393]](https://git.sudo.ws/sudo/commit/?id=e08f3f393)

* RUNSON:

  some updates
  [[b20a6bb33]](https://git.sudo.ws/sudo/commit/?id=b20a6bb33)

* logging.h:

  Fix compilation problem when –with-logging=file was specified. This
  means that syslog is now required to build sudo but that should not be a
  problem. If it is it can be fixed trivially with a configure check for
  syslog() or syslog.h.
  [[a7cc50dab]](https://git.sudo.ws/sudo/commit/?id=a7cc50dab)

* tgetpass.c:

  Make this work again for things like “sudo echo hi | more” where the tty
  gets put into character at a time mode. We read until we read end of
  line or we run out of space (similar to fgets(3)).
  [[3f1581ae6]](https://git.sudo.ws/sudo/commit/?id=3f1581ae6)

1999-10-20 Todd C. Miller

* sudoers.cat, sudoers.html, sudoers.man, sudoers.pod:

  change ital to bold
  [[d0026e7d8]](https://git.sudo.ws/sudo/commit/?id=d0026e7d8)

* RUNSON:

  update
  [[76a97eb99]](https://git.sudo.ws/sudo/commit/?id=76a97eb99)

1999-10-16 Todd C. Miller

* defaults.c:

  Error out if syslog parameters are given without a value. For Ultrix or
  4.2BSD “syslog” is allowed without a value since there are no facilities
  in the 4.2BSD syslog.
  [[be02f53ea]](https://git.sudo.ws/sudo/commit/?id=be02f53ea)

1999-10-15 Todd C. Miller

* defaults.c:

  Ignore the syslog facility for systems w/ old syslog like Ultrix.
  [[041188d02]](https://git.sudo.ws/sudo/commit/?id=041188d02)

* TROUBLESHOOTING:

  people with “.” early in their path can have problems running sudo from
  the build dir ;-)
  [[1cf9d84fb]](https://git.sudo.ws/sudo/commit/?id=1cf9d84fb)

1999-10-13 Todd C. Miller

* sudo.cat, sudo.html, sudo.man, sudo.pod:

  Remove -r realm option
  [[ea90bc54b]](https://git.sudo.ws/sudo/commit/?id=ea90bc54b)

* auth/kerb5.c, auth/sudo\_auth.c, auth/sudo\_auth.h, configure,
  configure.in, sudo.c:

  New krb5 code from Frank Cusack <fcusack@iconnet.net>.
  [[3acdd5b02]](https://git.sudo.ws/sudo/commit/?id=3acdd5b02)

* CHANGES:

  update to reality
  [[e0a83ab41]](https://git.sudo.ws/sudo/commit/?id=e0a83ab41)

1999-10-12 Todd C. Miller

* auth/fwtk.c:

  include <auth.h> to get function prototypes.
  [[b8d230f46]](https://git.sudo.ws/sudo/commit/?id=b8d230f46)

* sudo.cat, sudo.html, sudo.man, sudo.pod:

  document -L flag
  [[421aca163]](https://git.sudo.ws/sudo/commit/?id=421aca163)

1999-10-11 Todd C. Miller

* sudo.c:

  in set\_perms(), always call setuid(0) before changing the ruid/euid so
  we always know it will succeed.
  [[7f5c24893]](https://git.sudo.ws/sudo/commit/?id=7f5c24893)

* defaults.h:

  #undef T\_FOO to avoid conflicts with system defines (like on ULTRIX).
  [[bd99c3545]](https://git.sudo.ws/sudo/commit/?id=bd99c3545)

* TODO, sample.sudoers, sudoers.cat, sudoers.html, sudoers.man,
  sudoers.pod:

  Docuement “Defaults” lines in /etc/sudoers. Still needs some fleshing
  out but this is a start.
  [[8a33fc598]](https://git.sudo.ws/sudo/commit/?id=8a33fc598)

1999-10-10 Todd C. Miller

* :

  use strtol, not strtoul since not everyone has not strtoul
  [[278f6c85a]](https://git.sudo.ws/sudo/commit/?id=278f6c85a)

* defaults.c:

  use strtol, not strtoul since not everyone has not strtoul
  [[d34020aef]](https://git.sudo.ws/sudo/commit/?id=d34020aef)

* lex.yy.c, parse.lex:

  last {WORD} rule should only apply in the INITIAL state
  [[315335247]](https://git.sudo.ws/sudo/commit/?id=315335247)

* lex.yy.c, parse.lex:

  o Add support for escaped characters in the WORD macro o Modify fill()
  to squash escape chars
  [[f963da316]](https://git.sudo.ws/sudo/commit/?id=f963da316)

* defaults.c, defaults.h:

  o Add T\_PATH flag to allow simple sanity checks for default values that
  are supposed to be pathnames. o Fix a duplicate free when visudo finds
  an error.
  [[deb02f9b3]](https://git.sudo.ws/sudo/commit/?id=deb02f9b3)

1999-10-09 Todd C. Miller

* defaults.c, defaults.h, logging.c:

  mail\_if\_foo -> mail\_foo
  [[deab20a57]](https://git.sudo.ws/sudo/commit/?id=deab20a57)

1999-10-08 Todd C. Miller

* compat.h, defaults.c, defaults.h, sudo.c, tgetpass.c:

  o Add requiretty option o Move O\_NOCTTY to compat.h
  [[2c4fefde5]](https://git.sudo.ws/sudo/commit/?id=2c4fefde5)

* logging.c:

  The exit() in log\_error() was mistakenly removed in a previous version.
  Put it back…
  [[1296f2884]](https://git.sudo.ws/sudo/commit/?id=1296f2884)

1999-10-07 Todd C. Miller

* INSTALL, TODO, auth/aix\_auth.c, auth/fwtk.c, auth/pam.c, auth/rfc1938.c,
  auth/sia.c, auth/sudo\_auth.c, check.c, config.h.in, configure,
  configure.in, defaults.c, defaults.h, find\_path.c, getspwuid.c,
  logging.c, parse.yacc, sudo.c, sudo.tab.c:

  o Change defaults stuff to put the value right in the struct. o
  Implement mailer\_flags o Store syslog stuff both in int and string form.
  Setting the string form magically updates the int version. o Add boolean
  attribute to strings where it makes sense to say !foo
  [[7769bf6a3]](https://git.sudo.ws/sudo/commit/?id=7769bf6a3)

* tgetpass.c:

  add O\_NOCTTY when opening /dev/tty just in case
  [[cc82693f5]](https://git.sudo.ws/sudo/commit/?id=cc82693f5)

1999-10-06 Todd C. Miller

* auth/API:

  cleanup function no longer takes a status arg
  [[c832accc1]](https://git.sudo.ws/sudo/commit/?id=c832accc1)

* INSTALL:

  the the
  [[97fc9e232]](https://git.sudo.ws/sudo/commit/?id=97fc9e232)

1999-09-15 Todd C. Miller

* TODO, config.h.in, configure, configure.in, logging.c:

  Use strftime() instead of ctime() if it is available.
  [[f7e23611b]](https://git.sudo.ws/sudo/commit/?id=f7e23611b)

1999-09-14 Todd C. Miller

* defaults.c:

  fix copyright date
  [[7b5e21697]](https://git.sudo.ws/sudo/commit/?id=7b5e21697)

* RUNSON:

  update ReliantUNIX entry
  [[0da16dc26]](https://git.sudo.ws/sudo/commit/?id=0da16dc26)

* defaults.c, defaults.h, logging.c:

  add log\_year option
  [[80ac47fb0]](https://git.sudo.ws/sudo/commit/?id=80ac47fb0)

* configure, configure.in:

  add –without-sendmail to help output
  [[c1f71dcd8]](https://git.sudo.ws/sudo/commit/?id=c1f71dcd8)

* configure, configure.in:

  enforce an otctal arg for –with-suoders-mode
  [[bb635cab4]](https://git.sudo.ws/sudo/commit/?id=bb635cab4)

1999-09-08 Todd C. Miller

* BUGS, INSTALL, Makefile.in, TODO, aclocal.m4, auth/aix\_auth.c,
  auth/fwtk.c, auth/kerb5.c, auth/pam.c, auth/rfc1938.c, auth/sia.c,
  auth/sudo\_auth.c, check.c, config.h.in, configure, configure.in,
  defaults.c, defaults.h, find\_path.c, lex.yy.c, logging.c, parse.h,
  parse.lex, parse.yacc, sudo.c, sudo.h, sudo.tab.c, sudo.tab.h,
  testsudoers.c, version.c, visudo.c:

  Add support for “Defaults” line in sudoers to make configuration
  variables changable at runtime (and on a global, per-host and per-user
  basis). Both the names and the internal representation are still subject
  to change. It was necessary to make sudo\_user.runas but a char \*\*
  instead of a char \* since this value can be changed by a Defaults line.
  There is a similar (but more complicated) issue with sudo\_user.prompt
  but it is handled differently at the moment.

  Add a “-L” flag to list the name of options with their descriptions.
  This may only be temporary.

  Move some prototypes to parse.h

  Be much less restrictive on what is allowed for a username.
  [[13bf42675]](https://git.sudo.ws/sudo/commit/?id=13bf42675)

* sample.syslog.conf:

  Add more info
  [[093fbe1e4]](https://git.sudo.ws/sudo/commit/?id=093fbe1e4)

1999-09-04 Todd C. Miller

* LICENSE, fnmatch.3, fnmatch.c, getcwd.c, lsearch.c, snprintf.c,
  strcasecmp.c:

  UCB has dropped the advertising clause from their license.
  [[4aa7852a4]](https://git.sudo.ws/sudo/commit/?id=4aa7852a4)

1999-08-31 Todd C. Miller

* auth/sudo\_auth.h:

  move dce\_verofy proto to correct section
  [[3197ab9de]](https://git.sudo.ws/sudo/commit/?id=3197ab9de)

* auth/dce.c:

  remove XXX
  [[5b8c2b07b]](https://git.sudo.ws/sudo/commit/?id=5b8c2b07b)

1999-08-28 Todd C. Miller

* emul/fnmatch.h:

  Add fnmatch() prototype
  [[f74a9f987]](https://git.sudo.ws/sudo/commit/?id=f74a9f987)

* fnmatch.c, parse.c, testsudoers.c:

  Move inclusion of emul/fnmatch.h to be after sudo.h for \_\_P
  [[a067249e1]](https://git.sudo.ws/sudo/commit/?id=a067249e1)

* sudo.h:

  add strcasecmp proto
  [[607e54b5e]](https://git.sudo.ws/sudo/commit/?id=607e54b5e)

* auth/sudo\_auth.c:

  add check for case where there are no auth methods
  [[ba31293c2]](https://git.sudo.ws/sudo/commit/?id=ba31293c2)

* configure, configure.in:

  Define \_XOPEN\_EXTENDED\_SOURCE on AIX and **USE\_FIXED\_PROTOTYPES** on
  SunOS4 w/ gcc
  [[92e5ebd9f]](https://git.sudo.ws/sudo/commit/?id=92e5ebd9f)

* getspwuid.c, lex.yy.c, parse.lex, parse.yacc, sudo.tab.c:

  include strings.h everywhere we include string.h
  [[3a8c0ca96]](https://git.sudo.ws/sudo/commit/?id=3a8c0ca96)

* version.c:

  nicer output when showing auth methods
  [[55e31d781]](https://git.sudo.ws/sudo/commit/?id=55e31d781)

* version.c:

  Add support for SEND\_MAIL\_WHEN\_NO\_HOST
  [[3de04bb48]](https://git.sudo.ws/sudo/commit/?id=3de04bb48)

* config.h.in, configure, configure.in:

  Add \_GNU\_SOURCE for Linux
  [[fda4a9709]](https://git.sudo.ws/sudo/commit/?id=fda4a9709)

* lex.yy.c, parse.lex:

  fix definition of OCTECT
  [[86c1328f6]](https://git.sudo.ws/sudo/commit/?id=86c1328f6)

* configure, configure.in:

  aix\_auth.o not authenticate.o
  [[df15b27a0]](https://git.sudo.ws/sudo/commit/?id=df15b27a0)

1999-08-27 Todd C. Miller

* sudo.c:

  Only block SIGINT, SIGQUIT, SIGTSTP (which can be generated from the
  keyboard). Since we run with ruid/euid == 0 the user can’t really signal
  us in nasty ways.
  [[61bd59c73]](https://git.sudo.ws/sudo/commit/?id=61bd59c73)

* visudo.c:

  Don’t need to worry about catching too many signals since we do locking
  on the tmp file. If a lockfile is really stale, it will be detected and
  overwritten.
  [[8fcdf8a30]](https://git.sudo.ws/sudo/commit/?id=8fcdf8a30)

* INSTALL, Makefile.in:

  include auth/API in tarball
  [[24f317e17]](https://git.sudo.ws/sudo/commit/?id=24f317e17)

* auth/sudo\_auth.c:

  move memset() of plaintext pw outside of verify loop and only do the
  memset if we are *not* in standalone mode.
  [[e026a2c24]](https://git.sudo.ws/sudo/commit/?id=e026a2c24)

* auth/sudo\_auth.c, auth/sudo\_auth.h:

  DCE is not a standalone method
  [[017a9a0ad]](https://git.sudo.ws/sudo/commit/?id=017a9a0ad)

* sudo.c:

  fix –enable-noargs-shell
  [[79faf00e5]](https://git.sudo.ws/sudo/commit/?id=79faf00e5)

* snprintf.c:

  “#ifdef **STDC**” not “#if **STDC**” (I missed one)
  [[54a43740e]](https://git.sudo.ws/sudo/commit/?id=54a43740e)

* auth/fwtk.c, auth/sia.c:

  \_cleanup() function returns an int.
  [[c5fc92121]](https://git.sudo.ws/sudo/commit/?id=c5fc92121)

* auth/dce.c:

  there were still some return(0)’s hanging around, make them AUTH\_FAILURE
  [[e061ce62f]](https://git.sudo.ws/sudo/commit/?id=e061ce62f)

* parse.c:

  typo in comment
  [[56f3bf61c]](https://git.sudo.ws/sudo/commit/?id=56f3bf61c)

* version.c:

  add missing semicolon
  [[cff5f9b39]](https://git.sudo.ws/sudo/commit/?id=cff5f9b39)

* auth/sudo\_auth.h:

  missing backslash
  [[b5dca2ab0]](https://git.sudo.ws/sudo/commit/?id=b5dca2ab0)

1999-08-26 Todd C. Miller

* CHANGES, config.h.in, configure, configure.in:

  Kill \_XOPEN\_EXTENDED\_SOURCE – causes problems on some OSes
  [[359b5be92]](https://git.sudo.ws/sudo/commit/?id=359b5be92)

* Makefile.in:

  add parse.h to HDRS
  [[2e4dcff8f]](https://git.sudo.ws/sudo/commit/?id=2e4dcff8f)

* Makefile.in, configure, configure.in:

  Kill VISUDO\_LIBS and VISUDO\_LDFLAGS. Add LIBS, NET\_LIBS, and LDFLAGS.
  Common libs go in LIBS, commong ld flags go in LDFLAGS and network libs
  like -lsocket, -lnsl go in NET\_LIBS. This allows testsudoers to build on
  Solaris and is a bit cleaner in general.
  [[3118b7f86]](https://git.sudo.ws/sudo/commit/?id=3118b7f86)

* UPGRADE:

  mention ptmp -> sudoers.tmp
  [[a80f9e0fb]](https://git.sudo.ws/sudo/commit/?id=a80f9e0fb)

* config.h.in, configure, configure.in:

  Define \_XOPEN\_SOURCE\_EXTENDED not \_XOPEN\_SOURCE
  [[ff95bb1d7]](https://git.sudo.ws/sudo/commit/?id=ff95bb1d7)

* RUNSON:

  add 2 reports
  [[82a59a898]](https://git.sudo.ws/sudo/commit/?id=82a59a898)

* auth/kerb5.c:

  Minor changes, mostly cosmetic. verify\_krb\_v5\_tgt() changed to return a
  value more like a system function
  [[17f02dfb1]](https://git.sudo.ws/sudo/commit/?id=17f02dfb1)

* auth/dce.c:

  Add an XXX
  [[39c448c71]](https://git.sudo.ws/sudo/commit/?id=39c448c71)

* TODO:

  more things todo!
  [[21e6a9d16]](https://git.sudo.ws/sudo/commit/?id=21e6a9d16)

* sample.sudoers:

  update based on what is in the man page
  [[05a861df1]](https://git.sudo.ws/sudo/commit/?id=05a861df1)

* parse.yacc, sudo.tab.c:

  minor change to first line printed in -l mode
  [[2b28160a5]](https://git.sudo.ws/sudo/commit/?id=2b28160a5)

* sudo.cat, sudo.html, sudo.man, sudo.pod:

  rename “ENVIRONMENT VARIABLES” section to “ENVIRONMENT” to be more
  standard and add “EXAMPLES” section
  [[e50798ff5]](https://git.sudo.ws/sudo/commit/?id=e50798ff5)

* visudo.cat, visudo.html, visudo.man, visudo.pod:

  rename “ENVIRONMENT VARIABLES” section to “ENVIRONMENT” to be more
  standard
  [[575c28def]](https://git.sudo.ws/sudo/commit/?id=575c28def)

* logging.c, parse.c, sudo.h:

  add FLAG\_NO\_CHECK
  [[a2b3e36e7]](https://git.sudo.ws/sudo/commit/?id=a2b3e36e7)

* lex.yy.c, parse.lex:

  make an OCTET really be limited to 0-255
  [[ca1b945b3]](https://git.sudo.ws/sudo/commit/?id=ca1b945b3)

* UPGRADE:

  mention timestamp changes
  [[e89b9ff18]](https://git.sudo.ws/sudo/commit/?id=e89b9ff18)

* PORTING:

  cosmetic cleanup
  [[5d5133d4c]](https://git.sudo.ws/sudo/commit/?id=5d5133d4c)

* sudoers.cat, sudoers.html, sudoers.man, sudoers.pod:

  new sudoers(8) man page
  [[7a84959b4]](https://git.sudo.ws/sudo/commit/?id=7a84959b4)

1999-08-24 Todd C. Miller

* version.c:

  Update comments about syslog name tables
  [[d661d1d66]](https://git.sudo.ws/sudo/commit/?id=d661d1d66)

* CHANGES, LICENSE, Makefile.in, configure, configure.in, parse.yacc,
  strcasecmp.c, sudo.tab.c:

  include strcasecmp() for those without it
  [[0d38bef9a]](https://git.sudo.ws/sudo/commit/?id=0d38bef9a)

* sample.sudoers:

  Use the : operator some more and fix a typo
  [[1a5da52c7]](https://git.sudo.ws/sudo/commit/?id=1a5da52c7)

* HISTORY:

  update the history of sudo
  [[f4f46ff02]](https://git.sudo.ws/sudo/commit/?id=f4f46ff02)

* parse.c, parse.lex, testsudoers.c:

  CIDR-style netmask support
  [[8723291d8]](https://git.sudo.ws/sudo/commit/?id=8723291d8)

* CHANGES:

  recent changes
  [[3781e9d41]](https://git.sudo.ws/sudo/commit/?id=3781e9d41)

* sudo.tab.c, sudo.tab.h:

  these should be generated with byacc, not bison
  [[25d75cea6]](https://git.sudo.ws/sudo/commit/?id=25d75cea6)

* lex.yy.c:

  regen
  [[7b0368f2f]](https://git.sudo.ws/sudo/commit/?id=7b0368f2f)

* parse.h, parse.yacc, sudo.tab.c, sudo.tab.h:

  In “sudo -l” mode, the type of the stored (expanded) alias was not
  stored with the contents. This could lead to incorrect output if the
  sudoers file had different alias types with the same name. Normal
  parsing (ie: not in ‘-l’ mode) is unaffected.
  [[51350b2c7]](https://git.sudo.ws/sudo/commit/?id=51350b2c7)

1999-08-23 Todd C. Miller

* configure, configure.in:

  define \_XOPEN\_SOURCE to get at crypt() proto on some systems
  [[ba358d6d5]](https://git.sudo.ws/sudo/commit/?id=ba358d6d5)

1999-08-22 Todd C. Miller

* snprintf.c:

  fix comment
  [[8b3c8d5c7]](https://git.sudo.ws/sudo/commit/?id=8b3c8d5c7)

* tgetpass.c:

  don’t need limits.h
  [[db4cac174]](https://git.sudo.ws/sudo/commit/?id=db4cac174)

* snprintf.c:

  kill bogus reference to vfprintf
  [[9d5008bf3]](https://git.sudo.ws/sudo/commit/?id=9d5008bf3)

* sample.sudoers, sudoers:

  better examples
  [[c58303644]](https://git.sudo.ws/sudo/commit/?id=c58303644)

* snprintf.c:

  Add some const in the K&R defs. This is safe since we define const away
  if the compiler doesn’t grok it.
  [[5922bfb58]](https://git.sudo.ws/sudo/commit/?id=5922bfb58)

* aclocal.m4, configure:

  Better test for working long long support. Ultrix compiler supports
  basic long long but not all operations on them.
  [[084b426b3]](https://git.sudo.ws/sudo/commit/?id=084b426b3)

* aclocal.m4, auth/secureware.c, config.h.in, configure, getspwuid.c,
  snprintf.c, sudo.c:

  Add check for LONG\_IS\_QUAD #undef MAXINT before including hpsecurity.h
  to silence an HP-UX warning Check for U?LONG\_LONG\_MAX in snprintf.c and
  use LONG\_IS\_QUAD
  [[b13e8006e]](https://git.sudo.ws/sudo/commit/?id=b13e8006e)

1999-08-21 Todd C. Miller

* LICENSE, aclocal.m4, config.h.in, configure, configure.in, snprintf.c:

  UCB-derived snprintf + asprintf support. Supports quads if the compiler
  does. No floating point yet, perhaps later…
  [[ab0c1eae1]](https://git.sudo.ws/sudo/commit/?id=ab0c1eae1)

1999-08-20 Todd C. Miller

* auth/API, auth/sudo\_auth.c, auth/sudo\_auth.h, check.c, find\_path.c,
  goodpath.c, logging.c, parse.c, sudo.c:

  Run most of the code as root, not the invoking user. It doesn’t really
  gain us anything to run as the user since an attacker can just have an
  setuid(0) in their egg. Running as root solves potential problems wrt
  signalling.
  [[275c2fc98]](https://git.sudo.ws/sudo/commit/?id=275c2fc98)

* sudo.tab.c:

  regen
  [[bc65b24ed]](https://git.sudo.ws/sudo/commit/?id=bc65b24ed)

1999-08-19 Todd C. Miller

* logging.c, sudo.c:

  Don’t wait for child to finish in log\_error(), let the signal handler
  get it if we are still running, else let init reap it for us. The extra
  time it takes to wait lets the user know that mail is being sent.

  Install SIGCHLD handler in main() and for POSIX signals, block
  everything *except* SIGCHLD.
  [[b9746389c]](https://git.sudo.ws/sudo/commit/?id=b9746389c)

* INSTALL, config.h.in, configure, configure.in, logging.c, parse.c,
  parse.yacc, sudo.c, sudo.h:

  sudoers\_lookup() now returns a bitmap instead of an int. This makes it
  possible to express things like “failed to validate because user not
  listed for this host”. Some thigns that were previously VALIDATE\_FOO are
  now FLAG\_FOO. This may change later on.

  Reorganized code in log\_auth() and sudo.c to deal with above changes.

  Safer versions of push/pushcp with in the do { … } while (0) style

  parse.yacc now saves info on the stack to allow parse.c to determine if
  a user was listed, but not for the host he/she tried to run on.

  Added –with-mail-if-no-host option
  [[0598093e2]](https://git.sudo.ws/sudo/commit/?id=0598093e2)

1999-08-17 Todd C. Miller

* parse.yacc, sudo.h, sudo.tab.c, visudo.c, visudo.cat, visudo.html,
  visudo.man, visudo.pod:

  o NewArgv and NewArgc don’t need to be externally visible. o If pedantic
  > 1, it is a parse error. o Add -s (strict) option to visudo which sets
  pedantic to 2.
  [[804e168d9]](https://git.sudo.ws/sudo/commit/?id=804e168d9)

* HISTORY, INSTALL:

  Just have sudo-bugs contact info in one place
  [[1afa5be40]](https://git.sudo.ws/sudo/commit/?id=1afa5be40)

* sudo.cat, sudo.html, sudo.man, sudo.pod:

  Add BUGS section
  [[b7a10e740]](https://git.sudo.ws/sudo/commit/?id=b7a10e740)

* Makefile.in, configure, configure.in:

  Add testsudoers to default build target if –with-devel Don’t clean
  generated parser files unless “distclean”.
  [[3ad8fe164]](https://git.sudo.ws/sudo/commit/?id=3ad8fe164)

* parse.yacc, sudo.tab.c:

  In pedantic mode we need to save *all* the aliases, not just those that
  match, or we get spurious warnings.
  [[b28ac86ab]](https://git.sudo.ws/sudo/commit/?id=b28ac86ab)

* TROUBLESHOOTING:

  reference samples.sylog.conf
  [[0acdc98f1]](https://git.sudo.ws/sudo/commit/?id=0acdc98f1)

1999-08-14 Todd C. Miller

* sample.syslog.conf:

  Sample entries for syslog.conf
  [[1451404ba]](https://git.sudo.ws/sudo/commit/?id=1451404ba)

* CHANGES:

  recent changes
  [[2e8eaae77]](https://git.sudo.ws/sudo/commit/?id=2e8eaae77)

* auth/API, auth/afs.c, auth/aix\_auth.c, auth/dce.c, auth/fwtk.c,
  auth/kerb4.c, auth/kerb5.c, auth/pam.c, auth/passwd.c, auth/rfc1938.c,
  auth/secureware.c, auth/securid.c, auth/sia.c, auth/sudo\_auth.c,
  auth/sudo\_auth.h:

  In struct sudo\_auth, turn need\_root and configured into flags and add a
  flag to specify an auth method is running alone (the only one). Pass
  auth methods their sudo\_auth pointer, not the data pointer. This allows
  us to get at the flags and tell if we are the only auth method. That, in
  turn, allows the method to be able to decide what should/should not be a
  fatal error. Currently only rfc1938 uses it this way, which allows us to
  kill the OTP\_ONLY define and te hackery that went with it. With access
  to the sudo\_auth struct, methods can also get at a string holding their
  cannonical name (useful in error messages).
  [[d40947c0b]](https://git.sudo.ws/sudo/commit/?id=d40947c0b)

* INSTALL, Makefile.in, README, config.h.in, configure, configure.in,
  getspwuid.c, lex.yy.c, parse.lex, parse.yacc, sudo.tab.c, sudo.tab.h:

  o –with-otp deprecated, use –without-passwd instead o real
  dependencies in the Makefile o –with-devel option to enable yacc, lex,
  and -Wall o style – “foo -> bar” becomes “foo->bar” o ALL goes back
  to being a token, not a string but don’t leak memory o rename hsotspec
  -> host in parse.yacc
  [[3a8b0be63]](https://git.sudo.ws/sudo/commit/?id=3a8b0be63)

1999-08-12 Todd C. Miller

* BUGS, CHANGES:

  recent changes
  [[c2d088ebe]](https://git.sudo.ws/sudo/commit/?id=c2d088ebe)

* auth/sudo\_auth.c, configure, configure.in, interfaces.c, snprintf.c,
  sudo.c, sudo.h:

  o Digital UNIX needs to check for \*snprintf() before -ldb is added to
  LIBS since -ldb includes a bogus snprintf(). o Add forward refs for
  struct mbuf and struct rtentry for Digital UNIX. o Reorder some
  functions in snprintf.c to fix -Wall o Add missing includes to fix more
  -Wall
  [[d7ebfe06d]](https://git.sudo.ws/sudo/commit/?id=d7ebfe06d)

* INSTALL, auth/sudo\_auth.c, check.c, config.h.in, configure,
  configure.in, parse.yacc, sudo.tab.c, testsudoers.c, version.c,
  visudo.c:

  o Add a “pedentic” flag to the parser. This makes sudo warn in cases
  where an alias may be used before it is defined. Only turned on for
  visudo and testsudoers. o Add –disable-authentication option that makes
  sudo not require authentication by default. The PASSWD tag can be used
  to require authentication for an entry. We no longer overload
  –without-passwd.
  [[2386dc1b4]](https://git.sudo.ws/sudo/commit/?id=2386dc1b4)

* lex.yy.c, parse.lex:

  Break ‘WORD’ regexp def into HOSTNAME and USERNAME. These days a
  username can contain just about anything so be very permissive. Also
  drop the unused . punctuation.
  [[f14dd25b0]](https://git.sudo.ws/sudo/commit/?id=f14dd25b0)

1999-08-09 Todd C. Miller

* parse.yacc, sudo.tab.c:

  o add a ‘val’ element to aliasinfo struct and move -> parse.h o
  find\_alias() now returns an aliasinfo \* instead of boolean o add\_alias()
  now takes a value parameter to store in the aliasinfo.val o The cmnd,
  hostspec, runasuser, and user rules now return: 1) positive match 0)
  negative match (due to ‘!’) -1) no match This means setting $$
  explicitly in all cases, which I should have done in the first place. It
  also means that we always store a value that is != -1 and when we see a
  ‘!’ we can set \*\_matches to !rv if rv != -1. The upshot of all of this
  is that ‘!’ now works the way it should in lists and some of the rules
  are more uniform and sensible.
  [[2ce523cd1]](https://git.sudo.ws/sudo/commit/?id=2ce523cd1)

* Makefile.in:

  add parse.h dependency
  [[518eec0ab]](https://git.sudo.ws/sudo/commit/?id=518eec0ab)

* parse.h:

  kill unused \*\_matched macros
  [[b18495e62]](https://git.sudo.ws/sudo/commit/?id=b18495e62)

* parse.yacc:

  Allow a list of users as the first thing in a user spec, not just a
  single entry. This makes things more uniform, though it does allow you
  to write user specs that are hard to read.
  [[76c801a68]](https://git.sudo.ws/sudo/commit/?id=76c801a68)

* sudo.tab.c:

  parse.yacc
  [[b4a7c5507]](https://git.sudo.ws/sudo/commit/?id=b4a7c5507)

* configure:

  regen
  [[d2dcea30c]](https://git.sudo.ws/sudo/commit/?id=d2dcea30c)

* configure.in:

  fix check for crypt() in libufc
  [[7bb2d52e9]](https://git.sudo.ws/sudo/commit/?id=7bb2d52e9)

1999-08-07 Todd C. Miller

* README:

  sudo-users list now exists
  [[609851d85]](https://git.sudo.ws/sudo/commit/?id=609851d85)

* INSTALL, PORTING, README, TODO, TROUBLESHOOTING:

  Update to reality.
  [[be4e87f66]](https://git.sudo.ws/sudo/commit/?id=be4e87f66)

* CHANGES, Makefile.in, TODO, TROUBLESHOOTING, check.c, compat.h,
  config.h.in, configure, configure.in, fileops.c, logging.c, sudo.h,
  version.c, visudo.c:

  o Move lock\_file() and touch() into fileops.c so visudo can use them o
  Visudo now locks the sudoers temp file instead of bailing when the temp
  file already exists. This fixes the problem of stale temp files but it
  does *require* that you not try to put the temp file in a world-writable
  directory. This shoud not be an issue as the temp file should live in
  the same dir as sudoers. o Visudo now only installs the temp file as
  sudoers if it changed.
  [[76148d531]](https://git.sudo.ws/sudo/commit/?id=76148d531)

1999-08-06 Todd C. Miller

* logging.c:

  add fcntl locking
  [[68a2b1678]](https://git.sudo.ws/sudo/commit/?id=68a2b1678)

* config.h.in, configure, configure.in, logging.c:

  Lock the log file.
  [[925f4eabc]](https://git.sudo.ws/sudo/commit/?id=925f4eabc)

* Makefile.in, TROUBLESHOOTING, parse.c, pathnames.h.in, sudo.c, visudo.c,
  visudo.cat, visudo.html, visudo.man, visudo.pod:

  o /etc/stmp -> /etc/sudoers.tmp since solaris uses stmp as shadow temp
  file o \_PATH\_SUDO\_SUDOERS -> \_PATH\_SUDOERS and \_PATH\_SUDO\_STMP ->
  \_PATH\_SUDOERS\_TMP
  [[145992dce]](https://git.sudo.ws/sudo/commit/?id=145992dce)

1999-08-05 Todd C. Miller

* INSTALL, check.c, config.h.in, configure, configure.in, version.c:

  o Kill \*\_MESSAGE and replace with NO\_LECTURE o Add more things to root
  sudo -V config reporting
  [[7c53b7496]](https://git.sudo.ws/sudo/commit/?id=7c53b7496)

* configure, configure.in:

  aix\_auth.o not authenticate.o
  [[61dc1ddf6]](https://git.sudo.ws/sudo/commit/?id=61dc1ddf6)

* config.h.in:

  Add –with-goodpri and –with-badpri configure options to specify the
  syslog priority to use.
  [[ae96a4f1a]](https://git.sudo.ws/sudo/commit/?id=ae96a4f1a)

* INSTALL, configure, configure.in, logging.h:

  Add –with-goodpri and –with-badpri configure options to specify the
  syslog priority to use.
  [[d47ddf6a9]](https://git.sudo.ws/sudo/commit/?id=d47ddf6a9)

* compat.h:

  kill crufty AIX stuff
  [[fdb5da47a]](https://git.sudo.ws/sudo/commit/?id=fdb5da47a)

* Makefile.in:

  Sigh, some versions of make (like Solaris’s) don’t deal with $< like I
  would expect. Both GNU and BSD makes get this right but… So, we just
  expand $< inline at the cost of some ugliness.
  [[93c236774]](https://git.sudo.ws/sudo/commit/?id=93c236774)

* version.c:

  If the invoking user is root, sudo will now print configure info in -V
  mode. Currently just prints logging info, to be expanded later.
  [[fd16d8e77]](https://git.sudo.ws/sudo/commit/?id=fd16d8e77)

* logging.c, logging.h, sudo.c, sudo.h:

  o new defines for syslog facility and priority o use new print\_version()
  functino for -V mode
  [[27d6f353e]](https://git.sudo.ws/sudo/commit/?id=27d6f353e)

* check.c:

  Don’t need version.c
  [[928352412]](https://git.sudo.ws/sudo/commit/?id=928352412)

* aclocal.m4, config.h.in, configure, configure.in:

  Add check for syslog facilities and priorities tables in syslog.h
  [[e966a6b3e]](https://git.sudo.ws/sudo/commit/?id=e966a6b3e)

* Makefile.in:

  o authenticate -> aix\_auth o add version.c
  [[a7acfdb68]](https://git.sudo.ws/sudo/commit/?id=a7acfdb68)

* auth/sudo\_auth.c:

  Missed a prompt -> user\_prompt conversion
  [[5e7246552]](https://git.sudo.ws/sudo/commit/?id=5e7246552)

1999-08-04 Todd C. Miller

* TODO:

  sudo should lock its logfile
  [[4aa1fb7fe]](https://git.sudo.ws/sudo/commit/?id=4aa1fb7fe)

* parse.yacc, sudo.tab.c:

  o Add ‘!’ correctly when expanding Aliases. o Add shortcut macros for
  append() to make things more readable. o The separator in append() is
  now a string instead of a char. o In append(), only prepend the
  separator if the last char is not a ‘!’. This is a hack but it greatly
  simplifies ‘!’ handling. o In -l mode, Runas lists and NOPASSWD/PASSWD
  tags are now inherited across entries in a list (matches current
  behavior). o Fix formatting in -l mode such that items in a list are
  separated by a space. Greatlt improves readability. o Space for name
  field in struct aliasinfo is now allocated dyanically instead of using a
  (big) buffer. o In add\_alias(), only search the list once (lsearch
  instead of lfind + lsearch)
  [[16ab37701]](https://git.sudo.ws/sudo/commit/?id=16ab37701)

* lex.yy.c, sudo.tab.c, sudo.tab.h:

  regen
  [[0d5a675f5]](https://git.sudo.ws/sudo/commit/?id=0d5a675f5)

* configure, configure.in:

  Solais pam doesn’t require anye xtra setup
  [[1a4ebcf2f]](https://git.sudo.ws/sudo/commit/?id=1a4ebcf2f)

* parse.yacc:

  o Simpler ‘!’ support now that the lexer deals with multiple !’s for us.
  o In the case of opFOO, have FOO give a boolean return value and set
  foo\_matches in opFOO, not FOO. o Treat ‘ALL’ as a string since it gets
  fill()’d in parse.lex–fixes a small memory leak. In the long run it may
  be better to just fix parse.lex and make ALL back into a token. However,
  having it be a string is useful since it can be easily passed back to
  the parent rule if we so desire.
  [[716e0b543]](https://git.sudo.ws/sudo/commit/?id=716e0b543)

* parse.lex:

  o Remove some unnecessary backslashes o collapse multiple !’s by using
  !+ and checking if yyleng is even or odd. this allows us to simplify !
  handling in parse.yacc
  [[d1a6fa810]](https://git.sudo.ws/sudo/commit/?id=d1a6fa810)

* sudo.c:

  -u flag was being ignored
  [[014bd2293]](https://git.sudo.ws/sudo/commit/?id=014bd2293)

1999-08-01 Todd C. Miller

* Makefile.in:

  correct fix
  [[3fc0ab768]](https://git.sudo.ws/sudo/commit/?id=3fc0ab768)

* Makefile.in:

  work around pod2man stupididy
  [[896c2748e]](https://git.sudo.ws/sudo/commit/?id=896c2748e)

* Makefile.in:

  correct dependencies for .cat
  [[3e8a6d496]](https://git.sudo.ws/sudo/commit/?id=3e8a6d496)

* sudo.cat, sudo.man, visudo.cat, visudo.man:

  regen
  [[762fb6a66]](https://git.sudo.ws/sudo/commit/?id=762fb6a66)

* sudo.pod, visudo.pod:

  Add copyright Update to reality
  [[29974bceb]](https://git.sudo.ws/sudo/commit/?id=29974bceb)

* parse.c, sudo.c, sudo.h:

  rename validate() to the more descriptive sudoers\_lookup()
  [[6b3909c78]](https://git.sudo.ws/sudo/commit/?id=6b3909c78)

* auth/aix\_auth.c:

  use tgetpass
  [[ef4302501]](https://git.sudo.ws/sudo/commit/?id=ef4302501)

1999-07-31 Todd C. Miller

* CHANGES:

  updates
  [[ff7b46866]](https://git.sudo.ws/sudo/commit/?id=ff7b46866)

* HISTORY, INSTALL, Makefile.in, README, RUNSON, TROUBLESHOOTING,
  configure, configure.in, sudo.c:

  Sudo, not CU Sudo
  [[5a51e05e6]](https://git.sudo.ws/sudo/commit/?id=5a51e05e6)

* LICENSE:

  add 4th term to license similar to term 5 in the apache license
  [[fa26399ae]](https://git.sudo.ws/sudo/commit/?id=fa26399ae)

* emul/search.h, emul/utime.h:

  add 4th term to license similar to term 5 in the apache license
  [[1a89248e4]](https://git.sudo.ws/sudo/commit/?id=1a89248e4)

* auth/afs.c, auth/aix\_auth.c, auth/dce.c, auth/fwtk.c, auth/kerb4.c,
  auth/kerb5.c, auth/pam.c, auth/passwd.c, auth/rfc1938.c,
  auth/secureware.c, auth/securid.c, auth/sia.c, auth/sudo\_auth.c,
  auth/sudo\_auth.h, insults.h, interfaces.c, interfaces.h, lex.yy.c,
  logging.c, logging.h, parse.c, parse.h, parse.lex, parse.yacc,
  pathnames.h.in, putenv.c, strerror.c, sudo.c, sudo.h, sudo.tab.c,
  sudo\_setenv.c, testsudoers.c, tgetpass.c, utime.c, version.h, visudo.c:

  add 4th term to license similar to term 5 in the apache license
  [[0d732401f]](https://git.sudo.ws/sudo/commit/?id=0d732401f)

* ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h:

  add 4th term to license similar to term 5 in the apache license
  [[40c228aa7]](https://git.sudo.ws/sudo/commit/?id=40c228aa7)

* Makefile.in, alloc.c, check.c, compat.h, config.h.in, find\_path.c,
  getspwuid.c, goodpath.c:

  add 4th term to license similar to term 5 in the apache license
  [[ca8eb6f2a]](https://git.sudo.ws/sudo/commit/?id=ca8eb6f2a)

* LICENSE, aclocal.m4, auth/rfc1938.c, check.c, configure.in, insults.h,
  logging.c, sudo.c, sudo.h:

  there was a 1995 release too
  [[794f537ee]](https://git.sudo.ws/sudo/commit/?id=794f537ee)

1999-07-28 Todd C. Miller

* CHANGES:

  updates
  [[46e856500]](https://git.sudo.ws/sudo/commit/?id=46e856500)

* check.c:

  Use dirs instead of files for timestamp. This allows tty and non-tty
  schemes to coexist reasonably. Note, however, that when you update a tty
  ticket, the mtime on the user dir gets updated as well.
  [[0804f1786]](https://git.sudo.ws/sudo/commit/?id=0804f1786)

* configure, configure.in:

  Fix getprpwnam() checking on SCO. Need to link with “-lprot -lx” when
  linking test program, not just -lprot. Also add check for getspnam().
  The SCO docs indicate that /etc/shadow can be used but this may be a
  lie.
  [[0368b9e61]](https://git.sudo.ws/sudo/commit/?id=0368b9e61)

1999-07-24 Todd C. Miller

* auth/API:

  first cut at auth API description
  [[234f718e4]](https://git.sudo.ws/sudo/commit/?id=234f718e4)

1999-07-22 Todd C. Miller

* auth/fwtk.c, auth/kerb4.c, auth/kerb5.c, auth/pam.c, auth/rfc1938.c,
  auth/secureware.c, auth/securid.c, auth/sudo\_auth.c, auth/sudo\_auth.h:

  auth API change. There is now an init method that gets run before the
  main loop. This allows auth routines to differentiate between
  initialization that happens once vs. setup that needs to run each time
  through the loop.
  [[a1e0a8180]](https://git.sudo.ws/sudo/commit/?id=a1e0a8180)

* auth/kerb5.c, logging.c:

  use easprintf() and evasprintf()
  [[8d72a57eb]](https://git.sudo.ws/sudo/commit/?id=8d72a57eb)

* alloc.c, sudo.h:

  add easprintf() and evasprintf(), error checking versions of asprintf()
  and vasprintf()
  [[fd410d4bc]](https://git.sudo.ws/sudo/commit/?id=fd410d4bc)

* TODO:

  remove 2 items. One done, one won’t do.
  [[c8962786f]](https://git.sudo.ws/sudo/commit/?id=c8962786f)

* lex.yy.c, sudo.tab.c:

  regen
  [[712675948]](https://git.sudo.ws/sudo/commit/?id=712675948)

* configure, sudo.cat, sudo.html, sudo.man, sudoers.html, visudo.cat,
  visudo.html, visudo.man:

  regen
  [[4c7239fd9]](https://git.sudo.ws/sudo/commit/?id=4c7239fd9)

* CHANGES:

  new changes
  [[2ffac7eb4]](https://git.sudo.ws/sudo/commit/?id=2ffac7eb4)

* sudo.pod:

  o Document -K flag and update meaning of -k flag. o BSD-style copyright
  o Document clearing of BIND resolver environment variables o Clarify bit
  about shared libs o suggest rc files create /tmp/.odus if your OS gives
  away files
  [[0e2cc2b7a]](https://git.sudo.ws/sudo/commit/?id=0e2cc2b7a)

* visudo.pod:

  BSD license
  [[3cbcd52f9]](https://git.sudo.ws/sudo/commit/?id=3cbcd52f9)

* version.h:

  BSD-style copyright
  [[6ccee0f5b]](https://git.sudo.ws/sudo/commit/?id=6ccee0f5b)

* tgetpass.c:

  o BSD copyright o no need to block signals, we now do that in main() o
  cosmetic changes
  [[dd312cee2]](https://git.sudo.ws/sudo/commit/?id=dd312cee2)

* testsudoers.c, visudo.c:

  o BSD-style copyright o Use “struct sudo\_user” instead of old globals. o
  some cometic cleanup
  [[4dc01cc91]](https://git.sudo.ws/sudo/commit/?id=4dc01cc91)

* sudo\_setenv.c:

  BSD-style copyright
  [[5fbc12d52]](https://git.sudo.ws/sudo/commit/?id=5fbc12d52)

* sudo.h:

  o BSD copyright o logging and parser bits moved to their own .h files o
  new “struct sudo\_user” to encapsulate many of the old globals.
  [[95179ddff]](https://git.sudo.ws/sudo/commit/?id=95179ddff)

* sudo.c:

  o no longer contains sudo 1.1/1.2 code o BSD copyright o use new logging
  routines o simplified flow of control o BIND resolver additions to
  badenv\_table
  [[7fe99a8ca]](https://git.sudo.ws/sudo/commit/?id=7fe99a8ca)

* strerror.c:

  BSD-style copyright
  [[c4079a538]](https://git.sudo.ws/sudo/commit/?id=c4079a538)

* snprintf.c:

  Now compiles on more K&R compilers
  [[bcc133c11]](https://git.sudo.ws/sudo/commit/?id=bcc133c11)

* putenv.c:

  BSD-style copyright, cosmetic changes
  [[ebc1acfff]](https://git.sudo.ws/sudo/commit/?id=ebc1acfff)

* pathnames.h.in:

  BSD-style copyright
  [[be40509eb]](https://git.sudo.ws/sudo/commit/?id=be40509eb)

* parse.c, parse.h, parse.lex, parse.yacc:

  BSD-style copyright. Move parser-specific defines and structs into
  parse.h + other cosmetic changes
  [[c7fd99aa5]](https://git.sudo.ws/sudo/commit/?id=c7fd99aa5)

* logging.h:

  defines for logging routines
  [[c665b6724]](https://git.sudo.ws/sudo/commit/?id=c665b6724)

* find\_path.c, getspwuid.c, goodpath.c, interfaces.c:

  BSD-style copyright, cosmetic changes
  [[692fe8cdb]](https://git.sudo.ws/sudo/commit/?id=692fe8cdb)

* ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h, insults.h,
  interfaces.h:

  BSD-style copyright
  [[cdd6ceff6]](https://git.sudo.ws/sudo/commit/?id=cdd6ceff6)

* configure.in:

  o tgetpass.c is no longer optional o kill DCE\_OBJS, add AUTH\_OBJS o kill
  –disable-tgetpass o add –without-passwd o changes to fill in AUTH\_OBJS
  for new auth api o check for strerror(), v?snprintf() and v?asprintf() o
  replace –with-AuthSRV with –with-fwtk
  [[379f68366]](https://git.sudo.ws/sudo/commit/?id=379f68366)

* config.h.in:

  BSD-style copyright. Remove USE\_GETPASS and HAVE\_UTIME\_NULL. Add
  HAVE\_FWTK, HAVE\_STRERROR, HAVE\_SNPRINTF, HAVE\_VSNPRINTF, HAVE\_ASPRINTF,
  HAVE\_VASPRINTF, WITHOUT\_PASSWD and NO\_PASSWD
  [[be18d643e]](https://git.sudo.ws/sudo/commit/?id=be18d643e)

* compat.h:

  BSD-style copyright; Add S\_IFLNK and MIN/MAX id they are missing.
  [[e4ea15963]](https://git.sudo.ws/sudo/commit/?id=e4ea15963)

* alloc.c:

  BSD-style copyright
  [[1403ace08]](https://git.sudo.ws/sudo/commit/?id=1403ace08)

* TROUBLESHOOTING:

  no more –with-getpass
  [[3d5c6fc25]](https://git.sudo.ws/sudo/commit/?id=3d5c6fc25)

* TODO:

  Take out things I’ve done…
  [[3bce72741]](https://git.sudo.ws/sudo/commit/?id=3bce72741)

* README:

  Refer to LICENSE
  [[6e31765b8]](https://git.sudo.ws/sudo/commit/?id=6e31765b8)

* PORTING:

  –with-getpass no longer exists
  [[27456c392]](https://git.sudo.ws/sudo/commit/?id=27456c392)

* Makefile.in:

  BSD-style copyright. Update to reflect reality wrt new files and new
  auth modules.
  [[e86bcddbe]](https://git.sudo.ws/sudo/commit/?id=e86bcddbe)

* INSTALL:

  Remove –with-AuthSRV and –disable-tgetpass. Add –with-fwtk and
  –without-passwd.
  [[106a909f3]](https://git.sudo.ws/sudo/commit/?id=106a909f3)

* HISTORY:

  Update history a bit
  [[1497cdb54]](https://git.sudo.ws/sudo/commit/?id=1497cdb54)

* COPYING, LICENSE:

  Now distributed under a BSD-style license
  [[40b43b7a2]](https://git.sudo.ws/sudo/commit/?id=40b43b7a2)

* auth/sudo\_auth.c:

  o BSD-style copyright o Add support for NO\_PASSWD/WITHOUT\_PASSWD
  options. o skey/opie replaced by rfc1938 code o new struct sudo\_user
  global
  [[c47edcb88]](https://git.sudo.ws/sudo/commit/?id=c47edcb88)

* auth/pam.c, auth/sia.c:

  BSD-style copyright and use new log functions
  [[53543b6b7]](https://git.sudo.ws/sudo/commit/?id=53543b6b7)

* auth/kerb5.c:

  o BSD-style copyright o Use new log functiongs o Use asprintf() and
  snprintf() where sensible.
  [[43499ea5e]](https://git.sudo.ws/sudo/commit/?id=43499ea5e)

* check.c:

  Rewrote all the old sudo 1.1/1.2 code. Timestamp handling is now done
  more reasonably–better sanity checks and tty-based stamps are now done
  as files in a directory with the same name as the invoking user, eg.
  /var/run/sudo/millert/ttyp1. It is not currently possible to mix tty and
  non-tty based ticket schemes but this may change in the future (it
  requires sudo to use a directory instead of a file in the non-tty case).
  Also, `sudo -k'' now sets the ticket back to the epoch and` sudo -K’’
  really deletes the file. That way you don’t get the lecture again just
  because you killed your ticket in .logout. BSD-style copyright now.
  [[ccc736937]](https://git.sudo.ws/sudo/commit/?id=ccc736937)

* logging.c:

  o rewritten logging routines. log\_error() now takes printf-style varargs
  and log\_auth() for the return value of validate(). o BSD-style copyright
  [[7e369e519]](https://git.sudo.ws/sudo/commit/?id=7e369e519)

* auth.c, check\_sia.c, dce\_pwent.c, secureware.c:

  superceded by new auth API
  [[d1bcdd049]](https://git.sudo.ws/sudo/commit/?id=d1bcdd049)

* auth/kerb4.c:

  BSD-style copyright
  [[55ced1ba2]](https://git.sudo.ws/sudo/commit/?id=55ced1ba2)

* auth/fwtk.c:

  Use snprintf() where it makes sense and add a BSD-style copyright
  [[5d0a0e44e]](https://git.sudo.ws/sudo/commit/?id=5d0a0e44e)

* auth/afs.c, auth/aix\_auth.c, auth/dce.c, auth/passwd.c, auth/rfc1938.c,
  auth/secureware.c, auth/securid.c, auth/sudo\_auth.h:

  BSD-style copyright
  [[f73c3fa0d]](https://git.sudo.ws/sudo/commit/?id=f73c3fa0d)

* emul/utime.h, utime.c:

  BSD-style copyright
  [[61f51d958]](https://git.sudo.ws/sudo/commit/?id=61f51d958)

* emul/search.h:

  this has been rewritten so use my BSD-style copyright
  [[f00f0b239]](https://git.sudo.ws/sudo/commit/?id=f00f0b239)

1999-07-15 Todd C. Miller

* snprintf.c:

  include malloc.h if no stdlib.h
  [[17f22b06c]](https://git.sudo.ws/sudo/commit/?id=17f22b06c)

* snprintf.c:

  KTH snprintf()/asprintf() for systems w/o them
  [[143a6195c]](https://git.sudo.ws/sudo/commit/?id=143a6195c)

* strerror.c:

  strerror() for systems w/o it
  [[f47def63f]](https://git.sudo.ws/sudo/commit/?id=f47def63f)

1999-07-12 Todd C. Miller

* visudo.c:

  stylistic changes
  [[b144c103f]](https://git.sudo.ws/sudo/commit/?id=b144c103f)

* parse.c, parse.lex, parse.yacc:

  Add contribution info in the main comment
  [[26be17a3d]](https://git.sudo.ws/sudo/commit/?id=26be17a3d)

1999-07-11 Todd C. Miller

* auth/pam.c:

  remove missed ref to PAM\_nullpw
  [[68ee11667]](https://git.sudo.ws/sudo/commit/?id=68ee11667)

* auth/sudo\_auth.h:

  pasto
  [[d0c6d7581]](https://git.sudo.ws/sudo/commit/?id=d0c6d7581)

* auth/kerb5.c:

  more or less complete now–still untested
  [[baadc4ede]](https://git.sudo.ws/sudo/commit/?id=baadc4ede)

* auth/afs.c, auth/pam.c:

  don’t use user\_name macro, it will go away
  [[61e798ffd]](https://git.sudo.ws/sudo/commit/?id=61e798ffd)

* auth/opie.c, auth/rfc1938.c, auth/sudo\_auth.h:

  combine skey/opie code into rfc1938.c
  [[2ad09786a]](https://git.sudo.ws/sudo/commit/?id=2ad09786a)

* auth/dce.c, auth/sudo\_auth.h:

  DCE authentication method; basically unchanged from dce\_pwent.c
  [[0e40c7888]](https://git.sudo.ws/sudo/commit/?id=0e40c7888)

* auth/aix\_auth.c, auth/sudo\_auth.h:

  AIX authenticate() support. Could probably be much better
  [[ce2573d99]](https://git.sudo.ws/sudo/commit/?id=ce2573d99)

* auth/sia.c:

  Fix an uninitialized variable and some cleanup. Now works (tested)
  [[d1c145f41]](https://git.sudo.ws/sudo/commit/?id=d1c145f41)

* auth/sia.c, auth/sudo\_auth.h:

  SIA support for digital unix
  [[c9e9f07ac]](https://git.sudo.ws/sudo/commit/?id=c9e9f07ac)

* auth/pam.c:

  don’t use prompt global, it will go away
  [[14854258a]](https://git.sudo.ws/sudo/commit/?id=14854258a)

* auth/secureware.c:

  correct copyright years
  [[2d8417f59]](https://git.sudo.ws/sudo/commit/?id=2d8417f59)

* auth/afs.c, auth/fwtk.c, auth/kerb4.c, auth/kerb5.c, auth/opie.c,
  auth/pam.c, auth/passwd.c, auth/secureware.c, auth/securid.c,
  auth/skey.c, auth/sudo\_auth.c, auth/sudo\_auth.h:

  New authentication API and methods
  [[169d85ac9]](https://git.sudo.ws/sudo/commit/?id=169d85ac9)

1999-07-08 Todd C. Miller

* sudo.tab.c:

  regen
  [[d22fe7a98]](https://git.sudo.ws/sudo/commit/?id=d22fe7a98)

* parse.yacc:

  only save an entry if user\_matches && host\_matches, even if the stack is
  empty (fix for previous commit)
  [[63209c134]](https://git.sudo.ws/sudo/commit/?id=63209c134)

* sudo.tab.c:

  regen
  [[5ab9fa82e]](https://git.sudo.ws/sudo/commit/?id=5ab9fa82e)

* parse.yacc:
  1. Always save an entry on the stack if it is empty. This fixes the -l
     and -v flags that were broken by earlier parser changes.
  2. In a Runas list, don’t negate FALSE -> TRUE since that would make
     !foo match any time the user specified a runas user (via -u) other than
     foo.
     [[fb54a0311]](https://git.sudo.ws/sudo/commit/?id=fb54a0311)

* testsudoers.c:

  interfaces and num\_interfaces are now auto, not extern
  [[feb78be26]](https://git.sudo.ws/sudo/commit/?id=feb78be26)

1999-07-07 Todd C. Miller

* auth.c:

  use a static global to keep stae about empty passwords
  [[b7a4a6c78]](https://git.sudo.ws/sudo/commit/?id=b7a4a6c78)

* check\_sia.c:

  make PASSWORD\_NOT\_CORRECT logging consistent with other modules
  [[cc68b825c]](https://git.sudo.ws/sudo/commit/?id=cc68b825c)

1999-07-05 Todd C. Miller

* auth.c:

  PAM prompt code was wrong, looks like we have to kludge it after all.
  [[1b023dc9d]](https://git.sudo.ws/sudo/commit/?id=1b023dc9d)

* auth.c:

  In the PAM code, when a user hits return at the first password prompt,
  exit without a warning just like the normal auth code
  [[3bdb3e41c]](https://git.sudo.ws/sudo/commit/?id=3bdb3e41c)

* configure, configure.in:

  kludge around cross-compiler false positives
  [[0f648f106]](https://git.sudo.ws/sudo/commit/?id=0f648f106)

* auth.c, check.c, check\_sia.c, logging.c, sudo.h, tgetpass.c:

  New (correct) PAM code Tgetpass now takes an echo flag for use with
  PAM\_PROMPT\_ECHO\_ON Block SIGINT and SIGTSTP during auth remove a useless
  umask setting Change error from BAD\_ALLOCATION -> BAD\_AUTH\_INIT (for
  use with sia/PAM) Some cosmetic changes to auth.c for consistency
  [[69a00325e]](https://git.sudo.ws/sudo/commit/?id=69a00325e)

* sudo.c:

  Some -Wall and kill some trailing spaces
  [[20002b5fe]](https://git.sudo.ws/sudo/commit/?id=20002b5fe)

* configure.in:

  define -D\_\_EXTENSIONS\_\_ for solaris so we get crypt() proto
  [[82353107e]](https://git.sudo.ws/sudo/commit/?id=82353107e)

1999-06-22 Todd C. Miller

* RUNSON:

  add Dynix 4.4.4
  [[34fa2fc23]](https://git.sudo.ws/sudo/commit/?id=34fa2fc23)

* INSTALL, config.h.in, configure, configure.in:

  for kerberos V < version, fall back on old kerb4 auth code
  [[8e30e833f]](https://git.sudo.ws/sudo/commit/?id=8e30e833f)

* INSTALL:

  clarify some things
  [[81cf00633]](https://git.sudo.ws/sudo/commit/?id=81cf00633)

* UPGRADE, sudoers.cat, sudoers.man, sudoers.pod:

  typos
  [[a11c14868]](https://git.sudo.ws/sudo/commit/?id=a11c14868)

1999-06-14 Todd C. Miller

* sudo.c:

  mention why DONT\_LEAK\_PATH\_INFO is not the default
  [[b3cd9b1f9]](https://git.sudo.ws/sudo/commit/?id=b3cd9b1f9)

1999-06-03 Todd C. Miller

* tgetpass.c:

  Fix open(2) return value checking, was NULL for fopen, should be -1 for
  open
  [[1eab167a3]](https://git.sudo.ws/sudo/commit/?id=1eab167a3)

* configure:

  regen
  [[c4cb29099]](https://git.sudo.ws/sudo/commit/?id=c4cb29099)

* configure.in:

  better wording for solaris pam notice
  [[45700fb7b]](https://git.sudo.ws/sudo/commit/?id=45700fb7b)

* CHANGES:

  document recent changes
  [[8b8db7ea0]](https://git.sudo.ws/sudo/commit/?id=8b8db7ea0)

* TROUBLESHOOTING:

  Update shadow password section
  [[f5c60e6df]](https://git.sudo.ws/sudo/commit/?id=f5c60e6df)

* auth.c:

  move authentication code from check.c to auth.c
  [[7d768c1ce]](https://git.sudo.ws/sudo/commit/?id=7d768c1ce)

* Makefile.in, check.c, sudo.h:

  move authentication code to auth.c
  [[406056d7e]](https://git.sudo.ws/sudo/commit/?id=406056d7e)

1999-05-17 Todd C. Miller

* Makefile.in, check.c, check\_sia.c, compat.h, find\_path.c, getspwuid.c,
  goodpath.c, interfaces.c, interfaces.h, lex.yy.c, logging.c, parse.c,
  parse.lex, parse.yacc, secureware.c, sudo.c, sudo.h, sudo.tab.c,
  sudo\_setenv.c, testsudoers.c, tgetpass.c, visudo.c:

  Move interface-related defines to interfaces.h so we don’t have to
  include <netinet/in.h> everywhere.
  [[80287c981]](https://git.sudo.ws/sudo/commit/?id=80287c981)

1999-05-14 Todd C. Miller

* CHANGES, INSTALL, TODO, check.c, compat.h, getspwuid.c, logging.c,
  parse.yacc, sudo.c, sudo.tab.c, tgetpass.c:

  o Replace \_PASSWD\_LEN braindeath with our own SUDO\_MAX\_PASS. It turns
  out the old DES crypt does the right thing with passwords longert than 8
  characters. o Fix common typo (necesary -> necessary) o Update TODO
  list
  [[850a52aa6]](https://git.sudo.ws/sudo/commit/?id=850a52aa6)

1999-05-03 Todd C. Miller

* sudo.c:

  set $LOGNAME when we set $USER
  [[6b91a87a9]](https://git.sudo.ws/sudo/commit/?id=6b91a87a9)

1999-04-27 Todd C. Miller

* INSTALL:

  add comment about digital unix and interfaces.c warning with gcc
  [[52ff801d8]](https://git.sudo.ws/sudo/commit/?id=52ff801d8)

1999-04-15 Todd C. Miller

* sample.sudoers:

  use modern paths and give examples for some of the new parser features
  [[276ea3cbe]](https://git.sudo.ws/sudo/commit/?id=276ea3cbe)

1999-04-10 Todd C. Miller

* parse.c:

  fix comment
  [[16fdb0a5c]](https://git.sudo.ws/sudo/commit/?id=16fdb0a5c)

* alloc.c, check.c, check\_sia.c, dce\_pwent.c, find\_path.c, getspwuid.c,
  goodpath.c, interfaces.c, lex.yy.c, logging.c, parse.c, parse.lex,
  parse.yacc, putenv.c, secureware.c, sudo.c, sudo.tab.c, sudo\_setenv.c,
  testsudoers.c, tgetpass.c, utime.c, visudo.c:

  Function names should be flush with the start of the line so they can be
  found trivially in an editor and with grep
  [[06e586ee7]](https://git.sudo.ws/sudo/commit/?id=06e586ee7)

* find\_path.c, interfaces.c, lex.yy.c, parse.c, parse.lex, parse.yacc,
  sudo.c, sudo.tab.c, testsudoers.c, tgetpass.c, visudo.c:

  free(3) is already void, no need to cast it
  [[eecc5ce1c]](https://git.sudo.ws/sudo/commit/?id=eecc5ce1c)

* logging.c, sudo.c, sudo.h:

  catch case where cmnd\_safe is not set (this should not be possible)
  [[8e8fbc251]](https://git.sudo.ws/sudo/commit/?id=8e8fbc251)

* CHANGES, logging.c, parse.c, parse.yacc, sudo.c, sudo.h, sudo.tab.c,
  testsudoers.c, visudo.c:

  Stash the “safe” path (ie: the one listed in sudoers) to the command
  instead of stashing the struct stat. Should be safer.
  [[59b0cff8c]](https://git.sudo.ws/sudo/commit/?id=59b0cff8c)

1999-04-08 Todd C. Miller

* INSTALL, Makefile.in, UPGRADE:

  notes on updating from an earlier release
  [[0ef9c81f1]](https://git.sudo.ws/sudo/commit/?id=0ef9c81f1)

* CHANGES:

  updated
  [[f1891c879]](https://git.sudo.ws/sudo/commit/?id=f1891c879)

1999-04-07 Todd C. Miller

* parse.yacc, sudo.tab.c, sudo.tab.h, sudoers.cat, sudoers.html,
  sudoers.man, sudoers.pod:

  You can now specifiy a host list instead of just a host or alias. Ie:
  user = host1,host2,ALIAS,!host3 my\_command now works.
  [[622b7a1d9]](https://git.sudo.ws/sudo/commit/?id=622b7a1d9)

* testsudoers.c:

  Quiet -Wall
  [[3a8971f65]](https://git.sudo.ws/sudo/commit/?id=3a8971f65)

* parse.yacc, sudo.tab.c:

  Move the push from the beginning of cmndspec to the end. This means we
  no longer have to do a push at the end of privilege, just reset some
  values.
  [[91e31132d]](https://git.sudo.ws/sudo/commit/?id=91e31132d)

* sudoers.cat, sudoers.html, sudoers.man, sudoers.pod:

  runas-lists and NOPASSWD/PASSWD modifiers are now sticky and you can use
  “!” most everywhere
  [[2d8c7c081]](https://git.sudo.ws/sudo/commit/?id=2d8c7c081)

1999-04-06 Todd C. Miller

* sudoers.pod:

  modernize paths and update su example based on sample.sudoers one
  [[0d2e2e9f3]](https://git.sudo.ws/sudo/commit/?id=0d2e2e9f3)

* sample.sudoers:

  New runas semantics
  [[5d78a954e]](https://git.sudo.ws/sudo/commit/?id=5d78a954e)

* CHANGES, Makefile.in, alloc.c, config.h.in, configure, configure.in,
  strdup.c, sudo.h:

  In estrdup(), do the malloc ourselves so we don’t need to rely on the
  system strdup(3) which may or may not exist. There is now no need to
  provide strdup() for those w/o it. Also, the prototype for estrdup() was
  wrong, it returns char \* and its param is const.
  [[0d67007d1]](https://git.sudo.ws/sudo/commit/?id=0d67007d1)

* getcwd.c:

  $Sudo tag
  [[29523f349]](https://git.sudo.ws/sudo/commit/?id=29523f349)

* check.c:

  buf should be prompt; Michael Robokoff <mrobo@…>
  [[ecb8d08e2]](https://git.sudo.ws/sudo/commit/?id=ecb8d08e2)

* CHANGES, TODO, parse.yacc, sudo.tab.c:

  It is now possible to use the ‘!’ operator in a runas list as well as in
  a Cmnd\_Alias, Host\_Alias and User\_Alias.
  [[f50a342b4]](https://git.sudo.ws/sudo/commit/?id=f50a342b4)

* logging.c, sudo.h:

  Kill GLOBAL\_NO\_SPW\_ENT (not used) and crank GLOBAL\_PROBLEM
  [[d53f3818a]](https://git.sudo.ws/sudo/commit/?id=d53f3818a)

* sudo.h:

  Definitions of \*\_matched were wrong–user top, not top-2 as subscript.
  [[1818ace05]](https://git.sudo.ws/sudo/commit/?id=1818ace05)

* logging.c, parse.c, parse.yacc, sudo.c, sudo.h, sudo.tab.c:

  Add VALIDATE\_NOT\_OK\_NOPASS for when user is not allowed to run a command
  but the NOPASSWD flag was set. Make runasspec, runaslist, runasuser, and
  nopasswd typeless in parse.yacc Add support for ‘!’ in the runas list
  Fix double printing of ‘%’ and ‘+’ for groups and netgroups respectively
  Add \*\_matched macros (no need for local stack variable). Should only be
  used directly after a pop (since top must be >= 2).
  [[499e86923]](https://git.sudo.ws/sudo/commit/?id=499e86923)

* aclocal.m4, configure.in:

  Add copyright, somewhat silly
  [[9284e417c]](https://git.sudo.ws/sudo/commit/?id=9284e417c)

1999-04-05 Todd C. Miller

* BUGS, INSTALL, Makefile.in, README, alloc.c, check.c, check\_sia.c,
  compat.h, config.h.in, configure, configure.in, dce\_pwent.c,
  emul/utime.h, find\_path.c, getspwuid.c, goodpath.c, ins\_2001.h,
  ins\_classic.h, ins\_csops.h, ins\_goons.h, insults.h, interfaces.c,
  lex.yy.c, logging.c, parse.c, parse.lex, parse.yacc, pathnames.h.in,
  putenv.c, secureware.c, strdup.c, sudo.c, sudo.cat, sudo.h, sudo.man,
  sudo.tab.c, sudo\_setenv.c, sudoers.cat, sudoers.man, testsudoers.c,
  tgetpass.c, utime.c, version.h, visudo.c, visudo.cat, visudo.man:

  Crank version to 1.6 and combine copyright statements
  [[e6deacb6c]](https://git.sudo.ws/sudo/commit/?id=e6deacb6c)

* sample.sudoers:

  Use ! not ^ to do negation
  [[9a9dc3fab]](https://git.sudo.ws/sudo/commit/?id=9a9dc3fab)

* lex.yy.c, sudo.tab.c:

  regen
  [[094a29a66]](https://git.sudo.ws/sudo/commit/?id=094a29a66)

* parse.lex, parse.yacc:

  Make runas and NOPASSWD tags persistent across entris in a command list.
  Add a PASSWD tag to reverse NOPASSWD. When you override a runas or
  \*PASSWD tag the value given becomes the new default for the rest of the
  command list.
  [[4f6f75ae3]](https://git.sudo.ws/sudo/commit/?id=4f6f75ae3)

1999-04-02 Todd C. Miller

* CHANGES, RUNSON:

  update for 1.5.9
  [[321906bfb]](https://git.sudo.ws/sudo/commit/?id=321906bfb)

* visudo.c:

  Shift return value of system(3) by 8 to get real exit value and if it is
  not 1 or 0 print the retval along with the error message.
  [[a234aee2c]](https://git.sudo.ws/sudo/commit/?id=a234aee2c)

1999-03-30 Todd C. Miller

* Makefile.in:

  testsudoers needs LIBOBJS too
  [[1116756bf]](https://git.sudo.ws/sudo/commit/?id=1116756bf)

* parse.c, parse.yacc, sudo.tab.c:

  Fix another parser bug. For a sudoers entry like this: millert
  ALL=/bin/ls,(daemon) !/bin/ls sudo would not allow millert to run ls as
  root.
  [[49c5a12d8]](https://git.sudo.ws/sudo/commit/?id=49c5a12d8)

* CHANGES:

  new change
  [[b3f330600]](https://git.sudo.ws/sudo/commit/?id=b3f330600)

* parse.yacc, sudo.tab.c:

  Save entries that match a ! command on the matching stack too
  [[baae4d4dd]](https://git.sudo.ws/sudo/commit/?id=baae4d4dd)

* sudo.c:

  Make sudo’s usage info better when mutually exclusive args are given and
  don’t rely on argument order to detect this; nick@….au
  [[1b56f53a4]](https://git.sudo.ws/sudo/commit/?id=1b56f53a4)

1999-03-29 Todd C. Miller

* CHANGES, Makefile.in, RUNSON:

  updates from CU
  [[2c7a8ba7b]](https://git.sudo.ws/sudo/commit/?id=2c7a8ba7b)

* Makefile.in:

  use gzip
  [[3f7ace9ee]](https://git.sudo.ws/sudo/commit/?id=3f7ace9ee)

* parse.yacc, sudo.tab.c:

  Fix off by one error introduced in \*alloc changes
  [[75fb22990]](https://git.sudo.ws/sudo/commit/?id=75fb22990)

* BUGS, CHANGES, INSTALL, Makefile.in, README, alloc.c, check.c,
  check\_sia.c, compat.h, config.h.in, configure, configure.in,
  dce\_pwent.c, emul/utime.h, find\_path.c, getspwuid.c, goodpath.c,
  ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h, insults.h,
  interfaces.c, lex.yy.c, logging.c, parse.c, parse.lex, parse.yacc,
  pathnames.h.in, putenv.c, secureware.c, strdup.c, sudo.c, sudo.cat,
  sudo.h, sudo.man, sudo.tab.c, sudo\_setenv.c, sudoers.cat, sudoers.man,
  testsudoers.c, tgetpass.c, utime.c, version.h, visudo.c, visudo.cat,
  visudo.html, visudo.man, visudo.pod:

  ++version
  [[79c46d1c8]](https://git.sudo.ws/sudo/commit/?id=79c46d1c8)

* Makefile.in, check.c, find\_path.c, getspwuid.c, goodpath.c,
  interfaces.c, lex.yy.c, logging.c, parse.c, parse.lex, parse.yacc,
  putenv.c, secureware.c, strdup.c, sudo.c, sudo.h, sudo.tab.c,
  sudo\_setenv.c, testsudoers.c, utime.c, visudo.c:

  Use emalloc/erealloc/estrdup
  [[382ef7549]](https://git.sudo.ws/sudo/commit/?id=382ef7549)

* alloc.c:

  error checking memory allocation routines
  [[d8947486e]](https://git.sudo.ws/sudo/commit/?id=d8947486e)

* parse.yacc, sudo.tab.c:

  Still not right, this fixes it for real
  [[e4b42c5ea]](https://git.sudo.ws/sudo/commit/?id=e4b42c5ea)

* parse.yacc, sudo.tab.c:

  Fix for previous commit
  [[b789f9e93]](https://git.sudo.ws/sudo/commit/?id=b789f9e93)

* CHANGES, INSTALL, parse.yacc:

  Fix a parser bug that was exposed when mixing different runas specs and
  ! commands. For example: millert ALL=(daemon) /usr/bin/whoami,!/bin/ls
  would allow millert to run whoami as root as well as daemon when it
  should just allow daemon. The problem was that comma-separated commands
  in a list shared the same entry on the matching stack. Now they get
  their own entry iff there is a full match. It may be better to just make
  the runas spec persistent across all commands in a list like the user
  and host entries of the matching stack. However, since that is a fairly
  major change it should gets its own minor rev increase.
  [[217710df3]](https://git.sudo.ws/sudo/commit/?id=217710df3)

1999-03-28 Todd C. Miller

* check.c, config.h.in:

  Simplify PAM code and fix a PAM-related warning on Linux
  [[bd76c1333]](https://git.sudo.ws/sudo/commit/?id=bd76c1333)

1999-03-26 Todd C. Miller

* CHANGES:

  updates
  [[37873b23d]](https://git.sudo.ws/sudo/commit/?id=37873b23d)

* sample.sudoers:

  better su entry
  [[56b0eb23f]](https://git.sudo.ws/sudo/commit/?id=56b0eb23f)

* configure:

  regen
  [[07b9914ed]](https://git.sudo.ws/sudo/commit/?id=07b9914ed)

* check.c, configure.in:

  new pam code that works on solaris, should work on linux too;
  aelberg@…
  [[c38c66b2b]](https://git.sudo.ws/sudo/commit/?id=c38c66b2b)

1999-03-19 Todd C. Miller

* RUNSON:

  more entries
  [[958ccf521]](https://git.sudo.ws/sudo/commit/?id=958ccf521)

* config.h.in:

  only include strings.h if there is no string.h
  [[2a5776995]](https://git.sudo.ws/sudo/commit/?id=2a5776995)

1999-03-17 Todd C. Miller

* config.guess:

  Sinix is now being called ReliantUNIX; bjjackso@…
  [[5dcb02b2a]](https://git.sudo.ws/sudo/commit/?id=5dcb02b2a)

1999-03-13 Todd C. Miller

* sudo.c:

  shost must be set before log functions are called #ifdef HOST\_IN\_LOG
  [[c74286542]](https://git.sudo.ws/sudo/commit/?id=c74286542)

1999-03-07 Todd C. Miller

* CHANGES, lex.yy.c, parse.lex:

  Fix a bug wrt quoting characters in command args. Stop processing an arg
  when you hit a backslash so the quoted-character detection can catch it.
  [[736359cce]](https://git.sudo.ws/sudo/commit/?id=736359cce)

1999-02-26 Todd C. Miller

* interfaces.c:

  include sys/time.h; aparently AIX needs it. ppz@cdu.elektra.ru
  [[ddb4cacb4]](https://git.sudo.ws/sudo/commit/?id=ddb4cacb4)

1999-02-24 Todd C. Miller

* configure, configure.in:

  add missing case statement so –without-sendmail works
  [[3e14f7237]](https://git.sudo.ws/sudo/commit/?id=3e14f7237)

1999-02-23 Todd C. Miller

* CHANGES:

  more
  [[59321981d]](https://git.sudo.ws/sudo/commit/?id=59321981d)

1999-02-22 Todd C. Miller

* configure, configure.in:

  only search for -lsun in irix <= 4.x
  [[6bf7f60c2]](https://git.sudo.ws/sudo/commit/?id=6bf7f60c2)

* configure, configure.in:

  back out last configure.in change now that I’ve hacked autoconf to fix
  the real problem and add a missing newline
  [[89bdafdc3]](https://git.sudo.ws/sudo/commit/?id=89bdafdc3)

* CHANGES:

  updated
  [[8aa6c700b]](https://git.sudo.ws/sudo/commit/?id=8aa6c700b)

* getcwd.c:

  add def of dirfd() for those without it
  [[cd8cc0d00]](https://git.sudo.ws/sudo/commit/?id=cd8cc0d00)

* configure, configure.in:

  When falling back to checking for socket() when linking with “-lsocket
  -lnsl” check for main() instead since autoconf has already cached the
  results of checking for socket() in -lsocket. This is really an autoconf
  bug as it should use the extra libs as part of the cache variable name.
  [[d3730e35f]](https://git.sudo.ws/sudo/commit/?id=d3730e35f)

* configure.in:

  typo
  [[27a065f26]](https://git.sudo.ws/sudo/commit/?id=27a065f26)

1999-02-21 Todd C. Miller

* configure.in:

  fix occurrence of $with\_timeout that should be $with\_password\_timeout;
  Michael.Neef@neuroinformatik.ruhr-uni-bochum.de
  [[a650f840c]](https://git.sudo.ws/sudo/commit/?id=a650f840c)

1999-02-17 Todd C. Miller

* sudo.cat, sudo.html, sudo.man, sudo.pod:

  fix grammar; espie@…
  [[aeffa02a1]](https://git.sudo.ws/sudo/commit/?id=aeffa02a1)

1999-02-11 Todd C. Miller

* parse.yacc, sudo.c, testsudoers.c:

  add cast for strdup in places it does not have it
  [[f9b80fcad]](https://git.sudo.ws/sudo/commit/?id=f9b80fcad)

1999-02-09 Todd C. Miller

* configure, configure.in:

  define for\_BSD\_TYPES irix
  [[699338971]](https://git.sudo.ws/sudo/commit/?id=699338971)

1999-02-07 Todd C. Miller

* Makefile.in, sudo.cat, sudo.html, sudo.man, sudo.pod:

  Make it clear that it is the user’s password, not root’s, that we want.
  [[50219d0aa]](https://git.sudo.ws/sudo/commit/?id=50219d0aa)

* check.c, sudo.h:

  If the user enters an empty password and really has no password, accept
  the empty password they entered. Perviously, they could enter anything
  *but* an empty password. Also, add GETPASS macro that calls either
  tgetpass() or getpass() depending on how sudo was configured. Problem
  noted by jdg@maths.qmw.ac.uk
  [[a3029dedd]](https://git.sudo.ws/sudo/commit/?id=a3029dedd)

1999-02-03 Todd C. Miller

* Makefile.in, check.c, check\_sia.c, compat.h, config.h.in, dce\_pwent.c,
  emul/utime.h, find\_path.c, getspwuid.c, goodpath.c, ins\_2001.h,
  ins\_classic.h, ins\_csops.h, ins\_goons.h, insults.h, interfaces.c,
  logging.c, parse.c, parse.lex, parse.yacc, pathnames.h.in, putenv.c,
  secureware.c, strdup.c, sudo.c, sudo.h, sudo\_setenv.c, testsudoers.c,
  tgetpass.c, utime.c, version.h, visudo.c:

  add explicate copyright
  [[52916f16a]](https://git.sudo.ws/sudo/commit/?id=52916f16a)

* CHANGES:

  mention -lsocket, -lnsl configure changes
  [[9d42f9713]](https://git.sudo.ws/sudo/commit/?id=9d42f9713)

1999-02-02 Todd C. Miller

* sudo.c:

  Don’t clobber errno after calling check\_sudoers().
  [[e6f9653f7]](https://git.sudo.ws/sudo/commit/?id=e6f9653f7)

1999-02-01 Todd C. Miller

* configure, configure.in:

  When linking with both -lsocket and -lnsl be sure to do so in that
  order. Also, when we can’t find socket() or inet\_addr() and have to try
  linking with both libs, issue a warning.
  [[97d36a72d]](https://git.sudo.ws/sudo/commit/?id=97d36a72d)

* sudo.cat, sudo.man, sudo.pod:

  clarify bad timestamp and fmt
  [[dab5a0133]](https://git.sudo.ws/sudo/commit/?id=dab5a0133)

1999-01-23 Todd C. Miller

* INSTALL, RUNSON:

  be clear that pam is linux-only and add a RUNSON entry
  [[859712c53]](https://git.sudo.ws/sudo/commit/?id=859712c53)

1999-01-22 Todd C. Miller

* CHANGES, INSTALL, configure, configure.in:

  fix and correctly document –with-umask; problem noted by adap@…
  [[463396270]](https://git.sudo.ws/sudo/commit/?id=463396270)

1999-01-20 Todd C. Miller

* configure, configure.in:

  only use /usr/{man,catman}/local to store man pages if suer didn’t
  override prefix or mandir
  [[fe4f974b3]](https://git.sudo.ws/sudo/commit/?id=fe4f974b3)

* INSTALL, configure, configure.in:

  fix typo, make –with-SecurID take an arg
  [[94026c212]](https://git.sudo.ws/sudo/commit/?id=94026c212)

1999-01-19 Todd C. Miller

* RUNSON:

  updates from users
  [[f0f0bcc2f]](https://git.sudo.ws/sudo/commit/?id=f0f0bcc2f)

* CHANGES, INSTALL, check.c, configure, configure.in:

  FWTK ‘authsrv’ support from Kevin Kadow <kadow@MSG.NET>
  [[cefcc04d6]](https://git.sudo.ws/sudo/commit/?id=cefcc04d6)

* configure, configure.in:

  better fix for the problem of unresolved symbols in -lnsl or -lsocket
  [[55a5687a3]](https://git.sudo.ws/sudo/commit/?id=55a5687a3)

* configure, configure.in:

  when checking for functions in -lnsl and -lsocket link with both of them
  to avoid unresolved symbols on some weirdo systems
  [[0ca93567b]](https://git.sudo.ws/sudo/commit/?id=0ca93567b)

1999-01-18 Todd C. Miller

* BUGS, CHANGES, RUNSON, TODO:

  old changes that didn’t make it into RCS before the RCS->CVS switch
  [[1bb164610]](https://git.sudo.ws/sudo/commit/?id=1bb164610)

1999-01-17 Todd C. Miller

* Makefile.in, check.c, check\_sia.c, compat.h, config.h.in, configure.in,
  dce\_pwent.c, emul/search.h, emul/utime.h, find\_path.c, getspwuid.c,
  goodpath.c, ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h,
  insults.h, interfaces.c, lex.yy.c, logging.c, lsearch.c, parse.c,
  parse.lex, parse.yacc, pathnames.h.in, putenv.c, secureware.c, strdup.c,
  sudo.c, sudo.pod, sudo\_setenv.c, sudoers.pod, testsudoers.c, tgetpass.c,
  utime.c, visudo.c, visudo.pod:

  add sudo tags
  [[826fe213f]](https://git.sudo.ws/sudo/commit/?id=826fe213f)

* sudo.h:

  testing Sudo tag
  [[251962273]](https://git.sudo.ws/sudo/commit/?id=251962273)

* version.h:

  testing Sudo tag
  [[d9a077e8a]](https://git.sudo.ws/sudo/commit/?id=d9a077e8a)

* BUGS, INSTALL, Makefile.in, README, check.c, check\_sia.c, compat.h,
  config.h.in, configure, configure.in, dce\_pwent.c, emul/utime.h,
  find\_path.c, getspwuid.c, goodpath.c, ins\_2001.h, ins\_classic.h,
  ins\_csops.h, ins\_goons.h, insults.h, interfaces.c, lex.yy.c, logging.c,
  parse.c, parse.lex, parse.yacc, pathnames.h.in, putenv.c, secureware.c,
  strdup.c, sudo.c, sudo.cat, sudo.h, sudo.man, sudo\_setenv.c,
  sudoers.cat, sudoers.man, testsudoers.c, tgetpass.c, utime.c, version.h,
  visudo.c, visudo.cat, visudo.man:

  crank version and regen files
  [[d3aaf5228]](https://git.sudo.ws/sudo/commit/?id=d3aaf5228)

* Makefile.in:

  kill rcs goop in update\_version and fix now that version is a const
  [[c2621fd7e]](https://git.sudo.ws/sudo/commit/?id=c2621fd7e)

* INSTALL, check.c, config.h.in, configure, configure.in, logging.c,
  sudo.c, sudo.h, sudo.pod:

  kerb5 support from fcusack@iconnet.net
  [[3983a7a65]](https://git.sudo.ws/sudo/commit/?id=3983a7a65)

* realpath.c, sudo\_realpath.c:

  we no longer use realpath
  [[7f5675869]](https://git.sudo.ws/sudo/commit/?id=7f5675869)

* qualify.c:

  replaced by find\_path.c
  [[8f92b48b4]](https://git.sudo.ws/sudo/commit/?id=8f92b48b4)

* options.h:

  all options are now configure flags
  [[cf56274ec]](https://git.sudo.ws/sudo/commit/?id=cf56274ec)

* lex.yy.c:

  regen
  [[eb22ac2ec]](https://git.sudo.ws/sudo/commit/?id=eb22ac2ec)

* getwd.c:

  superceded by getcwd.c
  [[9e591b7bd]](https://git.sudo.ws/sudo/commit/?id=9e591b7bd)

* getpass.c:

  superceded by tgetpass.c
  [[ca49d5ca8]](https://git.sudo.ws/sudo/commit/?id=ca49d5ca8)

* SUPPORTED:

  superceded by RUNSON
  [[e83631bac]](https://git.sudo.ws/sudo/commit/?id=e83631bac)

* OPTIONS:

  No longer used now that we have configure options for everything.
  [[2853eeffa]](https://git.sudo.ws/sudo/commit/?id=2853eeffa)

* configure:

  regen based on configure.in
  [[ab576d5bd]](https://git.sudo.ws/sudo/commit/?id=ab576d5bd)

* sudo.cat, sudo.html, sudo.man, sudoers.cat, sudoers.html, sudoers.man,
  visudo.cat, visudo.html, visudo.man:

  regen based on sudo.pod, sudoers.pod, and visudo.pod
  [[de6f4fac3]](https://git.sudo.ws/sudo/commit/?id=de6f4fac3)

1998-12-11 Todd C. Miller

* check.c:

  fix tty tickets in remove\_timestamp (didn’t use ‘:’)
  [[9daf68bb7]](https://git.sudo.ws/sudo/commit/?id=9daf68bb7)

1998-12-07 Todd C. Miller

* interfaces.c:

  close sock when we are done with it
  [[d61383848]](https://git.sudo.ws/sudo/commit/?id=d61383848)

1998-11-28 Todd C. Miller

* parse.yacc:

  never say “error on line -1”
  [[a31b34260]](https://git.sudo.ws/sudo/commit/?id=a31b34260)

1998-11-24 Todd C. Miller

* configure.in:

  check for -lnsl before -lsocket
  [[3b6a06a6a]](https://git.sudo.ws/sudo/commit/?id=3b6a06a6a)

* configure.in:

  quote ‘[’, ‘]’ used in ranges correctly
  [[0c0b9b9d3]](https://git.sudo.ws/sudo/commit/?id=0c0b9b9d3)

1998-11-21 Todd C. Miller

* config.h.in:

  add missing NO\_ROOT\_SUDO noted by drno@…
  [[38e108587]](https://git.sudo.ws/sudo/commit/?id=38e108587)

1998-11-20 Todd C. Miller

* version.h:

  1.5.7
  [[aa0917f9c]](https://git.sudo.ws/sudo/commit/?id=aa0917f9c)

* INSTALL:

  more info for 1.5.7
  [[ab78fa496]](https://git.sudo.ws/sudo/commit/?id=ab78fa496)

* README:

  update for 1.5.7
  [[3940efc90]](https://git.sudo.ws/sudo/commit/?id=3940efc90)

* parse.yacc:

  make increases of cm\_list\_size and ga\_list\_size be similar to increases
  of stacksize (ie: >= not > in initial compare).
  [[d5fb938c1]](https://git.sudo.ws/sudo/commit/?id=d5fb938c1)

* parse.yacc:

  when we get a syntax error, report it for the previous line since that’s
  generally where the error occurred.
  [[cbd9d6f32]](https://git.sudo.ws/sudo/commit/?id=cbd9d6f32)

1998-11-18 Todd C. Miller

* config.h.in, configure.in, interfaces.c:

  add back check for sys/sockio.h but only use it if SIOCGIFCONF is not
  defined
  [[6bf40c3c0]](https://git.sudo.ws/sudo/commit/?id=6bf40c3c0)

* config.h.in:

  define BSD\_COMP for svr4
  [[a3c16ebec]](https://git.sudo.ws/sudo/commit/?id=a3c16ebec)

* check.c, check\_sia.c, find\_path.c, getcwd.c, getspwuid.c, goodpath.c,
  interfaces.c, logging.c, lsearch.c, parse.c, parse.lex, parse.yacc,
  putenv.c, secureware.c, strdup.c, sudo.c, sudo\_setenv.c, testsudoers.c,
  tgetpass.c, utime.c, visudo.c:

  more -Wall
  [[62dba8f4d]](https://git.sudo.ws/sudo/commit/?id=62dba8f4d)

* configure.in:

  kill check for sockio,h
  [[bbcd21287]](https://git.sudo.ws/sudo/commit/?id=bbcd21287)

* config.h.in:

  no more HAVE\_SYS\_SOCKIO\_H
  [[35ec16eb7]](https://git.sudo.ws/sudo/commit/?id=35ec16eb7)

* check.c, check\_sia.c, find\_path.c, getcwd.c, getspwuid.c, goodpath.c,
  interfaces.c, logging.c, lsearch.c, parse.c, parse.lex, parse.yacc,
  putenv.c, secureware.c, strdup.c, sudo.c, sudo\_setenv.c, testsudoers.c,
  tgetpass.c, utime.c, visudo.c:

  -Wall
  [[c253188f5]](https://git.sudo.ws/sudo/commit/?id=c253188f5)

1998-11-16 Todd C. Miller

* sudo.c:

  add missing inform\_user()
  [[ba5a24cfc]](https://git.sudo.ws/sudo/commit/?id=ba5a24cfc)

1998-11-14 Todd C. Miller

* find\_path.c:

  return NOT\_FOUND if given fully qualified path and it does not exist
  previously it would perror(ENOENT) which bypasses the option to not leak
  path info
  [[4c4e1d376]](https://git.sudo.ws/sudo/commit/?id=4c4e1d376)

* configure.in:

  for kerb5, check for -lkerb4, fall back on -lkrb for kerb, check for
  -ldes
  [[1515dfb49]](https://git.sudo.ws/sudo/commit/?id=1515dfb49)

1998-11-13 Todd C. Miller

* INSTALL:

  tty tickets are user:tty now
  [[a8fce0bce]](https://git.sudo.ws/sudo/commit/?id=a8fce0bce)

* check.c:

  when using tty tickets make it user:tty not user.tty as a username could
  have a ‘.’ in it
  [[b831104e1]](https://git.sudo.ws/sudo/commit/?id=b831104e1)

1998-11-10 Todd C. Miller

* sudo.c:

  add “ignoring foo found in .” for auth successful case
  [[53969f978]](https://git.sudo.ws/sudo/commit/?id=53969f978)

1998-11-09 Todd C. Miller

* sudo.c:

  add missing printf param
  [[b82d683a3]](https://git.sudo.ws/sudo/commit/?id=b82d683a3)

1998-11-08 Todd C. Miller

* INSTALL, config.h.in, configure.in, find\_path.c, sudo.c, sudo.h:

  go back to printing “command not found” unless –disable-path-info
  specified. Also, tell user when we ignore ‘.’ in their path and it would
  have been used but for –with-ignore-dot.
  [[0900eabf3]](https://git.sudo.ws/sudo/commit/?id=0900eabf3)

* check.c, sudo.c:

  Only one space after a colon, not two, in printf’s
  [[0b9e318b7]](https://git.sudo.ws/sudo/commit/?id=0b9e318b7)

1998-11-05 Todd C. Miller

* sudo.pod:

  document setting $USER
  [[0aad2d5af]](https://git.sudo.ws/sudo/commit/?id=0aad2d5af)

* check.c:

  fix bugs with prompt expansion
  [[91af18b71]](https://git.sudo.ws/sudo/commit/?id=91af18b71)

* sudo.c:

  set $USER for root too
  [[ef4b73161]](https://git.sudo.ws/sudo/commit/?id=ef4b73161)

1998-11-04 Todd C. Miller

* getspwuid.c:

  typo
  [[2fb6e41a5]](https://git.sudo.ws/sudo/commit/?id=2fb6e41a5)

* configure.in:

  HP-UX’s iscomsec is in -lsec, not libc
  [[4d1f46461]](https://git.sudo.ws/sudo/commit/?id=4d1f46461)

* configure.in:

  remove some entries in the OS case statement that did nothing
  [[4c017795d]](https://git.sudo.ws/sudo/commit/?id=4c017795d)

* TROUBLESHOOTING:

  add “cd” section and flush out syslog section
  [[6d5591ba2]](https://git.sudo.ws/sudo/commit/?id=6d5591ba2)

* Makefile.in:

  no more sudo-lex.yy.c
  [[80b47ae77]](https://git.sudo.ws/sudo/commit/?id=80b47ae77)

* check\_sia.c:

  add custom prompt support
  [[16df5841a]](https://git.sudo.ws/sudo/commit/?id=16df5841a)

* testsudoers.c:

  kill perror(“malloc”) since we already have a good error messages pw\_ent
  -> pw for brevity
  [[d0c535cee]](https://git.sudo.ws/sudo/commit/?id=d0c535cee)

* sudo.c:

  kill perror(“malloc”) since we already have a good error messages pw\_ent
  -> pw for brevity set $USER if -u specified
  [[22f741b38]](https://git.sudo.ws/sudo/commit/?id=22f741b38)

* parse.yacc:

  kill perror(“malloc”) since we already have a good error messages
  [[c3f28be05]](https://git.sudo.ws/sudo/commit/?id=c3f28be05)

* parse.c:

  kill perror(“malloc”) since we already have a good error messages pw\_ent
  -> pw for brevity when checking if %group matches, look up user in
  password file so that %groups works in a RunAs spec.
  [[4f461199a]](https://git.sudo.ws/sudo/commit/?id=4f461199a)

* logging.c:

  kill perror(“malloc”) since we already have a good error messages
  [[5731e248b]](https://git.sudo.ws/sudo/commit/?id=5731e248b)

* check.c, getspwuid.c, interfaces.c:

  kill perror(“malloc”) since we already have a good error messages pw\_ent
  -> pw for brevity
  [[de21acbb3]](https://git.sudo.ws/sudo/commit/?id=de21acbb3)

1998-11-03 Todd C. Miller

* tgetpass.c:

  the prompt is expanded before tgetpass is called
  [[b751a2b9c]](https://git.sudo.ws/sudo/commit/?id=b751a2b9c)

* sudo.h:

  tgetpass now has the same args as getpass again
  [[1548a20d9]](https://git.sudo.ws/sudo/commit/?id=1548a20d9)

* getspwuid.c:

  add iscomsec, issecure support
  [[918306ecc]](https://git.sudo.ws/sudo/commit/?id=918306ecc)

* check.c:

  we now expand any %h or %u in the prompt before passing to tgetpass
  [[dad5b0257]](https://git.sudo.ws/sudo/commit/?id=dad5b0257)

* configure.in:

  add check for syslog(3) in -lsocket, -lnsl, -linet
  [[8f6ba6258]](https://git.sudo.ws/sudo/commit/?id=8f6ba6258)

* config.h.in:

  add HAVE\_ISCOMSEC and HAVE\_ISSECURE
  [[764ab3769]](https://git.sudo.ws/sudo/commit/?id=764ab3769)

* configure.in:

  add check for iscomsec in HP-UX
  [[aff8524f0]](https://git.sudo.ws/sudo/commit/?id=aff8524f0)

* configure.in:

  check for issecure if we have getpwanam on SunOS some options are
  incompatible with DUNIX SIA check for dispcrypt on DUNIX
  [[a3d49aa08]](https://git.sudo.ws/sudo/commit/?id=a3d49aa08)

1998-10-25 Todd C. Miller

* config.h.in:

  add HAVE\_DISPCRYPT
  [[a402de123]](https://git.sudo.ws/sudo/commit/?id=a402de123)

* secureware.c:

  add back support for non-dispcrypt based checking for older DUNIX
  [[8e41aef0f]](https://git.sudo.ws/sudo/commit/?id=8e41aef0f)

* INSTALL:

  sia changes
  [[3539bbf5b]](https://git.sudo.ws/sudo/commit/?id=3539bbf5b)

* configure.in:

  SIA becomes the default on Digital UNIX now havbe –disable-sia to turn
  it off…
  [[015c75c4d]](https://git.sudo.ws/sudo/commit/?id=015c75c4d)

* check.c:

  move local includes after system ones
  [[713756564]](https://git.sudo.ws/sudo/commit/?id=713756564)

1998-10-24 Todd C. Miller

* check.c, check\_sia.c, sudo.h:

  add pass\_warn() which prints out INCORRECT\_PASSWORD or an insult to
  stderr
  [[261cdb5d8]](https://git.sudo.ws/sudo/commit/?id=261cdb5d8)

* check\_sia.c:

  fix while loop in sia\_attempt\_auth() that checks the password. Only the
  first iteration was working.
  [[5bdc7d308]](https://git.sudo.ws/sudo/commit/?id=5bdc7d308)

1998-10-22 Todd C. Miller

* aclocal.m4:

  don’t trust UID\_MAX or MAXUID
  [[1f94c6b38]](https://git.sudo.ws/sudo/commit/?id=1f94c6b38)

* configure.in:

  fix two pastos
  [[ce733cd8f]](https://git.sudo.ws/sudo/commit/?id=ce733cd8f)

* configure.in:

  fix typo
  [[23ede59ea]](https://git.sudo.ws/sudo/commit/?id=23ede59ea)

* getspwuid.c, secureware.c:

  init crypt\_type to INT\_MAX since it is legal to be negative in DUNX 5.0
  [[a91e6bc12]](https://git.sudo.ws/sudo/commit/?id=a91e6bc12)

* configure.in:

  for secureware on dunix, use -lsecurity -ldb -laud -lm but check for
  -ldb since DUNX < 4.0 lacks it
  [[48e0ca4a0]](https://git.sudo.ws/sudo/commit/?id=48e0ca4a0)

1998-10-21 Todd C. Miller

* check.c, compat.h, config.h.in, configure.in, getspwuid.c, secureware.c,
  sudo.c, tgetpass.c:

  getprpwuid is broken in HP-UX 10.20 at least (it sleeps for 2 minutes if
  the shadow files don’t exist).
  [[7ffee3b99]](https://git.sudo.ws/sudo/commit/?id=7ffee3b99)

1998-10-20 Todd C. Miller

* INSTALL:

  updated –with-editor blurb
  [[929bff13f]](https://git.sudo.ws/sudo/commit/?id=929bff13f)

* TROUBLESHOOTING:

  tell how to put sudoers in a different dir
  [[7e6b4c5a2]](https://git.sudo.ws/sudo/commit/?id=7e6b4c5a2)

* configure.in:

  add missing quotes around $with\_editor
  [[96286964e]](https://git.sudo.ws/sudo/commit/?id=96286964e)

* configure.in:

  typo in –with-editor bits
  [[4c28e57f8]](https://git.sudo.ws/sudo/commit/?id=4c28e57f8)

* INSTALL:

  I don’t expect it to work on Solaris
  [[272a9f4a1]](https://git.sudo.ws/sudo/commit/?id=272a9f4a1)

* check.c:

  add back security/pam\_misc.h
  [[1c8dc54a3]](https://git.sudo.ws/sudo/commit/?id=1c8dc54a3)

1998-10-19 Todd C. Miller

* INSTALL:

  remove dunix note since configure checks for this now
  [[e6f3d9825]](https://git.sudo.ws/sudo/commit/?id=e6f3d9825)

* configure.in:

  add check for broken dunix prot.h (4.0 < 4.0D is bad)
  [[bd320380b]](https://git.sudo.ws/sudo/commit/?id=bd320380b)

* getspwuid.c, secureware.c, tgetpass.c:

  new dunix shadow code, use dispcrypt(3)
  [[3d92a1bb9]](https://git.sudo.ws/sudo/commit/?id=3d92a1bb9)

* config.h.in:

  add HAVE\_INITPRIVS
  [[153bd73ab]](https://git.sudo.ws/sudo/commit/?id=153bd73ab)

* sudo.c:

  call initprivs() if we have it for getprpwuid later on
  [[156c3b069]](https://git.sudo.ws/sudo/commit/?id=156c3b069)

* Makefile.in:

  clean pathnames.h too
  [[1895d4388]](https://git.sudo.ws/sudo/commit/?id=1895d4388)

* configure.in:

  quote “Sorry, try again.” with [] since it has a comma in it set LIBS
  when we add stuff to SUDO\_LIBS set SECUREWARE when we find getprpwuid()
  so we can check for bigcrypt, set\_auth\_parameters, and initprivs later.
  [[c68982b8f]](https://git.sudo.ws/sudo/commit/?id=c68982b8f)

* INSTALL:

  update Digital UNIX note about acl.h
  [[035fb6792]](https://git.sudo.ws/sudo/commit/?id=035fb6792)

* INSTALL:

  add –with-sia –without-root-sudo -> –disable-root-sudo some
  reordering
  [[1be01aad4]](https://git.sudo.ws/sudo/commit/?id=1be01aad4)

* secureware.c:

  add whitespace
  [[d948a701e]](https://git.sudo.ws/sudo/commit/?id=d948a701e)

* Makefile.in, check.c, config.h.in, configure.in, logging.c, sudo.h:

  add SIA support
  [[1dffdd17c]](https://git.sudo.ws/sudo/commit/?id=1dffdd17c)

* check\_sia.c:

  Initial revision
  [[31d783ac8]](https://git.sudo.ws/sudo/commit/?id=31d783ac8)

1998-10-18 Todd C. Miller

* configure.in:

  when checking for -lsocket, -lnsl, and -linet, check for the specific
  functions we need from them.
  [[eeaca5b70]](https://git.sudo.ws/sudo/commit/?id=eeaca5b70)

* config.h.in, sudo.h:

  move Syslog\_\* defs into sudo.h
  [[16d565dd8]](https://git.sudo.ws/sudo/commit/?id=16d565dd8)

* Makefile.in, sudo.h:

  added check\_secureware
  [[f4bef103d]](https://git.sudo.ws/sudo/commit/?id=f4bef103d)

* configure.in:

  finished adding AC\_MSG\_CHECKING and AC\_MSG\_RESULT bits
  [[136ab6b11]](https://git.sudo.ws/sudo/commit/?id=136ab6b11)

* insults.h:

  don’t define CLASSIC\_INSULTS and CSOPS\_INSULTS if no other sets defined.
  configure now does that for us
  [[1ff9e00ca]](https://git.sudo.ws/sudo/commit/?id=1ff9e00ca)

* configure.in:

  move some –with options around change a bunch of echo’s to
  AC\_MSG\_CHECKING, AC\_MSG\_RESULT pairs
  [[4e5978a37]](https://git.sudo.ws/sudo/commit/?id=4e5978a37)

* configure.in:

  change $with\_foo-bar -> $with\_foo\_bar kill extra " that caused a syntax
  error add some echo verbage
  [[5a62253b5]](https://git.sudo.ws/sudo/commit/?id=5a62253b5)

1998-10-17 Todd C. Miller

* check.c:

  moved SecureWare stuff into secureware.c
  [[a20f23f79]](https://git.sudo.ws/sudo/commit/?id=a20f23f79)

* secureware.c:

  Initial revision
  [[176c73421]](https://git.sudo.ws/sudo/commit/?id=176c73421)

* INSTALL:

  update url to solaris gcc bins
  [[16b0c311e]](https://git.sudo.ws/sudo/commit/?id=16b0c311e)

* INSTALL:

  change option formatter and flesh out someentries
  [[56954cf32]](https://git.sudo.ws/sudo/commit/?id=56954cf32)

* TROUBLESHOOTING, sudo.pod, visudo.pod:

  environmental variable -> environment variable
  [[5f41948de]](https://git.sudo.ws/sudo/commit/?id=5f41948de)

* BUGS:

  everything is now done via configure
  [[1dbd23841]](https://git.sudo.ws/sudo/commit/?id=1dbd23841)

* README:

  prev rev was 1.5.6
  [[819eaaad9]](https://git.sudo.ws/sudo/commit/?id=819eaaad9)

* Makefile.in:

  passing SUDOERS\_MODE, SUDOERS\_UID, SUDOERS\_GID correctly
  [[127545f11]](https://git.sudo.ws/sudo/commit/?id=127545f11)

* config.h.in:

  SUDOERS\_MODE, SUDOERS\_UID, SUDOERS\_GID now come from the Makefile
  [[54d5d53cb]](https://git.sudo.ws/sudo/commit/?id=54d5d53cb)

* Makefile.in:

  merge OSDEFS and OPTIONS into DEFS get sudoers\_uid, sudoers\_gid,
  sudoers\_mode from configure
  [[7634b229a]](https://git.sudo.ws/sudo/commit/?id=7634b229a)

* configure.in:

  SUDOERS\_MODE, SUDOERS\_UID, and SUDOERS\_GID now get substituted into the
  Makefile, not config.h
  [[a03196691]](https://git.sudo.ws/sudo/commit/?id=a03196691)

* INSTALL:

  document all –with/–enable options
  [[05ab66bad]](https://git.sudo.ws/sudo/commit/?id=05ab66bad)

1998-10-15 Todd C. Miller

* insults.h:

  options.h is no more
  [[3ea98f1aa]](https://git.sudo.ws/sudo/commit/?id=3ea98f1aa)

* config.h.in:

  assimilated options.h
  [[bfbe8fd6a]](https://git.sudo.ws/sudo/commit/?id=bfbe8fd6a)

* configure.in:

  moved options from options.h to configure
  [[97f58b0e6]](https://git.sudo.ws/sudo/commit/?id=97f58b0e6)

* check.c, find\_path.c, getspwuid.c, goodpath.c, interfaces.c, logging.c,
  parse.c, parse.lex, parse.yacc, sudo.c, sudo.pod, sudo\_setenv.c,
  visudo.c:

  no more options.h
  [[5bfb481ca]](https://git.sudo.ws/sudo/commit/?id=5bfb481ca)

* INSTALL, Makefile.in, PORTING, TROUBLESHOOTING:

  remove references to options.h
  [[b61f17b50]](https://git.sudo.ws/sudo/commit/?id=b61f17b50)

* dce\_pwent.c, interfaces.c, sudo.c:

  kill sys/time.h
  [[a40aca2b1]](https://git.sudo.ws/sudo/commit/?id=a40aca2b1)

* tgetpass.c:

  if select return < -1 still prompt for pw
  [[bb8c2e2a7]](https://git.sudo.ws/sudo/commit/?id=bb8c2e2a7)

* options.h:

  convert LOGGING, LOGFAC, MAXLOGFILELEN, IGNORE\_DOT\_PATH into configure
  options
  [[0560b084f]](https://git.sudo.ws/sudo/commit/?id=0560b084f)

* parse.c:

  FAST\_MATCH is no longer an optino
  [[581cfa140]](https://git.sudo.ws/sudo/commit/?id=581cfa140)

* check.c:

  remove\_timestamp() if timestamp is preposterous
  [[f45971922]](https://git.sudo.ws/sudo/commit/?id=f45971922)

* options.h:

  convert more options to –with/–enable
  [[4c92134ba]](https://git.sudo.ws/sudo/commit/?id=4c92134ba)

* INSTALL, aclocal.m4:

  logfile -> logpath
  [[918410089]](https://git.sudo.ws/sudo/commit/?id=918410089)

* configure.in:

  convert more options into –with and –enable
  [[76486858e]](https://git.sudo.ws/sudo/commit/?id=76486858e)

* tgetpass.c:

  catch EINTR in select and restart
  [[a05c2b96b]](https://git.sudo.ws/sudo/commit/?id=a05c2b96b)

* logging.c:

  sys/errno -> errno
  [[d68094514]](https://git.sudo.ws/sudo/commit/?id=d68094514)

1998-09-24 Todd C. Miller

* sudo.c:

  UMASK -> SUDO\_UMASK.
  [[9d6cd6f21]](https://git.sudo.ws/sudo/commit/?id=9d6cd6f21)

* check.c, logging.c:

  time.h, not sys/time.h
  [[4c0e6f882]](https://git.sudo.ws/sudo/commit/?id=4c0e6f882)

1998-09-21 Todd C. Miller

* logging.c:

  MAILER -> \_PATH\_SENDMAIL
  [[8450ad080]](https://git.sudo.ws/sudo/commit/?id=8450ad080)

* INSTALL, configure.in:

  no more –with-C2, now it is –disable-shadow
  [[d3d704681]](https://git.sudo.ws/sudo/commit/?id=d3d704681)

* aclocal.m4, check.c, compat.h, config.h.in, configure.in, getspwuid.c,
  sudo.c, tgetpass.c:

  new shadow password scheme. Always include shadow support if the
  platform supports it and the user did not disable it via configure
  [[1c66c857e]](https://git.sudo.ws/sudo/commit/?id=1c66c857e)

1998-09-20 Todd C. Miller

* configure.in:

  –with-getpass -> –{enable,disable}-tgetpass
  [[2de38e16c]](https://git.sudo.ws/sudo/commit/?id=2de38e16c)

* Makefile.in:

  pathnames.h -> pathnames.h.in
  [[f82c3563e]](https://git.sudo.ws/sudo/commit/?id=f82c3563e)

* check.c:

  fix version string
  [[8f69024cc]](https://git.sudo.ws/sudo/commit/?id=8f69024cc)

* check.c:

  move pam\_conv to be static to auth function remove pam\_misc.h (solaris
  doesn’t have one)
  [[80c1c8dcb]](https://git.sudo.ws/sudo/commit/?id=80c1c8dcb)

* aclocal.m4:

  *CONFIG\_PATH*\* -> *PATH*\* or *PATH\_SUDO*\* kill SUDO\_PROG\_PWD
  [[b8c4ae71a]](https://git.sudo.ws/sudo/commit/?id=b8c4ae71a)

* configure.in:

  munge pathnames.h.in -> pathnames.h kill SUDO\_PROG\_PWD
  [[1e70f549c]](https://git.sudo.ws/sudo/commit/?id=1e70f549c)

* pathnames.h.in:

  convert to pathnames.h.in
  [[699272e31]](https://git.sudo.ws/sudo/commit/?id=699272e31)

1998-09-19 Todd C. Miller

* configure.in:

  fix typo in sysv4 matching case /.
  [[7266c9f0e]](https://git.sudo.ws/sudo/commit/?id=7266c9f0e)

1998-09-18 Todd C. Miller

* check.c:

  pam stuff needs to run as root, not user, for shadow passwords
  [[8d906459d]](https://git.sudo.ws/sudo/commit/?id=8d906459d)

1998-09-17 Todd C. Miller

* BUGS, INSTALL, README, configure.in:

  updated version
  [[d257d37b5]](https://git.sudo.ws/sudo/commit/?id=d257d37b5)

* Makefile.in, check.c, compat.h, config.h.in, dce\_pwent.c, emul/utime.h,
  find\_path.c, getspwuid.c, goodpath.c, ins\_2001.h, ins\_classic.h,
  ins\_csops.h, ins\_goons.h, insults.h, interfaces.c, logging.c, options.h,
  parse.c, parse.lex, parse.yacc, pathnames.h.in, putenv.c, strdup.c,
  sudo.c, sudo.h, sudo\_setenv.c, testsudoers.c, tgetpass.c, utime.c,
  visudo.c:

  updated version
  [[0ef9f25d7]](https://git.sudo.ws/sudo/commit/?id=0ef9f25d7)

* check.c:

  user version.h for long message
  [[932624d6a]](https://git.sudo.ws/sudo/commit/?id=932624d6a)

* check.c:

  this is version 1.5.6
  [[286aa8f83]](https://git.sudo.ws/sudo/commit/?id=286aa8f83)

1998-09-16 Todd C. Miller

* Makefile.in:

  remove errant backslash
  [[cc449d186]](https://git.sudo.ws/sudo/commit/?id=cc449d186)

1998-09-15 Todd C. Miller

* options.h, parse.yacc, pathnames.h.in:

  fix version string
  [[3dd98aef6]](https://git.sudo.ws/sudo/commit/?id=3dd98aef6)

* BUGS, CHANGES, TODO:

  updtaed for 1.5.6
  [[e46758789]](https://git.sudo.ws/sudo/commit/?id=e46758789)

* RUNSON:

  updated for 1.5.6
  [[b9933f615]](https://git.sudo.ws/sudo/commit/?id=b9933f615)

1998-09-14 Todd C. Miller

* interfaces.c:

  kill unused localhost\_mask var copy if name to ifr\_tmp after we zero it
  [[8021b8cb8]](https://git.sudo.ws/sudo/commit/?id=8021b8cb8)

1998-09-13 Todd C. Miller

* INSTALL:

  Better description of new vs. old sudoers modes fix some typos better
  description of /usr/ucb/cc gotchas on slowaris
  [[9f3d9e122]](https://git.sudo.ws/sudo/commit/?id=9f3d9e122)

* Makefile.in:

  add sample.pam
  [[d4272a1b2]](https://git.sudo.ws/sudo/commit/?id=d4272a1b2)

* sudo.c:

  set NewArgv[0] to user\_shell, not basename(user\_shell)
  [[6ded52e06]](https://git.sudo.ws/sudo/commit/?id=6ded52e06)

1998-09-12 Todd C. Miller

* README:

  mention TROUBLESHOOTING more fix some typos
  [[68d062c37]](https://git.sudo.ws/sudo/commit/?id=68d062c37)

* configure.in:

  move –enable/–disable to be after –with
  [[eacb84a5f]](https://git.sudo.ws/sudo/commit/?id=eacb84a5f)

* INSTALL:

  document –enable/–disable
  [[50a5047e3]](https://git.sudo.ws/sudo/commit/?id=50a5047e3)

* INSTALL:

  document –with-pam
  [[2b9b3b75b]](https://git.sudo.ws/sudo/commit/?id=2b9b3b75b)

1998-09-11 Todd C. Miller

* configure.in:

  Add message for pam users
  [[6b213a75c]](https://git.sudo.ws/sudo/commit/?id=6b213a75c)

* sample.pam:

  Initial revision
  [[06bff7d2c]](https://git.sudo.ws/sudo/commit/?id=06bff7d2c)

* config.h.in:

  fix HAVE\_PAM
  [[60c2ab2b5]](https://git.sudo.ws/sudo/commit/?id=60c2ab2b5)

* check.c, config.h.in, configure.in:

  pam support, from Gary Calvin <GCalvin@…>
  [[218e76a05]](https://git.sudo.ws/sudo/commit/?id=218e76a05)

1998-09-10 Todd C. Miller

* config.h.in:

  add HOST\_IN\_LOG and WRAP\_LOG
  [[50411d770]](https://git.sudo.ws/sudo/commit/?id=50411d770)

* logging.c:

  add WRAP\_LOG and HOST\_IN\_LOG
  [[f9d20e875]](https://git.sudo.ws/sudo/commit/?id=f9d20e875)

* configure.in:

  add –enable-log-host and –enable-log-wrap
  [[9c725b503]](https://git.sudo.ws/sudo/commit/?id=9c725b503)

* aclocal.m4:

  use AC\_DEFINE\_UNQUOTED for –with-logfile and –with-timedir
  [[8508d5f04]](https://git.sudo.ws/sudo/commit/?id=8508d5f04)

1998-09-09 Todd C. Miller

* compat.h:

  add howmany macro
  [[6465c5eb4]](https://git.sudo.ws/sudo/commit/?id=6465c5eb4)

* tgetpass.c:

  include sys/param.h to get howmany macro
  [[0c54ebc58]](https://git.sudo.ws/sudo/commit/?id=0c54ebc58)

1998-09-08 Todd C. Miller

* OPTIONS, options.h, parse.yacc, sudo.c, testsudoers.c, visudo.c:

  add RUNAS\_DEFAULT
  [[e68f156ac]](https://git.sudo.ws/sudo/commit/?id=e68f156ac)

1998-09-07 Todd C. Miller

* fnmatch.c:

  bring in stdio.h for NULL
  [[fd94f14a1]](https://git.sudo.ws/sudo/commit/?id=fd94f14a1)

* aclocal.m4:

  allow /bin/{ksh,bach} and /usr/bin/{ksh,bash} as sh
  [[3f029f608]](https://git.sudo.ws/sudo/commit/?id=3f029f608)

* sudo.c:

  use HAVE\_SET\_AUTH\_PARAMETERS
  [[2e6a9074e]](https://git.sudo.ws/sudo/commit/?id=2e6a9074e)

* config.h.in:

  add HAVE\_SET\_AUTH\_PARAMETERS
  [[ccb78e265]](https://git.sudo.ws/sudo/commit/?id=ccb78e265)

* configure.in:

  add *-*-hiuxmpp\* add test for set\_auth\_parameters() if secureware
  [[48940fc5a]](https://git.sudo.ws/sudo/commit/?id=48940fc5a)

* config.sub:

  add support for HI-UX/MPP SR220001 02-03 0 SR2201
  [[fc8053beb]](https://git.sudo.ws/sudo/commit/?id=fc8053beb)

* interfaces.c:

  initialize previfname
  [[d228cff31]](https://git.sudo.ws/sudo/commit/?id=d228cff31)

* interfaces.c:

  Don’t use SIOCGIFADDR, we don’t need it Use SIOCGIFFLAGS if we have it
  check ifr\_flags against IFF\_UP and IFF\_LOOPBACK instead of kludging it
  [[65de4eeb7]](https://git.sudo.ws/sudo/commit/?id=65de4eeb7)

* configure.in:

  typo
  [[57a7e0057]](https://git.sudo.ws/sudo/commit/?id=57a7e0057)

* Makefile.in:

  don’t need special build line for sudo.tab.o
  [[fa0936547]](https://git.sudo.ws/sudo/commit/?id=fa0936547)

* Makefile.in:

  don’t clean sudo.tab.[ch]
  [[d9d0fe1d5]](https://git.sudo.ws/sudo/commit/?id=d9d0fe1d5)

* sudo.c:

  Sudo should prompt for a password before telling the user that a command
  could not be found.
  [[ca0a28b03]](https://git.sudo.ws/sudo/commit/?id=ca0a28b03)

* BUGS:

  for 1.5.6
  [[5eac2b72c]](https://git.sudo.ws/sudo/commit/?id=5eac2b72c)

* INSTALL, README:

  no longer require yacc
  [[5f20cb4a5]](https://git.sudo.ws/sudo/commit/?id=5f20cb4a5)

* Makefile.in:

  typo
  [[45e7634e9]](https://git.sudo.ws/sudo/commit/?id=45e7634e9)

* Makefile.in:

  y.tab -> sudo.tab include pre-yacc’d parse.yacc
  [[10fd92bb9]](https://git.sudo.ws/sudo/commit/?id=10fd92bb9)

* parse.lex:

  include sudo.tab.h, not y.tab.h don’t break out of command args if you
  get a ‘=’
  [[e1a6b1fec]](https://git.sudo.ws/sudo/commit/?id=e1a6b1fec)

* insults.h:

  fix version ,
  [[0643cd950]](https://git.sudo.ws/sudo/commit/?id=0643cd950)

* ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h:

  fix version
  [[00861546a]](https://git.sudo.ws/sudo/commit/?id=00861546a)

* compat.h:

  fix version
  [[f56bd7754]](https://git.sudo.ws/sudo/commit/?id=f56bd7754)

* getcwd.c:

  getcwd(3) from OpenBSD for those without it.
  [[39a719159]](https://git.sudo.ws/sudo/commit/?id=39a719159)

* sudo.h:

  HAVE\_GETWD -> HAVE\_GETCWD
  [[0c040bfc5]](https://git.sudo.ws/sudo/commit/?id=0c040bfc5)

* configure.in:

  pretend sunos doesn’t have getcwd(3) since it opens a pipe to getpwd!
  [[6dc57e6ea]](https://git.sudo.ws/sudo/commit/?id=6dc57e6ea)

* parse.c:

  use NAMLEN() macro
  [[a1c5148c3]](https://git.sudo.ws/sudo/commit/?id=a1c5148c3)

* fnmatch.c:

  remove duplicate include of string.h
  [[e7a1cc6b6]](https://git.sudo.ws/sudo/commit/?id=e7a1cc6b6)

* configure.in:

  call SUDO\_TYPE\_DEV\_T and SUDO\_TYPE\_INO\_T
  [[1aa92f833]](https://git.sudo.ws/sudo/commit/?id=1aa92f833)

* aclocal.m4:

  add SUDO\_TYPE\_DEV\_T and SUDO\_TYPE\_INO\_T
  [[856a70de8]](https://git.sudo.ws/sudo/commit/?id=856a70de8)

* config.h.in:

  add dev\_t and ino\_t
  [[15c6fea6d]](https://git.sudo.ws/sudo/commit/?id=15c6fea6d)

1998-07-28 Todd C. Miller

* check.c:

  fix OTP\_ONLY for opie
  [[1d26f2699]](https://git.sudo.ws/sudo/commit/?id=1d26f2699)

1998-06-24 Todd C. Miller

* testsudoers.c, tgetpass.c:

  include stdlib.h for malloc proto
  [[2b2b9eb8e]](https://git.sudo.ws/sudo/commit/?id=2b2b9eb8e)

1998-05-19 Todd C. Miller

* Makefile.in:

  make update\_version saner
  [[30a451818]](https://git.sudo.ws/sudo/commit/?id=30a451818)

* config.h.in:

  add HAVE\_WAITPID, HAVE\_WAIT3, and sudo\_waitpid()
  [[59214c317]](https://git.sudo.ws/sudo/commit/?id=59214c317)

* configure.in:

  check for waitpid and wait3 or no waitpid
  [[a168f9c59]](https://git.sudo.ws/sudo/commit/?id=a168f9c59)

* logging.c:

  used waitpid or wait3 if we have ’em
  [[df4b885d1]](https://git.sudo.ws/sudo/commit/?id=df4b885d1)

1998-05-02 Todd C. Miller

* visudo.c:

  fix some fprintf args, ariel@… (Ariel Faigon)
  [[ae7a8f497]](https://git.sudo.ws/sudo/commit/?id=ae7a8f497)

1998-04-28 Todd C. Miller

* configure.in:

  don’t need to explicately mention -lsocket -lnsl for sequent
  [[5723320dc]](https://git.sudo.ws/sudo/commit/?id=5723320dc)

1998-04-25 Todd C. Miller

* configure.in:

  dynix should not link with -linet
  [[29a1672a8]](https://git.sudo.ws/sudo/commit/?id=29a1672a8)

1998-04-10 Todd C. Miller

* INSTALL:

  mention that HP-UX doesn’t ship with yacc
  [[2dd0d5e14]](https://git.sudo.ws/sudo/commit/?id=2dd0d5e14)

1998-04-07 Todd C. Miller

* check.c:

  ignore kerberos if we can’t get the local realm
  [[ac5c39884]](https://git.sudo.ws/sudo/commit/?id=ac5c39884)

1998-04-06 Todd C. Miller

* BUGS, INSTALL, README, configure.in:

  ++version
  [[69cd51691]](https://git.sudo.ws/sudo/commit/?id=69cd51691)

* version.h:

  ++
  [[fa85e6fe1]](https://git.sudo.ws/sudo/commit/?id=fa85e6fe1)

* Makefile.in, check.c, config.h.in, dce\_pwent.c, emul/utime.h,
  find\_path.c, getcwd.c, getspwuid.c, goodpath.c, interfaces.c, logging.c,
  parse.c, parse.lex, putenv.c, strdup.c, sudo.c, sudo.h, sudo\_setenv.c,
  testsudoers.c, tgetpass.c, utime.c, visudo.c:

  updated version
  [[12477fd6e]](https://git.sudo.ws/sudo/commit/?id=12477fd6e)

* check.c, sudo.h:

  fix version
  [[36ef6aa48]](https://git.sudo.ws/sudo/commit/?id=36ef6aa48)

* getcwd.c:

  don’t use popen/pclose. Do it inline.
  [[1014adbe0]](https://git.sudo.ws/sudo/commit/?id=1014adbe0)

* lsearch.c:

  add rcsid
  [[09bb1a3bf]](https://git.sudo.ws/sudo/commit/?id=09bb1a3bf)

* sudo.c:

  typo
  [[7f4e5240c]](https://git.sudo.ws/sudo/commit/?id=7f4e5240c)

* check.c, compat.h, ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h,
  insults.h, options.h, parse.yacc, pathnames.h.in, sudo.h:

  updated version
  [[3b1be424a]](https://git.sudo.ws/sudo/commit/?id=3b1be424a)

* check.c, find\_path.c, parse.c, sudo.c, testsudoers.c:

  MAX\* + 1 -> MAX\*
  [[c27d678ff]](https://git.sudo.ws/sudo/commit/?id=c27d678ff)

* Makefile.in:

  getwd.c -> getcwd.c
  [[96d7c5970]](https://git.sudo.ws/sudo/commit/?id=96d7c5970)

* config.h.in:

  kill HAVE\_GETWD
  [[a5b490a9d]](https://git.sudo.ws/sudo/commit/?id=a5b490a9d)

* configure.in:

  getcwd, not getwd
  [[2a4fbbdad]](https://git.sudo.ws/sudo/commit/?id=2a4fbbdad)

* getcwd.c:

  use MAX\* not MAX\* + 1 always run pwd as using getwd() defeats the
  purpose
  [[8832e50f4]](https://git.sudo.ws/sudo/commit/?id=8832e50f4)

1998-03-31 Todd C. Miller

* OPTIONS, options.h:

  add STUB\_LOAD\_INTERFACES
  [[fa270d375]](https://git.sudo.ws/sudo/commit/?id=fa270d375)

* Makefile.in, check.c, compat.h, config.h.in, dce\_pwent.c, emul/utime.h,
  find\_path.c, getspwuid.c, getwd.c, goodpath.c, ins\_2001.h,
  ins\_classic.h, ins\_csops.h, ins\_goons.h, insults.h, interfaces.c,
  logging.c, options.h, parse.c, parse.lex, parse.yacc, pathnames.h.in,
  putenv.c, strdup.c, sudo.c, sudo.h, sudo\_setenv.c, testsudoers.c,
  tgetpass.c, utime.c, visudo.c:

  updated version
  [[e37e1e56b]](https://git.sudo.ws/sudo/commit/?id=e37e1e56b)

* configure.in:

  support \*-ccur-sysv4 and fix two typos
  [[bcae83c5b]](https://git.sudo.ws/sudo/commit/?id=bcae83c5b)

1998-03-28 Todd C. Miller

* configure.in:

  don’t echo about with\_logfile and with\_timedir
  [[cf7b77a03]](https://git.sudo.ws/sudo/commit/?id=cf7b77a03)

* INSTALL:

  document –with-logfile and –with-timedir
  [[73fa35c6a]](https://git.sudo.ws/sudo/commit/?id=73fa35c6a)

* aclocal.m4:

  support –with-logfile and –with-timedir
  [[ceb7a9bdf]](https://git.sudo.ws/sudo/commit/?id=ceb7a9bdf)

* configure.in:

  Add –with-logfile and –with-timedir
  [[56b156583]](https://git.sudo.ws/sudo/commit/?id=56b156583)

* sudo.c:

  change size computation of NewArgv for UNICOS
  [[533fbe071]](https://git.sudo.ws/sudo/commit/?id=533fbe071)

1998-02-19 Todd C. Miller

* configure.in:

  treate -*-sysv4* like *-*-svr4
  [[fcc46c02f]](https://git.sudo.ws/sudo/commit/?id=fcc46c02f)

1998-02-18 Todd C. Miller

* configure.in:

  fix spacing for –with-authenticate help
  [[822e075e1]](https://git.sudo.ws/sudo/commit/?id=822e075e1)

* Makefile.in, check.c, compat.h, config.h.in, dce\_pwent.c, emul/utime.h,
  find\_path.c, getspwuid.c, getwd.c, goodpath.c, ins\_2001.h,
  ins\_classic.h, ins\_csops.h, ins\_goons.h, insults.h, interfaces.c,
  logging.c, options.h, parse.c, parse.lex, parse.yacc, pathnames.h.in,
  putenv.c, strdup.c, sudo.c, sudo.h, sudo\_setenv.c, testsudoers.c,
  tgetpass.c, utime.c, visudo.c:

  updated version
  [[c866646cd]](https://git.sudo.ws/sudo/commit/?id=c866646cd)

* parse.yacc:

  fix off by one error in push macro
  [[14292f47c]](https://git.sudo.ws/sudo/commit/?id=14292f47c)

1998-02-17 Todd C. Miller

* configure.in:

  removed bogus alloca hack
  [[797a152c6]](https://git.sudo.ws/sudo/commit/?id=797a152c6)

* check.c:

  added AIX 4.x authenticate() support
  [[73e984f39]](https://git.sudo.ws/sudo/commit/?id=73e984f39)

* parse.yacc:

  include alloca.h if using bison and not gcc and it exists. fixes an
  alloca problem on hpux 10.x
  [[cd226d56c]](https://git.sudo.ws/sudo/commit/?id=cd226d56c)

* INSTALL:

  mention –with-authenticate
  [[3b9b17cd5]](https://git.sudo.ws/sudo/commit/?id=3b9b17cd5)

* configure.in:

  added AIX authenticate() support
  [[0111f5efc]](https://git.sudo.ws/sudo/commit/?id=0111f5efc)

* config.h.in:

  add HAVE\_AUTHENTICATE
  [[3ba4c7b26]](https://git.sudo.ws/sudo/commit/?id=3ba4c7b26)

* interfaces.c:

  dynamically size ifconf buffer
  [[9719fa21b]](https://git.sudo.ws/sudo/commit/?id=9719fa21b)

* configure.in:

  quote ‘[’ and ‘]’
  [[12627050d]](https://git.sudo.ws/sudo/commit/?id=12627050d)

* Makefile.in, check.c, compat.h, config.h.in, dce\_pwent.c, emul/utime.h,
  find\_path.c, getspwuid.c, getwd.c, goodpath.c, ins\_2001.h,
  ins\_classic.h, ins\_csops.h, ins\_goons.h, insults.h, logging.c,
  options.h, parse.c, parse.lex, parse.yacc, pathnames.h.in, putenv.c,
  strdup.c, sudo.c, sudo.h, sudo\_setenv.c, testsudoers.c, tgetpass.c,
  utime.c, visudo.c:

  updated version
  [[2fc787d5f]](https://git.sudo.ws/sudo/commit/?id=2fc787d5f)

* visudo.pod:

  add ERRORS section
  [[0bf1342c1]](https://git.sudo.ws/sudo/commit/?id=0bf1342c1)

1998-02-16 Todd C. Miller

* TROUBLESHOOTING:

  add busy stmp file explanation
  [[2c18a14bd]](https://git.sudo.ws/sudo/commit/?id=2c18a14bd)

1998-02-15 Todd C. Miller

* configure.in:

  the name of the cached var that signals whether or not you are cross
  compiling changed. It is now ac\_cv\_prog\_cc\_cross
  [[686c50ad3]](https://git.sudo.ws/sudo/commit/?id=686c50ad3)

1998-02-11 Todd C. Miller

* INSTALL:

  mention glibc 2.07 is fixed wrt lsearch().
  [[6ffcfb752]](https://git.sudo.ws/sudo/commit/?id=6ffcfb752)

1998-02-07 Todd C. Miller

* sample.sudoers, sudoers.pod:

  better example of su but not root su
  [[a58e3f4b1]](https://git.sudo.ws/sudo/commit/?id=a58e3f4b1)

1998-02-06 Todd C. Miller

* Makefile.in, check.c, compat.h, config.h.in, dce\_pwent.c, emul/utime.h,
  find\_path.c, getspwuid.c, getwd.c, goodpath.c, ins\_2001.h,
  ins\_classic.h, ins\_csops.h, ins\_goons.h, insults.h, interfaces.c,
  logging.c, options.h, parse.c, parse.lex, parse.yacc, pathnames.h.in,
  putenv.c, strdup.c, sudo.c, sudo.h, sudo\_setenv.c, testsudoers.c,
  tgetpass.c, utime.c, visudo.c:

  updated version
  [[bc7803cd0]](https://git.sudo.ws/sudo/commit/?id=bc7803cd0)

* Makefile.in:

  correct regexp for updating version
  [[e843aa9af]](https://git.sudo.ws/sudo/commit/?id=e843aa9af)

* tgetpass.c:

  remove bogus flush of stderr spew prompt before turning off echo. Seems
  to fix a weird problem where if sudo complained about a bogus stamp file
  the user would sometimes not have a chance to enter a password
  [[9cc65287f]](https://git.sudo.ws/sudo/commit/?id=9cc65287f)

* check.c:

  fix bogus flush of stderr
  [[b4c1c9190]](https://git.sudo.ws/sudo/commit/?id=b4c1c9190)

* sudo.c:

  close fd’s <=2 not <=3 and move that chunk of code up
  [[25ed56fba]](https://git.sudo.ws/sudo/commit/?id=25ed56fba)

* configure.in:

  support hpux1[0-9] not just hpux10
  [[c8b7a421b]](https://git.sudo.ws/sudo/commit/?id=c8b7a421b)

1998-01-30 Todd C. Miller

* parse.c:

  set sudoers\_fp to nil after closing
  [[3e52d3a11]](https://git.sudo.ws/sudo/commit/?id=3e52d3a11)

1998-01-24 Todd C. Miller

* config.guess, config.sub:

  updated from autoconf 2.12
  [[ce5895467]](https://git.sudo.ws/sudo/commit/?id=ce5895467)

* configure.in:

  add *-*-svr4 rule
  [[48aeb59d0]](https://git.sudo.ws/sudo/commit/?id=48aeb59d0)

1998-01-23 Todd C. Miller

* tgetpass.c:

  fix select usage for high fd’s (dynamically allocate readfds)
  [[0e8cf35a7]](https://git.sudo.ws/sudo/commit/?id=0e8cf35a7)

* check.c:

  kill extra whitespace
  [[7baad7a52]](https://git.sudo.ws/sudo/commit/?id=7baad7a52)

* sudo.c:

  do an initgroups() before running a command, unless the target user is
  root.
  [[7d5c340f9]](https://git.sudo.ws/sudo/commit/?id=7d5c340f9)

1998-01-22 Todd C. Miller

* TROUBLESHOOTING:

  tell people to use tabs, not spaces, in syslog.conf
  [[b51df9a11]](https://git.sudo.ws/sudo/commit/?id=b51df9a11)

1998-01-21 Todd C. Miller

* Makefile.in, config.h.in, dce\_pwent.c, emul/utime.h, getwd.c, parse.lex,
  putenv.c, strdup.c, testsudoers.c, utime.c:

  updated version
  [[efbcdfe82]](https://git.sudo.ws/sudo/commit/?id=efbcdfe82)

* check.c, find\_path.c, getspwuid.c, goodpath.c, interfaces.c, logging.c,
  parse.c, sudo.c, sudo\_setenv.c, tgetpass.c, visudo.c:

  updated version
  [[0c362fb21]](https://git.sudo.ws/sudo/commit/?id=0c362fb21)

* compat.h, ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h,
  insults.h, options.h, parse.yacc, pathnames.h.in, sudo.h:

  updated version
  [[ca5babc43]](https://git.sudo.ws/sudo/commit/?id=ca5babc43)

* Makefile.in:

  more tweaks to update\_version
  [[a3e801b5c]](https://git.sudo.ws/sudo/commit/?id=a3e801b5c)

* Makefile.in:

  fixed up update\_version rule
  [[ab0c4bd97]](https://git.sudo.ws/sudo/commit/?id=ab0c4bd97)

* configure.in:

  ++version
  [[8dfd58be3]](https://git.sudo.ws/sudo/commit/?id=8dfd58be3)

* Makefile.in:

  removed supe of check.c
  [[9032779ac]](https://git.sudo.ws/sudo/commit/?id=9032779ac)

* INSTALL:

  ++version I missed
  [[96c8ab7a1]](https://git.sudo.ws/sudo/commit/?id=96c8ab7a1)

* RUNSON:

  updated
  [[59366d1b5]](https://git.sudo.ws/sudo/commit/?id=59366d1b5)

* BUGS, INSTALL, Makefile.in, README, check.c, compat.h, config.h.in,
  dce\_pwent.c, emul/utime.h, find\_path.c, getspwuid.c, getwd.c,
  goodpath.c, ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h,
  insults.h, interfaces.c, logging.c, options.h, parse.c, parse.lex,
  parse.yacc, pathnames.h.in, putenv.c, strdup.c, sudo.c, sudo.h,
  sudo\_setenv.c, testsudoers.c, tgetpass.c, utime.c, version.h, visudo.c:

  updated version
  [[bb6a33e08]](https://git.sudo.ws/sudo/commit/?id=bb6a33e08)

* CHANGES:

  updated for 1.5.5
  [[82bf12933]](https://git.sudo.ws/sudo/commit/?id=82bf12933)

* Makefile.in:

  add rules to update version stuff in files so I don’t need to do it by
  hand
  [[d89923705]](https://git.sudo.ws/sudo/commit/?id=d89923705)

* sudo.h:

  sudoers\_fp is now extern
  [[acea5f29e]](https://git.sudo.ws/sudo/commit/?id=acea5f29e)

* sudo.c:

  in check\_sudoers, cache the sudoers file handle in sudoers\_fp so we
  don’t have to open it again in the parse. This may help with weird
  solaris problems where EAGAIN sometime occurrs.
  [[8de870a70]](https://git.sudo.ws/sudo/commit/?id=8de870a70)

* parse.c:

  sudoers file open is now done only in check\_sudoers() so we just do a
  rewind() instead of an open. May help people on solaris who were getting
  EAGAIN.
  [[cae4b9d3e]](https://git.sudo.ws/sudo/commit/?id=cae4b9d3e)

1998-01-16 Todd C. Miller

* INSTALL:

  mention that newer glibc is fixed
  [[859e6d86e]](https://git.sudo.ws/sudo/commit/?id=859e6d86e)

1998-01-13 Todd C. Miller

* sudo.c:

  newer irix uses *RLDN32*\* envariables for 32-bit binaries so ignore
  \_RLD\* instead of *RLD*\*
  [[7b3bc67b0]](https://git.sudo.ws/sudo/commit/?id=7b3bc67b0)

* parse.c:

  typo
  [[652393318]](https://git.sudo.ws/sudo/commit/?id=652393318)

* parse.c:

  fix that bug for real
  [[6a2b6895f]](https://git.sudo.ws/sudo/commit/?id=6a2b6895f)

* INSTALL:

  document Linux’s libc6 brokenness.
  [[46a2f512f]](https://git.sudo.ws/sudo/commit/?id=46a2f512f)

* parse.yacc:

  -Wall
  [[dd18f0def]](https://git.sudo.ws/sudo/commit/?id=dd18f0def)

* RUNSON:

  updated
  [[c627b8d2b]](https://git.sudo.ws/sudo/commit/?id=c627b8d2b)

* TROUBLESHOOTING:

  remind people to HUP syslogd
  [[e3b90fe98]](https://git.sudo.ws/sudo/commit/?id=e3b90fe98)

* Makefile.in:

  add -O flag to tar
  [[df6c6d30b]](https://git.sudo.ws/sudo/commit/?id=df6c6d30b)

* RUNSON:

  updated
  [[fe5b5de20]](https://git.sudo.ws/sudo/commit/?id=fe5b5de20)

* TODO:

  updated
  [[b93a31eda]](https://git.sudo.ws/sudo/commit/?id=b93a31eda)

* sudo.pod:

  remove author’s email addr. people should mail sudo-bugs
  [[a703659c3]](https://git.sudo.ws/sudo/commit/?id=a703659c3)

* INSTALL:

  fix version
  [[994d39953]](https://git.sudo.ws/sudo/commit/?id=994d39953)

* README, check.c, compat.h, config.h.in, configure.in, dce\_pwent.c,
  find\_path.c, getspwuid.c, getwd.c, goodpath.c, ins\_2001.h,
  ins\_classic.h, ins\_csops.h, ins\_goons.h, insults.h, interfaces.c,
  logging.c, options.h, parse.c, parse.lex, parse.yacc, pathnames.h.in,
  putenv.c, strdup.c, sudo.c, sudo.h, sudo\_setenv.c, testsudoers.c,
  tgetpass.c, utime.c, version.h, visudo.c:

  ++version
  [[166789a1d]](https://git.sudo.ws/sudo/commit/?id=166789a1d)

* RUNSON:

  updated
  [[3068ee535]](https://git.sudo.ws/sudo/commit/?id=3068ee535)

* INSTALL, Makefile.in:

  ++version
  [[b1d52793c]](https://git.sudo.ws/sudo/commit/?id=b1d52793c)

* CHANGES:

  updated fort 1.5.4
  [[1c5372b88]](https://git.sudo.ws/sudo/commit/?id=1c5372b88)

* check.c:

  exit(1) if user enters no passwd
  [[a74348f17]](https://git.sudo.ws/sudo/commit/?id=a74348f17)

* BUGS:

  ++version
  [[9b05743b6]](https://git.sudo.ws/sudo/commit/?id=9b05743b6)

* parse.c:

  commands can start with ./\* not just /\* – fixes a serious security
  hole.
  [[ab9b35245]](https://git.sudo.ws/sudo/commit/?id=ab9b35245)

1997-12-21 Todd C. Miller

* sudo.c:

  Don’t set the tty variable to NULL when we lack a tty, leave it as
  “unknown”.
  [[07e09b16f]](https://git.sudo.ws/sudo/commit/?id=07e09b16f)

1997-11-23 Todd C. Miller

* sample.sudoers:

  fix usage of (username) in conjunction with , and !
  [[687434bc9]](https://git.sudo.ws/sudo/commit/?id=687434bc9)

* visudo.c:

  catch the case where the user is not in the passwd file
  [[82654611c]](https://git.sudo.ws/sudo/commit/?id=82654611c)

* tgetpass.c:

  use fileno(input) + 1 instead of getdtablesize() as the nfds arg to
  select(2)
  [[ea498e61d]](https://git.sudo.ws/sudo/commit/?id=ea498e61d)

* sudo.c:

  define tty global to an initial value to avoid dumping core in logging
  functions when passwd file is unavailable.
  [[4b4e2b792]](https://git.sudo.ws/sudo/commit/?id=4b4e2b792)

* sudo.c:

  do the set\_perms(PERM\_USER, sudo\_mode) after we have gotten the passwd
  entry
  [[ff05eaccf]](https://git.sudo.ws/sudo/commit/?id=ff05eaccf)

* sudo.pod:

  talk about problem of ALL
  [[52fb34f92]](https://git.sudo.ws/sudo/commit/?id=52fb34f92)

1997-10-10 Todd C. Miller

* README:

  new web location
  [[c035f8e80]](https://git.sudo.ws/sudo/commit/?id=c035f8e80)

* INSTALL:

  fdesc bug is fixed in Open/Net BSD
  [[ad6df9f51]](https://git.sudo.ws/sudo/commit/?id=ad6df9f51)

* HISTORY:

  updates from Nieusma
  [[ce0fc8333]](https://git.sudo.ws/sudo/commit/?id=ce0fc8333)

1997-10-09 Todd C. Miller

* dce\_pwent.c:

  move compat.h after the system includes
  [[671e941d5]](https://git.sudo.ws/sudo/commit/?id=671e941d5)

1997-08-06 Todd C. Miller

* logging.c:

  save errno from being clobbered by wait(). From Theo
  [[b5f54d774]](https://git.sudo.ws/sudo/commit/?id=b5f54d774)

1997-05-21 Todd C. Miller

* compat.h:

  fix an occurence of setresuid -> setreuid (typo)
  [[8b28002ef]](https://git.sudo.ws/sudo/commit/?id=8b28002ef)

1997-03-19 Todd C. Miller

* install-sh:

  check for path to strip
  [[abeaf9523]](https://git.sudo.ws/sudo/commit/?id=abeaf9523)

1997-01-16 Todd C. Miller

* logging.c:

  deal with maxfilelen < 0 case
  [[0caa3cc55]](https://git.sudo.ws/sudo/commit/?id=0caa3cc55)

* OPTIONS:

  fixed descriptin
  [[f842ab526]](https://git.sudo.ws/sudo/commit/?id=f842ab526)

1996-12-12 Todd C. Miller

* sudo.c:

  correct error message if mode/owner wrong and not statable by owner but
  is statable by root.
  [[b0192afc3]](https://git.sudo.ws/sudo/commit/?id=b0192afc3)

1996-11-23 Todd C. Miller

* config.guess, config.sub:

  autoconf 2.11
  [[294b7f496]](https://git.sudo.ws/sudo/commit/?id=294b7f496)

1996-11-16 Todd C. Miller

* CHANGES, RUNSON, TODO:

  sudo 1.5.3.
  [[a36ba7b5c]](https://git.sudo.ws/sudo/commit/?id=a36ba7b5c)

1996-11-14 Todd C. Miller

* parse.yacc, sudo.h:

  command\_alias -> generic\_alias
  [[23b2719a3]](https://git.sudo.ws/sudo/commit/?id=23b2719a3)

* sample.sudoers:

  added Runas\_Alias example and fixed syntax errors
  [[33f9387f3]](https://git.sudo.ws/sudo/commit/?id=33f9387f3)

* OPTIONS, options.h:

  updated MAILSUBJECT
  [[e5b84ec22]](https://git.sudo.ws/sudo/commit/?id=e5b84ec22)

* logging.c:

  added %h expansion
  [[773ec24a3]](https://git.sudo.ws/sudo/commit/?id=773ec24a3)

* INSTALL, Makefile.in, README, check.c, compat.h, config.h.in,
  configure.in, dce\_pwent.c, find\_path.c, getspwuid.c, getwd.c,
  goodpath.c, ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h,
  insults.h, interfaces.c, logging.c, options.h, parse.c, parse.lex,
  parse.yacc, pathnames.h.in, putenv.c, strdup.c, sudo.c, sudo.h,
  sudo\_setenv.c, testsudoers.c, tgetpass.c, utime.c, version.h, visudo.c:

  ++version
  [[5e723efe7]](https://git.sudo.ws/sudo/commit/?id=5e723efe7)

* BUGS, emul/utime.h:

  ++version
  [[30da32917]](https://git.sudo.ws/sudo/commit/?id=30da32917)

* sudoers.pod:

  document Runas\_Alias
  [[ca6a440b9]](https://git.sudo.ws/sudo/commit/?id=ca6a440b9)

* visudo.pod:

  q (uid) -> Q
  [[f7a75a2a4]](https://git.sudo.ws/sudo/commit/?id=f7a75a2a4)

* visudo.c:

  buffer oflow checking q (uit) -> Q if yyparse() fails drop into whatnow
  [[75704661b]](https://git.sudo.ws/sudo/commit/?id=75704661b)

* parse.yacc:

  add size params to sprintf
  [[7e737b38e]](https://git.sudo.ws/sudo/commit/?id=7e737b38e)

* parse.lex:

  allow trailing space after ‘\’ but before ‘\n’
  [[156e7dbe2]](https://git.sudo.ws/sudo/commit/?id=156e7dbe2)

* find\_path.c:

  off by one error in path size check
  [[aa54c845e]](https://git.sudo.ws/sudo/commit/?id=aa54c845e)

* check.c:

  sprintf paranoia
  [[679876886]](https://git.sudo.ws/sudo/commit/?id=679876886)

1996-11-12 Todd C. Miller

* parse.yacc:

  fixed more\_aliases
  [[fcb212ea8]](https://git.sudo.ws/sudo/commit/?id=fcb212ea8)

* visudo.c:

  now warns if killed by signal ./
  [[df20cedfc]](https://git.sudo.ws/sudo/commit/?id=df20cedfc)

1996-11-11 Todd C. Miller

* parse.yacc:

  fix Runas\_Alias stuff Alias’s in runas list now get expanded (but it is
  gross)
  [[8336c86cb]](https://git.sudo.ws/sudo/commit/?id=8336c86cb)

* sudo.c:

  Can now deal with SUDOERS\_UID == 0 and SUDOERS\_MODE == 0400
  [[b317dc70a]](https://git.sudo.ws/sudo/commit/?id=b317dc70a)

* parse.yacc:

  add Runas\_Alias support change FOO to FOO\_ALIAS (ie: USER\_ALIAS)
  [[ec7e18737]](https://git.sudo.ws/sudo/commit/?id=ec7e18737)

* parse.lex:

  Add Runas\_Alias and simplify a rule.
  [[add3e8df2]](https://git.sudo.ws/sudo/commit/?id=add3e8df2)

* parse.yacc:

  always store User\_Alias’s since they can be used inside of a runas list.
  Sigh. Really need a Runas\_Alias instead.
  [[894ef0be7]](https://git.sudo.ws/sudo/commit/?id=894ef0be7)

1996-10-30 Todd C. Miller

* visudo.c:

  deal with case where there is no sudoers file
  [[4b6e45e63]](https://git.sudo.ws/sudo/commit/?id=4b6e45e63)

1996-10-12 Todd C. Miller

* TROUBLESHOOTING:

  added one
  [[6108f1b1a]](https://git.sudo.ws/sudo/commit/?id=6108f1b1a)

1996-10-11 Todd C. Miller

* HISTORY, testsudoers.c:

  developement -> development
  [[413f86907]](https://git.sudo.ws/sudo/commit/?id=413f86907)

* INSTALL:

  added a note
  [[e933c6679]](https://git.sudo.ws/sudo/commit/?id=e933c6679)

* RUNSON:

  for 1.5.2
  [[96baceed2]](https://git.sudo.ws/sudo/commit/?id=96baceed2)

* CHANGES:

  updated
  [[a5e9569ef]](https://git.sudo.ws/sudo/commit/?id=a5e9569ef)

1996-10-10 Todd C. Miller

* PORTING:

  removed seteuid() notes
  [[efd201c57]](https://git.sudo.ws/sudo/commit/?id=efd201c57)

1996-10-09 Todd C. Miller

* compat.h:

  better seteuid() emulatino
  [[873346d18]](https://git.sudo.ws/sudo/commit/?id=873346d18)

* configure.in:

  added check for seteuid
  [[c7a278dd9]](https://git.sudo.ws/sudo/commit/?id=c7a278dd9)

* config.h.in:

  added HAVE\_SETEUID
  [[142136af0]](https://git.sudo.ws/sudo/commit/?id=142136af0)

1996-10-08 Todd C. Miller

* configure.in:

  first stab at sequent support
  [[0032402ab]](https://git.sudo.ws/sudo/commit/?id=0032402ab)

* config.h.in:

  added HAVE\_SYS\_SELECT\_H
  [[fbb39c0ee]](https://git.sudo.ws/sudo/commit/?id=fbb39c0ee)

* compat.h:

  sequent -> *SEQUENT*
  [[9376a8cd8]](https://git.sudo.ws/sudo/commit/?id=9376a8cd8)

* compat.h:

  added seteuid() macro for DYNIX
  [[885cbad12]](https://git.sudo.ws/sudo/commit/?id=885cbad12)

* tgetpass.c:

  \_AIX -> HAVE\_SYS\_SELECT\_H
  [[67b0c8635]](https://git.sudo.ws/sudo/commit/?id=67b0c8635)

1996-10-07 Todd C. Miller

* BUGS, INSTALL, Makefile.in, OPTIONS, README, config.h.in, logging.c,
  parse.c, parse.lex, parse.yacc, putenv.c, strdup.c, sudo\_setenv.c,
  testsudoers.c, tgetpass.c, utime.c, visudo.c:

  ++version
  [[b0248f15d]](https://git.sudo.ws/sudo/commit/?id=b0248f15d)

* check.c, compat.h, dce\_pwent.c, emul/utime.h, find\_path.c, getspwuid.c,
  getwd.c, goodpath.c, ins\_2001.h, ins\_classic.h, ins\_csops.h,
  ins\_goons.h, insults.h, interfaces.c, options.h, pathnames.h.in,
  version.h:

  ++version
  [[e712f1152]](https://git.sudo.ws/sudo/commit/?id=e712f1152)

* sudo.pod:

  added -H and SUDO\_PS1
  [[0df08805e]](https://git.sudo.ws/sudo/commit/?id=0df08805e)

* configure.in:

  use SUDO\_FUNC\_FNMATCH
  [[2289375f2]](https://git.sudo.ws/sudo/commit/?id=2289375f2)

* aclocal.m4:

  added SUDO\_FUNC\_FNMATCH
  [[95389204f]](https://git.sudo.ws/sudo/commit/?id=95389204f)

* sudo.c:

  added -H flag
  [[f0379ffce]](https://git.sudo.ws/sudo/commit/?id=f0379ffce)

* sudo.h:

  added MODE\_RESET\_HOME /
  [[f59e97e49]](https://git.sudo.ws/sudo/commit/?id=f59e97e49)

1996-10-05 Todd C. Miller

* INSTALL:

  mention OPIE
  [[7dc02d05f]](https://git.sudo.ws/sudo/commit/?id=7dc02d05f)

* options.h:

  SKEY -> OTP
  [[ca99af41d]](https://git.sudo.ws/sudo/commit/?id=ca99af41d)

* configure.in:

  added opie support
  [[d4f1b26e7]](https://git.sudo.ws/sudo/commit/?id=d4f1b26e7)

* compat.h, config.h.in:

  added HAVE\_OPIE
  [[932ec901b]](https://git.sudo.ws/sudo/commit/?id=932ec901b)

* check.c:

  added HAVE\_OPIE and changed to **OTP**
  [[3ecf71cad]](https://git.sudo.ws/sudo/commit/?id=3ecf71cad)

* OPTIONS:

  SKEY -> OTP
  [[87a71d92f]](https://git.sudo.ws/sudo/commit/?id=87a71d92f)

1996-10-04 Todd C. Miller

* check.c:

  moved fclose() in skey stuff.
  [[1cb521729]](https://git.sudo.ws/sudo/commit/?id=1cb521729)

1996-10-03 Todd C. Miller

* putenv.c:

  index -> strchr remove unnecesary stuff
  [[043a7ef1a]](https://git.sudo.ws/sudo/commit/?id=043a7ef1a)

* check.c:

  now call skeychallenge() to get challenge instead of making one up
  ourselves. this way, we get extra goodies in the prompt.
  [[f4f2eb66b]](https://git.sudo.ws/sudo/commit/?id=f4f2eb66b)

1996-09-10 Todd C. Miller

* CHANGES:

  added one
  [[33199ba0d]](https://git.sudo.ws/sudo/commit/?id=33199ba0d)

* parse.lex:

  allow logins to start with a number (YUCK!)
  [[de10f9281]](https://git.sudo.ws/sudo/commit/?id=de10f9281)

1996-09-08 Todd C. Miller

* TROUBLESHOOTING:

  added soalris 2.5 vs 2.4 note
  [[4b1e2cb6f]](https://git.sudo.ws/sudo/commit/?id=4b1e2cb6f)

* configure.in:

  DUNIX doesn’t need -lnsl
  [[4bf4ed77c]](https://git.sudo.ws/sudo/commit/?id=4bf4ed77c)

* CHANGES:

  \*\*\* empty log message \*\*\*
  [[268af7a6b]](https://git.sudo.ws/sudo/commit/?id=268af7a6b)

* check.c, compat.h, config.h.in, dce\_pwent.c, find\_path.c, getspwuid.c,
  getwd.c, goodpath.c, ins\_2001.h, ins\_classic.h, ins\_csops.h,
  ins\_goons.h, insults.h, interfaces.c, logging.c, options.h, parse.c,
  parse.lex, parse.yacc, pathnames.h.in, putenv.c, strdup.c, sudo.c,
  sudo.h, sudo\_setenv.c, testsudoers.c, tgetpass.c, utime.c, version.h,
  visudo.c:

  courtesan
  [[6a230806a]](https://git.sudo.ws/sudo/commit/?id=6a230806a)

* PORTING, README, RUNSON:

  courtesan
  [[475865158]](https://git.sudo.ws/sudo/commit/?id=475865158)

* INSTALL, Makefile.in, TROUBLESHOOTING:

  courtesan
  [[b9993015f]](https://git.sudo.ws/sudo/commit/?id=b9993015f)

* visudo.pod:

  \*\*\* empty log message \*\*\*
  [[9a4c5a915]](https://git.sudo.ws/sudo/commit/?id=9a4c5a915)

* sudo.pod, visudo.pod:

  courtesan
  [[bf1f33e51]](https://git.sudo.ws/sudo/commit/?id=bf1f33e51)

1996-09-07 Todd C. Miller

* HISTORY:

  added courtesan ./
  [[e9cc671d8]](https://git.sudo.ws/sudo/commit/?id=e9cc671d8)

1996-09-06 Todd C. Miller

* sudo.c:

  added $SUDO\_PROMPT support
  [[ff9b44992]](https://git.sudo.ws/sudo/commit/?id=ff9b44992)

1996-09-04 Todd C. Miller

* check.c:

  print long skey challemged to stderr, not stdout
  [[ce5547930]](https://git.sudo.ws/sudo/commit/?id=ce5547930)

1996-09-01 Todd C. Miller

* CHANGES:

  updated for 1.5.1
  [[9e94a58a3]](https://git.sudo.ws/sudo/commit/?id=9e94a58a3)

* emul/utime.h:

  ++version
  [[d73996961]](https://git.sudo.ws/sudo/commit/?id=d73996961)

1996-08-31 Todd C. Miller

* RUNSON:

  updated for 1.5.1
  [[571ba606c]](https://git.sudo.ws/sudo/commit/?id=571ba606c)

1996-08-30 Todd C. Miller

* check.c:

  use shost, not host for tgetpass
  [[6e0efd965]](https://git.sudo.ws/sudo/commit/?id=6e0efd965)

* sudo.pod:

  documented %u and %h
  [[aa50602a5]](https://git.sudo.ws/sudo/commit/?id=aa50602a5)

* OPTIONS:

  documented %u and %h
  [[08124aa7c]](https://git.sudo.ws/sudo/commit/?id=08124aa7c)

* configure.in:

  fixed typo
  [[28258dfcc]](https://git.sudo.ws/sudo/commit/?id=28258dfcc)

* INSTALL, Makefile.in, README, check.c, compat.h, config.h.in,
  dce\_pwent.c, find\_path.c, getspwuid.c, getwd.c, goodpath.c, ins\_2001.h,
  ins\_classic.h, ins\_csops.h, ins\_goons.h, insults.h, interfaces.c,
  logging.c, options.h, parse.c, parse.lex, parse.yacc, pathnames.h.in,
  putenv.c, strdup.c, sudo.c, sudo.h, sudo\_setenv.c, testsudoers.c,
  tgetpass.c, utime.c, version.h, visudo.c:

  ++version
  [[d189849b4]](https://git.sudo.ws/sudo/commit/?id=d189849b4)

* BUGS:

  ++version
  [[f2ce8eeb3]](https://git.sudo.ws/sudo/commit/?id=f2ce8eeb3)

1996-08-29 Todd C. Miller

* Makefile.in, configure.in, version.h:

  ++version
  [[64bc07fae]](https://git.sudo.ws/sudo/commit/?id=64bc07fae)

* sudo.h:

  new tgetpass() params
  [[259ced1cc]](https://git.sudo.ws/sudo/commit/?id=259ced1cc)

* check.c:

  pass use and host to tgetpass
  [[3c0aaf274]](https://git.sudo.ws/sudo/commit/?id=3c0aaf274)

* tgetpass.c:

  added %u and %h escapes
  [[23ccf1269]](https://git.sudo.ws/sudo/commit/?id=23ccf1269)

* OPTIONS, check.c, options.h:

  added NO\_MESSAGE
  [[ad9f1ff3c]](https://git.sudo.ws/sudo/commit/?id=ad9f1ff3c)

* configure.in:

  added cray (unicos) support
  [[91abcbf09]](https://git.sudo.ws/sudo/commit/?id=91abcbf09)

1996-08-27 Todd C. Miller

* OPTIONS, options.h, sudo.c:

  added SHELL\_SETS\_HOME
  [[944fb1c5f]](https://git.sudo.ws/sudo/commit/?id=944fb1c5f)

1996-08-25 Todd C. Miller

* INSTALL:

  added note about “make install”
  [[dacecfff9]](https://git.sudo.ws/sudo/commit/?id=dacecfff9)

* parse.yacc:

  changed length/size params from int to size\_t
  [[a47e58eda]](https://git.sudo.ws/sudo/commit/?id=a47e58eda)

* OPTIONS:

  now get CSOPS insults as well by default
  [[71cb7c694]](https://git.sudo.ws/sudo/commit/?id=71cb7c694)

* insults.h:

  use csops insults too by default
  [[08795dd45]](https://git.sudo.ws/sudo/commit/?id=08795dd45)

* INSTALL, Makefile.in, README, config.h.in, configure.in, version.h:

  version = 1.5
  [[53e6e6ec4]](https://git.sudo.ws/sudo/commit/?id=53e6e6ec4)

* sudo.c:

  added runas\_homedir
  [[56405a97e]](https://git.sudo.ws/sudo/commit/?id=56405a97e)

* TODO:

  updated for 1.5
  [[feeaac1f0]](https://git.sudo.ws/sudo/commit/?id=feeaac1f0)

* RUNSON:

  updated for 1.5
  [[811464dd0]](https://git.sudo.ws/sudo/commit/?id=811464dd0)

* CHANGES:

  1.5 release
  [[f9b425506]](https://git.sudo.ws/sudo/commit/?id=f9b425506)

* INSTALL:

  added “upgrading” notes
  [[5f1b0564c]](https://git.sudo.ws/sudo/commit/?id=5f1b0564c)

1996-08-22 Todd C. Miller

* visudo.c:

  now do chmod and chown after edit of temp file and before rename
  [[81bdc0aa1]](https://git.sudo.ws/sudo/commit/?id=81bdc0aa1)

1996-08-18 Todd C. Miller

* Makefile.in:

  ++version added INSTALL.configure
  [[39bc5df7a]](https://git.sudo.ws/sudo/commit/?id=39bc5df7a)

* configure.in, version.h:

  ++version
  [[35d209fc9]](https://git.sudo.ws/sudo/commit/?id=35d209fc9)

* TROUBLESHOOTING:

  \*\*\* empty log message \*\*\*
  [[6ec8aba27]](https://git.sudo.ws/sudo/commit/?id=6ec8aba27)

* parse.yacc:

  added missing cast
  [[9347d2299]](https://git.sudo.ws/sudo/commit/?id=9347d2299)

* sudo.c:

  sets $HOME to pw\_dir of runas user
  [[10d364249]](https://git.sudo.ws/sudo/commit/?id=10d364249)

* sudo.pod:

  document $HOME change
  [[3d560a948]](https://git.sudo.ws/sudo/commit/?id=3d560a948)

1996-08-17 Todd C. Miller

* sudo.pod:

  fixed up some wording
  [[375014458]](https://git.sudo.ws/sudo/commit/?id=375014458)

* check.c, dce\_pwent.c, find\_path.c, getspwuid.c, getwd.c, goodpath.c,
  interfaces.c, logging.c, parse.c, parse.lex, parse.yacc, putenv.c,
  strdup.c, sudo.c, sudo\_setenv.c, testsudoers.c, tgetpass.c, utime.c,
  visudo.c:

  ++version
  [[35825133a]](https://git.sudo.ws/sudo/commit/?id=35825133a)

* compat.h, ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h,
  insults.h, options.h, pathnames.h.in, sudo.h:

  ++version
  [[daa856faa]](https://git.sudo.ws/sudo/commit/?id=daa856faa)

* emul/utime.h:

  ++version
  [[062e3de7a]](https://git.sudo.ws/sudo/commit/?id=062e3de7a)

* sudo.h:

  name nad type changes
  [[76d7bf617]](https://git.sudo.ws/sudo/commit/?id=76d7bf617)

* testsudoers.c:

  now works with new sudo
  [[7eea86a4c]](https://git.sudo.ws/sudo/commit/?id=7eea86a4c)

* parse.yacc:

  fixed some XXX
  [[be3b37d15]](https://git.sudo.ws/sudo/commit/?id=be3b37d15)

* parse.yacc:

  some variable name changes + comment headers for functions.
  [[f0d121ea2]](https://git.sudo.ws/sudo/commit/?id=f0d121ea2)

* tgetpass.c:

  added extra paren’s to make compilers happy
  [[bd228048b]](https://git.sudo.ws/sudo/commit/?id=bd228048b)

* sudo.c:

  \*\*\* empty log message \*\*\*
  [[7c3b77207]](https://git.sudo.ws/sudo/commit/?id=7c3b77207)

* parse.c:

  now uses init\_parser() if not in sudoers and tries “list” or “validate”
  scold but don’t be nasty.
  [[7d272a7ff]](https://git.sudo.ws/sudo/commit/?id=7d272a7ff)

* TROUBLESHOOTING:

  now can use upper case login names
  [[ed452695f]](https://git.sudo.ws/sudo/commit/?id=ed452695f)

* visudo.c:

  now uses init\_parser()
  [[d10ba268d]](https://git.sudo.ws/sudo/commit/?id=d10ba268d)

* INSTALL, README:

  updated
  [[6ea54d165]](https://git.sudo.ws/sudo/commit/?id=6ea54d165)

* PORTING:

  added info about PASSWORD\_TIMEOUT
  [[69aa11849]](https://git.sudo.ws/sudo/commit/?id=69aa11849)

* INSTALL.configure:

  Initial revision
  [[60d9d742d]](https://git.sudo.ws/sudo/commit/?id=60d9d742d)

* BUGS:

  fixed a bug ,
  [[df08f782b]](https://git.sudo.ws/sudo/commit/?id=df08f782b)

* parse.yacc:

  now dynamically allocates memory for the stacks – no more overflows!
  [[5436bf7c8]](https://git.sudo.ws/sudo/commit/?id=5436bf7c8)

* sudo.pod:

  -l now explands command aliases
  [[37069572f]](https://git.sudo.ws/sudo/commit/?id=37069572f)

* parse.yacc:

  hacks to expand command aliases for `sudo -l’
  [[bb29f0023]](https://git.sudo.ws/sudo/commit/?id=bb29f0023)

* sudo.c:

  remove $ENV and $BASH\_ENV (dangerous in ksh, posix sh, and bash)
  [[6da9b067a]](https://git.sudo.ws/sudo/commit/?id=6da9b067a)

* sudo.h:

  added struct command\_alias
  [[c3991cf7e]](https://git.sudo.ws/sudo/commit/?id=c3991cf7e)

* sudo.pod:

  fixed a bug
  [[0de439852]](https://git.sudo.ws/sudo/commit/?id=0de439852)

* lsearch.c:

  in compar() key should be first arg
  [[76d219d87]](https://git.sudo.ws/sudo/commit/?id=76d219d87)

1996-08-15 Todd C. Miller

* BUGS:

  fixed some bugs
  [[50c058e5f]](https://git.sudo.ws/sudo/commit/?id=50c058e5f)

* parse.yacc:

  can now deal with upcase HOST and USER names
  [[0f643f7a4]](https://git.sudo.ws/sudo/commit/?id=0f643f7a4)

* sudo.c:

  don’t yell too loudly at non-sudoers if they do “sudo -l”
  [[085fbf822]](https://git.sudo.ws/sudo/commit/?id=085fbf822)

* sudo.pod:

  fixed thinko
  [[740d2166e]](https://git.sudo.ws/sudo/commit/?id=740d2166e)

* parse.c:

  fix comment
  [[8c35fa2ec]](https://git.sudo.ws/sudo/commit/?id=8c35fa2ec)

1996-08-09 Todd C. Miller

* parse.c, parse.yacc:

  added support for new `sudo -l’ stuff
  [[4fb2f4ca9]](https://git.sudo.ws/sudo/commit/?id=4fb2f4ca9)

* sudo.c:

  now uses list\_matches()
  [[236019c88]](https://git.sudo.ws/sudo/commit/?id=236019c88)

* sudo.h:

  added struct sudo\_match
  [[8d4d6aebf]](https://git.sudo.ws/sudo/commit/?id=8d4d6aebf)

* configure.in:

  now more -lgnumalloc
  [[f85cd6de2]](https://git.sudo.ws/sudo/commit/?id=f85cd6de2)

1996-08-01 Todd C. Miller

* install-sh:

  added more paths for chown and whoami
  [[8db0946c7]](https://git.sudo.ws/sudo/commit/?id=8db0946c7)

1996-07-31 Todd C. Miller

* check.c:

  typo
  [[8e1ce2143]](https://git.sudo.ws/sudo/commit/?id=8e1ce2143)

1996-07-30 Todd C. Miller

* aclocal.m4:

  fixed DUNIX check for shadow pw
  [[73ef23903]](https://git.sudo.ws/sudo/commit/?id=73ef23903)

* tgetpass.c:

  now only turn off echo if it is already on. this fixes a race when you
  use sudo in a pipelin
  [[bdfd25e87]](https://git.sudo.ws/sudo/commit/?id=bdfd25e87)

* INSTALL:

  updated
  [[9e058b7c2]](https://git.sudo.ws/sudo/commit/?id=9e058b7c2)

* configure.in:

  changed “test -z $foo && do\_this” to if; then construct
  [[5126cd239]](https://git.sudo.ws/sudo/commit/?id=5126cd239)

1996-07-29 Todd C. Miller

* configure.in:

  added missing defines of SHADOW\_TYPE
  [[731bf90ae]](https://git.sudo.ws/sudo/commit/?id=731bf90ae)

1996-07-26 Todd C. Miller

* check.c:

  protect AUTH\_CRYPT\_OLDCRYPT and AUTH\_CRYPT\_C1CRYPT since they are only
  in dunix 4.x
  [[fb89ade3e]](https://git.sudo.ws/sudo/commit/?id=fb89ade3e)

* getspwuid.c:

  added AUTH\_CRYPT\_C1CRYPT support
  [[b7670208d]](https://git.sudo.ws/sudo/commit/?id=b7670208d)

* parse.c:

  no longer return VALIDATE\_NOT\_OK if there was a runas that didn’t match.
  Now we can have runas stuff on more than one line.
  [[89784f655]](https://git.sudo.ws/sudo/commit/?id=89784f655)

* getspwuid.c, sudo.c, tgetpass.c:

  use SHADOW\_TYPE instead of HAVE\_C2\_SECURITY
  [[e7999949e]](https://git.sudo.ws/sudo/commit/?id=e7999949e)

* configure.in:

  got rid of HAVE\_C2\_SECURITY SHADOW\_TYPE is always defined to something
  [[b543114b0]](https://git.sudo.ws/sudo/commit/?id=b543114b0)

* config.h.in:

  removed HAVE\_C2\_SECURITY added SPW\_BSD
  [[69b1a0b42]](https://git.sudo.ws/sudo/commit/?id=69b1a0b42)

* compat.h:

  use SHADOW\_TYPE instead of HAVE\_C2\_SECURITY
  [[f9d2f8923]](https://git.sudo.ws/sudo/commit/?id=f9d2f8923)

* check.c:

  SHADOW\_TYPE is always defined so just against its value
  [[f5da2ecd9]](https://git.sudo.ws/sudo/commit/?id=f5da2ecd9)

* aclocal.m4:

  added SUDO\_CHECK\_SHADOW\_DUNIX
  [[f13ef276c]](https://git.sudo.ws/sudo/commit/?id=f13ef276c)

1996-07-25 Todd C. Miller

* sudoers.pod:
  + -> ?\* in one example added another instance of (runas) and one of
    NOPASSWD:
    [[c809dd70c]](https://git.sudo.ws/sudo/commit/?id=c809dd70c)

1996-07-24 Todd C. Miller

* configure.in:

  added back check for config.cache from other host type
  [[7fea014bc]](https://git.sudo.ws/sudo/commit/?id=7fea014bc)

* parse.lex:

  removed an instance of "
  [[c5752f7b6]](https://git.sudo.ws/sudo/commit/?id=c5752f7b6)

* sample.sudoers:

  added an example
  [[2db411723]](https://git.sudo.ws/sudo/commit/?id=2db411723)

* sudoers.pod:

  updated wrt new wildcard matching
  [[48a1af2dc]](https://git.sudo.ws/sudo/commit/?id=48a1af2dc)

* configure.in:

  new check for shadow passwords if we don’t know anything
  [[f089b9ae6]](https://git.sudo.ws/sudo/commit/?id=f089b9ae6)

* aclocal.m4:

  new SUDO\_CHECK\_SHADOW\_GENERIC
  [[228a2ffa7]](https://git.sudo.ws/sudo/commit/?id=228a2ffa7)

* configure.in:

  added back check for -lsocket (oops)
  [[f25c6bb6b]](https://git.sudo.ws/sudo/commit/?id=f25c6bb6b)

* configure.in:

  better (working) check for shadow passwd type if we know to use C2.
  [[73c39341f]](https://git.sudo.ws/sudo/commit/?id=73c39341f)

* configure.in:

  now uses AC\_CANONICAL\_HOST to figure out os type
  [[db9dddd2a]](https://git.sudo.ws/sudo/commit/?id=db9dddd2a)

* Makefile.in:

  added config.{guess,sub}
  [[859753c60]](https://git.sudo.ws/sudo/commit/?id=859753c60)

* aclocal.m4:

  removed unused stuff to figure out os type
  [[36b9dafdf]](https://git.sudo.ws/sudo/commit/?id=36b9dafdf)

* config.sub:

  added openbsd
  [[a656b6123]](https://git.sudo.ws/sudo/commit/?id=a656b6123)

* config.sub:

  Initial revision
  [[216889be9]](https://git.sudo.ws/sudo/commit/?id=216889be9)

* config.guess:

  Initial revision
  [[d588e771e]](https://git.sudo.ws/sudo/commit/?id=d588e771e)

* testsudoers.c:

  don’t call fnmatch() with FNM\_PATHNAME flag unless it can only be a
  pathname. need to check against sudoers\_args even if user\_args is nil
  [[09c9f7ed9]](https://git.sudo.ws/sudo/commit/?id=09c9f7ed9)

* parse.c:

  don’t call fnmatch() with FNM\_PATHNAME flag unless it can only be a
  pathname need to check against sudoers\_args even if user\_args is nil
  [[d7ae14e4d]](https://git.sudo.ws/sudo/commit/?id=d7ae14e4d)

1996-07-23 Todd C. Miller

* check.c:

  added support for AUTH\_CRYPT\_OLDCRYPT w/ DUNIX C2
  [[b380c0ade]](https://git.sudo.ws/sudo/commit/?id=b380c0ade)

* testsudoers.c:

  now takes command line args and uses cmnd\_args
  [[27386f12f]](https://git.sudo.ws/sudo/commit/?id=27386f12f)

* parse.lex:

  fill\_args was adding an extra leading space
  [[4dba5f4fc]](https://git.sudo.ws/sudo/commit/?id=4dba5f4fc)

1996-07-22 Todd C. Miller

* visudo.c:

  fixed dummy command\_matches()
  [[945d9795e]](https://git.sudo.ws/sudo/commit/?id=945d9795e)

* parse.yacc:

  fixed prototype
  [[efb526bb2]](https://git.sudo.ws/sudo/commit/?id=efb526bb2)

* sudo.h:

  added cmnd\_args
  [[7fb14dd3f]](https://git.sudo.ws/sudo/commit/?id=7fb14dd3f)

* parse.yacc:

  now uses flat args string
  [[f62d59e92]](https://git.sudo.ws/sudo/commit/?id=f62d59e92)

* parse.c, parse.lex:

  now uses flat arg string
  [[8a177073e]](https://git.sudo.ws/sudo/commit/?id=8a177073e)

* visudo.c:

  added cmnd\_args def
  [[27d484f3f]](https://git.sudo.ws/sudo/commit/?id=27d484f3f)

* sudo.c:

  now sets cmnd\_args global
  [[bd641284a]](https://git.sudo.ws/sudo/commit/?id=bd641284a)

* logging.c:

  cmnd\_args is now exported from sudo.[ch]
  [[cfcbda54f]](https://git.sudo.ws/sudo/commit/?id=cfcbda54f)

1996-07-21 Todd C. Miller

* parse.yacc:

  can’t rely on cmnd\_matches as much as I thought – added some $$ stuff
  back in to prevent namespace pollution problems.
  [[d2173d029]](https://git.sudo.ws/sudo/commit/?id=d2173d029)

* parse.yacc:

  Simplified parse rules wrt runas and NOPASSWD (more consistent).
  [[0b3777229]](https://git.sudo.ws/sudo/commit/?id=0b3777229)

1996-07-20 Todd C. Miller

* parse.lex:

  NOPASSWD may now have blanks before the ‘:’ ‘(’ only starts a ‘runas’ if
  in the initial state to avoid collision with command args
  [[10e0e119a]](https://git.sudo.ws/sudo/commit/?id=10e0e119a)

* configure.in:

  added checks for specific shadow passwd schemes
  [[bf505a852]](https://git.sudo.ws/sudo/commit/?id=bf505a852)

* aclocal.m4:

  added routines to check for specific shadow passwd types
  [[d2bbb4989]](https://git.sudo.ws/sudo/commit/?id=d2bbb4989)

1996-07-18 Todd C. Miller

* configure.in:

  added support for ncr boxen
  [[0f31b85ef]](https://git.sudo.ws/sudo/commit/?id=0f31b85ef)

* aclocal.m4:

  added support for detecting ncr boxen
  [[25e15d666]](https://git.sudo.ws/sudo/commit/?id=25e15d666)

1996-07-16 Todd C. Miller

* configure.in:

  added sinix support
  [[fd134afec]](https://git.sudo.ws/sudo/commit/?id=fd134afec)

1996-07-14 Todd C. Miller

* TROUBLESHOOTING:

  added info about “config.cache from other other” error.
  [[2298f95f1]](https://git.sudo.ws/sudo/commit/?id=2298f95f1)

* aclocal.m4:

  now makes sure you don’t have a config.cache file from another OS
  [[aebf2b71d]](https://git.sudo.ws/sudo/commit/?id=aebf2b71d)

* configure.in:

  now sets $LIBS when needed to configure links with libs when doing tests
  hpux10 now uses SPW\_SECUREWARE for C2 added check for bigcrypt(3) if
  SPW\_SECUREWARE
  [[5de06090e]](https://git.sudo.ws/sudo/commit/?id=5de06090e)

* getspwuid.c:

  fixed typo
  [[967ae180e]](https://git.sudo.ws/sudo/commit/?id=967ae180e)

* tgetpass.c:

  now include stuff for SPW\_SECUREWARE to get AUTH\_MAX\_PASSWD\_LENGTH
  [[015c90151]](https://git.sudo.ws/sudo/commit/?id=015c90151)

* getspwuid.c:

  no more SPW\_HPUX10
  [[cc4420658]](https://git.sudo.ws/sudo/commit/?id=cc4420658)

* config.h.in:

  no more SPW\_HPUX10 added HAVE\_BIGCRYPT
  [[c4ceabc70]](https://git.sudo.ws/sudo/commit/?id=c4ceabc70)

* compat.h:

  now uses AUTH\_MAX\_PASSWD\_LENGTH if SPW\_SECUREWARE
  [[88cfad174]](https://git.sudo.ws/sudo/commit/?id=88cfad174)

* check.c:

  SPW\_SECUREWARE now uses bigcrypt
  [[c6b64b90a]](https://git.sudo.ws/sudo/commit/?id=c6b64b90a)

1996-07-13 Todd C. Miller

* sample.sudoers:

  fixed 2 syntax errors
  [[50f80d4b0]](https://git.sudo.ws/sudo/commit/?id=50f80d4b0)

* sudoers:

  root may now run ALL as ALL
  [[cde762379]](https://git.sudo.ws/sudo/commit/?id=cde762379)

1996-07-12 Todd C. Miller

* interfaces.c:

  fixed a typo/thinko that broke BSD’s with sa\_len
  [[ed9227dfd]](https://git.sudo.ws/sudo/commit/?id=ed9227dfd)

1996-07-08 Todd C. Miller

* check.c, configure.in:

  updated AFS support
  [[e79f19be3]](https://git.sudo.ws/sudo/commit/?id=e79f19be3)

* TROUBLESHOOTING:

  added entry about /usr/ucb/cc
  [[19469d203]](https://git.sudo.ws/sudo/commit/?id=19469d203)

* INSTALL:

  prep no longer holds gcc binaries
  [[cefe4d66c]](https://git.sudo.ws/sudo/commit/?id=cefe4d66c)

* INSTALL:

  updated AFS note
  [[90eda2cb9]](https://git.sudo.ws/sudo/commit/?id=90eda2cb9)

* Makefile.in:

  added @AFS\_LIBS@
  [[c6b4aca90]](https://git.sudo.ws/sudo/commit/?id=c6b4aca90)

* compat.h:

  AFS allows long passwords
  [[e518e10e0]](https://git.sudo.ws/sudo/commit/?id=e518e10e0)

* testsudoers.c:

  fixed -u user support
  [[5a616c40c]](https://git.sudo.ws/sudo/commit/?id=5a616c40c)

* parse.c:

  sudo -v now groks VALIDATE\_OK\_NOPASS
  [[54d39940b]](https://git.sudo.ws/sudo/commit/?id=54d39940b)

* parse.yacc:

  fixed no\_passwd vs. runas\_matched
  [[bae4e50e0]](https://git.sudo.ws/sudo/commit/?id=bae4e50e0)

* TROUBLESHOOTING:

  took out stuff about NFS-mounting since it is no longer an issue
  [[d0d972fa0]](https://git.sudo.ws/sudo/commit/?id=d0d972fa0)

* INSTALL:

  added –with-libraries > –with-libpath –with-incpath
  [[728bc783e]](https://git.sudo.ws/sudo/commit/?id=728bc783e)

* parse.yacc:

  was setting runas\_matches to -1 in wrong place
  [[11f5b7788]](https://git.sudo.ws/sudo/commit/?id=11f5b7788)

* check.c:

  removed usersec.h which is not present in new AFS versions
  [[33383c49e]](https://git.sudo.ws/sudo/commit/?id=33383c49e)

* tgetpass.c:

  now deals with timeout <= 0
  [[a27847e1b]](https://git.sudo.ws/sudo/commit/?id=a27847e1b)

* OPTIONS:

  updated
  [[bf55f57bd]](https://git.sudo.ws/sudo/commit/?id=bf55f57bd)

* configure.in:

  BSD/OS >= 2.0 now uses shlicc instead of just gcc
  [[32581d8a9]](https://git.sudo.ws/sudo/commit/?id=32581d8a9)

* sudo.c:

  fixed backwards compatibility with sudo 1.4 sudoers mode for root
  readable/writable filesystems
  [[633b6d2c3]](https://git.sudo.ws/sudo/commit/?id=633b6d2c3)

* Makefile.in:

  now gives INSTALL -c flag
  [[7a5a50b75]](https://git.sudo.ws/sudo/commit/?id=7a5a50b75)

* parse.yacc:

  slightly simpler initialization of no\_passwd and runas\_matches
  [[fb8c99d83]](https://git.sudo.ws/sudo/commit/?id=fb8c99d83)

* testsudoers.c:

  added -u username support
  [[064589670]](https://git.sudo.ws/sudo/commit/?id=064589670)

* configure.in:

  improved –with-libraries support
  [[a74cdaf8d]](https://git.sudo.ws/sudo/commit/?id=a74cdaf8d)

1996-07-07 Todd C. Miller

* configure.in:

  added –with-incpath, –with-libpath, –with-libraries
  [[5b4a48996]](https://git.sudo.ws/sudo/commit/?id=5b4a48996)

* parse.yacc:

  now initializes some fields that weren’t getting set to -1 pretty gross
  – need a rewrite.
  [[f52c2aa2e]](https://git.sudo.ws/sudo/commit/?id=f52c2aa2e)

1996-06-26 Todd C. Miller

* alloca.c:

  removed emacs’isms
  [[6d7e5a309]](https://git.sudo.ws/sudo/commit/?id=6d7e5a309)

* configure.in:

  no longer add -lPW to \*\_LIBS since we include alloca.c
  [[380e37c3c]](https://git.sudo.ws/sudo/commit/?id=380e37c3c)

* config.h.in:

  added HAVE\_ALLOCA\_H
  [[1775cd168]](https://git.sudo.ws/sudo/commit/?id=1775cd168)

* Makefile.in:

  added alloca.c
  [[01d3bf08b]](https://git.sudo.ws/sudo/commit/?id=01d3bf08b)

* alloca.c:

  Initial revision
  [[269efa95c]](https://git.sudo.ws/sudo/commit/?id=269efa95c)

* configure.in:

  ++version
  [[8e46ed96d]](https://git.sudo.ws/sudo/commit/?id=8e46ed96d)

1996-06-25 Todd C. Miller

* sudo.c:

  now set uid to 1 instead of nobody for PERM\_SUDOERS since nobody is not
  always set to a valid uid.
  [[0ac88016c]](https://git.sudo.ws/sudo/commit/?id=0ac88016c)

* OPTIONS:

  fixed entry for SUDO\_MODE
  [[4d9f668bb]](https://git.sudo.ws/sudo/commit/?id=4d9f668bb)

* sudo.c:

  Fixed NFS-mounted sudoers file under solaris both uid *and* gid were
  being set to -2. Now beat NFS to the punch and set uid to “nobody”
  ourselves, preserving group 0 to read sudoers.
  [[ea3da1971]](https://git.sudo.ws/sudo/commit/?id=ea3da1971)

* parse.c:

  moved set\_perms(PERM\_ROOT) to be before yyparse()
  [[d60779d01]](https://git.sudo.ws/sudo/commit/?id=d60779d01)

* logging.c:

  fixed a typo
  [[c7d5c3edf]](https://git.sudo.ws/sudo/commit/?id=c7d5c3edf)

* configure.in:

  no longer need AC\_PROG\_INSTALL
  [[a01ddb350]](https://git.sudo.ws/sudo/commit/?id=a01ddb350)

* Makefile.in:

  always use install-sh to avoid install(1)’s that use get{pw,gr}nam
  [[f0944b76c]](https://git.sudo.ws/sudo/commit/?id=f0944b76c)

* INSTALL:

  make clean -> make distclean
  [[8571327c7]](https://git.sudo.ws/sudo/commit/?id=8571327c7)

1996-06-20 Todd C. Miller

* parse.yacc:

  removed some unnecsary if’s
  [[cb2fd7e30]](https://git.sudo.ws/sudo/commit/?id=cb2fd7e30)

* Makefile.in, version.h:

  ++version
  [[95cbc71d6]](https://git.sudo.ws/sudo/commit/?id=95cbc71d6)

* parse.c, testsudoers.c:

  now includes netgroup.h
  [[082d9aed0]](https://git.sudo.ws/sudo/commit/?id=082d9aed0)

* interfaces.c:

  removed cats of ioctl to int since they didn’t shut up -Wall
  [[79810c01e]](https://git.sudo.ws/sudo/commit/?id=79810c01e)

* interfaces.c:

  explicately cast ioctl() to int since it it not always declared
  [[5fc1d4b79]](https://git.sudo.ws/sudo/commit/?id=5fc1d4b79)

* sudo.h:

  added declarations for yyparse() and yylex()
  [[08470fd76]](https://git.sudo.ws/sudo/commit/?id=08470fd76)

* parse.yacc:

  fixed an occurence of ‘==’ -> ‘=’
  [[2f49ee316]](https://git.sudo.ws/sudo/commit/?id=2f49ee316)

* config.h.in, configure.in:

  added check for netgroup.h
  [[b57aab8cd]](https://git.sudo.ws/sudo/commit/?id=b57aab8cd)

* sudo.c:

  fixed 2 compiler warnings
  [[2f7e9de28]](https://git.sudo.ws/sudo/commit/?id=2f7e9de28)

* sudo.c:

  SHELL\_IF\_NO\_ARGS caused core dump since NewArg[cv] weren’t being
  initialized
  [[399cddc8e]](https://git.sudo.ws/sudo/commit/?id=399cddc8e)

1996-06-19 Todd C. Miller

* sudo.pod:

  fixed a typo
  [[b512f62ba]](https://git.sudo.ws/sudo/commit/?id=b512f62ba)

1996-06-17 Todd C. Miller

* parse.yacc:

  fixed a formatting thingie
  [[a35441d43]](https://git.sudo.ws/sudo/commit/?id=a35441d43)

* parse.c, parse.yacc:

  fixed -u support with multiple user lists on a line
  [[8b66b6116]](https://git.sudo.ws/sudo/commit/?id=8b66b6116)

* configure.in:

  unixware needs -lgen
  [[a23fb9c4f]](https://git.sudo.ws/sudo/commit/?id=a23fb9c4f)

* README:

  updated ftp location
  [[4edc42a9a]](https://git.sudo.ws/sudo/commit/?id=4edc42a9a)

* sudoers.pod:

  add net\_addr/netmask support
  [[a0d157b76]](https://git.sudo.ws/sudo/commit/?id=a0d157b76)

* sample.sudoers:

  added net\_addr/mask example
  [[c796e229c]](https://git.sudo.ws/sudo/commit/?id=c796e229c)

* parse.c, parse.lex:

  added support for net\_addr/netmask
  [[f66eb18a5]](https://git.sudo.ws/sudo/commit/?id=f66eb18a5)

1996-06-16 Todd C. Miller

* sudoers.pod:

  ^ -> !
  [[0ede02bbe]](https://git.sudo.ws/sudo/commit/?id=0ede02bbe)

1996-06-15 Todd C. Miller

* RUNSON:

  updated for 1.4.3
  [[6a06980d2]](https://git.sudo.ws/sudo/commit/?id=6a06980d2)

* CHANGES:

  udpated for 1.4.3
  [[891b7c05a]](https://git.sudo.ws/sudo/commit/?id=891b7c05a)

* BUGS, TODO, TROUBLESHOOTING:

  updated
  [[5e7c7dfb8]](https://git.sudo.ws/sudo/commit/?id=5e7c7dfb8)

* sample.sudoers:

  updated with examples of new stuff
  [[a28397923]](https://git.sudo.ws/sudo/commit/?id=a28397923)

* INSTALL, README:

  ++version
  [[f64553860]](https://git.sudo.ws/sudo/commit/?id=f64553860)

* sudoers.pod:

  updated wrt -u and NOPASSWD
  [[255e60f65]](https://git.sudo.ws/sudo/commit/?id=255e60f65)

* sudo.pod:

  updated wrt -u and CAVEATS
  [[3041d6537]](https://git.sudo.ws/sudo/commit/?id=3041d6537)

1996-06-09 Todd C. Miller

* sudo.c:

  fixed usage()
  [[319a9ffe5]](https://git.sudo.ws/sudo/commit/?id=319a9ffe5)

* parse.lex:

  now use :foo: character classes (makes no diff for generated lexer)
  [[99e16a5a2]](https://git.sudo.ws/sudo/commit/?id=99e16a5a2)

1996-06-07 Todd C. Miller

* check.c:

  fixed LONG\_SKEY\_PROMPT stuff
  [[e4743a46c]](https://git.sudo.ws/sudo/commit/?id=e4743a46c)

1996-06-06 Todd C. Miller

* visudo.c:

  fixed a comment
  [[f3cdb9aa3]](https://git.sudo.ws/sudo/commit/?id=f3cdb9aa3)

* lsearch.c:

  make more like NetBSD one – now compiles w/o warnings
  [[1a6b10fe8]](https://git.sudo.ws/sudo/commit/?id=1a6b10fe8)

* emul/search.h:

  fixed decls of lsearch()
  [[e04a2ef6c]](https://git.sudo.ws/sudo/commit/?id=e04a2ef6c)

* config.h.in, configure.in, getspwuid.c:

  added SPW\_HPUX10
  [[10a84d536]](https://git.sudo.ws/sudo/commit/?id=10a84d536)

* check.c:

  hpux 10 uses bigcrypt() if C2
  [[ac186f85f]](https://git.sudo.ws/sudo/commit/?id=ac186f85f)

1996-06-04 Todd C. Miller

* parse.c:

  now always uses fnmatch to match args
  [[6737221aa]](https://git.sudo.ws/sudo/commit/?id=6737221aa)

* tgetpass.c:

  back to using stdio instead of raw i/o since that caused some problems
  [[1e21b9212]](https://git.sudo.ws/sudo/commit/?id=1e21b9212)

1996-05-29 Todd C. Miller

* sudo.c:

  now give usage warning if use -l,-v,-k with args
  [[636e5f1df]](https://git.sudo.ws/sudo/commit/?id=636e5f1df)

1996-05-28 Todd C. Miller

* sudo.c:

  NewArgc is now set to 1 for -l, -v, -k
  [[59f71cc27]](https://git.sudo.ws/sudo/commit/?id=59f71cc27)

* sudo.c:

  now sets sudoers to correct group if mode is 0400
  [[47f7ef9f3]](https://git.sudo.ws/sudo/commit/?id=47f7ef9f3)

* install-sh:

  updated to version used by inn and bind
  [[e577aafd1]](https://git.sudo.ws/sudo/commit/?id=e577aafd1)

* configure.in:

  now uses -lgnumalloc if it exists
  [[1af442146]](https://git.sudo.ws/sudo/commit/?id=1af442146)

* Makefile.in:

  “make install” now sets uid/gid and mode on sudoers if it exists
  [[4520d3c66]](https://git.sudo.ws/sudo/commit/?id=4520d3c66)

* sudo.c:

  rmeoved debugging statements
  [[afbddeebe]](https://git.sudo.ws/sudo/commit/?id=afbddeebe)

* parse.yacc:

  added a missing free()
  [[2ed1645b9]](https://git.sudo.ws/sudo/commit/?id=2ed1645b9)

* sudo.c:

  now uses user\_gid instead of getegid (which was wrong anyway) to set
  SUDO\_GID Now sets command line args in SUDO\_COMMAND envariabled
  (logging.c depends on args being in the environment)
  [[2c1b963a2]](https://git.sudo.ws/sudo/commit/?id=2c1b963a2)

* logging.c:

  now uses SUDO\_COMMAND envariable to get command args rather than
  building it up again.
  [[95fd02c9f]](https://git.sudo.ws/sudo/commit/?id=95fd02c9f)

* parse.c:

  now uses user\_gid
  [[d1c239718]](https://git.sudo.ws/sudo/commit/?id=d1c239718)

* sudo.c:

  fixed off by one error in allocation NewArgv
  [[5a32554c0]](https://git.sudo.ws/sudo/commit/?id=5a32554c0)

* parse.c:

  in sudoers, ‘command “”’ now means command with no args
  [[9ec0715a3]](https://git.sudo.ws/sudo/commit/?id=9ec0715a3)

* configure.in:

  added check for fnmatch(3) and fnmatch.h
  [[275314dbd]](https://git.sudo.ws/sudo/commit/?id=275314dbd)

* config.h.in:

  added HAVE\_FNMATCH
  [[b9f8e76bd]](https://git.sudo.ws/sudo/commit/?id=b9f8e76bd)

* Makefile.in:

  replaced wildcat.\* with fnmatch.\*
  [[49d0b999f]](https://git.sudo.ws/sudo/commit/?id=49d0b999f)

* testsudoers.c:

  now uses fnmatch()
  [[0713be74a]](https://git.sudo.ws/sudo/commit/?id=0713be74a)

1996-05-27 Todd C. Miller

* parse.c:

  now uses fnmatch() instead of wildmat a trailing star (\*) by itself now
  matches multiple args added support for wildcards in the pathname in
  sudoers
  [[a062a35c7]](https://git.sudo.ws/sudo/commit/?id=a062a35c7)

1996-05-25 Todd C. Miller

* fnmatch.c:

  now includes compat.h and config.h
  [[63e1abb3d]](https://git.sudo.ws/sudo/commit/?id=63e1abb3d)

* config.h.in:

  added HAVE\_FNMATCH\_H
  [[4f7d758d5]](https://git.sudo.ws/sudo/commit/?id=4f7d758d5)

* configure.in:

  now checks for alloca() (if needed by bison or dce) and links with -lPW
  if it contains alloca() and libv and compiler do not.
  [[0dfc086d4]](https://git.sudo.ws/sudo/commit/?id=0dfc086d4)

* emul/fnmatch.h, fnmatch.3, fnmatch.c:

  Initial revision
  [[af0130958]](https://git.sudo.ws/sudo/commit/?id=af0130958)

1996-04-29 Todd C. Miller

* sudo.c:

  now fixes mode on sudoers if set to 0400 to aid in upgrade
  [[afe3f2749]](https://git.sudo.ws/sudo/commit/?id=afe3f2749)

1996-04-28 Todd C. Miller

* Makefile.in:

  fixed pod2man usage
  [[94687786e]](https://git.sudo.ws/sudo/commit/?id=94687786e)

* Makefile.in, configure.in, version.h:

  ++version
  [[cc766e700]](https://git.sudo.ws/sudo/commit/?id=cc766e700)

* testsudoers.c, visudo.c:

  runas\_user is now initialized to “root”
  [[8263fc99d]](https://git.sudo.ws/sudo/commit/?id=8263fc99d)

* sudo.h:

  removed PERM\_FULL\_ROOT
  [[5f7eaa954]](https://git.sudo.ws/sudo/commit/?id=5f7eaa954)

* sudo.c:

  runas\_user defaults to “root” so no more need to PERM\_RUNAS
  [[487432985]](https://git.sudo.ws/sudo/commit/?id=487432985)

* parse.c:

  will now only running commands as root if there was no runas list (or if
  root is in the runas list)
  [[624218c54]](https://git.sudo.ws/sudo/commit/?id=624218c54)

* logging.c:

  now logs “USER=%s”
  [[36f120849]](https://git.sudo.ws/sudo/commit/?id=36f120849)

* parse.yacc:

  runas\_matches is now set to false if we get a negative match
  [[7c9580971]](https://git.sudo.ws/sudo/commit/?id=7c9580971)

* parse.lex:

  make #uid work + some minor cleanup
  [[60f30dc2f]](https://git.sudo.ws/sudo/commit/?id=60f30dc2f)

* sample.sudoers:

  added support for NOPASSWD and “runas” from garp@… /
  [[1d93314f9]](https://git.sudo.ws/sudo/commit/?id=1d93314f9)

* visudo.c:

  added support for “runas” from garp@… replaced SUDOERS\_OWNER with
  SUDOERS\_UID, SUDOERS\_GID added support for SUDOERS\_MODE
  [[aa92ab8df]](https://git.sudo.ws/sudo/commit/?id=aa92ab8df)

* testsudoers.c:

  added support for “runas” from garp@…
  [[fdcd43047]](https://git.sudo.ws/sudo/commit/?id=fdcd43047)

* sudo.h:

  added support for NO\_PASSWD and runas from garp@… replaced
  SUDOERS\_OWNER with SUDOERS\_UID and SUDOERS\_GID and added support fro
  SUDOERS\_MODE
  [[6b725ac51]](https://git.sudo.ws/sudo/commit/?id=6b725ac51)

* sudo.c:

  added support for NO\_PASSWD and runas from garp@… replaced
  SUDOERS\_OWNER with SUDOERS\_UID and SUDOERS\_GID and added support fro
  SUDOERS\_MODE
  [[da33d14c3]](https://git.sudo.ws/sudo/commit/?id=da33d14c3)

* parse.yacc:

  added support for NO\_PASSWD and runas from garp@…
  [[0acd82680]](https://git.sudo.ws/sudo/commit/?id=0acd82680)

* parse.c, parse.lex:

  added support for NO\_PASSWD and runas from garp@…
  [[32002b7d9]](https://git.sudo.ws/sudo/commit/?id=32002b7d9)

* logging.c:

  added support for SUDOERS\_WRONG\_MODE and “runas”
  [[88c189315]](https://git.sudo.ws/sudo/commit/?id=88c189315)

* configure.in:

  added –with-CC only link with -lshadow on linux (with shadow pw) if
  libc lacks getspnam()
  [[d726595a1]](https://git.sudo.ws/sudo/commit/?id=d726595a1)

* OPTIONS, options.h:

  removed NO\_PASSWD since it is not possible to do this in the sudoers
  file itself. Replaced SUDOERS\_OWNER with SUDOERS\_UID and SUDOERS\_GID.
  Added SUDOERS\_MODE.
  [[394083380]](https://git.sudo.ws/sudo/commit/?id=394083380)

* Makefile.in:

  now uses SUDOERS\_UID and SUDOERS\_GID
  [[bab3ce55d]](https://git.sudo.ws/sudo/commit/?id=bab3ce55d)

1996-04-27 Todd C. Miller

* INSTALL:

  added –with-CC
  [[26956e346]](https://git.sudo.ws/sudo/commit/?id=26956e346)

1996-04-06 Todd C. Miller

* parse.lex:

  added double quote support
  [[b4a7b0b3b]](https://git.sudo.ws/sudo/commit/?id=b4a7b0b3b)

* sudoers.pod:

  documented double quoting
  [[f8e16f134]](https://git.sudo.ws/sudo/commit/?id=f8e16f134)

1996-04-05 Todd C. Miller

* mkinstalldirs:

  Initial revision
  [[cab14bb40]](https://git.sudo.ws/sudo/commit/?id=cab14bb40)

* check.c:

  fixed some indentation
  [[b61573f6d]](https://git.sudo.ws/sudo/commit/?id=b61573f6d)

* Makefile.in:

  fixed a typo
  [[69e72e361]](https://git.sudo.ws/sudo/commit/?id=69e72e361)

* Makefile.in:

  added install-dirs .
  [[d51ed38ad]](https://git.sudo.ws/sudo/commit/?id=d51ed38ad)

1996-04-04 Todd C. Miller

* dce\_pwent.c:

  new version from “Jeff A. Earickson” <jaearick@…>
  [[dbc8a7b31]](https://git.sudo.ws/sudo/commit/?id=dbc8a7b31)

1996-04-03 Todd C. Miller

* configure.in:

  $CSOPS -> $with\_csops (whoops, missed one)
  [[ec1dffeb6]](https://git.sudo.ws/sudo/commit/?id=ec1dffeb6)

* BUGS:

  updated
  [[c3c1d1c32]](https://git.sudo.ws/sudo/commit/?id=c3c1d1c32)

* parse.lex:

  FQHOST now has same constraints as non-FQHOST
  [[0a31e88ba]](https://git.sudo.ws/sudo/commit/?id=0a31e88ba)

* INSTALL:

  added note about OS’s w/ shadow passwords turned on by default
  [[7b4f181e5]](https://git.sudo.ws/sudo/commit/?id=7b4f181e5)

1996-04-02 Todd C. Miller

* configure.in:

  fixed a typo
  [[1f6605163]](https://git.sudo.ws/sudo/commit/?id=1f6605163)

* configure.in:

  added support for –without-THING sanitized shadow pw situtation by
  adding support for –without-C2
  [[9d633ad10]](https://git.sudo.ws/sudo/commit/?id=9d633ad10)

* tgetpass.c:

  fixed a typo wrt placement of an end paren
  [[20a284166]](https://git.sudo.ws/sudo/commit/?id=20a284166)

* check.c:

  was closing an fd that may not have been opened
  [[0eb20432f]](https://git.sudo.ws/sudo/commit/?id=0eb20432f)

1996-03-22 Todd C. Miller

* OPTIONS, options.h, sudo.c:

  added NO\_PASSWD
  [[1265fcc4f]](https://git.sudo.ws/sudo/commit/?id=1265fcc4f)

1996-03-20 Todd C. Miller

* configure.in:

  now always use shadow pw on some arches
  [[823ddd9fd]](https://git.sudo.ws/sudo/commit/?id=823ddd9fd)

1996-03-19 Todd C. Miller

* configure.in:

  added pyramid support
  [[9b33594ed]](https://git.sudo.ws/sudo/commit/?id=9b33594ed)

* configure.in:

  no longer check for C2 if alternate passwd method is used no longer
  check for some libs twice
  [[7ff41561c]](https://git.sudo.ws/sudo/commit/?id=7ff41561c)

* parse.yacc:

  moved fqdn stuff into parse.lex (FQHOST)
  [[f70482057]](https://git.sudo.ws/sudo/commit/?id=f70482057)

* parse.lex:

  added FQHOST rules
  [[182cb02be]](https://git.sudo.ws/sudo/commit/?id=182cb02be)

* tgetpass.c:

  now define TCSASOFT in necesary
  [[61a3d472e]](https://git.sudo.ws/sudo/commit/?id=61a3d472e)

* tgetpass.c:

  now uses read/write instead of stdio string goop to avoid problems with
  select(2)
  [[e47ce61c4]](https://git.sudo.ws/sudo/commit/?id=e47ce61c4)

* OPTIONS, find\_path.c, options.h:

  -DNO\_DOT\_PATH -> -DIGNORE\_DOT\_PATH
  [[b0fd211fb]](https://git.sudo.ws/sudo/commit/?id=b0fd211fb)

1996-03-17 Todd C. Miller

* INSTALL:

  added note about no shadow auto-detect if using alternate auth schemes
  [[954be8925]](https://git.sudo.ws/sudo/commit/?id=954be8925)

* configure.in:

  don’t check for C2 if AFS or DCE (unless they said –with-C2)
  [[9b6fc4c41]](https://git.sudo.ws/sudo/commit/?id=9b6fc4c41)

* testsudoers.c:

  now groks shost
  [[5e8e31386]](https://git.sudo.ws/sudo/commit/?id=5e8e31386)

* OPTIONS, find\_path.c, options.h:

  added NO\_DOT\_PATH
  [[2faa03ec4]](https://git.sudo.ws/sudo/commit/?id=2faa03ec4)

1996-03-16 Todd C. Miller

* find\_path.c:

  checkdot now works correctly
  [[13ad7291f]](https://git.sudo.ws/sudo/commit/?id=13ad7291f)

1996-03-12 Todd C. Miller

* configure.in:

  can’t have DCE and C2 passwords both…
  [[dd8e4bba8]](https://git.sudo.ws/sudo/commit/?id=dd8e4bba8)

1996-03-11 Todd C. Miller

* parse.yacc, sudo.c, sudo.h, visudo.c:

  now uses shost even if not FQDN
  [[058a58a50]](https://git.sudo.ws/sudo/commit/?id=058a58a50)

* configure.in:

  now looks for skey in /usr/lib and doesn’t require libskey to be in
  /usr/local/lib just because skey.h is (for my netbsd box :-)
  [[8ee0906f2]](https://git.sudo.ws/sudo/commit/?id=8ee0906f2)

* aclocal.m4, config.h.in, pathnames.h.in:

  *SUDO\_PATH* -> *CONFIG\_PATH*
  [[d3fc83d9a]](https://git.sudo.ws/sudo/commit/?id=d3fc83d9a)

* aclocal.m4, sudo.pod:

  /var/run/.odus -> /var/run/sudo
  [[5c30bd48d]](https://git.sudo.ws/sudo/commit/?id=5c30bd48d)

* pathnames.h.in:

  now uses \_SUDO\_PATH\_TIMEDIR
  [[4cd2a9390]](https://git.sudo.ws/sudo/commit/?id=4cd2a9390)

* OPTIONS:

  udpated FQDN
  [[f39b2329e]](https://git.sudo.ws/sudo/commit/?id=f39b2329e)

* aclocal.m4, configure.in:

  added SUDO\_TIMEDIR
  [[7f0e97586]](https://git.sudo.ws/sudo/commit/?id=7f0e97586)

* config.h.in:

  added \_SUDO\_PATH\_TIMEDIR
  [[f5230f628]](https://git.sudo.ws/sudo/commit/?id=f5230f628)

* sudo.pod:

  updated wrt /var/run/sudo
  [[21c38820f]](https://git.sudo.ws/sudo/commit/?id=21c38820f)

* sudo.c, sudo.h:

  added support for shost if FQDN
  [[773636c1c]](https://git.sudo.ws/sudo/commit/?id=773636c1c)

* parse.yacc, visudo.c:

  now uses shost if FQDN
  [[56df3dd85]](https://git.sudo.ws/sudo/commit/?id=56df3dd85)

* check.c:

  Now use skeylookup() instead off skeychallenge()
  [[4a46e1a18]](https://git.sudo.ws/sudo/commit/?id=4a46e1a18)

1996-02-28 Todd C. Miller

* logging.c:

  mail\_argv should not contain ALERTMAIL as it includes “-t”
  [[98a6190b1]](https://git.sudo.ws/sudo/commit/?id=98a6190b1)

1996-02-22 Todd C. Miller

* INSTALL, Makefile.in, README, configure.in, version.h:

  ++version
  [[77684bd09]](https://git.sudo.ws/sudo/commit/?id=77684bd09)

* compat.h:

  added more \_PASSWD\_LEN stuff – now uses PASS\_MAX too
  [[7c0d81ee3]](https://git.sudo.ws/sudo/commit/?id=7c0d81ee3)

* tgetpass.c:

  now includes limits.h moved \_PASSWD\_LEN -> compat.h
  [[47574e1af]](https://git.sudo.ws/sudo/commit/?id=47574e1af)

1996-02-06 Todd C. Miller

* INSTALL, README:

  ++version
  [[caf533f47]](https://git.sudo.ws/sudo/commit/?id=caf533f47)

* Makefile.in:

  ++versoin
  [[e03f27e9a]](https://git.sudo.ws/sudo/commit/?id=e03f27e9a)

* Makefile.in:

  fixed a typo
  [[27f2f09ed]](https://git.sudo.ws/sudo/commit/?id=27f2f09ed)

* configure.in:

  ++version
  [[578218b1a]](https://git.sudo.ws/sudo/commit/?id=578218b1a)

1996-02-05 Todd C. Miller

* RUNSON:

  updated
  [[ba88cc5d9]](https://git.sudo.ws/sudo/commit/?id=ba88cc5d9)

* CHANGES:

  done for 1.4.1 (I hope)
  [[fb3ad7370]](https://git.sudo.ws/sudo/commit/?id=fb3ad7370)

* sudoers.pod:

  added info on wildcards
  [[7d247e981]](https://git.sudo.ws/sudo/commit/?id=7d247e981)

* sample.sudoers:

  added wildcard example
  [[e9714fa3f]](https://git.sudo.ws/sudo/commit/?id=e9714fa3f)

* Makefile.in:

  now uses \*.pod to build \*.man and \*.cat & \*.html
  [[aa9916588]](https://git.sudo.ws/sudo/commit/?id=aa9916588)

* configure.in:

  addedSUDO\_PROG\_BSHELL !ll
  [[2be584fff]](https://git.sudo.ws/sudo/commit/?id=2be584fff)

* visudo.pod:

  fixed up some formatting
  [[6f8e34d2c]](https://git.sudo.ws/sudo/commit/?id=6f8e34d2c)

* sudoers.pod:

  redid section describing sample sudoers stuff
  [[7cb5af2dc]](https://git.sudo.ws/sudo/commit/?id=7cb5af2dc)

* sudo.pod:

  fixed some formatting
  [[5003b21c7]](https://git.sudo.ws/sudo/commit/?id=5003b21c7)

* getspwuid.c:

  now treats "” as bourne shell
  [[32af5520d]](https://git.sudo.ws/sudo/commit/?id=32af5520d)

* Makefile.in:

  TESTOBJS nwo includes wildmat.o
  [[e43668a6a]](https://git.sudo.ws/sudo/commit/?id=e43668a6a)

* testsudoers.c:

  now works with NewArg[cv]
  [[63c9d31bd]](https://git.sudo.ws/sudo/commit/?id=63c9d31bd)

* sudo.c:

  removed an XXX (fixed it in getspwuid.c)
  [[3da8d74b0]](https://git.sudo.ws/sudo/commit/?id=3da8d74b0)

* aclocal.m4:

  added check for bourne shell
  [[1d084add8]](https://git.sudo.ws/sudo/commit/?id=1d084add8)

* pathnames.h.in:

  added \_PATH\_BSHELL
  [[0f9fcf68c]](https://git.sudo.ws/sudo/commit/?id=0f9fcf68c)

* config.h.in:

  added \_SUDO\_PATH\_BSHELL
  [[15eb52fd0]](https://git.sudo.ws/sudo/commit/?id=15eb52fd0)

1996-02-04 Todd C. Miller

* visudo.c:

  unixware vi returns 256 instead of 0
  [[845ee30d7]](https://git.sudo.ws/sudo/commit/?id=845ee30d7)

* INSTALL:

  added Linux note
  [[a33259079]](https://git.sudo.ws/sudo/commit/?id=a33259079)

* logging.c:

  fixed up some XXX’s. file log format now looks a little more like real
  syslog(3) format.
  [[53ef7e23c]](https://git.sudo.ws/sudo/commit/?id=53ef7e23c)

* README, TROUBLESHOOTING:

  updated wrt lex/flex
  [[b220613b8]](https://git.sudo.ws/sudo/commit/?id=b220613b8)

* Makefile.in:

  commented out rule to build lex.yy.c from parse.lex since we ship with a
  pre-flex’d parser
  [[dcac138a6]](https://git.sudo.ws/sudo/commit/?id=dcac138a6)

* parse.c, parse.yacc, visudo.c:

  path\_matches -> command\_matches
  [[1151a4bfd]](https://git.sudo.ws/sudo/commit/?id=1151a4bfd)

* logging.c:

  eliminated some strcat()’s
  [[5fd8419d8]](https://git.sudo.ws/sudo/commit/?id=5fd8419d8)

* configure.in:

  no longer checks for lex/flex (now assumes flex)
  [[40555aba5]](https://git.sudo.ws/sudo/commit/?id=40555aba5)

* configure.in:

  now checks for $kerb\_dir\_candidate/krb.h instead of just
  kerb\_dir\_candidate
  [[1b412bd7d]](https://git.sudo.ws/sudo/commit/?id=1b412bd7d)

1996-02-03 Todd C. Miller

* parse.yacc:

  now use a ‘hook’ expression instead of an iffy one :-)
  [[42225e3b0]](https://git.sudo.ws/sudo/commit/?id=42225e3b0)

1996-02-02 Todd C. Miller

* visudo.c:

  now works with new sudo arg stuff
  [[6002abd99]](https://git.sudo.ws/sudo/commit/?id=6002abd99)

* parse.yacc:

  fixed dereferencing deadbeef
  [[65058a100]](https://git.sudo.ws/sudo/commit/?id=65058a100)

* sudo.c:

  changed an occurrence of Argv to NewArgv
  [[1714849ac]](https://git.sudo.ws/sudo/commit/?id=1714849ac)

* parse.lex:

  took out support for quoted commands since there is no need…
  [[500ae8269]](https://git.sudo.ws/sudo/commit/?id=500ae8269)

* parse.c:

  fixed a typo in a for() loop
  [[0f898397f]](https://git.sudo.ws/sudo/commit/?id=0f898397f)

* logging.c:

  protected against dereferencing rogue pointers
  [[f19b2ebf8]](https://git.sudo.ws/sudo/commit/?id=f19b2ebf8)

* sudo.c:

  now uses NewArgv amd NewArgc so cmnd\_aegs is no longer needed this also
  allows us to eliminate some kludges in parse\_args() and eliminate
  superfluous code.
  [[e06c19bbb]](https://git.sudo.ws/sudo/commit/?id=e06c19bbb)

* logging.c:

  no longer uses cmnd\_args, now uses NewArgv instead.
  [[d38613278]](https://git.sudo.ws/sudo/commit/?id=d38613278)

* sudo.h:

  added struct sudo\_command, NewArgc, and NewArgv removed cmnd\_args (no
  longer used)
  [[bfacbff72]](https://git.sudo.ws/sudo/commit/?id=bfacbff72)

* Makefile.in:

  added wildmat.c to SRCS & SUDOBJS
  [[b81d0d611]](https://git.sudo.ws/sudo/commit/?id=b81d0d611)

* parse.yacc:

  COMMAND is now a struct containing the path and args
  [[8356e4bcd]](https://git.sudo.ws/sudo/commit/?id=8356e4bcd)

* parse.lex:

  replaced append() with fill\_cmnd() and fill\_args. command args from a
  sudoers entry are now stored in an arrary for easy matching.
  [[2b003ffa8]](https://git.sudo.ws/sudo/commit/?id=2b003ffa8)

* parse.c:

  command line args from sudoers file are now in an array like ones passed
  in from the command line
  [[dd18abfe4]](https://git.sudo.ws/sudo/commit/?id=dd18abfe4)

1996-02-01 Todd C. Miller

* parse.c:

  wildwat stuff now works
  [[7731bb261]](https://git.sudo.ws/sudo/commit/?id=7731bb261)

1996-01-29 Todd C. Miller

* version.h:

  ++version
  [[d28ce9489]](https://git.sudo.ws/sudo/commit/?id=d28ce9489)

* Makefile.in:

  ++version added wildmat.\*
  [[1947459b9]](https://git.sudo.ws/sudo/commit/?id=1947459b9)

1996-01-28 Todd C. Miller

* parse.lex:

  added support for quoted commands (w/ or w/o args)
  [[216ca11a0]](https://git.sudo.ws/sudo/commit/?id=216ca11a0)

1996-01-22 Todd C. Miller

* sudo.pod, visudo.pod:

  cleaned up formatting
  [[9a3ee91ec]](https://git.sudo.ws/sudo/commit/?id=9a3ee91ec)

* sudo.pod, visudo.pod:

  Initial revision
  [[57155eeaa]](https://git.sudo.ws/sudo/commit/?id=57155eeaa)

1996-01-21 Todd C. Miller

* sudoers.pod:

  looks reasonable, could be mroe readable
  [[368217d7b]](https://git.sudo.ws/sudo/commit/?id=368217d7b)

* sudoers.pod:

  Initial revision
  [[3c20fdea2]](https://git.sudo.ws/sudo/commit/?id=3c20fdea2)

1996-01-16 Todd C. Miller

* RUNSON:

  updated
  [[75ef8ca4b]](https://git.sudo.ws/sudo/commit/?id=75ef8ca4b)

* OPTIONS:

  updated NO\_ROOT\_SUDO entry
  [[6a5d75b5c]](https://git.sudo.ws/sudo/commit/?id=6a5d75b5c)

1996-01-15 Todd C. Miller

* RUNSON:

  \*\*\* empty log message \*\*\*
  [[94535bae6]](https://git.sudo.ws/sudo/commit/?id=94535bae6)

* sudo.c:

  fixed SECURE\_PATH
  [[35622b80c]](https://git.sudo.ws/sudo/commit/?id=35622b80c)

* RUNSON:

  udpa`ted for 1.4
  [[1eb9339ef]](https://git.sudo.ws/sudo/commit/?id=1eb9339ef)

* configure.in:

  AIX aixcrypt.exp now uses $(srcdir)
  [[d0aeb1ee2]](https://git.sudo.ws/sudo/commit/?id=d0aeb1ee2)

* TROUBLESHOOTING:

  added entry for anal ansi compilers
  [[e2b93bc0e]](https://git.sudo.ws/sudo/commit/?id=e2b93bc0e)

1996-01-14 Todd C. Miller

* INSTALL:

  added info on libcrypt\_i for SCO
  [[2be2ed2c3]](https://git.sudo.ws/sudo/commit/?id=2be2ed2c3)

* TODO:

  \*\*\* empty log message \*\*\*
  [[4b99b83de]](https://git.sudo.ws/sudo/commit/?id=4b99b83de)

* sample.sudoers:

  added comments
  [[57be0e7ff]](https://git.sudo.ws/sudo/commit/?id=57be0e7ff)

* TODO:

  1.4 release
  [[491ed09c0]](https://git.sudo.ws/sudo/commit/?id=491ed09c0)

* CHANGES:

  ++version
  [[c769b5644]](https://git.sudo.ws/sudo/commit/?id=c769b5644)

* INSTALL, OPTIONS, README, config.h.in, configure.in:

  ++version
  [[84c4fd514]](https://git.sudo.ws/sudo/commit/?id=84c4fd514)

* BUGS:

  ++version and fixed ISC
  [[f0f808679]](https://git.sudo.ws/sudo/commit/?id=f0f808679)

* check.c, compat.h, dce\_pwent.c, find\_path.c, getspwuid.c, getwd.c,
  goodpath.c, ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h,
  insults.h, logging.c, options.h, pathnames.h.in, putenv.c, strdup.c,
  sudo.c, sudo.h, sudo\_setenv.c, testsudoers.c, tgetpass.c, utime.c,
  visudo.c:

  ++version
  [[813ac511d]](https://git.sudo.ws/sudo/commit/?id=813ac511d)

* interfaces.c:

  added STUB\_LOAD\_INTERFACES ++version
  [[ed5fcdccc]](https://git.sudo.ws/sudo/commit/?id=ed5fcdccc)

* Makefile.in, emul/utime.h, parse.c, parse.lex, parse.yacc, version.h:

  ++version
  [[d58db6c2c]](https://git.sudo.ws/sudo/commit/?id=d58db6c2c)

* PORTING:

  added info about fd\_set in tgetpass added info on interfaces.c
  [[d10787840]](https://git.sudo.ws/sudo/commit/?id=d10787840)

1996-01-11 Todd C. Miller

* dce\_pwent.c:

  added sudo header
  [[b05ce03eb]](https://git.sudo.ws/sudo/commit/?id=b05ce03eb)

* tgetpass.c:

  fixed a typo
  [[d9a1d1425]](https://git.sudo.ws/sudo/commit/?id=d9a1d1425)

* Makefile.in:

  tgetpass.o is now only linked in with sudo (not visudo)
  [[2d066db85]](https://git.sudo.ws/sudo/commit/?id=2d066db85)

1996-01-09 Todd C. Miller

* BUGS, INSTALL, Makefile.in, OPTIONS, README, config.h.in, configure.in:

  ++version
  [[6e0dec332]](https://git.sudo.ws/sudo/commit/?id=6e0dec332)

* emul/utime.h:

  added copyright notice
  [[da7d049fe]](https://git.sudo.ws/sudo/commit/?id=da7d049fe)

* check.c, compat.h, find\_path.c, getspwuid.c, getwd.c, goodpath.c,
  ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h, insults.h,
  interfaces.c, logging.c, options.h, parse.c, parse.lex, parse.yacc,
  pathnames.h.in, putenv.c, strdup.c, sudo.c, sudo.h, sudo\_setenv.c,
  testsudoers.c, tgetpass.c, utime.c, version.h, visudo.c:

  ++version
  [[a90d2d478]](https://git.sudo.ws/sudo/commit/?id=a90d2d478)

* tgetpass.c:

  minor cleanup and now includes sys/bsdtypes for svr4’ish boxen
  [[38e76816a]](https://git.sudo.ws/sudo/commit/?id=38e76816a)

* configure.in:

  ISC now gets -lcrypt now check for sys/bsdtypes.h
  [[73bb405bf]](https://git.sudo.ws/sudo/commit/?id=73bb405bf)

* config.h.in:

  added check for sys/bsdtypes.h
  [[3b6e55a85]](https://git.sudo.ws/sudo/commit/?id=3b6e55a85)

1996-01-07 Todd C. Miller

* parse.yacc:

  removed debugging stuff (setting freed ptr to NULL)
  [[c509bec0c]](https://git.sudo.ws/sudo/commit/?id=c509bec0c)

* TROUBLESHOOTING:

  added 2 entries
  [[14ebaab3b]](https://git.sudo.ws/sudo/commit/?id=14ebaab3b)

* Makefile.in:

  added FAQ
  [[3e2876d44]](https://git.sudo.ws/sudo/commit/?id=3e2876d44)

* TROUBLESHOOTING:

  added section on syslog
  [[dc7ee7602]](https://git.sudo.ws/sudo/commit/?id=dc7ee7602)

* configure.in:

  added AC\_ISC\_POSIX for better ISC support
  [[90596667f]](https://git.sudo.ws/sudo/commit/?id=90596667f)

* config.h.in:

  fixed typo
  [[ab99db6cc]](https://git.sudo.ws/sudo/commit/?id=ab99db6cc)

* config.h.in:

  added define for \_POSIX\_SOURCE
  [[16bdc95c2]](https://git.sudo.ws/sudo/commit/?id=16bdc95c2)

1996-01-04 Todd C. Miller

* configure.in:

  fixed check for lsearch()
  [[e59decf05]](https://git.sudo.ws/sudo/commit/?id=e59decf05)

1995-12-22 Todd C. Miller

* interfaces.c:

  fixed for AIX now deal if num\_interfaces == 0 (should not happen)
  [[3aba9c478]](https://git.sudo.ws/sudo/commit/?id=3aba9c478)

1995-12-20 Todd C. Miller

* configure.in:

  now only define HAVE\_LSEARCH if there is a corresponding search.h
  [[fe1e64dcb]](https://git.sudo.ws/sudo/commit/?id=fe1e64dcb)

* interfaces.c:

  works on ISC again
  [[6d0d2c8ba]](https://git.sudo.ws/sudo/commit/?id=6d0d2c8ba)

1995-12-18 Todd C. Miller

* configure.in:

  now define HAVE\_LSEARCH if we find lsearch() in libcompat
  [[479248730]](https://git.sudo.ws/sudo/commit/?id=479248730)

* lsearch.c:

  char \* -> const char \*
  [[e4aed8e5e]](https://git.sudo.ws/sudo/commit/?id=e4aed8e5e)

* configure.in:

  now looks in -lcompat for lsearch()
  [[6946bdb78]](https://git.sudo.ws/sudo/commit/?id=6946bdb78)

* Makefile.in:

  remove sudo.core visudo.core for clan target
  [[16b1ecdb1]](https://git.sudo.ws/sudo/commit/?id=16b1ecdb1)

* aclocal.m4:

  added UID\_MAX support in check for MAX\_UID\_T\_LEN
  [[8e4308dc2]](https://git.sudo.ws/sudo/commit/?id=8e4308dc2)

* Makefile.in:

  fixed another occurence of sudo\_getpwuid.\*
  [[332bab8e0]](https://git.sudo.ws/sudo/commit/?id=332bab8e0)

* Makefile.in, getspwuid.c:

  sudo\_getpwuid.c -> getspwuid.c
  [[81a441aed]](https://git.sudo.ws/sudo/commit/?id=81a441aed)

* configure.in:

  moved the “echo”
  [[481f1098c]](https://git.sudo.ws/sudo/commit/?id=481f1098c)

* BUGS, CHANGES, INSTALL, Makefile.in, OPTIONS, README, check.c, compat.h,
  config.h.in, configure.in, find\_path.c, getspwuid.c, getwd.c,
  goodpath.c, ins\_2001.h, ins\_classic.h, ins\_csops.h, ins\_goons.h,
  insults.h, interfaces.c, logging.c, options.h, parse.c, parse.lex,
  parse.yacc, pathnames.h.in, putenv.c, strdup.c, sudo.c, sudo.h,
  sudo\_setenv.c, testsudoers.c, tgetpass.c, utime.c, version.h, visudo.c:

  ++version
  [[684637770]](https://git.sudo.ws/sudo/commit/?id=684637770)

* testsudoers.c:

  added group support
  [[d606c291c]](https://git.sudo.ws/sudo/commit/?id=d606c291c)

* sample.sudoers:

  added group entry
  [[c5d1fb9fc]](https://git.sudo.ws/sudo/commit/?id=c5d1fb9fc)

* sudoers.man:

  documented group support
  [[db1608442]](https://git.sudo.ws/sudo/commit/?id=db1608442)

* parse.c, parse.lex, parse.yacc, visudo.c:

  added group support
  [[7617fde66]](https://git.sudo.ws/sudo/commit/?id=7617fde66)

1995-12-15 Todd C. Miller

* check.c:

  tkfile was too short and overflowed the kerberos realm
  [[e8b95038f]](https://git.sudo.ws/sudo/commit/?id=e8b95038f)

1995-12-11 Todd C. Miller

* sudo.c:

  now copy command args directly from Argv
  [[206899d1d]](https://git.sudo.ws/sudo/commit/?id=206899d1d)

* sudo.c:

  replaced code to copy cmnd\_args so that is does not use realloc since
  most realloc()’s really stink
  [[0e9f9c7a4]](https://git.sudo.ws/sudo/commit/?id=0e9f9c7a4)

1995-12-08 Todd C. Miller

* configure.in:

  syslog() fixed in hpux 10.01
  [[ef4e6fbfa]](https://git.sudo.ws/sudo/commit/?id=ef4e6fbfa)

1995-12-06 Todd C. Miller

* configure.in:

  AC\_CHECK\_LIB() now sets SUDO\_LIBS (and VISUDO\_LIBS if appropriate)
  [[54d9ede9c]](https://git.sudo.ws/sudo/commit/?id=54d9ede9c)

* configure.in:

  better error if cannot find skey incs or libs
  [[4ef6206a1]](https://git.sudo.ws/sudo/commit/?id=4ef6206a1)

* aclocal.m4:

  now use a temp file for determining max len of uid\_t in string form. the
  old hacky way broke on netbsd
  [[23df4113c]](https://git.sudo.ws/sudo/commit/?id=23df4113c)

* sudo.c:

  added set of parens and a space
  [[1d04bad9c]](https://git.sudo.ws/sudo/commit/?id=1d04bad9c)

1995-12-05 Todd C. Miller

* dce\_pwent.c:

  fixes from Jeff Earickson <jaearick@…> ,
  [[c8b4bacee]](https://git.sudo.ws/sudo/commit/?id=c8b4bacee)

* check.c:

  modified a comment
  [[ffbfd5434]](https://git.sudo.ws/sudo/commit/?id=ffbfd5434)

* Makefile.in:

  fixed up testsudoers target
  [[1c5b326ff]](https://git.sudo.ws/sudo/commit/?id=1c5b326ff)

* configure.in:

  DCE changes from Jeff Earickson <jaearick@…> LIBS -> SUDO\_LIBS and
  VISUDO\_LIBS LDFLAGS -> SUDO\_FDFLAGS and VISUDO\_LDFLAGS
  [[792805deb]](https://git.sudo.ws/sudo/commit/?id=792805deb)

* Makefile.in:

  LIBS -> SUDO\_LIBS , VISUDO\_LIBS LDFLAGS -> SUDO\_LDFLAGS,
  VISUDO\_LDFLAGS
  [[7f19f036b]](https://git.sudo.ws/sudo/commit/?id=7f19f036b)

1995-11-28 Todd C. Miller

* configure.in:

  fix for C2 on hpux 10 now uses -linet if it exists
  [[86159a83f]](https://git.sudo.ws/sudo/commit/?id=86159a83f)

* check.c:

  LONG\_SKEY\_PROMPT is less of a klusge /
  [[d135a0bd1]](https://git.sudo.ws/sudo/commit/?id=d135a0bd1)

* configure.in:

  fixed typos w/ dce stuff
  [[17f433989]](https://git.sudo.ws/sudo/commit/?id=17f433989)

* Makefile.in:

  added dce\_pwent.c
  [[fa560d43b]](https://git.sudo.ws/sudo/commit/?id=fa560d43b)

1995-11-26 Todd C. Miller

* INSTALL:

  amended section on combining authentication mechanisms
  [[d0dbdb84f]](https://git.sudo.ws/sudo/commit/?id=d0dbdb84f)

* PORTING:

  minor updates for 1.3.6
  [[3187d13ad]](https://git.sudo.ws/sudo/commit/?id=3187d13ad)

* TROUBLESHOOTING:

  added 2 more entries
  [[88dfd93ad]](https://git.sudo.ws/sudo/commit/?id=88dfd93ad)

* BUGS:

  updated for 1.3.6
  [[d3a01db5d]](https://git.sudo.ws/sudo/commit/?id=d3a01db5d)

* README:

  overhauled
  [[cfc28644c]](https://git.sudo.ws/sudo/commit/?id=cfc28644c)

* INSTALL:

  rewrote for sudo 1.3.6
  [[c68baecaf]](https://git.sudo.ws/sudo/commit/?id=c68baecaf)

* TROUBLESHOOTING:

  added 3 entries
  [[c4e077ce0]](https://git.sudo.ws/sudo/commit/?id=c4e077ce0)

1995-11-25 Todd C. Miller

* find\_path.c, getspwuid.c, sudo.c:

  added explict casts for strdup since many includes don’t prototype it.
  gag me.
  [[d7716e975]](https://git.sudo.ws/sudo/commit/?id=d7716e975)

* sudo.h:

  removed prototype for sudo\_getpwuid() since convex C compiler choked on
  it.
  [[6b80b1c56]](https://git.sudo.ws/sudo/commit/?id=6b80b1c56)

* sudo.c:

  added prototype for sudo\_getpwuid()
  [[9f8332a19]](https://git.sudo.ws/sudo/commit/?id=9f8332a19)

* lsearch.c:

  now compiles on strict ANSI compilers
  [[808e27538]](https://git.sudo.ws/sudo/commit/?id=808e27538)

* check.c:

  added LONG\_SKEY\_PROMPT support
  [[6a414eaef]](https://git.sudo.ws/sudo/commit/?id=6a414eaef)

* Makefile.in:

  added extra $’s for make to eat up, yum.
  [[06f794982]](https://git.sudo.ws/sudo/commit/?id=06f794982)

* OPTIONS, options.h:

  added LONG\_SKEY\_PROMPT
  [[b0deb3be4]](https://git.sudo.ws/sudo/commit/?id=b0deb3be4)

1995-11-24 Todd C. Miller

* check.c:

  s/key support now works with normal s/key as well as logdaemon
  [[461d87164]](https://git.sudo.ws/sudo/commit/?id=461d87164)

* OPTIONS, options.h:

  added SKEY\_ONLY
  [[ba894df8b]](https://git.sudo.ws/sudo/commit/?id=ba894df8b)

* compat.h:

  set \_PASSWD\_LEN to 256 for any of KERB4, DCE, SKEY
  [[63a56ec6d]](https://git.sudo.ws/sudo/commit/?id=63a56ec6d)

* INSTALL:

  added DCE note added more AIX notes
  [[7c1c3bf03]](https://git.sudo.ws/sudo/commit/?id=7c1c3bf03)

* sudo.c:

  now include pthread.h for DCE support
  [[3ff093bde]](https://git.sudo.ws/sudo/commit/?id=3ff093bde)

* check.c:

  dce\_pwent() is ok after all .,
  [[cd1efe7d2]](https://git.sudo.ws/sudo/commit/?id=cd1efe7d2)

* logging.c:

  now uses SYSLOG() macro that equates to either syslog() or
  syslog\_wrapper
  [[9dd72728e]](https://git.sudo.ws/sudo/commit/?id=9dd72728e)

* dce\_pwent.c:

  minor formatting changes. renamed check() to somthing less generic
  [[8e58945ad]](https://git.sudo.ws/sudo/commit/?id=8e58945ad)

* check.c, logging.c, parse.yacc, sudo.c, sudo.h, testsudoers.c, visudo.c:
  now uses user\_pw\_ent and simple macros to get at the contents
  [[d6a223e2a]](https://git.sudo.ws/sudo/commit/?id=d6a223e2a)

1995-11-23 Todd C. Miller

* check.c:

  simpler dec unix C2 support
  [[57a4342e7]](https://git.sudo.ws/sudo/commit/?id=57a4342e7)

* getspwuid.c:

  now sets crypt\_type for DEC unix C2
  [[6a22027ee]](https://git.sudo.ws/sudo/commit/?id=6a22027ee)

1995-11-21 Todd C. Miller

* configure.in:

  added csops paths for skey
  [[4fda1d8ac]](https://git.sudo.ws/sudo/commit/?id=4fda1d8ac)

* getspwuid.c:

  now includes string.h for strdup() prototype
  [[eb09cb8fa]](https://git.sudo.ws/sudo/commit/?id=eb09cb8fa)

* getspwuid.c:

  fixed a few typos
  [[a8014ddfc]](https://git.sudo.ws/sudo/commit/?id=a8014ddfc)

* check.c:

  now includes skey.h
  [[b60cb8ec7]](https://git.sudo.ws/sudo/commit/?id=b60cb8ec7)

* getspwuid.c:

  fixed up comments
  [[310055043]](https://git.sudo.ws/sudo/commit/?id=310055043)

* check.c:

  moved a lot of the shadow passwd crap to sudo\_getpwuid()
  [[d058a9b04]](https://git.sudo.ws/sudo/commit/?id=d058a9b04)

* sudo.c:

  now uses sudo\_pw\_ent
  [[9dcee68e5]](https://git.sudo.ws/sudo/commit/?id=9dcee68e5)

* testsudoers.c:

  now uses sudo\_pw\_ent
  [[0542fa247]](https://git.sudo.ws/sudo/commit/?id=0542fa247)

* visudo.c:

  now sets sudo\_pw\_ent
  [[8104a5f13]](https://git.sudo.ws/sudo/commit/?id=8104a5f13)

* getspwuid.c:

  Initial revision
  [[cf8fd5937]](https://git.sudo.ws/sudo/commit/?id=cf8fd5937)

* tgetpass.c:

  moved dce stuff into compat.h
  [[333636652]](https://git.sudo.ws/sudo/commit/?id=333636652)

* logging.c, sudo.h:

  now uses sudo\_pw\_ent
  [[8b5caa700]](https://git.sudo.ws/sudo/commit/?id=8b5caa700)

* Makefile.in:

  added sudo\_getpwuid.c
  [[a6b5b2302]](https://git.sudo.ws/sudo/commit/?id=a6b5b2302)

* compat.h:

  added dce support
  [[787742ebf]](https://git.sudo.ws/sudo/commit/?id=787742ebf)

* parse.yacc:

  now uses sudo\_pw\_ent
  [[ddfc75753]](https://git.sudo.ws/sudo/commit/?id=ddfc75753)

1995-11-20 Todd C. Miller

* check.c:

  fixed exempt\_group stuff for OS’s that don’t put base gid in group
  vector
  [[4865f17ea]](https://git.sudo.ws/sudo/commit/?id=4865f17ea)

* check.c:

  S/Key support now works with sunos4 shadow passwords
  [[02bc955a1]](https://git.sudo.ws/sudo/commit/?id=02bc955a1)

* Makefile.in:

  fixed clean rule
  [[a72a93101]](https://git.sudo.ws/sudo/commit/?id=a72a93101)

* config.h.in, configure.in:

  added DCE support
  [[dfa3e6d8c]](https://git.sudo.ws/sudo/commit/?id=dfa3e6d8c)

* tgetpass.c:

  DCE & KERB support
  [[7dba81c21]](https://git.sudo.ws/sudo/commit/?id=7dba81c21)

* check.c:

  first stab at dce support
  [[ef7f00e9b]](https://git.sudo.ws/sudo/commit/?id=ef7f00e9b)

* dce\_pwent.c:

  now smells like sudo
  [[0a6a0021d]](https://git.sudo.ws/sudo/commit/?id=0a6a0021d)

* dce\_pwent.c:

  Initial revision
  [[84fd90f7a]](https://git.sudo.ws/sudo/commit/?id=84fd90f7a)

* check.c:

  skey’d sudo now works w/ normal password as well
  [[ac12f043f]](https://git.sudo.ws/sudo/commit/?id=ac12f043f)

1995-11-19 Todd C. Miller

* Makefile.in, OPTIONS, check.c, compat.h, config.h.in, find\_path.c,
  getwd.c, goodpath.c, ins\_2001.h, ins\_classic.h, ins\_csops.h,
  ins\_goons.h, insults.h, interfaces.c, logging.c, options.h, parse.c,
  parse.lex, parse.yacc, pathnames.h.in, putenv.c, strdup.c, sudo.c,
  sudo.h, sudo\_setenv.c, testsudoers.c, tgetpass.c, utime.c, version.h,
  visudo.c:

  updated version number
  [[9de4fd545]](https://git.sudo.ws/sudo/commit/?id=9de4fd545)

* README:

  updated to reflect version change
  [[6e4cb31d4]](https://git.sudo.ws/sudo/commit/?id=6e4cb31d4)

* configure.in:

  –with options now line up ++version
  [[6de61de5f]](https://git.sudo.ws/sudo/commit/?id=6de61de5f)

* sudo.h:

  removed unecesary S/Key stuff
  [[5675d703f]](https://git.sudo.ws/sudo/commit/?id=5675d703f)

* configure.in:

  fixed S/Key support
  [[ac8c65d15]](https://git.sudo.ws/sudo/commit/?id=ac8c65d15)

* Makefile.in:

  -I stuff now goes in CPPFLAGS
  [[baae3457a]](https://git.sudo.ws/sudo/commit/?id=baae3457a)

* check.c:

  fixed SKey support
  [[53ae703b7]](https://git.sudo.ws/sudo/commit/?id=53ae703b7)

* README:

  updated version
  [[402ce291c]](https://git.sudo.ws/sudo/commit/?id=402ce291c)

* OPTIONS:

  fixed description of EXEMPTGROUP
  [[3251001be]](https://git.sudo.ws/sudo/commit/?id=3251001be)

* sudo.c:

  more people use *RLD* than just alphas…
  [[e3f95518c]](https://git.sudo.ws/sudo/commit/?id=e3f95518c)

* Makefile.in:

  replaced $man\_prefix with $mandir
  [[5eb9954c2]](https://git.sudo.ws/sudo/commit/?id=5eb9954c2)

* configure.in:

  fixed a typo
  [[cec2ef656]](https://git.sudo.ws/sudo/commit/?id=cec2ef656)

* Makefile.in:

  now use more GNU’ish dir names
  [[db2cf11f5]](https://git.sudo.ws/sudo/commit/?id=db2cf11f5)

* configure.in:

  now set \*dir correctly (can override from command line)
  [[db7b85cb5]](https://git.sudo.ws/sudo/commit/?id=db7b85cb5)

* sudo.c:

  now deal with situations where we getwd() fails
  [[621d42205]](https://git.sudo.ws/sudo/commit/?id=621d42205)

1995-11-17 Todd C. Miller

* Makefile.in:

  added etc\_dir, bin\_dir, sbin\_dir
  [[7147ee96c]](https://git.sudo.ws/sudo/commit/?id=7147ee96c)

* configure.in:

  added sbin\_dir
  [[e0898a0db]](https://git.sudo.ws/sudo/commit/?id=e0898a0db)

* Makefile.in:

  now ship a flex-generated lex.yy.c
  [[e8ec31de0]](https://git.sudo.ws/sudo/commit/?id=e8ec31de0)

* Makefile.in:

  now sets \_PATH\_SUDO\_SUDOERS, \_PATH\_SUDO\_STMP, SUDOERS\_OWNER
  [[4e3a66387]](https://git.sudo.ws/sudo/commit/?id=4e3a66387)

* pathnames.h.in:

  \_PATH\_SUDO\_SUDOERS & \_PATH\_SUDO\_STMP are now overridden via Makefile
  [[fe45fd70c]](https://git.sudo.ws/sudo/commit/?id=fe45fd70c)

* options.h:

  no more error for redefining SUDOERS\_OWNER
  [[6b339fda9]](https://git.sudo.ws/sudo/commit/?id=6b339fda9)

* OPTIONS:

  expanded SUDOERS\_OWNER section
  [[f98507d06]](https://git.sudo.ws/sudo/commit/?id=f98507d06)

1995-11-16 Todd C. Miller

* visudo.c:

  now warn if chown(2) failed
  [[5d8180011]](https://git.sudo.ws/sudo/commit/?id=5d8180011)

* logging.c:

  better default warning for NO\_SUDOERS\_FILE
  [[15d1cc7a6]](https://git.sudo.ws/sudo/commit/?id=15d1cc7a6)

* sudo.c:

  added missing set\_perms() no more cryptic message if the sudoers file is
  zero length, now just give a parse error
  [[6475d4378]](https://git.sudo.ws/sudo/commit/?id=6475d4378)

* logging.c:

  better diagnostics if NO\_SUDOERS\_FILE
  [[d725ba8a5]](https://git.sudo.ws/sudo/commit/?id=d725ba8a5)

* sudo.c:

  check\_sudoers() now catches sudoers files that are not readable (but are
  stat’able).
  [[8285802f2]](https://git.sudo.ws/sudo/commit/?id=8285802f2)

1995-11-13 Todd C. Miller

* configure.in:

  now add -D\_\_STDC\_\_ for convex cc (not gcc)
  [[d05eae98b]](https://git.sudo.ws/sudo/commit/?id=d05eae98b)

* configure.in:

  MAN\_PREFIX -> man\_prefix now sets prefix and exec\_prefix
  [[910e9c09f]](https://git.sudo.ws/sudo/commit/?id=910e9c09f)

* Makefile.in:

  now uses exec\_prefix & prefix from configure
  [[4bdbf190f]](https://git.sudo.ws/sudo/commit/?id=4bdbf190f)

* find\_path.c, getwd.c, goodpath.c, interfaces.c, logging.c, parse.c,
  parse.lex, parse.yacc, sudo.c, sudo.h, sudo\_setenv.c, tgetpass.c,
  utime.c, visudo.c:

  options.h is now <> instead of "” so shadow build trees can have a
  custom copy of options.h
  [[96be725f3]](https://git.sudo.ws/sudo/commit/?id=96be725f3)

* check.c:

  user\_is\_exempt() is no longer a hack, it now uses getgrnam()
  [[7f847219c]](https://git.sudo.ws/sudo/commit/?id=7f847219c)

* options.h:

  EXEMPTGROUP is now “sudo”
  [[fed5c96f7]](https://git.sudo.ws/sudo/commit/?id=fed5c96f7)

* configure.in:

  MAN\_POSTINSTALL now contains a leading space
  [[e8b3cb701]](https://git.sudo.ws/sudo/commit/?id=e8b3cb701)

* Makefile.in:

  removed leading tab if @MAN\_POSTINSTALL@ not defined now removes
  testsudoers in clean:
  [[8f90254de]](https://git.sudo.ws/sudo/commit/?id=8f90254de)

* tgetpass.c:

  includes pwd.h to get \_PASSWD\_LEN definition
  [[6a6099ebb]](https://git.sudo.ws/sudo/commit/?id=6a6099ebb)

1995-10-30 Todd C. Miller

* sudo.c:

  unset the KRB\_CONF envariable if using kerberos so we don’t get spoofed
  into using a bogus server
  [[3003b4109]](https://git.sudo.ws/sudo/commit/?id=3003b4109)

1995-09-29 Todd C. Miller

* parse.yacc:

  now explicately initialize match[] tp be FALSE
  [[a14ba7447]](https://git.sudo.ws/sudo/commit/?id=a14ba7447)

1995-09-23 Todd C. Miller

* sudo.c:

  removed unused variable now passes -Wall
  [[5d691e1c4]](https://git.sudo.ws/sudo/commit/?id=5d691e1c4)

* parse.yacc:

  yyerror and dumpaliases are now void’s now passes -Wall
  [[4571b88d5]](https://git.sudo.ws/sudo/commit/?id=4571b88d5)

* parse.lex:

  added prototype for yyerror
  [[0fb7a2ee3]](https://git.sudo.ws/sudo/commit/?id=0fb7a2ee3)

* check.c, logging.c, parse.c:

  now passes -Wall
  [[02036880c]](https://git.sudo.ws/sudo/commit/?id=02036880c)

* interfaces.c:

  rmeoved unused cruft now passes -Wall
  [[f0ac53072]](https://git.sudo.ws/sudo/commit/?id=f0ac53072)

* Makefile.in:

  fixed headers that moved to emul dir
  [[87fbfbc19]](https://git.sudo.ws/sudo/commit/?id=87fbfbc19)

* logging.c:

  fixed deref of nil pointer if no args
  [[4b3c1201e]](https://git.sudo.ws/sudo/commit/?id=4b3c1201e)

1995-09-15 Todd C. Miller

* OPTIONS:

  added a caveat to FQDN section
  [[13b5f7de9]](https://git.sudo.ws/sudo/commit/?id=13b5f7de9)

1995-09-13 Todd C. Miller

* Makefile.in:

  more $srcdir support for install targets
  [[32204d965]](https://git.sudo.ws/sudo/commit/?id=32204d965)

* find\_path.c, interfaces.c, parse.c, parse.lex, parse.yacc, putenv.c,
  strdup.c, sudo.c, sudo\_setenv.c, testsudoers.c, visudo.c:

  don’t include malloc.h if we include stdlib.h
  [[211361a5f]](https://git.sudo.ws/sudo/commit/?id=211361a5f)

* parse.yacc:

  local search.h now lives in emul
  [[8a8926d92]](https://git.sudo.ws/sudo/commit/?id=8a8926d92)

* check.c, utime.c:

  local utime.h now lives in emul dir
  [[5a27e8bba]](https://git.sudo.ws/sudo/commit/?id=5a27e8bba)

* lsearch.c:

  local search.h now lives in emul
  [[23c122966]](https://git.sudo.ws/sudo/commit/?id=23c122966)

* Makefile.in:

  added support for building in other than the sourcedir
  [[c03629867]](https://git.sudo.ws/sudo/commit/?id=c03629867)

1995-09-10 Todd C. Miller

* OPTIONS:

  annotated CSOPS\_INSULTS option
  [[6024339b8]](https://git.sudo.ws/sudo/commit/?id=6024339b8)

* TROUBLESHOOTING:

  updated shadow passwords blurb
  [[592e98531]](https://git.sudo.ws/sudo/commit/?id=592e98531)

* sudo.c:

  if SHELL\_IF\_NO\_ARGS is set, “sudo – foo” now runs a shell and passes
  along foo as the arguments
  [[dff189d00]](https://git.sudo.ws/sudo/commit/?id=dff189d00)

1995-09-09 Todd C. Miller

* parse.lex:

  collapsed pathname and dir sections into one – its now less expensive
  [[ec56686b8]](https://git.sudo.ws/sudo/commit/?id=ec56686b8)

* parse.lex:

  fixed spacing quoting [,:\=] now works correctly append() and fill()
  now take args to make the above work
  [[08a934797]](https://git.sudo.ws/sudo/commit/?id=08a934797)

* sudo.c:

  fixed a typo that caused commands with no tty on fd 0 but a tty on fd 1
  to erroneously have “none” as their tty
  [[cc1ab5b5b]](https://git.sudo.ws/sudo/commit/?id=cc1ab5b5b)

1995-09-04 Todd C. Miller

* check.c:

  timestampfile is now a global static removed decl of timestampfile in
  remove\_timestamp since we can just use the global one
  [[63cfcdca9]](https://git.sudo.ws/sudo/commit/?id=63cfcdca9)

* check.c:

  created touch() to update timestamps added USE\_TTY\_TICKETS support (bit
  of a kludge)
  [[810bbee99]](https://git.sudo.ws/sudo/commit/?id=810bbee99)

* compat.h:

  added \_S\_IFDIR and S\_ISDIR
  [[cc30667ee]](https://git.sudo.ws/sudo/commit/?id=cc30667ee)

* OPTIONS, options.h:

  added USE\_TTY\_TICKETS
  [[9696360b4]](https://git.sudo.ws/sudo/commit/?id=9696360b4)

* parse.yacc:

  removed const from casts for lsearch() & lfind() to placate irix 4.x C
  compiler
  [[fa50c30f2]](https://git.sudo.ws/sudo/commit/?id=fa50c30f2)

1995-09-03 Todd C. Miller

* sudo.c:

  now only strip ‘/dev/’ off of a tty if it starts with ‘/dev/’
  [[33de10d52]](https://git.sudo.ws/sudo/commit/?id=33de10d52)

* pathnames.h.in:

  added \_PATH\_DEV
  [[1f0b6dbfd]](https://git.sudo.ws/sudo/commit/?id=1f0b6dbfd)

* configure.in:

  AC\_HAVE\_HEADERS -> AC\_CHECK\_HEADERS now check for tcgetattr only if
  have termios.h
  [[62b47b8b9]](https://git.sudo.ws/sudo/commit/?id=62b47b8b9)

* tgetpass.c:

  fixed incorrect #ifdef termio uses “unsigned short” not int for c\_?flag
  [[993b7e5ec]](https://git.sudo.ws/sudo/commit/?id=993b7e5ec)

* parse.lex, parse.yacc:

  fixed a spelling error
  [[f3268e58e]](https://git.sudo.ws/sudo/commit/?id=f3268e58e)

* Makefile.in:

  fixed typo
  [[963dd0e35]](https://git.sudo.ws/sudo/commit/?id=963dd0e35)

1995-09-02 Todd C. Miller

* Makefile.in:

  fixed a comment
  [[7c6446141]](https://git.sudo.ws/sudo/commit/?id=7c6446141)

* parse.yacc:

  added dotcat() to cat 2 strings w/ a dot effeciently now that we
  dynamically allocate strings they need to be free()’d
  [[4b39028f9]](https://git.sudo.ws/sudo/commit/?id=4b39028f9)

* parse.lex:

  dynamically allocates space for strings
  [[bc5adec09]](https://git.sudo.ws/sudo/commit/?id=bc5adec09)

* sudo.h:

  no more MAXCOMMANDLENGTH
  [[0ee553665]](https://git.sudo.ws/sudo/commit/?id=0ee553665)

* sudo.h:

  added decl of tty
  [[57d9cb9bf]](https://git.sudo.ws/sudo/commit/?id=57d9cb9bf)

* logging.c, sudo.c:

  moved tty stuff into sudo.c
  [[589f1d626]](https://git.sudo.ws/sudo/commit/?id=589f1d626)

1995-09-01 Todd C. Miller

* parse.c:

  fixed a logic bug. Was denying a command if user gave command line args
  but there were none in the sudoers file which is wrong.
  [[184dac958]](https://git.sudo.ws/sudo/commit/?id=184dac958)

* sudo.h:

  MAXCOMMMANDLEN dropped down to 1K
  [[24df673d9]](https://git.sudo.ws/sudo/commit/?id=24df673d9)

* parse.lex:

  return foo; -> return(foo);
  [[0df5364ca]](https://git.sudo.ws/sudo/commit/?id=0df5364ca)

* parse.yacc:

  fixed netgr\_matches() prototype
  [[8e59f998d]](https://git.sudo.ws/sudo/commit/?id=8e59f998d)

* parse.lex:

  added support for escaping “termination” characters
  [[dde7f1113]](https://git.sudo.ws/sudo/commit/?id=dde7f1113)

* parse.c:

  buf is now of size MAXPATHLEN+1 since it never holds command args
  [[4fb87b2fa]](https://git.sudo.ws/sudo/commit/?id=4fb87b2fa)

* sudo.c:

  fixed comments
  [[eaf845fd2]](https://git.sudo.ws/sudo/commit/?id=eaf845fd2)

* goodpath.c:

  fixed negation problem (doh!)
  [[d47330a7b]](https://git.sudo.ws/sudo/commit/?id=d47330a7b)

* parse.yacc:

  fixed 2nd parameter to lfind()
  [[08719aef1]](https://git.sudo.ws/sudo/commit/?id=08719aef1)

* parse.lex:

  now do bounds checking in fill() and append()
  [[023afc59e]](https://git.sudo.ws/sudo/commit/?id=023afc59e)

* sudo.c:

  include netdb.h as we should added a missing void cast added
  SHELL\_IF\_NO\_ARGS support now use realloc() properly. would fail if
  realloc actually moved the string instead of shrinking it
  [[57e17e71d]](https://git.sudo.ws/sudo/commit/?id=57e17e71d)

* sample.sudoers:

  updated with examples of new features
  [[035886c88]](https://git.sudo.ws/sudo/commit/?id=035886c88)

* goodpath.c:

  now set errno to EACCES if not a regular file or not executable
  [[3cf3a02c9]](https://git.sudo.ws/sudo/commit/?id=3cf3a02c9)

* find\_path.c:

  if given a fully-qualified or relative path we now check it with
  sudo\_goodpath() and error out with the appropriate error message if the
  file does not exist or is not executable
  [[a7b14880a]](https://git.sudo.ws/sudo/commit/?id=a7b14880a)

* emul/search.h, lsearch.c:

  now use correct args for lfind
  [[f55ea664c]](https://git.sudo.ws/sudo/commit/?id=f55ea664c)

* logging.c:

  added a comment
  [[0c690ddb8]](https://git.sudo.ws/sudo/commit/?id=0c690ddb8)

* insults.h:

  added in CSOps insults
  [[7785f5aa8]](https://git.sudo.ws/sudo/commit/?id=7785f5aa8)

* ins\_csops.h:

  Initial revision
  [[6c57ab6f9]](https://git.sudo.ws/sudo/commit/?id=6c57ab6f9)

* tgetpass.c:

  added RCS id
  [[38169ba0b]](https://git.sudo.ws/sudo/commit/?id=38169ba0b)

* sudo.h:

  increased MAXCOMMANDLENGTH to 8k HAVE\_GETCWD -> HAVE\_GETWD
  [[23c90d776]](https://git.sudo.ws/sudo/commit/?id=23c90d776)

* OPTIONS:

  added CLASSIC\_INSULTS, CSOPS\_INSULTS, SHELL\_IF\_NO\_ARGS
  [[43b4dfd76]](https://git.sudo.ws/sudo/commit/?id=43b4dfd76)

* sudo.c:

  fixed -k load\_interfaces() now gets called if FQDN is set -p now works
  with -s
  [[eb742282b]](https://git.sudo.ws/sudo/commit/?id=eb742282b)

* parse.c:

  don’t try to stat() “pseudo commands” like “validate”
  [[ffbade154]](https://git.sudo.ws/sudo/commit/?id=ffbade154)

* options.h:

  added CLASSIC\_INSULTS added CSOPS\_INSULTS added SHELL\_IF\_NO\_ARGS
  [[ed57e2a47]](https://git.sudo.ws/sudo/commit/?id=ed57e2a47)

* configure.in:

  added SecurID support added other insults to –with-csops
  [[2c45ad3a6]](https://git.sudo.ws/sudo/commit/?id=2c45ad3a6)

* config.h.in:

  added HAVE\_SECURID
  [[9460142f7]](https://git.sudo.ws/sudo/commit/?id=9460142f7)

* Makefile.in:

  added clobber target added ins\_csops.h now gets CFLAGS from configure
  [[f66ada034]](https://git.sudo.ws/sudo/commit/?id=f66ada034)

* aclocal.m4:

  relaxed SUDO\_FULL\_VOID
  [[6059ab504]](https://git.sudo.ws/sudo/commit/?id=6059ab504)

* visudo.c:

  function comment blocks are now in same style as rest of code
  [[85d528d35]](https://git.sudo.ws/sudo/commit/?id=85d528d35)

* testsudoers.c:

  added support for command line args in /etc/sudoers
  [[6ae45fad7]](https://git.sudo.ws/sudo/commit/?id=6ae45fad7)

* sudoers.man:

  updated to have command args in the sudoers file
  [[489923b34]](https://git.sudo.ws/sudo/commit/?id=489923b34)

* sudo.man:

  added -s and – flags added SHELL to ENVIRONMENT VARIABLES section
  [[2cd2d10e2]](https://git.sudo.ws/sudo/commit/?id=2cd2d10e2)

1995-08-19 Todd C. Miller

* parse.yacc:

  PATH renamed to COMMAND
  [[30215484c]](https://git.sudo.ws/sudo/commit/?id=30215484c)

* parse.lex:

  it is now a parse error for directories to have args attached to them
  [[cda9b243c]](https://git.sudo.ws/sudo/commit/?id=cda9b243c)

* logging.c:

  now say command args if telling user to buzz off
  [[723998be9]](https://git.sudo.ws/sudo/commit/?id=723998be9)

* sudo.c:

  -s no longer indicates end of args sped up loading on cmnd\_args in
  load\_cmnd()
  [[b79d33a5b]](https://git.sudo.ws/sudo/commit/?id=b79d33a5b)

* parse.c:

  removed an unreachable statement
  [[e5101444c]](https://git.sudo.ws/sudo/commit/?id=e5101444c)

* parse.lex:

  made more efficient by pulling out the terminators when in GOTCMND state
  and making them their own rule
  [[ed0730ba0]](https://git.sudo.ws/sudo/commit/?id=ed0730ba0)

1995-08-14 Todd C. Miller

* sudo.h:

  removed MAXLOGLEN since it is no longer used
  [[35d4d8e6b]](https://git.sudo.ws/sudo/commit/?id=35d4d8e6b)

* parse.lex:

  now allows command args
  [[35d2f76b1]](https://git.sudo.ws/sudo/commit/?id=35d2f76b1)

* parse.c:

  now groks command arguments
  [[564533bc7]](https://git.sudo.ws/sudo/commit/?id=564533bc7)

* logging.c:

  now sets tty correctly when piped input
  [[a7260a073]](https://git.sudo.ws/sudo/commit/?id=a7260a073)

* sudo.c:

  fixed loading of cmnd\_args (was including command name too)
  [[fee6ecbf0]](https://git.sudo.ws/sudo/commit/?id=fee6ecbf0)

* logging.c:

  fixed a core dump due to incorrect if construct
  [[bf3ef98ba]](https://git.sudo.ws/sudo/commit/?id=bf3ef98ba)

1995-08-13 Todd C. Miller

* configure.in:

  only add -lsun is irix < 5 don’t look for -lnsl or -lsocket if irix
  [[f1bd62ffb]](https://git.sudo.ws/sudo/commit/?id=f1bd62ffb)

* aclocal.m4:

  fixed check for ISC
  [[aa87fbdeb]](https://git.sudo.ws/sudo/commit/?id=aa87fbdeb)

* sudo.c:

  now sets cmnd\_args used by log\_error() and that will be used by the
  parse to check against command args
  [[f82ab3e8c]](https://git.sudo.ws/sudo/commit/?id=f82ab3e8c)

* sudo.h:

  added cmnd\_args
  [[c4286fc59]](https://git.sudo.ws/sudo/commit/?id=c4286fc59)

* logging.c:

  now dynamically allocate logline since we can guess at its size
  [[f912e0d98]](https://git.sudo.ws/sudo/commit/?id=f912e0d98)

1995-08-05 Todd C. Miller

* logging.c:

  cleaned up a bunch of unnecesary #ifdef’s eliminated a buffer remove
  “register” since the compiler knows more than I do now do a “basename”
  of the tty
  [[8163d81ab]](https://git.sudo.ws/sudo/commit/?id=8163d81ab)

1995-07-31 Todd C. Miller

* configure.in:

  ++version
  [[ba2059342]](https://git.sudo.ws/sudo/commit/?id=ba2059342)

* sudo.h:

  added shell extern changed MODE\_\* to be bit masks to allow for several
  options together
  [[78d3d79ac]](https://git.sudo.ws/sudo/commit/?id=78d3d79ac)

* sudo.c:

  added -s (shell) option made MODE\_\* masks so we can do bitwise & and |
  to see if multiple flags are set.
  [[8219db961]](https://git.sudo.ws/sudo/commit/?id=8219db961)

* check.c:

  added securid support
  [[68cdc96ff]](https://git.sudo.ws/sudo/commit/?id=68cdc96ff)

1995-07-30 Todd C. Miller

* logging.c:

  removed a bunch of unnecesary strncpy()’s and replaced with strcat()
  [[b42c06bb1]](https://git.sudo.ws/sudo/commit/?id=b42c06bb1)

1995-07-29 Todd C. Miller

* Makefile.in, version.h:

  ++version
  [[8e3717b14]](https://git.sudo.ws/sudo/commit/?id=8e3717b14)

1995-07-27 Todd C. Miller

* parse.yacc:

  fixed free() of an uninitialized pointer (yuck)
  [[15f6c5ef5]](https://git.sudo.ws/sudo/commit/?id=15f6c5ef5)

* testsudoers.c:

  added netgr\_matches
  [[5d8c7fe68]](https://git.sudo.ws/sudo/commit/?id=5d8c7fe68)

* parse.c:

  cleaned up netgr\_matches
  [[178e4a3c1]](https://git.sudo.ws/sudo/commit/?id=178e4a3c1)

1995-07-26 Todd C. Miller

* RUNSON:

  updated for 1.3.4
  [[d08b4b9f1]](https://git.sudo.ws/sudo/commit/?id=d08b4b9f1)

1995-07-25 Todd C. Miller

* Makefile.in:

  now installs sudoers.man – really should clean this up though.
  [[34b242a23]](https://git.sudo.ws/sudo/commit/?id=34b242a23)

* Makefile.in:

  added sudoers.cat and sudoers.man
  [[81a36b2d1]](https://git.sudo.ws/sudo/commit/?id=81a36b2d1)

* sudo.man:

  pulled out stuff on the sudoers file format into a separate man page
  [[5245392ea]](https://git.sudo.ws/sudo/commit/?id=5245392ea)

* sudoers.man:

  Initial revision
  [[bcfd0d604]](https://git.sudo.ws/sudo/commit/?id=bcfd0d604)

* HISTORY:

  fixed up my email address
  [[3b623d1da]](https://git.sudo.ws/sudo/commit/?id=3b623d1da)

* configure.in:

  added checks for innetgr and getdomainname
  [[c0435b95d]](https://git.sudo.ws/sudo/commit/?id=c0435b95d)

* visudo.c:

  added dummy netgr\_matches function
  [[99464ee08]](https://git.sudo.ws/sudo/commit/?id=99464ee08)

* parse.c:

  added netgr\_matches
  [[1b9251bea]](https://git.sudo.ws/sudo/commit/?id=1b9251bea)

* parse.lex, parse.yacc:

  added NETGROUP support
  [[ad2662ed8]](https://git.sudo.ws/sudo/commit/?id=ad2662ed8)

* config.h.in:

  added HAVE\_INNETGR & HAVE\_GETDOMAINNAME
  [[fc5299a5b]](https://git.sudo.ws/sudo/commit/?id=fc5299a5b)

1995-07-24 Todd C. Miller

* sudo.c:

  rewrote clean\_env() that has rm\_env() builtin
  [[dd9a16514]](https://git.sudo.ws/sudo/commit/?id=dd9a16514)

1995-07-23 Todd C. Miller

* check.c:

  now cast uid to long in sprintf
  [[4d96a2181]](https://git.sudo.ws/sudo/commit/?id=4d96a2181)

* OPTIONS:

  added \_INSULTS suffix to HAL & GOONS end
  [[cfed883f6]](https://git.sudo.ws/sudo/commit/?id=cfed883f6)

* options.h:

  added \_INSULTS suffix to HAL & GOONS
  [[52a3360e3]](https://git.sudo.ws/sudo/commit/?id=52a3360e3)

* ins\_2001.h, ins\_classic.h, ins\_goons.h, insults.h:

  converted to new scheme of insult “unions” end
  [[7b931ceaa]](https://git.sudo.ws/sudo/commit/?id=7b931ceaa)

* sudo.c:

  now uses MAX\_UID\_T\_LEN
  [[e70f526da]](https://git.sudo.ws/sudo/commit/?id=e70f526da)

* configure.in:

  added SUDO\_UID\_T\_LEN !l
  [[2ff580d88]](https://git.sudo.ws/sudo/commit/?id=2ff580d88)

* config.h.in:

  added MAX\_UID\_T\_LEN
  [[316e21468]](https://git.sudo.ws/sudo/commit/?id=316e21468)

* check.c:

  now use MAX\_UID\_T\_LEN
  [[b6f9d1d1a]](https://git.sudo.ws/sudo/commit/?id=b6f9d1d1a)

* aclocal.m4:

  added check for max len of uid\_t fixed sco vs. isc check
  [[6cda67389]](https://git.sudo.ws/sudo/commit/?id=6cda67389)

1995-07-19 Todd C. Miller

* configure.in:

  corrected version
  [[93347870a]](https://git.sudo.ws/sudo/commit/?id=93347870a)

* configure.in:

  added sco support
  [[09a11bf6d]](https://git.sudo.ws/sudo/commit/?id=09a11bf6d)

* aclocal.m4:

  hack to check for sco
  [[1f0c48184]](https://git.sudo.ws/sudo/commit/?id=1f0c48184)

* interfaces.c:

  removed #include <net/route.h> since it was hosing some OS’s
  [[9c631578e]](https://git.sudo.ws/sudo/commit/?id=9c631578e)

1995-07-18 Todd C. Miller

* find\_path.c:

  fixed prreadlink() prototype
  [[964e5aae9]](https://git.sudo.ws/sudo/commit/?id=964e5aae9)

* check.c:

  added parens in #if’s
  [[f6037dabc]](https://git.sudo.ws/sudo/commit/?id=f6037dabc)

* configure.in:

  added SPW\_ prefix
  [[568aeeec7]](https://git.sudo.ws/sudo/commit/?id=568aeeec7)

* sudo.h:

  moved SPW\_\* to config.h.in
  [[a03c27ecb]](https://git.sudo.ws/sudo/commit/?id=a03c27ecb)

* sudo.c:

  added a set of parens
  [[6555548e4]](https://git.sudo.ws/sudo/commit/?id=6555548e4)

* config.h.in:

  added SPW\_\*
  [[b53bdfe49]](https://git.sudo.ws/sudo/commit/?id=b53bdfe49)

* sudo.h:

  added SPW\_\* reordered error codes
  [[5e8d163cd]](https://git.sudo.ws/sudo/commit/?id=5e8d163cd)

* check.c:

  moved SPW\_\* to sudo.h
  [[415172f62]](https://git.sudo.ws/sudo/commit/?id=415172f62)

1995-07-17 Todd C. Miller

* sudo.c:

  SPW\_AUTH -> SPW\_SECUREWARE
  [[9b176c01e]](https://git.sudo.ws/sudo/commit/?id=9b176c01e)

* logging.c:

  GLOBAL\_NO\_AUTH\_ENT -> GLOBAL\_NO\_SPW\_ENT
  [[8a13a1ce6]](https://git.sudo.ws/sudo/commit/?id=8a13a1ce6)

* configure.in:

  AUTH -> SECUREWARE
  [[db9e49907]](https://git.sudo.ws/sudo/commit/?id=db9e49907)

* check.c:

  SPW\_AUTH -> SPW\_SECUREWARE
  [[56dcb8360]](https://git.sudo.ws/sudo/commit/?id=56dcb8360)

* check.c:

  now uses SHADOW\_TYPE to make shadow pw support more readable and
  modular. It’s a start…
  [[69f73dca3]](https://git.sudo.ws/sudo/commit/?id=69f73dca3)

* configure.in:

  added autodetection of shadow passwords
  [[19e032b9a]](https://git.sudo.ws/sudo/commit/?id=19e032b9a)

* sudo.c:

  now uses SHADOW\_TYPE define
  [[8e002084a]](https://git.sudo.ws/sudo/commit/?id=8e002084a)

* config.h.in:

  added SHADOW\_TYPE which replaces SUNOS4 & **svr4** defines
  [[f4f8eac02]](https://git.sudo.ws/sudo/commit/?id=f4f8eac02)

* aclocal.m4:

  added SUDO\_CHECK\_SHADOW
  [[17a7c74d5]](https://git.sudo.ws/sudo/commit/?id=17a7c74d5)

1995-07-12 Todd C. Miller

* configure.in:

  define SVR4 for ISC define BROKEN\_SYSLOG for hpux took out test for
  memmove() since we dno longer use it…
  [[59dcca855]](https://git.sudo.ws/sudo/commit/?id=59dcca855)

* CHANGES:

  updated
  [[676ca1e9f]](https://git.sudo.ws/sudo/commit/?id=676ca1e9f)

* logging.c:

  added BROKEN\_SYSLOG support
  [[aac8b5fc9]](https://git.sudo.ws/sudo/commit/?id=aac8b5fc9)

* config.h.in:

  added BROKEN\_SYSLOG
  [[0df6a284b]](https://git.sudo.ws/sudo/commit/?id=0df6a284b)

* check.c:

  now only bitch it timestamp > time\_now + 2 \* timeout to allow for a
  machine udpating its time from a server
  [[b5ea3c824]](https://git.sudo.ws/sudo/commit/?id=b5ea3c824)

* sudo.man:

  added 2 security notes updated Nieusma’s email addr
  [[82cb03da2]](https://git.sudo.ws/sudo/commit/?id=82cb03da2)

* lsearch.c:

  changed a memmove() to memcpy() since we don’t have to worry about
  overlapping segments.
  [[9bde08229]](https://git.sudo.ws/sudo/commit/?id=9bde08229)

1995-07-11 Todd C. Miller

* interfaces.c:

  cleanup up the loop when interfaces are groped in so that it is readable
  [[63893680d]](https://git.sudo.ws/sudo/commit/?id=63893680d)

* Makefile.in, version.h:

  ++version
  [[17b7225c7]](https://git.sudo.ws/sudo/commit/?id=17b7225c7)

1995-07-09 Todd C. Miller

* CHANGES:

  annotated 124-126
  [[8d2e68cbb]](https://git.sudo.ws/sudo/commit/?id=8d2e68cbb)

1995-07-07 Todd C. Miller

* check.c:

  fixed permissions check on /tmp/.odus
  [[14ec8cc12]](https://git.sudo.ws/sudo/commit/?id=14ec8cc12)

1995-07-06 Todd C. Miller

* check.c:

  fixed some comments
  [[77577c970]](https://git.sudo.ws/sudo/commit/?id=77577c970)

* check.c:

  now checks owner & mode of timedir also checks for bogus dates on
  timestamp file
  [[fc15f54aa]](https://git.sudo.ws/sudo/commit/?id=fc15f54aa)

* OPTIONS:

  updated TIMEOUT info
  [[5681ddef0]](https://git.sudo.ws/sudo/commit/?id=5681ddef0)

* logging.c, sudo.h:

  added BAD\_STAMPDIR and BAD\_STAMPFILE
  [[05bea6375]](https://git.sudo.ws/sudo/commit/?id=05bea6375)

* compat.h:

  added definition of S\_IRWXU
  [[c76d6d4e2]](https://git.sudo.ws/sudo/commit/?id=c76d6d4e2)

* CHANGES:

  updated
  [[edee3fe6d]](https://git.sudo.ws/sudo/commit/?id=edee3fe6d)

1995-07-03 Todd C. Miller

* interfaces.c:

  added #ifdef to make it compile on strange arches
  [[ba502e7de]](https://git.sudo.ws/sudo/commit/?id=ba502e7de)

1995-07-02 Todd C. Miller

* aclocal.m4:

  fixed check for fulkl void impl.
  [[0c39d1e66]](https://git.sudo.ws/sudo/commit/?id=0c39d1e66)

* check.c:

  added mssing “static”
  [[237080124]](https://git.sudo.ws/sudo/commit/?id=237080124)

* insults.h:

  replaced #elif with #else #if constructs for ancient C compilers
  [[001cbba28]](https://git.sudo.ws/sudo/commit/?id=001cbba28)

* INSTALL:

  updated irix c2 & kerb5 info
  [[8923092f7]](https://git.sudo.ws/sudo/commit/?id=8923092f7)

* configure.in:

  added shadow pw support for irix
  [[a5424b506]](https://git.sudo.ws/sudo/commit/?id=a5424b506)

1995-07-01 Todd C. Miller

* BUGS, TODO:

  updated
  [[9e232c80a]](https://git.sudo.ws/sudo/commit/?id=9e232c80a)

* CHANGES:

  last changes for sudo 1.3.3
  [[372332a8e]](https://git.sudo.ws/sudo/commit/?id=372332a8e)

* configure.in:

  now calls SUDO\_SOCK\_SA\_LEN
  [[f6f708d9c]](https://git.sudo.ws/sudo/commit/?id=f6f708d9c)

* config.h.in:

  added HAVE\_SA\_LEN
  [[05543559e]](https://git.sudo.ws/sudo/commit/?id=05543559e)

* aclocal.m4:

  added SUDO\_SOCK\_SA\_LEN
  [[16768b25a]](https://git.sudo.ws/sudo/commit/?id=16768b25a)

* interfaces.c:

  now works with ip implementations that use sa\_len in sockaddr
  [[3a0993f0e]](https://git.sudo.ws/sudo/commit/?id=3a0993f0e)

* INSTALL:

  added note about buggy AIX compiler
  [[27f0a0437]](https://git.sudo.ws/sudo/commit/?id=27f0a0437)

* interfaces.c:

  now include sys/time.h for AIX
  [[70da65274]](https://git.sudo.ws/sudo/commit/?id=70da65274)

1995-06-28 Todd C. Miller

* Makefile.in:

  getcwd -> getwd
  [[4c82d0e4d]](https://git.sudo.ws/sudo/commit/?id=4c82d0e4d)

* interfaces.c:

  now works for ISC and others. yay.
  [[ec568f270]](https://git.sudo.ws/sudo/commit/?id=ec568f270)

1995-06-26 Todd C. Miller

* Makefile.in, version.h:

  version++
  [[1656c457a]](https://git.sudo.ws/sudo/commit/?id=1656c457a)

1995-06-23 Todd C. Miller

* aclocal.m4:

  fixed test for full void impl
  [[c96837917]](https://git.sudo.ws/sudo/commit/?id=c96837917)

* sudo.c:

  now check to see that st\_dev is non-zero before assuming that we are
  being spoofed
  [[4c67e31d9]](https://git.sudo.ws/sudo/commit/?id=4c67e31d9)

1995-06-20 Todd C. Miller

* aclocal.m4, configure.in:

  SUDO\_FUNC\_UTIME\_NULL -> AC\_FUNC\_UTIME\_NULL
  [[cbec8fc76]](https://git.sudo.ws/sudo/commit/?id=cbec8fc76)

1995-06-19 Todd C. Miller

* aclocal.m4:

  fixed include file order for SUDO\_FUNC\_UTIME\_POSIX
  [[51dd620a8]](https://git.sudo.ws/sudo/commit/?id=51dd620a8)

* logging.c:

  added cast for ttyname()
  [[b37760089]](https://git.sudo.ws/sudo/commit/?id=b37760089)

* configure.in:

  fixed typo
  [[20c9ac303]](https://git.sudo.ws/sudo/commit/?id=20c9ac303)

* check.c:

  now deal correctly with all known variation of utime() – yippe
  [[a6dbb5d20]](https://git.sudo.ws/sudo/commit/?id=a6dbb5d20)

* configure.in:

  added SUDO\_FUNC\_UTIME\_POSIX
  [[4ece0da6b]](https://git.sudo.ws/sudo/commit/?id=4ece0da6b)

* aclocal.m4:

  added SUDO\_FUNC\_UTIME\_NULL and SUDO\_FUNC\_UTIME\_POSIX
  [[4a6f9ff55]](https://git.sudo.ws/sudo/commit/?id=4a6f9ff55)

* config.h.in:

  added HAVE\_UTIME\_POSIX
  [[0882a4f14]](https://git.sudo.ws/sudo/commit/?id=0882a4f14)

* check.c:

  fixed a typo
  [[db30358dd]](https://git.sudo.ws/sudo/commit/?id=db30358dd)

* check.c:

  no longer assume !HAVE\_UTIME\_NULL means old BSD utime()
  [[11ab938fa]](https://git.sudo.ws/sudo/commit/?id=11ab938fa)

* check.c:

  fixed fascist C compiler warning
  [[44ce99e44]](https://git.sudo.ws/sudo/commit/?id=44ce99e44)

* interfaces.c:

  now set strioctl.ic\_timout in STRSET() now initialize num\_interfaces to
  0 (just to be anal)
  [[5986e74e4]](https://git.sudo.ws/sudo/commit/?id=5986e74e4)

1995-06-18 Todd C. Miller

* sudo.h:

  increaed MAXLOGLEN by MAXPATHLEN to account for ttyname
  [[5114bdf3a]](https://git.sudo.ws/sudo/commit/?id=5114bdf3a)

* logging.c:

  added tty logging
  [[9a22c6ba1]](https://git.sudo.ws/sudo/commit/?id=9a22c6ba1)

* interfaces.c:

  reworked the ISC code
  [[34eaa537d]](https://git.sudo.ws/sudo/commit/?id=34eaa537d)

* Makefile.in, version.h:

  updated version
  [[40d5ad5fb]](https://git.sudo.ws/sudo/commit/?id=40d5ad5fb)

* check.c:

  now expect old-style utime(3) if utime() can’t take NULL as an arg
  [[3e30f821d]](https://git.sudo.ws/sudo/commit/?id=3e30f821d)

* configure.in:

  added check for utime.h
  [[66dcba0b7]](https://git.sudo.ws/sudo/commit/?id=66dcba0b7)

* config.h.in:

  added HAVE\_UTIME\_H
  [[14bfd8b7a]](https://git.sudo.ws/sudo/commit/?id=14bfd8b7a)

* Makefile.in:

  added CPPFLAGS STATIC\_FLAGS -> LDFLAGS
  [[53807380c]](https://git.sudo.ws/sudo/commit/?id=53807380c)

* configure.in:

  now search for kerb libs and includes
  [[1a19c778d]](https://git.sudo.ws/sudo/commit/?id=1a19c778d)

* check.c:

  added support for utime(2)’s that can’t take a NULL parameter
  [[403a90802]](https://git.sudo.ws/sudo/commit/?id=403a90802)

* utime.c:

  moved HAVE\_UTIME\_NULL stuff to update\_timestamp() where t belongs
  [[8ff79b51e]](https://git.sudo.ws/sudo/commit/?id=8ff79b51e)

* configure.in:

  added utime(s) stuff
  [[07c8eb771]](https://git.sudo.ws/sudo/commit/?id=07c8eb771)

* check.c:

  now use utime()
  [[24047697d]](https://git.sudo.ws/sudo/commit/?id=24047697d)

* config.h.in:

  added HAVE\_UTIME and HAVE\_UTIME\_NULL
  [[0b7bd3d22]](https://git.sudo.ws/sudo/commit/?id=0b7bd3d22)

1995-06-17 Todd C. Miller

* utime.c:

  now use HAVE\_UTIME\_NULL
  [[d08febb0f]](https://git.sudo.ws/sudo/commit/?id=d08febb0f)

* emul/utime.h, utime.c:

  Initial revision
  [[9df83c3d6]](https://git.sudo.ws/sudo/commit/?id=9df83c3d6)

* check.c:

  need to setuid(0) to make kerb4 stuff work.
  [[a7c2a548a]](https://git.sudo.ws/sudo/commit/?id=a7c2a548a)

* tgetpass.c:

  no more special case for kerberos
  [[c56b2c446]](https://git.sudo.ws/sudo/commit/?id=c56b2c446)

* config.h.in:

  took out setreuid and setresuid stuff added kerb5 stuff (use kerb4
  emulation)
  [[88201485c]](https://git.sudo.ws/sudo/commit/?id=88201485c)

* compat.h:

  no longer need setreuid() emulation now set \_PASSWD\_LEN to 128 if
  kerberos
  [[eb7a72d97]](https://git.sudo.ws/sudo/commit/?id=eb7a72d97)

* check.c:

  now use private ticket file for kerberos support to avoid trouncing on
  system one
  [[10a2f6e7d]](https://git.sudo.ws/sudo/commit/?id=10a2f6e7d)

1995-06-15 Todd C. Miller

* sudo.h:

  added SPOOF\_ATTEMPT & cmnd\_st
  [[3e2eb0013]](https://git.sudo.ws/sudo/commit/?id=3e2eb0013)

* sudo.c:

  added anti-spoofing support
  [[b122474e4]](https://git.sudo.ws/sudo/commit/?id=b122474e4)

* parse.c:

  now use global cmnd\_st
  [[77f4bbc68]](https://git.sudo.ws/sudo/commit/?id=77f4bbc68)

* logging.c:

  added SPOOF\_ATTEMPT suypport
  [[0b4722346]](https://git.sudo.ws/sudo/commit/?id=0b4722346)

* testsudoers.c, visudo.c:

  added void casts where appropriate
  [[6115fb5d4]](https://git.sudo.ws/sudo/commit/?id=6115fb5d4)

* parse.yacc:

  fixed up spacing and added void casts where appropriate
  [[a81984983]](https://git.sudo.ws/sudo/commit/?id=a81984983)

* sudo.c:

  fixed problem with “-p prompt” but no args
  [[42b3a170e]](https://git.sudo.ws/sudo/commit/?id=42b3a170e)

1995-06-14 Todd C. Miller

* sudo.man:

  added BUGS and annotated -l description
  [[8adfa4e1d]](https://git.sudo.ws/sudo/commit/?id=8adfa4e1d)

* sudo.h:

  validate() now takes a flag
  [[91e4fbc50]](https://git.sudo.ws/sudo/commit/?id=91e4fbc50)

* sudo.c:

  validate() now takes a flag added -l
  [[d3e338f2f]](https://git.sudo.ws/sudo/commit/?id=d3e338f2f)

* parse.yacc:

  added support for -l
  [[4c84f2143]](https://git.sudo.ws/sudo/commit/?id=4c84f2143)

* parse.c:

  validate() now takes a flag that says whether or not to check the
  command
  [[b7660fc07]](https://git.sudo.ws/sudo/commit/?id=b7660fc07)

1995-06-08 Todd C. Miller

* logging.c:

  now deals with Argv == 1
  [[7f5a33a01]](https://git.sudo.ws/sudo/commit/?id=7f5a33a01)

* sudo.man:

  added -p option
  [[0a94dbed5]](https://git.sudo.ws/sudo/commit/?id=0a94dbed5)

* sudo.c:

  added prompt support reworked parse\_args()
  [[337897e2d]](https://git.sudo.ws/sudo/commit/?id=337897e2d)

* sudo.h:

  added prompt
  [[d66c79ce2]](https://git.sudo.ws/sudo/commit/?id=d66c79ce2)

* options.h:

  added PASSPROMPT
  [[bbd0744ef]](https://git.sudo.ws/sudo/commit/?id=bbd0744ef)

* check.c:

  now use BUFSIZ as length of kerb password added kpass so pass is always
  a char \* now use prompt global when asking for a password
  [[ffbac45a4]](https://git.sudo.ws/sudo/commit/?id=ffbac45a4)

* tgetpass.c:

  now use BUFSIZ as \_PASSWD\_LEN if using kerberos
  [[579fa5cc3]](https://git.sudo.ws/sudo/commit/?id=579fa5cc3)

* OPTIONS:

  added PASSPROMPT
  [[378732007]](https://git.sudo.ws/sudo/commit/?id=378732007)

1995-06-07 Todd C. Miller

* configure.in:

  only look for -lufc or -lcrypt if crypt() not in libc
  [[171f81153]](https://git.sudo.ws/sudo/commit/?id=171f81153)

* check.c:

  don’t exit on kerb error, just warn if k\_errno == KDC\_PR\_UNKNOWN
  (unknown user) silently fail
  [[131a4affd]](https://git.sudo.ws/sudo/commit/?id=131a4affd)

* INSTALL:

  added kerb4 note
  [[2a67a0f93]](https://git.sudo.ws/sudo/commit/?id=2a67a0f93)

* tgetpass.c:

  HAVE\_KERBEROS -> HAVE\_KERB4
  [[f5f05a899]](https://git.sudo.ws/sudo/commit/?id=f5f05a899)

* check.c:

  removed debugging printf
  [[5d132edc1]](https://git.sudo.ws/sudo/commit/?id=5d132edc1)

* configure.in:

  KERBEROS -> KERB4 added checks for setreuid & setresuid
  [[ca4368dd8]](https://git.sudo.ws/sudo/commit/?id=ca4368dd8)

* config.h.in:

  HAVE\_KERBEROS -> HAVE\_KERB4 added HAVE\_SETREUID and HAVE\_SETRESUID
  [[71f08751c]](https://git.sudo.ws/sudo/commit/?id=71f08751c)

* compat.h:

  added deif of UID\_NO\_CHANGE & GID\_NO\_CHANGE added setreuid emulation
  with setresuid if applic
  [[9d7f497c5]](https://git.sudo.ws/sudo/commit/?id=9d7f497c5)

* check.c:

  HAVE\_KERBEROS -> HAVE\_KERB4 now only do the stupid chown() hack if no
  setreuid() or a broken one
  [[32a7316a0]](https://git.sudo.ws/sudo/commit/?id=32a7316a0)

1995-06-06 Todd C. Miller

* configure.in:

  added kerberos support
  [[2513e340f]](https://git.sudo.ws/sudo/commit/?id=2513e340f)

* config.h.in:

  added HAVE\_KERBEROS
  [[792d8d434]](https://git.sudo.ws/sudo/commit/?id=792d8d434)

* tgetpass.c:

  added KERBEROS support (long passwords)
  [[bb62e6b4c]](https://git.sudo.ws/sudo/commit/?id=bb62e6b4c)

* check.c:

  added kerberos support
  [[2e1a47e33]](https://git.sudo.ws/sudo/commit/?id=2e1a47e33)

1995-06-03 Todd C. Miller

* sudo.h:

  added MODE\_BACKGROUND
  [[ad9a0eef3]](https://git.sudo.ws/sudo/commit/?id=ad9a0eef3)

* sudo.man:

  escaped dashes added -b option
  [[b3c96d7ea]](https://git.sudo.ws/sudo/commit/?id=b3c96d7ea)

* sudo.c:

  added -b option
  [[c60704dcc]](https://git.sudo.ws/sudo/commit/?id=c60704dcc)

* check.c:

  added crypt() for osf/1 3.x enhanced secuiry
  [[e776214bf]](https://git.sudo.ws/sudo/commit/?id=e776214bf)

* configure.in:

  now check for -lcrypt
  [[c5f8f7e8e]](https://git.sudo.ws/sudo/commit/?id=c5f8f7e8e)

* interfaces.c:

  added ENXIO like EADDRNOTAVAIL
  [[545d39191]](https://git.sudo.ws/sudo/commit/?id=545d39191)

1995-05-08 Todd C. Miller

* configure.in:

  now emulate getwd(), not getcwd()
  [[7d51f8373]](https://git.sudo.ws/sudo/commit/?id=7d51f8373)

* sudo.c:

  getcwd() -> getwd()
  [[a2ec4c76d]](https://git.sudo.ws/sudo/commit/?id=a2ec4c76d)

* getwd.c:

  getcwd -> getwd
  [[69e9c49d3]](https://git.sudo.ws/sudo/commit/?id=69e9c49d3)

1995-05-02 Todd C. Miller

* ins\_2001.h, ins\_classic.h, ins\_goons.h:

  Initial revision
  [[d87459b87]](https://git.sudo.ws/sudo/commit/?id=d87459b87)

* insults.h:

  broke out insults into separate include files
  [[638177948]](https://git.sudo.ws/sudo/commit/?id=638177948)

* OPTIONS, options.h:

  added GOONS
  [[61beb65fb]](https://git.sudo.ws/sudo/commit/?id=61beb65fb)

* Makefile.in:

  added ins\_2001.h ins\_classic.h ins\_goons.h
  [[edcbd9935]](https://git.sudo.ws/sudo/commit/?id=edcbd9935)

* Makefile.in, version.h:

  ++version
  [[18dee8405]](https://git.sudo.ws/sudo/commit/?id=18dee8405)

* visudo.c:

  moved signal handler setup to setup\_signals()
  [[5047747d5]](https://git.sudo.ws/sudo/commit/?id=5047747d5)

* sudo.h:

  added load\_interfaces()
  [[aff6b07d4]](https://git.sudo.ws/sudo/commit/?id=aff6b07d4)

* sudo.c:

  moved load\_interfaces to interfaces.c
  [[aaa41e678]](https://git.sudo.ws/sudo/commit/?id=aaa41e678)

* parse.yacc:

  added clearaliases
  [[923bd0d3e]](https://git.sudo.ws/sudo/commit/?id=923bd0d3e)

* OPTIONS, options.h:

  added FAST\_MATCH
  [[b541399b4]](https://git.sudo.ws/sudo/commit/?id=b541399b4)

* parse.lex:

  now uses clearaliases variable
  [[513a1c7e9]](https://git.sudo.ws/sudo/commit/?id=513a1c7e9)

* interfaces.c:

  Initial revision
  [[0613d37b4]](https://git.sudo.ws/sudo/commit/?id=0613d37b4)

* Makefile.in:

  added interfaces.[co]
  [[08a953c95]](https://git.sudo.ws/sudo/commit/?id=08a953c95)

* testsudoers.c:

  now uses ip addrs and netmasks via load\_interfaces()
  [[1250db5a9]](https://git.sudo.ws/sudo/commit/?id=1250db5a9)

* sudo.c:

  now remove IFS instead of setting to “sane” value
  [[e991fcfa7]](https://git.sudo.ws/sudo/commit/?id=e991fcfa7)

1995-05-01 Todd C. Miller

* parse.c:

  added FAST\_MATCH
  [[4a37e0c32]](https://git.sudo.ws/sudo/commit/?id=4a37e0c32)

1995-04-30 Todd C. Miller

* Makefile.in:

  sudo\_goodpath.c-> goodpath.c
  [[53cab8546]](https://git.sudo.ws/sudo/commit/?id=53cab8546)

* sudo.c:

  added Andy’s new ISC changes
  [[431c0a7e5]](https://git.sudo.ws/sudo/commit/?id=431c0a7e5)

1995-04-14 Todd C. Miller

* OPTIONS:

  added a sentence to SECURE\_PATH info
  [[c93d5f806]](https://git.sudo.ws/sudo/commit/?id=c93d5f806)

* BUGS:

  added one
  [[8c96a3142]](https://git.sudo.ws/sudo/commit/?id=8c96a3142)

* CHANGES:

  updated
  [[f90710c26]](https://git.sudo.ws/sudo/commit/?id=f90710c26)

* RUNSON:

  updated
  [[b32d8ae6a]](https://git.sudo.ws/sudo/commit/?id=b32d8ae6a)

1995-04-13 Todd C. Miller

* RUNSON:

  updated for beta3
  [[d06ece937]](https://git.sudo.ws/sudo/commit/?id=d06ece937)

* Makefile.in, version.h:

  ++version
  [[d1136057f]](https://git.sudo.ws/sudo/commit/?id=d1136057f)

* aclocal.m4:

  sendmail is now looked for in /usr/ucblib
  [[97fe29dc9]](https://git.sudo.ws/sudo/commit/?id=97fe29dc9)

* sudo.c:

  fixed indentation
  [[d562e7ff7]](https://git.sudo.ws/sudo/commit/?id=d562e7ff7)

* aclocal.m4:

  fixed a typo
  [[b4f1460d6]](https://git.sudo.ws/sudo/commit/?id=b4f1460d6)

* sudo.c:

  updated ISC mods
  [[52b6b6965]](https://git.sudo.ws/sudo/commit/?id=52b6b6965)

* configure.in:

  added unixware case
  [[803fd573b]](https://git.sudo.ws/sudo/commit/?id=803fd573b)

* check.c:

  user\_is\_exempt is no longer hidden
  [[c34759834]](https://git.sudo.ws/sudo/commit/?id=c34759834)

* RUNSON:

  updated
  [[a82cc716e]](https://git.sudo.ws/sudo/commit/?id=a82cc716e)

* aclocal.m4:

  isc and riscos changes
  [[2fada0f81]](https://git.sudo.ws/sudo/commit/?id=2fada0f81)

* OPTIONS:

  added NOTE about new interaction of EXEMPTGROUP and SECURE\_PATH
  [[849adcde2]](https://git.sudo.ws/sudo/commit/?id=849adcde2)

* Makefile.in:

  fixed a typo and added testsudoers stuff
  [[029096a2c]](https://git.sudo.ws/sudo/commit/?id=029096a2c)

* testsudoers.c:

  Initial revision
  [[37eab2662]](https://git.sudo.ws/sudo/commit/?id=37eab2662)

1995-04-12 Todd C. Miller

* parse.yacc:

  applied fixed patch from Chris
  [[19e806c2e]](https://git.sudo.ws/sudo/commit/?id=19e806c2e)

1995-04-11 Todd C. Miller

* Makefile.in:

  fixed a typo
  [[84eee6209]](https://git.sudo.ws/sudo/commit/?id=84eee6209)

* parse.yacc:

  added a set of braces for bison
  [[8b380a172]](https://git.sudo.ws/sudo/commit/?id=8b380a172)

* parse.yacc:

  merged in Chris’ changes to dekludge the parser.
  [[d70bb866d]](https://git.sudo.ws/sudo/commit/?id=d70bb866d)

* logging.c:

  send\_mail() was calling find\_path() which is wrong since find\_path()
  stores cmnd in a static var. Anyhow, it doesn’t make much sense since
  MAILER should always be fully qualified
  [[f200df002]](https://git.sudo.ws/sudo/commit/?id=f200df002)

1995-04-10 Todd C. Miller

* sample.sudoers:

  added User\_Alias stuff
  [[9d82a8dac]](https://git.sudo.ws/sudo/commit/?id=9d82a8dac)

* aclocal.m4:

  SUDO\_NEXT now looks for /usr/lib/NextStep/software\_version
  [[aa3186a8e]](https://git.sudo.ws/sudo/commit/?id=aa3186a8e)

* RUNSON:

  added DEC UNIX 3.0 w/ gcc
  [[dc01e4b77]](https://git.sudo.ws/sudo/commit/?id=dc01e4b77)

* visudo.c:

  Exit was being used in places where exit should be used
  [[7ab29f4c7]](https://git.sudo.ws/sudo/commit/?id=7ab29f4c7)

* sudoers:

  added “User alias specification”
  [[942182265]](https://git.sudo.ws/sudo/commit/?id=942182265)

* parse.yacc:

  fixed probs caused by making nslots and naliases a size\_t
  [[a783a139f]](https://git.sudo.ws/sudo/commit/?id=a783a139f)

* RUNSON:

  added KSR, upped rev to 1.3.1b2
  [[31ed7f457]](https://git.sudo.ws/sudo/commit/?id=31ed7f457)

* logging.c, parse.yacc:

  1024 -> BUFSIZ
  [[27b183432]](https://git.sudo.ws/sudo/commit/?id=27b183432)

* parse.yacc:

  void \* -> VOID \* naliases and nslots are now size\_t to appease lsearch
  on 64-bit machines
  [[6cb2afdad]](https://git.sudo.ws/sudo/commit/?id=6cb2afdad)

1995-04-09 Todd C. Miller

* TODO:

  did a bunch of things and added a bunch :-)
  [[ef44ca921]](https://git.sudo.ws/sudo/commit/?id=ef44ca921)

* PORTING:

  updated
  [[5e3afabe4]](https://git.sudo.ws/sudo/commit/?id=5e3afabe4)

* visudo.man:

  closer to BSD manpage style
  [[83c920618]](https://git.sudo.ws/sudo/commit/?id=83c920618)

* sudo.man:

  closer to standard BSD man format
  [[40b035adc]](https://git.sudo.ws/sudo/commit/?id=40b035adc)

* compat.h, config.h.in, emul/search.h, insults.h, options.h,
  pathnames.h.in, sudo.h, version.h:

  added RCS id
  [[f08ab58ba]](https://git.sudo.ws/sudo/commit/?id=f08ab58ba)

* sudo.h:

  removed crufty #defines that are no longer used
  [[cdaae28ef]](https://git.sudo.ws/sudo/commit/?id=cdaae28ef)

* BUGS:

  fixed a bug
  [[620997189]](https://git.sudo.ws/sudo/commit/?id=620997189)

* sudo.man:

  updated based on sudo changes
  [[ba0bce3a6]](https://git.sudo.ws/sudo/commit/?id=ba0bce3a6)

* parse.yacc:

  now allow ALL keyword in User\_Aliases now allow ALL keyword as well as a
  NAME or ALIAS
  [[557d431e2]](https://git.sudo.ws/sudo/commit/?id=557d431e2)

* CHANGES:

  updated
  [[a23cda72e]](https://git.sudo.ws/sudo/commit/?id=a23cda72e)

* sudo.c:

  now sets SUDO\_COMMAND and SUDO\_GID envariables.
  [[0869c2a39]](https://git.sudo.ws/sudo/commit/?id=0869c2a39)

* aclocal.m4:

  fixed bug with full void impl check
  [[588891cf3]](https://git.sudo.ws/sudo/commit/?id=588891cf3)

* parse.yacc:

  fixed User\_Alias supoprt
  [[a6923398d]](https://git.sudo.ws/sudo/commit/?id=a6923398d)

* parse.yacc:

  added stubs for User\_Alias support
  [[dfcb0eb6e]](https://git.sudo.ws/sudo/commit/?id=dfcb0eb6e)

* sudo.c:

  now sets removes # bogus interfaces from num\_interfaces
  [[050ca432a]](https://git.sudo.ws/sudo/commit/?id=050ca432a)

* parse.lex:

  added User\_Alias support
  [[166d2b78b]](https://git.sudo.ws/sudo/commit/?id=166d2b78b)

1995-04-08 Todd C. Miller

* Makefile.in:

  removed extraneous TODO
  [[ea57effc3]](https://git.sudo.ws/sudo/commit/?id=ea57effc3)

1995-04-07 Todd C. Miller

* visudo.c:

  ntwk\_matches -> addr\_matches
  [[36fec1269]](https://git.sudo.ws/sudo/commit/?id=36fec1269)

* parse.yacc:

  ntwk\_matches -> addr\_matches
  [[c9a574adc]](https://git.sudo.ws/sudo/commit/?id=c9a574adc)

* parse.c:

  ntwk\_matches -> addr\_matches now use inet\_addr() not inet\_network()
  (which expects octet boundaries) fixes for OSF (sizeof(int) !=
  sizeof(long))
  [[521f2f6ac]](https://git.sudo.ws/sudo/commit/?id=521f2f6ac)

* sudo.c:

  took out debugging info
  [[aa03cdc83]](https://git.sudo.ws/sudo/commit/?id=aa03cdc83)

* aclocal.m4:

  OS was being set to unknown before non-uname based host checks. This
  caused no checks to happen since $OS was not zero-length.
  [[d00426b55]](https://git.sudo.ws/sudo/commit/?id=d00426b55)

* sudo.c:

  fixed loading of interfaces struct still has debugging info in though
  [[ec1c2e69e]](https://git.sudo.ws/sudo/commit/?id=ec1c2e69e)

* parse.c:

  fixed typo
  [[e27349c62]](https://git.sudo.ws/sudo/commit/?id=e27349c62)

1995-04-06 Todd C. Miller

* Makefile.in:

  ++version
  [[a7d2490f1]](https://git.sudo.ws/sudo/commit/?id=a7d2490f1)

* version.h:

  ++
  [[32a5ff4f9]](https://git.sudo.ws/sudo/commit/?id=32a5ff4f9)

* visudo.c:

  removed extraneous extern decl of “top
  [[144121414]](https://git.sudo.ws/sudo/commit/?id=144121414)

* visudo.c:

  now zeros “top”
  [[4e6307fdc]](https://git.sudo.ws/sudo/commit/?id=4e6307fdc)

* parse.yacc:

  removed parser\_cleanup (no need for it now)
  [[cd3a5bd09]](https://git.sudo.ws/sudo/commit/?id=cd3a5bd09)

* parse.lex:

  now calls reset\_aliases() directly
  [[f2b3adaa4]](https://git.sudo.ws/sudo/commit/?id=f2b3adaa4)

1995-04-04 Todd C. Miller

* OPTIONS:

  added a sentence to SECURE\_PATH description
  [[f12862c69]](https://git.sudo.ws/sudo/commit/?id=f12862c69)

* parse.c:

  fixed my stupid bug where I used NAMLEN on something I wanted to just
  get the name from. argh.
  [[6e45d61aa]](https://git.sudo.ws/sudo/commit/?id=6e45d61aa)

1995-04-03 Todd C. Miller

* lsearch.c:

  fixed argument order of memmove() that i hosed when converting from
  bcopy(). arghh.
  [[285bc82b3]](https://git.sudo.ws/sudo/commit/?id=285bc82b3)

* Makefile.in:

  finally fixed DISTFILES line
  [[1259d8444]](https://git.sudo.ws/sudo/commit/?id=1259d8444)

* Makefile.in:

  tabs -> spaces
  [[e94d4c878]](https://git.sudo.ws/sudo/commit/?id=e94d4c878)

* Makefile.in:

  added missing files to DISTFILES
  [[d3ebf9190]](https://git.sudo.ws/sudo/commit/?id=d3ebf9190)

* Makefile.in:

  SUPPORTED -> RUNSON
  [[20fe8172c]](https://git.sudo.ws/sudo/commit/?id=20fe8172c)

1995-04-01 Todd C. Miller

* TODO:

  updated
  [[8a4a51a4b]](https://git.sudo.ws/sudo/commit/?id=8a4a51a4b)

* RUNSON:

  updated for pl5b1 release
  [[25dbadf29]](https://git.sudo.ws/sudo/commit/?id=25dbadf29)

* BUGS, TODO:

  updated
  [[012deffa1]](https://git.sudo.ws/sudo/commit/?id=012deffa1)

* check.c:

  fixed bug where if you hit return at first sudo prompt it would still
  log as a failure
  [[f650082b1]](https://git.sudo.ws/sudo/commit/?id=f650082b1)

* CHANGES:

  updated
  [[d6a68fe4a]](https://git.sudo.ws/sudo/commit/?id=d6a68fe4a)

* aclocal.m4:

  better test for bogus void \* implementation
  [[af82bb25a]](https://git.sudo.ws/sudo/commit/?id=af82bb25a)

* logging.c:

  added PASSWORDS\_NOT\_CORRECT
  [[c1e520bbc]](https://git.sudo.ws/sudo/commit/?id=c1e520bbc)

* check.c:

  added PASSWORDS\_NOT\_CORRECT stuff]
  [[5bc17e9f8]](https://git.sudo.ws/sudo/commit/?id=5bc17e9f8)

* sudo.h:

  added PASSWORDS\_NOT\_CORRECT
  [[11e414889]](https://git.sudo.ws/sudo/commit/?id=11e414889)

* tgetpass.c:

  moved pathnames.h
  [[735be1c0b]](https://git.sudo.ws/sudo/commit/?id=735be1c0b)

* sudo.c:

  removed some unused vars and fixed up uid2str
  [[911605896]](https://git.sudo.ws/sudo/commit/?id=911605896)

* putenv.c:

  moved compat.h
  [[5df37f27d]](https://git.sudo.ws/sudo/commit/?id=5df37f27d)

* getcwd.c, getwd.c:

  added pathnames.h
  [[99ae8d306]](https://git.sudo.ws/sudo/commit/?id=99ae8d306)

1995-03-31 Todd C. Miller

* parse.yacc:

  fixed a typo I introduced in the last checkin :-(
  [[0590d7b64]](https://git.sudo.ws/sudo/commit/?id=0590d7b64)

* parse.lex:

  can’t have #ifdef’s where N is defined so just do this the broken way
  for AIX
  [[2bc423cab]](https://git.sudo.ws/sudo/commit/?id=2bc423cab)

* parse.yacc:

  better hack from Chris (but still a hack)
  [[f104cc2dd]](https://git.sudo.ws/sudo/commit/?id=f104cc2dd)

* parse.lex:

  stupid hack for broken aix lex
  [[b6331561f]](https://git.sudo.ws/sudo/commit/?id=b6331561f)

* tgetpass.c:

  now includes compat.h 
  [[d3012dcf0]](https://git.sudo.ws/sudo/commit/?id=d3012dcf0)

* visudo.c:

  now includes fcntl.h
  [[3c033eac1]](https://git.sudo.ws/sudo/commit/?id=3c033eac1)

* compat.h:

  added FD\_SET and FD\_ZERO for 4.2BSD
  [[0d11b8fd1]](https://git.sudo.ws/sudo/commit/?id=0d11b8fd1)

* parse.yacc:

  dirty hack to fix parser bug. i don’t really like this but it works for
  now…
  [[032a129cf]](https://git.sudo.ws/sudo/commit/?id=032a129cf)

* sudo.c:

  uid2str is now static like the prototype says
  [[f4e9cea28]](https://git.sudo.ws/sudo/commit/?id=f4e9cea28)

1995-03-30 Todd C. Miller

* CHANGES, SUPPORTED, TODO, TROUBLESHOOTING:

  updated
  [[2f417910d]](https://git.sudo.ws/sudo/commit/?id=2f417910d)

* RUNSON:

  Initial revision
  [[ec700ab3b]](https://git.sudo.ws/sudo/commit/?id=ec700ab3b)

* sudo.c:

  check\_sudoers now returns an error code and sudo calls inform\_user and
  log\_error based on the return value.
  [[086c51194]](https://git.sudo.ws/sudo/commit/?id=086c51194)

* logging.c, sudo.h:

  added entries for new errors
  [[37966f0da]](https://git.sudo.ws/sudo/commit/?id=37966f0da)

* parse.c:

  now set uid to that of SUDOERS\_OWNER while parsing sudoers file
  [[8e89a08f2]](https://git.sudo.ws/sudo/commit/?id=8e89a08f2)

* Makefile.in:

  took out testsudoers 
  [[b6b88fea9]](https://git.sudo.ws/sudo/commit/?id=b6b88fea9)

* sudo.c:

  now explicately checks that it is setuid root
  [[838882502]](https://git.sudo.ws/sudo/commit/?id=838882502)

* sudo.c:

  If a user has no passwd entry sudo would segv (writing to a garbage
  pointer). Now allocate space before writing :-)
  [[a0b01e062]](https://git.sudo.ws/sudo/commit/?id=a0b01e062)

* configure.in:

  reordered AC\_CHECK\_FUNCS
  [[2f1773275]](https://git.sudo.ws/sudo/commit/?id=2f1773275)

* config.h.in:

  fixed memset macro
  [[0d4643159]](https://git.sudo.ws/sudo/commit/?id=0d4643159)

* tgetpass.c, visudo.c:

  bzero -> memset
  [[e281c20f4]](https://git.sudo.ws/sudo/commit/?id=e281c20f4)

* logging.c:

  bzero -> memset when a parse error is logged the line number of the
  error is now logged too
  [[222d26076]](https://git.sudo.ws/sudo/commit/?id=222d26076)

* INSTALL:

  added Sunos to blurb about c2 security
  [[25d8da8ad]](https://git.sudo.ws/sudo/commit/?id=25d8da8ad)

* configure.in:

  added a SUN4 define for C2 security
  [[b5b99e0b3]](https://git.sudo.ws/sudo/commit/?id=b5b99e0b3)

* config.h.in:

  bcopy -> memmove bzero -> memset
  [[166536d2a]](https://git.sudo.ws/sudo/commit/?id=166536d2a)

* lsearch.c:

  bcopy -> memmove char \* -> VOID \*
  [[a5bf165f7]](https://git.sudo.ws/sudo/commit/?id=a5bf165f7)

* check.c:

  added support for sunos with C2 security
  [[99af59db4]](https://git.sudo.ws/sudo/commit/?id=99af59db4)

* OPTIONS, options.h:

  reordered
  [[f45450cf7]](https://git.sudo.ws/sudo/commit/?id=f45450cf7)

* pathnames.h.in:

  \_PATH\_SUDO\_LOGFILE now set based on configure
  [[af2bbaf7c]](https://git.sudo.ws/sudo/commit/?id=af2bbaf7c)

* configure.in:

  added SUDO\_LOGFILE and SUDO\_TYPE\_SIZE\_T
  [[40d004931]](https://git.sudo.ws/sudo/commit/?id=40d004931)

* config.h.in:

  added \_SUDO\_PATH\_LOGFILE
  [[4bdb9b6fa]](https://git.sudo.ws/sudo/commit/?id=4bdb9b6fa)

* aclocal.m4:

  added SUDO\_LOGFILE to find where to put sudo.log added SUDO\_CHECK\_TYPE
  (just AC\_CHECK\_TYPE but checks unistd.h too) added SUDO\_TYPE\_SIZE\_T
  (calls SUDO\_CHECK\_TYPE)
  [[8fcb78602]](https://git.sudo.ws/sudo/commit/?id=8fcb78602)

1995-03-29 Todd C. Miller

* TROUBLESHOOTING:

  Initial revision
  [[38b60eebb]](https://git.sudo.ws/sudo/commit/?id=38b60eebb)

* sudo.c:

  now do set\_perms(PERM\_ROOT) before the getpwuid() in load\_global() to
  work around a problem is trusted hpux shadow passwords. yuck.
  [[fe19bcc7c]](https://git.sudo.ws/sudo/commit/?id=fe19bcc7c)

* parse.yacc:

  backed out a change in malloc/realloc
  [[ba7c8ad18]](https://git.sudo.ws/sudo/commit/?id=ba7c8ad18)

* parse.yacc:

  now include stdlib.h
  [[cc47d04a0]](https://git.sudo.ws/sudo/commit/?id=cc47d04a0)

* visudo.c:

  now do an freopen() of the stmp file so that yyin will always point to
  the same thing. This is important for flex since we are doing a
  YY\_NEWFILE
  [[c58915743]](https://git.sudo.ws/sudo/commit/?id=c58915743)

* parse.yacc:

  replaced yywrap() with parser\_cleanup() since yywrap() needs to be in
  parse.lex to be able to use YY\_NEW\_FILE. sigh.
  [[60b17a682]](https://git.sudo.ws/sudo/commit/?id=60b17a682)

* parse.lex:

  now have a rule that matches anything that doesn’t match an explicite
  rule. well, you know what i mean (. matches anything not yet matched).
  However, this means that there is input still queued up so we need to do
  a YY\_NEW\_FILE; in yywrap. So, yywrap has moved into parse.lex and it
  calls parser\_cleanup() which is most of the old yywrap() sigh.
  [[4cfd02344]](https://git.sudo.ws/sudo/commit/?id=4cfd02344)

* SUPPORTED:

  no longer used
  [[96f7d5a0c]](https://git.sudo.ws/sudo/commit/?id=96f7d5a0c)

* getcwd.c, getwd.c:

  moved compat.h to be the last include file
  [[64b69d5f5]](https://git.sudo.ws/sudo/commit/?id=64b69d5f5)

* parse.yacc:

  fixed type of aliascmp() args
  [[e3bed398b]](https://git.sudo.ws/sudo/commit/?id=e3bed398b)

* find\_path.c:

  NULL -> ‘\0’
  [[dda75b2fd]](https://git.sudo.ws/sudo/commit/?id=dda75b2fd)

* parse.yacc:

  added casts to lfind and lsearch args for irix
  [[5db1b51da]](https://git.sudo.ws/sudo/commit/?id=5db1b51da)

* Makefile.in:

  bsdinstall -> install-sh
  [[204f66598]](https://git.sudo.ws/sudo/commit/?id=204f66598)

* INSTALL:

  added info about make realclean
  [[4ada7ce45]](https://git.sudo.ws/sudo/commit/?id=4ada7ce45)

* Makefile.in:

  updated VERSION added dependencies for visudo.cat
  [[78c573df1]](https://git.sudo.ws/sudo/commit/?id=78c573df1)

* version.h:

  -> pl5b1
  [[46dd8bfb8]](https://git.sudo.ws/sudo/commit/?id=46dd8bfb8)

* sudo.c:

  took out -l
  [[22c7d31a5]](https://git.sudo.ws/sudo/commit/?id=22c7d31a5)

* Makefile.in:

  now there is a real visudo.man and visudo.cat
  [[894585ffe]](https://git.sudo.ws/sudo/commit/?id=894585ffe)

* sudo.man:

  took out visudo stuff
  [[644f4fcba]](https://git.sudo.ws/sudo/commit/?id=644f4fcba)

* visudo.man:

  Initial revision
  [[dd534f542]](https://git.sudo.ws/sudo/commit/?id=dd534f542)

* parse.c, parse.lex, parse.yacc:

  updated copyright
  [[890fb310e]](https://git.sudo.ws/sudo/commit/?id=890fb310e)

* README:

  updated for pl5
  [[1e46c2691]](https://git.sudo.ws/sudo/commit/?id=1e46c2691)

* sudo.man:

  updated Nieusma & Hieb email addresses
  [[0c651fc7c]](https://git.sudo.ws/sudo/commit/?id=0c651fc7c)

* INSTALL:

  updated to include options.h and OPTIONS
  [[7ff2175ca]](https://git.sudo.ws/sudo/commit/?id=7ff2175ca)

* CHANGES, TODO:

  updated
  [[0b7813011]](https://git.sudo.ws/sudo/commit/?id=0b7813011)

* BUGS:

  eliminated bug #1 (yay)
  [[efbfee912]](https://git.sudo.ws/sudo/commit/?id=efbfee912)

* configure.in:

  sunos no longer gets linked statically
  [[e29e1f9d2]](https://git.sudo.ws/sudo/commit/?id=e29e1f9d2)

1995-03-28 Todd C. Miller

* parse.lex:

  prototype now uses \_\_P()
  [[80f073fbc]](https://git.sudo.ws/sudo/commit/?id=80f073fbc)

* parse.lex:

  make fill() non-ansi
  [[b07614b2e]](https://git.sudo.ws/sudo/commit/?id=b07614b2e)

* parse.c:

  made -v (validate) work
  [[f0fff46a1]](https://git.sudo.ws/sudo/commit/?id=f0fff46a1)

* logging.c:

  now gives host
  [[839b5e7ff]](https://git.sudo.ws/sudo/commit/?id=839b5e7ff)

* find\_path.c:

  don’t check for execute/statable if fq or relative path given
  [[8a7d8fb41]](https://git.sudo.ws/sudo/commit/?id=8a7d8fb41)

* parse.c:

  added a cast
  [[31f5c73d0]](https://git.sudo.ws/sudo/commit/?id=31f5c73d0)

* visudo.c:

  now include ctype.h for islower and tolower macros
  [[485c9e6ed]](https://git.sudo.ws/sudo/commit/?id=485c9e6ed)

* goodpath.c:

  moved \_S\_IFMT & \_S\_ISREG to compat.h
  [[a9f4e4530]](https://git.sudo.ws/sudo/commit/?id=a9f4e4530)

* sudo.c:

  moved a set of parens
  [[4e29c4d3f]](https://git.sudo.ws/sudo/commit/?id=4e29c4d3f)

* strdup.c:

  now include compat.h
  [[b0406ebfb]](https://git.sudo.ws/sudo/commit/?id=b0406ebfb)

* emul/search.h:

  void \* -> VOID \*
  [[f1b54219d]](https://git.sudo.ws/sudo/commit/?id=f1b54219d)

* parse.yacc:

  now cast malloc & realloc return vals added search for HAVE\_LSEARCH now
  use strcmp if no strcasecmp available
  [[7c1eda16e]](https://git.sudo.ws/sudo/commit/?id=7c1eda16e)

* lsearch.c:

  void \* -> VOID \*
  [[445a68297]](https://git.sudo.ws/sudo/commit/?id=445a68297)

* config.h.in:

  removed HAVE\_FLEX added VOID added HAVE\_DIRENT\_H, HAVE\_SYS\_NDIR\_H,
  HAVE\_SYS\_DIR\_H, HAVE\_NDIR\_H added HAVE\_LSEARCH
  [[363964548]](https://git.sudo.ws/sudo/commit/?id=363964548)

* compat.h:

  added \_S\_IFMT, \_S\_IFREG, and S\_ISREG
  [[b207b64d8]](https://git.sudo.ws/sudo/commit/?id=b207b64d8)

* aclocal.m4:

  took out SUDO\_PROG\_INSTALL 1.x to 2.x changes added echo and results to
  most SUDO\_\* macros
  [[6b98875f8]](https://git.sudo.ws/sudo/commit/?id=6b98875f8)

* Makefile.in:

  no more -I.
  [[2b322baa6]](https://git.sudo.ws/sudo/commit/?id=2b322baa6)

* configure.in:

  various 1.x ro 2.x autoconf changes now check for strcasecmp now use
  AC\_INSTALL\_PROG instead of custom one added check for fully woorking
  void implementation
  [[91da5d313]](https://git.sudo.ws/sudo/commit/?id=91da5d313)

* Makefile.in:

  added lsearch & search.h visudo links into $(LIBOBJS)
  [[a6867100a]](https://git.sudo.ws/sudo/commit/?id=a6867100a)

* aclocal.m4:

  partial 1.x to 2.x changes added SUDO\_FULL\_VOID
  [[dde32f14d]](https://git.sudo.ws/sudo/commit/?id=dde32f14d)

* visudo.c:

  whatnow\_help was prototyped to be static be was not declared as such
  [[348eb2c3e]](https://git.sudo.ws/sudo/commit/?id=348eb2c3e)

* configure.in:

  autoconf 2.x changes took out HAVE\_FLEX (no longer used) added check for
  dirent/dir/ndir.h
  [[dbc0ddbdf]](https://git.sudo.ws/sudo/commit/?id=dbc0ddbdf)

* parse.c:

  now use groovy gnu autoconf macro AC\_HEADER\_DIRENT
  [[d24022cde]](https://git.sudo.ws/sudo/commit/?id=d24022cde)

* getcwd.c, getwd.c:

  MAXPATHLEN -> MAXPATHLEN+1
  [[fb3c0f2a3]](https://git.sudo.ws/sudo/commit/?id=fb3c0f2a3)

* emul/search.h, lsearch.c:

  Initial revision
  [[c28761743]](https://git.sudo.ws/sudo/commit/?id=c28761743)

1995-03-27 Todd C. Miller

* parse.yacc:

  eliminated bison warnings
  [[09e1ddb05]](https://git.sudo.ws/sudo/commit/?id=09e1ddb05)

* parse.lex:

  added missing case
  [[f1c8d99b9]](https://git.sudo.ws/sudo/commit/?id=f1c8d99b9)

* visudo.c:

  now iincludes signal.h
  [[d5752237a]](https://git.sudo.ws/sudo/commit/?id=d5752237a)

* parse.yacc:

  only clear data structures on a parse error
  [[e24031eab]](https://git.sudo.ws/sudo/commit/?id=e24031eab)

* visudo.c:

  whatnow() now gives help on invalid input
  [[6876438ab]](https://git.sudo.ws/sudo/commit/?id=6876438ab)

* visudo.c:

  added a whatnow() function (sort of like mh)
  [[7c7ea0252]](https://git.sudo.ws/sudo/commit/?id=7c7ea0252)

* parse.yacc:

  kill\_aliases -> reset\_aliases yywrap() now cleans up by calling
  reset\_aliases() and clearing top took reset stuff out of yyerror() since
  it doesn’t beling there (and doesn’t work anyway). errorlineno is now
  initially set to -1 so we can set it to the first error that occurrs (it
  was getting set to the last)
  [[f92064130]](https://git.sudo.ws/sudo/commit/?id=f92064130)

* parse.lex:

  added a void cast
  [[bd987bf7f]](https://git.sudo.ws/sudo/commit/?id=bd987bf7f)

* visudo.c:

  rewrote from scratch based on 4.3BSD vipw.c
  [[c56ec5dbc]](https://git.sudo.ws/sudo/commit/?id=c56ec5dbc)

1995-03-26 Todd C. Miller

* sudo.c, sudo.h:

  removed ocmnd
  [[40fbed903]](https://git.sudo.ws/sudo/commit/?id=40fbed903)

* sudo.h:

  no more sudo\_realpath() and find\_path() changed params
  [[8de40d1c3]](https://git.sudo.ws/sudo/commit/?id=8de40d1c3)

* sudo.c:

  find\_path() changed since no more realpath()
  [[175390b58]](https://git.sudo.ws/sudo/commit/?id=175390b58)

* parse.yacc:

  on error, errorlineno is set to the line where the error occurred added
  kill\_aliases() to free the aliases struct now clean up in yyerror() so
  we can reparse cleanly
  [[d06e1f3ab]](https://git.sudo.ws/sudo/commit/?id=d06e1f3ab)

* options.h, parse.c:

  no more USE\_REALPATH
  [[5509c7763]](https://git.sudo.ws/sudo/commit/?id=5509c7763)

* logging.c:

  changed to use new find\_path()
  [[ee49c5c24]](https://git.sudo.ws/sudo/commit/?id=ee49c5c24)

* find\_path.c:

  removed all the realpath() stuff
  [[4125ee07a]](https://git.sudo.ws/sudo/commit/?id=4125ee07a)

* Makefile.in:

  sudo\_realpath.c -> sudo\_goodpath.c
  [[2c44508fa]](https://git.sudo.ws/sudo/commit/?id=2c44508fa)

* visudo.c:

  now works correctly with utk parser
  [[fd341dbde]](https://git.sudo.ws/sudo/commit/?id=fd341dbde)

* goodpath.c:

  Initial revision
  [[26a5f0d15]](https://git.sudo.ws/sudo/commit/?id=26a5f0d15)

* sudo\_realpath.c:

  eliminated a compiler warning
  [[cc10c0ec0]](https://git.sudo.ws/sudo/commit/?id=cc10c0ec0)

* sudo.c:

  elinated compiler warning
  [[ba61aad4a]](https://git.sudo.ws/sudo/commit/?id=ba61aad4a)

* sudo\_realpath.c:

  added sudo\_goodpath()
  [[aeb609efd]](https://git.sudo.ws/sudo/commit/?id=aeb609efd)

* sudo.h:

  added prototype for sudo\_goodpath
  [[5595c3817]](https://git.sudo.ws/sudo/commit/?id=5595c3817)

* parse.c:

  added support for /sys/dir.h
  [[054c9ce3d]](https://git.sudo.ws/sudo/commit/?id=054c9ce3d)

* options.h:

  USE\_REALPATH turned off
  [[094d564e6]](https://git.sudo.ws/sudo/commit/?id=094d564e6)

* find\_path.c:

  added calls to sudo\_goodpath()
  [[c3ac93caa]](https://git.sudo.ws/sudo/commit/?id=c3ac93caa)

* configure.in:

  added check for dirent.h
  [[c08ab7544]](https://git.sudo.ws/sudo/commit/?id=c08ab7544)

* config.h.in:

  added HAVE\_DIRENT\_H
  [[c2906f3e9]](https://git.sudo.ws/sudo/commit/?id=c2906f3e9)

* configure.in:

  added in linux shadow pass stuff 
  [[0ef8b2e01]](https://git.sudo.ws/sudo/commit/?id=0ef8b2e01)

1995-03-24 Todd C. Miller

* visudo.c:

  added back host, user, cmnd, parse\_error
  [[5b042113e]](https://git.sudo.ws/sudo/commit/?id=5b042113e)

* visudo.c:

  added in utk changes plus some minor cosmetic changes
  [[846f554a4]](https://git.sudo.ws/sudo/commit/?id=846f554a4)

* sudo.c, sudo\_realpath.c:

  added void casts for printf’s
  [[37aafbf09]](https://git.sudo.ws/sudo/commit/?id=37aafbf09)

* options.h:

  added a define of USE\_REALPATH
  [[b7221f7ab]](https://git.sudo.ws/sudo/commit/?id=b7221f7ab)

* configure.in:

  there is no more visudoers/Makefile
  [[359e12ece]](https://git.sudo.ws/sudo/commit/?id=359e12ece)

* Makefile.in:

  added in utk changes (visudo is now built from the toplevel)
  [[dbafc6245]](https://git.sudo.ws/sudo/commit/?id=dbafc6245)

* find\_path.c:

  added (void) casts to printf’s
  [[35a22d345]](https://git.sudo.ws/sudo/commit/?id=35a22d345)

* parse.c, parse.lex, parse.yacc, sudo.h, sudo\_realpath.c:

  merged in utk changes
  [[34a6197f4]](https://git.sudo.ws/sudo/commit/?id=34a6197f4)

1995-03-23 Todd C. Miller

* find\_path.c:

  now check to see that what we are trying to run is a file (or a link to
  a file, we do a stat(2) so there is no diff)
  [[0759d4809]](https://git.sudo.ws/sudo/commit/?id=0759d4809)

1995-03-13 Todd C. Miller

* CHANGES:

  updated
  [[3600186d6]](https://git.sudo.ws/sudo/commit/?id=3600186d6)

* Makefile.in:

  aclocal.m4 -> acsite.m4 make realclean updated for new autoconf 
  [[a3457aaf0]](https://git.sudo.ws/sudo/commit/?id=a3457aaf0)

* sudo.man:

  added myself as maintainer
  [[e9a79b137]](https://git.sudo.ws/sudo/commit/?id=e9a79b137)

1995-02-17 Todd C. Miller

* sudo.c:

  changed setegid -> setgid
  [[b9f7c72dd]](https://git.sudo.ws/sudo/commit/?id=b9f7c72dd)

1995-02-06 Todd C. Miller

* configure.in:

  fixed the test for irix 5.x to skip bad libs
  [[bc207b74c]](https://git.sudo.ws/sudo/commit/?id=bc207b74c)

* aclocal.m4:

  now initialize OS and OSREV
  [[312b501f4]](https://git.sudo.ws/sudo/commit/?id=312b501f4)

1995-01-27 Todd C. Miller

* configure.in:

  irix5 changes
  [[34de49432]](https://git.sudo.ws/sudo/commit/?id=34de49432)

* configure.in:

  AC\_WITH -> AC\_ARG\_WITH changes other misc changes for autoconf 2.1
  compatibility
  [[e70ddc18d]](https://git.sudo.ws/sudo/commit/?id=e70ddc18d)

1995-01-19 Todd C. Miller

* visudo.c:

  use YY\_NEW\_FILE, not yyrestart since OSF flex doesn’t do the righ thing
  wrt yyrestart (grrrr)
  [[10b323c36]](https://git.sudo.ws/sudo/commit/?id=10b323c36)

1995-01-16 Todd C. Miller

* Makefile.in:

  added visudoers/compat.h to DISTFILES
  [[9a2d60685]](https://git.sudo.ws/sudo/commit/?id=9a2d60685)

* configure.in:

  fixed an echo
  [[8f18ca32c]](https://git.sudo.ws/sudo/commit/?id=8f18ca32c)

* sudo.c:

  added ocmnd declaration adjusted for find\_path()’s new parameters
  [[ee8a3a440]](https://git.sudo.ws/sudo/commit/?id=ee8a3a440)

* sudo.h:

  added ocmnd extern adjusted find\_path() prototype
  [[7bcb9b4e1]](https://git.sudo.ws/sudo/commit/?id=7bcb9b4e1)

* parse.c:

  cmndcmp() now takes 3 arguments and checks against the qualified as well
  as the unqualified pathname. more code that should use cmndcmp() but did
  not, now does
  [[44fb090c7]](https://git.sudo.ws/sudo/commit/?id=44fb090c7)

* options.h:

  added to a comment
  [[6091806d4]](https://git.sudo.ws/sudo/commit/?id=6091806d4)

* logging.c:

  changed to use new find\_path() parameter passing
  [[9116e4558]](https://git.sudo.ws/sudo/commit/?id=9116e4558)

* find\_path.c:

  find\_path() now takes 2 copyout parameters (one for the qualified
  pathname and one for the unqualified pathname). The third parameter may
  be NULL.
  [[4fa8a93f6]](https://git.sudo.ws/sudo/commit/?id=4fa8a93f6)

* configure.in:

  no longer munge pathnames.h
  [[4618404c7]](https://git.sudo.ws/sudo/commit/?id=4618404c7)

* pathnames.h.in:

  changed *PATH*\* to use *SUDO\_PATH*\* (which are defined in config.h) as a
  result, pathnames.h does not need to be run through configure and the
  user can override the configured values easily.
  [[4c790506b]](https://git.sudo.ws/sudo/commit/?id=4c790506b)

* config.h.in:

  added *SUDO\_PATH*\* entries
  [[bf7b8e1c2]](https://git.sudo.ws/sudo/commit/?id=bf7b8e1c2)

* aclocal.m4:

  \_PATH\* -> *SUDO\_PATH*\*
  [[4c3d48a8b]](https://git.sudo.ws/sudo/commit/?id=4c3d48a8b)

* Makefile.in:

  updated DISTFILES and HDRS .o’s now depend on config.h
  [[f351747a4]](https://git.sudo.ws/sudo/commit/?id=f351747a4)

1995-01-13 Todd C. Miller

* compat.h:

  removed extraneous #endif
  [[3eace2625]](https://git.sudo.ws/sudo/commit/?id=3eace2625)

* aclocal.m4:

  added SUDO\_PROG\_MV
  [[4fbbe1bb5]](https://git.sudo.ws/sudo/commit/?id=4fbbe1bb5)

* configure.in:

  added SUDO\_PROG\_MV added riscos and isc os types took out
  -DSHORT\_MESSAGE from –with-csops since it is now the default
  [[1bd5b76a6]](https://git.sudo.ws/sudo/commit/?id=1bd5b76a6)

* sudo.c:

  move the include of id.h to compat.h now includes options.h
  [[5318438a0]](https://git.sudo.ws/sudo/commit/?id=5318438a0)

* sudo.h:

  moved compatibility #defines to compat.h
  [[df46f66f6]](https://git.sudo.ws/sudo/commit/?id=df46f66f6)

* pathnames.h.in:

  added \_PATH\_MV
  [[fd5039a32]](https://git.sudo.ws/sudo/commit/?id=fd5039a32)

* config.h.in:

  move \_\_P to compat.h
  [[3fe8d9202]](https://git.sudo.ws/sudo/commit/?id=3fe8d9202)

* getcwd.c, getwd.c, putenv.c:

  now includes compat.h
  [[b7b53ae4a]](https://git.sudo.ws/sudo/commit/?id=b7b53ae4a)

* compat.h:

  Initial revision
  [[2046a4520]](https://git.sudo.ws/sudo/commit/?id=2046a4520)

1995-01-12 Todd C. Miller

* sudo.h:

  pull user-configurable stuff out and put in options.h
  [[08207310c]](https://git.sudo.ws/sudo/commit/?id=08207310c)

1995-01-11 Todd C. Miller

* parse.lex, parse.yacc, visudo.c:

  now includes options.h
  [[17f8d7469]](https://git.sudo.ws/sudo/commit/?id=17f8d7469)

* check.c, find\_path.c, logging.c, parse.c, sudo\_realpath.c,
  sudo\_setenv.c:

  now includes options.h
  [[db8b50d82]](https://git.sudo.ws/sudo/commit/?id=db8b50d82)

* Makefile.in:

  added visudoers/options.h
  [[3de8088fe]](https://git.sudo.ws/sudo/commit/?id=3de8088fe)

* OPTIONS, options.h:

  Initial revision
  [[4c5b5bd9a]](https://git.sudo.ws/sudo/commit/?id=4c5b5bd9a)

* Makefile.in:

  added OPTIONS and options.h
  [[0435459ce]](https://git.sudo.ws/sudo/commit/?id=0435459ce)

* logging.c:

  changed #ifdef’s to use LOGGING and SLOG\_SYSLOG/SLOG\_FILE
  [[e4452a2ed]](https://git.sudo.ws/sudo/commit/?id=e4452a2ed)

* check.c, sudo.h:

  changed PASSWORD\_TIMEOUT to minutes
  [[25f7b5cf1]](https://git.sudo.ws/sudo/commit/?id=25f7b5cf1)

1994-12-17 Todd C. Miller

* visudo.c:

  now only do Editor +line\_num if line\_num != 0
  [[7bd269bd8]](https://git.sudo.ws/sudo/commit/?id=7bd269bd8)

1994-12-16 Todd C. Miller

* visudo.c:

  now use mv if rename(2) fails
  [[5d212959c]](https://git.sudo.ws/sudo/commit/?id=5d212959c)

* BUGS:

  added a visudo bug
  [[9961a7c96]](https://git.sudo.ws/sudo/commit/?id=9961a7c96)

* check.c:

  expanded comment
  [[b5096e0ce]](https://git.sudo.ws/sudo/commit/?id=b5096e0ce)

1994-11-12 Todd C. Miller

* check.c:

  fixed user\_is\_exempt to return 0 if EXEMPTGROUP is not set
  [[7806a5c2d]](https://git.sudo.ws/sudo/commit/?id=7806a5c2d)

1994-11-10 Todd C. Miller

* sudo.c:

  added mips & isc support
  [[be3b8f806]](https://git.sudo.ws/sudo/commit/?id=be3b8f806)

* parse.c:

  added support for non-root owned sudoers file
  [[6482c50cb]](https://git.sudo.ws/sudo/commit/?id=6482c50cb)

* check.c:

  added exempt group support
  [[f17d6c53c]](https://git.sudo.ws/sudo/commit/?id=f17d6c53c)

* sudo.h:

  added set\_perms() support added SUDOERS\_OWNER so can have non-root own
  sudoers file added exempt group support added isc support
  [[34abdbe9a]](https://git.sudo.ws/sudo/commit/?id=34abdbe9a)

* visudo.c:

  now copy sudoers to temp file via read/write (not stdio) now chown new
  sudoers file to SUDOERS\_OWNER
  [[1249fb564]](https://git.sudo.ws/sudo/commit/?id=1249fb564)

1994-11-08 Todd C. Miller

* configure.in:

  added skey support
  [[15c283a95]](https://git.sudo.ws/sudo/commit/?id=15c283a95)

* sudo\_realpath.c:

  be\_\* -> setperms()
  [[7f271c978]](https://git.sudo.ws/sudo/commit/?id=7f271c978)

* sudo.h:

  fixed typo added set\_perms support added skey support added
  seteuid()/setegid() emulation for AIX
  [[7b434f97f]](https://git.sudo.ws/sudo/commit/?id=7b434f97f)

* sudo.c:

  be\_\* -> setperms() now check to make sure sudoers file is owned by root
  nread/write by only root
  [[8dc58160a]](https://git.sudo.ws/sudo/commit/?id=8dc58160a)

* logging.c, parse.c:

  be\_\* -> setperms()
  [[fe8b92ba4]](https://git.sudo.ws/sudo/commit/?id=fe8b92ba4)

* check.c:

  be\_\* -> set\_perms() added skey support
  [[46d361a44]](https://git.sudo.ws/sudo/commit/?id=46d361a44)

1994-11-06 Todd C. Miller

* Makefile.in:

  ++version
  [[2eb3cac51]](https://git.sudo.ws/sudo/commit/?id=2eb3cac51)

* version.h:

  ++
  [[60c966b07]](https://git.sudo.ws/sudo/commit/?id=60c966b07)

1994-10-21 Todd C. Miller

* sudo.c:

  now sets IFS
  [[efdad527c]](https://git.sudo.ws/sudo/commit/?id=efdad527c)

* insults.h:

  fixed typo
  [[368e652de]](https://git.sudo.ws/sudo/commit/?id=368e652de)

1994-10-15 Todd C. Miller

* config.h.in:

  added HAVE\_SKEY
  [[34c40cc12]](https://git.sudo.ws/sudo/commit/?id=34c40cc12)

1994-10-04 Todd C. Miller

* CHANGES:

  updated
  [[ff7362b42]](https://git.sudo.ws/sudo/commit/?id=ff7362b42)

* Makefile.in:

  ++version
  [[53588e79a]](https://git.sudo.ws/sudo/commit/?id=53588e79a)

* version.h:

  ++
  [[a09ab0b86]](https://git.sudo.ws/sudo/commit/?id=a09ab0b86)

* sudo.c:

  now bail if ARgv[1] > MAXPATHLEN
  [[6b069fabe]](https://git.sudo.ws/sudo/commit/?id=6b069fabe)

* configure.in:

  added function check for tcgetattr(3)
  [[92245ab4f]](https://git.sudo.ws/sudo/commit/?id=92245ab4f)

* config.h.in:

  only define HAVE\_TERMIOS\_H if you have tcgetattr(3)
  [[3fe0b9672]](https://git.sudo.ws/sudo/commit/?id=3fe0b9672)

* config.h.in:

  added check for tcgetattr
  [[140618362]](https://git.sudo.ws/sudo/commit/?id=140618362)

1994-09-26 Todd C. Miller

* CHANGES:

  updated
  [[93d600b2c]](https://git.sudo.ws/sudo/commit/?id=93d600b2c)

1994-09-22 Todd C. Miller

* parse.lex:

  now only include unistd.h for linux
  [[cbb087974]](https://git.sudo.ws/sudo/commit/?id=cbb087974)

1994-09-21 Todd C. Miller

* Makefile.in:

  added visudo.8 generation
  [[881374f18]](https://git.sudo.ws/sudo/commit/?id=881374f18)

* configure.in:

  added -Wl,-bI:./aixcrypt.exp to aix flags
  [[482ea91f5]](https://git.sudo.ws/sudo/commit/?id=482ea91f5)

1994-09-20 Todd C. Miller

* BUGS:

  added one
  [[e72686577]](https://git.sudo.ws/sudo/commit/?id=e72686577)

* CHANGES:

  updated
  [[e3b750dd1]](https://git.sudo.ws/sudo/commit/?id=e3b750dd1)

* README:

  added mailing list info
  [[a4c6eb1dd]](https://git.sudo.ws/sudo/commit/?id=a4c6eb1dd)

* parse.yacc:

  now use sudolineno instead of yylineno fixed bison warnings
  [[43e8cd4fa]](https://git.sudo.ws/sudo/commit/?id=43e8cd4fa)

* configure.in:

  now use -no\_library\_replacement for osf don’t make a static binary for
  hpux >= 9.0
  [[92b4dea2d]](https://git.sudo.ws/sudo/commit/?id=92b4dea2d)

* tgetpass.c:

  added string.h/strings.h inclusion
  [[1c91f8bb7]](https://git.sudo.ws/sudo/commit/?id=1c91f8bb7)

* config.h.in:

  added ssize\_t def
  [[de7ed682d]](https://git.sudo.ws/sudo/commit/?id=de7ed682d)

* parse.lex:

  added inclusion of string.h/strings.h
  [[000b5d235]](https://git.sudo.ws/sudo/commit/?id=000b5d235)

* aclocal.m4:

  fixed uname | sed (needed to quote the ‘[’)
  [[fa4273a93]](https://git.sudo.ws/sudo/commit/?id=fa4273a93)

* parse.lex:

  replaced yylineno with sudolineno fixed bison syntax errors
  [[98e893ece]](https://git.sudo.ws/sudo/commit/?id=98e893ece)

* visudo.c:

  changed yylineno to sudolineno since yylineno cannot be counted upon.
  [[fff477cb8]](https://git.sudo.ws/sudo/commit/?id=fff477cb8)

* TODO:

  updated
  [[e0e9092ca]](https://git.sudo.ws/sudo/commit/?id=e0e9092ca)

* parse.c:

  added code to support command listings
  [[0d973cdf2]](https://git.sudo.ws/sudo/commit/?id=0d973cdf2)

* sudo.c:

  added code for -l flag
  [[410f21dd7]](https://git.sudo.ws/sudo/commit/?id=410f21dd7)

* sudo.man:

  fixed typo added info for -l flag
  [[7021bdc4e]](https://git.sudo.ws/sudo/commit/?id=7021bdc4e)

* configure.in:

  AC\_SSIZE\_T -> SUDO\_SSIZE\_T
  [[abadb6ec6]](https://git.sudo.ws/sudo/commit/?id=abadb6ec6)

* aclocal.m4:

  added SUDO\_SSIZE\_T
  [[b20ff4687]](https://git.sudo.ws/sudo/commit/?id=b20ff4687)

* sudo.h:

  added MODE\_LIST
  [[2ff6056d9]](https://git.sudo.ws/sudo/commit/?id=2ff6056d9)

* configure.in:

  added AC\_SSIZE\_T
  [[50c517dd5]](https://git.sudo.ws/sudo/commit/?id=50c517dd5)

* find\_path.c, sudo\_realpath.c:

  readlink() is now declared as returning ssize~\_t
  [[c367fa702]](https://git.sudo.ws/sudo/commit/?id=c367fa702)

* configure.in:

  added -laud for OSF c2
  [[565adde5b]](https://git.sudo.ws/sudo/commit/?id=565adde5b)

1994-09-02 Todd C. Miller

* Makefile.in, visudo.c:

  changed sudo-bugs.cs.colorado.edu -> sudo-bugs@…
  [[b56bc92e0]](https://git.sudo.ws/sudo/commit/?id=b56bc92e0)

* config.h.in, parse.lex, parse.yacc, pathnames.h.in:

  changed sudo-bugs.cs.colorado.edu -> sudo-bugs@…
  [[7229829c8]](https://git.sudo.ws/sudo/commit/?id=7229829c8)

* check.c, find\_path.c, getcwd.c, getwd.c, insults.h, logging.c, parse.c,
  putenv.c, strdup.c, sudo.c, sudo.h, sudo\_realpath.c, sudo\_setenv.c,
  tgetpass.c, version.h:

  changed sudo-bugs.cs.colorado.edu -> sudo-bugs@cs.colorado.ed
  [[525954e1b]](https://git.sudo.ws/sudo/commit/?id=525954e1b)

1994-09-01 Todd C. Miller

* Makefile.in:

  ++version
  [[5019a29e6]](https://git.sudo.ws/sudo/commit/?id=5019a29e6)

* version.h:

  ++
  [[ed62683a6]](https://git.sudo.ws/sudo/commit/?id=ed62683a6)

* logging.c:

  added host to alertmail messages
  [[89d6f4937]](https://git.sudo.ws/sudo/commit/?id=89d6f4937)

* CHANGES, TODO:

  udpated
  [[9dd2859b9]](https://git.sudo.ws/sudo/commit/?id=9dd2859b9)

* logging.c:

  fixed logging problem where mail would not say which user it was
  [[ad6f7a488]](https://git.sudo.ws/sudo/commit/?id=ad6f7a488)

* configure.in:

  added -laud for gcc if osf & c2
  [[3f557e4b2]](https://git.sudo.ws/sudo/commit/?id=3f557e4b2)

* check.c:

  moved set\_auth\_parameters to sudo.c
  [[e3fb4ee3a]](https://git.sudo.ws/sudo/commit/?id=e3fb4ee3a)

* sudo.c:

  added set\_auth\_parameters for osf
  [[5d04e3eaf]](https://git.sudo.ws/sudo/commit/?id=5d04e3eaf)

* configure.in:

  cleaned up -static stuff
  [[ee7f9e145]](https://git.sudo.ws/sudo/commit/?id=ee7f9e145)

* Makefile.in:

  ++version
  [[71888a611]](https://git.sudo.ws/sudo/commit/?id=71888a611)

* version.h:

  ++
  [[5341cd3f8]](https://git.sudo.ws/sudo/commit/?id=5341cd3f8)

* sudo.c:

  changed setenv() to sudo\_setenv()
  [[4c19411fc]](https://git.sudo.ws/sudo/commit/?id=4c19411fc)

* check.c:

  fixed osf problem
  [[e6e9c18d0]](https://git.sudo.ws/sudo/commit/?id=e6e9c18d0)

* configure.in:

  added OSF C2 stuff
  [[07594fd73]](https://git.sudo.ws/sudo/commit/?id=07594fd73)

* CHANGES:

  updated
  [[22d700250]](https://git.sudo.ws/sudo/commit/?id=22d700250)

* check.c:

  added osf auth support & removed some extra spaces
  [[d366d09e6]](https://git.sudo.ws/sudo/commit/?id=d366d09e6)

* INSTALL, SUPPORTED:

  added osf C2 stuff
  [[22acfc6df]](https://git.sudo.ws/sudo/commit/?id=22acfc6df)

1994-08-31 Todd C. Miller

* TODO:

  added 2 suggestions
  [[07111800e]](https://git.sudo.ws/sudo/commit/?id=07111800e)

* Makefile.in:

  removed README.v1.3.1 and added VERSION stuff
  [[eca586506]](https://git.sudo.ws/sudo/commit/?id=eca586506)

* version.h:

  pl1
  [[0368a035b]](https://git.sudo.ws/sudo/commit/?id=0368a035b)

1994-08-30 Todd C. Miller

* version.h:

  1.3.1final
  [[7f8aa5d8c]](https://git.sudo.ws/sudo/commit/?id=7f8aa5d8c)

* Makefile.in:

  added HISTORY
  [[3e474aef2]](https://git.sudo.ws/sudo/commit/?id=3e474aef2)

* sudo.man:

  mention HISTPRY file
  [[de6a7d9e2]](https://git.sudo.ws/sudo/commit/?id=de6a7d9e2)

* sudo.c:

  use sizeof instead of a constant in 1 place
  [[617455453]](https://git.sudo.ws/sudo/commit/?id=617455453)

* parse.yacc:

  added unistd.h
  [[b7df10fe2]](https://git.sudo.ws/sudo/commit/?id=b7df10fe2)

* parse.lex:

  added unistd.h
  [[e5de10d25]](https://git.sudo.ws/sudo/commit/?id=e5de10d25)

* README:

  udpated
  [[bdb249e47]](https://git.sudo.ws/sudo/commit/?id=bdb249e47)

* HISTORY:

  Initial revision
  [[6004a8cd4]](https://git.sudo.ws/sudo/commit/?id=6004a8cd4)

1994-08-17 Todd C. Miller

* version.h:

  ++
  [[cd3d369b9]](https://git.sudo.ws/sudo/commit/?id=cd3d369b9)

* CHANGES:

  updated
  [[02f0a29db]](https://git.sudo.ws/sudo/commit/?id=02f0a29db)

* sudo\_setenv.c:

  added unistd.h include
  [[109d54f91]](https://git.sudo.ws/sudo/commit/?id=109d54f91)

1994-08-16 Todd C. Miller

* sudo.c:

  added sys/time.h for AIX
  [[23c2416e0]](https://git.sudo.ws/sudo/commit/?id=23c2416e0)

1994-08-15 Todd C. Miller

* configure.in:

  added check for -lsocket and sys/sockio.h
  [[79a42a836]](https://git.sudo.ws/sudo/commit/?id=79a42a836)

* config.h.in:

  took out libshadow check and added in sys/sockio.h check
  [[ca9133000]](https://git.sudo.ws/sudo/commit/?id=ca9133000)

* sudo.c:

  now include sockio.h instead of ioctl.h if it exists “sudo -” now gets a
  better error message
  [[98ca6de0d]](https://git.sudo.ws/sudo/commit/?id=98ca6de0d)

* sample.sudoers:

  now has a dir and subnet entry
  [[19c13f4fa]](https://git.sudo.ws/sudo/commit/?id=19c13f4fa)

1994-08-13 Todd C. Miller

* sudo.c:

  removed if\_ether.h
  [[51ebc0b2b]](https://git.sudo.ws/sudo/commit/?id=51ebc0b2b)

* TODO:

  added an item
  [[8245f195d]](https://git.sudo.ws/sudo/commit/?id=8245f195d)

* sudo.man:

  added network and ip addresses to man page
  [[e047d29e1]](https://git.sudo.ws/sudo/commit/?id=e047d29e1)

* sudo.c:

  no error if can’t get interfaces or netmask since networking may not be
  in the kernel.
  [[20f8b1911]](https://git.sudo.ws/sudo/commit/?id=20f8b1911)

* parse.c:

  nwo check for interfaces == NULL
  [[e9114229c]](https://git.sudo.ws/sudo/commit/?id=e9114229c)

* parse.c:

  fixed a bug that caused directory specs in a Cmnd\_Alias to fail if the
  last entry in the spec failed (ie: it was only looking at the last
  entry). CLeaned things up by adding the cmndcmp() function–all neat &
  tidy
  [[971a69bb2]](https://git.sudo.ws/sudo/commit/?id=971a69bb2)

* CHANGES:

  added one
  [[c3be7c93c]](https://git.sudo.ws/sudo/commit/?id=c3be7c93c)

1994-08-12 Todd C. Miller

* sudo.c:

  now do two passes to skip bogus interfaces (lo0, etc)
  [[6e337ed50]](https://git.sudo.ws/sudo/commit/?id=6e337ed50)

* parse.lex, parse.yacc, visudo.c:

  added include of netinet/in.h
  [[5a766f63a]](https://git.sudo.ws/sudo/commit/?id=5a766f63a)

* logging.c, sudo\_realpath.c, sudo\_setenv.c:

  added ninclude of netinet/in.h
  [[835b10be2]](https://git.sudo.ws/sudo/commit/?id=835b10be2)

* check.c, find\_path.c, getcwd.c, getwd.c:

  added include of netinet/in.h
  [[380be0c4c]](https://git.sudo.ws/sudo/commit/?id=380be0c4c)

* version.h:

  ++
  [[787a7254b]](https://git.sudo.ws/sudo/commit/?id=787a7254b)

* sudo.h:

  added interfaces global
  [[b8cc728d9]](https://git.sudo.ws/sudo/commit/?id=b8cc728d9)

* parse.c:

  now uses new interfaces global
  [[2b0794bb0]](https://git.sudo.ws/sudo/commit/?id=2b0794bb0)

* sudo.c:

  now ip addresses are gleaned fw/o dns
  [[669ecb8a2]](https://git.sudo.ws/sudo/commit/?id=669ecb8a2)

1994-08-10 Todd C. Miller

* sudo.c:

  added load\_ip\_addrs() to load the ip\_addrs global var
  [[49673e12c]](https://git.sudo.ws/sudo/commit/?id=49673e12c)

* parse.c:

  added hostcmp() to compare hostnames, ip addrs, and network addrs
  [[3fa8477a1]](https://git.sudo.ws/sudo/commit/?id=3fa8477a1)

* sudo.h:

  added ip\_addrs def added load\_ip\_addrs prototype
  [[2d67de500]](https://git.sudo.ws/sudo/commit/?id=2d67de500)

1994-08-08 Todd C. Miller

* CHANGES:

  updated
  [[701f67f7d]](https://git.sudo.ws/sudo/commit/?id=701f67f7d)

* Makefile.in:

  removed multiple entries in DISTFILES
  [[c7b944fc9]](https://git.sudo.ws/sudo/commit/?id=c7b944fc9)

* visudo.c:

  ansified the !STDC\_HEADERS decls
  [[1823b5723]](https://git.sudo.ws/sudo/commit/?id=1823b5723)

* find\_path.c, getcwd.c, getwd.c, putenv.c, strdup.c:

  don’t do malloc decl if gnuc
  [[aaefd1c3a]](https://git.sudo.ws/sudo/commit/?id=aaefd1c3a)

* sudo.c:

  can’t use getopt(3) since it munges args to the command to be run as
  root don’t do malloc decl if gnuc
  [[880ca6406]](https://git.sudo.ws/sudo/commit/?id=880ca6406)

* find\_path.c, getcwd.c, getwd.c, putenv.c, strdup.c, sudo.c,
  sudo\_realpath.c, sudo\_setenv.c:

  ansi-fied !STDC\_HEADER function prottypes
  [[e54f35e71]](https://git.sudo.ws/sudo/commit/?id=e54f35e71)

* getcwd.c, getwd.c:

  added missing paren
  [[72cf5123b]](https://git.sudo.ws/sudo/commit/?id=72cf5123b)

* Makefile.in:

  added putenv.c to DISTFILES
  [[cf91591b6]](https://git.sudo.ws/sudo/commit/?id=cf91591b6)

* sudo\_setenv.c:

  added params to func decls when STDC\_HEADERS is not defined now can
  count on putenv() being there
  [[495749c32]](https://git.sudo.ws/sudo/commit/?id=495749c32)

* sudo\_realpath.c:

  took out errno decl since sudo.h does it for us fixed up a next cc
  warning added params to func decls when STDC\_HEADERS is not defined
  [[b20e86de9]](https://git.sudo.ws/sudo/commit/?id=b20e86de9)

* sudo.h:

  took out environ extern added local declaratio of putenv() if local
  version is needed
  [[65a4afee4]](https://git.sudo.ws/sudo/commit/?id=65a4afee4)

* find\_path.c, getcwd.c, getwd.c, strdup.c, sudo.c:

  added params to func decls when STDC\_HEADERS is not defined
  [[38b6d5f1d]](https://git.sudo.ws/sudo/commit/?id=38b6d5f1d)

* config.h.in:

  added memcpy check check to see that ansi vs bsd macros are ntot already
  defiend before defining (ie: avoid redefinition)
  [[a3bbe79d6]](https://git.sudo.ws/sudo/commit/?id=a3bbe79d6)

* configure.in:

  removed fluff setenv check plus check w/ replace for putenv if also no
  setenv
  [[5b1f9bb96]](https://git.sudo.ws/sudo/commit/?id=5b1f9bb96)

* putenv.c:

  Initial revision
  [[c31749bb5]](https://git.sudo.ws/sudo/commit/?id=c31749bb5)

1994-08-06 Todd C. Miller

* sudo\_setenv.c:

  Initial revision
  [[b82711913]](https://git.sudo.ws/sudo/commit/?id=b82711913)

* sudo.h:

  rm’d s realp[ath added sudo\_realpath and sudo\_setenv
  [[8d2884395]](https://git.sudo.ws/sudo/commit/?id=8d2884395)

* sudo.c:

  now use sudo\_setenvc
  [[7b0e8546f]](https://git.sudo.ws/sudo/commit/?id=7b0e8546f)

* configure.in:

  added puteenv and setenv, removed realpath
  [[e80ed0c91]](https://git.sudo.ws/sudo/commit/?id=e80ed0c91)

* config.h.in:

  added putenv & setenv
  [[9fb3f695e]](https://git.sudo.ws/sudo/commit/?id=9fb3f695e)

* Makefile.in:

  added sudo\_setenv
  [[c07002061]](https://git.sudo.ws/sudo/commit/?id=c07002061)

* version.h:

  ++
  [[121d219b8]](https://git.sudo.ws/sudo/commit/?id=121d219b8)

1994-08-05 Todd C. Miller

* configure.in:

  added MAN\_POSTINSTALL and /usr/share/catman for irix
  [[3f4bcc6ad]](https://git.sudo.ws/sudo/commit/?id=3f4bcc6ad)

* Makefile.in:

  added MAN\_POSTINSTALL
  [[bb6e73e3a]](https://git.sudo.ws/sudo/commit/?id=bb6e73e3a)

* CHANGES:

  added
  [[108b01614]](https://git.sudo.ws/sudo/commit/?id=108b01614)

* sudo.man:

  added SUDO\_\* plus new options
  [[510223269]](https://git.sudo.ws/sudo/commit/?id=510223269)

* CHANGES:

  added one
  [[5130df6af]](https://git.sudo.ws/sudo/commit/?id=5130df6af)

* configure.in:

  took out shadow lib
  [[6f4d5e7e7]](https://git.sudo.ws/sudo/commit/?id=6f4d5e7e7)

* TODO:

  adde done
  [[ca19e057f]](https://git.sudo.ws/sudo/commit/?id=ca19e057f)

* visudo.c:

  now use yyrestart() if flex now reset yylineno to 0
  [[a1ebf256d]](https://git.sudo.ws/sudo/commit/?id=a1ebf256d)

* Makefile.in:

  support for installing a cat page instead of a man page if no nroff
  [[c87dbc5fd]](https://git.sudo.ws/sudo/commit/?id=c87dbc5fd)

* configure.in:

  now defines HAVE\_FLEX fixed up man stuff so that it looks for nroff to
  determine whether or not to install a cat or man page
  [[9007d32f3]](https://git.sudo.ws/sudo/commit/?id=9007d32f3)

* config.h.in:

  added HAVE\_FLEX
  [[a05e773b6]](https://git.sudo.ws/sudo/commit/?id=a05e773b6)

* sudo.c:

  not set ret to MODE\_RUN initially
  [[ee50a4661]](https://git.sudo.ws/sudo/commit/?id=ee50a4661)

* find\_path.c:

  made command (and therefor cmnd dynamically allocated)
  [[494d1c116]](https://git.sudo.ws/sudo/commit/?id=494d1c116)

* TODO:

  did #8
  [[d5cd5fac2]](https://git.sudo.ws/sudo/commit/?id=d5cd5fac2)

* version.h:

  ++
  [[ace8ac2c0]](https://git.sudo.ws/sudo/commit/?id=ace8ac2c0)

* sudo\_realpath.c:

  changed bufs from MAXPATHLEN to MAXPATHLEN+1
  [[22fa51dbf]](https://git.sudo.ws/sudo/commit/?id=22fa51dbf)

* sudo.h:

  added MODE\_ removed validate\_only and added remove\_timestamp()
  [[a6fe8c86a]](https://git.sudo.ws/sudo/commit/?id=a6fe8c86a)

* sudo.c:

  usage() now takes an int (exit value) added parse\_args() to parse
  command line arguments moved call to find\_path() from load\_globals to
  new function load\_cmnd() removed validate\_only global – now use the
  concept of “modes” added -h and -k options
  [[70333883c]](https://git.sudo.ws/sudo/commit/?id=70333883c)

* parse.c:

  no longer use global validate\_only now checks for command called
  “validate” removed check for non-fully qualified commands since that is
  done by find\_path
  [[a24fdfd08]](https://git.sudo.ws/sudo/commit/?id=a24fdfd08)

* find\_path.c:

  changed MAXPATHLEN r to MAXPATHLEN+1
  [[0b185cb71]](https://git.sudo.ws/sudo/commit/?id=0b185cb71)

* find\_path.c:

  fixed off by one error with MAXPATHLEN and fixed a comment
  [[3353665bb]](https://git.sudo.ws/sudo/commit/?id=3353665bb)

* check.c:

  check\_timestamp no longer runs reminder(), it is implied in the return
  val added remove\_timestamp()
  [[81cf2c5e6]](https://git.sudo.ws/sudo/commit/?id=81cf2c5e6)

* CHANGES:

  updated
  [[e418bfc74]](https://git.sudo.ws/sudo/commit/?id=e418bfc74)

1994-08-04 Todd C. Miller

* BUGS:

  fixed on
  [[abd71f1a7]](https://git.sudo.ws/sudo/commit/?id=abd71f1a7)

* sudo\_realpath.c:

  took out old\_errno
  [[6259b8270]](https://git.sudo.ws/sudo/commit/?id=6259b8270)

* CHANGES:

  updated
  [[3f0fd7c8c]](https://git.sudo.ws/sudo/commit/?id=3f0fd7c8c)

1994-08-03 Todd C. Miller

* logging.c:

  moved send\_mail to after syslog
  [[91970b418]](https://git.sudo.ws/sudo/commit/?id=91970b418)

* sudo.c:

  now set SUDO\_ envariables
  [[8161d52f3]](https://git.sudo.ws/sudo/commit/?id=8161d52f3)

1994-08-01 Todd C. Miller

* version.h:

  ++
  [[c8fa6ac23]](https://git.sudo.ws/sudo/commit/?id=c8fa6ac23)

* sudo\_realpath.c:

  now print error if chdir fails
  [[35d838c68]](https://git.sudo.ws/sudo/commit/?id=35d838c68)

* find\_path.c:

  removed an XXX
  [[3c318d8ae]](https://git.sudo.ws/sudo/commit/?id=3c318d8ae)

1994-07-26 Todd C. Miller

* CHANGES:

  updated
  [[17800e3e9]](https://git.sudo.ws/sudo/commit/?id=17800e3e9)

* configure.in:

  no more static binaries for aix
  [[648570a53]](https://git.sudo.ws/sudo/commit/?id=648570a53)

1994-07-25 Todd C. Miller

* INSTALL:

  fixed typo
  [[193f01342]](https://git.sudo.ws/sudo/commit/?id=193f01342)

* sudo\_realpath.c:

  took out stuff not needed for sudo now does be\_root/be\_user itself now
  uses cwd global
  [[46a7d9cd5]](https://git.sudo.ws/sudo/commit/?id=46a7d9cd5)

* version.h:

  +=2
  [[691f31353]](https://git.sudo.ws/sudo/commit/?id=691f31353)

* logging.c, sudo.c:

  be\_root/be\_user is now down in sudo\_realpath()
  [[2624e7ee7]](https://git.sudo.ws/sudo/commit/?id=2624e7ee7)

* logging.c, sudo.h:

  now works with 4.2BSD syslog (blech)
  [[7b70cafbb]](https://git.sudo.ws/sudo/commit/?id=7b70cafbb)

* find\_path.c:

  now use sudo\_realpath()
  [[93230e6c2]](https://git.sudo.ws/sudo/commit/?id=93230e6c2)

* config.h.in:

  took out realpth() stuff since we now use sudo\_realpath()
  [[0230d8474]](https://git.sudo.ws/sudo/commit/?id=0230d8474)

* configure.in:

  ultrix enhanced sec
  [[445a13eeb]](https://git.sudo.ws/sudo/commit/?id=445a13eeb)

* SUPPORTED:

  added ultrix enhanced sec.
  [[35ae1ba37]](https://git.sudo.ws/sudo/commit/?id=35ae1ba37)

* INSTALL:

  updated
  [[c3f2fa99c]](https://git.sudo.ws/sudo/commit/?id=c3f2fa99c)

* check.c:

  ultrix enhanced security suport
  [[3a61f6992]](https://git.sudo.ws/sudo/commit/?id=3a61f6992)

* Makefile.in:

  added sudo\_realpath.c
  [[1f8ffedda]](https://git.sudo.ws/sudo/commit/?id=1f8ffedda)

* CHANGES:

  updated
  [[b46f59417]](https://git.sudo.ws/sudo/commit/?id=b46f59417)

* tgetpass.c:

  increased passwd len to 24 for c2 security
  [[adf4060de]](https://git.sudo.ws/sudo/commit/?id=adf4060de)

* BUGS:

  updated BUGS
  [[abf8c06cb]](https://git.sudo.ws/sudo/commit/?id=abf8c06cb)

1994-07-15 Todd C. Miller

* check.c:

  now use user global var
  [[6f2b5908c]](https://git.sudo.ws/sudo/commit/?id=6f2b5908c)

* configure.in:

  took out -ls
  [[c1850dc59]](https://git.sudo.ws/sudo/commit/?id=c1850dc59)

1994-07-14 Todd C. Miller

* configure.in:

  added AFS libs
  [[18d1aa194]](https://git.sudo.ws/sudo/commit/?id=18d1aa194)

* sudo.h:

  user is now a char \* added epasswd
  [[5cd28192b]](https://git.sudo.ws/sudo/commit/?id=5cd28192b)

* sudo.c:

  added tzset() to load\_globals added epasswd (encrypted password) global
  made user dynamically allocated
  [[e7bf4f9fe]](https://git.sudo.ws/sudo/commit/?id=e7bf4f9fe)

* configure.in:

  added tzset test
  [[c61a3f9b7]](https://git.sudo.ws/sudo/commit/?id=c61a3f9b7)

* config.h.in:

  added HAVE\_TZSET
  [[6da926cb1]](https://git.sudo.ws/sudo/commit/?id=6da926cb1)

* check.c:

  cleaned up encrypted passwd grab somewhat
  [[5d1d53ddb]](https://git.sudo.ws/sudo/commit/?id=5d1d53ddb)

* configure.in:

  fixed AFS typo
  [[df5ff10a2]](https://git.sudo.ws/sudo/commit/?id=df5ff10a2)

* INSTALL:

  added AFS not
  [[8d3e7540f]](https://git.sudo.ws/sudo/commit/?id=8d3e7540f)

* CHANGES:

  udpated
  [[511ab3ee9]](https://git.sudo.ws/sudo/commit/?id=511ab3ee9)

* logging.c:

  can now log to both syslog & a file
  [[be6537192]](https://git.sudo.ws/sudo/commit/?id=be6537192)

* sudo.h:

  added BOTH\_LOGS
  [[c80d59a51]](https://git.sudo.ws/sudo/commit/?id=c80d59a51)

* CHANGES:

  updated
  [[1fec608b9]](https://git.sudo.ws/sudo/commit/?id=1fec608b9)

* configure.in:

  –with-AFS
  [[9afc5e8d9]](https://git.sudo.ws/sudo/commit/?id=9afc5e8d9)

* config.h.in:

  added HAVE\_AFS
  [[8ff8e0d7f]](https://git.sudo.ws/sudo/commit/?id=8ff8e0d7f)

* check.c:

  added afs changes
  [[b3adbb74b]](https://git.sudo.ws/sudo/commit/?id=b3adbb74b)

* sudo.h:

  removed AFS stuff :-)
  [[de673c3fe]](https://git.sudo.ws/sudo/commit/?id=de673c3fe)

* tgetpass.c:

  include sys/select for AIX
  [[88e2af512]](https://git.sudo.ws/sudo/commit/?id=88e2af512)

* sudo.h:

  added AFS
  [[624a46cd1]](https://git.sudo.ws/sudo/commit/?id=624a46cd1)

* version.h:

  ++
  [[de84c4f25]](https://git.sudo.ws/sudo/commit/?id=de84c4f25)

1994-07-07 Todd C. Miller

* CHANGES, SUPPORTED:

  updated
  [[a5c59d2d6]](https://git.sudo.ws/sudo/commit/?id=a5c59d2d6)

* logging.c:

  can now have MAILER undefined
  [[f3cd23eee]](https://git.sudo.ws/sudo/commit/?id=f3cd23eee)

* INSTALL:

  new sub-note about MAILER
  [[7083436ee]](https://git.sudo.ws/sudo/commit/?id=7083436ee)

* sudo.man:

  added blurb about password timeout
  [[5fe128aab]](https://git.sudo.ws/sudo/commit/?id=5fe128aab)

* configure.in:

  convex c2 changes
  [[8b8127da5]](https://git.sudo.ws/sudo/commit/?id=8b8127da5)

* aclocal.m4:

  took out duplicate define of \_CONVEX\_SOURCE
  [[d0aeec82d]](https://git.sudo.ws/sudo/commit/?id=d0aeec82d)

* Makefile.in:

  added OSDEFS
  [[8a28dbc48]](https://git.sudo.ws/sudo/commit/?id=8a28dbc48)

* config.h.in:

  added spaces
  [[6cbabab4e]](https://git.sudo.ws/sudo/commit/?id=6cbabab4e)

* tgetpass.c:

  added a goto if fgets fails
  [[cd4a540c1]](https://git.sudo.ws/sudo/commit/?id=cd4a540c1)

* sudo.h:

  use \_\_hpux not hpux convex c2 stuff
  [[2b12703ae]](https://git.sudo.ws/sudo/commit/?id=2b12703ae)

* sudo.c:

  use \_\_hpux not hpux
  [[0148bcaf6]](https://git.sudo.ws/sudo/commit/?id=0148bcaf6)

* logging.c:

  convex c2 stuff
  [[93279eeaf]](https://git.sudo.ws/sudo/commit/?id=93279eeaf)

* config.h.in:

  define ansi-ish cpp os defines if non-ansi are defined for hpux & convex
  [[63bd80e13]](https://git.sudo.ws/sudo/commit/?id=63bd80e13)

* INSTALL:

  updated to say we support sonvex C2
  [[4025b56ea]](https://git.sudo.ws/sudo/commit/?id=4025b56ea)

* check.c:

  added convex c2 support
  [[ff2bea694]](https://git.sudo.ws/sudo/commit/?id=ff2bea694)

1994-07-01 Todd C. Miller

* tgetpass.c:

  no more ioctl never returns NULL uses fgets() and select() to timeout
  [[e94e7218b]](https://git.sudo.ws/sudo/commit/?id=e94e7218b)

1994-06-29 Todd C. Miller

* configure.in:

  things were testing -n “$GCC” instead of -z “$GCC”
  [[840b5688d]](https://git.sudo.ws/sudo/commit/?id=840b5688d)

* tgetpass.c:

  now works + uses fgets()
  [[85a5899af]](https://git.sudo.ws/sudo/commit/?id=85a5899af)

1994-06-28 Todd C. Miller

* tgetpass.c:

  select doesn’t seem to recognize a single ‘\n’ as input waiting so we
  can;t use it, sigh.
  [[391a73f40]](https://git.sudo.ws/sudo/commit/?id=391a73f40)

1994-06-26 Todd C. Miller

* PORTING:

  updated tgetpass() blurb
  [[a541ff80b]](https://git.sudo.ws/sudo/commit/?id=a541ff80b)

* configure.in:

  added –with-getpass
  [[a16b59c88]](https://git.sudo.ws/sudo/commit/?id=a16b59c88)

* Makefile.in:

  added tgetpass stuff
  [[90b6768a8]](https://git.sudo.ws/sudo/commit/?id=90b6768a8)

* tgetpass.c:

  now uses stdio
  [[605250d9a]](https://git.sudo.ws/sudo/commit/?id=605250d9a)

* version.h:

  ++
  [[0e68f2351]](https://git.sudo.ws/sudo/commit/?id=0e68f2351)

1994-06-24 Todd C. Miller

* PORTING:

  updated ,.
  [[5f597efb1]](https://git.sudo.ws/sudo/commit/?id=5f597efb1)

* config.h.in:

  added USE\_GETPASS && HAVE\_C2\_SECURITY
  [[f7d1ae533]](https://git.sudo.ws/sudo/commit/?id=f7d1ae533)

* configure.in:

  fixed a test aded –with-C2 and –with-tgetpass
  [[56bcd39a2]](https://git.sudo.ws/sudo/commit/?id=56bcd39a2)

* check.c:

  added hpux C2 shit
  [[8680c1962]](https://git.sudo.ws/sudo/commit/?id=8680c1962)

* Makefile.in:

  took out tgetpass.\*
  [[94cf91194]](https://git.sudo.ws/sudo/commit/?id=94cf91194)

* INSTALL:

  added C2 blurb
  [[efb9ac3e8]](https://git.sudo.ws/sudo/commit/?id=efb9ac3e8)

1994-06-13 Todd C. Miller

* configure.in:

  no termio(s) for ultrix since it is broken
  [[0e3502816]](https://git.sudo.ws/sudo/commit/?id=0e3502816)

* check.c:

  added a space (yeah, anal)
  [[32e385dbc]](https://git.sudo.ws/sudo/commit/?id=32e385dbc)

* realpath.c, sudo\_realpath.c:

  fixed it (duh, rtfm)
  [[a534a9688]](https://git.sudo.ws/sudo/commit/?id=a534a9688)

1994-06-08 Todd C. Miller

* config.h.in:

  took out bsd signal stuff for irix
  [[ba0fa8127]](https://git.sudo.ws/sudo/commit/?id=ba0fa8127)

* visudo.c:

  comments in #endif
  [[213000626]](https://git.sudo.ws/sudo/commit/?id=213000626)

* configure.in:

  don’t define BSD signals for irix
  [[9952fbbd8]](https://git.sudo.ws/sudo/commit/?id=9952fbbd8)

* TODO:

  did some…
  [[c783c5800]](https://git.sudo.ws/sudo/commit/?id=c783c5800)

* CHANGES:

  updated
  [[9a62cffff]](https://git.sudo.ws/sudo/commit/?id=9a62cffff)

* realpath.c, sudo\_realpath.c:

  took out unneeded code by changing where a strings was terminated
  [[1970f75b4]](https://git.sudo.ws/sudo/commit/?id=1970f75b4)

1994-06-07 Todd C. Miller

* realpath.c, sudo\_realpath.c:

  fix bug where /dirname would return NULL
  [[d8013e48b]](https://git.sudo.ws/sudo/commit/?id=d8013e48b)

* sudo.h:

  move \_\_P to config.h
  [[c2c72c6e7]](https://git.sudo.ws/sudo/commit/?id=c2c72c6e7)

* getcwd.c, getwd.c, realpath.c, sudo\_realpath.c:

  added errno definition
  [[9e85433e9]](https://git.sudo.ws/sudo/commit/?id=9e85433e9)

* config.h.in:

  added \_\_P
  [[dce131798]](https://git.sudo.ws/sudo/commit/?id=dce131798)

* config.h.in:

  added HAVE\_FCHDIR
  [[678b9c6bc]](https://git.sudo.ws/sudo/commit/?id=678b9c6bc)

* strdup.c:

  now include stdio
  [[d717b6dd5]](https://git.sudo.ws/sudo/commit/?id=d717b6dd5)

* realpath.c, sudo\_realpath.c:

  now works if no fchdir
  [[56e09c3b7]](https://git.sudo.ws/sudo/commit/?id=56e09c3b7)

* visudo.c:

  define SA\_RESETHAND to null if not defined
  [[a0944afd8]](https://git.sudo.ws/sudo/commit/?id=a0944afd8)

* configure.in:

  added check & replace
  [[e2ffd1432]](https://git.sudo.ws/sudo/commit/?id=e2ffd1432)

* configure.in:

  took out -static for nextstep – it doesn’t work
  [[7ba319bd5]](https://git.sudo.ws/sudo/commit/?id=7ba319bd5)

1994-06-06 Todd C. Miller

* logging.c:

  moved #endif to where it belongs
  [[e066e7b2f]](https://git.sudo.ws/sudo/commit/?id=e066e7b2f)

* SUPPORTED:

  correction
  [[0e7f77f8e]](https://git.sudo.ws/sudo/commit/?id=0e7f77f8e)

* configure.in:

  now checks for strdup realpath getcwd bzero
  [[b21fe972a]](https://git.sudo.ws/sudo/commit/?id=b21fe972a)

* config.h.in:

  emulate bzero
  [[807274756]](https://git.sudo.ws/sudo/commit/?id=807274756)

* visudo.c:

  added posic signals
  [[b1d57caa6]](https://git.sudo.ws/sudo/commit/?id=b1d57caa6)

* tgetpass.c:

  bzero cast
  [[289e1ea1f]](https://git.sudo.ws/sudo/commit/?id=289e1ea1f)

* logging.c:

  added posix signals
  [[369cf760d]](https://git.sudo.ws/sudo/commit/?id=369cf760d)

* configure.in:

  removed BROKEN\_GETPASS added new srcs toreplace missing functions
  [[f2a4f4ad7]](https://git.sudo.ws/sudo/commit/?id=f2a4f4ad7)

* config.h.in:

  added posix signal stuff
  [[54c4fdf46]](https://git.sudo.ws/sudo/commit/?id=54c4fdf46)

* Makefile.in:

  added new srcs
  [[e97a32e6f]](https://git.sudo.ws/sudo/commit/?id=e97a32e6f)

* visudo.c:

  updated useag
  [[9fe50ceef]](https://git.sudo.ws/sudo/commit/?id=9fe50ceef)

* tgetpass.c:

  now uses posix signals
  [[49b131a7e]](https://git.sudo.ws/sudo/commit/?id=49b131a7e)

* PORTING:

  updated sto reflect major changes
  [[473acb842]](https://git.sudo.ws/sudo/commit/?id=473acb842)

* CHANGES, TODO:

  updated
  [[662727816]](https://git.sudo.ws/sudo/commit/?id=662727816)

* tgetpass.c:

  uses sysconf() if available
  [[14ea471ac]](https://git.sudo.ws/sudo/commit/?id=14ea471ac)

* sudo.h:

  added PASSWORD\_TIMEOUT + prototypes for new functions
  [[c49ded5fd]](https://git.sudo.ws/sudo/commit/?id=c49ded5fd)

* realpath.c, sudo\_realpath.c:

  for those w/o this in libc
  [[2ff87dea0]](https://git.sudo.ws/sudo/commit/?id=2ff87dea0)

* getcwd.c, getwd.c:

  Initial revision
  [[1460112ba]](https://git.sudo.ws/sudo/commit/?id=1460112ba)

* find\_path.c:

  rewrote to use realpath(3) - nis now all my code
  [[bcdde9854]](https://git.sudo.ws/sudo/commit/?id=bcdde9854)

* config.h.in:

  added HAVE\_REALPATH
  [[d5573c8fa]](https://git.sudo.ws/sudo/commit/?id=d5573c8fa)

* check.c:

  now use tgetpass
  [[ccc790967]](https://git.sudo.ws/sudo/commit/?id=ccc790967)

* Makefile.in:

  added LIBOBJS use tgetpass.c
  [[42335fe01]](https://git.sudo.ws/sudo/commit/?id=42335fe01)

1994-06-05 Todd C. Miller

* tgetpass.c:

  works now :-)
  [[7a0dee3e6]](https://git.sudo.ws/sudo/commit/?id=7a0dee3e6)

* tgetpass.c:

  Initial revision
  [[7c8d0ba74]](https://git.sudo.ws/sudo/commit/?id=7c8d0ba74)

* pathnames.h.in:

  added /dev/tty
  [[1cbcc7d1f]](https://git.sudo.ws/sudo/commit/?id=1cbcc7d1f)

1994-06-04 Todd C. Miller

* version.h:

  incremented
  [[b5ff63bb4]](https://git.sudo.ws/sudo/commit/?id=b5ff63bb4)

* sudo.c:

  always use getcwd
  [[a5c4f697d]](https://git.sudo.ws/sudo/commit/?id=a5c4f697d)

* config.h.in:

  added check for getwd
  [[d658bd71a]](https://git.sudo.ws/sudo/commit/?id=d658bd71a)

* configure.in:

  replace strdup & realpath & getcwd if missing
  [[4e09ec9e8]](https://git.sudo.ws/sudo/commit/?id=4e09ec9e8)

* pathnames.h.in:

  added \_PATH\_PWD
  [[96227ea99]](https://git.sudo.ws/sudo/commit/?id=96227ea99)

* aclocal.m4:

  added SUDO\_PROG\_PWD
  [[84e75c6ee]](https://git.sudo.ws/sudo/commit/?id=84e75c6ee)

* strdup.c:

  Initial revision
  [[aa3f3f2b6]](https://git.sudo.ws/sudo/commit/?id=aa3f3f2b6)

* realpath.c, sudo\_realpath.c:

  Initial revision
  [[6b8659a55]](https://git.sudo.ws/sudo/commit/?id=6b8659a55)

1994-06-03 Todd C. Miller

* configure.in:

  quoted quare brackets
  [[4eb6ab0b4]](https://git.sudo.ws/sudo/commit/?id=4eb6ab0b4)

1994-06-02 Todd C. Miller

* sudo.c:

  no need to strdup() a constant
  [[9e79c34b9]](https://git.sudo.ws/sudo/commit/?id=9e79c34b9)

* CHANGES:

  updated
  [[b46f7ee32]](https://git.sudo.ws/sudo/commit/?id=b46f7ee32)

* sudo.man:

  added validate
  [[c0c9196c5]](https://git.sudo.ws/sudo/commit/?id=c0c9196c5)

* sudo.c:

  added -v to usage
  [[48b8a66dc]](https://git.sudo.ws/sudo/commit/?id=48b8a66dc)

* parse.c, sudo.c, sudo.h:

  added validate\_only stuff
  [[71cba1559]](https://git.sudo.ws/sudo/commit/?id=71cba1559)

1994-05-30 Todd C. Miller

* configure.in:

  now finds sed
  [[b32c8249b]](https://git.sudo.ws/sudo/commit/?id=b32c8249b)

* aclocal.m4:

  $OSREV is now an int
  [[9f8f955af]](https://git.sudo.ws/sudo/commit/?id=9f8f955af)

1994-05-29 Todd C. Miller

* configure.in:

  added mtxinu to caser
  [[418f2c1b1]](https://git.sudo.ws/sudo/commit/?id=418f2c1b1)

* sudo.h:

  added EXEC macro
  [[e3021f03c]](https://git.sudo.ws/sudo/commit/?id=e3021f03c)

* sudo.c:

  now use the EXEC nmacro now only do a gethostbyname() if FQDN is set
  [[a298a5dc4]](https://git.sudo.ws/sudo/commit/?id=a298a5dc4)

* logging.c:

  changed mail\_argv[] def now use EXEC() macro
  [[7e8d543af]](https://git.sudo.ws/sudo/commit/?id=7e8d543af)

* check.c:

  took out crypt() definition
  [[82eebb817]](https://git.sudo.ws/sudo/commit/?id=82eebb817)

* version.h:

  upped the version
  [[182569994]](https://git.sudo.ws/sudo/commit/?id=182569994)

* configure.in:

  always look for -lnsl
  [[577b056eb]](https://git.sudo.ws/sudo/commit/?id=577b056eb)

* aclocal.m4:

  added an echo
  [[6224b05a7]](https://git.sudo.ws/sudo/commit/?id=6224b05a7)

* sudo.h:

  SHORT\_MESSAGE is now the default
  [[6767aaea0]](https://git.sudo.ws/sudo/commit/?id=6767aaea0)

* config.h.in:

  fixed typo
  [[bada3e70e]](https://git.sudo.ws/sudo/commit/?id=bada3e70e)

* configure.in:

  added missing AC\_DEFINE(SVR4) for solaris
  [[2aef79a8d]](https://git.sudo.ws/sudo/commit/?id=2aef79a8d)

* sudo.man:

  documented the -v flag
  [[d194e3be5]](https://git.sudo.ws/sudo/commit/?id=d194e3be5)

* SUPPORTED:

  updated
  [[d430425c5]](https://git.sudo.ws/sudo/commit/?id=d430425c5)

* check.c:

  proto-ized crypt()
  [[4cb06ad6e]](https://git.sudo.ws/sudo/commit/?id=4cb06ad6e)

* config.h.in:

  added LIBSHADOW undef
  [[3288ffb0c]](https://git.sudo.ws/sudo/commit/?id=3288ffb0c)

* configure.in:

  nwo set OS to be lowercase
  [[4e2dcf6da]](https://git.sudo.ws/sudo/commit/?id=4e2dcf6da)

1994-05-28 Todd C. Miller

* configure.in:

  now use SUDO\_OSTYPE to set $OS
  [[97610ce1a]](https://git.sudo.ws/sudo/commit/?id=97610ce1a)

* aclocal.m4:

  now use uname to determine os
  [[2660e4eca]](https://git.sudo.ws/sudo/commit/?id=2660e4eca)

* visudo.c:

  added prototypes & moved sig handler around
  [[3d1600cf9]](https://git.sudo.ws/sudo/commit/?id=3d1600cf9)

* sudo.h:

  added prototyppes
  [[c38d9bb31]](https://git.sudo.ws/sudo/commit/?id=c38d9bb31)

* check.c, logging.c, sudo.c:

  added prototypes
  [[ebae58f1e]](https://git.sudo.ws/sudo/commit/?id=ebae58f1e)

* parse.c:

  added comment
  [[aab695bfc]](https://git.sudo.ws/sudo/commit/?id=aab695bfc)

* config.h.in:

  nwo use \_BSD\_SIGNALS not \_BSD\_COMPAT
  [[1ad59c55a]](https://git.sudo.ws/sudo/commit/?id=1ad59c55a)

* aixcrypt.exp:

  Initial revision
  [[ca172a787]](https://git.sudo.ws/sudo/commit/?id=ca172a787)

* Makefile.in:

  added aixcrypt.exp
  [[ef0a3ea3f]](https://git.sudo.ws/sudo/commit/?id=ef0a3ea3f)

* parse.lex, parse.yacc:

  moved config.h to top of includes
  [[e24868395]](https://git.sudo.ws/sudo/commit/?id=e24868395)

1994-05-25 Todd C. Miller

* find\_path.c:

  now don’t bitch if get EACCESS (treat like EPERM)
  [[c1d9e44e5]](https://git.sudo.ws/sudo/commit/?id=c1d9e44e5)

* visudo.c:

  added -v flag and usage()
  [[6e7d42f3e]](https://git.sudo.ws/sudo/commit/?id=6e7d42f3e)

* version.h:

  fixed a typo
  [[51ae4df13]](https://git.sudo.ws/sudo/commit/?id=51ae4df13)

* sudo.c:

  cast Argv to a const for exec added -v flag
  [[48f3cb673]](https://git.sudo.ws/sudo/commit/?id=48f3cb673)

* logging.c:

  mail\_argv is now a const
  [[dbe2a6eaf]](https://git.sudo.ws/sudo/commit/?id=dbe2a6eaf)

* configure.in:

  only set RETSIGTYPE if it is not set already
  [[30eac2b98]](https://git.sudo.ws/sudo/commit/?id=30eac2b98)

* aclocal.m4:

  now defines & STDC\_HEADERS for Irix
  [[07cc73c86]](https://git.sudo.ws/sudo/commit/?id=07cc73c86)

* Makefile.in:

  added version.h
  [[c18eee72f]](https://git.sudo.ws/sudo/commit/?id=c18eee72f)

* insults.h, sudo.h:

  prevent multiple inclusion
  [[76d8f8314]](https://git.sudo.ws/sudo/commit/?id=76d8f8314)

* version.h:

  Initial revision
  [[5ad8ed74a]](https://git.sudo.ws/sudo/commit/?id=5ad8ed74a)

* parse.lex, parse.yacc:

  now includes config.h
  [[d84455362]](https://git.sudo.ws/sudo/commit/?id=d84455362)

* aclocal.m4:

  now talks about sunos 4.x
  [[85cb36bf0]](https://git.sudo.ws/sudo/commit/?id=85cb36bf0)

* visudo.c:

  calls to Exit now pass an arg
  [[c8dd0685a]](https://git.sudo.ws/sudo/commit/?id=c8dd0685a)

1994-05-24 Todd C. Miller

* visudo.c:

  signal handler now takes an int argument
  [[cd34949b7]](https://git.sudo.ws/sudo/commit/?id=cd34949b7)

* CHANGES:

  updated
  [[77bafb149]](https://git.sudo.ws/sudo/commit/?id=77bafb149)

* sudo.c:

  ok, the getcwd() is now *really* done as the user
  [[0d0f47007]](https://git.sudo.ws/sudo/commit/?id=0d0f47007)

* configure.in:

  changed AIX STATIC\_FLAGS
  [[e1b0835d1]](https://git.sudo.ws/sudo/commit/?id=e1b0835d1)

* aclocal.m4:

  solaris now defines SVR4
  [[bd6ad42ff]](https://git.sudo.ws/sudo/commit/?id=bd6ad42ff)

* sudo.h:

  added cwd and fixed stupid core dump that makes no sense. sigh.
  [[e67d74fd5]](https://git.sudo.ws/sudo/commit/?id=e67d74fd5)

* sudo.c:

  moved getcwd stuff into load\_globals
  [[3e94c6f25]](https://git.sudo.ws/sudo/commit/?id=3e94c6f25)

* parse.c:

  took out externs that are in suod.h
  [[3b297e037]](https://git.sudo.ws/sudo/commit/?id=3b297e037)

* logging.c:

  moved cwd into load\_globals
  [[0745d6014]](https://git.sudo.ws/sudo/commit/?id=0745d6014)

* find\_path.c:

  moved cwd stuff
  [[f12f25204]](https://git.sudo.ws/sudo/commit/?id=f12f25204)

* Makefile.in:

  fixed make distclean & realclean
  [[eba71ad92]](https://git.sudo.ws/sudo/commit/?id=eba71ad92)

* TODO:

  updated .,
  [[155ee3a3c]](https://git.sudo.ws/sudo/commit/?id=155ee3a3c)

* CHANGES:

  added solaris changes
  [[ae8e3920f]](https://git.sudo.ws/sudo/commit/?id=ae8e3920f)

* aclocal.m4:

  added solaris changes, need to rework
  [[70bf2e06d]](https://git.sudo.ws/sudo/commit/?id=70bf2e06d)

* configure.in:

  cleaned up for solaris
  [[78d689a68]](https://git.sudo.ws/sudo/commit/?id=78d689a68)

* logging.c:

  reinstall reapchild signal handler for non-bsd signals
  [[f1dd6045c]](https://git.sudo.ws/sudo/commit/?id=f1dd6045c)

* sudo.h:

  took out getdtablesize() emulation for HP-UX (no longer needed)
  [[813b5043d]](https://git.sudo.ws/sudo/commit/?id=813b5043d)

* sudo.c:

  support for HAVE\_SYSCONF
  [[92c371d0f]](https://git.sudo.ws/sudo/commit/?id=92c371d0f)

* visudo.c:

  added <fcntl.h> for solaris & reorg’d the includes + minor prettying
  up /
  [[e5bfa3716]](https://git.sudo.ws/sudo/commit/?id=e5bfa3716)

* config.h.in:

  added HAVE\_SYSCONF
  [[b31df9d64]](https://git.sudo.ws/sudo/commit/?id=b31df9d64)

1994-05-16 Todd C. Miller

* configure.in:

  now tells you what os you are running /.
  [[5e9f8b3fa]](https://git.sudo.ws/sudo/commit/?id=5e9f8b3fa)

* aclocal.m4:

  took out extra ‘,’
  [[b6f0ae579]](https://git.sudo.ws/sudo/commit/?id=b6f0ae579)

1994-05-14 Todd C. Miller

* config.h.in:

  added \_BSD\_COMPAT
  [[f3cd67d4c]](https://git.sudo.ws/sudo/commit/?id=f3cd67d4c)

* aclocal.m4:

  fixed for irix5
  [[368f8ff12]](https://git.sudo.ws/sudo/commit/?id=368f8ff12)

* CHANGES:

  updated
  [[706d34d6e]](https://git.sudo.ws/sudo/commit/?id=706d34d6e)

* sudo.c:

  uid seinitialized to -2
  [[eba166035]](https://git.sudo.ws/sudo/commit/?id=eba166035)

1994-04-28 Todd C. Miller

* sudo.c:

  now removes LIBPATH for AIX
  [[4624211f8]](https://git.sudo.ws/sudo/commit/?id=4624211f8)

1994-03-13 Todd C. Miller

* configure.in:

  now uses ufc if it finds it
  [[d344d9926]](https://git.sudo.ws/sudo/commit/?id=d344d9926)

1994-03-12 Todd C. Miller

* sudo.h:

  no longer define yyval & yylval since yacc does it
  [[9c8379f84]](https://git.sudo.ws/sudo/commit/?id=9c8379f84)

* parse.lex:

  now defines yylval as extenr
  [[3420a8138]](https://git.sudo.ws/sudo/commit/?id=3420a8138)

* configure.in:

  BROKEN\_GETPASS is now an OPTION
  [[b4c691030]](https://git.sudo.ws/sudo/commit/?id=b4c691030)

* config.h.in:

  took out BROKEN\_GETPASS
  [[bf67223ed]](https://git.sudo.ws/sudo/commit/?id=bf67223ed)

* Makefile.in:

  took out big comment
  [[a7554759f]](https://git.sudo.ws/sudo/commit/?id=a7554759f)

* README:

  updated
  [[963ff0128]](https://git.sudo.ws/sudo/commit/?id=963ff0128)

* Makefile.in:

  took out README.beta
  [[d068ff5c4]](https://git.sudo.ws/sudo/commit/?id=d068ff5c4)

* SUPPORTED:

  Initial revision
  [[a510313f5]](https://git.sudo.ws/sudo/commit/?id=a510313f5)

* INSTALL:

  now reference SUPPORTED .,
  [[125035689]](https://git.sudo.ws/sudo/commit/?id=125035689)

* config.h.in:

  now check for convex OR **convex**
  [[7b8a8ca5c]](https://git.sudo.ws/sudo/commit/?id=7b8a8ca5c)

* aclocal.m4:

  now check for convex or **convex**
  [[bccde2f1f]](https://git.sudo.ws/sudo/commit/?id=bccde2f1f)

* Makefile.in:

  added dist target
  [[c65bf9a27]](https://git.sudo.ws/sudo/commit/?id=c65bf9a27)

* aclocal.m4:

  use **convex**
  [[7545c3f56]](https://git.sudo.ws/sudo/commit/?id=7545c3f56)

* find\_path.c:

  now use *S*\* stat stuff to be ansi-like
  [[e4488ba02]](https://git.sudo.ws/sudo/commit/?id=e4488ba02)

* INSTALL:

  updated for configure directions
  [[34e610346]](https://git.sudo.ws/sudo/commit/?id=34e610346)

* Makefile.in:

  distclean now removes config.h and pathnames.h
  [[ac5d3ccc9]](https://git.sudo.ws/sudo/commit/?id=ac5d3ccc9)

* CHANGES:

  updated
  [[00059fed6]](https://git.sudo.ws/sudo/commit/?id=00059fed6)

* TODO:

  fixed typoe
  [[20fb526ac]](https://git.sudo.ws/sudo/commit/?id=20fb526ac)

* visudo.c:

  updated version
  [[af68170f3]](https://git.sudo.ws/sudo/commit/?id=af68170f3)

* Makefile.in:

  updated version
  [[c452eabc8]](https://git.sudo.ws/sudo/commit/?id=c452eabc8)

* config.h.in, pathnames.h.in:

  added copyright header
  [[008cfb1be]](https://git.sudo.ws/sudo/commit/?id=008cfb1be)

* check.c, find\_path.c, insults.h, logging.c, parse.c, parse.lex,
  parse.yacc, sudo.c, sudo.h:

  udpated version
  [[6a83afd8e]](https://git.sudo.ws/sudo/commit/?id=6a83afd8e)

* visudo.c:

  udpated to use configure + pathnames.h
  [[6474d6e68]](https://git.sudo.ws/sudo/commit/?id=6474d6e68)

* aclocal.m4:

  updated
  [[f2660677a]](https://git.sudo.ws/sudo/commit/?id=f2660677a)

* Makefile.in, config.h.in, configure.in:

  updated
  [[f654f0657]](https://git.sudo.ws/sudo/commit/?id=f654f0657)

* sudo.h:

  now works with configure
  [[e5bcdc915]](https://git.sudo.ws/sudo/commit/?id=e5bcdc915)

* check.c, find\_path.c, getpass.c, logging.c, parse.c, sudo.c:

  updated to work with configure + pathnames.h
  [[1ed1db9cf]](https://git.sudo.ws/sudo/commit/?id=1ed1db9cf)

* Makefile.in:

  added LEXLIB
  [[51e373397]](https://git.sudo.ws/sudo/commit/?id=51e373397)

1994-03-10 Todd C. Miller

* COPYING:

  updated gnu general licence to versio 2
  [[01d0c73ab]](https://git.sudo.ws/sudo/commit/?id=01d0c73ab)

* config.h.in, pathnames.h.in:

  Initial revision
  [[af9a2fcb3]](https://git.sudo.ws/sudo/commit/?id=af9a2fcb3)

* sudo.h:

  changed to work with configure
  [[3ea5d9311]](https://git.sudo.ws/sudo/commit/?id=3ea5d9311)

1994-03-09 Todd C. Miller

* Makefile.in, aclocal.m4, configure.in:

  Initial revision
  [[e37e623c2]](https://git.sudo.ws/sudo/commit/?id=e37e623c2)

* visudo.c:

  now uses defines used by configure
  [[51b6a4954]](https://git.sudo.ws/sudo/commit/?id=51b6a4954)

1994-03-01 Todd C. Miller

* find\_path.c:

  sudo won’t bitch about EPERM now, for real
  [[e17904708]](https://git.sudo.ws/sudo/commit/?id=e17904708)

1994-02-28 Todd C. Miller

* logging.c:

  renamed exec\_argv to eliminate a libc name clash with ksros
  [[e28f02938]](https://git.sudo.ws/sudo/commit/?id=e28f02938)

* CHANGES:

  corrected
  [[4f004574c]](https://git.sudo.ws/sudo/commit/?id=4f004574c)

* logging.c, sudo.c, sudo.h:

  execve -> execv
  [[eea6d47b7]](https://git.sudo.ws/sudo/commit/?id=eea6d47b7)

* TODO:

  upated
  [[beaf4c0f3]](https://git.sudo.ws/sudo/commit/?id=beaf4c0f3)

* PORTING:

  added 2 mroe items
  [[d206d1afb]](https://git.sudo.ws/sudo/commit/?id=d206d1afb)

* CHANGES:

  updated
  [[562d12b66]](https://git.sudo.ws/sudo/commit/?id=562d12b66)

* sudo.h:

  added UMASK and mode\_t declaration
  [[708d387ce]](https://git.sudo.ws/sudo/commit/?id=708d387ce)

* sudo.c:

  added UMASK
  [[f96b43c29]](https://git.sudo.ws/sudo/commit/?id=f96b43c29)

* logging.c:

  now opens log file with mode 077
  [[75e0a9c4a]](https://git.sudo.ws/sudo/commit/?id=75e0a9c4a)

* check.c:

  saved current umask ans restores it
  [[35bc172d3]](https://git.sudo.ws/sudo/commit/?id=35bc172d3)

* sudo.h:

  added MAXLOGFILELEN
  [[33f8a9573]](https://git.sudo.ws/sudo/commit/?id=33f8a9573)

* logging.c:

  split long log lines. FOr syslog, split into multiple entries, for a log
  file, indent the extra for readability
  [[17fa431e5]](https://git.sudo.ws/sudo/commit/?id=17fa431e5)

1994-02-27 Todd C. Miller

* CHANGES:

  added changes
  [[3563a655e]](https://git.sudo.ws/sudo/commit/?id=3563a655e)

* sudo.h:

  MAXLOGLEN & MAXSYSLOGLEN are now different (as they should be)
  [[aeaf49a05]](https://git.sudo.ws/sudo/commit/?id=aeaf49a05)

1994-02-25 Todd C. Miller

* TODO:

  added input from Brett M Hogden <hogden@…>
  [[dbebfacdc]](https://git.sudo.ws/sudo/commit/?id=dbebfacdc)

1994-02-16 Todd C. Miller

* sudo.c:

  added rmenv() to remove stuff from environ. can now uses execvp() OR
  execve() becuase of this.
  [[f767453fd]](https://git.sudo.ws/sudo/commit/?id=f767453fd)

* logging.c:

  now uses execvp() OR execve()
  [[d2bed77ff]](https://git.sudo.ws/sudo/commit/?id=d2bed77ff)

* sudo.h:

  added USE\_EXECVE
  [[d0621cb55]](https://git.sudo.ws/sudo/commit/?id=d0621cb55)

* sudo.h:

  added environ
  [[8f341c382]](https://git.sudo.ws/sudo/commit/?id=8f341c382)

* find\_path.c:

  now ignore EPERM
  [[5bbf149cb]](https://git.sudo.ws/sudo/commit/?id=5bbf149cb)

* sudo.h:

  moved some func decls out of sudo.h and into sudo.c as statics /.
  [[a2f434a5b]](https://git.sudo.ws/sudo/commit/?id=a2f434a5b)

* CHANGES:

  updated
  [[df71654d9]](https://git.sudo.ws/sudo/commit/?id=df71654d9)

* sudo.h:

  took out Envp
  [[7e7f273f7]](https://git.sudo.ws/sudo/commit/?id=7e7f273f7)

1994-02-14 Todd C. Miller

* BUGS:

  Initial revision
  [[ad0c60041]](https://git.sudo.ws/sudo/commit/?id=ad0c60041)

1994-02-10 Todd C. Miller

* CHANGES:

  added SECURE\_PATH
  [[283f726be]](https://git.sudo.ws/sudo/commit/?id=283f726be)

* sudo.c, sudo.h:

  added SECURE\_PATH
  [[de6ad83ae]](https://git.sudo.ws/sudo/commit/?id=de6ad83ae)

* sudo.h:

  added SECURE\_PATH
  [[80d7989b0]](https://git.sudo.ws/sudo/commit/?id=80d7989b0)

* INSTALL:

  added sample.sudoers note
  [[f2f8b0fe9]](https://git.sudo.ws/sudo/commit/?id=f2f8b0fe9)

* sudoers:

  Initial revision
  [[98b29f37f]](https://git.sudo.ws/sudo/commit/?id=98b29f37f)

1994-02-09 Todd C. Miller

* find\_path.c:

  fixed typo
  [[e3763dbc9]](https://git.sudo.ws/sudo/commit/?id=e3763dbc9)

* PORTING:

  took out SAVED\_UID garbage
  [[c06006ed3]](https://git.sudo.ws/sudo/commit/?id=c06006ed3)

* INSTALL:

  mentioned HAL
  [[abf158a3e]](https://git.sudo.ws/sudo/commit/?id=abf158a3e)

* sudo.h:

  added HAL line
  [[4b82432a5]](https://git.sudo.ws/sudo/commit/?id=4b82432a5)

* insults.h:

  added HAL insults
  [[03d3b4729]](https://git.sudo.ws/sudo/commit/?id=03d3b4729)

* TODO:

  updated
  [[3146d8b65]](https://git.sudo.ws/sudo/commit/?id=3146d8b65)

* logging.c:

  more verbose error if mailer not found
  [[828bb5cec]](https://git.sudo.ws/sudo/commit/?id=828bb5cec)

* check.c:

  now do getpwent as root for soem shadow password systems (bsdi)
  [[2062d2e45]](https://git.sudo.ws/sudo/commit/?id=2062d2e45)

1994-02-08 Todd C. Miller

* sudo.h:

  took out SAVED\_UID garbade
  [[32880e3db]](https://git.sudo.ws/sudo/commit/?id=32880e3db)

* sudo.c:

  took out SAVED\_UID garbage since it don’t work
  [[e52637f9a]](https://git.sudo.ws/sudo/commit/?id=e52637f9a)

1994-02-06 Todd C. Miller

* README:

  updated
  [[6cebcce04]](https://git.sudo.ws/sudo/commit/?id=6cebcce04)

* insults.h:

  added a missing space :-)
  [[4379df16e]](https://git.sudo.ws/sudo/commit/?id=4379df16e)

* sudo.c, sudo.h:

  took out multimax cruft
  [[4928e8b99]](https://git.sudo.ws/sudo/commit/?id=4928e8b99)

* INSTALL:

  minor update
  [[4113d0697]](https://git.sudo.ws/sudo/commit/?id=4113d0697)

* PORTING:

  finished
  [[4b6e7e4a5]](https://git.sudo.ws/sudo/commit/?id=4b6e7e4a5)

* sudo.c:

  fixed a typo + indentation
  [[273de6003]](https://git.sudo.ws/sudo/commit/?id=273de6003)

1994-02-05 Todd C. Miller

* sudo.h:

  took outumoved some defines to the config file ,. ,.
  [[e44792a09]](https://git.sudo.ws/sudo/commit/?id=e44792a09)

* PORTING:

  Initial revision
  [[39e421221]](https://git.sudo.ws/sudo/commit/?id=39e421221)

* TODO:

  did #6
  [[33361a227]](https://git.sudo.ws/sudo/commit/?id=33361a227)

* sudo.h:

  added HAS\_SAVED\_UID
  [[894a7bd0f]](https://git.sudo.ws/sudo/commit/?id=894a7bd0f)

* sudo.c:

  put back AIX cruft
  [[4d7ae0eb2]](https://git.sudo.ws/sudo/commit/?id=4d7ae0eb2)

1994-02-03 Todd C. Miller

* sudo.c:

  aix changes
  [[9195775b9]](https://git.sudo.ws/sudo/commit/?id=9195775b9)

1994-02-02 Todd C. Miller

* CHANGES:

  updated
  [[7de8d09af]](https://git.sudo.ws/sudo/commit/?id=7de8d09af)

* check.c, logging.c, parse.c, sudo.c, sudo.h:

  now is only root when abs necesary
  [[641911504]](https://git.sudo.ws/sudo/commit/?id=641911504)

* check.c:

  added missing %s\n
  [[188c9c743]](https://git.sudo.ws/sudo/commit/?id=188c9c743)

1994-01-31 Todd C. Miller

* install-sh:

  Initial revision
  [[24ab11e96]](https://git.sudo.ws/sudo/commit/?id=24ab11e96)

* TODO:

  updated
  [[6085563fc]](https://git.sudo.ws/sudo/commit/?id=6085563fc)

* CHANGES:

  updated
  [[b949042de]](https://git.sudo.ws/sudo/commit/?id=b949042de)

* sudo.c:

  now removed *RLD*\* for alphas
  [[b4638d455]](https://git.sudo.ws/sudo/commit/?id=b4638d455)

* INSTALL:

  updated for new config scheme
  [[d091a46f4]](https://git.sudo.ws/sudo/commit/?id=d091a46f4)

* find\_path.c:

  more verbose eror messages
  [[7a96a43a5]](https://git.sudo.ws/sudo/commit/?id=7a96a43a5)

1994-01-27 Todd C. Miller

* TODO:

  now have solaris
  [[814b02fb2]](https://git.sudo.ws/sudo/commit/?id=814b02fb2)

* sudo.h:

  define **svr4** for SOLARIS
  [[827968466]](https://git.sudo.ws/sudo/commit/?id=827968466)

* check.c:

  added svr4 junk for shadow pws for solaris 2.x
  [[a58183855]](https://git.sudo.ws/sudo/commit/?id=a58183855)

* check.c, sudo.c:

  took out setuid(0) and setreuid(udi) garbage. Its not needed since we
  start out setuid with the correct perms.
  [[9fe518466]](https://git.sudo.ws/sudo/commit/?id=9fe518466)

* check.c, sudo.c, sudo.h:

  now use setreuid()
  [[5b566c24c]](https://git.sudo.ws/sudo/commit/?id=5b566c24c)

1994-01-26 Todd C. Miller

* sudo.man:

  revised AUTHORS secrtion & added ENV\_EDITOR stuff to VARIABLES sectoin
  [[40b281b90]](https://git.sudo.ws/sudo/commit/?id=40b281b90)

* visudo.c:

  now uses ENV\_EDITOR if you want to use the EDITOR envar
  [[40013231b]](https://git.sudo.ws/sudo/commit/?id=40013231b)

* sudo.h:

  now uses ENV\_EDITOR if you want to use the EDITOR envar >> .
  [[706098107]](https://git.sudo.ws/sudo/commit/?id=706098107)

1993-12-07 Todd C. Miller

* INSTALL:

  rewrote most of this
  [[4efc55f5d]](https://git.sudo.ws/sudo/commit/?id=4efc55f5d)

* README:

  minor update + spell fix
  [[ed2ad1b1c]](https://git.sudo.ws/sudo/commit/?id=ed2ad1b1c)

* sudo.h:

  added all options that are in the Makefile
  [[89db72019]](https://git.sudo.ws/sudo/commit/?id=89db72019)

* getpass.c:

  now use USE\_TERMIO #define for sgi & hpux
  [[e3344ec4c]](https://git.sudo.ws/sudo/commit/?id=e3344ec4c)

* TODO:

  todo: posix sigs
  [[253d2da1c]](https://git.sudo.ws/sudo/commit/?id=253d2da1c)

1993-12-06 Todd C. Miller

* check.c, find\_path.c:

  always include strings.h
  [[0535ec788]](https://git.sudo.ws/sudo/commit/?id=0535ec788)

* visudo.c:

  added STATICEDITOR
  [[5dfa832ea]](https://git.sudo.ws/sudo/commit/?id=5dfa832ea)

* sudo.h:

  sgi has vi in /usr/bin too
  [[b114ace5f]](https://git.sudo.ws/sudo/commit/?id=b114ace5f)

* sudo.man:

  added VISUAL
  [[ab7a9d7f7]](https://git.sudo.ws/sudo/commit/?id=ab7a9d7f7)

1993-12-03 Todd C. Miller

* sudo.h:

  sue /usr/bin/vi on some systems
  [[78a90c446]](https://git.sudo.ws/sudo/commit/?id=78a90c446)

* sudo.c:

  fixed warning (include strings.h)
  [[3424e2f97]](https://git.sudo.ws/sudo/commit/?id=3424e2f97)

* sudo.man:

  added John\_Rouillard@…’s changes (new features)
  [[606f03842]](https://git.sudo.ws/sudo/commit/?id=606f03842)

* CHANGES:

  changes from John\_Rouillard@…
  [[7a05f1558]](https://git.sudo.ws/sudo/commit/?id=7a05f1558)

* visudo.c:

  added EDITOR envar
  [[07f4067d5]](https://git.sudo.ws/sudo/commit/?id=07f4067d5)

* check.c, find\_path.c, parse.c, sudo.c:

  added patches from John\_Rouillard directory spec uses EDITOR
  [[62ea70cb3]](https://git.sudo.ws/sudo/commit/?id=62ea70cb3)

1993-12-02 Todd C. Miller

* getpass.c:

  added flush for hpux
  [[da4e410e9]](https://git.sudo.ws/sudo/commit/?id=da4e410e9)

1993-11-30 Todd C. Miller

* sudo.c:

  no longer assume malloc returns a char \*
  [[70ba02c3c]](https://git.sudo.ws/sudo/commit/?id=70ba02c3c)

* sudo.c:

  alpha change to remove LD\_-like thing fixed SHLIB\_PATH stuff – now gets
  removed correctly
  [[d4eee981f]](https://git.sudo.ws/sudo/commit/?id=d4eee981f)

* sudo.h:

  added STD\_HEADERS macro
  [[f3b1d00d6]](https://git.sudo.ws/sudo/commit/?id=f3b1d00d6)

* sudo.c:

  now uses STD\_HEADERS macor for ansi
  [[68154bdc5]](https://git.sudo.ws/sudo/commit/?id=68154bdc5)

* find\_path.c:

  now uses STD\_HEADERS macro
  [[73c468246]](https://git.sudo.ws/sudo/commit/?id=73c468246)

* check.c:

  niceties for C compiler bitches – no real change
  [[5e14daa52]](https://git.sudo.ws/sudo/commit/?id=5e14daa52)

1993-11-29 Todd C. Miller

* visudo.c:

  now doesn’t fclose a file never opened.
  [[286917fb5]](https://git.sudo.ws/sudo/commit/?id=286917fb5)

1993-11-28 Todd C. Miller

* sudo.man:

  added visudo line
  [[064283569]](https://git.sudo.ws/sudo/commit/?id=064283569)

* sudo.man:

  added error stuff added me in there…
  [[448b927f6]](https://git.sudo.ws/sudo/commit/?id=448b927f6)

* CHANGES:

  noted insults
  [[529f842ee]](https://git.sudo.ws/sudo/commit/?id=529f842ee)

* INSTALL:

  added blurb about reading stuff
  [[83ce5a74d]](https://git.sudo.ws/sudo/commit/?id=83ce5a74d)

* sudo.h:

  added insults
  [[56892786c]](https://git.sudo.ws/sudo/commit/?id=56892786c)

* insults.h:

  corrected somments and removed newlines
  [[c3feddde4]](https://git.sudo.ws/sudo/commit/?id=c3feddde4)

* check.c:

  now uses insults
  [[e52f0a1c3]](https://git.sudo.ws/sudo/commit/?id=e52f0a1c3)

* insults.h:

  Initial revision
  [[993d2e092]](https://git.sudo.ws/sudo/commit/?id=993d2e092)

* INSTALL:

  added dec syslog note
  [[cf4788078]](https://git.sudo.ws/sudo/commit/?id=cf4788078)

* sample.sudoers:

  added real stuff in there
  [[7ec19af90]](https://git.sudo.ws/sudo/commit/?id=7ec19af90)

* TODO:

  added a todo
  [[2b19d60cf]](https://git.sudo.ws/sudo/commit/?id=2b19d60cf)

* TODO:

  added one
  [[d6e95525a]](https://git.sudo.ws/sudo/commit/?id=d6e95525a)

1993-11-27 Todd C. Miller

* sample.sudoers:

  Initial revision
  [[9fc2328aa]](https://git.sudo.ws/sudo/commit/?id=9fc2328aa)

* sudo.man:

  updated with changes
  [[7e33d32a0]](https://git.sudo.ws/sudo/commit/?id=7e33d32a0)

* sudo.man:

  Initial revision
  [[e95e88318]](https://git.sudo.ws/sudo/commit/?id=e95e88318)

* indent.pro:

  Initial revision
  [[2e99de877]](https://git.sudo.ws/sudo/commit/?id=2e99de877)

* CHANGES, COPYING, INSTALL, README, TODO:

  Initial revision
  [[7e5f99455]](https://git.sudo.ws/sudo/commit/?id=7e5f99455)

* visudo.c:

  updated version number and took out jeff’s old addr since it is no good
  [[971d4b609]](https://git.sudo.ws/sudo/commit/?id=971d4b609)

* check.c, find\_path.c, logging.c, parse.c, parse.lex, parse.yacc, sudo.c,
  sudo.h:

  updated version number and took out jeff’s email (since it is invalid)
  [[594284b22]](https://git.sudo.ws/sudo/commit/?id=594284b22)

1993-10-28 Todd C. Miller

* check.c:

  added fflush()
  [[b736fa27f]](https://git.sudo.ws/sudo/commit/?id=b736fa27f)

1993-10-23 Todd C. Miller

* find\_path.c:

  now return NULL instead pfof exiting for nopnn-fatal errors
  [[9ad66eb1a]](https://git.sudo.ws/sudo/commit/?id=9ad66eb1a)

1993-10-21 Todd C. Miller

* check.c:

  new banner
  [[ea9cc34c7]](https://git.sudo.ws/sudo/commit/?id=ea9cc34c7)

* parse.lex:

  now sudo.h gets included first
  [[3840f015d]](https://git.sudo.ws/sudo/commit/?id=3840f015d)

1993-10-18 Todd C. Miller

* parse.lex:

  now can use flex
  [[59d3ab1ec]](https://git.sudo.ws/sudo/commit/?id=59d3ab1ec)

* sudo.h:

  linux patch
  [[8282217cc]](https://git.sudo.ws/sudo/commit/?id=8282217cc)

* sudo.c:

  hpux 9 fix, removes SHLIB\_PATH linux patch
  [[5c4b258d2]](https://git.sudo.ws/sudo/commit/?id=5c4b258d2)

* check.c:

  linux diff
  [[c9af5ccf7]](https://git.sudo.ws/sudo/commit/?id=c9af5ccf7)

1993-10-15 Todd C. Miller

* find\_path.c:

  stat now ignores EINVAL
  [[ca882aafc]](https://git.sudo.ws/sudo/commit/?id=ca882aafc)

1993-10-06 Todd C. Miller

* find\_path.c, sudo.c:

  now declare strdup as extern
  [[11dfd7ef4]](https://git.sudo.ws/sudo/commit/?id=11dfd7ef4)

1993-10-04 Todd C. Miller

* visudo.c:

  reformatted with indent + by hand
  [[f7abfbf81]](https://git.sudo.ws/sudo/commit/?id=f7abfbf81)

* check.c, find\_path.c, getpass.c, logging.c, parse.c, sudo.c, sudo.h:

  used indent to “fix” coding style
  [[e75a6d3b5]](https://git.sudo.ws/sudo/commit/?id=e75a6d3b5)

* find\_path.c:

  now checks ‘.’ or ‘.’ or ’’ in PATH – but does it LAST should maybe
  move the code that does this into the loop body. makes it messier tho.
  hmmm.
  [[847ce91e0]](https://git.sudo.ws/sudo/commit/?id=847ce91e0)

1993-09-08 Todd C. Miller

* find\_path.c:

  redid the fix for non-executable files in an easier to read way plus
  some minor aethetic changes
  [[2ddeba57e]](https://git.sudo.ws/sudo/commit/?id=2ddeba57e)

* find\_path.c:

  fixed bug with non-executable tings of same name in path introduced by
  checkig errno after stat(2).
  [[fde49b4c7]](https://git.sudo.ws/sudo/commit/?id=fde49b4c7)

1993-09-05 Todd C. Miller

* sudo.c:

  fixed off by one error
  [[5ae9d330e]](https://git.sudo.ws/sudo/commit/?id=5ae9d330e)

* find\_path.c:

  now handles decending below ‘/’ correctly
  [[c3636ccc4]](https://git.sudo.ws/sudo/commit/?id=c3636ccc4)

* sudo.c:

  now actually builds Envp instead of munging envp
  [[f00b6795c]](https://git.sudo.ws/sudo/commit/?id=f00b6795c)

1993-09-04 Todd C. Miller

* parse.yacc:

  now includes sys/param.h
  [[1c2d27eea]](https://git.sudo.ws/sudo/commit/?id=1c2d27eea)

* visudo.c:

  now includes sys/param.h
  [[3151ffe1c]](https://git.sudo.ws/sudo/commit/?id=3151ffe1c)

* sudo.h:

  fixed ifndef -> ifdef
  [[4ccc94fc1]](https://git.sudo.ws/sudo/commit/?id=4ccc94fc1)

* qualify.c:

  make more like find\_path.c
  [[3d8cc2e42]](https://git.sudo.ws/sudo/commit/?id=3d8cc2e42)

* find\_path.c:

  rewritten by millert
  [[81d0c1f6d]](https://git.sudo.ws/sudo/commit/?id=81d0c1f6d)

* sudo.h:

  fixed MAXCOMMANDLENGTH now uses USE\_CWD and NEED\_STRDUP added info about
  new defines in the comment
  [[f530705e0]](https://git.sudo.ws/sudo/commit/?id=f530705e0)

* logging.c:

  now uses USE\_CWD
  [[d555cdb52]](https://git.sudo.ws/sudo/commit/?id=d555cdb52)

* sudo.h:

  added delc for clean\_envp() and Envp
  [[35ea44396]](https://git.sudo.ws/sudo/commit/?id=35ea44396)

* sudo.c:

  now rips LD\_\* env vars out of envp and passed sanitized Envp to exec
  [[d7391584e]](https://git.sudo.ws/sudo/commit/?id=d7391584e)

* logging.c:

  now uses execve()
  [[4d48690a2]](https://git.sudo.ws/sudo/commit/?id=4d48690a2)

* find\_path.c:

  ENOTDIR is ok now too (in case part of the path is bogus)
  [[51deb28db]](https://git.sudo.ws/sudo/commit/?id=51deb28db)

* qualify.c:

  now works correctly (ttaltotal rewrite)
  [[223b37b14]](https://git.sudo.ws/sudo/commit/?id=223b37b14)

* parse.lex:

  now includes sys/param.h didn’t match trailing / – fix from rouilj@…
  [[696122957]](https://git.sudo.ws/sudo/commit/?id=696122957)

1993-06-11 Todd C. Miller

* sudo.c:

  moved around the #ifndef \_AIX
  [[3a96124e8]](https://git.sudo.ws/sudo/commit/?id=3a96124e8)

* check.c, logging.c, parse.c:

  Initial revision
  [[958ee39a6]](https://git.sudo.ws/sudo/commit/?id=958ee39a6)

1993-03-20 Todd C. Miller

* qualify.c:

  Initial revision
  [[fd93ea8d4]](https://git.sudo.ws/sudo/commit/?id=fd93ea8d4)

1993-03-13 Todd C. Miller

* find\_path.c:

  now works if you do sudo bin/test
  [[065775e4a]](https://git.sudo.ws/sudo/commit/?id=065775e4a)

* find\_path.c:

  works
  [[ff04cc5e1]](https://git.sudo.ws/sudo/commit/?id=ff04cc5e1)

1993-03-02 Todd C. Miller

* sudo.h:

  Initial revision
  [[799707635]](https://git.sudo.ws/sudo/commit/?id=799707635)

* visudo.c:

  Initial revision
  [[9706aa636]](https://git.sudo.ws/sudo/commit/?id=9706aa636)

* parse.lex, parse.yacc:

  Initial revision
  [[a1fcf10b6]](https://git.sudo.ws/sudo/commit/?id=a1fcf10b6)

1993-02-16 Todd C. Miller

* sudo.c:

  took out errno.h
  [[b7d12de74]](https://git.sudo.ws/sudo/commit/?id=b7d12de74)

* sudo.c:

  now spews error if exec fails and exits with -1
  [[852d93715]](https://git.sudo.ws/sudo/commit/?id=852d93715)

* sudo.c:

  Initial revision
  [[eca93e1da]](https://git.sudo.ws/sudo/commit/?id=eca93e1da)

* find\_path.c:

  now only execs files with (an) executable bit set.
  [[96a16b626]](https://git.sudo.ws/sudo/commit/?id=96a16b626)

* find\_path.c:

  Initial revision
  [[0a8420d1a]](https://git.sudo.ws/sudo/commit/?id=0a8420d1a)

1993-02-15 Todd C. Miller

* getpass.c:

  added nice comment
  [[463350e1c]](https://git.sudo.ws/sudo/commit/?id=463350e1c)

* getpass.c:

  now works on sgi’s
  [[31f6f67f0]](https://git.sudo.ws/sudo/commit/?id=31f6f67f0)

* getpass.c:

  Initial revision
  [[b2abb3f5c]](https://git.sudo.ws/sudo/commit/?id=b2abb3f5c)



=== Content from arxiv.org_835cbe6c_20250115_082315.html ===

[Skip to main content](#content)

[![Cornell University](/static/browse/0.3.4/images/icons/cu/cornell-reduced-white-SMALL.svg)](https://www.cornell.edu/)
We gratefully acknowledge support from the Simons Foundation, [member institutions](https://info.arxiv.org/about/ourmembers.html), and all contributors.
[Donate](https://info.arxiv.org/about/donate.html)

[![arxiv logo](/static/browse/0.3.4/images/arxiv-logo-one-color-white.svg)](/) > [cs](/list/cs/recent) > arXiv:2309.02545

[Help](https://info.arxiv.org/help) | [Advanced Search](https://arxiv.org/search/advanced)

All fields
Title
Author
Abstract
Comments
Journal reference
ACM classification
MSC classification
Report number
arXiv identifier
DOI
ORCID
arXiv author ID
Help pages
Full text

Search

[![arXiv logo](/static/browse/0.3.4/images/arxiv-logomark-small-white.svg)](https://arxiv.org/)
[![Cornell University Logo](/static/browse/0.3.4/images/icons/cu/cornell-reduced-white-SMALL.svg)](https://www.cornell.edu/)
open search

GO

open navigation menu
## quick links

* [Login](https://arxiv.org/login)
* [Help Pages](https://info.arxiv.org/help)
* [About](https://info.arxiv.org/about)

# Computer Science > Cryptography and Security

**arXiv:2309.02545** (cs)

[Submitted on 5 Sep 2023 ([v1](https://arxiv.org/abs/2309.02545v1)), last revised 12 Apr 2024 (this version, v2)]
# Title:Mayhem: Targeted Corruption of Register and Stack Variables

Authors:[Andrew J. Adiletta](https://arxiv.org/search/cs?searchtype=author&query=Adiletta,+A+J), [M. Caner Tol](https://arxiv.org/search/cs?searchtype=author&query=Tol,+M+C), [Yarkın Doröz](https://arxiv.org/search/cs?searchtype=author&query=Dor%C3%B6z,+Y), [Berk Sunar](https://arxiv.org/search/cs?searchtype=author&query=Sunar,+B) View a PDF of the paper titled Mayhem: Targeted Corruption of Register and Stack Variables, by Andrew J. Adiletta and 3 other authors
[View PDF](/pdf/2309.02545)
[HTML (experimental)](https://arxiv.org/html/2309.02545v2)
> Abstract:In the past decade, many vulnerabilities were discovered in microarchitectures which yielded attack vectors and motivated the study of countermeasures. Further, architectural and physical imperfections in DRAMs led to the discovery of Rowhammer attacks which give an adversary power to introduce bit flips in a victim's memory space. Numerous studies analyzed Rowhammer and proposed techniques to prevent it altogether or to mitigate its effects.
>
> In this work, we push the boundary and show how Rowhammer can be further exploited to inject faults into stack variables and even register values in a victim's process. We achieve this by targeting the register value that is stored in the process's stack, which subsequently is flushed out into the memory, where it becomes vulnerable to Rowhammer. When the faulty value is restored into the register, it will end up used in subsequent iterations. The register value can be stored in the stack via latent function calls in the source or by actively triggering signal handlers. We demonstrate the power of the findings by applying the techniques to bypass SUDO and SSH authentication. We further outline how MySQL and other cryptographic libraries can be targeted with the new attack vector. There are a number of challenges this work overcomes with extensive experimentation before coming together to yield an end-to-end attack on an OpenSSL digital signature: achieving co-location with stack and register variables, with synchronization provided via a blocking window. We show that stack and registers are no longer safe from the Rowhammer attack.

| Comments: | ACM ASIACCS 2024 |
| --- | --- |
| Subjects: | Cryptography and Security (cs.CR) |
| Cite as: | [arXiv:2309.02545](https://arxiv.org/abs/2309.02545) [cs.CR] |
|  | (or  [arXiv:2309.02545v2](https://arxiv.org/abs/2309.02545v2) [cs.CR] for this version) |
|  | <https://doi.org/10.48550/arXiv.2309.02545>  Focus to learn more    arXiv-issued DOI via DataCite |

## Submission history

From: M. Caner Tol [[view email](/show-email/f8f20797/2309.02545)]

Full-text links:
## Access Paper:

View a PDF of the paper titled Mayhem: Targeted Corruption of Register and Stack Variables, by Andrew J. Adiletta and 3 other authors* [View PDF](/pdf/2309.02545)
* [HTML (experimental)](https://arxiv.org/html/2309.02545v2)
* [TeX Source](/src/2309.02545)
* [Other Formats](/format/2309.02545)

[![license icon](https://arxiv.org/icons/licenses/by-4.0.png)
view license](http://creativecommons.org/licenses/by/4.0/ "Rights to this article")

Current browse context: cs.CR
[< prev](/prevnext?id=2309.02545&function=prev&context=cs.CR "previous in cs.CR (accesskey p)")

  |
[next >](/prevnext?id=2309.02545&function=next&context=cs.CR "next in cs.CR (accesskey n)")

[new](/list/cs.CR/new)
 |
[recent](/list/cs.CR/recent)
 | [2023-09](/list/cs.CR/2023-09)
Change to browse by:
[cs](/abs/2309.02545?context=cs)

### References & Citations

* [NASA ADS](https://ui.adsabs.harvard.edu/abs/arXiv%3A2309.02545)
* [Google Scholar](https://scholar.google.com/scholar_lookup?arxiv_id=2309.02545)
* [Semantic Scholar](https://api.semanticscholar.org/arXiv%3A2309.02545)

[a](/static/browse/0.3.4/css/cite.css)
export BibTeX citation
Loading...

## BibTeX formatted citation

×

loading...

Data provided by:

### Bookmark

[![BibSonomy logo](/static/browse/0.3.4/images/icons/social/bibsonomy.png)](http://www.bibsonomy.org/BibtexHandler?requTask=upload&url=https://arxiv.org/abs/2309.02545&description=Mayhem: Targeted Corruption of Register and Stack Variables "Bookmark on BibSonomy")
[![Reddit logo](/static/browse/0.3.4/images/icons/social/reddit.png)](https://reddit.com/submit?url=https://arxiv.org/abs/2309.02545&title=Mayhem: Targeted Corruption of Register and Stack Variables "Bookmark on Reddit")

Bibliographic Tools
# Bibliographic and Citation Tools

Bibliographic Explorer Toggle

Bibliographic Explorer *([What is the Explorer?](https://info.arxiv.org/labs/showcase.html#arxiv-bibliographic-explorer))*

Connected Papers Toggle

Connected Papers *([What is Connected Papers?](https://www.connectedpapers.com/about))*

Litmaps Toggle

Litmaps *([What is Litmaps?](https://www.litmaps.co/))*

scite.ai Toggle

scite Smart Citations *([What are Smart Citations?](https://www.scite.ai/))*

Code, Data, Media
# Code, Data and Media Associated with this Article

alphaXiv Toggle

alphaXiv *([What is alphaXiv?](https://alphaxiv.org/))*

Links to Code Toggle

CatalyzeX Code Finder for Papers *([What is CatalyzeX?](https://www.catalyzex.com))*

DagsHub Toggle

DagsHub *([What is DagsHub?](https://dagshub.com/))*

GotitPub Toggle

Gotit.pub *([What is GotitPub?](http://gotit.pub/faq))*

Huggingface Toggle

Hugging Face *([What is Huggingface?](https://huggingface.co/huggingface))*

Links to Code Toggle

Papers with Code *([What is Papers with Code?](https://paperswithcode.com/))*

ScienceCast Toggle

ScienceCast *([What is ScienceCast?](https://sciencecast.org/welcome))*

Demos
# Demos

Replicate Toggle

Replicate *([What is Replicate?](https://replicate.com/docs/arxiv/about))*

Spaces Toggle

Hugging Face Spaces *([What is Spaces?](https://huggingface.co/docs/hub/spaces))*

Spaces Toggle

TXYZ.AI *([What is TXYZ.AI?](https://txyz.ai))*

Related Papers
# Recommenders and Search Tools

Link to Influence Flower

Influence Flower *([What are Influence Flowers?](https://influencemap.cmlab.dev/))*

Core recommender toggle

CORE Recommender *([What is CORE?](https://core.ac.uk/services/recommender))*

* Author
* Venue
* Institution
* Topic

About arXivLabs

# arXivLabs: experimental projects with community collaborators

arXivLabs is a framework that allows collaborators to develop and share new arXiv features directly on our website.

Both individuals and organizations that work with arXivLabs have embraced and accepted our values of openness, community, excellence, and user data privacy. arXiv is committed to these values and only works with partners that adhere to them.

Have an idea for a project that will add value for arXiv's community? [**Learn more about arXivLabs**](https://info.arxiv.org/labs/index.html).

[Which authors of this paper are endorsers?](/auth/show-endorsers/2309.02545) |
Disable MathJax ([What is MathJax?](https://info.arxiv.org/help/mathjax.html))

* [About](https://info.arxiv.org/about)
* [Help](https://info.arxiv.org/help)

* contact arXivClick here to contact arXiv
   [Contact](https://info.arxiv.org/help/contact.html)
* subscribe to arXiv mailingsClick here to subscribe
   [Subscribe](https://info.arxiv.org/help/subscribe)

* [Copyright](https://info.arxiv.org/help/license/index.html)
* [Privacy Policy](https://info.arxiv.org/help/policies/privacy_policy.html)

* [Web Accessibility Assistance](https://info.arxiv.org/help/web_accessibility.html)
* [arXiv Operational Status](https://status.arxiv.org)

  Get status notifications via
  [email](https://subscribe.sorryapp.com/24846f03/email/new)
  or [slack](https://subscribe.sorryapp.com/24846f03/slack/new)



=== Content from security.netapp.com_4ec7319a_20250115_213256.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Resources](https://security.netapp.com/resources)

## Security Resources

With the ever prevalent threats that span todayâs landscape, NetApp continues
to derive and provide security solutions across the portfolio. Links to
security resources are found below. As always, stay tuned because just like the
threat landscape, these resources are ever changing and being updated!

#### Products and Solutions

The product and solutions resources provide guidance, recommendations, and best
practices with regard to security elements and configurations amongst the
NetApp portfolio.

##### ONTAP

[ONTAP 9 Security Datasheet](http://www.netapp.com/us/media/ds-3846.pdf) - The
ONTAP 9 Security Datasheet provides a comprehensive list of security features
and functions available in ONTAP 9 - So if the question is, âwhat are all the
security features/functions in ONTAP 9?â, This is your resource!

[Security Hardening Guide for NetApp ONTAP
9](https://www.netapp.com/us/media/tr-4569.pdf) - We humbly refer to the
Security Hardening Guide for NetApp ONTAP 9 as your key resource when it comes
to answering the question, âhow do I deploy ONTAP 9 in the most secure
fashion?â. The hardening guide provides the recommended commands and configs
necessary to enable ONTAP 9 in the most secure configuration.

[ONTAP 9 Encryption Power
Guide](https://docs.netapp.com/us-en/ontap/pdfs/sidebar/Security_and_data_encryption.pdf)

* When it comes to understanding the configuration and management details of NSE and NVE,
  including deployment, certificates, onboard key management and more, the Power
  Guide is the key resource!

[ONTAP 9 Network Management
Guide](https://docs.netapp.com/us-en/ontap/pdfs/sidebar/Network_management.pdf) - While
this guide provides vast elements surrounding ONTAP networking (IPv4, v6,
IPSpaces, and more), it also captures some key security elements such as
managing SVMs, protocol restrictions and firewall configuration in addition to
control plane elements such as DNS, SNMP, FIPS configuration, and MTU details.
The Network Management Guide also shows list of ports used in ONTAP, also
listed in the hardening guide.

[ONTAP 9 Manage administrator authentication and RBAC with the
CLI](https://docs.netapp.com/us-en/ontap/authentication/)

* You can enable login accounts for ONTAP cluster administrators and storage virtual machine (SVM) administrators.
  You can also use role-based access control (RBAC) to define the capabilities of administrators.

[NFS Kerberos in ONTAP](https://www.netapp.com/pdf.html?item=/media/19384-tr-4616.pdf)

* How to configure NFS Kerberos support in ONTAP for Active Directory and Red Hat Enterprise Linux (RHEL) clients.

[How to configure LDAP in ONTAP Multiprotocol NAS identity
management](https://www.netapp.com/pdf.html?item=/media/19423-tr-4835.pdf)

* Lightweight Directory Access Protocol (LDAP) configuration as a method for UNIX identity
  management and name mapping for multiprotocol NAS access in ONTAP.

[DS-3898: NetApp Storage Encryption and NetApp Volume
Encryption](http://www.netapp.com/us/media/ds-3898.pdf) - When it comes to
encryption at rest there are many questions about the capabilities. The NSE and
NVE Datasheet seeks to quell such questions by providing a comprehensive
understanding of what NSE is, what NVE is, use cases, and how they can be
leveraged individually or together for a true dual/double encryption solution.

[NetApp Storage Encryption
Datasheet](http://www.netapp.com/us/media/ds-3213-en.pdf) - The NSE Datasheet
provides a holistic overview of the NSE solution and use cases. If you have
ever wondered what NSE is, what we mean by self encrypting drives, or what
encryption algorithm is in use, this is the resource for you!

[NetApp Volume Encryption
Datasheet](http://www.netapp.com/us/media/ds-3899.pdf) - The NVE Datasheet
provides a holistic overview of the NVE solution and use cases. If you have
ever wondered what NVE is, or what encryption algorithm it uses, this is the
resource for you!

[ONTAP 9.x STIG](https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=network-other)

* Ver 1, Rel 1 of the NetApp ONTAP DSC 9.x STIG has been posted to the Security
  Technical Implementation Guides (STIGs) Document Library.

#### Threats

Threat resources consist of guidance to address known threats through a
combination of prevention, mitigation, and remediation.

##### Ransomware

[The NetApp Solution for
Ransomware](http://www.netapp.com/us/media/tr-4572.pdf) - Ransomware wages war
on every environment. Being the custodians of one of the worldâs most valuable
resources (data/information), itâs imperative that we protect it. When it comes
to ransomware, this is your guide to addressing and remediating the threat.

[NetApp and Varonis ransomware white
paper](https://info.varonis.com/hubfs/docs/whitepapers/en/Varonis-Ransomware-Whitepaper-Netapp.pdf) -
As a companion to the NetApp Solution for Ransomware, we have partnered with
Varonis in addressing the advanced techniques around this threat. We have
discussed and captured the solution in this joint white paper.

#### Integration and Solutions Guides

As we continue to tout the key elements of security including key management,
we understand the challenges and value of timeliness as it applies to adoption
and deployment. Due to such challenges we provide integration guides where we
walk through the configuration/provisioning of âkeyâ elements such as key
managers, FPolicy, and other security laden integration solutions.

##### Key Management

[NetApp ONTAP 9 External Key Management: Vormetric Key Management Integration
Guide](http://www.netapp.com/us/media/tr-4618.pdf) - The Vormetric integration
guide for ONTAP 9 depicts how to provision the Vormetric (Thales) key manager
for use with ONTAP 9.

##### FPolicy

[Cloud Insights with Cloud Secure](https://cloud.netapp.com/ci-sde-plp-cloud-secure-info-trial?hsCtaTracking=fefadff4-c195-4b6a-95e3-265d8ce7c0cd%7Cb696fdde-c026-4007-a39e-5e986c4d27c6)

[FPolicy Solution Guide for Clustered Data ONTAP: Varonis DatAdvantage](http://www.netapp.com/us/media/tr-4429.pdf)

[FPolicy Solution Guide for Clustered Data ONTAP: Veritas Data Insight](http://www.netapp.com/us/media/tr-4473.pdf)

##### Anti-Virus

[Antivirus Solution Guide for McAfee](https://www.netapp.com/us/media/tr-4286.pdf)

[Antivirus Solution Guide for Symantec](https://www.netapp.com/us/media/tr-4304.pdf)

[Antivirus Solution Guide for Trend Micro](https://www.netapp.com/us/media/tr-4312.pdf)

#### Compliance

Compliance continues to evolve and shape the manner in which we address the
organizationâs of today and more importantly how we address securing the data.
Remember Security does not equal Compliance, but security does in fact aid in
addressing the challenge.

##### PCI DSS

[ONTAP PCI DSS](http://www.netapp.com/us/media/tr-4401.pdf)

#### Security Partners

[Varonis](https://www.varonis.com/)

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from security.netapp.com_3cf4a1eb_20250115_213248.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)

## NetApp Product Security

NetApp is an industry leader in developing and implementing product security standards. Learn how our security polices, certifications, and guidelines can help you maintain the confidentiality, integrity, and availability of your data.

![Advisories](/images/icons-product-security-146x146.png)
### [Advisories](https://security.netapp.com/advisory/)

Review vulnerability announcements and remediation instructions published by the Product Security Incident Response Team.

![Bulletins](/images/icon-find-training-146x146.png)
### [Bulletins](https://security.netapp.com/bulletins/)

Review information regarding non-NetApp vulnerabilities and their potential impact on NetApp Products.

![Contact](/images/icon-contact-146x146.png)
### [Contact](https://security.netapp.com/contact/)

Learn the best ways to reach out to NetApp in various security scenarios.

![Policy](/images/icon-policy-146x146.png)
### [Policy](https://security.netapp.com/policy/)

Find out about NetApp's approach to product security processes and policy.

![Resources](/images/icon-global-learning-partners-146x146.png)
### [Resources](https://security.netapp.com/resources/)

Explore guidance, recommendations, and best practices for securely operating NetApp systems.

![Certifications](/images/icon-get-certified-146x146.png)
### [Certifications](https://security.netapp.com/certs/)

Visit the [Trust Center](https://www.netapp.com/company/trust-center/compliance/) for details about NetAppâs industry-leading compliance achievements

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from lists.fedoraproject.org_2f3b3f22_20250115_082320.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/U6XMRUJCPII4MPWG43HTYR76DGLEYEFZ/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/U6XMRUJCPII4MPWG43HTYR76DGLEYEFZ/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/U6XMRUJCPII4MPWG43HTYR76DGLEYEFZ/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/U6XMRUJCPII4MPWG43HTYR76DGLEYEFZ/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-U6XMRUJCPII4MPWG43HTYR76DGLEYEFZ.mbox.gz?message=U6XMRUJCPII4MPWG43HTYR76DGLEYEFZ "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/U6XMRUJCPII4MPWG43HTYR76DGLEYEFZ/#U6XMRUJCPII4MPWG43HTYR76DGLEYEFZ)

# [SECURITY] Fedora 39 Update: sudo-1.9.15-1.p5.fc39

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

28 Jan
2024

28 Jan
'24

3:13 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-cdccda4f62
2024-01-28 03:07:02.755047
--------------------------------------------------------------------------------

Name : sudo
Product : Fedora 39
Version : 1.9.15
Release : 1.p5.fc39
URL : <https://www.sudo.ws>
Summary : Allows restricted root access for specified users
Description :
Sudo (superuser do) allows a system administrator to give certain
users (or groups of users) the ability to run some (or all) commands
as root while logging all commands and arguments. Sudo operates on a
per-command basis. It is not a replacement for the shell. Features
include: the ability to restrict what commands a user may run on a
per-host basis, copious logging of each command (providing a clear
audit trail of who did what), a configurable timeout of the sudo
command, and the ability to use the same configuration file (sudoers)
on many different machines.

--------------------------------------------------------------------------------
Update Information:

Rabase to 1.9.15p5
--------------------------------------------------------------------------------
ChangeLog:

\* Wed Jan 24 2024 Radovan Sroka rsroka@redhat.com - 1.9.15-1
- Rabase to 1.9.15p5
- sudo-1\_9\_15p5 is available Resolves: rhbz#2248505
- TRIAGE CVE-2023-42465 sudo: Targeted Corruption of Register and Stack
Variables Resolves: rhbz#2255569
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2248505 - sudo-1\_9\_15p5 is available
<https://bugzilla.redhat.com/show_bug.cgi?id=2248505>
[ 2 ] Bug #2255569 - TRIAGE CVE-2023-42465 sudo: Targeted Corruption of Register and Stack Variables [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2255569>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-cdccda4f62' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/U6XMRUJCPII4MPWG43HTYR76DGLEYEFZ/#U6XMRUJCPII4MPWG43HTYR76DGLEYEFZ)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.


