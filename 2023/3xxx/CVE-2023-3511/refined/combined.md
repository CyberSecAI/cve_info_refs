=== Content from gitlab.com_38252028_20250114_193100.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Auditor users can create merge requests on projects they don't have access to

⚠ **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2046752](https://hackerone.com/reports/2046752)** by `js_noob` on 2023-07-02, assigned to [@greg](/greg "Greg Myers"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Hello team, according to [docs](https://docs.gitlab.com/ee/administration/auditor_users.html#auditor-user-permissions-and-restrictions), an auditor has read-access to projects he doesn't have access to.

> Have read-only access to projects you aren’t a member of.

However, an auditor can still create merge requests in projects he cannot access, using changes/branches originating from forks.

##### Steps to reproduce

**As an admin:**

1. Spin up your own GitLab instance, and apply the ultimate trial to it (<https://about.gitlab.com/free-trial/?hosted=self-managed>)
2. Create a private dummy project
3. Create a new user in your instance (or you can easily signup from another browser)

**As the other user:**

4. Verify that you can't access the project created in Step 2

**As the admin:**

5. Promote that user to `Auditor` <https://YOUR_DOMAIN/admin/users/USER_USERNAME/edit>

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/ba7d3166511741c5b4debedf3ce336e45689657b/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f39353333633462392d393435652d343630352d396466332d6433313361303039313261612f696d6167652e706e67)

**As the auditor (previously the "other user"):**

6. Verify that you can "read" that project (created in step 2)
7. Navigate to the merge requests page and verify that can't create MRs, now let's workaround that
8. Fork that project into your namespace, create a new branch and add any changes to it
9. Create a new MR with the base as your project with the new branch and target the original project with the `main` branch

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/5820f36cb0914ce7c1cd99711e60c2a8419e79cd/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61386132346664322d326632622d346634652d623563612d3036623433386166303237352f696d6167652e706e67)

**As the admin:**

10. Verify that a new MR is created

##### Examples/POC

[bandicam\_2023-07-02\_10-52-20-985.mp4](https://user-content.gitlab-static.net/a00ab6bb76b6976b7057d2ef08ba047b0af8769d/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64313563613630622d373039392d343364642d626665322d6665616561393961323737332f62616e646963616d5f323032332d30372d30325f31302d35322d32302d3938352e6d7034 "Download 'bandicam_2023-07-02_10-52-20-985.mp4'")

##### What is the current *bug* behavior?

An auditor can create MRs, originating from forks, on projects he doesn't have access to.

##### What is the expected *correct* behavior?

Auditor MRs, originating from forks, on projects he doesn't have access to should be blocked just like any other MRs.

###### Results of GitLab environment info

```
System information
System:         Debian 11
Proxy:          no
Current User:   git
Using RVM:      no
Ruby Version:   3.0.6p216
Gem Version:    3.4.13
Bundler Version:2.4.14
Rake Version:   13.0.6
Redis Version:  6.2.11
Sidekiq Version:6.5.7
Go Version:     unknown

GitLab information
Version:        16.1.1-ee
Revision:       d3582d7719f
Directory:      /opt/gitlab/embedded/service/gitlab-rails
DB Adapter:     PostgreSQL
DB Version:     13.11
URL:            https://gitlab-private.net
HTTP Clone URL: https://gitlab-private.net/some-group/some-project.git
SSH Clone URL:  git@gitlab-private.net:some-group/some-project.git
Elasticsearch:  no
Geo:            no
Using LDAP:     no
Using Omniauth: yes
Omniauth Providers:

GitLab Shell
Version:        14.23.0
Repository storages:
- default:      unix:/var/opt/gitlab/gitaly/gitaly.socket
GitLab Shell path:              /opt/gitlab/embedded/service/gitlab-shell
```

#### Impact

User with read-only access (auditor) can create merge requests on projects he doesn't have access to.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [bandicam\_2023-07-02\_10-52-20-985.mp4](https://h1.sec.gitlab.net/a/d15ca60b-7099-43dd-bfe2-feaea99a2773/bandicam_2023-07-02_10-52-20-985.mp4)
* [image.png](https://h1.sec.gitlab.net/a/9533c4b9-945e-4605-9df3-d313a00912aa/image.png)
* [image.png](https://h1.sec.gitlab.net/a/a8a24fd2-2f2b-4f4e-b5ca-06b438af0275/image.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


