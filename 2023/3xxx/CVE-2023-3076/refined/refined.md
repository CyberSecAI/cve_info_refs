- **Root cause of vulnerability**: The MStore API plugin does not properly restrict access to its wholesale REST API endpoint, allowing unauthenticated users to create new user accounts with a role of their choice. This is exploitable if the site owner has paid for the plugin's pro features (simulated by setting `mstore_purchase_code` option to true).
- **Weaknesses/vulnerabilities present**: Unauthenticated privilege escalation. The plugin lacks proper authorization checks on the `/wp-json/api/flutter_wholesale/register` endpoint.
- **Impact of exploitation**: An attacker can create an administrator account on the WordPress site, gaining full control over the website.
- **Attack vectors**: A remote unauthenticated attacker can send a POST request to the `/wp-json/api/flutter_wholesale/register` endpoint with a chosen username, email, password, and the role set to "administrator".
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the vulnerable WordPress site. The vulnerability is only exploitable if the `mstore_purchase_code` option is enabled.