=== Content from git.kernel.org_a3184073_20250115_090935.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=4bedf9eee016286c835e3d8fa981ddece5338795)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=4bedf9eee016286c835e3d8fa981ddece5338795)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=4bedf9eee016286c835e3d8fa981ddece5338795)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=4bedf9eee016286c835e3d8fa981ddece5338795)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pablo Neira Ayuso <pablo@netfilter.org> | 2023-06-16 14:45:22 +0200 |
| --- | --- | --- |
| committer | Pablo Neira Ayuso <pablo@netfilter.org> | 2023-06-20 22:41:51 +0200 |
| commit | [4bedf9eee016286c835e3d8fa981ddece5338795](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=4bedf9eee016286c835e3d8fa981ddece5338795) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=4bedf9eee016286c835e3d8fa981ddece5338795)) | |
| tree | [704f7ea556a51526dda5ab172071b1e3d3f3c027](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=4bedf9eee016286c835e3d8fa981ddece5338795) | |
| parent | [d7fce52fdf96663ddc2eb21afecff3775588612a](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d7fce52fdf96663ddc2eb21afecff3775588612a) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=4bedf9eee016286c835e3d8fa981ddece5338795&id2=d7fce52fdf96663ddc2eb21afecff3775588612a)) | |
| download | [linux-4bedf9eee016286c835e3d8fa981ddece5338795.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-4bedf9eee016286c835e3d8fa981ddece5338795.tar.gz) | |

netfilter: nf\_tables: fix chain binding transaction logicAdd bound flag to rule and chain transactions as in 6a0a8d10a366
("netfilter: nf\_tables: use-after-free in failing rule with bound set")
to skip them in case that the chain is already bound from the abort
path.
This patch fixes an imbalance in the chain use refcnt that triggers a
WARN\_ON on the table and chain destroy path.
This patch also disallows nested chain bindings, which is not
supported from userspace.
The logic to deal with chain binding in nft\_data\_hold() and
nft\_data\_release() is not correct. The NFT\_TRANS\_PREPARE state needs a
special handling in case a chain is bound but next expressions in the
same rule fail to initialize as described by 1240eb93f061 ("netfilter:
nf\_tables: incorrect error path handling with NFT\_MSG\_NEWRULE").
The chain is left bound if rule construction fails, so the objects
stored in this chain (and the chain itself) are released by the
transaction records from the abort path, follow up patch ("netfilter:
nf\_tables: add NFT\_TRANS\_PREPARE\_ERROR to deal with bound set/chain")
completes this error handling.
When deleting an existing rule, chain bound flag is set off so the
rule expression .destroy path releases the objects.
Fixes: d0e2c7de92c7 ("netfilter: nf\_tables: add NFT\_CHAIN\_BINDING")
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=4bedf9eee016286c835e3d8fa981ddece5338795)

| -rw-r--r-- | [include/net/netfilter/nf\_tables.h](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/include/net/netfilter/nf_tables.h?id=4bedf9eee016286c835e3d8fa981ddece5338795) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [net/netfilter/nf\_tables\_api.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/net/netfilter/nf_tables_api.c?id=4bedf9eee016286c835e3d8fa981ddece5338795) | 86 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [net/netfilter/nft\_immediate.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/net/netfilter/nft_immediate.c?id=4bedf9eee016286c835e3d8fa981ddece5338795) | 87 | |  |  |  | | --- | --- | --- | |

3 files changed, 153 insertions, 41 deletions

| diff --git a/include/net/netfilter/nf\_tables.h b/include/net/netfilter/nf\_tables.hindex 83db182decc871..8ba7f81e81a69b 100644--- a/[include/net/netfilter/nf\_tables.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/net/netfilter/nf_tables.h?id=d7fce52fdf96663ddc2eb21afecff3775588612a)+++ b/[include/net/netfilter/nf\_tables.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/net/netfilter/nf_tables.h?id=4bedf9eee016286c835e3d8fa981ddece5338795)@@ -1009,7 +1009,10 @@ static inline struct nft\_userdata \*nft\_userdata(const struct nft\_rule \*rule) return (void \*)&rule->data[rule->dlen]; } -void nf\_tables\_rule\_release(const struct nft\_ctx \*ctx, struct nft\_rule \*rule);+void nft\_rule\_expr\_activate(const struct nft\_ctx \*ctx, struct nft\_rule \*rule);+void nft\_rule\_expr\_deactivate(const struct nft\_ctx \*ctx, struct nft\_rule \*rule,+ enum nft\_trans\_phase phase);+void nf\_tables\_rule\_destroy(const struct nft\_ctx \*ctx, struct nft\_rule \*rule);  static inline void nft\_set\_elem\_update\_expr(const struct nft\_set\_ext \*ext, struct nft\_regs \*regs,@@ -1104,6 +1107,7 @@ int nft\_setelem\_validate(const struct nft\_ctx \*ctx, struct nft\_set \*set, const struct nft\_set\_iter \*iter, struct nft\_set\_elem \*elem); int nft\_set\_catchall\_validate(const struct nft\_ctx \*ctx, struct nft\_set \*set);+int nf\_tables\_bind\_chain(const struct nft\_ctx \*ctx, struct nft\_chain \*chain);  enum nft\_chain\_types { NFT\_CHAIN\_T\_DEFAULT = 0,@@ -1140,11 +1144,17 @@ int nft\_chain\_validate\_dependency(const struct nft\_chain \*chain, int nft\_chain\_validate\_hooks(const struct nft\_chain \*chain, unsigned int hook\_flags); +static inline bool nft\_chain\_binding(const struct nft\_chain \*chain)+{+ return chain->flags & NFT\_CHAIN\_BINDING;+}+ static inline bool nft\_chain\_is\_bound(struct nft\_chain \*chain) { return (chain->flags & NFT\_CHAIN\_BINDING) && chain->bound; } +int nft\_chain\_add(struct nft\_table \*table, struct nft\_chain \*chain); void nft\_chain\_del(struct nft\_chain \*chain); void nf\_tables\_chain\_destroy(struct nft\_ctx \*ctx); @@ -1575,6 +1585,7 @@ struct nft\_trans\_rule { struct nft\_rule \*rule; struct nft\_flow\_rule \*flow; u32 rule\_id;+ bool bound; };  #define nft\_trans\_rule(trans) \@@ -1583,6 +1594,8 @@ struct nft\_trans\_rule { (((struct nft\_trans\_rule \*)trans->data)->flow) #define nft\_trans\_rule\_id(trans) \ (((struct nft\_trans\_rule \*)trans->data)->rule\_id)+#define nft\_trans\_rule\_bound(trans) \+ (((struct nft\_trans\_rule \*)trans->data)->bound)  struct nft\_trans\_set { struct nft\_set \*set;@@ -1607,15 +1620,19 @@ struct nft\_trans\_set { (((struct nft\_trans\_set \*)trans->data)->gc\_int)  struct nft\_trans\_chain {+ struct nft\_chain \*chain; bool update; char \*name; struct nft\_stats \_\_percpu \*stats; u8 policy;+ bool bound; u32 chain\_id; struct nft\_base\_chain \*basechain; struct list\_head hook\_list; }; +#define nft\_trans\_chain(trans) \+ (((struct nft\_trans\_chain \*)trans->data)->chain) #define nft\_trans\_chain\_update(trans) \ (((struct nft\_trans\_chain \*)trans->data)->update) #define nft\_trans\_chain\_name(trans) \@@ -1624,6 +1641,8 @@ struct nft\_trans\_chain { (((struct nft\_trans\_chain \*)trans->data)->stats) #define nft\_trans\_chain\_policy(trans) \ (((struct nft\_trans\_chain \*)trans->data)->policy)+#define nft\_trans\_chain\_bound(trans) \+ (((struct nft\_trans\_chain \*)trans->data)->bound) #define nft\_trans\_chain\_id(trans) \ (((struct nft\_trans\_chain \*)trans->data)->chain\_id) #define nft\_trans\_basechain(trans) \diff --git a/net/netfilter/nf\_tables\_api.c b/net/netfilter/nf\_tables\_api.cindex 69bceefaa5c80e..5e4965b985281b 100644--- a/[net/netfilter/nf\_tables\_api.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/netfilter/nf_tables_api.c?id=d7fce52fdf96663ddc2eb21afecff3775588612a)+++ b/[net/netfilter/nf\_tables\_api.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/netfilter/nf_tables_api.c?id=4bedf9eee016286c835e3d8fa981ddece5338795)@@ -193,6 +193,48 @@ static void nft\_set\_trans\_bind(const struct nft\_ctx \*ctx, struct nft\_set \*set) } } +static void nft\_chain\_trans\_bind(const struct nft\_ctx \*ctx, struct nft\_chain \*chain)+{+ struct nftables\_pernet \*nft\_net;+ struct net \*net = ctx->net;+ struct nft\_trans \*trans;++ if (!nft\_chain\_binding(chain))+ return;++ nft\_net = nft\_pernet(net);+ list\_for\_each\_entry\_reverse(trans, &nft\_net->commit\_list, list) {+ switch (trans->msg\_type) {+ case NFT\_MSG\_NEWCHAIN:+ if (nft\_trans\_chain(trans) == chain)+ nft\_trans\_chain\_bound(trans) = true;+ break;+ case NFT\_MSG\_NEWRULE:+ if (trans->ctx.chain == chain)+ nft\_trans\_rule\_bound(trans) = true;+ break;+ }+ }+}++int nf\_tables\_bind\_chain(const struct nft\_ctx \*ctx, struct nft\_chain \*chain)+{+ if (!nft\_chain\_binding(chain))+ return 0;++ if (nft\_chain\_binding(ctx->chain))+ return -EOPNOTSUPP;++ if (chain->bound)+ return -EBUSY;++ chain->bound = true;+ chain->use++;+ nft\_chain\_trans\_bind(ctx, chain);++ return 0;+}+ static int nft\_netdev\_register\_hooks(struct net \*net, struct list\_head \*hook\_list) {@@ -338,8 +380,9 @@ static struct nft\_trans \*nft\_trans\_chain\_add(struct nft\_ctx \*ctx, int msg\_type) ntohl(nla\_get\_be32(ctx->nla[NFTA\_CHAIN\_ID])); } }-+ nft\_trans\_chain(trans) = ctx->chain; nft\_trans\_commit\_list\_add\_tail(ctx->net, trans);+ return trans; } @@ -357,8 +400,7 @@ static int nft\_delchain(struct nft\_ctx \*ctx) return 0; } -static void nft\_rule\_expr\_activate(const struct nft\_ctx \*ctx,- struct nft\_rule \*rule)+void nft\_rule\_expr\_activate(const struct nft\_ctx \*ctx, struct nft\_rule \*rule) { struct nft\_expr \*expr; @@ -371,9 +413,8 @@ static void nft\_rule\_expr\_activate(const struct nft\_ctx \*ctx, } } -static void nft\_rule\_expr\_deactivate(const struct nft\_ctx \*ctx,- struct nft\_rule \*rule,- enum nft\_trans\_phase phase)+void nft\_rule\_expr\_deactivate(const struct nft\_ctx \*ctx, struct nft\_rule \*rule,+ enum nft\_trans\_phase phase) { struct nft\_expr \*expr; @@ -2226,7 +2267,7 @@ static int nft\_basechain\_init(struct nft\_base\_chain \*basechain, u8 family, return 0; } -static int nft\_chain\_add(struct nft\_table \*table, struct nft\_chain \*chain)+int nft\_chain\_add(struct nft\_table \*table, struct nft\_chain \*chain) { int err; @@ -3490,8 +3531,7 @@ err\_fill\_rule\_info: return err; } -static void nf\_tables\_rule\_destroy(const struct nft\_ctx \*ctx,- struct nft\_rule \*rule)+void nf\_tables\_rule\_destroy(const struct nft\_ctx \*ctx, struct nft\_rule \*rule) { struct nft\_expr \*expr, \*next; @@ -3508,7 +3548,7 @@ static void nf\_tables\_rule\_destroy(const struct nft\_ctx \*ctx, kfree(rule); } -void nf\_tables\_rule\_release(const struct nft\_ctx \*ctx, struct nft\_rule \*rule)+static void nf\_tables\_rule\_release(const struct nft\_ctx \*ctx, struct nft\_rule \*rule) { nft\_rule\_expr\_deactivate(ctx, rule, NFT\_TRANS\_RELEASE); nf\_tables\_rule\_destroy(ctx, rule);@@ -6638,7 +6678,6 @@ static int nf\_tables\_newsetelem(struct sk\_buff \*skb, void nft\_data\_hold(const struct nft\_data \*data, enum nft\_data\_types type) { struct nft\_chain \*chain;- struct nft\_rule \*rule;  if (type == NFT\_DATA\_VERDICT) { switch (data->verdict.code) {@@ -6646,15 +6685,6 @@ void nft\_data\_hold(const struct nft\_data \*data, enum nft\_data\_types type) case NFT\_GOTO: chain = data->verdict.chain; chain->use++;-- if (!nft\_chain\_is\_bound(chain))- break;-- chain->table->use++;- list\_for\_each\_entry(rule, &chain->rules, list)- chain->use++;-- nft\_chain\_add(chain->table, chain); break; } }@@ -9677,7 +9707,7 @@ static int \_\_nf\_tables\_abort(struct net \*net, enum nfnl\_abort\_action action) kfree(nft\_trans\_chain\_name(trans)); nft\_trans\_destroy(trans); } else {- if (nft\_chain\_is\_bound(trans->ctx.chain)) {+ if (nft\_trans\_chain\_bound(trans)) { nft\_trans\_destroy(trans); break; }@@ -9700,6 +9730,10 @@ static int \_\_nf\_tables\_abort(struct net \*net, enum nfnl\_abort\_action action) nft\_trans\_destroy(trans); break; case NFT\_MSG\_NEWRULE:+ if (nft\_trans\_rule\_bound(trans)) {+ nft\_trans\_destroy(trans);+ break;+ } trans->ctx.chain->use--; list\_del\_rcu(&nft\_trans\_rule(trans)->list); nft\_rule\_expr\_deactivate(&trans->ctx,@@ -10263,22 +10297,12 @@ static int nft\_verdict\_init(const struct nft\_ctx \*ctx, struct nft\_data \*data, static void nft\_verdict\_uninit(const struct nft\_data \*data) { struct nft\_chain \*chain;- struct nft\_rule \*rule;  switch (data->verdict.code) { case NFT\_JUMP: case NFT\_GOTO: chain = data->verdict.chain; chain->use--;-- if (!nft\_chain\_is\_bound(chain))- break;-- chain->table->use--;- list\_for\_each\_entry(rule, &chain->rules, list)- chain->use--;-- nft\_chain\_del(chain); break; } }diff --git a/net/netfilter/nft\_immediate.c b/net/netfilter/nft\_immediate.cindex c9d2f7c29f5304..0492a04064f11f 100644--- a/[net/netfilter/nft\_immediate.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/netfilter/nft_immediate.c?id=d7fce52fdf96663ddc2eb21afecff3775588612a)+++ b/[net/netfilter/nft\_immediate.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/netfilter/nft_immediate.c?id=4bedf9eee016286c835e3d8fa981ddece5338795)@@ -76,11 +76,9 @@ static int nft\_immediate\_init(const struct nft\_ctx \*ctx, switch (priv->data.verdict.code) { case NFT\_JUMP: case NFT\_GOTO:- if (nft\_chain\_is\_bound(chain)) {- err = -EBUSY;- goto err1;- }- chain->bound = true;+ err = nf\_tables\_bind\_chain(ctx, chain);+ if (err < 0)+ return err; break; default: break;@@ -98,6 +96,31 @@ static void nft\_immediate\_activate(const struct nft\_ctx \*ctx, const struct nft\_expr \*expr) { const struct nft\_immediate\_expr \*priv = nft\_expr\_priv(expr);+ const struct nft\_data \*data = &priv->data;+ struct nft\_ctx chain\_ctx;+ struct nft\_chain \*chain;+ struct nft\_rule \*rule;++ if (priv->dreg == NFT\_REG\_VERDICT) {+ switch (data->verdict.code) {+ case NFT\_JUMP:+ case NFT\_GOTO:+ chain = data->verdict.chain;+ if (!nft\_chain\_binding(chain))+ break;++ chain\_ctx = \*ctx;+ chain\_ctx.chain = chain;++ list\_for\_each\_entry(rule, &chain->rules, list)+ nft\_rule\_expr\_activate(&chain\_ctx, rule);++ nft\_clear(ctx->net, chain);+ break;+ default:+ break;+ }+ }  return nft\_data\_hold(&priv->data, nft\_dreg\_to\_type(priv->dreg)); }@@ -107,6 +130,40 @@ static void nft\_immediate\_deactivate(const struct nft\_ctx \*ctx, enum nft\_trans\_phase phase) { const struct nft\_immediate\_expr \*priv = nft\_expr\_priv(expr);+ const struct nft\_data \*data = &priv->data;+ struct nft\_ctx chain\_ctx;+ struct nft\_chain \*chain;+ struct nft\_rule \*rule;++ if (priv->dreg == NFT\_REG\_VERDICT) {+ switch (data->verdict.code) {+ case NFT\_JUMP:+ case NFT\_GOTO:+ chain = data->verdict.chain;+ if (!nft\_chain\_binding(chain))+ break;++ chain\_ctx = \*ctx;+ chain\_ctx.chain = chain;++ list\_for\_each\_entry(rule, &chain->rules, list)+ nft\_rule\_expr\_deactivate(&chain\_ctx, rule, phase);++ switch (phase) {+ case NFT\_TRANS\_PREPARE:+ nft\_deactivate\_next(ctx->net, chain);+ break;+ default:+ nft\_chain\_del(chain);+ chain->bound = false;+ chain->table->use--;+ break;+ }+ break;+ default:+ break;+ }+ }  if (phase == NFT\_TRANS\_COMMIT) return;@@ -131,15 +188,27 @@ static void nft\_immediate\_destroy(const struct nft\_ctx \*ctx, case NFT\_GOTO: chain = data->verdict.chain; - if (!nft\_chain\_is\_bound(chain))+ if (!nft\_chain\_binding(chain))+ break;++ /\* Rule construction failed, but chain is already bound:+ \* let the transaction records release this chain and its rules.+ \*/+ if (chain->bound) {+ chain->use--; break;+ } + /\* Rule has been deleted, release chain and its rules. \*/ chain\_ctx = \*ctx; chain\_ctx.chain = chain; - list\_for\_each\_entry\_safe(rule, n, &chain->rules, list)- nf\_tables\_rule\_release(&chain\_ctx, rule);-+ chain->use--;+ list\_for\_each\_entry\_safe(rule, n, &chain->rules, list) {+ chain->use--;+ list\_del(&rule->list);+ nf\_tables\_rule\_destroy(&chain\_ctx, rule);+ } nf\_tables\_chain\_destroy(&chain\_ctx); break; default: |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 09:08:12 +0000



=== Content from lists.debian.org_cf8e0c86_20250115_090937.html ===


---

[[Date Prev](msg00000.html)][[Date Next](msg00002.html)]
[[Thread Prev](msg00000.html)][[Thread Next](msg00002.html)]
[[Date Index](maillist.html#00001)]
[[Thread Index](threads.html#00001)]

# [SECURITY] [DLA 3512-1] linux-5.10 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3512-1] linux-5.10 security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Wed, 2 Aug 2023 17:00:39 +0200
* *Message-id*: <[[🔎]](/msgid-search/ZMpvl8jCguXR3iTV%40decadent.org.uk) [ZMpvl8jCguXR3iTV@decadent.org.uk](msg00001.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3512-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
August 2, 2023                                <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux-5.10
Version        : 5.10.179-3~deb10u1
CVE ID         : CVE-2023-2156 CVE-2023-3390 CVE-2023-3610 CVE-2023-20593
                 CVE-2023-31248 CVE-2023-35001

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2023-2156

    It was discovered that a flaw in the handling of the RPL protocol
    may allow an unauthenticated remote attacker to cause a denial of
    service if RPL is enabled (not by default in Debian).

CVE-2023-3390

    A use-after-free flaw in the netfilter subsystem caused by
    incorrect error path handling may result in denial of service or
    privilege escalation.

CVE-2023-3610

    A use-after-free flaw in the netfilter subsystem caused by
    incorrect refcount handling on the table and chain destroy path
    may result in denial of service or privilege escalation.

CVE-2023-20593

    Tavis Ormandy discovered that under specific microarchitectural
    circumstances, a vector register in AMD "Zen 2" CPUs may not be
    written to 0 correctly.  This flaw allows an attacker to leak
    sensitive information across concurrent processes, hyper threads
    and virtualized guests.

    For details please refer to
    <<https://lock.cmpxchg8b.com/zenbleed.html>> and
    <<https://github.com/google/security-research/security/advisories/GHSA-v6wh-rxpg-cmm8>>.

    This issue can also be mitigated by a microcode update through the
    amd64-microcode package or a system firmware (BIOS/UEFI) update.
    However, the initial microcode release by AMD only provides
    updates for second generation EPYC CPUs.  Various Ryzen CPUs are
    also affected, but no updates are available yet.

CVE-2023-31248

    Mingi Cho discovered a use-after-free flaw in the Netfilter
    nf_tables implementation when using nft_chain_lookup_byid, which
    may result in local privilege escalation for a user with the
    CAP_NET_ADMIN capability in any user or network namespace.

CVE-2023-35001

    Tanguy DUBROCA discovered an out-of-bounds reads and write flaw in
    the Netfilter nf_tables implementation when processing an
    nft_byteorder expression, which may result in local privilege
    escalation for a user with the CAP_NET_ADMIN capability in any
    user or network namespace.

For Debian 10 buster, these problems have been fixed in version
5.10.179-3~deb10u1.

We recommend that you upgrade your linux-5.10 packages.

For the detailed security status of linux-5.10 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux-5.10>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpulcuphbOYp.pgp)**

*Description:* PGP signature

---



=== Content from www.debian.org_a1f801a9_20250115_090939.html ===


---

[[Date Prev](msg00152.html)][[Date Next](msg00154.html)]
[[Thread Prev](msg00152.html)][[Thread Next](msg00154.html)]
[[Date Index](maillist.html#00153)]
[[Thread Index](threads.html#00153)]

# [SECURITY] [DSA 5461-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5461-1] linux security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Sun, 30 Jul 2023 07:30:11 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1qQ0sV-00EA4R-Pj%40seger.debian.org) [E1qQ0sV-00EA4R-Pj@seger.debian.org](msg00153.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5461-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
July 30, 2023                         <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2023-3390 CVE-2023-3610 CVE-2023-20593

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2023-3390

    A use-after-free flaw in the netfilter subsystem caused by incorrect
    error path handling may result in denial of service or privilege
    escalation.

CVE-2023-3610

    A use-after-free flaw in the netfilter subsystem caused by incorrect
    refcount handling on the table and chain destroy path may result in
    denial of service or privilege escalation.

CVE-2023-20593

    Tavis Ormandy discovered that under specific microarchitectural
    circumstances, a vector register in AMD "Zen 2" CPUs may not be
    written to 0 correctly.  This flaw allows an attacker to leak
    sensitive information across concurrent processes, hyper threads
    and virtualized guests.

    For details please refer to
    <<https://lock.cmpxchg8b.com/zenbleed.html>> and
    <<https://github.com/google/security-research/security/advisories/GHSA-v6wh-rxpg-cmm8>>.

    This issue can also be mitigated by a microcode update through the
    amd64-microcode package or a system firmware (BIOS/UEFI) update.
    However, the initial microcode release by AMD only provides
    updates for second generation EPYC CPUs.  Various Ryzen CPUs are
    also affected, but no updates are available yet.

For the oldstable distribution (bullseye), these problems have been fixed
in version 5.10.179-3.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmTGCxhfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0Q2Lw//W7eGT2uTxzgwGK1ivLNtzu4VnZfX3luCzLc2Gy49YhSTPfepMsR+EZWU
zMfxMwXp7HcgUUAj6VnKPSYt0lmauDVy9POUl20nOzM8hFScemhFJ+DVSeeJrfhR
RPUroaJNLpJS1QjYJisi2tjKnoc8IhCkw/X88I4S4dAzekmRTLeEdeAIP0jyRYDi
Pd+nW8vR2bcMG4jAaA/lBu17FgysEpHMleMzr9Ocw7k6eqlcIo12w36Ml51MmXZW
Lxr7XKrAM6p9TuL+BY0i4FvW0f7hvbpMdhIaAzUf+7LQj9Tn5rGNaHB+NhLO6HB1
spOXfZLVCM10LDCDIUR3lz0hUNI/10bKtoarbvoygevVzuvGWLTmI5P/uei9Bv1m
jqd+FOtkZuYsuQzvzIrVISGL2ltpD3055mBaOJWIBrDl+mrR88m+LAMA5iJiCuvh
M6rfJgraQFHeMFJi1ojDgNyyRaasxOKXRcWAYOvgZ1XKLfJ10OkieYq5CO1c7iKW
4NkwBklDP8wEHoZHMEY3KnLnGcNO93wBBGcQVIBlMXu0IKlf/BT0Rcj0ynz5g5N1
MgvGAJio+yTr4QWRz/GQRtF3Lf5r4Ezib/Y2Qv9PUbVWzmmiUyQsATjcp9d+sLSB
hJhR9+9d4DefRAPGFOSCA6d01qL8HygsvKyyGB4C1DdbSlT3APc=
=3UcB
-----END PGP SIGNATURE-----

```

---



=== Content from security.netapp.com_3ce4bb27_20250115_090938.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [July 2023 Linux Kernel 6.3 Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20230818-0005)

## July 2023 Linux Kernel 6.3 Vulnerabilities in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20230818-0005 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20230818-0005 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20230818-0005 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20230818-0005 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20230818-0005
**Version:**
8.0

**Last updated:**
10/22/2024

**Status:**
Interim.

**CVEs:** CVE-2023-3609, CVE-2023-3610

Overview
#### Summary

Multiple NetApp products incorporate Linux kernel. Linux kernel versions prior to 6.4 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2023-3609](https://nvd.nist.gov/vuln/detail/CVE-2023-3609) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2023-3610](https://nvd.nist.gov/vuln/detail/CVE-2023-3610) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

Affected Products
#### Affected Products

* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C

#### Products Under Investigation

* NetApp HCI Compute Node (Bootstrap OS)

#### Products Not Affected

* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S** | NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2876227.html) for more information. |
| **NetApp HCI Baseboard Management Controller (BMC) - H410C** | NetApp HCI Baseboard Management Controller (BMC) - H410C has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2876227.html) for more information. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20230818-0005>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20230818 | Initial Public Release |
| 2.0 | 20230821 | FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400 moved to Products Not Affected |
| 3.0 | 20230828 | SnapCenter Plug-in for VMware vSphere and Active IQ Unified Manager for VMware vSphere moved to Products Not Affected |
| 4.0 | 20231101 | Brocade SAN Navigator (SANnav) moved to Products Not Affected and NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S moved to Won't Fix status |
| 5.0 | 20231107 | NetApp HCI Baseboard Management Controller (BMC) - H410C moved to Won't Fix status |
| 6.0 | 20231122 | NetApp HCI Baseboard Management Controller (BMC) - H610S, NetApp HCI Baseboard Management Controller (BMC) - H610C, and NetApp HCI Baseboard Management Controller (BMC) - H615C moved to Products Not Affected |
| 7.0 | 20231208 | NetApp SolidFire & HCI Storage Node (Element Software) and NetApp SolidFire & HCI Management Node moved to Products Not Affected |
| 8.0 | 20241022 | AFF Baseboard Management Controller (BMC) - A700s moved to Products Not Affected |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)


