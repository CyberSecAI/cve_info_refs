- **Root cause of vulnerability**: The `download.php` script in the King-Avis Prestashop module uses a file path extracted from the `file` parameter without sanitization, leading to a path traversal vulnerability.
- **Weaknesses/vulnerabilities present**:
    - Path traversal: The application uses an unsanitized file path from user input allowing access to files outside of the intended directory.
    - Lack of input sanitization: The `file` parameter from the GET request is not sanitized before being used in `fopen` and `readfile` functions.
- **Impact of exploitation**:
    - Local file read: Attackers can read arbitrary local files on the server.
    - Sensitive information disclosure: Attackers can potentially gain access to configuration files, source code, or other sensitive data.
- **Attack vectors**:
    - HTTP GET requests to `download.php` with a crafted `file` parameter containing path traversal sequences.
- **Required attacker capabilities/position**:
    - Authentication: An attacker needs to know the correct token, which is intended to be known by administrators.
    - Network access: The attacker needs to be able to make HTTP requests to the server.