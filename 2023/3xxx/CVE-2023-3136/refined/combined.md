=== Content from www.wordfence.com_f35cd2a5_20250114_211954.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# MailArchiver <= 2.10.1 - Unauthenticated Stored Cross-Site Scripting via Email Subject

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel) Â Â >Â Â   [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities) Â Â >Â Â  MailArchiver <= 2.10.1 - Unauthenticated Stored Cross-Site Scripting via Email Subject

7.2

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2023-3136](https://www.cve.org/CVERecord?id=CVE-2023-3136) |
| --- | --- |
| CVSS | 7.2 (High) |
| Publicly Published | July 12, 2023 |
| Last Updated | January 22, 2024 |
| Researcher | [Alex Thomas - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/alex-thomas) |

### Description

The MailArchiver plugin for WordPress is vulnerable to Stored Cross-Site Scripting via an email subject in versions up to, and including, 2.10.1 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/2937545/mailarchiver)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fmailarchiver%2Fmailarchiver-2101-unauthenticated-stored-cross-site-scripting-via-email-subject&t=MailArchiver%20%3C%3D%202.10.1%20-%20Unauthenticated%20Stored%20Cross-Site%20Scripting%20via%20Email%20Subject "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fmailarchiver%2Fmailarchiver-2101-unauthenticated-stored-cross-site-scripting-via-email-subject&text=MailArchiver%20%3C%3D%202.10.1%20-%20Unauthenticated%20Stored%20Cross-Site%20Scripting%20via%20Email%20Subject "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fmailarchiver%2Fmailarchiver-2101-unauthenticated-stored-cross-site-scripting-via-email-subject "LinkedIn")
Email

## Vulnerability Details for MailArchiver

#### [MailArchiver](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/mailarchiver)

| Software Type | Plugin |
| --- | --- |
| Software Slug | mailarchiver [(view on wordpress.org)](https://wordpress.org/plugins/mailarchiver) |
| Patched? | Yes |
| Remediation | Update to version 2.11.0, or a newer patched version |
| Affected Version | * <= 2.10.1 |
| Patched Version | * 2.11.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVEÂ®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from www.wordfence.com_935f2393_20250115_190108.html ===


![WordfenceÂ®](/img/hero-wordfence-text.png)

# The global leader in WordPress security.

[Learn more >](/products/pricing/)

## Discover which plan is right for you.

Join over 5 million secure WordPress site owners using Wordfence Free. Block
attacks with the basic tools you need to keep your site safe. The Free version has a 30-day delay on firewall rules and malware signatures.

[Learn More](/products/wordfence-free/)

Real-time updates to firewall rules and malware signatures as new threats emerge, continuously updated Premium IP Blocklist blocks over 40,000 known threat actors, Country Blocking, access to the security Audit Log, Premium Support, and more.

[Learn More](/products/wordfence-premium/)

Wordfence Care includes the benefits of Premium with unlimited hands-on
incident response and hands-on support. For business owners who value their time: If you have an
incident, our world-class analysts take care of it.

[Learn More](/products/wordfence-care/)

For Mission Critical websites, Wordfence Response provides incident response 24
hours a day, 7 days a week and 365 days a year with a 1-hour response time and 24 hours time to
resolution. If down-time has a financial impact, choose Wordfence Response.

[Learn More](/products/wordfence-response/)

[Compare plans >](/products/pricing/)

## Wordfence is the global leader in WordPress security.

The average WordPress site is attacked once every
**34** minutes.
**43** requests hit that site every day
probing for weak and breached passwords, vulnerable plugins and themes, and other points of entry.
Websites protected by Wordfence are shielded from those attacks with an average of
**215M** hits being blocked across
our network every day.

[Secure your site today >](/products/pricing/)

64K
malicious IPs blocklisted in the past 30 days

6.5B
attacks blocked in the past 30 days

555
web application firewall rules

5,239
malware signatures in our real-time malware signature set

## Manage all of your sites in one place with Wordfence Central [Learn more >](/products/wordfence-central/)

**Save Time And Streamline Your Security With Wordfence Central.** Wordfence Central is **free for all Wordfence users**, including our Wordfence Free customers, without any catch or upsell. Get an **instantaneous view** of the security posture of all your WordPress websites, configure Wordfence across a few or **thousands of sites** using templates, **launch scans**, manage licenses, and **view security events** all from a Central Dashboard. Paid Wordfence sites additionally include access to the security Audit Log to track events for each site. Wordfence Central is a must-have for agency owners or anyone else who manages security for multiple websites.

![Wordfence Central Preview](/img/wordfence-central-preview.png)

Introducing

[![WordfenceÂ® CLI](/img/hero-wordfence-cli-logo.png)](/products/wordfence-cli/)

[Learn more >](/products/wordfence-cli/)

A high performance security scanner for a second line of detection

*Secure your system at the server level with our malware and vulnerability scanner*

[![WordfenceÂ® Intelligence](/img/hero-wordfence-intelligence-logo.png)](/threat-intel/)

[Learn more >](/threat-intel/)

WordPress vulnerability information at your fingertips

*Access the same Threat Intelligence Data used to power our popular Wordfence security plugin*

## Breaking news from our blog

[View all >](/blog)

[![](https://www.wordfence.com/wp-content/uploads/2025/01/WFI-Vuln-Report-WeekofsDec16.png)](https://www.wordfence.com/blog/2025/01/wordfence-intelligence-weekly-wordpress-vulnerability-report-december-16-2024-to-january-5-2025/)
### [Wordfence Intelligence Weekly WordPress Vulnerability Report (December 16, 2024 to January 5, 2025)](https://www.wordfence.com/blog/2025/01/wordfence-intelligence-weekly-wordpress-vulnerability-report-december-16-2024-to-january-5-2025/)

ðŸ“¢ Did you know Wordfence runs a Bug Bounty Program for all WordPress plugin and themes at no cost to vendors?

[![](https://www.wordfence.com/wp-content/uploads/2024/12/WFI-Vuln-Report-WeekofsDec9.png)](https://www.wordfence.com/blog/2024/12/wordfence-intelligence-weekly-wordpress-vulnerability-report-december-9-2024-to-december-15-2024/)
### [Wordfence Intelligence Weekly WordPress Vulnerability Report (December 9, 2024 to December 15, 2024)](https://www.wordfence.com/blog/2024/12/wordfence-intelligence-weekly-wordpress-vulnerability-report-december-9-2024-to-december-15-2024/)

ðŸ’¥ Time to wrap up this year and kick-off the new year with a bang!

[![](https://www.wordfence.com/wp-content/uploads/2024/12/WFI-Vuln-Report-WeekofsDec2.png)](https://www.wordfence.com/blog/2024/12/wordfence-intelligence-weekly-wordpress-vulnerability-report-december-2-2024-to-december-8-2024/)
### [Wordfence Intelligence Weekly WordPress Vulnerability Report (December 2, 2024 to December 8, 2024)](https://www.wordfence.com/blog/2024/12/wordfence-intelligence-weekly-wordpress-vulnerability-report-december-2-2024-to-december-8-2024/)

ðŸ’¥ Time to wrap up this year and kick-off the new year with a bang!

[![](https://www.wordfence.com/wp-content/uploads/2024/12/FeaturedImage_Wordfence_161.02.png)](https://www.wordfence.com/blog/2024/12/6000000-wordpress-sites-protected-against-payment-refund-and-subscription-cancellation-vulnerability-in-wpforms-wordpress-plugin/)
### [6,000,000 WordPress Sites Protected Against Payment Refund and Subscription Cancellation Vulnerability in WPForms WordPress Plugin](https://www.wordfence.com/blog/2024/12/6000000-wordpress-sites-protected-against-payment-refund-and-subscription-cancellation-vulnerability-in-wpforms-wordpress-plugin/)

On October 23th, 2024, we received a submission for a Missing Authorization to Payment Refund and Subscription Cancellation vulnerability in WPForms, a WordPress plugin with more than 6,000,000 active installations.

[![](https://www.wordfence.com/wp-content/uploads/2024/12/WFI-Vuln-Report-WeekofsNov25.png)](https://www.wordfence.com/blog/2024/12/wordfence-intelligence-weekly-wordpress-vulnerability-report-november-25-2024-to-december-1-2024/)
### [Wordfence Intelligence Weekly WordPress Vulnerability Report (November 25, 2024 to December 1, 2024)](https://www.wordfence.com/blog/2024/12/wordfence-intelligence-weekly-wordpress-vulnerability-report-november-25-2024-to-december-1-2024/)

ðŸ’¥ Time to wrap up this year and kick-off the new year with a bang!

[![](https://www.wordfence.com/wp-content/uploads/2024/11/WFI-Vuln-Report-WeekofsNov18.png)](https://www.wordfence.com/blog/2024/11/wordfence-intelligence-weekly-wordpress-vulnerability-report-november-18-2024-to-november-24-2024/)
### [Wordfence Intelligence Weekly WordPress Vulnerability Report (November 18, 2024 to November 24, 2024)](https://www.wordfence.com/blog/2024/11/wordfence-intelligence-weekly-wordpress-vulnerability-report-november-18-2024-to-november-24-2024/)

ðŸ¦¸ ðŸ’¥ Calling all superheroes and hunters! Introducing the End of Year Holiday ExtravaganzaÂ and the WordPress Superhero Challenge for the Wordfence Bug Bounty Program!

[![](https://www.wordfence.com/wp-content/uploads/2024/11/FeaturedImage_Wordfence_160.03.02.png)](https://www.wordfence.com/blog/2024/11/200000-wordpress-sites-affected-by-unauthenticated-critical-vulnerabilities-in-anti-spam-by-cleantalk-wordpress-plugin/)
### [200,000 WordPress Sites Affected by Unauthenticated Critical Vulnerabilities in Anti-Spam by CleanTalk WordPress Plugin](https://www.wordfence.com/blog/2024/11/200000-wordpress-sites-affected-by-unauthenticated-critical-vulnerabilities-in-anti-spam-by-cleantalk-wordpress-plugin/)

200,000 WordPress Sites Affected by Unauthenticated Critical Vulnerabilities in Anti-Spam by CleanTalk WordPress Plugin

[![](https://www.wordfence.com/wp-content/uploads/2024/11/WFI-Vuln-Report-WeekofsNov11.png)](https://www.wordfence.com/blog/2024/11/wordfence-intelligence-weekly-wordpress-vulnerability-report-november-11-2024-to-november-17-2024/)
### [Wordfence Intelligence Weekly WordPress Vulnerability Report (November 11, 2024 to November 17, 2024)](https://www.wordfence.com/blog/2024/11/wordfence-intelligence-weekly-wordpress-vulnerability-report-november-11-2024-to-november-17-2024/)

ðŸ¦¸ ðŸ’¥ Calling all superheroes and hunters! Introducing the End of Year Holiday ExtravaganzaÂ and the WordPress Superhero Challenge for the Wordfence Bug Bounty Program!

## Join the official Wordfence mailing list

Receive WordPress security alerts, news, and research in your inbox before it appears in the press.

## Wordfence in the press

[View all >](/news/)

[![Search Engine Journal](https://www.wordfence.com/wp-content/uploads/2020/04/SEJ-logo.png)](https://www.searchenginejournal.com/wordpress-contact-form-vulnerabilities/526057/)
### [Vulnerabilities In Two WordPress Contact Form Plugins Affect +1.1 Million](https://www.searchenginejournal.com/wordpress-contact-form-vulnerabilities/526057/)

[![WP Tavern](https://www.wordfence.com/wp-content/uploads/2021/03/wp_tavern-media.png)](https://wptavern.com/remote-code-execution-vulnerability-patched-in-wpml-wordpress-plugin)
### [Remote Code Execution Vulnerability Patched in WPML WordPress Plugin](https://wptavern.com/remote-code-execution-vulnerability-patched-in-wpml-wordpress-plugin)

[![WP Tavern](https://www.wordfence.com/wp-content/uploads/2021/03/wp_tavern-media.png)](https://wptavern.com/wordfence-launches-wordpress-superhero-challenge-with-big-rewards)
### [Wordfence Launches WordPress Superhero Challenge with Big Rewards](https://wptavern.com/wordfence-launches-wordpress-superhero-challenge-with-big-rewards)

[![TechRadar](https://www.wordfence.com/wp-content/uploads/2020/11/techradar.png)](https://www.techradar.com/pro/security/thousands-of-wordpress-sites-potentially-at-risk-from-plugin-security-flaw)
### [Thousands Of WordPress Sites Potentially At Risk From Plugin Security Flaw](https://www.techradar.com/pro/security/thousands-of-wordpress-sites-potentially-at-risk-from-plugin-security-flaw)

[![SecurityWeek Logo](https://www.wordfence.com/wp-content/uploads/2022/02/securityweek_logo.png)](https://www.securityweek.com/critical-flaw-in-donation-plugin-exposed-100000-wordpress-sites-to-takeover/)
### [Critical Flaw in Donation Plugin Exposed 100,000 WordPress Sites to Takeover](https://www.securityweek.com/critical-flaw-in-donation-plugin-exposed-100000-wordpress-sites-to-takeover/)

[![](https://www.wordfence.com/wp-content/uploads/2023/08/THN.png)](https://thehackernews.com/2024/08/givewp-wordpress-plugin-vulnerability.html)
### [GiveWP WordPress Plugin Vulnerability Puts 100,000+ Websites at Risk](https://thehackernews.com/2024/08/givewp-wordpress-plugin-vulnerability.html)

[![WP Tavern](https://www.wordfence.com/wp-content/uploads/2021/03/wp_tavern-media.png)](https://wptavern.com/critical-vulnerability-patched-in-givewp-plugin)
### [Critical Vulnerability Patched in GiveWP Plugin](https://wptavern.com/critical-vulnerability-patched-in-givewp-plugin)

[![WP Tavern](https://www.wordfence.com/wp-content/uploads/2021/03/wp_tavern-media.png)](https://wptavern.com/wordfence-cli-2-0-1-update-adds-free-vulnerability-scanning)
### [Wordfence CLI 2.0.1 Update Adds Free Vulnerability Scanning](https://wptavern.com/wordfence-cli-2-0-1-update-adds-free-vulnerability-scanning)

## Why choose Wordfence?

370M
total downloads

5M
sites with Wordfence

24/7
support, all year round

3,985
5-star reviews

[Get started today >](/products/pricing/)

- ### Fantastic Support â€“ The Best Solution for a Hacked Website

  If you know the horror of having your website hacked, you know the mountain of stress that comes with it. Even worse is trying to find a solution to fix your hacked website for a reasonable price without being overly sold to. This is where WordFence comes in to save the day.

  They very quickly and thoroughly fixed my hacked website, keeping me updated with the status at all times. I also received a long report detailing what was hacked, how it was fixed, and instructions to secure my website from future hacks. In a matter of days, my site was unblacklisted by Google and Iâ€™m back in business!

  While I canâ€™t yet speak to how well WordFence secures your website from hacks, I can say that they have been the best solution for fixing my hacked website. Based on that experience, I have no problem entrusting them with securing my website going forward.

  THANK YOU WORDFENCE! It was worth every penny.

  suzippy

  @suzippy
- ### Awesome Plugin and Premium Support

  Wordfence Premium has provided excellent customer service. The plugin is easy to use, and the premium support is friendly and informative. Very happy with their service.

  docmolly

  @docmolly
- ### Best Money I Spend!

  Wordfence is by far the best and most important plug-in I have installed on every site I maintain. The free version is good, but the premium version is worth every penny and more. In fact, I refuse to create or maintain a site without it.

  daisy2love

  daisy2love
- ### Excellent support and the best security plugin

  We have been using Wordfence (free version) for years on all our 100+ WordPress websites. We havenâ€™t had any hacked websites since then. Just recently we purchased the premium license to increase the security of our websites even more. We had some questions regarding a multi WP install on the same domain in various subfolders and received timely and professional support within a day. Everything is setup properly now and we sleep quietly at night knowing that itâ€™s all secured.

  ByteMotion

  @bytemotion
- ### Wordfence site-cleaning team saved my client big time

  Iâ€™ve have the Wordfence plugin (free version) on dozens of my personal and client sites for a few years. Easy to install and configure, itâ€™s blocked many attacks and Iâ€™ve never had a site hacked that had it. On one client site, we didnâ€™t use it, they got hacked and it was nasty, they sell tickets to their events and their payment system stopped taking payments (and gave some customers virus/malware).

  Not just one site, but the clientâ€™s entire hosting account was infected. I contacted Wordfence for a site cleaning and they got on it right away. In two days, the site was cleaned and taking payments again. Wordfence running on the sites after the cleaning reported a malware backdoor in my wptwin site-cloning script. I sent the report and the wptwin.php script to the security analyst who cleaned the site and within a few hours, he replied that indeed this was a false positive. That was great service and set me at ease that the clientâ€™s site had not become re-infected.

  imagiNed

  @imagined
- ### Thank you very much for providing such a good plugin and service

  Having researched and trialed various security plugins Wordfence wins hands down each time. All our websites are running Wordfence Premium and this plugin has served us very well for several years and the support team are second to none. As a small business there are an array of tasks to take care of and it is a very small price to pay for Wordfence Premium to take care of an extremely important task and is worth every penny.

  A reliable security plugin is paramount but it goes without saying this must be backed up by a good technical support team who can assist you when there is a problem. The Wordfence technical support goes beyond the call of duty and their knowledge is very reassuring when things go awry with your website.

  Phil provided an excellent service giving us the confidence we are with the right people who really know what they are doing and can explain and assist in a very succinct, knowledgeable and helpful manner.

  Having numerous plugins running on a WordPress website can result in all manner of conflicts, never mind issues that maybe caused by the hosting services used which can be a nightmare to unravel without the right technical support at hand.

  Wordfence not only protects your website from being hacked but provides a wealth of advice and excellent technical support when needed. Thank you very much for providing such a good service.

  aristocats

  aristocats
- ### Wordfence is the best!

  Iâ€™ve been using Wordfence for some time now on 6 of my sites. It works extremely well and provides me with the protection from intruders that I need. Iâ€™ve only had a couple of minor issues, mostly caused by my lack of experience, but the support at Wordfence has been great at helping me out of a jam. I highly recommend the plugin, and purchasing the upgrade to the pro version is worth every penny. The plugin is easy to install and setup is simple. And.. if your host is GoDaddy, it is one of their recommended plugin partners.

  lairbear

  @lairbear
- ### Awesome

  Wordfence is my favourite WordPress plugin. Immediately installed on all my clientâ€™s sites. Saved my bacon numerous times.

  bluesix

  @bluesix
- ### Wordfence review

  Wordfence is a top-notch plugin, even the free version has tons on functions. I strongly recommend it for not only the newbie web-designer but also the experienced one as well. It is undoubtedly a great product.

  Steve F.

  sfekete111
- ### Amazing, Must-have for WP Site security

  My small business WP Site got hacked (built, installed and maintained by me) and a cryptocurrency miner was hidden somewhere in my code.

  I spent a week trying to eliminate that code, and my Host also looked for it, without success, meanwhile I looked like a jerk trying to mine cryptocurrency from clients and potential clients!

  I tried several other WP security plugins, and web scan sites, but none could find or fix my problem.

  I downloaded and installed Wordfence, it found and repaired my problem in less than 5 minutes!

  Iâ€™ve since enabled many of its additional features and have been stunned to learn just how many attempts there are daily to log into my page! No wonder it got hacked. Some jerk even set up a new username for himself!

  Anyhow, Iâ€™ll never have any other WP page without Wordfence, and neither should you!

  Amazing plugin, very simple and very powerful.

  Cain57

  @cain57

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save



=== Content from plugins.trac.wordpress.org_0f347ee2_20250114_211951.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse â†—ï¸Ž](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv â†—ï¸Ž](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp â†—ï¸Ž](https://central.wordcamp.org/)
  + [Meetups â†—ï¸Ž](https://www.meetup.com/pro/wordpress/)
  + [Job Board â†—ï¸Ž](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg â†—ï¸Ž](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store â†—ï¸Ž](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2937545%2Fmailarchiver)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* â† [Previous Change](/changeset/2873845/mailarchiver "Changeset 2873845 for mailarchiver")
* [Next Change](/changeset/2983435/mailarchiver "Changeset 2983435 for mailarchiver") â†’

---

# Changeset [2937545](/changeset/2937545 "Show full changeset") for [mailarchiver](/browser/mailarchiver?rev=2937545 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
07/12/2023 10:14:11 AM
([18 months](/timeline?from=2023-07-12T10%3A14%3A11Z&precision=second "See timeline at 07/12/2023 10:14:11 AM") ago)

Author:
PierreLannoy
Message:

MailArchiver 2.11.0 released from GitHub

Location:
[mailarchiver](/browser/mailarchiver?rev=2937545)
Files:

2 added
32 edited
1 copied

* [tags/2.11.0](/browser/mailarchiver/tags/2.11.0?rev=2937545 "Show entry in browser")
  (copied)
  *(copied from [mailarchiver/trunk](/browser/mailarchiver/trunk?rev=2873845 "Show original file (revision 2937544)"))*
* [tags/2.11.0/CHANGELOG.md](/browser/mailarchiver/tags/2.11.0/CHANGELOG.md?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [tags/2.11.0/admin/class-mailarchiver-admin.php](/browser/mailarchiver/tags/2.11.0/admin/class-mailarchiver-admin.php?rev=2937545 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [tags/2.11.0/admin/partials/mailarchiver-admin-settings-archiver-edit.php](/browser/mailarchiver/tags/2.11.0/admin/partials/mailarchiver-admin-settings-archiver-edit.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [tags/2.11.0/functions.php](/browser/mailarchiver/tags/2.11.0/functions.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [tags/2.11.0/includes/features/class-archiverfactory.php](/browser/mailarchiver/tags/2.11.0/includes/features/class-archiverfactory.php?rev=2937545 "Show entry in browser")
  (modified)
  ([3 diffs](#file5 "Show differences"))
* [tags/2.11.0/includes/features/class-archivermaintainer.php](/browser/mailarchiver/tags/2.11.0/includes/features/class-archivermaintainer.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [tags/2.11.0/includes/features/class-archivers.php](/browser/mailarchiver/tags/2.11.0/includes/features/class-archivers.php?rev=2937545 "Show entry in browser")
  (modified)
  ([2 diffs](#file7 "Show differences"))
* [tags/2.11.0/includes/features/class-events.php](/browser/mailarchiver/tags/2.11.0/includes/features/class-events.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file8 "Show differences"))
* [tags/2.11.0/includes/features/class-eventviewer.php](/browser/mailarchiver/tags/2.11.0/includes/features/class-eventviewer.php?rev=2937545 "Show entry in browser")
  (modified)
  ([3 diffs](#file9 "Show differences"))
* [tags/2.11.0/includes/features/class-handlertypes.php](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545 "Show entry in browser")
  (modified)
  ([21 diffs](#file10 "Show differences"))
* [tags/2.11.0/includes/features/class-processortypes.php](/browser/mailarchiver/tags/2.11.0/includes/features/class-processortypes.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file11 "Show differences"))
* [tags/2.11.0/includes/features/class-securityoptions.php](/browser/mailarchiver/tags/2.11.0/includes/features/class-securityoptions.php?rev=2937545 "Show entry in browser")
  (added)
* [tags/2.11.0/includes/processors/class-mailprocessor.php](/browser/mailarchiver/tags/2.11.0/includes/processors/class-mailprocessor.php?rev=2937545 "Show entry in browser")
  (modified)
  ([3 diffs](#file13 "Show differences"))
* [tags/2.11.0/includes/system/class-sitehealth.php](/browser/mailarchiver/tags/2.11.0/includes/system/class-sitehealth.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))
* [tags/2.11.0/init.php](/browser/mailarchiver/tags/2.11.0/init.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file15 "Show differences"))
* [tags/2.11.0/mailarchiver.php](/browser/mailarchiver/tags/2.11.0/mailarchiver.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file16 "Show differences"))
* [tags/2.11.0/readme.txt](/browser/mailarchiver/tags/2.11.0/readme.txt?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file17 "Show differences"))
* [trunk/CHANGELOG.md](/browser/mailarchiver/trunk/CHANGELOG.md?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file18 "Show differences"))
* [trunk/admin/class-mailarchiver-admin.php](/browser/mailarchiver/trunk/admin/class-mailarchiver-admin.php?rev=2937545 "Show entry in browser")
  (modified)
  ([3 diffs](#file19 "Show differences"))
* [trunk/admin/partials/mailarchiver-admin-settings-archiver-edit.php](/browser/mailarchiver/trunk/admin/partials/mailarchiver-admin-settings-archiver-edit.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file20 "Show differences"))
* [trunk/functions.php](/browser/mailarchiver/trunk/functions.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file21 "Show differences"))
* [trunk/includes/features/class-archiverfactory.php](/browser/mailarchiver/trunk/includes/features/class-archiverfactory.php?rev=2937545 "Show entry in browser")
  (modified)
  ([3 diffs](#file22 "Show differences"))
* [trunk/includes/features/class-archivermaintainer.php](/browser/mailarchiver/trunk/includes/features/class-archivermaintainer.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file23 "Show differences"))
* [trunk/includes/features/class-archivers.php](/browser/mailarchiver/trunk/includes/features/class-archivers.php?rev=2937545 "Show entry in browser")
  (modified)
  ([2 diffs](#file24 "Show differences"))
* [trunk/includes/features/class-events.php](/browser/mailarchiver/trunk/includes/features/class-events.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file25 "Show differences"))
* [trunk/includes/features/class-eventviewer.php](/browser/mailarchiver/trunk/includes/features/class-eventviewer.php?rev=2937545 "Show entry in browser")
  (modified)
  ([3 diffs](#file26 "Show differences"))
* [trunk/includes/features/class-handlertypes.php](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545 "Show entry in browser")
  (modified)
  ([21 diffs](#file27 "Show differences"))
* [trunk/includes/features/class-processortypes.php](/browser/mailarchiver/trunk/includes/features/class-processortypes.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file28 "Show differences"))
* [trunk/includes/features/class-securityoptions.php](/browser/mailarchiver/trunk/includes/features/class-securityoptions.php?rev=2937545 "Show entry in browser")
  (added)
* [trunk/includes/processors/class-mailprocessor.php](/browser/mailarchiver/trunk/includes/processors/class-mailprocessor.php?rev=2937545 "Show entry in browser")
  (modified)
  ([3 diffs](#file30 "Show differences"))
* [trunk/includes/system/class-sitehealth.php](/browser/mailarchiver/trunk/includes/system/class-sitehealth.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file31 "Show differences"))
* [trunk/init.php](/browser/mailarchiver/trunk/init.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file32 "Show differences"))
* [trunk/mailarchiver.php](/browser/mailarchiver/trunk/mailarchiver.php?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file33 "Show differences"))
* [trunk/readme.txt](/browser/mailarchiver/trunk/readme.txt?rev=2937545 "Show entry in browser")
  (modified)
  ([1 diff](#file34 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [mailarchiver/tags/2.11.0/CHANGELOG.md](/changeset/2937545/mailarchiver/tags/2.11.0/CHANGELOG.md "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/CHANGELOG.md")

  | [r2873845](/browser/mailarchiver/trunk/CHANGELOG.md?rev=2873845#L3 "Show revision 2873845 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/CHANGELOG.md?rev=2937545#L3 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 |  |
  | 4 | 4 | The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/), and \*\*MailArchiver\*\* adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html). |
  |  | 5 |  |
  |  | 6 | ## [2.11.0] - 2023-07-12 |
  |  | 7 |  |
  |  | 8 | ### Added |
  |  | 9 | - Compatibility with WordPress 6.3. |
  |  | 10 | - New option in archivers for proactive protection against XSS vulnerabilities. |
  |  | 11 |  |
  |  | 12 | ### Changed |
  |  | 13 | - Improved view for plain text email bodies. |
  |  | 14 | - Improved compatibility with Contact Forms plugin. |
  |  | 15 | - The color for `shmop` test in Site Health is now gray to not worry to much about it (was previously orange). |
  |  | 16 |  |
  |  | 17 | ### Fixed |
  |  | 18 | - [SEC004] XSS vulnerability / [CVE-2023-3136](https://www.cve.org/CVERecord?id=CVE-2023-3136) (thanks to [Alex Thomas](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/alex-thomas) from [Wordfence](https://www.wordfence.com)). |
  | 5 | 19 |  |
  | 6 | 20 | ## [2.10.1] - 2023-03-02 |
* ## [mailarchiver/tags/2.11.0/admin/class-mailarchiver-admin.php](/changeset/2937545/mailarchiver/tags/2.11.0/admin/class-mailarchiver-admin.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/admin/class-mailarchiver-admin.php")

  | [r2873845](/browser/mailarchiver/trunk/admin/class-mailarchiver-admin.php?rev=2873845#L259 "Show revision 2873845 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/admin/class-mailarchiver-admin.php?rev=2937545#L259 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 259 | 259 | add\_settings\_section( 'mailarchiver\_archiver\_specific\_section', null, [ $this, 'archiver\_specific\_section\_callback' ], 'mailarchiver\_archiver\_specific\_section' ); |
  | 260 | 260 | add\_settings\_section( 'mailarchiver\_archiver\_privacy\_section', esc\_html\_\_( 'Privacy options', 'mailarchiver' ), [ $this, 'archiver\_privacy\_section\_callback' ], 'mailarchiver\_archiver\_privacy\_section' ); |
  |  | 261 | add\_settings\_section( 'mailarchiver\_archiver\_security\_section', esc\_html\_\_( 'Security options', 'mailarchiver' ), [ $this, 'archiver\_security\_section\_callback' ], 'mailarchiver\_archiver\_security\_section' ); |
  | 261 | 262 | add\_settings\_section( 'mailarchiver\_archiver\_details\_section', esc\_html\_\_( 'Reported details', 'mailarchiver' ), [ $this, 'archiver\_details\_section\_callback' ], 'mailarchiver\_archiver\_details\_section' ); |
  | 262 | 263 | } |
  | [â€¦](/browser/mailarchiver/trunk/admin/class-mailarchiver-admin.php?rev=2873845#L574) | [â€¦](/browser/mailarchiver/tags/2.11.0/admin/class-mailarchiver-admin.php?rev=2937545#L575) |  |
  | 574 | 575 | $this->current\_archiver['privacy']['pseudonymization']Â  = ( array\_key\_exists( 'mailarchiver\_archiver\_privacy\_name', $\_POST ) ? true : false ); |
  | 575 | 576 | $this->current\_archiver['privacy']['mailanonymization'] = ( array\_key\_exists( 'mailarchiver\_archiver\_privacy\_mail', $\_POST ) ? true : false ); |
  |  | 577 | $this->current\_archiver['security']['xss']Â  Â  Â  Â  Â  Â  Â  = ( array\_key\_exists( 'mailarchiver\_archiver\_security\_xss', $\_POST ) ? true : false ); |
  | 576 | 578 | $this->current\_archiver['privacy']['encryption']Â  Â  Â  Â  = ( array\_key\_exists( 'mailarchiver\_archiver\_privacy\_encryption', $\_POST ) ? Secret::set( filter\_input( INPUT\_POST, 'mailarchiver\_archiver\_privacy\_encryption', FILTER\_UNSAFE\_RAW ) ) : '' ); |
  | 577 | 579 | $this->current\_archiver['processors']Â  Â  Â  Â  Â  Â  Â  Â  Â  Â = []; |
  | [â€¦](/browser/mailarchiver/trunk/admin/class-mailarchiver-admin.php?rev=2873845#L1126) | [â€¦](/browser/mailarchiver/tags/2.11.0/admin/class-mailarchiver-admin.php?rev=2937545#L1128) |  |
  | 1126 | 1128 |  |
  | 1127 | 1129 | /\*\* |
  |  | 1130 | \* Callback for archiver security section. |
  |  | 1131 | \* |
  |  | 1132 | \* @since 2.11.0 |
  |  | 1133 | \*/ |
  |  | 1134 | public function archiver\_security\_section\_callback() { |
  |  | 1135 | $form = new Form(); |
  |  | 1136 | add\_settings\_field( |
  |  | 1137 | 'mailarchiver\_archiver\_security\_xss', |
  |  | 1138 | \_\_( 'XSS', 'mailarchiver' ), |
  |  | 1139 | [ $form, 'echo\_field\_checkbox' ], |
  |  | 1140 | 'mailarchiver\_archiver\_security\_section', |
  |  | 1141 | 'mailarchiver\_archiver\_security\_section', |
  |  | 1142 | [ |
  |  | 1143 | 'text'Â  Â  Â  Â  => esc\_html\_\_( 'Script removal', 'mailarchiver' ), |
  |  | 1144 | 'id'Â  Â  Â  Â  Â  => 'mailarchiver\_archiver\_security\_xss', |
  |  | 1145 | 'checked'Â  Â  Â => $this->current\_archiver['security']['xss'], |
  |  | 1146 | 'description' => esc\_html\_\_( 'If checked, all scripts will be removed from subject and content fields.', 'mailarchiver' ), |
  |  | 1147 | 'full\_width'Â  => false, |
  |  | 1148 | 'enabled'Â  Â  Â => true, |
  |  | 1149 | ] |
  |  | 1150 | ); |
  |  | 1151 | register\_setting( 'mailarchiver\_archiver\_security\_section', 'mailarchiver\_archiver\_security\_xss' ); |
  |  | 1152 | } |
  |  | 1153 |  |
  |  | 1154 | /\*\* |
  | 1128 | 1155 | \* Callback for archiver privacy section. |
  | 1129 | 1156 | \* |
* ## [mailarchiver/tags/2.11.0/admin/partials/mailarchiver-admin-settings-archiver-edit.php](/changeset/2937545/mailarchiver/tags/2.11.0/admin/partials/mailarchiver-admin-settings-archiver-edit.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/admin/partials/mailarchiver-admin-settings-archiver-edit.php")

  | [r2606924](/browser/mailarchiver/trunk/admin/partials/mailarchiver-admin-settings-archiver-edit.php?rev=2606924#L33 "Show revision 2606924 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/admin/partials/mailarchiver-admin-settings-archiver-edit.php?rev=2937545#L33 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 33 | 33 | <?php if ( in\_array( $current\_handler['class'], [ 'alerting', 'logging', 'storing' ], true ) ) { ?> |
  | 34 | 34 | <?php do\_settings\_sections( 'mailarchiver\_archiver\_privacy\_section' ); ?> |
  |  | 35 | <?php do\_settings\_sections( 'mailarchiver\_archiver\_security\_section' ); ?> |
  | 35 | 36 | <?php do\_settings\_sections( 'mailarchiver\_archiver\_details\_section' ); ?> |
  | 36 | 37 | <?php } ?> |
* ## [mailarchiver/tags/2.11.0/functions.php](/changeset/2937545/mailarchiver/tags/2.11.0/functions.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/functions.php")

  | [r2640285](/browser/mailarchiver/trunk/functions.php?rev=2640285#L394 "Show revision 2640285 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/functions.php?rev=2937545#L394 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 394 | 394 | } |
  | 395 | 395 |  |
  |  | 396 | /\*\* |
  |  | 397 | \* Properly strips script tags including |
  |  | 398 | \* |
  |  | 399 | \* This differs from strip\_tags() because it removes the contents of |
  |  | 400 | \* the `<script>` and `<style>` tags. E.g. `strip\_tags( '<script>something</script>' )` |
  |  | 401 | \* will return 'something'. wp\_strip\_all\_tags will return '' |
  |  | 402 | \* |
  |  | 403 | \* @since 2.11.0 |
  |  | 404 | \* |
  |  | 405 | \* @param string $textÂ  Â  Â  Â  Â  String containing HTML tags |
  |  | 406 | \* @param boolÂ  Â $remove\_breaks Optional. Whether to remove left over line breaks and white space chars |
  |  | 407 | \* @return string The processed string. |
  |  | 408 | \*/ |
  |  | 409 | function mailarchiver\_strip\_script\_tags( $text, $remove\_breaks = false ) { |
  |  | 410 | if ( is\_null( $text ) ) { |
  |  | 411 | return ''; |
  |  | 412 | } |
  |  | 413 |  |
  |  | 414 | if ( ! is\_scalar( $text ) ) { |
  |  | 415 | /\* |
  |  | 416 | \* To maintain consistency with pre-PHP 8 error levels, |
  |  | 417 | \* trigger\_error() is used to trigger an E\_USER\_WARNING, |
  |  | 418 | \* rather than \_doing\_it\_wrong(), which triggers an E\_USER\_NOTICE. |
  |  | 419 | \*/ |
  |  | 420 | trigger\_error( |
  |  | 421 | sprintf( |
  |  | 422 | /\* translators: 1: The function name, 2: The argument number, 3: The argument name, 4: The expected type, 5: The provided type. \*/ |
  |  | 423 | \_\_( 'Warning: %1$s expects parameter %2$s (%3$s) to be a %4$s, %5$s given.' ), |
  |  | 424 | \_\_FUNCTION\_\_, |
  |  | 425 | '#1', |
  |  | 426 | '$text', |
  |  | 427 | 'string', |
  |  | 428 | gettype( $text ) |
  |  | 429 | ), |
  |  | 430 | E\_USER\_WARNING |
  |  | 431 | ); |
  |  | 432 |  |
  |  | 433 | return ''; |
  |  | 434 | } |
  |  | 435 |  |
  |  | 436 | $text = preg\_replace( '@<(script)[^>]\*?>.\*?</\\1>@si', '', $text ); |
  |  | 437 |  |
  |  | 438 | if ( $remove\_breaks ) { |
  |  | 439 | $text = preg\_replace( '/[\r\n\t ]+/', ' ', $text ); |
  |  | 440 | } |
  |  | 441 |  |
  |  | 442 | return trim( $text ); |
  |  | 443 | } |
  |  | 444 |  |
  | 396 | 445 |  |
  | 397 | 446 | /\*\* |
* ## [mailarchiver/tags/2.11.0/includes/features/class-archiverfactory.php](/changeset/2937545/mailarchiver/tags/2.11.0/includes/features/class-archiverfactory.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/includes/features/class-archiverfactory.php")

  | [r2606924](/browser/mailarchiver/trunk/includes/features/class-archiverfactory.php?rev=2606924#L131 "Show revision 2606924 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/includes/features/class-archiverfactory.php?rev=2937545#L131 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 131 | 131 | } |
  | 132 | 132 | break; |
  |  | 133 | case 'security': |
  |  | 134 | $args[] = (bool) $archiver['security'][ $p['value'] ]; |
  |  | 135 | break; |
  | 133 | 136 | case 'literal': |
  | 134 | 137 | $args[] = $p['value']; |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-archiverfactory.php?rev=2606924#L162) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-archiverfactory.php?rev=2937545#L165) |  |
  | 162 | 165 | $archiver = $this->privacy\_check( $archiver ); |
  | 163 | 166 | } |
  |  | 167 | if ( $handler && in\_array( 'security', $handler['params'], true ) ) { |
  |  | 168 | $archiver = $this->security\_check( $archiver ); |
  |  | 169 | } |
  | 164 | 170 | if ( $handler && in\_array( 'processors', $handler['params'], true ) ) { |
  | 165 | 171 | $archiver = $this->processor\_check( $archiver ); |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-archiverfactory.php?rev=2606924#L284) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-archiverfactory.php?rev=2937545#L290) |  |
  | 284 | 290 | $archiver['privacy']['mailanonymization'] = false; |
  | 285 | 291 | $archiver['privacy']['encryption']Â  Â  Â  Â  = ''; |
  |  | 292 | } |
  |  | 293 | return $archiver; |
  |  | 294 | } |
  |  | 295 |  |
  |  | 296 | /\*\* |
  |  | 297 | \* Check the security part of the archiver. |
  |  | 298 | \* |
  |  | 299 | \* @paramÂ  Â array $archiverÂ  The archiver definition. |
  |  | 300 | \* @returnÂ  arrayÂ  Â The checked archiver definition. |
  |  | 301 | \* @sinceÂ  Â  2.11.0 |
  |  | 302 | \*/ |
  |  | 303 | private function security\_check( $archiver ) { |
  |  | 304 | if ( array\_key\_exists( 'security', $archiver ) ) { |
  |  | 305 | if ( ! array\_key\_exists( 'xss', $archiver['security'] ) ) { |
  |  | 306 | $archiver['security']['xss'] = true; |
  |  | 307 | } |
  |  | 308 | } else { |
  |  | 309 | $archiver['security']['xss'] = true; |
  | 286 | 310 | } |
  | 287 | 311 | return $archiver; |
* ## [mailarchiver/tags/2.11.0/includes/features/class-archivermaintainer.php](/changeset/2937545/mailarchiver/tags/2.11.0/includes/features/class-archivermaintainer.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/includes/features/class-archivermaintainer.php")

  | [r2640285](/browser/mailarchiver/trunk/includes/features/class-archivermaintainer.php?rev=2640285#L125 "Show revision 2640285 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/includes/features/class-archivermaintainer.php?rev=2937545#L125 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 125 | 125 | } |
  | 126 | 126 | } |
  |  | 127 | $security = []; |
  |  | 128 | foreach ( $logger['security'] as $i => $item ) { |
  |  | 129 | if ( $item ) { |
  |  | 130 | $security[] = $i; |
  |  | 131 | } |
  |  | 132 | } |
  | 127 | 133 | $logger['privacy']Â  Â  = '[' . implode(', ', $privacy ) . ']'; |
  |  | 134 | $logger['security']Â  Â = '[' . implode(', ', $security ) . ']'; |
  | 128 | 135 | $logger['processors'] = '[' . implode(', ', $logger['processors'] ) . ']'; |
  | 129 | 136 | $configurationÂ  Â  Â  Â  = []; |
* ## [mailarchiver/tags/2.11.0/includes/features/class-archivers.php](/changeset/2937545/mailarchiver/tags/2.11.0/includes/features/class-archivers.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/includes/features/class-archivers.php")

  | [r2712816](/browser/mailarchiver/trunk/includes/features/class-archivers.php?rev=2712816#L13 "Show revision 2712816 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/includes/features/class-archivers.php?rev=2937545#L13 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 |  |
  | 14 | 14 | use Mailarchiver\Plugin\Feature\PrivacyOptions; |
  |  | 15 | use Mailarchiver\Plugin\Feature\SecurityOptions; |
  | 15 | 16 | use Mailarchiver\System\Option; |
  | 16 | 17 | use Mailarchiver\Plugin\Feature\Archive; |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-archivers.php?rev=2712816#L217) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-archivers.php?rev=2937545#L218) |  |
  | 217 | 218 | if ( $item['privacy'][$option] ) { |
  | 218 | 219 | $result .= '<img alt="' . PrivacyOptions::$options\_names[ $option ] . '" title="' . PrivacyOptions::$options\_names[ $option ] . '" style="width:16px;padding-left:6px;padding-top:6px;" src="' . Icons::get\_base64( PrivacyOptions::$options\_icons[ $option ], 'none', '#9999BB' ) . '" />'; |
  |  | 220 | } |
  |  | 221 | } |
  |  | 222 | foreach ( SecurityOptions::$options as $option ) { |
  |  | 223 | if ( $item['security'][$option] ) { |
  |  | 224 | $result .= '<img alt="' . SecurityOptions::$options\_names[ $option ] . '" title="' . SecurityOptions::$options\_names[ $option ] . '" style="width:16px;padding-left:6px;padding-top:6px;" src="' . Icons::get\_base64( SecurityOptions::$options\_icons[ $option ], 'none', '#9999BB' ) . '" />'; |
  | 219 | 225 | } |
  | 220 | 226 | } |
* ## [mailarchiver/tags/2.11.0/includes/features/class-events.php](/changeset/2937545/mailarchiver/tags/2.11.0/includes/features/class-events.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/includes/features/class-events.php")

  | [r2658583](/browser/mailarchiver/trunk/includes/features/class-events.php?rev=2658583#L157 "Show revision 2658583 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/includes/features/class-events.php?rev=2937545#L157 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 157 | 157 | $urlÂ  Â  Â  Â  Â  Â  Â = add\_query\_arg( $args, admin\_url( 'admin.php' ) ); |
  | 158 | 158 | $iconÂ  Â  Â  Â  Â  Â  = '<img style="width:18px;float:left;padding-right:6px;" src="' . EventTypes::$icons[ $item['level'] ] . '" />'; |
  | 159 |  | $nameÂ  Â  Â  Â  Â  Â  = '<a href="' . $url . '">' . ~~$item['subject']~~ . '</a>'; |
  |  | 159 | $nameÂ  Â  Â  Â  Â  Â  = '<a href="' . $url . '">' . mailarchiver\_strip\_script\_tags( $item['subject'], true ) . '</a>'; |
  | 160 | 160 | $resultÂ  Â  Â  Â  Â  = $icon . $name; |
  | 161 | 161 | return $result; |
* ## [mailarchiver/tags/2.11.0/includes/features/class-eventviewer.php](/changeset/2937545/mailarchiver/tags/2.11.0/includes/features/class-eventviewer.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/includes/features/class-eventviewer.php")

  | [r2606924](/browser/mailarchiver/trunk/includes/features/class-eventviewer.php?rev=2606924#L132 "Show revision 2606924 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/includes/features/class-eventviewer.php?rev=2937545#L132 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 132 | 132 | } else { |
  | 133 | 133 | $content = str\_replace( '"', '\"', $content ); |
  | 134 |  | $content = str\_replace( "\r\n", "<br~~/~~>", $content ); |
  | 135 |  | $content = str\_replace( "\n", "<br~~/~~>", $content ); |
  | 136 |  | $content = str\_replace( "\r", "<br~~/~~>", $content ); |
  | 137 |  | $content = str\_replace( "\t", "", $content ); |
  |  | 134 | $content = str\_replace( "\r\n", "<br>", $content ); |
  |  | 135 | $content = str\_replace( "\n", "<br>", $content ); |
  |  | 136 | $content = str\_replace( "\r", "<br>", $content ); |
  |  | 137 | $content = str\_replace( "\t", "<br>", $content ); |
  | 138 | 138 | $content = '<html><body style=\"padding:10px;font-family:\'Lucida Console\', Monaco, monospace;font-size: 14px;background-color:#F1F1F1;\">' . $content . '</body></html>'; |
  | 139 | 139 | } |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-eventviewer.php?rev=2606924#L148) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-eventviewer.php?rev=2937545#L148) |  |
  | 148 | 148 | $content = str\_replace( '\\', '\\\\', $content ); |
  | 149 | 149 | $content = str\_replace( '"', '\"', $content ); |
  | 150 |  | ~~$content = str\_replace( "\r\n", " ", $content );~~ |
  | 151 |  | ~~$content = str\_replace( "\n", " ", $content );~~ |
  | 152 |  | ~~$content = str\_replace( "\r", " ", $content );~~ |
  | 153 |  | ~~$content = str\_replace( "\t", " ", $content );~~ |
  | 154 | 150 | while ( false !== strpos( $content, 'Â  ' ) ) { |
  | 155 | 151 | $content = str\_replace("Â  ", " ", $content); |
  | 156 | 152 | } |
  | 157 | 153 | } |
  | 158 |  | $this->body = ~~$content~~; |
  |  | 154 | $this->body = mailarchiver\_strip\_script\_tags( $content, $is\_html ); |
  | 159 | 155 | } |
  | 160 | 156 |  |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-eventviewer.php?rev=2606924#L245) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-eventviewer.php?rev=2937545#L241) |  |
  | 245 | 241 | if ( isset( $this->event ) ) { |
  | 246 | 242 | $icon = '<img style="width:30px;float:left;padding-right:8px;" src="' . EventTypes::$icons[ $this->event['level'] ] . '" />'; |
  | 247 |  | $name = ~~$this->event['subject']~~; |
  |  | 243 | $name = mailarchiver\_strip\_script\_tags( $this->event['subject'], true ); |
  | 248 | 244 | // phpcs:ignore |
  | 249 | 245 | echo '<h2>' . $icon . $name . '</h2>'; |
* ## [mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php](/changeset/2937545/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php")

  | [r2640285](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L68 "Show revision 2640285 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L68 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 68 | 68 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'A mail copy sent to Litmus service.', 'mailarchiver' ), |
  | 69 | 69 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_litmus\_icon(), |
  | 70 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 70 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 71 | 71 | 'configuration' => [ |
  | 72 | 72 | 'box'Â  Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L122) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L122) |  |
  | 122 | 122 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'A mail copy sent to Email on Acid service.', 'mailarchiver' ), |
  | 123 | 123 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_eoa\_icon(), |
  | 124 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 124 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 125 | 125 | 'configuration' => [ |
  | 126 | 126 | 'box'Â  Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L176) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L176) |  |
  | 176 | 176 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'A mail copy sent to MailerCheck service.', 'mailarchiver' ), |
  | 177 | 177 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_mailercheck\_icon(), |
  | 178 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 178 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 179 | 179 | 'configuration' => [ |
  | 180 | 180 | 'box'Â  Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L217) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L217) |  |
  | 217 | 217 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'A mail copy sent to an email address.', 'mailarchiver' ), |
  | 218 | 218 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_mail\_icon(), |
  | 219 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 219 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 220 | 220 | 'configuration' => [ |
  | 221 | 221 | 'box'Â  Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L256) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L256) |  |
  | 256 | 256 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'An archive sent to a Fluentd collector.', 'mailarchiver' ), |
  | 257 | 257 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_fluentd\_icon(), |
  | 258 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 258 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 259 | 259 | 'configuration' => [ |
  | 260 | 260 | 'host'Â  Â  => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L312) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L312) |  |
  | 312 | 312 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'An archive sent to Logentries & insightOps service.', 'mailarchiver' ), |
  | 313 | 313 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_logentries\_icon(), |
  | 314 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 314 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 315 | 315 | 'configuration' => [ |
  | 316 | 316 | 'host'Â  Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L381) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L381) |  |
  | 381 | 381 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'An archive sent to Solawinds Loggly service.', 'mailarchiver' ), |
  | 382 | 382 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_loggly\_icon(), |
  | 383 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 383 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 384 | 384 | 'configuration' => [ |
  | 385 | 385 | 'token' => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L414) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L414) |  |
  | 414 | 414 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'An archive sent to a remote syslogd server.', 'mailarchiver' ), |
  | 415 | 415 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_syslog\_icon(), |
  | 416 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 416 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 417 | 417 | 'configuration' => [ |
  | 418 | 418 | 'host'Â  Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L532) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L532) |  |
  | 532 | 532 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_grafana\_icon(), |
  | 533 | 533 | 'needs'Â  Â  Â  Â  Â => [], |
  | 534 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 534 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 535 | 535 | 'configuration' => [ |
  | 536 | 536 | 'host'Â  => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L630) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L630) |  |
  | 630 | 630 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_loki\_icon(), |
  | 631 | 631 | 'needs'Â  Â  Â  Â  Â => [], |
  | 632 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 632 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 633 | 633 | 'configuration' => [ |
  | 634 | 634 | 'url'Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L698) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L698) |  |
  | 698 | 698 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'Emails in error signaled to Pushover service.', 'mailarchiver' ), |
  | 699 | 699 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_pushover\_icon(), |
  | 700 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 700 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 701 | 701 | 'configuration' => [ |
  | 702 | 702 | 'token' => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L782) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L782) |  |
  | 782 | 782 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'Emails in error signaled through Slack Webhooks.', 'mailarchiver' ), |
  | 783 | 783 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_slack\_icon(), |
  | 784 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 784 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 785 | 785 | 'configuration' => [ |
  | 786 | 786 | 'webhook' => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L925) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L925) |  |
  | 925 | 925 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'An archive sent to files that are rotated every day and a limited number of files are kept.', 'mailarchiver' ), |
  | 926 | 926 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_rotatingfiles\_icon(), |
  | 927 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 927 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 928 | 928 | 'configuration' => [ |
  | 929 | 929 | 'filename' => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L986) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L986) |  |
  | 986 | 986 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'An archive stored in your WordPress database and available right in your admin dashboard.', 'mailarchiver' ), |
  | 987 | 987 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_wordpress\_icon(), |
  | 988 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 988 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 989 | 989 | 'configuration' => [ |
  | 990 | 990 | 'rotate' => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1054) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L1054) |  |
  | 1054 | 1054 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_elasticcloud\_icon(), |
  | 1055 | 1055 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1056 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1056 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1057 | 1057 | 'configuration' => [ |
  | 1058 | 1058 | 'cloudid' => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1139) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L1139) |  |
  | 1139 | 1139 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_elasticsearch\_icon(), |
  | 1140 | 1140 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1141 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1141 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1142 | 1142 | 'configuration' => [ |
  | 1143 | 1143 | 'url'Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1225) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L1225) |  |
  | 1225 | 1225 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_imap\_icon(), |
  | 1226 | 1226 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1227 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1227 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1228 | 1228 | 'configuration' => [ |
  | 1229 | 1229 | 'url'Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1346) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L1346) |  |
  | 1346 | 1346 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_gmail\_icon(), |
  | 1347 | 1347 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1348 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1348 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1349 | 1349 | 'configuration' => [ |
  | 1350 | 1350 | 'user'Â  => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1400) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L1400) |  |
  | 1400 | 1400 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_ovh\_icon(), |
  | 1401 | 1401 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1402 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1402 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1403 | 1403 | 'configuration' => [ |
  | 1404 | 1404 | 'user'Â  => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1454) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L1454) |  |
  | 1454 | 1454 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_gandi\_icon(), |
  | 1455 | 1455 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1456 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1456 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1457 | 1457 | 'configuration' => [ |
  | 1458 | 1458 | 'user'Â  => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1508) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/features/class-handlertypes.php?rev=2937545#L1508) |  |
  | 1508 | 1508 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_microsoft\_icon(), |
  | 1509 | 1509 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1510 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1510 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1511 | 1511 | 'configuration' => [ |
  | 1512 | 1512 | 'user'Â  => [ |
* ## [mailarchiver/tags/2.11.0/includes/features/class-processortypes.php](/changeset/2937545/mailarchiver/tags/2.11.0/includes/features/class-processortypes.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/includes/features/class-processortypes.php")

  | [r2400372](/browser/mailarchiver/trunk/includes/features/class-processortypes.php?rev=2400372#L72 "Show revision 2400372 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/includes/features/class-processortypes.php?rev=2937545#L72 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 72 | 72 | ], |
  | 73 | 73 | [ |
  |  | 74 | 'type'Â  => 'security', |
  |  | 75 | 'value' => 'xss', |
  |  | 76 | ], |
  |  | 77 | [ |
  | 74 | 78 | 'type'Â  => 'privacy', |
  | 75 | 79 | 'value' => 'encryption', |
* ## [mailarchiver/tags/2.11.0/includes/processors/class-mailprocessor.php](/changeset/2937545/mailarchiver/tags/2.11.0/includes/processors/class-mailprocessor.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/includes/processors/class-mailprocessor.php")

  | [r2606924](/browser/mailarchiver/trunk/includes/processors/class-mailprocessor.php?rev=2606924#L37 "Show revision 2606924 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/includes/processors/class-mailprocessor.php?rev=2937545#L37 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 37 | 37 |  |
  | 38 | 38 | /\*\* |
  |  | 39 | \* Xss filtering switch. |
  |  | 40 | \* |
  |  | 41 | \* @sinceÂ  2.11.0 |
  |  | 42 | \* @varÂ  Â  booleanÂ  Â  $xssÂ  Â  Is xss filtering activated? |
  |  | 43 | \*/ |
  |  | 44 | private $xss = false; |
  |  | 45 |  |
  |  | 46 | /\*\* |
  | 39 | 47 | \* Encryption key. |
  | 40 | 48 | \* |
  | [â€¦](/browser/mailarchiver/trunk/includes/processors/class-mailprocessor.php?rev=2606924#L49) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/processors/class-mailprocessor.php?rev=2937545#L57) |  |
  | 49 | 57 | \* @sinceÂ  Â 1.0.0 |
  | 50 | 58 | \* @paramÂ  Â boolean $mailanonymizeÂ  Optional. Is mailanonymization activated? |
  |  | 59 | \* @paramÂ  Â boolean $xssÂ  Â  Â  Â  Â  Â  Optional. Is xss filtering activated? |
  | 51 | 60 | \* @paramÂ  Â stringÂ  $encryptionÂ  Â  Â Optional. Encryption key. |
  | 52 | 61 | \*/ |
  | 53 |  | public function \_\_construct( $mailanonymize = true, $encryption = '' ) { |
  |  | 62 | public function \_\_construct( $mailanonymize = true, $xss = true, $encryption = '' ) { |
  | 54 | 63 | $this->mailanonymization = $mailanonymize; |
  | 55 | 64 | $this->encryptionÂ  Â  Â  Â  = $encryption; |
  |  | 65 | $this->xssÂ  Â  Â  Â  Â  Â  Â  Â = $xss; |
  | 56 | 66 | } |
  | 57 | 67 |  |
  | [â€¦](/browser/mailarchiver/trunk/includes/processors/class-mailprocessor.php?rev=2606924#L72) | [â€¦](/browser/mailarchiver/tags/2.11.0/includes/processors/class-mailprocessor.php?rev=2937545#L82) |  |
  | 72 | 82 | $record['context']['to'] = $tos; |
  | 73 | 83 | } |
  |  | 84 | if ( $this->xss ) { |
  |  | 85 | $record['context']['subject'] = mailarchiver\_strip\_script\_tags( $record['context']['subject'] ); |
  |  | 86 | $record['context']['body']['raw']Â  = mailarchiver\_strip\_script\_tags( $record['context']['body']['raw'] ); |
  |  | 87 | $record['context']['body']['text'] = mailarchiver\_strip\_script\_tags( $record['context']['body']['text'] ); |
  |  | 88 | } |
  | 74 | 89 | if ( 0 < strlen( $this->encryption ) ) { |
  | 75 | 90 | if ( PwdProtect::is\_available() ) { |
* ## [mailarchiver/tags/2.11.0/includes/system/class-sitehealth.php](/changeset/2937545/mailarchiver/tags/2.11.0/includes/system/class-sitehealth.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/includes/system/class-sitehealth.php")

  | [r2794879](/browser/mailarchiver/trunk/includes/system/class-sitehealth.php?rev=2794879#L336 "Show revision 2794879 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/includes/system/class-sitehealth.php?rev=2937545#L336 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 336 | 336 | 'badge'Â  Â  Â  Â => [ |
  | 337 | 337 | 'label' => esc\_html\_\_( 'Performance', 'mailarchiver' ), |
  | 338 |  | 'color' => '~~orange~~', |
  |  | 338 | 'color' => 'gray', |
  | 339 | 339 | ], |
  | 340 | 340 | 'description' => sprintf( '<p>%s</p>', esc\_html\_\_( 'You should consider using shared memory (PHP shmop) to allow inter-process communication.', 'mailarchiver' ) ), |
* ## [mailarchiver/tags/2.11.0/init.php](/changeset/2937545/mailarchiver/tags/2.11.0/init.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/init.php")

  | [r2873845](/browser/mailarchiver/trunk/init.php?rev=2873845#L13 "Show revision 2873845 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/init.php?rev=2937545#L13 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 | define( 'MAILARCHIVER\_PRODUCT\_ABBREVIATION', 'mailarchiver' ); |
  | 14 | 14 | define( 'MAILARCHIVER\_SLUG', 'mailarchiver' ); |
  | 15 |  | define( 'MAILARCHIVER\_VERSION', '2.1~~0.1~~' ); |
  |  | 15 | define( 'MAILARCHIVER\_VERSION', '2.11.0' ); |
  | 16 | 16 | define( 'MAILARCHIVER\_MONOLOG\_VERSION', '2.9.1' ); |
  | 17 | 17 | define( 'MAILARCHIVER\_CODENAME', '"-"' ); |
* ## [mailarchiver/tags/2.11.0/mailarchiver.php](/changeset/2937545/mailarchiver/tags/2.11.0/mailarchiver.php "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/mailarchiver.php")

  | [r2873845](/browser/mailarchiver/trunk/mailarchiver.php?rev=2873845#L11 "Show revision 2873845 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/mailarchiver.php?rev=2937545#L11 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | \* Plugin URI:Â  Â  Â  Â  https://perfops.one/mailarchiver |
  | 12 | 12 | \* Description:Â  Â  Â  Â Automatically archive and store all emails sent from your site. |
  | 13 |  | \* Version:Â  Â  Â  Â  Â  Â 2.1~~0.1~~ |
  |  | 13 | \* Version:Â  Â  Â  Â  Â  Â 2.11.0 |
  | 14 | 14 | \* Requires at least: 5.2 |
  | 15 | 15 | \* Requires PHP:Â  Â  Â  7.2 |
* ## [mailarchiver/tags/2.11.0/readme.txt](/changeset/2937545/mailarchiver/tags/2.11.0/readme.txt "Show the changeset 2937545 restricted to mailarchiver/tags/2.11.0/readme.txt")

  | [r2873845](/browser/mailarchiver/trunk/readme.txt?rev=2873845#L4 "Show revision 2873845 of this file in browser") | [r2937545](/browser/mailarchiver/tags/2.11.0/readme.txt?rev=2937545#L4 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 5.2 |
  | 5 | 5 | Requires PHP: 7.2 |
  | 6 |  | Tested up to: 6.~~2~~ |
  | 7 |  | Stable tag: 2.1~~0.1~~ |
  |  | 6 | Tested up to: 6.3 |
  |  | 7 | Stable tag: 2.11.0 |
  | 8 | 8 | License: GPLv3 |
  | 9 | 9 | License URI: https://www.gnu.org/licenses/gpl-3.0.html |
* ## [mailarchiver/trunk/CHANGELOG.md](/changeset/2937545/mailarchiver/trunk/CHANGELOG.md "Show the changeset 2937545 restricted to mailarchiver/trunk/CHANGELOG.md")

  | [r2873845](/browser/mailarchiver/trunk/CHANGELOG.md?rev=2873845#L3 "Show revision 2873845 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/CHANGELOG.md?rev=2937545#L3 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 |  |
  | 4 | 4 | The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/), and \*\*MailArchiver\*\* adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html). |
  |  | 5 |  |
  |  | 6 | ## [2.11.0] - 2023-07-12 |
  |  | 7 |  |
  |  | 8 | ### Added |
  |  | 9 | - Compatibility with WordPress 6.3. |
  |  | 10 | - New option in archivers for proactive protection against XSS vulnerabilities. |
  |  | 11 |  |
  |  | 12 | ### Changed |
  |  | 13 | - Improved view for plain text email bodies. |
  |  | 14 | - Improved compatibility with Contact Forms plugin. |
  |  | 15 | - The color for `shmop` test in Site Health is now gray to not worry to much about it (was previously orange). |
  |  | 16 |  |
  |  | 17 | ### Fixed |
  |  | 18 | - [SEC004] XSS vulnerability / [CVE-2023-3136](https://www.cve.org/CVERecord?id=CVE-2023-3136) (thanks to [Alex Thomas](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/alex-thomas) from [Wordfence](https://www.wordfence.com)). |
  | 5 | 19 |  |
  | 6 | 20 | ## [2.10.1] - 2023-03-02 |
* ## [mailarchiver/trunk/admin/class-mailarchiver-admin.php](/changeset/2937545/mailarchiver/trunk/admin/class-mailarchiver-admin.php "Show the changeset 2937545 restricted to mailarchiver/trunk/admin/class-mailarchiver-admin.php")

  | [r2873845](/browser/mailarchiver/trunk/admin/class-mailarchiver-admin.php?rev=2873845#L259 "Show revision 2873845 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/admin/class-mailarchiver-admin.php?rev=2937545#L259 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 259 | 259 | add\_settings\_section( 'mailarchiver\_archiver\_specific\_section', null, [ $this, 'archiver\_specific\_section\_callback' ], 'mailarchiver\_archiver\_specific\_section' ); |
  | 260 | 260 | add\_settings\_section( 'mailarchiver\_archiver\_privacy\_section', esc\_html\_\_( 'Privacy options', 'mailarchiver' ), [ $this, 'archiver\_privacy\_section\_callback' ], 'mailarchiver\_archiver\_privacy\_section' ); |
  |  | 261 | add\_settings\_section( 'mailarchiver\_archiver\_security\_section', esc\_html\_\_( 'Security options', 'mailarchiver' ), [ $this, 'archiver\_security\_section\_callback' ], 'mailarchiver\_archiver\_security\_section' ); |
  | 261 | 262 | add\_settings\_section( 'mailarchiver\_archiver\_details\_section', esc\_html\_\_( 'Reported details', 'mailarchiver' ), [ $this, 'archiver\_details\_section\_callback' ], 'mailarchiver\_archiver\_details\_section' ); |
  | 262 | 263 | } |
  | [â€¦](/browser/mailarchiver/trunk/admin/class-mailarchiver-admin.php?rev=2873845#L574) | [â€¦](/browser/mailarchiver/trunk/admin/class-mailarchiver-admin.php?rev=2937545#L575) |  |
  | 574 | 575 | $this->current\_archiver['privacy']['pseudonymization']Â  = ( array\_key\_exists( 'mailarchiver\_archiver\_privacy\_name', $\_POST ) ? true : false ); |
  | 575 | 576 | $this->current\_archiver['privacy']['mailanonymization'] = ( array\_key\_exists( 'mailarchiver\_archiver\_privacy\_mail', $\_POST ) ? true : false ); |
  |  | 577 | $this->current\_archiver['security']['xss']Â  Â  Â  Â  Â  Â  Â  = ( array\_key\_exists( 'mailarchiver\_archiver\_security\_xss', $\_POST ) ? true : false ); |
  | 576 | 578 | $this->current\_archiver['privacy']['encryption']Â  Â  Â  Â  = ( array\_key\_exists( 'mailarchiver\_archiver\_privacy\_encryption', $\_POST ) ? Secret::set( filter\_input( INPUT\_POST, 'mailarchiver\_archiver\_privacy\_encryption', FILTER\_UNSAFE\_RAW ) ) : '' ); |
  | 577 | 579 | $this->current\_archiver['processors']Â  Â  Â  Â  Â  Â  Â  Â  Â  Â = []; |
  | [â€¦](/browser/mailarchiver/trunk/admin/class-mailarchiver-admin.php?rev=2873845#L1126) | [â€¦](/browser/mailarchiver/trunk/admin/class-mailarchiver-admin.php?rev=2937545#L1128) |  |
  | 1126 | 1128 |  |
  | 1127 | 1129 | /\*\* |
  |  | 1130 | \* Callback for archiver security section. |
  |  | 1131 | \* |
  |  | 1132 | \* @since 2.11.0 |
  |  | 1133 | \*/ |
  |  | 1134 | public function archiver\_security\_section\_callback() { |
  |  | 1135 | $form = new Form(); |
  |  | 1136 | add\_settings\_field( |
  |  | 1137 | 'mailarchiver\_archiver\_security\_xss', |
  |  | 1138 | \_\_( 'XSS', 'mailarchiver' ), |
  |  | 1139 | [ $form, 'echo\_field\_checkbox' ], |
  |  | 1140 | 'mailarchiver\_archiver\_security\_section', |
  |  | 1141 | 'mailarchiver\_archiver\_security\_section', |
  |  | 1142 | [ |
  |  | 1143 | 'text'Â  Â  Â  Â  => esc\_html\_\_( 'Script removal', 'mailarchiver' ), |
  |  | 1144 | 'id'Â  Â  Â  Â  Â  => 'mailarchiver\_archiver\_security\_xss', |
  |  | 1145 | 'checked'Â  Â  Â => $this->current\_archiver['security']['xss'], |
  |  | 1146 | 'description' => esc\_html\_\_( 'If checked, all scripts will be removed from subject and content fields.', 'mailarchiver' ), |
  |  | 1147 | 'full\_width'Â  => false, |
  |  | 1148 | 'enabled'Â  Â  Â => true, |
  |  | 1149 | ] |
  |  | 1150 | ); |
  |  | 1151 | register\_setting( 'mailarchiver\_archiver\_security\_section', 'mailarchiver\_archiver\_security\_xss' ); |
  |  | 1152 | } |
  |  | 1153 |  |
  |  | 1154 | /\*\* |
  | 1128 | 1155 | \* Callback for archiver privacy section. |
  | 1129 | 1156 | \* |
* ## [mailarchiver/trunk/admin/partials/mailarchiver-admin-settings-archiver-edit.php](/changeset/2937545/mailarchiver/trunk/admin/partials/mailarchiver-admin-settings-archiver-edit.php "Show the changeset 2937545 restricted to mailarchiver/trunk/admin/partials/mailarchiver-admin-settings-archiver-edit.php")

  | [r2606924](/browser/mailarchiver/trunk/admin/partials/mailarchiver-admin-settings-archiver-edit.php?rev=2606924#L33 "Show revision 2606924 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/admin/partials/mailarchiver-admin-settings-archiver-edit.php?rev=2937545#L33 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 33 | 33 | <?php if ( in\_array( $current\_handler['class'], [ 'alerting', 'logging', 'storing' ], true ) ) { ?> |
  | 34 | 34 | <?php do\_settings\_sections( 'mailarchiver\_archiver\_privacy\_section' ); ?> |
  |  | 35 | <?php do\_settings\_sections( 'mailarchiver\_archiver\_security\_section' ); ?> |
  | 35 | 36 | <?php do\_settings\_sections( 'mailarchiver\_archiver\_details\_section' ); ?> |
  | 36 | 37 | <?php } ?> |
* ## [mailarchiver/trunk/functions.php](/changeset/2937545/mailarchiver/trunk/functions.php "Show the changeset 2937545 restricted to mailarchiver/trunk/functions.php")

  | [r2640285](/browser/mailarchiver/trunk/functions.php?rev=2640285#L394 "Show revision 2640285 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/functions.php?rev=2937545#L394 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 394 | 394 | } |
  | 395 | 395 |  |
  |  | 396 | /\*\* |
  |  | 397 | \* Properly strips script tags including |
  |  | 398 | \* |
  |  | 399 | \* This differs from strip\_tags() because it removes the contents of |
  |  | 400 | \* the `<script>` and `<style>` tags. E.g. `strip\_tags( '<script>something</script>' )` |
  |  | 401 | \* will return 'something'. wp\_strip\_all\_tags will return '' |
  |  | 402 | \* |
  |  | 403 | \* @since 2.11.0 |
  |  | 404 | \* |
  |  | 405 | \* @param string $textÂ  Â  Â  Â  Â  String containing HTML tags |
  |  | 406 | \* @param boolÂ  Â $remove\_breaks Optional. Whether to remove left over line breaks and white space chars |
  |  | 407 | \* @return string The processed string. |
  |  | 408 | \*/ |
  |  | 409 | function mailarchiver\_strip\_script\_tags( $text, $remove\_breaks = false ) { |
  |  | 410 | if ( is\_null( $text ) ) { |
  |  | 411 | return ''; |
  |  | 412 | } |
  |  | 413 |  |
  |  | 414 | if ( ! is\_scalar( $text ) ) { |
  |  | 415 | /\* |
  |  | 416 | \* To maintain consistency with pre-PHP 8 error levels, |
  |  | 417 | \* trigger\_error() is used to trigger an E\_USER\_WARNING, |
  |  | 418 | \* rather than \_doing\_it\_wrong(), which triggers an E\_USER\_NOTICE. |
  |  | 419 | \*/ |
  |  | 420 | trigger\_error( |
  |  | 421 | sprintf( |
  |  | 422 | /\* translators: 1: The function name, 2: The argument number, 3: The argument name, 4: The expected type, 5: The provided type. \*/ |
  |  | 423 | \_\_( 'Warning: %1$s expects parameter %2$s (%3$s) to be a %4$s, %5$s given.' ), |
  |  | 424 | \_\_FUNCTION\_\_, |
  |  | 425 | '#1', |
  |  | 426 | '$text', |
  |  | 427 | 'string', |
  |  | 428 | gettype( $text ) |
  |  | 429 | ), |
  |  | 430 | E\_USER\_WARNING |
  |  | 431 | ); |
  |  | 432 |  |
  |  | 433 | return ''; |
  |  | 434 | } |
  |  | 435 |  |
  |  | 436 | $text = preg\_replace( '@<(script)[^>]\*?>.\*?</\\1>@si', '', $text ); |
  |  | 437 |  |
  |  | 438 | if ( $remove\_breaks ) { |
  |  | 439 | $text = preg\_replace( '/[\r\n\t ]+/', ' ', $text ); |
  |  | 440 | } |
  |  | 441 |  |
  |  | 442 | return trim( $text ); |
  |  | 443 | } |
  |  | 444 |  |
  | 396 | 445 |  |
  | 397 | 446 | /\*\* |
* ## [mailarchiver/trunk/includes/features/class-archiverfactory.php](/changeset/2937545/mailarchiver/trunk/includes/features/class-archiverfactory.php "Show the changeset 2937545 restricted to mailarchiver/trunk/includes/features/class-archiverfactory.php")

  | [r2606924](/browser/mailarchiver/trunk/includes/features/class-archiverfactory.php?rev=2606924#L131 "Show revision 2606924 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/includes/features/class-archiverfactory.php?rev=2937545#L131 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 131 | 131 | } |
  | 132 | 132 | break; |
  |  | 133 | case 'security': |
  |  | 134 | $args[] = (bool) $archiver['security'][ $p['value'] ]; |
  |  | 135 | break; |
  | 133 | 136 | case 'literal': |
  | 134 | 137 | $args[] = $p['value']; |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-archiverfactory.php?rev=2606924#L162) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-archiverfactory.php?rev=2937545#L165) |  |
  | 162 | 165 | $archiver = $this->privacy\_check( $archiver ); |
  | 163 | 166 | } |
  |  | 167 | if ( $handler && in\_array( 'security', $handler['params'], true ) ) { |
  |  | 168 | $archiver = $this->security\_check( $archiver ); |
  |  | 169 | } |
  | 164 | 170 | if ( $handler && in\_array( 'processors', $handler['params'], true ) ) { |
  | 165 | 171 | $archiver = $this->processor\_check( $archiver ); |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-archiverfactory.php?rev=2606924#L284) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-archiverfactory.php?rev=2937545#L290) |  |
  | 284 | 290 | $archiver['privacy']['mailanonymization'] = false; |
  | 285 | 291 | $archiver['privacy']['encryption']Â  Â  Â  Â  = ''; |
  |  | 292 | } |
  |  | 293 | return $archiver; |
  |  | 294 | } |
  |  | 295 |  |
  |  | 296 | /\*\* |
  |  | 297 | \* Check the security part of the archiver. |
  |  | 298 | \* |
  |  | 299 | \* @paramÂ  Â array $archiverÂ  The archiver definition. |
  |  | 300 | \* @returnÂ  arrayÂ  Â The checked archiver definition. |
  |  | 301 | \* @sinceÂ  Â  2.11.0 |
  |  | 302 | \*/ |
  |  | 303 | private function security\_check( $archiver ) { |
  |  | 304 | if ( array\_key\_exists( 'security', $archiver ) ) { |
  |  | 305 | if ( ! array\_key\_exists( 'xss', $archiver['security'] ) ) { |
  |  | 306 | $archiver['security']['xss'] = true; |
  |  | 307 | } |
  |  | 308 | } else { |
  |  | 309 | $archiver['security']['xss'] = true; |
  | 286 | 310 | } |
  | 287 | 311 | return $archiver; |
* ## [mailarchiver/trunk/includes/features/class-archivermaintainer.php](/changeset/2937545/mailarchiver/trunk/includes/features/class-archivermaintainer.php "Show the changeset 2937545 restricted to mailarchiver/trunk/includes/features/class-archivermaintainer.php")

  | [r2640285](/browser/mailarchiver/trunk/includes/features/class-archivermaintainer.php?rev=2640285#L125 "Show revision 2640285 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/includes/features/class-archivermaintainer.php?rev=2937545#L125 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 125 | 125 | } |
  | 126 | 126 | } |
  |  | 127 | $security = []; |
  |  | 128 | foreach ( $logger['security'] as $i => $item ) { |
  |  | 129 | if ( $item ) { |
  |  | 130 | $security[] = $i; |
  |  | 131 | } |
  |  | 132 | } |
  | 127 | 133 | $logger['privacy']Â  Â  = '[' . implode(', ', $privacy ) . ']'; |
  |  | 134 | $logger['security']Â  Â = '[' . implode(', ', $security ) . ']'; |
  | 128 | 135 | $logger['processors'] = '[' . implode(', ', $logger['processors'] ) . ']'; |
  | 129 | 136 | $configurationÂ  Â  Â  Â  = []; |
* ## [mailarchiver/trunk/includes/features/class-archivers.php](/changeset/2937545/mailarchiver/trunk/includes/features/class-archivers.php "Show the changeset 2937545 restricted to mailarchiver/trunk/includes/features/class-archivers.php")

  | [r2712816](/browser/mailarchiver/trunk/includes/features/class-archivers.php?rev=2712816#L13 "Show revision 2712816 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/includes/features/class-archivers.php?rev=2937545#L13 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 |  |
  | 14 | 14 | use Mailarchiver\Plugin\Feature\PrivacyOptions; |
  |  | 15 | use Mailarchiver\Plugin\Feature\SecurityOptions; |
  | 15 | 16 | use Mailarchiver\System\Option; |
  | 16 | 17 | use Mailarchiver\Plugin\Feature\Archive; |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-archivers.php?rev=2712816#L217) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-archivers.php?rev=2937545#L218) |  |
  | 217 | 218 | if ( $item['privacy'][$option] ) { |
  | 218 | 219 | $result .= '<img alt="' . PrivacyOptions::$options\_names[ $option ] . '" title="' . PrivacyOptions::$options\_names[ $option ] . '" style="width:16px;padding-left:6px;padding-top:6px;" src="' . Icons::get\_base64( PrivacyOptions::$options\_icons[ $option ], 'none', '#9999BB' ) . '" />'; |
  |  | 220 | } |
  |  | 221 | } |
  |  | 222 | foreach ( SecurityOptions::$options as $option ) { |
  |  | 223 | if ( $item['security'][$option] ) { |
  |  | 224 | $result .= '<img alt="' . SecurityOptions::$options\_names[ $option ] . '" title="' . SecurityOptions::$options\_names[ $option ] . '" style="width:16px;padding-left:6px;padding-top:6px;" src="' . Icons::get\_base64( SecurityOptions::$options\_icons[ $option ], 'none', '#9999BB' ) . '" />'; |
  | 219 | 225 | } |
  | 220 | 226 | } |
* ## [mailarchiver/trunk/includes/features/class-events.php](/changeset/2937545/mailarchiver/trunk/includes/features/class-events.php "Show the changeset 2937545 restricted to mailarchiver/trunk/includes/features/class-events.php")

  | [r2658583](/browser/mailarchiver/trunk/includes/features/class-events.php?rev=2658583#L157 "Show revision 2658583 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/includes/features/class-events.php?rev=2937545#L157 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 157 | 157 | $urlÂ  Â  Â  Â  Â  Â  Â = add\_query\_arg( $args, admin\_url( 'admin.php' ) ); |
  | 158 | 158 | $iconÂ  Â  Â  Â  Â  Â  = '<img style="width:18px;float:left;padding-right:6px;" src="' . EventTypes::$icons[ $item['level'] ] . '" />'; |
  | 159 |  | $nameÂ  Â  Â  Â  Â  Â  = '<a href="' . $url . '">' . ~~$item['subject']~~ . '</a>'; |
  |  | 159 | $nameÂ  Â  Â  Â  Â  Â  = '<a href="' . $url . '">' . mailarchiver\_strip\_script\_tags( $item['subject'], true ) . '</a>'; |
  | 160 | 160 | $resultÂ  Â  Â  Â  Â  = $icon . $name; |
  | 161 | 161 | return $result; |
* ## [mailarchiver/trunk/includes/features/class-eventviewer.php](/changeset/2937545/mailarchiver/trunk/includes/features/class-eventviewer.php "Show the changeset 2937545 restricted to mailarchiver/trunk/includes/features/class-eventviewer.php")

  | [r2606924](/browser/mailarchiver/trunk/includes/features/class-eventviewer.php?rev=2606924#L132 "Show revision 2606924 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/includes/features/class-eventviewer.php?rev=2937545#L132 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 132 | 132 | } else { |
  | 133 | 133 | $content = str\_replace( '"', '\"', $content ); |
  | 134 |  | $content = str\_replace( "\r\n", "<br~~/~~>", $content ); |
  | 135 |  | $content = str\_replace( "\n", "<br~~/~~>", $content ); |
  | 136 |  | $content = str\_replace( "\r", "<br~~/~~>", $content ); |
  | 137 |  | $content = str\_replace( "\t", "", $content ); |
  |  | 134 | $content = str\_replace( "\r\n", "<br>", $content ); |
  |  | 135 | $content = str\_replace( "\n", "<br>", $content ); |
  |  | 136 | $content = str\_replace( "\r", "<br>", $content ); |
  |  | 137 | $content = str\_replace( "\t", "<br>", $content ); |
  | 138 | 138 | $content = '<html><body style=\"padding:10px;font-family:\'Lucida Console\', Monaco, monospace;font-size: 14px;background-color:#F1F1F1;\">' . $content . '</body></html>'; |
  | 139 | 139 | } |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-eventviewer.php?rev=2606924#L148) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-eventviewer.php?rev=2937545#L148) |  |
  | 148 | 148 | $content = str\_replace( '\\', '\\\\', $content ); |
  | 149 | 149 | $content = str\_replace( '"', '\"', $content ); |
  | 150 |  | ~~$content = str\_replace( "\r\n", " ", $content );~~ |
  | 151 |  | ~~$content = str\_replace( "\n", " ", $content );~~ |
  | 152 |  | ~~$content = str\_replace( "\r", " ", $content );~~ |
  | 153 |  | ~~$content = str\_replace( "\t", " ", $content );~~ |
  | 154 | 150 | while ( false !== strpos( $content, 'Â  ' ) ) { |
  | 155 | 151 | $content = str\_replace("Â  ", " ", $content); |
  | 156 | 152 | } |
  | 157 | 153 | } |
  | 158 |  | $this->body = ~~$content~~; |
  |  | 154 | $this->body = mailarchiver\_strip\_script\_tags( $content, $is\_html ); |
  | 159 | 155 | } |
  | 160 | 156 |  |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-eventviewer.php?rev=2606924#L245) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-eventviewer.php?rev=2937545#L241) |  |
  | 245 | 241 | if ( isset( $this->event ) ) { |
  | 246 | 242 | $icon = '<img style="width:30px;float:left;padding-right:8px;" src="' . EventTypes::$icons[ $this->event['level'] ] . '" />'; |
  | 247 |  | $name = ~~$this->event['subject']~~; |
  |  | 243 | $name = mailarchiver\_strip\_script\_tags( $this->event['subject'], true ); |
  | 248 | 244 | // phpcs:ignore |
  | 249 | 245 | echo '<h2>' . $icon . $name . '</h2>'; |
* ## [mailarchiver/trunk/includes/features/class-handlertypes.php](/changeset/2937545/mailarchiver/trunk/includes/features/class-handlertypes.php "Show the changeset 2937545 restricted to mailarchiver/trunk/includes/features/class-handlertypes.php")

  | [r2640285](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L68 "Show revision 2640285 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L68 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 68 | 68 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'A mail copy sent to Litmus service.', 'mailarchiver' ), |
  | 69 | 69 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_litmus\_icon(), |
  | 70 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 70 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 71 | 71 | 'configuration' => [ |
  | 72 | 72 | 'box'Â  Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L122) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L122) |  |
  | 122 | 122 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'A mail copy sent to Email on Acid service.', 'mailarchiver' ), |
  | 123 | 123 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_eoa\_icon(), |
  | 124 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 124 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 125 | 125 | 'configuration' => [ |
  | 126 | 126 | 'box'Â  Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L176) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L176) |  |
  | 176 | 176 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'A mail copy sent to MailerCheck service.', 'mailarchiver' ), |
  | 177 | 177 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_mailercheck\_icon(), |
  | 178 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 178 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 179 | 179 | 'configuration' => [ |
  | 180 | 180 | 'box'Â  Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L217) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L217) |  |
  | 217 | 217 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'A mail copy sent to an email address.', 'mailarchiver' ), |
  | 218 | 218 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_mail\_icon(), |
  | 219 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 219 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 220 | 220 | 'configuration' => [ |
  | 221 | 221 | 'box'Â  Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L256) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L256) |  |
  | 256 | 256 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'An archive sent to a Fluentd collector.', 'mailarchiver' ), |
  | 257 | 257 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_fluentd\_icon(), |
  | 258 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 258 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 259 | 259 | 'configuration' => [ |
  | 260 | 260 | 'host'Â  Â  => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L312) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L312) |  |
  | 312 | 312 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'An archive sent to Logentries & insightOps service.', 'mailarchiver' ), |
  | 313 | 313 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_logentries\_icon(), |
  | 314 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 314 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 315 | 315 | 'configuration' => [ |
  | 316 | 316 | 'host'Â  Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L381) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L381) |  |
  | 381 | 381 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'An archive sent to Solawinds Loggly service.', 'mailarchiver' ), |
  | 382 | 382 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_loggly\_icon(), |
  | 383 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 383 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 384 | 384 | 'configuration' => [ |
  | 385 | 385 | 'token' => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L414) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L414) |  |
  | 414 | 414 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'An archive sent to a remote syslogd server.', 'mailarchiver' ), |
  | 415 | 415 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_syslog\_icon(), |
  | 416 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 416 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 417 | 417 | 'configuration' => [ |
  | 418 | 418 | 'host'Â  Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L532) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L532) |  |
  | 532 | 532 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_grafana\_icon(), |
  | 533 | 533 | 'needs'Â  Â  Â  Â  Â => [], |
  | 534 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 534 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 535 | 535 | 'configuration' => [ |
  | 536 | 536 | 'host'Â  => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L630) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L630) |  |
  | 630 | 630 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_loki\_icon(), |
  | 631 | 631 | 'needs'Â  Â  Â  Â  Â => [], |
  | 632 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 632 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 633 | 633 | 'configuration' => [ |
  | 634 | 634 | 'url'Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L698) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L698) |  |
  | 698 | 698 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'Emails in error signaled to Pushover service.', 'mailarchiver' ), |
  | 699 | 699 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_pushover\_icon(), |
  | 700 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 700 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 701 | 701 | 'configuration' => [ |
  | 702 | 702 | 'token' => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L782) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L782) |  |
  | 782 | 782 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'Emails in error signaled through Slack Webhooks.', 'mailarchiver' ), |
  | 783 | 783 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_slack\_icon(), |
  | 784 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 784 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 785 | 785 | 'configuration' => [ |
  | 786 | 786 | 'webhook' => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L925) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L925) |  |
  | 925 | 925 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'An archive sent to files that are rotated every day and a limited number of files are kept.', 'mailarchiver' ), |
  | 926 | 926 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_rotatingfiles\_icon(), |
  | 927 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 927 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 928 | 928 | 'configuration' => [ |
  | 929 | 929 | 'filename' => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L986) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L986) |  |
  | 986 | 986 | 'help'Â  Â  Â  Â  Â  => esc\_html\_\_( 'An archive stored in your WordPress database and available right in your admin dashboard.', 'mailarchiver' ), |
  | 987 | 987 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_wordpress\_icon(), |
  | 988 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 988 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 989 | 989 | 'configuration' => [ |
  | 990 | 990 | 'rotate' => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1054) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L1054) |  |
  | 1054 | 1054 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_elasticcloud\_icon(), |
  | 1055 | 1055 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1056 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1056 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1057 | 1057 | 'configuration' => [ |
  | 1058 | 1058 | 'cloudid' => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1139) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L1139) |  |
  | 1139 | 1139 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_elasticsearch\_icon(), |
  | 1140 | 1140 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1141 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1141 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1142 | 1142 | 'configuration' => [ |
  | 1143 | 1143 | 'url'Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1225) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L1225) |  |
  | 1225 | 1225 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_imap\_icon(), |
  | 1226 | 1226 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1227 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1227 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1228 | 1228 | 'configuration' => [ |
  | 1229 | 1229 | 'url'Â  Â => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1346) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L1346) |  |
  | 1346 | 1346 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_gmail\_icon(), |
  | 1347 | 1347 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1348 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1348 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1349 | 1349 | 'configuration' => [ |
  | 1350 | 1350 | 'user'Â  => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1400) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L1400) |  |
  | 1400 | 1400 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_ovh\_icon(), |
  | 1401 | 1401 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1402 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1402 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1403 | 1403 | 'configuration' => [ |
  | 1404 | 1404 | 'user'Â  => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1454) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L1454) |  |
  | 1454 | 1454 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_gandi\_icon(), |
  | 1455 | 1455 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1456 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1456 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1457 | 1457 | 'configuration' => [ |
  | 1458 | 1458 | 'user'Â  => [ |
  | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2640285#L1508) | [â€¦](/browser/mailarchiver/trunk/includes/features/class-handlertypes.php?rev=2937545#L1508) |  |
  | 1508 | 1508 | 'icon'Â  Â  Â  Â  Â  => $this->get\_base64\_microsoft\_icon(), |
  | 1509 | 1509 | 'needs'Â  Â  Â  Â  Â => [], |
  | 1510 |  | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy' ], |
  |  | 1510 | 'params'Â  Â  Â  Â  => [ 'processors', 'privacy', 'security' ], |
  | 1511 | 1511 | 'configuration' => [ |
  | 1512 | 1512 | 'user'Â  => [ |
* ## [mailarchiver/trunk/includes/features/class-processortypes.php](/changeset/2937545/mailarchiver/trunk/includes/features/class-processortypes.php "Show the changeset 2937545 restricted to mailarchiver/trunk/includes/features/class-processortypes.php")

  | [r2400372](/browser/mailarchiver/trunk/includes/features/class-processortypes.php?rev=2400372#L72 "Show revision 2400372 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/includes/features/class-processortypes.php?rev=2937545#L72 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 72 | 72 | ], |
  | 73 | 73 | [ |
  |  | 74 | 'type'Â  => 'security', |
  |  | 75 | 'value' => 'xss', |
  |  | 76 | ], |
  |  | 77 | [ |
  | 74 | 78 | 'type'Â  => 'privacy', |
  | 75 | 79 | 'value' => 'encryption', |
* ## [mailarchiver/trunk/includes/processors/class-mailprocessor.php](/changeset/2937545/mailarchiver/trunk/includes/processors/class-mailprocessor.php "Show the changeset 2937545 restricted to mailarchiver/trunk/includes/processors/class-mailprocessor.php")

  | [r2606924](/browser/mailarchiver/trunk/includes/processors/class-mailprocessor.php?rev=2606924#L37 "Show revision 2606924 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/includes/processors/class-mailprocessor.php?rev=2937545#L37 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 37 | 37 |  |
  | 38 | 38 | /\*\* |
  |  | 39 | \* Xss filtering switch. |
  |  | 40 | \* |
  |  | 41 | \* @sinceÂ  2.11.0 |
  |  | 42 | \* @varÂ  Â  booleanÂ  Â  $xssÂ  Â  Is xss filtering activated? |
  |  | 43 | \*/ |
  |  | 44 | private $xss = false; |
  |  | 45 |  |
  |  | 46 | /\*\* |
  | 39 | 47 | \* Encryption key. |
  | 40 | 48 | \* |
  | [â€¦](/browser/mailarchiver/trunk/includes/processors/class-mailprocessor.php?rev=2606924#L49) | [â€¦](/browser/mailarchiver/trunk/includes/processors/class-mailprocessor.php?rev=2937545#L57) |  |
  | 49 | 57 | \* @sinceÂ  Â 1.0.0 |
  | 50 | 58 | \* @paramÂ  Â boolean $mailanonymizeÂ  Optional. Is mailanonymization activated? |
  |  | 59 | \* @paramÂ  Â boolean $xssÂ  Â  Â  Â  Â  Â  Optional. Is xss filtering activated? |
  | 51 | 60 | \* @paramÂ  Â stringÂ  $encryptionÂ  Â  Â Optional. Encryption key. |
  | 52 | 61 | \*/ |
  | 53 |  | public function \_\_construct( $mailanonymize = true, $encryption = '' ) { |
  |  | 62 | public function \_\_construct( $mailanonymize = true, $xss = true, $encryption = '' ) { |
  | 54 | 63 | $this->mailanonymization = $mailanonymize; |
  | 55 | 64 | $this->encryptionÂ  Â  Â  Â  = $encryption; |
  |  | 65 | $this->xssÂ  Â  Â  Â  Â  Â  Â  Â = $xss; |
  | 56 | 66 | } |
  | 57 | 67 |  |
  | [â€¦](/browser/mailarchiver/trunk/includes/processors/class-mailprocessor.php?rev=2606924#L72) | [â€¦](/browser/mailarchiver/trunk/includes/processors/class-mailprocessor.php?rev=2937545#L82) |  |
  | 72 | 82 | $record['context']['to'] = $tos; |
  | 73 | 83 | } |
  |  | 84 | if ( $this->xss ) { |
  |  | 85 | $record['context']['subject'] = mailarchiver\_strip\_script\_tags( $record['context']['subject'] ); |
  |  | 86 | $record['context']['body']['raw']Â  = mailarchiver\_strip\_script\_tags( $record['context']['body']['raw'] ); |
  |  | 87 | $record['context']['body']['text'] = mailarchiver\_strip\_script\_tags( $record['context']['body']['text'] ); |
  |  | 88 | } |
  | 74 | 89 | if ( 0 < strlen( $this->encryption ) ) { |
  | 75 | 90 | if ( PwdProtect::is\_available() ) { |
* ## [mailarchiver/trunk/includes/system/class-sitehealth.php](/changeset/2937545/mailarchiver/trunk/includes/system/class-sitehealth.php "Show the changeset 2937545 restricted to mailarchiver/trunk/includes/system/class-sitehealth.php")

  | [r2794879](/browser/mailarchiver/trunk/includes/system/class-sitehealth.php?rev=2794879#L336 "Show revision 2794879 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/includes/system/class-sitehealth.php?rev=2937545#L336 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 336 | 336 | 'badge'Â  Â  Â  Â => [ |
  | 337 | 337 | 'label' => esc\_html\_\_( 'Performance', 'mailarchiver' ), |
  | 338 |  | 'color' => '~~orange~~', |
  |  | 338 | 'color' => 'gray', |
  | 339 | 339 | ], |
  | 340 | 340 | 'description' => sprintf( '<p>%s</p>', esc\_html\_\_( 'You should consider using shared memory (PHP shmop) to allow inter-process communication.', 'mailarchiver' ) ), |
* ## [mailarchiver/trunk/init.php](/changeset/2937545/mailarchiver/trunk/init.php "Show the changeset 2937545 restricted to mailarchiver/trunk/init.php")

  | [r2873845](/browser/mailarchiver/trunk/init.php?rev=2873845#L13 "Show revision 2873845 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/init.php?rev=2937545#L13 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 | define( 'MAILARCHIVER\_PRODUCT\_ABBREVIATION', 'mailarchiver' ); |
  | 14 | 14 | define( 'MAILARCHIVER\_SLUG', 'mailarchiver' ); |
  | 15 |  | define( 'MAILARCHIVER\_VERSION', '2.1~~0.1~~' ); |
  |  | 15 | define( 'MAILARCHIVER\_VERSION', '2.11.0' ); |
  | 16 | 16 | define( 'MAILARCHIVER\_MONOLOG\_VERSION', '2.9.1' ); |
  | 17 | 17 | define( 'MAILARCHIVER\_CODENAME', '"-"' ); |
* ## [mailarchiver/trunk/mailarchiver.php](/changeset/2937545/mailarchiver/trunk/mailarchiver.php "Show the changeset 2937545 restricted to mailarchiver/trunk/mailarchiver.php")

  | [r2873845](/browser/mailarchiver/trunk/mailarchiver.php?rev=2873845#L11 "Show revision 2873845 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/mailarchiver.php?rev=2937545#L11 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | \* Plugin URI:Â  Â  Â  Â  https://perfops.one/mailarchiver |
  | 12 | 12 | \* Description:Â  Â  Â  Â Automatically archive and store all emails sent from your site. |
  | 13 |  | \* Version:Â  Â  Â  Â  Â  Â 2.1~~0.1~~ |
  |  | 13 | \* Version:Â  Â  Â  Â  Â  Â 2.11.0 |
  | 14 | 14 | \* Requires at least: 5.2 |
  | 15 | 15 | \* Requires PHP:Â  Â  Â  7.2 |
* ## [mailarchiver/trunk/readme.txt](/changeset/2937545/mailarchiver/trunk/readme.txt "Show the changeset 2937545 restricted to mailarchiver/trunk/readme.txt")

  | [r2873845](/browser/mailarchiver/trunk/readme.txt?rev=2873845#L4 "Show revision 2873845 of this file in browser") | [r2937545](/browser/mailarchiver/trunk/readme.txt?rev=2937545#L4 "Show revision 2937545 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 5.2 |
  | 5 | 5 | Requires PHP: 7.2 |
  | 6 |  | Tested up to: 6.~~2~~ |
  | 7 |  | Stable tag: 2.1~~0.1~~ |
  |  | 6 | Tested up to: 6.3 |
  |  | 7 | Stable tag: 2.11.0 |
  | 8 | 8 | License: GPLv3 |
  | 9 | 9 | License URI: https://www.gnu.org/licenses/gpl-3.0.html |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2937545)
* [Zip Archive](?format=zip&new=2937545)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_b3b3f7f0_20250115_190109.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel) Â Â >Â Â   [Vulnerability Researchers](https://www.wordfence.com/threat-intel/vulnerabilities/researchers) Â Â >Â Â  Alex Thomas

![](https://www.gravatar.com/avatar/01c3929fe6b851d3cf7bda3c0215f691.jpg?r=g&d=mp&s=300)

# Alex Thomas

## Organization: Wordfence

51
All Time Ranking

71
All Time Discoveries

0
90 Day Published Submissions

N/A
Last Published Submission

## About

Senior Vulnerability Researcher @Wordfence, OSCP & GPEN

## 1 Achievement

[Learn more about Achievements](https://www.wordfence.com/threat-intel/bug-bounty-program/achievements)

![Wordfence Vulnerability Researcher](https://www.wordfence.com/achievements/585b426e1fff6dfcf39811f4287d163a.svg)

**Wordfence Vulnerability Researcher**

November 8, 2023

[Learn more](https://www.wordfence.com/threat-intel/bug-bounty-program/achievements)
[Learn more about Achievements](https://www.wordfence.com/threat-intel/bug-bounty-program/achievements)

![]()

#

Close

## Showing 1-20 of 71 Vulnerabilities

[Radio Player <= 2.0.73 - Missing Authorization to Player Deletion](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/radio-player/radio-player-2073-missing-authorization-to-player-deletion)

5.3

[CVE-2023-4024](https://www.cve.org/CVERecord?id=CVE-2023-4024)

Aug 16, 2024

[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N)

[Radio Player <= 2.0.73 - Missing Authorization to Player Update](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/radio-player/radio-player-2073-missing-authorization-to-player-update)

5.3

[CVE-2023-4025](https://www.cve.org/CVERecord?id=CVE-2023-4025)

Aug 16, 2024

[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N)

[Radio Player <= 2.0.73 - Missing Authorization to Settings Update](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/radio-player/radio-player-2073-missing-authorization-to-settings-update)

5.3

[CVE-2023-4027](https://www.cve.org/CVERecord?id=CVE-2023-4027)

Aug 16, 2024

[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N)

[Popup Builder <= 4.3.0 - Missing Authorization in Multiple AJAX Actions](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/popup-builder/popup-builder-430-missing-authorization-in-multiple-ajax-actions)

7.4

[CVE-2024-2544](https://www.cve.org/CVERecord?id=CVE-2024-2544)

Jun 14, 2024

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L)

[Content Blocks (Custom Post Widget) <= 3.3.0 - Authenticated (Contributor+) Stored Cross-Site Scripting via content\_block Shortcode](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/custom-post-widget/content-blocks-custom-post-widget-330-authenticated-contributor-stored-cross-site-scripting-via-content-block-shortcode)

6.4

[CVE-2024-3565](https://www.cve.org/CVERecord?id=CVE-2024-3565)

May 31, 2024

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

[Shortcodes and extra features for Phlox theme <= 2.15.7 - Authenticated (Contributor+) Stored Cross-Site Scripting via 'title\_tag'](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/auxin-elements/shortcodes-and-extra-features-for-phlox-theme-2155-authenticated-contributor-stored-cross-site-scripting-via-title-tag)

6.4

[CVE-2024-1396](https://www.cve.org/CVERecord?id=CVE-2024-1396)

Apr 15, 2024

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

[HT Mega <= 2.4.6 - Authenticated (Contributor+) Stored Cross-Site Scripting via titleTag](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/ht-mega-for-elementor/ht-mega-246-authenticated-contributor-stored-cross-site-scripting-via-titletag)

6.4

[CVE-2024-1397](https://www.cve.org/CVERecord?id=CVE-2024-1397)

Mar 12, 2024

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

[Export WP Page to Static HTML/CSS <= 2.1.9 - Missing Authorization via Multiple AJAX Actions](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/export-wp-page-to-static-html/export-wp-page-to-static-htmlcss-219-missing-authorization-via-multiple-ajax-actions)

5.4

[CVE-2023-6369](https://www.cve.org/CVERecord?id=CVE-2023-6369)

Nov 28, 2023

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N)

[Ziteboard Online Whiteboard <= 2.9.9 - Authenticated (Contributor+) Stored Cross-Site Scripting via ziteboard Shortcode](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/ziteboard-online-whiteboard/ziteboard-online-whiteboard-299-authenticated-contributor-stored-cross-site-scripting-via-ziteboard-shortcode)

6.4

[CVE-2023-5076](https://www.cve.org/CVERecord?id=CVE-2023-5076)

Nov 6, 2023

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

[Funnelforms Free <= 3.4 - Missing Authorization to Arbitrary Post Deletion](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-arbitrary-post-deletion)

6.5

[CVE-2023-5386](https://www.cve.org/CVERecord?id=CVE-2023-5386)

Nov 1, 2023

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N)

[Funnelforms Free <= 3.4 - Missing Authorization to Post Modification](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-post-modification)

4.3

[CVE-2023-5411](https://www.cve.org/CVERecord?id=CVE-2023-5411)

Nov 1, 2023

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

[Funnelforms Free <= 3.4 - Missing Authorization to Test Email Sending](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-test-email-sending)

4.3

[CVE-2023-5419](https://www.cve.org/CVERecord?id=CVE-2023-5419)

Nov 1, 2023

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

[Funnelforms Free <= 3.4 - Missing Authorization to Enable/Disable Dark Mode](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-enabledisable-dark-mode)

4.3

[CVE-2023-5387](https://www.cve.org/CVERecord?id=CVE-2023-5387)

Nov 1, 2023

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

[Funnelforms Free <= 3.4 - Missing Authorization to New Category Creation](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-new-category-creation)

4.3

[CVE-2023-5415](https://www.cve.org/CVERecord?id=CVE-2023-5415)

Nov 1, 2023

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

[Funnelforms Free <= 3.4 - Missing Authorization to Category Deletion](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-category-deletion)

4.3

[CVE-2023-5416](https://www.cve.org/CVERecord?id=CVE-2023-5416)

Nov 1, 2023

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

[Funnelforms Free <= 3.4 - Missing Authorization to Category Update](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-category-update)

4.3

[CVE-2023-5417](https://www.cve.org/CVERecord?id=CVE-2023-5417)

Nov 1, 2023

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

[Funnelforms Free <= 3.4 - Missing Authorization to Arbitrary Post Duplication](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-arbitrary-post-duplication)

4.3

[CVE-2023-5385](https://www.cve.org/CVERecord?id=CVE-2023-5385)

Nov 1, 2023

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

[Icons Font Loader <= 1.1.2 - Authenticated (Administrator+) Arbitrary File Upload](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/icons-font-loader/icons-font-loader-112-authenticated-administrator-arbitrary-file-upload)

7.2

[CVE-2023-5860](https://www.cve.org/CVERecord?id=CVE-2023-5860)

Nov 1, 2023

[CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H)

[HTML filter and csv-file search <= 2.7 - Authenticated (Contributor+) Local File Inclusion via Shortcode](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/hk-filter-and-search/html-filter-and-csv-file-search-27-authenticated-contributor-local-file-inclusion-via-shortcode)

8.8

[CVE-2023-5099](https://www.cve.org/CVERecord?id=CVE-2023-5099)

Oct 30, 2023

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

[HTML filter and csv-file search <= 2.7 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/hk-filter-and-search/html-filter-and-csv-file-search-27-authenticated-contributor-stored-cross-site-scripting-via-shortcode)

6.4

[CVE-2023-5096](https://www.cve.org/CVERecord?id=CVE-2023-5096)

Oct 30, 2023

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| Title | CVE ID | [CVSS](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/alex-thomas?sortby=cvss_score&sort=desc#jump) | Vector | [Date](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/alex-thomas?sortby=date&sort=desc#jump) |
| --- | --- | --- | --- | --- |
| [Radio Player <= 2.0.73 - Missing Authorization to Player Deletion](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/radio-player/radio-player-2073-missing-authorization-to-player-deletion) | [CVE-2023-4024](https://www.cve.org/CVERecord?id=CVE-2023-4024) | 5.3 | [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N) | August 16, 2024 |
| [Radio Player <= 2.0.73 - Missing Authorization to Player Update](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/radio-player/radio-player-2073-missing-authorization-to-player-update) | [CVE-2023-4025](https://www.cve.org/CVERecord?id=CVE-2023-4025) | 5.3 | [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N) | August 16, 2024 |
| [Radio Player <= 2.0.73 - Missing Authorization to Settings Update](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/radio-player/radio-player-2073-missing-authorization-to-settings-update) | [CVE-2023-4027](https://www.cve.org/CVERecord?id=CVE-2023-4027) | 5.3 | [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N) | August 16, 2024 |
| [Popup Builder <= 4.3.0 - Missing Authorization in Multiple AJAX Actions](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/popup-builder/popup-builder-430-missing-authorization-in-multiple-ajax-actions) | [CVE-2024-2544](https://www.cve.org/CVERecord?id=CVE-2024-2544) | 7.4 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L) | June 14, 2024 |
| [Content Blocks (Custom Post Widget) <= 3.3.0 - Authenticated (Contributor+) Stored Cross-Site Scripting via content\_block Shortcode](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/custom-post-widget/content-blocks-custom-post-widget-330-authenticated-contributor-stored-cross-site-scripting-via-content-block-shortcode) | [CVE-2024-3565](https://www.cve.org/CVERecord?id=CVE-2024-3565) | 6.4 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N) | May 31, 2024 |
| [Shortcodes and extra features for Phlox theme <= 2.15.7 - Authenticated (Contributor+) Stored Cross-Site Scripting via 'title\_tag'](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/auxin-elements/shortcodes-and-extra-features-for-phlox-theme-2155-authenticated-contributor-stored-cross-site-scripting-via-title-tag) | [CVE-2024-1396](https://www.cve.org/CVERecord?id=CVE-2024-1396) | 6.4 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N) | April 15, 2024 |
| [HT Mega <= 2.4.6 - Authenticated (Contributor+) Stored Cross-Site Scripting via titleTag](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/ht-mega-for-elementor/ht-mega-246-authenticated-contributor-stored-cross-site-scripting-via-titletag) | [CVE-2024-1397](https://www.cve.org/CVERecord?id=CVE-2024-1397) | 6.4 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N) | March 12, 2024 |
| [Export WP Page to Static HTML/CSS <= 2.1.9 - Missing Authorization via Multiple AJAX Actions](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/export-wp-page-to-static-html/export-wp-page-to-static-htmlcss-219-missing-authorization-via-multiple-ajax-actions) | [CVE-2023-6369](https://www.cve.org/CVERecord?id=CVE-2023-6369) | 5.4 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N) | November 28, 2023 |
| [Ziteboard Online Whiteboard <= 2.9.9 - Authenticated (Contributor+) Stored Cross-Site Scripting via ziteboard Shortcode](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/ziteboard-online-whiteboard/ziteboard-online-whiteboard-299-authenticated-contributor-stored-cross-site-scripting-via-ziteboard-shortcode) | [CVE-2023-5076](https://www.cve.org/CVERecord?id=CVE-2023-5076) | 6.4 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N) | November 6, 2023 |
| [Funnelforms Free <= 3.4 - Missing Authorization to Arbitrary Post Deletion](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-arbitrary-post-deletion) | [CVE-2023-5386](https://www.cve.org/CVERecord?id=CVE-2023-5386) | 6.5 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N) | November 1, 2023 |
| [Funnelforms Free <= 3.4 - Missing Authorization to Post Modification](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-post-modification) | [CVE-2023-5411](https://www.cve.org/CVERecord?id=CVE-2023-5411) | 4.3 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N) | November 1, 2023 |
| [Funnelforms Free <= 3.4 - Missing Authorization to Test Email Sending](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-test-email-sending) | [CVE-2023-5419](https://www.cve.org/CVERecord?id=CVE-2023-5419) | 4.3 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N) | November 1, 2023 |
| [Funnelforms Free <= 3.4 - Missing Authorization to Enable/Disable Dark Mode](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-enabledisable-dark-mode) | [CVE-2023-5387](https://www.cve.org/CVERecord?id=CVE-2023-5387) | 4.3 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N) | November 1, 2023 |
| [Funnelforms Free <= 3.4 - Missing Authorization to New Category Creation](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-new-category-creation) | [CVE-2023-5415](https://www.cve.org/CVERecord?id=CVE-2023-5415) | 4.3 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N) | November 1, 2023 |
| [Funnelforms Free <= 3.4 - Missing Authorization to Category Deletion](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-category-deletion) | [CVE-2023-5416](https://www.cve.org/CVERecord?id=CVE-2023-5416) | 4.3 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N) | November 1, 2023 |
| [Funnelforms Free <= 3.4 - Missing Authorization to Category Update](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-category-update) | [CVE-2023-5417](https://www.cve.org/CVERecord?id=CVE-2023-5417) | 4.3 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N) | November 1, 2023 |
| [Funnelforms Free <= 3.4 - Missing Authorization to Arbitrary Post Duplication](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/funnelforms-free/funnelforms-free-34-missing-authorization-to-arbitrary-post-duplication) | [CVE-2023-5385](https://www.cve.org/CVERecord?id=CVE-2023-5385) | 4.3 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N) | November 1, 2023 |
| [Icons Font Loader <= 1.1.2 - Authenticated (Administrator+) Arbitrary File Upload](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/icons-font-loader/icons-font-loader-112-authenticated-administrator-arbitrary-file-upload) | [CVE-2023-5860](https://www.cve.org/CVERecord?id=CVE-2023-5860) | 7.2 | [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H) | November 1, 2023 |
| [HTML filter and csv-file search <= 2.7 - Authenticated (Contributor+) Local File Inclusion via Shortcode](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/hk-filter-and-search/html-filter-and-csv-file-search-27-authenticated-contributor-local-file-inclusion-via-shortcode) | [CVE-2023-5099](https://www.cve.org/CVERecord?id=CVE-2023-5099) | 8.8 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) | October 30, 2023 |
| [HTML filter and csv-file search <= 2.7 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/hk-filter-and-search/html-filter-and-csv-file-search-27-authenticated-contributor-stored-cross-site-scripting-via-shortcode) | [CVE-2023-5096](https://www.cve.org/CVERecord?id=CVE-2023-5096) | 6.4 | [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N) | October 30, 2023 |

* Â«
* â€¹
* 1
* [2](?page=2)
* [3](?page=3)
* [4](?page=4)
* [â€º](?page=2)
* [Â»](?page=4)

### Share this researcher's vulnerability discoveries

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fresearchers%2Falex-thomas&t=Alex%20Thomas "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fresearchers%2Falex-thomas&text=Alex%20Thomas "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fresearchers%2Falex-thomas "LinkedIn")
Email

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


