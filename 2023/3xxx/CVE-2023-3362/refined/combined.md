=== Content from gitlab.com_3a77f6c4_20250114_230159.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Expose of GitHub Import errors via Import::GithubController#failures

The [failures action](https://gitlab.com/gitlab-org/gitlab/-/blob/0c32936ec616e3920ae47301cbcd46eca378febd/app/controllers/import/github_controller.rb#L94-109) which was implemented in [!117133 (merged)](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/117133 "Add private endpoint to show github import errors") doesn't perform any sort of authorization which allows a malicious to access the import errors of any project imported via GitHub

<https://gitlab.com/import/github/failures?project_id=PROJECT_ID>

The endpoint exposes [these information](https://gitlab.com/gitlab-org/gitlab/-/blob/0c32936ec616e3920ae47301cbcd46eca378febd/app/serializers/import/github_failure_entity.rb#L17-46) about the import error

### Solution

The action should check if the user is the owner of the project like the [Import::GithubController#cancel\_all](https://gitlab.com/gitlab-org/gitlab/-/blob/0c32936ec616e3920ae47301cbcd46eca378febd/app/controllers/import/github_controller.rb#L120-135) does.

```
diff --git a/app/controllers/import/github_controller.rb b/app/controllers/import/github_controller.rb
index 41477519ba5e..ee6338e70e95 100644
--- a/app/controllers/import/github_controller.rb
+++ b/app/controllers/import/github_controller.rb
@@ -92,7 +92,7 @@ def realtime_changes
   end

   def failures
-    project = Project.imported_from(provider_name).find(params[:project_id])
+    project = Project.imported_from(provider_name).created_by(current_user).find(params[:project_id])

     unless project.import_finished?
       return render status: :bad_request, json: {
@@ -107,7 +107,7 @@ def failures
   end

   def cancel
-    project = Project.imported_from(provider_name).find(params[:project_id])
+    project = Project.imported_from(provider_name).created_by(current_user).find(params[:project_id])
     result = Import::Github::CancelProjectImportService.new(project, current_user).execute

     if result[:status] == :success
```

Edited Jun 13, 2023 by [Rodrigo Tomonari](/rodrigo.tomonari)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


