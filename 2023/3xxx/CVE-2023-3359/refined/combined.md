=== Content from git.kernel.org_f6d40d26_20250114_202322.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jiasheng Jiang <jiasheng@iscas.ac.cn> | 2023-01-27 10:40:06 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-01-28 14:36:28 +0100 |
| commit | [b0576ade3aaf24b376ea1a4406ae138e2a22b0c0](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0)) | |
| tree | [50d23ff70fd5c0e5a1d29f9f61d037c0b774730f](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0) | |
| parent | [2241ab53cbb5cdb08a6b2d4688feb13971058f65](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=2241ab53cbb5cdb08a6b2d4688feb13971058f65) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0&id2=2241ab53cbb5cdb08a6b2d4688feb13971058f65)) | |
| download | [linux-b0576ade3aaf24b376ea1a4406ae138e2a22b0c0.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-b0576ade3aaf24b376ea1a4406ae138e2a22b0c0.tar.gz) | |

nvmem: brcm\_nvram: Add check for kzallocAdd the check for the return value of kzalloc in order to avoid
NULL pointer dereference.
Fixes: 6e977eaa8280 ("nvmem: brcm\_nvram: parse NVRAM content into NVMEM cells")
Cc: stable@vger.kernel.org
Signed-off-by: Jiasheng Jiang <jiasheng@iscas.ac.cn>
Signed-off-by: Srinivas Kandagatla <srinivas.kandagatla@linaro.org>
Link: [https://lore.kernel.org/r/20230127104015.23839-2-srinivas.kandagatla@linaro.org](https://lore.kernel.org/r/20230127104015.23839-2-srinivas.kandagatla%40linaro.org)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0)

| -rw-r--r-- | [drivers/nvmem/brcm\_nvram.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/drivers/nvmem/brcm_nvram.c?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/drivers/nvmem/brcm\_nvram.c b/drivers/nvmem/brcm\_nvram.cindex 34130449f2d28c..39aa27942f28b3 100644--- a/[drivers/nvmem/brcm\_nvram.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/nvmem/brcm_nvram.c?id=2241ab53cbb5cdb08a6b2d4688feb13971058f65)+++ b/[drivers/nvmem/brcm\_nvram.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/nvmem/brcm_nvram.c?id=b0576ade3aaf24b376ea1a4406ae138e2a22b0c0)@@ -98,6 +98,9 @@ static int brcm\_nvram\_parse(struct brcm\_nvram \*priv) len = le32\_to\_cpu(header.len);  data = kzalloc(len, GFP\_KERNEL);+ if (!data)+ return -ENOMEM;+ memcpy\_fromio(data, priv->base, len); data[len - 1] = '\0'; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:21:59 +0000


