- **Root cause of vulnerability**: An integer underflow occurs in the `lexer_getline()` function when parsing NTRIP stream data due to repeated decrement of `lexer->inbuflen` without proper handling, leading to a large positive value after underflow. This incorrect value is then used in a `memmove()` operation, causing memory corruption.
- **Weaknesses/vulnerabilities present**: Integer underflow leading to out-of-bounds memory access/corruption.
- **Impact of exploitation**: Memory corruption leading to denial of service (crash) or potentially arbitrary code execution.
- **Attack vectors**: Sending a specially crafted HTTP response from a malicious NTRIP caster to the vulnerable GPSd client. This response does not include the expected `\r\n` delimiter, causing the vulnerable code to continue processing and triggering the integer underflow.
- **Required attacker capabilities/position**: The attacker needs to operate a malicious NTRIP caster and be able to send the malformed response to a vulnerable GPSd client. The attacker does not require authentication or prior knowledge of the system.