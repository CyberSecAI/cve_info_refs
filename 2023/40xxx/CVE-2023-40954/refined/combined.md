=== Content from github.com_b09abc20_20250114_183120.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgmarczynski%2Fodoo-web-progress%2Fcommit%2F3c867f1cf7447449c81b1aa24ebb1f7ae757489f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgmarczynski%2Fodoo-web-progress%2Fcommit%2F3c867f1cf7447449c81b1aa24ebb1f7ae757489f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=gmarczynski%2Fodoo-web-progress)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[gmarczynski](/gmarczynski)
/
**[odoo-web-progress](/gmarczynski/odoo-web-progress)**
Public

* [Notifications](/login?return_to=%2Fgmarczynski%2Fodoo-web-progress) You must be signed in to change notification settings
* [Fork
  37](/login?return_to=%2Fgmarczynski%2Fodoo-web-progress)
* [Star
   40](/login?return_to=%2Fgmarczynski%2Fodoo-web-progress)

* [Code](/gmarczynski/odoo-web-progress)
* [Issues
  12](/gmarczynski/odoo-web-progress/issues)
* [Pull requests
  3](/gmarczynski/odoo-web-progress/pulls)
* [Actions](/gmarczynski/odoo-web-progress/actions)
* [Projects
  0](/gmarczynski/odoo-web-progress/projects)
* [Security](/gmarczynski/odoo-web-progress/security)
* [Insights](/gmarczynski/odoo-web-progress/pulse)

Additional navigation options

* [Code](/gmarczynski/odoo-web-progress)
* [Issues](/gmarczynski/odoo-web-progress/issues)
* [Pull requests](/gmarczynski/odoo-web-progress/pulls)
* [Actions](/gmarczynski/odoo-web-progress/actions)
* [Projects](/gmarczynski/odoo-web-progress/projects)
* [Security](/gmarczynski/odoo-web-progress/security)
* [Insights](/gmarczynski/odoo-web-progress/pulse)

## Commit

[Permalink](/gmarczynski/odoo-web-progress/commit/3c867f1cf7447449c81b1aa24ebb1f7ae757489f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[FIX] Escape parameter of SQL query, closes [#34](https://github.com/gmarczynski/odoo-web-progress/issues/34)

[Browse files](/gmarczynski/odoo-web-progress/tree/3c867f1cf7447449c81b1aa24ebb1f7ae757489f)
Browse the repository at this point in the history

* Loading branch information

Grzegorz Marczynski
committed
Aug 10, 2023

1 parent
[bd2d5b3](/gmarczynski/odoo-web-progress/commit/bd2d5b3e0d10c704ae3557fe9e0a2db678ad7556)

commit 3c867f1

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**34 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* web\_progress

  + models

    - web\_progress/models/web\_progress.py
      [web\_progress.py](#diff-a6ed0fbaf7357291e319a84d96cb648b17f3bcc18b9014785a111cfe921c28e8)
  + tests

    - web\_progress/tests/test\_web\_progress.py
      [test\_web\_progress.py](#diff-d0f939bbe275784b14fc4ed77f6303bc185f462239c1f478dca39a69b30f924d)

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[web\_progress/models/web\_progress.py](#diff-a6ed0fbaf7357291e319a84d96cb648b17f3bcc18b9014785a111cfe921c28e8 "web_progress/models/web_progress.py")

Show comments

[View file](/gmarczynski/odoo-web-progress/blob/3c867f1cf7447449c81b1aa24ebb1f7ae757489f/web_progress/models/web_progress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -165,7 +165,7 @@ def get\_all\_progress(self, recency=\_progress\_period\_secs \* 2): |
|  |  | """ |
|  |  | query = """ |
|  |  | SELECT code, array\_agg(state) FROM web\_progress |
|  |  | WHERE create\_date > timezone('utc', now()) - INTERVAL '{recency} SECOND' |
|  |  | WHERE create\_date > timezone('utc', now()) - INTERVAL '%s SECOND' |
|  |  | AND recur\_depth = 0 {user\_id} |
|  |  | GROUP BY code |
|  |  | """.format( |
| Expand All | | @@ -175,7 +175,7 @@ def get\_all\_progress(self, recency=\_progress\_period\_secs \* 2): |
|  |  | user\_id=self.env.user.id, |
|  |  | ) or '') |
|  |  | # superuser has right to see (and cancel) progress of everybody |
|  |  | self.env.cr.execute(query) |
|  |  | self.env.cr.execute(query, (recency, )) |
|  |  | result = self.env.cr.fetchall() |
|  |  | ret = [{ |
|  |  | 'code': r[0], |
| Expand Down | |  |

33 changes: 32 additions & 1 deletion

33
[web\_progress/tests/test\_web\_progress.py](#diff-d0f939bbe275784b14fc4ed77f6303bc185f462239c1f478dca39a69b30f924d "web_progress/tests/test_web_progress.py")

Show comments

[View file](/gmarczynski/odoo-web-progress/blob/3c867f1cf7447449c81b1aa24ebb1f7ae757489f/web_progress/tests/test_web_progress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,7 @@ |
|  |  | from odoo.tests import common, tagged |
|  |  | from odoo import exceptions |
|  |  | from odoo import exceptions, api, registry |
|  |  | from odoo.tools import mute\_logger |
|  |  | from psycopg2.errors import SyntaxError |
|  |  | import uuid |
|  |  | import logging |
|  |  | from ..models.web\_progress import last\_report\_time |
| Expand Down  Expand Up | | @@ -115,3 +117,32 @@ def test\_web\_progress\_percent(self): |
|  |  | self.partner\_ids.web\_progress\_percent(0, "Start") |
|  |  | self.partner\_ids.web\_progress\_percent(50, "Middle") |
|  |  | self.partner\_ids.web\_progress\_percent(100, "End") |
|  |  |  |
|  |  |  |
|  |  | class WebProgressTestAllProgress(common.SavepointCase): |
|  |  | at\_install = True |
|  |  | post\_install = False |
|  |  |  |
|  |  | @mute\_logger('odoo.sql\_db') |
|  |  | def test\_get\_all\_progress(self): |
|  |  | """ |
|  |  | Check call to get\_all\_progress without and with parameters. |
|  |  | Verify if the parameter is properly escaped in the internal SQL query. |
|  |  | """ |
|  |  | progress\_code = str(uuid.uuid4()) |
|  |  | partner\_obj = self.env['res.partner'].with\_context(progress\_code=progress\_code) |
|  |  | partner\_obj.web\_progress\_percent(0, "Start") |
|  |  | with api.Environment.manage(): |
|  |  | with registry(self.env.cr.dbname).cursor() as new\_cr: |
|  |  | # Create a new environment with a new cursor |
|  |  | new\_env = api.Environment(new\_cr, self.env.uid, self.env.context) |
|  |  | progress\_obj = self.env['web.progress'].with\_env(new\_env) |
|  |  | res = progress\_obj.get\_all\_progress() |
|  |  | self.assertEqual(res, [{'code': progress\_code}]) |
|  |  | res = progress\_obj.get\_all\_progress(0) |
|  |  | self.assertEqual(res, []) |
|  |  | with self.assertRaises(SyntaxError) as e: |
|  |  | progress\_obj.get\_all\_progress("0 SECOND' GROUP BY code; " |
|  |  | "SELECT code, array\_agg(state) FROM web\_progress " |
|  |  | "WHERE create\_date > timezone('utc', now()) - INTERVAL '10") |
|  |  | new\_cr.rollback() |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3c867f1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgmarczynski%2Fodoo-web-progress%2Fcommit%2F3c867f1cf7447449c81b1aa24ebb1f7ae757489f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7f572a7c_20250114_183121.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fluvsn%2FOdZoo%2Ftree%2Fmain%2Fexploits%2Fweb_progress)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fluvsn%2FOdZoo%2Ftree%2Fmain%2Fexploits%2Fweb_progress)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=luvsn%2FOdZoo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[luvsn](/luvsn)
/
**[OdZoo](/luvsn/OdZoo)**
Public

* [Notifications](/login?return_to=%2Fluvsn%2FOdZoo) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2Fluvsn%2FOdZoo)
* [Star
   3](/login?return_to=%2Fluvsn%2FOdZoo)

* [Code](/luvsn/OdZoo)
* [Issues
  0](/luvsn/OdZoo/issues)
* [Pull requests
  0](/luvsn/OdZoo/pulls)
* [Actions](/luvsn/OdZoo/actions)
* [Projects
  0](/luvsn/OdZoo/projects)
* [Security](/luvsn/OdZoo/security)
* [Insights](/luvsn/OdZoo/pulse)

Additional navigation options

* [Code](/luvsn/OdZoo)
* [Issues](/luvsn/OdZoo/issues)
* [Pull requests](/luvsn/OdZoo/pulls)
* [Actions](/luvsn/OdZoo/actions)
* [Projects](/luvsn/OdZoo/projects)
* [Security](/luvsn/OdZoo/security)
* [Insights](/luvsn/OdZoo/pulse)

## Files

 main
## Breadcrumbs

1. [OdZoo](/luvsn/OdZoo/tree/main)
2. /[exploits](/luvsn/OdZoo/tree/main/exploits)
/
# web\_progress

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/luvsn/OdZoo/commits/main/exploits/web_progress) main
## Breadcrumbs

1. [OdZoo](/luvsn/OdZoo/tree/main)
2. /[exploits](/luvsn/OdZoo/tree/main/exploits)
/
# web\_progress

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/luvsn/OdZoo/tree/main/exploits) | | |
| [PoC-web\_progress.mp4](/luvsn/OdZoo/blob/main/exploits/web_progress/PoC-web_progress.mp4 "PoC-web_progress.mp4") | | [PoC-web\_progress.mp4](/luvsn/OdZoo/blob/main/exploits/web_progress/PoC-web_progress.mp4 "PoC-web_progress.mp4") |  |  |
| [README.md](/luvsn/OdZoo/blob/main/exploits/web_progress/README.md "README.md") | | [README.md](/luvsn/OdZoo/blob/main/exploits/web_progress/README.md "README.md") |  |  |
| [exploit-web\_progress.py](/luvsn/OdZoo/blob/main/exploits/web_progress/exploit-web_progress.py "exploit-web_progress.py") | | [exploit-web\_progress.py](/luvsn/OdZoo/blob/main/exploits/web_progress/exploit-web_progress.py "exploit-web_progress.py") |  |  |
| View all files | | |

## [README.md](#readme)

# Dynamic Progress Bar

Important

The responsible disclosure policy has been followed when reporting this vulnerability. A patch has been made available by the module's vendor before this repository was made public.

Warning

The information and scripts provided here are intended for research and educational purposes only.
Usage of these resources in any way that could compromise the security of a system used in production is strictly prohibited and may lead to legal consequences.
The creator of these resources bears no responsibility for any misuse or harm resulting from their utilization.

## CVE ID

**CVE-2023-40954**

## Description

**SQL injection vulnerability** in Grzegorz Marczynski Dynamic Progress Bar (aka `web_progress`) v. 11.0 thru 11.0.2, v.12.0 thru 12.0.2, v.13.0 thru 13.0.2, v.14.0 thru 14.0.2.1, v.15.0 thru 15.0.2, v.16.0 thru 16.0.2.1 allows a remote attacker to **gain privileges** via the `recency` parameter in `models/web_progress.py` component.

Note

Versions made available on the Odoo Apps Store from August 5th 2023 are patched.

## Affected product

**Dynamic Progress Bar**

## Technical name of affected product

`web_progress`

## Link to the Odoo Apps Store

<https://apps.odoo.com/apps/modules/16.0/web_progress/>

## Vulnerability type

SQL injection

## Impact

Privilege Escalation, Information Disclosure

## Affected components:

`models/web_progress.py:WebProgress::get_all_progress(recency)`

## Attack vectors

A portal user or internal user of an Odoo instance with the `web_progress` module installed on it can trigger the `get_all_progress` method using the External API, passing a crafted `recency` argument to the method to inject the SQL query of its choice that will be executed through the database cursor.

## Proof-of-Concept

Note

A recorded demo of the PoC as well as the code for the exploit are available under this directory.

User `lucas` is a portal user and thus has no specific permission. User lucas sends an XML-RPC to the `web.progress` model through the External API , triggering the `get_all_progress` method. It passes a crafted `recency` argument that injects an SQL query modifying the admin password before executing the original intended query:

`models.execute_kw(db, uid, password, 'web.progress', 'get_all_progress', ["1 SECOND' GROUP BY code; UPDATE res_users SET password='whatever' WHERE login='admin'; SELECT code, array_agg(state) FROM web_progress WHERE create_date > timezone('utc', now()) - INTERVAL '1 "])`

Since the vulnerable method is a public method, it can be called from the External API. Also, since the database cursor is directly employed, no access rights checking is performed. No user input validation or sanitation is performed, allowing the attacker to inject arbitrary SQL queries, with consequences ranging from information disclosure to data tampering and privilege escalation. A possible patch could make use of prepared statements or make the affected method private to be no longer callable from the External API.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


