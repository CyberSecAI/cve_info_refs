```json
{
  "matches": [
    {
      "cve": "CVE-2023-40360",
      "content": "Multiple NetApp products incorporate QEMU. QEMU versions through 8.0.4 are susceptible to a vulnerability which when successfully exploited could lead to Denial of Service (DoS).\n\nSuccessful exploitation of this vulnerability could lead to Denial of Service (DoS).\n\nThe crash report triggered by the reproducer is:\n\n../hw/nvme/ctrl.c:6890:29: runtime error: member access within null pointer of type 'NvmeEnduranceGroup' (aka 'struct NvmeEnduranceGroup')\nSUMMARY: UndefinedBehaviorSanitizer: undefined-behavior ../hw/nvme/ctrl.c:6890:29 in\nAddressSanitizer:DEADLYSIGNAL\n=================================================================\n==1085476==ERROR: AddressSanitizer: SEGV on unknown address 0x000000001fc8 (pc 0x56306b765ebf bp 0x7ffff17fd890 sp 0x7ffff17f6a00 T0)\n==1085476==The signal is caused by a READ memory access.\n    #0 0x56306b765ebf in nvme_directive_receive ../hw/nvme/ctrl.c:6890:33\n    #1 0x56306b765ebf in nvme_admin_cmd ../hw/nvme/ctrl.c:6958:16\n    #2 0x56306b765ebf in nvme_process_sq ../hw/nvme/ctrl.c:7015:13\n    #3 0x56306cda2c3b in aio_bh_call ../util/async.c:169:5\n    #4 0x56306cda3384 in aio_bh_poll ../util/async.c:216:13\n    #5 0x56306cd3f15b in aio_dispatch ../util/aio-posix.c:423:5\n    #6 0x56306cda72da in aio_ctx_dispatch ../util/async.c:358:5\n    #7 0x7fa321cc417c in g_main_context_dispatch (/lib/x86_64-linux-gnu/libglib-2.0.so.0+0x5217c) (BuildId: 5fdb313daf182a33a858ba2cc945211b11d34561)\n    #8 0x56306cda840f in glib_pollfds_poll ../util/main-loop.c:290:9\n    #9 0x56306cda840f in os_host_main_loop_wait ../util/main-loop.c:313:5\n    #10 0x56306cda840f in main_loop_wait ../util/main-loop.c:592:11\n    #11 0x56306bd17f76 in qemu_main_loop ../softmmu/runstate.c:732:9\n    #12 0x56306c721835 in qemu_default_main ../softmmu/main.c:37:14\n    #13 0x7fa320aeb082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16\n    #14 0x56306af0309d in _start (./qemu-system-x86_64+0x1e9109d)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV ../hw/nvme/ctrl.c:6890:33 in nvme_directive_receive\n\nnvme_directive_receive() does not check if an endurance group has been\nconfigured (set) prior to testing if flexible data placement is enabled\nor not.\n\nFix this.\n\nCc: qemu-stable@nongnu.org\nResolves: [qemu-project/qemu#1815](https://gitlab.com/qemu-project/qemu/-/issues/1815 \"Null pointer access in nvme_directive_receive()\").",
      "vulnerability_details": {
        "root_cause": "The vulnerability is due to a null pointer dereference in the `nvme_directive_receive()` function within QEMU's NVMe emulation code. This occurs because the function attempts to access a member of the `NvmeEnduranceGroup` structure without checking if an endurance group has been configured.",
        "weaknesses": [
          "Null pointer dereference",
          "Missing configuration check"
        ],
        "impact": "Successful exploitation leads to a Denial of Service (DoS) due to a crash caused by a segmentation fault (SEGV).",
        "attack_vectors": [
          "Sending a crafted NVMe directive to the emulated NVMe controller. This can be achieved through specific QEMU command line arguments or via a virtual machine.",
           "Fuzzing the nvme device"
        ],
        "required_capabilities": "An attacker would need to be able to control or manipulate the interaction with the emulated NVMe device. This can be within a virtual machine or by interacting directly with the QEMU process itself."
      }
    }
  ],
  "unrelated": [],
  "no_info": []
}
```