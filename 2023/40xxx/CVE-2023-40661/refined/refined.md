```
{
  "CVE-2023-40661": {
    "related_content": [
      {
        "source": "github.com_cd5d7744_20250115_125256.html",
        "vulnerability": "NOINFO"
      },
      {
        "source": "github.com_ca166fe6_20250115_125251.html",
        "vulnerability": {
          "root_cause": "A stack buffer overflow was found in the `sc_pkcs15_get_lastupdate` function due to a missing length check on the last update data retrieved from the smart card.",
          "weaknesses": [
            "Stack buffer overflow"
          ],
           "impact": "A specifically crafted smart card could trigger a buffer overflow, potentially leading to arbitrary code execution.",
          "attack_vectors": "The vulnerability can only be triggered via specially crafted smart card responses to the host.",
           "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
          }
        },
      {
        "source": "github.com_35c7f428_20250115_201751.html",
        "vulnerability": "NOINFO"
      },
     {
        "source": "github.com_27b15574_20250115_125303.html",
          "vulnerability": {
            "root_cause": "Integer overflow due to lack of separate handling of offset in the buffer and the Elementary File (EF) during write operations in sc_hsm_write_ef. A loop in the function did not update the `offset` variable correctly, leading to an infinite loop, as well as out-of-bounds write.",
           "weaknesses": [
                "Integer overflow",
                "Out-of-bounds write"
            ],
            "impact": "A specially crafted smart card response could lead to a buffer overflow in the `sc_hsm_write_ef` function, potentially leading to arbitrary code execution.",
            "attack_vectors": "The vulnerability can only be triggered via a specially crafted smart card responses to the host.",
           "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
          }
      },
      {
       "source": "bugzilla.redhat.com_c9518a55_20250115_201853.html",
        "vulnerability": {
          "root_cause": "Multiple memory issues, including buffer overflows and double frees, were found in the pkcs15-init tool during card enrollment.",
            "weaknesses": [
              "Stack buffer overflow",
              "Heap buffer overflow",
              "Heap double free"
            ],
           "impact": "An attacker with physical access could exploit these vulnerabilities using a specially crafted USB device or smart card to compromise key generation, certificate loading, and card management operations during enrollment.",
            "attack_vectors": "The attacker needs physical access to the computer, and a specially crafted smart card that is able to send malformed responses to the host.",
            "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
        }
      },
       {
        "source": "github.com_709399a8_20250115_201749.html",
        "vulnerability": "UNRELATED"
      },
      {
        "source": "bugs.chromium.org_1a7db369_20250115_125304.html",
         "vulnerability": "NOINFO"
      },
      {
        "source": "bugs.chromium.org_bf382b72_20250115_125252.html",
        "vulnerability": "NOINFO"
      },
       {
        "source": "github.com_eb741d45_20250115_201808.html",
        "vulnerability": "NOINFO"
      },
      {
        "source": "wiki.debian.org_8d48714b_20250115_201839.html",
        "vulnerability":"NOINFO"
      },
       {
        "source": "github.com_a1b59367_20250115_201807.html",
         "vulnerability": "NOINFO"
      },
       {
        "source": "bugs.chromium.org_0944ec5a_20250115_125312.html",
        "vulnerability": "NOINFO"
      },
         {
        "source": "github.com_2dc01af3_20250115_201843.html",
        "vulnerability": {
          "root_cause": "Multiple memory vulnerabilities exist within the OpenSC packages, specifically in the card enrollment process using `pkcs15-init`",
          "weaknesses": [
            "Out-of-bounds read",
            "Heap buffer overflow",
	    "Stack buffer overflow"
           ],
           "impact": "An attacker with physical access to the computer can use a specially crafted USB device or smart card to manipulate responses to APDUs, potentially compromising key generation, certificate loading, and other card management during enrollment.",
          "attack_vectors": "The attack requires physical access to the computer, and a specially crafted smart card or USB device capable of generating malicious responses.",
          "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card or USB device that is able to send malformed responses."
        }
      },
           {
        "source": "github.com_c983adfb_20250115_125306.html",
         "vulnerability":{
             "root_cause":"A heap buffer overflow vulnerability was discovered in `cosm_new_file` function within pkcs15-oberthur.c due to missing path length validation",
              "weaknesses": [
                "Heap buffer overflow"
           ],
          "impact": "A crafted smart card response during card enrollment with pkcs15-init may lead to a buffer overflow.",
           "attack_vectors": "The vulnerability can only be triggered via a specially crafted smart card response to the host.",
            "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
         }
      },
          {
        "source": "access.redhat.com_2c2dd296_20250115_125239.html",
         "vulnerability": "NOINFO"
      },
      {
        "source": "bugs.chromium.org_556fa3a5_20250115_125256.html",
       "vulnerability":"NOINFO"
      },
         {
          "source": "github.com_9aa3b9ab_20250115_125258.html",
          "vulnerability":{
               "root_cause":"Stack buffer overflow during parsing of pkcs15 profile files when a string copy is performed without checking the size of the source string before copying.",
              "weaknesses":[
                  "Stack buffer overflow"
              ],
               "impact":"A specially crafted smart card could trigger a stack buffer overflow, potentially leading to arbitrary code execution.",
                "attack_vectors": "The vulnerability can only be triggered via a specially crafted smart card response to the host.",
               "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
            }
        },
     {
        "source": "bugs.chromium.org_4a4ac099_20250115_125249.html",
        "vulnerability":"NOINFO"
      },
      {
        "source": "www.openwall.com_df719f9f_20250114_224717.html",
        "vulnerability": {
          "root_cause": "Multiple issues in `pkcs15-init` reported by dynamic analysers (OSS-fuzz) such as buffer overflows and double frees.",
            "weaknesses":[
              "Stack buffer overflow",
               "Heap buffer overflow",
               "Heap double free"
            ],
           "impact":"These can be triggered during the card enrollment process using pkcs15-init, possibly leading to arbitrary code execution. ",
          "attack_vectors":"The attack requires a crafted USB device or smart card, presenting specifically crafted APDU responses.",
           "required_attacker_capabilities":"The attacker needs physical access to the computer and a smart card that is able to send malformed responses."
           }
      },
      {
        "source": "bugs.chromium.org_9c6bc5cd_20250115_125309.html",
         "vulnerability": "NOINFO"
      },
     {
        "source": "bugs.chromium.org_937b8046_20250115_125312.html",
        "vulnerability": "NOINFO"
      },
         {
        "source": "lists.fedoraproject.org_3d068101_20250114_224728.html",
         "vulnerability": "NOINFO"
      },
       {
          "source":"access.redhat.com_17465dfb_20250115_201852.html",
        "vulnerability": "NOINFO"
      },
         {
        "source": "bugs.chromium.org_556fa3a5_20250115_125256.html",
         "vulnerability": "NOINFO"
      },
       {
        "source": "github.com_063376f6_20250115_201808.html",
         "vulnerability":"NOINFO"
      },
        {
        "source": "github.com_c840b555_20250115_125302.html",
         "vulnerability": {
           "root_cause": "A buffer underflow vulnerability in pkcs15-setcos.c's cosm_create_key function is due to missing boundary checks.",
           "weaknesses":[
              "Buffer underflow"
            ],
            "impact": "A specially crafted smart card could trigger a buffer underflow, potentially leading to a denial of service or arbitrary code execution.",
            "attack_vectors":"The vulnerability can only be triggered via a specially crafted smart card response to the host.",
             "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
         }
      },
        {
        "source":"access.redhat.com_2c2dd296_20250115_125239.html",
        "vulnerability":"NOINFO"
      },
        {
         "source": "github.com_f53c0621_20250115_201808.html",
         "vulnerability":{
             "root_cause":"The `sc_hsm_write_ef` function had a loop, which was not correctly handling the `file_offset` and the `offset` variable leading to an out-of-bounds read and an infinite loop",
              "weaknesses": [
                    "Out-of-bounds read",
                     "Infinite loop"
                  ],
          "impact": "A specially crafted smart card response could lead to an out-of-bounds read in the `sc_hsm_write_ef` function, potentially leading to arbitrary code execution.",
           "attack_vectors": "The vulnerability can only be triggered via a specially crafted smart card response to the host.",
            "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
          }
        },
         {
        "source": "bugs.chromium.org_9a124010_20250115_125256.html",
         "vulnerability": "NOINFO"
      },
    {
        "source": "lists.debian.org_4050d938_20250114_224727.html",
         "vulnerability": {
             "root_cause": "Multiple vulnerabilities in opensc related to handling smart cards through pkcs15-init.",
            "weaknesses":[
               "Stack buffer overflow",
               "Heap buffer overflow"
              ],
           "impact":"These vulnerabilities allow a malicious smart card to trigger application crashes.",
           "attack_vectors": "The attack requires physical access to the computer and crafted smart cards with specific responses.",
            "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
        }
      },
      {
        "source": "access.redhat.com_74c66c28_20250115_125238.html",
        "vulnerability": "NOINFO"
      },
         {
       "source":"github.com_dba769c8_20250115_201814.html",
       "vulnerability": "NOINFO"
      },
         {
        "source": "bugs.chromium.org_9d7893e4_20250115_125309.html",
         "vulnerability": "NOINFO"
      },
        {
        "source":"github.com_2dc01af3_20250115_201843.html",
          "vulnerability": "NOINFO"
          },
         {
        "source": "github.com_c840b555_20250115_125302.html",
         "vulnerability":"NOINFO"
      },
      {
        "source": "access.redhat.com_3f6e2085_20250115_201850.html",
         "vulnerability":"NOINFO"
         },
    {
        "source": "bugs.chromium.org_4a4ac099_20250115_125249.html",
        "vulnerability":"NOINFO"
      },
          {
          "source": "github.com_52c80f02_20250115_125257.html",
            "vulnerability": {
               "root_cause": "A buffer underflow in the `cosm_create_key` function in `pkcs15-oberthur.c` occurs when the path length is checked for being less than 2, but path length is used for id which leads to access before buffer starts.",
                "weaknesses":[
                    "Buffer Underflow"
                   ],
                   "impact":"A specially crafted smart card response could lead to a buffer underflow during creation of an RSA key in the setcos driver.",
                   "attack_vectors":"The vulnerability can only be triggered via a specially crafted smart card response to the host.",
                   "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
              }
          },
          {
           "source": "github.com_5750b399_20250115_201748.html",
            "vulnerability":{
              "root_cause":"The `myeid_enc_dec_sym` function in the MyEID driver has an out of bounds read when handling encryption with symmetric keys due to the missing size checks.",
              "weaknesses":[
                 "Out-of-bounds read"
               ],
              "impact":"An attacker with physical access to the computer can use a specially crafted USB device or smart card to trigger the out-of-bounds read and gain unauthorized access to sensitive data.",
              "attack_vectors":"The vulnerability can be triggered by a crafted smart card response via specially crafted APDU commands.",
               "required_attacker_capabilities":"The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
              }
       },
      {
          "source":"access.redhat.com_edc65776_20250115_201853.html",
            "vulnerability": "NOINFO"
         },
          {
           "source":"github.com_afc40b6d_20250115_125259.html",
             "vulnerability": {
               "root_cause": "A stack buffer overflow vulnerability is caused by a missing check on the `path.len` when calling `sc_pkcs15init_rmdir` in pkcs15-lib.c, causing an out of bounds write.",
               "weaknesses": [
                    "Stack buffer overflow"
                  ],
               "impact": "A malicious smart card can potentially trigger an out-of-bounds write during directory removal.",
               "attack_vectors": "The vulnerability can only be triggered via a specially crafted smart card response to the host.",
               "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
             }
          },
            {
        "source": "bugs.chromium.org_9a124010_20250115_125256.html",
        "vulnerability":"NOINFO"
      },
             {
        "source": "github.com_68e1e72f_20250115_125248.html",
        "vulnerability": "NOINFO"
         },
      {
       "source":"bugs.chromium.org_937b8046_20250115_125312.html",
       "vulnerability": "NOINFO"
      },
          {
          "source":"github.com_f97e5fc9_20250115_125252.html",
          "vulnerability":{
               "root_cause":"An out of bounds read is present in `cflex_delete_file` due to missing bounds check on the path length which leads to an integer underflow.",
                "weaknesses":[
                    "Out-of-bounds read"
                   ],
                  "impact":"A malicious smart card can potentially trigger a buffer underflow and lead to denial of service or arbitrary code execution.",
                 "attack_vectors": "The vulnerability can only be triggered via a specially crafted smart card response to the host.",
               "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
            }
      },
       {
       "source":"bugs.chromium.org_363cf915_20250115_125300.html",
       "vulnerability": "NOINFO"
      },
       {
        "source": "github.com_060f213e_20250115_201810.html",
       "vulnerability": {
         "root_cause": "Multiple vulnerabilities, including buffer overflows and double frees, in OpenSC when handling malformed responses during card enrollment, leading to potential security risks.",
          "weaknesses": [
               "Stack buffer overflow",
               "Heap buffer overflow",
               "Double free"
           ],
            "impact": "An attacker with physical access to the computer, using a specially crafted smart card or USB device, may potentially execute arbitrary code or compromise data.",
            "attack_vectors":"The attacker needs physical access to the computer and a specially crafted card that sends malformed APDU responses.",
             "required_attacker_capabilities": "The attacker needs physical access to the machine and a smart card that is able to send malformed responses."
           }
        },
        {
       "source":"access.redhat.com_3a61d1b3_20250115_125245.html",
        "vulnerability": "NOINFO"
       },
         {
          "source": "bugs.chromium.org_9a124010_20250115_125256.html",
           "vulnerability": "NOINFO"
         },
        {
         "source": "github.com_52c80f02_20250115_125257.html",
         "vulnerability":"NOINFO"
         },
     {
       "source":"github.com_afc40b6d_20250115_125259.html",
       "vulnerability":"NOINFO"
      }
     ]
    ,
    "summary": "CVE-2023-40661 is a vulnerability related to multiple memory issues in the OpenSC library, especially within the pkcs15-init tool used during card enrollment, where an attacker with physical access using crafted smart cards can trigger buffer overflows, double frees and other related vulnerabilities leading to potential unauthorized access and code execution.",
     "details": "CVE-2023-40661 addresses various memory issues discovered in the OpenSC library, primarily affecting the pkcs15-init tool during smart card enrollment. These issues include stack and heap buffer overflows, as well as double-free vulnerabilities. Exploitation requires physical access to the machine and a smart card that is able to send malformed responses. Successful attacks could lead to arbitrary code execution or denial of service. OpenSC versions 0.17.0 up to 0.23.0 are affected. The patches can be found in release 0.24.0 and in related git commits."
    }
}
```