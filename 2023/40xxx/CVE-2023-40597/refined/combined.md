=== Content from research.splunk.com_9ab40ab2_20250114_225726.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk Absolute Path Traversal Using runshellscript

Updated Date: 2024-10-17
ID: 356bd3fe-f59b-4f64-baa1-51495411b7ad
Author: Rod Soto
[Type: Hunting](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

The following analytic detects the exploitation of an absolute path traversal vulnerability in Splunk Enterprise versions lower than 8.2.12, 9.0.6, and 9.1.1, where an attacker can execute arbitrary code located on a separate disk. It leverages logs from the `splunk_python` macro, specifically looking for the `runshellscript` command with a specific argument count and path pattern. This activity is significant as it indicates a potential exploitation attempt that could lead to unauthorized code execution. If confirmed malicious, this could allow an attacker to gain control over the Splunk instance, leading to data breaches or further system compromise.

### Search

```
 1`splunk_python` *runshellscript*
 2| eval log_split=split(_raw, "runshellscript: ")
 3| eval array_raw = mvindex(log_split,1)
 4| eval data_cleaned=replace(replace(replace(array_raw,"\[",""),"\]",""),"'","")
 5| eval array_indices=split(data_cleaned,",")
 6| eval runshellscript_args_count=mvcount(array_indices)
 7| where runshellscript_args_count = 10
 8| eval interpreter=mvindex(array_indices,0)
 9| eval targetScript=mvindex(array_indices,1)
10| eval targetScript != "*C:*"
11| stats count min(_time) as firstTime max(_time) as lastTime by splunk_server interpreter targetScript
12| `security_content_ctime(firstTime)`
13| `security_content_ctime(lastTime)`
14| `splunk_absolute_path_traversal_using_runshellscript_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [security\_content\_ctime](https://github.com/splunk/security_content/blob/develop/macros/security_content_ctime.yml) | `convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)` |
| splunk\_absolute\_path\_traversal\_using\_runshellscript\_filter | `search *` |

`splunk_absolute_path_traversal_using_runshellscript_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1083](https://attack.mitre.org/techniques/T1083/) | File and Directory Discovery | Discovery |

KillChainPhase.EXPLOITAITON

NistCategory.DE\_AE

Cis18Value.CIS\_10

APT18
APT28
APT3
APT32
APT38
APT39
APT41
APT5
Aoqin Dragon
BRONZE BUTLER
Chimera
Confucius
Dark Caracal
Darkhotel
Dragonfly
FIN13
Fox Kitten
Gamaredon Group
HAFNIUM
Inception
Ke3chang
Kimsuky
Lazarus Group
Leafminer
LuminousMoth
Magic Hound
MuddyWater
Mustang Panda
Patchwork
Play
RedCurl
Sandworm Team
Scattered Spider
Sidewinder
Sowbug
TeamTNT
ToddyCat
Tropic Trooper
Turla
Volt Typhoon
Windigo
Winnti Group
Winter Vivern
admin@338
menuPass

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Risk Event | False |

This configuration file applies to all detections of type hunting.
### Implementation

Must have access to internal indexes. Only applies to Splunk on Windows versions.

### Known False Positives

The command runshellscript can be used for benign purposes. Analyst will have to review the searches and determined maliciousness specially by looking at targeted script.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Possible attack against splunk\_server $splunk\_server$ through abuse of the runshellscript command | 35 | 50 | 70 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/advisories/SVD-2023-0806>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1083/splunk/splunk_absolute_path_traversal_using_runshellscript_splunk_python.log) | `python.log` | `splunk_python` |
| Integration | â Passing | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1083/splunk/splunk_absolute_path_traversal_using_runshellscript_splunk_python.log) | `python.log` | `splunk_python` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_absolute_path_traversal_using_runshellscript.yml) |
Version: **3**

[Detection: Spike in File Writes](https://research.splunk.com/endpoint/fdb0f805-74e4-4539-8c00-618927333aae/ "Detection: Spike in File Writes")

[Detection: Splunk Account Discovery Drilldown Dashboard Disclosure](https://research.splunk.com/application/f844c3f6-fd99-43a2-ba24-93e35fe84be6/ "Detection: Splunk Account Discovery Drilldown Dashboard Disclosure")

Â© 2005 - 2024 Splunk LLC All rights reserved.



=== Content from advisory.splunk.com_f9e7b2af_20250114_225725.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Absolute Path Traversal in Splunk Enterprise Using runshellscript.py

**Advisory ID:** SVD-2023-0806

**CVE ID:** [CVE-2023-40597](https://www.cve.org/CVERecord?id=CVE-2023-40597)

**Published:** 2023-08-30

**Last Update:** 2023-10-18

**CVSSv3.1 Score:** 7.8, High

**CVSSv3.1 Vector:** [CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H)

**CWE:** [CWE-36](https://cwe.mitre.org/data/definitions/36.html)

**Bug ID:** VULN-5304

## Description

In Splunk Enterprise versions lower than 8.2.12, 9.0.6, and 9.1.1, an attacker can exploit an absolute path traversal to execute arbitrary code that is located on a separate disk.

The runshellscript.py script does not perform adequate user validation. This lets an attacker use the runshellscript.py script to run a script in the root directory of another disk on the machine.

The exploit requires the attacker to have write access to the drive on which they place the exploit script.
This vulnerability only affects Splunk Enterprise Instances that run on Windows.

## Solution

Upgrade Splunk Enterprise to 8.2.12, 9.0.6, or 9.1.1.

This vulnerability does not affect Splunk Cloud Platform instances.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 8.2 | Splunk Web | 8.2.0 to 8.2.11 | 8.2.12 |
| Splunk Enterprise | 9.0 | Splunk Web | 9.0.0 to 9.0.5 | 9.0.6 |
| Splunk Enterprise | 9.1 | Splunk Web | 9.1.0 | 9.1.1 |
| Splunk Cloud | - | Splunk Web | 9.0.2305.100 and below | 9.0.2305.200 |

## Mitigations and Workarounds

No mitigations

## Detections

* [Splunk Absolute Path Traversal Using runshellscript](https://research.splunk.com/application/356bd3fe-f59b-4f64-baa1-51495411b7ad/)

## Severity

Splunk rates this vulnerability a 7.8, Medium, with a CVSSv3.1 vector of CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H.

This vulnerability only affects Splunk Enterprise Instances that run on Windows machines. If your Splunk platform instance does not run on Windows, it is not affected and this vulnerability is considered informational.

## Acknowledgments

Danylo Dmytriiev (DDV\_UA)

## Changelog

* 2023-10-18: Added additional details to the description and severity to clarify that this vulnerability only affects instances that run on Windows machines

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)
