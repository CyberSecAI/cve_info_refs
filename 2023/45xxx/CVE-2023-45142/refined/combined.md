=== Content from github.com_9b660eb4_20250115_085020.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go%2Fblob%2Fv1.12.0%2Fsemconv%2Finternal%2Fv2%2Fhttp.go)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go%2Fblob%2Fv1.12.0%2Fsemconv%2Finternal%2Fv2%2Fhttp.go)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=open-telemetry%2Fopentelemetry-go)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-telemetry](/open-telemetry)
/
**[opentelemetry-go](/open-telemetry/opentelemetry-go)**
Public

* [Notifications](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go)
* [Star
   5.4k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go)

* [Code](/open-telemetry/opentelemetry-go/tree/v1.12.0)
* [Issues
  156](/open-telemetry/opentelemetry-go/issues)
* [Pull requests
  34](/open-telemetry/opentelemetry-go/pulls)
* [Discussions](/open-telemetry/opentelemetry-go/discussions)
* [Actions](/open-telemetry/opentelemetry-go/actions)
* [Projects
  5](/open-telemetry/opentelemetry-go/projects)
* [Security](/open-telemetry/opentelemetry-go/security)
* [Insights](/open-telemetry/opentelemetry-go/pulse)

Additional navigation options

* [Code](/open-telemetry/opentelemetry-go/tree/v1.12.0)
* [Issues](/open-telemetry/opentelemetry-go/issues)
* [Pull requests](/open-telemetry/opentelemetry-go/pulls)
* [Discussions](/open-telemetry/opentelemetry-go/discussions)
* [Actions](/open-telemetry/opentelemetry-go/actions)
* [Projects](/open-telemetry/opentelemetry-go/projects)
* [Security](/open-telemetry/opentelemetry-go/security)
* [Insights](/open-telemetry/opentelemetry-go/pulse)

## Files

 v1.12.0
## Breadcrumbs

1. [opentelemetry-go](/open-telemetry/opentelemetry-go/tree/v1.12.0)
2. /[semconv](/open-telemetry/opentelemetry-go/tree/v1.12.0/semconv)
3. /[internal](/open-telemetry/opentelemetry-go/tree/v1.12.0/semconv/internal)
4. /[v2](/open-telemetry/opentelemetry-go/tree/v1.12.0/semconv/internal/v2)
/
# http.go

Copy path Blame  Blame
## Latest commit

## History

[History](/open-telemetry/opentelemetry-go/commits/v1.12.0/semconv/internal/v2/http.go)405 lines (364 loc) · 11.5 KB v1.12.0
## Breadcrumbs

1. [opentelemetry-go](/open-telemetry/opentelemetry-go/tree/v1.12.0)
2. /[semconv](/open-telemetry/opentelemetry-go/tree/v1.12.0/semconv)
3. /[internal](/open-telemetry/opentelemetry-go/tree/v1.12.0/semconv/internal)
4. /[v2](/open-telemetry/opentelemetry-go/tree/v1.12.0/semconv/internal/v2)
/
# http.go

Top
## File metadata and controls

* Code
* Blame

405 lines (364 loc) · 11.5 KB[Raw](https://github.com/open-telemetry/opentelemetry-go/raw/refs/tags/v1.12.0/semconv/internal/v2/http.go)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405// Copyright The OpenTelemetry Authors//// Licensed under the Apache License, Version 2.0 (the "License");// you may not use this file except in compliance with the License.// You may obtain a copy of the License at//// http://www.apache.org/licenses/LICENSE-2.0//// Unless required by applicable law or agreed to in writing, software// distributed under the License is distributed on an "AS IS" BASIS,// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.// See the License for the specific language governing permissions and// limitations under the License.
package internal // import "go.opentelemetry.io/otel/semconv/internal/v2"
import ( "fmt" "net/http" "strings"
 "go.opentelemetry.io/otel/attribute" "go.opentelemetry.io/otel/codes")
// HTTPConv are the HTTP semantic convention attributes defined for a version// of the OpenTelemetry specification.type HTTPConv struct { NetConv \*NetConv
 EnduserIDKey attribute.Key HTTPClientIPKey attribute.Key HTTPFlavorKey attribute.Key HTTPMethodKey attribute.Key HTTPRequestContentLengthKey attribute.Key HTTPResponseContentLengthKey attribute.Key HTTPRouteKey attribute.Key HTTPSchemeHTTP attribute.KeyValue HTTPSchemeHTTPS attribute.KeyValue HTTPStatusCodeKey attribute.Key HTTPTargetKey attribute.Key HTTPURLKey attribute.Key HTTPUserAgentKey attribute.Key}
// ClientResponse returns attributes for an HTTP response received by a client// from a server. The following attributes are returned if the related values// are defined in resp: "http.status.code", "http.response\_content\_length".//// This does not add all OpenTelemetry required attributes for an HTTP event,// it assumes ClientRequest was used to create the span with a complete set of// attributes. If a complete set of attributes can be generated using the// request contained in resp. For example://// append(ClientResponse(resp), ClientRequest(resp.Request)...)func (c \*HTTPConv) ClientResponse(resp \*http.Response) []attribute.KeyValue { var n int if resp.StatusCode > 0 { n++ } if resp.ContentLength > 0 { n++ }
 attrs := make([]attribute.KeyValue, 0, n) if resp.StatusCode > 0 { attrs = append(attrs, c.HTTPStatusCodeKey.Int(resp.StatusCode)) } if resp.ContentLength > 0 { attrs = append(attrs, c.HTTPResponseContentLengthKey.Int(int(resp.ContentLength))) } return attrs}
// ClientRequest returns attributes for an HTTP request made by a client. The// following attributes are always returned: "http.url", "http.flavor",// "http.method", "net.peer.name". The following attributes are returned if the// related values are defined in req: "net.peer.port", "http.user\_agent",// "http.request\_content\_length", "enduser.id".func (c \*HTTPConv) ClientRequest(req \*http.Request) []attribute.KeyValue { n := 3 // URL, peer name, proto, and method. var h string if req.URL != nil { h = req.URL.Host } peer, p := firstHostPort(h, req.Header.Get("Host")) port := requiredHTTPPort(req.URL != nil && req.URL.Scheme == "https", p) if port > 0 { n++ } useragent := req.UserAgent() if useragent != "" { n++ } if req.ContentLength > 0 { n++ } userID, \_, hasUserID := req.BasicAuth() if hasUserID { n++ } attrs := make([]attribute.KeyValue, 0, n)
 attrs = append(attrs, c.method(req.Method)) attrs = append(attrs, c.proto(req.Proto))
 var u string if req.URL != nil { // Remove any username/password info that may be in the URL. userinfo := req.URL.User req.URL.User = nil u = req.URL.String() // Restore any username/password info that was removed. req.URL.User = userinfo } attrs = append(attrs, c.HTTPURLKey.String(u))
 attrs = append(attrs, c.NetConv.PeerName(peer)) if port > 0 { attrs = append(attrs, c.NetConv.PeerPort(port)) }
 if useragent != "" { attrs = append(attrs, c.HTTPUserAgentKey.String(useragent)) }
 if l := req.ContentLength; l > 0 { attrs = append(attrs, c.HTTPRequestContentLengthKey.Int64(l)) }
 if hasUserID { attrs = append(attrs, c.EnduserIDKey.String(userID)) }
 return attrs}
// ServerRequest returns attributes for an HTTP request received by a server.//// The server must be the primary server name if it is known. For example this// would be the ServerName directive// (https://httpd.apache.org/docs/2.4/mod/core.html#servername) for an Apache// server, and the server\_name directive// (http://nginx.org/en/docs/http/ngx\_http\_core\_module.html#server\_name) for an// nginx server. More generically, the primary server name would be the host// header value that matches the default virtual host of an HTTP server. It// should include the host identifier and if a port is used to route to the// server that port identifier should be included as an appropriate port// suffix.//// If the primary server name is not known, server should be an empty string.// The req Host will be used to determine the server instead.//// The following attributes are always returned: "http.method", "http.scheme",// "http.flavor", "http.target", "net.host.name". The following attributes are// returned if they related values are defined in req: "net.host.port",// "net.sock.peer.addr", "net.sock.peer.port", "http.user\_agent", "enduser.id",// "http.client\_ip".func (c \*HTTPConv) ServerRequest(server string, req \*http.Request) []attribute.KeyValue { n := 5 // Method, scheme, target, proto, and host name. var host string var p int if server == "" { host, p = splitHostPort(req.Host) } else { // Prioritize the primary server name. host, p = splitHostPort(server) if p < 0 { \_, p = splitHostPort(req.Host) } } hostPort := requiredHTTPPort(req.TLS != nil, p) if hostPort > 0 { n++ } peer, peerPort := splitHostPort(req.RemoteAddr) if peer != "" { n++ if peerPort > 0 { n++ } } useragent := req.UserAgent() if useragent != "" { n++ } userID, \_, hasUserID := req.BasicAuth() if hasUserID { n++ } clientIP := serverClientIP(req.Header.Get("X-Forwarded-For")) if clientIP != "" { n++ } attrs := make([]attribute.KeyValue, 0, n)
 attrs = append(attrs, c.method(req.Method)) attrs = append(attrs, c.scheme(req.TLS != nil)) attrs = append(attrs, c.proto(req.Proto)) attrs = append(attrs, c.NetConv.HostName(host))
 if req.URL != nil { attrs = append(attrs, c.HTTPTargetKey.String(req.URL.RequestURI())) } else { // This should never occur if the request was generated by the net/http // package. Fail gracefully, if it does though. attrs = append(attrs, c.HTTPTargetKey.String(req.RequestURI)) }
 if hostPort > 0 { attrs = append(attrs, c.NetConv.HostPort(hostPort)) }
 if peer != "" { // The Go HTTP server sets RemoteAddr to "IP:port", this will not be a // file-path that would be interpreted with a sock family. attrs = append(attrs, c.NetConv.SockPeerAddr(peer)) if peerPort > 0 { attrs = append(attrs, c.NetConv.SockPeerPort(peerPort)) } }
 if useragent != "" { attrs = append(attrs, c.HTTPUserAgentKey.String(useragent)) }
 if hasUserID { attrs = append(attrs, c.EnduserIDKey.String(userID)) }
 if clientIP != "" { attrs = append(attrs, c.HTTPClientIPKey.String(clientIP)) }
 return attrs}
func (c \*HTTPConv) method(method string) attribute.KeyValue { if method == "" { return c.HTTPMethodKey.String(http.MethodGet) } return c.HTTPMethodKey.String(method)}
func (c \*HTTPConv) scheme(https bool) attribute.KeyValue { // nolint:revive if https { return c.HTTPSchemeHTTPS } return c.HTTPSchemeHTTP}
func (c \*HTTPConv) proto(proto string) attribute.KeyValue { switch proto { case "HTTP/1.0": return c.HTTPFlavorKey.String("1.0") case "HTTP/1.1": return c.HTTPFlavorKey.String("1.1") case "HTTP/2": return c.HTTPFlavorKey.String("2.0") case "HTTP/3": return c.HTTPFlavorKey.String("3.0") default: return c.HTTPFlavorKey.String(proto) }}
func serverClientIP(xForwardedFor string) string { if idx := strings.Index(xForwardedFor, ","); idx >= 0 { xForwardedFor = xForwardedFor[:idx] } return xForwardedFor}
func requiredHTTPPort(https bool, port int) int { // nolint:revive if https { if port > 0 && port != 443 { return port } } else { if port > 0 && port != 80 { return port } } return -1}
// Return the request host and port from the first non-empty source.func firstHostPort(source ...string) (host string, port int) { for \_, hostport := range source { host, port = splitHostPort(hostport) if host != "" || port > 0 { break } } return}
// RequestHeader returns the contents of h as OpenTelemetry attributes.func (c \*HTTPConv) RequestHeader(h http.Header) []attribute.KeyValue { return c.header("http.request.header", h)}
// ResponseHeader returns the contents of h as OpenTelemetry attributes.func (c \*HTTPConv) ResponseHeader(h http.Header) []attribute.KeyValue { return c.header("http.response.header", h)}
func (c \*HTTPConv) header(prefix string, h http.Header) []attribute.KeyValue { key := func(k string) attribute.Key { k = strings.ToLower(k) k = strings.ReplaceAll(k, "-", "\_") k = fmt.Sprintf("%s.%s", prefix, k) return attribute.Key(k) }
 attrs := make([]attribute.KeyValue, 0, len(h)) for k, v := range h { attrs = append(attrs, key(k).StringSlice(v)) } return attrs}
// ClientStatus returns a span status code and message for an HTTP status code// value received by a client.func (c \*HTTPConv) ClientStatus(code int) (codes.Code, string) { stat, valid := validateHTTPStatusCode(code) if !valid { return stat, fmt.Sprintf("Invalid HTTP status code %d", code) } return stat, ""}
// ServerStatus returns a span status code and message for an HTTP status code// value returned by a server. Status codes in the 400-499 range are not// returned as errors.func (c \*HTTPConv) ServerStatus(code int) (codes.Code, string) { stat, valid := validateHTTPStatusCode(code) if !valid { return stat, fmt.Sprintf("Invalid HTTP status code %d", code) }
 if code/100 == 4 { return codes.Unset, "" } return stat, ""}
type codeRange struct { fromInclusive int toInclusive int}
func (r codeRange) contains(code int) bool { return r.fromInclusive <= code && code <= r.toInclusive}
var validRangesPerCategory = map[int][]codeRange{ 1: { {http.StatusContinue, http.StatusEarlyHints}, }, 2: { {http.StatusOK, http.StatusAlreadyReported}, {http.StatusIMUsed, http.StatusIMUsed}, }, 3: { {http.StatusMultipleChoices, http.StatusUseProxy}, {http.StatusTemporaryRedirect, http.StatusPermanentRedirect}, }, 4: { {http.StatusBadRequest, http.StatusTeapot}, // yes, teapot is so useful… {http.StatusMisdirectedRequest, http.StatusUpgradeRequired}, {http.StatusPreconditionRequired, http.StatusTooManyRequests}, {http.StatusRequestHeaderFieldsTooLarge, http.StatusRequestHeaderFieldsTooLarge}, {http.StatusUnavailableForLegalReasons, http.StatusUnavailableForLegalReasons}, }, 5: { {http.StatusInternalServerError, http.StatusLoopDetected}, {http.StatusNotExtended, http.StatusNetworkAuthenticationRequired}, },}
// validateHTTPStatusCode validates the HTTP status code and returns// corresponding span status code. If the `code` is not a valid HTTP status// code, returns span status Error and false.func validateHTTPStatusCode(code int) (codes.Code, bool) { category := code / 100 ranges, ok := validRangesPerCategory[category] if !ok { return codes.Error, false } ok = false for \_, crange := range ranges { ok = crange.contains(code) if ok { break } } if !ok { return codes.Error, false } if category > 0 && category < 4 { return codes.Unset, true } return codes.Error, true}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_eae61750_20250115_085009.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fblob%2F5f7e6ad5a49b45df45f61a1deb29d7f1158032df%2Finstrumentation%2Fnet%2Fhttp%2Fotelhttp%2Fhandler.go)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fblob%2F5f7e6ad5a49b45df45f61a1deb29d7f1158032df%2Finstrumentation%2Fnet%2Fhttp%2Fotelhttp%2Fhandler.go)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=open-telemetry%2Fopentelemetry-go-contrib)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-telemetry](/open-telemetry)
/
**[opentelemetry-go-contrib](/open-telemetry/opentelemetry-go-contrib)**
Public

* [Notifications](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib) You must be signed in to change notification settings
* [Fork
  584](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib)
* [Star
   1.3k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib)

* [Code](/open-telemetry/opentelemetry-go-contrib)
* [Issues
  191](/open-telemetry/opentelemetry-go-contrib/issues)
* [Pull requests
  59](/open-telemetry/opentelemetry-go-contrib/pulls)
* [Actions](/open-telemetry/opentelemetry-go-contrib/actions)
* [Projects
  3](/open-telemetry/opentelemetry-go-contrib/projects)
* [Security](/open-telemetry/opentelemetry-go-contrib/security)
* [Insights](/open-telemetry/opentelemetry-go-contrib/pulse)

Additional navigation options

* [Code](/open-telemetry/opentelemetry-go-contrib)
* [Issues](/open-telemetry/opentelemetry-go-contrib/issues)
* [Pull requests](/open-telemetry/opentelemetry-go-contrib/pulls)
* [Actions](/open-telemetry/opentelemetry-go-contrib/actions)
* [Projects](/open-telemetry/opentelemetry-go-contrib/projects)
* [Security](/open-telemetry/opentelemetry-go-contrib/security)
* [Insights](/open-telemetry/opentelemetry-go-contrib/pulse)

## Files

 5f7e6ad
## Breadcrumbs

1. [opentelemetry-go-contrib](/open-telemetry/opentelemetry-go-contrib/tree/5f7e6ad5a49b45df45f61a1deb29d7f1158032df)
2. /[instrumentation](/open-telemetry/opentelemetry-go-contrib/tree/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation)
3. /[net](/open-telemetry/opentelemetry-go-contrib/tree/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net)
4. /[http](/open-telemetry/opentelemetry-go-contrib/tree/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http)
5. /[otelhttp](/open-telemetry/opentelemetry-go-contrib/tree/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp)
/
# handler.go

Copy path Blame  Blame
## Latest commit

## History

[History](/open-telemetry/opentelemetry-go-contrib/commits/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go)264 lines (224 loc) · 8.23 KB 5f7e6ad
## Breadcrumbs

1. [opentelemetry-go-contrib](/open-telemetry/opentelemetry-go-contrib/tree/5f7e6ad5a49b45df45f61a1deb29d7f1158032df)
2. /[instrumentation](/open-telemetry/opentelemetry-go-contrib/tree/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation)
3. /[net](/open-telemetry/opentelemetry-go-contrib/tree/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net)
4. /[http](/open-telemetry/opentelemetry-go-contrib/tree/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http)
5. /[otelhttp](/open-telemetry/opentelemetry-go-contrib/tree/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp)
/
# handler.go

Top
## File metadata and controls

* Code
* Blame

264 lines (224 loc) · 8.23 KB[Raw](https://github.com/open-telemetry/opentelemetry-go-contrib/raw/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264// Copyright The OpenTelemetry Authors//// Licensed under the Apache License, Version 2.0 (the "License");// you may not use this file except in compliance with the License.// You may obtain a copy of the License at//// http://www.apache.org/licenses/LICENSE-2.0//// Unless required by applicable law or agreed to in writing, software// distributed under the License is distributed on an "AS IS" BASIS,// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.// See the License for the specific language governing permissions and// limitations under the License.
package otelhttp // import "go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp"
import ( "io" "net/http" "time"
 "github.com/felixge/httpsnoop"
 "go.opentelemetry.io/otel" "go.opentelemetry.io/otel/attribute" "go.opentelemetry.io/otel/metric" "go.opentelemetry.io/otel/metric/instrument" "go.opentelemetry.io/otel/propagation" semconv "go.opentelemetry.io/otel/semconv/v1.17.0" "go.opentelemetry.io/otel/semconv/v1.17.0/httpconv" "go.opentelemetry.io/otel/trace")
var \_ http.Handler = &Handler{}
// Handler is http middleware that corresponds to the http.Handler interface and// is designed to wrap a http.Mux (or equivalent), while individual routes on// the mux are wrapped with WithRouteTag. A Handler will add various attributes// to the span using the attribute.Keys defined in this package.type Handler struct { operation string server string handler http.Handler
 tracer trace.Tracer meter metric.Meter propagators propagation.TextMapPropagator spanStartOptions []trace.SpanStartOption readEvent bool writeEvent bool filters []Filter spanNameFormatter func(string, \*http.Request) string counters map[string]instrument.Int64Counter valueRecorders map[string]instrument.Float64Histogram publicEndpoint bool publicEndpointFn func(\*http.Request) bool}
func defaultHandlerFormatter(operation string, \_ \*http.Request) string { return operation}
// NewHandler wraps the passed handler, functioning like middleware, in a span// named after the operation and with any provided Options.func NewHandler(handler http.Handler, operation string, opts ...Option) http.Handler { h := Handler{ handler: handler, operation: operation, }
 defaultOpts := []Option{ WithSpanOptions(trace.WithSpanKind(trace.SpanKindServer)), WithSpanNameFormatter(defaultHandlerFormatter), }
 c := newConfig(append(defaultOpts, opts...)...) h.configure(c) h.createMeasures()
 return &h}
func (h \*Handler) configure(c \*config) { h.tracer = c.Tracer h.meter = c.Meter h.propagators = c.Propagators h.spanStartOptions = c.SpanStartOptions h.readEvent = c.ReadEvent h.writeEvent = c.WriteEvent h.filters = c.Filters h.spanNameFormatter = c.SpanNameFormatter h.publicEndpoint = c.PublicEndpoint h.publicEndpointFn = c.PublicEndpointFn h.server = c.ServerName}
func handleErr(err error) { if err != nil { otel.Handle(err) }}
func (h \*Handler) createMeasures() { h.counters = make(map[string]instrument.Int64Counter) h.valueRecorders = make(map[string]instrument.Float64Histogram)
 requestBytesCounter, err := h.meter.Int64Counter(RequestContentLength) handleErr(err)
 responseBytesCounter, err := h.meter.Int64Counter(ResponseContentLength) handleErr(err)
 serverLatencyMeasure, err := h.meter.Float64Histogram(ServerLatency) handleErr(err)
 h.counters[RequestContentLength] = requestBytesCounter h.counters[ResponseContentLength] = responseBytesCounter h.valueRecorders[ServerLatency] = serverLatencyMeasure}
// ServeHTTP serves HTTP requests (http.Handler).func (h \*Handler) ServeHTTP(w http.ResponseWriter, r \*http.Request) { requestStartTime := time.Now() for \_, f := range h.filters { if !f(r) { // Simply pass through to the handler if a filter rejects the request h.handler.ServeHTTP(w, r) return } }
 ctx := h.propagators.Extract(r.Context(), propagation.HeaderCarrier(r.Header)) opts := []trace.SpanStartOption{ trace.WithAttributes(httpconv.ServerRequest(h.server, r)...), } if h.server != "" { hostAttr := semconv.NetHostName(h.server) opts = append(opts, trace.WithAttributes(hostAttr)) } opts = append(opts, h.spanStartOptions...) if h.publicEndpoint || (h.publicEndpointFn != nil && h.publicEndpointFn(r.WithContext(ctx))) { opts = append(opts, trace.WithNewRoot()) // Linking incoming span context if any for public endpoint. if s := trace.SpanContextFromContext(ctx); s.IsValid() && s.IsRemote() { opts = append(opts, trace.WithLinks(trace.Link{SpanContext: s})) } }
 tracer := h.tracer
 if tracer == nil { if span := trace.SpanFromContext(r.Context()); span.SpanContext().IsValid() { tracer = newTracer(span.TracerProvider()) } else { tracer = newTracer(otel.GetTracerProvider()) } }
 ctx, span := tracer.Start(ctx, h.spanNameFormatter(h.operation, r), opts...) defer span.End()
 readRecordFunc := func(int64) {} if h.readEvent { readRecordFunc = func(n int64) { span.AddEvent("read", trace.WithAttributes(ReadBytesKey.Int64(n))) } }
 var bw bodyWrapper // if request body is nil or NoBody, we don't want to mutate the body as it // will affect the identity of it in an unforeseeable way because we assert // ReadCloser fulfills a certain interface and it is indeed nil or NoBody. if r.Body != nil && r.Body != http.NoBody { bw.ReadCloser = r.Body bw.record = readRecordFunc r.Body = &bw }
 writeRecordFunc := func(int64) {} if h.writeEvent { writeRecordFunc = func(n int64) { span.AddEvent("write", trace.WithAttributes(WroteBytesKey.Int64(n))) } }
 rww := &respWriterWrapper{ ResponseWriter: w, record: writeRecordFunc, ctx: ctx, props: h.propagators, statusCode: http.StatusOK, // default status code in case the Handler doesn't write anything }
 // Wrap w to use our ResponseWriter methods while also exposing // other interfaces that w may implement (http.CloseNotifier, // http.Flusher, http.Hijacker, http.Pusher, io.ReaderFrom).
 w = httpsnoop.Wrap(w, httpsnoop.Hooks{ Header: func(httpsnoop.HeaderFunc) httpsnoop.HeaderFunc { return rww.Header }, Write: func(httpsnoop.WriteFunc) httpsnoop.WriteFunc { return rww.Write }, WriteHeader: func(httpsnoop.WriteHeaderFunc) httpsnoop.WriteHeaderFunc { return rww.WriteHeader }, })
 labeler := &Labeler{} ctx = injectLabeler(ctx, labeler)
 h.handler.ServeHTTP(w, r.WithContext(ctx))
 setAfterServeAttributes(span, bw.read, rww.written, rww.statusCode, bw.err, rww.err)
 // Add metrics attributes := append(labeler.Get(), httpconv.ServerRequest(h.server, r)...) if rww.statusCode > 0 { attributes = append(attributes, semconv.HTTPStatusCode(rww.statusCode)) } h.counters[RequestContentLength].Add(ctx, bw.read, attributes...) h.counters[ResponseContentLength].Add(ctx, rww.written, attributes...)
 // Use floating point division here for higher precision (instead of Millisecond method). elapsedTime := float64(time.Since(requestStartTime)) / float64(time.Millisecond)
 h.valueRecorders[ServerLatency].Record(ctx, elapsedTime, attributes...)}
func setAfterServeAttributes(span trace.Span, read, wrote int64, statusCode int, rerr, werr error) { attributes := []attribute.KeyValue{}
 // TODO: Consider adding an event after each read and write, possibly as an // option (defaulting to off), so as to not create needlessly verbose spans. if read > 0 { attributes = append(attributes, ReadBytesKey.Int64(read)) } if rerr != nil && rerr != io.EOF { attributes = append(attributes, ReadErrorKey.String(rerr.Error())) } if wrote > 0 { attributes = append(attributes, WroteBytesKey.Int64(wrote)) } if statusCode > 0 { attributes = append(attributes, semconv.HTTPStatusCode(statusCode)) } span.SetStatus(httpconv.ServerStatus(statusCode))
 if werr != nil && werr != io.EOF { attributes = append(attributes, WriteErrorKey.String(werr.Error())) } span.SetAttributes(attributes...)}
// WithRouteTag annotates a span with the provided route name using the// RouteKey Tag.func WithRouteTag(route string, h http.Handler) http.Handler { return http.HandlerFunc(func(w http.ResponseWriter, r \*http.Request) { span := trace.SpanFromContext(r.Context()) span.SetAttributes(semconv.HTTPRoute(route)) h.ServeHTTP(w, r) })}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_faf5e8ec_20250115_085015.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Freleases%2Ftag%2Fv1.19.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Freleases%2Ftag%2Fv1.19.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=open-telemetry%2Fopentelemetry-go-contrib)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-telemetry](/open-telemetry)
/
**[opentelemetry-go-contrib](/open-telemetry/opentelemetry-go-contrib)**
Public

* [Notifications](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib) You must be signed in to change notification settings
* [Fork
  584](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib)
* [Star
   1.3k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib)

* [Code](/open-telemetry/opentelemetry-go-contrib/tree/v1.19.0)
* [Issues
  191](/open-telemetry/opentelemetry-go-contrib/issues)
* [Pull requests
  59](/open-telemetry/opentelemetry-go-contrib/pulls)
* [Actions](/open-telemetry/opentelemetry-go-contrib/actions)
* [Projects
  3](/open-telemetry/opentelemetry-go-contrib/projects)
* [Security](/open-telemetry/opentelemetry-go-contrib/security)
* [Insights](/open-telemetry/opentelemetry-go-contrib/pulse)

Additional navigation options

* [Code](/open-telemetry/opentelemetry-go-contrib/tree/v1.19.0)
* [Issues](/open-telemetry/opentelemetry-go-contrib/issues)
* [Pull requests](/open-telemetry/opentelemetry-go-contrib/pulls)
* [Actions](/open-telemetry/opentelemetry-go-contrib/actions)
* [Projects](/open-telemetry/opentelemetry-go-contrib/projects)
* [Security](/open-telemetry/opentelemetry-go-contrib/security)
* [Insights](/open-telemetry/opentelemetry-go-contrib/pulse)

1. [Releases](/open-telemetry/opentelemetry-go-contrib/releases)
2. [v1.19.0](/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0)

# Release v1.19.0/v0.44.0/v0.13.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/open-telemetry/opentelemetry-go-contrib/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.19.0)

 Loading

[View all tags](/open-telemetry/opentelemetry-go-contrib/tags)

![@MrAlias](https://avatars.githubusercontent.com/u/5543599?s=40&v=4)
[MrAlias](/MrAlias)
released this
12 Sep 18:49

·
[1075 commits](/open-telemetry/opentelemetry-go-contrib/compare/v1.19.0...main)
to main
since this release

[v1.19.0](/open-telemetry/opentelemetry-go-contrib/tree/v1.19.0)

This tag was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/5543599?s=64&v=4)](/MrAlias)
[MrAlias](/MrAlias)
Tyler Yahn

GPG key ID: 46B0F3E1A8B1BA5A

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

[`fdfa6e3`](/open-telemetry/opentelemetry-go-contrib/commit/fdfa6e3abf03caa6a1d3267913e01526d97eab8a)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

### Added

* Add `gcp.gce.instance.name` and `gcp.gce.instance.hostname` resource attributes to `go.opentelemetry.io/contrib/detectors/gcp`. ([#4263](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4263))

### Changed

* The semantic conventions used by `go.opentelemetry.io/contrib/detectors/aws/ec2` have been upgraded to v1.21.0. ([#4265](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4265))
* The semantic conventions used by `go.opentelemetry.io/contrib/detectors/aws/ecs` have been upgraded to v1.21.0. ([#4265](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4265))
* The semantic conventions used by `go.opentelemetry.io/contrib/detectors/aws/eks` have been upgraded to v1.21.0. ([#4265](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4265))
* The semantic conventions used by `go.opentelemetry.io/contrib/detectors/aws/lambda` have been upgraded to v1.21.0. ([#4265](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4265))
* The semantic conventions used by `go.opentelemetry.io/contrib/instrumentation/github.com/aws/aws-lambda-go/otellambda` have been upgraded to v1.21.0. ([#4265](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4265))
  + The `faas.execution` attribute is now `faas.invocation_id`.
  + The `faas.id` attribute is now `aws.lambda.invoked_arn`.
* The semantic conventions used by `go.opentelemetry.io/contrib/instrumentation/github.com/aws/aws-sdk-go-v2/otelaws` have been upgraded to v1.21.0. ([#4265](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4265))
* The `http.request.method` attribute will only allow known HTTP methods from the metrics generated by `go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp`. ([#4277](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277))

### Removed

* The high cardinality attributes `net.sock.peer.addr`, `net.sock.peer.port`, `http.user_agent`, `enduser.id`, and `http.client_ip` were removed from the metrics generated by `go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp`. ([#4277](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277))
* The deprecated `go.opentelemetry.io/contrib/instrumentation/github.com/astaxie/beego/otelbeego` module is removed. ([#4295](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4295))
* The deprecated `go.opentelemetry.io/contrib/instrumentation/github.com/go-kit/kit/otelkit` module is removed. ([#4295](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4295))
* The deprecated `go.opentelemetry.io/contrib/instrumentation/github.com/Shopify/sarama/otelsarama` module is removed. ([#4295](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4295))
* The deprecated `go.opentelemetry.io/contrib/instrumentation/github.com/bradfitz/gomemcache/memcache/otelmemcache` module is removed. ([#4295](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4295))
* The deprecated `go.opentelemetry.io/contrib/instrumentation/github.com/gocql/gocql/otelgocql` module is removed. ([#4295](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4295))

## New Contributors

* [@utsushiiro](https://github.com/utsushiiro) made their first contribution in [#4260](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4260)
* [@RangelReale](https://github.com/RangelReale) made their first contribution in [#4230](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4230)

**Full Changelog**: [v1.18.0...v1.19.0](https://github.com/open-telemetry/opentelemetry-go-contrib/compare/v1.18.0...v1.19.0)

### Contributors

* [![@RangelReale](https://avatars.githubusercontent.com/u/369785?s=64&v=4)](https://github.com/RangelReale)
* [![@utsushiiro](https://avatars.githubusercontent.com/u/20026847?s=64&v=4)](https://github.com/utsushiiro)

RangelReale and utsushiiro

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5de54ff9_20250115_085008.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-cg3q-j54f-5p7p)

**CVE-2022-21698**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-cg3q-j54f-5p7p)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2022-21698](/advisories/GHSA-cg3q-j54f-5p7p)

## Uncontrolled Resource Consumption in promhttp

High severity

GitHub Reviewed

Published
Feb 15, 2022
in
[prometheus/client\_golang](/prometheus/client_golang)
•
Updated Feb 15, 2023

[Vulnerability details](/advisories/GHSA-cg3q-j54f-5p7p)
[Dependabot alerts
0](/advisories/GHSA-cg3q-j54f-5p7p/dependabot)

## Package

gomod

github.com/prometheus/client\_golang
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

< 1.11.1

## Patched versions

1.11.1

## Description

This is the Go client library for Prometheus. It has two separate parts, one for instrumenting application code, and one for creating clients that talk to the Prometheus HTTP API. client\_golang is the instrumentation library for Go applications in Prometheus, and the promhttp package in client\_golang provides tooling around HTTP servers and clients.

### Impact

HTTP server susceptible to a Denial of Service through unbounded cardinality, and potential memory exhaustion, when handling requests with non-standard HTTP methods.

### Affected Configuration

In order to be affected, an instrumented software must

* Use any of `promhttp.InstrumentHandler*` middleware except `RequestsInFlight`.
* Do not filter any specific methods (e.g GET) before middleware.
* Pass metric with `method` label name to our middleware.
* Not have any firewall/LB/proxy that filters away requests with unknown `method`.

### Patches

* [prometheus/client\_golang#962](https://github.com/prometheus/client_golang/pull/962)
* [prometheus/client\_golang#987](https://github.com/prometheus/client_golang/pull/987)

### Workarounds

If you cannot upgrade to [v1.11.1 or above](https://github.com/prometheus/client_golang/releases/tag/v1.11.1), in order to stop being affected you can:

* Remove `method` label name from counter/gauge you use in the InstrumentHandler.
* Turn off affected promhttp handlers.
* Add custom middleware before promhttp handler that will sanitize the request method given by Go http.Request.
* Use a reverse proxy or web application firewall, configured to only allow a limited set of methods.

### For more information

If you have any questions or comments about this advisory:

* Open an issue in <https://github.com/prometheus/client_golang>
* Email us at `prometheus-team@googlegroups.com`

### References

* [GHSA-cg3q-j54f-5p7p](https://github.com/prometheus/client_golang/security/advisories/GHSA-cg3q-j54f-5p7p "GHSA-cg3q-j54f-5p7p")
* <https://nvd.nist.gov/vuln/detail/CVE-2022-21698>
* [prometheus/client\_golang#962](https://github.com/prometheus/client_golang/pull/962)
* [prometheus/client\_golang#987](https://github.com/prometheus/client_golang/pull/987)
* <https://github.com/prometheus/client_golang/releases/tag/v1.11.1>
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FY3N7H6VSDZM37B4SKM2PFFCUWU7QYWN/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FY3N7H6VSDZM37B4SKM2PFFCUWU7QYWN/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZKORFJTRRDJCWBTJPISKKCVMMMJBIRLG/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZKORFJTRRDJCWBTJPISKKCVMMMJBIRLG/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/AK7CJBCGERCRXYUR2EWDSSDVAQMTAZGX/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/AK7CJBCGERCRXYUR2EWDSSDVAQMTAZGX/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SASRKYHT5ZFSVMJUQUG3UAEQRJYGJKAR/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/SASRKYHT5ZFSVMJUQUG3UAEQRJYGJKAR/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7V7I72LSQ3IET3QJR6QPAVGJZ4CBDLN5/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7V7I72LSQ3IET3QJR6QPAVGJZ4CBDLN5/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KBMVIQFKQDSSTHVVJWJ4QH6TW3JVB7XZ/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KBMVIQFKQDSSTHVVJWJ4QH6TW3JVB7XZ/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2PFW6Q2LXXWTFRTMTRN4ZGADFRQPKJ3D/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2PFW6Q2LXXWTFRTMTRN4ZGADFRQPKJ3D/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/HLAQRRGNSO5MYCPAXGPH2OCSHOGHSQMQ/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/HLAQRRGNSO5MYCPAXGPH2OCSHOGHSQMQ/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/J5WPM42UR6XIBQNQPNQHM32X7S4LJTRX/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/J5WPM42UR6XIBQNQPNQHM32X7S4LJTRX/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/36GUEPA5TPSC57DZTPYPBL6T7UPQ2FRH/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/36GUEPA5TPSC57DZTPYPBL6T7UPQ2FRH/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4KDETHL5XCT6RZN2BBNOCEXRZ2W3SFU3/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4KDETHL5XCT6RZN2BBNOCEXRZ2W3SFU3/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DLUJZV3HBP56ADXU6QH2V7RNYUPMVBXQ/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/DLUJZV3HBP56ADXU6QH2V7RNYUPMVBXQ/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2IK53GWZ475OQ6ENABKMJMTOBZG6LXUR/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2IK53GWZ475OQ6ENABKMJMTOBZG6LXUR/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MH6ALXEQXIFQRQFNJ5Y2MJ5DFPIX76VN/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MH6ALXEQXIFQRQFNJ5Y2MJ5DFPIX76VN/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZY2SLWOQR4ZURQ7UBRZ7JIX6H6F5JHJR/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZY2SLWOQR4ZURQ7UBRZ7JIX6H6F5JHJR/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/5OGNAFVXSMTTT2UPH6CS3IH6L3KM42Q7/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/5OGNAFVXSMTTT2UPH6CS3IH6L3KM42Q7/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RN7JGC2LVHPEGSJYODFUV5FEKPBVG4D7/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RN7JGC2LVHPEGSJYODFUV5FEKPBVG4D7/)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/3L6GDN5S5QZSCFKWD3GKL2RDZQ6B4UWA/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/3L6GDN5S5QZSCFKWD3GKL2RDZQ6B4UWA/)
* <https://pkg.go.dev/vuln/GO-2022-0322>

[![@bwplotka](https://avatars.githubusercontent.com/u/6950331?s=40&v=4)](/bwplotka)
[bwplotka](/bwplotka)
published to
[prometheus/client\_golang](/prometheus/client_golang/security/advisories/GHSA-cg3q-j54f-5p7p)
Feb 15, 2022

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-21698)
Feb 15, 2022

Published to the GitHub Advisory Database
Feb 16, 2022

Reviewed
Feb 16, 2022

Last updated
Feb 15, 2023

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.754%
 (81st percentile)

### Weaknesses

[CWE-400](/advisories?query=cwe%3A400) [CWE-772](/advisories?query=cwe%3A772)

### CVE ID

CVE-2022-21698

### GHSA ID

GHSA-cg3q-j54f-5p7p

### Source code

[prometheus/client\_golang](https://github.com/prometheus/client_golang)

### Credits

* [![@dgl](https://avatars.githubusercontent.com/u/5385?s=40&v=4)](/dgl)
  [dgl](/dgl)
  Analyst

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-cg3q-j54f-5p7p/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.fedoraproject.org_4ef79dfe_20250115_085022.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/2UTRJ54INZG3OC2FTAN6AFB2RYNY2GAD/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/2UTRJ54INZG3OC2FTAN6AFB2RYNY2GAD/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/2UTRJ54INZG3OC2FTAN6AFB2RYNY2GAD/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/2UTRJ54INZG3OC2FTAN6AFB2RYNY2GAD/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-2UTRJ54INZG3OC2FTAN6AFB2RYNY2GAD.mbox.gz?message=2UTRJ54INZG3OC2FTAN6AFB2RYNY2GAD "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/2UTRJ54INZG3OC2FTAN6AFB2RYNY2GAD/#2UTRJ54INZG3OC2FTAN6AFB2RYNY2GAD)

# [SECURITY] Fedora 39 Update: caddy-2.7.6-1.fc39

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

19 Feb
2024

19 Feb
'24

3:29 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-22b915e51a
2024-02-19 02:27:28.284321
--------------------------------------------------------------------------------

Name : caddy
Product : Fedora 39
Version : 2.7.6
Release : 1.fc39
URL : <https://caddyserver.com>
Summary : Web server with automatic HTTPS
Description :
Caddy is an extensible server platform that uses TLS by default.

--------------------------------------------------------------------------------
Update Information:

Update to the latest upstream version, which includes a fix for CVE-2023-45142.
<https://github.com/caddyserver/caddy/releases/tag/v2.7.6>
--------------------------------------------------------------------------------
ChangeLog:

\* Fri Feb 9 2024 Carl George carlwgeorge@fedoraproject.org - 2.7.6-1
- Update to version 2.7.6 rhbz#2253698
- Includes fix for CVE-2023-45142 rhbz#2246587
\* Tue Jan 23 2024 Fedora Release Engineering releng@fedoraproject.org - 2.7.5-3
- Rebuilt for <https://fedoraproject.org/wiki/Fedora_40_Mass_Rebuild>
\* Fri Jan 19 2024 Fedora Release Engineering releng@fedoraproject.org - 2.7.5-2
- Rebuilt for <https://fedoraproject.org/wiki/Fedora_40_Mass_Rebuild>
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2246587 - CVE-2023-45142 caddy: opentelemetry-go-contrib: DoS vulnerability in otelhttp [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2246587>
[ 2 ] Bug #2253698 - caddy-2.7.6 is available
<https://bugzilla.redhat.com/show_bug.cgi?id=2253698>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-22b915e51a' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/2UTRJ54INZG3OC2FTAN6AFB2RYNY2GAD/#2UTRJ54INZG3OC2FTAN6AFB2RYNY2GAD)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from github.com_8a55cac4_20250115_085013.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fpull%2F4277)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fpull%2F4277)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=open-telemetry%2Fopentelemetry-go-contrib)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-telemetry](/open-telemetry)
/
**[opentelemetry-go-contrib](/open-telemetry/opentelemetry-go-contrib)**
Public

* [Notifications](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib) You must be signed in to change notification settings
* [Fork
  584](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib)
* [Star
   1.3k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib)

* [Code](/open-telemetry/opentelemetry-go-contrib)
* [Issues
  191](/open-telemetry/opentelemetry-go-contrib/issues)
* [Pull requests
  59](/open-telemetry/opentelemetry-go-contrib/pulls)
* [Actions](/open-telemetry/opentelemetry-go-contrib/actions)
* [Projects
  3](/open-telemetry/opentelemetry-go-contrib/projects)
* [Security](/open-telemetry/opentelemetry-go-contrib/security)
* [Insights](/open-telemetry/opentelemetry-go-contrib/pulse)

Additional navigation options

* [Code](/open-telemetry/opentelemetry-go-contrib)
* [Issues](/open-telemetry/opentelemetry-go-contrib/issues)
* [Pull requests](/open-telemetry/opentelemetry-go-contrib/pulls)
* [Actions](/open-telemetry/opentelemetry-go-contrib/actions)
* [Projects](/open-telemetry/opentelemetry-go-contrib/projects)
* [Security](/open-telemetry/opentelemetry-go-contrib/security)
* [Insights](/open-telemetry/opentelemetry-go-contrib/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Remove high cardanility metrics from otelhttp #4277

 Merged

[MrAlias](/MrAlias)
merged 9 commits into
[open-telemetry:main](/open-telemetry/opentelemetry-go-contrib/tree/main "open-telemetry/opentelemetry-go-contrib:main")
from
[MadVikingGod:mvg/http-metric-semconv](/MadVikingGod/opentelemetry-go-contrib/tree/mvg/http-metric-semconv "MadVikingGod/opentelemetry-go-contrib:mvg/http-metric-semconv")

Sep 7, 2023

 Merged

# [Remove high cardanility metrics from otelhttp](#top) #4277

[MrAlias](/MrAlias)
merged 9 commits into
[open-telemetry:main](/open-telemetry/opentelemetry-go-contrib/tree/main "open-telemetry/opentelemetry-go-contrib:main")
from
[MadVikingGod:mvg/http-metric-semconv](/MadVikingGod/opentelemetry-go-contrib/tree/mvg/http-metric-semconv "MadVikingGod/opentelemetry-go-contrib:mvg/http-metric-semconv")

Sep 7, 2023

[Conversation
12](/open-telemetry/opentelemetry-go-contrib/pull/4277)
[Commits
9](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits)
[Checks
0](/open-telemetry/opentelemetry-go-contrib/pull/4277/checks)
[Files changed](/open-telemetry/opentelemetry-go-contrib/pull/4277/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=60&v=4)](/MadVikingGod)

Copy link

Contributor

### @MadVikingGod **[MadVikingGod](/MadVikingGod)** commented [Sep 5, 2023](#issue-1882621195) • edited by MrAlias Loading

This does not upgrade to the latest semantic convention, that will be a different PR.

This removes the following attributes from the metrics that `go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp` generates:

* `net.sock.peer.addr`
* `net.sock.peer.port`
* `http.user_agent`
* `enduser.id`
* `http.client_ip`

This also only allows `http.request.method` to be known HTTP methods, or `_OTHER`.

Resolve [open-telemetry/opentelemetry-go#3765](https://github.com/open-telemetry/opentelemetry-go/issues/3765)

Sorry, something went wrong.

 👍
5
 pellared, tony612, johanstokking, programmer04, and zsgilber reacted with thumbs up emoji
 🎉
1
 mlaflamm reacted with hooray emoji

All reactions

* 👍
  5 reactions
* 🎉
  1 reaction

 [MadVikingGod](/MadVikingGod)
added 2 commits
[September 5, 2023 14:30](#commits-pushed-ddee5d5)

[![@MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=40&v=4)](/MadVikingGod)

`[Add a metric attribute SemConvUtil target.](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/ddee5d54ccc511c91ea1f8bdc318f0b5ab0e81eb "Add a metric attribute SemConvUtil target.")`

`[ddee5d5](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/ddee5d54ccc511c91ea1f8bdc318f0b5ab0e81eb)`

[![@MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=40&v=4)](/MadVikingGod)

`[changelog](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/eefbcdc32c634240659f6ede9c2b65c85b97f13d "changelog")`

`[eefbcdc](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/eefbcdc32c634240659f6ede9c2b65c85b97f13d)`

 [![@MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=40&u=0fb4f1c9a9cc552e3272fbcf4a4f706065be1e48&v=4)](/MadVikingGod)
[MadVikingGod](/MadVikingGod)
requested review from
[Aneurysm9](/Aneurysm9) and
[dmathieu](/dmathieu)
as [code owners](/open-telemetry/opentelemetry-go-contrib/blob/417fc12448f1c91f733a634062d985d97b2e07e3/CODEOWNERS#L46)
[September 5, 2023 19:46](#event-10287460612)

 [![@MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=40&u=0fb4f1c9a9cc552e3272fbcf4a4f706065be1e48&v=4)](/MadVikingGod)
[MadVikingGod](/MadVikingGod)
requested a review
from a team
[September 5, 2023 19:46](#event-10287460641)

 [![@MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=40&u=0fb4f1c9a9cc552e3272fbcf4a4f706065be1e48&v=4)](/MadVikingGod)
[MadVikingGod](/MadVikingGod)
requested a review
from [hanyuancheung](/hanyuancheung)
as a [code owner](/open-telemetry/opentelemetry-go-contrib/blob/417fc12448f1c91f733a634062d985d97b2e07e3/CODEOWNERS#L35)
[September 5, 2023 19:46](#event-10287460650)

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Sep 5, 2023](#issuecomment-1707225202) • edited Loading

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/pull/4277?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) Report Merging [#4277](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/pull/4277?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) ([3541453](https://github.com/open-telemetry/opentelemetry-go-contrib/commit/3541453403a126509b76d8e429a12e3d554a7a58)) into [main](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/commit/b6fc62f4da6f50864e04b800d5ef3326efe76617?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) ([b6fc62f](https://github.com/open-telemetry/opentelemetry-go-contrib/commit/b6fc62f4da6f50864e04b800d5ef3326efe76617)) will **increase** coverage by `0.0%`. The diff coverage is `82.6%`.  [Impacted file tree graph](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/pull/4277?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry)  ``` @@          Coverage Diff           @@ ##            main   #4277    +/-   ## ======================================   Coverage   79.4%   79.5%             ======================================   Files        166     166               Lines      10376   10677   +301      ====================================== + Hits        8246    8491   +245      - Misses      1996    2045    +49      - Partials     134     141     +7      ```  | [Files Changed](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/pull/4277?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) | Coverage | | --- | --- | | [...stful/otelrestful/internal/semconvutil/httpconv.go](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/pull/4277?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-aW5zdHJ1bWVudGF0aW9uL2dpdGh1Yi5jb20vZW1pY2tsZWkvZ28tcmVzdGZ1bC9vdGVscmVzdGZ1bC9pbnRlcm5hbC9zZW1jb252dXRpbC9odHRwY29udi5nbw==) | `82.6%` | | [...gonic/gin/otelgin/internal/semconvutil/httpconv.go](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/pull/4277?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-aW5zdHJ1bWVudGF0aW9uL2dpdGh1Yi5jb20vZ2luLWdvbmljL2dpbi9vdGVsZ2luL2ludGVybmFsL3NlbWNvbnZ1dGlsL2h0dHBjb252Lmdv) | `82.6%` | | [...rilla/mux/otelmux/internal/semconvutil/httpconv.go](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/pull/4277?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-aW5zdHJ1bWVudGF0aW9uL2dpdGh1Yi5jb20vZ29yaWxsYS9tdXgvb3RlbG11eC9pbnRlcm5hbC9zZW1jb252dXRpbC9odHRwY29udi5nbw==) | `82.6%` | | [...ack/echo/otelecho/internal/semconvutil/httpconv.go](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/pull/4277?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-aW5zdHJ1bWVudGF0aW9uL2dpdGh1Yi5jb20vbGFic3RhY2svZWNoby9vdGVsZWNoby9pbnRlcm5hbC9zZW1jb252dXRpbC9odHRwY29udi5nbw==) | `82.6%` | | [...on.v1/otelmacaron/internal/semconvutil/httpconv.go](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/pull/4277?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-aW5zdHJ1bWVudGF0aW9uL2dvcGtnLmluL21hY2Fyb24udjEvb3RlbG1hY2Fyb24vaW50ZXJuYWwvc2VtY29udnV0aWwvaHR0cGNvbnYuZ28=) | `82.6%` | | [...ace/otelhttptrace/internal/semconvutil/httpconv.go](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/pull/4277?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-aW5zdHJ1bWVudGF0aW9uL25ldC9odHRwL2h0dHB0cmFjZS9vdGVsaHR0cHRyYWNlL2ludGVybmFsL3NlbWNvbnZ1dGlsL2h0dHBjb252Lmdv) | `82.6%` | | [...net/http/otelhttp/internal/semconvutil/httpconv.go](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/pull/4277?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-aW5zdHJ1bWVudGF0aW9uL25ldC9odHRwL290ZWxodHRwL2ludGVybmFsL3NlbWNvbnZ1dGlsL2h0dHBjb252Lmdv) | `82.6%` | | [instrumentation/net/http/otelhttp/handler.go](https://app.codecov.io/gh/open-telemetry/opentelemetry-go-contrib/pull/4277?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-aW5zdHJ1bWVudGF0aW9uL25ldC9odHRwL290ZWxodHRwL2hhbmRsZXIuZ28=) | `100.0%` | |

All reactions

Sorry, something went wrong.

 [MadVikingGod](/MadVikingGod)
and others
added 2 commits
[September 5, 2023 15:49](#commits-pushed-1bc6fdf)

[![@MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=40&v=4)](/MadVikingGod)

`[Fix lint](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/1bc6fdf47e35b45f456df38940eb9ef849fdb5b3 "Fix lint")`

`[1bc6fdf](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/1bc6fdf47e35b45f456df38940eb9ef849fdb5b3)`

[![@hanyuancheung](https://avatars.githubusercontent.com/u/48237831?s=40&v=4)](/hanyuancheung)

`[Merge branch 'main' into mvg/http-metric-semconv](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/35684b201672bda5bb219c1f636d43679a3155b8 "Merge branch 'main' into mvg/http-metric-semconv")`

`[35684b2](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/35684b201672bda5bb219c1f636d43679a3155b8)`

[![hanyuancheung](https://avatars.githubusercontent.com/u/48237831?s=60&v=4)](/hanyuancheung)

**[hanyuancheung](/hanyuancheung)**
approved these changes
[Sep 6, 2023](#pullrequestreview-1612344666)

 [View reviewed changes](/open-telemetry/opentelemetry-go-contrib/pull/4277/files/1bc6fdf47e35b45f456df38940eb9ef849fdb5b3)

[![pellared](https://avatars.githubusercontent.com/u/5067549?s=60&v=4)](/pellared)

**[pellared](/pellared)**
reviewed
[Sep 6, 2023](#pullrequestreview-1612697898)

 [View reviewed changes](/open-telemetry/opentelemetry-go-contrib/pull/4277/files/35684b201672bda5bb219c1f636d43679a3155b8)

[instrumentation/github.com/gin-gonic/gin/otelgin/internal/semconvutil/httpconv.go](/open-telemetry/opentelemetry-go-contrib/pull/4277/files/35684b201672bda5bb219c1f636d43679a3155b8#diff-3aa9ef953cdaa3fd4ea00aa9ea0d828ceffd3d14a249c4fbb5a77ef38e6792d8)

Show resolved

Hide resolved

[instrumentation/github.com/gin-gonic/gin/otelgin/internal/semconvutil/httpconv.go](/open-telemetry/opentelemetry-go-contrib/pull/4277/files/35684b201672bda5bb219c1f636d43679a3155b8#diff-3aa9ef953cdaa3fd4ea00aa9ea0d828ceffd3d14a249c4fbb5a77ef38e6792d8)
Outdated

Show resolved

Hide resolved

[![@MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=40&v=4)](/MadVikingGod)

`[use switch over map lookup](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/417cf57483f6eb63e63968363cc35373bc8a4aa8 "use switch over map lookup")`

`[417cf57](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/417cf57483f6eb63e63968363cc35373bc8a4aa8)`

[![pellared](https://avatars.githubusercontent.com/u/5067549?s=60&v=4)](/pellared)

**[pellared](/pellared)**
reviewed
[Sep 6, 2023](#pullrequestreview-1613844666)

 [View reviewed changes](/open-telemetry/opentelemetry-go-contrib/pull/4277/files/417cf57483f6eb63e63968363cc35373bc8a4aa8)

[instrumentation/github.com/emicklei/go-restful/otelrestful/internal/semconvutil/httpconv.go](/open-telemetry/opentelemetry-go-contrib/pull/4277/files/417cf57483f6eb63e63968363cc35373bc8a4aa8#diff-273e99fb5e8109245a6871d3a1ea5904dda4af232f1bd74158027dea35f6d5de)

Show resolved

Hide resolved

 [MadVikingGod](/MadVikingGod)
and others
added 3 commits
[September 6, 2023 15:05](#commits-pushed-5a3f48f)

[![@MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=40&v=4)](/MadVikingGod)

`[Add top level HTTPServerRequestMetrics](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/5a3f48f7b7a21d45e26916bf239ba50f2dfb6ad1 "Add top level HTTPServerRequestMetrics
Make the otelhttp use the new function
Add test for new function.")`
 …

`[5a3f48f](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/5a3f48f7b7a21d45e26916bf239ba50f2dfb6ad1)`

```
Make the otelhttp use the new function
Add test for new function.
```

[![@pellared](https://avatars.githubusercontent.com/u/5067549?s=40&v=4)](/pellared)

`[Update CHANGELOG.md](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/aaecf6f3c830df0c9ad901d4e4af2037f20ddb28 "Update CHANGELOG.md")`

`[aaecf6f](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/aaecf6f3c830df0c9ad901d4e4af2037f20ddb28)`

[![@pellared](https://avatars.githubusercontent.com/u/5067549?s=40&v=4)](/pellared)

`[Merge branch 'main' into mvg/http-metric-semconv](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/e80a8c3e179aaddbd1966b421be948d3d8feecca "Merge branch 'main' into mvg/http-metric-semconv")`

`[e80a8c3](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/e80a8c3e179aaddbd1966b421be948d3d8feecca)`

[![pellared](https://avatars.githubusercontent.com/u/5067549?s=60&v=4)](/pellared)

**[pellared](/pellared)**
approved these changes
[Sep 7, 2023](#pullrequestreview-1615031328)

 [View reviewed changes](/open-telemetry/opentelemetry-go-contrib/pull/4277/files/aaecf6f3c830df0c9ad901d4e4af2037f20ddb28)

[![pellared](https://avatars.githubusercontent.com/u/5067549?s=60&v=4)](/pellared)

**[pellared](/pellared)**
requested changes
[Sep 7, 2023](#pullrequestreview-1615038645)

 [View reviewed changes](/open-telemetry/opentelemetry-go-contrib/pull/4277/files/e80a8c3e179aaddbd1966b421be948d3d8feecca)

[internal/shared/semconvutil/httpconv.go.tmpl](/open-telemetry/opentelemetry-go-contrib/pull/4277/files/e80a8c3e179aaddbd1966b421be948d3d8feecca#diff-2610d3fd3bed5e1b43bdaa2b058c6f623c6995da4ffa6faf8d3cd54967d3c722)
Outdated

Show resolved

Hide resolved

[internal/shared/semconvutil/httpconv.go.tmpl](/open-telemetry/opentelemetry-go-contrib/pull/4277/files/e80a8c3e179aaddbd1966b421be948d3d8feecca#diff-2610d3fd3bed5e1b43bdaa2b058c6f623c6995da4ffa6faf8d3cd54967d3c722)
Outdated

Show resolved

Hide resolved

[internal/shared/semconvutil/httpconv.go.tmpl](/open-telemetry/opentelemetry-go-contrib/pull/4277/files/e80a8c3e179aaddbd1966b421be948d3d8feecca#diff-2610d3fd3bed5e1b43bdaa2b058c6f623c6995da4ffa6faf8d3cd54967d3c722)
Outdated

Show resolved

Hide resolved

[![@MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=40&v=4)](/MadVikingGod)

`[Address PR comments](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/3541453403a126509b76d8e429a12e3d554a7a58 "Address PR comments")`

`[3541453](/open-telemetry/opentelemetry-go-contrib/pull/4277/commits/3541453403a126509b76d8e429a12e3d554a7a58)`

[![pellared](https://avatars.githubusercontent.com/u/5067549?s=60&v=4)](/pellared)

**[pellared](/pellared)**
approved these changes
[Sep 7, 2023](#pullrequestreview-1615861175)

 [View reviewed changes](/open-telemetry/opentelemetry-go-contrib/pull/4277/files/3541453403a126509b76d8e429a12e3d554a7a58)

[![@MrAlias](https://avatars.githubusercontent.com/u/5543599?s=40&u=f34eb596f4aeb4bff9eb2d57975df03f724a7968&v=4)](/MrAlias)
[MrAlias](/MrAlias)
merged commit [`50ca48f`](/open-telemetry/opentelemetry-go-contrib/commit/50ca48f8017e04bcf9149a5435e7f8f96f9e83c9)
into
open-telemetry:main

[Sep 7, 2023](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277#event-10309944518)

[![@MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=40&u=0fb4f1c9a9cc552e3272fbcf4a4f706065be1e48&v=4)](/MadVikingGod)
[MadVikingGod](/MadVikingGod)
added this to the [v0.44.0](/open-telemetry/opentelemetry-go-contrib/milestone/12) milestone
[Sep 7, 2023](#event-10310164733)

This was referenced Sep 12, 2023

[http.server.duration metric includes high cardinality attr: http.client\_ip
#3765](/open-telemetry/opentelemetry-go-contrib/issues/3765)

Closed

[Migrate from OpenCensus to OpenTelemetry
knative/pkg#855](/knative/pkg/issues/855)

Open

[![@davendu](https://avatars.githubusercontent.com/u/58910463?s=80&u=7a47726fc6f4700da2dd701ae2f558d68e27f00f&v=4)](/davendu)

Copy link

### **[davendu](/davendu)** commented [Sep 12, 2023](#issuecomment-1714986222)

| Weird. Why [@dmathieu](https://github.com/dmathieu) 's [previous suggestion](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/3980#pullrequestreview-1476833100) is not applied to this PR:  I don't think this is the proper approach. It's adding some weird complexity, and whether an attribute has too much cardinality or not is very subjective.  The solution being discussed in [open-telemetry/opentelemetry-specification#3061](https://github.com/open-telemetry/opentelemetry-specification/issues/3061) seems much better.  And what's the community's suggestion towards similar attributes? My own instrumentation library also needs some `high cardanility` attributes, and not sure if I should remove them or filter through the view. |
| --- |

All reactions

Sorry, something went wrong.

[![@dmathieu](https://avatars.githubusercontent.com/u/9347?s=80&u=ade95e23ea06fc13514de6a7bb9bf7b5b90d37a5&v=4)](/dmathieu)

Copy link

Member

### **[dmathieu](/dmathieu)** commented [Sep 12, 2023](#issuecomment-1715130393)

| This PR solves from a potential memory leak issue, since the values from those attributes are coming from untrusted sources. We should be able to bring back those attributes once something like [open-telemetry/opentelemetry-go#4457](https://github.com/open-telemetry/opentelemetry-go/pull/4457) is stable. |
| --- |

 👍
1
 davendu reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@FaranIdo](https://avatars.githubusercontent.com/u/22587682?s=80&u=9e99d0733af5fcdba5b3f924c9bcb38a09d6759d&v=4)](/FaranIdo)

Copy link

Contributor

### **[FaranIdo](/FaranIdo)** commented [Sep 12, 2023](#issuecomment-1715500350)

| [@dmathieu](https://github.com/dmathieu) [@pellared](https://github.com/pellared) [@MadVikingGod](https://github.com/MadVikingGod) do you plan to add a similar solution to otelgrpc to avoid high cardinality there as well? (I think reported here: [#3071](https://github.com/open-telemetry/opentelemetry-go-contrib/issues/3071)) |
| --- |

 👀
2
 thundering-herd and jpopadak reacted with eyes emoji

All reactions

* 👀
  2 reactions

Sorry, something went wrong.

[![@MrAlias](https://avatars.githubusercontent.com/u/5543599?s=40&u=f34eb596f4aeb4bff9eb2d57975df03f724a7968&v=4)](/MrAlias)
[MrAlias](/MrAlias)
mentioned this pull request
[Sep 12, 2023](#ref-pullrequest-1892742529)

[Release v1.19.0/v0.44.0/v0.13.0
#4299](/open-telemetry/opentelemetry-go-contrib/pull/4299)
 Merged

[![@tbuchaillot](https://avatars.githubusercontent.com/u/25751713?s=40&v=4)](/tbuchaillot)
[tbuchaillot](/tbuchaillot)
mentioned this pull request
[Oct 5, 2023](#ref-pullrequest-1926209130)

[TT-10153 Updating otelhttp to v0.44.0 and otel to v1.19.0
TykTechnologies/opentelemetry#30](/TykTechnologies/opentelemetry/pull/30)
 Merged

19 tasks

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Oct 12, 2023](#ref-issue-1940515344)

[x/vulndb: potential Go vuln in github.com/open-telemetry/opentelemetry-go-contrib: CVE-2023-45142
golang/vulndb#2113](/golang/vulndb/issues/2113)

Closed

80 hidden items

Load more…

This was referenced May 1, 2024

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.364
uniget-org/tools#4487](/uniget-org/tools/pull/4487)
 Merged

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.365
uniget-org/tools#4526](/uniget-org/tools/pull/4526)
 Merged

[chore(deps): update dependency uniget-org/renovate-custom
uniget-org/tools#4581](/uniget-org/tools/pull/4581)
 Merged

This was referenced May 9, 2024

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.368
uniget-org/tools#4633](/uniget-org/tools/pull/4633)
 Merged

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.369
uniget-org/tools#4695](/uniget-org/tools/pull/4695)
 Merged

This was referenced May 17, 2024

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.370
uniget-org/tools#4803](/uniget-org/tools/pull/4803)
 Merged

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.371
uniget-org/tools#4821](/uniget-org/tools/pull/4821)
 Merged

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.372
uniget-org/tools#4875](/uniget-org/tools/pull/4875)
 Merged

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[May 25, 2024](#ref-pullrequest-2316834356)

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.373
uniget-org/tools#4946](/uniget-org/tools/pull/4946)
 Merged

1 task

This was referenced Jun 14, 2024

[chore(deps): update dependency raystack/meteor to v0.10.0
uniget-org/tools#5357](/uniget-org/tools/pull/5357)
 Merged

[chore(deps): update dependency raystack/meteor to v0.10.1
uniget-org/tools#5368](/uniget-org/tools/pull/5368)
 Merged

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.377
uniget-org/tools#5443](/uniget-org/tools/pull/5443)
 Merged

This was referenced Jun 26, 2024

[Fixed hardcoded versions
uniget-org/tools#5538](/uniget-org/tools/pull/5538)
 Merged

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.378
uniget-org/tools#5578](/uniget-org/tools/pull/5578)
 Merged

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.380
uniget-org/tools#5600](/uniget-org/tools/pull/5600)
 Merged

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.381
uniget-org/tools#5650](/uniget-org/tools/pull/5650)
 Merged

This was referenced Jul 5, 2024

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.383
uniget-org/tools#5710](/uniget-org/tools/pull/5710)
 Merged

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.384
uniget-org/tools#5728](/uniget-org/tools/pull/5728)
 Merged

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.386
uniget-org/tools#5786](/uniget-org/tools/pull/5786)
 Merged

[Simplified or removed post\_install
uniget-org/tools#5850](/uniget-org/tools/pull/5850)
 Merged

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Jul 17, 2024](#ref-pullrequest-2414061088)

[chore(deps): update dependency kubernetes/kubernetes to v1.30.3
uniget-org/tools#5986](/uniget-org/tools/pull/5986)
 Merged

1 task

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Jul 25, 2024](#ref-pullrequest-2429364718)

[chore(deps): update dependency uniget-org/renovate-custom to v0.0.388
uniget-org/tools#6137](/uniget-org/tools/pull/6137)
 Merged

1 task

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Aug 7, 2024](#ref-pullrequest-2452654976)

[Added meteor-commit
uniget-org/tools#6397](/uniget-org/tools/pull/6397)
 Merged

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Sep 12, 2024](#ref-pullrequest-2521142828)

[chore(deps): update dependency kubernetes/kubernetes to v1.31.1
uniget-org/tools#7100](/uniget-org/tools/pull/7100)
 Merged

1 task

This was referenced Oct 23, 2024

[chore(deps): update dependency kubernetes/kubernetes to v1.31.2
uniget-org/tools#7891](/uniget-org/tools/pull/7891)
 Merged

[chore(deps): update dependency mutagen-io/mutagen-compose to v0.18.0
uniget-org/tools#7930](/uniget-org/tools/pull/7930)
 Merged

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Nov 1, 2024](#ref-pullrequest-2628152210)

[chore(deps): update dependency raystack/meteor to v0.11.0
uniget-org/tools#8097](/uniget-org/tools/pull/8097)
 Merged

1 task

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Nov 21, 2024](#ref-pullrequest-2677710187)

[chore(deps): update dependency kubernetes/kubernetes to v1.31.3
uniget-org/tools#8568](/uniget-org/tools/pull/8568)
 Merged

1 task

This was referenced Dec 11, 2024

[chore(deps): update dependency kubernetes/kubernetes to v1.31.4
uniget-org/tools#8973](/uniget-org/tools/pull/8973)
 Merged

[chore(deps): update dependency kubernetes/kubernetes to v1.32.0
uniget-org/tools#9008](/uniget-org/tools/pull/9008)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fpull%2F4277)

Reviewers

[![@hanyuancheung](https://avatars.githubusercontent.com/u/48237831?s=40&v=4)](/hanyuancheung) [hanyuancheung](/hanyuancheung)

hanyuancheung approved these changes

[![@pellared](https://avatars.githubusercontent.com/u/5067549?s=40&v=4)](/pellared) [pellared](/pellared)

pellared approved these changes

[![@Aneurysm9](https://avatars.githubusercontent.com/u/473616?s=40&v=4)](/Aneurysm9) [Aneurysm9](/Aneurysm9)

 Awaiting requested review from Aneurysm9

[![@dmathieu](https://avatars.githubusercontent.com/u/9347?s=40&v=4)](/dmathieu) [dmathieu](/dmathieu)

 Awaiting requested review from dmathieu

 dmathieu is a code owner

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**v1.20.0/v0.45.0**](/open-telemetry/opentelemetry-go-contrib/milestone/12 "v1.20.0/v0.45.0")

Development

Successfully merging this pull request may close these issues.

 [Metrics memory leak v1.12.0/v0.35.0 and up](https://github.com/open-telemetry/opentelemetry-go/issues/3765)

7 participants

[![@MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=52&v=4)](/MadVikingGod) [![@davendu](https://avatars.githubusercontent.com/u/58910463?s=52&v=4)](/davendu) [![@dmathieu](https://avatars.githubusercontent.com/u/9347?s=52&v=4)](/dmathieu) [![@FaranIdo](https://avatars.githubusercontent.com/u/22587682?s=52&v=4)](/FaranIdo) [![@pellared](https://avatars.githubusercontent.com/u/5067549?s=52&v=4)](/pellared) [![@hanyuancheung](https://avatars.githubusercontent.com/u/48237831?s=52&v=4)](/hanyuancheung) [![@MrAlias](https://avatars.githubusercontent.com/u/5543599?s=52&v=4)](/MrAlias)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_318b00d5_20250115_085015.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fsecurity%2Fadvisories%2FGHSA-5r5m-65gx-7vrh)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fsecurity%2Fadvisories%2FGHSA-5r5m-65gx-7vrh)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=open-telemetry%2Fopentelemetry-go-contrib)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-telemetry](/open-telemetry)
/
**[opentelemetry-go-contrib](/open-telemetry/opentelemetry-go-contrib)**
Public

* [Notifications](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib) You must be signed in to change notification settings
* [Fork
  584](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib)
* [Star
   1.3k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib)

* [Code](/open-telemetry/opentelemetry-go-contrib)
* [Issues
  191](/open-telemetry/opentelemetry-go-contrib/issues)
* [Pull requests
  59](/open-telemetry/opentelemetry-go-contrib/pulls)
* [Actions](/open-telemetry/opentelemetry-go-contrib/actions)
* [Projects
  3](/open-telemetry/opentelemetry-go-contrib/projects)
* [Security](/open-telemetry/opentelemetry-go-contrib/security)
* [Insights](/open-telemetry/opentelemetry-go-contrib/pulse)

Additional navigation options

* [Code](/open-telemetry/opentelemetry-go-contrib)
* [Issues](/open-telemetry/opentelemetry-go-contrib/issues)
* [Pull requests](/open-telemetry/opentelemetry-go-contrib/pulls)
* [Actions](/open-telemetry/opentelemetry-go-contrib/actions)
* [Projects](/open-telemetry/opentelemetry-go-contrib/projects)
* [Security](/open-telemetry/opentelemetry-go-contrib/security)
* [Insights](/open-telemetry/opentelemetry-go-contrib/pulse)

# DoS vulnerability for high cardinality metrics in otelhttp and otelbeego

High

[Aneurysm9](/Aneurysm9)
published
GHSA-5r5m-65gx-7vrh
Feb 8, 2023

## Package

gomod

go.opentelemetry.io/contrib/instrumentation/github.com/astaxie/beego/otelbeego
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

v0.38.0

## Patched versions

v0.39.0

gomod

go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp
([Go](/advisories?query=ecosystem%3Ago))

v0.38.0

v0.39.0

## Description

### Impact

The [v0.38.0](https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.13.0) release of [`go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp`](https://github.com/open-telemetry/opentelemetry-go-contrib/blob/463c2e7cd69d25f40b0a595b05394eeb26c68ae2/instrumentation/net/http/otelhttp/handler.go#L218) uses the [`httpconv.ServerRequest`](https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159) function to annotate metric measurements for the `http.server.request_content_length`, `http.server.response_content_length`, and `http.server.duration` instruments.

The `ServerRequest` function sets the `http.target` attribute value to be the whole request URI (including the query string)[1](#user-content-fn-1-3319ce88d6ef41b00dbebd28f031de14). The metric instruments do not "forget" previous measurement attributes when `cumulative` temporality is used, this means the cardinality of the measurements allocated is directly correlated with the unique URIs handled. If the query string is constantly random, this will result in a constant increase in memory allocation that can be used in a denial-of-service attack.

Pseudo-attack:

```
for infinite loop {
  r := generate_random_string()
  do_http_request("/some/path?random="+r)
}

```
### Patches

* `go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp` - v0.39.0
* `go.opentelemetry.io/contrib/instrumentation/github.com/astaxie/beego/otelbeego` - v0.39.0

## Footnotes

1. <https://github.com/open-telemetry/opentelemetry-go/blob/6cb5718eaaed5c408c3bf4ad1aecee5c20ccdaa9/semconv/internal/v2/http.go#L202-L208> [↩](#user-content-fnref-1-3319ce88d6ef41b00dbebd28f031de14)

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2023-25151

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_adb17600_20250115_085017.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fsecurity%2Fadvisories%2FGHSA-rcjv-mgp8-qvmr)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fsecurity%2Fadvisories%2FGHSA-rcjv-mgp8-qvmr)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=open-telemetry%2Fopentelemetry-go-contrib)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-telemetry](/open-telemetry)
/
**[opentelemetry-go-contrib](/open-telemetry/opentelemetry-go-contrib)**
Public

* [Notifications](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib) You must be signed in to change notification settings
* [Fork
  584](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib)
* [Star
   1.3k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib)

* [Code](/open-telemetry/opentelemetry-go-contrib)
* [Issues
  191](/open-telemetry/opentelemetry-go-contrib/issues)
* [Pull requests
  59](/open-telemetry/opentelemetry-go-contrib/pulls)
* [Actions](/open-telemetry/opentelemetry-go-contrib/actions)
* [Projects
  3](/open-telemetry/opentelemetry-go-contrib/projects)
* [Security](/open-telemetry/opentelemetry-go-contrib/security)
* [Insights](/open-telemetry/opentelemetry-go-contrib/pulse)

Additional navigation options

* [Code](/open-telemetry/opentelemetry-go-contrib)
* [Issues](/open-telemetry/opentelemetry-go-contrib/issues)
* [Pull requests](/open-telemetry/opentelemetry-go-contrib/pulls)
* [Actions](/open-telemetry/opentelemetry-go-contrib/actions)
* [Projects](/open-telemetry/opentelemetry-go-contrib/projects)
* [Security](/open-telemetry/opentelemetry-go-contrib/security)
* [Insights](/open-telemetry/opentelemetry-go-contrib/pulse)

# DoS vulnerability in otelhttp (uncontrolled resource consumption) due to unbound cardinality metrics

High

[arminru](/arminru)
published
GHSA-rcjv-mgp8-qvmr
Oct 12, 2023

## Package

gomod

go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

< 0.44.0

## Patched versions

0.44.0

## Description

### Summary

This handler wrapper

[opentelemetry-go-contrib/instrumentation/net/http/otelhttp/handler.go](https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65)

Lines 63 to 65
in
[5f7e6ad](/open-telemetry/opentelemetry-go-contrib/commit/5f7e6ad5a49b45df45f61a1deb29d7f1158032df)

|  | // NewHandler wraps the passed handler, functioning like middleware, in a span |
| --- | --- |
|  | // named after the operation and with any provided Options. |
|  | func NewHandler(handler http.Handler, operation string, opts ...Option) http.Handler { |

out of the box adds labels

* `http.user_agent`
* `http.method`

that have unbound cardinality. It leads to the server's potential memory exhaustion when many malicious requests are sent to it.

### Details

HTTP header User-Agent or HTTP method for requests can be easily set by an attacker to be random and long. The library internally uses [httpconv.ServerRequest](https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159) that records every value for HTTP [method](https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L204) and [User-Agent](https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223).

### PoC

Send many requests with long randomly generated HTTP methods or/and User agents (e.g. a million) and observe how memory consumption increases during it.

### Impact

In order to be affected, the program has to configure a metrics pipeline, use [otelhttp.NewHandler](https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65) wrapper, and does not filter any unknown HTTP methods or User agents on the level of CDN, LB, previous middleware, etc.

### Others

It is similar to already reported vulnerabilities

* [GHSA-5r5m-65gx-7vrh](https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh "GHSA-5r5m-65gx-7vrh") ([open-telemetry/opentelemetry-go-contrib](https://github.com/open-telemetry/opentelemetry-go-contrib))
* [GHSA-cg3q-j54f-5p7p](https://github.com/advisories/GHSA-cg3q-j54f-5p7p "GHSA-cg3q-j54f-5p7p") ([prometheus/client\_golang](https://github.com/prometheus/client_golang))

### Workaround for affected versions

As a workaround to stop being affected [otelhttp.WithFilter()](https://pkg.go.dev/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp/filters) can be used, but it requires manual careful configuration to not log certain requests entirely.

For convenience and safe usage of this library, it should by default mark with the label `unknown` non-standard HTTP methods and User agents to show that such requests were made but do not increase cardinality. In case someone wants to stay with the current behavior, library API should allow to enable it.

The other possibility is to disable HTTP metrics instrumentation by passing [`otelhttp.WithMeterProvider`](https://pkg.go.dev/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp#WithMeterProvider) option with [`noop.NewMeterProvider`](https://pkg.go.dev/go.opentelemetry.io/otel/metric/noop#NewMeterProvider).

### Solution provided by upgrading

In PR [#4277](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277), released with package version 0.44.0, the values collected for attribute `http.request.method` were changed to be restricted to a set of well-known values and other high cardinality attributes were removed.

### References

* [#4277](https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277)
* <https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0>

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2023-45142

### Weaknesses

No CWEs

### Credits

* [![@programmer04](https://avatars.githubusercontent.com/u/9593424?s=40&v=4)](/programmer04)
  [programmer04](/programmer04)
  Reporter
* [![@MadVikingGod](https://avatars.githubusercontent.com/u/3766680?s=40&v=4)](/MadVikingGod)
  [MadVikingGod](/MadVikingGod)
  Remediation developer
* [![@arminru](https://avatars.githubusercontent.com/u/7052238?s=40&v=4)](/arminru)
  [arminru](/arminru)
  Coordinator
* [![@pellared](https://avatars.githubusercontent.com/u/5067549?s=40&v=4)](/pellared)
  [pellared](/pellared)
  Remediation reviewer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_454d1410_20250115_085018.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go%2Fblob%2F38e1b499c3da3107694ad2660b3888eee9c8b896%2Fsemconv%2Finternal%2Fv2%2Fhttp.go)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go%2Fblob%2F38e1b499c3da3107694ad2660b3888eee9c8b896%2Fsemconv%2Finternal%2Fv2%2Fhttp.go)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=open-telemetry%2Fopentelemetry-go)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-telemetry](/open-telemetry)
/
**[opentelemetry-go](/open-telemetry/opentelemetry-go)**
Public

* [Notifications](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go)
* [Star
   5.4k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go)

* [Code](/open-telemetry/opentelemetry-go)
* [Issues
  156](/open-telemetry/opentelemetry-go/issues)
* [Pull requests
  34](/open-telemetry/opentelemetry-go/pulls)
* [Discussions](/open-telemetry/opentelemetry-go/discussions)
* [Actions](/open-telemetry/opentelemetry-go/actions)
* [Projects
  5](/open-telemetry/opentelemetry-go/projects)
* [Security](/open-telemetry/opentelemetry-go/security)
* [Insights](/open-telemetry/opentelemetry-go/pulse)

Additional navigation options

* [Code](/open-telemetry/opentelemetry-go)
* [Issues](/open-telemetry/opentelemetry-go/issues)
* [Pull requests](/open-telemetry/opentelemetry-go/pulls)
* [Discussions](/open-telemetry/opentelemetry-go/discussions)
* [Actions](/open-telemetry/opentelemetry-go/actions)
* [Projects](/open-telemetry/opentelemetry-go/projects)
* [Security](/open-telemetry/opentelemetry-go/security)
* [Insights](/open-telemetry/opentelemetry-go/pulse)

## Files

 38e1b49
## Breadcrumbs

1. [opentelemetry-go](/open-telemetry/opentelemetry-go/tree/38e1b499c3da3107694ad2660b3888eee9c8b896)
2. /[semconv](/open-telemetry/opentelemetry-go/tree/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv)
3. /[internal](/open-telemetry/opentelemetry-go/tree/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal)
4. /[v2](/open-telemetry/opentelemetry-go/tree/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2)
/
# http.go

Copy path Blame  Blame
## Latest commit

## History

[History](/open-telemetry/opentelemetry-go/commits/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go)404 lines (363 loc) · 11.6 KB 38e1b49
## Breadcrumbs

1. [opentelemetry-go](/open-telemetry/opentelemetry-go/tree/38e1b499c3da3107694ad2660b3888eee9c8b896)
2. /[semconv](/open-telemetry/opentelemetry-go/tree/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv)
3. /[internal](/open-telemetry/opentelemetry-go/tree/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal)
4. /[v2](/open-telemetry/opentelemetry-go/tree/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2)
/
# http.go

Top
## File metadata and controls

* Code
* Blame

404 lines (363 loc) · 11.6 KB[Raw](https://github.com/open-telemetry/opentelemetry-go/raw/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404// Copyright The OpenTelemetry Authors//// Licensed under the Apache License, Version 2.0 (the "License");// you may not use this file except in compliance with the License.// You may obtain a copy of the License at//// http://www.apache.org/licenses/LICENSE-2.0//// Unless required by applicable law or agreed to in writing, software// distributed under the License is distributed on an "AS IS" BASIS,// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.// See the License for the specific language governing permissions and// limitations under the License.
package internal // import "go.opentelemetry.io/otel/semconv/internal/v2"
import ( "fmt" "net/http" "strings"
 "go.opentelemetry.io/otel/attribute" "go.opentelemetry.io/otel/codes")
// HTTPConv are the HTTP semantic convention attributes defined for a version// of the OpenTelemetry specification.type HTTPConv struct { NetConv \*NetConv
 EnduserIDKey attribute.Key HTTPClientIPKey attribute.Key HTTPFlavorKey attribute.Key HTTPMethodKey attribute.Key HTTPRequestContentLengthKey attribute.Key HTTPResponseContentLengthKey attribute.Key HTTPRouteKey attribute.Key HTTPSchemeHTTP attribute.KeyValue HTTPSchemeHTTPS attribute.KeyValue HTTPStatusCodeKey attribute.Key HTTPTargetKey attribute.Key HTTPURLKey attribute.Key HTTPUserAgentKey attribute.Key}
// ClientResponse returns attributes for an HTTP response received by a client// from a server. The following attributes are returned if the related values// are defined in resp: "http.status.code", "http.response\_content\_length".//// This does not add all OpenTelemetry required attributes for an HTTP event,// it assumes ClientRequest was used to create the span with a complete set of// attributes. If a complete set of attributes can be generated using the// request contained in resp. For example://// append(ClientResponse(resp), ClientRequest(resp.Request)...)func (c \*HTTPConv) ClientResponse(resp \*http.Response) []attribute.KeyValue { var n int if resp.StatusCode > 0 { n++ } if resp.ContentLength > 0 { n++ }
 attrs := make([]attribute.KeyValue, 0, n) if resp.StatusCode > 0 { attrs = append(attrs, c.HTTPStatusCodeKey.Int(resp.StatusCode)) } if resp.ContentLength > 0 { attrs = append(attrs, c.HTTPResponseContentLengthKey.Int(int(resp.ContentLength))) } return attrs}
// ClientRequest returns attributes for an HTTP request made by a client. The// following attributes are always returned: "http.url", "http.flavor",// "http.method", "net.peer.name". The following attributes are returned if the// related values are defined in req: "net.peer.port", "http.user\_agent",// "http.request\_content\_length", "enduser.id".func (c \*HTTPConv) ClientRequest(req \*http.Request) []attribute.KeyValue { n := 3 // URL, peer name, proto, and method. var h string if req.URL != nil { h = req.URL.Host } peer, p := firstHostPort(h, req.Header.Get("Host")) port := requiredHTTPPort(req.URL != nil && req.URL.Scheme == "https", p) if port > 0 { n++ } useragent := req.UserAgent() if useragent != "" { n++ } if req.ContentLength > 0 { n++ } userID, \_, hasUserID := req.BasicAuth() if hasUserID { n++ } attrs := make([]attribute.KeyValue, 0, n)
 attrs = append(attrs, c.method(req.Method)) attrs = append(attrs, c.proto(req.Proto))
 var u string if req.URL != nil { // Remove any username/password info that may be in the URL. userinfo := req.URL.User req.URL.User = nil u = req.URL.String() // Restore any username/password info that was removed. req.URL.User = userinfo } attrs = append(attrs, c.HTTPURLKey.String(u))
 attrs = append(attrs, c.NetConv.PeerName(peer)) if port > 0 { attrs = append(attrs, c.NetConv.PeerPort(port)) }
 if useragent != "" { attrs = append(attrs, c.HTTPUserAgentKey.String(useragent)) }
 if l := req.ContentLength; l > 0 { attrs = append(attrs, c.HTTPRequestContentLengthKey.Int64(l)) }
 if hasUserID { attrs = append(attrs, c.EnduserIDKey.String(userID)) }
 return attrs}
// ServerRequest returns attributes for an HTTP request received by a server.//// The server must be the primary server name if it is known. For example this// would be the ServerName directive// (https://httpd.apache.org/docs/2.4/mod/core.html#servername) for an Apache// server, and the server\_name directive// (http://nginx.org/en/docs/http/ngx\_http\_core\_module.html#server\_name) for an// nginx server. More generically, the primary server name would be the host// header value that matches the default virtual host of an HTTP server. It// should include the host identifier and if a port is used to route to the// server that port identifier should be included as an appropriate port// suffix.//// If the primary server name is not known, server should be an empty string.// The req Host will be used to determine the server instead.//// The following attributes are always returned: "http.method", "http.scheme",// "http.flavor", "http.target", "net.host.name". The following attributes are// returned if they related values are defined in req: "net.host.port",// "net.sock.peer.addr", "net.sock.peer.port", "http.user\_agent", "enduser.id",// "http.client\_ip".func (c \*HTTPConv) ServerRequest(server string, req \*http.Request) []attribute.KeyValue { // TODO: This currently does not add the specification required // `http.target` attribute. It has too high of a cardinality to safely be // added. An alternate should be added, or this comment removed, when it is // addressed by the specification. If it is ultimately decided to continue // not including the attribute, the HTTPTargetKey field of the HTTPConv // should be removed as well.
 n := 4 // Method, scheme, proto, and host name. var host string var p int if server == "" { host, p = splitHostPort(req.Host) } else { // Prioritize the primary server name. host, p = splitHostPort(server) if p < 0 { \_, p = splitHostPort(req.Host) } } hostPort := requiredHTTPPort(req.TLS != nil, p) if hostPort > 0 { n++ } peer, peerPort := splitHostPort(req.RemoteAddr) if peer != "" { n++ if peerPort > 0 { n++ } } useragent := req.UserAgent() if useragent != "" { n++ } userID, \_, hasUserID := req.BasicAuth() if hasUserID { n++ } clientIP := serverClientIP(req.Header.Get("X-Forwarded-For")) if clientIP != "" { n++ } attrs := make([]attribute.KeyValue, 0, n)
 attrs = append(attrs, c.method(req.Method)) attrs = append(attrs, c.scheme(req.TLS != nil)) attrs = append(attrs, c.proto(req.Proto)) attrs = append(attrs, c.NetConv.HostName(host))
 if hostPort > 0 { attrs = append(attrs, c.NetConv.HostPort(hostPort)) }
 if peer != "" { // The Go HTTP server sets RemoteAddr to "IP:port", this will not be a // file-path that would be interpreted with a sock family. attrs = append(attrs, c.NetConv.SockPeerAddr(peer)) if peerPort > 0 { attrs = append(attrs, c.NetConv.SockPeerPort(peerPort)) } }
 if useragent != "" { attrs = append(attrs, c.HTTPUserAgentKey.String(useragent)) }
 if hasUserID { attrs = append(attrs, c.EnduserIDKey.String(userID)) }
 if clientIP != "" { attrs = append(attrs, c.HTTPClientIPKey.String(clientIP)) }
 return attrs}
func (c \*HTTPConv) method(method string) attribute.KeyValue { if method == "" { return c.HTTPMethodKey.String(http.MethodGet) } return c.HTTPMethodKey.String(method)}
func (c \*HTTPConv) scheme(https bool) attribute.KeyValue { // nolint:revive if https { return c.HTTPSchemeHTTPS } return c.HTTPSchemeHTTP}
func (c \*HTTPConv) proto(proto string) attribute.KeyValue { switch proto { case "HTTP/1.0": return c.HTTPFlavorKey.String("1.0") case "HTTP/1.1": return c.HTTPFlavorKey.String("1.1") case "HTTP/2": return c.HTTPFlavorKey.String("2.0") case "HTTP/3": return c.HTTPFlavorKey.String("3.0") default: return c.HTTPFlavorKey.String(proto) }}
func serverClientIP(xForwardedFor string) string { if idx := strings.Index(xForwardedFor, ","); idx >= 0 { xForwardedFor = xForwardedFor[:idx] } return xForwardedFor}
func requiredHTTPPort(https bool, port int) int { // nolint:revive if https { if port > 0 && port != 443 { return port } } else { if port > 0 && port != 80 { return port } } return -1}
// Return the request host and port from the first non-empty source.func firstHostPort(source ...string) (host string, port int) { for \_, hostport := range source { host, port = splitHostPort(hostport) if host != "" || port > 0 { break } } return}
// RequestHeader returns the contents of h as OpenTelemetry attributes.func (c \*HTTPConv) RequestHeader(h http.Header) []attribute.KeyValue { return c.header("http.request.header", h)}
// ResponseHeader returns the contents of h as OpenTelemetry attributes.func (c \*HTTPConv) ResponseHeader(h http.Header) []attribute.KeyValue { return c.header("http.response.header", h)}
func (c \*HTTPConv) header(prefix string, h http.Header) []attribute.KeyValue { key := func(k string) attribute.Key { k = strings.ToLower(k) k = strings.ReplaceAll(k, "-", "\_") k = fmt.Sprintf("%s.%s", prefix, k) return attribute.Key(k) }
 attrs := make([]attribute.KeyValue, 0, len(h)) for k, v := range h { attrs = append(attrs, key(k).StringSlice(v)) } return attrs}
// ClientStatus returns a span status code and message for an HTTP status code// value received by a client.func (c \*HTTPConv) ClientStatus(code int) (codes.Code, string) { stat, valid := validateHTTPStatusCode(code) if !valid { return stat, fmt.Sprintf("Invalid HTTP status code %d", code) } return stat, ""}
// ServerStatus returns a span status code and message for an HTTP status code// value returned by a server. Status codes in the 400-499 range are not// returned as errors.func (c \*HTTPConv) ServerStatus(code int) (codes.Code, string) { stat, valid := validateHTTPStatusCode(code) if !valid { return stat, fmt.Sprintf("Invalid HTTP status code %d", code) }
 if code/100 == 4 { return codes.Unset, "" } return stat, ""}
type codeRange struct { fromInclusive int toInclusive int}
func (r codeRange) contains(code int) bool { return r.fromInclusive <= code && code <= r.toInclusive}
var validRangesPerCategory = map[int][]codeRange{ 1: { {http.StatusContinue, http.StatusEarlyHints}, }, 2: { {http.StatusOK, http.StatusAlreadyReported}, {http.StatusIMUsed, http.StatusIMUsed}, }, 3: { {http.StatusMultipleChoices, http.StatusUseProxy}, {http.StatusTemporaryRedirect, http.StatusPermanentRedirect}, }, 4: { {http.StatusBadRequest, http.StatusTeapot}, // yes, teapot is so useful… {http.StatusMisdirectedRequest, http.StatusUpgradeRequired}, {http.StatusPreconditionRequired, http.StatusTooManyRequests}, {http.StatusRequestHeaderFieldsTooLarge, http.StatusRequestHeaderFieldsTooLarge}, {http.StatusUnavailableForLegalReasons, http.StatusUnavailableForLegalReasons}, }, 5: { {http.StatusInternalServerError, http.StatusLoopDetected}, {http.StatusNotExtended, http.StatusNetworkAuthenticationRequired}, },}
// validateHTTPStatusCode validates the HTTP status code and returns// corresponding span status code. If the `code` is not a valid HTTP status// code, returns span status Error and false.func validateHTTPStatusCode(code int) (codes.Code, bool) { category := code / 100 ranges, ok := validRangesPerCategory[category] if !ok { return codes.Error, false } ok = false for \_, crange := range ranges { ok = crange.contains(code) if ok { break } } if !ok { return codes.Error, false } if category > 0 && category < 4 { return codes.Unset, true } return codes.Error, true}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


