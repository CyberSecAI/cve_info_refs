Based on the provided content, here's an analysis of CVE-2023-45889:

**Root cause of vulnerability:**
- The vulnerability is due to an insufficient patch for a previous vulnerability (CVE-2022-48612) in the ClassLink OneClick extension.
- The patch implemented a regular expression (regex) to validate the origin of the request. However, the regex was flawed and did not properly account for specially crafted attacker-controlled origins.

**Weaknesses/vulnerabilities present:**
- The primary weakness is the flawed regex used for origin validation. The regex did not prevent origins with chained subdomains or userinfo subcomponents from bypassing the check.
- Specifically, the regex `r = "^https:\\/\\/(betalaunchpad\\.classlink\\.com|stagingclouddesktop\\.classlink\\.com|launchpad\\.classlink\\.com|my\\.classlink\\.eu|betamyapps\\.classlink\\.com|stagingmyapps\\.classlink\\.com|myapps\\.classlink\\.com|betateacherconsole\\.classlink\\.com|stagingteacherconsole\\.classlink\\.com|teacherconsole\\.classlink\\.com|betamybackpack\\.classlink\\.com|stagingmybackpack\\.classlink\\.com|mybackpack\\.classlink\\.com)";` failed to block crafted origins such as `https://betalaunchpad.classlink.com.example.com` and `https://betalaunchpad.classlink.com@example.com`.
- This allowed the `s` function (responsible for sending "initiate-sso" message) to be triggered from attacker-controlled origins.
- The `s` function takes in user controlled data as parameter which is passed to `initiate-sso` message, leading to universal cross-site scripting.

**Impact of exploitation:**
- Universal Cross-Site Scripting (UXSS): An attacker can inject arbitrary JavaScript code into any page by controlling `appResponse.pre_auth_script`. This can lead to session hijacking, data theft, and other malicious activities.

**Attack vectors:**
- The attack vector involves crafting a malicious page with the necessary HTML elements to trigger the vulnerable code path in the ClassLink extension.
- The attacker needs to include a button with classes `bg-info` and `js-uc`, along with the attribute `data-index="0"`.
- The attacker must host the malicious page on a domain that bypasses the flawed regex check, for example: `https://betalaunchpad.classlink.com.example.com`
- When a user clicks the button, the extension sends an `initiate-sso` message with the attacker controlled origin, which then calls the vulnerable `e` function in the injected.js and injects the attacker controlled script in `appResponse.pre_auth_script`

**Required attacker capabilities/position:**
- The attacker needs the ability to host a malicious web page that a victim user with the vulnerable ClassLink extension would visit.
- The attacker does not require access to the user's ClassLink credentials, or the user's device. The attack occurs through the user's browser.

**Additional details**

- The vulnerability is a bypass of a previous patch for CVE-2022-48612.
- The attacker needs to set  `appResponse.userauth` to `[""]` to prevent an out of bounds array index error.
- For successful exploitation on Edge, the attacker must also include `selectors` in the payload `appResponse` e.g. `{"userauth": [""], "pre_auth_script": "alert(window.location)", "selectors": [""]}`
- The content includes a proof of concept that demonstrates the exploit.
- The author mentions that the use of the browser's URL API instead of a custom regex would have been a more robust approach.
- The timeline of reporting and patching efforts is included, showing significant delays and lack of communication from ClassLink.