Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2023-7071

**Root Cause of Vulnerability:**
- Insufficient input sanitization and output escaping in the `TableOfContents.php` file of the Essential Blocks plugin. The plugin fails to properly sanitize user-controlled input within the Table of Contents block, specifically when processing post content to generate the table of contents.

**Weaknesses/Vulnerabilities Present:**
- Stored Cross-Site Scripting (XSS) vulnerability.

**Impact of Exploitation:**
- An attacker can inject arbitrary web scripts into pages. When a user accesses a page containing the malicious script, the script will execute, potentially leading to:
  - Session hijacking
  - Defacement
  - Phishing attacks
  - Other malicious activities

**Attack Vectors:**
- The vulnerability is triggered when the Table of Contents block is used on a page and user-supplied content is processed to create the table of contents. An attacker can inject malicious code through post content that will then be used by the vulnerable functionality.

**Required Attacker Capabilities/Position:**
- The attacker must be an authenticated user with at least contributor-level access to WordPress.
- The attacker needs the ability to create or edit posts, where they can add the Table of Contents block and inject malicious content.

**Additional Details:**

- The vulnerability is present in versions of the Essential Blocks plugin up to and including 4.4.6.
- The vulnerability was patched in version 4.4.7.
- The vulnerable code is located in the `blocks/TableOfContents.php` file. The code changes in changeset 3018547 are directly related to the fix of this vulnerability, by updating the way post content is processed. Specifically, the problematic use of  `htmlentities`, `utf8_decode` and `htmlspecialchars_decode` to sanitize content was replaced with the use of `DOMDocument` and `loadHTML` to parse the content.

**Summary:**
The Essential Blocks plugin was vulnerable to Stored XSS, which could allow authenticated users to inject malicious scripts into site content by using the table of content block. The vulnerability stemmed from insufficient sanitization of post content before being used by the table of content functionality.