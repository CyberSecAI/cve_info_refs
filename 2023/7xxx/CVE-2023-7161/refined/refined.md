The content is related to CVE-2023-7161.

**Root cause of vulnerability:**
The Netcom NS-ASG application security gateway version 6.3.1 is vulnerable to SQL injection.

**Weaknesses/vulnerabilities present:**
- SQL Injection vulnerability exists in the `login_check` functionality.
- The vulnerability is present in the `check_VirtualSiteId` parameter.
- The `updatexml` function is used in the exploit to extract the database name.

**Impact of exploitation:**
- An attacker can execute arbitrary SQL queries.
- The attacker can retrieve sensitive information, including the database name. In the provided example, it retrieves the database name: `iscserver`.

**Attack vectors:**
- The vulnerability can be exploited by sending a crafted HTTP POST request to the `/vpnweb/index.php` endpoint.
- The attacker manipulates the `check_VirtualSiteId` parameter by injecting SQL code.

**Required attacker capabilities/position:**
- The attacker must be able to send HTTP POST requests to the vulnerable server.
- The attacker needs to know the vulnerable parameter name `check_VirtualSiteId`.
- No authentication is required to trigger the vulnerability.