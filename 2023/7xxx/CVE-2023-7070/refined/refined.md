Based on the provided content, here's an analysis of CVE-2023-7070:

**1. Verification of CVE Relevance:**

The content directly relates to CVE-2023-7070. The Wordfence article explicitly identifies the vulnerability and references the vulnerable code in the `email-encoder-bundle` plugin. The Trac changeset also highlights code modifications related to sanitization.

**2. Root Cause of Vulnerability:**

The root cause is insufficient input sanitization and output escaping of user-supplied attributes within the `eeb_mailto` shortcode of the "Email Encoder â€“ Protect Email Addresses and Phone Numbers" WordPress plugin. Specifically, the `display` and `noscript` attributes of the `eeb_mailto` shortcode were not properly sanitized.

**3. Weaknesses/Vulnerabilities Present:**

-   **Stored Cross-Site Scripting (XSS):** The primary vulnerability is a stored XSS. This means that malicious scripts can be injected into the database (via shortcode attributes) and executed when a user views the affected content.
-   **Insufficient Input Sanitization:** The plugin failed to adequately sanitize user-provided data in shortcode attributes before storing them in the database.
-   **Improper Output Escaping:** The plugin also failed to properly escape the stored, unsanitized attributes when rendering the page, which allowed the injection of malicious code.

**4. Impact of Exploitation:**

-   **Arbitrary Script Execution:** An attacker can inject arbitrary JavaScript code into a page. This code executes when a user views the page.
-   **Account Takeover:** Attackers can potentially use the injected script for various malicious purposes, such as redirecting users to malicious sites, stealing cookies, or performing actions on behalf of the user, which could lead to account takeover or data exfiltration.
-   **Website Defacement:** The injected scripts could also be used to deface the website.

**5. Attack Vectors:**

-   **Shortcode Injection:** An attacker injects the malicious script by crafting a `eeb_mailto` shortcode with malicious code within the `display` or `noscript` attribute.
-   **Vulnerable Attributes:** The vulnerable attributes are the `display` and `noscript` arguments of the `eeb_mailto` shortcode.

**6. Required Attacker Capabilities/Position:**

-   **Authenticated User:** The attacker needs to be an authenticated user with at least contributor-level privileges within the WordPress site. This is because contributors can create and edit posts and pages and insert shortcodes.
-   **Knowledge of Shortcode Syntax:** The attacker needs to be familiar with the plugin's shortcode syntax to craft the malicious injection.

**Technical Details from Code Changes:**

-   **`class-email-encoder-bundle-run.php`:**
    -   The code changes in this file show that the plugin was using `html_entity_decode` to decode the attributes `display` and `noscript`, which is needed but was missing proper sanitization after decoding. The patch introduces `wp_kses()` to sanitize these attributes before using them.
    -   The patch now uses `sanitize_title()` for the `protect_using` attribute, likely to avoid unexpected input.
    -   It also introduces `$allowed_attr_html` to define which HTML attributes are allowed, improving security.
-   **`class-email-encoder-bundle-settings.php`:**
    -   The settings file includes the definition of `$safe_attr_html`, an array containing a list of allowed HTML tags and attributes, for use with `wp_kses()`. This reinforces the security improvements.
-  **`shortcodes.php`:**
     - This change displays the allowed HTML tags and attributes to the user.

**Summary of Patches:**

The patch focuses on sanitizing the input by using `wp_kses` which checks the decoded `display` and `noscript` against the allowed HTML tags and attributes, and only allows the use of safe attributes which are defined in the plugin's settings.

In summary, CVE-2023-7070 is a medium severity vulnerability due to the ability of authenticated users with contributor level access to inject arbitrary scripts into the website. This could potentially lead to data theft, account takeover or website defacement. The patch implements the use of `wp_kses` to sanitize the input and prevent the execution of malicious scripts.