Based on the provided content, here's an analysis of the vulnerabilities, focusing on CVE-2023-7005:

**Note:** The provided document mentions multiple CVEs. However, this analysis will focus on the content related to **CVE-2023-7005**, which the document titles as "Reusing a virtual key".

**CVE-2023-7005: Reusing a virtual key**

*   **Root Cause:** The vulnerability stems from the fact that the TTLock app provides all the necessary information to use a virtual key to anyone who receives such a key. The lock uses a single AES key for communication, and the `check_user_time` function (used for virtual key authorization) doesn't require the admin secret (`adminPs`), it only needs the validity time frame and the `unlockKey`. The limits on the virtual key (time frame, single-use etc.) are enforced by the app, and not the lock.

*   **Weaknesses/Vulnerabilities Present:**
    *   **Insecure Key Distribution:** The AES key and `unlockKey` are shared with anyone who receives a virtual key, allowing them to access the lock outside of the intended timeframe, even after the virtual key has expired.
    *   **Lack of Lock-Side Enforcement:** The lock does not enforce the virtual key limitations, instead, relying solely on the app for this.
    *   **Static Key:** The AES key and the `unlockKey` do not change over time.

*   **Impact of Exploitation:**
    *   An attacker who has received a virtual key can extract the necessary information from the app (AES key, unlockKey).
    *   They can use this information at any time to communicate with the lock, generate a valid challenge response using the `unlockKey`, and gain unauthorized access to the lock.
    *   This access will remain until the lock is reset.

*   **Attack Vectors:**
    *   **Abuse of legitimate function:** Attackers simply take advantage of the key information they receive through the legitimate virtual key functionality.
*   **Required Attacker Capabilities/Position:**
    *   The attacker must have been granted a virtual key at some point.
    *   The attacker needs to be able to extract the AES key and the `unlockKey` from the TTLock app.
    *   The attacker needs to communicate with the lock over BLE.

**Summary**

This vulnerability allows an attacker to gain unauthorized access to the lock by replaying previously valid virtual keys using the extracted AES key and unlock key. The vulnerability is due to the lock's failure to validate the virtual key's constraints.