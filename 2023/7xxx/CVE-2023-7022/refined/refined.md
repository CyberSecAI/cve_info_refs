The provided content describes a SQL injection vulnerability in Tongda OA, specifically in the `general/work_plan/manage/delete_all.php` route.

**Root cause of vulnerability:**
The vulnerability stems from the direct concatenation of the `$DELETE_STR` parameter into an SQL query without proper sanitization or escaping.

**Weaknesses/vulnerabilities present:**
- SQL injection: The code is vulnerable to SQL injection due to the insecure way user-supplied input (`$DELETE_STR`) is incorporated into the SQL query.
- Lack of input validation/sanitization: The application fails to validate or sanitize the `$DELETE_STR` parameter, allowing attackers to inject arbitrary SQL code.

**Impact of exploitation:**
- Data exfiltration: Attackers can use SQL injection to extract sensitive data from the database.
- Data manipulation: Attackers can modify or delete data within the database.
- Full database compromise: Attackers could potentially gain complete control over the database server and the application.

**Attack vectors:**
- HTTP request: The attack vector is through a crafted HTTP request to the vulnerable `delete_all.php` endpoint, injecting malicious SQL code into the `$DELETE_STR` parameter.

**Required attacker capabilities/position:**
- The attacker needs to be able to send HTTP requests to the vulnerable application.
- The attacker does not need to be authenticated.
- The attacker needs knowledge of the application's URL structure.

**Additional Information:**
The content provides a detailed explanation of how to exploit the SQL injection vulnerability with a specific payload, demonstrating how blind SQL injection can be used to extract data.
The payload `1)%20and%20(substr(DATABASE(),1,1))=char(116)%20and%20(select%20count(*)%20from%20information_schema.columns%20A,information_schema.columns%20B)%20and(1)=(1` is used to perform a blind SQL injection. The injection is confirmed by the presence of a delay when the `char()` value corresponds to the actual character of the database name.