```
{
  "CVE-2023-21270": {
    "related": true,
    "summary": "The vulnerability lies in how PermissionManagerService handles non-runtime permissions during package updates. Specifically, when a non-shared UID package is updated (replaced), the system creates a new UID permission state. However, the existing logic fails to carry over permission flags from the old state, particularly when flags are used for role protected permissions (ROLE_GRANTED) and app op permissions (USER_SET).",
    "root_cause": "The `restorePermissionState()` function in `PermissionManagerServiceImpl` creates a new UID permission state for updated non-shared UID packages but doesn't preserve permission flags from the old state.",
    "weaknesses": [
      "Improper preservation of permission flags during package updates"
    ],
    "impact": "The vulnerability could lead to an elevation of privilege by allowing an application to retain permissions that should have been revoked or modified during an update.",
     "attack_vectors": "A malicious application could exploit this vulnerability during an update process by manipulating permissions flags.",
    "required_capabilities": "The attacker needs to be able to replace/update an installed application on a vulnerable system."
  }
}
```