Based on the provided information, here's an analysis of CVE-2023-5118:

**Root cause of vulnerability:**
- The vulnerability is due to insufficient sanitization and validation of user-supplied data within the Kofax Capture application. Specifically, the `author` and `text` parameters sent via a POST request to the `/sofer/DocumentService.asc/SaveAnnotation` endpoint are not properly handled.

**Weaknesses/vulnerabilities present:**
- **Stored Cross-Site Scripting (XSS) (CWE-79):** Malicious JavaScript code can be injected through the vulnerable parameters. This code is then stored and executed within the application when other users access the affected data.

**Impact of exploitation:**
- Successful exploitation allows an attacker to execute arbitrary JavaScript code within the context of a user's session. This can lead to various malicious activities:
    - **Session hijacking:** Stealing user session cookies, granting unauthorized access to accounts.
    - **Data theft:** Accessing and exfiltrating sensitive data visible to the victim user.
    - **Defacement:** Modifying the appearance of the web page.
    - **Redirection:** Redirecting users to malicious websites.
    - **Malware injection:** Delivering malware to the victim's browser.
    - **Performing actions on behalf of the victim:** Manipulating data, changing settings, etc.
- The impact is that an attacker can perform actions within the application with the permissions of a logged-in user who views content containing the malicious JavaScript code.

**Attack vectors:**
- The primary attack vector is by crafting a malicious link or form that exploits the vulnerable `/sofer/DocumentService.asc/SaveAnnotation` endpoint.
- The attacker would need to trick a logged-in user into interacting with the malicious link or form. This could involve:
  - Social engineering, such as sending a phishing email with a malicious link.
  - Tricking users into manually submitting a form containing malicious code.

**Required attacker capabilities/position:**
- The attacker needs to be able to craft HTTP requests to send malicious input to the vulnerable endpoint
- The attacker also needs to have a method of delivering malicious links or forms to a user of the Kofax Capture application.
- The attacker does not necessarily require prior authentication to exploit the stored XSS, but the malicious script will only execute if a user with a valid session interacts with the crafted input.

**Additional Notes**
- The vulnerability is located in the function for adding new annotations while editing document content, suggesting that only users interacting with the document editing features would be affected.
- The specific versions vulnerable are up to and including 11.0.0, while versions 11.1.x and above are reportedly fixed. However, the exact scope of affected versions prior to 11.1.x has not been confirmed by the vendor.
- The vulnerability was reported to CERT Polska by Dawid Małecki and Sławomir Zakrzewski from AFINE.