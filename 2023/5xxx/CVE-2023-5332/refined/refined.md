Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**

- The root cause is the combination of the `enable-script-checks` option being set to `true` in HashiCorp Consul and the Consul API being exposed over a network. This allows an attacker to register malicious script checks through the API, leading to remote code execution on the Consul agent.

**Weaknesses/Vulnerabilities Present:**

- **Remote Code Execution (RCE):** The primary vulnerability is that arbitrary code can be executed on the Consul agent by registering a malicious script check.
- **Insecure Default Configuration:** The `enable-script-checks` was enabled by default in some configurations, which was a contributing factor to the issue.
- **Exposed API:** The Consul API being accessible over the network is a prerequisite for the exploit.
- **Lack of proper ACL enforcement:** While ACLs are a mitigation, even with ACLs, a compromised host with an ACL token can register a service with a script check, if that ACL token has the required privileges.

**Impact of Exploitation:**

- **Remote Code Execution:** Attackers can gain the ability to execute arbitrary code on the affected Consul nodes.
- **Malware Propagation:** Attackers can use the compromised Consul nodes to propagate malware to other servers within the network by registering malicious script checks on other vulnerable Consul agents.
- **Compromise of Consul State:** On servers, script checks can expose all Consul state, including ACL tokens, to the attacker.

**Attack Vectors:**

- **Network Access to Consul API:** Attackers require network access to the Consul HTTP API.
- **Registration of Malicious Check:** The attack vector is registering a malicious script check via the exposed Consul API.

**Required Attacker Capabilities/Position:**

- **Network Access:** Attackers must have network access to the Consul API.
- **Ability to Register Checks:** Attackers need the ability to register health check definitions via the Consul API. This could be via an unauthenticated API if ACLs are disabled, or by compromising an ACL token.
- **Basic understanding of Consul API:** To construct a malicious health check registration request.

**Additional Details from Content:**

-   The vulnerability was actively being exploited in the wild.
-   The vendor has backported a fix to older versions of Consul (1.2.4, 1.1.1, 1.0.8, and 0.9.4), which include the `-enable-local-script-checks` option.
-   The recommended mitigation includes using the `-enable-local-script-checks` option which prevents remote registration of script checks via the API. This allows script checks only from local configuration files.
-   The vendor recommends disabling script checks on Consul servers.
-   The vendor also highlights the importance of securing the Consul HTTP API by binding it to a loopback interface.
-   ACLs are recommended as a best practice, but the content points out that ACL tokens themselves can be used to propagate the attack if one is compromised.

The information provided is more detailed than a typical CVE description, offering specific details on the vulnerability, exploitation, impact, and mitigations.