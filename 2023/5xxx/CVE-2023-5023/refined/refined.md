- **Root cause of vulnerability:** The vulnerability stems from the direct concatenation of user-supplied input (`$RELATIVES_ID`) into an SQL query without proper sanitization or parameterization.
- **Weaknesses/vulnerabilities present:** SQL injection vulnerability. The code directly incorporates the `$RELATIVES_ID` parameter into the SQL query, creating an opportunity for injection. The parenthesis closure is exploited to bypass the initial query and insert malicious SQL.
- **Impact of exploitation:** Successful exploitation allows an attacker to extract sensitive database information, potentially including database names, table structures, and data. The specific technique described is a blind SQL injection, which can be used to enumerate the database contents.
- **Attack vectors:** The vulnerability can be exploited through the `RELATIVES_ID` parameter in the `general/hr/manage/staff_relatives/delete.php` route of the Tongda OA v2017 software.
- **Required attacker capabilities/position:** An attacker needs to be able to send HTTP requests to the vulnerable endpoint with a crafted payload in the `RELATIVES_ID` parameter.