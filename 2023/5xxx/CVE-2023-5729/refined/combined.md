=== Content from security.gentoo.org_897e22ca_20250114_175840.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.mozilla.org_2991b745_20250114_175839.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1823720)
* [XML](/show_bug.cgi?ctype=xml&id=1823720)

Closed
[Bug 1823720](/show_bug.cgi?id=1823720)
(CVE-2023-5729)

Opened 2 years ago
Closed 1 year ago

# Obscured Fullscreen by Launching Security Credential Setup

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Obscured Fullscreen by Launching Security Credential Setup

## Categories

### (Core :: DOM: Web Authentication, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Web%20Authentication#DOM%3A%20Web%20Authentication)

DOM: Web Authentication
▾

Core :: DOM: Web Authentication
Bugs and issues related to the W3C Web Authentication (webauthn) implementation in Firefox, or its interaction with operating system and hardware components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Web%20Authentication&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Web%20Authentication&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Web%20Authentication)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

119 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox-esr115 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix) |
| firefox115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix) |
| firefox116 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix) |
| firefox117 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix) |
| firefox118 | [-](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=wontfix) |
| firefox119 | [+](/buglist.cgi?f1=cf_tracking_firefox119&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | - | wontfix |
| firefox-esr128 | --- | --- |
| firefox115 |  | wontfix |
| firefox116 |  | wontfix |
| firefox117 |  | wontfix |
| firefox118 | - | wontfix |
| firefox119 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: fazim.pentester, Assigned: jschanck)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/291ff310b7805a4159d7f46af196813e?d=mm&size=40)  [jschanck](/user_profile?user_id=689878)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/4894f6e6dda807a548d66213399b6dff?d=mm&size=40)  [fazim.pentester](/user_profile?user_id=720428)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/291ff310b7805a4159d7f46af196813e?d=mm&size=40)  [jschanck](/user_profile?user_id=689878)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2023-4051](/show_bug.cgi?id=1821884 "RESOLVED FIXED - File Open Dialog hide fullscreen notification")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1823720&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1823720)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-37207](/show_bug.cgi?id=1816287 "VERIFIED FIXED - Obscuring the Full-Screen notification in Firefox Using maximized external application window (e.g. via mailto:)")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-low, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main119+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-5729

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main119+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [freddy](/user_profile?user_id=428608) | [sec-bounty](#c30 "2 years ago") | - |
| --- | --- | --- |
| [freddy](/user_profile?user_id=428608) | sec-bounty | - |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | [sec-bounty-hof](#a38782726_578488 "7 months ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty-hof | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a16576584_488993 "1 year ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 2 obsolete files)

| [spoof.html](/attachment.cgi?id=9324216)  [2 years ago](#c0)  [Shaheen Fazim](/user_profile?user_id=720428)   3.07 KB, text/html |  | [Details](/attachment.cgi?id=9324216&action=edit) |
| --- | --- | --- |
| [demo.mp4](/attachment.cgi?id=9324217)  [2 years ago](#c1)  [Shaheen Fazim](/user_profile?user_id=720428)   786.17 KB, video/mp4 |  | [Details](/attachment.cgi?id=9324217&action=edit) |
| [Bug 1823720 - Autofocus WebAuthn prompts. r=keeler](/attachment.cgi?id=9344744)  [1 years ago](#c17)  [John Schanck [:jschanck]](/user_profile?user_id=689878)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9344744&action=edit) | [Review](/attachment.cgi?id=9344744) |
| [Bug 1823720 - prevent some fullscreen states while WebAuthn prompts are shown. r?edgar r=keeler!](/attachment.cgi?id=9350553)  [1 year ago](#c24)  [John Schanck [:jschanck]](/user_profile?user_id=689878)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9350553&action=edit) | [Review](/attachment.cgi?id=9350553) |
| [advisory.txt](/attachment.cgi?id=9359584)  [1 year ago](#c34)  [Tyson Smith [:tsmith]](/user_profile?user_id=486634)   274 bytes, text/plain |  | [Details](/attachment.cgi?id=9359584&action=edit) |
| [advisory.txt](/attachment.cgi?id=9359925)  [1 year ago](#c35)  [Tyson Smith [:tsmith]](/user_profile?user_id=486634)   272 bytes, text/plain |  | [Details](/attachment.cgi?id=9359925&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1823720#c0)• 2 years ago |
|  | |

Attached file
[spoof.html](attachment.cgi?id=9324216)
— [Details](attachment.cgi?id=9324216&action=edit)

In Firefox for Windows, launching Windows Security Credential Setup using navigator.credentials() can obscure the fullscreen toast Text.

Steps to Reproduce:

1. Download the spoof.html file.
2. Open the spoof.html file in Firefox for Windows.
3. Click anywhere on the webpage.
Flags: sec-bounty?

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1823720#c1)• 2 years ago |
|  | |

Attached video
[demo.mp4](attachment.cgi?id=9324217)
— [Details](attachment.cgi?id=9324217&action=edit)

Video Demonstration

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1823720#c2)• 2 years ago |
|  | |

Looks like we're putting website-provided text into the OS dialog. That generally feels like something where we'll need to provide some kind of sanitization. It also seems like, just like in [bug 1816287](/show_bug.cgi?id=1816287 "VERIFIED FIXED - Obscuring the Full-Screen notification in Firefox Using maximized external application window (e.g. via mailto:)"), we may want to exit fullscreen when this happens.

Christoph, do you know who knows about the webauth/credential implementation here?

Group: firefox-core-security → dom-core-securityComponent: Security → DOM: Web AuthenticationFlags: needinfo?(ckerschb)Product: Firefox → Core

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1823720#c3)• 2 years ago |
|  | |

John is our WebAuthN go-to person. He offered to take a look.

302 to him.

Flags: needinfo?(ckerschb) → needinfo?(jschanck)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1823720#c4)• 2 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #2](/show_bug.cgi?id=1823720#c2 "RESOLVED FIXED - Obscured Fullscreen by Launching Security Credential Setup"))

> It also seems like, just like in [bug 1816287](/show_bug.cgi?id=1816287 "VERIFIED FIXED - Obscuring the Full-Screen notification in Firefox Using maximized external application window (e.g. via mailto:)"), we may want to exit fullscreen when this happens.

I was thinking of [bug 1821884](/show_bug.cgi?id=1821884 "RESOLVED FIXED - File Open Dialog hide fullscreen notification") here, though it was discussed in both.

See Also: → [CVE-2023-4051](/show_bug.cgi?id=1821884 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"), [CVE-2023-37207](/show_bug.cgi?id=1816287 "VERIFIED FIXED - Obscuring the Full-Screen notification in Firefox Using maximized external application window (e.g. via mailto:)")

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1823720#c5)• 2 years ago |
|  | |

I could be convinced that we should exit fullscreen here. But I don't actually see a security risk. The worst-case scenario is that `example.com` somehow tricks the user into creating a credential for `example.com`.

You could argue that displaying the newlines in the dialog is a bug in the Windows WebAuthn API. There's a relevant SHOULD clause in [Section 5.4.1](https://w3c.github.io/webauthn/#dictdef-publickeycredentialentity):

```
Clients SHOULD perform enforcement, as prescribed in Section 3.4.3 of [RFC8265]
for the UsernameCasePreserved Profile of the PRECIS IdentifierClass [RFC8264],
on name's value prior to displaying the value to the user or including the value
as a parameter of the authenticatorMakeCredential operation.

```

And a similar SHOULD clause for the relying party's behavior. But it's not a MUST.

:edgar, if we did want to exit fullscreen, what's the preferred way to do that? Is there a way to temporarily prohibit fullscreen requests?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a106363_406194)• 2 years ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a194054_689878)• 2 years ago |

Flags: needinfo?(jschanck)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1823720#c6)• 2 years ago |
|  | |

The severity field is not set for this bug.

:jschanck, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(jschanck)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1823720#c7)• 2 years ago |
|  | |

On the mac the dialog doesn't come anywhere geographicalluy close to the fullscreen toast, let alone obscure it. Even in the movie this spoof doesn't fully hide it on Windows: it's clearly suspicious behavior. In addition, the security dialog itself will be a surprise to most users and raise even more suspicion about the site.

Chrome on mac starts to go into fullscreen and then pops right back out when the webauthn dialog shows up. That would fix the problem, though we should be consistent. Is it *never* appropriate to request a permission while you're in fullscreen? It would be simplest to say "no; it's never appropriate". We wouldn't have to worry about sites trying to create fake permission dialogs (but they couldn't get any privileges so I can't think of a reason to do that). We would only ever show the permission dialogs when we had browser chrome available to show it's a legit prompt, and to show the true site context (the fullscreen site might "fake navigate" and then try to get a victim to grant permissions to it thinking they're on some other site they trust. Also, when we're not in fullscreen the controls to fix mis-granted permissions are easy to notice and use.

On balance I think it will be safer to prevent permission dialogs in fullscreen, either by suppressing them (auto reject?) or by canceling fullscreen to ask. But I could imagine a case or two where that could get awkward. For example, you're browsing a fullscreen map and click the button to jump to your location: the site now has to ask for geolocation permission to do that. Or you're in a fullscreen game app and it has an option to let you create an avatar based on a picture of you, and needs to get permission to use the webcam.

We could do both: reject/suppress permission requests for a few seconds (5? 10?) when we start the fullscreen transition, but allow them after that. We could also consider rejecting requestFullscreen() calls if there's already an unresolved permission request in progress. I might be inventing new race conditions for us to lose :-)

Edgar: what do you think?

Flags: needinfo?(echen)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1823720#c8)• 2 years ago |
|  | |

Safari seems to have a race condition. Sometimes the passkey dialog comes up first and then I enter fullscreen, a bit more of the time I go into fullscreen first and then am take back to the original Desktop to futz with the security key. After that I'm not taken back to the fullscreen content, but it's still open on the other desktop. You've got to figure out your own way back over there (4-finger side-swipe or Control-right-arrow) or click on the empty tab to pull it back from fullscreen. (Note: the testcase only works in Safari 16.4. You have to change it to use `webkitRequestFullscreen()` in earlier versions). The Safari version of the prompt shows the full name text including the

So that's a lot about the fullscreen/prompt interaction, and that part might be fixed elsewhere than Web Authentication. But it seems pretty clear that Firefox and Safari, at least, aren't preparing the name strings are specified. We're supposed to make sure it conforms to the FreeForm class defined by [RFC8264](https://www.rfc-editor.org/rfc/rfc8264) and [RFC8266}(<https://www.rfc-editor.org/rfc/rfc8266>). Those forbid control characters which would take care of the newlines, but also a whole bunch of Unicode normalization that's similar to what's done for IDN domain names. Maybe this part should be spun out into it's own bug.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1823720#c9)• 2 years ago |
|  | |

friendly ping

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1823720#c10)• 2 years ago |
|  | |

Lets wait for [bug 1821884](/show_bug.cgi?id=1821884 "RESOLVED FIXED - File Open Dialog hide fullscreen notification") to be resolved first, the solution there might help this as well.

Depends on: [CVE-2023-4051](/show_bug.cgi?id=1821884 "RESOLVED FIXED - File Open Dialog hide fullscreen notification")Flags: needinfo?(echen)See Also: [CVE-2023-4051](/show_bug.cgi?id=1821884 "RESOLVED FIXED - File Open Dialog hide fullscreen notification") →

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1823720#c11)• 2 years ago |
|  | |

(In reply to Edgar Chen [:edgar] from [comment #10](/show_bug.cgi?id=1823720#c10 "RESOLVED FIXED - Obscured Fullscreen by Launching Security Credential Setup"))

> Lets wait for [bug 1821884](/show_bug.cgi?id=1821884 "RESOLVED FIXED - File Open Dialog hide fullscreen notification") to be resolved first, the solution there might help this as well.

Did this work out ie has this been addressed by that fix?

Flags: needinfo?(echen)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1823720#c12)• 2 years ago |
|  | |

This has been addressed by [bug 1821884](/show_bug.cgi?id=1821884 "RESOLVED FIXED - File Open Dialog hide fullscreen notification") on Windows, but not on Mac and Linux, because the credential popup doesn't cause the browser window to deactivate, so detecting activation doesn't work there.

Chrome and Safari both deactivate the browser window when credential popup is shown (at least the page receive blur event and lose the focus), it seems to me that we should do the same.

Gijs, do you know what might cause the difference between on Windows and other platforms? I suspect there are some difference in widget code, but not so sure.

Flags: needinfo?(echen) → needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1823720#c13)• 2 years ago |
|  | |

(In reply to Edgar Chen [:edgar] from [comment #12](/show_bug.cgi?id=1823720#c12 "RESOLVED FIXED - Obscured Fullscreen by Launching Security Credential Setup"))

> Gijs, do you know what might cause the difference between on Windows and other platforms? I suspect there are some difference in widget code, but not so sure.

No, I don't know. Hopefully jschanck does. I'll ping on slack.

Flags: needinfo?(gijskruitbosch+bugs)

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1823720#c14)• 2 years ago |
|  | |

On Windows the UI is presented by the platform. On Mac and Linux we use `PopupNotifications.show` [here](https://searchfox.org/mozilla-central/rev/962a843f6d96283c45162c788dc72bf217fca7df/browser/base/content/browser.js#7848).

Flags: needinfo?(jschanck)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1823720#c15)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1823720&comment_id=16456413 "1 revision") |
|  | |

(In reply to John Schanck [:jschanck] from [comment #14](/show_bug.cgi?id=1823720#c14 "RESOLVED FIXED - Obscured Fullscreen by Launching Security Credential Setup"))

> On Windows the UI is presented by the platform. On Mac and Linux we use `PopupNotifications.show` [here](https://searchfox.org/mozilla-central/rev/962a843f6d96283c45162c788dc72bf217fca7df/browser/base/content/browser.js#7848).

Thanks! If we passed the `autofocus` option to this call, it should steal focus as Edgar suggested in [comment 12](/show_bug.cgi?id=1823720#c12 "RESOLVED FIXED - Obscured Fullscreen by Launching Security Credential Setup"). Is there any reason not to do that? And do we have a security delay implemented on any buttons this popup shows to prevent clickjacking / keyjacking, if we do start autofocusing it?

Flags: needinfo?(jschanck)

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1823720#c16)• 1 years ago |
|  | |

Passing `autofocus` seems to work, thanks! And yes, there's a security delay [here](https://searchfox.org/mozilla-central/source/toolkit/modules/PopupNotifications.sys.mjs#1905-1913). The delay is configured by the `security.notification_enable_delay` pref and defaults to 500ms.

Flags: needinfo?(jschanck)

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1823720#c17)• 1 years ago |
|  | |

Attached file
[Bug 1823720 - Autofocus WebAuthn prompts. r=keeler](attachment.cgi?id=9344744) (obsolete)
— [Details](attachment.cgi?id=9344744&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a10395085_600971)• 1 years ago |

Assignee: nobody → jschanckStatus: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a10395185_689878)• 1 years ago |

Severity: -- → S3Priority: -- → P2

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1823720#c18)• 1 years ago |
|  | |

Comment on [attachment 9344744](/attachment.cgi?id=9344744 "Bug 1823720 - Autofocus WebAuthn prompts. r=keeler") [[details]](/attachment.cgi?id=9344744&action=edit "Bug 1823720 - Autofocus WebAuthn prompts. r=keeler")

[Bug 1823720](/show_bug.cgi?id=1823720 "RESOLVED FIXED - Obscured Fullscreen by Launching Security Credential Setup") - Autofocus WebAuthn prompts. r=keeler

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not easily. The patch aligns our behavior on MacOS and Linux with our behavior on Windows post-[Bug 1821884](/show_bug.cgi?id=1821884 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"). While it makes sense to align our behavior, the spoofing proof-of-concept was not very convincing on MacOS and Linux to begin with.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: The patch should apply cleanly.
* **How likely is this patch to cause regressions; how much testing does it need?**: I don't see any way that autofocusing the prompts could cause regressions. The prompts are sensitive to visibility changes, but not focus changes. There are unit tests that cover all meaningful interactions with the prompts.
* **Is Android affected?**: No
[Attachment #9344744](/attachment.cgi?id=9344744&action=edit "Bug 1823720 - Autofocus WebAuthn prompts. r=keeler") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1823720#c19)• 1 years ago |
|  | |

sec-moderate bugs don't require sec-approval

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix)
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix)
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox117](/buglist.cgi?f1=cf_tracking_firefox117&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [117+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=117%2B)Flags: needinfo?(jschanck)

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a11075013_689878)• 1 years ago |

[Attachment #9344744](/attachment.cgi?id=9344744&action=edit "Bug 1823720 - Autofocus WebAuthn prompts. r=keeler") -
Flags: sec-approval?

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a11075021_689878)• 1 years ago |

Flags: needinfo?(jschanck)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1823720#c20)• 1 years ago |
|  | |

The bug is marked as tracked for firefox117 (nightly). However, the bug still has low severity.

:freddy, could you please increase the severity for this tracked bug? If you disagree with the tracking decision, please talk with the release managers.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#tracked_attention.py).

Flags: needinfo?(fbraun)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1823720#c21)• 1 year ago |
|  | |

John, do you still think this should be kept as tracked and increased to S2 or no longer tracked for 117?

Flags: needinfo?(fbraun) → needinfo?(jschanck)

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1823720#c22)• 1 year ago |
|  | |

No longer tracked for 117, thanks. I will get to it for 118.

Flags: needinfo?(jschanck)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1823720#c23)• 1 year ago |
|  | |

[Tracking Requested - why for this release]: Unlikely we're going to make 117, so requesting to be tracked for 118.

[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix)
[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected)
[tracking-firefox117](/buglist.cgi?f1=cf_tracking_firefox117&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B) → ---
[tracking-firefox118](/buglist.cgi?f1=cf_tracking_firefox118&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=%3F)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
[117+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=117%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=%3F)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a12269211_695136)• 1 year ago |

[tracking-firefox118](/buglist.cgi?f1=cf_tracking_firefox118&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=%3F) → [118+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=118%2B)

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1823720#c24)• 1 year ago |
|  | |

Attached file
[Bug 1823720 - prevent some fullscreen states while WebAuthn prompts are shown. r?edgar r=keeler!](attachment.cgi?id=9350553)
— [Details](attachment.cgi?id=9350553&action=edit)

This prevents fullscreen states that hide chrome while WebAuthn prompts are shown. Specifically, it

1. ensures that the navigation toolbox is shown in fullscreen windows, and
2. disallows fullscreen DOM elements.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a13850869_600971)• 1 year ago |

[Attachment #9344744](/attachment.cgi?id=9344744&action=edit "Bug 1823720 - Autofocus WebAuthn prompts. r=keeler") -
Attachment is obsolete: true

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1823720#c25)• 1 year ago |
|  | |

Unfortunately the `autofocus` trick isn't compatible with some assumptions made by our tests (and, worse, by the webauthn wpts), so I've posted a new patch using a different approach.

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1823720#c26)• 1 year ago |
|  | |

Pushed by jschanck@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/730394fa6984>
prevent some fullscreen states while WebAuthn prompts are shown. r=edgar,keeler

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1823720#c27)• 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/730394fa6984>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 1 year ago
[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 119 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1823720#c28)• 1 year ago |
|  | |

The patch landed in nightly and beta is affected.

:jschanck, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox118` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(jschanck)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a14072798_695136)• 1 year ago |

[tracking-firefox119](/buglist.cgi?f1=cf_tracking_firefox119&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox119&o1=equals&v1=%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1823720#c29)• 1 year ago |
|  | |

changing severity to sec-low, and even that seems generous. This attack does not hide the toast movement and the transition animation still happens. Also, popping up a Windows Hello dialog when you're not expecting it is very suspicious.

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1823720#c30)• 1 year ago |
|  | |

Shaheen Fazim, thank you for reporting this bug to us. Ultimately, we were not fully convinced that this is a very useful spoof, as explained by Dan in the comment above. We generally do not pay a bounty for bugs rated sec-low. Looking forward to your next submission!

Flags: sec-bounty? → sec-bounty-

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1823720#c31)• 1 year ago |
|  | |

Not requesting beta uplift as the change is cosmetic on mac / linux.

[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix)Flags: needinfo?(jschanck)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a14794775_75935)• 1 year ago |

[tracking-firefox118](/buglist.cgi?f1=cf_tracking_firefox118&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=-)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
[118+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=118%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=-)

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1823720#c32)• 1 year ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #29](/show_bug.cgi?id=1823720#c29 "RESOLVED FIXED - Obscured Fullscreen by Launching Security Credential Setup"))

> changing severity to sec-low, and even that seems generous. This attack does not hide the toast movement and the transition animation still happens. Also, popping up a Windows Hello dialog when you're not expecting it is very suspicious.

Hello, even though a fullscreen toast animation or movement is displayed, an attacker could use the same background color as the color the toast is using. Consequently, they could conceal it in a manner that leaves the victim unaware, as the toast text is effectively hidden by using the Windows Hello dialogue. Since Windows Hello is an OS dialogue, the victim will not be aware if the site has launched. When he/she cancels it, the site can easily spoof it. Could you please reevaluate the issue and elevate the security severity, as this is similar to other fullscreen spoofs?

Flags: needinfo?(dveditz)

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1823720#c33)• 1 year ago |
|  | |

The key point I am emphasizing here is that this method effectively conceals the text informing the user that the site is in fullscreen mode. I was able to achieve this using the mentioned approach. I believe this constitutes a valid security concern, and I hope you find it a reasonable basis for a bounty.

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a16576584_488993)• 1 year ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a18325053_486634)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main119+]

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1823720#c34)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9359584) (obsolete)
— [Details](attachment.cgi?id=9359584&action=edit)

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1823720#c35)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9359925)
— [Details](attachment.cgi?id=9359925&action=edit)

[Attachment #9359584](/attachment.cgi?id=9359584&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a18759856_578488)• 1 year ago |

Alias: CVE-2023-5729

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a30424383_1689)• 10 months ago |

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1823720#c36)• 9 months ago |
|  | |

Bulk-unhiding security bugs fixed in Firefox 119-121 (Fall 2023). Use "moo-doctrine-subsidy" to filter

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a37679184_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823720#a38782726_578488)• 7 months ago |

Flags: sec-bounty-hof+
You need to [log in](/show_bug.cgi?id=1823720&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Shaheen Fazim](/user_profile?user_id=720428)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_57f45128_20250114_175840.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-45

## Security Vulnerabilities fixed in Firefox 119

Announced
October 24, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 119

#### [#CVE-2023-5721: Queued up rendering could have allowed websites to clickjack](#CVE-2023-5721)

Reporter
Kelsey Gilbert
Impact
high
##### Description

It was possible for certain browser prompts and dialogs to be activated or dismissed unintentionally by the user due to an insufficient activation-delay.

##### References

* [Bug 1830820](https://bugzilla.mozilla.org/show_bug.cgi?id=1830820)

#### [#CVE-2023-5722: Cross-Origin size and header leakage](#CVE-2023-5722)

Reporter
annevk
Impact
moderate
##### Description

Using iterative requests an attacker was able to learn the size of an opaque response, as well as the contents of a server-supplied Vary header.

##### References

* [Bug 1738426](https://bugzilla.mozilla.org/show_bug.cgi?id=1738426)

#### [#CVE-2023-5723: Invalid cookie characters could have led to unexpected errors](#CVE-2023-5723)

Reporter
Daniel Veditz
Impact
moderate
##### Description

An attacker with temporary script access to a site could have set a cookie containing invalid characters using `document.cookie` that could have led to unknown errors.

##### References

* [Bug 1802057](https://bugzilla.mozilla.org/show_bug.cgi?id=1802057)

#### [#CVE-2023-5724: Large WebGL draw could have led to a crash](#CVE-2023-5724)

Reporter
pwn2car
Impact
moderate
##### Description

Drivers are not always robust to extremely large draw calls and in some cases this scenario could have led to a crash.

##### References

* [Bug 1836705](https://bugzilla.mozilla.org/show_bug.cgi?id=1836705)

#### [#CVE-2023-5725: WebExtensions could open arbitrary URLs](#CVE-2023-5725)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

A malicious installed WebExtension could open arbitrary URLs, which under the right circumstance could be leveraged to collect sensitive user data.

##### References

* [Bug 1845739](https://bugzilla.mozilla.org/show_bug.cgi?id=1845739)

#### [#CVE-2023-5726: Full screen notification obscured by file open dialog on macOS](#CVE-2023-5726)

Reporter
Edgar Chen and Hafiizh
Impact
moderate
##### Description

A website could have obscured the full screen notification by using the file open dialog. This could have led to user confusion and possible spoofing attacks.
*Note: This issue only affected macOS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1846205](https://bugzilla.mozilla.org/show_bug.cgi?id=1846205)

#### [#CVE-2023-5727: Download Protections were bypassed by .msix, .msixbundle, .appx, and .appxbundle files on Windows](#CVE-2023-5727)

Reporter
Marco Bonardo
Impact
moderate
##### Description

The executable file warning was not presented when downloading .msix, .msixbundle, .appx, and .appxbundle files, which can run commands on a user's computer.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1847180](https://bugzilla.mozilla.org/show_bug.cgi?id=1847180)

#### [#CVE-2023-5728: Improper object tracking during GC in the JavaScript engine could have led to a crash.](#CVE-2023-5728)

Reporter
anbu
Impact
moderate
##### Description

During garbage collection extra operations were performed on a object that should not be. This could have led to a potentially exploitable crash.

##### References

* [Bug 1852729](https://bugzilla.mozilla.org/show_bug.cgi?id=1852729)

#### [#CVE-2023-5729: Fullscreen notification dialog could have been obscured by WebAuthn prompts](#CVE-2023-5729)

Reporter
Shaheen Fazim
Impact
low
##### Description

A malicious web site can enter fullscreen mode while simultaneously triggering a WebAuthn prompt. This could have obscured the fullscreen notification and could have been leveraged in a spoofing attack.

##### References

* [Bug 1823720](https://bugzilla.mozilla.org/show_bug.cgi?id=1823720)

#### [#CVE-2023-5730: Memory safety bugs fixed in Firefox 119, Firefox ESR 115.4, and Thunderbird 115.4.1](#CVE-2023-5730)

Reporter
Jed Davis, Andrew McCreight, Randell Jesup, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 118, Firefox ESR 115.3, and Thunderbird 115.3. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 119, Firefox ESR 115.4, and Thunderbird 115.4.1](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1836607%2C1840918%2C1848694%2C1848833%2C1850191%2C1850259%2C1852596%2C1853201%2C1854002%2C1855306%2C1855640%2C1856695)

#### [#CVE-2023-5731: Memory safety bugs fixed in Firefox 119](#CVE-2023-5731)

Reporter
Steve Fink, Stefan Arentz, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 118. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 119](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1690111%2C1721904%2C1851803%2C1854068)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


