Based on the provided information, here's an analysis of CVE-2023-5050:

**Root Cause of Vulnerability:**
The vulnerability stems from insufficient input sanitization and output escaping within the Leaflet Map plugin for WordPress. This occurs when processing shortcodes, specifically the `geojson-shortcode.php`, which allows for the inclusion of popup text, as seen in the reference to `plugins.trac.wordpress.org/browser/leaflet-map/tags/3.3.0/shortcodes/class.geojson-shortcode.php#L124`.

**Weaknesses/Vulnerabilities Present:**
- **Stored Cross-Site Scripting (XSS):** The plugin fails to properly sanitize user-supplied input, specifically when handling `popup_text` and `popup_property` attributes in the `geojson` shortcode, allowing the injection of malicious JavaScript.

**Impact of Exploitation:**
- **Arbitrary Code Execution:** Successful exploitation enables an attacker to inject malicious JavaScript code that executes within the context of a user's browser when they view a page containing the vulnerable shortcode.
- **Website Compromise:** This can lead to various malicious activities, including:
    - Redirecting users to attacker-controlled websites.
    - Stealing user session cookies to hijack accounts.
    - Modifying website content and injecting further malicious scripts.
    - Performing actions on behalf of the user without their consent.

**Attack Vectors:**
- **Shortcode Injection:** An attacker with contributor-level or higher privileges can inject the malicious payload by crafting a malicious shortcode (specifically the `geojson` shortcode).

**Required Attacker Capabilities/Position:**
- **Authenticated Contributor or Higher Access:** The attacker must have an account on the WordPress site with at least "Contributor" level privileges to create or modify posts/pages and use shortcodes.

**Additional Details:**
- The vulnerability was present in versions of the Leaflet Map plugin up to and including 3.3.0.
- The fix for this vulnerability involves escaping geojson popup properties to prevent XSS attacks.
- The fix involved the usage of `esc_js()` function, as seen in `plugins.trac.wordpress.org/changeset/2968965/leaflet-map#file12`.
- The plugin version 3.3.1 addresses this issue by implementing proper output escaping using `esc_js()` on `popup_text` and `popup_property`.