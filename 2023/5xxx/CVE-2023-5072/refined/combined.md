=== Content from github.com_1cfe6c11_20250114_181028.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstleary%2FJSON-java%2Fissues%2F771)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstleary%2FJSON-java%2Fissues%2F771)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=stleary%2FJSON-java)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[stleary](/stleary)
/
**[JSON-java](/stleary/JSON-java)**
Public

* [Notifications](/login?return_to=%2Fstleary%2FJSON-java) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2Fstleary%2FJSON-java)
* [Star
   4.6k](/login?return_to=%2Fstleary%2FJSON-java)

* [Code](/stleary/JSON-java)
* [Issues
  39](/stleary/JSON-java/issues)
* [Pull requests
  6](/stleary/JSON-java/pulls)
* [Actions](/stleary/JSON-java/actions)
* [Projects
  0](/stleary/JSON-java/projects)
* [Wiki](/stleary/JSON-java/wiki)
* [Security](/stleary/JSON-java/security)
* [Insights](/stleary/JSON-java/pulse)

Additional navigation options

* [Code](/stleary/JSON-java)
* [Issues](/stleary/JSON-java/issues)
* [Pull requests](/stleary/JSON-java/pulls)
* [Actions](/stleary/JSON-java/actions)
* [Projects](/stleary/JSON-java/projects)
* [Wiki](/stleary/JSON-java/wiki)
* [Security](/stleary/JSON-java/security)
* [Insights](/stleary/JSON-java/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fstleary%2FJSON-java%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fstleary%2FJSON-java%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Logic to exclude object keys that are themselves objects is imperfect #771

Closed

[eamonnmcmanus](/eamonnmcmanus) opened this issue
Sep 20, 2023
¬∑ 11 comments
 ¬∑ Fixed by [#772](https://github.com/stleary/JSON-java/pull/772)

Closed

# [Logic to exclude object keys that are themselves objects is imperfect](#top) #771

[eamonnmcmanus](/eamonnmcmanus) opened this issue
Sep 20, 2023
¬∑ 11 comments
 ¬∑ Fixed by [#772](https://github.com/stleary/JSON-java/pull/772)

Labels
[Active discussion](/stleary/JSON-java/labels/Active%20discussion)

## Comments

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=80&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)

Copy link

Contributor

### **[eamonnmcmanus](/eamonnmcmanus)** commented [Sep 20, 2023](#issue-1905464604)

| `JSONObject` contains [this logic](https://github.com/stleary/JSON-java/blob/01727fd0ed00c1f1f5582bdc97244356ac029f3b/src/main/java/org/json/JSONObject.java#L218-L222) to prevent a key in a JSON object from being another JSON object or an array:  ```             case '{':             case '[':                 if(prev=='{') {                     throw x.syntaxError("A JSON Object can not directly nest another JSON Object or JSON Array.");                 } ```  However this doesn't cover all cases. For example, `JSONObject` currently accepts this string:  ``` {"a":1, [{"b": 2}]: 3}  ```  which it interprets as an object with two keys, one that is the string `a` and one that is the string `[{"b":2}]`.  Strict JSON, of course, only accepts string literals as keys in objects. JSON-java is more liberal, but it does balk at nested objects since the fix for [#654](https://github.com/stleary/JSON-java/issues/654). The example above suggests that that fix was incomplete. I think it would make sense to disallow nested objects or arrays as keys always. They're not valid JSON and it's unlikely that anyone is relying on them for legitimate purposes. Meanwhile they can straightforwardly be used for DoS attacks, similar to [#654](https://github.com/stleary/JSON-java/issues/654) and [#758](https://github.com/stleary/JSON-java/issues/758).  I have a proposed fix which I will send shortly. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
1
 mayaba reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[eamonnmcmanus](/eamonnmcmanus)
added a commit
to eamonnmcmanus/JSON-java
that referenced
this issue
[Sep 20, 2023](#ref-commit-661114c)
[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=40&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)

`[Generalize the logic to disallow nested objects and arrays as keys in‚Ä¶](/eamonnmcmanus/JSON-java/commit/661114c50dcfd53bb041aab66f14bb91e0a87c8a "Generalize the logic to disallow nested objects and arrays as keys in objects.

Fixes #771.")`
‚Ä¶

`[661114c](/eamonnmcmanus/JSON-java/commit/661114c50dcfd53bb041aab66f14bb91e0a87c8a)`

```
‚Ä¶ objects.

Fixes [stleary#771](https://github.com/stleary/JSON-java/issues/771).
```

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=40&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)
[eamonnmcmanus](/eamonnmcmanus)
mentioned this issue
[Sep 20, 2023](#ref-pullrequest-1905473651)

[Disallow nested objects and arrays as keys in objects
#772](/stleary/JSON-java/pull/772)
 Merged

[![@stleary](https://avatars.githubusercontent.com/u/5107558?s=80&u=fbfe657488541faf7a084c543be5a907e50f1afe&v=4)](/stleary)

Copy link

Owner

### **[stleary](/stleary)** commented [Sep 21, 2023](#issuecomment-1729476782)

| [@eamonnmcmanus](https://github.com/eamonnmcmanus) Thanks for bringing this up, however, I am not convinced yet this is a bug. Using the above example results in a valid JSON doc:  ``` {   "a": 1,   "[{\"b\":2}]": 3 }  ```  You mentioned the current code allows potential DOS attacks. Can you explain how that would work? |
| --- |

All reactions

Sorry, something went wrong.

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=80&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)

Copy link

Contributor

Author

### **[eamonnmcmanus](/eamonnmcmanus)** commented [Sep 21, 2023](#issuecomment-1729720501)

| I'm reluctant to share precise exploit details here, but I have sent them privately. |
| --- |

All reactions

Sorry, something went wrong.

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=80&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)

Copy link

Contributor

Author

### **[eamonnmcmanus](/eamonnmcmanus)** commented [Sep 21, 2023](#issuecomment-1730436735)

| OK, after discussion with [@stleary](https://github.com/stleary) I'm sharing the details here.  The bug that allows an array-of-object as a key can be exploited recursively:  ``` jshell> new JSONObject("{a:1,[{a:1,[{a:1,[{a:1}]:2}]:2}]:2}") $5 ==> {"a":1,"[{\"a\":1,\"[{\\\"a\\\":1,\\\"[{\\\\\\\"a\\\\\\\":1}]\\\":2}]\":2}]":2}  ```  Each level of recursion doubles the number of backslashes, so with only a couple of hundred characters an attacker can provoke an `OutOfMemoryError`. This `OutOfMemoryError` occurs during the parsing, because at each level the parser will [call `toString()`](https://github.com/stleary/JSON-java/blob/01727fd0ed00c1f1f5582bdc97244356ac029f3b/src/main/java/org/json/JSONObject.java#L226) on the array-of-object, which in turn will end up calling [`quote`](https://github.com/stleary/JSON-java/blob/01727fd0ed00c1f1f5582bdc97244356ac029f3b/src/main/java/org/json/JSONObject.java#L2178).  I dare say an attacker can also provoke a `StackOverflowError` similar to [#654](https://github.com/stleary/JSON-java/issues/654), but an `OutOfMemoryError` is more severe because it can affect everything running in the JVM, not just the thread that is parsing the input. Servers can't safely recover from `OutOfMemoryError` in general.  [#660](https://github.com/stleary/JSON-java/pull/660) already addressed problems like this to some extent. It adds both a catch for `StackOverflowError` and some logic to prevent keys that are themselves objects. Here I'm saying that that logic can be bypassed, and in [#772](https://github.com/stleary/JSON-java/pull/772) I'm proposing alternative logic that I think can't be. |
| --- |

 üëç
5
 stleary, brsolomon-deloitte, yokeshbabu-dj-20258, Yotimes, and mayaba reacted with thumbs up emoji

All reactions

* üëç
  5 reactions

Sorry, something went wrong.

[![@stleary](https://avatars.githubusercontent.com/u/5107558?s=80&u=fbfe657488541faf7a084c543be5a907e50f1afe&v=4)](/stleary)

Copy link

Owner

### **[stleary](/stleary)** commented [Sep 24, 2023](#issuecomment-1732583345) ‚Ä¢ edited Loading

| Now convinced there is a bug in how missing quotes are handled. Updating the string for clarity.  **How should this text be parsed?** `"{a:1,[{b:2,[{c:3,[{d:4}]:5}]:6}]:7}"`  **20230618 release:** {"a":1,"[{"b":2,"[{\"c\":3,\"[{\\\"d\\\":4}]\":5}]":6}]":7}  **[#772](https://github.com/stleary/JSON-java/pull/772) fix:** org.json.JSONException: Nested array not expected here. at 6 [character 7 line 1] (probably should be referencing character 6)  **I think the parser should terminate implicit strings by a colon for JSONObject, and by a comma or closing bracket for JSONArray):**  ```     {         "a":1,         "[{b":2,         "[{c",3,         "[{d", 4,         "}]",5,         "}]",6,     # error for duplicate key         "}]",7      # error for duplicate key      }  ```  Post here if anyone has a different take on how the parser should work. |
| --- |

 üëç
3
 johnjaylward, karthiicksiva, and mayaba reacted with thumbs up emoji

All reactions

* üëç
  3 reactions

Sorry, something went wrong.

[![@johnjaylward](https://avatars.githubusercontent.com/u/383703?s=80&v=4)](/johnjaylward)

Copy link

Contributor

### **[johnjaylward](/johnjaylward)** commented [Sep 24, 2023](#issuecomment-1732584041)

| **I think the parser should terminate implicit strings by a colon for JSONObject, and by a comma or closing bracket for JSONArray):**  ```     {         "a":1,         "[{b":2,         "[{c",3,         "[{d", 4,         "}]",5,         "}]",6,     # error for duplicate key         "}]",7      # error for duplicate key      }  ```  This makes the most sense to me |
| --- |

All reactions

Sorry, something went wrong.

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=80&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)

Copy link

Contributor

Author

### **[eamonnmcmanus](/eamonnmcmanus)** commented [Sep 26, 2023](#issuecomment-1736095348)

| It's certainly possible to introduce a clearer rule for unquoted keys. Those aren't standard JSON, but we can imagine that if people use them then they are expecting something like JavaScript semantics. Scanning to the first `:` is probably a fair approximation of that. For the example string `{a:1,[{b:2,[{c:3,[{d:4}]:5}]:6}]:7}`, I would expect that to be a syntax error. The first parsed keys would indeed be `a`, `[{b`, `[{c`, and `[{d`, with corresponding values 1, 2, 3, 4, but then the `}` after `4` would be interpreted as the end of the object. As far as I can see, the current code doesn't actually throw an exception if there is junk after the closing `}`, so in fact the result would be  ``` {     "a":1,     "[{b":2,     "[{c":3,     "[{d":4 }  ```  A similar rule for unquoted values in arrays (scanning to the first `,` or `]`) would I think be straightforward to do at the same time.  In both cases this can change the parse of some existing strings. For example `{a:1,[{b:2,[{c:3,[{d:4}]:5}]:6}]:7}` is currently parsed as an object with two keys: `a` and `[{"b":2,"[{\"c\":3,\"[{\\\"d\\\":4}]\":5}]":6}]`. For JSONArray, I think it means that some strings that are not currently accepted would be. `[a}]` is currently rejected but with the change it would be a single-element array containing the string `a}`.  To be honest, I'm not sure that this would be solving a problem that anyone has. I don't think anyone has JSON strings like this that they expect to be able to parse with the results above, or to be able to parse at all. But the new rules are at least simpler to explain.  I will look into what's involved in making another PR implementing these rules. |
| --- |

All reactions

Sorry, something went wrong.

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=80&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)

Copy link

Contributor

Author

### **[eamonnmcmanus](/eamonnmcmanus)** commented [Sep 26, 2023](#issuecomment-1736304363)

| I've prototyped some of the above, but the more I think about it the less I like it. Some JSON implementations do indeed go beyond the spec to allow object keys that are not string literals. But I think that is to be more like JavaScript (which of course is the JS of JSON). JavaScript does allow "object literals" like `{a:23}` and `{17:23}`, which are equivalent to `{"a":23}`and `{"17":23}` respectively. But it doesn't allow nested arrays or objects there, and it particularly doesn't allow random characters so as to treat `{[{b:2}` as `{"[{b":2}`. So I really do think that the approach in [#772](https://github.com/stleary/JSON-java/pull/772) is best. Especially given that the code already does forbid nested arrays and objects in keys *most* of the time. |
| --- |

 üëç
1
 stleary reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@stleary](https://avatars.githubusercontent.com/u/5107558?s=40&u=fbfe657488541faf7a084c543be5a907e50f1afe&v=4)](/stleary)
[stleary](/stleary)
added
the
[Active discussion](/stleary/JSON-java/labels/Active%20discussion)
label
[Sep 26, 2023](#event-10480972184)

[![@stleary](https://avatars.githubusercontent.com/u/5107558?s=80&u=fbfe657488541faf7a084c543be5a907e50f1afe&v=4)](/stleary)

Copy link

Owner

### **[stleary](/stleary)** commented [Sep 26, 2023](#issuecomment-1736455234)

| Agreed that if the user wants a key, value, or list element to use chars that might be interpreted as JSON control chars like braces, brackets, commas, etc., then they need to use double quotes. So for example `{[b:2}` should be disallowed, but `{b:2}` or `{"[b":"]2"}` would be OK. I think it is better in this case to modify the existing behavior so that the parser is more intuitive and predictable. |
| --- |

All reactions

Sorry, something went wrong.

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=80&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)

Copy link

Contributor

Author

### **[eamonnmcmanus](/eamonnmcmanus)** commented [Sep 27, 2023](#issuecomment-1737687131)

| I think it is better in this case to modify the existing behavior so that the parser is more intuitive and predictable.  Did you have something in mind? The main alternative I see to just bailing on `[` and `{` would be to use the [existing set](https://github.com/stleary/JSON-java/blob/4e8231c512ce3f53a177f7ede8639f01f60c4f19/src/main/java/org/json/JSONTokener.java#L437) of special characters and say that a key is any sequence of non-blank characters that doesn't contain one of those. Since `[` and `{` are both in the set, that means you'll still get an exception for the examples we've been talking about, but it might be more like "expecting `:`" with a line and column number pointing to the `[` or `{`, rather than something about nesting. |
| --- |

All reactions

Sorry, something went wrong.

[![@stleary](https://avatars.githubusercontent.com/u/5107558?s=80&u=fbfe657488541faf7a084c543be5a907e50f1afe&v=4)](/stleary)

Copy link

Owner

### **[stleary](/stleary)** commented [Sep 27, 2023](#issuecomment-1737912696)

| It seems to me that you, [@johnjaylward](https://github.com/johnjaylward), and I have about the same idea, maybe differing in details. Your approach makes sense, please proceed, and let's see how it turns out. |
| --- |

All reactions

Sorry, something went wrong.

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=80&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)

Copy link

Contributor

Author

### **[eamonnmcmanus](/eamonnmcmanus)** commented [Sep 27, 2023](#issuecomment-1737988159)

| OK, well I did what I said in my [last comment](https://github.com/stleary/JSON-java/issues/771#issuecomment-1737687131) and updated [#772](https://github.com/stleary/JSON-java/pull/772) so it just skips past the part of `nextValue()` that would allow an object key to be another object or an array. That means that something like `{a:1,[{b:2}]:3}` will get an exception at the `[` since that's not an allowed character in unquoted text. So you get the same "Missing value" exception as you would for something like `{#:1}`. |
| --- |

All reactions

Sorry, something went wrong.

[![@stleary](https://avatars.githubusercontent.com/u/5107558?s=40&u=fbfe657488541faf7a084c543be5a907e50f1afe&v=4)](/stleary)
[stleary](/stleary)
closed this as [completed](/stleary/JSON-java/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#772](/stleary/JSON-java/pull/772)
[Oct 1, 2023](#event-10519949877)

[![@johnjaylward](https://avatars.githubusercontent.com/u/383703?s=40&v=4)](/johnjaylward)
[johnjaylward](/johnjaylward)
mentioned this issue
[Oct 13, 2023](#ref-issue-1941052489)

[CVE-2023-5072 - Denial of Service in JSON-Java versions up to and including 20230618.
#789](/stleary/JSON-java/issues/789)

Open

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this issue
[Oct 16, 2023](#ref-issue-1944214948)

[Allocation of Resources Without Limits or Throttling SNYK-JAVA-ORGJSON-5962464
RADAR-base/RADAR-Rest-Source-Auth#242](/RADAR-base/RADAR-Rest-Source-Auth/issues/242)

Closed

[![@IVU-REK](https://avatars.githubusercontent.com/u/14013231?s=40&v=4)](/IVU-REK)
[IVU-REK](/IVU-REK)
mentioned this issue
[Oct 24, 2023](#ref-issue-1958989365)

[CVE-2023-5072 in org.json/json
primefaces/primefaces#10886](/primefaces/primefaces/issues/10886)

Closed

This was referenced Oct 30, 2023

[Security scan tool (Black Duck Binary Analysis) detected CVE-2022-45688, is the latest version 1.5.4 really affected by this vulnerability?
jettison-json/jettison#77](/jettison-json/jettison/issues/77)

Closed

[Security scan tool (Black Duck Binary Analysis) detected CVE-2023-5072, is the latest version 1.5.4 really affected by this vulnerability?
jettison-json/jettison#86](/jettison-json/jettison/issues/86)

Open

[![@AUK4GIT](https://avatars.githubusercontent.com/u/6498990?s=40&v=4)](/AUK4GIT)
[AUK4GIT](/AUK4GIT)
mentioned this issue
[Nov 24, 2023](#ref-issue-2009460276)

[feat:
ionic-team/capacitor#7095](/ionic-team/capacitor/issues/7095)

Closed

[![@claireagordon](https://avatars.githubusercontent.com/u/62080877?s=40&v=4)](/claireagordon)
[claireagordon](/claireagordon)
mentioned this issue
[Mar 26, 2024](#ref-pullrequest-2208959428)

[CVE-2023-5072: disallow nested object/array keys & detect embedded \0
yext/JSON-java#1](/yext/JSON-java/pull/1)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fstleary%2FJSON-java%2Fissues%2F771)

Assignees

No one assigned

Labels

[Active discussion](/stleary/JSON-java/labels/Active%20discussion)

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Disallow nested objects and arrays as keys in objects](/stleary/JSON-java/pull/772)
 [eamonnmcmanus/JSON-java](/eamonnmcmanus/JSON-java)

3 participants

[![@johnjaylward](https://avatars.githubusercontent.com/u/383703?s=52&v=4)](/johnjaylward) [![@stleary](https://avatars.githubusercontent.com/u/5107558?s=52&v=4)](/stleary) [![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=52&v=4)](/eamonnmcmanus)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_78544645_20250114_181026.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstleary%2FJSON-java%2Fissues%2F758)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstleary%2FJSON-java%2Fissues%2F758)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=stleary%2FJSON-java)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[stleary](/stleary)
/
**[JSON-java](/stleary/JSON-java)**
Public

* [Notifications](/login?return_to=%2Fstleary%2FJSON-java) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2Fstleary%2FJSON-java)
* [Star
   4.6k](/login?return_to=%2Fstleary%2FJSON-java)

* [Code](/stleary/JSON-java)
* [Issues
  39](/stleary/JSON-java/issues)
* [Pull requests
  6](/stleary/JSON-java/pulls)
* [Actions](/stleary/JSON-java/actions)
* [Projects
  0](/stleary/JSON-java/projects)
* [Wiki](/stleary/JSON-java/wiki)
* [Security](/stleary/JSON-java/security)
* [Insights](/stleary/JSON-java/pulse)

Additional navigation options

* [Code](/stleary/JSON-java)
* [Issues](/stleary/JSON-java/issues)
* [Pull requests](/stleary/JSON-java/pulls)
* [Actions](/stleary/JSON-java/actions)
* [Projects](/stleary/JSON-java/projects)
* [Wiki](/stleary/JSON-java/wiki)
* [Security](/stleary/JSON-java/security)
* [Insights](/stleary/JSON-java/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fstleary%2FJSON-java%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fstleary%2FJSON-java%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Confusion between `\0` and EOF can lead to OutOfMemoryError #758

Closed

[eamonnmcmanus](/eamonnmcmanus) opened this issue
Aug 1, 2023
¬∑ 6 comments
 ¬∑ Fixed by [#759](https://github.com/stleary/JSON-java/pull/759)

Closed

# [Confusion between `\0` and EOF can lead to OutOfMemoryError](#top) #758

[eamonnmcmanus](/eamonnmcmanus) opened this issue
Aug 1, 2023
¬∑ 6 comments
 ¬∑ Fixed by [#759](https://github.com/stleary/JSON-java/pull/759)

Labels
[Active discussion](/stleary/JSON-java/labels/Active%20discussion)

## Comments

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=80&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)

Copy link

Contributor

### **[eamonnmcmanus](/eamonnmcmanus)** commented [Aug 1, 2023](#issue-1831811460)

| `JSONTokener.next()` [uses](https://github.com/stleary/JSON-java/blob/402db6ad84353c84e4747510a8ac5322b32a8df4/src/main/java/org/json/JSONTokener.java#L182) a 0 return to indicate EOF. But 0 is also returned when an actual `\0` character is read. In some circumstances that can be used to circumvent parser checks. Parsing untrusted input could then potentially lead to OutOfMemoryError even for quite small input strings. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@johnjaylward](https://avatars.githubusercontent.com/u/383703?s=80&v=4)](/johnjaylward)

Copy link

Contributor

### **[johnjaylward](/johnjaylward)** commented [Aug 1, 2023](#issuecomment-1660893516)

| Do you have an actual test to validate this?  I'd argue that valid text input should never have a `\0` in it in the first place, so treating it the same as EOF would just make the parsed JSON document invalid. From what I remember of the parser, this should make the parsing stop and if the JSON value is not complete, than the parse would fail with an JSONException |
| --- |

All reactions

Sorry, something went wrong.

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=80&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)

Copy link

Contributor

Author

### **[eamonnmcmanus](/eamonnmcmanus)** commented [Aug 1, 2023](#issuecomment-1660960334)

| Yes, I have a test that can provoke OutOfMemoryError with a small input, though I'm not going to publish it until a fix has been released. Yes, `\0` should mean EOF everywhere, but it currently doesn't. |
| --- |

All reactions

Sorry, something went wrong.

[![@johnjaylward](https://avatars.githubusercontent.com/u/383703?s=80&v=4)](/johnjaylward)

Copy link

Contributor

### **[johnjaylward](/johnjaylward)** commented [Aug 1, 2023](#issuecomment-1660972105)

| Without a PoC, I doubt anyone else will fix this.  Feel free to submit a PR.  I don't think I'd consider a OOME a security issue, but if you feel different, follow the instructions for those here: <https://github.com/stleary/JSON-java/wiki/FAQ#how-are-vulnerabilities-and-exploits-handled> |
| --- |

All reactions

Sorry, something went wrong.

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=80&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)

Copy link

Contributor

Author

### **[eamonnmcmanus](/eamonnmcmanus)** commented [Aug 1, 2023](#issuecomment-1661002839)

| I think Denial of Service attacks kind of *are* security issues, aren't they? If you can make a server fall over by firing carefully-crafted JSON at it, that seems not great. Anyway, yes, my next step was to submit a PR.  (I have already shared repro details with [@stleary](https://github.com/stleary).) |
| --- |

 üëç
7
 BrunoVernay, ivesa, sanjeevirajm, J0B10, arnab36, larrywest, and mayaba reacted with thumbs up emoji

All reactions

* üëç
  7 reactions

Sorry, something went wrong.

[eamonnmcmanus](/eamonnmcmanus)
added a commit
to eamonnmcmanus/JSON-java
that referenced
this issue
[Aug 1, 2023](#ref-commit-c8a9e15)
[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=40&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)

`[Don't skip past \0 when parsing JSON objects.](/eamonnmcmanus/JSON-java/commit/c8a9e15a57886dbf3e51cd450bde8e0c4599bff3 "Don't skip past `\0` when parsing JSON objects.

A better solution might be to use -1 instead 0 to represent EOF everywhere,
which of course means changing `char` variables to `int`. The solution here is
enough to solve the immediate problem, though.

Fixes #758.")`
‚Ä¶

`[c8a9e15](/eamonnmcmanus/JSON-java/commit/c8a9e15a57886dbf3e51cd450bde8e0c4599bff3)`

```
A better solution might be to use -1 instead 0 to represent EOF everywhere,
which of course means changing `char` variables to `int`. The solution here is
enough to solve the immediate problem, though.

Fixes [stleary#758](https://github.com/stleary/JSON-java/issues/758).
```

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=40&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)
[eamonnmcmanus](/eamonnmcmanus)
mentioned this issue
[Aug 1, 2023](#ref-pullrequest-1831965829)

[JSON parsing should detect embedded `\0` values
#759](/stleary/JSON-java/pull/759)
 Merged

[![@stleary](https://avatars.githubusercontent.com/u/5107558?s=80&u=fbfe657488541faf7a084c543be5a907e50f1afe&v=4)](/stleary)

Copy link

Owner

### **[stleary](/stleary)** commented [Aug 1, 2023](#issuecomment-1661025664)

| [@eamonnmcmanus](https://github.com/eamonnmcmanus) Good catch and thanks for bringing this up. In this case, it's OK to post the recreate code and proposed fix. |
| --- |

All reactions

Sorry, something went wrong.

[![@stleary](https://avatars.githubusercontent.com/u/5107558?s=40&u=fbfe657488541faf7a084c543be5a907e50f1afe&v=4)](/stleary)
[stleary](/stleary)
added
the
[Active discussion](/stleary/JSON-java/labels/Active%20discussion)
label
[Aug 1, 2023](#event-9980798929)

[![@johnjaylward](https://avatars.githubusercontent.com/u/383703?s=80&v=4)](/johnjaylward)

Copy link

Contributor

### **[johnjaylward](/johnjaylward)** commented [Aug 1, 2023](#issuecomment-1661027420)

| DoS issues are about reliability. They are not security issues in and of themselves.  If the DoS leads to some other other issues like memory corruption or getting access to information that shouldn't be available, then it would track as security. |
| --- |

 üëç
1
 sanjeevirajm reacted with thumbs up emoji
 üëé
7
 J0B10, rouke-broersma, igorbga, danekja, larrywest, mayaba, and LeonardoPantani reacted with thumbs down emoji

All reactions

* üëç
  1 reaction
* üëé
  7 reactions

Sorry, something went wrong.

[![@stleary](https://avatars.githubusercontent.com/u/5107558?s=40&u=fbfe657488541faf7a084c543be5a907e50f1afe&v=4)](/stleary)
[stleary](/stleary)
closed this as [completed](/stleary/JSON-java/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#759](/stleary/JSON-java/pull/759)
[Aug 5, 2023](#event-10015329691)

[![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=40&u=460e6c0f31206cc9dc5552a3c6b1634ea7f98ee9&v=4)](/eamonnmcmanus)
[eamonnmcmanus](/eamonnmcmanus)
mentioned this issue
[Sep 20, 2023](#ref-issue-1905464604)

[Logic to exclude object keys that are themselves objects is imperfect
#771](/stleary/JSON-java/issues/771)

Closed

[![@johnjaylward](https://avatars.githubusercontent.com/u/383703?s=40&v=4)](/johnjaylward)
[johnjaylward](/johnjaylward)
mentioned this issue
[Oct 13, 2023](#ref-issue-1941052489)

[CVE-2023-5072 - Denial of Service in JSON-Java versions up to and including 20230618.
#789](/stleary/JSON-java/issues/789)

Open

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this issue
[Oct 16, 2023](#ref-issue-1944214948)

[Allocation of Resources Without Limits or Throttling SNYK-JAVA-ORGJSON-5962464
RADAR-base/RADAR-Rest-Source-Auth#242](/RADAR-base/RADAR-Rest-Source-Auth/issues/242)

Closed

[![@ddjain](https://avatars.githubusercontent.com/u/17905734?s=40&v=4)](/ddjain)
[ddjain](/ddjain)
mentioned this issue
[Oct 24, 2023](#ref-pullrequest-1958568585)

[Mitigate dependency vulnerability in a2d2: json-20230227.jar
elimuinformatics/a2d2#390](/elimuinformatics/a2d2/pull/390)
 Merged

[![@IVU-REK](https://avatars.githubusercontent.com/u/14013231?s=40&v=4)](/IVU-REK)
[IVU-REK](/IVU-REK)
mentioned this issue
[Oct 24, 2023](#ref-issue-1958989365)

[CVE-2023-5072 in org.json/json
primefaces/primefaces#10886](/primefaces/primefaces/issues/10886)

Closed

This was referenced Oct 30, 2023

[Security scan tool (Black Duck Binary Analysis) detected CVE-2022-45688, is the latest version 1.5.4 really affected by this vulnerability?
jettison-json/jettison#77](/jettison-json/jettison/issues/77)

Closed

[Security scan tool (Black Duck Binary Analysis) detected CVE-2023-5072, is the latest version 1.5.4 really affected by this vulnerability?
jettison-json/jettison#86](/jettison-json/jettison/issues/86)

Open

[![@AUK4GIT](https://avatars.githubusercontent.com/u/6498990?s=40&v=4)](/AUK4GIT)
[AUK4GIT](/AUK4GIT)
mentioned this issue
[Nov 24, 2023](#ref-issue-2009460276)

[feat:
ionic-team/capacitor#7095](/ionic-team/capacitor/issues/7095)

Closed

[claireagordon](/claireagordon)
added a commit
to yext/JSON-java
that referenced
this issue
[Mar 26, 2024](#ref-commit-4fa27f1)
[![@claireagordon](https://avatars.githubusercontent.com/u/62080877?s=40&v=4)](/claireagordon)

`[JSON parsing should detect embedded \0 values](/yext/JSON-java/commit/4fa27f1bf2972276475bfac2edd27f083209d1b0 "JSON parsing should detect embedded \0 values

See:
https://github.com/stleary/JSON-java/issues/758
https://github.com/stleary/JSON-java/pull/759

Port pull #759 from stleary/JSON-java to help
address OOM errors described in
https://www.cve.org/CVERecord?id=CVE-2023-5072

To support the JSONTokener.end() function this
relies on, port over the 'eof' flag & set in
all locations it's used in the latest JSON-java.

Use the String next(int n) implementation from
more recent java versions so we can properly check
end() while reading a group of characters.

Test by:
- importing into alpha locally & running all tests
that depend on //thirdparty:json
- verifying that Snyk's proof-of-concept does
not cause OOMs:
https://security.snyk.io/vuln/SNYK-JAVA-ORGJSON-5962464")`
‚Ä¶

`[4fa27f1](/yext/JSON-java/commit/4fa27f1bf2972276475bfac2edd27f083209d1b0)`

```
See:
[stleary/JSON-java#758](https://github.com/stleary/JSON-java/issues/758)
[stleary/JSON-java#759](https://github.com/stleary/JSON-java/pull/759)

Port pull #759 from stleary/JSON-java to help
address OOM errors described in
<https://www.cve.org/CVERecord?id=CVE-2023-5072>

To support the JSONTokener.end() function this
relies on, port over the 'eof' flag & set in
all locations it's used in the latest JSON-java.

Use the String next(int n) implementation from
more recent java versions so we can properly check
end() while reading a group of characters.

Test by:
- importing into alpha locally & running all tests
that depend on //thirdparty:json
- verifying that Snyk's proof-of-concept does
not cause OOMs:
<https://security.snyk.io/vuln/SNYK-JAVA-ORGJSON-5962464>
```

[![@claireagordon](https://avatars.githubusercontent.com/u/62080877?s=40&v=4)](/claireagordon)
[claireagordon](/claireagordon)
mentioned this issue
[Mar 26, 2024](#ref-pullrequest-2208959428)

[CVE-2023-5072: disallow nested object/array keys & detect embedded \0
yext/JSON-java#1](/yext/JSON-java/pull/1)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fstleary%2FJSON-java%2Fissues%2F758)

Assignees

No one assigned

Labels

[Active discussion](/stleary/JSON-java/labels/Active%20discussion)

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [JSON parsing should detect embedded `\0` values](/stleary/JSON-java/pull/759)
 [eamonnmcmanus/JSON-java](/eamonnmcmanus/JSON-java)

3 participants

[![@johnjaylward](https://avatars.githubusercontent.com/u/383703?s=52&v=4)](/johnjaylward) [![@stleary](https://avatars.githubusercontent.com/u/5107558?s=52&v=4)](/stleary) [![@eamonnmcmanus](https://avatars.githubusercontent.com/u/5246810?s=52&v=4)](/eamonnmcmanus)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from security.netapp.com_224c48e1_20250114_181029.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
√¶¬ó¬•√¶¬ú¬¨√®¬™¬û

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [May 2024 IBM Cognos Analytics Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20240621-0007)

## May 2024 IBM Cognos Analytics Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close √ó

#### Subscribe to NTAP-20240621-0007 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240621-0007 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close √ó

#### Unsubscribe from NTAP-20240621-0007 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240621-0007 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240621-0007
**Version:**
2.0

**Last updated:**
09/20/2024

**Status:**
Final.

**CVEs:** CVE-2023-44981, CVE-2023-44487, CVE-2023-5072, CVE-2023-34462, CVE-2024-25047, CVE-2022-23540, CVE-2022-23541, CVE-2022-23539, CVE-2023-31484, CVE-2020-15366, CVE-2021-28363

Overview
#### Summary

Multiple NetApp products incorporate IBM Cognos Analytics. IBM Cognos Analytics versions 12.0 through 12.0.2 and 11.2.0 through 11.2.4 FP2 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2020-15366](https://nvd.nist.gov/vuln/detail/CVE-2020-15366) | 5.6 (MEDIUM) | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L |
| [CVE-2021-28363](https://nvd.nist.gov/vuln/detail/CVE-2021-28363) | 5.9 (MEDIUM) | CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:L/A:N |
| [CVE-2022-23539](https://nvd.nist.gov/vuln/detail/CVE-2022-23539) | 5.9 (MEDIUM) | CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:N |
| [CVE-2022-23540](https://nvd.nist.gov/vuln/detail/CVE-2022-23540) | 6.4 (MEDIUM) | CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:L |
| [CVE-2022-23541](https://nvd.nist.gov/vuln/detail/CVE-2022-23541) | 5.0 (MEDIUM) | CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L |
| [CVE-2023-31484](https://nvd.nist.gov/vuln/detail/CVE-2023-31484) | 7.4 (HIGH) | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N |
| [CVE-2023-34462](https://nvd.nist.gov/vuln/detail/CVE-2023-34462) | 6.5 (MEDIUM) | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2023-44487](https://nvd.nist.gov/vuln/detail/CVE-2023-44487) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2023-44981](https://nvd.nist.gov/vuln/detail/CVE-2023-44981) | 8.1 (HIGH) | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2023-5072](https://nvd.nist.gov/vuln/detail/CVE-2023-5072) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2024-25047](https://nvd.nist.gov/vuln/detail/CVE-2024-25047) | 8.6 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://www.ibm.com/support/pages/node/7149874>

Affected Products
#### Affected Products

* OnCommand Insight

#### Products Not Affected

* AFF BIOS - A1K/A70/A90
* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A1K/A70/A90
* AFF Baseboard Management Controller (BMC) - A700s
* AFF LOADER- A1K/A70/A90
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp DataOps Toolkit
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 10
* ONTAP tools for VMware vSphere 9
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG5812/SG5860
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* StorageGRID Baseboard Management Controller (BMC) SG5812/SG5860
* System Manager 9.x
* Terraform Provider for ONTAP

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **OnCommand Insight** | <https://mysupport.netapp.com/site/products/all/details/oncommand-insight/downloads-tab/download/60983/7.3.16> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240621-0007>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240621 | Initial Public Release |
| 2.0 | 20240920 | OnCommand Insight added to Software Versions and Fixes, Final status |

This document is provided solely for informational purposes. All information is based upon NetApp√¢¬Ä¬ôs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. √Ç¬© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ¬©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from www.openwall.com_f82909be_20250114_181024.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <381C59E7-FFD1-4ED5-B567-40E6D98E13B0@beckweb.net>
Date: Wed, 13 Dec 2023 18:22:37 +0100
From: Daniel Beck <ml@...kweb.net>
To: oss-security@...ts.openwall.com
Subject: Multiple vulnerabilities in Jenkins plugins

Jenkins is an open source automation server which enables developers around
the world to reliably build, test, and deploy their software.

The following releases contain fixes for security vulnerabilities:

* Analysis Model API Plugin 11.13.0
* Nexus Platform Plugin 3.18.1-01
* Scriptler Plugin 344.v5a_ddb_5f9e685

Additionally, we announce unresolved security issues in the following
plugins:

* Deployment Dashboard Plugin
* Dingding JSON Pusher Plugin
* HTMLResource Plugin
* OpenId Connect Authentication Plugin
* PaaSLane Estimate Plugin

Summaries of the vulnerabilities are below. More details, severity, and
attribution can be found here:
<https://www.jenkins.io/security/advisory/2023-12-13/>

We provide advance notification for security updates on this mailing list:
<https://groups.google.com/d/forum/jenkinsci-advisories>

If you discover security vulnerabilities in Jenkins, please report them as
described here:
<https://www.jenkins.io/security/#reporting-vulnerabilities>

---

SECURITY-3327 / CVE-2023-5072
Analysis Model API Plugin 11.11.0 and earlier bundles versions of JSON-Java
vulnerable to CVE-2023-5072.

This may allow attackers able to control input to cause a Denial of Service
(DoS) by parsing a crafted JSON document.

SECURITY-3205 / CVE-2023-50764
Scriptler Plugin 342.v6a_89fd40f466 and earlier does not restrict a file
name query parameter in an HTTP endpoint.

This allows attackers with Scriptler/Configure permission to delete
arbitrary files on the Jenkins controller file system.

SECURITY-3206 / CVE-2023-50765
Scriptler Plugin 342.v6a_89fd40f466 and earlier does not perform a
permission check in an HTTP endpoint.

This allows attackers with Overall/Read permission to read the contents of
a Groovy script by knowing its ID.

SECURITY-3204 / CVE-2023-50766 (CSRF) & CVE-2023-50767 (missing permission check)
Nexus Platform Plugin 3.18.0-03 and earlier does not perform permission
checks in methods implementing form validation.

This allows attackers with Overall/Read permission to send an HTTP request
to an attacker-specified URL and parse the response as XML.

Additionally, the plugin does not configure its XML parser to prevent XML
external entity (XXE) attacks, so attackers can have Jenkins parse a
crafted XML response that uses external entities for extraction of secrets
from the Jenkins controller or server-side request forgery.

Additionally, these form validation methods do not require POST requests,
resulting in a cross-site request forgery (CSRF) vulnerability.

SECURITY-3203 / CVE-2023-50768 (CSRF) & CVE-2023-50769 (missing permission check)
Nexus Platform Plugin 3.18.0-03 and earlier does not perform permission
checks in methods implementing form validation.

This allows attackers with Overall/Read permission to connect to an
attacker-specified HTTP server using attacker-specified credentials IDs
obtained through another method, capturing credentials stored in Jenkins.

Additionally, these form validation methods do not require POST requests,
resulting in a cross-site request forgery (CSRF) vulnerability.

SECURITY-3168 / CVE-2023-50770
OpenId Connect Authentication Plugin provides an anti-lockout feature,
which allows administrators to define a local user account that can be used
to recover access to Jenkins.

In OpenId Connect Authentication Plugin 2.6 and earlier the password to
that account is stored in a recoverable format.

This allows attackers with access to the Jenkins controller file system to
recover the plain text password of that account, likely gaining
administrator access to Jenkins.

As of publication of this advisory, there is no fix.

SECURITY-2979 / CVE-2023-50771
OpenId Connect Authentication Plugin 2.6 and earlier improperly determines
that a redirect URL after login is legitimately pointing to Jenkins.

This allows attackers to perform phishing attacks by having users go to a
Jenkins URL that will forward them to a different site after successful
authentication.

As of publication of this advisory, there is no fix.

SECURITY-3184 / CVE-2023-50772 (storage) & CVE-2023-50773 (masking)
Dingding JSON Pusher Plugin 2.0 and earlier stores access tokens
unencrypted in job `config.xml` files on the Jenkins controller as part of
its configuration.

These tokens can be viewed by users with Item/Extended Read permission or
access to the Jenkins controller file system.

Additionally, the job configuration form does not mask these tokens,
increasing the potential for attackers to observe and capture them.

As of publication of this advisory, there is no fix.

SECURITY-3183 / CVE-2023-50774
HTMLResource Plugin 1.02 and earlier does not require POST requests for an
HTTP endpoint, resulting in a cross-site request forgery (CSRF)
vulnerability.

This vulnerability allows attackers to delete arbitrary files on the
Jenkins controller file system.

As of publication of this advisory, there is no fix.

SECURITY-3092 / CVE-2023-50775
Deployment Dashboard Plugin 1.0.10 and earlier does not require POST
requests for an HTTP endpoint, resulting in a cross-site request forgery
(CSRF) vulnerability.

This vulnerability allows attackers to copy jobs.

As of publication of this advisory, there is no fix.

SECURITY-3182 / CVE-2023-50776 (storage) & CVE-2023-50777 (masking)
PaaSLane Estimate Plugin 1.0.4 and earlier stores PaaSLane authentication
tokens unencrypted in job `config.xml` files on the Jenkins controller as
part of its configuration.

These tokens can be viewed by users with Item/Extended Read permission or
access to the Jenkins controller file system.

Additionally, the job configuration form does not mask these tokens,
increasing the potential for attackers to observe and capture them.

As of publication of this advisory, there is no fix.

SECURITY-3179 / CVE-2023-50778 (CSRF) & CVE-2023-50779 (missing permission check)
PaaSLane Estimate Plugin 1.0.4 and earlier does not perform permission
checks in several HTTP endpoints.

This allows attackers with Overall/Read permission to connect to an
attacker-specified URL using an attacker-specified token.

Additionally, these HTTP endpoints do not require POST requests, resulting
in a cross-site request forgery (CSRF) vulnerability.

As of publication of this advisory, there is no fix.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


