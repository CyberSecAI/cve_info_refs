- **Root cause of vulnerability:** The plugin retrieves client IP addresses from HTTP headers that can be manipulated by an attacker. Specifically, it appears the plugin uses the `Client-Ip` header to obtain the IP address instead of relying on the server-provided IP.
- **Weaknesses/vulnerabilities present:** IP address spoofing.
- **Impact of exploitation:** Attackers can manipulate the logged IP addresses, hiding their malicious actions, and potentially bypassing security measures that rely on accurate IP information.
- **Attack vectors:** The attacker sends a crafted HTTP request to the WordPress login page (`/wp-login.php`) with a spoofed `Client-Ip` header.
- **Required attacker capabilities/position:** The attacker can send arbitrary HTTP requests to the target WordPress site and set custom HTTP headers. The attacker does not need any authentication or prior access.