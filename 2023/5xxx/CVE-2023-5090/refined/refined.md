Based on the provided documents, here's a breakdown of the vulnerability related to CVE-2023-5090:

**Root Cause of Vulnerability:**

The vulnerability lies within the KVM (Kernel Virtual Machine) implementation for AMD's Secure Virtual Machine (SVM) when using the Advanced Virtual Interrupt Controller (AVIC) and the x2APIC. Specifically, the `svm_set_x2apic_msr_interception` function, responsible for enabling or disabling the interception of x2APIC Model Specific Registers (MSRs), contains an incorrect check. This erroneous check, `!apic_x2apic_mode()`, prevents the function from properly setting up the interception when a guest operating system resets its APIC from x2APIC mode back to xAPIC mode.

**Weaknesses/Vulnerabilities Present:**

*   **Improper MSR Interception:** The core issue is that the x2APIC MSRs are not intercepted as expected when a guest transitions from x2APIC to xAPIC mode after an APIC reset. This leaves the bare-metal x2APIC exposed to the guest OS, bypassing the hypervisor's virtualization layer.

**Impact of Exploitation:**

*   **Direct Host x2APIC Access:** A malicious guest operating system could potentially directly access and manipulate the host system's x2APIC through the unintercepted MSRs.
*   **Denial of Service (DoS):** This direct access can lead to a denial of service, potentially by corrupting host resources or crashing the host OS.

**Attack Vectors:**

*   **Guest OS Reset:** The vulnerability is triggered when a guest operating system transitions its APIC from x2APIC mode to xAPIC mode, typically after an APIC reset.
*   **Malicious Guest OS:** An attacker would need control over the guest operating system to initiate the APIC reset and exploit the unintercepted x2APIC MSRs.

**Required Attacker Capabilities/Position:**

*   **Malicious Guest:** The attacker must be able to execute code within a virtualized guest operating system, and have the ability to cause the guest APIC to reset.
*   **KVM and AVIC Enabled:** The vulnerable system must be running KVM virtualization with AVIC enabled.
*  **AMD SVM Environment**: The vulnerability is present in AMD SVM environments when the x2AVIC feature is used.

**Additional Technical Details:**

*   The fix involves removing the incorrect check: `!apic_x2apic_mode()` from the function `svm_set_x2apic_msr_interception`. This ensures the function properly sets up interception regardless of the guest's APIC mode.
*   The vulnerability affects systems where x2AVIC was enabled in KVM.

**Summary of Patches and Workarounds:**

*   **Patch:** The primary fix is within the KVM code:
    *   `arch/x86/kvm/svm/svm.c`: Modified to remove the faulty conditional check to ensure proper x2APIC MSR interception is always enabled when x2avic is active.
*   **Workaround:** The issue also has an errata that can be worked around by never setting the 'is_running' bit, which ensures a VM exit on all ICR writes. This is an "errata param" which can be toggled on/off with 'avic_zen2_errata_workaround=0'. This may impact performance by forcing more VM exits but prevents the vulnerability. In later versions of the patch, the `enable_ipiv` parameter was moved to common x86 code and it was used to disable the IPI virtualization which avoids the conditionals. 
*   There are also patches to add support for a new 'invalid IPI vector' exit code, which was introduced in later AMD APM revisions.
* There is also a patch to refresh AVIC inhibition after a nested VM exit.

**Affected Products:**

The vulnerability affects Red Hat Enterprise Linux 8 and 9 (including RHEL for Realtime and for NFV), specifically when using the SVM virtualization extensions, as well as various Red Hat CodeReady Linux Builder and other products.

This information is based on the provided text and aims to give a full picture of CVE-2023-5090.