=== Content from plugins.trac.wordpress.org_8526e632_20250114_180936.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3018102)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3018101 "Changeset 3018101")
* [Next Changeset](/changeset/3018103 "Changeset 3018103") →

---

# Changeset 3018102

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
01/06/2024 02:46:54 PM
([12 months](/timeline?from=2024-01-06T14%3A46%3A54Z&precision=second "See timeline at 01/06/2024 02:46:54 PM") ago)

Author:
avi.megladon
Message:

Bug fixes and improvements

Location:
[wp-register-profile-with-shortcode](/browser/wp-register-profile-with-shortcode?rev=3018102)
Files:

77 added
10 edited

* [tags/3.6.0](/browser/wp-register-profile-with-shortcode/tags/3.6.0?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha/captcha.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha/captcha.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha/captcha\_admin.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha/captcha_admin.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha/fonts](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha/fonts?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha/fonts/AntykwaBold.ttf](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha/fonts/AntykwaBold.ttf?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha/fonts/Candice.ttf](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha/fonts/Candice.ttf?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha/fonts/Ding-DongDaddyO.ttf](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha/fonts/Ding-DongDaddyO.ttf?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha/fonts/Duality.ttf](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha/fonts/Duality.ttf?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha/fonts/Heineken.ttf](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha/fonts/Heineken.ttf?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha/fonts/Jura.ttf](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha/fonts/Jura.ttf?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha/fonts/StayPuft.ttf](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha/fonts/StayPuft.ttf?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha/fonts/TimesNewRomanBold.ttf](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha/fonts/TimesNewRomanBold.ttf?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/captcha/fonts/VeraSansBold.ttf](/browser/wp-register-profile-with-shortcode/tags/3.6.0/captcha/fonts/VeraSansBold.ttf?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/config](/browser/wp-register-profile-with-shortcode/tags/3.6.0/config?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/config/config-default-fields.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/config/config-default-fields.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/config/config-emails.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/config/config-emails.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/css](/browser/wp-register-profile-with-shortcode/tags/3.6.0/css?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/css/style\_register\_widget.css](/browser/wp-register-profile-with-shortcode/tags/3.6.0/css/style_register_widget.css?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/css/style\_register\_widget\_admin.css](/browser/wp-register-profile-with-shortcode/tags/3.6.0/css/style_register_widget_admin.css?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/functions.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/functions.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/images](/browser/wp-register-profile-with-shortcode/tags/3.6.0/images?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/images/paypal.png](/browser/wp-register-profile-with-shortcode/tags/3.6.0/images/paypal.png?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/images/rss.png](/browser/wp-register-profile-with-shortcode/tags/3.6.0/images/rss.png?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/includes](/browser/wp-register-profile-with-shortcode/tags/3.6.0/includes?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/includes/class-admin-security.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/includes/class-admin-security.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/includes/class-edit-profile.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/includes/class-edit-profile.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/includes/class-form.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/includes/class-form.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/includes/class-password-update.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/includes/class-password-update.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/includes/class-register-form.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/includes/class-register-form.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/includes/class-register-process.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/includes/class-register-process.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/includes/class-scripts.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/includes/class-scripts.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/includes/class-settings.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/includes/class-settings.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/includes/class\_register\_form.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/includes/class_register_form.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/index.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/index.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/js](/browser/wp-register-profile-with-shortcode/tags/3.6.0/js?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/js/additional-methods.js](/browser/wp-register-profile-with-shortcode/tags/3.6.0/js/additional-methods.js?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/js/ap-tabs.js](/browser/wp-register-profile-with-shortcode/tags/3.6.0/js/ap-tabs.js?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/js/ap.cookie.js](/browser/wp-register-profile-with-shortcode/tags/3.6.0/js/ap.cookie.js?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/js/jquery.validate.min.js](/browser/wp-register-profile-with-shortcode/tags/3.6.0/js/jquery.validate.min.js?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-da\_DK.mo](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-da_DK.mo?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-da\_DK.po](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-da_DK.po?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-da\_FR.mo](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-da_FR.mo?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-da\_FR.po](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-da_FR.po?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-de\_DE.mo](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-de_DE.mo?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-de\_DE.po](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-de_DE.po?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-es\_ES.mo](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-es_ES.mo?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-es\_ES.po](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-es_ES.po?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-fi\_FI.mo](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-fi_FI.mo?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-fi\_FI.po](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-fi_FI.po?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-it\_IT.mo](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-it_IT.mo?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-it\_IT.po](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-it_IT.po?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-nl\_NL.mo](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-nl_NL.mo?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-nl\_NL.po](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-nl_NL.po?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-pt\_PT.mo](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-pt_PT.mo?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-pt\_PT.po](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-pt_PT.po?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-sr\_RS.mo](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-sr_RS.mo?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode-sr\_RS.po](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode-sr_RS.po?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/languages/wp-register-profile-with-shortcode.pot](/browser/wp-register-profile-with-shortcode/tags/3.6.0/languages/wp-register-profile-with-shortcode.pot?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/readme.txt](/browser/wp-register-profile-with-shortcode/tags/3.6.0/readme.txt?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/register-widget-shortcode.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/register-widget-shortcode.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/register-widget.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/register-widget.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/register.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/register.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view/admin](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view/admin?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view/admin/captcha.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view/admin/captcha.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view/admin/donate.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view/admin/donate.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view/admin/help-support.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view/admin/help-support.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view/admin/login-add.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view/admin/login-add.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view/admin/register-add.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view/admin/register-add.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view/admin/settings.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view/admin/settings.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view/frontend](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view/frontend?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view/frontend/captcha.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view/frontend/captcha.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view/frontend/profile-edit.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view/frontend/profile-edit.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view/frontend/register.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view/frontend/register.php?rev=3018102 "Show entry in browser")
  (added)
* [tags/3.6.0/view/frontend/update-password.php](/browser/wp-register-profile-with-shortcode/tags/3.6.0/view/frontend/update-password.php?rev=3018102 "Show entry in browser")
  (added)
* [trunk/includes/class-edit-profile.php](/browser/wp-register-profile-with-shortcode/trunk/includes/class-edit-profile.php?rev=3018102 "Show entry in browser")
  (modified)
  ([2 diffs](#file77 "Show differences"))
* [trunk/includes/class-password-update.php](/browser/wp-register-profile-with-shortcode/trunk/includes/class-password-update.php?rev=3018102 "Show entry in browser")
  (modified)
  ([2 diffs](#file78 "Show differences"))
* [trunk/includes/class-register-process.php](/browser/wp-register-profile-with-shortcode/trunk/includes/class-register-process.php?rev=3018102 "Show entry in browser")
  (modified)
  ([1 diff](#file79 "Show differences"))
* [trunk/includes/class-settings.php](/browser/wp-register-profile-with-shortcode/trunk/includes/class-settings.php?rev=3018102 "Show entry in browser")
  (modified)
  ([1 diff](#file80 "Show differences"))
* [trunk/readme.txt](/browser/wp-register-profile-with-shortcode/trunk/readme.txt?rev=3018102 "Show entry in browser")
  (modified)
  ([2 diffs](#file81 "Show differences"))
* [trunk/register.php](/browser/wp-register-profile-with-shortcode/trunk/register.php?rev=3018102 "Show entry in browser")
  (modified)
  ([1 diff](#file82 "Show differences"))
* [trunk/view/admin/settings.php](/browser/wp-register-profile-with-shortcode/trunk/view/admin/settings.php?rev=3018102 "Show entry in browser")
  (modified)
  ([1 diff](#file83 "Show differences"))
* [trunk/view/frontend/profile-edit.php](/browser/wp-register-profile-with-shortcode/trunk/view/frontend/profile-edit.php?rev=3018102 "Show entry in browser")
  (modified)
  ([1 diff](#file84 "Show differences"))
* [trunk/view/frontend/register.php](/browser/wp-register-profile-with-shortcode/trunk/view/frontend/register.php?rev=3018102 "Show entry in browser")
  (modified)
  ([1 diff](#file85 "Show differences"))
* [trunk/view/frontend/update-password.php](/browser/wp-register-profile-with-shortcode/trunk/view/frontend/update-password.php?rev=3018102 "Show entry in browser")
  (modified)
  ([1 diff](#file86 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wp-register-profile-with-shortcode/trunk/includes/class-edit-profile.php](/changeset/3018102/wp-register-profile-with-shortcode/trunk/includes/class-edit-profile.php "Show the changeset 3018102 restricted to wp-register-profile-with-shortcode/trunk/includes/class-edit-profile.php")

  | [r2393730](/browser/wp-register-profile-with-shortcode/trunk/includes/class-edit-profile.php?rev=2393730#L1 "Show revision 2393730 of this file in browser") | [r3018102](/browser/wp-register-profile-with-shortcode/trunk/includes/class-edit-profile.php?rev=3018102#L1 "Show revision 3018102 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 | 2 |  |
  | 3 |  | class Register\_Profile\_Edit{ |
  |  | 3 | class Register\_Profile\_Edit |
  |  | 4 | { |
  | 4 | 5 |  |
  | 5 |  | public function \_\_construct() { |
  | 6 |  | add\_action( 'init', array($this, 'edit\_profile\_validate' ) ); |
  | 7 |  | } |
  | 8 |  |  |
  | 9 |  | public function is\_field\_enabled($value){ |
  | 10 |  | $data = get\_option( $value ); |
  | 11 |  | if($data == 'Yes'){ |
  | 12 |  | return true; |
  | 13 |  | } else { |
  | 14 |  | return false; |
  | 15 |  | } |
  | 16 |  | } |
  | 17 |  |  |
  | 18 |  | public function is\_field\_required($value){ |
  | 19 |  | $data = get\_option( $value ); |
  | 20 |  | if($data == 'Yes'){ |
  | 21 |  | return 'required="required"'; |
  | 22 |  | } else { |
  | 23 |  | return ''; |
  | 24 |  | } |
  | 25 |  | } |
  | 26 |  |  |
  | 27 |  |  |
  | 28 |  | public function edit\_profile\_validate(){ |
  | 29 |  |  |
  | 30 |  | if(isset($\_POST['option']) and sanitize\_text\_field($\_POST['option']) == "wprp\_user\_edit\_profile"){ |
  | 31 |  | start\_session\_if\_not\_started(); |
  | 32 |  | global $post; |
  | 33 |  | $error = false; |
  | 34 |  |  |
  | 35 |  | if(!is\_user\_logged\_in()){ |
  | 36 |  | $msg = \_\_('Login to update profile!','wp-register-profile-with-shortcode'); |
  | 37 |  | $error = true; |
  | 38 |  | } |
  | 39 |  |  |
  | 40 |  | /\*if( email\_exists( sanitize\_text\_field($\_POST['user\_email']) )) { |
  | 41 |  | $msg = \_\_('Email already exists. Please use a different one!','wp-register-profile-with-shortcode'); |
  | 42 |  | $error = true; |
  | 43 |  | }\*/ |
  | 44 |  |  |
  | 45 |  | $userdata = array(); |
  | 46 |  |  |
  | 47 |  | if( $this->is\_field\_enabled('firstname\_in\_profile') ){ |
  | 48 |  | if( $this->is\_field\_enabled('is\_firstname\_required') and sanitize\_text\_field($\_POST['first\_name']) == '' ){ |
  | 49 |  | $msg .= \_\_('Please enter first name','wp-register-profile-with-shortcode'); |
  | 50 |  | $msg .= '</br>'; |
  | 51 |  | $error = true; |
  | 52 |  | } else { |
  | 53 |  | $userdata['first\_name'] = sanitize\_text\_field($\_POST['first\_name']); |
  | 54 |  | } |
  | 55 |  | } |
  | 56 |  |  |
  | 57 |  | if($this->is\_field\_enabled('lastname\_in\_profile')){ |
  | 58 |  | if( $this->is\_field\_enabled('is\_lastname\_required') and sanitize\_text\_field($\_POST['last\_name']) == '' ){ |
  | 59 |  | $msg .= \_\_('Please enter last name','wp-register-profile-with-shortcode'); |
  | 60 |  | $msg .= '</br>'; |
  | 61 |  | $error = true; |
  | 62 |  | } else { |
  | 63 |  | $userdata['last\_name'] = sanitize\_text\_field($\_POST['last\_name']); |
  | 64 |  | } |
  | 65 |  | } |
  | 66 |  |  |
  | 67 |  | if($this->is\_field\_enabled('displayname\_in\_profile')){ |
  | 68 |  | if( $this->is\_field\_enabled('is\_displayname\_required') and sanitize\_text\_field($\_POST['display\_name']) == '' ){ |
  | 69 |  | $msg .= \_\_('Please enter display name','wp-register-profile-with-shortcode'); |
  | 70 |  | $msg .= '</br>'; |
  | 71 |  | $error = true; |
  | 72 |  | } else { |
  | 73 |  | $userdata['display\_name'] = sanitize\_text\_field($\_POST['display\_name']); |
  | 74 |  | } |
  | 75 |  | } |
  | 76 |  |  |
  | 77 |  | if($this->is\_field\_enabled('userdescription\_in\_profile')){ |
  | 78 |  | if( $this->is\_field\_enabled('is\_userdescription\_required') and sanitize\_text\_field($\_POST['description']) == '' ){ |
  | 79 |  | $msg .= \_\_('Please enter description','wp-register-profile-with-shortcode'); |
  | 80 |  | $msg .= '</br>'; |
  | 81 |  | $error = true; |
  | 82 |  | } else { |
  | 83 |  | $userdata['description'] = sanitize\_text\_field($\_POST['description']); |
  | 84 |  | } |
  | 85 |  | } |
  | 86 |  |  |
  | 87 |  | if($this->is\_field\_enabled('userurl\_in\_profile')){ |
  | 88 |  | if( $this->is\_field\_enabled('is\_userurl\_required') and sanitize\_text\_field($\_POST['user\_url']) == '' ){ |
  | 89 |  | $msg .= \_\_('Please enter description','wp-register-profile-with-shortcode'); |
  | 90 |  | $msg .= '</br>'; |
  | 91 |  | $error = true; |
  | 92 |  | } else { |
  | 93 |  | $userdata['user\_url'] = sanitize\_text\_field($\_POST['user\_url']); |
  | 94 |  | } |
  | 95 |  | } |
  | 96 |  |  |
  | 97 |  | if(!$error){ |
  | 98 |  | $user\_id = get\_current\_user\_id(); |
  | 99 |  | $userdata['ID'] = $user\_id; |
  | 100 |  | $userdata['user\_email'] = sanitize\_text\_field($\_POST['user\_email']); |
  | 101 |  |  |
  | 102 |  | // update user profile in db // |
  | 103 |  | $user\_id = wp\_update\_user( $userdata ); |
  | 104 |  | // update user profile in db // |
  | 105 |  |  |
  | 106 |  | // check for any errors // |
  | 107 |  | if ( is\_wp\_error( $user\_id ) ) { |
  | 108 |  | $msg = $user\_id->get\_error\_message(); |
  | 109 |  | $\_SESSION['reg\_error\_msg'] = $msg; |
  | 110 |  | $\_SESSION['reg\_msg\_class'] = 'reg\_error'; |
  | 111 |  | if(!empty($\_POST['redirect'])){ |
  | 112 |  | $redirect =  sanitize\_text\_field($\_POST['redirect']); |
  | 113 |  | wp\_redirect($redirect); |
  | 114 |  | exit; |
  | 115 |  | } else { |
  | 116 |  | wp\_redirect(get\_permalink()); |
  | 117 |  | exit; |
  | 118 |  | } |
  | 119 |  | } |
  | 120 |  | // check for any errors // |
  | 121 |  |  |
  | 122 |  | $\_SESSION['reg\_error\_msg'] = \_\_('Profile data updated successfully.','wp-register-profile-with-shortcode'); |
  | 123 |  | $\_SESSION['reg\_msg\_class'] = 'reg\_success'; |
  | 124 |  |  |
  | 125 |  | } else { |
  | 126 |  | $\_SESSION['reg\_error\_msg'] = $msg; |
  | 127 |  | $\_SESSION['reg\_msg\_class'] = 'reg\_error'; |
  | 128 |  | } |
  | 129 |  |  |
  | 130 |  | if(!empty($\_POST['redirect'])){ |
  | 131 |  | $redirect =  sanitize\_text\_field($\_POST['redirect']); |
  | 132 |  | wp\_redirect($redirect); |
  | 133 |  | exit; |
  | 134 |  | } |
  | 135 |  | } |
  | 136 |  |  |
  | 137 |  | } |
  | 138 |  |  |
  | 139 |  | public function profile\_edit(){ |
  | 140 |  | global $post; |
  | 141 |  | if(is\_user\_logged\_in()){ |
  | 142 |  | $current\_user = wp\_get\_current\_user(); |
  | 143 |  | $user\_id = get\_current\_user\_id(); |
  | 144 |  | echo '<div id="reg\_forms" class="reg\_forms">'; |
  | 145 |  | $this->load\_script(); |
  | 146 |  | do\_action('wprp\_before\_profile\_form\_start'); |
  | 147 |  | $this->error\_message(); |
  | 148 |  | include( WPRPWS\_DIR\_PATH . '/view/frontend/profile-edit.php'); |
  | 149 |  | do\_action('wprp\_after\_profile\_form\_end'); |
  | 150 |  | echo '</div>'; |
  | 151 |  | } |
  | 152 |  | } |
  | 153 |  |  |
  | 154 |  | public function load\_script(){?> |
  |  | 6 | public function \_\_construct() |
  |  | 7 | { |
  |  | 8 | add\_action('init', array($this, 'edit\_profile\_validate')); |
  |  | 9 | } |
  |  | 10 |  |
  |  | 11 | public function is\_field\_enabled($value) |
  |  | 12 | { |
  |  | 13 | $data = get\_option($value); |
  |  | 14 | if ($data == 'Yes') { |
  |  | 15 | return true; |
  |  | 16 | } else { |
  |  | 17 | return false; |
  |  | 18 | } |
  |  | 19 | } |
  |  | 20 |  |
  |  | 21 | public function is\_field\_required($value) |
  |  | 22 | { |
  |  | 23 | $data = get\_option($value); |
  |  | 24 | if ($data == 'Yes') { |
  |  | 25 | return 'required="required"'; |
  |  | 26 | } else { |
  |  | 27 | return ''; |
  |  | 28 | } |
  |  | 29 | } |
  |  | 30 |  |
  |  | 31 | public function edit\_profile\_validate() |
  |  | 32 | { |
  |  | 33 |  |
  |  | 34 | if (isset($\_POST['option']) and sanitize\_text\_field($\_POST['option']) == "wprp\_user\_edit\_profile") { |
  |  | 35 |  |
  |  | 36 | if (!wp\_verify\_nonce($\_POST['wprp\_5q5rt78'], 'wprp\_action')) { |
  |  | 37 | wp\_die('Error'); |
  |  | 38 | } |
  |  | 39 |  |
  |  | 40 | start\_session\_if\_not\_started(); |
  |  | 41 | global $post; |
  |  | 42 | $error = false; |
  |  | 43 |  |
  |  | 44 | if (!is\_user\_logged\_in()) { |
  |  | 45 | $msg = \_\_('Login to update profile!', 'wp-register-profile-with-shortcode'); |
  |  | 46 | $error = true; |
  |  | 47 | } |
  |  | 48 |  |
  |  | 49 | /\*if( email\_exists( sanitize\_text\_field($\_POST['user\_email']) )) { |
  |  | 50 | $msg = \_\_('Email already exists. Please use a different one!','wp-register-profile-with-shortcode'); |
  |  | 51 | $error = true; |
  |  | 52 | }\*/ |
  |  | 53 |  |
  |  | 54 | $userdata = array(); |
  |  | 55 |  |
  |  | 56 | if ($this->is\_field\_enabled('firstname\_in\_profile')) { |
  |  | 57 | if ($this->is\_field\_enabled('is\_firstname\_required') and sanitize\_text\_field($\_POST['first\_name']) == '') { |
  |  | 58 | $msg .= \_\_('Please enter first name', 'wp-register-profile-with-shortcode'); |
  |  | 59 | $msg .= '</br>'; |
  |  | 60 | $error = true; |
  |  | 61 | } else { |
  |  | 62 | $userdata['first\_name'] = sanitize\_text\_field($\_POST['first\_name']); |
  |  | 63 | } |
  |  | 64 | } |
  |  | 65 |  |
  |  | 66 | if ($this->is\_field\_enabled('lastname\_in\_profile')) { |
  |  | 67 | if ($this->is\_field\_enabled('is\_lastname\_required') and sanitize\_text\_field($\_POST['last\_name']) == '') { |
  |  | 68 | $msg .= \_\_('Please enter last name', 'wp-register-profile-with-shortcode'); |
  |  | 69 | $msg .= '</br>'; |
  |  | 70 | $error = true; |
  |  | 71 | } else { |
  |  | 72 | $userdata['last\_name'] = sanitize\_text\_field($\_POST['last\_name']); |
  |  | 73 | } |
  |  | 74 | } |
  |  | 75 |  |
  |  | 76 | if ($this->is\_field\_enabled('displayname\_in\_profile')) { |
  |  | 77 | if ($this->is\_field\_enabled('is\_displayname\_required') and sanitize\_text\_field($\_POST['display\_name']) == '') { |
  |  | 78 | $msg .= \_\_('Please enter display name', 'wp-register-profile-with-shortcode'); |
  |  | 79 | $msg .= '</br>'; |
  |  | 80 | $error = true; |
  |  | 81 | } else { |
  |  | 82 | $userdata['display\_name'] = sanitize\_text\_field($\_POST['display\_name']); |
  |  | 83 | } |
  |  | 84 | } |
  |  | 85 |  |
  |  | 86 | if ($this->is\_field\_enabled('userdescription\_in\_profile')) { |
  |  | 87 | if ($this->is\_field\_enabled('is\_userdescription\_required') and sanitize\_text\_field($\_POST['description']) == '') { |
  |  | 88 | $msg .= \_\_('Please enter description', 'wp-register-profile-with-shortcode'); |
  |  | 89 | $msg .= '</br>'; |
  |  | 90 | $error = true; |
  |  | 91 | } else { |
  |  | 92 | $userdata['description'] = sanitize\_text\_field($\_POST['description']); |
  |  | 93 | } |
  |  | 94 | } |
  |  | 95 |  |
  |  | 96 | if ($this->is\_field\_enabled('userurl\_in\_profile')) { |
  |  | 97 | if ($this->is\_field\_enabled('is\_userurl\_required') and sanitize\_text\_field($\_POST['user\_url']) == '') { |
  |  | 98 | $msg .= \_\_('Please enter description', 'wp-register-profile-with-shortcode'); |
  |  | 99 | $msg .= '</br>'; |
  |  | 100 | $error = true; |
  |  | 101 | } else { |
  |  | 102 | $userdata['user\_url'] = sanitize\_text\_field($\_POST['user\_url']); |
  |  | 103 | } |
  |  | 104 | } |
  |  | 105 |  |
  |  | 106 | if (!$error) { |
  |  | 107 | $user\_id = get\_current\_user\_id(); |
  |  | 108 | $userdata['ID'] = $user\_id; |
  |  | 109 | $userdata['user\_email'] = sanitize\_text\_field($\_POST['user\_email']); |
  |  | 110 |  |
  |  | 111 | // update user profile in db // |
  |  | 112 | $user\_id = wp\_update\_user($userdata); |
  |  | 113 | // update user profile in db // |
  |  | 114 |  |
  |  | 115 | // check for any errors // |
  |  | 116 | if (is\_wp\_error($user\_id)) { |
  |  | 117 | $msg = $user\_id->get\_error\_message(); |
  |  | 118 | $\_SESSION['reg\_error\_msg'] = $msg; |
  |  | 119 | $\_SESSION['reg\_msg\_class'] = 'reg\_error'; |
  |  | 120 | if (!empty($\_POST['redirect'])) { |
  |  | 121 | $redirect = sanitize\_text\_field($\_POST['redirect']); |
  |  | 122 | wp\_redirect($redirect); |
  |  | 123 | exit; |
  |  | 124 | } else { |
  |  | 125 | wp\_redirect(get\_permalink()); |
  |  | 126 | exit; |
  |  | 127 | } |
  |  | 128 | } |
  |  | 129 | // check for any errors // |
  |  | 130 |  |
  |  | 131 | $\_SESSION['reg\_error\_msg'] = \_\_('Profile data updated successfully.', 'wp-register-profile-with-shortcode'); |
  |  | 132 | $\_SESSION['reg\_msg\_class'] = 'reg\_success'; |
  |  | 133 |  |
  |  | 134 | } else { |
  |  | 135 | $\_SESSION['reg\_error\_msg'] = $msg; |
  |  | 136 | $\_SESSION['reg\_msg\_class'] = 'reg\_error'; |
  |  | 137 | } |
  |  | 138 |  |
  |  | 139 | if (!empty($\_POST['redirect'])) { |
  |  | 140 | $redirect = sanitize\_text\_field($\_POST['redirect']); |
  |  | 141 | wp\_redirect($redirect); |
  |  | 142 | exit; |
  |  | 143 | } |
  |  | 144 | } |
  |  | 145 |  |
  |  | 146 | } |
  |  | 147 |  |
  |  | 148 | public function profile\_edit() |
  |  | 149 | { |
  |  | 150 | global $post; |
  |  | 151 | if (is\_user\_logged\_in()) { |
  |  | 152 | $current\_user = wp\_get\_current\_user(); |
  |  | 153 | $user\_id = get\_current\_user\_id(); |
  |  | 154 | echo '<div id="reg\_forms" class="reg\_forms">'; |
  |  | 155 | $this->load\_script(); |
  |  | 156 | do\_action('wprp\_before\_profile\_form\_start'); |
  |  | 157 | $this->error\_message(); |
  |  | 158 | include WPRPWS\_DIR\_PATH . '/view/frontend/profile-edit.php'; |
  |  | 159 | do\_action('wprp\_after\_profile\_form\_end'); |
  |  | 160 | echo '</div>'; |
  |  | 161 | } |
  |  | 162 | } |
  |  | 163 |  |
  |  | 164 | public function load\_script() |
  |  | 165 | {?> |
  | 155 | 166 | <script type="text/javascript"> |
  | 156 | 167 | jQuery(document).ready(function () { |
  | […](/browser/wp-register-profile-with-shortcode/trunk/includes/class-edit-profile.php?rev=2393730#L159) | […](/browser/wp-register-profile-with-shortcode/trunk/includes/class-edit-profile.php?rev=3018102#L170) |  |
  | 159 | 170 | </script> |
  | 160 | 171 | <?php } |
  | 161 |  |  |
  | 162 |  | public function error\_message(){ |
  | 163 |  | start\_session\_if\_not\_started(); |
  | 164 |  | if(isset($\_SESSION['reg\_error\_msg']) and $\_SESSION['reg\_error\_msg']){ |
  | 165 |  | echo '<div class="'.$\_SESSION['reg\_msg\_class'].'">'.$\_SESSION['reg\_error\_msg'].'</div>'; |
  | 166 |  | unset($\_SESSION['reg\_error\_msg']); |
  | 167 |  | unset($\_SESSION['reg\_msg\_class']); |
  | 168 |  | } |
  | 169 |  | } |
  | 170 |  |  |
  |  | 172 |  |
  |  | 173 | public function error\_message() |
  |  | 174 | { |
  |  | 175 | start\_session\_if\_not\_started(); |
  |  | 176 | if (isset($\_SESSION['reg\_error\_msg']) and $\_SESSION['reg\_error\_msg']) { |
  |  | 177 | echo '<div class="' . $\_SESSION['reg\_msg\_class'] . '">' . $\_SESSION['reg\_error\_msg'] . '</div>'; |
  |  | 178 | unset($\_SESSION['reg\_error\_msg']); |
  |  | 179 | unset($\_SESSION['reg\_msg\_class']); |
  |  | 180 | } |
  |  | 181 | } |
  |  | 182 |  |
  | 171 | 183 | } |
* ## [wp-register-profile-with-shortcode/trunk/includes/class-password-update.php](/changeset/3018102/wp-register-profile-with-shortcode/trunk/includes/class-password-update.php "Show the changeset 3018102 restricted to wp-register-profile-with-shortcode/trunk/includes/class-password-update.php")

  | [r2379514](/browser/wp-register-profile-with-shortcode/trunk/includes/class-password-update.php?rev=2379514#L1 "Show revision 2379514 of this file in browser") | [r3018102](/browser/wp-register-profile-with-shortcode/trunk/includes/class-password-update.php?rev=3018102#L1 "Show revision 3018102 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 | 2 |  |
  | 3 |  | class Register\_Update\_Password{ |
  |  | 3 | class Register\_Update\_Password |
  |  | 4 | { |
  | 4 | 5 |  |
  | 5 |  | public function \_\_construct() { |
  | 6 |  | add\_action( 'init', array($this, 'update\_password\_validate' ) ); |
  | 7 |  | } |
  | 8 |  |  |
  |  | 6 | public function \_\_construct() |
  |  | 7 | { |
  |  | 8 | add\_action('init', array($this, 'update\_password\_validate')); |
  |  | 9 | } |
  | 9 | 10 |  |
  | 10 |  | public function update\_password\_validate(){ |
  | 11 |  | if(isset($\_POST['option']) and sanitize\_text\_field($\_POST['option']) == "rpws\_user\_update\_password"){ |
  | 12 |  | start\_session\_if\_not\_started(); |
  | 13 |  | global $post; |
  | 14 |  | $error = false; |
  | 15 |  |  |
  | 16 |  | if(!is\_user\_logged\_in()){ |
  | 17 |  | $msg = \_\_('Login to update profile!','wp-register-profile-with-shortcode'); |
  | 18 |  | $error = true; |
  | 19 |  | } |
  | 20 |  |  |
  | 21 |  | if($\_POST['user\_new\_password'] == ''){ |
  | 22 |  | $msg = \_\_('Password can\'t be empty.','wp-register-profile-with-shortcode'); |
  | 23 |  | $error = true; |
  | 24 |  | } |
  | 25 |  |  |
  | 26 |  | if(isset($\_POST['user\_new\_password']) and ( $\_POST['user\_new\_password'] != $\_POST['user\_retype\_password'])){ |
  | 27 |  | $msg = \_\_('Your new password don\'t match with retype password!','wp-register-profile-with-shortcode'); |
  | 28 |  | $error = true; |
  | 29 |  | } |
  | 30 |  |  |
  | 31 |  | if(!$error){ |
  | 32 |  | $user\_id = get\_current\_user\_id(); |
  | 33 |  | wp\_set\_password( $\_POST['user\_new\_password'], $user\_id ); |
  | 34 |  |  |
  | 35 |  | $\_SESSION['reg\_error\_msg'] = \_\_('Your password updated successfully. Please login again.','wp-register-profile-with-shortcode'); |
  | 36 |  | $\_SESSION['reg\_msg\_class'] = 'reg\_success'; |
  | 37 |  |  |
  | 38 |  | } else { |
  | 39 |  | $\_SESSION['reg\_error\_msg'] = $msg; |
  | 40 |  | $\_SESSION['reg\_msg\_class'] = 'reg\_error'; |
  | 41 |  | } |
  | 42 |  |  |
  | 43 |  | if(!empty($\_POST['redirect'])){ |
  | 44 |  | $redirect =  sanitize\_text\_field($\_POST['redirect']); |
  | 45 |  | wp\_redirect($redirect); |
  | 46 |  | exit; |
  | 47 |  | } |
  | 48 |  | } |
  | 49 |  | } |
  | 50 |  |  |
  | 51 |  |  |
  | 52 |  | public function load\_script(){?> |
  |  | 11 | public function update\_password\_validate() |
  |  | 12 | { |
  |  | 13 | if (isset($\_POST['option']) and sanitize\_text\_field($\_POST['option']) == "rpws\_user\_update\_password") { |
  |  | 14 |  |
  |  | 15 | if (!wp\_verify\_nonce($\_POST['wprp\_5q5rt78'], 'wprp\_action')) { |
  |  | 16 | wp\_die('Error'); |
  |  | 17 | } |
  |  | 18 |  |
  |  | 19 | start\_session\_if\_not\_started(); |
  |  | 20 | global $post; |
  |  | 21 | $error = false; |
  |  | 22 |  |
  |  | 23 | if (!is\_user\_logged\_in()) { |
  |  | 24 | $msg = \_\_('Login to update profile!', 'wp-register-profile-with-shortcode'); |
  |  | 25 | $error = true; |
  |  | 26 | } |
  |  | 27 |  |
  |  | 28 | if ($\_POST['user\_new\_password'] == '') { |
  |  | 29 | $msg = \_\_('Password can\'t be empty.', 'wp-register-profile-with-shortcode'); |
  |  | 30 | $error = true; |
  |  | 31 | } |
  |  | 32 |  |
  |  | 33 | if (isset($\_POST['user\_new\_password']) and ($\_POST['user\_new\_password'] != $\_POST['user\_retype\_password'])) { |
  |  | 34 | $msg = \_\_('Your new password don\'t match with retype password!', 'wp-register-profile-with-shortcode'); |
  |  | 35 | $error = true; |
  |  | 36 | } |
  |  | 37 |  |
  |  | 38 | if (!$error) { |
  |  | 39 | $user\_id = get\_current\_user\_id(); |
  |  | 40 | wp\_set\_password($\_POST['user\_new\_password'], $user\_id); |
  |  | 41 |  |
  |  | 42 | $\_SESSION['reg\_error\_msg'] = \_\_('Your password updated successfully. Please login again.', 'wp-register-profile-with-shortcode'); |
  |  | 43 | $\_SESSION['reg\_msg\_class'] = 'reg\_success'; |
  |  | 44 |  |
  |  | 45 | } else { |
  |  | 46 | $\_SESSION['reg\_error\_msg'] = $msg; |
  |  | 47 | $\_SESSION['reg\_msg\_class'] = 'reg\_error'; |
  |  | 48 | } |
  |  | 49 |  |
  |  | 50 | if (!empty($\_POST['redirect'])) { |
  |  | 51 | $redirect = sanitize\_text\_field($\_POST['redirect']); |
  |  | 52 | wp\_redirect($redirect); |
  |  | 53 | exit; |
  |  | 54 | } |
  |  | 55 | } |
  |  | 56 | } |
  |  | 57 |  |
  |  | 58 | public function load\_script() |
  |  | 59 | {?> |
  | 53 | 60 | <script type="text/javascript"> |
  | 54 | 61 | jQuery(document).ready(function () { |
  | […](/browser/wp-register-profile-with-shortcode/trunk/includes/class-password-update.php?rev=2379514#L57) | […](/browser/wp-register-profile-with-shortcode/trunk/includes/class-password-update.php?rev=3018102#L64) |  |
  | 57 | 64 | </script> |
  | 58 | 65 | <?php } |
  | 59 |  |  |
  | 60 |  | public function update\_password\_form(){ |
  | 61 |  | global $post; |
  | 62 |  | if(is\_user\_logged\_in()){ |
  | 63 |  | echo '<div id="reg\_forms" class="reg\_forms">'; |
  | 64 |  | $this->load\_script(); |
  | 65 |  | do\_action('wprp\_before\_update\_pass\_form\_start'); |
  | 66 |  | $this->error\_message(); |
  | 67 |  | include( WPRPWS\_DIR\_PATH . '/view/frontend/update-password.php'); |
  | 68 |  | do\_action('wprp\_after\_update\_pass\_form\_end'); |
  | 69 |  | echo '</div>'; |
  | 70 |  | } |
  | 71 |  | } |
  | 72 |  |  |
  | 73 |  | public function error\_message(){ |
  | 74 |  | start\_session\_if\_not\_started(); |
  | 75 |  | if(isset($\_SESSION['reg\_error\_msg']) and $\_SESSION['reg\_error\_msg']){ |
  | 76 |  | echo '<div class="'.$\_SESSION['reg\_msg\_class'].'">'.$\_SESSION['reg\_error\_msg'].'</div>'; |
  | 77 |  | unset($\_SESSION['reg\_error\_msg']); |
  | 78 |  | unset($\_SESSION['reg\_msg\_class']); |
  | 79 |  | } |
  | 80 |  | } |
  | 81 |  |  |
  |  | 66 |  |
  |  | 67 | public function update\_password\_form() |
  |  | 68 | { |
  |  | 69 | global $post; |
  |  | 70 | if (is\_user\_logged\_in()) { |
  |  | 71 | echo '<div id="reg\_forms" class="reg\_forms">'; |
  |  | 72 | $this->load\_script(); |
  |  | 73 | do\_action('wprp\_before\_update\_pass\_form\_start'); |
  |  | 74 | $this->error\_message(); |
  |  | 75 | include WPRPWS\_DIR\_PATH . '/view/frontend/update-password.php'; |
  |  | 76 | do\_action('wprp\_after\_update\_pass\_form\_end'); |
  |  | 77 | echo '</div>'; |
  |  | 78 | } |
  |  | 79 | } |
  |  | 80 |  |
  |  | 81 | public function error\_message() |
  |  | 82 | { |
  |  | 83 | start\_session\_if\_not\_started(); |
  |  | 84 | if (isset($\_SESSION['reg\_error\_msg']) and $\_SESSION['reg\_error\_msg']) { |
  |  | 85 | echo '<div class="' . $\_SESSION['reg\_msg\_class'] . '">' . $\_SESSION['reg\_error\_msg'] . '</div>'; |
  |  | 86 | unset($\_SESSION['reg\_error\_msg']); |
  |  | 87 | unset($\_SESSION['reg\_msg\_class']); |
  |  | 88 | } |
  |  | 89 | } |
  |  | 90 |  |
  | 82 | 91 | } |
* ## [wp-register-profile-with-shortcode/trunk/includes/class-register-process.php](/changeset/3018102/wp-register-profile-with-shortcode/trunk/includes/class-register-process.php "Show the changeset 3018102 restricted to wp-register-profile-with-shortcode/trunk/includes/class-register-process.php")

  | [r2393730](/browser/wp-register-profile-with-shortcode/trunk/includes/class-register-process.php?rev=2393730#L1 "Show revision 2393730 of this file in browser") | [r3018102](/browser/wp-register-profile-with-shortcode/trunk/includes/class-register-process.php?rev=3018102#L1 "Show revision 3018102 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 | 2 |  |
  | 3 |  | class Register\_Process { |
  | 4 |  |  |
  | 5 |  | public function \_\_construct() { |
  | 6 |  | add\_action( 'init', array($this, 'register\_validate' ) ); |
  | 7 |  | } |
  | 8 |  |  |
  | 9 |  | public function is\_field\_enabled($value){ |
  | 10 |  | $data = get\_option( $value ); |
  | 11 |  | if($data === 'Yes'){ |
  | 12 |  | return true; |
  | 13 |  | } else { |
  | 14 |  | return false; |
  | 15 |  | } |
  | 16 |  | } |
  | 17 |  |  |
  | 18 |  | public function is\_field\_required($value){ |
  | 19 |  | $data = get\_option( $value ); |
  | 20 |  | if($data === 'Yes'){ |
  | 21 |  | return 'required="required"'; |
  | 22 |  | } else { |
  | 23 |  | return ''; |
  | 24 |  | } |
  | 25 |  | } |
  | 26 |  |  |
  | 27 |  | public static function curPageURL() { |
  | 28 |  | $pageURL = 'http'; |
  | 29 |  | if (isset($\_SERVER["HTTPS"]) and $\_SERVER["HTTPS"] == "on") {$pageURL .= "s";} |
  | 30 |  | $pageURL .= "://"; |
  | 31 |  | if (isset($\_SERVER["SERVER\_PORT"]) and $\_SERVER["SERVER\_PORT"] != "80") { |
  | 32 |  | $pageURL .= $\_SERVER["SERVER\_NAME"].":".$\_SERVER["SERVER\_PORT"].$\_SERVER["REQUEST\_URI"]; |
  | 33 |  | } else { |
  | 34 |  | $pageURL .= $\_SERVER["SERVER\_NAME"].$\_SERVER["REQUEST\_URI"]; |
  | 35 |  | } |
  | 36 |  | return $pageURL; |
  | 37 |  | } |
  | 38 |  |  |
  | 39 |  | public function create\_user( $data = array() ){ |
  | 40 |  | start\_session\_if\_not\_started(); |
  | 41 |  | global $wprw\_mail\_to\_user\_subject,$wprw\_mail\_to\_admin\_subject; |
  | 42 |  | $wprw\_admin\_email = get\_option( 'wprw\_admin\_email' ); |
  | 43 |  | $wprw\_from\_email = get\_option( 'wprw\_from\_email' ); |
  | 44 |  | $wprw\_success\_msg = Register\_Settings::removeslashes(get\_option( 'wprw\_success\_msg' )); |
  | 45 |  |  |
  | 46 |  | if(empty($wprw\_success\_msg)){ |
  | 47 |  | $success\_msg = \_\_(Register\_Settings::$wprw\_success\_msg,'wp-register-profile-with-shortcode'); |
  | 48 |  | } else { |
  | 49 |  | $success\_msg = $wprw\_success\_msg; |
  | 50 |  | } |
  | 51 |  |  |
  | 52 |  | if($wprw\_from\_email == ''){ |
  | 53 |  | $wprw\_from\_email = 'no-reply@wordpress.com'; |
  | 54 |  | } |
  | 55 |  |  |
  | 56 |  | $userdata = $data['userdata']; |
  | 57 |  |  |
  | 58 |  | // insert new user in db // |
  | 59 |  | $user\_id = wp\_insert\_user( $userdata ); |
  | 60 |  | // insert new user in db // |
  | 61 |  |  |
  | 62 |  | // after insert action // |
  | 63 |  | do\_action( 'wprp\_after\_insert\_user', $user\_id ); |
  | 64 |  | // after insert action // |
  | 65 |  |  |
  | 66 |  | // subscription action // |
  | 67 |  | do\_action( 'cfws\_subscription', $user\_id, $data ); |
  | 68 |  | // subscription action // |
  | 69 |  |  |
  | 70 |  | $headers[] = 'From: <'.$wprw\_from\_email.'>'; |
  | 71 |  |  |
  | 72 |  | // send mail to user // |
  | 73 |  | $subject = Register\_Settings::removeslashes(get\_option('new\_user\_register\_mail\_subject')); |
  | 74 |  | $body = $this->new\_user\_data\_to\_user\_mail( $userdata ); |
  | 75 |  | $body = html\_entity\_decode($body); |
  | 76 |  |  |
  | 77 |  | $to\_array = array($userdata['user\_email']); |
  | 78 |  | add\_filter( 'wp\_mail\_content\_type', 'wprw\_set\_html\_content\_type' ); |
  | 79 |  | wp\_mail( $to\_array, $subject, $body, $headers ); |
  | 80 |  | remove\_filter( 'wp\_mail\_content\_type', 'wprw\_set\_html\_content\_type' ); |
  | 81 |  | // send mail to user // |
  | 82 |  |  |
  | 83 |  | // send mail to admin // |
  | 84 |  | if(!empty($wprw\_admin\_email)){ |
  | 85 |  | $subject1 = \_\_($wprw\_mail\_to\_admin\_subject,'wp-register-profile-with-shortcode'); |
  | 86 |  | $body1 = $this->new\_user\_data\_to\_admin\_mail( $userdata ); |
  | 87 |  | $body1 = html\_entity\_decode($body1); |
  | 88 |  | add\_filter( 'wp\_mail\_content\_type', 'wprw\_set\_html\_content\_type' ); |
  | 89 |  | wp\_mail( $wprw\_admin\_email, $subject1, $body1, $headers ); |
  | 90 |  | remove\_filter( 'wp\_mail\_content\_type', 'wprw\_set\_html\_content\_type' ); |
  | 91 |  | } |
  | 92 |  | // send mail to admin // |
  | 93 |  |  |
  | 94 |  | if( !$this->is\_field\_enabled('force\_login\_after\_registration') and $user\_id ){ |
  | 95 |  | $\_SESSION['reg\_error\_msg'] = $success\_msg; |
  | 96 |  | $\_SESSION['reg\_msg\_class'] = 'reg\_success'; |
  | 97 |  | } |
  | 98 |  |  |
  | 99 |  | unset($\_SESSION['wp\_register\_temp\_data']); |
  | 100 |  | return $user\_id; |
  | 101 |  | } |
  | 102 |  |  |
  | 103 |  | public function new\_user\_data\_to\_user\_mail( $userdata = array() ){ |
  | 104 |  | $wprw\_mail\_to\_user\_body = Register\_Settings::removeslashes(get\_option('new\_user\_register\_mail\_body')); |
  | 105 |  |  |
  | 106 |  | $wprw\_mail\_to\_user\_body = str\_replace(array("#site\_name#","#user\_name#","#user\_password#","#site\_url#"), array( get\_bloginfo('name'), $userdata['user\_login'], $userdata['user\_pass'], site\_url() ), $wprw\_mail\_to\_user\_body); |
  | 107 |  | return $wprw\_mail\_to\_user\_body; |
  | 108 |  | } |
  | 109 |  |  |
  | 110 |  | public function new\_user\_data\_to\_admin\_mail( $userdata = array() ){ |
  | 111 |  | global $wprw\_mail\_to\_admin\_body; |
  | 112 |  | $data = ''; |
  | 113 |  |  |
  | 114 |  | if(!empty($userdata['user\_login'])){ |
  | 115 |  | $data .= '<strong>'.\_\_( 'User Name', 'wp-register-profile-with-shortcode' ).':</strong> '.$userdata['user\_login']; |
  | 116 |  | $data .= '<br>'; |
  | 117 |  | } |
  | 118 |  | if(!empty($userdata['user\_email'])){ |
  | 119 |  | $data .= '<strong>'.\_\_( 'User Email', 'wp-register-profile-with-shortcode' ).':</strong> '.$userdata['user\_email']; |
  | 120 |  | $data .= '<br>'; |
  | 121 |  | } |
  | 122 |  | if(!empty($userdata['first\_name'])){ |
  | 123 |  | $data .= '<strong>'.\_\_( 'First Name', 'wp-register-profile-with-shortcode' ).':</strong> '.$userdata['first\_name']; |
  | 124 |  | $data .= '<br>'; |
  | 125 |  | } |
  | 126 |  | if(!empty($userdata['last\_name'])){ |
  | 127 |  | $data .= '<strong>'.\_\_( 'Last Name', 'wp-register-profile-with-shortcode' ).':</strong> '.$userdata['last\_name']; |
  | 128 |  | $data .= '<br>'; |
  | 129 |  | } |
  | 130 |  | if(!empty($userdata['display\_name'])){ |
  | 131 |  | $data .= '<strong>'.\_\_( 'Display Name', 'wp-register-profile-with-shortcode' ).':</strong> '.$userdata['display\_name']; |
  | 132 |  | $data .= '<br>'; |
  | 133 |  | } |
  | 134 |  | if(!empty($userdata['description'])){ |
  | 135 |  | $data .= '<strong>'.\_\_( 'About User', 'wp-register-profile-with-shortcode' ).':</strong> '.$userdata['description']; |
  | 136 |  | $data .= '<br>'; |
  | 137 |  | } |
  | 138 |  | if(!empty($userdata['user\_url'])){ |
  | 139 |  | $data .= '<strong>'.\_\_( 'User URL', 'wp-register-profile-with-shortcode' ).':</strong> '.$userdata['user\_url']; |
  | 140 |  | $data .= '<br>'; |
  | 141 |  | } |
  | 142 |  |  |
  | 143 |  | $wprw\_mail\_to\_admin\_body = str\_replace( array("#site\_name#", "#new\_user\_data#", '#user\_name#'), array(get\_bloginfo('name'), $data, $userdata['user\_login']), $wprw\_mail\_to\_admin\_body); |
  | 144 |  |  |
  | 145 |  | return $wprw\_mail\_to\_admin\_body; |
  | 146 |  | } |
  | 147 |  |  |
  | 148 |  | public function register\_validate(){ |
  | 149 |  | if(isset($\_POST['option']) and sanitize\_text\_field($\_POST['option']) == "wprp\_user\_register"){ |
  | 150 |  | start\_session\_if\_not\_started(); |
  | 151 |  | global $post; |
  | 152 |  | $error = false; |
  | 153 |  | $comp\_errors = array(); |
  | 154 |  | $msg = ''; |
  | 155 |  | $\_SESSION['wp\_register\_temp\_data'] = $\_POST; |
  | 156 |  |  |
  | 157 |  | // validation compatibility filter // |
  | 158 |  | $default\_registration\_form\_hooks = get\_option('default\_registration\_form\_hooks'); |
  | 159 |  | if($default\_registration\_form\_hooks == 'Yes'){ |
  | 160 |  | $comp\_validation = apply\_filters( 'registration\_errors', $comp\_errors, sanitize\_text\_field(@$\_POST['user\_login']), sanitize\_text\_field(@$\_POST['user\_email']) ); |
  | 161 |  | if ( is\_wp\_error( $comp\_validation ) ) { |
  | 162 |  | $msg .= \_\_($comp\_validation->get\_error\_message(),'wp-register-profile-with-shortcode'); |
  | 163 |  | $msg .= '</br>'; |
  | 164 |  | $error = true; |
  | 165 |  | } |
  | 166 |  | } |
  | 167 |  | // validation compatibility filter // |
  | 168 |  |  |
  | 169 |  | if($this->is\_field\_enabled('captcha\_in\_registration')){ |
  | 170 |  | if ( sanitize\_text\_field($\_POST['user\_captcha']) != $\_SESSION['wprp\_captcha\_code'] ){ |
  | 171 |  | $msg .= \_\_('Security code do not match!','wp-register-profile-with-shortcode'); |
  | 172 |  | $msg .= '</br>'; |
  | 173 |  | $error = true; |
  | 174 |  | } |
  | 175 |  | } |
  | 176 |  |  |
  | 177 |  | if(!$this->is\_field\_enabled('username\_in\_registration') and empty($\_POST['user\_login'])){ |
  | 178 |  | $\_POST['user\_login'] = sanitize\_text\_field($\_POST['user\_email']); |
  | 179 |  | } |
  | 180 |  |  |
  | 181 |  | if ( username\_exists( sanitize\_text\_field($\_POST['user\_login']) ) ){ |
  | 182 |  | $msg .= \_\_('Username already exists. Please use a different one!','wp-register-profile-with-shortcode'); |
  | 183 |  | $msg .= '</br>'; |
  | 184 |  | $error = true; |
  | 185 |  | } |
  | 186 |  |  |
  | 187 |  | if( email\_exists( sanitize\_text\_field($\_POST['user\_email']) )) { |
  | 188 |  | $msg .= \_\_('Email already exists. Please use a different one!','wp-register-profile-with-shortcode'); |
  | 189 |  | $msg .= '</br>'; |
  | 190 |  | $error = true; |
  | 191 |  | } |
  | 192 |  |  |
  | 193 |  | if($this->is\_field\_enabled('password\_in\_registration')){ |
  | 194 |  | if($\_POST['new\_user\_password'] != $\_POST['re\_user\_password']){ |
  | 195 |  | $msg .= \_\_('Password and Retype password do not match!','wp-register-profile-with-shortcode'); |
  | 196 |  | $msg .= '</br>'; |
  | 197 |  | $error = true; |
  | 198 |  | } |
  | 199 |  | } |
  | 200 |  |  |
  | 201 |  | $userdata = array(); |
  | 202 |  |  |
  | 203 |  | if($this->is\_field\_enabled('firstname\_in\_registration')){ |
  | 204 |  | if( $this->is\_field\_enabled('is\_firstname\_required') and sanitize\_text\_field($\_POST['first\_name']) == '' ){ |
  | 205 |  | $msg .= \_\_('Please enter first name','wp-register-profile-with-shortcode'); |
  | 206 |  | $msg .= '</br>'; |
  | 207 |  | $error = true; |
  | 208 |  | } else { |
  | 209 |  | $userdata['first\_name'] = sanitize\_text\_field($\_POST['first\_name']); |
  | 210 |  | } |
  | 211 |  | } |
  | 212 |  |  |
  | 213 |  | if($this->is\_field\_enabled('lastname\_in\_registration')){ |
  | 214 |  | if( $this->is\_field\_enabled('is\_lastname\_required') and sanitize\_text\_field($\_POST['last\_name']) == '' ){ |
  | 215 |  | $msg .= \_\_('Please enter last name','wp-register-profile-with-shortcode'); |
  | 216 |  | $msg .= '</br>'; |
  | 217 |  | $error = true; |
  | 218 |  | } else { |
  | 219 |  | $userdata['last\_name'] = sanitize\_text\_field($\_POST['last\_name']); |
  | 220 |  | } |
  | 221 |  | } |
  | 222 |  |  |
  | 223 |  | if($this->is\_field\_enabled('displayname\_in\_registration')){ |
  | 224 |  | if( $this->is\_field\_enabled('is\_displayname\_required') and sanitize\_text\_field($\_POST['display\_name']) == '' ){ |
  | 225 |  | $msg .= \_\_('Please enter display name','wp-register-profile-with-shortcode'); |
  | 226 |  | $msg .= '</br>'; |
  | 227 |  | $error = true; |
  | 228 |  | } else { |
  | 229 |  | $userdata['display\_name'] = sanitize\_text\_field($\_POST['display\_name']); |
  | 230 |  | } |
  | 231 |  | } |
  | 232 |  |  |
  | 233 |  | if($this->is\_field\_enabled('userdescription\_in\_registration')){ |
  | 234 |  | if( $this->is\_field\_enabled('is\_userdescription\_required') and sanitize\_text\_field($\_POST['description']) == '' ){ |
  | 235 |  | $msg .= \_\_('Please enter description','wp-register-profile-with-shortcode'); |
  | 236 |  | $msg .= '</br>'; |
  | 237 |  | $error = true; |
  | 238 |  | } else { |
  | 239 |  | $userdata['description'] = sanitize\_text\_field($\_POST['description']); |
  | 240 |  | } |
  | 241 |  | } |
  | 242 |  |  |
  | 243 |  | if($this->is\_field\_enabled('userurl\_in\_registration')){ |
  | 244 |  | if( $this->is\_field\_enabled('is\_userurl\_required') and sanitize\_text\_field($\_POST['user\_url']) == '' ){ |
  | 245 |  | $msg .= \_\_('Please enter description','wp-register-profile-with-shortcode'); |
  | 246 |  | $msg .= '</br>'; |
  | 247 |  | $error = true; |
  | 248 |  | } else { |
  | 249 |  | $userdata['user\_url'] = sanitize\_text\_field($\_POST['user\_url']); |
  | 250 |  | } |
  | 251 |  | } |
  | 252 |  |  |
  | 253 |  | if(!$error){ |
  | 254 |  | $userdata['user\_login'] = sanitize\_text\_field($\_POST['user\_login']); |
  | 255 |  | $userdata['user\_email'] = sanitize\_text\_field($\_POST['user\_email']); |
  | 256 |  |  |
  | 257 |  | if($this->is\_field\_enabled('password\_in\_registration') and $\_POST['new\_user\_password'] != ''){ |
  | 258 |  | $new\_pass = $\_POST['new\_user\_password']; |
  | 259 |  | $userdata['user\_pass'] = $new\_pass; |
  | 260 |  | } else { |
  | 261 |  | $new\_pass = wp\_generate\_password(); |
  | 262 |  | $userdata['user\_pass'] = $new\_pass; |
  | 263 |  | } |
  | 264 |  |  |
  | 265 |  | $enable\_cfws\_newsletter\_subscription = get\_option( 'enable\_cfws\_newsletter\_subscription' ); |
  | 266 |  | if($enable\_cfws\_newsletter\_subscription == 'Yes'){ |
  | 267 |  | $userdata['cf\_subscribe\_newsletter'] = sanitize\_text\_field($\_POST['cf\_subscribe\_newsletter']); |
  | 268 |  | } |
  | 269 |  |  |
  | 270 |  | if(get\_option('enable\_subscription') == 'Yes'){ |
  | 271 |  | $\_SESSION['wp\_register\_subscription']['userdata'] = $userdata; |
  | 272 |  | $\_SESSION['wp\_register\_subscription']['sub\_type'] = sanitize\_text\_field($\_REQUEST['sub\_type']); |
  | 273 |  | $redirect\_page = get\_permalink(get\_option('subscription\_page')); |
  | 274 |  | wp\_redirect($redirect\_page); |
  | 275 |  | exit; |
  | 276 |  | } else { |
  | 277 |  | $create\_user\_data['userdata'] = $userdata; |
  | 278 |  | $user\_id = $this->create\_user($create\_user\_data); |
  | 279 |  |  |
  | 280 |  | if( $this->is\_field\_enabled('force\_login\_after\_registration') and $user\_id ){ |
  | 281 |  | $nuser = get\_user\_by( 'id', $user\_id ); |
  | 282 |  | if( $nuser ) { |
  | 283 |  | wp\_set\_current\_user( $user\_id, $nuser->user\_login ); |
  | 284 |  | wp\_set\_auth\_cookie( $user\_id ); |
  | 285 |  | do\_action( 'wp\_login', $nuser->user\_login, $nuser ); |
  | 286 |  | } |
  | 287 |  | } |
  | 288 |  |  |
  | 289 |  | $redirect\_page = get\_option('thank\_you\_page\_after\_registration\_url'); |
  | 290 |  | if($redirect\_page){ |
  | 291 |  | $redirect =  get\_permalink($redirect\_page); |
  | 292 |  | } else { |
  | 293 |  | $redirect =  sanitize\_text\_field($\_REQUEST['redirect']); |
  | 294 |  | } |
  | 295 |  |  |
  | 296 |  | wp\_redirect($redirect); |
  | 297 |  | exit; |
  | 298 |  | } |
  | 299 |  | } else { |
  | 300 |  | $\_SESSION['reg\_error\_msg'] = $msg; |
  | 301 |  | $\_SESSION['reg\_msg\_class'] = 'reg\_error'; |
  | 302 |  | } |
  | 303 |  | } |
  | 304 |  | } |
  |  | 3 | class Register\_Process |
  |  | 4 | { |
  |  | 5 |  |
  |  | 6 | public function \_\_construct() |
  |  | 7 | { |
  |  | 8 | add\_action('init', array($this, 'register\_validate')); |
  |  | 9 | } |
  |  | 10 |  |
  |  | 11 | public function is\_field\_enabled($value) |
  |  | 12 | { |
  |  | 13 | $data = get\_option($value); |
  |  | 14 | if ($data === 'Yes') { |
  |  | 15 | return true; |
  |  | 16 | } else { |
  |  | 17 | return false; |
  |  | 18 | } |
  |  | 19 | } |
  |  | 20 |  |
  |  | 21 | public function is\_field\_required($value) |
  |  | 22 | { |
  |  | 23 | $data = get\_option($value); |
  |  | 24 | if ($data === 'Yes') { |
  |  | 25 | return 'required="required"'; |
  |  | 26 | } else { |
  |  | 27 | return ''; |
  |  | 28 | } |
  |  | 29 | } |
  |  | 30 |  |
  |  | 31 | public static function curPageURL() |
  |  | 32 | { |
  |  | 33 | $pageURL = 'http'; |
  |  | 34 | if (isset($\_SERVER["HTTPS"]) and $\_SERVER["HTTPS"] == "on") {$pageURL .= "s";} |
  |  | 35 | $pageURL .= "://"; |
  |  | 36 | if (isset($\_SERVER["SERVER\_PORT"]) and $\_SERVER["SERVER\_PORT"] != "80") { |
  |  | 37 | $pageURL .= $\_SERVER["SERVER\_NAME"] . ":" . $\_SERVER["SERVER\_PORT"] . $\_SERVER["REQUEST\_URI"]; |
  |  | 38 | } else { |
  |  | 39 | $pageURL .= $\_SERVER["SERVER\_NAME"] . $\_SERVER["REQUEST\_URI"]; |
  |  | 40 | } |
  |  | 41 | return $pageURL; |
  |  | 42 | } |
  |  | 43 |  |
  |  | 44 | public function create\_user($data = array()) |
  |  | 45 | { |
  |  | 46 | start\_session\_if\_not\_started(); |
  |  | 47 | global $wprw\_mail\_to\_user\_subject, $wprw\_mail\_to\_admin\_subject; |
  |  | 48 | $wprw\_admin\_email = get\_option('wprw\_admin\_email'); |
  |  | 49 | $wprw\_from\_email = get\_option('wprw\_from\_email'); |
  |  | 50 | $wprw\_success\_msg = Register\_Settings::removeslashes(get\_option('wprw\_success\_msg')); |
  |  | 51 |  |
  |  | 52 | if (empty($wprw\_success\_msg)) { |
  |  | 53 | $success\_msg = \_\_(Register\_Settings::$wprw\_success\_msg, 'wp-register-profile-with-shortcode'); |
  |  | 54 | } else { |
  |  | 55 | $success\_msg = $wprw\_success\_msg; |
  |  | 56 | } |
  |  | 57 |  |
  |  | 58 | if ($wprw\_from\_email == '') { |
  |  | 59 | $wprw\_from\_email = 'no-reply@wordpress.com'; |
  |  | 60 | } |
  |  | 61 |  |
  |  | 62 | $userdata = $data['userdata']; |
  |  | 63 |  |
  |  | 64 | // insert new user in db // |
  |  | 65 | $user\_id = wp\_insert\_user($userdata); |
  |  | 66 | // insert new user in db // |
  |  | 67 |  |
  |  | 68 | // after insert action // |
  |  | 69 | do\_action('wprp\_after\_insert\_user', $user\_id); |
  |  | 70 | // after insert action // |
  |  | 71 |  |
  |  | 72 | // subscription action // |
  |  | 73 | do\_action('cfws\_subscription', $user\_id, $data); |
  |  | 74 | // subscription action // |
  |  | 75 |  |
  |  | 76 | $headers[] = 'From: <' . $wprw\_from\_email . '>'; |
  |  | 77 |  |
  |  | 78 | // send mail to user // |
  |  | 79 | $subject = Register\_Settings::removeslashes(get\_option('new\_user\_register\_mail\_subject')); |
  |  | 80 | $body = $this->new\_user\_data\_to\_user\_mail($userdata); |
  |  | 81 | $body = html\_entity\_decode($body); |
  |  | 82 |  |
  |  | 83 | $to\_array = array($userdata['user\_email']); |
  |  | 84 | add\_filter('wp\_mail\_content\_type', 'wprw\_set\_html\_content\_type'); |
  |  | 85 | wp\_mail($to\_array, $subject, $body, $headers); |
  |  | 86 | remove\_filter('wp\_mail\_content\_type', 'wprw\_set\_html\_content\_type'); |
  |  | 87 | // send mail to user // |
  |  | 88 |  |
  |  | 89 | // send mail to admin // |
  |  | 90 | if (!empty($wprw\_admin\_email)) { |
  |  | 91 | $subject1 = \_\_($wprw\_mail\_to\_admin\_subject, 'wp-register-profile-with-shortcode'); |
  |  | 92 | $body1 = $this->new\_user\_data\_to\_admin\_mail($userdata); |
  |  | 93 | $body1 = html\_entity\_decode($body1); |
  |  | 94 | add\_filter('wp\_mail\_content\_type', 'wprw\_set\_html\_content\_type'); |
  |  | 95 | wp\_mail($wprw\_admin\_email, $subject1, $body1, $headers); |
  |  | 96 | remove\_filter('wp\_mail\_content\_type', 'wprw\_set\_html\_content\_type'); |
  |  | 97 | } |
  |  | 98 | // send mail to admin // |
  |  | 99 |  |
  |  | 100 | if (!$this->is\_field\_enabled('force\_login\_after\_registration') and $user\_id) { |
  |  | 101 | $\_SESSION['reg\_error\_msg'] = $success\_msg; |
  |  | 102 | $\_SESSION['reg\_msg\_class'] = 'reg\_success'; |
  |  | 103 | } |
  |  | 104 |  |
  |  | 105 | unset($\_SESSION['wp\_register\_temp\_data']); |
  |  | 106 | return $user\_id; |
  |  | 107 | } |
  |  | 108 |  |
  |  | 109 | public function new\_user\_data\_to\_user\_mail($userdata = array()) |
  |  | 110 | { |
  |  | 111 | $wprw\_mail\_to\_user\_body = Register\_Settings::removeslashes(get\_option('new\_user\_register\_mail\_body')); |
  |  | 112 |  |
  |  | 113 | $wprw\_mail\_to\_user\_body = str\_replace(array("#site\_name#", "#user\_name#", "#user\_password#", "#site\_url#"), array(get\_bloginfo('name'), $userdata['user\_login'], $userdata['user\_pass'], site\_url()), $wprw\_mail\_to\_user\_body); |
  |  | 114 | return $wprw\_mail\_to\_user\_body; |
  |  | 115 | } |
  |  | 116 |  |
  |  | 117 | public function new\_user\_data\_to\_admin\_mail($userdata = array()) |
  |  | 118 | { |
  |  | 119 | global $wprw\_mail\_to\_admin\_body; |
  |  | 120 | $data = ''; |
  |  | 121 |  |
  |  | 122 | if (!empty($userdata['user\_login'])) { |
  |  | 123 | $data .= '<strong>' . \_\_('User Name', 'wp-register-profile-with-shortcode') . ':</strong> ' . $userdata['user\_login']; |
  |  | 124 | $data .= '<br>'; |
  |  | 125 | } |
  |  | 126 | if (!empty($userdata['user\_email'])) { |
  |  | 127 | $data .= '<strong>' . \_\_('User Email', 'wp-register-profile-with-shortcode') . ':</strong> ' . $userdata['user\_email']; |
  |  | 128 | $data .= '<br>'; |
  |  | 129 | } |
  |  | 130 | if (!empty($userdata['first\_name'])) { |
  |  | 131 | $data .= '<strong>' . \_\_('First Name', 'wp-register-profile-with-shortcode') . ':</strong> ' . $userdata['first\_name']; |
  |  | 132 | $data .= '<br>'; |
  |  | 133 | } |
  |  | 134 | if (!empty($userdata['last\_name'])) { |
  |  | 135 | $data .= '<strong>' . \_\_('Last Name', 'wp-register-profile-with-shortcode') . ':</strong> ' . $userdata['last\_name']; |
  |  | 136 | $data .= '<br>'; |
  |  | 137 | } |
  |  | 138 | if (!empty($userdata['display\_name'])) { |
  |  | 139 | $data .= '<strong>' . \_\_('Display Name', 'wp-register-profile-with-shortcode') . ':</strong> ' . $userdata['display\_name']; |
  |  | 140 | $data .= '<br>'; |
  |  | 141 | } |
  |  | 142 | if (!empty($userdata['description'])) { |
  |  | 143 | $data .= '<strong>' . \_\_('About User', 'wp-register-profile-with-shortcode') . ':</strong> ' . $userdata['description']; |
  |  | 144 | $data .= '<br>'; |
  |  | 145 | } |
  |  | 146 | if (!empty($userdata['user\_url'])) { |
  |  | 147 | $data .= '<strong>' . \_\_('User URL', 'wp-register-profile-with-shortcode') . ':</strong> ' . $userdata['user\_url']; |
  |  | 148 | $data .= '<br>'; |
  |  | 149 | } |
  |  | 150 |  |
  |  | 151 | $wprw\_mail\_to\_admin\_body = str\_replace(array("#site\_name#", "#new\_user\_data#", '#user\_name#'), array(get\_bloginfo('name'), $data, $userdata['user\_login']), $wprw\_mail\_to\_admin\_body); |
  |  | 152 |  |
  |  | 153 | return $wprw\_mail\_to\_admin\_body; |
  |  | 154 | } |
  |  | 155 |  |
  |  | 156 | public function register\_validate() |
  |  | 157 | { |
  |  | 158 | if (isset($\_POST['option']) and sanitize\_text\_field($\_POST['option']) == "wprp\_user\_register") { |
  |  | 159 |  |
  |  | 160 | if (!wp\_verify\_nonce($\_POST['wprp\_5q5rt78'], 'wprp\_action')) { |
  |  | 161 | wp\_die('Error'); |
  |  | 162 | } |
  |  | 163 |  |
  |  | 164 | start\_session\_if\_not\_started(); |
  |  | 165 | global $post; |
  |  | 166 | $error = false; |
  |  | 167 | $comp\_errors = array(); |
  |  | 168 | $msg = ''; |
  |  | 169 | $\_SESSION['wp\_register\_temp\_data'] = $\_POST; |
  |  | 170 |  |
  |  | 171 | // validation compatibility filter // |
  |  | 172 | $default\_registration\_form\_hooks = get\_option('default\_registration\_form\_hooks'); |
  |  | 173 | if ($default\_registration\_form\_hooks == 'Yes') { |
  |  | 174 | $comp\_validation = apply\_filters('registration\_errors', $comp\_errors, sanitize\_text\_field(@$\_POST['user\_login']), sanitize\_text\_field(@$\_POST['user\_email'])); |
  |  | 175 | if (is\_wp\_error($comp\_validation)) { |
  |  | 176 | $msg .= \_\_($comp\_validation->get\_error\_message(), 'wp-register-profile-with-shortcode'); |
  |  | 177 | $msg .= '</br>'; |
  |  | 178 | $error = true; |
  |  | 179 | } |
  |  | 180 | } |
  |  | 181 | // validation compatibility filter // |
  |  | 182 |  |
  |  | 183 | if ($this->is\_field\_enabled('captcha\_in\_registration')) { |
  |  | 184 | if (sanitize\_text\_field($\_POST['user\_captcha']) != $\_SESSION['wprp\_captcha\_code']) { |
  |  | 185 | $msg .= \_\_('Security code do not match!', 'wp-register-profile-with-shortcode'); |
  |  | 186 | $msg .= '</br>'; |
  |  | 187 | $error = true; |
  |  | 188 | } |
  |  | 189 | } |
  |  | 190 |  |
  |  | 191 | if (!$this->is\_field\_enabled('username\_in\_registration') and empty($\_POST['user\_login'])) { |
  |  | 192 | $\_POST['user\_login'] = sanitize\_text\_field($\_POST['user\_email']); |
  |  | 193 | } |
  |  | 194 |  |
  |  | 195 | if (username\_exists(sanitize\_text\_field($\_POST['user\_login']))) { |
  |  | 196 | $msg .= \_\_('Username already exists. Please use a different one!', 'wp-register-profile-with-shortcode'); |
  |  | 197 | $msg .= '</br>'; |
  |  | 198 | $error = true; |
  |  | 199 | } |
  |  | 200 |  |
  |  | 201 | if (email\_exists(sanitize\_text\_field($\_POST['user\_email']))) { |
  |  | 202 | $msg .= \_\_('Email already exists. Please use a different one!', 'wp-register-profile-with-shortcode'); |
  |  | 203 | $msg .= '</br>'; |
  |  | 204 | $error = true; |
  |  | 205 | } |
  |  | 206 |  |
  |  | 207 | if ($this->is\_field\_enabled('password\_in\_registration')) { |
  |  | 208 | if ($\_POST['new\_user\_password'] != $\_POST['re\_user\_password']) { |
  |  | 209 | $msg .= \_\_('Password and Retype password do not match!', 'wp-register-profile-with-shortcode'); |
  |  | 210 | $msg .= '</br>'; |
  |  | 211 | $error = true; |
  |  | 212 | } |
  |  | 213 | } |
  |  | 214 |  |
  |  | 215 | $userdata = array(); |
  |  | 216 |  |
  |  | 217 | if ($this->is\_field\_enabled('firstname\_in\_registration')) { |
  |  | 218 | if ($this->is\_field\_enabled('is\_firstname\_required') and sanitize\_text\_field($\_POST['first\_name']) == '') { |
  |  | 219 | $msg .= \_\_('Please enter first name', 'wp-register-profile-with-shortcode'); |
  |  | 220 | $msg .= '</br>'; |
  |  | 221 | $error = true; |
  |  | 222 | } else { |
  |  | 223 | $userdata['first\_name'] = sanitize\_text\_field($\_POST['first\_name']); |
  |  | 224 | } |
  |  | 225 | } |
  |  | 226 |  |
  |  | 227 | if ($this->is\_field\_enabled('lastname\_in\_registration')) { |
  |  | 228 | if ($this->is\_field\_enabled('is\_lastname\_required') and sanitize\_text\_field($\_POST['last\_name']) == '') { |
  |  | 229 | $msg .= \_\_('Please enter last name', 'wp-register-profile-with-shortcode'); |
  |  | 230 | $msg .= '</br>'; |
  |  | 231 | $error = true; |
  |  | 232 | } else { |
  |  | 233 | $userdata['last\_name'] = sanitize\_text\_field($\_POST['last\_name']); |
  |  | 234 | } |
  |  | 235 | } |
  |  | 236 |  |
  |  | 237 | if ($this->is\_field\_enabled('displayname\_in\_registration')) { |
  |  | 238 | if ($this->is\_field\_enabled('is\_displayname\_required') and sanitize\_text\_field($\_POST['display\_name']) == '') { |
  |  | 239 | $msg .= \_\_('Please enter display name', 'wp-register-profile-with-shortcode'); |
  |  | 240 | $msg .= '</br>'; |
  |  | 241 | $error = true; |
  |  | 242 | } else { |
  |  | 243 | $userdata['display\_name'] = sanitize\_text\_field($\_POST['display\_name']); |
  |  | 244 | } |
  |  | 245 | } |
  |  | 246 |  |
  |  | 247 | if ($this->is\_field\_enabled('userdescription\_in\_registration')) { |
  |  | 248 | if ($this->is\_field\_enabled('is\_userdescription\_required') and sanitize\_text\_field($\_POST['description']) == '') { |
  |  | 249 | $msg .= \_\_('Please enter description', 'wp-register-profile-with-shortcode'); |
  |  | 250 | $msg .= '</br>'; |
  |  | 251 | $error = true; |
  |  | 252 | } else { |
  |  | 253 | $userdata['description'] = sanitize\_text\_field($\_POST['description']); |
  |  | 254 | } |
  |  | 255 | } |
  |  | 256 |  |
  |  | 257 | if ($this->is\_field\_enabled('userurl\_in\_registration')) { |
  |  | 258 | if ($this->is\_field\_enabled('is\_userurl\_required') and sanitize\_text\_field($\_POST['user\_url']) == '') { |
  |  | 259 | $msg .= \_\_('Please enter description', 'wp-register-profile-with-shortcode'); |
  |  | 260 | $msg .= '</br>'; |
  |  | 261 | $error = true; |
  |  | 262 | } else { |
  |  | 263 | $userdata['user\_url'] = sanitize\_text\_field($\_POST['user\_url']); |
  |  | 264 | } |
  |  | 265 | } |
  |  | 266 |  |
  |  | 267 | if (!$error) { |
  |  | 268 | $userdata['user\_login'] = sanitize\_text\_field($\_POST['user\_login']); |
  |  | 269 | $userdata['user\_email'] = sanitize\_text\_field($\_POST['user\_email']); |
  |  | 270 |  |
  |  | 271 | if ($this->is\_field\_enabled('password\_in\_registration') and $\_POST['new\_user\_password'] != '') { |
  |  | 272 | $new\_pass = $\_POST['new\_user\_password']; |
  |  | 273 | $userdata['user\_pass'] = $new\_pass; |
  |  | 274 | } else { |
  |  | 275 | $new\_pass = wp\_generate\_password(); |
  |  | 276 | $userdata['user\_pass'] = $new\_pass; |
  |  | 277 | } |
  |  | 278 |  |
  |  | 279 | $enable\_cfws\_newsletter\_subscription = get\_option('enable\_cfws\_newsletter\_subscription'); |
  |  | 280 | if ($enable\_cfws\_newsletter\_subscription == 'Yes') { |
  |  | 281 | $userdata['cf\_subscribe\_newsletter'] = sanitize\_text\_field($\_POST['cf\_subscribe\_newsletter']); |
  |  | 282 | } |
  |  | 283 |  |
  |  | 284 | if (get\_option('enable\_subscription') == 'Yes') { |
  |  | 285 | $\_SESSION['wp\_register\_subscription']['userdata'] = $userdata; |
  |  | 286 | $\_SESSION['wp\_register\_subscription']['sub\_type'] = sanitize\_text\_field($\_REQUEST['sub\_type']); |
  |  | 287 | $redirect\_page = get\_permalink(get\_option('subscription\_page')); |
  |  | 288 | wp\_redirect($redirect\_page); |
  |  | 289 | exit; |
  |  | 290 | } else { |
  |  | 291 | $create\_user\_data['userdata'] = $userdata; |
  |  | 292 | $user\_id = $this->create\_user($create\_user\_data); |
  |  | 293 |  |
  |  | 294 | if ($this->is\_field\_enabled('force\_login\_after\_registration') and $user\_id) { |
  |  | 295 | $nuser = get\_user\_by('id', $user\_id); |
  |  | 296 | if ($nuser) { |
  |  | 297 | wp\_set\_current\_user($user\_id, $nuser->user\_login); |
  |  | 298 | wp\_set\_auth\_cookie($user\_id); |
  |  | 299 | do\_action('wp\_login', $nuser->user\_login, $nuser); |
  |  | 300 | } |
  |  | 301 | } |
  |  | 302 |  |
  |  | 303 | $redirect\_page = get\_option('thank\_you\_page\_after\_registration\_url'); |
  |  | 304 | if ($redirect\_page) { |
  |  | 305 | $redirect = get\_permalink($redirect\_page); |
  |  | 306 | } else { |
  |  | 307 | $redirect = sanitize\_text\_field($\_REQUEST['redirect']); |
  |  | 308 | } |
  |  | 309 |  |
  |  | 310 | wp\_redirect($redirect); |
  |  | 311 | exit; |
  |  | 312 | } |
  |  | 313 | } else { |
  |  | 314 | $\_SESSION['reg\_error\_msg'] = $msg; |
  |  | 315 | $\_SESSION['reg\_msg\_class'] = 'reg\_error'; |
  |  | 316 | } |
  |  | 317 | } |
  |  | 318 | } |
  | 305 | 319 | } |
* ## [wp-register-profile-with-shortcode/trunk/includes/class-settings.php](/changeset/3018102/wp-register-profile-with-shortcode/trunk/includes/class-settings.php "Show the changeset 3018102 restricted to wp-register-profile-with-shortcode/trunk/includes/class-settings.php")

  | [r2969364](/browser/wp-register-profile-with-shortcode/trunk/includes/class-settings.php?rev=2969364#L13 "Show revision 2969364 of this file in browser") | [r3018102](/browser/wp-register-profile-with-shortcode/trunk/includes/class-settings.php?rev=3018102#L13 "Show revision 3018102 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 | { |
  | 14 | 14 | if (isset($\_POST['option']) and sanitize\_text\_field($\_POST['option']) == "register\_widget\_save\_settings") { |
  |  | 15 |  |
  |  | 16 | if (!wp\_verify\_nonce($\_POST['wprp\_58irt78'], 'wprp\_admin\_action')) { |
  |  | 17 | wp\_die('Error'); |
  |  | 18 | } |
  |  | 19 |  |
  | 15 | 20 | start\_session\_if\_not\_started(); |
  | 16 | 21 | global $wprp\_default\_options\_data; |
* ## [wp-register-profile-with-shortcode/trunk/readme.txt](/changeset/3018102/wp-register-profile-with-shortcode/trunk/readme.txt "Show the changeset 3018102 restricted to wp-register-profile-with-shortcode/trunk/readme.txt")

  | [r2969364](/browser/wp-register-profile-with-shortcode/trunk/readme.txt?rev=2969364#L4 "Show revision 2969364 of this file in browser") | [r3018102](/browser/wp-register-profile-with-shortcode/trunk/readme.txt?rev=3018102#L4 "Show revision 3018102 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Tags: register, responsive user registration, wp register, profile, register widget, widget, user register, register user, responsive form, responsive register form, custom fields, profile image, date, time, user image, custom profile fields, profile data |
  | 5 | 5 | Requires at least: 2.0.2 |
  | 6 |  | Tested up to: 6.~~2~~.2 |
  | 7 |  | Stable tag: 3.~~5.9~~ |
  |  | 6 | Tested up to: 6.4.2 |
  |  | 7 | Stable tag: 3.6.0 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/wp-register-profile-with-shortcode/trunk/readme.txt?rev=2969364#L89) | […](/browser/wp-register-profile-with-shortcode/trunk/readme.txt?rev=3018102#L89) |  |
  | 89 | 89 | == Changelog == |
  | 90 | 90 |  |
  |  | 91 | = 3.6.0 = |
  |  | 92 | \* Bug fixes and improvements. |
  |  | 93 |  |
  | 91 | 94 | = 3.5.9 = |
  | 92 | 95 | \* Bug fixes and improvements. |
* ## [wp-register-profile-with-shortcode/trunk/register.php](/changeset/3018102/wp-register-profile-with-shortcode/trunk/register.php "Show the changeset 3018102 restricted to wp-register-profile-with-shortcode/trunk/register.php")

  | [r2969364](/browser/wp-register-profile-with-shortcode/trunk/register.php?rev=2969364#L4 "Show revision 2969364 of this file in browser") | [r3018102](/browser/wp-register-profile-with-shortcode/trunk/register.php?rev=3018102#L4 "Show revision 3018102 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Plugin URI: https://wordpress.org/plugins/wp-register-profile-with-shortcode/ |
  | 5 | 5 | Description: This is a simple registration form in the widget. just install the plugin and add the register widget in the sidebar. Thats it. :) |
  | 6 |  | Version: 3.~~5.9~~ |
  |  | 6 | Version: 3.6.0 |
  | 7 | 7 | Text Domain: wp-register-profile-with-shortcode |
  | 8 | 8 | Domain Path: /languages |
* ## [wp-register-profile-with-shortcode/trunk/view/admin/settings.php](/changeset/3018102/wp-register-profile-with-shortcode/trunk/view/admin/settings.php "Show the changeset 3018102 restricted to wp-register-profile-with-shortcode/trunk/view/admin/settings.php")

  | [r2944276](/browser/wp-register-profile-with-shortcode/trunk/view/admin/settings.php?rev=2944276#L3 "Show revision 2944276 of this file in browser") | [r3018102](/browser/wp-register-profile-with-shortcode/trunk/view/admin/settings.php?rev=3018102#L3 "Show revision 3018102 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | wp\_nonce\_field('register\_widget\_save\_action', 'register\_widget\_save\_action\_field'); |
  | 4 | 4 | Form\_Class::form\_input('hidden', 'option', '', 'register\_widget\_save\_settings'); |
  |  | 5 | wp\_nonce\_field('wprp\_admin\_action', 'wprp\_58irt78'); |
  | 5 | 6 | ?> |
  | 6 | 7 | <table width="100%" border="0" class="ap-table"> |
* ## [wp-register-profile-with-shortcode/trunk/view/frontend/profile-edit.php](/changeset/3018102/wp-register-profile-with-shortcode/trunk/view/frontend/profile-edit.php "Show the changeset 3018102 restricted to wp-register-profile-with-shortcode/trunk/view/frontend/profile-edit.php")

  | [r2393730](/browser/wp-register-profile-with-shortcode/trunk/view/frontend/profile-edit.php?rev=2393730#L1 "Show revision 2393730 of this file in browser") | [r3018102](/browser/wp-register-profile-with-shortcode/trunk/view/frontend/profile-edit.php?rev=3018102#L1 "Show revision 3018102 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <form name="profile" id="profile" method="post" action="" <?php do\_action('wprp\_profile\_form\_tag');?>> |
  | 2 | 2 | <input type="hidden" name="option" value="wprp\_user\_edit\_profile" /> |
  | 3 |  | <input type="hidden" name="redirect" value="<?php echo sanitize\_text\_field( Register\_Process::curPageURL() ); ?>"> |
  |  | 3 | <input type="hidden" name="redirect" value="<?php echo sanitize\_text\_field(Register\_Process::curPageURL()); ?>"> |
  |  | 4 | <?php wp\_nonce\_field('wprp\_action', 'wprp\_5q5rt78');?> |
  | 4 | 5 | <div class="reg-form-group"> |
  | 5 | 6 | <label for="name"> |
  | 6 |  | <?php \_e('Username','wp-register-profile-with-shortcode');?> |
  |  | 7 | <?php \_e('Username', 'wp-register-profile-with-shortcode');?> |
  | 7 | 8 | </label> |
  | 8 |  | <input type="text" required value="<?php echo $current\_user->user\_login;~~?>" disabled <?php do\_action( 'wprp\_profile\_user\_login\_field'~~ );?>/> |
  |  | 9 | <input type="text" required value="<?php echo $current\_user->user\_login; ?>" disabled <?php do\_action('wprp\_profile\_user\_login\_field');?>/> |
  | 9 | 10 | </div> |
  | 10 | 11 | <div class="reg-form-group"> |
  | 11 | 12 | <label for="name"> |
  | 12 |  | <?php \_e('User Email','wp-register-profile-with-shortcode');?> |
  |  | 13 | <?php \_e('User Email', 'wp-register-profile-with-shortcode');?> |
  | 13 | 14 | </label> |
  | 14 |  | <input type="email" name="user\_email" value="<?php echo $current\_user->user\_email;~~?>" required title="<?php \_e('Please enter email','wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_profile\_user\_email\_field'~~ );?>/> |
  |  | 15 | <input type="email" name="user\_email" value="<?php echo $current\_user->user\_email; ?>" required title="<?php \_e('Please enter email', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_profile\_user\_email\_field');?>/> |
  | 15 | 16 | </div> |
  | 16 |  | <?php if~~($this->is\_field\_enabled('firstname\_in\_profile')){~~ ?> |
  |  | 17 | <?php if ($this->is\_field\_enabled('firstname\_in\_profile')) {?> |
  | 17 | 18 | <div class="reg-form-group"> |
  | 18 | 19 | <label for="name"> |
  | 19 |  | <?php \_e('First Name','wp-register-profile-with-shortcode');?> |
  |  | 20 | <?php \_e('First Name', 'wp-register-profile-with-shortcode');?> |
  | 20 | 21 | </label> |
  | 21 |  | <input type="text" name="first\_name" <?php echo $this->is\_field\_required('is\_firstname\_required');~~?> title="<?php \_e('Please enter first name','wp-register-profile-with-shortcode');?>" placeholder="First Name" value="<?php echo $current\_user->first\_name;?>" <?php do\_action( 'wprp\_profile\_first\_name\_field'~~ );?>/> |
  |  | 22 | <input type="text" name="first\_name" <?php echo $this->is\_field\_required('is\_firstname\_required'); ?> title="<?php \_e('Please enter first name', 'wp-register-profile-with-shortcode');?>" placeholder="First Name" value="<?php echo $current\_user->first\_name; ?>" <?php do\_action('wprp\_profile\_first\_name\_field');?>/> |
  | 22 | 23 | </div> |
  | 23 |  | <?php }?> |
  | 24 |  | <?php if~~($this->is\_field\_enabled('lastname\_in\_profile')){~~ ?> |
  |  | 24 | <?php }?> |
  |  | 25 | <?php if ($this->is\_field\_enabled('lastname\_in\_profile')) {?> |
  | 25 | 26 | <div class="reg-form-group"> |
  | 26 | 27 | <label for="name"> |
  | 27 |  | <?php \_e('Last Name','wp-register-profile-with-shortcode');?> |
  |  | 28 | <?php \_e('Last Name', 'wp-register-profile-with-shortcode');?> |
  | 28 | 29 | </label> |
  | 29 |  | <input type="text" name="last\_name" <?php echo $this->is\_field\_required('is\_lastname\_required');~~?> title="<?php \_e('Please enter last name','wp-register-profile-with-shortcode');?>" placeholder="Last Name" value="<?php echo $current\_user->last\_name;?>" <?php do\_action( 'wprp\_profile\_last\_name\_field'~~ );?>/> |
  |  | 30 | <input type="text" name="last\_name" <?php echo $this->is\_field\_required('is\_lastname\_required'); ?> title="<?php \_e('Please enter last name', 'wp-register-profile-with-shortcode');?>" placeholder="Last Name" value="<?php echo $current\_user->last\_name; ?>" <?php do\_action('wprp\_profile\_last\_name\_field');?>/> |
  | 30 | 31 | </div> |
  | 31 |  | <?php }?> |
  | 32 |  | <?php if~~($this->is\_field\_enabled('displayname\_in\_profile')){~~ ?> |
  |  | 32 | <?php }?> |
  |  | 33 | <?php if ($this->is\_field\_enabled('displayname\_in\_profile')) {?> |
  | 33 | 34 | <div class="reg-form-group"> |
  | 34 | 35 | <label for="name"> |
  | 35 |  | <?php \_e('Display Name','wp-register-profile-with-shortcode');?> |
  |  | 36 | <?php \_e('Display Name', 'wp-register-profile-with-shortcode');?> |
  | 36 | 37 | </label> |
  | 37 |  | <input type="text" name="display\_name" <?php echo $this->is\_field\_required('is\_displayname\_required');~~?> title="<?php \_e('Please enter display name','wp-register-profile-with-shortcode');?>" placeholder="Display Name" value="<?php echo $current\_user->display\_name;?>" <?php do\_action( 'wprp\_profile\_display\_name\_field'~~ );?>/> |
  |  | 38 | <input type="text" name="display\_name" <?php echo $this->is\_field\_required('is\_displayname\_required'); ?> title="<?php \_e('Please enter display name', 'wp-register-profile-with-shortcode');?>" placeholder="Display Name" value="<?php echo $current\_user->display\_name; ?>" <?php do\_action('wprp\_profile\_display\_name\_field');?>/> |
  | 38 | 39 | </div> |
  | 39 |  | <?php }?> |
  | 40 |  | <?php if~~($this->is\_field\_enabled('userdescription\_in\_profile')){~~ ?> |
  |  | 40 | <?php }?> |
  |  | 41 | <?php if ($this->is\_field\_enabled('userdescription\_in\_profile')) {?> |
  | 41 | 42 | <div class="reg-form-group"> |
  | 42 | 43 | <label for="name"> |
  | 43 |  | <?php \_e('About User','wp-register-profile-with-shortcode');?> |
  |  | 44 | <?php \_e('About User', 'wp-register-profile-with-shortcode');?> |
  | 44 | 45 | </label> |
  | 45 |  | <textarea name="description" <?php echo $this->is\_field\_required('is\_userdescription\_required');~~?> title="<?php \_e('Please enter about','wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_profile\_description\_field' );?>><?php echo get\_the\_author\_meta( 'description', $user\_id );~~?></textarea> |
  |  | 46 | <textarea name="description" <?php echo $this->is\_field\_required('is\_userdescription\_required'); ?> title="<?php \_e('Please enter about', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_profile\_description\_field');?>><?php echo get\_the\_author\_meta('description', $user\_id); ?></textarea> |
  | 46 | 47 | </div> |
  | 47 |  | <?php }?> |
  | 48 |  | <?php if~~($this->is\_field\_enabled('userurl\_in\_profile')){~~ ?> |
  |  | 48 | <?php }?> |
  |  | 49 | <?php if ($this->is\_field\_enabled('userurl\_in\_profile')) {?> |
  | 49 | 50 | <div class="reg-form-group"> |
  | 50 | 51 | <label for="name"> |
  | 51 |  | <?php \_e('Website','wp-register-profile-with-shortcode');?> |
  |  | 52 | <?php \_e('Website', 'wp-register-profile-with-shortcode');?> |
  | 52 | 53 | </label> |
  | 53 |  | <input type="url" name="user\_url" <?php echo $this->is\_field\_required('is\_userurl\_required');~~?> title="<?php \_e('Please enter website url','wp-register-profile-with-shortcode');?>" placeholder="User URL" value="<?php echo get\_the\_author\_meta( 'user\_url', $user\_id );?>" <?php do\_action( 'wprp\_profile\_user\_url\_field'~~ );?>/> |
  |  | 54 | <input type="url" name="user\_url" <?php echo $this->is\_field\_required('is\_userurl\_required'); ?> title="<?php \_e('Please enter website url', 'wp-register-profile-with-shortcode');?>" placeholder="User URL" value="<?php echo get\_the\_author\_meta('user\_url', $user\_id); ?>" <?php do\_action('wprp\_profile\_user\_url\_field');?>/> |
  | 54 | 55 | </div> |
  | 55 |  | <?php }?> |
  |  | 56 | <?php }?> |
  | 56 | 57 | <?php do\_action('wp\_register\_profile\_edit\_form');?> |
  | 57 | 58 | <div class="reg-form-group"> |
  | 58 |  | <input name="profile" type="submit" value="<?php \_e('Update',~~'wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_profile\_form\_submit\_tag'~~ );?>/> |
  |  | 59 | <input name="profile" type="submit" value="<?php \_e('Update', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_profile\_form\_submit\_tag');?>/> |
  | 59 | 60 | </div> |
  | 60 | 61 | </form> |
* ## [wp-register-profile-with-shortcode/trunk/view/frontend/register.php](/changeset/3018102/wp-register-profile-with-shortcode/trunk/view/frontend/register.php "Show the changeset 3018102 restricted to wp-register-profile-with-shortcode/trunk/view/frontend/register.php")

  | [r2393730](/browser/wp-register-profile-with-shortcode/trunk/view/frontend/register.php?rev=2393730#L1 "Show revision 2393730 of this file in browser") | [r3018102](/browser/wp-register-profile-with-shortcode/trunk/view/frontend/register.php?rev=3018102#L1 "Show revision 3018102 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <form name="register" id="register" method="post" action="" <?php do\_action('wprp\_register\_form\_tag');?>> |
  | 2 | 2 | <input type="hidden" name="option" value="wprp\_user\_register" /> |
  | 3 |  | <input type="hidden" name="redirect" value="<?php echo sanitize\_text\_field( Register\_Process::curPageURL() ); ?>" /> |
  | 4 |  | <?php if($wprp\_p->is\_field\_enabled('username\_in\_registration')){ ?> |
  |  | 3 | <input type="hidden" name="redirect" value="<?php echo sanitize\_text\_field(Register\_Process::curPageURL()); ?>" /> |
  |  | 4 | <?php wp\_nonce\_field('wprp\_action', 'wprp\_5q5rt78');?> |
  |  | 5 | <?php if ($wprp\_p->is\_field\_enabled('username\_in\_registration')) {?> |
  | 5 | 6 | <div class="reg-form-group"> |
  | 6 | 7 | <label for="username"> |
  | 7 |  | <?php \_e('Username','wp-register-profile-with-shortcode');?> |
  |  | 8 | <?php \_e('Username', 'wp-register-profile-with-shortcode');?> |
  | 8 | 9 | </label> |
  | 9 |  | <input type="text" name="user\_login" value="<?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['user\_login']);~~?>" required title="<?php \_e('Please enter username','wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('Username','wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_user\_login\_field'~~ );?>/> |
  |  | 10 | <input type="text" name="user\_login" value="<?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['user\_login']); ?>" required title="<?php \_e('Please enter username', 'wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('Username', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_user\_login\_field');?>/> |
  | 10 | 11 | </div> |
  | 11 |  | <?php }?> |
  |  | 12 | <?php }?> |
  | 12 | 13 | <div class="reg-form-group"> |
  | 13 | 14 | <label for="useremail"> |
  | 14 |  | <?php \_e('User Email','wp-register-profile-with-shortcode');?> |
  |  | 15 | <?php \_e('User Email', 'wp-register-profile-with-shortcode');?> |
  | 15 | 16 | </label> |
  | 16 |  | <input type="email" name="user\_email" value="<?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['user\_email']);~~?>" required title="<?php \_e('Please enter email','wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('User Email','wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_user\_email\_field'~~ );?>/> |
  |  | 17 | <input type="email" name="user\_email" value="<?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['user\_email']); ?>" required title="<?php \_e('Please enter email', 'wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('User Email', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_user\_email\_field');?>/> |
  | 17 | 18 | </div> |
  | 18 |  | <?php if~~($wprp\_p->is\_field\_enabled('password\_in\_registration')){~~ ?> |
  |  | 19 | <?php if ($wprp\_p->is\_field\_enabled('password\_in\_registration')) {?> |
  | 19 | 20 | <div class="reg-form-group"> |
  | 20 | 21 | <label for="password"> |
  | 21 |  | <?php \_e('Password','wp-register-profile-with-shortcode');?> |
  |  | 22 | <?php \_e('Password', 'wp-register-profile-with-shortcode');?> |
  | 22 | 23 | </label> |
  | 23 |  | <input type="password" name="new\_user\_password" required placeholder="<?php \_e('Password',~~'wp-register-profile-with-shortcode');?>" title="<?php \_e('Please enter password','wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_new\_user\_password\_field'~~ );?>/> |
  |  | 24 | <input type="password" name="new\_user\_password" required placeholder="<?php \_e('Password', 'wp-register-profile-with-shortcode');?>" title="<?php \_e('Please enter password', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_new\_user\_password\_field');?>/> |
  | 24 | 25 | </div> |
  | 25 | 26 | <div class="reg-form-group"> |
  | 26 | 27 | <label for="retypepassword"> |
  | 27 |  | <?php \_e('Retype Password','wp-register-profile-with-shortcode');?> |
  |  | 28 | <?php \_e('Retype Password', 'wp-register-profile-with-shortcode');?> |
  | 28 | 29 | </label> |
  | 29 |  | <input type="password" name="re\_user\_password" required title="<?php \_e('Please re-enter password',~~'wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('Retype Password','wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_re\_user\_password\_field'~~ );?>/> |
  |  | 30 | <input type="password" name="re\_user\_password" required title="<?php \_e('Please re-enter password', 'wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('Retype Password', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_re\_user\_password\_field');?>/> |
  | 30 | 31 | </div> |
  | 31 |  | <?php }?> |
  | 32 |  | <?php if~~($wprp\_p->is\_field\_enabled('firstname\_in\_registration')){~~ ?> |
  |  | 32 | <?php }?> |
  |  | 33 | <?php if ($wprp\_p->is\_field\_enabled('firstname\_in\_registration')) {?> |
  | 33 | 34 | <div class="reg-form-group"> |
  | 34 | 35 | <label for="firstname"> |
  | 35 |  | <?php \_e('First Name','wp-register-profile-with-shortcode');?> |
  |  | 36 | <?php \_e('First Name', 'wp-register-profile-with-shortcode');?> |
  | 36 | 37 | </label> |
  | 37 |  | <input type="text" name="first\_name" value="<?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['first\_name']);~~?>" <?php echo $wprp\_p->is\_field\_required('is\_firstname\_required');?> title="<?php \_e('Please enter first name','wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('First Name','wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_first\_name\_field'~~ );?>/> |
  |  | 38 | <input type="text" name="first\_name" value="<?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['first\_name']); ?>" <?php echo $wprp\_p->is\_field\_required('is\_firstname\_required'); ?> title="<?php \_e('Please enter first name', 'wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('First Name', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_first\_name\_field');?>/> |
  | 38 | 39 | </div> |
  | 39 |  | <?php }?> |
  | 40 |  | <?php if~~($wprp\_p->is\_field\_enabled('lastname\_in\_registration')){~~ ?> |
  |  | 40 | <?php }?> |
  |  | 41 | <?php if ($wprp\_p->is\_field\_enabled('lastname\_in\_registration')) {?> |
  | 41 | 42 | <div class="reg-form-group"> |
  | 42 | 43 | <label for="lastname"> |
  | 43 |  | <?php \_e('Last Name','wp-register-profile-with-shortcode');?> |
  |  | 44 | <?php \_e('Last Name', 'wp-register-profile-with-shortcode');?> |
  | 44 | 45 | </label> |
  | 45 |  | <input type="text" name="last\_name" value="<?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['last\_name']);~~?>" <?php echo $wprp\_p->is\_field\_required('is\_lastname\_required');?> title="<?php \_e('Please enter last name','wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('Last Name','wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_last\_name\_field'~~ );?>/> |
  |  | 46 | <input type="text" name="last\_name" value="<?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['last\_name']); ?>" <?php echo $wprp\_p->is\_field\_required('is\_lastname\_required'); ?> title="<?php \_e('Please enter last name', 'wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('Last Name', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_last\_name\_field');?>/> |
  | 46 | 47 | </div> |
  | 47 |  | <?php }?> |
  | 48 |  | <?php if~~($wprp\_p->is\_field\_enabled('displayname\_in\_registration')){~~ ?> |
  |  | 48 | <?php }?> |
  |  | 49 | <?php if ($wprp\_p->is\_field\_enabled('displayname\_in\_registration')) {?> |
  | 49 | 50 | <div class="reg-form-group"> |
  | 50 | 51 | <label for="displayname"> |
  | 51 |  | <?php \_e('Display Name','wp-register-profile-with-shortcode');?> |
  |  | 52 | <?php \_e('Display Name', 'wp-register-profile-with-shortcode');?> |
  | 52 | 53 | </label> |
  | 53 |  | <input type="text" name="display\_name" value="<?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['display\_name']);~~?>" <?php echo $wprp\_p->is\_field\_required('is\_displayname\_required');?> title="<?php \_e('Please enter display name','wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('Display Name','wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_display\_name\_field'~~ );?>/> |
  |  | 54 | <input type="text" name="display\_name" value="<?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['display\_name']); ?>" <?php echo $wprp\_p->is\_field\_required('is\_displayname\_required'); ?> title="<?php \_e('Please enter display name', 'wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('Display Name', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_display\_name\_field');?>/> |
  | 54 | 55 | </div> |
  | 55 |  | <?php }?> |
  | 56 |  | <?php if~~($wprp\_p->is\_field\_enabled('userdescription\_in\_registration')){~~ ?> |
  |  | 56 | <?php }?> |
  |  | 57 | <?php if ($wprp\_p->is\_field\_enabled('userdescription\_in\_registration')) {?> |
  | 57 | 58 | <div class="reg-form-group"> |
  | 58 | 59 | <label for="aboutuser"> |
  | 59 |  | <?php \_e('About User','wp-register-profile-with-shortcode');?> |
  |  | 60 | <?php \_e('About User', 'wp-register-profile-with-shortcode');?> |
  | 60 | 61 | </label> |
  | 61 |  | <textarea name="description" <?php echo $wprp\_p->is\_field\_required('is\_userdescription\_required');~~?> title="<?php \_e('Please enter about','wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_description\_field' );?>><?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['description']);~~?></textarea> |
  |  | 62 | <textarea name="description" <?php echo $wprp\_p->is\_field\_required('is\_userdescription\_required'); ?> title="<?php \_e('Please enter about', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_description\_field');?>><?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['description']); ?></textarea> |
  | 62 | 63 | </div> |
  | 63 |  | <?php }?> |
  | 64 |  | <?php if~~($wprp\_p->is\_field\_enabled('userurl\_in\_registration')){~~ ?> |
  |  | 64 | <?php }?> |
  |  | 65 | <?php if ($wprp\_p->is\_field\_enabled('userurl\_in\_registration')) {?> |
  | 65 | 66 | <div class="reg-form-group"> |
  | 66 | 67 | <label for="website"> |
  | 67 |  | <?php \_e('Website','wp-register-profile-with-shortcode');?> |
  |  | 68 | <?php \_e('Website', 'wp-register-profile-with-shortcode');?> |
  | 68 | 69 | </label> |
  | 69 |  | <input type="url" name="user\_url" value="<?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['user\_url']);~~?>" <?php echo $wprp\_p->is\_field\_required('is\_userurl\_required');?> title="<?php \_e('Please enter website url','wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('Website','wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_user\_url\_field'~~ );?>/> |
  |  | 70 | <input type="url" name="user\_url" value="<?php echo sanitize\_text\_field(@$\_SESSION['wp\_register\_temp\_data']['user\_url']); ?>" <?php echo $wprp\_p->is\_field\_required('is\_userurl\_required'); ?> title="<?php \_e('Please enter website url', 'wp-register-profile-with-shortcode');?>" placeholder="<?php \_e('Website', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_user\_url\_field');?>/> |
  | 70 | 71 | </div> |
  | 71 |  | <?php }?> |
  | 72 |  | <?php do\_action('wp\_register\_profile\_subscription');?> |
  | 73 |  | <?php if~~($wprp\_p->is\_field\_enabled('captcha\_in\_registration')){~~ ?> |
  |  | 72 | <?php }?> |
  |  | 73 | <?php do\_action('wp\_register\_profile\_subscription');?> |
  |  | 74 | <?php if ($wprp\_p->is\_field\_enabled('captcha\_in\_registration')) {?> |
  | 74 | 75 | <div class="reg-form-group"> |
  | 75 | 76 | <label for="captcha"> |
  | 76 |  | <?php \_e('Captcha','wp-register-profile-with-shortcode');?> |
  |  | 77 | <?php \_e('Captcha', 'wp-register-profile-with-shortcode');?> |
  | 77 | 78 | </label> |
  | 78 | 79 | <?php $this->captcha\_image();?> |
  | 79 |  | <input type="text" name="user\_captcha" autocomplete="off" required title="<?php \_e('Please enter captcha',~~'wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_user\_captcha\_field'~~ );?>/> |
  |  | 80 | <input type="text" name="user\_captcha" autocomplete="off" required title="<?php \_e('Please enter captcha', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_user\_captcha\_field');?>/> |
  | 80 | 81 | </div> |
  | 81 |  | <?php }?> |
  | 82 |  | <?php $default\_registration\_form\_hooks == 'Yes'~~?do\_action('register\_form'):~~'';?> |
  |  | 82 | <?php }?> |
  |  | 83 | <?php $default\_registration\_form\_hooks == 'Yes' ? do\_action('register\_form') : '';?> |
  | 83 | 84 | <?php do\_action('wp\_register\_profile\_form');?> |
  | 84 | 85 | <div class="reg-form-group"> |
  | 85 |  | <input name="register" type="submit" value="<?php \_e('Register',~~'wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_register\_form\_submit\_tag'~~ );?>/> |
  |  | 86 | <input name="register" type="submit" value="<?php \_e('Register', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_register\_form\_submit\_tag');?>/> |
  | 86 | 87 | </div> |
  | 87 | 88 | </form> |
* ## [wp-register-profile-with-shortcode/trunk/view/frontend/update-password.php](/changeset/3018102/wp-register-profile-with-shortcode/trunk/view/frontend/update-password.php "Show the changeset 3018102 restricted to wp-register-profile-with-shortcode/trunk/view/frontend/update-password.php")

  | [r2379514](/browser/wp-register-profile-with-shortcode/trunk/view/frontend/update-password.php?rev=2379514#L1 "Show revision 2379514 of this file in browser") | [r3018102](/browser/wp-register-profile-with-shortcode/trunk/view/frontend/update-password.php?rev=3018102#L1 "Show revision 3018102 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <form name="update-password" id="update-password" method="post" action="" <?php do\_action('wprp\_update\_pass\_form\_tag');?>> |
  | 2 | 2 | <input type="hidden" name="option" value="rpws\_user\_update\_password" /> |
  | 3 |  | <input type="hidden" name="redirect" value="<?php echo sanitize\_text\_field( Register\_Process::curPageURL() ); ?>"> |
  |  | 3 | <input type="hidden" name="redirect" value="<?php echo sanitize\_text\_field(Register\_Process::curPageURL()); ?>"> |
  |  | 4 | <?php wp\_nonce\_field('wprp\_action', 'wprp\_5q5rt78');?> |
  | 4 | 5 | <div class="reg-form-group"> |
  | 5 | 6 | <label for="name"> |
  | 6 |  | <?php \_e('New Password','wp-register-profile-with-shortcode');?> |
  |  | 7 | <?php \_e('New Password', 'wp-register-profile-with-shortcode');?> |
  | 7 | 8 | </label> |
  | 8 |  | <input type="password" name="user\_new\_password" required title="<?php \_e('Please enter password',~~'wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_update\_pass\_user\_new\_password\_field'~~ );?>/> |
  |  | 9 | <input type="password" name="user\_new\_password" required title="<?php \_e('Please enter password', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_update\_pass\_user\_new\_password\_field');?>/> |
  | 9 | 10 | </div> |
  | 10 | 11 | <div class="reg-form-group"> |
  | 11 | 12 | <label for="name"> |
  | 12 |  | <?php \_e('Retype Password','wp-register-profile-with-shortcode');?> |
  |  | 13 | <?php \_e('Retype Password', 'wp-register-profile-with-shortcode');?> |
  | 13 | 14 | </label> |
  | 14 |  | <input type="password" name="user\_retype\_password" required title="<?php \_e('Please re-enter password',~~'wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_update\_pass\_user\_retype\_password\_field'~~ );?>/> |
  |  | 15 | <input type="password" name="user\_retype\_password" required title="<?php \_e('Please re-enter password', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_update\_pass\_user\_retype\_password\_field');?>/> |
  | 15 | 16 | </div> |
  | 16 | 17 | <div class="reg-form-group"> |
  | 17 |  | <input name="profile" type="submit" value="<?php \_e('Update',~~'wp-register-profile-with-shortcode');?>" <?php do\_action( 'wprp\_update\_pass\_form\_submit\_tag'~~ );?>/> |
  |  | 18 | <input name="profile" type="submit" value="<?php \_e('Update', 'wp-register-profile-with-shortcode');?>" <?php do\_action('wprp\_update\_pass\_form\_submit\_tag');?>/> |
  | 18 | 19 | </div> |
  | 19 | 20 | </form> |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3018102)
* [Zip Archive](?format=zip&new=3018102)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_c29ddcdb_20250114_180938.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# WP Register Profile With Shortcode <= 3.5.9 - Cross-Site Request Forgery to User Password Reset

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   WP Register Profile With Shortcode <= 3.5.9 - Cross-Site Request Forgery to User Password Reset

8.8

**Cross-Site Request Forgery (CSRF)**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

| CVE | [CVE-2023-5448](https://www.cve.org/CVERecord?id=CVE-2023-5448) |
| --- | --- |
| CVSS | 8.8 (High) |
| Publicly Published | January 10, 2024 |
| Last Updated | January 22, 2024 |
| Researcher | [Dmitrii Ignatyev - CleanTalk Inc](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/dmitrii) |

### Description

The WP Register Profile With Shortcode plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 3.5.9. This is due to missing or incorrect nonce validation on the update\_password\_validate function. This makes it possible for unauthenticated attackers to reset a user's password via a forged request granted they can trick the user into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3018102)
* [research.cleantalk.org](https://research.cleantalk.org/cve-2023-5448-wp-register-profile-with-shortcode-csrf-to-password-reset-poc/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-register-profile-with-shortcode%2Fwp-register-profile-with-shortcode-359-cross-site-request-forgery-to-user-password-reset&t=WP%20Register%20Profile%20With%20Shortcode%20%3C%3D%203.5.9%20-%20Cross-Site%20Request%20Forgery%20to%20User%20Password%20Reset "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-register-profile-with-shortcode%2Fwp-register-profile-with-shortcode-359-cross-site-request-forgery-to-user-password-reset&text=WP%20Register%20Profile%20With%20Shortcode%20%3C%3D%203.5.9%20-%20Cross-Site%20Request%20Forgery%20to%20User%20Password%20Reset "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-register-profile-with-shortcode%2Fwp-register-profile-with-shortcode-359-cross-site-request-forgery-to-user-password-reset "LinkedIn")
Email

## Vulnerability Details for WP Register Profile With Shortcode

#### [WP Register Profile With Shortcode](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wp-register-profile-with-shortcode)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wp-register-profile-with-shortcode [(view on wordpress.org)](https://wordpress.org/plugins/wp-register-profile-with-shortcode) |
| Patched? | Yes |
| Remediation | Update to version 3.6.0, or a newer patched version |
| Affected Version | * <= 3.5.9 |
| Patched Version | * 3.6.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


