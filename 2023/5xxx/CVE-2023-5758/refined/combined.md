=== Content from bugzilla.mozilla.org_ecd77645_20250115_102630.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1850019)
* [XML](/show_bug.cgi?ctype=xml&id=1850019)

Closed
[Bug 1850019](/show_bug.cgi?id=1850019)
(CVE-2023-5758)

Opened 1 year ago
Closed 1 year ago

# XSS on the domain reader in the firefox browser application for IOS

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

XSS on the domain reader in the firefox browser application for IOS

## Categories

### (Firefox for iOS :: General, defect)

[Product:](/describecomponents.cgi?product=Firefox%20for%20iOS)

Firefox for iOS
▾

Firefox for iOS
Firefox for iOS is the Firefox mobile experience developed for the iOS platform.
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20for%20iOS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20for%20iOS)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20for%20iOS&component=General#General)

General
▾

Firefox for iOS :: General
For bugs that don't fit into other components.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20for%20iOS&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

iOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| fxios | [119](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=119) | --- |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | 119 |  |

## People

### (Reporter: hackerone3117, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/55ce097ef86e17468e0f3b4092cb58fa?d=mm&size=40)  [hackerone3117](/user_profile?user_id=695571)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/481f85b35d45ebad6d41f98cae68ccbf?d=mm&size=40)  [jeevans](/user_profile?user_id=654438)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

### ( [URL](http://localhost:6571/reader-mode/page?url=javascript:alert(document.domain) "http://localhost:6571/reader-mode/page?url=javascript:alert(document.domain)") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[localhost:6571/reader-mode/page?url=j...](http://localhost:6571/reader-mode/page?url=javascript:alert(document.domain) "http://localhost:6571/reader-mode/page?url=javascript:alert(document.domain)")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[github.com/mozilla-mobile/firefox-ios...](https://github.com/mozilla-mobile/firefox-ios/pull/16345 "https://github.com/mozilla-mobile/firefox-ios/pull/16345")

## Details

### (Keywords: reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-5758

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a4675211_1689 "1 year ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [advisory.txt](/attachment.cgi?id=9360075)  [1 year ago](#c23)  [lmarceau](/user_profile?user_id=694570)   207 bytes, text/plain |  | [Details](/attachment.cgi?id=9360075&action=edit) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1850019#c0)• 1 year ago |
|  | |

Hi team.

As explained in <https://hackerone.com/reports/2117521>, I will be moving a vulnerability issue in an IOS app, which should be reported on the bugzilla form.

I found XSS in the Reader mode feature on the Firefox for IOS application, maybe this is also affected on Android.

I see that the domain of the reader feature is <http://localhost:6571>,

You can see the domain reader when opening <https://hackerone.com/irwanjugabro>, and the reader detects "connections is not secure" when you use the reader feature.

production steps:

1. download the firefox browser for IOS
2. then open the domain from the following reader features:

* <http://localhost:6571/reader-mode/page?url=javascript:alert(document.domain)>

3. after that, then click on the reader mode feature, then XSS will be triggered, because the redirect url that has been set to be javascript:alert(1)

# Impact

XSS on the domain reader in the firefox browser application for IOS

Flags: sec-bounty?

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850019#a66_691597)• 1 year ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → Firefox for iOS

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1850019#c1)• 1 year ago |
|  | |

POC VIDEOS :

* <https://drive.google.com/file/d/1cYGnZnHf4MDa-wGVBrfnc9aVtpzgjblp/view?usp=sharing>
Group: mobile-core-security → firefox-core-securityComponent: General → SecurityProduct: Firefox for iOS → Firefox

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850019#a1986_349244)• 1 year ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → Firefox for iOS

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1850019#c2)• 1 year ago |
|  | |

Hi all any update for this problem?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850019#a542975_1689)• 1 year ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1850019#c4)• 1 year ago |
|  | |

reader mode should have an allow-list of safe schemes and reject anything else. Ideally just http and https.

Flags: needinfo?(lmarceau)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1850019#c5)• 1 year ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #4](/show_bug.cgi?id=1850019#c4 "VERIFIED FIXED - XSS on the domain reader in the firefox browser application for IOS"))

> reader mode should have an allow-list of safe schemes and reject anything else. Ideally just http and https.

FWIW there's already an allowlist on desktop, and it allows http/https and local files: <https://searchfox.org/mozilla-central/rev/a7e33b7f61e7729e2b1051d2a7a27799f11a5de6/toolkit/components/reader/AboutReader.sys.mjs#50-62>

I imagine on iOS the local file option isn't realistic.

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850019#a1042959_694570)• 1 year ago |

Flags: needinfo?(lmarceau)

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1850019#c6)• 1 year ago |
|  | |

Tracking progress on this issue with JIRA ticket <https://mozilla-hub.atlassian.net/browse/FXIOS-7330>

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1850019#c7)• 1 year ago |
|  | |

I see the issue on Firefox iOS side where we are checking `scheme == "http" && host == "localhost" && path == "/reader-mode/page"` which isn't enough to stop attack like above. I was able to run the following on the url(s) to test some benign changes and they sure seem to interfere with the page.

<http://localhost:6571/reader-mode/page?url=javascript:document.body.style.display='none>';

<http://localhost:6571/reader-mode/page?url=javascript:document.body.innerText='Hello>';

<http://localhost:6571/reader-mode/page?url=javascript:document.body.style.fontSize='50px>';

**Regarding the fix and reference**

The fix involves checking the url and to not allow direct injection and instead sanitize the url or just straight up not accept it.

Best option would be mix of both.

a) Do not accept any harmful urls

b) Sanitize strings using our htmlEntityEncodedString method before sending it to reader mode

Added some references on where loading of the url happens, will investigate further if I find anything new.

\*\* Reference links \*\*

*enableReaderMode*: <https://github.com/mozilla-mobile/firefox-ios/blob/main/Client/Frontend/Browser/BrowserViewController/BrowserViewController%2BReaderMode.swift#L123>

*disableReaderMode*: <https://github.com/mozilla-mobile/firefox-ios/blob/main/Client/Frontend/Browser/BrowserViewController/BrowserViewController%2BReaderMode.swift#L151>

*isReaderModeURL*: <https://github.com/mozilla-mobile/firefox-ios/blob/main/Shared/Extensions/URLExtensions.swift#L290>

*htmlEntityEncodedString*: <https://github.com/mozilla-mobile/firefox-ios/blob/main/Shared/Extensions/String%2BExtension.swift#L137>

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1850019#c8)• 1 year ago |
|  | |

Made a PR with potential FIX: `https://github.com/mozilla-mobile/firefox-ios/pull/16345`

Will be on the look out for any more areas of sanitization

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1850019#c9)• 1 year ago |
|  | |

(In reply to Nishant Bhasin from [comment #8](/show_bug.cgi?id=1850019#c8 "VERIFIED FIXED - XSS on the domain reader in the firefox browser application for IOS"))

> Made a PR with potential FIX: `https://github.com/mozilla-mobile/firefox-ios/pull/16345`
>
> Will be on the look out for any more areas of sanitization

Sorry, I was on PTO for this.

I'm pretty concerned by this fix. Unfortunately I cannot test it because I don't have an iDevice. AFAICT this tries to break the XSS by escaping quotes, which `htmlEntityEncodedString` [happens to do](https://github.com/mozilla-mobile/firefox-ios/blob/b54069544e0f32efa4e528dc1a2ea49a6a46690c/Shared/Extensions/String%2BExtension.swift#L137-L146). But there is no particular reason that the JS URL would need to use quotes at all, and escaping those quotes doesn't do anything to break opening the JS URL, only JS URLs that happen to use quotes. In fact, even [comment 0](/show_bug.cgi?id=1850019#c0 "VERIFIED FIXED - XSS on the domain reader in the firefox browser application for IOS") has an example (using `alert(document.domain)`) that doesn't use quotes.

I don't see any changes in the patch that ensure that the scheme/protocol used for the `url` param is one of a safelist. Was there some reason not to go with this approach, and limit the pages on which reader mode can be invoked to `http` and `https` ones, thus avoiding this problem completely?

Flags: needinfo?(nish.bhasin)

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1850019#c10)• 1 year ago |
|  | |

Apologies for late reply as I was on PTO as well.

Reader mode runs on localhost and unfortunately with the current implementation we cannot simply stop users from accessing reader mode localhost urls and only stick to http / https. The issue isn't that reader mode is accessed from localhost. The issue is that the button pressed again for reader mode injects html / js.

With the above PR the idea isn't to not allow JS but to sanitize it so even if something does get injected it has no effect on the actual page. Its also the fact the the url isn't where this is happening but is actually happening inside a query param. The fix won't allow for a url to even load.

`http://localhost:6571/reader-mode/page?url=javascript:alert(document.domain)` will fail to even load with the fix mentioned above, it has been tested.

Ideally we should scrap this reader mode in favour of the one that Desktop uses but I won't go into those details as its much larger discussion and a bigger project. However let me know if there is a case that above PR missed.

Happy to further discuss this in detail.

Flags: needinfo?(nish.bhasin)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1850019#c11)• 1 year ago |
|  | |

I had a conversation with Nishant about the patch. I am reassured that it does reject all JS URLs passed to reader mode, so I think for the purposes of this bug we're all good. I was confused about what the tests are testing (primarily the escaping) vs. what the implementation actually ends up doing (rejecting URLs without a `host`, which includes all JS URLs).

In terms of defence in depth, I do still think it would be good to have an allowlist of valid schemes for the `url` param (ie enforce that scheme is either `http` or `https`), but that could happen as a follow-up / separate ticket.

At this point, should this bug be closed and marked as fixed in 119? :-)

Flags: needinfo?(nish.bhasin)

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1850019#c12)• 1 year ago |
|  | |

Hi all.

just asking, more than 1 months have passed, is there any update on this issue?

Thank you

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1850019#c13)• 1 year ago |
|  | |

I marked this bug QA needed. Once that's done then the bug will be closed and we'll create sec advisories for v119.

Flags: needinfo?(nish.bhasin)

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1850019#c14)• 1 year ago |
|  | |

Verified as fixed on v119 (34997) with iPhone 13 Pro (15.7.1.)

Please note that I tried on an older version to figure out or to see if I'm able to reproduce this issue like it was mentioned in the description or the video attached.

So on the **v118** version (more than 1 month old build) I tried the following:

* Open FF for iOS
* Open the domain from the following reader features:

  <http://localhost:6571/reader-mode/page?url=javascript:alert(document.domain)>
* after that, click on the reader mode feature, then XSS will be triggered because the redirect URL has been set to be javascript:alert(1)

  So after those steps when I tap on the Reader mode I have: Open this link in external app? (javascript:alert(document.domain).

  So like this, I was able to reproduce the issue.

When I tried on **v119 (34997)** where the fix is made - after repeating the steps from above when tapping on the `reader mode` nothing happened and the webpage just enter or leave the reader mode state. Nothing regarding `javascript:alert(document.domain) or anything related to that.

Can you please confirm this is the correct verification or do I need to check something more? @Irwan, @Nish

Please note that after this I will add a simply verification comment on the Jira ticket as it's a security issue and I will not add anything related to this on the Jira.

Flags: needinfo?(nish.bhasin)Flags: needinfo?(irwantni5)

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1850019#c15)• 1 year ago |
|  | |

Hi, thanks for tagging me here.

I think your retest is perfect on v119,

I can't try the restest on v119 because that version hasn't been released to the public yet, so I can't download it.

Cheers

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1850019#c16)• 1 year ago |
|  | |

Awesome, thank you for the fast response Irwan!

Then based on your comment, I can close this issue and also the Jira one, this means that next week we will have the RC week, and on the 24 October the build will be released and you will be able to double-check it at that time too.

Status: UNCONFIRMED → RESOLVEDClosed: 1 year agoFlags: needinfo?(nish.bhasin)Flags: needinfo?(irwantni5)Resolution: --- → FIXED

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850019#a4226430_616105)• 1 year ago |

Status: RESOLVED → VERIFIED
[tracking-fxios](/buglist.cgi?f1=cf_tracking_fxios&o1=isnotempty):
--- → [119](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=119)OS: Unspecified → iOS

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1850019#c17)• 1 year ago |
|  | |

Hi @andrei

thank you for your reply.

As we know that you have closed this ticket to be resolved, just ask if this problem is worth getting a bounty.

Once again, thank you.

Cheers

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1850019#c18)• 1 year ago |
|  | |

:irwan For bounty, developers are not the persons to take those decisions, so we can't answer this particular question. You should write at security@mozilla.org to contact the bug bounty team. The bug has the correct flags to be looked at by the bounty team now that it has been resolved, so they'll be able to answer you on this matter. Thank you!

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1850019#c19)• 1 year ago |
|  | |

Hi @lmarceau, thanks for the follow up.

I'm sorry I don't understand that, I will try to send it to the intended email as stated.

Kind regards

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1850019#c20)• 1 year ago |
|  | |

> I imagine on iOS [needing to use] the local file: option isn't realistic.
>
> ...
>
> the implementation actually ends up [...] rejecting URLs without a host, which includes all JS URLs

That rule would reject file:/// URLs also, because they don't have a host. We ended up needing to allow file:/// urls on Android; are you sure you won't need them on iOS? It came up when documents were shared with Firefox from another app. In some cases a file would be downloaded in the other app. Sharing them moved or copied them into a place Firefox for Android could read and the OS gave us a file:/// URL pointing to it. A particularly common case this came up in was when Fenix added support for being a PDF-handler, although it came up sometimes prior to that if an app downloaded or generated a local media file.

Apple being Apple it's quite possible sharing is done through an OS API with richer options and no need for a lowly file:/// URL.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850019#a4318036_75935)• 1 year ago |

Group: mobile-core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1850019#c21)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1850019&comment_id=16627473 "1 revision") |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

Nevermind: skimmed over [comment 8](/show_bug.cgi?id=1850019#c8 "VERIFIED FIXED - XSS on the domain reader in the firefox browser application for IOS") because I didn't notice the non-linkified URL

~~(In reply to :Gijs (he/him) from comment #11)~~

~~> I had a conversation with Nishant about the patch.~~

~~Where ***is*** the patch? It's not in this bug and there's no Jira issue or github PR linked in this bug's "see also" section~~

Flags: needinfo?(hackerone3117)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850019#a4675113_1689)• 1 year ago |

Flags: needinfo?(hackerone3117)See Also: → <https://github.com/mozilla-mobile/firefox-ios/pull/16345>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850019#a4675211_1689)• 1 year ago |

Flags: sec-bounty? → sec-bounty+

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1850019#c22)• 1 year ago |
|  | |

Hi everyone.

thank you for the bounty.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850019#a5282681_578488)• 1 year ago |

Alias: CVE-2023-5758

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1850019#c23)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9360075)
— [Details](attachment.cgi?id=9360075&action=edit)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850019#a24200983_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850019#a33578398_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1850019&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [lmarceau](/user_profile?user_id=694570)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from security.gentoo.org_897e22ca_20250115_102630.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_6f21d047_20250115_102632.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-48

## Security Vulnerabilities fixed in Firefox for iOS 119

Announced
October 24, 2023
Impact
high
Products
Firefox for iOS
Fixed in

* Firefox for iOS 119

#### [#CVE-2023-5758: Cross-Site Scripting (XSS) in reader mode](#CVE-2023-5758)

Reporter
Irwan
Impact
high
##### Description

When opening a page in reader mode, the redirect URL could have caused attacker-controlled script to execute in a reflected Cross-Site Scripting (XSS) attack.

##### References

* [Bug 1850019](https://bugzilla.mozilla.org/show_bug.cgi?id=1850019)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


