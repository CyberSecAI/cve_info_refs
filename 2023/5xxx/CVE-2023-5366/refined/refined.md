```
**CVE-2023-5366**

**Root cause of vulnerability:**
The vulnerability stems from a discrepancy between the OpenFlow specification and datapath implementations in Open vSwitch. The OpenFlow spec only requires matching on ICMPv6 type (135 or 136) for Neighbor Discovery target addresses, while datapath implementations also require ICMPv6 code to be zero for a packet to have a valid target address option. This discrepancy leads to overly broad datapath flows which can cause the match on the target address to be ignored.

**Weaknesses/vulnerabilities present:**
- OpenFlow rules with a match on the Neighbor Discovery (nd\_target) IPv6 packets without also matching on ICMPv6 Code (icmp_code or icmpv6_code) field being zero can be bypassed.
- The implementation doesn't properly enforce the requirement that ICMPv6 code must be 0 for the target address to be valid in Neighbor Discovery packets.

**Impact of exploitation:**
- A local attacker can create specially crafted ICMPv6 Neighbor Advertisement packets with modified or spoofed target IP addresses.
- This could allow a malicious actor to redirect ICMPv6 traffic to arbitrary IP addresses, bypassing intended OpenFlow rules and potentially causing a denial of service or other network disruption.
- The vulnerability is particularly concerning where OpenFlow rules are used to provide Neighbor Discovery anti-spoofing protection.

**Attack vectors:**
- The vulnerability is triggered by sending ICMPv6 Neighbor Solicitation or Neighbor Advertisement packets with modified or spoofed target IP addresses to a vulnerable Open vSwitch instance.
- The timing of these packets might also play a factor.

**Required attacker capabilities/position:**
- Local access to a network where a vulnerable Open vSwitch instance is operating.
- The ability to craft and send ICMPv6 Neighbor Advertisement packets.
- Knowledge of the OpenFlow rules configured in the switch.
```