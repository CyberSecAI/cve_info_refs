Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2023-5467

**Vulnerability:** Stored Cross-Site Scripting (XSS)

**Root Cause:** The vulnerability stems from insufficient input sanitization and output escaping of user-supplied attributes within the `GMW_Single_Location` class, particularly within the `__construct` method when processing shortcode attributes. This allows an attacker to inject malicious web scripts through shortcodes.

**Weaknesses/Vulnerabilities Present:**
*   **Improper Input Sanitization:** The plugin fails to properly sanitize user-provided shortcode attributes.
*   **Insufficient Output Escaping:** The plugin does not adequately escape output, leading to the execution of injected scripts in the user's browser.
*   **Lack of Context-Aware Output Encoding:** The plugin doesn't encode the output based on the context (e.g., HTML, Javascript), making it vulnerable to XSS.
*   **Use of `str_replace` for sanitization:** The plugin attempts to remove potentially malicious characters using `str_replace` function which is not a reliable method to sanitize inputs against XSS attacks.

**Impact of Exploitation:**
*   **Arbitrary Script Execution:** Successful exploitation allows attackers to execute arbitrary JavaScript code within the context of a user's browser when they visit a page containing the malicious shortcode.
*   **Account Takeover:** Attackers can potentially steal cookies, session tokens, or other sensitive information to hijack user accounts.
*   **Malicious Redirects:** Redirect users to malicious websites to perform phishing or other malicious activities
*   **Website Defacement:** Manipulate page content to deface the website.
*   **Data theft**: Steal or modify sensitive data displayed on pages.

**Attack Vectors:**
*   **Shortcodes:** Attackers inject malicious scripts through shortcodes by using the `gmw_single_location` shortcode and passing malicious parameters (e.g., via the 'css_id', 'css_class', etc attributes)
*   **Authenticated Users:** The vulnerability is exploitable by authenticated users with "contributor" level and higher permissions, enabling them to create or edit posts and pages containing the malicious shortcodes.

**Required Attacker Capabilities/Position:**
*   **WordPress Account:** Attackers need an account on the WordPress site with at least "contributor" level permissions, which allows for creating and editing posts or pages.
*   **Shortcode Usage:** Attackers need to be able to use the vulnerable shortcode, typically by embedding it in the post content.

**Additional Information:**

*   The vulnerable code snippets are in the `class-gmw-single-location.php` file specifically within the `__construct` method.
*   The vulnerability is present in GEO my WordPress plugin versions up to and including 4.0.
*   The patched version is 4.0.1, which includes fixes for the XSS vulnerability
*   The vulnerability can be triggered when rendering a page containing a crafted `gmw_single_location` shortcode.

In summary, this is a medium-severity stored XSS vulnerability that allows authenticated contributors or higher-level users to inject malicious scripts into a WordPress site via the Geo my WP plugin's shortcode functionality.