=== Content from www.mozilla.org_1b4e5f4d_20250114_211925.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-42

## Security Vulnerabilities fixed in Firefox ESR 115.3

Announced
September 26, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.3

#### [#CVE-2023-5168: Out-of-bounds write in FilterNodeD2D1](#CVE-2023-5168)

Reporter
sonakkbi
Impact
high
##### Description

A compromised content process could have provided malicious data to `FilterNodeD2D1` resulting in an out-of-bounds write, leading to a potentially exploitable crash in a privileged process.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1846683](https://bugzilla.mozilla.org/show_bug.cgi?id=1846683)

#### [#CVE-2023-5169: Out-of-bounds write in PathOps](#CVE-2023-5169)

Reporter
sonakkbi
Impact
high
##### Description

A compromised content process could have provided malicious data in a `PathRecording` resulting in an out-of-bounds write, leading to a potentially exploitable crash in a privileged process.

##### References

* [Bug 1846685](https://bugzilla.mozilla.org/show_bug.cgi?id=1846685)

#### [#CVE-2023-5171: Use-after-free in Ion Compiler](#CVE-2023-5171)

Reporter
Lukas Bernhard
Impact
high
##### Description

During Ion compilation, a Garbage Collection could have resulted in a use-after-free condition, allowing an attacker to write two NUL bytes, and cause a potentially exploitable crash.

##### References

* [Bug 1851599](https://bugzilla.mozilla.org/show_bug.cgi?id=1851599)

#### [#CVE-2023-5174: Double-free in process spawning on Windows](#CVE-2023-5174)

Reporter
Ronald Crane
Impact
moderate
##### Description

If Windows failed to duplicate a handle during process creation, the sandbox code may have inadvertently freed a pointer twice, resulting in a use-after-free and a potentially exploitable crash.
*This bug only affects Firefox on Windows when run in non-standard configurations (such as using `runas`). Other operating systems are unaffected.*

##### References

* [Bug 1848454](https://bugzilla.mozilla.org/show_bug.cgi?id=1848454)

#### [#CVE-2023-5176: Memory safety bugs fixed in Firefox 118, Firefox ESR 115.3, and Thunderbird 115.3](#CVE-2023-5176)

Reporter
Chris Peterson, Andrew McCreight, André Bargull, Nika Layzell and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 118, Firefox ESR 115.3, and Thunderbird 115.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1836353%2C1842674%2C1843824%2C1843962%2C1848890%2C1850180%2C1850983%2C1851195)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_f0f8a38e_20250114_211924.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-41

## Security Vulnerabilities fixed in Firefox 118

Announced
September 26, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 118

#### [#CVE-2023-5168: Out-of-bounds write in FilterNodeD2D1](#CVE-2023-5168)

Reporter
sonakkbi
Impact
high
##### Description

A compromised content process could have provided malicious data to `FilterNodeD2D1` resulting in an out-of-bounds write, leading to a potentially exploitable crash in a privileged process.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1846683](https://bugzilla.mozilla.org/show_bug.cgi?id=1846683)

#### [#CVE-2023-5169: Out-of-bounds write in PathOps](#CVE-2023-5169)

Reporter
sonakkbi
Impact
high
##### Description

A compromised content process could have provided malicious data in a `PathRecording` resulting in an out-of-bounds write, leading to a potentially exploitable crash in a privileged process.

##### References

* [Bug 1846685](https://bugzilla.mozilla.org/show_bug.cgi?id=1846685)

#### [#CVE-2023-5170: Memory leak from a privileged process](#CVE-2023-5170)

Reporter
sonakkbi
Impact
high
##### Description

In canvas rendering, a compromised content process could have caused a surface to change unexpectedly, leading to a memory leak of a privileged process. This memory leak could be used to effect a sandbox escape if the correct data was leaked.

##### References

* [Bug 1846686](https://bugzilla.mozilla.org/show_bug.cgi?id=1846686)

#### [#CVE-2023-5171: Use-after-free in Ion Compiler](#CVE-2023-5171)

Reporter
Lukas Bernhard
Impact
high
##### Description

During Ion compilation, a Garbage Collection could have resulted in a use-after-free condition, allowing an attacker to write two NUL bytes, and cause a potentially exploitable crash.

##### References

* [Bug 1851599](https://bugzilla.mozilla.org/show_bug.cgi?id=1851599)

#### [#CVE-2023-5172: Memory Corruption in Ion Hints](#CVE-2023-5172)

Reporter
Mozilla Fuzzing Team
Impact
high
##### Description

A hashtable in the Ion Engine could have been mutated while there was a live interior reference, leading to a potential use-after-free and exploitable crash.

##### References

* [Bug 1852218](https://bugzilla.mozilla.org/show_bug.cgi?id=1852218)

#### [#CVE-2023-5173: Out-of-bounds write in HTTP Alternate Services](#CVE-2023-5173)

Reporter
Ronald Crane
Impact
moderate
##### Description

In a non-standard configuration of Firefox, an integer overflow could have occurred based on network traffic (possibly under influence of a local unprivileged webpage), leading to an out-of-bounds write to privileged process memory.
*This bug only affects Firefox if a non-standard preference allowing non-HTTPS Alternate Services (`network.http.altsvc.oe`) is enabled.*

##### References

* [Bug 1823172](https://bugzilla.mozilla.org/show_bug.cgi?id=1823172)

#### [#CVE-2023-5174: Double-free in process spawning on Windows](#CVE-2023-5174)

Reporter
Ronald Crane
Impact
moderate
##### Description

If Windows failed to duplicate a handle during process creation, the sandbox code may have inadvertently freed a pointer twice, resulting in a use-after-free and a potentially exploitable crash.
*This bug only affects Firefox on Windows when run in non-standard configurations (such as using `runas`). Other operating systems are unaffected.*

##### References

* [Bug 1848454](https://bugzilla.mozilla.org/show_bug.cgi?id=1848454)

#### [#CVE-2023-5175: Use-after-free of ImageBitmap during process shutdown](#CVE-2023-5175)

Reporter
Yangkang of 360 ATA Team
Impact
low
##### Description

During process shutdown, it was possible that an `ImageBitmap` was created that would later be used after being freed from a different codepath, leading to a potentially exploitable crash.

##### References

* [Bug 1849704](https://bugzilla.mozilla.org/show_bug.cgi?id=1849704)

#### [#CVE-2023-5176: Memory safety bugs fixed in Firefox 118, Firefox ESR 115.3, and Thunderbird 115.3](#CVE-2023-5176)

Reporter
Chris Peterson, Andrew McCreight, André Bargull, Nika Layzell and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 118, Firefox ESR 115.3, and Thunderbird 115.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1836353%2C1842674%2C1843824%2C1843962%2C1848890%2C1850180%2C1850983%2C1851195)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_2540fd0c_20250114_211923.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1848454)
* [XML](/show_bug.cgi?ctype=xml&id=1848454)

Closed
[Bug 1848454](/show_bug.cgi?id=1848454)
(CVE-2023-5174)

Opened 1 year ago
Closed 1 year ago

# Double-delete UAF in BrokerServicesBase::SpawnTarget()

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Double-delete UAF in BrokerServicesBase::SpawnTarget()

## Categories

### (Core :: Security: Process Sandboxing, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Security%3A%20Process%20Sandboxing#Security%3A%20Process%20Sandboxing)

Security: Process Sandboxing
▾

Core :: Security: Process Sandboxing
For process sandboxing bugs. Generally this covers code under the security/sandbox/ source directory, but there is code elsewhere to hook the different platform process sandboxes into Gecko etc.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Security%3A%20Process%20Sandboxing&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Security%3A%20Process%20Sandboxing&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Security%3A%20Process%20Sandboxing)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 116

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

118 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox-esr115 | [118+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=118%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox116 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix) |
| firefox117 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix) |
| firefox118 | [+](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | 118+ | fixed |
| firefox-esr128 | --- | --- |
| firefox116 |  | wontfix |
| firefox117 |  | wontfix |
| firefox118 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mozillabugs, Assigned: bobowen)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/8877ff082c9a902bbf383dc11c1aeffc?d=mm&size=40)  [bobowen](/user_profile?user_id=458623)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d5c63f9bd72a6704ada7f9ca71771d8b?d=mm&size=40)  [mozillabugs](/user_profile?user_id=608633)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/6ad7e6f8a605ca81446ea4c83d819fb2?d=mm&size=40)  [gcp](/user_profile?user_id=151147)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=480639 "https://bugs.chromium.org/p/chromium/issues/detail?id=480639")

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [adv-main118+][adv-esr115.3+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-5174

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main118+][adv-esr115.3+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1536810_1689 "1 year ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a1780490_488993 "1 year ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [test3.cpp](/attachment.cgi?id=9348743)  [1 year ago](#c2)  [mozillabugs](/user_profile?user_id=608633)   1.10 KB, text/plain |  | [Details](/attachment.cgi?id=9348743&action=edit) |
| --- | --- | --- |
| [BadRefcntedPublicDestructorDelete.zip](/attachment.cgi?id=9348919)  [1 year ago](#c6)  [mozillabugs](/user_profile?user_id=608633)   4.09 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9348919&action=edit) |
| [Bug 1848454: Ensure an attempt is made to terminate the child when SpawnTarget fails and there is no job. r=handyman!](/attachment.cgi?id=9349479)  [1 year ago](#c15)  [Bob Owen (:bobowen)](/user_profile?user_id=458623)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115+](#c22 "1 year ago") | [Details](/attachment.cgi?id=9349479&action=edit) | [Review](/attachment.cgi?id=9349479) |
| [advisory.txt](/attachment.cgi?id=9354361)  [1 year ago](#c24)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   416 bytes, text/plain |  | [Details](/attachment.cgi?id=9354361&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1848454#c0)• 1 year ago |
|  | |

`BrokerServicesBase::SpawnTarget()` (`security/sandbox/chromium/sandbox/win/src/broker_services.cc`) can cause a double-delete UAF if Windows cannot duplicate a handle [1]. The bug is in the `!job.IsValid()` case (see lines 662 et seq below). If `AddTargetPeerInternal()` fails (which can occur if the Windows API `DuplicateHandle()` returns error), then `SpawnTarget()` calls `SpawnCleanup(target)`, which does `delete target`. But line 638 in `SpawnTarget()` already called `policy_base->AddTarget(target)`, which adds `target` to `policy_base->targets_`, which is a list of raw pointers. When `policy_base`'s reference count goes to 0, its destructor `PolicyBase::~PolicyBase()` (`security/sandbox/chromium/sandbox/win/src/sandbox_policy_base.cc`) does:

```
   122: TargetSet::iterator it;
   123: for (it = targets_.begin(); it != targets_.end(); ++it) {
   124:    TargetProcess* target = (*it);
   125:    delete target; // BOOM!
   126: }

```

thus causing a double-delete UAF.

```
   423: ResultCode BrokerServicesBase::SpawnTarget(...
   ...
   426:                                            scoped_refptr<TargetPolicy> policy...) {
   ...
   457:   scoped_refptr<PolicyBase> policy_base(static_cast<PolicyBase*>(policy.get()));
   ...
   637:   // Now the policy is the owner of the target.
   638:   result = policy_base->AddTarget(target);
   ...
   646:   if (job.IsValid()) {
   ...
   662:   } else {
   663:     result = AddTargetPeerInternal(process_info.process_handle(),
   664:                                    process_info.process_id(),
   665:                                    policy_base, last_error);
   666:     if (result != SBOX_ALL_OK) {
   667:       // This may fail in the same way as Job associated processes.
   668:       // crbug.com/480639.
   669:       SpawnCleanup(target);
   670:       return result;
   671:     }
   672:   }
   ...
   675:   return result;
   676: }

```
```
   688: ResultCode BrokerServicesBase::AddTargetPeerInternal(
   ...
   695:   HANDLE tmp_process_handle = INVALID_HANDLE_VALUE;
   696:   if (!::DuplicateHandle(::GetCurrentProcess(), peer_process_handle,
   697:                          ::GetCurrentProcess(), &tmp_process_handle,
   698:                          SYNCHRONIZE, false, 0 /*no options*/)) {
   699:     *last_error = ::GetLastError();
   700:     return SBOX_ERROR_CANNOT_DUPLICATE_PROCESS_HANDLE;
   701:   }
   ...
   714: }

```

You can demonstrate the UAF using the debugger. To do so:

1. Start FF and attach a debugger to it.
2. Set a BP on `broker_services.cc` line 663. Also set a BP on `PolicyBase()::~PolicyBase()`
3. Open any webpage in FF.
4. When the line 663 BP fires, step into `AddTargetPeerInternal()`. Simulate an error from `DuplicateHandle()` by skipping lines 696-98, setting control to line 700, setting `*lastError` to `5` (or anything else except `0`, really), and stepping out of the function.
5. Step into `SpawnCleanup()` and notice that it does `delete target`. Note the value of `target` and open a memory window there.
6. Proceed. Eventually the reference count of the object that was pointed to by `policy_base` will reach 0, and something will call `PolicyBase()::~PolicyBase()` in the chrome process.
7. Step the loop and notice that `~PolicyBase()` calls `delete` on the address you noted in step 5, which, of course, the code no longer owns.
8. Step further and watch the mayhem.

Interestingly, `BrokerServicesBase::SpawnTarget()`'s author noticed that this UAF was possible (lines 667-68), but never fixed it.

I will report this bug upstream.

[1] An attacker might be able to cause this situation by, e.g., using a script to do fetches from many URLs concurrently.

Flags: sec-bounty?

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1848454#c1)• 1 year ago |
|  | |

I found this bug after an AST matcher I had written identified the class `sandbox::TargetProcess` (of which `target`, above, is an instance) as (1) being a reference-counted class with a public destructor; and (2) having an instance `delete`ed outside of its `Release()` method. The matcher identified the `delete`s in `SpawnCleanup()` (`broker_services.cc`) and `PolicyBase::~PolicyBase()` (`sandbox_policy_base.cc`) as likely to be problematic, as well as an additional `delete` in `PolicyBase::OnJobEmpty()`.

It was not obvious that these `delete`s were actually problematic, but the following lines from `target_process.h` added to my suspicions:

```
50:  // TODO(cpu): Currently there does not seem to be a reason to implement
51:  // reference counting for this class since is internal, but kept the
52:  // the same interface so the interception framework does not need to be
53:  // touched at this point.
54:  void AddRef() {}
55:  void Release() {}

```

so I began reviewing the code, which is how I located the bug, which was reconfirmed by the curious lines:

```
667:     // This may fail in the same way as Job associated processes.
668:     // crbug.com/480639.

```

. The bug probably wouldn't have existed if `sandbox::TargetProcess` had been properly handled as a reference-counted class; in particular, not if (1) there had been no `delete`s outside of `Release()` and (2) all pointers to class objects had been reference-counting smart pointers.

The pattern that the AST matcher identifies (reference-counted class with public destructor and `delete` of object of such classes not inside of `class::Release()`) is questionable practice likely to cause bugs, since the point of reference counting is to prevent UAFs and leaks by (semi-)automating object lifetimes. A public destructor is not harmful in itself, but it creates the opportunity for non-`class::Release()` code to `delete` a class object, thus potentially destroying an object with a nonzero reference count.

The AST matcher has identified several reference-counting classes with public destructors, and 1 other non-test-code instance of a delete outside of `class::Release()`:

`txResultRecycler::recycle()` (`dom/xslt/xpath/txResultRecycler.cpp`)

I have not examined this`delete` instance for bugginess yet.

I have integrated the AST matcher into FF's build procedure, and will attach the relevant files in a later comment.

I developed the matcher in clang-query. There are 3 queries: one that identifies reference-counting classes (basically any class that has or inherits members `void AddRef()` and `void Release()`), one that identifies "suspect" classes, which are reference-counting classes with public destructors; and one that identifies `delete` expressions on suspect class objects that don't occur within a suspect class's `Release()` method. The queries, in order, are:

```
	let refcountingClassMatcher cxxRecordDecl(isSameOrDerivedFrom(allOf(cxxRecordDecl(has(cxxMethodDecl(hasName("AddRef"),returns(asString("void")),parameterCountIs(0)))), cxxRecordDecl(has(cxxMethodDecl(hasName("Release"),returns(asString("void")),parameterCountIs(0)).bind("releaseMethods")))))).bind("refcountingClasses")

	let suspectClassMatcher cxxRecordDecl(allOf(refcountingClassMatcher, has(allOf(cxxDestructorDecl(), isPublic())))).bind("suspectClasses")

	let deleteMatcher cxxDeleteExpr(allOf(cxxDeleteExpr(hasDescendant(implicitCastExpr(hasImplicitDestinationType(pointsTo(qualType(hasDeclaration(suspectClassMatcher))))))), unless(hasAncestor(cxxMethodDecl(equalsBoundNode("releaseMethods"))))))

```

Attached is a sample program (`test3.cpp`) that you can load in clang-query to see how the above queries work. The first query matches `RefCnterBase`, `RefCnterBase2`, and all the classes that inherit from them, either directly or indirectly. Curiously, `RefCnterBase` and `RefCnterBase2` match more than once, which I don't understand.

The second query matches only `RefCnterBase`, `C`, and `E`, apparently because these are the only reference-counting classes of which the sample program actually creates objects (it doesn't match `D`, even though it's a subobject of `E`, because `D` has a protected destructor). This result is suboptimal; I'd like to catch all suspect classes, even if nothing creates objects of those types.

The third query matches all the bad `deletes` in the test program. It does not, however, match the acceptable `delete`s:

1. in `foocontainer()::f()` (since `foocontainer` isn't reference-counting);
2. `delete pi` in `f5()` (since `pi` isa `int *`); and
3. `delete`s in `RefCnterBase::Release()` (since they are inside a reference-counting class's `Release()` method).

Note that the matchers do not check for more than one delete of the same object in the same scope, so

```
delete pe;
delete (E*) pe;

```

(and the same thing in `RefCnterBase::Release()`) doesn't elicit a warning. These matchers weren't designed to catch this particular bug.

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1848454#c2)• 1 year ago |
|  | |

Attached file
[test3.cpp](attachment.cgi?id=9348743)
— [Details](attachment.cgi?id=9348743&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1848454#a220452_406194)• 1 year ago |

Group: core-security → dom-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1848454#c3)• 1 year ago |
|  | |

I think we have a static analysis that rejects refcounted classes with public dtors, but maybe this directory is exempt because it is third party code.

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1848454#c4)• 1 year ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #3](/show_bug.cgi?id=1848454#c3 "RESOLVED FIXED - Double-delete UAF in BrokerServicesBase::SpawnTarget()"))

> I think we have a static analysis that rejects refcounted classes with public dtors, but maybe this directory is exempt because it is third party code.

Hmm, if that matcher exists, it doesn't seem to be run by default in `--enable-clang-plugin` builds. For example, the widely-used refcounting classes `mozilla::RefCounted<T>` (`mfbt/RefCounted.h` line 292 (116.0.2) / line 296 (trunk)) and `mozilla::AtomicRefCounted` (same module, line 309 (116.0.2) / line 313 (trunk) have public destructors, which my matcher flags, but the default matchers don't. Oddly, their base class `mozilla::RefCounted<T, Atomicity>`(same module) has a public destructor in release builds, but a protected destructor in debug builds (??) I didn't do a debug build, so maybe that's why I didn't see any warnings on the base class?

My matcher also turns up, e.g., class `WeakReference` (`mfbt/WeakPtr.h`), the derived classes `GenericRefCounted` and `GenericAtomicRefCounted` (`gfx/2d/GenericRefCounted.h`), etc.

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1848454#c5)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1848454&comment_id=16538556 "1 revision") |
|  | |

Attached is my matcher, with diffs for existing files versus the 116.0.2 release baseline. Note that my matcher discovered some issues in other matchers' test files, so I had to add `expected-warning` tags to those files.

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1848454#c6)• 1 year ago |
|  | |

Attached file
[BadRefcntedPublicDestructorDelete.zip](attachment.cgi?id=9348919)
— [Details](attachment.cgi?id=9348919&action=edit)

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1848454#c7)• 1 year ago |
|  | |

The current upstream `broker_services.cc` ([https://chromium.googlesource.com/chromium/src.git/+/refs/heads/main/sandbox/win/src/broker\_services.cc](https://chromium.googlesource.com/chromium/src.git/%2B/refs/heads/main/sandbox/win/src/broker_services.cc) ) is very different from the FF trunk version, so I have not reported this bug upstream.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1848454#c8)• 1 year ago |
|  | |

interesting that [crbug 480639](https://bugs.chromium.org/p/chromium/issues/detail?id=480639) is still private despite being pretty old.

Andi: is this something our checkers should have found, or could be improved to find?

Flags: needinfo?(bpostelnicu)Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=480639>

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1848454#a493020_151147)• 1 year ago |

Assignee: nobody → bobowencodeSeverity: -- → S2Priority: -- → P1

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1848454#c9)• 1 year ago |
|  | |

I think that the number of installs that might be vulnerable to this is going to be a fairly small percentage.

Normally all of the child processes that are using this code will be going through the `job.IsValid()` path.

However, on Windows 7 if the process is already in a job then we can't use nested jobs and have to use `JOB_NONE`.

Examples are using `runas` to start Firefox puts it in a job and also certain remote sessions use a job.

The upstream code has removed JOB\_NONE entirely.

Looks like we just want to call `Terminate` on the target, instead of `SpawnCleanup`.

Status: NEW → ASSIGNED

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1848454#c10)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1848454&comment_id=16542657 "1 revision") |
|  | |

(In reply to Bob Owen (:bobowen) from [comment #9](/show_bug.cgi?id=1848454#c9 "RESOLVED FIXED - Double-delete UAF in BrokerServicesBase::SpawnTarget()"))

> I think that the number of installs that might be vulnerable to this is going to be a fairly small percentage.
>
> Normally all of the child processes that are using this code will be going through the `job.IsValid()` path.
>
> However, on Windows 7 if the process is already in a job then we can't use nested jobs and have to use `JOB_NONE`.
>
> Examples are using `runas` to start Firefox puts it in a job and also certain remote sessions use a job.
>
> The upstream code has removed JOB\_NONE entirely.
>
> Looks like we just want to call `Terminate` on the target, instead of `SpawnCleanup`.

Hmm, I got the non-job path in Windows 10 when running FF under a limited account that was not the login account. That is, I started a cmd prompt using runas a limited account, then started FF in the cmd prompt. Is that what you mean by FF already being in a job?

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1848454#c11)• 1 year ago |
|  | |

(In reply to mozillabugs from [comment #10](/show_bug.cgi?id=1848454#c10 "RESOLVED FIXED - Double-delete UAF in BrokerServicesBase::SpawnTarget()"))

> (In reply to Bob Owen (:bobowen) from [comment #9](/show_bug.cgi?id=1848454#c9 "RESOLVED FIXED - Double-delete UAF in BrokerServicesBase::SpawnTarget()"))
>
> ...
>
> Hmm, I got the non-job path in Windows 10 when running FF under a limited account that was not the login account. That is, I started a cmd prompt using runas a limited account, then started FF in the cmd prompt. Is that what you mean by FF already being in a job?

Strange, are you logged into the machine remotely or possibly using compatibility mode?

Flags: needinfo?(mozillabugs)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1848454#c12)• 1 year ago |
|  | |

Ah wait, we were using JOB\_NONE for the gpu process until recently.

Flags: needinfo?(mozillabugs)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1848454#c13)• 1 year ago |
|  | |

(In reply to Bob Owen (:bobowen) from [comment #12](/show_bug.cgi?id=1848454#c12 "RESOLVED FIXED - Double-delete UAF in BrokerServicesBase::SpawnTarget()"))

> Ah wait, we were using JOB\_NONE for the gpu process until recently.

Although I imagine that makes it much less likely that `DuplicateHandle` will fail at this point.

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1848454#c14)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1848454&comment_id=16542689 "2 revisions") |
|  | |

(In reply to Bob Owen (:bobowen) from [comment #11](/show_bug.cgi?id=1848454#c11 "RESOLVED FIXED - Double-delete UAF in BrokerServicesBase::SpawnTarget()"))

> (In reply to mozillabugs from [comment #10](/show_bug.cgi?id=1848454#c10 "RESOLVED FIXED - Double-delete UAF in BrokerServicesBase::SpawnTarget()"))
>
> > (In reply to Bob Owen (:bobowen) from [comment #9](/show_bug.cgi?id=1848454#c9 "RESOLVED FIXED - Double-delete UAF in BrokerServicesBase::SpawnTarget()"))
> >
> > ...
> >
> > Hmm, I got the non-job path in Windows 10 when running FF under a limited account that was not the login account. That is, I started a cmd prompt using runas a limited account, then started FF in the cmd prompt. Is that what you mean by FF already being in a job?
>
> Strange, are you logged into the machine remotely or possibly using compatibility mode?

No. I am logged in locally and not using compatibility mode. The process being started is a content process, not a GPU process (it has the -contentproc and tab command line arguments).

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1848454#c15)• 1 year ago |
|  | |

Attached file
[Bug 1848454: Ensure an attempt is made to terminate the child when SpawnTarget fails and there is no job. r=handyman!](attachment.cgi?id=9349479)
— [Details](attachment.cgi?id=9349479&action=edit)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1848454#c16)• 1 year ago |
|  | |

Pushed by bobowencode@gmail.com:
<https://hg.mozilla.org/integration/autoland/rev/9a3b35d59182>
Ensure an attempt is made to terminate the child when SpawnTarget fails and there is no job. r=handyman

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1848454#c17)• 1 year ago |
|  | |

(In reply to mozillabugs from [comment #0](/show_bug.cgi?id=1848454#c0 "RESOLVED FIXED - Double-delete UAF in BrokerServicesBase::SpawnTarget()"))

...

> Interestingly, `BrokerServicesBase::SpawnTarget()`'s author noticed that this UAF was possible (lines 667-68), but never fixed it.

Incidentally, it's difficult to know because I don't think any of us have access to that bug, but my guess is the comment is saying that the termination of the process might fail. Not necessarily that there was a known theoretical UAF (if a current process`DuplicateHandle` happened to fail for some reason).

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1848454#a560030_458623)• 1 year ago |

[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected)
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected)
[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1848454#c18)• 1 year ago |
|  | |

Comment on [attachment 9349479](/attachment.cgi?id=9349479 "Bug 1848454: Ensure an attempt is made to terminate the child when SpawnTarget fails and there is no job. r=handyman!") [[details]](/attachment.cgi?id=9349479&action=edit "Bug 1848454: Ensure an attempt is made to terminate the child when SpawnTarget fails and there is no job. r=handyman!")

[Bug 1848454](/show_bug.cgi?id=1848454 "RESOLVED FIXED - Double-delete UAF in BrokerServicesBase::SpawnTarget()"): Ensure an attempt is made to terminate the child when SpawnTarget fails and there is no job. r=handyman!

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Even though failure of `DuplicateHandle` for the same process is probably very rare, the only way we would normally be using this code is for windows 7.

  As they will only have ESR from now on, it seems sensible to uplift.
* **User impact if declined**: Theoretical double delete UAF, although we don't have a PoC that can trigger it.
* **Fix Landed on Version**: 118
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Simple change that effectively removes the offending extra `delete`.
[Attachment #9349479](/attachment.cgi?id=9349479&action=edit "Bug 1848454: Ensure an attempt is made to terminate the child when SpawnTarget fails and there is no job. r=handyman!") -
Flags: approval-mozilla-esr115?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1848454#a584945_75935)• 1 year ago |

[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix)
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[tracking-firefox118](/buglist.cgi?f1=cf_tracking_firefox118&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [118+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=118%2B)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1848454#c19)• 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/9a3b35d59182>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 1 year ago
[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 118 Branch

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1848454#c20)• 1 year ago |
|  | |

> The AST matcher has identified...1 other non-test-code instance of a delete outside of `class::Release()`:
>
> `txResultRecycler::recycle()` (`dom/xslt/xpath/txResultRecycler.cpp`)
>
> I have not examined this`delete` instance for bugginess yet.

I have examined this usage, and it looks OK.

|  | [Andi [:andi]](/user_profile?user_id=555858) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1848454#c21)• 1 year ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #8](/show_bug.cgi?id=1848454#c8 "RESOLVED FIXED - Double-delete UAF in BrokerServicesBase::SpawnTarget()"))

> interesting that [crbug 480639](https://bugs.chromium.org/p/chromium/issues/detail?id=480639) is still private despite being pretty old.
>
> Andi: is this something our checkers should have found, or could be improved to find?

No, we don't have something that is targeting this specific scenario. We have more generic checkers.

Flags: needinfo?(bpostelnicu)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1848454#c22)• 1 year ago |
|  | |

Comment on [attachment 9349479](/attachment.cgi?id=9349479 "Bug 1848454: Ensure an attempt is made to terminate the child when SpawnTarget fails and there is no job. r=handyman!") [[details]](/attachment.cgi?id=9349479&action=edit "Bug 1848454: Ensure an attempt is made to terminate the child when SpawnTarget fails and there is no job. r=handyman!")

[Bug 1848454](/show_bug.cgi?id=1848454 "RESOLVED FIXED - Double-delete UAF in BrokerServicesBase::SpawnTarget()"): Ensure an attempt is made to terminate the child when SpawnTarget fails and there is no job. r=handyman!

Approved for 115.3esr.

[Attachment #9349479](/attachment.cgi?id=9349479&action=edit "Bug 1848454: Ensure an attempt is made to terminate the child when SpawnTarget fails and there is no job. r=handyman!") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1848454#c23)• 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/36eb7766bb55>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1848454#a1436985_75935)• 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1848454#a1536810_1689)• 1 year ago |

Flags: sec-bounty? → sec-bounty+

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1848454#a1780490_488993)• 1 year ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1848454#a3251640_578488)• 1 year ago |

Whiteboard: [adv-main118+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1848454#c24)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9354361)
— [Details](attachment.cgi?id=9354361&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1848454#a3513308_578488)• 1 year ago |

Whiteboard: [adv-main118+] → [adv-main118+][adv-esr115.3+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1848454#a12556968_1689)• 1 year ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1848454#a12561894_1689)• 1 year ago |

Alias: CVE-2023-5174

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1848454#a25295493_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1848454&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [mozillabugs](/user_profile?user_id=608633)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_ccc844ee_20250114_211926.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-43

## Security Vulnerabilities fixed in Thunderbird 115.3

Announced
September 26, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.3

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-5168: Out-of-bounds write in FilterNodeD2D1](#CVE-2023-5168)

Reporter
sonakkbi
Impact
high
##### Description

A compromised content process could have provided malicious data to `FilterNodeD2D1` resulting in an out-of-bounds write, leading to a potentially exploitable crash in a privileged process.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1846683](https://bugzilla.mozilla.org/show_bug.cgi?id=1846683)

#### [#CVE-2023-5169: Out-of-bounds write in PathOps](#CVE-2023-5169)

Reporter
sonakkbi
Impact
high
##### Description

A compromised content process could have provided malicious data in a `PathRecording` resulting in an out-of-bounds write, leading to a potentially exploitable crash in a privileged process.

##### References

* [Bug 1846685](https://bugzilla.mozilla.org/show_bug.cgi?id=1846685)

#### [#CVE-2023-5171: Use-after-free in Ion Compiler](#CVE-2023-5171)

Reporter
Lukas Bernhard
Impact
high
##### Description

During Ion compilation, a Garbage Collection could have resulted in a use-after-free condition, allowing an attacker to write two NUL bytes, and cause a potentially exploitable crash.

##### References

* [Bug 1851599](https://bugzilla.mozilla.org/show_bug.cgi?id=1851599)

#### [#CVE-2023-5174: Double-free in process spawning on Windows](#CVE-2023-5174)

Reporter
Ronald Crane
Impact
moderate
##### Description

If Windows failed to duplicate a handle during process creation, the sandbox code may have inadvertently freed a pointer twice, resulting in a use-after-free and a potentially exploitable crash.
*This bug only affects Firefox on Windows when run in non-standard configurations (such as using `runas`). Other operating systems are unaffected.*

##### References

* [Bug 1848454](https://bugzilla.mozilla.org/show_bug.cgi?id=1848454)

#### [#CVE-2023-5176: Memory safety bugs fixed in Firefox 118, Firefox ESR 115.3, and Thunderbird 115.3](#CVE-2023-5176)

Reporter
Chris Peterson, Andrew McCreight, André Bargull, Nika Layzell and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 118, Firefox ESR 115.3, and Thunderbird 115.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1836353%2C1842674%2C1843824%2C1843962%2C1848890%2C1850180%2C1850983%2C1851195)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


