=== Content from about.gitlab.com_c13d3f3f_20250114_204405.html ===


[←
Back to
releases](/releases/categories/releases/)
Jan 25, 2024

-
[Greg Myers](/company/team/#gitlab)
# GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8

Learn more about GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8 for GitLab Community Edition (CE) and Enterprise Edition (EE).

Today we are releasing versions 16.8.1, 16.7.4, 16.6.6, 16.5.8 for GitLab Community Edition (CE) and Enterprise Edition (EE).

These versions contain important security fixes, and we strongly recommend that all GitLab installations be upgraded to
one of these versions immediately. GitLab.com and GitLab Dedicated environments are already running the patched version.

GitLab releases patches for vulnerabilities in dedicated security releases. There are two types of security releases:
a monthly, scheduled security release, released a week after the feature release (which deploys on the 3rd Thursday of each month),
and ad-hoc security releases for critical vulnerabilities. For more information, you can visit our [security FAQ](https://about.gitlab.com/security/faq/).
You can see all of our regular and security release blog posts [here](/releases/categories/releases/).
In addition, the issues detailing each vulnerability are made public on our
[issue tracker](https://gitlab.com/gitlab-org/gitlab/-/issues/?sort=created_date&state=closed&label_name%5B%5D=bug%3A%3Avulnerability&confidential=no&first_page_size=100)
30 days after the release in which they were patched.

We are dedicated to ensuring all aspects of GitLab that are exposed to customers or that host customer data are held to
the highest security standards. As part of maintaining good security hygiene, it is highly recommended that all customers
upgrade to the latest security release for their supported version. You can read more
[best practices in securing your GitLab instance](/blog/2020/05/20/gitlab-instance-security-best-practices/) in our blog post.

### Recommended Action

We **strongly recommend** that all installations running a version affected by the issues described below are **upgraded to the latest version as soon as possible**.

When no specific deployment type (omnibus, source code, helm chart, etc.) of a product is mentioned, this means all types are affected.

## Table of fixes

| Title | Severity |
| --- | --- |
| [Arbitrary file write while creating workspace](#arbitrary-file-write-while-creating-workspace) | Critical |
| [ReDoS in `Cargo.toml` blob viewer](#redos-in-cargotoml-blob-viewer) | Medium |
| [Arbitrary API PUT requests via HTML injection in user's name](#arbitrary-api-put-requests-via-html-injection-in-users-name) | Medium |
| [Disclosure of the public email in Tags RSS Feed](#disclosure-of-the-public-email-in-tags-rss-feed) | Medium |
| [Non-Member can update MR Assignees of owned MRs](#non-member-can-update-mr-assignees-of-owned-mrs) | Medium |

### Arbitrary file write while creating workspace

An issue has been discovered in GitLab CE/EE affecting all versions from 16.0 prior to 16.5.8, 16.6 prior to 16.6.6, 16.7 prior to 16.7.4, and 16.8 prior to 16.8.1 which allows an authenticated user to write files to arbitrary locations on the GitLab server while creating a workspace.
This is a critical severity issue (`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H`, 9.9).
It is now mitigated in the latest release and is assigned [CVE-2024-0402](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-0402).

The fix for this security vulnerability has been backported to 16.5.8 in addition to 16.6.6, 16.7.4, and 16.8.1. GitLab 16.5.8 *only* includes a fix for this vulnerability and does *not* contain any of the other fixes or changes mentioned in this blog post.

This vulnerability has been discovered internally by GitLab team member [joernchen](https://gitlab.com/joernchen).

### ReDoS in `Cargo.toml` blob viewer

An issue has been discovered in GitLab CE/EE affecting all versions from 12.7 prior to 16.6.6, 16.7 prior to 16.7.4, and 16.8 prior to 16.8.1 It was possible for an attacker to trigger a Regular Expression Denial of Service via a `Cargo.toml` containing maliciously crafted input.
This is a medium severity issue (`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H`, 6.5).
It is now mitigated in the latest release and is assigned [CVE-2023-6159](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6159).

Thanks [yvvdwf](https://hackerone.com/yvvdwf) for reporting this vulnerability through our HackerOne bug bounty program.

### Arbitrary API PUT requests via HTML injection in user's name

An issue has been discovered in GitLab CE/EE affecting all versions after 13.7 before 16.6.6, 16.7 prior to 16.7.4, and 16.8 prior to 16.8.1. Improper input sanitization of user name allows arbitrary API PUT requests.
This is a medium severity issue (`CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N`, 6.4).
It is now mitigated in the latest release and is assigned [CVE-2023-5933](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-5933).

Thanks [yvvdwf](https://hackerone.com/yvvdwf) for reporting this vulnerability through our HackerOne bug bounty program.

### Disclosure of the public email in Tags RSS Feed

An issue has been discovered in GitLab affecting all versions before 16.6.6, 16.7 prior to 16.7.4, and 16.8 prior to 16.8.1. It was possible to read the user email address via tags feed although the visibility in the user profile has been disabled.
This is a medium severity issue (`CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N`, 5.3).
It is now mitigated in the latest release and is assigned [CVE-2023-5612](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-5612).

Thanks [erruqill](https://hackerone.com/erruqill) for reporting this vulnerability through our HackerOne bug bounty program.

### Non-Member can update MR Assignees of owned MRs

An authorization vulnerability exists in GitLab versions 14.0 prior to 16.6.6, 16.7 prior to 16.7.4, and 16.8 prior to 16.8.1. An unauthorized attacker is able to assign arbitrary users to MRs that they created within the project .
This is a medium severity issue (`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N`, 4.3).
It is now mitigated in the latest release and is assigned [CVE-2024-0456](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-0456).

Thanks to [Niklas](https://gitlab.com/Taucher2003) for reporting this vulnerability.

### Update xmlsoft/libxml2 to >= v2.11.6

The `xmlsoft/libxml2` version has been upgraded to 2.12.3 to mitigate [CVE-2023-45322](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45322).

### Upgrade redis to address CVE-2023-41056 (Redis RCE)

Redis has been upgraded to version 7.0.15 to mitigate [CVE-2023-41056](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-41056).

## Non Security Patches

### 16.8.1

* [Update dependency gitlab-glfm-markdown to '~> 0.0.11'](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/142344)
* [Backport Redis migration to 16.8](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/142307)
* [[Backport] Optimize garbage collection process](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/142398)
* [[Backport] Bump GitLab Shell version to 14.33.0](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/142628)

### 16.7.4

* [Backport - Bring legacy verification behavior back for repositories](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/141413)
* [Sync chef-gem and chef-bin (16.7)](https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7352)

### 16.6.6

* [Backport: Move release-environments pipeline to be sourced from master](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/141821)
* [Backport - Bring legacy verification behavior back for repositories](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/141412)

## Updating

To update GitLab, see the [Update page](/update).
To update Gitlab Runner, see the [Updating the Runner page](https://docs.gitlab.com/runner/install/linux-repository.html#updating-the-runner).

## Receive Security Release Notifications

To receive security release blog notifications delivered to your inbox, visit our [contact us](https://about.gitlab.com/company/contact/) page.
To receive release notifications via RSS, subscribe to our [security release RSS feed](https://about.gitlab.com/security-releases.xml) or our [RSS feed for all releases](https://about.gitlab.com/all-releases.xml).

[GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8
via @gitlab

Click to tweet!](http://twitter.com/share?text=GitLab+Critical+Security+Release%3A+16.8.1%2C+16.7.4%2C+16.6.6%2C+16.5.8+via+%40gitlab&url=https://about.gitlab.com/releases/2024/01/25/critical-security-release-gitlab-16-8-1-released/&hashtags= "Tweet!")

* [security](/releases/tags.html#security)

[Share on Facebook](http://www.facebook.com/sharer.php?u=https://about.gitlab.com/releases/2024/01/25/critical-security-release-gitlab-16-8-1-released/)
[Share on X](http://x.com/share?url=https://about.gitlab.com/releases/2024/01/25/critical-security-release-gitlab-16-8-1-released/&text=GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8)
[Share on LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://about.gitlab.com/releases/2024/01/25/critical-security-release-gitlab-16-8-1-released/&title=GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8&summary=&source=)
[Share on Hacker News](https://news.ycombinator.com/submitlink?u=https://about.gitlab.com/releases/2024/01/25/critical-security-release-gitlab-16-8-1-released/&t=GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8)

* [Previous Post:
  GitLab 16.8 released with Google Cloud Secret Manager
  ...](/releases/2024/01/18/gitlab-16-8-released/ "GitLab 16.8 released with Google Cloud Secret Manager support and the ability to speed up your builds with the Maven dependency proxy")
* [Next Post:
  GitLab Security Release: 16.8.2, 16.7.5, 16.6.7](/releases/2024/02/07/security-release-gitlab-16-8-2-released/ "GitLab Security Release: 16.8.2, 16.7.5, 16.6.7")

Sign up for GitLab's monthly newsletter

Thanks for subscribing!

### We want to hear from you

Enjoyed reading this blog post or have questions or feedback? Share your thoughts by creating a new topic in the GitLab community forum.

[Share your feedback](https://forum.gitlab.com/new-topic?title=GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8&body=&tags=blog-feedback)

## Take GitLab for a spin

See what your team could do with The DevSecOps Platform.

[Get free trial](https://gitlab.com/-/trials/new?glm_content=default-saas-trial&glm_source=about.gitlab.com)

![](/images/cta/gitlab-enterprise-team-member-photos.png)

Have a question? We're here to help.

[Talk to an expert](https://about.gitlab.com/sales/)

[Edit this page](https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/releases/posts/2024-01-25-critical-security-release-gitlab-16-8-1-released.html.md)
[View source](https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/releases/posts/2024-01-25-critical-security-release-gitlab-16-8-1-released.html.md)



=== Content from gitlab.com_3ab6527f_20250114_204406.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Arbitrary API PUT requests via HTML injection in user's name

⚠ **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2225710](https://hackerone.com/reports/2225710)** by `yvvdwf` on 2023-10-25, assigned to [@kmorrison1](/kmorrison1 "Kevin Morrison"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

Hello,

Full name of a user is sanitized by the following [function](https://gitlab.com/gitlab-org/gitlab/blob/97acd4825a295f547b804bc7fb3283a293b0254e/app/models/user.rb#L1416):

```
  def sanitize_name
    return unless self.name
    self.name = self.name.gsub(%r{</?[^>]*>}, '')
  end
```

The name can be any HTML tag without closing bracket.

When it is displayed in the navigation bar of gitlab, it is sanitized once more times using [`simple_sanitize`](https://gitlab.com/gitlab-org/gitlab/blob/97acd4825a295f547b804bc7fb3283a293b0254e/app/helpers/application_helper.rb#L118) function which allows `a, span` tags and `class, href, ...` attributes.

Thus, a user's fullname can be `<a class=x href=y`

In a [merge request page](https://gitlab.com/gitlab-org/gitlab/-/blob/1407a02dbef2cd06771bc94b61724430a94890d4/app/assets/javascripts/merge_request.js#L70-94), we got this gadget:

```
  const draftToggles = document.querySelectorAll('.js-draft-toggle-button');

  if (draftToggles.length) {
    draftToggles.forEach((draftToggle) => {
      draftToggle.addEventListener('click', (e) => {
        ...
        axios
          .put(draftToggle.href, null, { params: { format: 'json' } })
```

This means that if a user's fullname is `<a class=js-draft-toggle-button href=xxx` and this fullname is shown in a merge request page, then we can trick victim to execute any RESTful API PUT requests if the victim clicks on the fullname.

To easily capture victim's clicks, we can add `fixed-top` class to create a transparent topmost layer, and `tree-list-holder` class to hide this topmost layer on other pages (but the topmost shows only on a merge request page), for example, `a<a class="fixed-top tree-list-holder js-draft-toggle-button" href=xxxxxx`

### Reproduce

The vulnerability allows attackers to execute any RESTful API PUT requests on behalf of victim. The following scenario is to execute [`PUT /projects/:id/transfer`](https://docs.gitlab.com/ee/api/projects.html#transfer-a-project-to-a-new-namespace), thus to allow attacker to *steal* a victim's project by escalating to the owner of the project.

* step 0: as victim

  + create a new, private project and note its ID, e.g., `11111111` (we will steal this project: e.g., to be owner of the project)
* step 1: as attacker

  + create a new group, note its ID, e.g., `99999999`
  + invite victim as `Maintainer` of the group
* step 2: as attacker

  + create a new project, edit its readme then commit to another branch, then create a new merge request from the new branch to the default one. The objective is to have a merge request page, e.g., `https://gitlab.com/attacker/project-a/-/merge_requests/1`
  + goto attacker profile page (<https://gitlab.com/-/profile>), change "Full name" to: `a<a class="fixed-top tree-list-holder js-draft-toggle-button" href=/api/v4/projects/111111111/transfer?namespace=999999999` . Then click `Update profile settings` button. Important note: there must be no closed-bracket character `>` in the full name.
  + go back to the merge request page, `https://gitlab.com/attacker/project-a/-/merge_requests/1`, you should notice a topmost transparent layer.
  + change the project to public or add victim as a project member so that victim can view the merge request page
* step 3: as victim

  + visit the merge request page, then click any where

You might now notice that the project `111111111` has been transfer to the group `999999999` and attacker becomes owner of the project.

Best regards,

yvvdwf

#### Impact

The vulnerability allows attackers to execute any RESTful API PUT requests on behalf of victim.

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


