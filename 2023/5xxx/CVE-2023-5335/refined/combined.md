=== Content from www.wordfence.com_3950f987_20250115_094458.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Buzzsprout Podcasting <= 1.8.4 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Buzzsprout Podcasting <= 1.8.4 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2023-5335](https://www.cve.org/CVERecord?id=CVE-2023-5335) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | October 29, 2023 |
| Last Updated | January 22, 2024 |
| Researcher | [István Márton - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/lana-codes) |

### Description

The Buzzsprout Podcasting plugin for WordPress is vulnerable to Stored Cross-Site Scripting via 'buzzsprout' shortcode in versions up to, and including, 1.8.4 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers with contributor-level and above permissions to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/buzzsprout-podcasting/tags/1.8.3/buzzsprout-podcasting.php#L271)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/2990144/buzzsprout-podcasting)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fbuzzsprout-podcasting%2Fbuzzsprout-podcasting-183-authenticated-contributor-stored-cross-site-scripting-via-shortcode&t=Buzzsprout%20Podcasting%20%3C%3D%201.8.4%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20Shortcode "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fbuzzsprout-podcasting%2Fbuzzsprout-podcasting-183-authenticated-contributor-stored-cross-site-scripting-via-shortcode&text=Buzzsprout%20Podcasting%20%3C%3D%201.8.4%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20Shortcode "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fbuzzsprout-podcasting%2Fbuzzsprout-podcasting-183-authenticated-contributor-stored-cross-site-scripting-via-shortcode "LinkedIn")
Email

## Vulnerability Details for Buzzsprout Podcasting

#### [Buzzsprout Podcasting](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/buzzsprout-podcasting)

| Software Type | Plugin |
| --- | --- |
| Software Slug | buzzsprout-podcasting [(view on wordpress.org)](https://wordpress.org/plugins/buzzsprout-podcasting) |
| Patched? | Yes |
| Remediation | Update to version 1.8.5, or a newer patched version |
| Affected Version | * <= 1.8.4 |
| Patched Version | * 1.8.5 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_aa1743dd_20250115_094457.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fbuzzsprout-podcasting%2Ftags%2F1.8.3%2Fbuzzsprout-podcasting.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/buzzsprout-podcasting/tags/1.8.3/buzzsprout-podcasting.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/buzzsprout-podcasting/tags/1.8.3/buzzsprout-podcasting.php)

---

# [source:](/browser?order=name "Go to repository root") [buzzsprout-podcasting](/browser/buzzsprout-podcasting?order=name "View buzzsprout-podcasting")/[tags](/browser/buzzsprout-podcasting/tags?order=name "View tags")/[1.8.3](/browser/buzzsprout-podcasting/tags/1.8.3?order=name "View 1.8.3")/[buzzsprout-podcasting.php](/browser/buzzsprout-podcasting/tags/1.8.3/buzzsprout-podcasting.php?order=name "View buzzsprout-podcasting.php")

View diff against:

View revision:

| [Last change](/changeset/2859193/buzzsprout-podcasting/tags/1.8.3/buzzsprout-podcasting.php "View differences") on this file was [2859193](/changeset/2859193/ "View changeset 2859193"), checked in by molehill, [2 years ago](/timeline?from=2023-02-02T19%3A43%3A21Z&precision=second "See timeline at 02/02/2023 07:43:21 PM") |
| --- |
| tagging version 1.8.3 |
| **File size:** 14.1 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name: Buzzsprout Podcasting |
| [4](#L4) | Plugin URI: http://www.buzzsprout.com/wordpress |
| [5](#L5) | Description: This plugin fetches content from a Buzzsprout feed URL, from which user can pick an episode and add it into the post |
| [6](#L6) | Version: 1.8.3 |
| [7](#L7) | Author: Buzzsprout |
| [8](#L8) | Author URI: http://www.buzzsprout.com |
| [9](#L9) | \*/ |
| [10](#L10) |  |
| [11](#L11) | class Buzzsprout\_Podcasting{ |
| [12](#L12) |  |
| [13](#L13) | const PLUGIN\_NAME = 'Buzzsprout Podcasting'; |
| [14](#L14) | const PLUGIN\_SLUG = 'buzzsprout-podcasting'; |
| [15](#L15) | const PLUGIN\_TEXT\_DOMAIN = 'buzzsprout-podcasting-domain'; |
| [16](#L16) | const PLUGIN\_VERSION = 1.8; |
| [17](#L17) |  |
| [18](#L18) | /\*\* |
| [19](#L19) | \* @desc Initializes the plugin |
| [20](#L20) | \* |
| [21](#L21) | \*/ |
| [22](#L22) | public static function initialize(){ |
| [23](#L23) | add\_filter( 'media\_upload\_tabs', array( \_\_CLASS\_\_, 'register\_media\_tab' ) ); |
| [24](#L24) | add\_action( 'media\_upload\_buzzsprout\_podcasting', array( \_\_CLASS\_\_, 'add\_media\_tab' ) ); |
| [25](#L25) | add\_action( 'admin\_menu', array( \_\_CLASS\_\_, 'add\_options\_page' ) ); |
| [26](#L26) | add\_action( 'admin\_init', array( \_\_CLASS\_\_, 'register\_settings' ) ); |
| [27](#L27) | add\_action( 'admin\_enqueue\_scripts', array( \_\_CLASS\_\_, 'enqueue\_scripts' ) ); |
| [28](#L28) | add\_action( 'admin\_print\_styles-media-upload-popup', array( \_\_CLASS\_\_, 'enqueue\_media\_tab\_style' ) ); |
| [29](#L29) | add\_action('admin\_notices', array( \_\_CLASS\_\_, 'buzzsprout\_admin\_notice' ) ); |
| [30](#L30) | add\_shortcode('buzzsprout', array( \_\_CLASS\_\_, 'buzzsprout\_shortcode\_handler' ) ); |
| [31](#L31) | } |
| [32](#L32) |  |
| [33](#L33) | /\*\* |
| [34](#L34) | \* @desc Registers the Buzzsprout Podcasting media tab |
| [35](#L35) | \* @param array $tabs All media tabs |
| [36](#L36) | \* @return array All media tabs including the newly added Buzzsprout Podcasting |
| [37](#L37) | \*/ |
| [38](#L38) | public static function register\_media\_tab($tabs) { |
| [39](#L39) | $new\_tab = array( 'buzzsprout\_podcasting' => \_\_( 'Buzzsprout Podcasting', self::PLUGIN\_TEXT\_DOMAIN ) ); |
| [40](#L40) | return array\_merge( $tabs, $new\_tab ); |
| [41](#L41) | } |
| [42](#L42) |  |
| [43](#L43) | /\*\* |
| [44](#L44) | \* @desc    Adds the media tab |
| [45](#L45) | \* @return  wp\_iframe() |
| [46](#L46) | \*/ |
| [47](#L47) | public static function add\_media\_tab(){ |
| [48](#L48) | return wp\_iframe( array( \_\_CLASS\_\_, 'media\_tab\_content' ) ); |
| [49](#L49) | } |
| [50](#L50) |  |
| [51](#L51) | /\*\* |
| [52](#L52) | \* @desc    Enqueue scripts to be used throughout the admin pages |
| [53](#L53) | \* @return  void |
| [54](#L54) | \*/ |
| [55](#L55) | public static function enqueue\_scripts(){ |
| [56](#L56) | wp\_enqueue\_style( 'buzzsprout-podcasting-admin', plugins\_url( '/css/admin.css', \_\_FILE\_\_ ), false, self::PLUGIN\_VERSION ); |
| [57](#L57) | wp\_enqueue\_script( 'buzzsprout-podcasting-admin', plugins\_url('/js/admin-onload.js', \_\_FILE\_\_ ), array( 'jquery', 'media-upload' ) ); |
| [58](#L58) | } |
| [59](#L59) |  |
| [60](#L60) | /\*\* |
| [61](#L61) | \* @desc    Enqueue styles and scripts to use for the media upload thickbox |
| [62](#L62) | \* @return  void |
| [63](#L63) | \*/ |
| [64](#L64) | public static function enqueue\_media\_tab\_style(){ |
| [65](#L65) | wp\_enqueue\_style( 'buzzsprout-podcasting-admin', plugins\_url( '/css/admin.css', \_\_FILE\_\_ ), false, self::PLUGIN\_VERSION ); |
| [66](#L66) | wp\_enqueue\_script( 'buzzsprout-podcasting-box', plugins\_url('/js/box.js', \_\_FILE\_\_ ), array( 'jquery' ) ); |
| [67](#L67) | } |
| [68](#L68) |  |
| [69](#L69) | /\*\* |
| [70](#L70) | \* @desc    Content for the Buzzsprout Podcasting media tab within the media uploader thickbox |
| [71](#L71) | \* @return  mixed Media tab content |
| [72](#L72) | \*/ |
| [73](#L73) | public static function media\_tab\_content(){ |
| [74](#L74) | media\_upload\_header(); |
| [75](#L75) | $buzzsprout\_options = get\_option( self::PLUGIN\_SLUG ); ?> |
| [76](#L76) | <div class="box"> |
| [77](#L77) | <div style="float:right;"> |
| [78](#L78) | <p style="margin-top: 0;"><strong>Enjoying the Buzzsprout Plugin?</strong><br>Your <a href="https://wordpress.org/support/view/plugin-reviews/buzzsprout-podcasting" target="\_blank">ratings and reviews</a> are much appreciated!</p> |
| [79](#L79) | </div> |
| [80](#L80) | <?php if ( !$buzzsprout\_options ): ?> |
| [81](#L81) | <p class="major-info error"><?php printf( \_\_( 'You have not specified a valid Buzzsprout feed URL yet. Please use the form under %s %s to do so.', self::PLUGIN\_TEXT\_DOMAIN ), \_\_( self::PLUGIN\_NAME ),'<a href="' . admin\_url( 'options-general.php?page=buzzsprout-podcasting' ) . '" target="\_blank">' . \_\_( 'Settings page', self::PLUGIN\_TEXT\_DOMAIN ).'</a>' ); ?></p> |
| [82](#L82) | <?php elseif( !self::is\_feed\_valid( $buzzsprout\_options['feed-uri'] ) ): error\_log(self::is\_feed\_valid( $buzzsprout\_options['feed-uri'] ) ); ?> |
| [83](#L83) | <p class="major-info error"><?php printf(\_\_('A valid Buzzsprout feed URL cannot be found. Please use the form under %s to update your settings.', self::PLUGIN\_TEXT\_DOMAIN), '<a href="'.admin\_url('options-general.php?page=buzzsprout-podcasting').'">'.\_\_('Settings', self::PLUGIN\_TEXT\_DOMAIN).'</a>'); ?></p> |
| [84](#L84) | <?php else: |
| [85](#L85) | $rss = fetch\_feed( $buzzsprout\_options['feed-uri'].'?'.strtotime("now") ); |
| [86](#L86) |  |
| [87](#L87) | // MIME type can throw errors inside fetch\_feed. |
| [88](#L88) | // Use SimplePie class directly to force feed. |
| [89](#L89) | if ( is\_wp\_error( $rss ) ) { |
| [90](#L90) | $rss = new SimplePie(); |
| [91](#L91) | $rss->set\_feed\_url($buzzsprout\_options['feed-uri'].'?'.strtotime("now")); |
| [92](#L92) | $rss->force\_feed(true); // Force feed to fix MIME type errors |
| [93](#L93) | $rss->init(); |
| [94](#L94) | $rss->handle\_content\_type(); |
| [95](#L95) | } |
| [96](#L96) |  |
| [97](#L97) | $maxitems = $rss->get\_item\_quantity($buzzsprout\_options['number-episodes']); |
| [98](#L98) | $items = $rss->get\_items( 0, $maxitems ); ?> |
| [99](#L99) | <h2><?php \_e( 'Select an Episode', self::PLUGIN\_TEXT\_DOMAIN ); ?></h2> |
| [100](#L100) | <ul> |
| [101](#L101) | <?php if ($maxitems == 0): ?> |
| [102](#L102) | <li class="error"><?php \_e( 'No feed items can be retrieved.', self::PLUGIN\_TEXT\_DOMAIN ); ?></li> |
| [103](#L103) | <?php else: ?> |
| [104](#L104) | <?php foreach ( $items as $item ): // Loop through each feed item and display each item as a hyperlink. ?> |
| [105](#L105) | <li> |
| [106](#L106) | <a class="buzzp-item" href="#" title="<?php echo esc\_attr( \_\_('Click to add this episode into the post', self::PLUGIN\_TEXT\_DOMAIN ) ); ?>" data-short-tag="<?php echo self::buzzsprout\_item\_create\_short\_tag($item->get\_enclosure()->get\_link(), $buzzsprout\_options['include-flash']); ?>"><?php echo $item->get\_title(); ?></a> |
| [107](#L107) | </li> |
| [108](#L108) | <?php endforeach; ?> |
| [109](#L109) | <?php endif; ?> |
| [110](#L110) | </ul> |
| [111](#L111) | <?php endif; ?> |
| [112](#L112) | </div><?php |
| [113](#L113) | } |
| [114](#L114) |  |
| [115](#L115) | /\*\* |
| [116](#L116) | \* @desc    Adds the Buzzsprout Podcasting Options menu item |
| [117](#L117) | \* @return  void |
| [118](#L118) | \*/ |
| [119](#L119) | public static function add\_options\_page(){ |
| [120](#L120) | add\_options\_page(self::PLUGIN\_NAME, self::PLUGIN\_NAME, 'manage\_options', self::PLUGIN\_SLUG, array(\_\_CLASS\_\_, 'options\_page\_content')); |
| [121](#L121) | } |
| [122](#L122) |  |
| [123](#L123) | /\*\* |
| [124](#L124) | \* @desc    Registers the settings, settings section, and settings fields for the Buzzsprout Options page |
| [125](#L125) | \* @return  void |
| [126](#L126) | \*/ |
| [127](#L127) | public static function register\_settings(){ |
| [128](#L128) | register\_setting( self::PLUGIN\_SLUG, self::PLUGIN\_SLUG, array( \_\_CLASS\_\_, 'buzzsprout\_options\_validate' ) ); |
| [129](#L129) | add\_settings\_section( 'buzzsprout\_settings', \_\_( 'Buzzsprout Settings', self::PLUGIN\_TEXT\_DOMAIN ), array( \_\_CLASS\_\_, 'buzzsprout\_settings\_section\_cb'), self::PLUGIN\_SLUG ); |
| [130](#L130) | add\_settings\_field( 'buzzsprout\_feed\_address', \_\_( 'Buzzsprout feed address (URL)', self::PLUGIN\_TEXT\_DOMAIN ), array( \_\_CLASS\_\_, 'buzzsprout\_feed\_address\_cb' ), self::PLUGIN\_SLUG, 'buzzsprout\_settings' ); |
| [131](#L131) | add\_settings\_field( 'buzzsprout\_include\_flash', \_\_( 'Include audio player?', self::PLUGIN\_TEXT\_DOMAIN ), array( \_\_CLASS\_\_, 'buzzsprout\_include\_flash\_cb' ), self::PLUGIN\_SLUG, 'buzzsprout\_settings' ); |
| [132](#L132) | add\_settings\_field( 'buzzsprout\_number\_episodes', \_\_( 'Number of Episodes to return', self::PLUGIN\_TEXT\_DOMAIN ), array( \_\_CLASS\_\_, 'buzzsprout\_number\_episodes\_cb' ), self::PLUGIN\_SLUG, 'buzzsprout\_settings' ); |
| [133](#L133) | } |
| [134](#L134) |  |
| [135](#L135) | /\*\* |
| [136](#L136) | \* @desc    Displays the Buzzsprout Podcasting Options page content |
| [137](#L137) | \* @return  mixed Options page content |
| [138](#L138) | \*/ |
| [139](#L139) | public static function options\_page\_content(){ ?> |
| [140](#L140) | <div class="wrap buzzp"> |
| [141](#L141) | <div id="icon-options-buzzp" class="icon32"></div> |
| [142](#L142) | <h2><?php \_e( self::PLUGIN\_NAME, self::PLUGIN\_TEXT\_DOMAIN )?></h2> |
| [143](#L143) | <p><?php \_e("Buzzsprout is the only solution you need for publishing, hosting, promoting and tracking your podcast on the web. It eliminates the hassles and technical know-how required with self-managed podcast publishing. Whether you're just starting out or have been podcasting for years, Buzzsprout is the easiest way to get your podcast online.", self::PLUGIN\_TEXT\_DOMAIN); ?></p> |
| [144](#L144) | <p><?php printf(\_\_('You can learn more about Buzzsprout and create your own FREE account at %s.', self::PLUGIN\_TEXT\_DOMAIN ), '<a href="http://www.buzzsprout.com" target="\_blank">http://www.buzzsprout.com</a>'); ?></p> |
| [145](#L145) | <form action="options.php" method="post"> |
| [146](#L146) | <?php settings\_fields(self::PLUGIN\_SLUG); ?> |
| [147](#L147) | <?php do\_settings\_sections(self::PLUGIN\_SLUG); ?> |
| [148](#L148) | <p class="submit"> |
| [149](#L149) | <input class="button-primary" name="submit" type="submit" value="<?php echo( esc\_attr( \_\_( 'Save Changes', self::PLUGIN\_TEXT\_DOMAIN) ) ); ?>" /> |
| [150](#L150) | </p> |
| [151](#L151) | </form> |
| [152](#L152) |  |
| [153](#L153) | <h3><?php \_e('How the Buzzsprout Podcasting Plugin Works', self::PLUGIN\_TEXT\_DOMAIN)?></h3> |
| [154](#L154) |  |
| [155](#L155) | <p class="how-it-works"> |
| [156](#L156) | <?php \_e( 'The Buzzsprout Podcasting plugin makes embedding podcast episodes into your blog posts a breeze. Please see our <a href="https://www.buzzsprout.com/help/27" target="\_blank"><strong>WP Plugin Help Section</strong></a> for instructions, screenshots, and videos.', self::PLUGIN\_TEXT\_DOMAIN ); ?> |
| [157](#L157) | </p> |
| [158](#L158) | </div> |
| [159](#L159) | <?php |
| [160](#L160) | } |
| [161](#L161) |  |
| [162](#L162) | /\*\* |
| [163](#L163) | \* @desc    Validates the buzzsprout options settings |
| [164](#L164) | \* @param   $input Array of the buzzsprout\_podcasting\_options |
| [165](#L165) | \* @return  array Clean array of the buzzsprout podcasting options |
| [166](#L166) | \*/ |
| [167](#L167) | public static function buzzsprout\_options\_validate($input){ |
| [168](#L168) | $new\_input = array(); |
| [169](#L169) | $new\_input['feed-uri'] = esc\_url\_raw(strip\_tags( $input['feed-uri'] ) ); |
| [170](#L170) | $new\_input['include-flash'] = ($input['include-flash'] == 'on') ? true : false; |
| [171](#L171) | $new\_input['number-episodes'] = strip\_tags( $input['number-episodes'] ); |
| [172](#L172) | return $new\_input; |
| [173](#L173) | } |
| [174](#L174) |  |
| [175](#L175) | /\*\* |
| [176](#L176) | \* @desc    Adds a description to the Buzzsprout Settings section on the Buzzsprout Podcasting Options page |
| [177](#L177) | \* @return  void |
| [178](#L178) | \*/ |
| [179](#L179) | public static function buzzsprout\_settings\_section\_cb(){ |
| [180](#L180) | return ''; |
| [181](#L181) | } |
| [182](#L182) |  |
| [183](#L183) | /\*\* |
| [184](#L184) | \* @desc    Displays the feed address input for the Buzzsprout Podcasting Options page |
| [185](#L185) | \* @return  void |
| [186](#L186) | \*/ |
| [187](#L187) | public static function buzzsprout\_feed\_address\_cb(){ |
| [188](#L188) | $buzzsprout\_options = get\_option(self::PLUGIN\_SLUG); |
| [189](#L189) | ?> |
| [190](#L190) | <input style="width: 300px" type="text" name="<?php echo esc\_attr( self::PLUGIN\_SLUG.'[feed-uri]'); ?>" value="<?php echo esc\_attr($buzzsprout\_options['feed-uri']); ?>" /> |
| [191](#L191) | <span class="guide"> |
| [192](#L192) | <?php printf( \_\_('%s, then click on iTunes &amp; Directories > RSS Feed.', self::PLUGIN\_TEXT\_DOMAIN ), '<a href="http://www.buzzsprout.com/login" target="\_blank">'.\_\_('Login to your account', self::PLUGIN\_TEXT\_DOMAIN).'</a>'); ?> |
| [193](#L193) | </span><?php |
| [194](#L194) | } |
| [195](#L195) |  |
| [196](#L196) | /\*\* |
| [197](#L197) | \* @desc    Displays the include flash input for the Buzzsprout Podcasting Options page |
| [198](#L198) | \* @return  void |
| [199](#L199) | \*/ |
| [200](#L200) | public static function buzzsprout\_include\_flash\_cb(){ |
| [201](#L201) | $buzzsprout\_options = get\_option(self::PLUGIN\_SLUG); ?> |
| [202](#L202) | <input type="checkbox" name="<?php echo esc\_attr( self::PLUGIN\_SLUG.'[include-flash]'); ?>" <?php checked($buzzsprout\_options['include-flash']); ?> /> Yes |
| [203](#L203) | <?php |
| [204](#L204) | } |
| [205](#L205) |  |
| [206](#L206) | /\*\* |
| [207](#L207) | \* @desc    Displays the number episodes select box for the Buzzsprout Podcasting Options page |
| [208](#L208) | \* @return  void |
| [209](#L209) | \*/ |
| [210](#L210) | public static function buzzsprout\_number\_episodes\_cb(){ |
| [211](#L211) | $buzzsprout\_options = get\_option(self::PLUGIN\_SLUG); ?> |
| [212](#L212) | <p> |
| [213](#L213) | <select name="<?php echo esc\_attr( self::PLUGIN\_SLUG.'[number-episodes]'); ?>"> |
| [214](#L214) | <?php   for ($i = 5; $i < 21; $i += 5): |
| [215](#L215) | printf('<option value="%s"%s>%s</option>%s', $i, selected($buzzsprout\_options['number-episodes'], $i), $i, PHP\_EOL); |
| [216](#L216) | endfor; |
| [217](#L217) | printf('<option value="%s"%s>%s</option>%s', 9999, selected($buzzsprout\_options['number-episodes'], 9999), \_\_('All', self::PLUGIN\_TEXT\_DOMAIN), PHP\_EOL); ?> |
| [218](#L218) | </select> |
| [219](#L219) | <br class="clear" /> |
| [220](#L220) | </p><?php |
| [221](#L221) | } |
| [222](#L222) |  |
| [223](#L223) | /\*\* |
| [224](#L224) | \* @desc |
| [225](#L225) | \* @param string $url |
| [226](#L226) | \* @return bool Is valid or not |
| [227](#L227) | \*/ |
| [228](#L228) | public static function is\_feed\_valid($url){ |
| [229](#L229) | if (!trim($url)) return false; |
| [230](#L230) | return preg\_match('|^http(s)?://(feeds\.)?buzzsprout\.com/[0-9]+\.rss$|i', $url); |
| [231](#L231) | } |
| [232](#L232) |  |
| [233](#L233) | /\*\* |
| [234](#L234) | \* @desc Gets the subcription ID (from the RSS URL) |
| [235](#L235) | \* |
| [236](#L236) | \* @param mixed $feed\_uri |
| [237](#L237) | \* @return mixed |
| [238](#L238) | \*/ |
| [239](#L239) | public static function get\_subscription\_id($feed\_uri = false){ |
| [240](#L240) |  |
| [241](#L241) | // if a feed URI is not provided, try getting it from DB |
| [242](#L242) | if (!$feed\_uri){ |
| [243](#L243) | $buzzsprout\_otions = get\_option(self::PLUGIN\_SLUG); |
| [244](#L244) |  |
| [245](#L245) | if(!$buzzsprout\_otions) |
| [246](#L246) | return false; |
| [247](#L247) |  |
| [248](#L248) | $feed\_uri = $buzzsprout\_otions['feed-uri']; |
| [249](#L249) | } |
| [250](#L250) |  |
| [251](#L251) | if (!preg\_match\_all('|^https?://(feeds\.)?buzzsprout\.com/([0-9]+)\.rss$|i', $feed\_uri, $matches)) return false; |
| [252](#L252) | return isset($matches[2][0]) ? $matches[2][0] : false; |
| [253](#L253) | } |
| [254](#L254) |  |
| [255](#L255) | /\*\* |
| [256](#L256) | \* @desc Handles the [buzzsprout] shortcode |
| [257](#L257) | \* |
| [258](#L258) | \* @param mixed $atts |
| [259](#L259) | \* @return The parsed HTML |
| [260](#L260) | \*/ |
| [261](#L261) | public static function buzzsprout\_shortcode\_handler($atts){ |
| [262](#L262) | extract(shortcode\_atts(array( |
| [263](#L263) | 'episode'   => 0, |
| [264](#L264) | 'player'    => 'true', |
| [265](#L265) | ), $atts)); |
| [266](#L266) |  |
| [267](#L267) | // as player=true is preferred, we only disable player if the value is exclusively 'false' |
| [268](#L268) | $parsed\_html = sprintf( |
| [269](#L269) | '<div id="buzzsprout-player-%s"></div> |
| [270](#L270) | <script src="https://www.buzzsprout.com/%s/%s.js?container\_id=buzzsprout-player-%s&amp;%s" type="text/javascript" charset="utf-8"></script> |
| [271](#L271) | ', $episode, self::get\_subscription\_id(), $episode, $episode, $player != 'false' ? 'player=small' : '' |
| [272](#L272) | ); |
| [273](#L273) |  |
| [274](#L274) | return $parsed\_html; |
| [275](#L275) | } |
| [276](#L276) |  |
| [277](#L277) | /\*\* |
| [278](#L278) | \* Create a short tag to add into the post |
| [279](#L279) | \* |
| [280](#L280) | \* @param string Link of the buzz media file |
| [281](#L281) | \* @param mixed Whether player should be enabled |
| [282](#L282) | \*/ |
| [283](#L283) | public static function buzzsprout\_item\_create\_short\_tag($buzz\_item\_link, $player){ |
| [284](#L284) | // http://www.buzzsprout.com/96/1917-ep-9-rams-vs-titans.mp3 |
| [285](#L285) | if (!preg\_match\_all('|(buzzsprout\.com)/[0-9]+/([0-9]+).\*|i', $buzz\_item\_link, $matches)) return false; |
| [286](#L286) |  |
| [287](#L287) | if (!isset($matches[2][0])) return false; |
| [288](#L288) |  |
| [289](#L289) | $tag = sprintf("[buzzsprout episode='%s' player='%s']", trim($matches[2][0]), $player ? 'true' : 'false'); |
| [290](#L290) | return $tag; |
| [291](#L291) | } |
| [292](#L292) |  |
| [293](#L293) | /\*\* |
| [294](#L294) | \* @desc Check if the feed provided is valid and if so, the Settings updated message will be displayed, if not, the Invalid Buzzsprout Feed URL error message will be displayed. |
| [295](#L295) | \* |
| [296](#L296) | \*/ |
| [297](#L297) | public static function buzzsprout\_admin\_notice(){ |
| [298](#L298) | global $pagenow; |
| [299](#L299) | if ($pagenow == 'options-general.php' && $\_GET['page'] == self::PLUGIN\_SLUG) { |
| [300](#L300) | if ( (isset($\_GET['updated']) && $\_GET['updated'] == 'true') || (isset($\_GET['settings-updated']) && $\_GET['settings-updated'] == 'true') ) { |
| [301](#L301) |  |
| [302](#L302) | $errors = get\_settings\_errors(); |
| [303](#L303) |  |
| [304](#L304) | $buzzsprout\_options = get\_option( self::PLUGIN\_SLUG ); |
| [305](#L305) | if(!self::is\_feed\_valid($buzzsprout\_options['feed-uri'])){ |
| [306](#L306) | $buzzsprout\_options['feed-uri'] = ''; |
| [307](#L307) | update\_option(self::PLUGIN\_SLUG, $buzzsprout\_options); |
| [308](#L308) | $error\_message = \_\_('Invalid Buzzsprout Feed URL'); |
| [309](#L309) | add\_settings\_error('general', 'settings\_updated', $error\_message, 'error'); |
| [310](#L310) | } else { |
| [311](#L311) | $original\_message = $errors[0]['message']; |
| [312](#L312) | add\_settings\_error('general', 'settings\_updated', $original\_message, 'updated'); |
| [313](#L313) | } |
| [314](#L314) | } |
| [315](#L315) | } |
| [316](#L316) | } |
| [317](#L317) | } |
| [318](#L318) | add\_action('init', array('Buzzsprout\_Podcasting', 'initialize')); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/buzzsprout-podcasting/tags/1.8.3/buzzsprout-podcasting.php?format=txt)
* [Original Format](/export/3222730/buzzsprout-podcasting/tags/1.8.3/buzzsprout-podcasting.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


