=== Content from bugzilla.redhat.com_3dc575d8_20250115_090831.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2255869)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2255869)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2255869)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 2255869

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 2255869**](show_bug.cgi?id=2255869)
(CVE-2023-51765)
- [CVE-2023-51765](https://access.redhat.com/security/cve/CVE-2023-51765) sendmail: SMTP smuggling vulnerability

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2023-51765 sendmail: SMTP smuggling vulnerability

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | NEW | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2023-51765 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2255870](show_bug.cgi?id=2255870 "CLOSED RAWHIDE - TRIAGE CVE-2023-51765 sendmail: SMTP smuggling vulnerability [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [2255562](show_bug.cgi?id=2255562) | | TreeView+ | [depends on](buglist.cgi?bug_id=2255869&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2255869&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2023-12-25 22:05 UTC by Robb Gatica | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2024-06-18 02:20 UTC ([History](show_activity.cgi?id=2255869)) | | [CC List:](page.cgi?id=fields.html#cclist) | 1 user (show)  redhat-bugzilla | | Fixed In Version: | sendmail 8.18.0.2 | | | Doc Type: | --- | | | Doc Text: | A flaw was found in some SMTP server configurations in Sendmail. This issue may allow a remote attacker to break out of the email message data to "smuggle" SMTP commands and send spoofed emails that pass SPF checks. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2255869#c0)  Robb Gatica    2023-12-25 22:05:17 UTC  ``` escription: By exploiting interpretation differences of the SMTP protocol, it is possible to smuggle/send spoofed e-mails - hence SMTP smuggling - while still passing SPF alignment checks. During this research, two types of SMTP smuggling, outbound and inbound, were discovered. These allowed sending spoofed e-mails from millions of domains (e.g., admin[@]outlook.com) to millions of receiving SMTP servers (e.g., Amazon, PayPal, eBay). Identified vulnerabilities in Microsoft and GMX were quickly fixed, however, SEC Consult urges companies using the also affected Cisco Secure Email product to manually update their vulnerable default configuration.   References: <https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/>   ```  [Comment 1](show_bug.cgi?id=2255869#c1)  Robb Gatica    2023-12-25 22:05:47 UTC  ``` Created sendmail tracking bugs for this issue:  Affects: fedora-all [[bug 2255870](show_bug.cgi?id=2255870 "CLOSED RAWHIDE - TRIAGE CVE-2023-51765 sendmail: SMTP smuggling vulnerability [fedora-all]")]   ```  [Comment 3](show_bug.cgi?id=2255869#c3)  Sandipan Roy    2024-01-04 11:08:07 UTC  ``` The Sendmail vulnerability allowing SMTP smuggling is deemed moderate due to its impact on SPF protection mechanisms and specific conditions for successful exploitation. SMTP smuggling involves manipulating the communication between mail servers to inject unauthorized messages. Exploiting this flaw involves a technique where remote attackers inject email messages with a spoofed MAIL FROM address. This manipulation allows them to bypass SPF protections because Sendmail supports the <LF>.<CR><LF> sequence, which some other popular email servers do not.  CVSSv3:  5.3/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2255869&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.openwall.com_8b33c41d_20250115_090828.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](1) [[thread-next>]](../../../2024/04/30/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20231230165149.GA74712@veps.esmtp.org>
Date: Sat, 30 Dec 2023 16:51:49 +0000
From: Claus Assmann <ml+oss@...tp.org>
To: oss-security@...ts.openwall.com
Subject: Re: Re: New SMTP smuggling attack

On Fri, Dec 29, 2023, Alan Coopersmith wrote:

> > > - CVE-2023-51765 sendmail

> so you can submit updates/corrections via the web form at:
>   <https://cveform.mitre.org/>

Thanks for the URL, I've submitted my changes yesterday.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_ff0141a7_20250115_221232.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

# blists - web interface to mailing list archives

blists is a web interface to mailing list archives that works off indexed mbox files.
There are two programs: *bindex* and *bit*.
*bindex* generates or updates the index file (yes, incremental updates are supported).
*bit* is a CGI/SSI program that generates web pages on the fly.
Both programs are written in C and are very fast.

You can view the latest <README> file,
which describes blists in more detail and provides installation instructions.
It is also included in the archive below.

Download ([release notes](/lists/announce/2017/11/19/1)):

* [blists 2.0](blists-2.0.tar.gz) and
  its [signature](blists-2.0.tar.gz.sign)* [blists 1.0](blists-1.0.tar.gz) and
    its [signature](blists-1.0.tar.gz.sign)

These files are also
[available from the Openwall file archive](https://download.openwall.net/pub/projects/blists/).
The source code of blists can be browsed on
[GitHub](https://github.com/openwall/blists) or via
[CVSweb](https://cvsweb.openwall.com/blists).

Follow [this link](/signatures/) for information on verifying the signatures.

To see blists in action, check out our
[Open Source and information security mailing list archives](https://lists.openwall.net).

blists is a registered project with
[Open Hub](https://www.openhub.net/p/blists).

Quick Comment:

412070



=== Content from www.openwall.com_eed9f9bb_20250115_090846.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](5) [[thread-next>]](8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20231222150438.GA13989@unix-ag.uni-kl.de>
Date: Fri, 22 Dec 2023 16:04:38 +0100
From: Erik Auerswald <auerswal@...x-ag.uni-kl.de>
To: oss-security@...ts.openwall.com
Subject: Re: Re: New SMTP smuggling attack

Hi,

On Fri, Dec 22, 2023 at 01:11:37PM +0100, Marcus Meissner wrote:
> On Fri, Dec 22, 2023 at 11:09:49AM +0000, Stuart Henderson wrote:
> > On 2023/12/22 11:46, Marcus Meissner wrote:
> > >
> > > FWIW as no CVEs were to be found yet, I filed a CVE request for
> > > Postfix now.
> > >
> > > Not sure if we need it for others like sendmail too, as that is
> > > also referenced by the security researchers.

I'd think that sendmail should have a CVE, too, or there could be one
CVE pertaining to both Postfix and sendmail, because SEC Consult write
in their blog post:

   "After testing some popular e-mail software in their default
    configuration, it turned out that Postfix and Sendmail fulfil the
    requirements, are affected and can be smuggled to."

As such I'd say that both Postfix and sendmail are known to be vulnerable.

> > I'm a little confused by sec-consult's process here. They identify
> > a problem affecting various pieces of software including some very
> > widely deployed open source software, go to the trouble of doing
> > a coordinated disclosure, but only do that with...looking at their
> > timeline... gmx, microsoft and cisco?
>
> Yes its weird.
>
> I was also confused and actually only spotted the OSS software being
> affected on third read over their page.
>
> They also reference CERT and VINCE, but at least SUSE was not pulled
> into the VINCE issue if there was any. (as CERT has not published
> anything I am not sure there was any besides the Cisco disclosure).

According to the timeline, they involved CERT/CC and VINCE in August:

    2023-08-17: Contacting CERT Coordination Center (CERT/CC) for further
                discussion with Cisco
    ...
    2023-09-13: CERT/CC accepts the case
    ...
    2023-11-29: CERT/CC allows public release of SMTP smuggling, since
                no software vulnerabilities were identified ("it's not
                a bug, it's a feature")
    ...
    2023-12-18: Release date of blog post

The first timeline entry omits a bit from the text, i.e., VINCE:

   "we contacted CERT/CC on 17th August to get some help for further
    discussion with Cisco and involve other potentially affected vendors
    (such as sendmail) through the VINCE communication platform."

> Also postfix timeline starts 4 days ago only.
> [https://www.mail-archive.com/postfix-announce@postfix.org/msg00090.html](https://www.mail-archive.com/postfix-announce%40postfix.org/msg00090.html)

This is three days after the SEC Consult blog post.

My personal interpretation is as follows:

  * SEC Consult concentrated on the big email platforms, because of the
    potential impact.
  * They informed platforms that could be used to perform the attack
    against vulnerable targets.
  * They informed Cisco since they used an affected Cisco product
    and could thus be targeted (even though for Cisco this is not a
    vulnerability, but a feature).
  * They involved CERT/CC and VINCE, probably with the assumption that
    this would result in identifying and informing affected vendors
    and projects.
  * The CERT/CC and VINCE involvement resulted in "there is no
    vulnerability".
  * SEC Consult publish their findings.

Now, others (including me) see this as a vulnerability affecting at
least some open source email servers.  SNAFU.

Cheers,
Erik

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from wiki.debian.org_8d48714b_20250115_221231.html ===

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")

[Wiki](/FrontPage "Debian Wiki Homepage")

[Login](/LTS?action=login)

* [FrontPage](/FrontPage)
* [RecentChanges](/RecentChanges)
* [FindPage](/FindPage)
* [HelpContents](/HelpContents)
* [LTS](/LTS)

Search:

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")
[Wiki](/FrontPage "Debian Wiki Homepage")/

* [Login](/LTS?action=login)
* Comments
* [Info](/LTS?action=info)
* [Attachments](/LTS?action=AttachFile)
* More Actions:
  Raw Text
  Print View
  Render as Docbook
  Delete Cache
  ------------------------
  Check Spelling
  Like Pages
  Local Site Map
  ------------------------
  Rename Page
  Delete Page
  ------------------------
  Subscribe User
  ------------------------
  Remove Spam
  Revert to this revision
  Package Pages
  ------------------------
  Load
  Save
  SlideShow

# * [LTS](/LTS)

[Translation(s)](/DebianWiki/EditorGuide#translation): [English](/LTS) - [Deutsch](/de/LTS) - [Español](/es/LTS) - [Français](/fr/LTS) - [Italiano](/it/LTS) - [한국어](/ko/LTS) - [Português](/pt/LTS) - [Português (Brasil)](/pt_BR/LTS) - [Русский](/ru/LTS)

# Debian Long Term Support

Debian Long Term Support (LTS) is a project to extend the lifetime of all Debian stable releases to (at least) 5 years. Debian LTS is not handled by the Debian Security and Release teams, but by a separate group of volunteers and companies interested in making it a success.

Thus the Debian LTS team takes over security maintenance of the various releases once the Debian Security team stops its work.

![/!\](/htdocs/debwiki/img/alert.png "/!\")

LTS ([last modified 2024-08-15 02:46:47](/LTS?action=info))

* Debian [privacy policy](https://www.debian.org/legal/privacy), Wiki [team](/Teams/DebianWiki), [bugs](https://bugs.debian.org/wiki.debian.org) and [config](https://salsa.debian.org/debian/wiki.debian.org).
* Powered by [MoinMoin](https://moinmo.in/ "This site uses the MoinMoin Wiki software.") and [Python](https://moinmo.in/Python "MoinMoin is written in Python."), with hosting provided by [Metropolitan Area Network Darmstadt](https://www.man-da.de/).



=== Content from www.openwall.com_ff0141a7_20250115_221234.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

# blists - web interface to mailing list archives

blists is a web interface to mailing list archives that works off indexed mbox files.
There are two programs: *bindex* and *bit*.
*bindex* generates or updates the index file (yes, incremental updates are supported).
*bit* is a CGI/SSI program that generates web pages on the fly.
Both programs are written in C and are very fast.

You can view the latest <README> file,
which describes blists in more detail and provides installation instructions.
It is also included in the archive below.

Download ([release notes](/lists/announce/2017/11/19/1)):

* [blists 2.0](blists-2.0.tar.gz) and
  its [signature](blists-2.0.tar.gz.sign)* [blists 1.0](blists-1.0.tar.gz) and
    its [signature](blists-1.0.tar.gz.sign)

These files are also
[available from the Openwall file archive](https://download.openwall.net/pub/projects/blists/).
The source code of blists can be browsed on
[GitHub](https://github.com/openwall/blists) or via
[CVSweb](https://cvsweb.openwall.com/blists).

Follow [this link](/signatures/) for information on verifying the signatures.

To see blists in action, check out our
[Open Source and information security mailing list archives](https://lists.openwall.net).

blists is a registered project with
[Open Hub](https://www.openhub.net/p/blists).

Quick Comment:

412071



=== Content from lists.debian.org_40ac48b8_20250115_090839.html ===


---

[[Date Prev](msg00003.html)][[Date Next](msg00005.html)]
[[Thread Prev](msg00003.html)][[Thread Next](msg00005.html)]
[[Date Index](maillist.html#00004)]
[[Thread Index](threads.html#00004)]

# [SECURITY] [DLA 3829-1] sendmail security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3829-1] sendmail security update
* *From*: rouca@debian.org
* *Date*: Sat, 15 Jun 2024 08:32:49 +0000
* *Message-id*: <[[🔎]](/msgid-search/479290058b87cf48d7b1e96c8d448daa.rouca%40debian.org) [479290058b87cf48d7b1e96c8d448daa.rouca@debian.org](msg00004.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3829-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                   Bastien RoucariÃ¨s
June 15, 2024                                 <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : sendmail
Version        : 8.15.2-14~deb10u2
CVE ID         : CVE-2023-51765
Debian Bug     : 1059386

sendmail allowed SMTP smuggling in certain configurations.
Remote attackers can use a published exploitation technique to inject e-mail
messages with a spoofed MAIL FROM address, allowing bypass
of an SPF protection mechanism. This occurs because sendmail supports
<LF>.<CR><LF> but some other popular e-mail servers do not.

This particular injection vulnerability has been closed,
unfortunatly full closure need to reject mail that
contain NUL (0x00 byte).

This is slighly non conformant with RFC and could
be opt-out by setting confREJECT_NUL to 'false'
in sendmail.mc file.

For Debian 10 buster, this problem has been fixed in version
8.15.2-14~deb10u2.

We recommend that you upgrade your sendmail packages.

For the detailed security status of sendmail please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/sendmail>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQJFBAEBCgAvFiEEXQGHuUCiRbrXsPVqADoaLapBCF8FAmZtUbARHHJvdWNhQGRl
Ymlhbi5vcmcACgkQADoaLapBCF+HvA/+Mw7PEDlB2ZKWnJiKoJU7nVNuWyyBUSqV
bRVo4+FmMKiuBb9MvdWn10u2mydnZYDtzb9+d32axvOb9h1PAfQvPPnorpKQ08oa
Xy6tBakLRScnfp1sm2mFR3lpO0ySrF3uOT7dKGuSCF9qlcPvRQnjaFb2mTEo2TAF
20dNjhVgr5+BJ4RWGVJ/JsZRFvq+5kKJgdoz80LAByXrzOjrQ9K6Z9mXP1RjKXiw
qjNg7hV/YU9UDC8FOFjSMLp0qwIZVM1YaAyXdBR56nkqVNfWo3jrdcsEo6l4R7sQ
HbBBqTB3LhZXTIMBAbyiOFAtKfFo6Ah44HRrrXgs7dWOGBHzk1v/2rExCd7PbO2k
Lizt8W4ozev/e//vhe63U5rgZLeKzRZJvLuhRvgf63UW6G5joblIZJ0BZTNe/q8t
PTEPoGpVfazIkl5vEljK9IJkKidYI0V1BIyAhfuAeE/n0/5F7/6UktqiWwMwMzhg
ko54PB6NyV8oY8NseXpuV+qz4CpcL17Oa1gJeN8aSRUm8R8Fi0TSSLjJwXg/Mh7+
90fnip7XUAbDvVfg4MMESuaJuqGRnFGbbBgD0QTW0HgjO8DVDMyAY4D53G8Ucxti
KeS2vo7pbG+g+M2h2Ec/ExicDd5DuVLfLeEWzGycQooVyltn15hP7zmSflQCZ8FC
EZ3V+hBc8yc=
=KBz+
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_878de5d9_20250115_090828.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2023/12/24/2) [[next>]](2) [[<thread-prev]](../../../2023/12/24/1) [[thread-next>]](../../../2023/12/26/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <32345105-4692-465c-9a1d-e668c23df18d@hostland.ru>
Date: Mon, 25 Dec 2023 21:27:37 +0300
From: kai <kai@...tland.ru>
To: oss-security@...ts.openwall.com
Subject: Re: Re: New SMTP smuggling attack

Happy christmas list!

If anyone needs patch for postfix's 3.3.0-1ubuntu0.4
smtpd_forbid_bare_newline feature it has been attached to this message

On 24/12/2023 12.33, Marcus Meissner wrote:
> On Sat, Dec 23, 2023 at 02:29:34PM +0200, Valtteri Vuorikoski wrote:
>> On Fri, Dec 22, 2023 at 11:46:48AM +0100, Marcus Meissner wrote:
>>> Hi,
>>>
>>> FWIW as no CVEs were to be found yet, I filed a CVE request for Postfix now.
>>>
>>> Not sure if we need it for others like sendmail too, as that is also
>>> referenced by the security researchers.
>> Looks like exim opened a bug on this yesterday too, no sign of CVE yet:
>> <<https://bugs.exim.org/show_bug.cgi?id=3063>>
> CVEs are assigned now for:
>
> - CVE-2023-51764 postfix
> - CVE-2023-51765 sendmail
> - CVE-2023-51766 exim
>
> Ciao, Marcus
View attachment "[smtp-smuggling33.patch](1/1)" of type "text/x-patch" (6395 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.exim.org_f876863c_20250115_221236.html ===


| Bugzilla – Bug 3063 | "SMTP Smuggling" attack | Last modified: 2024-02-02 08:09:56 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](docs/html/bug_page.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=3063&GoAheadAndLogIn=1)

  Remember

  [x]
* |
  [Forgot Password](show_bug.cgi?id=3063&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

*First*
*Last*
*Prev*
*Next*

*This bug is not in your last
search results.*

[**Bug 3063**](show_bug.cgi?id=3063) -
"SMTP Smuggling" attack

|  | |
| --- | --- |
| [Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.") | "SMTP Smuggling" attack |

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Exim | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Exim "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Mail Receipt | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4.93 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | medium security | | [Target Milestone](page.cgi?id=fields.html#target_milestone): | Exim 4.98 | | [Assigned To](page.cgi?id=fields.html#assigned_to): | Jeremy Harris | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords](describekeywords.cgi): |  | | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=3063&hide_resolved=1) / [graph](showdependencygraph.cgi?id=3063) | | |  | | Reported: | 2023-12-22 10:53 UTC by Simon Arlott | | --- | --- | | Modified: | 2024-02-02 08:09 UTC ([History](show_activity.cgi?id=3063)) | | CC List: | 5 users (show)  exim-dev nobrowser pcernko unki viktor1dane | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=3063&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=3063&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=3063#c0)  Simon Arlott    2023-12-22 10:53:57 UTC  ``` Exim is partially vulnerable to <https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/>  Exim incorrectly allows <LF>.<LF> to end a message: "However, for the case when a dot on a line by itself terminates a message, the only recognized terminating sequences before and after the dot are LF and CRLF"  <https://www.rfc-editor.org/rfc/rfc5321>: "In particular, the sequence <LF>.<LF> (bare line feeds, without carriage returns) MUST NOT be treated as equivalent to <CRLF>.<CRLF> as the end of mail data indication."  With pipelining disabled, Exim is accepting one command after the end of a message. (I don't think it should do this.)  With pipelining enabled, Exim will accept commands up to DATA but no further. It's not possible to send a message like this but a precisely arranged set of packets and network congestion at exactly the right time would make it possible. ``` [Comment 1](show_bug.cgi?id=3063#c1)  Viktor Dukhovni    2023-12-22 20:57:30 UTC  ``` Does Exim enforce pipelining conformance by default?  That is, what is the default behaviour of Exim when an SMTP client expedites some data before receiving a reply to a command (e.g. *DATA*) that should be the *last* in a pipeline group?  Also, I should note that (as specified in RFC1830) BDAT is NOT the last command in a pipeline group, and so Exim will accept two messages via a transaction of the form:     MAIL FROM:<sender>    RCPT TO:<nobody>    DATA    From: Some Sender <sender>    To: Discarded Rcpt <nobody>    Subject: ...     <Some Message>    <LF>.<LF>    MAIL FROM:<forged-sender>    RCPT TO:<real-rcpt>    BDAT <length> LAST    From: Forged Sender <forged-sender>    To: Real Rcpt <real-rcpt>    Subject: Wire all your assets to me     <Phishing attack>    QUIT  It is sadly legal to pipeline any number of messages without any pauses with BDAT.  So provided the upstream system does not support CHUNKING, and treats non-standard line endings (<LF>.<LF> or <LF>.<CR><LF>) as normal message content to be sent verbatim, the SMTP smuggling scenario will work with that system as the sending and Exim as the receiving MTA. ``` [Comment 2](show_bug.cgi?id=3063#c2)  Jeremy Harris    2023-12-22 21:57:29 UTC  ``` (In reply to Viktor Dukhovni from [comment #1](show_bug.cgi?id=3063#c1)) > Does Exim enforce pipelining conformance by default?  In general yes, but specifically for the 354 "DATA go-ahead", not by default.  It's possible to induce one.  I could see some value in a change to always enforce.  > That is, what is the default behaviour of Exim when an SMTP client expedites  > Also, I should note that (as specified in RFC1830) BDAT is NOT the last > command in a pipeline group, and so Exim will accept two messages via a > transaction of the form: >  >    MAIL FROM:<sender> >    RCPT TO:<nobody> >    DATA  Um, that was DATA and not BDAT.  >    From: Some Sender <sender> >    To: Discarded Rcpt <nobody> >    Subject: ... >  >    <Some Message> >    <LF>.<LF>  and IF that gets treated as the dot closing off data, such that the following are taken as commands for a further message:  >    MAIL FROM:<forged-sender> >    RCPT TO:<real-rcpt> >    BDAT <length> LAST >    From: Forged Sender <forged-sender> >    To: Real Rcpt <real-rcpt> >    Subject: Wire all your assets to me >  >    <Phishing attack> >    QUIT  ... that "phishing attack" could just as easily have been sent as a sole message.  It will still be subject to all the same Access Control List operations, either way. ``` [Comment 3](show_bug.cgi?id=3063#c3)  Viktor Dukhovni    2023-12-22 22:06:42 UTC  ```  (In reply to Jeremy Harris from [comment #2](show_bug.cgi?id=3063#c2)) > (In reply to Viktor Dukhovni from [comment #1](show_bug.cgi?id=3063#c1)) > > Does Exim enforce pipelining conformance by default? >  > In general yes, but specifically for the 354 "DATA go-ahead", not > by default.  It's possible to induce one. >  > I could see some value in a change to always enforce.  That would likely be prudent.   > > Also, I should note that (as specified in RFC1830) BDAT is NOT the last > > command in a pipeline group, and so Exim will accept two messages via a > > transaction of the form: > >  > >    MAIL FROM:<sender> > >    RCPT TO:<nobody> > >    DATA >  > Um, that was DATA and not BDAT.  That's DELIBERATE.  The BDAT in question is in the BODY of the upstream message (below), preceded by <LF>.<LF>.  We need DATA from the upstream system to make some variant of <CRLF>.<CRLF> be end-of-message, but then its SMTP smuggling payload can use BDAT to bypass any pipelining enforcement.  >  > >    From: Some Sender <sender> > >    To: Discarded Rcpt <nobody> > >    Subject: ... > >  > >    <Some Message> > >    <LF>.<LF> >  > and IF that gets treated as the dot closing off data, such that the > following are taken as commands for a further message: >  > >    MAIL FROM:<forged-sender> > >    RCPT TO:<real-rcpt> > >    BDAT <length> LAST > >    From: Forged Sender <forged-sender> > >    To: Real Rcpt <real-rcpt> > >    Subject: Wire all your assets to me > >  > >    <Phishing attack> > >    QUIT >  > ... that "phishing attack" could just as easily have been sent > as a sole message.  It will still be subject to all the same > Access Control List operations, either way.  But the scenario in question assumes that the victim of forgery has DMARC, and that the sending system would normally restrict the alleged "From:" address (as is the typical case for submission via public email providers, hosting many customer domains, including perhaps their own).  In this attack scenario, the sending system is unaware that there's a second message in the body of the first, and the alignment of "From:" with the sender credentials is not enforced, but SPF-based DMARC checks still pass... ``` [Comment 4](show_bug.cgi?id=3063#c4)  Jeremy Harris    2023-12-24 19:32:41 UTC  ``` <https://nvd.nist.gov/vuln/detail/CVE-2023-51766>  git master: cf1376206284 & 5bb786d5ad56 address this. 5bb7 has a dependency on 4596719398f6 (which is only coding-style changes; not strictly part of the fixes).  Interested parties capable of building from git are invited to do so; these commits are not in a release package from the Exim project at this time. ``` [Comment 5](show_bug.cgi?id=3063#c5)  Jeremy Harris    2023-12-25 16:19:41 UTC  ``` I was was wrong about the lack of synch check for DATA.  There has always been one, so the one added in cf1376 is not needed (but will do no harm). ``` [Comment 6](show_bug.cgi?id=3063#c6)  Jeremy Harris    2023-12-29 12:51:08 UTC  ``` Security release 4.97.1 includes the relevant changes. ``` [Comment 7](show_bug.cgi?id=3063#c7)  Simon Arlott    2024-01-02 12:14:04 UTC  ``` > Dec 2023: getting a site to send a body including an "LF . LF" sequence > followed by SMTP commands is a possible "smtp smuggling" attack.  If > the first (header) line for the message has a proper CRLF then enforce > that for the body: convert bare LF to a space.  This still doesn't comply with RFC5321 because it allows <LF>.<LF> to end the message if the first header line ends with <LF>.  I expect that converting <LF> to a space is going to lead to further security or interoperability problems because it will mean Exim will merge two lines in a <CRLF>-based message if there's an <LF> in the middle of them, potentially changing the meaning of the message by merging two or more header lines together or merging the body with the headers.  Can't it just accept the message as-is, using dot duplication if the entire line is "."? ``` [Comment 8](show_bug.cgi?id=3063#c8)  Jeremy Harris    2024-01-02 12:19:27 UTC  ``` (In reply to Simon Arlott from [comment #7](show_bug.cgi?id=3063#c7)) > This still doesn't comply with RFC5321 because it allows <LF>.<LF> to end > the message if the first header line ends with <LF>.  That is deliberate, as there are use-cases that require it. ``` [Comment 9](show_bug.cgi?id=3063#c9)  Simon Arlott    2024-01-02 12:25:32 UTC  ``` You've not answered my other query on why Exim is replacing LF with a space. ``` [Comment 10](show_bug.cgi?id=3063#c10)  Ian    2024-01-02 17:42:53 UTC  ``` (In reply to Jeremy Harris from [comment #6](show_bug.cgi?id=3063#c6)) > Security release 4.97.1 includes the relevant changes.  Do any of these changes affect the octets which a transport filter sees? I have some suspect occurrences after upgrading (but not pointing a finger yet). ``` [Comment 11](show_bug.cgi?id=3063#c11)  Ian    2024-01-02 17:45:29 UTC  ``` (In reply to Jeremy Harris from [comment #8](show_bug.cgi?id=3063#c8)) > (In reply to Simon Arlott from [comment #7](show_bug.cgi?id=3063#c7)) > > This still doesn't comply with RFC5321 because it allows <LF>.<LF> to end > > the message if the first header line ends with <LF>. >  > That is deliberate, as there are use-cases that require it.  Can we have a configuration knob to disable it? Maybe even disable the LF ending headers.  I am up for coding it. ``` [Comment 12](show_bug.cgi?id=3063#c12)  Jeremy Harris    2024-01-02 18:04:03 UTC  ``` (In reply to Ian from [comment #10](show_bug.cgi?id=3063#c10)) > (In reply to Jeremy Harris from [comment #6](show_bug.cgi?id=3063#c6)) > > Security release 4.97.1 includes the relevant changes. >  > Do any of these changes affect the octets which a transport filter sees? I > have some suspect occurrences after upgrading (but not pointing a finger > yet).  Not directly, but if Exim is sending messages that it has previously received, the changes that are in the receive path would affect those messages - so if you are using a transport filter...  (In reply to Ian from [comment #10](show_bug.cgi?id=3063#c10)) > Can we have a configuration knob to disable it?  > I am up for coding it.  It doesn't seem technically infeasible.  I trust you have read around the relevant comments in the code regarding the support, and are willing to keep both pieces when it breaks - and include testcases for the testsuite, and maintain the new code for the forseeable future.  Please open a separate wishlist item for tracking this. ``` [Comment 13](show_bug.cgi?id=3063#c13)  Simon Arlott    2024-01-02 18:42:33 UTC  ``` (In reply to Simon Arlott from [comment #7](show_bug.cgi?id=3063#c7)) > > Dec 2023: getting a site to send a body including an "LF . LF" sequence > > followed by SMTP commands is a possible "smtp smuggling" attack.  If > > the first (header) line for the message has a proper CRLF then enforce > > that for the body: convert bare LF to a space. >  > I expect that converting <LF> to a space is going to lead to further > security or interoperability problems because it will mean Exim will merge > two lines in a <CRLF>-based message if there's an <LF> in the middle of > them, potentially changing the meaning of the message by merging two or more > header lines together or merging the body with the headers. >  > Can't it just accept the message as-is, using dot duplication if the entire > line is "."?  Jeremy, you've still not explained why Exim is now changing message content like this. Postfix and Sendmail don't do it. ``` [Comment 14](show_bug.cgi?id=3063#c14)  Viktor Dukhovni    2024-01-02 19:02:15 UTC  ``` (In reply to Simon Arlott from [comment #13](show_bug.cgi?id=3063#c13)) >  > Jeremy, you've still not explained why Exim is now changing message content > like this. Postfix and Sendmail don't do it.  Well, Postfix does in fact change message content when, for example, folding overly long headers or body lines, in order to ensure RFC-compliant SMTP output. In this case a line-break + space is inserted, and even without attempting to find a semantically appropriate context, garbage-in, garbage-out.  So it wouldn't be entirely unprecedented to replace non-conformant input with a plausible best-effort approximation.  That said, Postfix stores message content lines as "records", they have neither "LF" nor "CRLF" endings, they're either "Normal" records (complete lines to be <CRLF> terminated on output) or "Continued" records (line fragments, to which the next record is appended on output).  As a result, while both <LF> and <CRLF> were accepted as line endings on input (leading to a "Normal" queue file record), the output is <CRLF> terminated either way.  So it would perhaps be more natural to canonicalise <LF>.<LF> to <CRLF>.<CRLF> (but without treating it as end-of-message!).  The result would then be subject to dot-stuffing (SMTP transparency) on output.  One might accept <LF>.<LF> as message end only from clients whose "EHLO" and all subsequent SMTP commands up to and including "DATA" are <LF> terminated.  This allows some legacy unix-native SMTP clients to continue to work, while requiring RFC-conformant line-endings from all others. ``` [Comment 15](show_bug.cgi?id=3063#c15)  Ian    2024-01-08 06:21:52 UTC  ``` (In reply to Jeremy Harris from [comment #12](show_bug.cgi?id=3063#c12)) > (In reply to Ian from [comment #10](show_bug.cgi?id=3063#c10)) > > (In reply to Jeremy Harris from [comment #6](show_bug.cgi?id=3063#c6)) > > > Security release 4.97.1 includes the relevant changes. > >  > > Do any of these changes affect the octets which a transport filter sees? I > > have some suspect occurrences after upgrading (but not pointing a finger > > yet). >  > Not directly, but if Exim is sending messages that it has previously > received, the changes that are in the receive path would affect those > messages - so if you are using a transport filter... >  > (In reply to Ian from [comment #10](show_bug.cgi?id=3063#c10)) > > Can we have a configuration knob to disable it? >  > > I am up for coding it. >  > It doesn't seem technically infeasible.  I trust you have read around the > relevant comments in the code regarding the support, and are willing to > keep both pieces when it breaks - and include testcases for the testsuite, > and maintain the new code for the forseeable future. >  > Please open a separate wishlist item for tracking this.  Reading the code in receive.c, I'm having some ... second thoughts :-P  But maybe, and yes I understand that testcases are required. ``` [Comment 16](show_bug.cgi?id=3063#c16)  Simon Arlott    2024-01-08 08:06:47 UTC  ``` (In reply to Viktor Dukhovni from [comment #14](show_bug.cgi?id=3063#c14)) > (In reply to Simon Arlott from [comment #13](show_bug.cgi?id=3063#c13)) > >  > > Jeremy, you've still not explained why Exim is now changing message content > > like this. Postfix and Sendmail don't do it. >  > Well, Postfix does in fact change message content when, for example, folding > overly long headers or body lines, in order to ensure RFC-compliant SMTP > output. > In this case a line-break + space is inserted, and even without attempting > to find a semantically appropriate context, garbage-in, garbage-out. >  > So it wouldn't be entirely unprecedented to replace non-conformant input > with a plausible best-effort approximation.  You could say the same thing about <LF>.<LF>, which is the cause of this problem to begin with. It could allow new attacks based on adding and removing headers.  Incoming message with a second subject header hidden in what looks like the message body:  ``` Received: ...<CRLF> X-Placeholder1: A<LF> Subject: A<CRLF> <LF> X-Placeholder2: B<CRLF> Subject: B<CRLF> <CRLF> Message body<CRLF> .<CRLF> ```  Spooled message with alternative subject header exposed:  ``` Received: ... Received: ... X-Placeholder1: A Subject: A  X-Placeholder2: B Subject: B  Message body ```  > As a result, while both <LF> and <CRLF> were accepted as line endings on > input (leading to a "Normal" queue file record), the output is <CRLF> > terminated either way.  So it would perhaps be more natural to canonicalise > <LF>.<LF> to <CRLF>.<CRLF> (but without treating it as end-of-message!).  > The result would then be subject to dot-stuffing (SMTP transparency) on > output.  I think this is the approach that should be taken.  > One might accept <LF>.<LF> as message end only from clients whose "EHLO" and > all subsequent SMTP commands up to and including "DATA" are <LF> terminated. > This allows some legacy unix-native SMTP clients to continue to work, while > requiring RFC-conformant line-endings from all others.  This could be implemented by checking that no <CR> character has been received anywhere in the plaintext of the connection (without needing to specifically check line endings on every command).  A host list or expanded configuration variable would allow it to be accepted only from specific clients.  (It could exclude checking the message content itself because a message with CRLF line endings could be sent through an SMTP client that only uses LF line endings, but that allows a form of SMTP smuggling.) ``` [Comment 17](show_bug.cgi?id=3063#c17)  Simon Arlott    2024-02-02 08:09:56 UTC  ``` This is already creating interoperability problems in conjunction with the default strict line length limits, because a message body containing bare LFs which get converted to spaces can make the lines longer:  "< znx> after a recent upgrade .. we have noted that newlines seem to be getting stripped from a message body. still testing to determine exactly what is going on. but the message is accepted (passing a linelength check) and then rejected when it tries to router (failing a linelength check). messages which don't fail the linelength check .. get through but have their newlines stripped    and replaced by spaces. content is HTML. < jgh> I bet you're feeding bare CR's in < znx> possibly, I think it is from Oracle directly, not sure how it handles < znx> the newlines are in the message body"  This unexplained change should be reverted. As long as Exim understands the message correctly it can normalise the line endings when storing it. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=3063)
* - [XML](show_bug.cgi?ctype=xml&id=3063)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=3063)
* - Top of page

*First*
*Last*
*Prev*
*Next*

*This bug is not in your last
search results.*

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](docs/html/bug_page.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=3063&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=3063&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.openwall.com_023466ac_20250115_090828.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](../../../2023/12/30/1) [[<thread-prev]](../../../2023/12/26/5) [[thread-next>]](../../../2023/12/30/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <f3008fbc-4dbc-49ae-ba0a-1badbad2466f@oracle.com>
Date: Fri, 29 Dec 2023 12:50:55 -0800
From: Alan Coopersmith <alan.coopersmith@...cle.com>
To: oss-security@...ts.openwall.com, Claus Assmann <ml+oss@...tp.org>
Subject: Re: Re: New SMTP smuggling attack

On 12/26/23 11:15, Claus Assmann wrote:
> On Sun, Dec 24, 2023, Marcus Meissner wrote:
>
>> - CVE-2023-51765 sendmail
>
> Can you update the text for this (or point me to the proper way/persons
> to do this)?

<https://www.cve.org/CVERecord?id=CVE-2023-51765> shows:
   Assigner: MITRE Corporation

so you can submit updates/corrections via the web form at:
   <https://cveform.mitre.org/>

--
         -Alan Coopersmith-                 alan.coopersmith@...cle.com
          Oracle Solaris Engineering - <https://blogs.oracle.com/solaris>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from cveform.mitre.org_c3616b63_20250115_221238.html ===


[![CVE logo](Content/cveLogoR.svg)](https://cve.org/)

[CVE Records
![CVE Record search](Content/search_icon.png)](https://cve.mitre.org/cve/search_cve_list.html)

[Search CVE Records](https://cve.mitre.org/cve/search_cve_list.html)

## Submit a CVE Request

\* Required

![errors](Content/exclamation.jpg)

\* Select a request type

- Please choose an action -
Report Vulnerability/Request CVE ID
Notify CVE about a publication
Request an update to an existing CVE Entry
Request information on the CVE Numbering Authority (CNA) Program
Other

![errors](Content/exclamation.jpg)

\* Enter your e-mail address

![alert](Content/info.jpg)

IMPORTANT: Please add cve-request@mitre.org and cve@mitre.org as
safe senders in your email client before completing this form.

Enter a PGP Key (to encrypt)

Processing....

#### Legal

* [Terms of Use](https://cve.org/Legal/TermsOfUse)
* [Privacy Policy](https://cve.org/Legal/PrivacyPolicy)

#### Media

* [News](https://cve.org/Media/News)
* [Events](https://cve.org/Media/Events)
* [Sign up for e-newsletter](https://cve.mitre.org/news/newsletter.html)

##### Social Media

[github

![](Content/github.png)](https://github.com/CVEProject)
[linkedin

![](Content/linkedin.png)](https://www.linkedin.com/showcase/cve-cwe-capec)
[youtube

![](Content/youtube.png)](https://www.youtube.com/channel/UCUHd2XFDsKH8kjMZQaSKpDQ/)
[twitter for CVE New

![](Content/twitter.png)
New CVE Records](https://twitter.com/CVEnew/)
[twitter for CVE announce

![](Content/twitter.png)
 CVE Announce](https://twitter.com/CVEannounce/)

#### Contact

* [CVE Program Support](https://cveform.mitre.org)
* [CNA](https://cve.org/PartnerInformation/ListofPartners)
* [CVE Website Support](https://cveform.mitre.org)

Use of the CVE® List and the associated references from this website are subject to the
[terms of use](https://cve.org/Legal/TermsOfUse). CVE is sponsored by the
[U.S. Department of Homeland Security (DHS)](https://www.dhs.gov/)
 [Cybersecurity and Infrastructure Security Agency (CISA)](https://www.dhs.gov/cisa/cybersecurity-division/). Copyright © 1999-2023,
[The MITRE Corporation](https://www.mitre.org/). CVE and the CVE logo are registered trademarks of The MITRE Corporation.

×
#### Vulnerability Information

Vulnerability Type

CWE-ID

Definition

Buffer Overflow

[CWE-119](http://cwe.mitre.org/data/definitions/119.html)

The software performs operations on a memory buffer, but it can read from or write to a memory location that is outside of the intended boundary of the buffer.

Cross Site Scripting (XSS)

[CWE-79](http://cwe.mitre.org/data/definitions/79.html)

The software does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.

SQL Injection

[CWE-89](http://cwe.mitre.org/data/definitions/89.html)

The software constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component.

Directory Traversal

[CWE-22](http://cwe.mitre.org/data/definitions/22.html)

The software uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the software does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.

XML External Entity (XXE)

[CWE-611](http://cwe.mitre.org/data/definitions/611.html)

The software processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.

Insecure Permissions

[CWE-276](http://cwe.mitre.org/data/definitions/276.html)

The software, upon installation, sets incorrect permissions for an object that exposes it to an unintended actor.

Incorrect Access Control

[CWE-284](http://cwe.mitre.org/data/definitions/284.html)

The software does not restrict or incorrectly restricts access to a resource from an unauthorized actor.

Integer Overflow

[CWE-190](http://cwe.mitre.org/data/definitions/190.html)

The software performs a calculation that can produce an integer overflow or wraparound, when the logic assumes that the resulting value will always be larger than the original value. This can introduce other weaknesses when the calculation is used for resource management or execution control.

Cross Site Request Forgery (CSRF)

[CWE-352](http://cwe.mitre.org/data/definitions/352.html)

The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.

Missing SSL certification verification

[CWE-599](http://cwe.mitre.org/data/definitions/599.html)

The software uses OpenSSL and trusts or uses a certificate without using the SSL\_get\_verify\_result() function to ensure that the certificate satisfies all necessary security requirements.

Other or Unknown

N/A

The software contains a mistake other than above which can be directly used by a hacker to gain access to a system or network.

×
#### Other Vulnerability Information

You can find more information at [cwe.mitre.org](http://cwe.mitre.org)

* Algorithm complexity
* Array index error
* Auth bypass using cookie
* Buffer Overflow
* Cross-Site Request Forgery (CSRF)
* Cross-Site Scripting (XSS)
* Directory Traversal
* Double free
* Eval injection
* File Upload
* Format String
* HTTP Response Splitting

* HTTP Request Splitting
* Incomplete blacklist
* Integer Overflow
* Integer Signedness
* Memory Leak
* Shell Metacharacter Injectoin
* Open Redirect
* Redirect without Exit
* Path Disclosure
* Insecure Permissions
* PHP remote file inclusion
* Session Fixation

* SQL Injection
* Symbolic Link Following
* Untrusted Search Path
* Unquoted Windows search path
* Use after free
* Default user/password
* Large or infinite loop
* Exposed insecure/unsafe method in ActiveX control
* Generation of insufficiently random numbers
* XML Extneral Entity (XXE)
* Incorrect Access Control
* Missing SSL certificate validation

×
#### Vulnerability Information

Attack Type

Definition

Remote

The vulnerability can be exploited through a network. The attacker may be either on the adjacent or remote network.

Local

To exploit the vulnerability, the attacker needs to be logged into the operating system on a local machine or a guest operating system.

Physical

The attacker needs to be located near the victim or have physical access to the vulnerable system to exploit the vulnerability. Examples include touching a workstation keyboard or USB device, "shoulder surfing" to see a workstation's display, and touching the screen of a mobile device.

Context-dependent

The type of access needed to exploit the vulnerability is dependent on how the vulnerable product is used. This is most often used for libraries.

×
#### Vulnerability Information

Update Type

Definition

Duplicate

More than one CVE ID has been assigned to a single vulnerability.

Rejection

Vendor rejects the assignment of a particular CVE ID.

Split/Merge

A single CVE Entry should be split into two or more CVE Entries OR Two or more existing CVE Entries should be merged into a single CVE Entry.

Update Description

Update the description in an existing CVE Entry.

Update References

Add, remove, or change a reference for an existing CVE Entry.

Other

Any request related to an existing CVE Entry that does not fall within one of the other categories.



=== Content from www.youtube.com_6c0f97f0_20250115_090850.html ===
[00:00] [Music]
[00:14] okay so the next talk is going to be by
[00:18] Teo longin also known as teimo login
[00:22] he's a security consultant and a
[00:23] researcher he will be talking about a
[00:25] new technique called SMTP smuggling for
[00:29] spoofing emails and exploit one of the
[00:31] most widely used services on the
[00:32] internet thank you give it up for
[00:35] [Applause]
[00:41] Timo thank you thank you for the
[00:43] introduction so first of all a big fat
[00:47] sorry for me personally and from Sault
[00:50] for this absolute dumpster fire of a
[00:53] vulnerability disclosure so specifically
[00:56] sorry to Vita and Victor for having to
[00:59] well fix post fix and to all the CIS
[01:03] admins Worldwide having to apply these
[01:05] fixes during Christmas
[01:07] holidays and also
[01:10] however yeah also however big thanks to
[01:15] V and Victor for their commitment and
[01:18] also big thanks to the community for
[01:21] pushing this issue for releasing tools
[01:24] and so on and for
[01:28] okay
[01:31] [Applause]
[01:35] and for everyone that has no idea what
[01:37] is going on let me catch you up to speed
[01:40] so about a year ago I was just finish
[01:43] finishing up some DNS research and I was
[01:45] looking for a new research Target when I
[01:49] probably found the easiest way to hack a
[01:52] company and all that just with one
[01:55] simple Google
[01:58] search
[02:00] and it might sound stupid but this led
[02:03] me into the direction of something that
[02:05] I already knew but I never really
[02:07] realized and that is that fishing is
[02:10] still the number one initial axis Vector
[02:13] into a company and then it hit me like
[02:16] why don't I look at SMTP the simple mail
[02:19] transfer protocol which is used to send
[02:21] like billions of emails each day across
[02:24] the globe for like the past 40 years so
[02:27] my journey went on from DNS to MTP and
[02:30] today I'm introducing SMTP smuggling a
[02:33] novel technique for spoing
[02:35] emails who am I my name is Timo longin I
[02:39] work as a security consultant at second
[02:41] SE consult and a day I do penetration
[02:44] tests and at night I do vulnerability
[02:46] research and for like the past 3 years
[02:49] I've been looking at lots of DNS
[02:51] vulnerabilities and I've published lots
[02:53] of blog posts and
[02:55] tools and yeah I had to move on and the
[02:59] last time time someone from Sault had a
[03:01] talk at the
[03:03] CCC it was about
[03:08] dildos and I know that I have to
[03:10] disappoint at least some of you but this
[03:13] talk is not about penetrating the human
[03:15] life
[03:16] form however it is about penetrating
[03:19] SMTP protocol barriers so to see how
[03:24] this works well we must first understand
[03:26] how sending emails in general works so
[03:29] here we have a pretty simple email
[03:31] infrastructure we have a mail user agent
[03:34] for example Thunderbird and Thunderbird
[03:36] like wants to send an email via user
[03:39] outlook.com for example so now if we
[03:42] want to send an email that way we must
[03:44] first authenticate against the Outlook
[03:47] mail transfer agent or outbound SMTP
[03:52] server and once we've authenticated
[03:54] we're now allowed to send an email as
[03:56] user
[03:58] outlook.com and and only as user
[04:01] outlook.com and this email then gets
[04:03] transferred over to the receiver inbound
[04:06] SMTP server and this inbound SMTP server
[04:09] is now checking the email for
[04:11] authenticity and the most popular way of
[04:14] doing this is via SPF so the receiver
[04:18] inbound server is basically getting the
[04:20] SPF record via DNS for outlook.com and
[04:24] then it sees okay these IP addresses and
[04:26] IP ranges are allowed to send emails for
[04:30] outlook.com and since in this case the
[04:32] legitimate Outlook SMTP server or
[04:35] outbound SMTP server sent the email well
[04:38] the inbound receiver accepts it and now
[04:42] of course there is well a very
[04:44] interesting question and the question is
[04:47] well is is it possible for an attacker
[04:50] to send an email for example from admin
[04:53] at outlook.com or from a spoofed email
[04:56] address and this is what we're going to
[04:58] look at today and that's more more or
[04:59] less the goal of This
[05:01] research and I don't know if you've
[05:03] realized but the colors of these servers
[05:06] and I cannot unced but they really
[05:08] remind me of SpongeBob and
[05:11] Patrick and therefore we're going to
[05:13] refer to them as
[05:15] such so the general goal of This
[05:18] research and the premise of this re
[05:20] research was like finding a way to spoof
[05:23] emails and I was like okay why not take
[05:26] vulnerabilities from other text based
[05:29] product protols like
[05:31] HTTP and put them into
[05:34] SMTP and there was just one HTTP
[05:37] vulnerability that really fit the bill
[05:40] and that is HTTP request
[05:43] smuggling and the thing is we again see
[05:46] we have SpongeBob and Patrick but in
[05:48] this case in the HTTP world so what
[05:51] happens here is SpongBob is getting a
[05:54] request a post request over the
[05:57] internet and the interesting thing about
[06:00] this post request is that it has two
[06:03] headers
[06:05] specifying how to handle the post
[06:07] requist data it has a Content length
[06:09] header specifying 43 bytes and it also
[06:12] has a transfer encoding header and now
[06:15] SpongeBob has to decide okay well how do
[06:17] I handle the post data now and SpongeBob
[06:20] decides to use the content length and
[06:23] since the content length is 43 bytes
[06:26] well all the red highlighted data is
[06:28] forwarded to p Patrick and Patrick is
[06:30] not like okay I have no idea what to do
[06:33] so am I interpreting the content length
[06:35] or the transfer en coding but now
[06:36] Patrick is interpreting the transfer
[06:38] encoding and now we have an
[06:40] interpretation
[06:41] difference SpongeBob uses the content
[06:44] length Patrick is using the transfer
[06:47] encoding and since the transfer encoding
[06:49] specifies chunked and the first chunk is
[06:51] zero well the rest of the data that
[06:54] SpongeBob transferred is now interpreted
[06:56] as a second request which which now
[06:59] basically means that SpongeBob sees one
[07:01] request and Patrick sees two requests
[07:04] and the second request can have like or
[07:06] can Target an arbitrary path like for
[07:09] example admin which in this example is
[07:11] only accessible
[07:13] internally which is of course a problem
[07:16] and I was like okay why not take these
[07:18] interpretation differences and put them
[07:20] into SMTP and to understand or to get
[07:24] close to understanding how this works at
[07:26] least we must first look at the SMTP
[07:30] protocol itself so SMTP basically looks
[07:33] like this we have two main components we
[07:35] have in red SMTP commands and we have in
[07:38] blue the message data and to send a
[07:42] message now we must first send the SMTP
[07:46] commands so we must first introduce
[07:48] ourselves we must specify a sender
[07:50] address one or more recipient addresses
[07:53] and then we send a data command to tell
[07:57] the receiving SMTP server to essentially
[08:01] yeah now receive the message data and
[08:04] then we send message data we specify a
[08:07] from address again we specify a two
[08:09] address we specify a subject and then
[08:12] comes the message body and at some point
[08:14] when we now want to stop transferring
[08:16] the message data we must send something
[08:19] that is called an end of data sequence
[08:22] which is a carage return line feed.
[08:25] carriage return line
[08:27] feed and now was like well maybe we can
[08:30] use that to somehow confuse SMTP server
[08:36] implementations and the idea was
[08:38] basically that we have SpongeBob again
[08:41] and we submit an email to
[08:44] SpongeBob and this email contains
[08:47] something very weird it is something
[08:49] that looks like an end of data sequence
[08:51] but it's not an end of data sequence
[08:54] because it's not RFC conform but like
[08:56] someone could mistake it for an end of
[08:59] data sequence so SpongeBob looks at this
[09:01] and it's like okay this is not the thing
[09:03] from the RFC I'm not going to interpret
[09:05] this as n of data sequence so the the
[09:08] next or the message data that follows to
[09:10] this is still like message data until
[09:12] the actual end of data sequence comes
[09:16] and now SpongeBob sends this over to
[09:18] Patrick and now Patrick is like uh yeah
[09:20] I don't really care about rfc's so what
[09:23] I do is well I interpret this fake end
[09:26] of data sequence as an actual end of
[09:28] data sequence
[09:29] and the problem here is that everything
[09:31] following this end of data sequence is
[09:33] now interpreted as SMTP
[09:36] commands and what we can do now as an
[09:39] attacker is we can specify SMTP commands
[09:42] that send another email so even though
[09:45] SpongeBob only saw one big email Patrick
[09:48] is now seeing two smaller emails and the
[09:51] problem is that the second email can
[09:54] have like arbitrary SMTP commands
[09:56] meaning it could come from admin at
[09:58] Outlook look.com or
[10:00] whatever so yeah that's the theory at
[10:04] least and to see if this really
[10:07] works I first of all checked out some
[10:10] SMTP server implementations by simply
[10:12] connecting to some servers via tnet or
[10:15] via
[10:16] netcat and when I did that and I sent
[10:19] the data command first of all it looked
[10:21] like very RFC conform so basically when
[10:25] you send the data command the server
[10:26] asks you to stop this data stream via
[10:29] carryer turn line feed. carer turn Line
[10:32] Feed but then I also found some servers
[10:34] that just say well just send me a DOT on
[10:37] Al line by itself and the thing with
[10:39] this do on Al line by itself is that
[10:41] it's very much dependent on the
[10:43] operating system that you're on meaning
[10:46] on Windows this could be a carriage
[10:48] return line feed. carriage return line
[10:50] feed on Linux this could be a line feed
[10:53] doline
[10:54] feed and at that point I I thought I was
[10:57] on to something so
[11:00] I checked something out and the first
[11:02] thing I tried is like using these kinds
[11:05] of line feeds Carriage returns dots and
[11:08] trying to like stuff them through
[11:10] SpongeBob so I wrote an SMTP analysis
[11:13] client which basically sends emails
[11:16] containing fake end of data sequences
[11:18] for example line feed. linefeed and I
[11:21] sent them through various kinds of SMTP
[11:23] software this includes email services
[11:25] like Gmail like Outlook like GMX but Al
[11:29] email software like send mail like
[11:31] postfix XM Microsoft uh Exchange Server
[11:34] and so on and now on the inbound side on
[11:38] the inbound receiver side I checked
[11:41] which fake sequences actually go through
[11:44] so can I send a line feed. line feed
[11:48] through an outbound server and in most
[11:51] cases it doesn't work like a line feed.
[11:54] line feed very often just gets filtered
[11:56] or removed from the initial email
[12:00] but in some
[12:01] cases it just goes through without a
[12:04] change and this was the case for GMX so
[12:08] basically I send an email from GMX to my
[12:11] analysis server and the line feed.
[12:13] carriage return line feed sequence did
[12:15] not get filtered whatsoever so now what
[12:17] I did is I created a proof of concept
[12:21] here where first of all we s an email
[12:23] then we have this fake end of data
[12:25] sequence and then we have SMTP commands
[12:28] and data for a second email so now if
[12:31] this proof of concept works we should
[12:33] receive two emails on our receiver end
[12:37] and I sent all of this to Gmail and
[12:39] Gmail was like yeah this is not an end
[12:42] of data sequence and you can see that
[12:45] because everything after this end of
[12:47] data sequence is still interpreted as
[12:48] message
[12:49] data but in some cases it actually works
[12:54] and this was the first case of
[12:56] successful SMTP smuggling so from GMX to
[13:00] FastMail and we can see that it works
[13:03] because well we have two emails we have
[13:04] first of all user at gmx.net and
[13:07] secondly an email from admin gmx.net
[13:10] that passes SPF and Demar checks as well
[13:13] because it comes from the actual server
[13:16] from
[13:19] [Applause]
[13:27] GMX and I was like okay this is super
[13:32] sick but I was thinking so we have this
[13:35] second email and everything can be in
[13:37] there like the sender address can be
[13:39] anything so why not try other domains
[13:43] that point to the server of
[13:46] GMX and then I analyzed the SPF record
[13:49] and I realized well there we have the
[13:52] GMX SPF record but this is very similar
[13:56] to the web de SP PF record which is also
[14:00] very similar to the one of
[14:02] yonos and the thing is that we can now
[14:05] spoof like 1.35 million domains with
[14:08] this so if you don't know yonos they're
[14:11] like a super big hosting provider and
[14:13] they also provide emailing services and
[14:15] yeah they have like all these 1.35
[14:17] million domains pointing here so yeah I
[14:22] had of course had to try this so here's
[14:24] an email from admin at
[14:27] webd and now of course there's a
[14:29] question of does this work everywhere
[14:32] because as I said this only works with
[14:35] servers that interpret well non RFC
[14:38] conform end of data sequences like line
[14:40] feed. carry to return
[14:41] linefeed so we can smuggle or spoof
[14:44] these 1.35 million domains to well some
[14:49] servers so essentially we have 1.4
[14:52] million postfix instances and like 150k
[14:55] sand mail instances and this works well
[14:58] because they interpret car interpret
[15:01] Line feed. Car linefeed confusing myself
[15:03] here as n of data
[15:06] sequence and I was like okay this is
[15:08] pretty severe but there is more so I
[15:12] looked at outlook.com as well and
[15:15] Outlook gave me a very weird uh error
[15:18] message because they were like bare line
[15:20] feeds are illegal and I was like oh damn
[15:23] they they know what I'm doing
[15:27] here
[15:29] and therefore I analyzed it like okay
[15:32] you're not going to scare me with that
[15:33] one so then I found out well line feed.
[15:36] carriage Line Feed is also possible
[15:48] here yeah so let's have some
[15:50] fun the thing is however at that point I
[15:52] wasn't really sure if I'm going insane
[15:54] or if this actually works so I needed
[15:56] some kind of Sanity check and
[15:59] therefore I sent an email from
[16:00] admin@outlook.com to some
[16:03] co-workers and the idea behind this is
[16:06] if they react to this it works otherwise
[16:09] I'm insane
[16:11] so
[16:16] yeah and maybe now for a more
[16:19] International example because this is
[16:21] very Austrian I guess I don't know so
[16:27] yeah
[16:30] I guess you also understand this if you
[16:32] don't speak
[16:33] German and now you might be like okay we
[16:36] can send text based spoofed emails but
[16:39] you're not going to like fool anyone
[16:41] with this but thing is like we can
[16:43] smuggle basically anything HTML included
[16:47] so here I sent an email a fishing email
[16:51] an an unusual signin activity email from
[16:54] no reply at outlook.com from the actual
[16:57] outlook.com server was to myself and it
[17:00] just went
[17:02] through yeah but again what's what's
[17:07] possible with this and I was wondering
[17:10] so we can spoof outlook.com but what
[17:13] what else can we do with this so I
[17:16] looked at the SPF record and it was well
[17:20] weird in terms of weirdly familiar
[17:23] because this is not only the SPF record
[17:25] of outlook.com but also the SPF record
[17:28] of like millions of other
[17:31] domains because this is actually like
[17:35] the SPF record from exchange online
[17:39] because outlook.com sends its emails
[17:41] well Across The Exchange online
[17:43] infrastructure so yeah now we can
[17:46] basically spoof them all so I again had
[17:49] to test this
[17:57] one
[18:06] but the thing is here this only worked
[18:08] on a technical level so I didn't get the
[18:12] race so what's the impact essentially we
[18:15] can spoof from millions of domains but
[18:18] who accepts these emails again post fix
[18:21] and send mail however only postfix and
[18:24] sand mail instances they do not support
[18:26] the bat command and the bat command is
[18:29] like an alternative to the data command
[18:31] and if that is supported it doesn't
[18:34] work so that was outbound SMTP smuggling
[18:38] so that is like one part of it but then
[18:40] there is also inbound SMTP smuggling and
[18:44] with outbound SMTP smuggling the issue
[18:46] was basically at the outbound server
[18:48] because the outbound server basically
[18:51] failed to filter or insufficiently
[18:53] filtered like fake end of data sequences
[18:56] like line feed. Carri feed so now with
[19:00] Microsoft and GMX and then there's also
[19:03] inbound SMTP smuggling and this happens
[19:06] when there is just an inbound server
[19:09] that interprets such a wild end of data
[19:12] sequence that the outbound server would
[19:15] never even get the idea of filtering
[19:17] that and I found exactly that with Cisco
[19:20] secure of course
[19:22] email Cloud
[19:25] Gateway so because what they do is they
[19:28] clean the message and every bare Line
[19:31] Feed and every bare Carri turn character
[19:34] now gets replaced with a carriage return
[19:36] line feed so essentially a carriage
[19:39] return. carriage return gets interpreted
[19:42] as end of data
[19:46] [Applause]
[19:53] sequence and the issue of course is now
[19:57] that this Carri return. carar return
[19:59] does not get filtered at all basically
[20:02] so there are of course some service that
[20:04] filter this but we have again exchange
[20:06] online iCloud sent mail postfix and so
[20:09] many others that just let this through
[20:11] and I guess it kind of makes sense to
[20:13] let this through because I wouldn't get
[20:14] the idea of filtering that
[20:16] either so I had to test this out
[20:20] again and unfortunately or well
[20:24] technically it worked again but I did
[20:25] not receive any Apple devices not that I
[20:28] wanted that anyways but
[20:33] yeah what's the impact here so
[20:35] essentially we can spoof from even more
[20:38] domains as before like we have exchange
[20:40] online we have iCloud we have all post
[20:43] fix and
[20:44] sendmail and we can spoof to companies
[20:48] that can actually afford this stuff so
[20:50] like pretty big companies here this also
[20:54] includes like 40 other uh 40K other
[20:57] domains and that that's only the ones
[20:59] that are hosted in a cloud so they're
[21:01] also on Prime but I wasn't able to
[21:03] enumerate
[21:05] them yeah and now to the part that's
[21:08] probably interesting to you or to the
[21:11] most at least so the responsible
[21:14] disclosure so essentially on a purely
[21:17] technical level regarding inbound and
[21:20] outbound servers who's at fault here so
[21:22] essentially we have inbound servers that
[21:24] are never supposed or not supposed to
[21:26] interpret anything else as end of data
[21:28] sequence then a carriage return line
[21:30] feed. carriage return line feed at least
[21:32] by the RFC and then there are outbound
[21:35] SMTP servers that are not supposed to
[21:37] send Carriage returns and line feeds
[21:40] independent of each other so yeah
[21:42] basically everyone's at fault so we sent
[21:44] that to GMX and they were like super
[21:47] thankful and they were like okay we're
[21:49] going to fix this right away 10 days
[21:51] later they fixed this they said okay can
[21:54] we recheck this we recheck this they
[21:56] actually fixed this they paid us a small
[21:59] Bounty they even put us in their back
[22:02] Bounty Hall of Fame and all all on like
[22:05] that was a 10 out of 10
[22:07] [Applause]
[22:14] experience I'm going to send them this
[22:16] clip of you clapping thank you and yeah
[22:20] it really felt like we should have paid
[22:22] them the back bound you because yeah but
[22:25] the thing is from here it just goes
[22:27] downhill
[22:29] so we have Microsoft and Microsoft was
[22:32] like yeah this is like a moderate risk
[22:35] vulnerability
[22:37] because I don't know I guess they have
[22:39] bigger fish to fry but yeah
[22:43] anyways so we sent it to them and like 3
[22:47] months later they closed the case and
[22:49] said yeah all right it's fixed no bnie
[22:52] whatsoever so okay but the thing is at
[22:55] that point well I already got what I
[22:57] want wanted and that's an email from
[23:00] admin
[23:04] microsoft.com and now to Cisco well
[23:07] Cisco was like okay this is not a
[23:09] vulnerability this is a documented and
[23:12] configurable
[23:23] [Applause]
[23:25] feature and we were like okay that's a
[23:27] weird feature because
[23:30] like we can spoof some emails with that
[23:34] so yeah we said okay at least like tell
[23:37] your customers about this feature that
[23:39] it's maybe not the best default feature
[23:42] but yeah
[23:44] anyways yeah they said
[23:47] no
[23:49] yeah so then we were like okay we got
[23:52] this whole big SMTP smuggling issue
[23:54] Cisco doesn't want to fix anything
[23:56] Microsoft at that point was was
[23:58] vulnerable and we take this case to C CC
[24:02] and C CC for all of you that don't know
[24:04] that is the C coordination Center and
[24:07] they basically handle all these big
[24:08] vulnerabilities so that could have a
[24:10] worldwide impact and we sent this to
[24:12] them and they actually accepted the case
[24:15] and now you're like in this Vince portal
[24:18] this which is basically a big glorified
[24:20] chat room with 14 vendors we have like
[24:23] sent mail Microsoft Cisco uh Google in
[24:26] there and yeah so now you can start
[24:29] talking about the vulnerability and the
[24:31] first conversation was basically with
[24:33] Cisco still saying that they're not
[24:35] vulnerable you know yeah it's not a bug
[24:38] it's a feature and yeah essentially they
[24:42] were still like it's not a vulnerability
[24:44] and then sis uh CC was like yeah this is
[24:47] not a vulnerability for some reason okay
[24:50] so what about the general SMTP smuggling
[24:53] problem so what about postfix and sent
[24:56] mail interpreting non RFC conform and of
[24:58] data
[25:00] sequences so first of all sent mail was
[25:02] in this Vince portal to begin with so
[25:05] from the start they got all the puc's
[25:07] all the messages all yeah everything and
[25:11] they were like they didn't say anything
[25:14] and then what about postfix because
[25:17] they're 10 times larger essentially C CC
[25:20] was like first of all I don't know why
[25:22] they didn't add them to the case
[25:24] directly but they sent them an email or
[25:27] contacted them VI email but forgot to
[25:29] mention SMTP smuggling so now we're here
[25:33] thinking that they told po so we thought
[25:35] that they told postfix sent mail
[25:37] apparently didn't care C CC sides with
[25:41] Cisco regarding this feature so now
[25:44] we're like okay CIS uh Cisco yeah is
[25:47] definitely vulnerable we've confirmed
[25:49] that so we would like to publish this
[25:51] any blog post and that's where all the
[25:53] problem
[25:54] starts so we said okay okay we would
[25:58] like to publish this any blog post and
[26:00] we would warn Cisco customers about the
[26:02] feature and CC is like go ahead so just
[26:08] send us the link to the blog post once
[26:10] this is
[26:11] published and we were like yeah we go
[26:15] ahead with that and now basically we
[26:17] opened Pandora's Box because now 1.6
[26:21] million post M uh post fix and send mail
[26:24] instances on the internet are vulnerable
[26:26] meaning now if there is another case of
[26:29] outbound SMTP smuggling you can smuggle
[26:32] to post fix and send mail
[26:35] still does that mean second consult is
[26:37] not at fault at all of course sa consult
[26:39] is at fault because we published this
[26:41] blog post thinking that the impact of
[26:44] all of this is way lower than it
[26:46] actually is based on our great
[26:49] conversation with CTC and Vince in
[26:51] general and also if we would have just
[26:54] double checked that with postfix that
[26:56] this is really not not an issue none of
[26:58] this would have happened because postfix
[27:00] is very adamant about the fact that this
[27:02] is actually an
[27:03] issue so yeah in conclusion what does
[27:07] this mean please fix your postfix
[27:09] service you can find more information
[27:11] about that on the postfix website also
[27:14] please fix your Cisco service you can
[27:16] find more information about that on the
[27:18] second consult blog
[27:26] post
[27:30] [Applause]
[27:31] in the end however there is some kind of
[27:34] Sil Silver Lining at least because now
[27:36] postfix is directly in the Vince case
[27:39] and they've already made some great
[27:41] contributions so we're not putting our
[27:43] head in the sand and we're actively
[27:44] somehow trying to close Pandora's Box
[27:47] again and what does that mean
[27:49] essentially more research on like SMTP
[27:53] smuggling I mean asked straty before to
[27:55] like look at this more but yeah this
[27:58] didn't really end well and more blog
[28:01] posts more research first first and
[28:03] foremost um more vendors in the Vince
[28:06] case so we're trying to get everything
[28:08] fixed right now and again we are very
[28:10] sorry that this happened in the first
[28:13] place and
[28:16] finally something that probably all of
[28:18] you know anyways do not trust emails
[28:22] blindly especially not
[28:26] now thank you
[28:38] [Applause]
[28:45] nice thank you let's go with the Q&A um
[28:48] please go ahead hello I one small
[28:52] question the C CC stuff was this
[28:55] communicated via email and could you not
[28:59] have sent the mail at Cisco
[29:02] CD um yeah I mean we could have done
[29:06] that and created some kind of love
[29:07] triangle between Bill Gates Elon Musk
[29:10] and someone else I guess
[29:13] but yeah no we didn't see this email
[29:16] unfortunately like we saw it after that
[29:19] yeah but then it was kind of too late
[29:24] unfortunately uh hi thank you appreciate
[29:27] the work um can you maybe tell us a
[29:30] little bit about the timeline like when
[29:33] did you first discover this like how
[29:35] fresh this was first discovered so I
[29:38] started the research in June this year
[29:41] so basically we I had a research project
[29:43] at Sault for like 10 days and I was like
[29:46] okay these 10 days they're not going to
[29:47] be enough so I started 10 days earlier
[29:50] and then I like found SMTP smuggling on
[29:54] day six and yeah then it just goes on
[29:57] from telling this GMX Outlook or
[30:01] Microsoft and Cisco because they had
[30:04] these severe cases of SMTP smuggling
[30:06] meaning outbound and inbound and then we
[30:08] went ahead and told this to cery because
[30:10] there seems to be a general issue with
[30:13] SMTP smuggling worldwide and timeline
[30:16] wise I don't have it here right now but
[30:18] it is in the second Sal blog post and
[30:22] yeah but is is there a specific date
[30:25] that you want to know no no just I'll
[30:27] check the blog post
[30:29] thanks
[30:31] one hello um thank you for the good talk
[30:37] here um I wanted to ask is there any
[30:39] evidence or any suggestions that this
[30:42] has been used already um because this
[30:46] seems like a well pretty easy exploit to
[30:50] use so I might imagine it has been used
[30:53] already yeah I've mean I mean I received
[30:56] some comments on on my Reddit post and
[30:58] it was like yeah this is super old but
[31:01] thing
[31:02] is medium severity yeah probably no I I
[31:07] don't know I don't know really I I
[31:09] looked at lots of research but nothing
[31:11] really said otherwise so that's why I
[31:13] called it the novel vulnerability so I
[31:15] don't
[31:26] know
[31:27] [Music]
[31:38] la

=== Content from www.openwall.com_56a99a57_20250115_090827.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2023/12/23/5) [[next>]](2) [[<thread-prev]](../../../2023/12/23/2) [[thread-next>]](../../../2023/12/25/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20231224093335.GM14101@suse.de>
Date: Sun, 24 Dec 2023 10:33:37 +0100
From: Marcus Meissner <meissner@...e.de>
To: oss-security@...ts.openwall.com
Subject: Re: Re: New SMTP smuggling attack

On Sat, Dec 23, 2023 at 02:29:34PM +0200, Valtteri Vuorikoski wrote:
> On Fri, Dec 22, 2023 at 11:46:48AM +0100, Marcus Meissner wrote:
> > Hi,
> >
> > FWIW as no CVEs were to be found yet, I filed a CVE request for Postfix now.
> >
> > Not sure if we need it for others like sendmail too, as that is also
> > referenced by the security researchers.
>
> Looks like exim opened a bug on this yesterday too, no sign of CVE yet:
> <<https://bugs.exim.org/show_bug.cgi?id=3063>>

CVEs are assigned now for:

- CVE-2023-51764 postfix
- CVE-2023-51765 sendmail
- CVE-2023-51766 exim

Ciao, Marcus

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.openwall.net_ae5d8845_20250115_221235.html ===


| [lists.openwall.net](https://lists.openwall.net) [lists](/)  /  [announce](https://www.openwall.com/lists/announce/)  [owl-users](https://www.openwall.com/lists/owl-users/)  [owl-dev](https://www.openwall.com/lists/owl-dev/)  [john-users](https://www.openwall.com/lists/john-users/)  [john-dev](https://www.openwall.com/lists/john-dev/)  [passwdqc-users](https://www.openwall.com/lists/passwdqc-users/)  [yescrypt](https://www.openwall.com/lists/yescrypt/)  [popa3d-users](https://www.openwall.com/lists/popa3d-users/)  /  [oss-security](https://www.openwall.com/lists/oss-security/)  [kernel-hardening](https://www.openwall.com/lists/kernel-hardening/)  [musl](https://www.openwall.com/lists/musl/)  [sabotage](https://www.openwall.com/lists/sabotage/)  [tlsify](https://www.openwall.com/lists/tlsify/)  [passwords](https://www.openwall.com/lists/passwords/)  /  [crypt-dev](https://www.openwall.com/lists/crypt-dev/)  [xvendor](https://www.openwall.com/lists/xvendor/)  /  [Bugtraq](/bugtraq/)  [Full-Disclosure](/full-disclosure/)  [linux-kernel](/linux-kernel/)  linux-[netdev](/netdev/)  [linux-ext4](/linux-ext4/)  [linux-hardening](/linux-hardening/)  [linux-cve-announce](/linux-cve-announce/)  [PHC](/phc-discussions/)| *Open Source and information security mailing list archives*|  | | | | |
| --- | --- | --- | --- | --- |

| | [Hash Suite: Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

# Open Source and information security mailing list archives

### Openwall-hosted community mailing lists

* [oss-security](https://www.openwall.com/lists/oss-security/)
  ([info](https://oss-security.openwall.org/wiki/mailing-lists/oss-security)) -
  Open Source software security discussions
  (there's also a [wiki](https://oss-security.openwall.org/wiki/))* [kernel-hardening](https://www.openwall.com/lists/kernel-hardening/) -
    Linux kernel security hardening discussions (see also linux-hardening below)* [libc-coord](https://www.openwall.com/lists/libc-coord/) -
      [coordination of work on standard C libraries (libc)](https://www.openwall.com/lists/libc-coord/2020/01/30/1)* [musl](https://www.openwall.com/lists/musl/) - discussions around
        [musl](https://www.musl-libc.org),
        a new standard C library for Linux* [passwords](https://www.openwall.com/lists/passwords/) - discussions on anything related to passwords
          except what better fits on other mailing lists* [sabotage](https://www.openwall.com/lists/sabotage/) -
            discussions around Sabotage Linux,
            an experimental distribution based on musl and BusyBox* [tlsify](https://www.openwall.com/lists/tlsify/) - [a TLS API](https://www.openwall.com/lists/tlsify/2015/09/28/1)
              for file-descriptor-oriented applications to make use of secure (TLS) sockets
              without invasive changes to their programming model

### Openwall mailing lists

* [announce](https://www.openwall.com/lists/announce/) - announcements only, very low traffic* [owl-users](https://www.openwall.com/lists/owl-users/) -
    [Openwall GNU/\*/Linux](https://www.openwall.com/Owl/) (Owl) user discussions* [owl-dev](https://www.openwall.com/lists/owl-dev/) - Owl development discussions* [lkrg-users](https://www.openwall.com/lists/lkrg-users/) -
        [Linux Kernel Runtime Guard](https://www.openwall.com/lkrg/) user discussions* [john-users](https://www.openwall.com/lists/john-users/) -
          [John the Ripper](https://www.openwall.com/john/) password cracker user discussions

          See also:
          [selected most useful and currently relevant postings](https://openwall.info/wiki/john/mailing-list-excerpts)* [john-dev](https://www.openwall.com/lists/john-dev/) -
            John the Ripper development discussions* [passwdqc-users](https://www.openwall.com/lists/passwdqc-users/) -
              [passwdqc](https://www.openwall.com/passwdqc/)
              password/passphrase strength checking and policy enforcement toolset user discussions* [yescrypt](https://www.openwall.com/lists/yescrypt/) -
                discussions around [yescrypt](https://www.openwall.com/yescrypt/) KDF and password hashing scheme* [popa3d-users](https://www.openwall.com/lists/popa3d-users/) -
                  [popa3d](https://www.openwall.com/popa3d/) Unix POP3 daemon user discussions

### Obsolete/inactive Openwall(-hosted) mailing lists

* [crypt-dev](https://www.openwall.com/lists/crypt-dev/) -
  [design and implementation of a new password hashing method for servers](https://www.openwall.com/lists/crypt-dev/2011/04/05/2)* [xvendor](https://www.openwall.com/lists/xvendor/)
    ([info](https://www.openwall.com/community/xvendor)) -
    collaboration and information exchange between OS distribution vendors
    (mostly Linux) on non-security topics

### Other (third-party) mailing lists

* [Bugtraq](bugtraq/) -
  security vulnerability announcements and discussions, pre-moderated* [Full-Disclosure](full-disclosure/) -
    security vulnerability announcements and discussions, originally not moderated but now also pre-moderated* [linux-kernel](linux-kernel/) -
      Linux kernel development discussions, very high volume* [netdev](netdev/) -
        Linux networking subsystem development discussions, high volume* [linux-ext4](linux-ext4/) -
          Linux ext4 filesystem development* [linux-hardening](linux-hardening/) -
            Linux kernel security hardening discussions (focused on upstream maintenance of the changes)* [linux-cve-announce](linux-cve-announce/) -
              [Linux kernel CVE announcements](https://docs.kernel.org/process/cve.html)* [PHC discussions](phc-discussions/) -
                [Password Hashing Competition](https://password-hashing.net)
                discussions

Quick Comment:

| [Powered by Openwall GNU/*/Linux](https://www.openwall.com/Owl/ "Powered by Openwall GNU/*/Linux - security-enhanced \"Linux distribution\"") [Powered by OpenVZ](https://openvz.org "Powered by OpenVZ - OS virtualization solution for Linux") 781096 | |
| --- | --- |



=== Content from access.redhat.com_1f709436_20250115_221219.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.openwall.com_bf666f39_20250115_090828.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](../../../2023/12/27/1) [[<thread-prev]](../../../2023/12/25/1) [[thread-next>]](../../../2023/12/29/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20231226191528.GA6930@veps.esmtp.org>
Date: Tue, 26 Dec 2023 19:15:28 +0000
From: Claus Assmann <ml+oss@...tp.org>
To: oss-security@...ts.openwall.com
Subject: Re: New SMTP smuggling attack

On Sun, Dec 24, 2023, Marcus Meissner wrote:

> - CVE-2023-51765 sendmail

Can you update the text for this (or point me to the proper way/persons
to do this)?

1.
"sendmail through at least 8.14.7"
->
sendmail up to and including 8.17.2

2.
remove the seemingly unrelated reference to
"Merge sendmail 8.14.8 to HEAD  freebsd/freebsd-src@...76dd"

3.
Mention that 8.18 fixes the problem:
	Accept only CR LF . CR LF as end of an SMTP message as
		required by the RFCs when the new srv_features
		option 'o' is used.

sendmail 8.18.0.2 is available at
<https://ftp.sendmail.org/snapshots/sendmail.8.18.0.2.tar.gz>
<https://ftp.sendmail.org/snapshots/sendmail.8.18.0.2.tar.gz.sig>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_13072032_20250115_090845.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](6) [[thread-next>]](../../../2023/12/22/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20231221144656.GA40693@veps.esmtp.org>
Date: Thu, 21 Dec 2023 14:46:56 +0000
From: Claus Assmann <ml+oss@...tp.org>
To: oss-security@...ts.openwall.com
Subject: Re: New SMTP smuggling attack

Just for completeness:
sendmail 8.18.0.2 has options to handle this too, e.g.,
	Accept only CR LF . CR LF as end of an SMTP message as
		required by the RFCs when the new srv_features
		option 'o' is used.

And for those who read the source code there's also an FFR:
	/* enable checking for "bare LF" in message */
	"_FFR_BARE_LF",

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_6f88b7c6_20250115_090838.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffreebsd%2Ffreebsd-src%2Fcommit%2F5dd76dd0cc19450133aa379ce0ce4a68ae07fb39)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffreebsd%2Ffreebsd-src%2Fcommit%2F5dd76dd0cc19450133aa379ce0ce4a68ae07fb39)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=freebsd%2Ffreebsd-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[freebsd](/freebsd)
/
**[freebsd-src](/freebsd/freebsd-src)**
Public

* [Notifications](/login?return_to=%2Ffreebsd%2Ffreebsd-src) You must be signed in to change notification settings
* [Fork
  2.9k](/login?return_to=%2Ffreebsd%2Ffreebsd-src)
* [Star
   8.1k](/login?return_to=%2Ffreebsd%2Ffreebsd-src)

* [Code](/freebsd/freebsd-src)
* [Pull requests
  67](/freebsd/freebsd-src/pulls)
* [Actions](/freebsd/freebsd-src/actions)
* [Security](/freebsd/freebsd-src/security)
* [Insights](/freebsd/freebsd-src/pulse)

Additional navigation options

* [Code](/freebsd/freebsd-src)
* [Pull requests](/freebsd/freebsd-src/pulls)
* [Actions](/freebsd/freebsd-src/actions)
* [Security](/freebsd/freebsd-src/security)
* [Insights](/freebsd/freebsd-src/pulse)

## Commit

[Permalink](/freebsd/freebsd-src/commit/5dd76dd0cc19450133aa379ce0ce4a68ae07fb39)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge sendmail 8.14.8 to HEAD

[Browse files](/freebsd/freebsd-src/tree/5dd76dd0cc19450133aa379ce0ce4a68ae07fb39)
Browse the repository at this point in the history

```
MFC after:	5 days
```

* Loading branch information

[![@gshapiro](https://avatars.githubusercontent.com/u/1781031?s=40&v=4)](/gshapiro)

[gshapiro](/freebsd/freebsd-src/commits?author=gshapiro "View all commits by gshapiro")
committed
Jan 26, 2014

2 parents
[2482c27](/freebsd/freebsd-src/commit/2482c270bb1343686d0ac2ed740396ba777f258f)
+
[c1bfccf](/freebsd/freebsd-src/commit/c1bfccf73ee6551521d508e89408309544c871c8)

commit 5dd76dd

 Show file tree

 Hide file tree

Showing
**491 changed files**
with
**1,782 additions**
and
**1,127 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* contrib/sendmail

  + contrib/sendmail/LICENSE
    [LICENSE](#diff-5b19f8e9be69b2de821818f96056bf12a5d2c417f5cb9e9c3db94b0e84d0306c)
  + contrib/sendmail/PGPKEYS
    [PGPKEYS](#diff-3d6d892b6df7feaf51a1fce615970c8f6689e4795abfd6be5b46cc7e6c0fcf3a)
  + contrib/sendmail/README
    [README](#diff-afdf514b32ac88004952c11660c57bc96c3d8b2234007c1cbd8d7ed7fd7935cc)
  + contrib/sendmail/RELEASE\_NOTES
    [RELEASE\_NOTES](#diff-55daab7a32441c223901d0b134f808c253273f2a4d280db7e4136fd9afa70b4e)
  + cf

    - contrib/sendmail/cf/README
      [README](#diff-8f60c0428c575ee292609c02bb11e6780cc7d7b5662bd679e85854d4e2754b67)
    - cf

      * contrib/sendmail/cf/cf/chez.cs.mc
        [chez.cs.mc](#diff-8755f4e131c8b55c54840fce94665aeb1e1637743ca04f6c7da1e84b2ed8b291)
      * contrib/sendmail/cf/cf/clientproto.mc
        [clientproto.mc](#diff-7d75d5f4267cb55d65a7e7d013b0aff2b55ebdd72fa06b7eff1190ab021e9ef1)
      * contrib/sendmail/cf/cf/cs-hpux10.mc
        [cs-hpux10.mc](#diff-f68f1fa1e8b0ff7f41efc04181e54382f7e14f7473ec8a0dd3d489bfd3e2c189)
      * contrib/sendmail/cf/cf/cs-hpux9.mc
        [cs-hpux9.mc](#diff-968e1f57c28328174f49b50219f77e60df76dc66f730ac9662b65585a56f614e)
      * contrib/sendmail/cf/cf/cs-osf1.mc
        [cs-osf1.mc](#diff-7e5d4a60a88b109aa9f40240328833f561a8727896ffeebd0f5be5c79871c110)
      * contrib/sendmail/cf/cf/cs-solaris2.mc
        [cs-solaris2.mc](#diff-21672faef77ef52c62f8d00ba5d25dda1e7b01a513b9f27435d58c968b825ff1)
      * contrib/sendmail/cf/cf/cs-sunos4.1.mc
        [cs-sunos4.1.mc](#diff-73a45db047b32d0180c22def9c1f366268358abcb1a130e7409c65b5099f9089)
      * contrib/sendmail/cf/cf/cs-ultrix4.mc
        [cs-ultrix4.mc](#diff-16ce61cbeb699ee67847ec2c547fe5106d9bc2fa813f34960d54d482885a7bad)
      * contrib/sendmail/cf/cf/generic-bsd4.4.mc
        [generic-bsd4.4.mc](#diff-881a17b81173a50c51362712fd7945a0bdfcd9e08fb81333918d7eab5b6dd15d)
      * contrib/sendmail/cf/cf/generic-hpux10.mc
        [generic-hpux10.mc](#diff-7a2c678728e57042b2a959aa6d104563ef88657852f0b07599365ef0506ed59e)
      * contrib/sendmail/cf/cf/generic-hpux9.mc
        [generic-hpux9.mc](#diff-a5abc27d316aa08329b7a12a757428741f8d7bdcd55e5b63ddb704155efe8912)
      * contrib/sendmail/cf/cf/generic-linux.mc
        [generic-linux.mc](#diff-cd260c7147b81c04d672fecf4d3369b96e32234c1be9c7dff2ca3af967baea36)
      * contrib/sendmail/cf/cf/generic-mpeix.mc
        [generic-mpeix.mc](#diff-06c57a7856c13f8e6538cc33df86d4961a051b42194146a0813249d8f9b67c79)
      * contrib/sendmail/cf/cf/generic-nextstep3.3.mc
        [generic-nextstep3.3.mc](#diff-c56e04fd05a943ceb7d230fe52d37dc1f1313c254cfa334ab204fc552c152cf4)
      * contrib/sendmail/cf/cf/generic-osf1.mc
        [generic-osf1.mc](#diff-b5c5daee9dc66ba6e9d2c49effa24a2bf7ee4b462fb508e4d8d380ef3fa0d132)
      * contrib/sendmail/cf/cf/generic-solaris.mc
        [generic-solaris.mc](#diff-b9fd85b987104cd0197416f85e34f0264dbd873eb778989cff836ba4e473fd2f)
      * contrib/sendmail/cf/cf/generic-sunos4.1.mc
        [generic-sunos4.1.mc](#diff-cb2734cb723defcd1d3c6780006f82d229a71955019b2dfe6e0f25de65f1cf81)
      * contrib/sendmail/cf/cf/generic-ultrix4.mc
        [generic-ultrix4.mc](#diff-44f68cd20ad740647b82884481ce99889185f82b72977909b0c50f6bba80cff0)
      * contrib/sendmail/cf/cf/huginn.cs.mc
        [huginn.cs.mc](#diff-a2b1f56fdb51564a77e40598f296dddcfa871e026466561ca95172418365dcc5)
      * contrib/sendmail/cf/cf/knecht.mc
        [knecht.mc](#diff-db035ea4aacf2cce816d578ceb2591d39e8bb01dbb4080d49829d57b573d6383)
      * contrib/sendmail/cf/cf/mail.cs.mc
        [mail.cs.mc](#diff-45147f5dd029ac05cd8b5d43a67e0b1baa31f261d40b770b9c8d1afc75146583)
      * contrib/sendmail/cf/cf/mail.eecs.mc
        [mail.eecs.mc](#diff-3bf41fcafa5b4c194df50b89c2db311de1ee3437e7d05260e45cb6fbbafa6be6)
      * contrib/sendmail/cf/cf/mailspool.cs.mc
        [mailspool.cs.mc](#diff-8bd0c485422a227d146414ff8527379ae4bf299827c512d6064cdc10e43194eb)
      * contrib/sendmail/cf/cf/python.cs.mc
        [python.cs.mc](#diff-e22d41e578f6876402f547afe7cbfdf1d9383c0eaed3622604da7abcba133536)
      * contrib/sendmail/cf/cf/s2k-osf1.mc
        [s2k-osf1.mc](#diff-f921fde3f45ae82453df2a8d992204e91b36d8a4a3199cb7d87d38fe781e32b6)
      * contrib/sendmail/cf/cf/s2k-ultrix4.mc
        [s2k-ultrix4.mc](#diff-db705cf247ff0395d0320842e6915e87099358ef32ec66d44ccef383e85c646a)
      * contrib/sendmail/cf/cf/submit.cf
        [submit.cf](#diff-c4c4eec8ab91cb339ad9ec0c3cbce1d6433d2475e9795c0ecf010ee98bed1932)
      * contrib/sendmail/cf/cf/submit.mc
        [submit.mc](#diff-28f39505da22e8708a04f20eddf01eff825833fb11dfe7d2c4a3c3405f14dadb)
      * contrib/sendmail/cf/cf/tcpproto.mc
        [tcpproto.mc](#diff-507622e2f3cb75e902b05232b2e6cdd7de9f59b230c8229e1c1e7e2a1f491a52)
      * contrib/sendmail/cf/cf/ucbarpa.mc
        [ucbarpa.mc](#diff-0b08cdc2972a556e2435c719fd625e3585dc05bb50d5608d9ea2c4e396f347bc)
      * contrib/sendmail/cf/cf/ucbvax.mc
        [ucbvax.mc](#diff-e9f598124d772829d64aedcaf1b7dd0ed59ad11465d6d355ed1c77d01525f35c)
      * contrib/sendmail/cf/cf/uucpproto.mc
        [uucpproto.mc](#diff-002ee91563a466a5c187c40deb13b1c9207c5aff58ec3b14854dcb7571b3c876)
      * contrib/sendmail/cf/cf/vangogh.cs.mc
        [vangogh.cs.mc](#diff-56845dd173376f51c69ab61d0a9c89986a73ca9310531447e128877686b145fc)
    - domain

      * contrib/sendmail/cf/domain/Berkeley.EDU.m4
        [Berkeley.EDU.m4](#diff-3334da100dd0e921e27b9347a2ef0083fe380a04302cc0a83a323ae70c46ec9f)
      * contrib/sendmail/cf/domain/CS.Berkeley.EDU.m4
        [CS.Berkeley.EDU.m4](#diff-dd0bfa1fa56d8710e2a0364541fecf898243057954273ebb990629ae4a1e6321)
      * contrib/sendmail/cf/domain/EECS.Berkeley.EDU.m4
        [EECS.Berkeley.EDU.m4](#diff-d84700a8ffda4f076c31039677f96e5d4beb0caae78e6b65941098c1046e0267)
      * contrib/sendmail/cf/domain/S2K.Berkeley.EDU.m4
        [S2K.Berkeley.EDU.m4](#diff-f13ffa153205b5b0c2e097f69b2070b5b51b5e8bdd941a92c78436896115115b)
      * contrib/sendmail/cf/domain/berkeley-only.m4
        [berkeley-only.m4](#diff-0fd8dfa8209c4e427dfcd821e5c3a585a1c06b6df1985c9ce7644ddbf25c620d)
      * contrib/sendmail/cf/domain/generic.m4
        [generic.m4](#diff-aefcbcc8c2ac074910803035d5a617d2fe0f6e17752218f569042e5d25e38863)
    - feature

      * contrib/sendmail/cf/feature/accept\_unqualified\_senders.m4
        [accept\_unqualified\_senders.m4](#diff-78d72781b1d5897708270b3cbca0bf96bfd9cc3654720bb88854407f3ff21e2e)
      * contrib/sendmail/cf/feature/accept\_unresolvable\_domains.m4
        [accept\_unresolvable\_domains.m4](#diff-48a540629ea0a43e5d906133dfa27e1111d16a3a7aad4df2d1471c5980ee37be)
      * contrib/sendmail/cf/feature/access\_db.m4
        [access\_db.m4](#diff-6fa2a09157d5f4e5e2c6d02ccb54003707be990a3183dc8fb2f8d80c1595dd93)
      * contrib/sendmail/cf/feature/allmasquerade.m4
        [allmasquerade.m4](#diff-e5c0c845c1a11bcdf859b6c9c9381bea8a8197dc56193e01cb28d4d726f56eef)
      * contrib/sendmail/cf/feature/always\_add\_domain.m4
        [always\_add\_domain.m4](#diff-ec78c6b10fea38101a0cae8bfca6cb6251a208054a2dde9a1e9ebecf5dc3912f)
      * contrib/sendmail/cf/feature/authinfo.m4
        [authinfo.m4](#diff-08463662b9a4c4ef99360aa7ca3e97c405b6a8794f372aae913157c12d909a74)
      * contrib/sendmail/cf/feature/badmx.m4
        [badmx.m4](#diff-8f6bf448f1531e1a3c269e8e695d8346eff28935a601db0ad4d305d5282bc206)
      * contrib/sendmail/cf/feature/bestmx\_is\_local.m4
        [bestmx\_is\_local.m4](#diff-3cf9449ec9d172c1f1558dec213ac70e2a47a0216194cbaa10f202e424f3bfe2)
      * contrib/sendmail/cf/feature/bitdomain.m4
        [bitdomain.m4](#diff-55b67dea60ef66712045212c3adf9a83ef95a364d9ce7331d28164cf4fb1ec69)
      * contrib/sendmail/cf/feature/blacklist\_recipients.m4
        [blacklist\_recipients.m4](#diff-6b26dd39cf35a9fd172ef9f1e963d8bf75ea9eb19a5ad8562090183d072ea2f3)
      * contrib/sendmail/cf/feature/block\_bad\_helo.m4
        [block\_bad\_helo.m4](#diff-4839065878429d0847fa5e787cfc0f057a9cf262d05bb13294245c4c7d189546)
      * contrib/sendmail/cf/feature/compat\_check.m4
        [compat\_check.m4](#diff-385e6ff632431e521be8118251ebfa868b6a82cc9633b7bac45d39b526e4a3aa)
      * contrib/sendmail/cf/feature/conncontrol.m4
        [conncontrol.m4](#diff-475ac2619f8211c923ffd4fd5608942ebe60ef9d722d3a61cbd03953ba9f6749)
      * contrib/sendmail/cf/feature/delay\_checks.m4
        [delay\_checks.m4](#diff-9237c70e45a22ed27c0c966ce3f6d45b1ac7a7c3f12b31a1753f1dea7ec7b5ad)
      * contrib/sendmail/cf/feature/dnsbl.m4
        [dnsbl.m4](#diff-9fae2ac03a9bb037d1461dc2c9846fe7ac2fd9849f0b29c995947c656473064a)
      * contrib/sendmail/cf/feature/domaintable.m4
        [domaintable.m4](#diff-2a55cf8132dd0c19a5ad7a7a225a6d289bc6312c3845fadf02e1417464d471e8)
      * contrib/sendmail/cf/feature/enhdnsbl.m4
        [enhdnsbl.m4](#diff-ebb0262e1425fe71c4e9f96c6d22270e3d485fe1dc026e562074132c927aceea)
      * contrib/sendmail/cf/feature/generics\_entire\_domain.m4
        [generics\_entire\_domain.m4](#diff-48720c48e0846d3cea51aa75ddb70a8526519bdbd524feabc1b0fd54b1a9f57b)
      * contrib/sendmail/cf/feature/genericstable.m4
        [genericstable.m4](#diff-dcffb3b6edd85622bb1479054f89768eeb6d3bab62ffd38ce724347c25f26fcd)
      * contrib/sendmail/cf/feature/greet\_pause.m4
        [greet\_pause.m4](#diff-e8eb563d00079f30f3c560995e8cbc8de3587fc759652cc5293dc45b203d4744)
      * contrib/sendmail/cf/feature/ldap\_routing.m4
        [ldap\_routing.m4](#diff-871ba0a5a6d6681e1fd5d7dea4c4bcda2872d4e0a529d7e693bef2bf5f510d3b)
      * contrib/sendmail/cf/feature/limited\_masquerade.m4
        [limited\_masquerade.m4](#diff-fbbeff2c3915498d1c417d187ad3b5dd987efa649f838956348c7252447abb62)
      * contrib/sendmail/cf/feature/local\_lmtp.m4
        [local\_lmtp.m4](#diff-02a007f8b6d08bc79e63abb097c814daeb44001fb013fbea8db5a07f4c65fe45)
      * contrib/sendmail/cf/feature/local\_no\_masquerade.m4
        [local\_no\_masquerade.m4](#diff-30a62418d1169da957303ccbc846be330929392a0a6152d74b3bb327eec5d6b9)
      * contrib/sendmail/cf/feature/local\_procmail.m4
        [local\_procmail.m4](#diff-63faf0463b24b2c75522e2d8ef731791e64da375057dd6bc64b98c59049d9900)
      * contrib/sendmail/cf/feature/lookupdotdomain.m4
        [lookupdotdomain.m4](#diff-e5250aa36eab6a3c2d82140aa4428d25459a6bb8fd879cd200f7973cc7335993)
      * contrib/sendmail/cf/feature/loose\_relay\_check.m4
        [loose\_relay\_check.m4](#diff-2dd9c3ec65b24e79a46d3220e485a1f4b5eaaf566c6d3bb340f7a9f7d6a7c7bd)
      * contrib/sendmail/cf/feature/mailertable.m4
        [mailertable.m4](#diff-4bc5301e73609407b6f4cea8a4a188c6aeef30dbb775e77209f930a8f59ecac4)
      * contrib/sendmail/cf/feature/masquerade\_entire\_domain.m4
        [masquerade\_entire\_domain.m4](#diff-3298155a6f108687a97fcab826f79a7030fab9eab106a6406fe796d69b4d3a27)
      * contrib/sendmail/cf/feature/masquerade\_envelope.m4
        [masquerade\_envelope.m4](#diff-9f6c808d52e3b2fa136f168200b5e8d06b45ca524baf3b1e462d76ace880a7da)
      * contrib/sendmail/cf/feature/msp.m4
        [msp.m4](#diff-c69b93ed21a5d49ee1be4c6826dc125ad2aede3d7b936b34cabf5b53985a13c3)
      * contrib/sendmail/cf/feature/mtamark.m4
        [mtamark.m4](#diff-91779b61ca663e50a0ad1526c1047947c20ade22444ff42c0269ed387a65be23)
      * contrib/sendmail/cf/feature/no\_default\_msa.m4
        [no\_default\_msa.m4](#diff-b42254bd5d66d786d6cc20a7606958f1a19d675ee23cc76abeba48738dfbb28d)
      * contrib/sendmail/cf/feature/nocanonify.m4
        [nocanonify.m4](#diff-5e551e777cfe59ad57217b141073bce8c0e20cf4666c887e4a3a3ff883190fea)
      * contrib/sendmail/cf/feature/notsticky.m4
        [notsticky.m4](#diff-f9dd4cf83e5ea23c41bb474367b594be783c6e0a2515df25faab07804f850d3b)
      * contrib/sendmail/cf/feature/nouucp.m4
        [nouucp.m4](#diff-bbc8310a4ec5ebacb1f880508d1752aa7e287a7672411efbc6f8c23167bfc91c)
      * contrib/sendmail/cf/feature/nullclient.m4
        [nullclient.m4](#diff-770c367ccb87bd7e457f56133d4d414e49841343033c62b3ba240ea27525dad3)
      * contrib/sendmail/cf/feature/preserve\_local\_plus\_detail.m4
        [preserve\_local\_plus\_detail.m4](#diff-71acd61a3b918dadf7297d244c569e8953f8760c4302a8b501a50b6b5b7fcf13)
      * contrib/sendmail/cf/feature/preserve\_luser\_host.m4
        [preserve\_luser\_host.m4](#diff-1ab6db802698cc702024eb329782946a080b8f2bb8e023545c328c24dd891f07)
      * contrib/sendmail/cf/feature/promiscuous\_relay.m4
        [promiscuous\_relay.m4](#diff-0f7e8aea3b229af765205b1418384e7c82684c69abeac1c064442b0cb8fe7f0e)
      * contrib/sendmail/cf/feature/queuegroup.m4
        [queuegroup.m4](#diff-543333bb4d0ac5f1d5c2c047ffb3b606a1a4b3fec8f39bdbf5c1037236e26184)
      * contrib/sendmail/cf/feature/ratecontrol.m4
        [ratecontrol.m4](#diff-175b87269964cac67385dd2e042c73846df79ac60295fe36bc2ce83279b57934)
      * contrib/sendmail/cf/feature/redirect.m4
        [redirect.m4](#diff-db9ff335287e53a10374b16a1dbfb675e21b7091e8fb4d5a723298a3cf9f174b)
      * contrib/sendmail/cf/feature/relay\_based\_on\_MX.m4
        [relay\_based\_on\_MX.m4](#diff-1c3c69bf277f7272136a5d3f29c8fd7d90339c2ba8a318dfeb33ecfe9d330a33)
      * contrib/sendmail/cf/feature/relay\_entire\_domain.m4
        [relay\_entire\_domain.m4](#diff-9767cb97018170fd34944915d3584d45106e1ae8ad260ed8d45ccc315c96df11)
      * contrib/sendmail/cf/feature/relay\_hosts\_only.m4
        [relay\_hosts\_only.m4](#diff-d676d9d8d8ef683845a1d92beff0eafac41778b910a08b8840661e0c161fb61b)
      * contrib/sendmail/cf/feature/relay\_local\_from.m4
        [relay\_local\_from.m4](#diff-13501d4f5812fd6586678509316d36103b4bc615b15f11f9f90d4890b07e0801)
      * contrib/sendmail/cf/feature/relay\_mail\_from.m4
        [relay\_mail\_from.m4](#diff-2a8f63b632cf800af97add353320250685b3dce40fd16a6f509d85f3835bcf2d)
      * contrib/sendmail/cf/feature/require\_rdns.m4
        [require\_rdns.m4](#diff-d3fbfb3e370f0841a724e24cf06ae344d9f53764e90d6b10d02e02af72d21202)
      * contrib/sendmail/cf/feature/smrsh.m4
        [smrsh.m4](#diff-8c6053e2c275de8b6d014293031c7cfecf9112ce9bac99907425765d527d9be1)
      * contrib/sendmail/cf/feature/stickyhost.m4
        [stickyhost.m4](#diff-7306c377ca9791c3ac2638c942a2ada101512fe0f676c2a0e3b11533c90ba8f4)
      * contrib/sendmail/cf/feature/use\_client\_ptr.m4
        [use\_client\_ptr.m4](#diff-7a3b342858a5c0ef23a3f831135187c5231b83d3888e4d6b4b9b9448511a5c87)
      * contrib/sendmail/cf/feature/use\_ct\_file.m4
        [use\_ct\_file.m4](#diff-9d2698dc4c6475db1bd1e75f754478e29482e965faf69a7b24b3abfaf47a127b)
      * contrib/sendmail/cf/feature/use\_cw\_file.m4
        [use\_cw\_file.m4](#diff-4e1177a98df0165bab703e65943e2fc0975fd8461452b13389c5387a76940488)
      * contrib/sendmail/cf/feature/uucpdomain.m4
        [uucpdomain.m4](#diff-07e775b2d0940b9043d3858c37b52a49da2b803954a9ba18ec799ccf3825aab8)
      * contrib/sendmail/cf/feature/virtuser\_entire\_domain.m4
        [virtuser\_entire\_domain.m4](#diff-9678c5d6c450e2d6eca78b4f732c35db9a1f4c2eb7eb7308eb4f814242a151b3)
      * contrib/sendmail/cf/feature/virtusertable.m4
        [virtusertable.m4](#diff-084c1dae524174b633f8cb84039aa88dd9d4d98569019c3ca8268392f0592a62)
    - hack

      * contrib/sendmail/cf/hack/cssubdomain.m4
        [cssubdomain.m4](#diff-1535a45f617e346a4bcbbf69fc4d1eb747998a9370714de0322a61cd007f886b)
    - m4

      * contrib/sendmail/cf/m4/cf.m4
        [cf.m4](#diff-993cd3f72d6b93a6d120a5bab88a63f8a4f15f5c6a6565830822112f46c54971)
      * contrib/sendmail/cf/m4/cfhead.m4
        [cfhead.m4](#diff-4f3e4339473a1e0adee19384ea378b4a593a07dcd5cb42b8fb20415e9c3b2479)
      * contrib/sendmail/cf/m4/proto.m4
        [proto.m4](#diff-e8cc745b7cbbd02acd4cebca16348188f80917031a350bf014c84c9900e54dfa)
      * contrib/sendmail/cf/m4/version.m4
        [version.m4](#diff-f6b504dec286ea2bcdcf28cecc44853cbf7a666f3fe92f8bd10e73d71ad02554)
    - mailer

      * contrib/sendmail/cf/mailer/cyrus.m4
        [cyrus.m4](#diff-949652ab5ac1f070bd5142d4b7dfb461d5a4194de2911656eccc9f232f8aff48)
      * contrib/sendmail/cf/mailer/cyrusv2.m4
        [cyrusv2.m4](#diff-15e10d9fec01f06c4c295d96734937c6b8190df84c5e96804d82aab49591c5f9)
      * contrib/sendmail/cf/mailer/fax.m4
        [fax.m4](#diff-da79418e87f9e12bdc7b044aa60005b06f5c54be9784920bc60a9edb5364e566)
      * contrib/sendmail/cf/mailer/local.m4
        [local.m4](#diff-64877aa5065ddf9b4273ff9c3f8fb3a8328cab36758ed6790e76545269665b3c)
      * contrib/sendmail/cf/mailer/mail11.m4
        [mail11.m4](#diff-f4092a50c4c0fad3f368eb410ec250d17ef50194a26babaa20aed1a8041eb486)
      * contrib/sendmail/cf/mailer/phquery.m4
        [phquery.m4](#diff-45c0a5b60692ec35eb87217923b7d55afac60aa74e2a1763f0ced10d24127f92)
      * contrib/sendmail/cf/mailer/pop.m4
        [pop.m4](#diff-ff305b834eebd9d0b8db52703a64f77a38326b6bde2fce3ffb7665052064d9c7)
      * contrib/sendmail/cf/mailer/procmail.m4
        [procmail.m4](#diff-1c202974adf4f0afd2c811b708e94f50be2315e2e1f7fcd1aaeaeb90fff817e2)
      * contrib/sendmail/cf/mailer/qpage.m4
        [qpage.m4](#diff-d5e7b40ce41af87ebdc57c440955a1589641632aa9f4f3074a6749eaf0470763)
      * contrib/sendmail/cf/mailer/smtp.m4
        [smtp.m4](#diff-c243a96d191a6954a411c4127a81c9575f99fdcfecd3b6e1b2b6dcfb1b4ce96e)
      * contrib/sendmail/cf/mailer/usenet.m4
        [usenet.m4](#diff-1dbe94d81a214d44712de4b8768880b2ce48d0dabfb5f3ab40cb51db086ed3a2)
      * contrib/sendmail/cf/mailer/uucp.m4
        [uucp.m4](#diff-7b2f806014fda46ee55953ca1b0bf478c3025d3d9cb033837474946310bc7c2d)
    - ostype

      * contrib/sendmail/cf/ostype/a-ux.m4
        [a-ux.m4](#diff-fb5bbf00ba1e1ed2465241a36fcb6637af48176aa027c25c7ed8fb2c7c5a0b96)
      * contrib/sendmail/cf/ostype/aix3.m4
        [aix3.m4](#diff-07ebfa4031c98c3b2ecb4ab43e3682061a338fa37d90d31016e8306d3141a592)
      * contrib/sendmail/cf/ostype/aix4.m4
        [aix4.m4](#diff-4b64cf4db67d0e35f56b4f1c55c240a4d42d153578069965ea53c344912a499e)
      * contrib/sendmail/cf/ostype/aix5.m4
        [aix5.m4](#diff-c4d44cbd7cbbf5848c47981969dc9a41bfb6950d2140f32391fd3b89e23dad96)
      * contrib/sendmail/cf/ostype/altos.m4
        [altos.m4](#diff-4d66180a1ab0744710cf127e8b4e12b24758d0dde715e0e4d8df44303de869bb)
      * contrib/sendmail/cf/ostype/amdahl-uts.m4
        [amdahl-uts.m4](#diff-b40ccfbffa0ad1082c314f1b492a5bdef01e375e27046a75bdb95bf20541084b)
      * contrib/sendmail/cf/ostype/bsd4.3.m4
        [bsd4.3.m4](#diff-96483a7da75334ac0616a692713592c9296b756dfb6f355623a0b8e5dfefb4d8)
      * contrib/sendmail/cf/ostype/bsd4.4.m4
        [bsd4.4.m4](#diff-961c6d58f7588ad9512c322ebde238630148c9a3b7e81ce6c828caa607fcdf10)
      * contrib/sendmail/cf/ostype/bsdi.m4
        [bsdi.m4](#diff-d856d77010a1e4456480d16d86a3834c63eeaf45836b6d945a3aef0e87758a07)
      * contrib/sendmail/cf/ostype/bsdi1.0.m4
        [bsdi1.0.m4](#diff-aae187809991973af2dcd6247795d83dd6b04367d339cdb7125c936b3f78328e)
      * contrib/sendmail/cf/ostype/bsdi2.0.m4
        [bsdi2.0.m4](#diff-0fa09374829edf52d3093c735926b55aecedb4b3581ff14f91e0332311966927)
      * contrib/sendmail/cf/ostype/darwin.m4
        [darwin.m4](#diff-3f53aad3a8c3d6b446033e51a606b6df091b5caa63d25a036244bbf72daaea62)
      * contrib/sendmail/cf/ostype/dgux.m4
        [dgux.m4](#diff-11b9e3103149f943b59c7eb8b8c07ddb1e3336e5d07dd7d96b622fad94b5a154)
      * contrib/sendmail/cf/ostype/domainos.m4
        [domainos.m4](#diff-933441bd2568321f6d81b46bedf8f5c08f51a7883383184922e4bf779897693d)
      * contrib/sendmail/cf/ostype/dragonfly.m4
        [dragonfly.m4](#diff-96a8d5e837ee1e1ac12af5f562fdd5ac83fe2c5afca93ad4dbafa58fe03ebdc0)
      * contrib/sendmail/cf/ostype/dynix3.2.m4
        [dynix3.2.m4](#diff-11d69fd52abf95ee53d50c4df19f8cbcc1dc90042f99838c48577877d8b8cdb6)
      * contrib/sendmail/cf/ostype/freebsd4.m4
        [freebsd4.m4](#diff-89ae804d98ab9969ad10394d66fc1c8b0407de9668cc44e00f0cb9837e93fbb0)
      * contrib/sendmail/cf/ostype/freebsd5.m4
        [freebsd5.m4](#diff-a4fe446f68d0cc04b725921a20d2122471b8936ecaf9734ed5e511f2b78b7cfe)
      * contrib/sendmail/cf/ostype/freebsd6.m4
        [freebsd6.m4](#diff-c2aa8ecb98523946f85f1cea6c4950d250d68732f3803e7ae6ea2c4b1511a3ae)
      * contrib/sendmail/cf/ostype/gnu.m4
        [gnu.m4](#diff-b43a32825e78853ea40b5a68bec4ef2e2205d3b80115e15ac40187dc55eefb13)
      * contrib/sendmail/cf/ostype/hpux10.m4
        [hpux10.m4](#diff-1753fa5b024e3c16cba471ed64e274d407582bfd551a3b802a6d7d45c0da4c10)
      * contrib/sendmail/cf/ostype/hpux11.m4
        [hpux11.m4](#diff-5abb8f8c368dd1c1d374ba4433276a4463b24db73f50f4ccba237d4e87084acd)
      * contrib/sendmail/cf/ostype/hpux9.m4
        [hpux9.m4](#diff-63eb2fabc0c0d90af46c6e5a3b08617f7acc17405914e4380e77f3b303455fa3)
      * contrib/sendmail/cf/ostype/irix4.m4
        [irix4.m4](#diff-abff9437c0530bb948c16f208531e3fe2941f91362859010be8a81712a0d9bd9)
      * contrib/sendmail/cf/ostype/irix5.m4
        [irix5.m4](#diff-3230d676293455313a7a4fc10d4c44973c1e21c4b6594bafc5eb408eb47a981e)
      * contrib/sendmail/cf/ostype/irix6.m4
        [irix6.m4](#diff-d109fb42d8dabcba562d1b7564c9a27d78907d7bdd8101426564f88e00d1d08d)
      * contrib/sendmail/cf/ostype/isc4.1.m4
        [isc4.1.m4](#diff-b5bccd5c0e90379d93a5da6f780eecf0918214507e259376922651f3fce639f5)
      * contrib/sendmail/cf/ostype/linux.m4
        [linux.m4](#diff-8778cacc3e0dc9576b86242b1a909a192934d8b4d45c0f12af7e924be3f66241)
      * contrib/sendmail/cf/ostype/maxion.m4
        [maxion.m4](#diff-71dfb3c3cce57cf9a3dc3ac934fc1b893863fb5b9fe8fd01fe0da097ce3f785f)
      * contrib/sendmail/cf/ostype/mklinux.m4
        [mklinux.m4](#diff-7144dea803e7e20d64566110ced8a63e0f82febe74247fdd6f21eecd23622208)
      * contrib/sendmail/cf/ostype/mpeix.m4
        [mpeix.m4](#diff-54747e2367e736568b28ed2a74454ae083ae77243bebf556614bf464503960d9)
      * contrib/sendmail/cf/ostype/nextstep.m4
        [nextstep.m4](#diff-e814c35597d92d169e621f03825e40b7fbde82692ac7a43ddcf8c51e859ea676)
      * contrib/sendmail/cf/ostype/openbsd.m4
        [openbsd.m4](#diff-724889a752a5006365b1a9ce470c060d5c7f0b6b27209e6de22e18147e652a19)
      * contrib/sendmail/cf/ostype/osf1.m4
        [osf1.m4](#diff-1ef1941bc4514fb3947c12f4252a6b8c0407ddaf945454f2f36afde9d33577cc)
      * contrib/sendmail/cf/ostype/powerux.m4
        [powerux.m4](#diff-e976e10423cd16b3ed1e216e2608c7392f3a2e89e13e1dfc00152e8e5c38d4fb)
      * contrib/sendmail/cf/ostype/ptx2.m4
        [ptx2.m4](#diff-3d2a829ce22b41ad249eec207ee6963f17a5e87f7f7e249805f74d21f06ca875)
      * contrib/sendmail/cf/ostype/qnx.m4
        [qnx.m4](#diff-8ece605afa9d68a0b25cd93aee4808f8f8d8aad3baa186fdd2eb02e99e2a5372)
      * contrib/sendmail/cf/ostype/riscos4.5.m4
        [riscos4.5.m4](#diff-e8aae3890ec7470e253fd094a70f1062ff3e8d82144e67ed9fd7e831c9a4abbc)
      * contrib/sendmail/cf/ostype/sco-uw-2.1.m4
        [sco-uw-2.1.m4](#diff-01fb53dd142580003129904617997a869559959b3c8c9cad8a609e73083e7a8f)
      * contrib/sendmail/cf/ostype/sco3.2.m4
        [sco3.2.m4](#diff-d4fe8add179d98f88d879fe462ef3cae37466d2f5ce7a99d8c45fb453c074f47)
      * contrib/sendmail/cf/ostype/sinix.m4
        [sinix.m4](#diff-8f30e8da5f4ef0488d3ca7d9a0c77de42f9a177482021e6a6c8ae48feb15327b)
      * contrib/sendmail/cf/ostype/solaris11.m4
        [solaris11.m4](#diff-30f117af6c05604d2e5e2aa87316024daf97e228d4682e5ee4ea4d65af8d17cb)
      * contrib/sendmail/cf/ostype/solaris2.m4
        [solaris2.m4](#diff-6a697eff88d9c8a30261650d685b4ec46aa5f8585044e63973872d271c76b115)
      * contrib/sendmail/cf/ostype/solaris2.ml.m4
        [solaris2.ml.m4](#diff-c7a8d1449dcff7ff863fc5c4329f5d7d5edc1d6ee64816c1933f03a6ba0ccb3b)
      * contrib/sendmail/cf/ostype/solaris2.pre5.m4
        [solaris2.pre5.m4](#diff-39006126dc6eea99935954c4da4bd61480ba07204666ec5007c1c6739b6e4bf1)
      * contrib/sendmail/cf/ostype/solaris8.m4
        [solaris8.m4](#diff-f77e4337ab078e5b481a14f7706b4305d260494103a8c74f410c6393a6f59a05)
      * contrib/sendmail/cf/ostype/sunos3.5.m4
        [sunos3.5.m4](#diff-08cd1c159933b79b29b11d38af1f47750da860d2064557d8840085bc32f39a33)
      * contrib/sendmail/cf/ostype/sunos4.1.m4
        [sunos4.1.m4](#diff-dbf8ca84273504b97ecae90d7344ff7a4a03d8863d8528d3f80bea69846075c3)
      * contrib/sendmail/cf/ostype/svr4.m4
        [svr4.m4](#diff-439fa6c1f7d90622b0393d13871ec78cb99fe6e1d0ec4107497669f9232ddee6)
      * contrib/sendmail/cf/ostype/ultrix4.m4
        [ultrix4.m4](#diff-7f6bfbc0ab3228d6fd7705d89c4075b11bb96cf9d972a5c86a59b858fe4882dc)
      * contrib/sendmail/cf/ostype/unicos.m4
        [unicos.m4](#diff-8e9fe4f247e79a2b92fef0fcb6095266297355d599e64107c7a9e0cce6c07f41)
      * contrib/sendmail/cf/ostype/unicosmk.m4
        [unicosmk.m4](#diff-62aaa2948d8ebc35200443465fc6754f9849a46d3e4389873edf33ef9cff1775)
      * contrib/sendmail/cf/ostype/unicosmp.m4
        [unicosmp.m4](#diff-c79ed55df31edee51045813560f6c4be5da2208314b8c86ce0ed968413f0587a)
      * contrib/sendmail/cf/ostype/unixware7.m4
        [unixware7.m4](#diff-77df68e7d10f5e302ca0db6a632138e45b55a28d5fb8d3628dd77476e68e8dfe)
      * contrib/sendmail/cf/ostype/unknown.m4
        [unknown.m4](#diff-96cca8378b421e9611b9d63890162d717ea169101b7ca937686415d8a9eccda4)
      * contrib/sendmail/cf/ostype/uxpds.m4
        [uxpds.m4](#diff-270ebcd15d381978a678f673fbf2619f9a32c658fd4a57df372e2b1a7157b574)
    - contrib/sendmail/cf/sendmail.schema
      [sendmail.schema](#diff-d6f0bf5d935382a2d4574cd7b26d0acf4d1f64f9502bcacef77594d084f796bd)
    - sh

      * contrib/sendmail/cf/sh/makeinfo.sh
        [makeinfo.sh](#diff-29b0445628cf02c68e345479bc39836f24fc9473046e113a267f8b1139d9e835)
  + contrib

    - contrib/sendmail/contrib/dnsblaccess.m4
      [dnsblaccess.m4](#diff-a4eba8c8a71f79c01487bef53543906fcda2c265766bd2a8f67c3a7acbbaf95c)
    - contrib/sendmail/contrib/link\_hash.sh
      [link\_hash.sh](#diff-24917773c35118571839a20c8374dc13325d64099bbbf4b84a9bc95cba8e2aa4)
    - contrib/sendmail/contrib/qtool.8
      [qtool.8](#diff-0191290ffd5653b6bca6f6883d69d2b82f80a133161f1a226abb8f7bbe83e118)
    - contrib/sendmail/contrib/qtool.pl
      [qtool.pl](#diff-c3e51a32eea47ec9318c5622358d343a5a8e50035b5a8fc0d0e5e4f36c179db4)
  + doc/op

    - contrib/sendmail/doc/op/op.me
      [op.me](#diff-4412412ebaeb1cf75314990adc175102d3db00084ac90c6d2baac7f0f027a6bc)
  + editmap

    - contrib/sendmail/editmap/editmap.8
      [editmap.8](#diff-a533a8b35f867033965929fd2c0ca847dc52c47090f08b39680bdf7229d673ee)
    - contrib/sendmail/editmap/editmap.c
      [editmap.c](#diff-93094b5017ea0e575d279aeb6b7b142ba2b375f69df8d54eb6b8fccc94e79bce)
  + include

    - libmilter

      * contrib/sendmail/include/libmilter/mfapi.h
        [mfapi.h](#diff-4ca0c4f5b0144cc14aeaf9ece1e16baf64a4767da751de49dd887a4b9bd1cbec)
      * contrib/sendmail/include/libmilter/mfdef.h
        [mfdef.h](#diff-0b0262ea1cff4addafffb11c62e14556ff9b1ec9a9820f47b82f3239e3d01ba4)
      * contrib/sendmail/include/libmilter/milter.h
        [milter.h](#diff-040aea83c6d5ca724df183177a0838876e8bb68e7cb97a5cdbf7f234f4ecb4fb)
    - libsmdb

      * contrib/sendmail/include/libsmdb/smdb.h
        [smdb.h](#diff-f86e99ce2f18f2e45b23a7e9600ec454fb611131244f7b4677c2560d5c16da82)
    - sendmail

      * contrib/sendmail/include/sendmail/mailstats.h
        [mailstats.h](#diff-10e2b6bfaf3b8fb4ca9b44d0ebb28b76fbd1b60814e21db1b6b356397486fb11)
      * contrib/sendmail/include/sendmail/pathnames.h
        [pathnames.h](#diff-6af9036d317aa2ad24bbc3c9d7fa32130b869b20a8b3e238fc2b529f83321438)
      * contrib/sendmail/include/sendmail/sendmail.h
        [sendmail.h](#diff-cbb8ba1c3e2966ec4d895064ceb49d70f5c4a637a871e2455f69ab7cb0d2d715)
    - sm

      * contrib/sendmail/include/sm/assert.h
        [assert.h](#diff-44f6ffeaca2e89590cb2bf9661e8d134a0e50c201a96f74435e83f98a52e7824)
      * contrib/sendmail/include/sm/bdb.h
        [bdb.h](#diff-14caca011534465f1d50379ea1278d067304ae322a45e306969ec10f4087007c)
      * contrib/sendmail/include/sm/bitops.h
        [bitops.h](#diff-064e0b765be7aa55097d3b92b9b1bbf0ec5599db24fc07e7c514182fa67fd8bf)
      * contrib/sendmail/include/sm/cdefs.h
        [cdefs.h](#diff-d1a31938faf68d417750ced7eacecb3c4d9601cdfe943b752843cb2589ca5a61)
      * contrib/sendmail/include/sm/cf.h
        [cf.h](#diff-63adfe24c0ea702cca55088b8318caf81897730062029936b570ecbc0ba20140)
      * contrib/sendmail/include/sm/clock.h
        [clock.h](#diff-39f2706f45b41830a4ff3afe83376e9515e2e2a67ce9840e99bdc6ef601c0853)
      * contrib/sendmail/include/sm/conf.h
        [conf.h](#diff-74b6b1b856343932d565e69639980159d77ddb3438b1c7d22cea869cb384e339)
      * contrib/sendmail/include/sm/config.h
        [config.h](#diff-daee8605e5a07af9f6e1028758a25d92785345f38fcf915f619d38c7ff5abba6)
      * contrib/sendmail/include/sm/debug.h
        [debug.h](#diff-44bdca415a0f218c7ba12389eba3f35ad05872c874f9364ddcf850c7faec96e9)
      * contrib/sendmail/include/sm/errstring.h
        [errstring.h](#diff-ecf1631cd4a8b63aa30735a753a151d60e5da5e1726188172b84bb109a8ceccf)
      * contrib/sendmail/include/sm/exc.h
        [exc.h](#diff-13c37cf574da30723f1170904eab656910d3a8d86cfeface9eb8c66e7ff3e589)
      * contrib/sendmail/include/sm/fdset.h
        [fdset.h](#diff-36bf1b31357682af6eda1ae4f7582ee14f156384c95a5780a9059a0094a798ae)
      * contrib/sendmail/include/sm/gen.h
        [gen.h](#diff-dd6085f4256a2e5a96305e46525ee8fce6de578dea7614c7bacc7ffcf725e24c)
      * contrib/sendmail/include/sm/heap.h
        [heap.h](#diff-4ee0272c5365a5b2a8e50d8809926e1ca143e16b0d06502e8eb74a2a0f88c5e2)
      * contrib/sendmail/include/sm/io.h
        [io.h](#diff-cef6219feb9bec8a04d91f4f440868d4447afa94d89315c8c71f00bf81b1a050)
      * contrib/sendmail/include/sm/ldap.h
        [ldap.h](#diff-c2ea239ce85b382796afdaee37b098a73e539e4eb358d109ce865ed98155799d)
      * contrib/sendmail/include/sm/limits.h
        [limits.h](#diff-290c62516f7082d70628318485f4dfc78fae80547e45f8527cab5d6ea9792a05)
      * contrib/sendmail/include/sm/mbdb.h
        [mbdb.h](#diff-1f4a8044500060fcf135e18e5995e2b201bd75cd413b484580e3449a13da4094)
      * contrib/sendmail/include/sm/misc.h
        [misc.h](#diff-94cda484d2eb1ad6dacbb6f88828f08efa47d1c20d293db1d5bf330355ff0a06)
      * os

        + contrib/sendmail/include/sm/os/sm\_os\_aix.h
          [sm\_os\_aix.h](#diff-b61f36b7648ae6ee70676e3af60e338ffef5587cb9f39a27b733eb68f6898e8e)
        + contrib/sendmail/include/sm/os/sm\_os\_dragonfly.h
          [sm\_os\_dragonfly.h](#diff-6ef54238789c2921ed86d6165574bec6cde24eff7ab5dd62c84724e3c8037f27)
        + contrib/sendmail/include/sm/os/sm\_os\_freebsd.h
          [sm\_os\_freebsd.h](#diff-da311e572209d7a59a1d57e6696e70e1c9d0d141025eaa8d0430711e752b63dd)
        + contrib/sendmail/include/sm/os/sm\_os\_hp.h
          [sm\_os\_hp.h](#diff-2f46126df24f4c4b303d8cbc889482216c6d891cdf16debecf19dd6c82de55a9)
        + contrib/sendmail/include/sm/os/sm\_os\_irix.h
          [sm\_os\_irix.h](#diff-c6840f337b8af8ed7b17f77be71ef7d60ebea818f495dc46f810eb4e3df3703e)
        + contrib/sendmail/include/sm/os/sm\_os\_linux.h
          [sm\_os\_linux.h](#diff-f27a3e6746a13786b00adbfe2abafcff8e188a3b9d1839b8850540a521176fd9)
        + contrib/sendmail/include/sm/os/sm\_os\_mpeix.h
          [sm\_os\_mpeix.h](#diff-755094a980b59390b40fd04580d753feac9d652e0e193b359e348146651962de)
        + contrib/sendmail/include/sm/os/sm\_os\_next.h
          [sm\_os\_next.h](#diff-f15906848af1c6241de1f988271ad3db421028055d58b810f11e6f63169a66e8)
        + contrib/sendmail/include/sm/os/sm\_os\_openbsd.h
          [sm\_os\_openbsd.h](#diff-d1d837656f25c30cdff08496bc908a32847eefc28655b7b44d4799dbd031fd2f)
        + contrib/sendmail/include/sm/os/sm\_os\_openunix.h
          [sm\_os\_openunix.h](#diff-3e4f863310a9ca138df609756762c3e1a1decadd069c4a711112420b8f370c55)
        + contrib/sendmail/include/sm/os/sm\_os\_osf1.h
          [sm\_os\_osf1.h](#diff-2cb6f7826bd90748c88c253c051d7cca35550fdba02f0cb0f64f0c3f15e2224d)
        + contrib/sendmail/include/sm/os/sm\_os\_qnx.h
          [sm\_os\_qnx.h](#diff-180f959f57441c1aee4273d19ba8da9cb0f4a43c429921c59020494ef6108477)
        + contrib/sendmail/include/sm/os/sm\_os\_sunos.h
          [sm\_os\_sunos.h](#diff-d51be11031504aee268c4243f088157100435787e7ff046f7d529134e28b8052)
        + contrib/sendmail/include/sm/os/sm\_os\_ultrix.h
          [sm\_os\_ultrix.h](#diff-36a3e5a2af3b20e4b7f8d382f41bf6dd8dccc23ec6af5929d0a2dbf69a0f8264)
        + contrib/sendmail/include/sm/os/sm\_os\_unicos.h
          [sm\_os\_unicos.h](#diff-15fa1ccf2a7bd1742fa9169e5f24d3084e522f9eefd35e13a8a1742408369cd6)
        + contrib/sendmail/include/sm/os/sm\_os\_unicosmk.h
          [sm\_os\_unicosmk.h](#diff-689f65f51ddfc3dc01e339c5849745b5d9e40cdd758caafc5e3e494b6e2b1296)
        + contrib/sendmail/include/sm/os/sm\_os\_unicosmp.h
          [sm\_os\_unicosmp.h](#diff-2d66ae012d0e664298d0281810d9f52eb6d14c7dca1ad3abec1864aeefe4af82)
        + contrib/sendmail/include/sm/os/sm\_os\_unixware.h
          [sm\_os\_unixware.h](#diff-e77c636bbad8874ff84be13c76ab781febc102f6ac7986323e897224fd70124e)
      * contrib/sendmail/include/sm/path.h
        [path.h](#diff-a8523f7216a89dba651fc23a188e834f188f38c5bf32f0e35e73454a5b7a10f8)
      * contrib/sendmail/include/sm/rpool.h
        [rpool.h](#diff-db2dee6210de92327bf08d6d0e9eecce19c7e61fa733fd6fc65df2e759e00bcd)
      * contrib/sendmail/include/sm/sem.h
        [sem.h](#diff-2c3c91ca12a0c8ad3db9e145225396ffa5289f5fa85814ca26d2466e40a53d26)
      * contrib/sendmail/include/sm/sendmail.h
        [sendmail.h](#diff-de75fd5d497897e12c968beb19f9996e700a23cb0e0aa55accd75ce549a66b55)
      * contrib/sendmail/include/sm/setjmp.h
        [setjmp.h](#diff-f27a7cd211e6f5cf8e034359c5db503df6aaf0b4b5ec64964bc97599412097c8)
      * contrib/sendmail/include/sm/shm.h
        [shm.h](#diff-4d43e7c1a678e4b719026050ea95d5c89ba7b018286a695dc992409e3697493c)
      * contrib/sendmail/include/sm/signal.h
        [signal.h](#diff-ae65a56b7a25a244c2dd55c68a71eb810c6cead5f710a22dac23ff00881c54c3)
      * contrib/sendmail/include/sm/string.h
        [string.h](#diff-88626d6e0905ecaf3a005ff0ce8f628f6974be412e75b682d2fd28939b0cfbb2)
      * contrib/sendmail/include/sm/sysexits.h
        [sysexits.h](#diff-27a6d84d8c9932cda99c3c7719bc9d34e6300765da59382b15edde8d5e3adda1)
      * contrib/sendmail/include/sm/test.h
        [test.h](#diff-c8023aa701a5d4d86f52b4a99be062d17ff89147496ec52eed13da76f6a0f432)
      * contrib/sendmail/include/sm/time.h
        [time.h](#diff-074ca9d9f3821bbd36fbbd9349473a84ebd24f8e9795c1c45f74173f3f8cfab9)
      * contrib/sendmail/include/sm/types.h
        [types.h](#diff-a979cc12b4ef9111df6d9ff9b0a9ee542feab50bdabce7d2bfd809b875ff4ee0)
      * contrib/sendmail/include/sm/varargs.h
        [varargs.h](#diff-2f60d265c7a31ab671fdaa597e1eff3728bac55b224caa1465f01818356cfd3a)
      * contrib/sendmail/include/sm/xtrap.h
        [xtrap.h](#diff-135e9cc827027c42dd14ca1f4678d108effb144ea224e5dfe969b670ecf57f27)
  + libmilter

    - contrib/sendmail/libmilter/Makefile.m4
      [Makefile.m4](#diff-c4b4cf915e3dd436ff9eaaf99dea585a898ead3639001e499519d2b15927c8ed)
    - contrib/sendmail/libmilter/comm.c
      [comm.c](#diff-ef593e06f504cd5bdda724c952c8bea7fb9bf385106c44fc2c15d82ac876de61)
    - docs

      * contrib/sendmail/libmilter/docs/api.html
        [api.html](#diff-edd7d6ec0c976b3ab4a9dab1e45597cbafe38522bcf8225ea12e5419935f1c0c)
      * contrib/sendmail/libmilter/docs/design.html
        [design.html](#diff-78888caca140b1f054069f5db53c55a07afaa4f065741f8f80980a390959c47e)
      * contrib/sendmail/libmilter/docs/index.html
        [index.html](#diff-ce27d76c28d0e7ab0f8ce29c2e3983c20e9106ec087e664b060b7236270d0e2a)
      * contrib/sendmail/libmilter/docs/installation.html
        [installation.html](#diff-bbf36774ac0d33786c13f03a8375ebe97bdb46822bed6945a88382baa402e698)
      * contrib/sendmail/libmilter/docs/other.html
        [other.html](#diff-7a2eb51b53e7821f696c29ace9630225a24177ddf0402fa449495f6bee92be13)
      * contrib/sendmail/libmilter/docs/overview.html
        [overview.html](#diff-1b22e877d1c584a61acf990b80b6bfe5bb51cdb2bf184398461e64cdd1cff2df)
      * contrib/sendmail/libmilter/docs/sample.html
        [sample.html](#diff-7c95cfc88b05599b434e94ec95e9f931caf68fc8e71024a3f86abdc4eda3327c)
      * contrib/sendmail/libmilter/docs/smfi\_addheader.html
        [smfi\_addheader.html](#diff-e8b7d415111fab018d578dd5b96147be4d8130ae2d89001a5198110c5610f4a0)
      * contrib/sendmail/libmilter/docs/smfi\_addrcpt.html
        [smfi\_addrcpt.html](#diff-8979b3b164ee781202aedfb4b9e67355fe1134b96679d27112338b650dc80847)
      * contrib/sendmail/libmilter/docs/smfi\_addrcpt\_par.html
        [smfi\_addrcpt\_par.html](#diff-a13fe675a4b8c5182b4405c68258ef8de3ae09fdb041b0c231ebf212620a3169)
      * contrib/sendmail/libmilter/docs/smfi\_chgfrom.html
        [smfi\_chgfrom.html](#diff-e70512b50bc41f6490050aa8049c352ee9346cd47a778a266f4d8654ce79190c)
      * contrib/sendmail/libmilter/docs/smfi\_chgheader.html
        [smfi\_chgheader.html](#diff-73b560ffe708db4301041ca68cb1dd76d5adbe39b0c5d47744036738bdf91915)
      * contrib/sendmail/libmilter/docs/smfi\_delrcpt.html
        [smfi\_delrcpt.html](#diff-214468927c60a6f6ea463e80b5c17409a7794324ade81a54950d55fd54daf5aa)
      * contrib/sendmail/libmilter/docs/smfi\_getpriv.html
        [smfi\_getpriv.html](#diff-7d4e1e93a20f8dbf9fff57fd7ceaa6bcacd7b1edaa033fe878728ddf7f3229f4)
      * contrib/sendmail/libmilter/docs/smfi\_getsymval.html
        [smfi\_getsymval.html](#diff-eac42cd231bf4a8230f79a27dcd6d3bd594a37d10edaf881b9096e7e591ebff3)
      * contrib/sendmail/libmilter/docs/smfi\_insheader.html
        [smfi\_insheader.html](#diff-6c84f55c8186dc4692074fef4ffdeb876b2a42c29e092476b1ea5fc9bb054369)
      * contrib/sendmail/libmilter/docs/smfi\_main.html
        [smfi\_main.html](#diff-54bae9a221b59c20219d8e9ce30d5e68461d6165881a766030287ade0c499685)
      * contrib/sendmail/libmilter/docs/smfi\_opensocket.html
        [smfi\_opensocket.html](#diff-dcd197e96b3182041ee5965316b1fc11a953217e6ba191ea0bb558c33d37169b)
      * contrib/sendmail/libmilter/docs/smfi\_progress.html
        [smfi\_progress.html](#diff-651fbbb1ccf684ea38a6af8284efd31384d7e72c98cefa890d99b6b8bd195073)
      * contrib/sendmail/libmilter/docs/smfi\_quarantine.html
        [smfi\_quarantine.html](#diff-5ec85d35ce3f02474b2fb20b4fb5f3a44599f16c8e9fe04e7b34e318cd24bd12)
      * contrib/sendmail/libmilter/docs/smfi\_register.html
        [smfi\_register.html](#diff-d505e7b21f8fb773ba17d7b95fad17339dcc00d2890b05ec4e0329db96d995f1)
      * contrib/sendmail/libmilter/docs/smfi\_replacebody.html
        [smfi\_replacebody.html](#diff-e58b973ce21f3f1c3c6021c3f0d233a826902d44c29838fabdc38a0607a76f49)
      * contrib/sendmail/libmilter/docs/smfi\_setbacklog.html
        [smfi\_setbacklog.html](#diff-50f316951fd4f7623830bbbc910a3b211489a22b13ccf4b0b215f6055039b346)
      * contrib/sendmail/libmilter/docs/smfi\_setconn.html
        [smfi\_setconn.html](#diff-e10b358ed526cf3b28e8966717c1aa19b5315558ab91fad863acdc27e09cd0ee)
      * contrib/sendmail/libmilter/docs/smfi\_setdbg.html
        [smfi\_setdbg.html](#diff-13b4c5f4026951688af78af2165a7fd172acf2d8c2bccd17ffe02bbc7729c859)
      * contrib/sendmail/libmilter/docs/smfi\_setmlreply.html
        [smfi\_setmlreply.html](#diff-27d4f4de4e4fbdc6b2bc061367af8618220e78d6f2fdc448cec44eba57ba52ca)
      * contrib/sendmail/libmilter/docs/smfi\_setpriv.html
        [smfi\_setpriv.html](#diff-c50c1cf2ff31dc3c5b7a5713348b926329777128bdca52c60f521542ff3b0601)
      * contrib/sendmail/libmilter/docs/smfi\_setreply.html
        [smfi\_setreply.html](#diff-b796dbffeb1de57661e0299693c7d2245f29bcafb9470905b8ca9b4f041cd475)
      * contrib/sendmail/libmilter/docs/smfi\_setsymlist.html
        [smfi\_setsymlist.html](#diff-a2e1c56e26e864501e2f6b992954fda0c144e342221fef6e60e6a1c165157eb3)
      * contrib/sendmail/libmilter/docs/smfi\_settimeout.html
        [smfi\_settimeout.html](#diff-5c02a8c283943276eaa8157d6d3b505e9f46c59ed495c2e83e9c74c1d2ba9df8)
      * contrib/sendmail/libmilter/docs/smfi\_stop.html
        [smfi\_stop.html](#diff-7fdd029be311c0976fac1d8f09ee0517f61056c571de646a8c711a119271892a)
      * contrib/sendmail/libmilter/docs/smfi\_version.html
        [smfi\_version.html](#diff-ac34889046807fd1795624f9d0a8a82d4cb183ef388f66ed2677ab4851e2e52b)
      * contrib/sendmail/libmilter/docs/xxfi\_abort.html
        [xxfi\_abort.html](#diff-a5918d9bfdf9cf5d10760301b34c012253a42fb00ed10ec71f44c21e8eb5230a)
      * contrib/sendmail/libmilter/docs/xxfi\_body.html
        [xxfi\_body.html](#diff-592791b9dd46ddfaecf83e2c7fea9efd26d651fb89ef2ebc4d135bd7dd09c901)
      * contrib/sendmail/libmilter/docs/xxfi\_close.html
        [xxfi\_close.html](#diff-6adc5e26cbd766830accc7e5cac850a1d0c842fa692b20e6dac046f33e2b6221)
      * contrib/sendmail/libmilter/docs/xxfi\_connect.html
        [xxfi\_connect.html](#diff-1bb7e2e75ea55825291f6a58f9fafaffd05ccfec27442249ee55f424dafff233)
      * contrib/sendmail/libmilter/docs/xxfi\_data.html
        [xxfi\_data.html](#diff-9fd01567fa75255222024764eb8ddc15205954693c26f50f70e8ecf8895f2096)
      * contrib/sendmail/libmilter/docs/xxfi\_envfrom.html
        [xxfi\_envfrom.html](#diff-ce15f36c47ccd09e914b7127167c08e7369063e17946ef9b15e2af5372a0004e)
      * contrib/sendmail/libmilter/docs/xxfi\_envrcpt.html
        [xxfi\_envrcpt.html](#diff-3a80996c9db8e96697147ac9a9c5f88646e7d4848227ab314c7e020c4fedd9be)
      * contrib/sendmail/libmilter/docs/xxfi\_eoh.html
        [xxfi\_eoh.html](#diff-4f7029fda69adc4d45ee08e191e031bf232433d65eafbbe647dbb73e42f6e19b)
      * contrib/sendmail/libmilter/docs/xxfi\_eom.html
        [xxfi\_eom.html](#diff-18a63173e669e5c2e0b108f6bbfef5b1ebd15b75bb01811379943997df04129f)
      * contrib/sendmail/libmilter/docs/xxfi\_header.html
        [xxfi\_header.html](#diff-365c602c780fccecaf29ce6e5770a81ec2b1d87563b893cfe80efd1c62991715)
      * contrib/sendmail/libmilter/docs/xxfi\_helo.html
        [xxfi\_helo.html](#diff-69f3bdf1c7605c826d6963a55e6f1ef880ee926fbba1f217e0c2fc7abc2b7964)
      * contrib/sendmail/libmilter/docs/xxfi\_negotiate.html
        [xxfi\_negotiate.html](#diff-708cbdd62702c3eb91c0db4c4d630d91ff998b874f705d2baa3761ef2b1fbf27)
      * contrib/sendmail/libmilter/docs/xxfi\_unknown.html
        [xxfi\_unknown.html](#diff-a330e2639d76742614e316d8dd05bf6a2b8358a940ec5f160a1b033b72aae1ed)
    - contrib/sendmail/libmilter/engine.c
      [engine.c](#diff-51f6489d2d037034534cf536596362360dc2db4034d353fa03e20aa8ad84c2dc)
    - contrib/sendmail/libmilter/example.c
      [example.c](#diff-d5af62e81e00312e838d20723f611835657a0c2bb5dbaca7c5a13c36718db6dd)
    - contrib/sendmail/libmilter/handler.c
      [handler.c](#diff-c552093bf53224f3372e2e5060d00c5291ea72a7c9f526a4fdcf9bea0712ba0b)
    - contrib/sendmail/libmilter/libmilter.h
      [libmilter.h](#diff-3717b3be2a73f065f7f0f97d9c90a43986da8cc8f750c06f0c7ed78f36d90473)
    - contrib/sendmail/libmilter/listener.c
      [listener.c](#diff-a63b780648960da6c6ffe1e709126d087c93bccbbefdea63435c3b970bba0689)
    - contrib/sendmail/libmilter/main.c
      [main.c](#diff-04c637d3a332fd1a5db27aac645920c881e74473196b17c1dbe4c600b3a21ef7)
    - contrib/sendmail/libmilter/monitor.c
      [monitor.c](#diff-2bb704c0ce143718f4e6d802c94611ee4b2c6a666a82d1bad7e4cd9ba479187b)
    - contrib/sendmail/libmilter/signal.c
      [signal.c](#diff-02d0679be0c6a234ba4d7badc94e3eee80aa3532fcb3c5593cf7a96db5428082)
    - contrib/sendmail/libmilter/sm\_gethost.c
      [sm\_gethost.c](#diff-d2da19051ee3b597d25f3d713aabfdc91aa39af26b2343d106d3368d1e39722b)
    - contrib/sendmail/libmilter/smfi.c
      [smfi.c](#diff-295d8e89684e0ea00fa60276ae7d5369b6365a061172879676887a1c630e2eea)
    - contrib/sendmail/libmilter/worker.c
      [worker.c](#diff-8fb1feb7a36bcf78075b6f80a60f87e98abff888454c0b31a8d40b118835d890)
  + libsm

    - contrib/sendmail/libsm/Makefile.m4
      [Makefile.m4](#diff-3e10e257f20a26323993eecefc65aafda03405a99ee188401a056496b82ea68b)
    - contrib/sendmail/libsm/README
      [README](#diff-e4c964ab7a9696a790a6a50484ea4796d2b35c51da1afdad1011b51ac9c5de59)
    - contrib/sendmail/libsm/assert.c
      [assert.c](#diff-71300f6039bf315e92f7f89a4b5b02228d62ec70563b894cf8811acb7c75dced)
    - contrib/sendmail/libsm/b-strcmp.c
      [b-strcmp.c](#diff-17b95eebab214c9acea0bc05999b374bf2fcc754bbc3c5cf312787727afa8480)
    - contrib/sendmail/libsm/b-strl.c
      [b-strl.c](#diff-04904e528821b6688b6ad13a9e2b6daf3a1c734fd12eaabe73147e06b0c90235)
    - contrib/sendmail/libsm/cf.c
      [cf.c](#diff-7734dbbf3afb50a2be05e843f417c252a0382e44b1a5b77e636e641e9b8dc068)
    - contrib/sendmail/libsm/clock.c
      [clock.c](#diff-28567ed5d3e14497f6596f334b23b26ad09bdcfe91ddc45bedcced3206b27b1d)
    - contrib/sendmail/libsm/clrerr.c
      [clrerr.c](#diff-74eeb655c5e11131fdfecf0296e3f5f5716ccec45c4e265bae35138c2468a8fb)
    - contrib/sendmail/libsm/config.c
      [config.c](#diff-6e842ea07365355b95aed18bb1ed47e97be58ced32107a4c6af4958e1657903b)
    - contrib/sendmail/libsm/debug.c
      [debug.c](#diff-1fc68e47a58fbba032c4a1cdba4a33bd122a0fa42b9796b61ea65b840fa3828b)
    - contrib/sendmail/libsm/errstring.c
      [errstring.c](#diff-d5f983b78768443567ddd438dce573aee42078506aae4486df3c42cc1ce01f8d)
    - contrib/sendmail/libsm/exc.c
      [exc.c](#diff-d64b3a268c7c21bc800eda237b0b7df91452363a9992d910988ef35f7915abe7)
    - contrib/sendmail/libsm/fclose.c
      [fclose.c](#diff-d1d8db59958f9e85f2c409ae3e0b496c67ca4bf99e03175449458a7f555c4890)
    - contrib/sendmail/libsm/feof.c
      [feof.c](#diff-f6a139415b1e700d15b7a803c51398b27594b762b04abda8cb32eaec86cd5ac2)
    - contrib/sendmail/libsm/ferror.c
      [ferror.c](#diff-e0f542a7f3d00dfbbd6ec1e6e5c9f8d61f707470dea63495f4a10f0386aa5c0a)
    - contrib/sendmail/libsm/fflush.c
      [fflush.c](#diff-5473d30e2c6218a4e2fa98bfa3bce290b0ca519f12f9da538f9a62bba5e6b946)
    - contrib/sendmail/libsm/fget.c
      [fget.c](#diff-4d5167d3f2aedf702697f757527708b5c5722ae7562087488206bc2965f068c7)
    - contrib/sendmail/libsm/findfp.c
      [findfp.c](#diff-89f234738a0d13a3952f8ebee917d687bfe23f0754a7bff732f4e80407094776)
    - contrib/sendmail/libsm/flags.c
      [flags.c](#diff-9514cd3676c7c17cd9edf521e5013deee91a1fb3f0cd145613740d425a300dc0)
    - contrib/sendmail/libsm/fopen.c
      [fopen.c](#diff-3ddc338a8a4bd89d5dd578fb8449ae6aa76fea7ab94b3d10bdd0a0797cc56477)
    - contrib/sendmail/libsm/fpos.c
      [fpos.c](#diff-106f8bf37acc9558720bca7b71b6af0b3edaad8ea0931dfddcf24aaf3d9f386a)
    - contrib/sendmail/libsm/fprintf.c
      [fprintf.c](#diff-c37feb2b18b545e40d9d1bed392c6e38c019f604830cbfd7ab41242c69a476d5)
    - contrib/sendmail/libsm/fpurge.c
      [fpurge.c](#diff-2d6490192cdd93e8ac519310f75d1dc61d1e888f349dad3865df996f51428c75)
    - contrib/sendmail/libsm/fput.c
      [fput.c](#diff-cfdd3b846fbc6206f09543d6739019696709a007a2ac380265aaf0ac0511d7e8)
    - contrib/sendmail/libsm/fread.c
      [fread.c](#diff-8f5e59f96a5d6d46b0f496345d1c3dd37b0807394fe16bab218c28d66ee42eb6)
    - contrib/sendmail/libsm/fscanf.c
      [fscanf.c](#diff-607cd7662fb97181ff94a9b9c272ff18374c1faf72eb900e98be96ac27acd0eb)
    - contrib/sendmail/libsm/fseek.c
      [fseek.c](#diff-bf5d757f5d888a4a02fc86807e441ba16ff11352e2405ae6e30b271a02096391)
    - contrib/sendmail/libsm/fvwrite.c
      [fvwrite.c](#diff-a4555e39be0e3843ccaee883c00c218069a713eff94e17966feea0f2e6971fc2)
    - contrib/sendmail/libsm/fvwrite.h
      [fvwrite.h](#diff-11a8d3f295c02a26689c80fd4a8d56e6b4e164c1027a433efbcc01bccee5b459)
    - contrib/sendmail/libsm/fwalk.c
      [fwalk.c](#diff-3de8a9b67e5b5218c7cdba9f923ec0572f35c357372ee554edb8c9af11087828)
    - contrib/sendmail/libsm/fwrite.c
      [fwrite.c](#diff-ba00b0b72af93365f7bb02ea5652e9f63a87aa22ac16d9699083000a582f7eb4)
    - contrib/sendmail/libsm/get.c
      [get.c](#diff-a5a13b9947cd621e9865e4dc90614f80a8669907977364841e84e2ae2bf66f7e)
    - contrib/sendmail/libsm/glue.h
      [glue.h](#diff-7eb48394a6a8b70733c7c95d3fb89653625862f2c86fda2242d58cfc6c34618e)
    - contrib/sendmail/libsm/heap.c
      [heap.c](#diff-3a5af1d17ed177f7f5b7e4637417a91eee4ed11f7f1f0d08c9f89d96f12e546e)
    - contrib/sendmail/libsm/inet6\_ntop.c
      [inet6\_ntop.c](#diff-95d0224e3520fb5b240deeb6669cf61087b6e5312563ac8c19f052f1530cfffb)
    - contrib/sendmail/libsm/ldap.c
      [ldap.c](#diff-8dc565b047397e00255ed783f04bd05404b6a1d20a91d9d5badd3e7c81f48c8d)
    - contrib/sendmail/libsm/local.h
      [local.h](#diff-b5fdf8089de16ddb249a45b98ca11920768d2507b2131f8ec83bbcc1db980d11)
    - contrib/sendmail/libsm/makebuf.c
      [makebuf.c](#diff-5c66996d2a2d08c4872c73db6c867df3f3e18daa04322bf3ffca3787dec70aa7)
    - contrib/sendmail/libsm/match.c
      [match.c](#diff-7819f1587f859916e4eaaf0a6241bbe323313def3a6654b47de03dac4399f65f)
    - contrib/sendmail/libsm/mbdb.c
      [mbdb.c](#diff-4cb1bdee34710e023738b97fa2897703feceb30a4f6a2890e18aa80105c3d308)
    - contrib/sendmail/libsm/memstat.c
      [memstat.c](#diff-1bc12bb0918a1371af97f52d7eec303a8e447ffe5ca14f566bfcf9d504559955)
    - contrib/sendmail/libsm/mpeix.c
      [mpeix.c](#diff-50aa0080c170fb5b8e632281c9b6b4719942eb9638a61b2946b332ca29b29d83)
    - contrib/sendmail/libsm/niprop.c
      [niprop.c](#diff-23a4dea393c1558222d7267c9f6c7903c1d175f62fbe9b1f6e374d02672804e6)
    - contrib/sendmail/libsm/path.c
      [path.c](#diff-c708289965783a90a2c36c0fddb323f98b359d9e28384fc2bec5dad7dc4ab114)
    - contrib/sendmail/libsm/put.c
      [put.c](#diff-34f0114fdcd98db0b9250bae8598fe15d75308268530d5ed900edc9cca21eec4)
    - contrib/sendmail/libsm/refill.c
      [refill.c](#diff-62072f7d1cf0f5815fed2dda75c37503448d2753103b6b95773f422debe4814e)
    - contrib/sendmail/libsm/rewind.c
      [rewind.c](#diff-b256ef83998911c2daf5fae21b3eaf39b3428ab8479401059a61e24cbee463b4)
    - contrib/sendmail/libsm/rpool.c
      [rpool.c](#diff-810917223dabad2b203fedf6200cbf62ab5167fb7bcaa4610535620500bd5e7b)
    - contrib/sendmail/libsm/sem.c
      [sem.c](#diff-8833e64d667d45529605c4213f62bd522235e703019a5718ffa7b4dd5cb5bbad)
    - contrib/sendmail/libsm/setvbuf.c
      [setvbuf.c](#diff-cc635f876584492ccefd61e72d7b9726312f9e132469e2eac10dfd742e0bd95d)
    - contrib/sendmail/libsm/shm.c
      [shm.c](#diff-0b9944a10b3ee7f8ed44755d2ac52d1ef3b244cb534da141b15c0b54aa0d886a)
    - contrib/sendmail/libsm/signal.c
      [signal.c](#diff-c8974b78e273dc9cc5ca4df4734bb7ac789398e07a187199f89ffb24c9b6886f)
    - contrib/sendmail/libsm/smstdio.c
      [smstdio.c](#diff-61a928187fa5743ff2181bf4b8eae80356edb285adf8835d3abc87b8937dea3b)
    - contrib/sendmail/libsm/snprintf.c
      [snprintf.c](#diff-40a665f196a58d07c7c1bacb1a0f8d75526f5f98dd85960b412d02d653bce7dd)
    - contrib/sendmail/libsm/sscanf.c
      [sscanf.c](#diff-482fe964b15c8ac4eb454ca1bbb4d9db28f3ccb4b3f8474074f342b5494ac69d)
    - contrib/sendmail/libsm/stdio.c
      [stdio.c](#diff-b25e37d640353ac8eb12a803f7f28c56b80b225383dc5c5ce0f489368502e4f2)
    - contrib/sendmail/libsm/strcasecmp.c
      [strcasecmp.c](#diff-d798dcf04e9bd59b6e77ff3b2ffc3d1b4cd41eaa791549f60e10736586654288)
    - contrib/sendmail/libsm/strdup.c
      [strdup.c](#diff-9de2380ba2f6a0f70324b6b15a396d7d76947430c3611b15ffae71d62382adbd)
    - contrib/sendmail/libsm/strerror.c
      [strerror.c](#diff-04bcd099a58cfc0f7021ce685c75ce1491ba25e93d78d738432ac0d8dbfdec4c)
    - contrib/sendmail/libsm/strexit.c
      [strexit.c](#diff-f88a4986d403c0ebcd1f79f4f2a5e7121765f81185418bf6c063bc1e19bdcbf8)
    - contrib/sendmail/libsm/string.c
      [string.c](#diff-58a62798d424eab258d92c2f0a6131effaf0fdcca28f1515b15b433c0dc7274f)
    - contrib/sendmail/libsm/stringf.c
      [stringf.c](#diff-9ac0c5ce0bb23c02f73d41d5a314af627b21401a76f067a7dbc637d080dff557)
    - contrib/sendmail/libsm/strio.c
      [strio.c](#diff-eada0e8749bed6731f7315a13d854de3c816cd55b13b7909c6b67c8e46a77151)
    - contrib/sendmail/libsm/strl.c
      [strl.c](#diff-c58618a91186daf931a22cff08445256958572d53015f7c983cf7ba23f7f122f)
    - contrib/sendmail/libsm/strrevcmp.c
      [strrevcmp.c](#diff-368a89649ee3b2d86d7a569616b9f99c931494a3c765b120d32a8379279c8522)
    - contrib/sendmail/libsm/strto.c
      [strto.c](#diff-602884215afb546ab3adae599b071ef76dfbab92c7590f580286513c7a702d82)
    - contrib/sendmail/libsm/syslogio.c
      [syslogio.c](#diff-82e446b1f185e55739611c9ef414aadb36370de0ed491dac5d3b16c4c2b99f56)
    - contrib/sendmail/libsm/t-cf.c
      [t-cf.c](#diff-caaff9c3343e93bbb71c21281fc8a6ed23f3444bc88661d44b422fdc4c7eaf57)
    - contrib/sendmail/libsm/t-event.c
      [t-event.c](#diff-e70d866e29062f16fbe7a8c4e2dd2e3c5f10b6d6bbdf1e8e829f027de7e5bf99)
    - contrib/sendmail/libsm/t-exc.c
      [t-exc.c](#diff-99e05900cbcf59a3030f5d4087cdddad031d65bbc8468bca91a88afae148aca7)
    - contrib/sendmail/libsm/t-fget.c
      [t-fget.c](#diff-3ff9ceb3b0f6d92843183015b9e7d02ce4909ee11bec5416e0dcea5c1f8ce952)
    - contrib/sendmail/libsm/t-float.c
      [t-float.c](#diff-212a2b54ad12e9f7358d28549433603f2775fa4cbbd513dd20aa39ea4c066757)
    - contrib/sendmail/libsm/t-fopen.c
      [t-fopen.c](#diff-1e006246b718fae7052bac7ff1f0ad141b0536cb5499d964d38501524345cd66)
    - contrib/sendmail/libsm/t-heap.c
      [t-heap.c](#diff-9d6201b4bdc96805862fa018363eb98e1b5e7271155ee70af0d36aec92744402)
    - contrib/sendmail/libsm/t-inet6\_ntop.c
      [t-inet6\_ntop.c](#diff-546d34362a0100cad4843005501e74df83606ae208c1f9f1ae20f18bcf326006)
    - contrib/sendmail/libsm/t-match.c
      [t-match.c](#diff-a4d7b4622602e0fcae25ab494aca69769645fea0288dc5269f8bfbabe40f659f)
    - contrib/sendmail/libsm/t-memstat.c
      [t-memstat.c](#diff-58a7c4aa7ec979c5e8bc9bcb4e72585656a219de21e657d27e7fa7a788116eec)
    - contrib/sendmail/libsm/t-path.c
      [t-path.c](#diff-567ae033c9682f82927a2a53b308d235932d14ef48b7795e8f4938529c92269d)
    - contrib/sendmail/libsm/t-qic.c
      [t-qic.c](#diff-2d32e0af76d52d6d0b9313cd840ce219525ada18ef31bddacaa3950a5c94f33f)
    - contrib/sendmail/libsm/t-rpool.c
      [t-rpool.c](#diff-ccbcde7eabef2408034a7a7ddafc0da46ed0a65f2d93da7428e26663e13c9c45)
    - contrib/sendmail/libsm/t-scanf.c
      [t-scanf.c](#diff-dfe119cdcaf4334f4345d70c2014f1864f43c94ca9a7f0b2590a69b7689d8393)
    - contrib/sendmail/libsm/t-sem.c
      [t-sem.c](#diff-38fffba31304a0184d7d3d399d7be78b8b9f461e3232e3fe618fd482f180312e)
    - contrib/sendmail/libsm/t-shm.c
      [t-shm.c](#diff-c42ee3656a53153ec4ed51709ea14ea60754214fb910d86862a3fe22454696ed)
    - contrib/sendmail/libsm/t-smstdio.c
      [t-smstdio.c](#diff-a7cb3020a95571732525afab9f71b36cabb740cdbd9ebd5522c8cf680475b6c5)
    - contrib/sendmail/libsm/t-string.c
      [t-string.c](#diff-22f447482e21196080e733e6be4798177a4d10e3ad0d6acbfe05eec5f0518532)
    - contrib/sendmail/libsm/t-strio.c
      [t-strio.c](#diff-516f4ec8ce05b1539506e7a5ebc225aa5c23d3df21dc857539f952c441948206)
    - contrib/sendmail/libsm/t-strl.c
      [t-strl.c](#diff-ff8ceedef4483722f4dff0aca89406690bad45ba985243a6a4ff874232eab6ee)
    - contrib/sendmail/libsm/t-strrevcmp.c
      [t-strrevcmp.c](#diff-a3eb535c370110256363bd2b4c896bece4ebb9651d7505a1c7b493f11ae071a7)
    - contrib/sendmail/libsm/t-types.c
      [t-types.c](#diff-2f30c445487f5e9b8634d41c7c5e47d59b0ab5edb9f32d91b0e6ab7cc5c8102e)
    - contrib/sendmail/libsm/test.c
      [test.c](#diff-c58d877d31678b1dc8b8bb30933669b6d83213ba14d5e63844f79fc2155e10f3)
    - contrib/sendmail/libsm/ungetc.c
      [ungetc.c](#diff-d613a5e3bb40840e9082973837c0dae0ea402b8502b94f733b350623e2f83b88)
    - contrib/sendmail/libsm/util.c
      [util.c](#diff-1fbc376fc1256292c8ab9f7679440e7e982947f8aea9749dd168f77f48fb524b)
    - contrib/sendmail/libsm/vasprintf.c
      [vasprintf.c](#diff-87155dd83bb975eeab3e35037c9dceb8d5af10ca2011964294b0f5a7e5c78831)
    - contrib/sendmail/libsm/vfprintf.c
      [vfprintf.c](#diff-93d2c1c102d61da62c67fc24fae73dfe63ea5b196edcb909ac4be88a88409734)
    - contrib/sendmail/libsm/vfscanf.c
      [vfscanf.c](#diff-a77d96fa8389052058d10da82559df7bbf5903db3676efa4b78e1c69bbb4b97d)
    - contrib/sendmail/libsm/vprintf.c
      [vprintf.c](#diff-6ebc1b296eeb44fff0e6ceb2b228dcb36dd44cf9ae16e2100cd6ba126fe0a507)
    - contrib/sendmail/libsm/vsnprintf.c
      [vsnprintf.c](#diff-16f270f8f8158aa901412e87041edee5eadb7d545143d6da8051a0d313fecfe9)
    - contrib/sendmail/libsm/wbuf.c
      [wbuf.c](#diff-3bc0ac5c86f2a05faccacb72a2895a55c4726a65262d1807a1e5e87f753da113)
    - contrib/sendmail/libsm/wsetup.c
      [wsetup.c](#diff-ead0b23f43256f188a3e8b0eed89b06caf456bbd1b47d21f34025a150f300a9b)
    - contrib/sendmail/libsm/xtrap.c
      [xtrap.c](#diff-2ceb15b3b1ce4cf983336429e8eedbe53bea02788587f483804f881df35fee67)
  + libsmdb

    - contrib/sendmail/libsmdb/smdb.c
      [smdb.c](#diff-634b6e27986b24ba7d42a4d94106a325d807f45c711661d19131ae09040e4422)
    - contrib/sendmail/libsmdb/smdb1.c
      [smdb1.c](#diff-89788f66bcf36182a5e791895c8c24a0c090f58a9e3126460c314a29fec68185)
    - contrib/sendmail/libsmdb/smdb2.c
      [smdb2.c](#diff-fca34a17e5cfac0fd49fc372c47f6063c4bb73edd3d2272651f0b8338c85ba05)
    - contrib/sendmail/libsmdb/smndbm.c
      [smndbm.c](#diff-d40268d729b28ba0a462a5c4936d36d0135a5611195bf89553e423fb696d85f5)
  + libsmutil

    - contrib/sendmail/libsmutil/cf.c
      [cf.c](#diff-f0545d412b32d00c58175ee9893c4f1e52cf43e3898258579de979c6a7c7d46b)
    - contrib/sendmail/libsmutil/debug.c
      [debug.c](#diff-2202783ede72a6dd85984ba8d0732ba1b591fb32c83515bcfb5e0da230132820)
    - contrib/sendmail/libsmutil/err.c
      [err.c](#diff-a8569b8ce3c0a290e9fbf7ddced6ef61332566da0dfea6046dab4130cc96ea25)
    - contrib/sendmail/libsmutil/lockfile.c
      [lockfile.c](#diff-1d638fd4f3129de2869a0046c47622969c67ae36a9e38739df7d08dcb25e7870)
    - contrib/sendmail/libsmutil/safefile.c
      [safefile.c](#diff-2e3faa99c669ecc8628b2df4ec15512ff842f7ef3e9f6d89ab6943f8dc348600)
    - contrib/sendmail/libsmutil/snprintf.c
      [snprintf.c](#diff-a6fc8c4f96bb4dbe4ead1f9c489302ee323ea091f2417a06c640771823e410f8)
  + mail.local

    - contrib/sendmail/mail.local/mail.local.8
      [mail.local.8](#diff-2c89b6cc11c6a7e282400db644ea6a47d2d6c9d3fb292916af7fc409264b4069)
    - contrib/sendmail/mail.local/mail.local.c
      [mail.local.c](#diff-23fa50f9a809d9e704d38e6598bbed4960a47c467edef6b8b0b7cdd98ce45aed)
  + mailstats

    - contrib/sendmail/mailstats/mailstats.8
      [mailstats.8](#diff-f6b0820768e746430b5fca3ff01d5521084955d2494865ae22b97ce007f537f1)
    - contrib/sendmail/mailstats/mailstats.c
      [mailstats.c](#diff-92ac1a7a9e3aea5ba30ebee36bafc27781d020537ab7c257b8e79870f66a87ae)
  + makemap

    - contrib/sendmail/makemap/makemap.8
      [makemap.8](#diff-8201f30599e8079204a7c5e603246f7450960cfd4854358a11b3c1b335be94bc)
    - contrib/sendmail/makemap/makemap.c
      [makemap.c](#diff-0c22e9eefd6954ea896cead6efe6fc0f566db9d499d0dd34c3dcdd1d15eb3fa2)
  + praliases

    - contrib/sendmail/praliases/praliases.8
      [praliases.8](#diff-e6eb57ddffe3e4c3deb2a063be5822980329622e31bb5d82d7d9f997e5497619)
    - contrib/sendmail/praliases/praliases.c
      [praliases.c](#diff-f4d9dbb1b599da2b83e297a1ec4ce4b5f8c2f268898e74446e016f8968de2799)
  + rmail

    - contrib/sendmail/rmail/rmail.8
      [rmail.8](#diff-d3c1b567c1584b18873f2d2a61684c28826b75670b7eed21a2befedb68ba5dcc)
    - contrib/sendmail/rmail/rmail.c
      [rmail.c](#diff-176c79df1377f1f108308f59e10cffd6e2216e7f352c46b6e834f5e0cb176ad1)
  + smrsh

    - contrib/sendmail/smrsh/smrsh.8
      [smrsh.8](#diff-fbdbf7604173c485ce1a81ea7b739b63ebd9dc79a6a837d5c21cf35a6a4090f9)
    - contrib/sendmail/smrsh/smrsh.c
      [smrsh.c](#diff-af978856df4df940eb1aabd18bb056794a42f71095ad54cef3f5f3308a7709ea)
  + src

    - contrib/sendmail/src/Makefile.m4
      [Makefile.m4](#diff-0ed5ae8cf43729c554ec880c5829730555ff090c0e0c769fcfd08b880db8d336)
    - contrib/sendmail/src/README
      [README](#diff-081cf241141ed7fc0ea4e5ce21af3d2af6de66ba361f177d66f5e437a35aa591)
    - contrib/sendmail/src/SECURITY
      [SECURITY](#diff-2f96f13375032e57acf3e979efd6e40631aba0c675dd63ad088e7ccf9a54ce0d)
    - contrib/sendmail/src/TRACEFLAGS
      [TRACEFLAGS](#diff-2a24aa42db8896ee1bd20e1135b670fa1e62c354d3926193ca849aab28f5b041)
    - contrib/sendmail/src/TUNING
      [TUNING](#diff-9f447bad8be71fc8d2502cab027fbdf7c3e5e9d323897ec6f38fefb0b83b6075)
    - contrib/sendmail/src/alias.c
      [alias.c](#diff-ef0a83c70821b84c4a5c42662d4e89f292959e91dd422551ff22decf2500fe0e)
    - contrib/sendmail/src/aliases.5
      [aliases.5](#diff-791773b7eba752424dd1662e96df8b4e9433ec4f24c66e7491142e1dbdc235f5)
    - contrib/sendmail/src/arpadate.c
      [arpadate.c](#diff-5a16d91d1aa213ef6278b060ce5451ee3a39196b491364ffcf903ea09d3fcf75)
    - contrib/sendmail/src/bf.c
      [bf.c](#diff-fc28722738dea64cd8c693f366c056d108a9a18a8344704a6eb95170d2df9937)
    - contrib/sendmail/src/bf.h
      [bf.h](#diff-d5e9d510aa4b88188c750f17aeed876b45d81fa56c77501f5b50da8b7fdeff52)
    - contrib/sendmail/src/collect.c
      [collect.c](#diff-8228b916f6f23e88c7691cfb0240e8145fe7c0423390584bd21139ce5d218732)
    - contrib/sendmail/src/conf.c
      [conf.c](#diff-48dbb5950f37b7583ed66b2575d6109db11fd5575b97fcad194865ae0e20f640)
    - contrib/sendmail/src/conf.h
      [conf.h](#diff-ad63157bd606404a76e3a1f743eb605bb01b2129ce11f9c9f5791a9bdd9d075f)
    - contrib/sendmail/src/control.c
      [control.c](#diff-67e43d653f8c3db2d027f975e66eba0bbd81a11f136f56834715fe25ab34c261)
    - contrib/sendmail/src/convtime.c
      [convtime.c](#diff-95e25b8bb1818c1ec4ef013311aff89ee8060aeba526526d94c0c8e751d16018)
    - contrib/sendmail/src/daemon.c
      [daemon.c](#diff-21acf892bdb487c0086e4e3dd67c508da5476ccb8fc5d61f8ab855f132856f83)
    - contrib/sendmail/src/daemon.h
      [daemon.h](#diff-feac4ef6f1f070bfc0464a5e82a36cb43534ec0801e54bc11d7b3975d1825322)
    - contrib/sendmail/src/deliver.c
      [deliver.c](#diff-59641eb996130d512f18120cffcd2fe0c666eb8c78cb512d0614a294e5320756)
    - contrib/sendmail/src/domain.c
      [domain.c](#diff-7d0cf1ba742d583a32db39272d3b90928d67c02e8f6bc445e9ab5c92ad83b1ca)
    - contrib/sendmail/src/envelope.c
      [envelope.c](#diff-790e7bc74b331ee1e00385b411380bf3118847ef94086f093852975c90bba168)
    - contrib/sendmail/src/err.c
      [err.c](#diff-b37576d7a4228264835f5a05315be433745959c985cea4797a180e7f87de3b9a)
    - contrib/sendmail/src/headers.c
      [headers.c](#diff-e1ae81dc44e77ca599efea8d56f9ba6c001caa54aa706e3424207028337e5f88)
    - contrib/sendmail/src/helpfile
      [helpfile](#diff-87cf8cb9a3bf182687feb54e87ae75bb919733af369d2fe45ce9f2e9e9ee04e2)
    - contrib/sendmail/src/macro.c
      [macro.c](#diff-7e8ea6d7df0f88902b0fc97052e17f8c254c5b28835075184e0c6660887e3281)
    - contrib/sendmail/src/mailq.1
      [mailq.1](#diff-6e0428f1a38d672df5203bc2a96495241396a31b6bbb3a34562d0feccc57fe15)
    - contrib/sendmail/src/main.c
      [main.c](#diff-85409ccfb6694af453e25a35403747c79d3162c202256bc20a2145d69a69e66f)
    - contrib/sendmail/src/map.c
      [map.c](#diff-cd57a75979666f3960633217a9e8fce696f3e7616e6d3b17ee961d2af9dad3a1)
    - contrib/sendmail/src/map.h
      [map.h](#diff-62cabb120bab1625e9e7bdcfda322bd8c2308690ec4eb21467802587c3758cea)
    - contrib/sendmail/src/mci.c
      [mci.c](#diff-bd00e3cfa58a09b6074f37a688508a333b6fcb0e779c15bd88a7a8143cf20039)
    - contrib/sendmail/src/milter.c
      [milter.c](#diff-9000f4e8f22f5ef174a6ab5e92dfbef836915ed01f9fc6a82845faefe1f5b113)
    - contrib/sendmail/src/mime.c
      [mime.c](#diff-722116bc795c12582fa344c3bd553f56fed76066db34e886ad559431324d3a2b)
    - contrib/sendmail/src/newaliases.1
      [newaliases.1](#diff-bd2a1595b40f4ef4b9ba90660b45b0947ac3c05424f81ea828a7cfa87f4aa416)
    - contrib/sendmail/src/parseaddr.c
      [parseaddr.c](#diff-4867bf7ae9afef81a8b4b5b48e879e00f66df13cfed696e59fc3ec441bd929c5)
    - contrib/sendmail/src/queue.c
      [queue.c](#diff-dd90f29c26fd6db9e122828c261e965ef3ee41db689f64d4cad407d48dee060c)
    - contrib/sendmail/src/ratectrl.c
      [ratectrl.c](#diff-ee68d093c97ebf3f7ea8dc14dc6e263ef7d14708fd47939c182c88cfa14b8edf)
    - contrib/sendmail/src/readcf.c
      [readcf.c](#diff-1d6e2e6006cc156bd5140c011c2d8767daf68d552f17dfdc8fdf50ce8e3cd74a)
    - contrib/sendmail/src/recipient.c
      [recipient.c](#diff-ec02b32d66ede47a5868abd50fc6743c8a35f840833eb50d904bb7ceeeab65c4)
    - contrib/sendmail/src/sasl.c
      [sasl.c](#diff-8f84be14bf1e1ae1792962d0c900e1ee5af91aadf330f70e1bbee5eda201c2a0)
    - contrib/sendmail/src/savemail.c
      [savemail.c](#diff-e706de91c20d74c507a5eb4ad7ca789c07dabe22558e87387814acee65f03f84)
    - contrib/sendmail/src/sendmail.8
      [sendmail.8](#diff-5ace1aa3532dcc76f7d1790e90984f1b245b36a235431083e552af1a57a20796)
    - contrib/sendmail/src/sendmail.h
      [sendmail.h](#diff-a3263fb6a9cea0e8a63cf8b4ac19d19a700abf74f15e99cb7f5036c52bd7aea1)
    - contrib/sendmail/src/sfsasl.c
      [sfsasl.c](#diff-a5e12642a7446ecbc5246295cdb417675625bf613fdb1041d14df0a60591846a)
    - contrib/sendmail/src/sfsasl.h
      [sfsasl.h](#diff-620692b9e07ec44ff4adf4f0c1b19cacfff2ae13e645159f960f660e43e211a4)
    - contrib/sendmail/src/shmticklib.c
      [shmticklib.c](#diff-9c249603b855b06bd1dd7cb39c28ba891ba62e9f1bc93f6731dde277ca4e57d6)
    - contrib/sendmail/src/sm\_resolve.c
      [sm\_resolve.c](#diff-0371a97bc964cf7079837467684417f206c72a778e982034b507fd484a486b76)
    - contrib/sendmail/src/sm\_resolve.h
      [sm\_resolve.h](#diff-476d7319710c2258a49620c6310bb83c45d680cfb58d9ba7afc4d02fc1c4df1c)
    - contrib/sendmail/src/srvrsmtp.c
      [srvrsmtp.c](#diff-7118b8ca6131b54495f836a9ee5c44b505978224a2c19dc32ee21bdf31ccae46)
    - contrib/sendmail/src/stab.c
      [stab.c](#diff-b75213d281bdeee9840c93acbbe69486812e627350cb882ade980903f1a5a2fe)
    - contrib/sendmail/src/stats.c
      [stats.c](#diff-2729d9085f74bf3e53aeb00065a9c4b46934f26ffa89f8e643c0c09d44f351a3)
    - contrib/sendmail/src/statusd\_shm.h
      [statusd\_shm.h](#diff-b60cc0b24fabdc117efeadcd4d8f7163ce1fa0ec2b9e22a52be60f37f7e42237)
    - contrib/sendmail/src/sysexits.c
      [sysexits.c](#diff-49965213c31eb1f5bee9cafddc49a22a5bc2a529db07cafe26679c4636cfa106)
    - contrib/sendmail/src/timers.c
      [timers.c](#diff-1e462578119022f2e3569a151e2ca71da62acc71bbc1593bb50d97fab2468a8e)
    - contrib/sendmail/src/timers.h
      [timers.h](#diff-2872f82aeca52bea79cc52244a68c47a6eca9dbc7e6f9f3eaf8a440f3b02d56a)
    - contrib/sendmail/src/tls.c
      [tls.c](#diff-5110e19a99ad5f3b6999d04b6b7f007ada3b9e57cfc143567516661124b56087)
    - contrib/sendmail/src/trace.c
      [trace.c](#diff-29cb4536479f29aaafd5bb24ff71ddfdda0ac25a2c44bf35ed5ffa7d5ba383fe)
    - contrib/sendmail/src/udb.c
      [udb.c](#diff-fc5944836c967f53829e5237c6468546202e07ef8f240bf2564b3a642074b8ff)
    - contrib/sendmail/src/usersmtp.c
      [usersmtp.c](#diff-23ca10c86d0e469a13aedc69b97b9dc653c76037c08cc26f5fdea246beb43544)
    - contrib/sendmail/src/util.c
      [util.c](#diff-6dd36307cce2df06a460b2768577edc64ed607b8e7131bcf7fbf9678ff33b622)
    - contrib/sendmail/src/version.c
      [version.c](#diff-e0820c1729516f0eef9460a010a79f5d6353472dffbf2d85c976eba88f86cad2)
  + test

    - contrib/sendmail/test/README
      [README](#diff-30714880e8f1221f7e9eacc279176e8052912b8c50e8045cf9a7d49eef41bb47)
    - contrib/sendmail/test/t\_dropgid.c
      [t\_dropgid.c](#diff-8baf9554a7d7e55b651155cb61f726a352a78c27edc95823261761322904ff52)
    - contrib/sendmail/test/t\_exclopen.c
      [t\_exclopen.c](#diff-3474470a183f1360d885f7f36213b8451a4a0d92717a88b21972f070ec974758)
    - contrib/sendmail/test/t\_pathconf.c
      [t\_pathconf.c](#diff-c3a2b6d79b426109c8e1f39b2980053bdd467df8569d0d3f0b51a5f11ba40c2c)
    - contrib/sendmail/test/t\_seteuid.c
      [t\_seteuid.c](#diff-41ae93d9312e829f2b148fc9d11a0fb72f4a80d79d0c1b3c929f6ce99592b6d3)
    - contrib/sendmail/test/t\_setgid.c
      [t\_setgid.c](#diff-ce9239077a6ec58b85b58eb8f5ee4a97c1a42b8597aa7078e91e3aa04c201daa)
    - contrib/sendmail/test/t\_setreuid.c
      [t\_setreuid.c](#diff-909d7c260b0494f72012c3d00812ca5d7d08eed604cf139c09001e4243afa0aa)
    - contrib/sendmail/test/t\_setuid.c
      [t\_setuid.c](#diff-839583152558092e652e5e38ecf8af46174e17f929b1e2e2c07a809365abc24e)
    - contrib/sendmail/test/t\_snprintf.c
      [t\_snprintf.c](#diff-49c63a4b1f5e7071b88dd654745c324ca7df1badabc94d5d7f16f00593263d32)
  + vacation

    - contrib/sendmail/vacation/vacation.1
      [vacation.1](#diff-9e11c3d525812292f6595b93e94ad99ddd47a450f28af661ce1589673fe051b1)
    - contrib/sendmail/vacation/vacation.c
      [vacation.c](#diff-153957046d2ac7cb0d7cace54fc29f7bf5e96408025c23caaa1010db88a70031)

## There are no files selected for viewing

16 changes: 8 additions & 8 deletions

16
[contrib/sendmail/LICENSE](#diff-5b19f8e9be69b2de821818f96056bf12a5d2c417f5cb9e9c3db94b0e84d0306c "contrib/sendmail/LICENSE")

Show comments

[View file](/freebsd/freebsd-src/blob/5dd76dd0cc19450133aa379ce0ce4a68ae07fb39/contrib/sendmail/LICENSE)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,9 +1,9 @@ |
|  |  | SENDMAIL LICENSE |
|  |  |  |
|  |  | The following license terms and conditions apply, unless a redistribution |
|  |  | agreement or other license is obtained from Sendmail, Inc., 6475 Christie |
|  |  | Ave, Third Floor, Emeryville, CA 94608, USA, or by electronic mail at |
|  |  | license@sendmail.com. |
|  |  | The following license terms and conditions apply, unless a redistribution |
|  |  | agreement or other license is obtained from Proofpoint, Inc., 892 |
|  |  | Ross Street, Sunnyvale, CA, 94089, USA, or by electronic mail at |
|  |  | sendmail-license@proofpoint.com. |
|  |  |  |
|  |  | License Terms: |
|  |  |  |
| Expand Down  Expand Up | | @@ -35,12 +35,12 @@ each of the following conditions is met: |
|  |  | forth as paragraph 6 below, in the documentation and/or other materials |
|  |  | provided with the distribution. For the purposes of binary distribution |
|  |  | the "Copyright Notice" refers to the following language: |
|  |  | "Copyright (c) 1998-2012 Sendmail, Inc. All rights reserved." |
|  |  | "Copyright (c) 1998-2013 Proofpoint, Inc. All rights reserved." |
|  |  |  |
|  |  | 4. Neither the name of Sendmail, Inc. nor the University of California nor |
|  |  | 4. Neither the name of Proofpoint, Inc. nor the University of California nor |
|  |  | names of their contributors may be used to endorse or promote |
|  |  | products derived from this software without specific prior written |
|  |  | permission. The name "sendmail" is a trademark of Sendmail, Inc. |
|  |  | permission. The name "sendmail" is a trademark of Proofpoint, Inc. |
|  |  |  |
|  |  | 5. All redistributions must comply with the conditions imposed by the |
|  |  | University of California on certain embedded code, which copyright |
| Expand Down  Expand Up | | @@ -78,4 +78,4 @@ each of the following conditions is met: |
|  |  | (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF |
|  |  | THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. |
|  |  |  |
|  |  | $Revision: 8.18 $, Last updated $Date: 2012/05/15 21:49:03 $, Document 139848.1 |
|  |  | $Revision: 8.22 $, Last updated $Date: 2013/11/23 04:37:36 $, Document 139848.1 |

180 changes: 179 additions & 1 deletion

180
[contrib/sendmail/PGPKEYS](#diff-3d6d892b6df7feaf51a1fce615970c8f6689e4795abfd6be5b46cc7e6c0fcf3a "contrib/sendmail/PGPKEYS")

Show comments

[View file](/freebsd/freebsd-src/blob/5dd76dd0cc19450133aa379ce0ce4a68ae07fb39/contrib/sendmail/PGPKEYS)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -141,6 +141,184 @@ gpExpdV7qPrw9k01j5rod5PjZlG8zV0= |
|  |  | =SR28 |
|  |  | -----END PGP PUBLIC KEY BLOCK----- |
|  |  |  |
|  |  | Type Bits KeyID Created Expires Algorithm Use |
|  |  | pub 2048 E2763A73 2014-01-02 ------- RSA Sign & Encrypt |
|  |  | fingerprint: 49F6 A8BE 8473 3949 5191 6F3B 61DE 11EC E276 3A73 |
|  |  | uid Sendmail Signing Key/2014 <sendmail@Sendmail.ORG> |
|  |  |  |
|  |  | -----BEGIN PGP PUBLIC KEY BLOCK----- |
|  |  | Version: GnuPG v1 |
|  |  |  |
|  |  | mQENBFLGB58BCADFOlIYbhlAZ1URaoyfEHLgrm/bHeZufZO3jp2eeuDIkt4Z8csa |
|  |  | eLkwomo/UtmUNXkn5rlUacRjyuhrDgVyuhYVeqq+tVbGccrjq4TM+5dkDTtQvLE5 |
|  |  | sEF3pbNYiPNJwPnqMfGTVmSouR9gGJGgttPubFDp/2jTpuFYZbcDSo+hoI9m5RAH |
|  |  | aWe+MhFC0r7RZTv5pY1CG3GSODaoz2XIQ/dDJ4WKZFeEvDPQnpLY4t0cb0hVcxYO |
|  |  | XVZZs1YmS2sEJirwJ+rpxivX4eyVKSO9Vjidh6cvmg2UdKfNoXXd+G9r0DR5FSo7 |
|  |  | hQHlOCrLFQQ5YJ3thGNl/fw7wVXVs34Nj7QfABEBAAG0MVNlbmRtYWlsIFNpZ25p |
|  |  | bmcgS2V5LzIwMTQgPHNlbmRtYWlsQFNlbmRtYWlsLk9SRz6JATgEEwECACIFAlLG |
|  |  | B58CGwMGCwkIBwMCBhUIAgkKCwQWAgMBAh4BAheAAAoJEGHeEezidjpzcRgIAJUZ |
|  |  | 4J6yvykcpgrIS8ZjDz1ab2sXtBx0ZjI5TxxnIwg9RQb5YkEk2/9tPo0ZwNUTDwz6 |
|  |  | eVENR++Bv3VXs32RnRiFNy1Mm2hhULh4ifgqT6Sy7zRk/kwiKuj6xkjAGZV71QmD |
|  |  | ukFIpVaWAQwiFkDgqM3LbxZ1sisbvvA8M/zJq66uGg09Lu9CKcwjKDfy+UW1E8Ub |
|  |  | SRzStTRrpvCH400q/Pwv3mOA43+H6Un4fZfCOcZeo22rSgT6D/FEY4LMdNnMLYuU |
|  |  | zPkpx7cKvQa/AcMdjoGu38g364JxlDjxjE6M+XBym8Tx6j4res7o0W8TGW5g+rEv |
|  |  | 8X9i7uxdnEfYBlNAElGJARwEEAECAAYFAlLGCCIACgkQPWiyXVIHytM4QggAtF+W |
|  |  | cXu8pJi3+OAoPmj+etgIuLhJ2GOp8qNK8yvwTEwiNwtenjennlW3ETHiCbtfQ0/T |
|  |  | Z9rq5elhANsfp8LsXGoJ4ic6KJlDEhCrKa76jwEeECI74E60TpG0z64pHMmUhk7l |
|  |  | eAUckCOvW7iHIBJVA7ZM8oII04ipPz6qJfJrUWkJbfZh8VV5DRp7zKAFT+URgSUc |
|  |  | bdAbLjyC7AohynNVxir90UoT+wo06GPMDpeA5+fS0VZxKAwKv2P0mRZAK63yzEJz |
|  |  | +VK3GCHLPCWJvHoqx4KSutk2mIpZ406T/BJEphkGN0BHHiUmIr9qfX/87klA4i9K |
|  |  | dHvzFr6qFBxD78XfuIkBHAQQAQIABgUCUsYIMAAKCRCOWun7zu70Ox9XB/9IP99U |
|  |  | LScSFiDgoZQr3eMztpc2NLIS2bGO1iX7L+9VInPCob7Se53MpaFrDWNna53Xehwf |
|  |  | NbaqsCQrG+OIMMwhRc0x3QCoXQUchA/JyAUIojfOyoFUZvlyZStRGOp2TBRrJnmb |
|  |  | l3iWz3pStqqtvqag2d3YxowqGqUvlRzAXTFmgjcnfMcJrxb9f3n6Nf84QpxLHxB2 |
|  |  | MgOgxUCHXMtJ4WxFHAoINize+P/P99U9mpyn4ewTnSaFzcmemqoVT9yZUDYUYrap |
|  |  | Bm4Xp0Y92IzoNpJgKBZLwXihisuI4alY/hBopo5L89vms2BwesQuh/4Tr6SELwFx |
|  |  | zX63E++tz1TqHleWiQEcBBABAgAGBQJSxghsAAoJEDmkx32peISwXiIH/3suKuiQ |
|  |  | +KqQT10UdBoNg6m0XinG4IG2MghRRcdg2Q8ncCfMFJPsKQcPdjiUuuUIYtD7CE+O |
|  |  | SwQ9N+6vZlsk3Zq2I8rPEwrUTmZ1gDcMK93MafNS32Xt7FmCY6wpMCkpmCLd9sjb |
|  |  | 7rj3uZdv/aI6Is76z6dKTfxJWBrbsUQNncASn5JyCXrYj9eeGP8gHX2KCkyPBF4u |
|  |  | kHFPgdzYevCfZeP/+f/cdRwF6bAVaHiEZ2S/Vg6r3Z89vgd+wNKnNsljEiacYWuS |
|  |  | zxouEn0eWQj9kC3bXJgqXH+HLrEY8NAQ5EQWjd8bzIhzCTA9MtL+N1b0Ep36gNiw |
|  |  | YFB5b/b7KlbEPsSJARwEEAECAAYFAlLGCG8ACgkQYE378oVBCr4XDAf/auf1ljzq |
|  |  | w2khe1L/1ANvtnugMP3sVJEPU2nDUnCK2+c0G5INnWc+c7DEFsaLHgcs2eN/w80a |
|  |  | adInDn9lFw7DtcvZr3xL8q+b6j4i4jucjT5WVfYHbvc0xcKfpEjRge4oV3XR73SU |
|  |  | ztdTWZZAlds4Xvh9pojjM90fBu5uDqfpRM3/vNTQ9EWvjcCGKusWRTwgdfF94cHN |
|  |  | CeSe8PCo7sil6MtBBoujmLldCKZaLC08NLPX3yTGzNmuLyNZj9WgwPoK++XTxJly |
|  |  | 0j9EJsO28ZxmNCxsZyGA+1D1NuRurQ5FXIUHUfz6taP8FHSDt95cOiirmCMOAjT4 |
|  |  | UFtGAZFlbhzxroicBBABAgAGBQJSxghyAAoJEBKJbpunfyQpyFwD/1fp8qgb6zvn |
|  |  | dIoTUoVWahI41Clt65cA2d1Ib1IbJJ4ms9cxNbFMTvbpPQ4AXOz1t7x2uS3YDmq5 |
|  |  | IxdWLr6YPSMkGmtpF2CD1HwSLcUwtKcIFrb8a0EN8Z+sRKu7yYg1vMxc7LmmOBUX |
|  |  | x+j9fm/1OFGIHYnUEb9GeKFf91cK0VAIiJwEEAECAAYFAlLGCHUACgkQ2Krwyvaz |
|  |  | BylxvAP+JuZQFPnk6l4SKHR/3ZWz56fOqZ6Qv8cgUCFY5AY9OdSE7aU2zVjZTjd1 |
|  |  | dJzVD7xc/9h8OW4HakfwcNnfAqdQ4eNdox5+uydXwU0CXJqU8QxGPaCSRkB1Thb5 |
|  |  | aMik5S01lzra4s6dF0iMC15I5v0PAznykJO9Sq4qhMLUCYTxFiqInAQQAQIABgUC |
|  |  | UsYIeAAKCRCXQwEYcJO4QeDXBAC2hVO1j2dyQfkHr8eLAg/P+2qwZ1ZaG4jxItol |
|  |  | vF91lfGNCaG3RWB9iPRIkz5B+lSoh4mSPGzJ3cFDgB53rRMpFUa0qhiUpVaNuPMY |
|  |  | BSrkxYb00amJcFoXX+yE8soeu6BZ1cazg8GEkbjFbboqJMts2M39dD3c4ikbU4Op |
|  |  | v9ag1YicBBABAgAGBQJSxgh7AAoJEB57s8ivlZYl1w0D/1AySnzhz5PKQo4Wh9QX |
|  |  | qX+yMVBT3rgVO6EgR8ShsyMhZX8GwEEGPueDAh8MLGPqQZbjXq81QMeVk6TSUCQx |
|  |  | XbhHxyGJJTVDxxJxFJZ7f8y05PjppTA6TL2aKYsZLkWUPEq5vKocE2VAmYldwvRS |
|  |  | Ez4oNLWQD5dw05DPzVsJ2/49iJwEEAECAAYFAlLGCH4ACgkQcKAkTR75klFOVwP/ |
|  |  | fxmc8/ckreAjz7C3oarAHlWgAUHrJAAtG1MEgXN6FtzGZyzj7jsC4HI8A5nfwIWx |
|  |  | A67jktU+6OpySrvIv3gRF1OAV168Q9IE8KszvnJgl6Gknf/KuiwpthWHpKztn9lF |
|  |  | vealu7JKqI+3D5m33SqcWUg8SThfnGBoZOZGOnGrw4aInAQQAQIABgUCUsYIggAK |
|  |  | CRDI1e0plfYXcf9oA/44QISEfFkqab+NIIgKW0SHqJDmI5QvVkcCO1Ct+/TkhGVO |
|  |  | I68XKLMaNbzerl+BF26gU2IYCs0axa9hlkl8IJLokZhEPSRPDuSP2PG3GjaFsgnE |
|  |  | 5OK6aaVvjrEwaXe8v6rOYLmavnhZtOKg3H8pOl74KhFy1i/ZwM9oVfD4sfLhxIic |
|  |  | BBABAgAGBQJSxgiFAAoJECGD4bE5bweJnYsEAJUX07KH5tI+OfmhQ+WCFuU2as+r |
|  |  | I39oH1BB0W44fEhTj/yJFVqGSt4e3OBlP+SYqIM4DxPttxNtfQ9448rbzWLCdL0c |
|  |  | KGOM2y9NT/LoDi1JQ/IVLYvuIyNnPViAF5JQ96NrmJH+3SaC6goK6HY6D2Oh3iyO |
|  |  | 1VGIhjOWyJr2+5ZjiJwEEAECAAYFAlLGCIwACgkQiWliuGeMCgNvkwQAjrrAjFyh |
|  |  | pMepbLnRlxi2gcLqdmLcaub6AaRzCGDaYQxNFtBd+vLt0CtgY7sILahcMX6hLT53 |
|  |  | z4zCHoM93DM3jBoJehC0lH6/qd3ZAcW9vcSxk5ws97K6sbMXWIfqDgTUXaArOvKG |
|  |  | GHE3vsgaLvAQ8nz0QaVkwgSIQfz+vBDjlM6InAQQAQIABgUCUsYIjwAKCRA4IttH |
|  |  | zDdPLdPdBACoapJIpeNLyL9szztPzznIIxNbeuFJVfJRAE+pZ08y5YKVtGWArUcb |
|  |  | GBXlZC5FrVTqV3ptIa72ALApIZ/M4Awnk3C3XyjMioKemv7I+cOj5DqRgkR/hsAF |
|  |  | 7YSAg718twgv8W2Ssy8i2vOlAoazxzN9bhVl5cSny5aeUnpLwK0WMYicBBABAgAG |
|  |  | BQJSxgiSAAoJEJwcveLjXFY1DnoD/iFZ3zhzwIyWUl17pESa7H79tbcpmRyelH5M |
|  |  | vH51sEBl27yRRKrsx4oayaumUT7W4JVoQTEYH54unN6fSBqKK9VyxzlA+v8PJjTG |
|  |  | 43MhtMG5lc5B1fKXFer1SpxuoR5h3Qdi4KSz3yh8K8g5KKtciPBx5kEXSTm6Nycu |
|  |  | wkrCRYZLiJwEEAECAAYFAlLGCJcACgkQb1KT2KObplUY2QP/T2Zt5U2cl0usnYck |
|  |  | wmMF3ZAzmcfhsxMkVgxxL9AkVJh9dHhLSYFWN6qhlkZwiW6UhhKoINfEpb8gOcBz |
|  |  | rdb4u8yrWqIS726GqE/gnjYUf5CX22mOPWry8CPuWesRVpr832TzS5wxlBQzRMSS |
|  |  | MVn39IPfIQnC6UQ3tPChruwwZh2InAQQAQIABgUCUsYImgAKCRDvWJZk1DLhnUOZ |
|  |  | A/4qp/HD/+V1zpewexP4wL+bLA9Y6X+y2UWAh7eZCBQvXOhVAYcHxpmWgEfHuS+c |
|  |  | iHYqCc7hz+1AiKV8AfVk6RX0k9Oli/IMbM3ijv3uIl+5JF765oXUAB3RWg6V+MlJ |
|  |  | VhOVkBHXmBuhFnfVPeR5wNPpQ58d9LwsZtU11/Y76xzOUYicBBABAgAGBQJSxgie |
|  |  | AAoJEMGcHSUS00YdL7MEAK/BtyOdoFA/8SBA+8EOG8nd5NSlGNZUBnTlpWqdphkR |
|  |  | SLRrb1gLGr41ND2yvg/ElTti7m1D7+7VUnwCXM5wUO/RZuZx2uDYRCdDXj5WBhcg |
|  |  | 3wsHO3IPGGTbCukp9fLcthBQ46PDewlUVo6gPWhjWG/oC04XYeB3+f1f1zGAai+s |
|  |  | iJwEEAECAAYFAlLGCKMACgkQwCnKQBb0zOm0CAQAhwRycBvn1kZB8cjBVw0a74Xu |
|  |  | rjQrMVqmKM0LW/UzoVscB0W2KxZnvCLcw8N87CnnoSAO3MSnb/vPPhtnQxVe0IBA |
|  |  | 4yoe9acWJvmtIjw4JFDKioVPtEy+pcg5EDlyqNHj0He/Cmbirxbvy2XiGB/Y/lxu |
|  |  | t1kad5ZYY/F5+X4hbyOIRgQQEQIABgUCUsYIsQAKCRAY9QOAJMJ4ArQbAJ414QQw |
|  |  | 60cTU3tVbBTT/l/sRysTXACg1ggZJszRL0P8Yy6WOryQ+r5Fg8yInAQQAQIABgUC |
|  |  | UsYItwAKCRB8S2dtoA4VY3VvA/4i7bKzYElfVdTIj0IgHfd1zneeDjJoJP5tmf7F |
|  |  | ElWIkENFVkKQ+tUBO2d/qMK8h+aj3brDcve5A1LUIsD5leE+igke8SjVF9/fwN4U |
|  |  | 8Mpqrvaw+CX7zGMnt6J075OD7mfU7hZkSpDhmOEMaEzaviei2rovBgaNv7tOlgrk |
|  |  | J5nCo4icBBABAgAGBQJSxgi8AAoJENbgof5PvirdqiMEAKp3kzOjTetlDWAqK0BY |
|  |  | u1kSTCLzO8jFIq620dT0BqorZ5nvxwKovog/FgrZ0LlywsjlwOGCAFo3aW7WTEyt |
|  |  | 7AwlQvUScAbPuZZcyZxKwQ9h2O6C2K2RPVIIHQusLRVcr+oGgqMoNjpSxOOxfJuj |
|  |  | hT6fXHK5SayZSQEiZyeKme12iEYEEBECAAYFAlLGCMEACgkQIfnFvPdqm/UiSwCf |
|  |  | d7Y5AR2m6vK5drJEaqbnv2tmXzcAoMhOg7eUPnYXr0Uwpo/61oHAPUTwiJwEEAEC |
|  |  | AAYFAlLGCMcACgkQvdqP1j/qff1p6QP/TkEC+SJr4YUPy/0cLsSr9j0uPfvke+Qx |
|  |  | U0RWynv4BMU05TKaBeZiVG25iFsGERW0drxiisPkcgMTq98wE7Q23Qtk+Fg8amDn |
|  |  | 6c0qEj0S4xd/DfHPhcznHjjkhiTftSmeMGHDMF8M5+ZBSlJyM6M1dtTlceU88ZYu |
|  |  | Vv89Iz9nnmaJARwEEAECAAYFAlLGCMsACgkQvSdtLm/PqIVOHwgAvKy116ykGuvC |
|  |  | LlxCVx+RfIjhaXa5OTtZhLc7YkXgaNr4UmcvNZtGwQLUEjDO4fVCF/7bSrryZ6Fr |
|  |  | PZBNTKQRwbqH8UksQ+6hIbTBb5ZGcpKQPdIqEWjRjCoDah2EI1ln/JI8WY5NoA+V |
|  |  | iuBd07msr49qevHgGEex5dX7NKOu6nuvefaasVDODNsiMp2QZmIlP7XJw7VKkiEx |
|  |  | ov93DGImxD4o8r2Etzo1Lt5/soNzw26etSRFhoGHRdW2mlS5QFjebV+PNAxwvRrI |
|  |  | a+5CjoA/vFfwxV+RZlvCLhzuEsBIzw6yenfNEd37bzqJq/7Jp7kQCe463o7ujG00 |
|  |  | k+ObGvq/YokBNwQTAQIAIQIbAwIeAQIXgAUCUsYZQgYLCQgHAwIGFQgCCQoLAxYC |
|  |  | AQAKCRBh3hHs4nY6c/AjB/4rt17ezRHDxuDuS7+waPC9N6eXAQCbwdvkYd/v0bWe |
|  |  | 5jHgknMHR9OyGU9JKA4boJCtJNUvceAmzBtynqxy4hR6rmCwCmFW3AIK31iu3frz |
|  |  | Zqq84XK791voKMMrvnux0OHqq2l2mYOSNXUeVNQeyDE6HbKXFUiWhRZl36UndVaE |
|  |  | XhdDnKpxseMpYZsECW1+x1GxbUHFRx6tSiqzgLSNU/SsgwgttHwyqEdW0sr63r66 |
|  |  | 7XSoMKvEgIhb36hJ7AIaFNWasLnnLOTOWR74IHnJ68FpordYm7lnmT5Vg/ju9y29 |
|  |  | JDwfOcNroCao6tTjyXcM6KmIssQPavTDLK/I6XgVr9QziQEcBBABAgAGBQJSxwGo |
|  |  | AAoJEBCQryClqlvmWGgH/3CsqpTEKQW3FL/jughz3Yt8vmgqmlj7ZbTaVehIKRU4 |
|  |  | iL2XOlgAu3JISxCLPkdz79qcMSkZsOJtTGwA1yjvw/yx7oSznvW+jgNZ+fNOuT9w |
|  |  | c6YKGSm0KbGGOFzjzoCsnIpoVEVuJwOS/zqGY349WR5dyaY4pEL42StfqLLtHO7I |
|  |  | IJMKRcubedgZSogT9iwhin+sAGi60Wjq0pX240UQG0bgSB7n+/+7NT64u9yRyPwZ |
|  |  | 9B7Y11smlCw0jIlJD/P51rFgFciG/BdYyPfRHToe5CjOI+1sFxJYuOQI25o9/Syg |
|  |  | 7MMzp3ym2IEjIi3poBwfqZRlPDb5nHfu4vnSntPrwcWJAhwEEAEKAAYFAlLHCkcA |
|  |  | CgkQ8Ar26sJF0gu9AA/9EXGIp5BwAYXNtlrI66nuPBwbPXHIVXocnlu2O2Kfzc9W |
|  |  | Lvl3e5eSi61/TCOPNM4ParKUT9utxq9Sd01WO4GuepQFOiSfhMfKb7ORd0cKfWuM |
|  |  | 9shAKHsTbuAopO9R43jv1QnE+yL1xpM85JaGxI2pWf4XIpL32ZZ0s7s3x1fklNMG |
|  |  | 7ObB5dHr66M/V/GXZSx6rTBWhODm34W07HcXqDdwjVT8J/fo+3kkY9eXYuVfpl8t |
|  |  | bVV6g8DK1zMkQiQBHpN0DCZUYB9WoJgCKFsTvVUElRyMY5sd2bkyAktA2df1EBSH |
|  |  | kMXzqn3py+n3YzRY3VpsNUV3WkDRfU9SIdJd8g88muZeL9namSr/3eHTjdaMoCyL |
|  |  | GyyUpy5LrD56k3QWeXDWVynU9lXuxaiJDntP6A81d6vaIBtm8AFVihtJFoufHot4 |
|  |  | crmPqKtH+MQ9G6xwN5Az9okXKg7HGG9ZD82s4D/X5plN0OH5pMeYLrOQI+oEhjn2 |
|  |  | uK67y0Zl/eqoQcnVDy9PFrynuSVBC5/BTGNbebQrTDrIsQo0m0LMYO3mUzMBA7SO |
|  |  | j9iA0vmXxIGsPzf8lRu26odcahKWswRE492MZiTJlul+HWYmun1b0XJz/4YDWL5l |
|  |  | +kUVLnl53o2aHVlTkmPEMg/mwufkxTayJrtl3kL6oun7e6jUjaCRao9eLFZWtGWI |
|  |  | mwQQAQIABgUCUscuQwAKCRBfHshviAyeVYy3A/ig6XKOyU+RC/+4HtFxvL5osE9T |
|  |  | w/9JlY78umlNish7CJo0Sbka4nFipd6Iw/xcYiAQ06TuS5NDwdmcuoZoUpDAqbLP |
|  |  | r/pWpBy9IAUIzAa1UnyvYTDBp2NS3nxcWnzEpXk/dDyYMKX0gUsrDjE9ZTpsKeMq |
|  |  | 70Kgq7lPtH6EfekmiQIcBBABAgAGBQJSx12BAAoJEG8PnXiV/JnUMB4QAJu5xu2F |
|  |  | ej5QSiIXlZw8LD/uzx3UEQocQy4eGPtwTxeYogt9FtbdblRYb6Y8qc+Uyk6fLBxB |
|  |  | E+gclk3I2GnKnpqjtdG5utJnAbvynqfgoE81tuC7hjxKYPaqGTJotwX4IsV8MZZN |
|  |  | D6hduw1hxCWsnckS/6jnVrJxThKqlKEnnFqLE14W1WTnKIqh+dXYdnqn+MEMXZhK |
|  |  | 7z68TLteASvT1S9i91Kof7gmfe6hL2wbzPAtils6+gJr0ZfxxUTDzFL5hFulypzX |
|  |  | GgW4VemsZLRz6hhevPiWSRIGCG6xO/boGPnlOQt6Fv2mReBiuIidSia9S1G7G8KF |
|  |  | 36ya41RrS6157dgAeSGGUOAzGkvamqlJozlTo1dl8eD08x5G2cHKL/H2oviaE1hr |
|  |  | CgZypLuhPisW2Yd99WMndMV+jrbkNXcORVdYQO/T0aP0vA7zNrTv96shcpNoT3q7 |
|  |  | nWDuGvxjOic8sSX/MxR7F+4UqZO9eZGziPnKDrv1fp17CWWmBBvJHWhFXfPF9nPu |
|  |  | vej6q3Eq49pq3oDuIbtV+1GaMKLre1fzMzqyz1hQ+esByOKi/cAH+QzkbXUC4KyL |
|  |  | q45O/UfNR3hYZms36n05729qF+hW6tO2ZGd43k7kSVgYHj55BIr942dzWMvg7BUY |
|  |  | aWQqYiahIfDxfBXz+WvW5gihr8In24L6dYXDiEYEEBECAAYFAlLHhgUACgkQCaei |
|  |  | StHlggeAhgCdG3L6GRFUho2VtUOx+uaGsvj7vvUAoIahAtf5fb8mSfzceNr5neXd |
|  |  | FgnpiEYEEBECAAYFAlLINaMACgkQxLEHmIV5aiNLbgCgoJYeWDcldLWYU1MH+uvo |
|  |  | Ll4ThV0An0PZNMtCd6gwGGhGd9iMRqHzVpQQiQIcBBABCAAGBQJSyoYqAAoJEIvo |
|  |  | ebAocx4cLO8P/jO9GWX7PSI+k21P4NIjSc6VHYv8MMa5H36NWe8wnoUSUr8FKvUh |
|  |  | uLOI1bDamRZBdCWSuMf3gcWNiwVi3FKJqH/tAdjD4Mc9NaL2DJwKgHH3IlSwV+jF |
|  |  | Hz9OvkEzfo8RT0zVkbt61tMhrNCK7wRw/QrjchixNyJH9YIifV2huppwbgHl5YH7 |
|  |  | 7wYJ1thhIgyw8kSSKHFi3yJzy2q1qZ6hwcCCkUw2K9VgYV+0Y2plSkkc/OsoBUsU |
|  |  | JSNdCOSAzpwAmFuSpT3YVlwWnknJu0vV5BPUL/dJTeYLbhyxfXWiWDiF1tiBWHMS |
|  |  | KvUJowbW9r2CZ/FQx4V5hXKMfCupuDJpmCvIiDfRPGfuD4+4vJ+EhAp2TEyRL3HX |
|  |  | 7BAlQ/95TiS22AhcFqn7Zl+9tS1vUcj4xLmakPQ2REKgBqiUrVDu+GvzZY0A6V6k |
|  |  | J6LNc+ncaLX+B9lYqqMQmxLyRK3JySpHWgC2ZPoyje8GR4ksf0IlvrRufFMj1Qyt |
|  |  | /a8Jc1Z2mXJR3PRrsL7EBDdp7Xl8BGqnjShZgIvKPDt6+nCIqsv13OjWaUBl+CKg |
|  |  | eZcDMt2nZGUfu4KJD6ktJ9nvthrocWxL4dRhFM7s/R9ad1IdmySoBH9SnUuMgM8e |
|  |  | bKQ5FnVqNiy1Z+JrsigPvb671KJ1MA9n2rPaBhY1cNYaaavIbKkBzDDTuQENBFLG |
|  |  | B58BCACe6UEcbxy5q6rIPXZikT4WCg6bw3AtdT/MeLUCmxWhhP9g+T3i0t7zU6bu |
|  |  | Zcw1uFxjnKsMEeDBHwdI0Bg9r5EVtp77GVf1EGrveKvISURlktkBtcezTVRfukEM |
|  |  | mTXBt/3vMGLg+AadFGZTU2ciKdO22AxLBZWVgz0ICoO/ljtvEFokrrzwDoF6ySHX |
|  |  | 3Taiq/aMqI/RjIRXXMq6u+/oVC6droj10eZRYXGPMl7og5MRSUU8waV2fYgtfLmw |
|  |  | BtVEFbd0LPO5L1BNgIIMBx1X/QzMeBTldT+XcDSYh9ELfMJoynnVz0smZbeQ2PZ/ |
|  |  | DhGsVsLvJc+cx5cDnBKsPrejCTXBABEBAAGJAR8EGAECAAkFAlLGB58CGwwACgkQ |
|  |  | Yd4R7OJ2OnMzXAf+LxzrPplcEyIDKOoGW21320AwH5NqjInqj49K0gGhOL/xNkfs |
|  |  | C1wsiFFESdN7eL1+aDdk68CF1ClJagDKkH3U5o5PiPSjCsGBoGpdI6f7mRlxbUT2 |
|  |  | jQv0QC9Qav+9t4QcyBC/1BvwO1e7fgrpFLvBrXJpj4utHBP/R3WUo04kAp+sPbVk |
|  |  | tOEByvXAHkDDe0KAG2G9A0dLqF7kfydoSaioFmoJlkAu7LCwFLFbFZ3JRFAaYEQO |
|  |  | DfwkgPDDOA6k9Y1o+nbk/TgyEj7PtpzkiWh0aK5BRI8mjA/s0XNZKpuY1sghyASo |
|  |  | XvRQkAGPLcqS1D4k+kW3MLWpxjbSwGi8FCdsfg== |
|  |  | =d3FT |
|  |  | -----END PGP PUBLIC KEY BLOCK----- |
|  |  |  |
|  |  | Type Bits KeyID Created Expires Algorithm Use |
|  |  | pub 2048 5207CAD3 2013-01-02 ------- RSA Sign & Encrypt |
|  |  | fingerprint: B87D 4569 86F1 9484 07E5 CCB4 3D68 B25D 5207 CAD3 |
| Expand Down  Expand Up | | @@ -2435,4 +2613,4 @@ DnF3FZZEzV7oqPwC2jzv/1dD6GFhtgy0cnyoPGUJCyc= |
|  |  | =nES8 |
|  |  | -----END PGP PUBLIC KEY BLOCK----- |
|  |  |  |
|  |  | $Revision: 8.43 $, Last updated $Date: 2013/01/18 17:40:21 $ |
|  |  | $Revision: 8.46 $, Last updated $Date: 2014/01/18 00:20:24 $ |

6 changes: 3 additions & 3 deletions

6
[contrib/sendmail/README](#diff-afdf514b32ac88004952c11660c57bc96c3d8b2234007c1cbd8d7ed7fd7935cc "contrib/sendmail/README")

Show comments

[View file](/freebsd/freebsd-src/blob/5dd76dd0cc19450133aa379ce0ce4a68ae07fb39/contrib/sendmail/README)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,7 +1,7 @@ |
|  |  |  |
|  |  | SENDMAIL RELEASE 8 |
|  |  |  |
|  |  | This directory has the latest sendmail(TM) software from Sendmail, Inc. |
|  |  | This directory has the latest sendmail(TM) software from Proofpoint, Inc. |
|  |  |  |
|  |  | Report any bugs to sendmail-bugs-YYYY@support.sendmail.org |
|  |  | where YYYY is the current year, e.g., 2005. |
| Expand Down  Expand Up | | @@ -37,7 +37,7 @@ the latest updates. |
|  |  |  |
|  |  | 4. Read cf/README. |
|  |  |  |
|  |  | Sendmail is a trademark of Sendmail, Inc. |
|  |  | Sendmail is a trademark of Proofpoint, Inc. |
|  |  | US Patent Numbers 6865671, 6986037. |
|  |  |  |
|  |  | +-----------------------+ |
| Expand Down  Expand Up | | @@ -465,4 +465,4 @@ sendmail Source for the sendmail program itself. |
|  |  | test Some test scripts (currently only for compilation aids). |
|  |  | vacation Source for the vacation program. NOT PART OF SENDMAIL! |
|  |  |  |
|  |  | $Revision: 8.95 $, Last updated $Date: 2009/04/10 17:49:18 $ |
|  |  | $Revision: 8.96 $, Last updated $Date: 2013/11/22 20:51:01 $ |

54 changes: 52 additions & 2 deletions

54
[contrib/sendmail/RELEASE\_NOTES](#diff-55daab7a32441c223901d0b134f808c253273f2a4d280db7e4136fd9afa70b4e "contrib/sendmail/RELEASE_NOTES")

Show comments

[View file](/freebsd/freebsd-src/blob/5dd76dd0cc19450133aa379ce0ce4a68ae07fb39/contrib/sendmail/RELEASE_NOTES)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,11 +1,58 @@ |
|  |  | SENDMAIL RELEASE NOTES |
|  |  | $Id: RELEASE\_NOTES,v 8.2024 2013/04/19 15:01:58 ca Exp $ |
|  |  | $Id: RELEASE\_NOTES,v 8.2043 2014/01/23 20:27:19 ca Exp $ |
|  |  |  |
|  |  |  |
|  |  | This listing shows the version of the sendmail binary, the version |
|  |  | of the sendmail configuration files, the date of release, and a |
|  |  | summary of the changes in that release. |
|  |  |  |
|  |  | 8.14.8/8.14.8 2014/01/26 |
|  |  | Properly initialize all OpenSSL algorithms for versions before |
|  |  | OpenSSL 0.9.8o. Without this SHA2 algorithms may not |
|  |  | work properly, causing for example failures for certs |
|  |  | that use sha256WithRSAEncryption as signature algorithm. |
|  |  | When looking up hostnames, ensure only to return those records |
|  |  | for the requested family (AF\_INET or AF\_INET6). |
|  |  | On system that have NEEDSGETIPNODE and NETINET6 |
|  |  | this may have failed and cause delivery problems. |
|  |  | Problem noted by Kees Cook. |
|  |  | A new mailer flag '!' is available to suppress an MH hack |
|  |  | that drops an explicit From: header if it is the |
|  |  | same as what sendmail would generate. |
|  |  | Add an FFR (for future release) to use uncompressed IPv6 addresses, |
|  |  | i.e., they will not contain "::". For example, instead |
|  |  | of ::1 it will be 0:0:0:0:0:0:0:1. This means that |
|  |  | configuration data (including maps, files, classes, |
|  |  | custom ruleset, etc) have to use the same format. |
|  |  | This will be turned on in 8.15. It can be enabled in 8.14 |
|  |  | by compiling with: |
|  |  | APPENDDEF(`conf\_sendmail\_ENVDEF', `-D\_FFR\_IPV6\_FULL') |
|  |  | in your devtools/Site/site.config.m4 file. |
|  |  | Add an additional case for the WorkAroundBrokenAAAA check when |
|  |  | dealing with broken nameservers by ignoring SERVFAIL |
|  |  | errors returned on T\_AAAA (IPv6) lookups at delivery time. |
|  |  | Problem noted by Pavel Timofeev of OCS. |
|  |  | If available, pass LOGIN\_SETCPUMASK and LOGIN\_SETLOGINCLASS to |
|  |  | setusercontext() on deliveries as a different user. |
|  |  | Patch from Edward Tomasz Napierala from FreeBSD. |
|  |  | Avoid compiler warnings from a change in Cyrus-SASL 2.1.25. |
|  |  | Patch from Hajimu UMEMOTO from FreeBSD. |
|  |  | Add support for DHParameters 2048-bit primes. |
|  |  | CONFIG: Accept IPv6 literals when evaluating the HELO/EHLO argument |
|  |  | in FEATURE(`block\_bad\_helo'). Suggested by Andrey Chernov. |
|  |  | LIBSMDB: Add a missing check for malloc() in libsmdb/smndbm.c. |
|  |  | Patch from Bill Parker. |
|  |  | LIBSMDB: Fix minor memory leaks in libsmdb/ if allocations |
|  |  | fail. Patch from John Beck of Oracle. |
|  |  | Portability: |
|  |  | Add support for Darwin 12.x and 13.x (Mac OS X 10.8 and 10.9). |
|  |  | On Linux use socklen\_t as the type for the 3rd argument |
|  |  | for getsockname/getpeername if the glibc version is at |
|  |  | least 2.1. |
|  |  | Added Files: |
|  |  | devtools/OS/Darwin.12.x |
|  |  | devtools/OS/Darwin.13.x |
|  |  |  |
|  |  | 8.14.7/8.14.7 2013/04/21 |
|  |  | Drop support for IPv4-mapped IPv6 addresses to prevent the MTA |
|  |  | from using a mapped address over a legitimate IPv6 address |
| Expand Down  Expand Up | | @@ -80,9 +127,12 @@ summary of the changes in that release. |
|  |  | the reason for the failure in a single log line. Suggested |
|  |  | by James Carey of Boeing. |
|  |  | Portability: |
|  |  | Add support for Darwin 11.x and 12.x (Mac OS X 10.7 and 10.8). |
|  |  | Add support for Darwin 11.x (Mac OS X 10.7). |
|  |  | Add support for SunOS 5.12 (aka Solaris 12). Patch from |
|  |  | John Beck of Oracle. |
|  |  | Added Files: |
|  |  | devtools/OS/Darwin.11.x |
|  |  | devtools/OS/SunOS.5.12 |
|  |  |  |
|  |  | 8.14.5/8.14.5 2011/05/17 |
|  |  | Do not cache SMTP extensions across connections as the cache |
| Expand Down | |  |

7 changes: 5 additions & 2 deletions

7
[contrib/sendmail/cf/README](#diff-8f60c0428c575ee292609c02bb11e6780cc7d7b5662bd679e85854d4e2754b67 "contrib/sendmail/cf/README")

Show comments

[View file](/freebsd/freebsd-src/blob/5dd76dd0cc19450133aa379ce0ce4a68ae07fb39/contrib/sendmail/cf/README)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -77,7 +77,7 @@ Let's examine a typical .mc file: |
|  |  |  |
|  |  | divert(-1) |
|  |  | # |
|  |  | # Copyright (c) 1998-2005 Sendmail, Inc. and its suppliers. |
|  |  | # Copyright (c) 1998-2005 Proofpoint, Inc. and its suppliers. |
|  |  | # All rights reserved. |
|  |  | # Copyright (c) 1983 Eric P. Allman. All rights reserved. |
|  |  | # Copyright (c) 1988, 1993 |
| Expand Down  Expand Up | | @@ -1402,6 +1402,9 @@ preserve\_local\_plus\_detail |
|  |  | that address will be looked up in the alias file; user+\* and |
|  |  | user will not be looked up). Only use if the local |
|  |  | delivery agent in use supports +detail addressing. |
|  |  | Moreover, this will most likely not work if the 'w' flag |
|  |  | for the local mailer is set as the entire local address |
|  |  | including +detail is passed to the user lookup function. |
|  |  |  |
|  |  | compat\_check Enable ruleset check\_compat to look up pairs of addresses |
|  |  | with the Compat: tag -- Compat:sender<@>recipient -- in the |
| Expand Down  Expand Up | | @@ -4701,4 +4704,4 @@ M4 DIVERSIONS |
|  |  | 8 DNS based blacklists |
|  |  | 9 special local rulesets (1 and 2) |
|  |  |  |
|  |  | $Revision: 8.728 $, Last updated $Date: 2012/09/07 16:29:13 $ |
|  |  | $Revision: 8.730 $, Last updated $Date: 2014/01/16 15:55:51 $ |

4 changes: 2 additions & 2 deletions

4
[contrib/sendmail/cf/cf/chez.cs.mc](#diff-8755f4e131c8b55c54840fce94665aeb1e1637743ca04f6c7da1e84b2ed8b291 "contrib/sendmail/cf/cf/chez.cs.mc")

Show comments

[View file](/freebsd/freebsd-src/blob/5dd76dd0cc19450133aa379ce0ce4a68ae07fb39/contrib/sendmail/cf/cf/chez.cs.mc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | divert(-1) |
|  |  | # |
|  |  | # Copyright (c) 1998, 1999 Sendmail, Inc. and its suppliers. |
|  |  | # Copyright (c) 1998, 1999 Proofpoint, Inc. and its suppliers. |
|  |  | # All rights reserved. |
|  |  | # Copyright (c) 1983 Eric P. Allman. All rights reserved. |
|  |  | # Copyright (c) 1988, 1993 |
| Expand All | | @@ -24,7 +24,7 @@ divert(-1) |
|  |  | # |
|  |  |  |
|  |  | divert(0)dnl |
|  |  | VERSIONID(`$Id: chez.cs.mc,v 8.14 1999/02/07 07:25:59 gshapiro Exp $') |
|  |  | VERSIONID(`$Id: chez.cs.mc,v 8.15 2013/11/22 20:51:08 ca Exp $') |
|  |  | OSTYPE(bsd4.4)dnl |
|  |  | DOMAIN(CS.Berkeley.EDU)dnl |
|  |  | define(`LOCAL\_RELAY', vangogh.CS.Berkeley.EDU)dnl |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[contrib/sendmail/cf/cf/clientproto.mc](#diff-7d75d5f4267cb55d65a7e7d013b0aff2b55ebdd72fa06b7eff1190ab021e9ef1 "contrib/sendmail/cf/cf/clientproto.mc")

Show comments

[View file](/freebsd/freebsd-src/blob/5dd76dd0cc19450133aa379ce0ce4a68ae07fb39/contrib/sendmail/cf/cf/clientproto.mc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | divert(-1) |
|  |  | # |
|  |  | # Copyright (c) 1998-2000 Sendmail, Inc. and its suppliers. |
|  |  | # Copyright (c) 1998-2000 Proofpoint, Inc. and its suppliers. |
|  |  | # All rights reserved. |
|  |  | # Copyright (c) 1983 Eric P. Allman. All rights reserved. |
|  |  | # Copyright (c) 1988, 1993 |
| Expand All | | @@ -23,7 +23,7 @@ divert(-1) |
|  |  | # |
|  |  |  |
|  |  | divert(0)dnl |
|  |  | VERSIONID(`$Id: clientproto.mc,v 8.16 2000/03/21 21:05:26 ca Exp $') |
|  |  | VERSIONID(`$Id: clientproto.mc,v 8.17 2013/11/22 20:51:08 ca Exp $') |
|  |  |  |
|  |  | OSTYPE(unknown) |
|  |  | FEATURE(nullclient, mailhost.$m) |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5dd76dd`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffreebsd%2Ffreebsd-src%2Fcommit%2F5dd76dd0cc19450133aa379ce0ce4a68ae07fb39) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from fahrplan.events.ccc.de_c5aa1a3a_20250115_090833.html ===


# Schedule 37th Chaos Communication Congress

* [Overview](/congress/2023/fahrplan/index.html)
* [Wednesday
  -
  2023-12-27](/congress/2023/fahrplan/schedule/1.html)
* [Thursday
  -
  2023-12-28](/congress/2023/fahrplan/schedule/2.html)
* [Friday
  -
  2023-12-29](/congress/2023/fahrplan/schedule/3.html)
* [Saturday
  -
  2023-12-30](/congress/2023/fahrplan/schedule/4.html)
* [Speakers](/congress/2023/fahrplan/speakers.html)
* [Events](/congress/2023/fahrplan/events.html)
* [timeline](/congress/2023/fahrplan/timeline.html)
* [book](/congress/2023/fahrplan/booklet.html)
* [QR-Code](/congress/2023/fahrplan/qrcode.html)

Version Nichts ist wahr. Alles ist erlaubt.

## Lecture: SMTP Smuggling â Spoofing E-Mails Worldwide

###

![](/congress/2023/fahrplan/system/events/logos/000/011/782/large/SMTP_Smuggling-37C3_Logo.png)

Introducing a novel technique for e-mail spoofing.

SMTP, the Simple Mail Transfer Protocol, allows e-mailing since 1982. This easily makes it one of the oldest technologies amongst the Internet. However, even though it seems to have stood the test of time, there was still a trivial but novel exploitation technique just waiting to be discovered â SMTP smuggling!

In this talk, weâll explore how SMTP smuggling breaks the interpretation of the SMTP protocol in vulnerable server constellations worldwide, allowing some more than unwanted behavior. Sending e-mails as admin@microsoft.com to fortune 500 companies â while still passing SPF checks â will be the least of our problems!

From identifying this novel technique to exploiting it in one of the most used e-mail services on the Internet, weâll dive into all the little details this attack has to offer. Therefore, in this talk, weâll embark on an expedition beyond the known limits of SMTP, and venture into the uncharted territories of SMTP smuggling!

### Info

**Day:**
[2023-12-27](/congress/2023/fahrplan/schedule/1.html)

**Start time:**
22:05

**Duration:**
00:40

**Room:**
Saal Zuse

**Track:**
[Security](/congress/2023/fahrplan/events.html#security)

**Language:**
en

### Links:

* [iCalendar](/congress/2023/fahrplan/events/11782.ics)

### Feedback

[Click here to let us know how you liked this event.](https://frab.cccv.de/en/37c3/public/events/11782/feedback/new)

### Concurrent Events

### Speakers

|  | [Timo Longin](/congress/2023/fahrplan/speakers/19110.html) |
| --- | --- |

This schedule was generated with [frab](http://frab.github.io/frab/).

Archived page - [Impressum/Datenschutz](https://legal.cccv.de/)

=== Content from sec-consult.com_4dd94eef_20250115_133841.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/blog/detail/smtp-smuggling-ein-neue-methode-zur-absenderfaelschung-in-e-mails/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Blog](/blog/)
3. SMTP Smuggling - Spoofing E-Mails Worldwide
# SMTP Smuggling - Spoofing E-Mails Worldwide

18.12.2023

Introducing a novel technique for e-mail spoofing

![Overview SMTP Smuggling](/fileadmin/_processed_/a/8/csm_SMTP_Smuggling-Overview_Header_1ec709623c.png)

*In the course of a research project in collaboration with the SEC Consult Vulnerability Lab, Timo Longin ([@timolongin](https://twitter.com/timolongin)) - known for his [DNS protocol attacks](https://sec-consult.com/blog/detail/taking-over-a-country-kaminsky-style/) - discovered a novel exploitation technique for yet another Internet protocol - SMTP ([Simple Mail Transfer Protocol](https://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol)). Threat actors could abuse vulnerable SMTP servers worldwide to send malicious e-mails from arbitrary e-mail addresses, allowing targeted phishing attacks. Due to the nature of the exploit itself, this type of vulnerability was dubbed **SMTP smuggling**. Multiple 0-days were discovered, and various vendors were notified during our responsible disclosure in 2023.*

## Update on SMTP smuggling and responsible disclosure

Update 2024-02-19: The SMTP smuggling research scored 3rd place in the Portswigger Top 10 web hacking techniques of 2023, check it out here: [portswigger.net/research/top-10-web-hacking-techniques-of-2023](https://portswigger.net/research/top-10-web-hacking-techniques-of-2023)

Update 2024: We have created a new website which gives a short summary about the identified vulnerability, available tools and mitigations of various vendors: [smtpsmuggling.com](https://smtpsmuggling.com/)

Update, 2023-12-22: We were made aware of public discussions about the SMTP smuggling research on various platforms and we wanted to add some input regarding responsible disclosure as well as previous and further communication with the vendors.

We strictly adhere to our responsible disclosure processes (<https://sec-consult.com/vulnerability-lab/responsible-disclosure-policy/>) and always contact affected vendors before any publication. But in this case a lack of clarity in the communication and different interpretations of the impact of the vulnerability led to assumptions from all parties involved on who is affected, what the real impact could be and who has to be notified before publication.

As documented in the timeline of the blog post, the vulnerabilities were initially identified in June 2023 and after further internal research we contacted the specific, affected vendors (Microsoft, Cisco, GMX/Ionos). GMX and Microsoft fixed the issues promptly. But after receiving some feedback from Cisco, that our identified vulnerability is just a feature of the software and not a bug/vulnerability, we contacted CERT/CC on 17th August to get some help for further discussion with Cisco and involve other potentially affected vendors (such as sendmail) through the [VINCE communication platform](https://kb.cert.org/vince/).

There, we submitted all our research details and explained the case to the vendors involved. We received feedback from Cisco that our identified research is not a vulnerability, but a feature and that they will not change the default configuration nor inform their customers. Other vendors did not respond in VINCE but were contacted by CERT/CC.

Based on this feedback and as multiple other vendors were included in this discussion through the CERT/CC VINCE platform without objecting, we wrongly assessed the broader impact of the SMTP smuggling research. Because of this assumption, we asked CERT/CC end of November regarding publication of the details and received confirmation to proceed.

As our research was accepted at this year's 37C3 conference (info received on 3rd December) and we still thought that Cisco users should be warned about the vulnerable default configuration, we decided to publish our research before the conference and holidays in order to provide administrators time to re-configure their Cisco configuration. Hence, we also contacted CERT-Bund (BSI Germany) and CERT.at on 5th December via encrypted email and informed them about the planned release date of the blog post for 18th December and included the full blog post details and further call for action to warn Cisco users.

 Furthermore, we continue discussing SMTP smuggling with CERT/CC and affected vendors through the VINCE platform to address future remediation and measures.

 Our learnings from this case are that we will put even more thought into potential broader impact when sharing details with affected vendors and to strengthen the collaboration and communication with all parties involved.

## Postfix remediation and workaround

Postfix developers Wietse Venema and Viktor Dukhovni have promptly responded to the SMTP smuggling threat and released short-term workarounds on how the vulnerability can be fixed:

<https://www.postfix.org/smtp-smuggling.html>

###

### Official tools to test for SMTP smuggling issues are now available on [GitHub](https://github.com/The-Login/SMTP-Smuggling-Tools)

[![Example SMTP session between sender.example and receiver.example ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_full__02_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_full__02_.png)

Figure 1: Example SMTP session between sender.example and receiver.example

Novel attacks in SMTP? Yes, you read that right - **SMTP!**

Even though SMTP, the Simple Mail Transfer Protocol, is used for sending e-mails across the globe since the beginning of the Internet, it is still possible to find new ways of exploiting it even in 2023! So, **fasten your seat belts**, as we embark on an expedition beyond the known limits of SMTP, and venture into the uncharted territories of **SMTP smuggling**!

## TL;DR

By exploiting interpretation differences of the SMTP protocol, it is possible to smuggle/send spoofed e-mails - hence SMTP smuggling - while still passing SPF alignment checks. During this research, two types of SMTP smuggling, **outbound** and **inbound**, were discovered. These allowed sending spoofed e-mails **from millions** of domains (e.g., admin@outlook.com) to millions of receiving SMTP servers (e.g., Amazon, PayPal, eBay). Identified vulnerabilities in Microsoft and GMX were quickly fixed, however, **SEC Consult urges** companies using the also affected [Cisco Secure Email](https://www.cisco.com/site/in/en/products/security/secure-email/index.html) product to manually update their vulnerable default configuration (see Responsible Disclosure section below)!

##

## SMTP Basics

Before getting into the juicy bits and details of SMTP smuggling, we must first have a basic understanding of the SMTP protocol, SMTP terminology and e-mailing in general. Let's learn by example!

Here, in figure 1, we have an SMTP session between sender.example and receiver.example.

[![SMTP session transferring a mail object, including mail envelope and mail content/data, with SMTP commands, line breaks and data separated by color. ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender__03_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender__03_.png)

Figure 2: SMTP session transferring a mail object, including mail envelope and mail content/data, with SMTP commands, line breaks and data separated by color.

So, what's exactly going on here?

1. Initially, the receiving SMTP server **mx.receiver.example** sends a greeting, indicating that it is ready to accept incoming SMTP commands.
2. The "client"/sender **sender.example** initiates the SMTP session by sending the EHLO (extended hello) **SMTP command** to the server, specifying its domain name. Note that all SMTP commands will be highlighted in red.
3. **mx.receiver.example** responds with a 250 status code, indicating that the requested command (EHLO) was successful. It also provides supported **SMTP capabilities**.
4. Then, **sender.example** specifies the sender e-mail address as well as the receiver e-mail address via "mail FROM" and "rcpt TO" in the mail **envelope**. **mx.receiver.example** confirms both of these **SMTP commands** with a 250 status code.
5. Now, **sender.example** transmits the "data" command to signal its intention to start sending the message data/content.
6. After receiving a "go ahead" response, **sender.example** sends **message****headers** "Subject"/"From"/"To", a **message body** "lorem ipsum" and an **end-of-data sequence****"<CR><LF>.<CR><LF>"** (Carriage-Return / Line-Feed, and a single dot in a line). Note that all message data will be highlighted in blue.
7. **mx.receiver.example** reads the end-of-data sequence and responds with a 250 status code, implying that the message data was accepted.
8. Lastly, **sender.example** closes the connection via the "quit" command.

As you can see, there is a lot of back and forth in this SMTP session. To keep it simple and concise, SMTP sessions in this blog post **only** include the data transmitted by the sender as shown in figure 2.

[![Overview of a simplified e-mailing process via SMTP from left to right ](/fileadmin/_processed_/5/d/csm_SMTP_Smuggling-Sending_e-mails_overview__3__04__803988674e.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Sending_e-mails_overview__3__04_.png)

Figure 3: Overview of a simplified e-mailing process via SMTP from left to right

With this much knowledge about the SMTP protocol, we can put the training wheels aside and look at how SMTP is used to transfer e-mails across the Internet. For example, by sending an e-mail from user(at)outlook.com to user(at)receiver.example!

When sending an e-mail via [outlook.com](https://outlook.com/), we generally have two options:

1. Outlook's web interface
2. Using SMTP

Since this blog post is about SMTP smuggling and doesn't have to do anything with web applications (like [SMTP header injection](https://portswigger.net/kb/issues/00200800_smtp-header-injection)), we're opting for number two - SMTP! How this works is described in figure 3.

So, starting from the left side of the overview, the **mail user agent** (**MUA**: Thunderbird, Outlook, Windows Mail, etc.) connects to Outlook's **mail transfer agent** (**MTA**) on the message submission port TCP/587. MTAs that are dedicated to sending **outbound e-mails** are further addressed as **outbound SMTP servers**. The MUA then sends a series of SMTP commands and message data. Since we haven't described the STARTTLS and AUTH LOGIN commands before, here is a short description:

* **STARTTLS** is used to upgrade to an encrypted TLS session. Since SMTP is generally unencrypted, credentials would otherwise be exposed to listening attackers.
* The AUTH LOGIN SMTP command is used for authenticating the user. In this case, this is done via username and password.

After evaluating if the authenticated user is allowed to send an e-mail for the provided e-mail address in the "mail FROM" and "From" fields, the Outlook SMTP server sends an **inbound e-mail** to the **inbound SMTP server** of **receiver.example** over port TCP/25. This SMTP data looks very similar to the SMTP data submitted to the **outbound SMTP** server, but doesn't include the AUTH LOGIN command and, in this case, doesn't use STARTTLS.

This concludes the e-mail transfer. But how does the receiving inbound SMTP server make sure that the outbound SMTP server is indeed allowed to send e-mails for outlook.com? Or, why can't just anyone send e-mails for the outlook.com domain?

## SPF, DKIM and DMARC

Before an inbound SMTP server accepts an e-mail, it checks the sender's authenticity via e-mail authentication mechanisms such as [SPF](https://en.wikipedia.org/wiki/Sender_Policy_Framework), [DKIM](https://en.wikipedia.org/wiki/DomainKeys_Identified_Mail) and [DMARC](https://en.wikipedia.org/wiki/DMARC). This is important, since otherwise attackers could just send e-mails from arbitrary domains. For example, sending an e-mail as admin(at)outlook.com from an attacker server would be entirely possible. The most prevalent e-mail authentication mechanism, **SPF**, works by permitting sender IP addresses in special SPF/TXT DNS records. The SPF record of [outlook.com](http://outlook.com/) permits the following IP ranges for e-mail transfer:

v=spf1 include:spf-a.outlook.com include:spf-b.outlook.com ip4:157.55.9.128/25 include:spf.protection.outlook.com include:spf-a.hotmail.com include:\_spf-ssg-b.microsoft.com include:\_spf-ssg-c.microsoft.com ~all

[![Passing SPF checks with attacker.example domain, while sending as user@sender.example ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender_SPF_spoofing__05_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender_SPF_spoofing__05_.png)

Figure 4: Passing SPF checks with attacker.example domain, while sending as user@sender.example

If you are not sending from one of these IP ranges, the SPF check would fail and your e-mail most likely won't be forwarded or will be marked as spam. But which domain is actually getting checked? The problem with SPF by itself is that only the MAIL FROM domain from the mail envelope is checked. The From header in the message data, which is further displayed in the received e-mail, can have an arbitrary value, as shown in figure 4 (blue text).

[![Passing SPF and DKIM checks, by sending from an attacker server with an attacker-controlled DKIM key ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender_SPF_and_DKIM_spoofing__06_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender_SPF_and_DKIM_spoofing__06_.png)

Figure 5: Passing SPF and DKIM checks, by sending from an attacker server with an attacker-controlled DKIM key

The same goes for **DKIM** (DomainKeys Identified Mail) as well. DKIM allows signing the message data, including the From header. This signature can then be verified by the receiver with a public key that resides in the DNS. However, it is not enforced, which domain holds the public key (see figure 5).

In this case, the message from "user@sender.example" may be signed, but the verification key is located at "dkim.\_domainkey.attacker.example". This location is derived from concatenating the selector (s=) "dkim", the static value "\_domainkey" and the domain (d=) "attacker.example". So, even though an e-mail may have a valid SPF record and a valid DKIM signature, there is no mechanism for telling if the e-mail comes from a malicious sender or not.

Fortunately, there is **DMARC**, which stands for "Domain-based Message Authentication, Reporting and Conformance". DMARC introduces so-called "identifier alignment" for SPF and DKIM and allows senders to specify alignment policies for both methods. It verifies if the email's "From" domain aligns with SPF checks and/or DKIM signatures. Thus, the DMARC check fails if there is a mismatch between the MAIL FROM and the From domain where otherwise the SPF check would pass. An example for a DMARC policy, which is always located in a TXT record at \_dmarc.[domain], can be seen here:

v=DMARC1; p=reject; sp=none; fo=0; adkim=r; aspf=r; pct=100; rf=afrf

The policy (p=) tells the receiving server to reject 100 percent (pct=) of the messages that fail the DMARC check. Therefore, the message will get accepted (only) if a valid SPF record and/or DKIM signature is provided.

However, what happens if there is no DMARC record? In general, e-mail authenticity handling heavily depends on the inbound SMTP server's configuration and software. As a rule of thumb, if there is SPF or DKIM alignment, there is a good chance of the e-mail being accepted!

Now, with the groundwork done, let's get into **SMTP smuggling**!

[![Simple example of HTTP request smuggling by PortSwigger ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-HTTP_request_smuggling__07_.png "Figure 6: Simple example of HTTP request smuggling by PortSwigger ")](https://portswigger.net/web-security/request-smuggling "Figure 6: Simple example of HTTP request smuggling by PortSwigger")

Figure 6: Simple example of HTTP request smuggling by PortSwigger

## SMTP Smuggling?

The initial goal of this research was to test the SMTP protocol against some common and exotic attacks that work on other protocols, such as HTTP. Thanks to the contribution of many brilliant minds, there is a variety of **HTTP** attacks to choose from. However, in the context of SMTP, one of them just fit the bill. **HTTP request smuggling**!

If you want an in-depth explanation of HTTP request smuggling and all its facets, James Kettle (aka [@albinowax](https://twitter.com/albinowax)) did a [wonderful job](https://jameskettle.com/) on that. However, for now, we only need to understand the essentials!

With HTTP request smuggling, we're basically trying to exploit different interpretations of the same thing. For example, with discrepancies in the interpretation and processing of the "Content-Length" and "Transfer-Encoding" HTTP headers, an arbitrary HTTP request can be smuggled to an otherwise unreachable back-end server like in figure 6.

[![SMTP session with SMTP commands and message data separated by colour. ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender__08_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender__08_.png)

Figure 7: SMTP session with SMTP commands and message data separated by colour.

In this example, the vulnerable front-end server only sees one HTTP POST request, while the back-end server sees a POST request **and** a GET request to /**admin**!

With SMTP, we also have a setup with two servers, being **outbound and inbound SMTP servers**. So, let's take a look at an SMTP session again in figure 7.

[![SMTP smuggling in theory ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png)

Figure 8: SMTP smuggling in theory

Now tell me, **what happens if outbound and inbound SMTP servers interpret the end-of-data sequence (<CR><LF>.<CR><LF>) differently?**

Exactly, S**MTP smuggling!**

If SMTP servers have a different understanding of where the message data ends, an attacker can potentially break out of the message data. Even worse, this may allow to specify arbitrary SMTP commands and even to send separate e-mails (see figure 8)!

[![SMTP analysis setup for analyzing outbound SMTP servers ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_analysis_test_setup__3__10_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_analysis_test_setup__3__10_.png)

Figure 9: SMTP analysis setup for analyzing outbound SMTP servers

So, that's the basic idea of SMTP smuggling! But does it actually work?

## <CR><LF>.<CR><LF> is a lie?

To get a good understanding of how different kinds of SMTP software work, we can start our analysis as shown in figure 9:

[![Using \n.\n as end-of-data sequence #1 ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_CRLF_smuggling___11_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_CRLF_smuggling___11_.png)

Figure 10: Using \n.\n as end-of-data sequence #1

First, we register e-mail accounts at various public e-mail providers that support mail submissions via SMTP (unlike Tutanota and ProtonMail). We used the following providers for this research project:

* outlook.com
* gmail.com
* gmx.net
* icloud.com
* zoho.com
* fastmail.com
* runbox.com
* startmail.com
* mailbox.org
* aol.com
* yahoo.com
* web.de

Then, by sending e-mails through the **outbound** SMTP servers of these providers and receiving them on an **inbound SMTP analysis server**, we can see first differences in the implementation of the SMTP protocol in these SMTP servers.

When looking at the **SMTP analysis client** it becomes apparent straight away that some SMTP products do things "differently" than others. For example, here are some responses received from e-mail providers after sending the **DATA** SMTP command:

- 250 End data with <CR><LF>.<CR><LF>
 - 250 Start mail input; end with <CRLF>.<CRLF>
 - 250 Send data ending with <CRLF>.<CRLF>

This doesn't look good for our plans to smuggle SMTP commands, since we're looking for different interpretations of SMTP, and not the same text written differently. Right? But, we're not going to back off just because of some text, are we?

After further analysis, some SMTP servers returned the following responses, which looked a bit more promising:

- Enter message, ending with "." on a line by itself
 - Enter mail, end with "." on a line by itself

Why would that be more promising, though? Well, different operating systems have a different understanding of "**a line by itself**". A "." on a line by itself on Windows would be separated via two carriage return line feeds (**<CR><LF>.<CR><LF>** or **\r\n.\r\n**), while a "." on a line by itself on Linux would be separated with two line feeds (<LF>.<LF> or \n.\n).

So, why don't we try to end the message data of an e-mail with **<LF>.<LF>?** This would therefore look like in figure 10.

[![Using \n.\n as end-of-data sequence #2 ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_CRLF_smuggling__12_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_CRLF_smuggling__12_.png)

Figure 11: Using \n.\n as end-of-data sequence #2

Now, if an SMTP server doesn't consider <LF>.<LF> as the end-of-data sequence, the connection will be left hanging, since it's waiting for the actual <CR><LF>.<CR><LF>. Therefore, as shown in figure 11, we add the following.

[![Outbound e-mail provider delivering an e-mail with <LF>.<LF> sequence (not vulnerable) ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-12-4_19-57-58__13_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-12-4_19-57-58__13_.png)

Figure 12: Outbound e-mail provider delivering an e-mail with <LF>.<LF> sequence (not vulnerable)

With this, whenever <LF>.<LF> is supported as end-of-data sequence by the inbound SMTP server, only "lorem ipsum" will be part of the message data, otherwise the message also includes "This server is ignoring line feeds as end-of-data sequence!".

But, what can we actually achieve with this? Well, let's see how a message transfer could look like if <LF>.<LF> doesn't end the data section, like in figure 12.

[![Outbound e-mail provider delivering an e-mail with <LF>.<LF> sequence (vulnerable) ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-CRLF_Smuggling_2__3__14_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-CRLF_Smuggling_2__3__14_.png)

Figure 13: Outbound e-mail provider delivering an e-mail with <LF>.<LF> sequence (vulnerable)

Depending on the receiving inbound SMTP server this may be completely harmless. However, what if the inbound SMTP server interprets <LF>.<LF> as end-of-data sequence? (see figure 13)

[![Potential end-of-data sequence between START and END going through GMX's outbound SMTP server unchanged ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-GMX_Smuggling__3__15_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-GMX_Smuggling__3__15_.png)

Figure 14: Potential end-of-data sequence between START and END going through GMX's outbound SMTP server unchanged

In this case, the "harmless" <LF>.<LF> breaks out of the message data and "This server is ignoring line feeds as end-of-data sequence!" may now be interpreted as an **SMTP command**! Note that this requires the inbound server to accept multiple SMTP commands in a batch, or so-called SMTP pipelining. Luckily for us, most servers support this nowadays.

However, **outbound SMTP servers** commonly handle such "troublesome" <LF>.<LF> sequences via different means:

* Dot-stuffing (Escaping the single dot with another dot):  <LF>..<LF>
* Replacing it with a <CR><LF>
* Encoding it (e.g., via quoted-printable): =0A.=0A
* Removing the entire sequence
* Not sending the message

But sometimes, **they do nothing at all**!

So, essentially, we're looking for specific characteristics in outbound and inbound SMTP servers in terms of end-of-data sequence handling. More precisely, we're searching for what outbound SMTP servers ignore (e.g., <LF>.<LF>) and what inbound SMTP servers interpret (e.g., <LF>.<LF> as end-of-data). If we can find a correct combination, we can smuggle!

## First Blood

As previously mentioned, we've created e-mail accounts at various e-mail providers. Shortly after sending potential end-of-data sequences (e.g., <LF>.<LF>) from outbound provider SMTP servers to the SMTP analysis server, a **promising candidate emerged**!

**GMX**, established in 1997, is one of the old-school e-mail providers in the DACH region with roughly 20 million users. When sending an **<LF>.<CR><LF>** sequence to the outbound GMX SMTP server, it is passed unfiltered to the inbound SMTP server, as shown in figure 14!

[![SMTP smuggling from admin@gmx.net to user@provider.example ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_GMX__16_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_GMX__16_.png)

Figure 15: SMTP smuggling from admin@gmx.net to user@provider.example

Therefore, we can now break out of the message data at the inbound SMTP server, if <LF>.<CR><LF> is interpreted as an end-of-data sequence. So, how do we find such servers?

We simply send an e-mail with the following message data (see figure 15) to all the e-mail addresses we've registered.

[![Failed attempt of SMTP smuggling against Gmail ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/GMX_to_GMAIL_smuggling_failed__17_.PNG)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/GMX_to_GMAIL_smuggling_failed__17_.PNG)

Figure 16: Failed attempt of SMTP smuggling against Gmail

For a lot of them, we receive a very suspicious looking e-mail like in figure 16, since <LF>.<CR><LF> did not end the message data.

[![Successful SMTP smuggling from GMX to Fastmail. "Look at me! I am the admin now!" ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/GMX_to_FASTMAIL_smuggling_success__18_.PNG)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/GMX_to_FASTMAIL_smuggling_success__18_.PNG)

Figure 17: Successful SMTP smuggling from GMX to Fastmail. "Look at me! I am the admin now!"

But for some of them, we hit the jackpot!

[![Cross-domain SMTP smuggling to different recipients ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_WEB.DE_19_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_WEB.DE_19_.png)

Figure 18: Cross-domain SMTP smuggling to different recipients

This proof of concept (figure 17) was the first sign that SMTP smuggling actually works!

By inspecting the message headers, we can see that the SPF check passes with domain alignment for gmx.net! This is because the smuggled message actually came from the legitimate GMX SMTP server.

Received-SPF: pass

    (gmx.net: 212.227.15.15 is authorized to use 'admin@gmx.net' in 'mfrom' identity (mechanism 'ip4:212.227.15.0/25' matched))

    receiver=mx4.messagingengine.com;

    identity=mailfrom;

    envelope-from="admin@gmx.net";

    helo=mout.gmx.net;

    client-ip=212.227.15.15

Since we've achieved domain alignment for gmx.net, this e-mail will most likely pass spam filters, even with strict DMARC policies! **But wait**, if other domains also use the outbound SMTP server of GMX to send e-mails, can't we spoof them as well? Let's see! By analyzing the SPF record of **web.de**, we can see that the outbound SMTP IP address of GMX **212.227.15.15** is included as well!

v=spf1 ip4:212.227.126.128/25 ip4:212.227.15.0/25 ip4:212.227.17.0/27 ip4:217.72.192.248/29 ip4:82.165.159.0/26 ip4:217.72.207.0/27 ip4:217.72.192.64/26 ip4:82.165.229.130 ip4:82.165.230.22 ~all

Now, we can change the SMTP smuggling message data accordingly, like in figure 18.

[![Successful cross-domain SMTP smuggling from GMX to Fastmail using web.de as sender domain ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/WEB.DE_to_FASTMAIL_smuggling_success__20_.PNG)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/WEB.DE_to_FASTMAIL_smuggling_success__20_.PNG)

Figure 19: Successful cross-domain SMTP smuggling from GMX to Fastmail using web.de as sender domain

To simulate a real-life scenario, we specify a different receiver e-mail address for the first message and only send the smuggled message (figure 19) to the target.

[![Censored (real) profile picture associated with admin@web.de ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-12-4_21-4-41__21_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-12-4_21-4-41__21_.png)

Figure 20: Censored (real) profile picture associated with admin@web.de

In this case, our target would even see the associated profile picture (in this case of the real 'admin@web.de' user), like in figure 20!

[![Sending message data via BDAT](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-BDAT__22_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-BDAT__22_.png)

Figure 21: Sending message data via BDAT

And again, the SPF verification checks out!

Received-SPF: pass

    (web.de: 212.227.17.22 is authorized to use 'admin@web.de' in 'mfrom' identity (mechanism 'ip4:212.227.17.0/27' matched))

    receiver=mx4.messagingengine.com;

    identity=mailfrom;

    envelope-from="admin@web.de";

    helo=mout.gmx.net;

    client-ip=212.227.17.22

Now, you might think that this was already cool, **but we're just getting started**!

Even though we initially only analyzed GMX, the problem is far worse than it seemed at first. Like many big e-mail providers, GMX is using a custom SMTP server called **Nemesis****SMTPd**. Since GMX is part of **Ionos**, e-mailing services provided by Ionos are also using Nemesis SMTPd. By putting 1 and 1 together, we register an e-mail domain at Ionos and check if SMTP smuggling works. And it does! However, smuggling via a custom e-mail domain doesn't even seem to be necessary. The SPF record for the registered e-mail domain includes "\_spf-eu.ionos.com" and the SPF record for gmx.net includes "\_spf.gmx.net". Looking at the permitted IP ranges reveals "some" collisions:

$ dig \_spf-eu.ionos.com TXT
 "v=spf1 ip4:212.227.126.128/25 ip4:212.227.15.0/25 ip4:212.227.17.0/27 ip4:82.165.159.0/26 ip4:217.72.192.64/26 ?all"

 $ dig \_spf.gmx.net TXT
 "v=spf1 ip4:212.227.126.128/25 ip4:212.227.15.0/25 ip4:212.227.17.0/27 ip4:82.165.159.0/24 ip4:74.208.4.192/26  ip4:217.72.207.0/27 ip4:82.165.229.31 ip4:82.165.230.21 ip4:213.165.64.0/23 ip4:74.208.5.64/26 ~all"

So, either way, this allowed **spoofing** not only **gmx.net** and **web.de**, but also around a **million** other domains hosted at **Ionos**! But more on the details later!

## Smuggling via Microsoft Exchange Online

After a deeper analysis of outbound SMTP servers, a peculiarity in **Microsoft Outlook's** ([outlook.com](https://outlook.com/)) SMTP server was observed. When trying to send an **<LF>.<LF>** sequence, the message does not get transmitted, and the following error message is returned:

Remote server returned '550 5.6.11 SMTPSEND.BareLinefeedsAreIllegal; message contains bare linefeeds, which cannot be sent via DATA and receiving system does not support BDAT'

However, same as with GMX, **Outlook doesn't filter <LF>.<CR><LF>** sequences.

Still, it wasn't possible to smuggle to the same receivers (e.g., Fastmail) as with GMX. Reason for this is Outlook's usage of the optional **BDAT** SMTP command. BDAT is an alternative to the **DATA** command to transfer the message data. It works by specifying the message length with the BDAT command, instead of relying on an end-of-data sequence. For example, to transfer 72 bytes of message data, we can do it like in figure 21.

[![Sending a phishing e-mail from admin@outlook.com via SMTP smuggling](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_Outlook__23_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_Outlook__23_.png)

Figure 22: Sending a phishing e-mail from admin@outlook.com via SMTP smuggling

Even though that stops us from smuggling to some inbound SMTP servers, the BDAT command can only be used by Outlook, if the inbound SMTP server supports it. If the inbound SMTP server doesn't indicate BDAT support by returning the **CHUNKING** capability, DATA is used as fallback.

Therefore, we're looking for an inbound SMTP server that interprets <LF>.<CR><LF> as an end-of-data sequence and doesn't support BDAT.

Funnily enough, the [sec-consult.com](https://sec-consult.com/) SMTP server supports just that! Note that **LOTS** of servers on the Internet support this, but since we've got to make sure that our own systems are secure anyways, we'll be using sec-consult.com. So, what's the first thing to do with our newly gained power? **Sending spoofed e-mails to co-workers to make sure it actually works!** (see figure 22)

[![Typical Austrian reaction after receiving a spoofed e-mail ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/teams_conversation_OIDA__24_.PNG)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/teams_conversation_OIDA__24_.PNG)

Figure 23: Typical Austrian reaction after receiving a spoofed e-mail

Based on their reaction (figure 23), the message from admin(at)outlook.com definitely got delivered and didn't end up in spam.

[![Receiving a spoofed e-mail from admin@outlook.com aka Timo Lo(n)gin ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-5_15-26-20__24_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-5_15-26-20__24_.png)

Figure 24: Receiving a spoofed e-mail from admin@outlook.com aka Timo Lo(n)gin

The actual e-mail is shown in figure 24:

[![Using HTML with SMTP smuggling to create a convincing phishing e-mail ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-10_22-55-21__25_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-10_22-55-21__25_.png)

Figure 25: Using HTML with SMTP smuggling to create a convincing phishing e-mail

We can once more confirm SPF alignment by looking at the message headers:

Received-SPF: Pass ([mx3.atos.net](http://mx3.atos.net/): domain of admin(at)outlook.com designates 40.92.75.68 as permitted sender)
   identity=mailfrom; client-ip=40.92.75.68;
   receiver=[mx3.atos.net](http://mx3.atos.net/); envelope-from="admin@[outlook.com](http://outlook.com/)";
   x-sender="admin@[outlook.com](http://outlook.com/)"; x-conformance=spf\_only;
   x-record-type="v=spf1"; x-record-text="v=spf1
   ip4:40.92.0.0/15 ip4:40.107.0.0/16 ip4:52.100.0.0/14
   ip4:104.47.0.0/17 ip6:2a01:111:f400::/48
   ip6:2a01:111:f403::/49 ip6:2a01:111:f403:8000::/50
   ip6:2a01:111:f403:c000::/51 ip6:2a01:111:f403:f000::/52 -all"

Since the previous examples were only text-based, attackers could also use HTML, for some more convincing phishing e-mails (figure 25).

[![Receiving a spoofed e-mail on hr@sec-consult.com from ceo@sec-consult.com ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-5_15-53-16__26_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-5_15-53-16__26_.png)

Figure 26: Receiving a spoofed e-mail on hr@sec-consult.com from ceo@sec-consult.com

However, to keep it simple, we'll stick to just text.

So, this is cool, but again, **that's not everything**! Since the outbound Outlook SMTP server is not only used for e-mails by [outlook.com](https://outlook.com/), but for **the entirety of Exchange Online**, we can now send e-mails from **every domain which uses Exchange Online to send e-mails**!

Since this affects **LOTS** of companies (as later discussed in SMTP Smuggling Impact section), we can choose our sender domain freely. We can even use [sec-consult.com](https://sec-consult.com/) itself! (see figure 26)

[![Example message data with exotic end-of-data sequence using a null byte ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_exotic__27_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_exotic__27_.png)

Figure 27: Example message data with exotic end-of-data sequence using a null byte

As before, the SPF check succeeds with domain alignment, since sec-consult.com is using Exchange Online and the SPF record includes the respective Exchange Online SPF domain **spf.protection.outlook.com**.

Received-SPF: Pass ([mx4.atos.net](http://mx4.atos.net/): domain of ceo(at)sec-consult.com
   designates 40.92.48.103 as permitted sender)
   identity=mailfrom; client-ip=40.92.48.103;
   receiver=[mx4.atos.net](http://mx4.atos.net/); envelope-from="ceo@[sec-consult.com](http://sec-consult.com/)";
   x-sender="ceo@[sec-consult.com](http://sec-consult.com/)"; x-conformance=spf\_only;
   x-record-type="v=spf1"; x-record-text="v=spf1
   ip4:40.92.0.0/15 ip4:40.107.0.0/16 ip4:52.100.0.0/14
   ip4:104.47.0.0/17 ip6:2a01:111:f400::/48
   ip6:2a01:111:f403::/49 ip6:2a01:111:f403:8000::/50
   ip6:2a01:111:f403:c000::/51 ip6:2a01:111:f403:f000::/52 -all"

With GMX and Exchange Online out of the way, we're now approaching our last target!

## Smuggling to Amazon, PayPal, eBay, ..., on the road to Cisco

GMX and Exchange Online allow SMTP smuggling due to insufficient sanitization at their outbound SMTP servers, **but what about insecure inbound SMTP servers**? What if there are inbound SMTP servers that allow such non-restrictive end-of-data sequences that even the most restrictive outbound SMTP servers would let such sequences through?

To get to the bottom of this, we can use a scanner that sends e-mails to inbound SMTP servers, but uses exotic end-of-data sequences. If the connection to the inbound SMTP server times out, the exotic end-of-data sequence was ignored. Otherwise, we most likely found something interesting!

So, what exactly is "exotic"? Exotic end-of-data sequences could for example be:

* Interrupted end-of-data sequences:
  + <CR><LF>\x00.<CR><LF>
  + <CR><LF>.\x00<CR><LF>
* End-of-data sequences using incomplete CRLFs:
  + <LF>.<LF>
  + <CR><LF>.<CR>
  + <CR>.<LF>
* End-of-data sequences in the message header

The message data of such an "exotic" e-mail could look like in figure 27.

[![SMTP smuggling exploiting exotic end-of-data sequence <CR>.<CR> ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_iCloud__28_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_iCloud__28_.png)

Figure 28: SMTP smuggling exploiting exotic end-of-data sequence <CR>.<CR>

Now, by scanning the former Alexa Top 1000, various inbound SMTP servers accepting such sequences were identified! However, only one of those sequences seems to be working for lots of SMTP servers: **<CR>.<CR>**

This sequence gets accepted by the inbound e-mail servers of some really high-value targets:

* Amazon
* PayPal
* eBay
* Cisco
* The IRS

The one thing that they all have in common is that they're using [Cisco Secure Email](https://www.cisco.com/site/in/en/products/security/secure-email/index.html), with on-prem **Cisco Secure Email Gateway** or cloud-based Cisco's Secure Email Cloud Gateway. And again, for some odd reason, sec-consult.com is using Cisco Secure Email Gateway as well!

As a proof of concept (figure 28), we can now send an e-mail from admin(at)icloud.com to our target at sec-consult.com, since, like with many other outbound SMTP servers (further discussed in SMTP Smuggling Impact), **<CR>.<CR> doesn't get filtered:**

[![Sending spoofed e-mails as admin@icloud.com ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-5_18-13-25__29_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-5_18-13-25__29_.png)

Figure 29: Sending spoofed e-mails as admin@icloud.com

Like before, the e-mail goes through unscathed, as shown in figure 29.

[![Getting domains using Ionos e-mail services via SecurityTrails ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/ionos_domains__30_.PNG)](https://securitytrails.com/domain/mx01.ionos.de/dns?__cf_chl_tk=.TKYmeShS.FZRsY6AAhEHSwz4V.4vi5xyMUN0i6TvkY-1702368252-0-gaNycGzNFWU)

Figure 30: Getting domains using Ionos e-mail services via SecurityTrails

SPF checks pass with domain alignment and without any issues.

Received-SPF: Pass ([mx4.atos.net](http://mx4.atos.net/): domain of admin(at)icloud.com
   designates 17.57.155.23 as permitted sender)
   identity=mailfrom; client-ip=17.57.155.23;
   receiver=[mx4.atos.net](http://mx4.atos.net/); envelope-from="admin@[icloud.com](http://icloud.com/)";
   x-sender="admin@[icloud.com](http://icloud.com/)"; x-conformance=spf\_only;
   x-record-type="v=spf1"; x-record-text="v=spf1
   ip4:17.58.0.0/16 ip4:17.57.155.0/24 ip4:17.57.156.0/24
   ip4:144.178.36.0/24 ip4:144.178.38.0/24 ip4:112.19.199.64/29
   ip4:112.19.242.64/29 ip4:222.73.195.64/29 ip4:157.255.1.64/29
   ip4:106.39.212.64/29 ip4:123.126.78.64/29
   ip4:183.240.219.64/29 ip4:39.156.163.64/29 ~all"

Hence, DMARC passes as well:

Authentication-Results-Original: [mx4.atos.net](http://mx4.atos.net/); dkim=none (message not signed)
  header.i=none; spf=Pass smtp.mailfrom=admin@[icloud.com](http://icloud.com/); spf=None
  smtp.helo=postmaster@[qs51p00im-qukt01080502.me.com](http://qs51p00im-qukt01080502.me.com/); dmarc=pass (p=quarantine
  dis=none) d=[icloud.com](http://icloud.com/)

With Cisco's Secure Email covered, we can now go on and take a look at the global impact!

## SMTP Smuggling Impact

At this point we've covered lots of **outbound and inbound SMTP smuggling**. But, speaking globally, how bad is it?

### GMX and Ionos

SMTP smuggling via GMX and Ionos e-mail services allowed SMTP smuggling from roughly **1.35 million different domains**, as indicated by the domains pointing their MX record to Ionos (figure 30).

[![Used SMTP software on the Internet (Shodan)(results may vary) ](/fileadmin/_processed_/e/d/csm_shodan_email_software__31__30e6c2e871.png)](https://www.shodan.io/search/facet?query=port%3A25&facet=product)

Figure 31: Used SMTP software on the Internet (Shodan)(results may vary)

Checking the SPF record of these domains confirms that they are most likely all permitting **\_spf-eu.ionos.com** for sending e-mails.

However, as already mentioned, SMTP smuggling doesn't work for every receiving inbound SMTP server and, in this case, requires inbound SMTP servers to accept **<LF>.<CR><LF>** as end-of-data sequence. So, who's affected?

Only few of the bigger e-mail providers that were tested are affected. These include:

* Fastmail
* Runbox

This might not seem bad at first, but looking at affected SMTP software on the Internet is a different story. After testing some popular e-mail software in their default configuration, it turned out that **Postfix** and **Sendmail** fulfil the requirements, are **affected** and can be smuggled to. Speaking globally, this is a lot (figure 31)!

Aside from Postfix and Sendmail, other SMTP implementations are most likely affected as well, including Cisco Secure Email (Cloud) Gateway, to which we'll get in a second.

### Microsoft Exchange Online

Same as GMX and Ionos, Exchange Online allowed smuggling via a **<LF>.<CR><LF>** end-of-data sequence as well, which makes it possible to smuggle from every domain pointing their SPF record to Exchange Online. This amounts to [millions of domains](https://enlyft.com/tech/products/exchange-online) all across the globe, including some very high-value targets owned by Microsoft like **microsoft.com, msn.com, github.com, outlook.com, office365.com, openai.com** and many more, and also domains of their customers (e.g., **tesla.com, mastercard.com, nike.com**, etc.).

However, as previously mentioned, smuggling from Exchange Online is even more restricted than from GMX/Ionos, since the receiving inbound SMTP server must support BDAT. This is the case for Fastmail and - still - hundreds of thousands of [postfix](https://www.shodan.io/search?query=postfix+port%3A25+-CHUNKING) and [sendmail](https://www.shodan.io/search?query=sendmail+port%3A25+-CHUNKING) servers.

| Software | Without BDAT/CHUNKING | Total | Percentage | Shodan query |
| --- | --- | --- | --- | --- |
| Postfix | 716884 | 1475616 | ~50% | postfix port:25 -CHUNKING |
| Sendmail | 168823 | 169030 | ~99% | sendmail port:25 -CHUNKING |

[![Relevant configuration settings of Cisco Secure Email ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-12-4_20-56-43__32_.png)](https://www.cisco.com/c/en/us/td/docs/security/esa/esa15-0/user_guide/b_ESA_Admin_Guide_15-0/b_ESA_Admin_Guide_12_1_chapter_0100.html?bookSearch=true#task_1254814__table_985308C400C84CE3BC190BC8A3A95D86)

Figure 32: Relevant configuration settings of Cisco Secure Email

These numbers from Shodan might not paint the whole picture though, as many servers maybe running postfix, but are hiding their identification banner. Also, other smaller SMTP servers are affected as well, again including Cisco Secure Email (Cloud) Gateway.

We did not analyze all SMTP software out there, hence it might be possible that other vulnerable servers exist as well.

### Cisco Secure Email (Cloud) Gateway

The Cisco Secure Email Gateway and its cloud counterpart, the Cisco Secure Email Cloud Gateway, are both "vulnerable" to **inbound** SMTP smuggling. The quotes are necessary in this case, since, according to lengthy discussions with Cisco, this is not a bug, but a feature (see Responsible Disclosure section)!

**By default**, Cisco Secure Email (Cloud) Gateway accepts **<CR>.<CR>** as end-of-data sequence, which does not get filtered by the following SMTP servers when sending outbound:

* Outlook/Exchange Online
* Icloud
* On-premise exchange server
* Postfix
* Sendmail
* Startmail
* Fastmail
* Zohomail

This would allow inbound SMTP smuggling to around 40k domains using Cisco's Secure Email **Cloud** Gateway, if they're using the **default configuration** (like we did). These domains can be determined by checking a passive DNS database like SecurityTrails for [iphmx.com subdomains](https://securitytrails.com/list/apex_domain/iphmx.com). Identifying on-premise Cisco Secure Email Gateways on the other hand is a difficult task, since lots of Internet-wide scanners (e.g., Shodan) seem to get blocked when conducting service scans. However, to get a better feeling for the usage of this product, we scanned the former Alexa Top 1000, and discovered at least the following 32 domains.

* [amazon.com](http://amazon.com/)
* [amazon.co.jp](http://amazon.co.jp/)
* [amazon.co.uk](http://amazon.co.uk/)
* [amazon.it](http://amazon.it/)
* [amazon.fr](http://amazon.fr/)
* [marriott.com](http://marriott.com/)
* [cisco.com](http://cisco.com/)
* [amazon.in](http://amazon.in/)
* [paypal.com](http://paypal.com/)
* [amazon.ca](http://amazon.ca/)
* [goodreads.com](http://goodreads.com/)
* [webex.com](http://webex.com/)
* [custhelp.com](http://custhelp.com/)
* [imdb.com](http://imdb.com/)
* [intuit.com](http://intuit.com/)
* [ndtv.com](http://ndtv.com/)
* [amazon.cn](http://amazon.cn/)
* [makemytrip.com](http://makemytrip.com/)
* [amazon.com.au](http://amazon.com.au/)
* [amazonaws.com](http://amazonaws.com/)
* [primevideo.com](http://primevideo.com/)
* [amazon.es](http://amazon.es/)
* [irs.gov](http://irs.gov/)
* [amazon.com.br](http://amazon.com.br/)
* [aastocks.com](http://aastocks.com/)
* [ebay.com](http://ebay.com/)
* [amazon.de](http://amazon.de/)
* [ebay.de](http://ebay.de/)
* [ebay.co.uk](http://ebay.co.uk/)
* [ebay.com.au](http://ebay.com.au/)
* [mayoclinic.org](http://mayoclinic.org/)
* [audible.com](http://audible.com/)

Note that this doesn't take into account servers that don't have an MX record let alone an SMTP server.

## Further vulnerabilities

During the research we've also discovered some exotic inbound SMTP servers that interpret end-of-data sequences like **<CR><LF>\x00.<CR><LF>**, with "\x00" representing a null byte. With proprietary SMTP components and lots of different e-mail services intertwined it's hard to tell what is possible until an e-mail reaches its final destination.

Even though SMTP smuggling might still be hiding in some places, we hopefully eliminated some big targets.

## Responsible Disclosure

How do we report a vulnerability that is based on protocol interpretation? Who is right, who is wrong? Let's take a look at some RFCs!

In general, [RFC 5321](https://www.rfc-editor.org/rfc/rfc5321) from 2008 states the following:

***"The custom of accepting lines ending only in <LF>, as a concession to non-conforming behavior on the part of some UNIX systems, has proven to cause more interoperability problems than it solves, and SMTP server systems MUST NOT do this, even in the name of improved robustness.  In particular, the sequence "<LF>.<LF>" (bare line feeds, without carriage returns) MUST NOT be treated as equivalent to <CRLF>.<CRLF> as the end of mail data indication."***

So, it's the inbound SMTP server's fault! But wait, [RFC 5322](https://www.rfc-editor.org/rfc/rfc5322), also from 2008, says the following about the body of a message:

***"CR and LF MUST only occur together as CRLF; they MUST NOT appear independently in the body."***

This essentially means that **both sides (outbound and inbound)** are at fault! Also, this shows us that inconsistent interpretation of the end-of-data sequence is not a novel issue. Now, what do the affected parties think about this? We have thus initiated our responsible disclosure process around **end of July 2023** (see Timeline further below).

### GMX

The responsible disclosure process with GMX was pure bliss. After immediately receiving a response, the issue was fixed in roughly ten days. Aside from paying a bounty, they even added Timo to their [bug bounty hall of fame](https://bugbounty.gmx.net/halloffame-index.html). All-in-all a great experience! Huge props to GMX for such a professional and quick reaction.

### Microsoft

The outbound SMTP smuggling vulnerability was submitted via the [Microsoft Security Response Center (MSRC)](https://www.microsoft.com/en-us/msrc). Roughly a month later, Microsoft replied:

***"Thank you again for submitting this issue to Microsoft. Currently, MSRC prioritizes vulnerabilities that are assessed as “Important” or “Critical'’ severities for immediate servicing. After careful investigation, this case has been assessed as moderate severity and does not meet MSRC’s bar for immediate servicing since the attack only works if the mail server of the recipient treats a non-standard EOD sequence as EOD . However, we have shared the report with the team responsible for maintaining the product or service. They will take appropriate action as needed to help keep customers protected"***

Fair enough, they got bigger fish to fry! After retesting the issue every now and then, they seem to have fixed it roughly in the middle of October 2023.

### Cisco

As previously mentioned, the "vulnerability" in Cisco Secure Email (Cloud) Gateway is not a bug, but a feature. And, unlike in most cases, this is actually somewhat true.

Cisco Secure Email (Cloud) Gateway can be configured to handle carriage returns and line feeds in a special manner, as seen [here](https://www.cisco.com/c/en/us/td/docs/security/esa/esa15-0/user_guide/b_ESA_Admin_Guide_15-0/b_ESA_Admin_Guide_12_1_chapter_0100.html?bookSearch=true#task_1254814__table_985308C400C84CE3BC190BC8A3A95D86).

However, **by default**, Cisco Secure Email (Cloud) Gateway "Allows the message, but converts bare CR and LF characters to CRLF characters" (the vulnerable "Clean" setting), which basically **enables inbound SMTP smuggling** via **<CR>.<CR>** end-of-data sequences. We have communicated this issue to Cisco and CERT/CC and went back and forth quite a bit. But at the end of the day, it's not a bug, it's a feature.

Since this feature allowed us to send spoofed e-mails from arbitrary Exchange Online domains straight into our inboxes, we decided to **change** the configuration to "**Allow**".

This passes e-mails with bare carriage returns or line feeds on to our actual e-mail server (Cisco Secure Email Gateway is just a gateway), which only interprets <CR><LF>.<CR><LF> as end-of-data sequence. If you don't want to receive spoofed e-mails with valid DMARC checks as well, we highly recommend changing your configuration!

## Conclusion

We've shown a novel SMTP spoofing technique with this research that allowed to spoof e-mails from millions of domains.

Even though Microsoft and GMX have patched this issue promptly, inbound SMTP smuggling to Cisco Secure Email instances (cloud and on-premise) is still possible with **default** configurations. We highly encourage to change these default configurations, as described in the Responsible Disclosure chapter.

Also, this blog post hopefully sparked further interest in SMTP research, since there is still so much to explore. Even with SMTP smuggling alone, there are many things to look at:

* Other smuggling techniques
* Bounce smuggling
* Smuggling via BDAT
* Smuggling dangerous/exotic SMTP commands
* Internet-wide scans
* Other SMTP software
* etc.

So, this is probably not the last time you've heard of SMTP smuggling!

## Timeline

| 2023-06-07: | First outbound SMTP smuggling proof of concept (GMX) |
| --- | --- |
| 2023-06-08: | Discovery of outbound SMTP smuggling in Exchange Online |
| 2023-06-20: | Discovery of Cisco Secure Email (Cloud) Gateway inbound SMTP smuggling |
| 2023-06/2023-07: | Developing tools, analyzing test cases, further research |
| 2023-07-26: | Contacting MSRC |
| 2023-07-27: | Contacting Cisco |
| 2023-07-29: | Contacting GMX. |
| 2023-08-10: | GMX fixed the issue |
| 2023-08-17: | Contacting CERT Coordination Center (CERT/CC) for further discussion with Cisco |
| 2023-08-23: | Microsoft responds and rates the vulnerability with moderate risk |
| 2023-09-13: | CERT/CC accepts the case |
| 2023-10-16: | SMTP smuggling in Exchange Online is fixed |
| 2023-11-29: | CERT/CC allows public release of SMTP smuggling, since no software vulnerabilities were identified ("it's not a bug, it's a feature") |
| 2023-12-05: | Informing CERT.at and CERT-Bund about planned release, providing blog post draft, warning about Cisco configuration |
| 2023-12-18: | Release date of blog post |

*This research was done by Timo Longin and published on behalf of the [SEC Consult Vulnerability Lab](/vulnerability-lab/#c1699).*

## FAQ

How do I know if I am affected?

If you are a user of a big e-mail provider (Outlook, Gmail, etc.), you are most likely going to be fine (for now at least). Since SMTP smuggling is a fairly new topic and still has things to explore, we cannot be certain though. However, if you're using Cisco Secure Email (cloud or on-premise), you should definitely check your configuration (see Responsible Disclosure)! But, as always, don't blindly trust anything that lands in your e-mail inbox!

Update from 10/01/2024: Official tools to test for SMTP smuggling issues are now available on [GitHub](https://github.com/The-Login/SMTP-Smuggling-Tools)!

Is there a tool available to verify whether I am vulnerable?

Update from 10/01/2024: Official tools to test for SMTP smuggling issues are now available on [GitHub](https://github.com/The-Login/SMTP-Smuggling-Tools)!

We have developed an analysis tool internally but decided to publish it at a later date (maybe already at the [37C3 conference](https://events.ccc.de/congress/2023/hub/en/fahrplan) end of December 2023 where this research will be presented), as currently many Cisco Secure Mail installations are affected by the issue.

Do smuggled e-mails always get past spam filters?

The short answer is no, not always! Even though the smuggled e-mail might come from a legitimate sender and passes e-mail authentication due to SPF alignment, the e-mail might still get blocked, depending on the e-mail contents and other factors. Also, if more than SPF alignment is required for the e-mail to go through, we're out of luck with SMTP smuggling.

How would someone even get the idea of looking at a protocol like SMTP?

There are two major reasons:

1. SMTP is a very old protocol that is somewhat flying under the radar of a lot of security researchers (kind of like [DNS](https://sec-consult.com/blog/detail/taking-over-a-country-kaminsky-style/)). Since there wasn't any related research that indicated similar attacks, the chances were good for finding something new!
2. Phishing is one of the best ways for threat actors or our red teamers to gain initial access to an organization. Therefore, looking for vulnerabilities in the underlying e-mail protocol - SMTP - seemed natural.
Is this a novel attack technique?

Most likely! Again, for two major reasons:

1. Microsoft's SMTP infrastructure including Exchange Online was vulnerable. This would have most likely been found and fixed by prior researchers.
2. We haven't found any research stating otherwise.
Are there other interesting SMTP and e-mailing attacks?

Yes, lots of them! For example, ["Weak Links in Authentication Chains: A Large-scale - Analysis of Email Sender Spoofing Attacks"](https://www.usenix.org/conference/usenixsecurity21/presentation/shen-kaiwen) shows a range of interesting attacks that even worked with Gmail!

Can confusions of <CR><LF> and <LF> and alike cause security issues in other protocols as well?

Yes, of course! In general, implementations of (sometimes) vague specifications can cause all kinds of security issues.

Have you scanned the whole Internet and tested ALL e-mailing services?

As already mentioned, scanning e-mail services for used software and versions may yield inaccurate results and will most likely get you on some kind of blacklist. The same goes for more specific end-of-data sequence checks, where basically a whole e-mail is sent. Therefore, we could roughly only analyze the top 10k of Alexa domains during this research.

### Are you interested in working at SEC Consult?

SEC Consult is always searching for talented security professionals to work in our team.
[More Information](/career/#c2854)
#### About the author

![Portrait of Timo Longin SEC Consult](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/Authors/a-TLO.png)Timo Longin
[Back](/blog/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all



=== Content from idp-portal.suse.com_6b95d262_20250115_221239.html ===

## UCS

# Welcome to Univention Corporate Server

## JavaScript required

A browser with JavaScript enabled is required in order to use this service.

When using Internet Explorer, please check your security settings and add this address to your trusted sites.



=== Content from lwn.net_0e153a6e_20250115_090841.html ===


[![LWN.net Logo](https://static.lwn.net/images/logo/barepenguin-70.png)
LWN
.net
News from the source](/)
[![LWN](https://static.lwn.net/images/lcorner-ss.png)](/)

* [**Content**](#t)
  + [Weekly Edition](/current/)
  + [Archives](/Archives/)
  + [Search](/Search/)
  + [Kernel](/Kernel/)
  + [Security](/Security/)
  + [Events calendar](/Calendar/)
  + [Unread comments](/Comments/unread)
  + ---
  + [LWN FAQ](/op/FAQ.lwn)
  + [Write for us](/op/AuthorGuide.lwn)
* [**Edition**](#t)
  + [Return to the Front page](/Articles/955922/)

**User:**
**Password:**    |

 |

[**Subscribe**](/subscribe/) /
[**Log in**](/Login/) /
[**New account**](/Login/newaccount)

# Smuggling email inside of email

> **We're bad at marketing**
>
> We can admit it, marketing is not our strong suit. Our strength is
> writing the kind of articles that developers, administrators, and
> free-software supporters depend on to know what is going on in the
> Linux world. Please [subscribe today](/Promo/nsn-bad/subscribe) to help us keep doing that, and so
> we don’t have to get good at marketing.

By **Jake Edge**
January 3, 2024

Normally, when a new vulnerability is discovered and releases are
coordinated with those affected, the announcement is done at
a convenient time—not generally right before the end-of-year holidays, for
example. The [SMTP
Smuggling vulnerability](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/) has taken a different path, however, with its
announcement landing on December 18. That may well have been
unpleasant for some administrators that had not yet updated, but it was
particularly problematic for
some projects that had not been made aware of the vulnerability at
*all*—though it was known to affect several open-source mailers.

#### Discovery and disclosure

The vulnerability was discovered by Timo Longin of [SEC Consult](https://sec-consult.com/) back in June; the company
contacted three affected vendors, GMX, Microsoft, and Cisco in July. GMX
fixed the issue in August, and Microsoft did so in October, but Cisco
responded that the "identified vulnerability is just a feature of the
software and not a bug/vulnerability". That led SEC Consult to contact
the [CERT Coordination Center](https://www.kb.cert.org/vuls/)
(CERT/CC) for further assistance, using the [Vulnerability Information and
Coordination Environment](https://kb.cert.org/vince/) (VINCE) tool:

> There, we submitted all our research details and explained the case to the
> vendors involved. We received feedback from Cisco that our identified
> research is not a vulnerability, but a feature and that they will not
> change the default configuration nor inform their customers. Other vendors
> did not respond in VINCE but were contacted by CERT/CC.
>
> Based on this feedback and as multiple other vendors were included in this
> discussion through the CERT/CC VINCE platform without objecting, we wrongly
> assessed the broader impact of the SMTP smuggling research. Because of this
> assumption, we asked CERT/CC end of November regarding publication of the
> details and received confirmation to proceed.

A [talk
about the vulnerability](https://events.ccc.de/congress/2023/hub/en/event/smtp_smuggling_spoofing_e-mails_worldwide/) was accepted for the [37th Chaos
Communication Congress](https://events.ccc.de/congress/2023/hub/en/index) (37C3), which was held at the end of December.
So the vulnerability needed to be announced before that happened. The talk
acceptance occurred on December 3 and the announcement came out
roughly two weeks later—just before the holidays.
The "wrongly assessed" wording in the quote above seems to indicate
that SEC Consult recognizes that it made a mistake here. In addition, the
talk is [said](https://chaos.social/%40Foxboron/111621156200642472)
to have contained "a decent apology".

One of the other "vendors" mentioned in the (admirably
detailed) blog post is Sendmail, but Postfix is mentioned elsewhere as well.
It is clear that SEC Consult was fully aware that those two mailers were
vulnerable, but the company apparently relied on CERT/CC to involve
additional affected projects, which just as clearly did not happen. For
example, Postfix creator and maintainer Wietse Venema [called](https://www.mail-archive.com/postfix-users%40postfix.org/msg100901.html)
the vulnerability announcement "part of a non-responsible disclosure
process"; he softened that stance somewhat in a Postfix [SMTP Smuggling page](https://www.postfix.org/smtp-smuggling.html),
but still
noted that "[critical] information provided by the researcher was not
passed on to Postfix maintainers before publication of the attack".
The result was "a presumably unintended zero-day attack", he said.

#### Vulnerability

The [Simple
Mail Transfer Protocol](https://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol) (SMTP), which is described in [RFC 5321](https://datatracker.ietf.org/doc/html/rfc5321),
provides a text-based protocol for submitting and exchanging email on the
net.
At some level, this flaw is another indication that the "[robustness
principle](https://en.wikipedia.org/wiki/Robustness_principle)" (also known as "Postel's law") was not actually all that
sound from a security standpoint; being liberal in what is accepted
over-the-wire has often led to problems. In this case, the handling of
line endings in conjunction with the SMTP end-of-data indication can lead
to situations where email can be successfully spoofed—leading to rogue
email that passes
various checks for authenticity.

The SMTP DATA command is used for the actual text that will appear in an
email, including headers and the like; the so-called "envelope", which
describes the sender and receiver, is another
set of SMTP commands (EHLO, MAIL FROM, RCPT TO) that precede the DATA. The
blog post announcing the vulnerability has lots of diagrams and explanations
for those who want all the gory details. The DATA command is ended with
a line that is blank except for a single period ("."); the line endings for
SMTP are defined to be carriage-return (CR or "\r") followed by
line-feed (LF or "\n"), so end-of-data should be signaled with
"\r\n.\r\n".

It turns out that some mailers will accept just a line-feed as the line
terminator, but others will not; there is a difference
in interpretation of "\n.\n" that can be used to smuggle an
email message inside another:
```

    EHLO ...
    MAIL FROM: ...
    RCPT TO: ...
    DATA
    From: ...
    To: ...
    Subject: ...

    innocuous email text
    \n.\n
    MAIL FROM: <admin@...>
    RCPT TO: <victim@...>
    DATA
    From: Administrator <admin@...>
    To: J. Random Victim <victim@...>
    Subject: Beware of phishing scams

    Like this one
    \r\n.\r\n

```
The second set of commands is in the text of the email, if the
SMTP server receiving it does not consider
"\n.\n" as the termination of the
DATA command. That email will be sent to another SMTP server, however,
which may see things rather differently. If the SMTP server for the
destination sees that line as terminating the data, it may start
processing what comes next as entirely new email. It is a
vulnerability that
is analogous to [HTTP request
smuggling](https://en.wikipedia.org/wiki/HTTP_request_smuggling), which is where the name comes from.

There are also variations on the line endings (e.g. "\n.\r\n")
that can
be used to fool various
mailers. The core of the idea is to have the outbound mail server
ignore the "extra stuff" as part of the initial email message
and send the mail on to a server that sees the
single message as more than one—and acts accordingly. [SPF](https://en.wikipedia.org/wiki/Sender_Policy_Framework)
checks can be made to pass and even [DKIM](https://en.wikipedia.org/wiki/DomainKeys_Identified_Mail) can be spoofed by using an
attacker-controlled DKIM key in the smuggled headers. [DMARC](https://en.wikipedia.org/wiki/DMARC) can be used to thwart
the smuggling, but common configurations of it are still vulnerable.
In addition, because
mail servers, especially those of the larger
email providers, often handle multiple domains, there is an opportunity to
smuggle email that purports to
come from different
domains inside innocuous-seeming messages to users of those services.

The blog post mostly concentrates on the three vendors identified, but
clearly notes that "Postfix and Sendmail [fulfill] the requirements, are
affected and can be smuggled to". It provides several lists of domains
that can be spoofed via GMX, Microsoft Exchange Online, or Cisco Secure
Email Cloud Gateway. In fact, SEC Consult uses the Cisco product itself,
so the company has changed its settings away from the default to avoid the
problem, which Cisco does not acknowledge as any kind of bug.

#### Postfix and beyond

Meanwhile, over in open-source land, folks seemed rather astonished that
the vulnerability dropped with no warning. Marcus Meissner [posted](/ml/oss-security/20231221143630.GD14101%40suse.de/) about the vulnerability
to the oss-security mailing list: "As if we did not have sufficient
protocol vulnerability work short[ly] before
Christmas break this year, here is one more". He is likely referring
to the [Terrapin
vulnerability in the SSH protocol](/ml/oss-security/a8637927-82b1-4f95-a7e8-7aa6cbaca455%40rub.de/), which was [announced](https://terrapin-attack.com/) on December 18—well after
coordinating with many different SSH implementation projects. The SMTP
Smuggling vulnerability followed a rather different path, as Stuart
Henderson [pointed
out](/ml/oss-security/ZYVufT0sq16Z-M43%40symphytum.spacehopper.org/):
> I'm a little confused by sec-consult's process here. They identify a
> problem affecting various pieces of software including some very widely
> deployed open source software, go to the trouble of doing a coordinated
> disclosure, but only do that with...looking at their timeline... gmx,
> microsoft and cisco?

Meissner [noted](/ml/oss-security/20231222121134.GI14101%40suse.de/) that SUSE
was not alerted to the problem via VINCE and that the Postfix timeline (in
Venema's post) only started after the announcement. Erik Auerswald [speculated](/ml/oss-security/20231222150438.GA13989%40unix-ag.uni-kl.de/)
that SEC Consult expected CERT/CC to alert other affected projects; instead
it would seem that CERT/CC gave the go-ahead to release the findings.
After Rodrigo Freire [wondered](/ml/oss-security/CAHjsZGbiZYGug2L04iZ%2BVEmMg-pdfKyKOGdcSeCLnsZYd0Vm2Q%40mail.gmail.com/)
why the problem was considered a vulnerability, Auerswald [explained](/ml/oss-security/20231222175221.GA7191%40unix-ag.uni-kl.de/):
> Any user of an affected outbound server can spoof email from any user of
> the same outbound server despite SPF and DKIM (DMARC+DKIM can prevent this
> in some cases, also more senders can be spoofed in specific cases, for
> details see the blog post). But for this to work, the inbound server
> must act as a confused deputy. Both outbound and inbound servers need to
> be differently vulnerable to enable the attack. This specific attack can
> be prevented unilaterally on either the outbound or the inbound server.
>
> [...] For email server open source projects, relevant for the oss-security
> list, the primary vulnerability is to act as a confused deputy inbound
> server, because users of such email servers usually have a much smaller
> number of accounts than the big freemail providers. But, in general,
> they could also possibly act as a vulnerable outbound server, e.g.,
> after a [legitimate] user account has been compromised.

CVEs for Sendmail, Postfix, and Exim have [been assigned](/ml/oss-security/20231224093335.GM14101%40suse.de/).
Postfix has released updates with a new [smtpd\_forbid\_bare\_newline](https://www.postfix.org/postconf.5.html#smtpd_forbid_bare_newline)
option (that defaults to off, but will default to on in the upcoming
Postfix 3.9 release); those who do not want to upgrade can work around
most of the problems using existing options. Exim has [an
advisory](/ml/oss-security/20231229130718.GA6740%40openwall.com/), [bug
report](https://bugs.exim.org/show_bug.cgi?id=3063), and bug-fix release (4.97.1) for the problem. Sendmail has a [snapshot
release (8.18.0.2)](/ml/oss-security/20231221144656.GA40693%40veps.esmtp.org/) with a new option to address the flaw as well.
However, other than Postfix updates from [SUSE](/Articles/956688/) and [Slackware](/Articles/956148/),
most distributions have not yet issued updates for this problem,
which leaves a lot of Linux users vulnerable.

So the major open-source mailer projects scrambled to fix the
vulnerability over the holidays, but the process has obviously failed
here. We have not (yet?) heard from CERT/CC for its side of the story, but
either it or SEC Consult should definitely have contacted those projects in
the multiple months that have gone by since the discovery.
Given that SEC Consult knew about Sendmail and Postfix, though, it is a
little hard to understand how a simple heads-up message to the security
contacts for those projects was not sent.

It seems likely
that there are smaller mailers and other tools that are still affected by
the flaw—though they may only have just heard of it—a month or two of
advance notice,
especially for small projects, could have made a lot of difference. One
can only hope that lessons are being learned here and that any coordination
will be better ... coordinated (and communicated) down the road.

| Index entries for this article | |
| --- | --- |
| [Security](/Security/Index/) | [Vulnerabilities/SMTP smuggling](/Security/Index/#Vulnerabilities-SMTP_smuggling) |

---

 to post comments

### Smuggling email inside of email

Posted Jan 4, 2024 2:06 UTC (Thu)
by **iabervon** (subscriber, #722)
[[Link](/Articles/956778/)]

The image at the beginning of the blog post has a useful bit of information that didn't make it to the example in the article: the first/outer email is from attacker@sender, while the second/embedded email is purportedly from admin@sender, such that receiver is not surprised by sender delivering the second email. More generally, it can be attacker@cohost1 and admin@cohost2, where the two sites are different but expected to be cohosted.

The purported sender's mailer has to consider the ambiguous sequence to be valid inside of an email, while the receiver's mailer has to consider the ambiguous sequence to be a valid terminator of an email. There are sequences mentioned for which various open-source mailers are vulnerable as receivers and big hosting providers and also mailers used by big companies are vulnerable as senders.

It looks to me like the researchers considered the sender side to be doing things particularly wrong, and also that the vulnerability was that messages purportedly from users at the sender site could be forged by other users with the sender site's participation adding credibility, and didn't think of it (also) as receivers failing to block detectably inauthentic messages. They contacted everyone who would need to implement what they thought of as the correct fix, but not other people who could have mitigated the problem differently.

### Smuggling email inside of email

Posted Jan 4, 2024 2:59 UTC (Thu)
by **akp@akp.dk** (subscriber, #73019)
[[Link](/Articles/956782/)]

Debian released fixed versions of Postfix too via their updates repositories, but apparently it wasn’t considered a security issue - only a bug: <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1059230>

### The confused Deputy

Posted Jan 4, 2024 9:55 UTC (Thu)
by **Wol** (subscriber, #4433)
[[Link](/Articles/956804/)] (1 responses)

Surely an early disclosure that certain projects are vulnerable as confused deputies if they misinterpret /r/n./r/n could/should have been made months ago?

"The RFC standard says you \*MUST\*, some projects don't, and this has been identified as a security vulnerability".

That's leaking bugger-all information to an attacker - how do they use it etc etc, and giving all recipients the opportunity to protect themselves, very quickly.

Cheers,

Wol

### The confused Deputy

Posted Jan 5, 2024 3:05 UTC (Fri)
by **kentonv** (**✭ supporter ✭**, #92073)
[[Link](/Articles/956952/)]

Ehh... I think for anyone who has spent time dealing with smuggling vulnerabilities before (e.g. in HTTP, where they abound), that would have been a big enough hint for them to figure out the problem.

### Smuggling email inside of email

Posted Jan 4, 2024 10:06 UTC (Thu)
by **roc** (subscriber, #30627)
[[Link](/Articles/956805/)] (37 responses)

Postel's Law was a blunder and we've spent decades fighting the damage caused by people following it.

Computing is hard, but well-intentioned yet clearly mistaken principles such as Postel's Law are self-inflicted wounds that have made things a lot harder than they could have been.

### Smuggling email inside of email

Posted Jan 4, 2024 10:35 UTC (Thu)
by **MarcB** (subscriber, #101804)
[[Link](/Articles/956809/)] (2 responses)

The irony is that the principle is not followed in its original scope of middle-boxes in low level network protocols - where it actually makes a lot of sense. This has led to the ossification of IP protocols.

Instead it was foolishly extended to endpoints and completely different scenarios. There it is invariably causing damage. It makes things less secure, less stable and so much more complex.

### Smuggling email inside of email

Posted Jan 4, 2024 18:13 UTC (Thu)
by **nim-nim** (subscriber, #34454)
[[Link](/Articles/956904/)] (1 responses)

> The irony is that the principle is not followed in its original scope of middle-boxes in low level network protocols - where it actually makes a lot of sense.

No it never made any sense. All those middle boxes were deployed because the fuzziness was breaking things right and left, they are designed to limit the spread of badly formatted traffic.

Of course some of this tightening went too far and led to ossification but it did not happen by mistake or because people wanted to prevent new protocol extensions, it happened because fuzziness was breaking endpoints.

And none of the war on middleboxes actually fixed things for the end user all it achieved is concentrating decision power MAGMA-side. Today Google and Amazon and Microsoft and Apple can decide whatever breakage they want there is nothing between their cloud and their browser with the browser acting as an hostile enclave of their cloud on the user terminal.

### Smuggling email inside of email

Posted Jan 4, 2024 21:56 UTC (Thu)
by **Wol** (subscriber, #4433)
[[Link](/Articles/956933/)]

> No it never made any sense. All those middle boxes were deployed because the fuzziness was breaking things right and left, they are designed to limit the spread of badly formatted traffic.

The problem is they are also designed to prevent the spread of correctly fornatted traffic, which is why port 80 is such a mess ...

Cheers,

Wol

### Smuggling email inside of email

Posted Jan 4, 2024 13:17 UTC (Thu)
by **smitty\_one\_each** (subscriber, #28989)
[[Link](/Articles/956822/)] (10 responses)

If one is too fussy, that can also become a bugaboo.

Maybe: s/liberal/skeptically moderate/ ?

### Smuggling email inside of email

Posted Jan 4, 2024 14:40 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956828/)] (5 responses)

It's not fussiness per-se that's a problem; it's going beyond the protocol specification in ways that make life harder that's a problem. For example, if the protocol says that the size field is encoded as hexadecimal digits in UTF-8, and that an implementation must accept at least 8 digits, insisting that the other side uses a multiple of 8 digits is "too fussy" - I should be able to send 1a2 as a size given that definition, and I should be able to send 1abcdef23, but if you require 000001a2 and 00000001abcdef23, we've got a problem.

And this problem becomes insoluble if a different implementation rejects leading zeroes; you now have two implementations being "fussy" in opposite directions, both of which can be justified against the protocol spec (which doesn't talk about leading zeroes at all). The "correct" fix is to tighten up the protocol specification so that one or both implementations are wrong, but that gets into social coordination problems about what the specification "should" be, and is especially problematic if both implementations are the way they are because that makes it easier to build on existing libraries.

### Smuggling email inside of email

Posted Jan 4, 2024 22:31 UTC (Thu)
by **Wol** (subscriber, #4433)
[[Link](/Articles/956937/)] (4 responses)

> The "correct" fix is to tighten up the protocol specification so that one or both implementations are wrong,

No. The correct fix is to implement the specification correctly. In your own example, the spec places no requirements on the sender. Therefore the receiver should place no requirements on the sender. Your example of the reciever demanding a multiple of 8 is a clear "gilding of the lily", overly strict, and breach of the specification. Okay, if the spec does not tell the receiver how it knows how many digits it has received - ie the spec does not contain sufficient information to implement itself correctly - then the specification needs to be corrected.

In this particular case, I'd be inclined to \*clarify\* the spec by saying "the sender can send as many or as few characters as it likes". That doesn't affect any implementation enforcing the current letter of the spec. Yes it breaks your receiver, but only because it's enforcing "restrictions not in the spec".-

I've actually been badly bitten (by a PHB) because of this sort of problem back when email switched from ASCII to 8-bit. Of course, it was MS that contradicted the letter of the spec, but because it was \*our\* Microsoft Mail that was at fault, the PHB blamed the ISP and demanded \*they\* fixed the problem.

The SMTP spec says that invalid commands must be rejected with a 200 error, and the receiver \*must\* then wait for a new command. So the 8-bit RFC revision said "if you want to start an 8-bit transmission, use EHLO rather than HELO to tell the recipient to expect an 8-bit transmission". So what does MS Mail do? "550 Invalid command connection terminated".

I think the ISP ended up creating a config option telling sendmail not to use EHLO for certain (like us) customers.

Cheers,

Wol

### Smuggling email inside of email

Posted Jan 4, 2024 22:34 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956940/)]

The specification does not say whether zero-padding is allowed or not - and yet one of the my examples is a receiver that insists on no zero-padding because it's "obviously" not needed, while another insists on zero-padding because it's "obviously" needed to indicate length.

And the spec is currently silent on zero-padding; changing the spec to say "no zero padding allowed" is one option. Changing it to say "zero or more leading zeroes are permitted" is another.

### Smuggling email inside of email

Posted Jan 5, 2024 10:49 UTC (Fri)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956964/)] (2 responses)

And, as an aside, this comment is exactly why the robustness principle leads to a mess; I showed two receivers that insisted on different things that aren't in the letter of the specification (one insisting on zero padding, the other insisting that it's not allowed).

You've focused on the one that's visibly weird (the one that insists on padding), and ignored the other one that's outside the specification; and yet both are problematic if you're trying to deal with arbitrary clients. It would be simple to fix the specification to declare what degree of zero padding is allowed, but that's currently out of scope - the spec as given permits me to sent petabytes of 0 digits followed by the real number.

And your anecdote is unrelated; you have a case where your local mail server does not obey the letter of RFC 821 (which states that you must remain "in the same state" as before the command was received if you receive an invalid command while waiting for a HELO); in RFC 821 SMTP, you're only supposed to close the transmission channel if you're shutting down service, or in response to a successful QUIT command. This is different to a case where both implementations are obeying the letter of the specification, but imposing additional requirements not contained in the spec, and both implementers believe that they're obeying the spec (after all, they accept numbers formatted as hex digits).

### Smuggling email inside of email

Posted Jan 5, 2024 13:58 UTC (Fri)
by **Wol** (subscriber, #4433)
[[Link](/Articles/956974/)] (1 responses)

I know my example was actually an explicit breach of the spec, but your example is also a breach of the spec. BOTH your receivers are refusing to accept a transmission that complies with the spec.

So imho no the spec does not need to be changed at all. At most it should be clarified as "the spec tells the sender to send a hex-formatted number, therefore the receiver must accept any valid hex-formatted number."

As I see it, my SMTP example yes it's easy to say MS Mail ignored the spec. But your example is to me exactly the same. The sender sent a valid (as per the spec) message. The receiver refused to accept and process it correctly. Sendmail sent us a validly formatted EHLO. MS Mail refused to accept and process it correctly. I would have thought "if the other party is behaving as per spec, then you are at fault unless the spec is contradictory" was just plain obvious!

Cheers,

Wol

### Smuggling email inside of email

Posted Jan 5, 2024 14:26 UTC (Fri)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956978/)]

But that's just my point - one of the two examples is a plausible interpretation of the specification, because leading zeroes aren't discussed either way. The other is less plausible, but could come up if you're using a library that insists on having padded input.

And by your reasoning, the spec intends that implementations are capable of consuming petabytes of leading zeroes as part of accepting a hex-formatted number less than 10, otherwise they're in breach of the specification - but this is clearly absurd, and unlikely to be what the spec author intended. This is *why* you should fix the specification, not the implementations, since we've got behaviour that's not discussed but should be.

The reason your SMTP example is different is that the specification for SMTP explicitly says that a server keeps the connection open after a bad command - we're not talking about something that's omitted from the spec (are leading zeroes part of a valid hex-formatted number or not?), but about something that's in the spec but where your server deviated from the specification.

### Smuggling email inside of email

Posted Jan 4, 2024 19:54 UTC (Thu)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/956913/)] (3 responses)

I remember reading about the new robustness law: "Be as strict as possible in what you accept, and be slightly evil in what you send".

For example, if you provide a list of allowed encodings during the negotiation, then randomize the order, and maybe stuff a couple of non-existing encodings.

### Smuggling email inside of email

Posted Jan 5, 2024 10:52 UTC (Fri)
by **smitty\_one\_each** (subscriber, #28989)
[[Link](/Articles/956966/)] (1 responses)

"...and here's a little WTF-8 for my homies..."

### Smuggling email inside of email

Posted Jan 5, 2024 21:09 UTC (Fri)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/957040/)]

That's not "slightly", that's just evil.

### Smuggling email inside of email

Posted Jan 5, 2024 11:04 UTC (Fri)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956967/)]

Your "non-existing encodings" bit reminded me of [Raymond Chen on a driver compatibility issue in DirectX](https://devblogs.microsoft.com/oldnewthing/20040211-00/?p=40663); the OS would ask the driver "do you support this optional feature, GUID xxx?" and the driver in question always said "yes", causing issues when you used that feature.

The solution was to come up with a way to generate "impossible" features at runtime, and if your driver claimed to support such a feature, it was known to be lying about optional feature support and could be ignored.

### Smuggling email inside of email

Posted Jan 4, 2024 14:42 UTC (Thu)
by **rrolls** (subscriber, #151126)
[[Link](/Articles/956838/)] (20 responses)

Postel's Law is great for processing that is started directly by the intended user (and usually, a human being) and then completed as soon as possible (with that intended user being notified about it). I suspect it was originally written with that in mind, but because of the era, the condition was never stipulated.

For the "liberal in what you accept": if I'm trying to retrieve some value from some old file that only partially complies with a standard that's many years younger than the file, I want the program to do its utmost to retrieve that value; if the deviations from the standard are enough to prevent this from being possible, it's generally pretty obvious from the output.

Similarly, for the "conservative in what you do": if I'm collecting a whole bunch of data into one file to be sent off elsewhere, I'd want that file to be as simple and compliant as possible (in terms of its syntax/encoding), so that it's useful as input to the widest possible range of other programs.

Where Postel's Law is terrible is the case of processing that is started by some unattended, always-available server receiving something - indeed, like an email server. "Liberal in what you accept" is useful when the user is the intended user; but if the user is a malicious user instead, it's going to be just as useful to them. There's even an argument for not being "conservative in what you do" - this is the argument for "security by obscurity". (Whether this is a good argument or not is a different matter entirely.)

### Smuggling email inside of email

Posted Jan 4, 2024 14:54 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956860/)]

I've found a useful summary to be "Postel's Law applies only when one side of the conversation is intended to be a human". For machine-to-machine communications (as SMTP, IMAP and others are now), Postel's Law is outright hazardous.

This also plays into other things people do; for example, the problem with binary protocols and file formats is that you can't use tools intended to show text to a human to decode them. But if the intent is to use tools intended to handle that protocol or file format exclusively, you can do just as well with an unambiguous and well-designed binary format.

### Smuggling email inside of email

Posted Jan 4, 2024 15:32 UTC (Thu)
by **adobriyan** (subscriber, #30858)
[[Link](/Articles/956861/)] (17 responses)

> Postel's Law is great

No, it's just terrible. One key distinction between computers and humans is that computers are extremely precise and humans are extremely imprecise (especially in comparison). It very easy to lower computers to human level (just ship whatever buggy code at the moment), but it is \_impossible\_ to uplift humans to computer levels of precision.

Consequently, making computer second guess the human doesn't work. The best example is probably Excel guessing dates vs non-dates. It went as far as scientists renaming genes.

I was unfortunate to use a spreadsheet few years ago and naturally used some Linux clone. All I did is to paste like 10 floats into cells and it guessed format of the data on the \_first\_ try \_wrong. The very first interaction with a program is a bug. Of course it was done for user-friendliness and Excel compatibility and whatever reasons but bug is a bug is a bug. Encountering a bug immediately while doing nothing unusual suggests very high rate of this problem across all users.

It is bad that programmers misinterpret specs and write spec violations, it's ten times bad when managers force programmers to do so.

In a perfect world interacting with Excel will be like this:

\* user pasted data (or opens csv),

\* all new data are marked with red meaning "computer have no idea what the data mean",

\* user marks the data as "integer", "date", "real number" etc making them green in bulk or individually,

\* no processing takes place until data are made green.

Of course this is not happening, because asking user to explain to the computer what he means is somewhere around ethnic cleansing levels of human rights violations.

AI/ML companies show the problem very well now, where single digit percent failures are celebrated because humans sometimes perform even worse.

This particular SMTP bug is more of a confusion by 2 common newline types and "streaming" property of SMTP where there is no LEN command unambiguously identifying length of the message (to this day! [citation needed]).

The better Postel's law example is probably browser interpreting broken closing tags and reordering them internally.

This is perfect "we can't break popular website with in new update, can you fix it by Friday?" moment.

### Smuggling email inside of email

Posted Jan 4, 2024 15:58 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956865/)] (14 responses)

Some computer behaviour is simply annoying, though. For example, a JSON list is technically incorrect if there's a comma after the last element of the list but before the ], even though there's only one possible way to fix the input to be valid JSON. A good system will take that input data, recognise that there's only one possible edit that makes it sensible, and ask the user if that's really what they meant - then, if it is, make that edit for them.

And that's the gap between good applications of Postel's Law and bad ones; in a good application of it, the computer is interacting with the user to get confirmation that its "liberalness" in what it's accepting is indeed correct. In a bad application, the computer makes assumptions about what was meant, and doesn't give the originator a way to correct its errors.

### Smuggling email inside of email

Posted Jan 4, 2024 18:03 UTC (Thu)
by **NYKevin** (subscriber, #129325)
[[Link](/Articles/956899/)] (7 responses)

Is there an advantage to prohibiting the trailing comma in the first place? Python allows it, and doesn't seem to suffer any problems as a result of that specific design decision.\* SQL also bans trailing commas in the SELECT clause (and a couple of other places), and I have no idea why.\*\* What software malfunction could be triggered or exacerbated by allowing a trailing comma?

\* Python has been mentioned, so the thread will now be derailed with people complaining about random other features of Python that are totally irrelevant to this conversation, but at least I \*tried\* to steer it towards Postel's law and JSON.

\*\* In the case of SQL, this is an anti-feature, because any code that wants to generate SQL has to go to the trouble of ensuring that every column name is followed by a comma, except for the last column.

### Smuggling email inside of email

Posted Jan 4, 2024 19:22 UTC (Thu)
by **excors** (subscriber, #95769)
[[Link](/Articles/956911/)]

I think the reason is that JSON was designed to be a subset of ECMAScript 3, so that it could be parsed in web browsers with eval(), and ES3 doesn't allow trailing commas in object literals (though ES5 does).

(Later it was realised that eval is a terrible way to parse potentially-untrusted input, and doesn't even work in general for trusted input, but the original recommendation was literally just `eval("window.val="+json\_string)`: [http://web.archive.org/web/20030205013518/http://crockfor...](http://web.archive.org/web/20030205013518/http%3A//crockford.com/JSON/js.html))

ES3 does allow trailing commas in array literals, but that's part of the weird 'elision' syntax where `[,].length == 1`, `[,,1,,].length == 4`, etc, and I suspect it was omitted from JSON because Douglas Crockford didn't like it, plus it would be confusingly inconsistent with the object literals. (Crockford's "JavaScript: The Good Parts" says "[JSLint] does not expect to see elided elements in array literals. Extra commas should not be used. A comma should not appear after the last element of an array literal or object literal because it can be misinterpreted by some browsers.")

And once the first version of JSON had been published, it was too late to make any syntax changes without causing major interoperability problems.

### Smuggling email inside of email

Posted Jan 4, 2024 20:12 UTC (Thu)
by **khim** (subscriber, #9252)
[[Link](/Articles/956917/)] (5 responses)

Is there an advantage to prohibiting the trailing comma in the first place?

The problem is not in trailing comma. The problem is in different programs treating the same input differently (precisely what we are discussion in the article, isn't it?)

It doesn't even matter about **how exactly** you interpret broken data. The key is that **different apps would interpret them differently**.

If you want to have auto-fixer for the JSON then **decouple it from JSON parser and make sure user may use it with all apps that s/he want's or needs to use it**.

### Smuggling email inside of email

Posted Jan 4, 2024 21:45 UTC (Thu)
by **NYKevin** (subscriber, #129325)
[[Link](/Articles/956931/)] (4 responses)

My argument, unreasonable though it may be, is essentially that Crockford should have used his magical crystal ball to predict that prohibiting trailing commas would inevitably become a nuisance. I'm not suggesting that anyone in 2023 should be going around emitting JSON that actually contains trailing commas - that way lies madness. If you want to have trailing commas and don't care about JSON compatibility, then switch to TOML (which explicitly specifies a trailing comma as legal in arrays, and otherwise does not use commas much), or some other format with the same property.

### Smuggling email inside of email

Posted Jan 7, 2024 6:53 UTC (Sun)
by **ssmith32** (subscriber, #72404)
[[Link](/Articles/957077/)] (3 responses)

I have worked with lots and lots of JSON, in a variety of environments, and have never once found this to be any kind of problem, nuisance or otherwise.

Do tell how this is a nuisance..?

I mean, if someone continually trips up and fails to skip appending a delimiter to the last item of a list... I certainly wouldn't want them anywhere near my serde code.. it's sort of a bog-standard thing.

### Smuggling email inside of email

Posted Jan 7, 2024 8:12 UTC (Sun)
by **mjg59** (subscriber, #23239)
[[Link](/Articles/957081/)]

When reordering elements, or moving elements between different lists, it's much easier if you can just cut and paste without then needing to edit. Requiring that the final element in a list be special makes that harder. Given that there's zero ambiguity here it's something that maybe makes life easier for people implementing a parser but makes life harder for everyone producing things consumed by that parser, and overall that feels like a poor tradeoff.

### Smuggling email inside of email

Posted Jan 7, 2024 10:28 UTC (Sun)
by **mbunkus** (subscriber, #87248)
[[Link](/Articles/957084/)]

Programs can easily create valid JSON files; that isn't the issue. The issue is that JSON is human-readable and is therefore used in many places where humans must edit/write it manually, too, e.g. for config files. However, it wasn't designed for that use case. Not allowing the list separator in the last place is one of the drawbacks, not having comments the most obvious other one. Us humans want to be able to easily edit things, switch lines around, copy-paste stuff & append it, ideally without having to worry about these minutiae.

JSON is pretty much the worst of both worlds. It can be used for human-editable scenarios, but isn't good at it. It can be used for data interchange, but it isn't good at that either (parsing requires much more time & memory than necessary; real problems with big integers in various implementations etc.). It's the typical case of being just good enough & easy enough to implement to be ubiquitous. And us developers find it easy to use 'cause it makes debugging data flow so easy. Meh…

### Smuggling email inside of email

Posted Jan 7, 2024 11:00 UTC (Sun)
by **ianmcc** (subscriber, #88379)
[[Link](/Articles/957089/)]

I have some python code that I used to use to collate grades. Depending on the course, different fields of some python dictionary would be relevant for the final grade, so it would be a few messy lines with some commented out, some new ones added, etc. It is convenient in python that you can have a leading comma on every line. If that wasn't the case and you commented out the last entry (or added a new one at the end) then you'd need to fix up the commas. Admittedly not a huge burden, but also a rather pointless. And definitely it would be a nuisance.

### Smuggling email inside of email

Posted Jan 4, 2024 20:06 UTC (Thu)
by **khim** (subscriber, #9252)
[[Link](/Articles/956914/)] (5 responses)

A good system will take that input data, recognise that there's only one possible edit that makes it sensible, and ask the user if that's really what they meant - then, if it is, make that edit for them.

No. Good user system accepts what is specified and rejects what is not specified.

Some computer behaviour is simply annoying, though. For example, a JSON list is technically incorrect if there's a comma after the last element of the list but before the ], even though there's only one possible way to fix the input to be valid JSON.

No. It may be spurious command or forgotten `0` easily. Or just lost large chunk of data.

Now, it may be good idea to **demand** trailing comma, instead.

This format may even be better that today's one, but that would be **different** format.

And yes, I'm saying that as someone who very much edits JSON files by hand.

As annoying as getting message “you JSON is invalid” is I **much** prefer it to the fuzzy formats which couldn't be parsed reliably at all. Just look on [vk.xml](https://raw.githubusercontent.com/KhronosGroup/Vulkan-Docs/main/xml/vk.xml) and try to imagine what kind of parser may give you answer to the simple question: what size if `CAMetalLayer` (or if it even have a type).

A good system will take that input data, recognise that there's only one possible edit that makes it sensible, and ask the user if that's really what they meant - then, if it is, make that edit for them.

Please don't. If you do that people would invariably submit garbage, “apply edit” without looking and then **complain that program doesn't work even if they did everything correctly.**

If you want then add something like this to your **text editor**. Don't duplicate that code and cause vulnerabilties that we are discussing here.

It's **perfect** example of what is happening if you apply such “niceties”.

### Smuggling email inside of email

Posted Jan 4, 2024 20:14 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956916/)] (4 responses)

You're contradicting yourself within your comment: do you want my system, of which my text editor is one component, to be able to work with me to correct entry errors, or is that bad, because my text editor, a component of my system, should be able to work with me to correct entry errors?

And my entire point is that when there's only one correction to be made, the system as a whole should work with me to recognise where my error is, not just apply that correction blindly - chances are good that in the JSON block [1,2,3,], I meant [1,2,3], but it's also possible that I didn't mean that, and I meant [1,2,3,4,5,6], but forgot three numbers. Actually asking me if I meant [1,2,3] instead of [1,2,3,] gives me a chance to say "um, no, that's not what I meant" and fix it manually if the correction is wrong.

### Smuggling email inside of email

Posted Jan 4, 2024 20:56 UTC (Thu)
by **khim** (subscriber, #9252)
[[Link](/Articles/956921/)] (3 responses)

You're contradicting yourself within your comment: do you want my system, of which my text editor is one component, to be able to work with me to correct entry errors, or is that bad, because my text editor, a component of my system, should be able to work with me to correct entry errors?

Text editor either should work with **any** JSON consumer than I may want to use (including, but not limited, various Google APIs, phone apps and raw python scripts) or it shouldn't be used.

I would much prefer it as entirely separate tool not attached to anything else at all, but as long as integration with “your system” is optional I may stomach it.

What I don't want is to **ever** be in a situation when someone uses your system and then assumes that **my** system have to provide such facilities, too.

Because that's where the slippery slope starts: different programs shouldn't treat the same file differently.

And my entire point is that when there's only one correction to be made, the system as a whole should work with me to recognise where my error is, not just apply that correction blindly - chances are good that in the JSON block [1,2,3,], I meant [1,2,3], but it's also possible that I didn't mean that, and I meant [1,2,3,4,5,6], but forgot three numbers. Actually asking me if I meant [1,2,3] instead of [1,2,3,] gives me a chance to say "um, no, that's not what I meant" and fix it manually if the correction is wrong.

I don't even care about what exactly “your system” does. I **do** care about the fact that as long as you attach that ability to “your system” I have to attach it to “my system”, too. And then we and up these insane piles of buggy code which implements the same improvements in 10 different ways and end up with crazy security vulnerabilities.

And **please** stop playing that card about how you may reject fixes. It was plausible 20 years ago. **Today we know it just doesn't work**. [Dancing pigs](https://en.wikipedia.org/wiki/Dancing_pigs) would ensure that after “your system” would be adopted by masses it would work as if that question about what to do with fixes doesn't even exist.

The only way to achieve something even remotely resembling security is to ensure that all these “fixes” are **not offered automatically** and user **explicitly** and **consciously** opts in into them.

### Smuggling email inside of email

Posted Jan 4, 2024 21:05 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956924/)] (2 responses)

My "system" is a computer running software. Since you're being abundantly clear that your system is not a computer running software, what is it, and how does it interact with my system?

I'm going back to where Postel's Law comes from - it's a bad UX when the computer clearly knows what is wrong with your input, but does nothing to help you - [this bit of humour about systems that work that way](https://www.gnu.org/fun/jokes/ed-msg.en.html) is very funny, BTW - but it's also a bad UX in the long run if the computer blindly autocorrects for you.

And taking you at face value, you seem to be claiming that compilers giving me suggestions in the output, which I can then apply if I believe the computer is correct is "Today we know it just doesn't work." - and yet clang, rustc and GCC all do exactly that, telling me what they think I intended given what I've written. I can then accept or reject that change as I see fit.

### Smuggling email inside of email

Posted Jan 4, 2024 21:26 UTC (Thu)
by **khim** (subscriber, #9252)
[[Link](/Articles/956925/)] (1 responses)

My "system" is a computer running software.

You never told me what “your system” even is. What kind of software does it include, how does it process things, etc.

And taking you at face value, you seem to be claiming that compilers giving me suggestions in the output, which I can then apply if I believe the computer is correct is "Today we know it just doesn't work." - and yet clang, rustc and GCC all do exactly that, telling me what they think I intended given what I've written.

Yes, they are slowly but surely are nearing that threshold that separates helpful suggessions from madness.

Which may not even matter because we have a tool that crosses it easily: Bard/ChatGPT/etc. **These** may give you plenty of suggestions which may ruin everything your do so thoroughly you would be forced to go back to old backups and redo everything from scratch.

If you even have these backups.

I can then accept or reject that change as I see fit.

No. You have to **read it and think about it**. And even these, pretty limited, suggestions are already causing plenty of damage: I have seen plenty of “programmers” who arrive on forums and complain that after applying these fixes their program still doesn't work because they are going in circles.

They don't even stop to think for a minute and then realise that it's their responsibility to produce sensible code, not compiler's. No, they just assume that they may create something by randomly changing code and then following the compiler advice.

And these are “developers”! Trained ones! Who passed few interviews and got good marks!

What happens when “normal people” when they are operating our IT systems is hard to even imagine.

### Smuggling email inside of email

Posted Jan 4, 2024 21:41 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956930/)]

No, but you made false assumptions about my system, and then, having made those false assumptions, chose to be rude and obnoxious about how I was wrong because you made bad assumptions.

And "as I see fit" includes "reading and thinking about it" - that is one part of forming my opinion. Sure, there's no shortage of idiots out there, but those people would do something stupid whether the computer's error message is ?, or On line 52, column 96, there is a , followed by a ] ending a list. This comma is syntatically invalid; you need to either remove the comma or add another data item.

This is, after all, where Postel's Law comes from; if the only output is either ? or correct results, you're being strict in what you accept, but it's very hard to debug the resulting system. If your error tells you what the computer dislikes about its input, you're being weakly liberal in what you accept, and that makes it easier to debug; Postel's error was generalising this to the case where there's no intelligence in the loop at all.

### Smuggling email inside of email

Posted Jan 4, 2024 18:56 UTC (Thu)
by **wahern** (subscriber, #37304)
[[Link](/Articles/956909/)] (1 responses)

> This particular SMTP bug is more of a confusion by 2 common newline types and "streaming" property of SMTP where there is no LEN command unambiguously identifying length of the message (to this day! [citation needed]).

A BDAT command for SMTP was first specified in 1995: <https://www.rfc-editor.org/rfc/rfc1830.txt> Or 2020, depending on your criteria: <https://datatracker.ietf.org/doc/html/rfc3030>

Microsoft Exchange uses BDAT, IIRC, but otherwise it's mostly gone unused. Ironically, BDAT would make smuggling exploits even easier unless and until the old DATA command was completely retired.

### Smuggling email inside of email

Posted Jan 5, 2024 0:32 UTC (Fri)
by **auerswal** (subscriber, #119876)
[[Link](/Articles/956948/)]

According to the SEC Consult blog post, use of BDAT by Microsoft Exchange Online prevented their SMTP Smuggling attempts when the inbound server supported it.

### Smuggling email inside of email

Posted Jan 4, 2024 17:44 UTC (Thu)
by **pallas** (guest, #128204)
[[Link](/Articles/956898/)]

> Postel's Law is great for processing that is started directly by the intended user (and usually, a human being) and then completed as soon as possible (with that intended user being notified about it). I suspect it was originally written with that in mind, but because of the era, the condition was never stipulated.

It appears in RFC 761, a TCP spec from 1980.

### Smuggling email inside of email

Posted Jan 4, 2024 21:02 UTC (Thu)
by **gouttegd** (guest, #106484)
[[Link](/Articles/956923/)] (1 responses)

I believe that the robustness principle has been misunderstood all along.

While Postel’s initial formulation in RFC 761 [<https://datatracker.ietf.org/doc/html/rfc761>] was very short and could indeed be interpreted as a recommendation to accept ill-formed input, the extended formulation from RFC 1112 [<https://datatracker.ietf.org/doc/html/rfc1122#section-1.2.2>] (where it gains its name of “robustness principle”) doesn’t quite say that:

> Software should be written to deal with every conceivable error, no matter how unlikely; sooner or later a packet will come in with that particular combination of errors and attributes, and unless the software is prepared, chaos can ensue. In general, it is best to assume that the network is filled with malevolent entities that will send in packets designed to have the worst possible effect. This assumption will lead to suitable protective design

A robust program is \_not\_ a program that accepts any ill-formed input as long as the meaning is clear. It’s a program that is \_ready to receive\_ any ill-formed input and deal with it gracefully (instead of, say, erring into undefined behaviour territory or segfaulting, as a non-robust program would do). Whether it \_accepts\_ the ill-formed input once it has recognised it for what it was is another question entirely.

### Smuggling email inside of email

Posted Jan 4, 2024 22:14 UTC (Thu)
by **NYKevin** (subscriber, #129325)
[[Link](/Articles/956938/)]

The reason that nobody is willing to call that the "robustness principle" is that, by modern standards, it's completely obvious. Of \*course\* you can't just crash when somebody sends you an ugly packet (for whatever definition of "ugly" is appropriate). If you write software in 2024 that crashes or misbehaves on invalid network traffic, somebody will find it and get it labeled with a CVE number in (hopefully) short order.

### Smuggling email inside of email

Posted Jan 4, 2024 13:48 UTC (Thu)
by **james** (subscriber, #1325)
[[Link](/Articles/956823/)]

I note that for Exim, "disable chunking" by setting
chunking\_advertise\_hosts =

was also recommended as a workaround for CVE-2017-16943. I must admit that I never came up with a change control justification to turn it back on again.

Now I'm tempted to call that policy. Exim has had its security problems over the years, and turning off optional extras reduces the attack surface.

Copyright © 2024, Eklektix, Inc.

This article may be redistributed under the terms of the
[Creative
Commons CC BY-SA 4.0](http://creativecommons.org/licenses/by-sa/4.0/) license

Comments and public postings are copyrighted by their creators.

Linux is a registered trademark of Linus Torvalds



=== Content from www.openwall.com_b29d7280_20250115_090828.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2023/12/29/5) [[next>]](2) [[<thread-prev]](../../../2023/12/29/5) [[thread-next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20231230161120.GE24652@suse.de>
Date: Sat, 30 Dec 2023 17:11:22 +0100
From: Marcus Meissner <meissner@...e.de>
To: oss-security@...ts.openwall.com
Cc: Claus Assmann <ml+oss@...tp.org>
Subject: Re: Re: New SMTP smuggling attack

On Fri, Dec 29, 2023 at 12:50:55PM -0800, Alan Coopersmith wrote:
> On 12/26/23 11:15, Claus Assmann wrote:
> > On Sun, Dec 24, 2023, Marcus Meissner wrote:
> >
> > > - CVE-2023-51765 sendmail
> >
> > Can you update the text for this (or point me to the proper way/persons
> > to do this)?
>
> <https://www.cve.org/CVERecord?id=CVE-2023-51765> shows:
>   Assigner: MITRE Corporation
>
> so you can submit updates/corrections via the web form at:
>   <https://cveform.mitre.org/>

Yes please use this form, or if you do not want one of us can do it.

I did not request the sendmail and exim CVEs, also the postfix CVE seems
not my proposed description, so I guess someone else requested them.

Ciao, Marcus

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.suse.com_4730bdd4_20250115_090832.html ===


| Bugzilla – Bug 1218351 | VUL-0: CVE-2023-51765: sendmail: new SMTP smuggling attack | Last modified: 2024-10-07 08:45:17 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1218351)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1218351**](show_bug.cgi?id=1218351)
(CVE-2023-51765)
- VUL-0: CVE-2023-51765: sendmail: new SMTP smuggling attack

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2023-51765: sendmail: new SMTP smuggling attack

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2023-51765 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/389198/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv3.1:SUSE:CVE-2023-51765:5.3:(AV:... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2023-12-22 12:04 UTC by Marcus Meissner | | --- | --- | | Modified: | 2024-10-07 08:45 UTC ([History](show_activity.cgi?id=1218351)) | | CC List: | 7 users (show)  bert.stel boyd.memmott jochen.roeder meissner security-team varkoly werner | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1218351) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=1218351&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1218351&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1218351#c0)  Marcus Meissner   2023-12-22 12:04:48 UTC  ``` +++ This bug was initially created as a clone of [Bug #1218304](show_bug.cgi?id=1218304 "IN_PROGRESS - VUL-0: CVE-2023-51764: postfix: new SMTP smuggling attack") +++  <https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/>   describes a new SMTP smuggling attack, that exploits  "<cr><lf>.<cr><lf>" data end marker inconistent handling on some email servers. ``` [Comment 1](show_bug.cgi?id=1218351#c1)  Marcus Meissner   2023-12-22 12:35:57 UTC  ``` sendmail snapshot 8.18.0.2 is available for testing. It offers the new srv_features option 'o' to require CR LF . CR LF as end of an SMTP message and fixes parsing of UTF8 addresses when SMTPUTF8 BODY=3D7BIT are used as parameters for the MAIL command.  SHA256 (sendmail.8.18.0.2.tar.gz) =3D b8f64c67f94dc6ff0f65498636f8f90b794e58ded15a05650a98115167b60773 SHA256 (sendmail.8.18.0.2.tar.gz.sig) =3D 95c3f2845f0d099d6e2d4662f73a0e1afe83f028b69e3c62a9fdf12bbdaccdec  Available at: <https://ftp.sendmail.org/snapshots/sendmail.8.18.0.2.tar.gz> <https://ftp.sendmail.org/snapshots/sendmail.8.18.0.2.tar.gz.sig>   No seperate patch provided ``` [Comment 2](show_bug.cgi?id=1218351#c2)  Marcus Meissner   2023-12-22 13:37:15 UTC  ``` i have the diff between 8.17.2 and 8.18.0.2 , it is quite long but the 'O' option code might be extractable with some effort.  not sure how easy this will integrate. ``` [Comment 3](show_bug.cgi?id=1218351#c3)  Marcus Meissner   2023-12-24 09:24:07 UTC  ``` CVE-2023-51765 was assigned ``` [Comment 21](show_bug.cgi?id=1218351#c21)  Dr. Werner Fink   2024-02-22 08:24:25 UTC  ``` Both SR for SLE-12 and SLE-15 are accepted ``` [Comment 22](show_bug.cgi?id=1218351#c22)  Maintenance Automation   2024-03-04 08:30:03 UTC  ``` SUSE-SU-2024:0743-1: An update that solves one vulnerability can now be installed.  Category: security (moderate) Bug References: 1218351 CVE References: CVE-2023-51765 Sources used: openSUSE Leap 15.5 (src): sendmail-8.15.2-150000.8.12.1 Basesystem Module 15-SP5 (src): sendmail-8.15.2-150000.8.12.1 SUSE Package Hub 15 15-SP5 (src): sendmail-8.15.2-150000.8.12.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 23](show_bug.cgi?id=1218351#c23)  Maintenance Automation   2024-03-04 08:30:05 UTC  ``` SUSE-SU-2024:0742-1: An update that solves one vulnerability can now be installed.  Category: security (moderate) Bug References: 1218351 CVE References: CVE-2023-51765 Sources used: Legacy Module 12 (src): sendmail-8.14.9-4.9.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1218351)
* - [XML](show_bug.cgi?ctype=xml&id=1218351)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1218351)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1218351)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)


