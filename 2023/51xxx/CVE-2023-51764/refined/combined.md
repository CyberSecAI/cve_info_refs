=== Content from github.com_cfa189e2_20250115_114602.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feeenvik1%2FCVE-2023-51764%2Fblob%2Fmain%2FScreenshots%2FScreenshot_2.png)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feeenvik1%2FCVE-2023-51764%2Fblob%2Fmain%2FScreenshots%2FScreenshot_2.png)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=eeenvik1%2FCVE-2023-51764)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eeenvik1](/eeenvik1)
/
**[CVE-2023-51764](/eeenvik1/CVE-2023-51764)**
Public

* [Notifications](/login?return_to=%2Feeenvik1%2FCVE-2023-51764) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Feeenvik1%2FCVE-2023-51764)
* [Star
   4](/login?return_to=%2Feeenvik1%2FCVE-2023-51764)

* [Code](/eeenvik1/CVE-2023-51764)
* [Issues
  0](/eeenvik1/CVE-2023-51764/issues)
* [Pull requests
  0](/eeenvik1/CVE-2023-51764/pulls)
* [Actions](/eeenvik1/CVE-2023-51764/actions)
* [Projects
  0](/eeenvik1/CVE-2023-51764/projects)
* [Security](/eeenvik1/CVE-2023-51764/security)
* [Insights](/eeenvik1/CVE-2023-51764/pulse)

Additional navigation options

* [Code](/eeenvik1/CVE-2023-51764)
* [Issues](/eeenvik1/CVE-2023-51764/issues)
* [Pull requests](/eeenvik1/CVE-2023-51764/pulls)
* [Actions](/eeenvik1/CVE-2023-51764/actions)
* [Projects](/eeenvik1/CVE-2023-51764/projects)
* [Security](/eeenvik1/CVE-2023-51764/security)
* [Insights](/eeenvik1/CVE-2023-51764/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from access.redhat.com_2c6e463b_20250115_114612.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2024:9243 - Security Advisory

Issued:
2024-11-12
Updated:
2024-11-12
# RHSA-2024:9243 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Moderate: postfix security update

## Type/Severity

Security Advisory: Moderate

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2024%3A9243)

## Topic

An update for postfix is now available for Red Hat Enterprise Linux 9.

Red Hat Product Security has rated this update as having a security impact of Moderate. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

The postfix packages provide a Mail Transport Agent (MTA), which supports protocols like LDAP, SMTP AUTH (SASL), and TLS.

Security Fix(es):

* postfix: SMTP smuggling vulnerability (CVE-2023-51764)

For more details about the security issue(s), including the impact, a CVSS score, acknowledgments, and other related information, refer to the CVE page(s) listed in the References section.

Additional Changes:

For detailed information on changes in this release, see the Red Hat Enterprise Linux 9.5 Release Notes linked from the References section.

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

## Affected Products

* Red Hat Enterprise Linux for x86\_64 9 x86\_64
* Red Hat Enterprise Linux for IBM z Systems 9 s390x
* Red Hat Enterprise Linux for Power, little endian 9 ppc64le
* Red Hat Enterprise Linux for ARM 64 9 aarch64

## Fixes

* [BZ - 2255563](https://bugzilla.redhat.com/show_bug.cgi?id=2255563)
  - CVE-2023-51764 postfix: SMTP smuggling vulnerability

## CVEs

* [CVE-2023-51764](https://access.redhat.com/security/cve/CVE-2023-51764)

## References

* <https://access.redhat.com/security/updates/classification/#moderate>
* <https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/9.5_release_notes/index>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Enterprise Linux for x86\_64 9

| SRPM | |
| --- | --- |
| postfix-3.5.25-1.el9.src.rpm | SHA-256: b6e6e335031cd223736032c45027d65f109f890b9de89d101b0fe5dc0d05673d |
| x86\_64 | |
| postfix-3.5.25-1.el9.x86\_64.rpm | SHA-256: 248f64e65a21a234cd095da00032f0f9e8c3f65cdb4754fc9def99ba3035499d |
| postfix-cdb-3.5.25-1.el9.x86\_64.rpm | SHA-256: 2532c4682e9f094683f4ba47a4c2a5c0c67237fe08dfdbd78c46f6126efd01ca |
| postfix-cdb-debuginfo-3.5.25-1.el9.x86\_64.rpm | SHA-256: f02a3021f41af5123ab6c37ae10ecbc50f6a3c0bc569783a6541938c562e33cd |
| postfix-debuginfo-3.5.25-1.el9.x86\_64.rpm | SHA-256: a0cc9ef2c66747cec9306b150e6763f5501715c291269be5a25d3c6fbfab712f |
| postfix-debugsource-3.5.25-1.el9.x86\_64.rpm | SHA-256: ff631299f9dde6203f666160325c9ca460319f07d8f456a0c3b64e89513e2c8c |
| postfix-ldap-3.5.25-1.el9.x86\_64.rpm | SHA-256: e16776efc94c528be52f1b383505eb3ac197effd84f31c256f59e2221f446d40 |
| postfix-ldap-debuginfo-3.5.25-1.el9.x86\_64.rpm | SHA-256: fe380e785990df4ec678bec7ba25c7bda6bd6ae7f31769792670c29873f9465b |
| postfix-lmdb-3.5.25-1.el9.x86\_64.rpm | SHA-256: 5f66dd6360670395861cadf9211178433e151c15d707c6287562a6676136a22e |
| postfix-lmdb-debuginfo-3.5.25-1.el9.x86\_64.rpm | SHA-256: c86fc52ee9ceedc919f5066c9e3d91f40582e002b17323b913b04f03280d1e6d |
| postfix-mysql-3.5.25-1.el9.x86\_64.rpm | SHA-256: 56d13260508fe2eb15a7ebb2a9eb7e03866d499ed8b81a9f33527bd73df1a73b |
| postfix-mysql-debuginfo-3.5.25-1.el9.x86\_64.rpm | SHA-256: 69c57a51ff043357421c1882ddfbca0bcc6331540243d44f465a282a009ef3d1 |
| postfix-pcre-3.5.25-1.el9.x86\_64.rpm | SHA-256: ddfe3db0c720e795a900ede296f9f7f859f829a2f7669654869f5ec8bb5c8233 |
| postfix-pcre-debuginfo-3.5.25-1.el9.x86\_64.rpm | SHA-256: 242738db465061895574d042e37699fb8891c38eb77eb81f41f6df0e2625d758 |
| postfix-perl-scripts-3.5.25-1.el9.x86\_64.rpm | SHA-256: a17d5e3ba44d8609a551c78ee1a89049e2394f2f1ebba8c407583237f7ed5669 |
| postfix-pgsql-3.5.25-1.el9.x86\_64.rpm | SHA-256: e17371335917119a46e90042c4acf602d5f4c4f51ef62ca69cff2cd57784588f |
| postfix-pgsql-debuginfo-3.5.25-1.el9.x86\_64.rpm | SHA-256: a9d364e4f7b80c2c5fdd0056478718e0884ea7a37d4d712bcbe59e12bf70fc50 |
| postfix-sqlite-3.5.25-1.el9.x86\_64.rpm | SHA-256: 830d61e6fb9632ab59f855544b3a97249a47886d17945d6c10703a87466d4d89 |
| postfix-sqlite-debuginfo-3.5.25-1.el9.x86\_64.rpm | SHA-256: e7e0a5fdc54d381817d4749d37949698d7f015df5fbd9e21be35edd4a34511a7 |

## Red Hat Enterprise Linux for IBM z Systems 9

| SRPM | |
| --- | --- |
| postfix-3.5.25-1.el9.src.rpm | SHA-256: b6e6e335031cd223736032c45027d65f109f890b9de89d101b0fe5dc0d05673d |
| s390x | |
| postfix-3.5.25-1.el9.s390x.rpm | SHA-256: 31186b468ac3390c2a60f3ce347681fb7a425fcebf92b3a0572603d2ebbab8d3 |
| postfix-cdb-3.5.25-1.el9.s390x.rpm | SHA-256: ebeaf6bd69fb13954ade7fa816a3d4786ebc78b15599808d58ee79918abf1c23 |
| postfix-cdb-debuginfo-3.5.25-1.el9.s390x.rpm | SHA-256: 6f8eb3db9ec56b8b71c617dd11512365217e0a512267a0d105b67b8f1ddcb449 |
| postfix-debuginfo-3.5.25-1.el9.s390x.rpm | SHA-256: 72c0b526abddfa7c1e083f4cedeb0561c56601b39064dcc74880903f5f5dfad7 |
| postfix-debugsource-3.5.25-1.el9.s390x.rpm | SHA-256: 0a57916190ca60cfaaf523b0de7a9e4b9a30032a64f799aba990915729793ea6 |
| postfix-ldap-3.5.25-1.el9.s390x.rpm | SHA-256: 673b92dce7f8f9a2533f28ab8f8d7afe7520e81258ab2e6058caa8d01c844302 |
| postfix-ldap-debuginfo-3.5.25-1.el9.s390x.rpm | SHA-256: 7521d81d50542e223d134dc077849b4bceb7f54cafcacd84215077ea3671ee8f |
| postfix-lmdb-3.5.25-1.el9.s390x.rpm | SHA-256: e8507f30a6e0cacb1c7a98165f112d1aaa52c820268c208d2ec86ed44eaf0bc9 |
| postfix-lmdb-debuginfo-3.5.25-1.el9.s390x.rpm | SHA-256: c94facbef4ec0136146e7572dd89c0d3192e61005d698fd0e434da050bd1dfcd |
| postfix-mysql-3.5.25-1.el9.s390x.rpm | SHA-256: ff710f25703180914bc2581338dd0eb6e09cac6ec8fece3a93d46a9cf0056d46 |
| postfix-mysql-debuginfo-3.5.25-1.el9.s390x.rpm | SHA-256: a488aa84134e80cac258450f7d79f2f466e4fe5b6f4b740f50ab78812f01431a |
| postfix-pcre-3.5.25-1.el9.s390x.rpm | SHA-256: 379bd66e9f6950043484c37218e4813635aecdf5171250052d9e2e6c551e91f5 |
| postfix-pcre-debuginfo-3.5.25-1.el9.s390x.rpm | SHA-256: 5c348382b52b3f39a7d558f77431a0d1bc1a534bf95c6e1a671d375aaed2320a |
| postfix-perl-scripts-3.5.25-1.el9.s390x.rpm | SHA-256: 2a87e8b5563f87a01defce774fef97d6c186dadb117dcb481c816e83e42b0e2e |
| postfix-pgsql-3.5.25-1.el9.s390x.rpm | SHA-256: aecebc3ba866c4d6540481b0b1f8891a12ccc6538a2a2da82db1de4ccf7cba17 |
| postfix-pgsql-debuginfo-3.5.25-1.el9.s390x.rpm | SHA-256: 4bdec6f38ef7fae7a4de6f0de1e2a5ba89713166fb9ad1838d088b76b8ae57e6 |
| postfix-sqlite-3.5.25-1.el9.s390x.rpm | SHA-256: 62bb18a2fd54d6bdc0472b48f78a7391abee7c3cd2b075415fb8eea3eb41b47e |
| postfix-sqlite-debuginfo-3.5.25-1.el9.s390x.rpm | SHA-256: aec7f4df528e56ac5472ab161766a841b59b9f2ba5a36d5bf3c143274553ea0f |

## Red Hat Enterprise Linux for Power, little endian 9

| SRPM | |
| --- | --- |
| postfix-3.5.25-1.el9.src.rpm | SHA-256: b6e6e335031cd223736032c45027d65f109f890b9de89d101b0fe5dc0d05673d |
| ppc64le | |
| postfix-3.5.25-1.el9.ppc64le.rpm | SHA-256: e099a98d98474e454512f475be95e272a078f53ade4b2ceabe724e024de0b332 |
| postfix-cdb-3.5.25-1.el9.ppc64le.rpm | SHA-256: e26a20a3e22cc679ed60bbdd79b610d55228e5f3fcf3e24e39155506a6c7209c |
| postfix-cdb-debuginfo-3.5.25-1.el9.ppc64le.rpm | SHA-256: 7d3114ba95336526edc93decf72c9e8794571c073361defaec40347a7f1dd9c4 |
| postfix-debuginfo-3.5.25-1.el9.ppc64le.rpm | SHA-256: 410d1e83a3dd6437ff58091e7def4cd7e8c05a15a3ac192b9bcadfe0b9c28b88 |
| postfix-debugsource-3.5.25-1.el9.ppc64le.rpm | SHA-256: cc2ffa682eab8a002b524e1f46327a0f5b9cdea76fd3d6a0532c3e32372ec179 |
| postfix-ldap-3.5.25-1.el9.ppc64le.rpm | SHA-256: acd99930f87fdaf72a0f89406c6b066689e629177b80e4ec140a327bb33e25b8 |
| postfix-ldap-debuginfo-3.5.25-1.el9.ppc64le.rpm | SHA-256: 3d7b1841a8645795dfd78a7fe80aaa0bacee3e8324c4e3207ff6b61eee9b8554 |
| postfix-lmdb-3.5.25-1.el9.ppc64le.rpm | SHA-256: 8db838a8ffc2f2855e60bcb7f885d2880255192c1967e8193635f513a0c89401 |
| postfix-lmdb-debuginfo-3.5.25-1.el9.ppc64le.rpm | SHA-256: e0dd777b1d47332b8073151dfc08a2cf057d8972b3e699ac295cdc3a57e4ad7a |
| postfix-mysql-3.5.25-1.el9.ppc64le.rpm | SHA-256: 5ac3638b300bf07d3f5ef42937225199b77c77ffef63d0b19a0f56be35581136 |
| postfix-mysql-debuginfo-3.5.25-1.el9.ppc64le.rpm | SHA-256: 998470eccc5e72a97d7a03891c4c6719e5f811f8c49a1120a60dc70c1d001444 |
| postfix-pcre-3.5.25-1.el9.ppc64le.rpm | SHA-256: 1c586859610c3b32287576ec4e0e61ae9f775c1e7fd01a55c442ea6042ded3d7 |
| postfix-pcre-debuginfo-3.5.25-1.el9.ppc64le.rpm | SHA-256: b93fb731ce539ed3d50dff51fc497b9e98007490fdd4c5c5344c4b991966b354 |
| postfix-perl-scripts-3.5.25-1.el9.ppc64le.rpm | SHA-256: 78e8d0476f9a0380bfc1a9f23f57d1e02c1ed3c2a970d75b38a06cc386bbb852 |
| postfix-pgsql-3.5.25-1.el9.ppc64le.rpm | SHA-256: 8d43160a5c8710c761e6fdf01cd311c252542de0a9b55ba607ffe69142e079bc |
| postfix-pgsql-debuginfo-3.5.25-1.el9.ppc64le.rpm | SHA-256: 4d92451316ac2b7a22656cb325f07b1b83c0d0e818d7ead9f2fa7953b79c2d2d |
| postfix-sqlite-3.5.25-1.el9.ppc64le.rpm | SHA-256: 4d0e91a7557391bd5c5f7f25d6c7c168a1c465e891cc1197de148b8ede890cd1 |
| postfix-sqlite-debuginfo-3.5.25-1.el9.ppc64le.rpm | SHA-256: 3d738a13664f648c4f717965d926584954484f0e68f9fe8362550a9dbd281fb1 |

## Red Hat Enterprise Linux for ARM 64 9

| SRPM | |
| --- | --- |
| postfix-3.5.25-1.el9.src.rpm | SHA-256: b6e6e335031cd223736032c45027d65f109f890b9de89d101b0fe5dc0d05673d |
| aarch64 | |
| postfix-3.5.25-1.el9.aarch64.rpm | SHA-256: f5484af982d495126e1746d261e619719052c1a4a4203195306d5d055ec3523c |
| postfix-cdb-3.5.25-1.el9.aarch64.rpm | SHA-256: 4013e85cad28e05ac4efa0735c863fcf85d1f191b0563d186992c394a967245b |
| postfix-cdb-debuginfo-3.5.25-1.el9.aarch64.rpm | SHA-256: baae78c23c7bc81f1646197fd1ff4c79aa888755e51b2b0f6d0568d6dbfb9cea |
| postfix-debuginfo-3.5.25-1.el9.aarch64.rpm | SHA-256: bf3f1f49c5d237e42c8847dd4055a7c72fd7c1b820e455471aa3e456850dc56f |
| postfix-debugsource-3.5.25-1.el9.aarch64.rpm | SHA-256: ace1549a3f52d0824112e7d09c5635ec89b76143528fb6be023be224907b9c06 |
| postfix-ldap-3.5.25-1.el9.aarch64.rpm | SHA-256: 45ff1503020fc1a31ff5011187d4051c4bbf88b37e812c77646a36b1b2924614 |
| postfix-ldap-debuginfo-3.5.25-1.el9.aarch64.rpm | SHA-256: 1bdb1f0273035c2adca407ca7a0223c7385fdad06d865fa05e9e7f9f75eb6972 |
| postfix-lmdb-3.5.25-1.el9.aarch64.rpm | SHA-256: ddf5761c29e847acbfaa6419ca1530022f9905e2df863e25b6d362fc6b91fcbe |
| postfix-lmdb-debuginfo-3.5.25-1.el9.aarch64.rpm | SHA-256: 470b6d924d6861b46828ab277b8aff11fbc0b309b5e45d353187c0f13c4283c0 |
| postfix-mysql-3.5.25-1.el9.aarch64.rpm | SHA-256: db6f6cc59d3564f6f6604a4d1585cf4f3d8a188a37edd6415adcd6ea97812535 |
| postfix-mysql-debuginfo-3.5.25-1.el9.aarch64.rpm | SHA-256: 15c2e65f8845faa6dea6d7b175a8fd7ab2f6af7fbc7fdd7ed6584e1673013dd1 |
| postfix-pcre-3.5.25-1.el9.aarch64.rpm | SHA-256: 516fe641ec9ed97cfa48d4f9b93604bab4978201dc2b46efecea8dd07932c821 |
| postfix-pcre-debuginfo-3.5.25-1.el9.aarch64.rpm | SHA-256: 74c8c53a87036e4830ac269e6504ad4cfa2e6739ee555cd0b557b534c3ddffd2 |
| postfix-perl-scripts-3.5.25-1.el9.aarch64.rpm | SHA-256: 2bbc068f019b14c2535799c84c35b22c22a7ff292feac7f4f59c8c34e08fc0d8 |
| postfix-pgsql-3.5.25-1.el9.aarch64.rpm | SHA-256: b1a224763fac39274a93059e965af790e4f293b51adbcf51de19180938f3c209 |
| postfix-pgsql-debuginfo-3.5.25-1.el9.aarch64.rpm | SHA-256: d59390ecc41439e80db3ff557279e766a5beba52607d6e9f61cffa4cc7db7fcb |
| postfix-sqlite-3.5.25-1.el9.aarch64.rpm | SHA-256: 9895b356c0d687acff06d6c4a00616ee1bdf41fe183a7735ccd3d4c93016a52a |
| postfix-sqlite-debuginfo-3.5.25-1.el9.aarch64.rpm | SHA-256: 6f193ff2282d659aa180a3cb50aa919041434f9cfd6274304f8bfee3379afb7b |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_d85b316b_20250114_192947.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feeenvik1%2FCVE-2023-51764)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feeenvik1%2FCVE-2023-51764)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=eeenvik1%2FCVE-2023-51764)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eeenvik1](/eeenvik1)
/
**[CVE-2023-51764](/eeenvik1/CVE-2023-51764)**
Public

* [Notifications](/login?return_to=%2Feeenvik1%2FCVE-2023-51764) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Feeenvik1%2FCVE-2023-51764)
* [Star
   4](/login?return_to=%2Feeenvik1%2FCVE-2023-51764)

PoC CVE-2023-51764

[4
stars](/eeenvik1/CVE-2023-51764/stargazers) [4
forks](/eeenvik1/CVE-2023-51764/forks) [Branches](/eeenvik1/CVE-2023-51764/branches) [Tags](/eeenvik1/CVE-2023-51764/tags) [Activity](/eeenvik1/CVE-2023-51764/activity)
 [Star](/login?return_to=%2Feeenvik1%2FCVE-2023-51764)

 [Notifications](/login?return_to=%2Feeenvik1%2FCVE-2023-51764) You must be signed in to change notification settings

* [Code](/eeenvik1/CVE-2023-51764)
* [Issues
  0](/eeenvik1/CVE-2023-51764/issues)
* [Pull requests
  0](/eeenvik1/CVE-2023-51764/pulls)
* [Actions](/eeenvik1/CVE-2023-51764/actions)
* [Projects
  0](/eeenvik1/CVE-2023-51764/projects)
* [Security](/eeenvik1/CVE-2023-51764/security)
* [Insights](/eeenvik1/CVE-2023-51764/pulse)

Additional navigation options

* [Code](/eeenvik1/CVE-2023-51764)
* [Issues](/eeenvik1/CVE-2023-51764/issues)
* [Pull requests](/eeenvik1/CVE-2023-51764/pulls)
* [Actions](/eeenvik1/CVE-2023-51764/actions)
* [Projects](/eeenvik1/CVE-2023-51764/projects)
* [Security](/eeenvik1/CVE-2023-51764/security)
* [Insights](/eeenvik1/CVE-2023-51764/pulse)

# eeenvik1/CVE-2023-51764

    main[Branches](/eeenvik1/CVE-2023-51764/branches)[Tags](/eeenvik1/CVE-2023-51764/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[3 Commits](/eeenvik1/CVE-2023-51764/commits/main/) | | |
| [Screenshots](/eeenvik1/CVE-2023-51764/tree/main/Screenshots "Screenshots") | | [Screenshots](/eeenvik1/CVE-2023-51764/tree/main/Screenshots "Screenshots") |  |  |
| [CVE-2023-51764\_25.py](/eeenvik1/CVE-2023-51764/blob/main/CVE-2023-51764_25.py "CVE-2023-51764_25.py") | | [CVE-2023-51764\_25.py](/eeenvik1/CVE-2023-51764/blob/main/CVE-2023-51764_25.py "CVE-2023-51764_25.py") |  |  |
| [CVE-2023-51764\_465.py](/eeenvik1/CVE-2023-51764/blob/main/CVE-2023-51764_465.py "CVE-2023-51764_465.py") | | [CVE-2023-51764\_465.py](/eeenvik1/CVE-2023-51764/blob/main/CVE-2023-51764_465.py "CVE-2023-51764_465.py") |  |  |
| [README.md](/eeenvik1/CVE-2023-51764/blob/main/README.md "README.md") | | [README.md](/eeenvik1/CVE-2023-51764/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# PoC for CVE-2023-51764 SMTP SMUGGLING Postfix

## CVE-2023-51765\_25.py

### Описание

Данный скрипт позволяет отправлять сообщения, используя 25 порт почтового сервера.

### Использование

Перед запуском, необходимо изменить переменные:

* `smtp_server` - адрес почтового сервера
* `from_address` - отправитель первого письма
* `to_address` - получатель первого письма
* `username` - логин для прохождения авторизации
* `password` - пароль для прохождения авторизации
* `body` - сообщение
* + В теле сообщения есть две переменные
  + `mail FROM` - адрес ложного отправителя
  + `rcpt TO` - адрес действительного получателя

Запускать командой: `python3 CVE-2023-51765_25.py`

### Вывод работы скрипта

[![](https://github.com/eeenvik1/CVE-2023-51764/raw/main/Screenshots/Screenshot_2.png)](https://github.com/eeenvik1/CVE-2023-51764/blob/main/Screenshots/Screenshot_2.png)

### Доставленные сообщения

[![](https://github.com/eeenvik1/CVE-2023-51764/raw/main/Screenshots/Screenshot_1.png)](https://github.com/eeenvik1/CVE-2023-51764/blob/main/Screenshots/Screenshot_1.png)

## CVE-2023-51765\_465.py

### Описание

Данный скрипт позволяет отправлять сообщения, используя 465 порт почтового сервера.

### Использование

Перед запуском, необходимо изменить переменные:

* `smtp_server` - адрес почтового сервера
* `from_address` - отправитель первого письма
* `to_address` - получатель первого письма
* `username` - логин для прохождения авторизации
* `password` - пароль для прохождения авторизации
* `body` - сообщение
* + В теле сообщения есть две переменные
  + `mail FROM` - адрес ложного отправителя
  + `rcpt TO` - адрес действительного получателя

Запускать командой: `python3 CVE-2023-51765_25.py`

### Вывод работы скрипта

[![](https://github.com/eeenvik1/CVE-2023-51764/raw/main/Screenshots/Screenshot_4.png)](https://github.com/eeenvik1/CVE-2023-51764/blob/main/Screenshots/Screenshot_4.png)

### Доставленные сообщения

[![](https://github.com/eeenvik1/CVE-2023-51764/raw/main/Screenshots/Screenshot_3.png)](https://github.com/eeenvik1/CVE-2023-51764/blob/main/Screenshots/Screenshot_3.png)

## About

PoC CVE-2023-51764

### Topics

[cve](/topics/cve "Topic: cve")

### Resources

[Readme](#readme-ov-file)

[Activity](/eeenvik1/CVE-2023-51764/activity)
### Stars

[**4**
stars](/eeenvik1/CVE-2023-51764/stargazers)
### Watchers

[**1**
watching](/eeenvik1/CVE-2023-51764/watchers)
### Forks

[**4**
forks](/eeenvik1/CVE-2023-51764/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Feeenvik1%2FCVE-2023-51764&report=eeenvik1+%28user%29)

## [Releases](/eeenvik1/CVE-2023-51764/releases)

No releases published

## [Packages 0](/users/eeenvik1/packages?repo_name=CVE-2023-51764)

No packages published

## Languages

* [Python
  100.0%](/eeenvik1/CVE-2023-51764/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.debian.org_eb4ec818_20250115_114609.html ===

# Debian Bug report logs - #1059230 postfix: CVE-2023-51764: SMTP Smuggling attack

[![version graph](version.cgi?height=2;fixed=postfix%2F3.8.4-1;fixed=postfix%2F3.7.9-0%2Bdeb12u1;fixed=postfix%2F3.5.23-0%2Bdeb11u1;package=src%3Apostfix;absolute=0;found=postfix%2F3.8.2-1;found=postfix%2F3.4.23-0%2Bdeb10u1;found=postfix%2F3.7.6-0%2Bdeb12u2;found=postfix%2F3.5.18-0%2Bdeb11u1;collapse=1;width=2)](version.cgi?collapse=1;absolute=0;found=postfix%2F3.8.2-1;found=postfix%2F3.4.23-0%2Bdeb10u1;found=postfix%2F3.7.6-0%2Bdeb12u2;found=postfix%2F3.5.18-0%2Bdeb11u1;package=src%3Apostfix;fixed=postfix%2F3.8.4-1;fixed=postfix%2F3.7.9-0%2Bdeb12u1;fixed=postfix%2F3.5.23-0%2Bdeb11u1;info=1)

Package:
[src:postfix](pkgreport.cgi?src=postfix);
Maintainer for [src:postfix](pkgreport.cgi?src=postfix) is [Debian Postfix Team <team+postfix@tracker.debian.org>](pkgreport.cgi?maint=team%2Bpostfix%40tracker.debian.org);

Reported by: [Salvatore Bonaccorso <carnil@debian.org>](pkgreport.cgi?submitter=carnil%40debian.org)

Date: Thu, 21 Dec 2023 17:00:02 UTC

Severity: important

Tags: security, upstream

Found in versions postfix/3.8.2-1, postfix/3.4.23-0+deb10u1, postfix/3.7.6-0+deb12u2, postfix/3.5.18-0+deb11u1

Fixed in versions postfix/3.8.4-1, postfix/3.7.9-0+deb12u1, postfix/3.5.23-0+deb11u1

**Done:** Scott Kitterman <scott@kitterman.com>

Bug is archived. No further changes may be made.

Forwarded to [https://www.mail-archive.com/postfix-users@postfix.org/msg100901.html](https://www.mail-archive.com/postfix-users%40postfix.org/msg100901.html)

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=1059230;mbox=yes), [status mbox](bugreport.cgi?bug=1059230;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=1059230;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, carnil@debian.org, team@security.debian.org, LaMont Jones <lamont@debian.org>`:

`Bug#1059230`; Package `src:postfix`.
(Thu, 21 Dec 2023 17:00:04 GMT) ([full text](bugreport.cgi?bug=1059230;msg=2), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

New Bug report received and forwarded. Copy sent to `carnil@debian.org, team@security.debian.org, LaMont Jones <lamont@debian.org>`.
(Thu, 21 Dec 2023 17:00:04 GMT) ([full text](bugreport.cgi?bug=1059230;msg=4), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=5), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: postfix: SMTP Smuggling attack
Date: Thu, 21 Dec 2023 17:57:21 +0100
```
Source: postfix
Version: 3.8.2-1
Severity: important
Tags: security upstream
Forwarded: [https://www.mail-archive.com/postfix-users@postfix.org/msg100901.html](https://www.mail-archive.com/postfix-users%40postfix.org/msg100901.html)
X-Debbugs-Cc: carnil@debian.org, Debian Security Team <team@security.debian.org>
Control: found -1 3.7.6-0+deb12u2
Control: found -1 3.5.18-0+deb11u1
Control: found -1 3.4.23-0+deb10u1

Hi

There was a SMTP smuggling vulerability reported, for which in some
Postfix versions at least already exists short term mitiations in form
of "smtpd_forbid_unauth_pipelining = yes".

Details via:

[https://www.mail-archive.com/postfix-users@postfix.org/msg100901.html](https://www.mail-archive.com/postfix-users%40postfix.org/msg100901.html)
<https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/>

Regards,
Salvatore

```

---

**Marked as found in versions postfix/3.7.6-0+deb12u2.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `submit@bugs.debian.org`.
(Thu, 21 Dec 2023 17:00:04 GMT) ([full text](bugreport.cgi?bug=1059230;msg=7), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=7), [link](#6)).

---

**Marked as found in versions postfix/3.5.18-0+deb11u1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `submit@bugs.debian.org`.
(Thu, 21 Dec 2023 17:00:05 GMT) ([full text](bugreport.cgi?bug=1059230;msg=9), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=9), [link](#8)).

---

**Marked as found in versions postfix/3.4.23-0+deb10u1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `submit@bugs.debian.org`.
(Thu, 21 Dec 2023 17:00:05 GMT) ([full text](bugreport.cgi?bug=1059230;msg=11), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=11), [link](#10)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, LaMont Jones <lamont@debian.org>`:

`Bug#1059230`; Package `src:postfix`.
(Thu, 21 Dec 2023 18:15:02 GMT) ([full text](bugreport.cgi?bug=1059230;msg=13), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=13), [link](#12)).

---

**Acknowledgement sent**
to `Scott Kitterman <debian@kitterman.com>`:

Extra info received and forwarded to list. Copy sent to `LaMont Jones <lamont@debian.org>`.
(Thu, 21 Dec 2023 18:15:03 GMT) ([full text](bugreport.cgi?bug=1059230;msg=15), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=15), [link](#14)).

---

[Message #16](#16) received at 1059230@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=16), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=16), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40kitterman.com)
From: Scott Kitterman <debian@kitterman.com>
To: 1059230@bugs.debian.org
Subject: Re: Bug#1059230: postfix: SMTP Smuggling attack
Date: Thu, 21 Dec 2023 13:03:20 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=1059230;msg=16) (text/plain, inline)]
```
```
On Thursday, December 21, 2023 11:57:21 AM EST Salvatore Bonaccorso wrote:
> Source: postfix
> Version: 3.8.2-1
> Severity: important
> Tags: security upstream
> Forwarded:
> [https://www.mail-archive.com/postfix-users@postfix.org/msg100901.html](https://www.mail-archive.com/postfix-users%40postfix.org/msg100901.html)
> X-Debbugs-Cc: carnil@debian.org, Debian Security Team
> <team@security.debian.org> Control: found -1 3.7.6-0+deb12u2
> Control: found -1 3.5.18-0+deb11u1
> Control: found -1 3.4.23-0+deb10u1
>
> Hi
>
> There was a SMTP smuggling vulerability reported, for which in some
> Postfix versions at least already exists short term mitiations in form
> of "smtpd_forbid_unauth_pipelining = yes".
>
> Details via:
>
> [https://www.mail-archive.com/postfix-users@postfix.org/msg100901.html](https://www.mail-archive.com/postfix-users%40postfix.org/msg100901.html)
> <https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwid>
> e/

See <https://www.postfix.org/smtp-smuggling.html> for the most recent
information.

The mitigation is available for stable, but not yet oldstable.

Scott K
```
```
[[signature.asc](bugreport.cgi?att=1;bug=1059230;filename=signature.asc;msg=16) (application/pgp-signature, inline)]
```

---

**Reply sent**
to `Scott Kitterman <scott@kitterman.com>`:

You have taken responsibility.
(Fri, 22 Dec 2023 18:21:05 GMT) ([full text](bugreport.cgi?bug=1059230;msg=18), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=18), [link](#17)).

---

**Notification sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug acknowledged by developer.
(Fri, 22 Dec 2023 18:21:05 GMT) ([full text](bugreport.cgi?bug=1059230;msg=20), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=20), [link](#19)).

---

[Message #21](#21) received at 1059230-close@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=21), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=21), reply):

![](/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org)
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
To: 1059230-close@bugs.debian.org
Subject: Bug#1059230: fixed in postfix 3.8.4-1
Date: Fri, 22 Dec 2023 18:19:22 +0000
```
Source: postfix
Source-Version: 3.8.4-1
Done: Scott Kitterman <scott@kitterman.com>

We believe that the bug you reported is fixed in the latest version of
postfix, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 1059230@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Scott Kitterman <scott@kitterman.com> (supplier of updated postfix package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Fri, 22 Dec 2023 13:02:36 -0500
Source: postfix
Architecture: source
Version: 3.8.4-1
Distribution: unstable
Urgency: medium
Maintainer: LaMont Jones <lamont@debian.org>
Changed-By: Scott Kitterman <scott@kitterman.com>
Closes: [1059230](bugreport.cgi?bug=1059230)
Changes:
 postfix (3.8.4-1) unstable; urgency=medium
 .
   [Wietse Venema]
 .
   * 3.8.4 Closes: #[1059230](bugreport.cgi?bug=1059230)
Checksums-Sha1:
 39bfdedc1edd7a4b97b1942efaf119ee40665379 2976 postfix_3.8.4-1.dsc
 1355a0a7541c76c390ff20555917aaa9059110c7 4864184 postfix_3.8.4.orig.tar.gz
 d23e0c8d5caa6b50879ac147684f57f39561cf84 220 postfix_3.8.4.orig.tar.gz.asc
 4f656b1d0287580c3966451111636b72961405af 198944 postfix_3.8.4-1.debian.tar.xz
 477b0885600bda5f4649abdcf91641b257e17ee0 7663 postfix_3.8.4-1_source.buildinfo
Checksums-Sha256:
 136cf93be68713f414bae482b096757103ad10246bc349799182a4abb4860f3d 2976 postfix_3.8.4-1.dsc
 6f5848c5d8b6a7d2c5af0a9f75b0bd3f103451e912591464ab867fde085e6236 4864184 postfix_3.8.4.orig.tar.gz
 1bcccfc6efddf4d5749969c899fd51783a0a2fd9235bd00cfcde806c0a16d29b 220 postfix_3.8.4.orig.tar.gz.asc
 dd03bb4c321995632b5f0a2928683e8d7a3b1dc93e230ea1439da556480f482a 198944 postfix_3.8.4-1.debian.tar.xz
 0996e67ec945b582cd00fdde342b4c8fe285447ec8673c4414a3e1ae83362b78 7663 postfix_3.8.4-1_source.buildinfo
Files:
 28b87b5fa0824c130c5ae1b2c2c755a8 2976 mail optional postfix_3.8.4-1.dsc
 f2e5ac23387a5824bc365675697277e9 4864184 mail optional postfix_3.8.4.orig.tar.gz
 546e73ec5f44b3523621491ab543c4e6 220 mail optional postfix_3.8.4.orig.tar.gz.asc
 44fe2b1505491898e02165a354cf5552 198944 mail optional postfix_3.8.4-1.debian.tar.xz
 8fbdade12dafb7eabecef1da12503f6a 7663 mail optional postfix_3.8.4-1_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE53Kb/76FQA/u7iOxeNfe+5rVmvEFAmWFz2kACgkQeNfe+5rV
mvHxPhAAhQ5amNanXhjZ5bGfMlPC8S7NjcmHb3MlWb+k7EeY828LW+6rPg9eW6Qj
OBIhy1MopjPLl5uPm5rWLmsInhWTOktHWtEobIiXAD3/MlOI5GJD2arSCboySUl3
4K95ZuwtsaDjKV0+miokR70pnW6ZNfIgXkHy/r9Om7uFWqb3St2EKWxBaptzmood
RPCB2+8HNfQ85ww/beqiEritkMtc8k4jvgvPP/IUULnHebjISdOaroLx03e630dJ
Qf5RvAojnn+kdTiex4u+05Lb+99B2LKvJYXgvy3iSyKCLkegOe7a2mDjaw3WxeY+
/0DvYbo91qMNY2i8ikRUxRpNTTE16b4be8+23qj51TMjGQYOk5sXIIL92tkNPHfL
BL5ONApCgfmeUfc1AUxbs0JGMs1W0mb+oUTkDnywG7tEQPMLVWozgZ59DSbeHdUL
jN828f+CDHIi/bPQO114FjThmxmMwhbxSkgZElm0Hk/MjvDJrQ+YPxmrrKhZTRKj
qcZdxNaJ1f16/xFvalsrTYBSX5w2iwbJsWWoJgFwgSpqJCWxnNIEDZOQ+W2TwL7w
UHHaPH77P2EX4xmfTUEXNi6iuPF7y6bQcbaYjIKibJA7ukBa4Yfw3JkMD4Q0udcp
BkdZy0JYepo0twYKcYanR1elvB4QrSxMaRYQ/GmEZhTUI5Qgsvc=
=a0/Q
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, LaMont Jones <lamont@debian.org>`:

`Bug#1059230`; Package `src:postfix`.
(Sun, 24 Dec 2023 08:33:02 GMT) ([full text](bugreport.cgi?bug=1059230;msg=23), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=23), [link](#22)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `LaMont Jones <lamont@debian.org>`.
(Sun, 24 Dec 2023 08:33:02 GMT) ([full text](bugreport.cgi?bug=1059230;msg=25), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=25), [link](#24)).

---

[Message #26](#26) received at 1059230@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=26), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=26), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Scott Kitterman <debian@kitterman.com>, 1059230@bugs.debian.org
Subject: Re: Bug#1059230: postfix: SMTP Smuggling attack
Date: Sun, 24 Dec 2023 09:29:58 +0100
```
Control: retitle -1 postfix: [CVE-2023-51764](https://security-tracker.debian.org/tracker/CVE-2023-51764): SMTP Smuggling attack

Hi

On Thu, Dec 21, 2023 at 01:03:20PM -0500, Scott Kitterman wrote:
> On Thursday, December 21, 2023 11:57:21 AM EST Salvatore Bonaccorso wrote:
> > Source: postfix
> > Version: 3.8.2-1
> > Severity: important
> > Tags: security upstream
> > Forwarded:
> > [https://www.mail-archive.com/postfix-users@postfix.org/msg100901.html](https://www.mail-archive.com/postfix-users%40postfix.org/msg100901.html)
> > X-Debbugs-Cc: carnil@debian.org, Debian Security Team
> > <team@security.debian.org> Control: found -1 3.7.6-0+deb12u2
> > Control: found -1 3.5.18-0+deb11u1
> > Control: found -1 3.4.23-0+deb10u1
> >
> > Hi
> >
> > There was a SMTP smuggling vulerability reported, for which in some
> > Postfix versions at least already exists short term mitiations in form
> > of "smtpd_forbid_unauth_pipelining = yes".
> >
> > Details via:
> >
> > [https://www.mail-archive.com/postfix-users@postfix.org/msg100901.html](https://www.mail-archive.com/postfix-users%40postfix.org/msg100901.html)
> > <https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwid>
> > e/
>
> See <https://www.postfix.org/smtp-smuggling.html> for the most recent
> information.
>
> The mitigation is available for stable, but not yet oldstable.

Right, that was the better reference to following the status.

A CVE has been assigned in meanwhile for the issue in postfix:
[CVE-2023-51764](https://security-tracker.debian.org/tracker/CVE-2023-51764).

Regards,
Salvatore

```

---

**Changed Bug title to 'postfix: CVE-2023-51764: SMTP Smuggling attack' from 'postfix: SMTP Smuggling attack'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `1059230-submit@bugs.debian.org`.
(Sun, 24 Dec 2023 08:33:02 GMT) ([full text](bugreport.cgi?bug=1059230;msg=28), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=28), [link](#27)).

---

**Message sent on**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug#1059230.
(Sun, 24 Dec 2023 18:06:05 GMT) ([full text](bugreport.cgi?bug=1059230;msg=30), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=30), [link](#29)).

---

[Message #31](#31) received at 1059230-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=31), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=31), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40kitterman.com)
From: Scott Kitterman <debian@kitterman.com>
To: 1059230-submitter@bugs.debian.org
Subject: postfix: CVE-2023-51764: SMTP Smuggling attack stable update
Date: Sun, 24 Dec 2023 12:57:14 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=1059230;msg=31) (text/plain, inline)]
```
```
I've just uploaded 3.7.9 as a stable update to address this and other non-
security issues between the current 3.7.6 and the latest maintenance release.
It is pending SRM review.

Scott K
```
```
[[signature.asc](bugreport.cgi?att=1;bug=1059230;filename=signature.asc;msg=31) (application/pgp-signature, inline)]
```

---

**Information stored**
:

`Bug#1059230`; Package `src:postfix`.
(Sun, 24 Dec 2023 20:18:02 GMT) ([full text](bugreport.cgi?bug=1059230;msg=33), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=33), [link](#32)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and filed, but not forwarded.
(Sun, 24 Dec 2023 20:18:02 GMT) ([full text](bugreport.cgi?bug=1059230;msg=35), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=35), [link](#34)).

---

[Message #36](#36) received at 1059230-quiet@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=36), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=36), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Scott Kitterman <debian@kitterman.com>, 1059230-quiet@bugs.debian.org
Cc: 1059230-submitter@bugs.debian.org
Subject: Re: Bug#1059230: postfix: CVE-2023-51764: SMTP Smuggling attack
stable update
Date: Sun, 24 Dec 2023 21:15:09 +0100
```
Hi,

On Sun, Dec 24, 2023 at 12:57:14PM -0500, Scott Kitterman wrote:
> I've just uploaded 3.7.9 as a stable update to address this and other non-
> security issues between the current 3.7.6 and the latest maintenance release.
> It is pending SRM review.

Thanks, that sounds good, we do not necessarily need a DSA here given
workaround / mitigations exist. Proposing an update via point release
(and fasttrack it trough SUA seems good).

Will you do the same as well for oldstable / bullseye?

Regards,
Salvatore

```

---

**Message sent on**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug#1059230.
(Sun, 24 Dec 2023 20:18:03 GMT) ([full text](bugreport.cgi?bug=1059230;msg=38), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=38), [link](#37)).

---

**Message sent on**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug#1059230.
(Sun, 24 Dec 2023 21:33:03 GMT) ([full text](bugreport.cgi?bug=1059230;msg=41), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=41), [link](#40)).

---

[Message #42](#42) received at 1059230-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=42), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=42), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40kitterman.com)
From: Scott Kitterman <debian@kitterman.com>
To: 1059230-submitter@bugs.debian.org
Subject: Re: Bug#1059230: postfix: CVE-2023-51764: SMTP Smuggling attack stable update
Date: Sun, 24 Dec 2023 20:43:48 +0000
```

On December 24, 2023 8:15:09 PM UTC, Salvatore Bonaccorso <carnil@debian.org> wrote:
>Hi,
>
>On Sun, Dec 24, 2023 at 12:57:14PM -0500, Scott Kitterman wrote:
>> I've just uploaded 3.7.9 as a stable update to address this and other non-
>> security issues between the current 3.7.6 and the latest maintenance release.
>> It is pending SRM review.
>
>Thanks, that sounds good, we do not necessarily need a DSA here given
>workaround / mitigations exist. Proposing an update via point release
>(and fasttrack it trough SUA seems good).
>
>Will you do the same as well for oldstable / bullseye?

Yes.  That's my plan.

Scott K

```

---

**Reply sent**
to `Scott Kitterman <scott@kitterman.com>`:

You have taken responsibility.
(Tue, 26 Dec 2023 20:33:06 GMT) ([full text](bugreport.cgi?bug=1059230;msg=44), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=44), [link](#43)).

---

**Notification sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug acknowledged by developer.
(Tue, 26 Dec 2023 20:33:06 GMT) ([full text](bugreport.cgi?bug=1059230;msg=46), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=46), [link](#45)).

---

[Message #47](#47) received at 1059230-close@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=47), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=47), reply):

![](/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org)
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
To: 1059230-close@bugs.debian.org
Subject: Bug#1059230: fixed in postfix 3.7.9-0+deb12u1
Date: Tue, 26 Dec 2023 20:32:08 +0000
```
Source: postfix
Source-Version: 3.7.9-0+deb12u1
Done: Scott Kitterman <scott@kitterman.com>

We believe that the bug you reported is fixed in the latest version of
postfix, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 1059230@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Scott Kitterman <scott@kitterman.com> (supplier of updated postfix package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Sun, 24 Dec 2023 12:33:24 -0500
Source: postfix
Architecture: source
Version: 3.7.9-0+deb12u1
Distribution: bookworm
Urgency: medium
Maintainer: LaMont Jones <lamont@debian.org>
Changed-By: Scott Kitterman <scott@kitterman.com>
Closes: [1059230](bugreport.cgi?bug=1059230)
Changes:
 postfix (3.7.9-0+deb12u1) bookworm; urgency=medium
 .
   [Wietse Venema]
 .
   * 3.7.7
     - Bugfix (bug introduced: 20140218): when opportunistic TLS fails
       during or after the handshake, don't require that a probe
       message spent a minimum time-in-queue before falling back to
       plaintext. Problem reported by Serg. File: smtp/smtp.h.
     - Bugfix (defect introduced: 19980207): the valid_hostname()
       check in the Postfix DNS client library was blocking unusual
       but legitimate wildcard names (*.name) in some DNS lookup
       results and lookup requests. Examples:
           name          class/type value
         *.one.example   IN CNAME *.other.example
         *.other.example IN A     10.0.0.1
         *.other.example IN TLSA  ..certificate info...
       Such syntax is blesed in RFC 1034 section 4.3.3.
       This problem was reported first in the context of TLSA
       record lookups. Files: util/valid_hostname.[hc],
   * 3.7.8
     - Bugfix (defect introduced Postfix 2.5, 20080104): the Postfix
       SMTP server was waiting for a client command instead of
       replying immediately, after a client certificate verification
       error in TLS wrappermode. Reported by Andreas Kinzler. File:
       smtpd/smtpd.c.
     - Usability: the Postfix SMTP server now attempts to log the
       SASL username after authentication failure. In Postfix
       logging, this appends ", sasl_username=xxx" after the reason
       for SASL authentication failure. The logging replaces an
       unavailable reason with "(reason unavailable)", and replaces
       an unavailable sasl_username with "(unavailable)". Based
       on code by Jozsef Kadlecsik. Files: xsasl/xsasl_server.c,
       xsasl/xsasl_cyrus_server.c, smtpd/smtpd_sasl_glue.c.
     - Bugfix (defect introduced: Postfix 2.11): in forward_path,
       the expression ${recipient_delimiter} would expand to an
       empty string when a recipient address had no recipient
       delimiter. Fixed by restoring Postfix 2.10 behavior to use
       a configured recipient delimiter value. Reported by Tod
       A. Sandman. Files: proto/postconf.proto, local/local_expand.c.
   * 3.7.9 (Closes: #[1059230](bugreport.cgi?bug=1059230))
     - Addresses [CVE-2023-51764](https://security-tracker.debian.org/tracker/CVE-2023-51764), requires configuration change
     - Security: with "smtpd_forbid_bare_newline = yes" (default
       "no" for Postfix < 3.9), reply with "Error: bare <LF>
       received" and disconnect when an SMTP client sends a line
       ending in <LF>, violating the RFC 5321 requirement that
       lines must end in <CR><LF>. This prevents SMTP smuggling
       attacks that target a recipient at a Postfix server. For
       backwards compatibility, local clients are excluded by
       default with "smtpd_forbid_bare_newline_exclusions =
       $mynetworks". Files: mantools/postlink, proto/postconf.proto,
       global/mail_params.h, global/smtp_stream.c, global/smtp_stream.h,
Checksums-Sha1:
 6db951753ca1c6360e817424283906784bc289cb 3008 postfix_3.7.9-0+deb12u1.dsc
 1a7d623ed0af635b6e1134ce73f6afdf5800736a 4835829 postfix_3.7.9.orig.tar.gz
 91f3950f49debd1b5e94b8cdf495c52b778db8be 220 postfix_3.7.9.orig.tar.gz.asc
 d11db873c454cc58610e19312ca01b5fe3d32e84 197796 postfix_3.7.9-0+deb12u1.debian.tar.xz
 4484f05c29ef0f8c64d0733ed070d5ad6ee7bfa5 7695 postfix_3.7.9-0+deb12u1_source.buildinfo
Checksums-Sha256:
 dc186d3d4227a34c9dbf6c0a52bc390a18c1e244c43eb0d3af7d7d6f3040d662 3008 postfix_3.7.9-0+deb12u1.dsc
 d75db038b3dd202a9059d5c149d36fe8a05d54edc4f2e2be93e792eef16988f3 4835829 postfix_3.7.9.orig.tar.gz
 0e43d4b69adccf52e5f75d1603d624f99478af8a4f89786ed65a3a4568484d39 220 postfix_3.7.9.orig.tar.gz.asc
 9627d8ef2ed2b36b1f0fc03b5de5e5fc490567fc997a43cc671b8b67494f4e1e 197796 postfix_3.7.9-0+deb12u1.debian.tar.xz
 7521362d473d53ebde2353073617f41e4e404c2ba95e60d0f609a15e94037826 7695 postfix_3.7.9-0+deb12u1_source.buildinfo
Files:
 fc7122a062a90478f6c8e2406d134fd4 3008 mail optional postfix_3.7.9-0+deb12u1.dsc
 36d5c703793af81f5b7ca2bde5cae502 4835829 mail optional postfix_3.7.9.orig.tar.gz
 4d2f4f2263fad4934d45b2f167dd6a08 220 mail optional postfix_3.7.9.orig.tar.gz.asc
 8f7026cab46bad8cff8ae1e8f1a54403 197796 mail optional postfix_3.7.9-0+deb12u1.debian.tar.xz
 bea806f0819b6ef6ed30df1f1d01e75c 7695 mail optional postfix_3.7.9-0+deb12u1_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE53Kb/76FQA/u7iOxeNfe+5rVmvEFAmWIa5cACgkQeNfe+5rV
mvFaNw/9E9OmpR0GcUERCWFwpBnJ7qYgtXlRDPVAsIzuMvRYl1wMN4+psij93X/9
Ljw1lBYQbjFdCmCMMF9AymMZFIAIVvdf7ePeJpzCg/IcT3HB34rMARTB08RbZbyt
JHQQXSowrcq1ADl8jI02ju6TR/R4+b+hJgIVsKyaxBktB+KTdhR0bXZG5D6UgCPv
Lqup/eOjc3SISjxLRa1mVkwhTya2er2sQ86DEWOIbfqe/l+xWqucLFuE5wfhQrP6
mAK3+oCGuoPSMmN/H27v4bXoi0MbDJkTk2VMb6R9LJ3tavxu3dxb0VT0XtTZAvNl
OgCSwKMg1j/taXAaJDqdMx1YLS7EqaHHJ1YRNjlExbz2yWuxtJGVo3F3yeuuf+n3
Eff6EYJM3ZCAN5rYQnHGtM3RZPAFI5uQ2C/dWB0c/ApIiHFlehdQqSJE9jYTxp2X
TfVVBkXqxVaae7uKNd25mL7Qd+n60ugOoOSob7ueic2lIejy0a5C/AANwO6Y93QN
h8A0RyZPutkkEPkYh/mHoGZ2fhSsLtI4ZfpDoVOVxTmqAI3aY1qX6FcQ4vUmyOax
RlvupITUKQapZ+3yQ5G+eU4Tw9mUBBfQiVHiuP8gODjql6PNPo3w3QaMZrNi2bML
w+P8zSmY8OGYcu7NHC+6xq/WEA5gWkWXmkoD+KSAYS8hd6Kqxqs=
=ibhl
-----END PGP SIGNATURE-----

```

---

**Message sent on**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug#1059230.
(Tue, 26 Dec 2023 21:30:06 GMT) ([full text](bugreport.cgi?bug=1059230;msg=49), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=49), [link](#48)).

---

[Message #50](#50) received at 1059230-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=50), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=50), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40kitterman.com)
From: Scott Kitterman <debian@kitterman.com>
To: 1059230-submitter@bugs.debian.org
Subject: Re: Bug#1059230: postfix: CVE-2023-51764: SMTP Smuggling attack stable update
Date: Tue, 26 Dec 2023 16:27:28 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=1059230;msg=50) (text/plain, inline)]
```
```
On Sunday, December 24, 2023 3:15:09 PM EST Salvatore Bonaccorso wrote:
> Hi,
>
> On Sun, Dec 24, 2023 at 12:57:14PM -0500, Scott Kitterman wrote:
> > I've just uploaded 3.7.9 as a stable update to address this and other non-
> > security issues between the current 3.7.6 and the latest maintenance
> > release. It is pending SRM review.
>
> Thanks, that sounds good, we do not necessarily need a DSA here given
> workaround / mitigations exist. Proposing an update via point release
> (and fasttrack it trough SUA seems good).

For Stable, 3.7.9-0+deb12u1 has been accepted by SRM.  For Old Stable,
3.5.23-0+deb11u1 has been uploaded and is awaiting SRM review.

Scott K
```
```
[[signature.asc](bugreport.cgi?att=1;bug=1059230;filename=signature.asc;msg=50) (application/pgp-signature, inline)]
```

---

**Reply sent**
to `Scott Kitterman <scott@kitterman.com>`:

You have taken responsibility.
(Thu, 28 Dec 2023 07:06:03 GMT) ([full text](bugreport.cgi?bug=1059230;msg=52), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=52), [link](#51)).

---

**Notification sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug acknowledged by developer.
(Thu, 28 Dec 2023 07:06:04 GMT) ([full text](bugreport.cgi?bug=1059230;msg=54), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=54), [link](#53)).

---

[Message #55](#55) received at 1059230-close@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=55), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=55), reply):

![](/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org)
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
To: 1059230-close@bugs.debian.org
Subject: Bug#1059230: fixed in postfix 3.5.23-0+deb11u1
Date: Thu, 28 Dec 2023 07:02:26 +0000
```
Source: postfix
Source-Version: 3.5.23-0+deb11u1
Done: Scott Kitterman <scott@kitterman.com>

We believe that the bug you reported is fixed in the latest version of
postfix, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 1059230@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Scott Kitterman <scott@kitterman.com> (supplier of updated postfix package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Tue, 26 Dec 2023 16:07:38 -0500
Source: postfix
Architecture: source
Version: 3.5.23-0+deb11u1
Distribution: bullseye
Urgency: medium
Maintainer: LaMont Jones <lamont@debian.org>
Changed-By: Scott Kitterman <scott@kitterman.com>
Closes: [1059230](bugreport.cgi?bug=1059230)
Changes:
 postfix (3.5.23-0+deb11u1) bullseye; urgency=medium
 .
   [Wietse Venema]
 .
   * 3.5.19
     - Portability: the EVP_get_digestbyname change broke OpenSSL
       1.0.2 support. File: tls/tls.h.
     - Bugfix (introduced: Postfix 3.4): the posttls-finger command
       failed to detect that a connection was resumed in the case
       that a server did not return a certificate. Viktor Dukhovni.
       File: posttls-finger/posttls-finger.c.
     - Workaround: OpenSSL 3.x EVP_get_cipherbyname() can return
       lazily-bound handles. Postfix now checks that the expected
       functionality will be available instead of failing later.
       Fix by Viktor Dukhovni. File: tls/tls_server.c.
     - Bugfix (introduced: Postfix 3.5): check_ccert_access did
       not parse inline map specifications. Report and fix by Sean
       Gallagher. File: global/map_search.c.
     - Safety: the long form "{ name = value }" in import_environment
       or export_environment is not documented, but accepted, and
       it was stored in the process environment as the invalid
       form "name = value", thus not setting or overriding an entry
       for "name". This form is now stored as the expected
       "name=value". Found during code maintenance. Also refined
       the "missing attribute name" detection. Files: clean_env.c,
       split_nameval.c.
    -  Bugfix (introduced: Postfix 3.2): the MySQL client could
       return "not found" instead of "error" during the time that
       all MySQL server connections were turned down after error.
       Found during code maintenance. File: global/dict_mysql.c.
   * 3.5.20
     - Bugfix (defect introduced: Postfix 1.0): the command "postconf
       .. name=v1 .. name=v2 .." (multiple instances of the same
       parameter name) created multiple name=value entries with
       the same parameter name. It now logs a warning and skips
       the earlier update. Found during code maintenance. File:
       postconf/postconf_edit.c
     - Bugfix (defect introduced: Postfix 3.3): the command "postconf
       -M name1/type1='name2 type2 ...'" died with a segmentation
       violation when the request matched multiple master.cf
       entries. The master.cf file was not damaged. Problem reported
       by SATOH Fumiyasu. File: postconf/postconf_master.c.
     - Bugfix (defect introduced: Postfix 2.11): the command
       "postconf -M name1/type1='name2 type2 ...'" could add a
       service definition to master.cf that conflicted with an
       already existing service definition. It now replaces all
       existing service definitions that match the service pattern
       'name1/type1' or the service name and type in 'name2 type2
       ...' with a single service definition 'name2 type2 ...'.
       Problem reported by SATOH Fumiyasu. File: postconf/postconf_edit.c.
     - Bitrot: preliminary support for OpenSSL configuration files,
       primarily OpenSSL 1.1.1b and later. This introduces new
       parameters "tls_config_file" and "tls_config_name", which
       can be used to limit collateral damage from OS distributions
       that crank up security to 11, increasing the number of
       plaintext email deliveries. Details are in the postconf(5)
       manpage under "tls_config_file" and "tls_config_name".
       Viktor Dukhovni. Files: mantools/postlink, proto/postconf.proto,
       global/mail_params.h, posttls-finger/posttls-finger.c,
       smtp/smtp.c, smtp/smtp_proto.c, tls/tls_client.c, tls/tls.h,
       tls/tls_misc.c, tls/tls_proxy_client_print.c,
       tls/tls_proxy_client_scan.c, tls/tls_proxy.h, tls/tls_server.c,
       tlsproxy/tlsproxy.c.
     - Cleanup: use TLS_CLIENT_PARAMS to pass the OpensSSL 'init'
       configurations. This information is independent from the
       client or server TLS context, and therefore does not belong
       in tls_*_init() or tls_*_start() calls. The tlsproxy(8)
       server uses TLS_CLIENT_PARAMS to report differences between
       its own global TLS settings, and those from its clients.
       Files: posttls-finger/posttls-finger.c, smtp/smtp.c,
       smtp/smtp_proto.c, tls/tls.h, tls/tls_proxy_client_misc.c,
       tls/tls_proxy_client_print.c, tls/tls_proxy_client_scan.c,
       tls/tls_proxy.h, tlsproxy/tlsproxy.c.
     - Cleanup: reverted cosmetic-only changes to minimize the
       patch footprint for OpenSSL INI file support; updated daemon
       manpages with the new tls_config_file and tls_config_name
       configuration parameters. Files: smtp/smtp.c, smtpd/smtpd.c,
       tls/tls_client.c, tls/tls.h, tls/tls_server.c, tlsproxy/tlsproxy.c,
     - Cleanup: made OpenSSL 'default' INI file support error
       handling consistent with OpenSSL default behavior. Viktor
       Dukhovni. Files: proto/postconf.proto, tls/tls_misc.c.
     - Backwards compatibility for stable releases that originally
       had no OpenSSL INI support. Skip the new OpenSSL INI support
       code, unless the Postfix configuration actually specifies
       non-default tls_config_xxx settings. File: tls/tls_misc.c.
     - Cleanup: added a multiple initialization guard in the
       tls_library_init() function, and made an initialization
       error sticky. File: tls/tls_misc.c.
     - Security: new parameter smtpd_forbid_unauth_pipelining
       (default: no) to disconnect remote SMTP clients that violate
       RFC 2920 (or 5321) command pipelining constraints. Files:
       global/mail_params.h, smtpd/smtpd.c, proto/postconf.proto.
   * 3.5.21
     - Bugfix (bug introduced: 20140218): when opportunistic TLS fails
       during or after the handshake, don't require that a probe
       message spent a minimum time-in-queue before falling back to
       plaintext. Problem reported by Serg. File: smtp/smtp.h.
     - Bugfix (defect introduced: 19980207): the valid_hostname()
       check in the Postfix DNS client library was blocking unusual
       but legitimate wildcard names (*.name) in some DNS lookup
       results and lookup requests. Examples:
              name          class/type value
            *.one.example   IN CNAME *.other.example
            *.other.example IN A     10.0.0.1
            *.other.example IN TLSA  ..certificate info...
       Such syntax is blesed in RFC 1034 section 4.3.3.
       This problem was reported first in the context of TLSA
       record lookups. Files: util/valid_hostname.[hc],
       dns/dns_lookup.c.
   * 3.5.22
     - Bugfix (defect introduced Postfix 2.5, 20080104): the Postfix
       SMTP server was waiting for a client command instead of
       replying immediately, after a client certificate verification
       error in TLS wrappermode. Reported by Andreas Kinzler. File:
       smtpd/smtpd.c.
     - Usability: the Postfix SMTP server now attempts to log the
       SASL username after authentication failure. In Postfix
       logging, this appends ", sasl_username=xxx" after the reason
       for SASL authentication failure. The logging replaces an
       unavailable reason with "(reason unavailable)", and replaces
       an unavailable sasl_username with "(unavailable)". Based
       on code by Jozsef Kadlecsik. Files: xsasl/xsasl_server.c,
       xsasl/xsasl_cyrus_server.c, smtpd/smtpd_sasl_glue.c.
     - Bugfix (defect introduced: Postfix 2.11): in forward_path,
       the expression ${recipient_delimiter} would expand to an
       empty string when a recipient address had no recipient
       delimiter. Fixed by restoring Postfix 2.10 behavior to use
       a configured recipient delimiter value. Reported by Tod
       A. Sandman. Files: proto/postconf.proto, local/local_expand.c.
   * 3.5.23 (Closes: #[1059230](bugreport.cgi?bug=1059230))
     - Addresses [CVE-2023-51764](https://security-tracker.debian.org/tracker/CVE-2023-51764), requires configuration change
     - Security: with "smtpd_forbid_bare_newline = yes" (default
       "no" for Postfix < 3.9), reply with "Error: bare <LF>
       received" and disconnect when an SMTP client sends a line
       ending in <LF>, violating the RFC 5321 requirement that
       lines must end in <CR><LF>. This prevents SMTP smuggling
       attacks that target a recipient at a Postfix server. For
       backwards compatibility, local clients are excluded by
       default with "smtpd_forbid_bare_newline_exclusions =
       $mynetworks". Files: mantools/postlink, proto/postconf.proto,
       global/mail_params.h, global/smtp_stream.c, global/smtp_stream.h,
 .
   [Scott Kitterman]
 .
   * Refresh patches
Checksums-Sha1:
 76d1a77ea4608eeb7d643db76c789b5e7b980a54 3039 postfix_3.5.23-0+deb11u1.dsc
 d3e41d90e76bd6ad845ecc71fd2105a3e09e6e58 4649997 postfix_3.5.23.orig.tar.gz
 cc9c887391f16058cf5c1a915d4b20452f6e864b 220 postfix_3.5.23.orig.tar.gz.asc
 619eb5bff8d1059f5c252c37e2c9bec563ecec6b 211128 postfix_3.5.23-0+deb11u1.debian.tar.xz
 d038d955af8dcf0fda95b2d282080f4de9d656c9 7639 postfix_3.5.23-0+deb11u1_source.buildinfo
Checksums-Sha256:
 73ecce675283e37ae99de4c0b9cddd22b80fe300606c71e16278537ecf358c3f 3039 postfix_3.5.23-0+deb11u1.dsc
 35fc0489ddc997cc83a835907e7deb9e725ca0f5bbce2c9d007634f8873b5b31 4649997 postfix_3.5.23.orig.tar.gz
 76f3256c4a85e1bac0b0f6dd0dd98b058e30dde68916d93d95bc8c4849813360 220 postfix_3.5.23.orig.tar.gz.asc
 b141d0aabab7dd7463b11caa168f45f2fe654148f7ffe590c008a4d4a7f46c4b 211128 postfix_3.5.23-0+deb11u1.debian.tar.xz
 0ffbf069b71deb167cebe1d07a0b17fbd26306b67195092336c8abd864fe5a5c 7639 postfix_3.5.23-0+deb11u1_source.buildinfo
Files:
 7c7058ff58950583b6f3cec6b77b53b1 3039 mail optional postfix_3.5.23-0+deb11u1.dsc
 bb925ee7ac13d061da049ed04bbe6fa5 4649997 mail optional postfix_3.5.23.orig.tar.gz
 46ae7ea3bd6bfef63f5e6d7c80401b7c 220 mail optional postfix_3.5.23.orig.tar.gz.asc
 9e7c56e4e13cd890167b49a7675daba3 211128 mail optional postfix_3.5.23-0+deb11u1.debian.tar.xz
 4fc6ddcc7584e3c88feebc9a2b0b7b5e 7639 mail optional postfix_3.5.23-0+deb11u1_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE53Kb/76FQA/u7iOxeNfe+5rVmvEFAmWLQNQACgkQeNfe+5rV
mvGFcxAAxEHb/VHZ1475KpTQSLua3A9Cqe/IgLUcXQ2B2Ip3RcmTx05fMmbHB2Gr
T3W+OtutEfoWUxo+dAI41/Sgu+OpKEebm2lDQdBzrrp2qeeunH3xK055Snr9p7CE
Cph7H+Q6YbX3HqRHyB7uZI4XrdYzXropdUyUk31Y75tQJNRWK2JpdeMM5hRkIv6f
c52JjcNtqRFQYfk39ZYzZuPl9am/tihXqwyZR/00IhMXOKleR0q9yd45UKokq+Dw
7rA/qE/LRD1Y62NB3uGppMB5/jtT6rGWoQfadF2mWcfWQ9qdmNR7t//uXNECt3Me
0qEiPgzhrvNEZ55ZEjdhZnKiQkfZDAFjCgD0oRryVG7q4WLiFHWGb298+RzxWlz2
8qzikP9W7Qk3xqHIv2uMhR877/sPJfAfgRnyrjySWePG8Rc2TYLlHZhBVPIjBe9d
L5AocTgQCpqunMIXUZzsf9ug6Gr6YAQfEE5QIKvw4hIn7gu04STlFM0H7+LhS1Vc
fD/oIE8ujkSyvAKb//lbP5jWjC/NFabvX1rOUgTCfYZIJSCWd5UysyqDV7AyoOkU
gzyY1XKF/eGSYrzReM6SAIZUKvVs0dCwjVozcqMmMK47YkORXrdc53xYdLX7pXP1
yRUPiJT/Jd+43FdEhUkKOWaSLfRhQHFy7lFDtslTsKboi5VArkc=
=0z0h
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, LaMont Jones <lamont@debian.org>`:

`Bug#1059230`; Package `src:postfix`.
(Thu, 28 Dec 2023 20:36:02 GMT) ([full text](bugreport.cgi?bug=1059230;msg=57), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=57), [link](#56)).

---

**Acknowledgement sent**
to `Scott Kitterman <debian@kitterman.com>`:

Extra info received and forwarded to list. Copy sent to `LaMont Jones <lamont@debian.org>`.
(Thu, 28 Dec 2023 20:36:02 GMT) ([full text](bugreport.cgi?bug=1059230;msg=59), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=59), [link](#58)).

---

[Message #60](#60) received at 1059230@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=60), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=60), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40kitterman.com)
From: Scott Kitterman <debian@kitterman.com>
To: debian-release@lists.debian.org
Cc: 1059230@bugs.debian.org
Subject: Proposed Postfix SUA Text
Date: Thu, 28 Dec 2023 15:31:55 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=1059230;msg=60) (text/plain, inline)]
```
```
Postfix is a High-performance mail transport agent.

Upstream published versions 3.5.23 and 3.7.9.

These are bug-fix releases. The changes are not currently required for
operation, but upstream strongly recommends that users update.

Changes since 3.5.18 and 3.7.6 currently in bullseye and bookworm include fixes
for multiple implementation defects identified since these packages were last
updated, see debian/changelog for details.  Of particular note is a new
optional feature to prevent 'SMTP Smuggling' attacks.  It is disabled by
default.  A configuration change is required to enable this protection [1].

If you use postfix, we recommend that you install this update.

[1] <https://www.postfix.org/smtp-smuggling.html>
```
```
[[signature.asc](bugreport.cgi?att=1;bug=1059230;filename=signature.asc;msg=60) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, LaMont Jones <lamont@debian.org>`:

`Bug#1059230`; Package `src:postfix`.
(Fri, 29 Dec 2023 11:33:02 GMT) ([full text](bugreport.cgi?bug=1059230;msg=62), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=62), [link](#61)).

---

**Acknowledgement sent**
to `Jonathan Wiltshire <jmw@debian.org>`:

Extra info received and forwarded to list. Copy sent to `LaMont Jones <lamont@debian.org>`.
(Fri, 29 Dec 2023 11:33:02 GMT) ([full text](bugreport.cgi?bug=1059230;msg=64), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=64), [link](#63)).

---

[Message #65](#65) received at 1059230@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=65), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=65), reply):

![](/cgi-bin/libravatar.cgi?email=jmw%40debian.org)
From: Jonathan Wiltshire <jmw@debian.org>
To: Scott Kitterman <debian@kitterman.com>, 1059230@bugs.debian.org
Subject: Re: Bug#1059230: Proposed Postfix SUA Text
Date: Fri, 29 Dec 2023 11:29:21 +0000
```
On Thu, Dec 28, 2023 at 03:31:55PM -0500, Scott Kitterman wrote:
> Postfix is a High-performance mail transport agent.
>
> Upstream published versions 3.5.23 and 3.7.9.
>
> These are bug-fix releases. The changes are not currently required for
> operation, but upstream strongly recommends that users update.
>
> Changes since 3.5.18 and 3.7.6 currently in bullseye and bookworm include fixes
> for multiple implementation defects identified since these packages were last
> updated, see debian/changelog for details.  Of particular note is a new
> optional feature to prevent 'SMTP Smuggling' attacks.  It is disabled by
> default.  A configuration change is required to enable this protection [1].
>
> If you use postfix, we recommend that you install this update.
>
> [1] <https://www.postfix.org/smtp-smuggling.html>

The important part is the CVE fix with config change requirement, no? How
about this, rephrasing to shift the emphasis:

| Postfix is a high-performance mail transport agent.
|
| This update consists of recommended upstream bug fixes since the versions
| in bullseye and bookworm. In particular, a fix for [CVE-2023-51764](https://security-tracker.debian.org/tracker/CVE-2023-51764) (SMTP
| smuggling) requires a configuration change to take full effect.
|
| The configuration change is not done automatically to avoid causing
| issues with existing installations. Users should consult the relevant
| Postfix documentation [1] before setting "smtpd_forbid_bare_newline = yes"
| in the main.cf file.
|
|  1: <https://www.postfix.org/smtp-smuggling.html>

If you are able to comment before 13:00 UTC I can get it out this
afternoon.

Thanks,

--
Jonathan Wiltshire                                      jmw@debian.org
Debian Developer                         <http://people.debian.org/~jmw>

4096R: 0xD3524C51 / 0A55 B7C5 1223 3942 86EC  74C3 5394 479D D352 4C51
ed25519/0x196418AAEB74C8A1: CA619D65A72A7BADFC96D280196418AAEB74C8A1

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, LaMont Jones <lamont@debian.org>`:

`Bug#1059230`; Package `src:postfix`.
(Fri, 29 Dec 2023 12:03:03 GMT) ([full text](bugreport.cgi?bug=1059230;msg=67), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=67), [link](#66)).

---

**Acknowledgement sent**
to `Scott Kitterman <debian@kitterman.com>`:

Extra info received and forwarded to list. Copy sent to `LaMont Jones <lamont@debian.org>`.
(Fri, 29 Dec 2023 12:03:03 GMT) ([full text](bugreport.cgi?bug=1059230;msg=69), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=69), [link](#68)).

---

[Message #70](#70) received at 1059230@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=70), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=70), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40kitterman.com)
From: Scott Kitterman <debian@kitterman.com>
To: Jonathan Wiltshire <jmw@debian.org>, 1059230@bugs.debian.org
Subject: Re: Bug#1059230: Proposed Postfix SUA Text
Date: Fri, 29 Dec 2023 11:59:19 +0000
```
Looks good to me.

Thanks,

Scott K

On December 29, 2023 11:29:21 AM UTC, Jonathan Wiltshire <jmw@debian.org> wrote:
>On Thu, Dec 28, 2023 at 03:31:55PM -0500, Scott Kitterman wrote:
>> Postfix is a High-performance mail transport agent.
>>
>> Upstream published versions 3.5.23 and 3.7.9.
>>
>> These are bug-fix releases. The changes are not currently required for
>> operation, but upstream strongly recommends that users update.
>>
>> Changes since 3.5.18 and 3.7.6 currently in bullseye and bookworm include fixes
>> for multiple implementation defects identified since these packages were last
>> updated, see debian/changelog for details.  Of particular note is a new
>> optional feature to prevent 'SMTP Smuggling' attacks.  It is disabled by
>> default.  A configuration change is required to enable this protection [1].
>>
>> If you use postfix, we recommend that you install this update.
>>
>> [1] <https://www.postfix.org/smtp-smuggling.html>
>
>The important part is the CVE fix with config change requirement, no? How
>about this, rephrasing to shift the emphasis:
>
>| Postfix is a high-performance mail transport agent.
>|
>| This update consists of recommended upstream bug fixes since the versions
>| in bullseye and bookworm. In particular, a fix for [CVE-2023-51764](https://security-tracker.debian.org/tracker/CVE-2023-51764) (SMTP
>| smuggling) requires a configuration change to take full effect.
>|
>| The configuration change is not done automatically to avoid causing
>| issues with existing installations. Users should consult the relevant
>| Postfix documentation [1] before setting "smtpd_forbid_bare_newline = yes"
>| in the main.cf file.
>|
>|  1: <https://www.postfix.org/smtp-smuggling.html>
>
>If you are able to comment before 13:00 UTC I can get it out this
>afternoon.
>
>Thanks,
>
>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, LaMont Jones <lamont@debian.org>`:

`Bug#1059230`; Package `src:postfix`.
(Fri, 29 Dec 2023 20:48:02 GMT) ([full text](bugreport.cgi?bug=1059230;msg=72), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=72), [link](#71)).

---

**Acknowledgement sent**
to `Scott Kitterman <debian@kitterman.com>`:

Extra info received and forwarded to list. Copy sent to `LaMont Jones <lamont@debian.org>`.
(Fri, 29 Dec 2023 20:48:02 GMT) ([full text](bugreport.cgi?bug=1059230;msg=74), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=74), [link](#73)).

---

[Message #75](#75) received at 1059230@bugs.debian.org ([full text](bugreport.cgi?bug=1059230;msg=75), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=75), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40kitterman.com)
From: Scott Kitterman <debian@kitterman.com>
To: 1059230@bugs.debian.org
Subject: Stable Updates Available
Date: Fri, 29 Dec 2023 15:45:07 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=1059230;msg=75) (text/plain, inline)]
```
```
Updated packages are available from stable/oldstable-updates.

Scott K
```
```
[[signature.asc](bugreport.cgi?att=1;bug=1059230;filename=signature.asc;msg=75) (application/pgp-signature, inline)]
```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 27 Jan 2024 07:26:29 GMT) ([full text](bugreport.cgi?bug=1059230;msg=77), [mbox](bugreport.cgi?bug=1059230;mbox=yes;msg=77), [link](#76)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=1059230).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Wed Jan 15 11:46:08 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from github.com_9abf8679_20250115_114604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feeenvik1%2FCVE-2023-51764%2Fblob%2Fmain%2FScreenshots%2FScreenshot_4.png)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feeenvik1%2FCVE-2023-51764%2Fblob%2Fmain%2FScreenshots%2FScreenshot_4.png)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=eeenvik1%2FCVE-2023-51764)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eeenvik1](/eeenvik1)
/
**[CVE-2023-51764](/eeenvik1/CVE-2023-51764)**
Public

* [Notifications](/login?return_to=%2Feeenvik1%2FCVE-2023-51764) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Feeenvik1%2FCVE-2023-51764)
* [Star
   4](/login?return_to=%2Feeenvik1%2FCVE-2023-51764)

* [Code](/eeenvik1/CVE-2023-51764)
* [Issues
  0](/eeenvik1/CVE-2023-51764/issues)
* [Pull requests
  0](/eeenvik1/CVE-2023-51764/pulls)
* [Actions](/eeenvik1/CVE-2023-51764/actions)
* [Projects
  0](/eeenvik1/CVE-2023-51764/projects)
* [Security](/eeenvik1/CVE-2023-51764/security)
* [Insights](/eeenvik1/CVE-2023-51764/pulse)

Additional navigation options

* [Code](/eeenvik1/CVE-2023-51764)
* [Issues](/eeenvik1/CVE-2023-51764/issues)
* [Pull requests](/eeenvik1/CVE-2023-51764/pulls)
* [Actions](/eeenvik1/CVE-2023-51764/actions)
* [Projects](/eeenvik1/CVE-2023-51764/projects)
* [Security](/eeenvik1/CVE-2023-51764/security)
* [Insights](/eeenvik1/CVE-2023-51764/pulse)

## Files

 main
## Breadcrumbs

1. [CVE-2023-51764](/eeenvik1/CVE-2023-51764/tree/main)
2. /[Screenshots](/eeenvik1/CVE-2023-51764/tree/main/Screenshots)
/
# Screenshot\_4.png

Copy path
## Latest commit

## History

[History](/eeenvik1/CVE-2023-51764/commits/main/Screenshots/Screenshot_4.png)108 KB main
## Breadcrumbs

1. [CVE-2023-51764](/eeenvik1/CVE-2023-51764/tree/main)
2. /[Screenshots](/eeenvik1/CVE-2023-51764/tree/main/Screenshots)
/
# Screenshot\_4.png

Top
## File metadata and controls

108 KB![Screenshot_4.png](https://github.com/eeenvik1/CVE-2023-51764/blob/main/Screenshots/Screenshot_4.png?raw=true)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7849587e_20250114_192946.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fduy-31%2FCVE-2023-51764)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fduy-31%2FCVE-2023-51764)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=duy-31%2FCVE-2023-51764)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[duy-31](/duy-31)
/
**[CVE-2023-51764](/duy-31/CVE-2023-51764)**
Public

* [Notifications](/login?return_to=%2Fduy-31%2FCVE-2023-51764) You must be signed in to change notification settings
* [Fork
  12](/login?return_to=%2Fduy-31%2FCVE-2023-51764)
* [Star
   26](/login?return_to=%2Fduy-31%2FCVE-2023-51764)

Postfix SMTP Smuggling - Expect Script POC

[26
stars](/duy-31/CVE-2023-51764/stargazers) [12
forks](/duy-31/CVE-2023-51764/forks) [Branches](/duy-31/CVE-2023-51764/branches) [Tags](/duy-31/CVE-2023-51764/tags) [Activity](/duy-31/CVE-2023-51764/activity)
 [Star](/login?return_to=%2Fduy-31%2FCVE-2023-51764)

 [Notifications](/login?return_to=%2Fduy-31%2FCVE-2023-51764) You must be signed in to change notification settings

* [Code](/duy-31/CVE-2023-51764)
* [Issues
  1](/duy-31/CVE-2023-51764/issues)
* [Pull requests
  0](/duy-31/CVE-2023-51764/pulls)
* [Actions](/duy-31/CVE-2023-51764/actions)
* [Projects
  0](/duy-31/CVE-2023-51764/projects)
* [Security](/duy-31/CVE-2023-51764/security)
* [Insights](/duy-31/CVE-2023-51764/pulse)

Additional navigation options

* [Code](/duy-31/CVE-2023-51764)
* [Issues](/duy-31/CVE-2023-51764/issues)
* [Pull requests](/duy-31/CVE-2023-51764/pulls)
* [Actions](/duy-31/CVE-2023-51764/actions)
* [Projects](/duy-31/CVE-2023-51764/projects)
* [Security](/duy-31/CVE-2023-51764/security)
* [Insights](/duy-31/CVE-2023-51764/pulse)

# duy-31/CVE-2023-51764

    main[Branches](/duy-31/CVE-2023-51764/branches)[Tags](/duy-31/CVE-2023-51764/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[15 Commits](/duy-31/CVE-2023-51764/commits/main/) | | |
| [README.md](/duy-31/CVE-2023-51764/blob/main/README.md "README.md") | | [README.md](/duy-31/CVE-2023-51764/blob/main/README.md "README.md") |  |  |
| [cve-2023-51764.sh](/duy-31/CVE-2023-51764/blob/main/cve-2023-51764.sh "cve-2023-51764.sh") | | [cve-2023-51764.sh](/duy-31/CVE-2023-51764/blob/main/cve-2023-51764.sh "cve-2023-51764.sh") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2023-51764

Postfix SMTP Smuggling - Expect Script POC

send an email that is legitimate, but inside the email there is many others emails (different senders, recipients, subjet, etc).
The initial email is check for SPF/DKIM/DMARC, the others inside are not !

usage: ./cve-2023-51764.sh mx.fqdn port

./cve-2023-51764.sh mail.mydomain.com 25

[![image](https://private-user-images.githubusercontent.com/20819326/292914501-e6a0175f-b5ed-4022-aa06-386599984df3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODMyODUsIm5iZiI6MTczNjg4Mjk4NSwicGF0aCI6Ii8yMDgxOTMyNi8yOTI5MTQ1MDEtZTZhMDE3NWYtYjVlZC00MDIyLWFhMDYtMzg2NTk5OTg0ZGYzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDE5Mjk0NVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTcxY2RhMWRhOTgxZTBiMDYxODk4ZjZiOWU0NWFhNzNiZDU5NjljNTk2NDIxYjMzY2RjMjhjYjljZjk1MmUxOWMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ol3UtXM4DjBc3bMdh3W1-pBVcbBNLNmHAeb1cI-_AYE)](https://private-user-images.githubusercontent.com/20819326/292914501-e6a0175f-b5ed-4022-aa06-386599984df3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODMyODUsIm5iZiI6MTczNjg4Mjk4NSwicGF0aCI6Ii8yMDgxOTMyNi8yOTI5MTQ1MDEtZTZhMDE3NWYtYjVlZC00MDIyLWFhMDYtMzg2NTk5OTg0ZGYzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDE5Mjk0NVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTcxY2RhMWRhOTgxZTBiMDYxODk4ZjZiOWU0NWFhNzNiZDU5NjljNTk2NDIxYjMzY2RjMjhjYjljZjk1MmUxOWMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ol3UtXM4DjBc3bMdh3W1-pBVcbBNLNmHAeb1cI-_AYE)

notes:
chmod +x cve-2023-51764.sh

 require app expect

 require legitimate ip sender and email sender (to pass SPF, DKIM, DMARC)

result:

[![image](https://private-user-images.githubusercontent.com/20819326/292914701-82d31732-8548-493c-98e8-28cadc571107.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODMyODUsIm5iZiI6MTczNjg4Mjk4NSwicGF0aCI6Ii8yMDgxOTMyNi8yOTI5MTQ3MDEtODJkMzE3MzItODU0OC00OTNjLTk4ZTgtMjhjYWRjNTcxMTA3LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDE5Mjk0NVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU4ODlmNWQ1MGI5MGVhYTg5NWQ1YjQ5MTUyMWJhMzA3MmYxYzM1NTE0ZDNhMjVkNzBjYTU4MGRhM2ZhZGI0MDgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.rWkVmv6zW051g36Yp29yZpAugGegouUXeyGwtw13-Nc)](https://private-user-images.githubusercontent.com/20819326/292914701-82d31732-8548-493c-98e8-28cadc571107.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODMyODUsIm5iZiI6MTczNjg4Mjk4NSwicGF0aCI6Ii8yMDgxOTMyNi8yOTI5MTQ3MDEtODJkMzE3MzItODU0OC00OTNjLTk4ZTgtMjhjYWRjNTcxMTA3LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDE5Mjk0NVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU4ODlmNWQ1MGI5MGVhYTg5NWQ1YjQ5MTUyMWJhMzA3MmYxYzM1NTE0ZDNhMjVkNzBjYTU4MGRhM2ZhZGI0MDgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.rWkVmv6zW051g36Yp29yZpAugGegouUXeyGwtw13-Nc)

---

Kudos: <https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide>

Workaround/Fix: <https://www.postfix.org/smtp-smuggling.html>

---

more about me ;) <https://www.linkedin.com/in/duy-huan-bui/>

⚠️ Disclaimer:
IMPORTANT: This script is provided for educational, ethical testing, and lawful use ONLY. Do not use it on any system or network without explicit permission. Unauthorized access to computer systems and networks is illegal, and users caught performing unauthorized activities are subject to legal actions. The author is NOT responsible for any damage caused by the misuse of this script.

## About

Postfix SMTP Smuggling - Expect Script POC

### Resources

[Readme](#readme-ov-file)

[Activity](/duy-31/CVE-2023-51764/activity)
### Stars

[**26**
stars](/duy-31/CVE-2023-51764/stargazers)
### Watchers

[**2**
watching](/duy-31/CVE-2023-51764/watchers)
### Forks

[**12**
forks](/duy-31/CVE-2023-51764/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fduy-31%2FCVE-2023-51764&report=duy-31+%28user%29)

## [Releases](/duy-31/CVE-2023-51764/releases)

No releases published

## [Packages 0](/users/duy-31/packages?repo_name=CVE-2023-51764)

No packages published

## Languages

* [Shell
  100.0%](/duy-31/CVE-2023-51764/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_5c1b2009_20250114_192943.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2024/05/02/6) [[thread-next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ZjuTvJ5sifwGhs2q@moon>
Date: Wed, 8 May 2024 10:01:16 -0500
From: Mark Esler <mark.esler@...onical.com>
To: oss-security@...ts.openwall.com
Subject: Re: New SMTP smuggling attack

On 4/30/24 14:13, nightmare.yeah27@...ecat.org wrote:
> What is the benefit of stripping versus the much more natural option
> of rejecting such messages?

This applies to <CRLF>.<CRLF> and RFC 5321 section 4.5.2 as well.

Postfix' CVE-2023-51764 patchset adds options to normalize (default),
note, reject, or ignore bare newlines:
```
cleanup_replace_stray_cr_lf = default:yes
smtpd_forbid_bare_newline = default:normalize
smtpd_forbid_bare_newline_exclusions = default:$mynetworks
```
(See Postfix' HISTORY file for more context.)

To get back to your question, these all have usecases. What should be the
default is described in RFC 5321. Offering options and using the RFCs sane
default seems like a fair balance.

On 4/30/24 14:42, Erik Auerswald wrote:
> Well, my reading of the RFC does not forbid this sequence.  RFC 5321
> clearly does not require transforming this sequence into another sequence.

I should have initially clarified that _"forbidden" pattern_ refers to RFC
5321 section 4.5.2:

   Without some provision for data transparency, the character sequence
   "<CRLF>.<CRLF>" ends the mail text and cannot be sent by the user.
   In general, users are not aware of such "forbidden" sequences.  To
   allow all user composed text to be transmitted transparently, the
   following procedures are used:

   o  Before sending a line of mail text, the SMTP client checks the
      first character of the line.  If it is a period, one additional
      period is inserted at the beginning of the line.

   o  When a line of mail text is received by the SMTP server, it checks
      the line.  If the line is composed of a single period, it is
      treated as the end of mail indicator.  If the first character is a
      period and there are other characters on the line, the first
      character is deleted.

I believe "<CRLF><NUL>.<CRLF>" is a forbidden sequence. Resnick's response
to this sequence is:
  "Yes, the sending MTA should strip the NUL (as per RFC 5321 section
  4.1.1.4) and then dot-stuff the dot on the line by itself (as per RFC 5321
  section 4.5.2)."

> You to seem to advocate for "repair".  The "repair" strategy makes Cisco's
> ESA vulnerable.  I would argue that rejecting messages is less insecure.

By default, Cisco ESA is not RFC compliant. Their "clean" option only
replaces bare <CR> and <LF> characters with <CRLF>. So that <CR>.<CR>
becomes <CRLF>.<CRLF>. Both of these are "forbidden" patterns and should
be dot stuffed.

On 4/30/24 17:48, Steffen Nurpmeso wrote:
> Given that RFC 733 is from 1977 and RFC 822 is from 1982 i feel
> this entire thread is exaggerating.

The history of EOD attacks makes the recent SMTP Smuggling attacks so
surprising! It is hard to believe that SMTP servers were recently vulnerable
to <CRLF>.<CRLF> variations and that others still are.

Thanks Solar :)

Mark Esler and Bastien Roucariès

Download attachment "[signature.asc](3/1)" of type "application/pgp-signature" (834 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.redhat.com_5e3d9954_20250114_192945.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2255563)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2255563)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2255563)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 2255563

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 2255563**](show_bug.cgi?id=2255563)
(CVE-2023-51764)
- [CVE-2023-51764](https://access.redhat.com/security/cve/CVE-2023-51764) postfix: SMTP smuggling vulnerability

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2023-51764 postfix: SMTP smuggling vulnerability

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | NEW | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2023-51764 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2255565](show_bug.cgi?id=2255565 "CLOSED ERRATA - TRIAGE postfix: sendmail and postfix: SMTP smuggling vulnerability [fedora-all]") [2255566](show_bug.cgi?id=2255566 "CLOSED DUPLICATE - TRIAGE sendmail: sendmail and postfix: SMTP smuggling vulnerability [fedora-all]") [2255870](show_bug.cgi?id=2255870 "CLOSED RAWHIDE - TRIAGE CVE-2023-51765 sendmail: SMTP smuggling vulnerability [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [2255562](show_bug.cgi?id=2255562) | | TreeView+ | [depends on](buglist.cgi?bug_id=2255563&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2255563&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2023-12-21 21:58 UTC by Robb Gatica | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2024-11-12 09:08 UTC ([History](show_activity.cgi?id=2255563)) | | [CC List:](page.cgi?id=fields.html#cclist) | 6 users (show)  geert jskarvad kyoneyam pasik solar stefano.biagiotti | | Fixed In Version: | postfix 3.8.4, postfix 3.7.9, postfix 3.6.13, postfix 3.5.23 | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A flaw was found in some SMTP server configurations in Postfix. This flaw allows a remote attacker to break out email message data to "smuggle" SMTP commands and send spoofed emails that pass SPF checks. Out of the box, Postfix targets to accommodate older clients with faulty SMTP implementations due to which restrictions are not enforced in the default configuration. Appropriate mitigation strategies are mentioned in the appropriate section below. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2024:9243](https://access.redhat.com/errata/RHSA-2024%3A9243) | 0 | None | None | None | 2024-11-12 09:08:21 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2255563#c0)  Robb Gatica    2023-12-21 21:58:42 UTC  ``` Summary: Depending on how SMTP servers/software are configured to interpret the end-of-data sequence (e.g., <CR><LF>.<CR><LF>), an attacker can break out of the message data to "smuggle" SMTP commands to send spoofed emails that pass SPF checks.   Description: By exploiting interpretation differences of the SMTP protocol, it is possible to smuggle/send spoofed e-mails - hence SMTP smuggling - while still passing SPF alignment checks. During this research, two types of SMTP smuggling, outbound and inbound, were discovered. These allowed sending spoofed e-mails from millions of domains (e.g., admin[@]outlook.com) to millions of receiving SMTP servers (e.g., Amazon, PayPal, eBay). Identified vulnerabilities in Microsoft and GMX were quickly fixed, however, SEC Consult urges companies using the also affected Cisco Secure Email product to manually update their vulnerable default configuration.   References: <https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/> [https://www.mail-archive.com/postfix-users@postfix.org/msg100901.html](https://www.mail-archive.com/postfix-users%40postfix.org/msg100901.html) <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1059230>   ```  [Comment 1](show_bug.cgi?id=2255563#c1)  Robb Gatica    2023-12-21 22:18:41 UTC  ``` Mitigations per Postfix:  -----  As part of a non-responsible disclosure process, SEC Consult has published an email spoofing attack that involves a composition of different mail service behaviors with respect to broken line endings.   A short-term fix may deployed now, before the upcoming long holiday:  - Postfix 3.9 (stable release early 2024), rejects unuthorised   pipelining by default: "smtpd_forbid_unauth_pipelining = yes".  - Postfix 3.8.1, 3.7.6, 3.6.10 and 3.5.20 include the same feature,   but the "smtpd_forbid_unauth_pipelining" parameter defaults to   "no".  Setting "smtpd_forbid_unauth_pipelining = yes" may break legitimate SMTP clients that mis-implement SMTP, but such clients are exceedingly rare, especially when email is sent across the Internet.  This short-term fix will stop the published form of the attack, but other forms exist that will not be stopped in this manner.  The longer-term fix stops all forms of the smuggling attacks and is in testing. For most sites, this fix will be too late for deployment before a long holiday break, when typically production changes are not allowed until January.   ```  [Comment 2](show_bug.cgi?id=2255563#c2)  Robb Gatica    2023-12-21 22:21:00 UTC  ``` Mitigations for Sendmail, per OSS thread:  -----  sendmail 8.18.0.2 has options to handle this too, e.g., Accept only CR LF . CR LF as end of an SMTP message as required by the RFCs when the new srv_features option 'o' is used.  And for those who read the source code there's also an FFR: 	/* enable checking for "bare LF" in message */ 	"_FFR_BARE_LF",   ```  [Comment 3](show_bug.cgi?id=2255563#c3)  Robb Gatica    2023-12-21 22:22:02 UTC  ``` Created postfix tracking bugs for this issue:  Affects: fedora-all [[bug 2255565](show_bug.cgi?id=2255565 "CLOSED ERRATA - TRIAGE postfix: sendmail and postfix: SMTP smuggling vulnerability [fedora-all]")]   Created sendmail tracking bugs for this issue:  Affects: fedora-all [[bug 2255566](show_bug.cgi?id=2255566 "CLOSED DUPLICATE - TRIAGE sendmail: sendmail and postfix: SMTP smuggling vulnerability [fedora-all]")]   ```  [Comment 5](show_bug.cgi?id=2255563#c5)  pgnd    2023-12-22 17:45:57 UTC  ``` fyi, postfix 3.8.4, is out today, with fix that addresses the Smuggling Vulnerability,  From: postfix-announce Sent:  at Friday, Dec 22, 2023, 11:30 AM EST To: postfix-announce Cc: postfix-users Subject: [pfx-ann] Postfix stable release 3.8.4  > [An on-line version of this announcement will be available at <https://www.postfix.org/announcements/postfix-3.8.4.html>] >  > Fixed with Postfix 3.8.4: >  >    * Security: this release adds support to defend >      against an email spoofing attack (SMTP smuggling) on >      recipients at a Postfix server. For background, see >      <https://www.postfix.org/smtp-smuggling.html>. >  >      Sites concerned about SMTP smuggling attacks should enable this >      feature on Internet-facing Postfix servers. For compatibility >      with non-standard clients, Postfix by default excludes clients >      in mynetworks from this countermeasure. >  >      The recommended settings are: >  > 	# Optionally disconnect remote SMTP clients that send bare newlines, > 	# but allow local clients with non-standard SMTP implementations > 	# such as netcat, fax machines, or load balancer health checks. > 	# > 	smtpd_forbid_bare_newline = yes > 	smtpd_forbid_bare_newline_exclusions = $mynetworks >  >      The smtpd_forbid_bare_newline feature is disabled by default.   NOTE also that 3.9.x is planned for a "soon" release ...   ```  [Comment 7](show_bug.cgi?id=2255563#c7)  Geert Hendrickx    2024-01-10 15:25:00 UTC  ``` Postfix 3.8.5 (and patches for older supported releases as well) will come out soon, improving the solutions already implemented in 3.8.4.  Postfix 3.9 will contain the same solutions, with the only difference that in 3.9 they will be enabled by default.   ```  [Comment 8](show_bug.cgi?id=2255563#c8)  Alexander Peslyak    2024-01-17 16:16:25 UTC  ``` <https://access.redhat.com/security/cve/CVE-2023-51764> links to this bug, so I hope this is an appropriate place to report issues with that documentation page. As noted by e​lectronic_eel on #rocky-security Rocky Linux security channel, that page currently gives a mitigation that does not actually work on any RHEL distro. Specifically, it says: "The suggested mitigation involves rejecting unauthorized pipelining by default using the configuration option smtpd_forbid_unauth_pipelining = yes." It also says that none of RHEL6 to 9 will be fixed. However, even RHEL9's Postfix is too old to support the smtpd_forbid_unauth_pipelining option. Instead, the syntax that's supposed to work on the older Postfix in those distros is the other one also given at <https://www.postfix.org/smtp-smuggling.html>:  > With all Postfix versions: >  > main.cf: >     smtpd_data_restrictions = reject_unauth_pipelining >     smtpd_discard_ehlo_keywords = chunking, silent-discard  I have not actually tested it, but I confirmed that "reject_unauth_pipelining" is found in the source tree that's used on RHEL9, unlike "smtpd_forbid_unauth_pipelining".  I see there are few people (and only one from Red Hat?) CC'ed on this bug, but it's assigned to Product Security, so hopefully me posting this will reach the right people to fix the security documentation. However, since I am not sure, please reply and confirm that this has been received by someone who can act on it. Thanks!   ```  [Comment 9](show_bug.cgi?id=2255563#c9)  errata-xmlrpc    2024-11-12 09:08:20 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 9  Via RHSA-2024:9243 [https://access.redhat.com/errata/RHSA-2024:9243](https://access.redhat.com/errata/RHSA-2024%3A9243)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2255563&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.mail-archive.com_e797cd5e_20250115_114614.html ===


[Skip to site navigation (Press enter)](#nav)

# [[pfx] SMTP Smuggling short & long term fixes](/search?l=postfix-users@postfix.org&q=subject:%22%5C%5Bpfx%5C%5D+SMTP+Smuggling+short+%5C%26+long+term+fixes%22&o=newest)

[Wietse Venema via Postfix-users](/search?l=postfix-users@postfix.org&q=from:%22Wietse+Venema+via+Postfix%5C-users%22)
[Wed, 20 Dec 2023 07:51:52 -0800](/search?l=postfix-users@postfix.org&q=date:20231220)

```
As part of a non-responsible disclosure process, SEC Consult has
published an email spoofing attack that involves a composition of
different mail service behaviors with respect to broken line endings.
```
```

A short-term fix may deployed now, before the upcoming long holiday:

- Postfix 3.9 (stable release early 2024), rejects unuthorised
  pipelining by default: "smtpd_forbid_unauth_pipelining = yes".

- Postfix 3.8.1, 3.7.6, 3.6.10 and 3.5.20 include the same feature,
  but the "smtpd_forbid_unauth_pipelining" parameter defaults to
  "no".

Setting "smtpd_forbid_unauth_pipelining = yes" may break legitimate
SMTP clients that mis-implement SMTP, but such clients are exceedingly
rare, especially when email is sent across the Internet.

This short-term fix will stop the published form of the attack, but
other forms exist that will not be stopped in this manner.

The longer-term fix stops all forms of the smuggling attacks and is
in testing. For most sites, this fix will be too late for deployment
before a long holiday break, when typically production changes are
not allowed until January.

Timeline:
Dec 18 SEC Consult publishes an attack (composition of mail service behaviors)
Dec 19 Implement fix for Postfix, start testing and Q/A
Dec ?? Publish updated stable Postfix versions 3.8, 3.7, 3.6, 3.5
Dec 23 First day of a 10+ day holiday break and production freeze

References:
<https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/>

        Wietse
_______________________________________________
Postfix-users mailing list -- postfix-users@postfix.org
To unsubscribe send an email to postfix-users-le...@postfix.org

```

* [Previous message](msg100882.html)
* [View by thread](index.html#100901)
* [View by date](maillist.html#100901)
* [Next message](msg100903.html)

* [pfx] SMTP Smuggling short & long te... Wietse Venema via Postfix-users
* + [[pfx] Re: SMTP Smuggling short &amp...](msg100903.html) Linkcheck via Postfix-users
  + - [[pfx] Re: SMTP Smuggling short ...](msg100904.html) Wietse Venema via Postfix-users
    - * [[pfx] Re: SMTP Smuggling sh...](msg100905.html) Linkcheck via Postfix-users
    - [[pfx] Re: SMTP Smuggling short ...](msg100906.html) Linkcheck via Postfix-users
  + [[pfx] Re: SMTP Smuggling short &amp...](msg100916.html) Wietse Venema via Postfix-users
  + - [[pfx] Re: SMTP Smuggling short ...](msg100917.html) Viktor Dukhovni via Postfix-users

## Reply via email to

[![The Mail Archive](/logo.png)](/)

Search the site

* [The Mail Archive home](/)
* [postfix-users - all messages](/postfix-users%40postfix.org/)
* [postfix-users - about the list](/postfix-users%40postfix.org/info.html)
* [Expand](/search?l=postfix-users@postfix.org&q=subject:%22%5C%5Bpfx%5C%5D+SMTP+Smuggling+short+%5C%26+long+term+fixes%22&o=newest&f=1 "e")
* [Previous message](msg100882.html "p")
* [Next message](msg100903.html "n")

* [The Mail Archive home](/)
* [Add your mailing list](/faq.html#newlist)
* [FAQ](/faq.html)
* [Support](/faq.html#support)
* [Privacy](/faq.html#privacy)
* 4SwJ2F5sJXzJrP1@spike.porcupine.org



=== Content from www.openwall.com_56a99a57_20250114_192942.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2023/12/23/5) [[next>]](2) [[<thread-prev]](../../../2023/12/23/2) [[thread-next>]](../../../2023/12/25/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20231224093335.GM14101@suse.de>
Date: Sun, 24 Dec 2023 10:33:37 +0100
From: Marcus Meissner <meissner@...e.de>
To: oss-security@...ts.openwall.com
Subject: Re: Re: New SMTP smuggling attack

On Sat, Dec 23, 2023 at 02:29:34PM +0200, Valtteri Vuorikoski wrote:
> On Fri, Dec 22, 2023 at 11:46:48AM +0100, Marcus Meissner wrote:
> > Hi,
> >
> > FWIW as no CVEs were to be found yet, I filed a CVE request for Postfix now.
> >
> > Not sure if we need it for others like sendmail too, as that is also
> > referenced by the security researchers.
>
> Looks like exim opened a bug on this yesterday too, no sign of CVE yet:
> <<https://bugs.exim.org/show_bug.cgi?id=3063>>

CVEs are assigned now for:

- CVE-2023-51764 postfix
- CVE-2023-51765 sendmail
- CVE-2023-51766 exim

Ciao, Marcus

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from access.redhat.com_7beed953_20250115_114611.html ===

[Skip to main content](#rh-login-card)
![Red Hat logo](/auth/resources/wi6vu/login/rhd-theme/img/RHLogo_white.svg)

All Red Hat

[Register](/auth/realms/redhat-external/login-actions/registration?client_id=unified-downloads&tab_id=LeJqUZfkJ0c&client_data=eyJydSI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZG93bmxvYWRzL3NhbWwvZmluYWxpemUiLCJybSI6InBvc3QiLCJzdCI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZXJyYXRhL1JIU0EtMjAyNCUzQTkyNDMifQ)

# Log in to your Red Hat account

#### Danger alert:

#### Log in attempt timed out

Resubmit your information.

 Red Hat login or email

Next

 Red Hat login or email

Log in with company single sign-on

Log in with Red Hat account

 Red Hat login or email

Password

Log in

[Register for a Red Hat account](/auth/realms/redhat-external/login-actions/registration?client_id=unified-downloads&tab_id=LeJqUZfkJ0c&client_data=eyJydSI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZG93bmxvYWRzL3NhbWwvZmluYWxpemUiLCJybSI6InBvc3QiLCJzdCI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZXJyYXRhL1JIU0EtMjAyNCUzQTkyNDMifQ)

[Forgot your password?](/auth/realms/redhat-external/login-actions/reset-credentials?client_id=unified-downloads&tab_id=LeJqUZfkJ0c&client_data=eyJydSI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZG93bmxvYWRzL3NhbWwvZmluYWxpemUiLCJybSI6InBvc3QiLCJzdCI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZXJyYXRhL1JIU0EtMjAyNCUzQTkyNDMifQ)

### Why create an account?

* ![](/auth/resources/wi6vu/login/rhd-theme/img/pricetag.png)

  #### Product trials

  Try our products hands-on to see if they’ll work for you.
* ![](/auth/resources/wi6vu/login/rhd-theme/img/book.png)

  #### Learning resources

  Get training and learning tools to help you use our products.
* ![](/auth/resources/wi6vu/login/rhd-theme/img/support.png)

  #### World-class support

  Rely on our trusted customer support and partner enablement.

A subscription may be required for some services.

[![Red Hat logo](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[LinkedIn](https://www.linkedin.com/company/red-hat)
[YouTube](https://www.youtube.com/user/RedHatVideos)
[Facebook](https://www.facebook.com/redhatinc)
[X/Twitter](https://twitter.com/RedHat)
### Products

* [Red Hat Enterprise Linux](https://redhat.com/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShift](https://redhat.com/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation Platform](https://redhat.com/en/technologies/management/ansible)
* [Cloud services](https://redhat.com/en/technologies/cloud-computing/openshift/cloud-services)
* [See all products](https://redhat.com/en/technologies/all-products)

### Tools

* [My account](https://sso.redhat.com)
* [Training and certification](https://redhat.com/en/services/training-and-certification)
* [Customer support](https://access.redhat.com)
* [Developer resources](https://developers.redhat.com/)
* [Learning community](https://learn.redhat.com/)
* [Partner resources](https://connect.redhat.com/)
* [Resource library](https://redhat.com/en/resources)

### Try, buy & sell

* [Product trial center](https://redhat.com/en/products/trials)
* [Red Hat Marketplace](https://marketplace.redhat.com)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Find a partner](http://redhat.force.com/finder/)
* [Red Hat Store](https://www.redhat.com/en/store)
* [Console](https://cloud.redhat.com/)

### Communicate

* [Contact consulting](https://redhat.com/en/services/consulting-overview#contact-us)
* [Contact sales](https://redhat.com/en/contact)
* [Contact training](https://redhat.com/en/services/training-and-certification/contact-us)
* [Social](https://redhat.com/en/about/social)

### About Red Hat

We’re the world’s leading provider of enterprise open source solutions—including Linux, cloud, container, and Kubernetes. We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.

### Subscribe to our newsletter, Red Hat Shares

[Sign up now](https://www.redhat.com/en/email-preferences?newsletter=RH-Shares&intcmp=7016000000154xCAAQ)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

©  Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from lists.debian.org_c906a09f_20250114_192947.html ===


---

[[Date Prev](msg00019.html)][[Date Next](msg00021.html)]
[[Thread Prev](msg00019.html)][[Thread Next](msg00021.html)]
[[Date Index](maillist.html#00020)]
[[Thread Index](threads.html#00020)]

# [SECURITY] [DLA 3725-1] postfix security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3725-1] postfix security update
* *From*: rouca@debian.org
* *Date*: Tue, 30 Jan 2024 12:49:15 +0000
* *Message-id*: <[[🔎]](/msgid-search/aab61417bfdac2d51154f2d9e7dc31d0.rouca%40debian.org) [aab61417bfdac2d51154f2d9e7dc31d0.rouca@debian.org](msg00020.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3725-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                   Bastien RoucariÃ¨s
January 30, 2024                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : postfix
Version        : 3.4.23-0+deb10u2
CVE ID         : CVE-2023-51764
Debian Bug     : 1059230

Postfix, a popular mail server,
allowed SMTP smuggling unless configured with
smtpd_data_restrictions=reject_unauth_pipelining
and smtpd_discard_ehlo_keywords=chunking
(or certain other options that exist in recent versions).

Remote attackers can use a published exploitation technique to
inject e-mail messages with a spoofed MAIL FROM address,
allowing bypass of an SPF protection mechanism.

This occurs because Postfix supported <LF>.<CR><LF> but
some other popular e-mail servers do not.

To prevent attack variants (by always disallowing <LF> without <CR>),
a different solution is required, such as setting the backported
configuration option smtpd_forbid_bare_newline=yes

For Debian 10 buster, this problem has been fixed in version
3.4.23-0+deb10u2.

We recommend that you upgrade your postfix packages.

For the detailed security status of postfix please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/postfix>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEXQGHuUCiRbrXsPVqADoaLapBCF8FAmW48EoACgkQADoaLapB
CF+LQhAAil34Nfsl3v9k4z7/1fAyRbxU6og2+h/h3swadjcwk/LSyiGK9aRtMmS7
nyced5A0sxaVM/CGXfyYN8TIa5lxJaH3nrBhz6mfQzHIT0VJ2+2a/lnKDdE3lmEK
wgmh1gaZQ6BnDXlHzptdUtGx8UBi3Ypux++tppw649rJyk+PpvO2qz/Ri19Guqc3
ieZGCPgeQ1BWjQl89K/uREu9eArRcYmIvsfCpgbT0WxtgxygDXdCt1SC1RAAM5Pp
kOluJ1+OC0QTevx+AxMrnO+3RtsHht1MZm5UNk/ivOLfWSrNOK38issrTueYhFAI
XDZM47sd2KpMWqK+yFBNmi0GPY0AHWILzR5HvqVYXkpaJ1dLeiH+IgWxLEBX+zXd
dtmYirBB8vi2ZBOYudNpH9N3WjzRBpGelmW/ursQWKOVvGH0U6mury8l5iH2Zs2n
t1q9w9afN0CREg+sfviqScWVYClATNZ3o5+S6Lxa8nfE0GyxJfSEgaVm6LTuJnrf
nWYQ8cw1dlE9TRZdWPc7lCtiYdr0zr7/cpPWMbDNc4H/UFSrQqgmpR2dS0ZjELF1
LR0j8+i9/7x3w4C5v4nxZC/lLYpsnkhrwucE6olANUJcbadRwA0b2NDG/ADSQqIp
lP4z1J1/O4MEAAlNooUdCzwhla+GCLgoPZUfTga03lKTrl0mM5w=
=3Tgx
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_878de5d9_20250114_192942.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2023/12/24/2) [[next>]](2) [[<thread-prev]](../../../2023/12/24/1) [[thread-next>]](../../../2023/12/26/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <32345105-4692-465c-9a1d-e668c23df18d@hostland.ru>
Date: Mon, 25 Dec 2023 21:27:37 +0300
From: kai <kai@...tland.ru>
To: oss-security@...ts.openwall.com
Subject: Re: Re: New SMTP smuggling attack

Happy christmas list!

If anyone needs patch for postfix's 3.3.0-1ubuntu0.4
smtpd_forbid_bare_newline feature it has been attached to this message

On 24/12/2023 12.33, Marcus Meissner wrote:
> On Sat, Dec 23, 2023 at 02:29:34PM +0200, Valtteri Vuorikoski wrote:
>> On Fri, Dec 22, 2023 at 11:46:48AM +0100, Marcus Meissner wrote:
>>> Hi,
>>>
>>> FWIW as no CVEs were to be found yet, I filed a CVE request for Postfix now.
>>>
>>> Not sure if we need it for others like sendmail too, as that is also
>>> referenced by the security researchers.
>> Looks like exim opened a bug on this yesterday too, no sign of CVE yet:
>> <<https://bugs.exim.org/show_bug.cgi?id=3063>>
> CVEs are assigned now for:
>
> - CVE-2023-51764 postfix
> - CVE-2023-51765 sendmail
> - CVE-2023-51766 exim
>
> Ciao, Marcus
View attachment "[smtp-smuggling33.patch](1/1)" of type "text/x-patch" (6395 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from sec-consult.com_4dd94eef_20250115_114612.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/blog/detail/smtp-smuggling-ein-neue-methode-zur-absenderfaelschung-in-e-mails/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Blog](/blog/)
3. SMTP Smuggling - Spoofing E-Mails Worldwide
# SMTP Smuggling - Spoofing E-Mails Worldwide

18.12.2023

Introducing a novel technique for e-mail spoofing

![Overview SMTP Smuggling](/fileadmin/_processed_/a/8/csm_SMTP_Smuggling-Overview_Header_1ec709623c.png)

*In the course of a research project in collaboration with the SEC Consult Vulnerability Lab, Timo Longin ([@timolongin](https://twitter.com/timolongin)) - known for his [DNS protocol attacks](https://sec-consult.com/blog/detail/taking-over-a-country-kaminsky-style/) - discovered a novel exploitation technique for yet another Internet protocol - SMTP ([Simple Mail Transfer Protocol](https://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol)). Threat actors could abuse vulnerable SMTP servers worldwide to send malicious e-mails from arbitrary e-mail addresses, allowing targeted phishing attacks. Due to the nature of the exploit itself, this type of vulnerability was dubbed **SMTP smuggling**. Multiple 0-days were discovered, and various vendors were notified during our responsible disclosure in 2023.*

## Update on SMTP smuggling and responsible disclosure

Update 2024-02-19: The SMTP smuggling research scored 3rd place in the Portswigger Top 10 web hacking techniques of 2023, check it out here: [portswigger.net/research/top-10-web-hacking-techniques-of-2023](https://portswigger.net/research/top-10-web-hacking-techniques-of-2023)

Update 2024: We have created a new website which gives a short summary about the identified vulnerability, available tools and mitigations of various vendors: [smtpsmuggling.com](https://smtpsmuggling.com/)

Update, 2023-12-22: We were made aware of public discussions about the SMTP smuggling research on various platforms and we wanted to add some input regarding responsible disclosure as well as previous and further communication with the vendors.

We strictly adhere to our responsible disclosure processes (<https://sec-consult.com/vulnerability-lab/responsible-disclosure-policy/>) and always contact affected vendors before any publication. But in this case a lack of clarity in the communication and different interpretations of the impact of the vulnerability led to assumptions from all parties involved on who is affected, what the real impact could be and who has to be notified before publication.

As documented in the timeline of the blog post, the vulnerabilities were initially identified in June 2023 and after further internal research we contacted the specific, affected vendors (Microsoft, Cisco, GMX/Ionos). GMX and Microsoft fixed the issues promptly. But after receiving some feedback from Cisco, that our identified vulnerability is just a feature of the software and not a bug/vulnerability, we contacted CERT/CC on 17th August to get some help for further discussion with Cisco and involve other potentially affected vendors (such as sendmail) through the [VINCE communication platform](https://kb.cert.org/vince/).

There, we submitted all our research details and explained the case to the vendors involved. We received feedback from Cisco that our identified research is not a vulnerability, but a feature and that they will not change the default configuration nor inform their customers. Other vendors did not respond in VINCE but were contacted by CERT/CC.

Based on this feedback and as multiple other vendors were included in this discussion through the CERT/CC VINCE platform without objecting, we wrongly assessed the broader impact of the SMTP smuggling research. Because of this assumption, we asked CERT/CC end of November regarding publication of the details and received confirmation to proceed.

As our research was accepted at this year's 37C3 conference (info received on 3rd December) and we still thought that Cisco users should be warned about the vulnerable default configuration, we decided to publish our research before the conference and holidays in order to provide administrators time to re-configure their Cisco configuration. Hence, we also contacted CERT-Bund (BSI Germany) and CERT.at on 5th December via encrypted email and informed them about the planned release date of the blog post for 18th December and included the full blog post details and further call for action to warn Cisco users.

 Furthermore, we continue discussing SMTP smuggling with CERT/CC and affected vendors through the VINCE platform to address future remediation and measures.

 Our learnings from this case are that we will put even more thought into potential broader impact when sharing details with affected vendors and to strengthen the collaboration and communication with all parties involved.

## Postfix remediation and workaround

Postfix developers Wietse Venema and Viktor Dukhovni have promptly responded to the SMTP smuggling threat and released short-term workarounds on how the vulnerability can be fixed:

<https://www.postfix.org/smtp-smuggling.html>

###

### Official tools to test for SMTP smuggling issues are now available on [GitHub](https://github.com/The-Login/SMTP-Smuggling-Tools)

[![Example SMTP session between sender.example and receiver.example ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_full__02_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_full__02_.png)

Figure 1: Example SMTP session between sender.example and receiver.example

Novel attacks in SMTP? Yes, you read that right - **SMTP!**

Even though SMTP, the Simple Mail Transfer Protocol, is used for sending e-mails across the globe since the beginning of the Internet, it is still possible to find new ways of exploiting it even in 2023! So, **fasten your seat belts**, as we embark on an expedition beyond the known limits of SMTP, and venture into the uncharted territories of **SMTP smuggling**!

## TL;DR

By exploiting interpretation differences of the SMTP protocol, it is possible to smuggle/send spoofed e-mails - hence SMTP smuggling - while still passing SPF alignment checks. During this research, two types of SMTP smuggling, **outbound** and **inbound**, were discovered. These allowed sending spoofed e-mails **from millions** of domains (e.g., admin@outlook.com) to millions of receiving SMTP servers (e.g., Amazon, PayPal, eBay). Identified vulnerabilities in Microsoft and GMX were quickly fixed, however, **SEC Consult urges** companies using the also affected [Cisco Secure Email](https://www.cisco.com/site/in/en/products/security/secure-email/index.html) product to manually update their vulnerable default configuration (see Responsible Disclosure section below)!

##

## SMTP Basics

Before getting into the juicy bits and details of SMTP smuggling, we must first have a basic understanding of the SMTP protocol, SMTP terminology and e-mailing in general. Let's learn by example!

Here, in figure 1, we have an SMTP session between sender.example and receiver.example.

[![SMTP session transferring a mail object, including mail envelope and mail content/data, with SMTP commands, line breaks and data separated by color. ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender__03_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender__03_.png)

Figure 2: SMTP session transferring a mail object, including mail envelope and mail content/data, with SMTP commands, line breaks and data separated by color.

So, what's exactly going on here?

1. Initially, the receiving SMTP server **mx.receiver.example** sends a greeting, indicating that it is ready to accept incoming SMTP commands.
2. The "client"/sender **sender.example** initiates the SMTP session by sending the EHLO (extended hello) **SMTP command** to the server, specifying its domain name. Note that all SMTP commands will be highlighted in red.
3. **mx.receiver.example** responds with a 250 status code, indicating that the requested command (EHLO) was successful. It also provides supported **SMTP capabilities**.
4. Then, **sender.example** specifies the sender e-mail address as well as the receiver e-mail address via "mail FROM" and "rcpt TO" in the mail **envelope**. **mx.receiver.example** confirms both of these **SMTP commands** with a 250 status code.
5. Now, **sender.example** transmits the "data" command to signal its intention to start sending the message data/content.
6. After receiving a "go ahead" response, **sender.example** sends **message****headers** "Subject"/"From"/"To", a **message body** "lorem ipsum" and an **end-of-data sequence****"<CR><LF>.<CR><LF>"** (Carriage-Return / Line-Feed, and a single dot in a line). Note that all message data will be highlighted in blue.
7. **mx.receiver.example** reads the end-of-data sequence and responds with a 250 status code, implying that the message data was accepted.
8. Lastly, **sender.example** closes the connection via the "quit" command.

As you can see, there is a lot of back and forth in this SMTP session. To keep it simple and concise, SMTP sessions in this blog post **only** include the data transmitted by the sender as shown in figure 2.

[![Overview of a simplified e-mailing process via SMTP from left to right ](/fileadmin/_processed_/5/d/csm_SMTP_Smuggling-Sending_e-mails_overview__3__04__803988674e.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Sending_e-mails_overview__3__04_.png)

Figure 3: Overview of a simplified e-mailing process via SMTP from left to right

With this much knowledge about the SMTP protocol, we can put the training wheels aside and look at how SMTP is used to transfer e-mails across the Internet. For example, by sending an e-mail from user(at)outlook.com to user(at)receiver.example!

When sending an e-mail via [outlook.com](https://outlook.com/), we generally have two options:

1. Outlook's web interface
2. Using SMTP

Since this blog post is about SMTP smuggling and doesn't have to do anything with web applications (like [SMTP header injection](https://portswigger.net/kb/issues/00200800_smtp-header-injection)), we're opting for number two - SMTP! How this works is described in figure 3.

So, starting from the left side of the overview, the **mail user agent** (**MUA**: Thunderbird, Outlook, Windows Mail, etc.) connects to Outlook's **mail transfer agent** (**MTA**) on the message submission port TCP/587. MTAs that are dedicated to sending **outbound e-mails** are further addressed as **outbound SMTP servers**. The MUA then sends a series of SMTP commands and message data. Since we haven't described the STARTTLS and AUTH LOGIN commands before, here is a short description:

* **STARTTLS** is used to upgrade to an encrypted TLS session. Since SMTP is generally unencrypted, credentials would otherwise be exposed to listening attackers.
* The AUTH LOGIN SMTP command is used for authenticating the user. In this case, this is done via username and password.

After evaluating if the authenticated user is allowed to send an e-mail for the provided e-mail address in the "mail FROM" and "From" fields, the Outlook SMTP server sends an **inbound e-mail** to the **inbound SMTP server** of **receiver.example** over port TCP/25. This SMTP data looks very similar to the SMTP data submitted to the **outbound SMTP** server, but doesn't include the AUTH LOGIN command and, in this case, doesn't use STARTTLS.

This concludes the e-mail transfer. But how does the receiving inbound SMTP server make sure that the outbound SMTP server is indeed allowed to send e-mails for outlook.com? Or, why can't just anyone send e-mails for the outlook.com domain?

## SPF, DKIM and DMARC

Before an inbound SMTP server accepts an e-mail, it checks the sender's authenticity via e-mail authentication mechanisms such as [SPF](https://en.wikipedia.org/wiki/Sender_Policy_Framework), [DKIM](https://en.wikipedia.org/wiki/DomainKeys_Identified_Mail) and [DMARC](https://en.wikipedia.org/wiki/DMARC). This is important, since otherwise attackers could just send e-mails from arbitrary domains. For example, sending an e-mail as admin(at)outlook.com from an attacker server would be entirely possible. The most prevalent e-mail authentication mechanism, **SPF**, works by permitting sender IP addresses in special SPF/TXT DNS records. The SPF record of [outlook.com](http://outlook.com/) permits the following IP ranges for e-mail transfer:

v=spf1 include:spf-a.outlook.com include:spf-b.outlook.com ip4:157.55.9.128/25 include:spf.protection.outlook.com include:spf-a.hotmail.com include:\_spf-ssg-b.microsoft.com include:\_spf-ssg-c.microsoft.com ~all

[![Passing SPF checks with attacker.example domain, while sending as user@sender.example ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender_SPF_spoofing__05_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender_SPF_spoofing__05_.png)

Figure 4: Passing SPF checks with attacker.example domain, while sending as user@sender.example

If you are not sending from one of these IP ranges, the SPF check would fail and your e-mail most likely won't be forwarded or will be marked as spam. But which domain is actually getting checked? The problem with SPF by itself is that only the MAIL FROM domain from the mail envelope is checked. The From header in the message data, which is further displayed in the received e-mail, can have an arbitrary value, as shown in figure 4 (blue text).

[![Passing SPF and DKIM checks, by sending from an attacker server with an attacker-controlled DKIM key ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender_SPF_and_DKIM_spoofing__06_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender_SPF_and_DKIM_spoofing__06_.png)

Figure 5: Passing SPF and DKIM checks, by sending from an attacker server with an attacker-controlled DKIM key

The same goes for **DKIM** (DomainKeys Identified Mail) as well. DKIM allows signing the message data, including the From header. This signature can then be verified by the receiver with a public key that resides in the DNS. However, it is not enforced, which domain holds the public key (see figure 5).

In this case, the message from "user@sender.example" may be signed, but the verification key is located at "dkim.\_domainkey.attacker.example". This location is derived from concatenating the selector (s=) "dkim", the static value "\_domainkey" and the domain (d=) "attacker.example". So, even though an e-mail may have a valid SPF record and a valid DKIM signature, there is no mechanism for telling if the e-mail comes from a malicious sender or not.

Fortunately, there is **DMARC**, which stands for "Domain-based Message Authentication, Reporting and Conformance". DMARC introduces so-called "identifier alignment" for SPF and DKIM and allows senders to specify alignment policies for both methods. It verifies if the email's "From" domain aligns with SPF checks and/or DKIM signatures. Thus, the DMARC check fails if there is a mismatch between the MAIL FROM and the From domain where otherwise the SPF check would pass. An example for a DMARC policy, which is always located in a TXT record at \_dmarc.[domain], can be seen here:

v=DMARC1; p=reject; sp=none; fo=0; adkim=r; aspf=r; pct=100; rf=afrf

The policy (p=) tells the receiving server to reject 100 percent (pct=) of the messages that fail the DMARC check. Therefore, the message will get accepted (only) if a valid SPF record and/or DKIM signature is provided.

However, what happens if there is no DMARC record? In general, e-mail authenticity handling heavily depends on the inbound SMTP server's configuration and software. As a rule of thumb, if there is SPF or DKIM alignment, there is a good chance of the e-mail being accepted!

Now, with the groundwork done, let's get into **SMTP smuggling**!

[![Simple example of HTTP request smuggling by PortSwigger ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-HTTP_request_smuggling__07_.png "Figure 6: Simple example of HTTP request smuggling by PortSwigger ")](https://portswigger.net/web-security/request-smuggling "Figure 6: Simple example of HTTP request smuggling by PortSwigger")

Figure 6: Simple example of HTTP request smuggling by PortSwigger

## SMTP Smuggling?

The initial goal of this research was to test the SMTP protocol against some common and exotic attacks that work on other protocols, such as HTTP. Thanks to the contribution of many brilliant minds, there is a variety of **HTTP** attacks to choose from. However, in the context of SMTP, one of them just fit the bill. **HTTP request smuggling**!

If you want an in-depth explanation of HTTP request smuggling and all its facets, James Kettle (aka [@albinowax](https://twitter.com/albinowax)) did a [wonderful job](https://jameskettle.com/) on that. However, for now, we only need to understand the essentials!

With HTTP request smuggling, we're basically trying to exploit different interpretations of the same thing. For example, with discrepancies in the interpretation and processing of the "Content-Length" and "Transfer-Encoding" HTTP headers, an arbitrary HTTP request can be smuggled to an otherwise unreachable back-end server like in figure 6.

[![SMTP session with SMTP commands and message data separated by colour. ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender__08_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_example_only_sender__08_.png)

Figure 7: SMTP session with SMTP commands and message data separated by colour.

In this example, the vulnerable front-end server only sees one HTTP POST request, while the back-end server sees a POST request **and** a GET request to /**admin**!

With SMTP, we also have a setup with two servers, being **outbound and inbound SMTP servers**. So, let's take a look at an SMTP session again in figure 7.

[![SMTP smuggling in theory ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png)

Figure 8: SMTP smuggling in theory

Now tell me, **what happens if outbound and inbound SMTP servers interpret the end-of-data sequence (<CR><LF>.<CR><LF>) differently?**

Exactly, S**MTP smuggling!**

If SMTP servers have a different understanding of where the message data ends, an attacker can potentially break out of the message data. Even worse, this may allow to specify arbitrary SMTP commands and even to send separate e-mails (see figure 8)!

[![SMTP analysis setup for analyzing outbound SMTP servers ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_analysis_test_setup__3__10_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_analysis_test_setup__3__10_.png)

Figure 9: SMTP analysis setup for analyzing outbound SMTP servers

So, that's the basic idea of SMTP smuggling! But does it actually work?

## <CR><LF>.<CR><LF> is a lie?

To get a good understanding of how different kinds of SMTP software work, we can start our analysis as shown in figure 9:

[![Using \n.\n as end-of-data sequence #1 ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_CRLF_smuggling___11_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_CRLF_smuggling___11_.png)

Figure 10: Using \n.\n as end-of-data sequence #1

First, we register e-mail accounts at various public e-mail providers that support mail submissions via SMTP (unlike Tutanota and ProtonMail). We used the following providers for this research project:

* outlook.com
* gmail.com
* gmx.net
* icloud.com
* zoho.com
* fastmail.com
* runbox.com
* startmail.com
* mailbox.org
* aol.com
* yahoo.com
* web.de

Then, by sending e-mails through the **outbound** SMTP servers of these providers and receiving them on an **inbound SMTP analysis server**, we can see first differences in the implementation of the SMTP protocol in these SMTP servers.

When looking at the **SMTP analysis client** it becomes apparent straight away that some SMTP products do things "differently" than others. For example, here are some responses received from e-mail providers after sending the **DATA** SMTP command:

- 250 End data with <CR><LF>.<CR><LF>
 - 250 Start mail input; end with <CRLF>.<CRLF>
 - 250 Send data ending with <CRLF>.<CRLF>

This doesn't look good for our plans to smuggle SMTP commands, since we're looking for different interpretations of SMTP, and not the same text written differently. Right? But, we're not going to back off just because of some text, are we?

After further analysis, some SMTP servers returned the following responses, which looked a bit more promising:

- Enter message, ending with "." on a line by itself
 - Enter mail, end with "." on a line by itself

Why would that be more promising, though? Well, different operating systems have a different understanding of "**a line by itself**". A "." on a line by itself on Windows would be separated via two carriage return line feeds (**<CR><LF>.<CR><LF>** or **\r\n.\r\n**), while a "." on a line by itself on Linux would be separated with two line feeds (<LF>.<LF> or \n.\n).

So, why don't we try to end the message data of an e-mail with **<LF>.<LF>?** This would therefore look like in figure 10.

[![Using \n.\n as end-of-data sequence #2 ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_CRLF_smuggling__12_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_CRLF_smuggling__12_.png)

Figure 11: Using \n.\n as end-of-data sequence #2

Now, if an SMTP server doesn't consider <LF>.<LF> as the end-of-data sequence, the connection will be left hanging, since it's waiting for the actual <CR><LF>.<CR><LF>. Therefore, as shown in figure 11, we add the following.

[![Outbound e-mail provider delivering an e-mail with <LF>.<LF> sequence (not vulnerable) ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-12-4_19-57-58__13_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-12-4_19-57-58__13_.png)

Figure 12: Outbound e-mail provider delivering an e-mail with <LF>.<LF> sequence (not vulnerable)

With this, whenever <LF>.<LF> is supported as end-of-data sequence by the inbound SMTP server, only "lorem ipsum" will be part of the message data, otherwise the message also includes "This server is ignoring line feeds as end-of-data sequence!".

But, what can we actually achieve with this? Well, let's see how a message transfer could look like if <LF>.<LF> doesn't end the data section, like in figure 12.

[![Outbound e-mail provider delivering an e-mail with <LF>.<LF> sequence (vulnerable) ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-CRLF_Smuggling_2__3__14_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-CRLF_Smuggling_2__3__14_.png)

Figure 13: Outbound e-mail provider delivering an e-mail with <LF>.<LF> sequence (vulnerable)

Depending on the receiving inbound SMTP server this may be completely harmless. However, what if the inbound SMTP server interprets <LF>.<LF> as end-of-data sequence? (see figure 13)

[![Potential end-of-data sequence between START and END going through GMX's outbound SMTP server unchanged ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-GMX_Smuggling__3__15_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-GMX_Smuggling__3__15_.png)

Figure 14: Potential end-of-data sequence between START and END going through GMX's outbound SMTP server unchanged

In this case, the "harmless" <LF>.<LF> breaks out of the message data and "This server is ignoring line feeds as end-of-data sequence!" may now be interpreted as an **SMTP command**! Note that this requires the inbound server to accept multiple SMTP commands in a batch, or so-called SMTP pipelining. Luckily for us, most servers support this nowadays.

However, **outbound SMTP servers** commonly handle such "troublesome" <LF>.<LF> sequences via different means:

* Dot-stuffing (Escaping the single dot with another dot):  <LF>..<LF>
* Replacing it with a <CR><LF>
* Encoding it (e.g., via quoted-printable): =0A.=0A
* Removing the entire sequence
* Not sending the message

But sometimes, **they do nothing at all**!

So, essentially, we're looking for specific characteristics in outbound and inbound SMTP servers in terms of end-of-data sequence handling. More precisely, we're searching for what outbound SMTP servers ignore (e.g., <LF>.<LF>) and what inbound SMTP servers interpret (e.g., <LF>.<LF> as end-of-data). If we can find a correct combination, we can smuggle!

## First Blood

As previously mentioned, we've created e-mail accounts at various e-mail providers. Shortly after sending potential end-of-data sequences (e.g., <LF>.<LF>) from outbound provider SMTP servers to the SMTP analysis server, a **promising candidate emerged**!

**GMX**, established in 1997, is one of the old-school e-mail providers in the DACH region with roughly 20 million users. When sending an **<LF>.<CR><LF>** sequence to the outbound GMX SMTP server, it is passed unfiltered to the inbound SMTP server, as shown in figure 14!

[![SMTP smuggling from admin@gmx.net to user@provider.example ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_GMX__16_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_GMX__16_.png)

Figure 15: SMTP smuggling from admin@gmx.net to user@provider.example

Therefore, we can now break out of the message data at the inbound SMTP server, if <LF>.<CR><LF> is interpreted as an end-of-data sequence. So, how do we find such servers?

We simply send an e-mail with the following message data (see figure 15) to all the e-mail addresses we've registered.

[![Failed attempt of SMTP smuggling against Gmail ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/GMX_to_GMAIL_smuggling_failed__17_.PNG)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/GMX_to_GMAIL_smuggling_failed__17_.PNG)

Figure 16: Failed attempt of SMTP smuggling against Gmail

For a lot of them, we receive a very suspicious looking e-mail like in figure 16, since <LF>.<CR><LF> did not end the message data.

[![Successful SMTP smuggling from GMX to Fastmail. "Look at me! I am the admin now!" ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/GMX_to_FASTMAIL_smuggling_success__18_.PNG)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/GMX_to_FASTMAIL_smuggling_success__18_.PNG)

Figure 17: Successful SMTP smuggling from GMX to Fastmail. "Look at me! I am the admin now!"

But for some of them, we hit the jackpot!

[![Cross-domain SMTP smuggling to different recipients ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_WEB.DE_19_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_WEB.DE_19_.png)

Figure 18: Cross-domain SMTP smuggling to different recipients

This proof of concept (figure 17) was the first sign that SMTP smuggling actually works!

By inspecting the message headers, we can see that the SPF check passes with domain alignment for gmx.net! This is because the smuggled message actually came from the legitimate GMX SMTP server.

Received-SPF: pass

    (gmx.net: 212.227.15.15 is authorized to use 'admin@gmx.net' in 'mfrom' identity (mechanism 'ip4:212.227.15.0/25' matched))

    receiver=mx4.messagingengine.com;

    identity=mailfrom;

    envelope-from="admin@gmx.net";

    helo=mout.gmx.net;

    client-ip=212.227.15.15

Since we've achieved domain alignment for gmx.net, this e-mail will most likely pass spam filters, even with strict DMARC policies! **But wait**, if other domains also use the outbound SMTP server of GMX to send e-mails, can't we spoof them as well? Let's see! By analyzing the SPF record of **web.de**, we can see that the outbound SMTP IP address of GMX **212.227.15.15** is included as well!

v=spf1 ip4:212.227.126.128/25 ip4:212.227.15.0/25 ip4:212.227.17.0/27 ip4:217.72.192.248/29 ip4:82.165.159.0/26 ip4:217.72.207.0/27 ip4:217.72.192.64/26 ip4:82.165.229.130 ip4:82.165.230.22 ~all

Now, we can change the SMTP smuggling message data accordingly, like in figure 18.

[![Successful cross-domain SMTP smuggling from GMX to Fastmail using web.de as sender domain ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/WEB.DE_to_FASTMAIL_smuggling_success__20_.PNG)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/WEB.DE_to_FASTMAIL_smuggling_success__20_.PNG)

Figure 19: Successful cross-domain SMTP smuggling from GMX to Fastmail using web.de as sender domain

To simulate a real-life scenario, we specify a different receiver e-mail address for the first message and only send the smuggled message (figure 19) to the target.

[![Censored (real) profile picture associated with admin@web.de ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-12-4_21-4-41__21_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-12-4_21-4-41__21_.png)

Figure 20: Censored (real) profile picture associated with admin@web.de

In this case, our target would even see the associated profile picture (in this case of the real 'admin@web.de' user), like in figure 20!

[![Sending message data via BDAT](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-BDAT__22_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-BDAT__22_.png)

Figure 21: Sending message data via BDAT

And again, the SPF verification checks out!

Received-SPF: pass

    (web.de: 212.227.17.22 is authorized to use 'admin@web.de' in 'mfrom' identity (mechanism 'ip4:212.227.17.0/27' matched))

    receiver=mx4.messagingengine.com;

    identity=mailfrom;

    envelope-from="admin@web.de";

    helo=mout.gmx.net;

    client-ip=212.227.17.22

Now, you might think that this was already cool, **but we're just getting started**!

Even though we initially only analyzed GMX, the problem is far worse than it seemed at first. Like many big e-mail providers, GMX is using a custom SMTP server called **Nemesis****SMTPd**. Since GMX is part of **Ionos**, e-mailing services provided by Ionos are also using Nemesis SMTPd. By putting 1 and 1 together, we register an e-mail domain at Ionos and check if SMTP smuggling works. And it does! However, smuggling via a custom e-mail domain doesn't even seem to be necessary. The SPF record for the registered e-mail domain includes "\_spf-eu.ionos.com" and the SPF record for gmx.net includes "\_spf.gmx.net". Looking at the permitted IP ranges reveals "some" collisions:

$ dig \_spf-eu.ionos.com TXT
 "v=spf1 ip4:212.227.126.128/25 ip4:212.227.15.0/25 ip4:212.227.17.0/27 ip4:82.165.159.0/26 ip4:217.72.192.64/26 ?all"

 $ dig \_spf.gmx.net TXT
 "v=spf1 ip4:212.227.126.128/25 ip4:212.227.15.0/25 ip4:212.227.17.0/27 ip4:82.165.159.0/24 ip4:74.208.4.192/26  ip4:217.72.207.0/27 ip4:82.165.229.31 ip4:82.165.230.21 ip4:213.165.64.0/23 ip4:74.208.5.64/26 ~all"

So, either way, this allowed **spoofing** not only **gmx.net** and **web.de**, but also around a **million** other domains hosted at **Ionos**! But more on the details later!

## Smuggling via Microsoft Exchange Online

After a deeper analysis of outbound SMTP servers, a peculiarity in **Microsoft Outlook's** ([outlook.com](https://outlook.com/)) SMTP server was observed. When trying to send an **<LF>.<LF>** sequence, the message does not get transmitted, and the following error message is returned:

Remote server returned '550 5.6.11 SMTPSEND.BareLinefeedsAreIllegal; message contains bare linefeeds, which cannot be sent via DATA and receiving system does not support BDAT'

However, same as with GMX, **Outlook doesn't filter <LF>.<CR><LF>** sequences.

Still, it wasn't possible to smuggle to the same receivers (e.g., Fastmail) as with GMX. Reason for this is Outlook's usage of the optional **BDAT** SMTP command. BDAT is an alternative to the **DATA** command to transfer the message data. It works by specifying the message length with the BDAT command, instead of relying on an end-of-data sequence. For example, to transfer 72 bytes of message data, we can do it like in figure 21.

[![Sending a phishing e-mail from admin@outlook.com via SMTP smuggling](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_Outlook__23_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_Outlook__23_.png)

Figure 22: Sending a phishing e-mail from admin@outlook.com via SMTP smuggling

Even though that stops us from smuggling to some inbound SMTP servers, the BDAT command can only be used by Outlook, if the inbound SMTP server supports it. If the inbound SMTP server doesn't indicate BDAT support by returning the **CHUNKING** capability, DATA is used as fallback.

Therefore, we're looking for an inbound SMTP server that interprets <LF>.<CR><LF> as an end-of-data sequence and doesn't support BDAT.

Funnily enough, the [sec-consult.com](https://sec-consult.com/) SMTP server supports just that! Note that **LOTS** of servers on the Internet support this, but since we've got to make sure that our own systems are secure anyways, we'll be using sec-consult.com. So, what's the first thing to do with our newly gained power? **Sending spoofed e-mails to co-workers to make sure it actually works!** (see figure 22)

[![Typical Austrian reaction after receiving a spoofed e-mail ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/teams_conversation_OIDA__24_.PNG)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/teams_conversation_OIDA__24_.PNG)

Figure 23: Typical Austrian reaction after receiving a spoofed e-mail

Based on their reaction (figure 23), the message from admin(at)outlook.com definitely got delivered and didn't end up in spam.

[![Receiving a spoofed e-mail from admin@outlook.com aka Timo Lo(n)gin ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-5_15-26-20__24_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-5_15-26-20__24_.png)

Figure 24: Receiving a spoofed e-mail from admin@outlook.com aka Timo Lo(n)gin

The actual e-mail is shown in figure 24:

[![Using HTML with SMTP smuggling to create a convincing phishing e-mail ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-10_22-55-21__25_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-10_22-55-21__25_.png)

Figure 25: Using HTML with SMTP smuggling to create a convincing phishing e-mail

We can once more confirm SPF alignment by looking at the message headers:

Received-SPF: Pass ([mx3.atos.net](http://mx3.atos.net/): domain of admin(at)outlook.com designates 40.92.75.68 as permitted sender)
   identity=mailfrom; client-ip=40.92.75.68;
   receiver=[mx3.atos.net](http://mx3.atos.net/); envelope-from="admin@[outlook.com](http://outlook.com/)";
   x-sender="admin@[outlook.com](http://outlook.com/)"; x-conformance=spf\_only;
   x-record-type="v=spf1"; x-record-text="v=spf1
   ip4:40.92.0.0/15 ip4:40.107.0.0/16 ip4:52.100.0.0/14
   ip4:104.47.0.0/17 ip6:2a01:111:f400::/48
   ip6:2a01:111:f403::/49 ip6:2a01:111:f403:8000::/50
   ip6:2a01:111:f403:c000::/51 ip6:2a01:111:f403:f000::/52 -all"

Since the previous examples were only text-based, attackers could also use HTML, for some more convincing phishing e-mails (figure 25).

[![Receiving a spoofed e-mail on hr@sec-consult.com from ceo@sec-consult.com ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-5_15-53-16__26_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-5_15-53-16__26_.png)

Figure 26: Receiving a spoofed e-mail on hr@sec-consult.com from ceo@sec-consult.com

However, to keep it simple, we'll stick to just text.

So, this is cool, but again, **that's not everything**! Since the outbound Outlook SMTP server is not only used for e-mails by [outlook.com](https://outlook.com/), but for **the entirety of Exchange Online**, we can now send e-mails from **every domain which uses Exchange Online to send e-mails**!

Since this affects **LOTS** of companies (as later discussed in SMTP Smuggling Impact section), we can choose our sender domain freely. We can even use [sec-consult.com](https://sec-consult.com/) itself! (see figure 26)

[![Example message data with exotic end-of-data sequence using a null byte ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_exotic__27_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_session_exotic__27_.png)

Figure 27: Example message data with exotic end-of-data sequence using a null byte

As before, the SPF check succeeds with domain alignment, since sec-consult.com is using Exchange Online and the SPF record includes the respective Exchange Online SPF domain **spf.protection.outlook.com**.

Received-SPF: Pass ([mx4.atos.net](http://mx4.atos.net/): domain of ceo(at)sec-consult.com
   designates 40.92.48.103 as permitted sender)
   identity=mailfrom; client-ip=40.92.48.103;
   receiver=[mx4.atos.net](http://mx4.atos.net/); envelope-from="ceo@[sec-consult.com](http://sec-consult.com/)";
   x-sender="ceo@[sec-consult.com](http://sec-consult.com/)"; x-conformance=spf\_only;
   x-record-type="v=spf1"; x-record-text="v=spf1
   ip4:40.92.0.0/15 ip4:40.107.0.0/16 ip4:52.100.0.0/14
   ip4:104.47.0.0/17 ip6:2a01:111:f400::/48
   ip6:2a01:111:f403::/49 ip6:2a01:111:f403:8000::/50
   ip6:2a01:111:f403:c000::/51 ip6:2a01:111:f403:f000::/52 -all"

With GMX and Exchange Online out of the way, we're now approaching our last target!

## Smuggling to Amazon, PayPal, eBay, ..., on the road to Cisco

GMX and Exchange Online allow SMTP smuggling due to insufficient sanitization at their outbound SMTP servers, **but what about insecure inbound SMTP servers**? What if there are inbound SMTP servers that allow such non-restrictive end-of-data sequences that even the most restrictive outbound SMTP servers would let such sequences through?

To get to the bottom of this, we can use a scanner that sends e-mails to inbound SMTP servers, but uses exotic end-of-data sequences. If the connection to the inbound SMTP server times out, the exotic end-of-data sequence was ignored. Otherwise, we most likely found something interesting!

So, what exactly is "exotic"? Exotic end-of-data sequences could for example be:

* Interrupted end-of-data sequences:
  + <CR><LF>\x00.<CR><LF>
  + <CR><LF>.\x00<CR><LF>
* End-of-data sequences using incomplete CRLFs:
  + <LF>.<LF>
  + <CR><LF>.<CR>
  + <CR>.<LF>
* End-of-data sequences in the message header

The message data of such an "exotic" e-mail could look like in figure 27.

[![SMTP smuggling exploiting exotic end-of-data sequence <CR>.<CR> ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_iCloud__28_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-SMTP_smuggling_iCloud__28_.png)

Figure 28: SMTP smuggling exploiting exotic end-of-data sequence <CR>.<CR>

Now, by scanning the former Alexa Top 1000, various inbound SMTP servers accepting such sequences were identified! However, only one of those sequences seems to be working for lots of SMTP servers: **<CR>.<CR>**

This sequence gets accepted by the inbound e-mail servers of some really high-value targets:

* Amazon
* PayPal
* eBay
* Cisco
* The IRS

The one thing that they all have in common is that they're using [Cisco Secure Email](https://www.cisco.com/site/in/en/products/security/secure-email/index.html), with on-prem **Cisco Secure Email Gateway** or cloud-based Cisco's Secure Email Cloud Gateway. And again, for some odd reason, sec-consult.com is using Cisco Secure Email Gateway as well!

As a proof of concept (figure 28), we can now send an e-mail from admin(at)icloud.com to our target at sec-consult.com, since, like with many other outbound SMTP servers (further discussed in SMTP Smuggling Impact), **<CR>.<CR> doesn't get filtered:**

[![Sending spoofed e-mails as admin@icloud.com ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-5_18-13-25__29_.png)](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-7-5_18-13-25__29_.png)

Figure 29: Sending spoofed e-mails as admin@icloud.com

Like before, the e-mail goes through unscathed, as shown in figure 29.

[![Getting domains using Ionos e-mail services via SecurityTrails ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/ionos_domains__30_.PNG)](https://securitytrails.com/domain/mx01.ionos.de/dns?__cf_chl_tk=.TKYmeShS.FZRsY6AAhEHSwz4V.4vi5xyMUN0i6TvkY-1702368252-0-gaNycGzNFWU)

Figure 30: Getting domains using Ionos e-mail services via SecurityTrails

SPF checks pass with domain alignment and without any issues.

Received-SPF: Pass ([mx4.atos.net](http://mx4.atos.net/): domain of admin(at)icloud.com
   designates 17.57.155.23 as permitted sender)
   identity=mailfrom; client-ip=17.57.155.23;
   receiver=[mx4.atos.net](http://mx4.atos.net/); envelope-from="admin@[icloud.com](http://icloud.com/)";
   x-sender="admin@[icloud.com](http://icloud.com/)"; x-conformance=spf\_only;
   x-record-type="v=spf1"; x-record-text="v=spf1
   ip4:17.58.0.0/16 ip4:17.57.155.0/24 ip4:17.57.156.0/24
   ip4:144.178.36.0/24 ip4:144.178.38.0/24 ip4:112.19.199.64/29
   ip4:112.19.242.64/29 ip4:222.73.195.64/29 ip4:157.255.1.64/29
   ip4:106.39.212.64/29 ip4:123.126.78.64/29
   ip4:183.240.219.64/29 ip4:39.156.163.64/29 ~all"

Hence, DMARC passes as well:

Authentication-Results-Original: [mx4.atos.net](http://mx4.atos.net/); dkim=none (message not signed)
  header.i=none; spf=Pass smtp.mailfrom=admin@[icloud.com](http://icloud.com/); spf=None
  smtp.helo=postmaster@[qs51p00im-qukt01080502.me.com](http://qs51p00im-qukt01080502.me.com/); dmarc=pass (p=quarantine
  dis=none) d=[icloud.com](http://icloud.com/)

With Cisco's Secure Email covered, we can now go on and take a look at the global impact!

## SMTP Smuggling Impact

At this point we've covered lots of **outbound and inbound SMTP smuggling**. But, speaking globally, how bad is it?

### GMX and Ionos

SMTP smuggling via GMX and Ionos e-mail services allowed SMTP smuggling from roughly **1.35 million different domains**, as indicated by the domains pointing their MX record to Ionos (figure 30).

[![Used SMTP software on the Internet (Shodan)(results may vary) ](/fileadmin/_processed_/e/d/csm_shodan_email_software__31__30e6c2e871.png)](https://www.shodan.io/search/facet?query=port%3A25&facet=product)

Figure 31: Used SMTP software on the Internet (Shodan)(results may vary)

Checking the SPF record of these domains confirms that they are most likely all permitting **\_spf-eu.ionos.com** for sending e-mails.

However, as already mentioned, SMTP smuggling doesn't work for every receiving inbound SMTP server and, in this case, requires inbound SMTP servers to accept **<LF>.<CR><LF>** as end-of-data sequence. So, who's affected?

Only few of the bigger e-mail providers that were tested are affected. These include:

* Fastmail
* Runbox

This might not seem bad at first, but looking at affected SMTP software on the Internet is a different story. After testing some popular e-mail software in their default configuration, it turned out that **Postfix** and **Sendmail** fulfil the requirements, are **affected** and can be smuggled to. Speaking globally, this is a lot (figure 31)!

Aside from Postfix and Sendmail, other SMTP implementations are most likely affected as well, including Cisco Secure Email (Cloud) Gateway, to which we'll get in a second.

### Microsoft Exchange Online

Same as GMX and Ionos, Exchange Online allowed smuggling via a **<LF>.<CR><LF>** end-of-data sequence as well, which makes it possible to smuggle from every domain pointing their SPF record to Exchange Online. This amounts to [millions of domains](https://enlyft.com/tech/products/exchange-online) all across the globe, including some very high-value targets owned by Microsoft like **microsoft.com, msn.com, github.com, outlook.com, office365.com, openai.com** and many more, and also domains of their customers (e.g., **tesla.com, mastercard.com, nike.com**, etc.).

However, as previously mentioned, smuggling from Exchange Online is even more restricted than from GMX/Ionos, since the receiving inbound SMTP server must support BDAT. This is the case for Fastmail and - still - hundreds of thousands of [postfix](https://www.shodan.io/search?query=postfix+port%3A25+-CHUNKING) and [sendmail](https://www.shodan.io/search?query=sendmail+port%3A25+-CHUNKING) servers.

| Software | Without BDAT/CHUNKING | Total | Percentage | Shodan query |
| --- | --- | --- | --- | --- |
| Postfix | 716884 | 1475616 | ~50% | postfix port:25 -CHUNKING |
| Sendmail | 168823 | 169030 | ~99% | sendmail port:25 -CHUNKING |

[![Relevant configuration settings of Cisco Secure Email ](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/image-2023-12-4_20-56-43__32_.png)](https://www.cisco.com/c/en/us/td/docs/security/esa/esa15-0/user_guide/b_ESA_Admin_Guide_15-0/b_ESA_Admin_Guide_12_1_chapter_0100.html?bookSearch=true#task_1254814__table_985308C400C84CE3BC190BC8A3A95D86)

Figure 32: Relevant configuration settings of Cisco Secure Email

These numbers from Shodan might not paint the whole picture though, as many servers maybe running postfix, but are hiding their identification banner. Also, other smaller SMTP servers are affected as well, again including Cisco Secure Email (Cloud) Gateway.

We did not analyze all SMTP software out there, hence it might be possible that other vulnerable servers exist as well.

### Cisco Secure Email (Cloud) Gateway

The Cisco Secure Email Gateway and its cloud counterpart, the Cisco Secure Email Cloud Gateway, are both "vulnerable" to **inbound** SMTP smuggling. The quotes are necessary in this case, since, according to lengthy discussions with Cisco, this is not a bug, but a feature (see Responsible Disclosure section)!

**By default**, Cisco Secure Email (Cloud) Gateway accepts **<CR>.<CR>** as end-of-data sequence, which does not get filtered by the following SMTP servers when sending outbound:

* Outlook/Exchange Online
* Icloud
* On-premise exchange server
* Postfix
* Sendmail
* Startmail
* Fastmail
* Zohomail

This would allow inbound SMTP smuggling to around 40k domains using Cisco's Secure Email **Cloud** Gateway, if they're using the **default configuration** (like we did). These domains can be determined by checking a passive DNS database like SecurityTrails for [iphmx.com subdomains](https://securitytrails.com/list/apex_domain/iphmx.com). Identifying on-premise Cisco Secure Email Gateways on the other hand is a difficult task, since lots of Internet-wide scanners (e.g., Shodan) seem to get blocked when conducting service scans. However, to get a better feeling for the usage of this product, we scanned the former Alexa Top 1000, and discovered at least the following 32 domains.

* [amazon.com](http://amazon.com/)
* [amazon.co.jp](http://amazon.co.jp/)
* [amazon.co.uk](http://amazon.co.uk/)
* [amazon.it](http://amazon.it/)
* [amazon.fr](http://amazon.fr/)
* [marriott.com](http://marriott.com/)
* [cisco.com](http://cisco.com/)
* [amazon.in](http://amazon.in/)
* [paypal.com](http://paypal.com/)
* [amazon.ca](http://amazon.ca/)
* [goodreads.com](http://goodreads.com/)
* [webex.com](http://webex.com/)
* [custhelp.com](http://custhelp.com/)
* [imdb.com](http://imdb.com/)
* [intuit.com](http://intuit.com/)
* [ndtv.com](http://ndtv.com/)
* [amazon.cn](http://amazon.cn/)
* [makemytrip.com](http://makemytrip.com/)
* [amazon.com.au](http://amazon.com.au/)
* [amazonaws.com](http://amazonaws.com/)
* [primevideo.com](http://primevideo.com/)
* [amazon.es](http://amazon.es/)
* [irs.gov](http://irs.gov/)
* [amazon.com.br](http://amazon.com.br/)
* [aastocks.com](http://aastocks.com/)
* [ebay.com](http://ebay.com/)
* [amazon.de](http://amazon.de/)
* [ebay.de](http://ebay.de/)
* [ebay.co.uk](http://ebay.co.uk/)
* [ebay.com.au](http://ebay.com.au/)
* [mayoclinic.org](http://mayoclinic.org/)
* [audible.com](http://audible.com/)

Note that this doesn't take into account servers that don't have an MX record let alone an SMTP server.

## Further vulnerabilities

During the research we've also discovered some exotic inbound SMTP servers that interpret end-of-data sequences like **<CR><LF>\x00.<CR><LF>**, with "\x00" representing a null byte. With proprietary SMTP components and lots of different e-mail services intertwined it's hard to tell what is possible until an e-mail reaches its final destination.

Even though SMTP smuggling might still be hiding in some places, we hopefully eliminated some big targets.

## Responsible Disclosure

How do we report a vulnerability that is based on protocol interpretation? Who is right, who is wrong? Let's take a look at some RFCs!

In general, [RFC 5321](https://www.rfc-editor.org/rfc/rfc5321) from 2008 states the following:

***"The custom of accepting lines ending only in <LF>, as a concession to non-conforming behavior on the part of some UNIX systems, has proven to cause more interoperability problems than it solves, and SMTP server systems MUST NOT do this, even in the name of improved robustness.  In particular, the sequence "<LF>.<LF>" (bare line feeds, without carriage returns) MUST NOT be treated as equivalent to <CRLF>.<CRLF> as the end of mail data indication."***

So, it's the inbound SMTP server's fault! But wait, [RFC 5322](https://www.rfc-editor.org/rfc/rfc5322), also from 2008, says the following about the body of a message:

***"CR and LF MUST only occur together as CRLF; they MUST NOT appear independently in the body."***

This essentially means that **both sides (outbound and inbound)** are at fault! Also, this shows us that inconsistent interpretation of the end-of-data sequence is not a novel issue. Now, what do the affected parties think about this? We have thus initiated our responsible disclosure process around **end of July 2023** (see Timeline further below).

### GMX

The responsible disclosure process with GMX was pure bliss. After immediately receiving a response, the issue was fixed in roughly ten days. Aside from paying a bounty, they even added Timo to their [bug bounty hall of fame](https://bugbounty.gmx.net/halloffame-index.html). All-in-all a great experience! Huge props to GMX for such a professional and quick reaction.

### Microsoft

The outbound SMTP smuggling vulnerability was submitted via the [Microsoft Security Response Center (MSRC)](https://www.microsoft.com/en-us/msrc). Roughly a month later, Microsoft replied:

***"Thank you again for submitting this issue to Microsoft. Currently, MSRC prioritizes vulnerabilities that are assessed as “Important” or “Critical'’ severities for immediate servicing. After careful investigation, this case has been assessed as moderate severity and does not meet MSRC’s bar for immediate servicing since the attack only works if the mail server of the recipient treats a non-standard EOD sequence as EOD . However, we have shared the report with the team responsible for maintaining the product or service. They will take appropriate action as needed to help keep customers protected"***

Fair enough, they got bigger fish to fry! After retesting the issue every now and then, they seem to have fixed it roughly in the middle of October 2023.

### Cisco

As previously mentioned, the "vulnerability" in Cisco Secure Email (Cloud) Gateway is not a bug, but a feature. And, unlike in most cases, this is actually somewhat true.

Cisco Secure Email (Cloud) Gateway can be configured to handle carriage returns and line feeds in a special manner, as seen [here](https://www.cisco.com/c/en/us/td/docs/security/esa/esa15-0/user_guide/b_ESA_Admin_Guide_15-0/b_ESA_Admin_Guide_12_1_chapter_0100.html?bookSearch=true#task_1254814__table_985308C400C84CE3BC190BC8A3A95D86).

However, **by default**, Cisco Secure Email (Cloud) Gateway "Allows the message, but converts bare CR and LF characters to CRLF characters" (the vulnerable "Clean" setting), which basically **enables inbound SMTP smuggling** via **<CR>.<CR>** end-of-data sequences. We have communicated this issue to Cisco and CERT/CC and went back and forth quite a bit. But at the end of the day, it's not a bug, it's a feature.

Since this feature allowed us to send spoofed e-mails from arbitrary Exchange Online domains straight into our inboxes, we decided to **change** the configuration to "**Allow**".

This passes e-mails with bare carriage returns or line feeds on to our actual e-mail server (Cisco Secure Email Gateway is just a gateway), which only interprets <CR><LF>.<CR><LF> as end-of-data sequence. If you don't want to receive spoofed e-mails with valid DMARC checks as well, we highly recommend changing your configuration!

## Conclusion

We've shown a novel SMTP spoofing technique with this research that allowed to spoof e-mails from millions of domains.

Even though Microsoft and GMX have patched this issue promptly, inbound SMTP smuggling to Cisco Secure Email instances (cloud and on-premise) is still possible with **default** configurations. We highly encourage to change these default configurations, as described in the Responsible Disclosure chapter.

Also, this blog post hopefully sparked further interest in SMTP research, since there is still so much to explore. Even with SMTP smuggling alone, there are many things to look at:

* Other smuggling techniques
* Bounce smuggling
* Smuggling via BDAT
* Smuggling dangerous/exotic SMTP commands
* Internet-wide scans
* Other SMTP software
* etc.

So, this is probably not the last time you've heard of SMTP smuggling!

## Timeline

| 2023-06-07: | First outbound SMTP smuggling proof of concept (GMX) |
| --- | --- |
| 2023-06-08: | Discovery of outbound SMTP smuggling in Exchange Online |
| 2023-06-20: | Discovery of Cisco Secure Email (Cloud) Gateway inbound SMTP smuggling |
| 2023-06/2023-07: | Developing tools, analyzing test cases, further research |
| 2023-07-26: | Contacting MSRC |
| 2023-07-27: | Contacting Cisco |
| 2023-07-29: | Contacting GMX. |
| 2023-08-10: | GMX fixed the issue |
| 2023-08-17: | Contacting CERT Coordination Center (CERT/CC) for further discussion with Cisco |
| 2023-08-23: | Microsoft responds and rates the vulnerability with moderate risk |
| 2023-09-13: | CERT/CC accepts the case |
| 2023-10-16: | SMTP smuggling in Exchange Online is fixed |
| 2023-11-29: | CERT/CC allows public release of SMTP smuggling, since no software vulnerabilities were identified ("it's not a bug, it's a feature") |
| 2023-12-05: | Informing CERT.at and CERT-Bund about planned release, providing blog post draft, warning about Cisco configuration |
| 2023-12-18: | Release date of blog post |

*This research was done by Timo Longin and published on behalf of the [SEC Consult Vulnerability Lab](/vulnerability-lab/#c1699).*

## FAQ

How do I know if I am affected?

If you are a user of a big e-mail provider (Outlook, Gmail, etc.), you are most likely going to be fine (for now at least). Since SMTP smuggling is a fairly new topic and still has things to explore, we cannot be certain though. However, if you're using Cisco Secure Email (cloud or on-premise), you should definitely check your configuration (see Responsible Disclosure)! But, as always, don't blindly trust anything that lands in your e-mail inbox!

Update from 10/01/2024: Official tools to test for SMTP smuggling issues are now available on [GitHub](https://github.com/The-Login/SMTP-Smuggling-Tools)!

Is there a tool available to verify whether I am vulnerable?

Update from 10/01/2024: Official tools to test for SMTP smuggling issues are now available on [GitHub](https://github.com/The-Login/SMTP-Smuggling-Tools)!

We have developed an analysis tool internally but decided to publish it at a later date (maybe already at the [37C3 conference](https://events.ccc.de/congress/2023/hub/en/fahrplan) end of December 2023 where this research will be presented), as currently many Cisco Secure Mail installations are affected by the issue.

Do smuggled e-mails always get past spam filters?

The short answer is no, not always! Even though the smuggled e-mail might come from a legitimate sender and passes e-mail authentication due to SPF alignment, the e-mail might still get blocked, depending on the e-mail contents and other factors. Also, if more than SPF alignment is required for the e-mail to go through, we're out of luck with SMTP smuggling.

How would someone even get the idea of looking at a protocol like SMTP?

There are two major reasons:

1. SMTP is a very old protocol that is somewhat flying under the radar of a lot of security researchers (kind of like [DNS](https://sec-consult.com/blog/detail/taking-over-a-country-kaminsky-style/)). Since there wasn't any related research that indicated similar attacks, the chances were good for finding something new!
2. Phishing is one of the best ways for threat actors or our red teamers to gain initial access to an organization. Therefore, looking for vulnerabilities in the underlying e-mail protocol - SMTP - seemed natural.
Is this a novel attack technique?

Most likely! Again, for two major reasons:

1. Microsoft's SMTP infrastructure including Exchange Online was vulnerable. This would have most likely been found and fixed by prior researchers.
2. We haven't found any research stating otherwise.
Are there other interesting SMTP and e-mailing attacks?

Yes, lots of them! For example, ["Weak Links in Authentication Chains: A Large-scale - Analysis of Email Sender Spoofing Attacks"](https://www.usenix.org/conference/usenixsecurity21/presentation/shen-kaiwen) shows a range of interesting attacks that even worked with Gmail!

Can confusions of <CR><LF> and <LF> and alike cause security issues in other protocols as well?

Yes, of course! In general, implementations of (sometimes) vague specifications can cause all kinds of security issues.

Have you scanned the whole Internet and tested ALL e-mailing services?

As already mentioned, scanning e-mail services for used software and versions may yield inaccurate results and will most likely get you on some kind of blacklist. The same goes for more specific end-of-data sequence checks, where basically a whole e-mail is sent. Therefore, we could roughly only analyze the top 10k of Alexa domains during this research.

### Are you interested in working at SEC Consult?

SEC Consult is always searching for talented security professionals to work in our team.
[More Information](/career/#c2854)
#### About the author

![Portrait of Timo Longin SEC Consult](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/Authors/a-TLO.png)Timo Longin
[Back](/blog/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all



=== Content from lists.fedoraproject.org_080fe6bc_20250114_192957.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/QRLF5SOS7TP5N7FQSEK2NFNB44ISVTZC/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/QRLF5SOS7TP5N7FQSEK2NFNB44ISVTZC/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/QRLF5SOS7TP5N7FQSEK2NFNB44ISVTZC/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/QRLF5SOS7TP5N7FQSEK2NFNB44ISVTZC/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-QRLF5SOS7TP5N7FQSEK2NFNB44ISVTZC.mbox.gz?message=QRLF5SOS7TP5N7FQSEK2NFNB44ISVTZC "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/QRLF5SOS7TP5N7FQSEK2NFNB44ISVTZC/#QRLF5SOS7TP5N7FQSEK2NFNB44ISVTZC)

# [SECURITY] Fedora 39 Update: postfix-3.8.4-1.fc39

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

10 Jan
2024

10 Jan
'24

7:17 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-c839e7294f
2024-01-11 01:15:19.066683
--------------------------------------------------------------------------------

Name : postfix
Product : Fedora 39
Version : 3.8.4
Release : 1.fc39
URL : <http://www.postfix.org>
Summary : Postfix Mail Transport Agent
Description :
Postfix is a Mail Transport Agent (MTA).

--------------------------------------------------------------------------------
Update Information:

Security fix for CVE-2023-51764.
--------------------------------------------------------------------------------
ChangeLog:

\* Tue Jan 2 2024 Jaroslav ��karvada jskarvad@redhat.com - 2:3.8.4-1
- New version
Resolves: rhbz#2255641
- Fixed SMTP smuggling vulnerability
Resolves: CVE-2023-51764
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2255563 - CVE-2023-51764 postfix: SMTP smuggling vulnerability
<https://bugzilla.redhat.com/show_bug.cgi?id=2255563>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-c839e7294f' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/QRLF5SOS7TP5N7FQSEK2NFNB44ISVTZC/#QRLF5SOS7TP5N7FQSEK2NFNB44ISVTZC)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from github.com_216eaec2_20250115_114602.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feeenvik1%2FCVE-2023-51764%2Fblob%2Fmain%2FScreenshots%2FScreenshot_1.png)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feeenvik1%2FCVE-2023-51764%2Fblob%2Fmain%2FScreenshots%2FScreenshot_1.png)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=eeenvik1%2FCVE-2023-51764)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eeenvik1](/eeenvik1)
/
**[CVE-2023-51764](/eeenvik1/CVE-2023-51764)**
Public

* [Notifications](/login?return_to=%2Feeenvik1%2FCVE-2023-51764) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Feeenvik1%2FCVE-2023-51764)
* [Star
   4](/login?return_to=%2Feeenvik1%2FCVE-2023-51764)

* [Code](/eeenvik1/CVE-2023-51764)
* [Issues
  0](/eeenvik1/CVE-2023-51764/issues)
* [Pull requests
  0](/eeenvik1/CVE-2023-51764/pulls)
* [Actions](/eeenvik1/CVE-2023-51764/actions)
* [Projects
  0](/eeenvik1/CVE-2023-51764/projects)
* [Security](/eeenvik1/CVE-2023-51764/security)
* [Insights](/eeenvik1/CVE-2023-51764/pulse)

Additional navigation options

* [Code](/eeenvik1/CVE-2023-51764)
* [Issues](/eeenvik1/CVE-2023-51764/issues)
* [Pull requests](/eeenvik1/CVE-2023-51764/pulls)
* [Actions](/eeenvik1/CVE-2023-51764/actions)
* [Projects](/eeenvik1/CVE-2023-51764/projects)
* [Security](/eeenvik1/CVE-2023-51764/security)
* [Insights](/eeenvik1/CVE-2023-51764/pulse)

## Files

 main
## Breadcrumbs

1. [CVE-2023-51764](/eeenvik1/CVE-2023-51764/tree/main)
2. /[Screenshots](/eeenvik1/CVE-2023-51764/tree/main/Screenshots)
/
# Screenshot\_1.png

Copy path
## Latest commit

## History

[History](/eeenvik1/CVE-2023-51764/commits/main/Screenshots/Screenshot_1.png)7.62 KB main
## Breadcrumbs

1. [CVE-2023-51764](/eeenvik1/CVE-2023-51764/tree/main)
2. /[Screenshots](/eeenvik1/CVE-2023-51764/tree/main/Screenshots)
/
# Screenshot\_1.png

Top
## File metadata and controls

7.62 KB![Screenshot_1.png](https://github.com/eeenvik1/CVE-2023-51764/blob/main/Screenshots/Screenshot_1.png?raw=true)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from fahrplan.events.ccc.de_c5aa1a3a_20250114_192945.html ===


# Schedule 37th Chaos Communication Congress

* [Overview](/congress/2023/fahrplan/index.html)
* [Wednesday
  -
  2023-12-27](/congress/2023/fahrplan/schedule/1.html)
* [Thursday
  -
  2023-12-28](/congress/2023/fahrplan/schedule/2.html)
* [Friday
  -
  2023-12-29](/congress/2023/fahrplan/schedule/3.html)
* [Saturday
  -
  2023-12-30](/congress/2023/fahrplan/schedule/4.html)
* [Speakers](/congress/2023/fahrplan/speakers.html)
* [Events](/congress/2023/fahrplan/events.html)
* [timeline](/congress/2023/fahrplan/timeline.html)
* [book](/congress/2023/fahrplan/booklet.html)
* [QR-Code](/congress/2023/fahrplan/qrcode.html)

Version Nichts ist wahr. Alles ist erlaubt.

## Lecture: SMTP Smuggling â Spoofing E-Mails Worldwide

###

![](/congress/2023/fahrplan/system/events/logos/000/011/782/large/SMTP_Smuggling-37C3_Logo.png)

Introducing a novel technique for e-mail spoofing.

SMTP, the Simple Mail Transfer Protocol, allows e-mailing since 1982. This easily makes it one of the oldest technologies amongst the Internet. However, even though it seems to have stood the test of time, there was still a trivial but novel exploitation technique just waiting to be discovered â SMTP smuggling!

In this talk, weâll explore how SMTP smuggling breaks the interpretation of the SMTP protocol in vulnerable server constellations worldwide, allowing some more than unwanted behavior. Sending e-mails as admin@microsoft.com to fortune 500 companies â while still passing SPF checks â will be the least of our problems!

From identifying this novel technique to exploiting it in one of the most used e-mail services on the Internet, weâll dive into all the little details this attack has to offer. Therefore, in this talk, weâll embark on an expedition beyond the known limits of SMTP, and venture into the uncharted territories of SMTP smuggling!

### Info

**Day:**
[2023-12-27](/congress/2023/fahrplan/schedule/1.html)

**Start time:**
22:05

**Duration:**
00:40

**Room:**
Saal Zuse

**Track:**
[Security](/congress/2023/fahrplan/events.html#security)

**Language:**
en

### Links:

* [iCalendar](/congress/2023/fahrplan/events/11782.ics)

### Feedback

[Click here to let us know how you liked this event.](https://frab.cccv.de/en/37c3/public/events/11782/feedback/new)

### Concurrent Events

### Speakers

|  | [Timo Longin](/congress/2023/fahrplan/speakers/19110.html) |
| --- | --- |

This schedule was generated with [frab](http://frab.github.io/frab/).

Archived page - [Impressum/Datenschutz](https://legal.cccv.de/)

=== Content from github.com_c2540f1e_20250115_114604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feeenvik1%2FCVE-2023-51764%2Fblob%2Fmain%2FScreenshots%2FScreenshot_3.png)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feeenvik1%2FCVE-2023-51764%2Fblob%2Fmain%2FScreenshots%2FScreenshot_3.png)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=eeenvik1%2FCVE-2023-51764)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eeenvik1](/eeenvik1)
/
**[CVE-2023-51764](/eeenvik1/CVE-2023-51764)**
Public

* [Notifications](/login?return_to=%2Feeenvik1%2FCVE-2023-51764) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Feeenvik1%2FCVE-2023-51764)
* [Star
   4](/login?return_to=%2Feeenvik1%2FCVE-2023-51764)

* [Code](/eeenvik1/CVE-2023-51764)
* [Issues
  0](/eeenvik1/CVE-2023-51764/issues)
* [Pull requests
  0](/eeenvik1/CVE-2023-51764/pulls)
* [Actions](/eeenvik1/CVE-2023-51764/actions)
* [Projects
  0](/eeenvik1/CVE-2023-51764/projects)
* [Security](/eeenvik1/CVE-2023-51764/security)
* [Insights](/eeenvik1/CVE-2023-51764/pulse)

Additional navigation options

* [Code](/eeenvik1/CVE-2023-51764)
* [Issues](/eeenvik1/CVE-2023-51764/issues)
* [Pull requests](/eeenvik1/CVE-2023-51764/pulls)
* [Actions](/eeenvik1/CVE-2023-51764/actions)
* [Projects](/eeenvik1/CVE-2023-51764/projects)
* [Security](/eeenvik1/CVE-2023-51764/security)
* [Insights](/eeenvik1/CVE-2023-51764/pulse)

## Files

 main
## Breadcrumbs

1. [CVE-2023-51764](/eeenvik1/CVE-2023-51764/tree/main)
2. /[Screenshots](/eeenvik1/CVE-2023-51764/tree/main/Screenshots)
/
# Screenshot\_3.png

Copy path
## Latest commit

## History

[History](/eeenvik1/CVE-2023-51764/commits/main/Screenshots/Screenshot_3.png)6.42 KB main
## Breadcrumbs

1. [CVE-2023-51764](/eeenvik1/CVE-2023-51764/tree/main)
2. /[Screenshots](/eeenvik1/CVE-2023-51764/tree/main/Screenshots)
/
# Screenshot\_3.png

Top
## File metadata and controls

6.42 KB![Screenshot_3.png](https://github.com/eeenvik1/CVE-2023-51764/blob/main/Screenshots/Screenshot_3.png?raw=true)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.fedoraproject.org_f260cd34_20250114_192954.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/JQ5WXFCW2N6G2PH3JXDTYW5PH5EBQEGO/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/JQ5WXFCW2N6G2PH3JXDTYW5PH5EBQEGO/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/JQ5WXFCW2N6G2PH3JXDTYW5PH5EBQEGO/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/JQ5WXFCW2N6G2PH3JXDTYW5PH5EBQEGO/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-JQ5WXFCW2N6G2PH3JXDTYW5PH5EBQEGO.mbox.gz?message=JQ5WXFCW2N6G2PH3JXDTYW5PH5EBQEGO "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/JQ5WXFCW2N6G2PH3JXDTYW5PH5EBQEGO/#JQ5WXFCW2N6G2PH3JXDTYW5PH5EBQEGO)

# [SECURITY] Fedora 38 Update: postfix-3.7.9-1.fc38

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

11 Jan
2024

11 Jan
'24

2:17 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-5c186175f2
2024-01-11 02:15:43.703889
--------------------------------------------------------------------------------

Name : postfix
Product : Fedora 38
Version : 3.7.9
Release : 1.fc38
URL : <http://www.postfix.org>
Summary : Postfix Mail Transport Agent
Description :
Postfix is a Mail Transport Agent (MTA).

--------------------------------------------------------------------------------
Update Information:

Security fix for CVE-2023-51764.
--------------------------------------------------------------------------------
ChangeLog:

\* Tue Jan 2 2024 Jaroslav ��karvada jskarvad@redhat.com - 2:3.7.9-1
- New version
Resolves: rhbz#2255641
- Fixed SMTP smuggling vulnerability
Resolves: CVE-2023-51764
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2255563 - CVE-2023-51764 postfix: SMTP smuggling vulnerability
<https://bugzilla.redhat.com/show_bug.cgi?id=2255563>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-5c186175f2' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/JQ5WXFCW2N6G2PH3JXDTYW5PH5EBQEGO/#JQ5WXFCW2N6G2PH3JXDTYW5PH5EBQEGO)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from www.openwall.com_24208493_20250114_192959.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2024/01/20/1) [[next>]](2) [[thread-next>]](../../../2024/01/23/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20240122142906.GA4821@openwall.com>
Date: Mon, 22 Jan 2024 15:29:06 +0100
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Cc: Wietse Venema <wietse@...cupine.org>
Subject: Postfix updated SMTP smuggling countermeasure

If I'm reading this right, the initial implementation of Postfix
smtpd_forbid_bare_newline disallowed bare LF not only at the end of
DATA, but also elsewhere in the SMTP session.  This is now relaxed in
the recommended "smtpd_forbid_bare_newline = normalize" mode to apply
only to the end of DATA, while allowing bare LFs elsewhere.  This is
sufficient to prevent the attack while having better compatibility with
existing SMTP clients.

----- Forwarded message from Wietse Venema via Postfix-announce <postfix-announce@...tfix.org> -----

To: Postfix announce <postfix-announce@...tfix.org>
Date: Mon, 22 Jan 2024 09:01:59 -0500 (EST)
Subject: [pfx-ann] Postfix stable release 3.8.5, 3.7.10, 3.6.14, 3.5.24
From: Wietse Venema via Postfix-announce <postfix-announce@...tfix.org>
Reply-To: Wietse Venema <wietse@...cupine.org>

[An on-line version of this announcement will be available at
<https://www.postfix.org/announcements/postfix-3.8.5.html>]

[Fixes for Postfix versions < 3.5 will be announced at
<https://www.postfix.org/smtp-smuggling.html>]

Postfix stable release 3.8.5, 3.7.10, 3.6.14, 3.5.24

Security: this release improves support to defend against an email
spoofing attack (SMTP smuggling) on recipients at a Postfix server. For
background, see <https://www.postfix.org/smtp-smuggling.html>.

The improvements provide better logging, and better compatibility with
existing SMTP clients (less need to allowlist clients).

Sites concerned about SMTP smuggling attacks should enable this feature
on Internet-facing Postfix servers. For compatibility with non-standard
clients, Postfix by default excludes clients in mynetworks from this
countermeasure.

The recommended settings are:

    # Require the standard End-of-DATA sequence <CR><LF>.<CR><LF>.
    # Otherwise, allow bare <LF> and process it as if the client sent
    # <CR><LF>.
    #
    # This maintains compatibility with many legitimate SMTP client
    # applications that send a mix of standard and non-standard line
    # endings, but will fail to receive email from client implementations
    # that do not terminate DATA content with the standard End-of-DATA
    # sequence <CR><LF>.<CR><LF>.
    #
    # Such clients can be allowlisted with smtpd_forbid_bare_newline_exclusions.
    # The example below allowlists SMTP clients in trusted networks.
    #
    smtpd_forbid_bare_newline = normalize
    smtpd_forbid_bare_newline_exclusions = $mynetworks

Notes:

  * The default setting is "smtpd_forbid_bare_newline = no" in Postfix
    releases < 3.9, for compatibility reasons. This means that Postfix
    is by default vulnerable to SMTP smuggling.

  * The new setting "smtpd_forbid_bare_newline = normalize" is the
    default for Postfix releases 3.9 and later.

  * The old setting "smtpd_forbid_bare_newline = yes" is now an alias for
    "smtpd_forbid_bare_newline = normalize".

  * The new setting "smtpd_forbid_bare_newline = reject" will refuse
    commands or message content with a bare newline. For details see
    the RELEASE_NOTES or the postconf(5) documentation.

You can find the updated Postfix source code at the mirrors listed
at <https://www.postfix.org/>.

	Wietse
_______________________________________________
Postfix-announce mailing list -- postfix-announce@...tfix.org
To unsubscribe send an email to postfix-announce-leave@...tfix.org

----- End forwarded message -----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.mail-archive.com_282ccb71_20250115_114610.html ===


[Skip to site navigation (Press enter)](#nav)

# [[pfx] SMTP Smuggling short & long term fixes](/search?l=postfix-users@postfix.org&q=subject:%22%5C%5Bpfx%5C%5D+SMTP+Smuggling+short+%5C%26+long+term+fixes%22&o=newest)

[Wietse Venema via Postfix-users](/search?l=postfix-users@postfix.org&q=from:%22Wietse+Venema+via+Postfix%5C-users%22)
[Wed, 20 Dec 2023 07:51:52 -0800](/search?l=postfix-users@postfix.org&q=date:20231220)

```
As part of a non-responsible disclosure process, SEC Consult has
published an email spoofing attack that involves a composition of
different mail service behaviors with respect to broken line endings.
```
```

A short-term fix may deployed now, before the upcoming long holiday:

- Postfix 3.9 (stable release early 2024), rejects unuthorised
  pipelining by default: "smtpd_forbid_unauth_pipelining = yes".

- Postfix 3.8.1, 3.7.6, 3.6.10 and 3.5.20 include the same feature,
  but the "smtpd_forbid_unauth_pipelining" parameter defaults to
  "no".

Setting "smtpd_forbid_unauth_pipelining = yes" may break legitimate
SMTP clients that mis-implement SMTP, but such clients are exceedingly
rare, especially when email is sent across the Internet.

This short-term fix will stop the published form of the attack, but
other forms exist that will not be stopped in this manner.

The longer-term fix stops all forms of the smuggling attacks and is
in testing. For most sites, this fix will be too late for deployment
before a long holiday break, when typically production changes are
not allowed until January.

Timeline:
Dec 18 SEC Consult publishes an attack (composition of mail service behaviors)
Dec 19 Implement fix for Postfix, start testing and Q/A
Dec ?? Publish updated stable Postfix versions 3.8, 3.7, 3.6, 3.5
Dec 23 First day of a 10+ day holiday break and production freeze

References:
<https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/>

        Wietse
_______________________________________________
Postfix-users mailing list -- postfix-users@postfix.org
To unsubscribe send an email to postfix-users-le...@postfix.org

```

* [Previous message](msg100882.html)
* [View by thread](index.html#100901)
* [View by date](maillist.html#100901)
* [Next message](msg100903.html)

* [pfx] SMTP Smuggling short & long te... Wietse Venema via Postfix-users
* + [[pfx] Re: SMTP Smuggling short &amp...](msg100903.html) Linkcheck via Postfix-users
  + - [[pfx] Re: SMTP Smuggling short ...](msg100904.html) Wietse Venema via Postfix-users
    - * [[pfx] Re: SMTP Smuggling sh...](msg100905.html) Linkcheck via Postfix-users
    - [[pfx] Re: SMTP Smuggling short ...](msg100906.html) Linkcheck via Postfix-users
  + [[pfx] Re: SMTP Smuggling short &amp...](msg100916.html) Wietse Venema via Postfix-users
  + - [[pfx] Re: SMTP Smuggling short ...](msg100917.html) Viktor Dukhovni via Postfix-users

## Reply via email to

[![The Mail Archive](/logo.png)](/)

Search the site

* [The Mail Archive home](/)
* [postfix-users - all messages](/postfix-users%40postfix.org/)
* [postfix-users - about the list](/postfix-users%40postfix.org/info.html)
* [Expand](/search?l=postfix-users@postfix.org&q=subject:%22%5C%5Bpfx%5C%5D+SMTP+Smuggling+short+%5C%26+long+term+fixes%22&o=newest&f=1 "e")
* [Previous message](msg100882.html "p")
* [Next message](msg100903.html "n")

* [The Mail Archive home](/)
* [Add your mailing list](/faq.html#newlist)
* [FAQ](/faq.html)
* [Support](/faq.html#support)
* [Privacy](/faq.html#privacy)
* 4SwJ2F5sJXzJrP1@spike.porcupine.org



=== Content from lwn.net_0e153a6e_20250114_192958.html ===


[![LWN.net Logo](https://static.lwn.net/images/logo/barepenguin-70.png)
LWN
.net
News from the source](/)
[![LWN](https://static.lwn.net/images/lcorner-ss.png)](/)

* [**Content**](#t)
  + [Weekly Edition](/current/)
  + [Archives](/Archives/)
  + [Search](/Search/)
  + [Kernel](/Kernel/)
  + [Security](/Security/)
  + [Events calendar](/Calendar/)
  + [Unread comments](/Comments/unread)
  + ---
  + [LWN FAQ](/op/FAQ.lwn)
  + [Write for us](/op/AuthorGuide.lwn)
* [**Edition**](#t)
  + [Return to the Front page](/Articles/955922/)

**User:**
**Password:**    |

 |

[**Subscribe**](/subscribe/) /
[**Log in**](/Login/) /
[**New account**](/Login/newaccount)

# Smuggling email inside of email

By **Jake Edge**
January 3, 2024

Normally, when a new vulnerability is discovered and releases are
coordinated with those affected, the announcement is done at
a convenient time—not generally right before the end-of-year holidays, for
example. The [SMTP
Smuggling vulnerability](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/) has taken a different path, however, with its
announcement landing on December 18. That may well have been
unpleasant for some administrators that had not yet updated, but it was
particularly problematic for
some projects that had not been made aware of the vulnerability at
*all*—though it was known to affect several open-source mailers.

#### Discovery and disclosure

The vulnerability was discovered by Timo Longin of [SEC Consult](https://sec-consult.com/) back in June; the company
contacted three affected vendors, GMX, Microsoft, and Cisco in July. GMX
fixed the issue in August, and Microsoft did so in October, but Cisco
responded that the "identified vulnerability is just a feature of the
software and not a bug/vulnerability". That led SEC Consult to contact
the [CERT Coordination Center](https://www.kb.cert.org/vuls/)
(CERT/CC) for further assistance, using the [Vulnerability Information and
Coordination Environment](https://kb.cert.org/vince/) (VINCE) tool:

> There, we submitted all our research details and explained the case to the
> vendors involved. We received feedback from Cisco that our identified
> research is not a vulnerability, but a feature and that they will not
> change the default configuration nor inform their customers. Other vendors
> did not respond in VINCE but were contacted by CERT/CC.
>
> Based on this feedback and as multiple other vendors were included in this
> discussion through the CERT/CC VINCE platform without objecting, we wrongly
> assessed the broader impact of the SMTP smuggling research. Because of this
> assumption, we asked CERT/CC end of November regarding publication of the
> details and received confirmation to proceed.

> **$ sudo subscribe today**
>
> Subscribe today and elevate your LWN privileges. You’ll have
> access to all of LWN’s high-quality articles as soon as they’re
> published, and help support LWN in the process. [Act now](https://lwn.net/Promo/nst-sudo/claim) and you can start with a free trial subscription.

A [talk
about the vulnerability](https://events.ccc.de/congress/2023/hub/en/event/smtp_smuggling_spoofing_e-mails_worldwide/) was accepted for the [37th Chaos
Communication Congress](https://events.ccc.de/congress/2023/hub/en/index) (37C3), which was held at the end of December.
So the vulnerability needed to be announced before that happened. The talk
acceptance occurred on December 3 and the announcement came out
roughly two weeks later—just before the holidays.
The "wrongly assessed" wording in the quote above seems to indicate
that SEC Consult recognizes that it made a mistake here. In addition, the
talk is [said](https://chaos.social/%40Foxboron/111621156200642472)
to have contained "a decent apology".

One of the other "vendors" mentioned in the (admirably
detailed) blog post is Sendmail, but Postfix is mentioned elsewhere as well.
It is clear that SEC Consult was fully aware that those two mailers were
vulnerable, but the company apparently relied on CERT/CC to involve
additional affected projects, which just as clearly did not happen. For
example, Postfix creator and maintainer Wietse Venema [called](https://www.mail-archive.com/postfix-users%40postfix.org/msg100901.html)
the vulnerability announcement "part of a non-responsible disclosure
process"; he softened that stance somewhat in a Postfix [SMTP Smuggling page](https://www.postfix.org/smtp-smuggling.html),
but still
noted that "[critical] information provided by the researcher was not
passed on to Postfix maintainers before publication of the attack".
The result was "a presumably unintended zero-day attack", he said.

#### Vulnerability

The [Simple
Mail Transfer Protocol](https://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol) (SMTP), which is described in [RFC 5321](https://datatracker.ietf.org/doc/html/rfc5321),
provides a text-based protocol for submitting and exchanging email on the
net.
At some level, this flaw is another indication that the "[robustness
principle](https://en.wikipedia.org/wiki/Robustness_principle)" (also known as "Postel's law") was not actually all that
sound from a security standpoint; being liberal in what is accepted
over-the-wire has often led to problems. In this case, the handling of
line endings in conjunction with the SMTP end-of-data indication can lead
to situations where email can be successfully spoofed—leading to rogue
email that passes
various checks for authenticity.

The SMTP DATA command is used for the actual text that will appear in an
email, including headers and the like; the so-called "envelope", which
describes the sender and receiver, is another
set of SMTP commands (EHLO, MAIL FROM, RCPT TO) that precede the DATA. The
blog post announcing the vulnerability has lots of diagrams and explanations
for those who want all the gory details. The DATA command is ended with
a line that is blank except for a single period ("."); the line endings for
SMTP are defined to be carriage-return (CR or "\r") followed by
line-feed (LF or "\n"), so end-of-data should be signaled with
"\r\n.\r\n".

It turns out that some mailers will accept just a line-feed as the line
terminator, but others will not; there is a difference
in interpretation of "\n.\n" that can be used to smuggle an
email message inside another:
```

    EHLO ...
    MAIL FROM: ...
    RCPT TO: ...
    DATA
    From: ...
    To: ...
    Subject: ...

    innocuous email text
    \n.\n
    MAIL FROM: <admin@...>
    RCPT TO: <victim@...>
    DATA
    From: Administrator <admin@...>
    To: J. Random Victim <victim@...>
    Subject: Beware of phishing scams

    Like this one
    \r\n.\r\n

```
The second set of commands is in the text of the email, if the
SMTP server receiving it does not consider
"\n.\n" as the termination of the
DATA command. That email will be sent to another SMTP server, however,
which may see things rather differently. If the SMTP server for the
destination sees that line as terminating the data, it may start
processing what comes next as entirely new email. It is a
vulnerability that
is analogous to [HTTP request
smuggling](https://en.wikipedia.org/wiki/HTTP_request_smuggling), which is where the name comes from.

There are also variations on the line endings (e.g. "\n.\r\n")
that can
be used to fool various
mailers. The core of the idea is to have the outbound mail server
ignore the "extra stuff" as part of the initial email message
and send the mail on to a server that sees the
single message as more than one—and acts accordingly. [SPF](https://en.wikipedia.org/wiki/Sender_Policy_Framework)
checks can be made to pass and even [DKIM](https://en.wikipedia.org/wiki/DomainKeys_Identified_Mail) can be spoofed by using an
attacker-controlled DKIM key in the smuggled headers. [DMARC](https://en.wikipedia.org/wiki/DMARC) can be used to thwart
the smuggling, but common configurations of it are still vulnerable.
In addition, because
mail servers, especially those of the larger
email providers, often handle multiple domains, there is an opportunity to
smuggle email that purports to
come from different
domains inside innocuous-seeming messages to users of those services.

The blog post mostly concentrates on the three vendors identified, but
clearly notes that "Postfix and Sendmail [fulfill] the requirements, are
affected and can be smuggled to". It provides several lists of domains
that can be spoofed via GMX, Microsoft Exchange Online, or Cisco Secure
Email Cloud Gateway. In fact, SEC Consult uses the Cisco product itself,
so the company has changed its settings away from the default to avoid the
problem, which Cisco does not acknowledge as any kind of bug.

#### Postfix and beyond

Meanwhile, over in open-source land, folks seemed rather astonished that
the vulnerability dropped with no warning. Marcus Meissner [posted](/ml/oss-security/20231221143630.GD14101%40suse.de/) about the vulnerability
to the oss-security mailing list: "As if we did not have sufficient
protocol vulnerability work short[ly] before
Christmas break this year, here is one more". He is likely referring
to the [Terrapin
vulnerability in the SSH protocol](/ml/oss-security/a8637927-82b1-4f95-a7e8-7aa6cbaca455%40rub.de/), which was [announced](https://terrapin-attack.com/) on December 18—well after
coordinating with many different SSH implementation projects. The SMTP
Smuggling vulnerability followed a rather different path, as Stuart
Henderson [pointed
out](/ml/oss-security/ZYVufT0sq16Z-M43%40symphytum.spacehopper.org/):
> I'm a little confused by sec-consult's process here. They identify a
> problem affecting various pieces of software including some very widely
> deployed open source software, go to the trouble of doing a coordinated
> disclosure, but only do that with...looking at their timeline... gmx,
> microsoft and cisco?

Meissner [noted](/ml/oss-security/20231222121134.GI14101%40suse.de/) that SUSE
was not alerted to the problem via VINCE and that the Postfix timeline (in
Venema's post) only started after the announcement. Erik Auerswald [speculated](/ml/oss-security/20231222150438.GA13989%40unix-ag.uni-kl.de/)
that SEC Consult expected CERT/CC to alert other affected projects; instead
it would seem that CERT/CC gave the go-ahead to release the findings.
After Rodrigo Freire [wondered](/ml/oss-security/CAHjsZGbiZYGug2L04iZ%2BVEmMg-pdfKyKOGdcSeCLnsZYd0Vm2Q%40mail.gmail.com/)
why the problem was considered a vulnerability, Auerswald [explained](/ml/oss-security/20231222175221.GA7191%40unix-ag.uni-kl.de/):
> Any user of an affected outbound server can spoof email from any user of
> the same outbound server despite SPF and DKIM (DMARC+DKIM can prevent this
> in some cases, also more senders can be spoofed in specific cases, for
> details see the blog post). But for this to work, the inbound server
> must act as a confused deputy. Both outbound and inbound servers need to
> be differently vulnerable to enable the attack. This specific attack can
> be prevented unilaterally on either the outbound or the inbound server.
>
> [...] For email server open source projects, relevant for the oss-security
> list, the primary vulnerability is to act as a confused deputy inbound
> server, because users of such email servers usually have a much smaller
> number of accounts than the big freemail providers. But, in general,
> they could also possibly act as a vulnerable outbound server, e.g.,
> after a [legitimate] user account has been compromised.

CVEs for Sendmail, Postfix, and Exim have [been assigned](/ml/oss-security/20231224093335.GM14101%40suse.de/).
Postfix has released updates with a new [smtpd\_forbid\_bare\_newline](https://www.postfix.org/postconf.5.html#smtpd_forbid_bare_newline)
option (that defaults to off, but will default to on in the upcoming
Postfix 3.9 release); those who do not want to upgrade can work around
most of the problems using existing options. Exim has [an
advisory](/ml/oss-security/20231229130718.GA6740%40openwall.com/), [bug
report](https://bugs.exim.org/show_bug.cgi?id=3063), and bug-fix release (4.97.1) for the problem. Sendmail has a [snapshot
release (8.18.0.2)](/ml/oss-security/20231221144656.GA40693%40veps.esmtp.org/) with a new option to address the flaw as well.
However, other than Postfix updates from [SUSE](/Articles/956688/) and [Slackware](/Articles/956148/),
most distributions have not yet issued updates for this problem,
which leaves a lot of Linux users vulnerable.

So the major open-source mailer projects scrambled to fix the
vulnerability over the holidays, but the process has obviously failed
here. We have not (yet?) heard from CERT/CC for its side of the story, but
either it or SEC Consult should definitely have contacted those projects in
the multiple months that have gone by since the discovery.
Given that SEC Consult knew about Sendmail and Postfix, though, it is a
little hard to understand how a simple heads-up message to the security
contacts for those projects was not sent.

It seems likely
that there are smaller mailers and other tools that are still affected by
the flaw—though they may only have just heard of it—a month or two of
advance notice,
especially for small projects, could have made a lot of difference. One
can only hope that lessons are being learned here and that any coordination
will be better ... coordinated (and communicated) down the road.

| Index entries for this article | |
| --- | --- |
| [Security](/Security/Index/) | [Vulnerabilities/SMTP smuggling](/Security/Index/#Vulnerabilities-SMTP_smuggling) |

---

 to post comments

### Smuggling email inside of email

Posted Jan 4, 2024 2:06 UTC (Thu)
by **iabervon** (subscriber, #722)
[[Link](/Articles/956778/)]

The image at the beginning of the blog post has a useful bit of information that didn't make it to the example in the article: the first/outer email is from attacker@sender, while the second/embedded email is purportedly from admin@sender, such that receiver is not surprised by sender delivering the second email. More generally, it can be attacker@cohost1 and admin@cohost2, where the two sites are different but expected to be cohosted.

The purported sender's mailer has to consider the ambiguous sequence to be valid inside of an email, while the receiver's mailer has to consider the ambiguous sequence to be a valid terminator of an email. There are sequences mentioned for which various open-source mailers are vulnerable as receivers and big hosting providers and also mailers used by big companies are vulnerable as senders.

It looks to me like the researchers considered the sender side to be doing things particularly wrong, and also that the vulnerability was that messages purportedly from users at the sender site could be forged by other users with the sender site's participation adding credibility, and didn't think of it (also) as receivers failing to block detectably inauthentic messages. They contacted everyone who would need to implement what they thought of as the correct fix, but not other people who could have mitigated the problem differently.

### Smuggling email inside of email

Posted Jan 4, 2024 2:59 UTC (Thu)
by **akp@akp.dk** (subscriber, #73019)
[[Link](/Articles/956782/)]

Debian released fixed versions of Postfix too via their updates repositories, but apparently it wasn’t considered a security issue - only a bug: <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1059230>

### The confused Deputy

Posted Jan 4, 2024 9:55 UTC (Thu)
by **Wol** (subscriber, #4433)
[[Link](/Articles/956804/)] (1 responses)

Surely an early disclosure that certain projects are vulnerable as confused deputies if they misinterpret /r/n./r/n could/should have been made months ago?

"The RFC standard says you \*MUST\*, some projects don't, and this has been identified as a security vulnerability".

That's leaking bugger-all information to an attacker - how do they use it etc etc, and giving all recipients the opportunity to protect themselves, very quickly.

Cheers,

Wol

### The confused Deputy

Posted Jan 5, 2024 3:05 UTC (Fri)
by **kentonv** (**✭ supporter ✭**, #92073)
[[Link](/Articles/956952/)]

Ehh... I think for anyone who has spent time dealing with smuggling vulnerabilities before (e.g. in HTTP, where they abound), that would have been a big enough hint for them to figure out the problem.

### Smuggling email inside of email

Posted Jan 4, 2024 10:06 UTC (Thu)
by **roc** (subscriber, #30627)
[[Link](/Articles/956805/)] (37 responses)

Postel's Law was a blunder and we've spent decades fighting the damage caused by people following it.

Computing is hard, but well-intentioned yet clearly mistaken principles such as Postel's Law are self-inflicted wounds that have made things a lot harder than they could have been.

### Smuggling email inside of email

Posted Jan 4, 2024 10:35 UTC (Thu)
by **MarcB** (subscriber, #101804)
[[Link](/Articles/956809/)] (2 responses)

The irony is that the principle is not followed in its original scope of middle-boxes in low level network protocols - where it actually makes a lot of sense. This has led to the ossification of IP protocols.

Instead it was foolishly extended to endpoints and completely different scenarios. There it is invariably causing damage. It makes things less secure, less stable and so much more complex.

### Smuggling email inside of email

Posted Jan 4, 2024 18:13 UTC (Thu)
by **nim-nim** (subscriber, #34454)
[[Link](/Articles/956904/)] (1 responses)

> The irony is that the principle is not followed in its original scope of middle-boxes in low level network protocols - where it actually makes a lot of sense.

No it never made any sense. All those middle boxes were deployed because the fuzziness was breaking things right and left, they are designed to limit the spread of badly formatted traffic.

Of course some of this tightening went too far and led to ossification but it did not happen by mistake or because people wanted to prevent new protocol extensions, it happened because fuzziness was breaking endpoints.

And none of the war on middleboxes actually fixed things for the end user all it achieved is concentrating decision power MAGMA-side. Today Google and Amazon and Microsoft and Apple can decide whatever breakage they want there is nothing between their cloud and their browser with the browser acting as an hostile enclave of their cloud on the user terminal.

### Smuggling email inside of email

Posted Jan 4, 2024 21:56 UTC (Thu)
by **Wol** (subscriber, #4433)
[[Link](/Articles/956933/)]

> No it never made any sense. All those middle boxes were deployed because the fuzziness was breaking things right and left, they are designed to limit the spread of badly formatted traffic.

The problem is they are also designed to prevent the spread of correctly fornatted traffic, which is why port 80 is such a mess ...

Cheers,

Wol

### Smuggling email inside of email

Posted Jan 4, 2024 13:17 UTC (Thu)
by **smitty\_one\_each** (subscriber, #28989)
[[Link](/Articles/956822/)] (10 responses)

If one is too fussy, that can also become a bugaboo.

Maybe: s/liberal/skeptically moderate/ ?

### Smuggling email inside of email

Posted Jan 4, 2024 14:40 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956828/)] (5 responses)

It's not fussiness per-se that's a problem; it's going beyond the protocol specification in ways that make life harder that's a problem. For example, if the protocol says that the size field is encoded as hexadecimal digits in UTF-8, and that an implementation must accept at least 8 digits, insisting that the other side uses a multiple of 8 digits is "too fussy" - I should be able to send 1a2 as a size given that definition, and I should be able to send 1abcdef23, but if you require 000001a2 and 00000001abcdef23, we've got a problem.

And this problem becomes insoluble if a different implementation rejects leading zeroes; you now have two implementations being "fussy" in opposite directions, both of which can be justified against the protocol spec (which doesn't talk about leading zeroes at all). The "correct" fix is to tighten up the protocol specification so that one or both implementations are wrong, but that gets into social coordination problems about what the specification "should" be, and is especially problematic if both implementations are the way they are because that makes it easier to build on existing libraries.

### Smuggling email inside of email

Posted Jan 4, 2024 22:31 UTC (Thu)
by **Wol** (subscriber, #4433)
[[Link](/Articles/956937/)] (4 responses)

> The "correct" fix is to tighten up the protocol specification so that one or both implementations are wrong,

No. The correct fix is to implement the specification correctly. In your own example, the spec places no requirements on the sender. Therefore the receiver should place no requirements on the sender. Your example of the reciever demanding a multiple of 8 is a clear "gilding of the lily", overly strict, and breach of the specification. Okay, if the spec does not tell the receiver how it knows how many digits it has received - ie the spec does not contain sufficient information to implement itself correctly - then the specification needs to be corrected.

In this particular case, I'd be inclined to \*clarify\* the spec by saying "the sender can send as many or as few characters as it likes". That doesn't affect any implementation enforcing the current letter of the spec. Yes it breaks your receiver, but only because it's enforcing "restrictions not in the spec".-

I've actually been badly bitten (by a PHB) because of this sort of problem back when email switched from ASCII to 8-bit. Of course, it was MS that contradicted the letter of the spec, but because it was \*our\* Microsoft Mail that was at fault, the PHB blamed the ISP and demanded \*they\* fixed the problem.

The SMTP spec says that invalid commands must be rejected with a 200 error, and the receiver \*must\* then wait for a new command. So the 8-bit RFC revision said "if you want to start an 8-bit transmission, use EHLO rather than HELO to tell the recipient to expect an 8-bit transmission". So what does MS Mail do? "550 Invalid command connection terminated".

I think the ISP ended up creating a config option telling sendmail not to use EHLO for certain (like us) customers.

Cheers,

Wol

### Smuggling email inside of email

Posted Jan 4, 2024 22:34 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956940/)]

The specification does not say whether zero-padding is allowed or not - and yet one of the my examples is a receiver that insists on no zero-padding because it's "obviously" not needed, while another insists on zero-padding because it's "obviously" needed to indicate length.

And the spec is currently silent on zero-padding; changing the spec to say "no zero padding allowed" is one option. Changing it to say "zero or more leading zeroes are permitted" is another.

### Smuggling email inside of email

Posted Jan 5, 2024 10:49 UTC (Fri)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956964/)] (2 responses)

And, as an aside, this comment is exactly why the robustness principle leads to a mess; I showed two receivers that insisted on different things that aren't in the letter of the specification (one insisting on zero padding, the other insisting that it's not allowed).

You've focused on the one that's visibly weird (the one that insists on padding), and ignored the other one that's outside the specification; and yet both are problematic if you're trying to deal with arbitrary clients. It would be simple to fix the specification to declare what degree of zero padding is allowed, but that's currently out of scope - the spec as given permits me to sent petabytes of 0 digits followed by the real number.

And your anecdote is unrelated; you have a case where your local mail server does not obey the letter of RFC 821 (which states that you must remain "in the same state" as before the command was received if you receive an invalid command while waiting for a HELO); in RFC 821 SMTP, you're only supposed to close the transmission channel if you're shutting down service, or in response to a successful QUIT command. This is different to a case where both implementations are obeying the letter of the specification, but imposing additional requirements not contained in the spec, and both implementers believe that they're obeying the spec (after all, they accept numbers formatted as hex digits).

### Smuggling email inside of email

Posted Jan 5, 2024 13:58 UTC (Fri)
by **Wol** (subscriber, #4433)
[[Link](/Articles/956974/)] (1 responses)

I know my example was actually an explicit breach of the spec, but your example is also a breach of the spec. BOTH your receivers are refusing to accept a transmission that complies with the spec.

So imho no the spec does not need to be changed at all. At most it should be clarified as "the spec tells the sender to send a hex-formatted number, therefore the receiver must accept any valid hex-formatted number."

As I see it, my SMTP example yes it's easy to say MS Mail ignored the spec. But your example is to me exactly the same. The sender sent a valid (as per the spec) message. The receiver refused to accept and process it correctly. Sendmail sent us a validly formatted EHLO. MS Mail refused to accept and process it correctly. I would have thought "if the other party is behaving as per spec, then you are at fault unless the spec is contradictory" was just plain obvious!

Cheers,

Wol

### Smuggling email inside of email

Posted Jan 5, 2024 14:26 UTC (Fri)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956978/)]

But that's just my point - one of the two examples is a plausible interpretation of the specification, because leading zeroes aren't discussed either way. The other is less plausible, but could come up if you're using a library that insists on having padded input.

And by your reasoning, the spec intends that implementations are capable of consuming petabytes of leading zeroes as part of accepting a hex-formatted number less than 10, otherwise they're in breach of the specification - but this is clearly absurd, and unlikely to be what the spec author intended. This is *why* you should fix the specification, not the implementations, since we've got behaviour that's not discussed but should be.

The reason your SMTP example is different is that the specification for SMTP explicitly says that a server keeps the connection open after a bad command - we're not talking about something that's omitted from the spec (are leading zeroes part of a valid hex-formatted number or not?), but about something that's in the spec but where your server deviated from the specification.

### Smuggling email inside of email

Posted Jan 4, 2024 19:54 UTC (Thu)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/956913/)] (3 responses)

I remember reading about the new robustness law: "Be as strict as possible in what you accept, and be slightly evil in what you send".

For example, if you provide a list of allowed encodings during the negotiation, then randomize the order, and maybe stuff a couple of non-existing encodings.

### Smuggling email inside of email

Posted Jan 5, 2024 10:52 UTC (Fri)
by **smitty\_one\_each** (subscriber, #28989)
[[Link](/Articles/956966/)] (1 responses)

"...and here's a little WTF-8 for my homies..."

### Smuggling email inside of email

Posted Jan 5, 2024 21:09 UTC (Fri)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/957040/)]

That's not "slightly", that's just evil.

### Smuggling email inside of email

Posted Jan 5, 2024 11:04 UTC (Fri)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956967/)]

Your "non-existing encodings" bit reminded me of [Raymond Chen on a driver compatibility issue in DirectX](https://devblogs.microsoft.com/oldnewthing/20040211-00/?p=40663); the OS would ask the driver "do you support this optional feature, GUID xxx?" and the driver in question always said "yes", causing issues when you used that feature.

The solution was to come up with a way to generate "impossible" features at runtime, and if your driver claimed to support such a feature, it was known to be lying about optional feature support and could be ignored.

### Smuggling email inside of email

Posted Jan 4, 2024 14:42 UTC (Thu)
by **rrolls** (subscriber, #151126)
[[Link](/Articles/956838/)] (20 responses)

Postel's Law is great for processing that is started directly by the intended user (and usually, a human being) and then completed as soon as possible (with that intended user being notified about it). I suspect it was originally written with that in mind, but because of the era, the condition was never stipulated.

For the "liberal in what you accept": if I'm trying to retrieve some value from some old file that only partially complies with a standard that's many years younger than the file, I want the program to do its utmost to retrieve that value; if the deviations from the standard are enough to prevent this from being possible, it's generally pretty obvious from the output.

Similarly, for the "conservative in what you do": if I'm collecting a whole bunch of data into one file to be sent off elsewhere, I'd want that file to be as simple and compliant as possible (in terms of its syntax/encoding), so that it's useful as input to the widest possible range of other programs.

Where Postel's Law is terrible is the case of processing that is started by some unattended, always-available server receiving something - indeed, like an email server. "Liberal in what you accept" is useful when the user is the intended user; but if the user is a malicious user instead, it's going to be just as useful to them. There's even an argument for not being "conservative in what you do" - this is the argument for "security by obscurity". (Whether this is a good argument or not is a different matter entirely.)

### Smuggling email inside of email

Posted Jan 4, 2024 14:54 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956860/)]

I've found a useful summary to be "Postel's Law applies only when one side of the conversation is intended to be a human". For machine-to-machine communications (as SMTP, IMAP and others are now), Postel's Law is outright hazardous.

This also plays into other things people do; for example, the problem with binary protocols and file formats is that you can't use tools intended to show text to a human to decode them. But if the intent is to use tools intended to handle that protocol or file format exclusively, you can do just as well with an unambiguous and well-designed binary format.

### Smuggling email inside of email

Posted Jan 4, 2024 15:32 UTC (Thu)
by **adobriyan** (subscriber, #30858)
[[Link](/Articles/956861/)] (17 responses)

> Postel's Law is great

No, it's just terrible. One key distinction between computers and humans is that computers are extremely precise and humans are extremely imprecise (especially in comparison). It very easy to lower computers to human level (just ship whatever buggy code at the moment), but it is \_impossible\_ to uplift humans to computer levels of precision.

Consequently, making computer second guess the human doesn't work. The best example is probably Excel guessing dates vs non-dates. It went as far as scientists renaming genes.

I was unfortunate to use a spreadsheet few years ago and naturally used some Linux clone. All I did is to paste like 10 floats into cells and it guessed format of the data on the \_first\_ try \_wrong. The very first interaction with a program is a bug. Of course it was done for user-friendliness and Excel compatibility and whatever reasons but bug is a bug is a bug. Encountering a bug immediately while doing nothing unusual suggests very high rate of this problem across all users.

It is bad that programmers misinterpret specs and write spec violations, it's ten times bad when managers force programmers to do so.

In a perfect world interacting with Excel will be like this:

\* user pasted data (or opens csv),

\* all new data are marked with red meaning "computer have no idea what the data mean",

\* user marks the data as "integer", "date", "real number" etc making them green in bulk or individually,

\* no processing takes place until data are made green.

Of course this is not happening, because asking user to explain to the computer what he means is somewhere around ethnic cleansing levels of human rights violations.

AI/ML companies show the problem very well now, where single digit percent failures are celebrated because humans sometimes perform even worse.

This particular SMTP bug is more of a confusion by 2 common newline types and "streaming" property of SMTP where there is no LEN command unambiguously identifying length of the message (to this day! [citation needed]).

The better Postel's law example is probably browser interpreting broken closing tags and reordering them internally.

This is perfect "we can't break popular website with in new update, can you fix it by Friday?" moment.

### Smuggling email inside of email

Posted Jan 4, 2024 15:58 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956865/)] (14 responses)

Some computer behaviour is simply annoying, though. For example, a JSON list is technically incorrect if there's a comma after the last element of the list but before the ], even though there's only one possible way to fix the input to be valid JSON. A good system will take that input data, recognise that there's only one possible edit that makes it sensible, and ask the user if that's really what they meant - then, if it is, make that edit for them.

And that's the gap between good applications of Postel's Law and bad ones; in a good application of it, the computer is interacting with the user to get confirmation that its "liberalness" in what it's accepting is indeed correct. In a bad application, the computer makes assumptions about what was meant, and doesn't give the originator a way to correct its errors.

### Smuggling email inside of email

Posted Jan 4, 2024 18:03 UTC (Thu)
by **NYKevin** (subscriber, #129325)
[[Link](/Articles/956899/)] (7 responses)

Is there an advantage to prohibiting the trailing comma in the first place? Python allows it, and doesn't seem to suffer any problems as a result of that specific design decision.\* SQL also bans trailing commas in the SELECT clause (and a couple of other places), and I have no idea why.\*\* What software malfunction could be triggered or exacerbated by allowing a trailing comma?

\* Python has been mentioned, so the thread will now be derailed with people complaining about random other features of Python that are totally irrelevant to this conversation, but at least I \*tried\* to steer it towards Postel's law and JSON.

\*\* In the case of SQL, this is an anti-feature, because any code that wants to generate SQL has to go to the trouble of ensuring that every column name is followed by a comma, except for the last column.

### Smuggling email inside of email

Posted Jan 4, 2024 19:22 UTC (Thu)
by **excors** (subscriber, #95769)
[[Link](/Articles/956911/)]

I think the reason is that JSON was designed to be a subset of ECMAScript 3, so that it could be parsed in web browsers with eval(), and ES3 doesn't allow trailing commas in object literals (though ES5 does).

(Later it was realised that eval is a terrible way to parse potentially-untrusted input, and doesn't even work in general for trusted input, but the original recommendation was literally just `eval("window.val="+json\_string)`: [http://web.archive.org/web/20030205013518/http://crockfor...](http://web.archive.org/web/20030205013518/http%3A//crockford.com/JSON/js.html))

ES3 does allow trailing commas in array literals, but that's part of the weird 'elision' syntax where `[,].length == 1`, `[,,1,,].length == 4`, etc, and I suspect it was omitted from JSON because Douglas Crockford didn't like it, plus it would be confusingly inconsistent with the object literals. (Crockford's "JavaScript: The Good Parts" says "[JSLint] does not expect to see elided elements in array literals. Extra commas should not be used. A comma should not appear after the last element of an array literal or object literal because it can be misinterpreted by some browsers.")

And once the first version of JSON had been published, it was too late to make any syntax changes without causing major interoperability problems.

### Smuggling email inside of email

Posted Jan 4, 2024 20:12 UTC (Thu)
by **khim** (subscriber, #9252)
[[Link](/Articles/956917/)] (5 responses)

Is there an advantage to prohibiting the trailing comma in the first place?

The problem is not in trailing comma. The problem is in different programs treating the same input differently (precisely what we are discussion in the article, isn't it?)

It doesn't even matter about **how exactly** you interpret broken data. The key is that **different apps would interpret them differently**.

If you want to have auto-fixer for the JSON then **decouple it from JSON parser and make sure user may use it with all apps that s/he want's or needs to use it**.

### Smuggling email inside of email

Posted Jan 4, 2024 21:45 UTC (Thu)
by **NYKevin** (subscriber, #129325)
[[Link](/Articles/956931/)] (4 responses)

My argument, unreasonable though it may be, is essentially that Crockford should have used his magical crystal ball to predict that prohibiting trailing commas would inevitably become a nuisance. I'm not suggesting that anyone in 2023 should be going around emitting JSON that actually contains trailing commas - that way lies madness. If you want to have trailing commas and don't care about JSON compatibility, then switch to TOML (which explicitly specifies a trailing comma as legal in arrays, and otherwise does not use commas much), or some other format with the same property.

### Smuggling email inside of email

Posted Jan 7, 2024 6:53 UTC (Sun)
by **ssmith32** (subscriber, #72404)
[[Link](/Articles/957077/)] (3 responses)

I have worked with lots and lots of JSON, in a variety of environments, and have never once found this to be any kind of problem, nuisance or otherwise.

Do tell how this is a nuisance..?

I mean, if someone continually trips up and fails to skip appending a delimiter to the last item of a list... I certainly wouldn't want them anywhere near my serde code.. it's sort of a bog-standard thing.

### Smuggling email inside of email

Posted Jan 7, 2024 8:12 UTC (Sun)
by **mjg59** (subscriber, #23239)
[[Link](/Articles/957081/)]

When reordering elements, or moving elements between different lists, it's much easier if you can just cut and paste without then needing to edit. Requiring that the final element in a list be special makes that harder. Given that there's zero ambiguity here it's something that maybe makes life easier for people implementing a parser but makes life harder for everyone producing things consumed by that parser, and overall that feels like a poor tradeoff.

### Smuggling email inside of email

Posted Jan 7, 2024 10:28 UTC (Sun)
by **mbunkus** (subscriber, #87248)
[[Link](/Articles/957084/)]

Programs can easily create valid JSON files; that isn't the issue. The issue is that JSON is human-readable and is therefore used in many places where humans must edit/write it manually, too, e.g. for config files. However, it wasn't designed for that use case. Not allowing the list separator in the last place is one of the drawbacks, not having comments the most obvious other one. Us humans want to be able to easily edit things, switch lines around, copy-paste stuff & append it, ideally without having to worry about these minutiae.

JSON is pretty much the worst of both worlds. It can be used for human-editable scenarios, but isn't good at it. It can be used for data interchange, but it isn't good at that either (parsing requires much more time & memory than necessary; real problems with big integers in various implementations etc.). It's the typical case of being just good enough & easy enough to implement to be ubiquitous. And us developers find it easy to use 'cause it makes debugging data flow so easy. Meh…

### Smuggling email inside of email

Posted Jan 7, 2024 11:00 UTC (Sun)
by **ianmcc** (subscriber, #88379)
[[Link](/Articles/957089/)]

I have some python code that I used to use to collate grades. Depending on the course, different fields of some python dictionary would be relevant for the final grade, so it would be a few messy lines with some commented out, some new ones added, etc. It is convenient in python that you can have a leading comma on every line. If that wasn't the case and you commented out the last entry (or added a new one at the end) then you'd need to fix up the commas. Admittedly not a huge burden, but also a rather pointless. And definitely it would be a nuisance.

### Smuggling email inside of email

Posted Jan 4, 2024 20:06 UTC (Thu)
by **khim** (subscriber, #9252)
[[Link](/Articles/956914/)] (5 responses)

A good system will take that input data, recognise that there's only one possible edit that makes it sensible, and ask the user if that's really what they meant - then, if it is, make that edit for them.

No. Good user system accepts what is specified and rejects what is not specified.

Some computer behaviour is simply annoying, though. For example, a JSON list is technically incorrect if there's a comma after the last element of the list but before the ], even though there's only one possible way to fix the input to be valid JSON.

No. It may be spurious command or forgotten `0` easily. Or just lost large chunk of data.

Now, it may be good idea to **demand** trailing comma, instead.

This format may even be better that today's one, but that would be **different** format.

And yes, I'm saying that as someone who very much edits JSON files by hand.

As annoying as getting message “you JSON is invalid” is I **much** prefer it to the fuzzy formats which couldn't be parsed reliably at all. Just look on [vk.xml](https://raw.githubusercontent.com/KhronosGroup/Vulkan-Docs/main/xml/vk.xml) and try to imagine what kind of parser may give you answer to the simple question: what size if `CAMetalLayer` (or if it even have a type).

A good system will take that input data, recognise that there's only one possible edit that makes it sensible, and ask the user if that's really what they meant - then, if it is, make that edit for them.

Please don't. If you do that people would invariably submit garbage, “apply edit” without looking and then **complain that program doesn't work even if they did everything correctly.**

If you want then add something like this to your **text editor**. Don't duplicate that code and cause vulnerabilties that we are discussing here.

It's **perfect** example of what is happening if you apply such “niceties”.

### Smuggling email inside of email

Posted Jan 4, 2024 20:14 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956916/)] (4 responses)

You're contradicting yourself within your comment: do you want my system, of which my text editor is one component, to be able to work with me to correct entry errors, or is that bad, because my text editor, a component of my system, should be able to work with me to correct entry errors?

And my entire point is that when there's only one correction to be made, the system as a whole should work with me to recognise where my error is, not just apply that correction blindly - chances are good that in the JSON block [1,2,3,], I meant [1,2,3], but it's also possible that I didn't mean that, and I meant [1,2,3,4,5,6], but forgot three numbers. Actually asking me if I meant [1,2,3] instead of [1,2,3,] gives me a chance to say "um, no, that's not what I meant" and fix it manually if the correction is wrong.

### Smuggling email inside of email

Posted Jan 4, 2024 20:56 UTC (Thu)
by **khim** (subscriber, #9252)
[[Link](/Articles/956921/)] (3 responses)

You're contradicting yourself within your comment: do you want my system, of which my text editor is one component, to be able to work with me to correct entry errors, or is that bad, because my text editor, a component of my system, should be able to work with me to correct entry errors?

Text editor either should work with **any** JSON consumer than I may want to use (including, but not limited, various Google APIs, phone apps and raw python scripts) or it shouldn't be used.

I would much prefer it as entirely separate tool not attached to anything else at all, but as long as integration with “your system” is optional I may stomach it.

What I don't want is to **ever** be in a situation when someone uses your system and then assumes that **my** system have to provide such facilities, too.

Because that's where the slippery slope starts: different programs shouldn't treat the same file differently.

And my entire point is that when there's only one correction to be made, the system as a whole should work with me to recognise where my error is, not just apply that correction blindly - chances are good that in the JSON block [1,2,3,], I meant [1,2,3], but it's also possible that I didn't mean that, and I meant [1,2,3,4,5,6], but forgot three numbers. Actually asking me if I meant [1,2,3] instead of [1,2,3,] gives me a chance to say "um, no, that's not what I meant" and fix it manually if the correction is wrong.

I don't even care about what exactly “your system” does. I **do** care about the fact that as long as you attach that ability to “your system” I have to attach it to “my system”, too. And then we and up these insane piles of buggy code which implements the same improvements in 10 different ways and end up with crazy security vulnerabilities.

And **please** stop playing that card about how you may reject fixes. It was plausible 20 years ago. **Today we know it just doesn't work**. [Dancing pigs](https://en.wikipedia.org/wiki/Dancing_pigs) would ensure that after “your system” would be adopted by masses it would work as if that question about what to do with fixes doesn't even exist.

The only way to achieve something even remotely resembling security is to ensure that all these “fixes” are **not offered automatically** and user **explicitly** and **consciously** opts in into them.

### Smuggling email inside of email

Posted Jan 4, 2024 21:05 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956924/)] (2 responses)

My "system" is a computer running software. Since you're being abundantly clear that your system is not a computer running software, what is it, and how does it interact with my system?

I'm going back to where Postel's Law comes from - it's a bad UX when the computer clearly knows what is wrong with your input, but does nothing to help you - [this bit of humour about systems that work that way](https://www.gnu.org/fun/jokes/ed-msg.en.html) is very funny, BTW - but it's also a bad UX in the long run if the computer blindly autocorrects for you.

And taking you at face value, you seem to be claiming that compilers giving me suggestions in the output, which I can then apply if I believe the computer is correct is "Today we know it just doesn't work." - and yet clang, rustc and GCC all do exactly that, telling me what they think I intended given what I've written. I can then accept or reject that change as I see fit.

### Smuggling email inside of email

Posted Jan 4, 2024 21:26 UTC (Thu)
by **khim** (subscriber, #9252)
[[Link](/Articles/956925/)] (1 responses)

My "system" is a computer running software.

You never told me what “your system” even is. What kind of software does it include, how does it process things, etc.

And taking you at face value, you seem to be claiming that compilers giving me suggestions in the output, which I can then apply if I believe the computer is correct is "Today we know it just doesn't work." - and yet clang, rustc and GCC all do exactly that, telling me what they think I intended given what I've written.

Yes, they are slowly but surely are nearing that threshold that separates helpful suggessions from madness.

Which may not even matter because we have a tool that crosses it easily: Bard/ChatGPT/etc. **These** may give you plenty of suggestions which may ruin everything your do so thoroughly you would be forced to go back to old backups and redo everything from scratch.

If you even have these backups.

I can then accept or reject that change as I see fit.

No. You have to **read it and think about it**. And even these, pretty limited, suggestions are already causing plenty of damage: I have seen plenty of “programmers” who arrive on forums and complain that after applying these fixes their program still doesn't work because they are going in circles.

They don't even stop to think for a minute and then realise that it's their responsibility to produce sensible code, not compiler's. No, they just assume that they may create something by randomly changing code and then following the compiler advice.

And these are “developers”! Trained ones! Who passed few interviews and got good marks!

What happens when “normal people” when they are operating our IT systems is hard to even imagine.

### Smuggling email inside of email

Posted Jan 4, 2024 21:41 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/956930/)]

No, but you made false assumptions about my system, and then, having made those false assumptions, chose to be rude and obnoxious about how I was wrong because you made bad assumptions.

And "as I see fit" includes "reading and thinking about it" - that is one part of forming my opinion. Sure, there's no shortage of idiots out there, but those people would do something stupid whether the computer's error message is ?, or On line 52, column 96, there is a , followed by a ] ending a list. This comma is syntatically invalid; you need to either remove the comma or add another data item.

This is, after all, where Postel's Law comes from; if the only output is either ? or correct results, you're being strict in what you accept, but it's very hard to debug the resulting system. If your error tells you what the computer dislikes about its input, you're being weakly liberal in what you accept, and that makes it easier to debug; Postel's error was generalising this to the case where there's no intelligence in the loop at all.

### Smuggling email inside of email

Posted Jan 4, 2024 18:56 UTC (Thu)
by **wahern** (subscriber, #37304)
[[Link](/Articles/956909/)] (1 responses)

> This particular SMTP bug is more of a confusion by 2 common newline types and "streaming" property of SMTP where there is no LEN command unambiguously identifying length of the message (to this day! [citation needed]).

A BDAT command for SMTP was first specified in 1995: <https://www.rfc-editor.org/rfc/rfc1830.txt> Or 2020, depending on your criteria: <https://datatracker.ietf.org/doc/html/rfc3030>

Microsoft Exchange uses BDAT, IIRC, but otherwise it's mostly gone unused. Ironically, BDAT would make smuggling exploits even easier unless and until the old DATA command was completely retired.

### Smuggling email inside of email

Posted Jan 5, 2024 0:32 UTC (Fri)
by **auerswal** (subscriber, #119876)
[[Link](/Articles/956948/)]

According to the SEC Consult blog post, use of BDAT by Microsoft Exchange Online prevented their SMTP Smuggling attempts when the inbound server supported it.

### Smuggling email inside of email

Posted Jan 4, 2024 17:44 UTC (Thu)
by **pallas** (guest, #128204)
[[Link](/Articles/956898/)]

> Postel's Law is great for processing that is started directly by the intended user (and usually, a human being) and then completed as soon as possible (with that intended user being notified about it). I suspect it was originally written with that in mind, but because of the era, the condition was never stipulated.

It appears in RFC 761, a TCP spec from 1980.

### Smuggling email inside of email

Posted Jan 4, 2024 21:02 UTC (Thu)
by **gouttegd** (guest, #106484)
[[Link](/Articles/956923/)] (1 responses)

I believe that the robustness principle has been misunderstood all along.

While Postel’s initial formulation in RFC 761 [<https://datatracker.ietf.org/doc/html/rfc761>] was very short and could indeed be interpreted as a recommendation to accept ill-formed input, the extended formulation from RFC 1112 [<https://datatracker.ietf.org/doc/html/rfc1122#section-1.2.2>] (where it gains its name of “robustness principle”) doesn’t quite say that:

> Software should be written to deal with every conceivable error, no matter how unlikely; sooner or later a packet will come in with that particular combination of errors and attributes, and unless the software is prepared, chaos can ensue. In general, it is best to assume that the network is filled with malevolent entities that will send in packets designed to have the worst possible effect. This assumption will lead to suitable protective design

A robust program is \_not\_ a program that accepts any ill-formed input as long as the meaning is clear. It’s a program that is \_ready to receive\_ any ill-formed input and deal with it gracefully (instead of, say, erring into undefined behaviour territory or segfaulting, as a non-robust program would do). Whether it \_accepts\_ the ill-formed input once it has recognised it for what it was is another question entirely.

### Smuggling email inside of email

Posted Jan 4, 2024 22:14 UTC (Thu)
by **NYKevin** (subscriber, #129325)
[[Link](/Articles/956938/)]

The reason that nobody is willing to call that the "robustness principle" is that, by modern standards, it's completely obvious. Of \*course\* you can't just crash when somebody sends you an ugly packet (for whatever definition of "ugly" is appropriate). If you write software in 2024 that crashes or misbehaves on invalid network traffic, somebody will find it and get it labeled with a CVE number in (hopefully) short order.

### Smuggling email inside of email

Posted Jan 4, 2024 13:48 UTC (Thu)
by **james** (subscriber, #1325)
[[Link](/Articles/956823/)]

I note that for Exim, "disable chunking" by setting
chunking\_advertise\_hosts =

was also recommended as a workaround for CVE-2017-16943. I must admit that I never came up with a change control justification to turn it back on again.

Now I'm tempted to call that policy. Exim has had its security problems over the years, and turning off optional extras reduces the attack surface.

Copyright © 2024, Eklektix, Inc.

This article may be redistributed under the terms of the
[Creative
Commons CC BY-SA 4.0](http://creativecommons.org/licenses/by-sa/4.0/) license

Comments and public postings are copyrighted by their creators.

Linux is a registered trademark of Linus Torvalds



=== Content from github.com_6a846d46_20250115_114603.html ===
�PNG

   
IHDR  S  �   ���  7iCCPAdobe RGB (1998)  (����J�P��EšV��p'QPl���I[� X�C��IC�bn���n\�}'G�A� |ũ�C������9��bם�Q��X�vӑ����f��N��v�u 'q�����M��4��2�J#`�e!�
пҩ1̠�j��N�5O@���P
r� J��|\_��s=�9�r\_L]k�Z��Y�T˪eY��&A$����3���J��Q��`1l7�V�����=��en�G@,=YAx�.U;��b�p�azTd�7p��E�Z��< ��O��S?�    pHYs  �  ��+  �iTXtXML:com.adobe.xmp     xpacket begin="﻿" id="W5M0MpCehiHzreSzNTczkc9d"?            xpacket end="r"?T��  ^IDATx��wx���߳{wI.�K��(=`�X�"\*
�(���^�Ҥ�?T��
EDB�&��&��$B��w�6��c�K��] �>����f�����}���ժ[A�ҽ� A� R>A�"�|��EH��x�|Q6����w��sd��+�?^���\�z��=Gw��͸��$qG�OD��H����1cn���|����f�|���|�g'����O��3m#���oV���A�7x���MZ6H�i޲��1�w|�xsZx�&��ѰMK)r��G�O��v���&����}�()�< bb�اv��RH���hp����i�����fr
���� � ���>�Z������� ���m�sx�Ր ��ǣ6?�|��w�m�I�+(����{o6^G��/AŁ������}�ڧo|�/�Y�.�XSn�\*��Q�)��/�A�4
P�h8��8��`� 8�$ 9�-�p��#)�L �00�8w\�.-�sQ�Qp�| �ja�̨mf�V�����P6��  ���H2@�+`�`b�dȐ�-�dܖE��4 �V+�� �I��w��ɔ7�$@- ���H�kp�j ܱ���gc   �2�K"ñ��"�-�+\_%jC��=f�����i9d�Ҽ�,˙�" ��quȐ�$�[2�%��"MB����H�qKF��TYsv�Ѝ���X@-�/�/�L%(����
:΂�"{{@ g~���D�q �2���~ �0X5�����`��.�2.�qY-n�H�D��� /ֽ#��|�@5+�ΞMgu�, ��\�ѳ<� ����q�Z�+���?2�%qK�%��S�J$�Ȕ`S�V�x���
p+`a�f
7(H2���
6��!��tAZ�@��bE%++k�J�럫ج�� G s���������"�k2��p]%��pM�T�)#EF �\1i0����ۗ�\*�\:����Lv�ޝ�;:�V`��&�t f��!U)���tI$d2d2�${�)��AP��F ����U�����2����� �}`�Y�w�da0HH��m�\*\R�n�"]���w��`s�ŜSL�J�A�#��n�9Zd���{ {8��4�i�Q̹�e�w� L�%��9I���)�l�� ��q��l�])���u ���@ GE��vI3�;cbȐD��\_��2P�L�& �����5���Kj�A�'< ��e���=f��X������M��C�G��rv�󮕫̒�^QV}���� �l�oI�c��#��6� ��\*qƏ�������#J$9���gFCJ�pSޫ��w���5����̪YPǌ�Vl
B���O�#��j�Ye:eJ'�uM,��z.�E���w�lgqj��:DiD�����Q����-����9/U�I�����(!w�Dᐁ-�����������ϣbN���C\_�.Yh�5��=������<W[ ��⊣��.}A˅���D�?�۠:\���;����+���W�֞�����C�Wvg��m�{D���wOl�GƂ��b���cN�>��3��
U�YI\_�M�f���!J�u�x���kDF�[�s�^�hO�������s���7y�G��
�:a�;�]?� ܎Ol�?���xC�EE��,|�/%��~�s�����"`��d/2jQ�I�Lj]��GN�dn�o|��mo㽦��Yn��\_�1�q͑�$�� /l��ߏg\_b��썌� �T���f���7�&��\_����f�P�i�J'6,�p4�t�os��o+�R�Ơ�c�=�� M�'['?e\_�L���w9)��kq��⯧ �~2�/��\_:wj��9��<�DHU�7^�z{η���sd��\_,4{~�6c�\{ j���6��� ��A�}���l��Or�� @pP��u66�R���F�h39��[�mP���5ͧm޷~Pp!����m���k���^ ���%qM%�iޝ�O G���9�9�w9�ޣOVa@��CWDY��0 �Ԟ����Gm��X�3V3f��Rk��\�z�졵�?y��7�m��:szײJH���{�=�͞]�}�'���~��O\_y���3we$�5��띻��Ҙ߮�����9���Z��o������;�i. \��绽������������ֳ�4�ͥ�����}�#���Og8��\*l�?��w�-�~��E�wל��ٶNh;bc����n+�n��i׶��~�}��#\+��n����I��.<6U����k����u������c��3�Q3�$�/Z7��� ��N�=k��f����\*3\���.\*�sn�r6欢U��Ԫ=�P=�m��:����nx�% �991.~ɦ\�HݾpA�\_F��@��W��U�};]�%Dkp�Z��u}�����\_ƌ�U��� �܋�<�m��/v���o]��yGUh�l�~����~�ڣ� �$ӡ�U��CK��
<40ܸp6����4Od�">%5U���)��`]Fj�}�AR.\���ic��:��-��F��G;��j��úf��'�ǎ}"�>�Cާz��ۂ����ca��M^B�,b4H��U���5��)�Rb��3�O�x)e���~u{�����/����!v��}z�z����m�t��� ��\_�t�pi��e�x�g�VL�r5{��FRRpēO4�u�\*R/G\_5�\*]pM���z�B��
�V�k��+IfV�︷����o�?|���#G���Q�����Y.�ğA��mRC�XY ��=��z� �}��|�"�!�'��)?���lk�oqb��}�(]�j��r�N��\_�H��{��y{=l��L���\_�?�+���וGwOm�y��.Xl���t\�(:.�l8�&!�Oĩ�V(���[&���URh8�8�9+cC�٘�CoC���#�� �(q�M��le02�K0J"k���� 9��,f�`�b��D�Y��ȝ�$�Ŗ �O+�J�a%J�� �#pS�~��>�ݩ ������ K��lc�l����lEYS:΍�n6�}̐�& #�AB���\*��B�,R$���)��즚�U�p8+��I�s�����U�"����PΆ26�������D&C�Fl��D��>�#����z���&m8�W�a�%j!�8(kC9��X�
:�@�4~�6�p90U�nh�j�!��;��5��S#V-���,�t V+`��\*!E���\���s��Z� �t!!6����6�ZQ��\*[Q����~M�봇<�Y;����\*q��ș���{�Ŏ�"�`� S.B�0�q]���� �
:gzn�:h9SFT�.���l�EC��4I�ȸ-�,��pS�4I(��V�a6s��<^�Ε/DR�#H��"�q�S�zA���bCY+k��#�#�3�@�?��d � ��=��4 7T�j���j�.��/Q0%qv�\�{(�s�.U}J~Z��!�]n����c
�1���0�"�{�#�8��-s%���YF�.n�u�Tv����H�$ ��GȳE��g�2%�8C&C�$2$�w%��O�@��J7�
���Y���J2��=�c���q�
LQ��quP�R���V9mWdo({ґ�`�d�i�S��.���j�%Ń���▌2n�"EF0g6ǥ��r��:ωds���+�2�`t�~���������=���L��x���i�󝼫�z�'y:ᮂs���|��w��c��&2Wp^�ͼ�� g��x�`e03��``��^���GXe���rM�2�=g� WU�FD��J������(?��y^�+E�z����u���<�еb9�ߐdbb�ϵ���/� ��oC��U⤟�G������#B�Z�����:@\*[ٳ�{�k������ ���BI��@�aaU-L��T!]� ��w��6\_�ޣ�=�ރȋ����p`s����n��ƽ�+kz��$���,P��:�����Ֆ;J�����e��\_�z��=Gv��b�㕳}�\�7�`��}{����q��I.������3�k�HICh`fm����9�(��{x�z���L�s{i�N8#��c�͘y����p����9�>m���ç|8�Z��\_\_ʷ�@�ڦt�KW�u���A��(��  jd��'\_�R���٥QnҲA�O�E�9��ś��[5q���mZJ�K�?}b׷���6�h�ͯ/� g�V�l�,��"���VV�´y:���������5��7�f �B���F��|@�LKJ��������[�}z����Bd���B�=i���(%�^������=e�48ʃ�
����Ƽz�]��W1D�E�r�'��y��4{�z�|�|��w�m�I�����E������l����L�L2cV��P�m����MeJ���������}�ڧo|�/�Y�.�XSn�sӵ��=�l������'�<�!C�<]3��uO �����B��]8�o��a?�:���OM�Е)cO� F��U�.]�y� Sղ����&����Y��o%���çz~�Lo|f��ͩ����$$����"��?��F0��շ�j��?Hs��33��ӧ5�i�^V�b%��\*�?�0�i#�÷T{�z�ۯѪF@h��?>��E�w�:-:�"����y�ؚSG�Z�Rq�X���\_ź��\V$=U����|\*��W�0H8�/�i�w�5��-��%C�X���[��\_��1��'��kEF �&�H��VO  7U03�9����u��9�X��hE�LO^�7J��p�t �\*\W 3c��r�`�s�xg������Ks�N��t^���K���EL������ ᴟؠ�k\*x�Q�(\_�\*X��E��h?^�dw�
�vwjgW,%iq���y�������\*WN�Z�~[030'�, ��auXh�
�U
U�����t�ʵ±]e]%\_+��� ��=y��^��>��e�^t��K��'��^�8B��/%�>?����v�O&�����\ ��Y����z��9�
Q��E�EɊŨ�C��v������r)Q���0V��O
��.|�(S�O(��q��C�Jɍ�����Y�;�GV���I� 4j@yʮL�0&�)1�E�a(�$�,7�8�ÜO1)O'Nߠ$\*?��.��JRq����c�\_������(��'A�"�|��EH���{�����ީ+�ۿ���{� ��O��wH��fD�UqJ�� �W޻A�}<{��x쾿,�4b���e�&X��,K��+q�TݰMK)r��GDO��~sD+��x7�GA�M��>�Ky���cWpI���]��бy��������gc����$���Y޻�E%�G���(��,�Vx�C�F
��Ut�8��N�^�l��W] �(.��kپ`�ic�������}޼��p��K�=�H޻LsGn8��R��d.����w ��'�{W���.�:Դ��2RSm��{� ��O�w3t-z����ۮ�o;������ ��]� �>9s^mغ\_�˖��c� }�w?�;",Дxdç��NT74udψe��c��'͊�#K'�(1�DO� �4��>A�"�ϥ��-�ƻz�W2�v ���s�b2�L �Hg03��[��+�I�:�(���M�,X�ם�B���e��1g;@v��IY��6��r3`��B`�`b�8���+,q)X��Q���Q��B�,@ ���,.���\*$���`av��;}�J�w�� �b)+�RT �STjTU�aG+����r�89�S��Zn��GPYح�UjX�j� ,̾E9k) þ��`T�63�f��TI$�IH��&�TiR$��"C��7�]ĝ� �\*YY�L��\�;-eʁ5�=�E��4 �T�W�K\*ܖE��{daH�D����u�����}�@5+{&�uLgu����01dHȐD���n��
I2R�l�v���Y�YM��7�@ GG gA:��6T��JV��1G�\�V�9���
��f�9%
����pŶ0d2�&!]B��۲�S㤿8��%����m�T���r)6��)�p�dT6�����f`�D(���v�x����wt��\_�����
�$�D�S�@ ; `f춌X�8 v�s�Y���(�T~ G�L<�^��ms�~ʴPZ�'�r�s��d\_�~���he�-,�"~����$~�`�QSj�Y�4�L�����m�� �rT����ո);ͼA�����gFCh^�R�m��U↊�w��\_Gm3�b���4��@�'����H��[�Q>�8��@j�K2P���X����|?� ��/D�B4�d�����{�����I�����Ѹ)�|�/�L F�A�t�����3L��+?M�T"�ΝRu�O�\_��kD"
�B`fHs�+M��������nK��,n�����\_�6�Z����Aw�����L�'���� ��Q)Hh
��>q��\*�V��
����  ���\*��9����r�/itbk���R� 8C��+jqC3c���B������nv9� r~M�ƙ#׆
2$l?��e5��P�'��!Q��"F��Q��j�ك��� ��n��JrY���`�2�� I0F�L��D���f^L��`e��  ����̲߲\*؝��=���a=��0#��Z`���������<���r���X%+jYX=�,��
A�i��-������^Ŭ��`q�dJ�o�#MӔ�WO{�T�-�Đ)�}Aɲ�-#EB��8��`̎2���a�$m g��kc�[w:'��I��R�SRQ�Z@���Y�
z�r6�:��8�}��<���1{�"N-L�}�(��i�9\b9�pVֆ�6���r6۠��sVފP�ژ�6��Zx`���ç��1X2�F&Rd\U�J$�H���`eBq�21�Y���MV�s,�MH�����! �����[���T��$���r$P�qx���ġ�v;`�$��g���H��K�S�:�N����
p�'��]G�
A�q� �� � G�V9�cL�����I���( C���O��H��"�����m,��$����J&J
��
��VT�Ri�� �!�t �����z��\d�jZ� sA�")\_p��?��9q0��g/7��+��k��9��4`G%��M&vߧ�m�{��g?�>�Nh�aoU�k���B�M�������TպM��N�����9����+�c�7=�Y����C%w\_�����FD�C+��J�d�M��R�!�Ɩ[?t��[��G�Q��F�7�woݾ'�|����]�W��]~�ח�l�w򄵗m�?�ZTo�w�޺#{@��x1�ό��E���˜�{�Z?��M���.�ߪ���E�2���A�����А & 0�z�VJHH97�@�'"l���6
�D�ĳ6߯キ\_
n  ��B��SR���1����ov;�?A�,<{�gؿ����F�o���/l��c�qw�88�O�/N]O�Z���<� ɒc�, ��H��&!]R�B�u#�qE�c�,��T"g"�4;ܩ��1�IH"�ϒ+�g�ҩ���Tr.���Ȑ`b9�@%�/T�����tV��r��,�\/��K�Bl��0��`2eERQ� ,�I�� �Pf��Yn�90�]b�> ��� �2%��X���R+T���ɬ��R�5g2k]e�\�W�4 WU"F#����>W'A��P�T��C:���̬x���5i�H�F�)�C�e���㳢X��p
v��M�)\*�`D����:wj�$��'��^-��2�~G��p��hc`=R�:�-{�ay~d%�S\_#�u���?ߤ���]���J� �
6V�ªY� ��B��4�A�;<m�e����1H���K)Z��&�!�-A⺊��Ľ��7y4��hhB 
X{�,P�KgM3s��=�S� �6�\*V�Y���=jd���^�$�9���,����/Z�F���:�Ľ�S��s�x;QX�YY���~�R��Z��S� X���5g2��|�}l��G?뱓��%��7���~Ո}`he�¾C�����\j:d��r�N�}��|+� J1�(�f����ė�<�\_��k����˯������N�������Q������[wd��/��������{��|OP����\�e�[��]�h\_f�W� �"���>�/� &Y��J )�&h�D����ܦ�=�(�x���u\����
 @pUh9}Jj��|0�2=WR��nG�'���gO��w�ވ�-ڝ\��m�v:�.�����ï��Q�\_�#�'��x�T��� �\*M2���;��w����ϸ}ٱz}Ý�?A����A�^�}��EH�ዐ� �)�39�D��;�����)!]�f�Ĺ��]��$A�:׈��T��}�!�Y$��"�;��7y4�MhhB�����^A\*q���՟���(��S~Gm3�b-u�g�mV��˺4IK�'J6.�π �B�,�Nbo�2��t�D�Ɲ��9D�X� �Ԯz�G4��� J2���xy��q3+3�{}�V�(ɸT� 2%i�w/a@�͌2��5��5!7�S~�$��D:u[����
!e�uM�
�d��p^#U�k�CJŊA<#�^ׄ ��N�f ��񃑚}�1j���o~꟝14� Q�q7�� Ld�����1���گy��JW���Ne�|��R��zV�t�1��
�$~�p��d�2������%��/ ���\*��9����Z�J�� �N\S�^��L^P�\��!]������1�`���O13\Ԉ���w�����3Q��hmΐ!!A��ipQ�Y�@�`\*Q
���k�Ǉ�����̷@ F �U�p 6��A"�>�'J �ͱ�8ps�YX�L����Q���K�%@(nY2%��X 3��A$�`l\*N~[�O�͊9��
�;)K��
2$ܔ�5���8r�"J��]K��rT���T���VT��\*VT��r6h���DG�;q�P�xSF�Z\P��j(/ Y�6���J���l�f��Q�@�o�pXn��K���K"]B&}�C�.
s�. �&!C#���B#�,H@gC�26�ȡ�����\_@# �!em,�C��0Ϲ�
GN�� ,���D�
��� \*���
Y�,�T���$�='�4R��:�u�$�"4���Pܲ$@�X�L0 vKlǵ �6�9��qr��SZn7̵1d�9+ml��4 �2n��
�e�0J01{���% ��Ql��Y
�r��[� @8�2� Ȱ\_&d@��L` g�F�����ا\�>6'��ܥ�s"�o���ӞS�)�#Y� �(:%��<�� �.@���/�i�/ʆ0yh�Gԙ������%&��\_����]����md :/�?�}v�{>|�\_M�[u�
�G��L�s{i�N8#��c�͘y���� L&vߧ�m�{��g?d\_E���5#���S���${�(Ax���MZ6H���e����u�/[5���LB��Ki�jݦOy'`}��לɴ���,�����\_��u'��xt��Į�O���4 ��o4�?�{�5+=���^�B�Pbd ���
[�������h� �(Ix=���^���q�Q�YGV����!�O�8{l; �,K�^�мQgm&N{�b�U� �"��S=�|��w�m�I�� f�~.�z̙��m��X��`پ`�ic�������}޼��(��Q(�P�P��t�s�>}�}� ������IF��d�v+%$� &�ƹ#7+&%�h��\�ȩ� J���B��]8�o��a?�r���:.����  �\*��>%5 ����]zu�i�
�e���� ����S=��qK�7>3{��Ԋ�� XRR̆�;�|oĀ��N�����i; d�Z���%�]-�vH'���ݹ} �[<�>\_�j���:�^v�-���i�)�!��1ӆ�ܢ�:��gM^}ڠ�������a���#>��pwb 2� \_�0�A�v�}��EH�ዐ� �!��/B�'\_��O�)� |R>A�"�|��EH�ዐ������9/U�wİ�N�O�j��|Q6����w��sd��+�?^��I&B��=s�`ֿ�=�~���޽o�ѝ�|3�}5���Xh:}~8\*���j{vƋvS���)X�jC�F������(߁�B��jVҗ��K;���b���<ߞ���~Z��U���rY��6\{�!z��֥ @���~��Ew��?;a΀�O<�Bp��)ο����z�l�4!���M"Bp>��}�{0ɸq���;]~����Yn��\_�1�q�u��s�x��$T{���q��w�(Z��x��[y<���/oNo��]|��SGN��)6��H�:g6m�vw^6l�R�\:o�������&�ID+mA-�C-��#?E�o�Z��^gԆ��\_�\_�ZM�xln{ ���ǎG���]�.\_�:s�`�}��-R�΋�~l�ٝk;�B۰ߜ������~3��\*PG�
]�����ݔ�fr��y�mP����ڱw�{~]5��Y�շ�h����۳n���P��u�=�����9���/�?����
�l�1\_�=����m�?���^�9����e~>���v��@pP��u66�R���F����1)!.�Rlb�����I�x��O�:���T ��v�{����nA�LKJ��o&�0�.��
���nZ�ؑM��$5o\��������vMZ����V ���9}t�~<䝞��Kn;i�+�+\_�z�졵�?y��7�m��:szײ�����G��{ܛ=���xO`���v�z�\�:ή��o�h>b��N�}�§��w��?'�N�F= �zvO��Q���e��U�����'�
����ƼzŃ�5��7�98&������]�)��zt�uQ9�s땳1g�H�>��\_������=T� �~���EK��`@����k#�a���K۾���5 �˝=f=T��|������\���kUi���z���^RmT���C�n�~�=������q�����?�Xx����\_��,�|��M�~����9�僃M �����Hq������J��%\�<ή����Uz��z����u������T�B�x���'�;ԭ{t�3/2٣[�?���x]=�
o���K�y������bao���o+?R3�� ��@����:
 `L��7@Ņ�9LINV��FG��������Le�˛�]ɕ�
�=�FUt~���n+��c�^oNK3)姤�V.\��oޖ�pʎu�N�9{x����7��S��/�\*?��l������L7����$32o��9k�qe�q�A�y=yD�������m1�3�.kʍ�`AD�oٸ\�j?|�Բ��#�ۊ�}��ώ9RiW�w�Lr�ѳ�i�L���I���K���1��=�:������M����ǳ��2�X���qv��;\_���"?��דׁ:�R�<���Ν��o�nν(O|jj��L{��C��iLwS�o��������/��=isf��F ���4�)@pVV��r�i5��\_z��\_�w6��٘s�L-{��姤�j�ze�<�҄��mŸ@嚵tg7}��X��3gϥ��E)\_�����u�)��K\*���]>m�;W'4~�e�����r���8�]�����|���ۋ�|��"�,�����ٛS+V�^-��^ͳ�[��غa�ڡ�s�
\*>�5")�E�s.�����>ݹY�F�ޜ�j�����9SխZ�D��u�ԫ侗{~ρ[���R��
[v�h�W��q?����k�V�V�ZX�TA�ª�U�\F#��=�=����uz���6\_���،�]=Ӵ^���L�.
]��C�[��R����x{H'��}�\�<��}�ο?���
Z?۴b�ի����b�\���]m�U�+
8�^�f��؋�kT�V=4Du^��ۯѪF@h��?>��ힼJv+53�Vrf�ujt{��mS���#y♔�y�ؚSG�Z�Rq�X���\_ź�Ahּ?��=�~�T��fmtX��S�O�:~�/�����8�/c��O���G&,����l��d�vW�3���d�i�G/�ZgN�o��Q\_\_\*��%������\*(+�X�g!n����i���E��M����eč�g�����u��)���m7$��=�M�,���'��l��t��o���~�O����n���
Z��=�-=�䦉Kw+��{���b�\��{�]m��e}\�Mܜ�.j7�W�z5C�/w\_��\*��.A�"��>A�"�|��EH�ዐ� �!��/B�'\_��O�)� |R>A�"�|��EH��x�|W���w����-�g.Aw
���s�+I���W�)���&�3� ���g\_�\*��/�<̀�ŭ;٪ �n ˒)�J\|.U7l�R��<o�Q �����J�2ޭaAw���Į�O�R>Dw��\�%�z�/6tll8���q37�٘�{9I(�dy���%�.����c��cW�%�
�vhި������\�)���m�sxA��A�u�����kپ`�ic�������}޼��p�{�K�]�����en�;�5�VRR���̅Ց�g.Aw�����+xpx�^j�c��u��6�y�K�]�çz~�Lo|f��ͩ����$$����k�kv�`��v�|�!���@�̝���������^�u����A�]<r��ڰu���-]�ǮĄ����hJ<����w'\*� ���:�gD�2����fE��q�'�^A޻��{�ዐ� �!��/B�'\_��O�)� |R>A�"�|��EH�ዐ� �!��/RT���u�U5^�pKTT��m
���B�������#������~�S���"���")����������=�ی��Tt�r��5�3\*ͣ�����g�F�̇�߬�6^zt��5�~2��>Ӷ��Θֽ���D>A��|œw޲��1�w|�xsZx�&nW�Q���>}�����~�6-�ȥ���>����kb�D�Һ�)Toݼbԏ��9�k��ی�[6�!��ѐ�m�\CS ��w>|�p����ˆM�!��-x���
�edd\*�����6W����9�4��\_r�L~��Rl#|9=y]�HB�B��<|��񘙯��-3��Ԋ�êW��W;��Eٮ+�nصvh��.�`��u�4��c��J����Vҹ�W<|;}0�s���ڽ9��Z'�����?p�z��#^lZ�����!�p�q��L����)�˘�U���Q�)�}~ňV5BkN��I%m��U��[����3����.�~@
�t?��i!�Mh6�W[��L��A�"�|��EH�ዐ� �!��/B�'\_��O�)� |R>A�"�\*ߕ�n��cN������=�K�\� �&}�g��ծ�6pFB�'�N�1���o��@���5#���S"
7M����>m���ç|8�Z��\_\_�c{A�wx����������Yܺ󗭚`�v �,������Ru�6-�����=�^����+�
�E%����cWpI���]��бy��������gc�{�qW�z�/�Ǯ,K�^�мQgm&N{�y��b��%�x�Γ'�Ǯe�������.g ��?�y�FX��^<��A;^(?�c�
��.�p�ܑ�����:��#ǚr�6XP�֘ ����S��V�zث�N���3� ���G��W�������k�ؕ��7~��ѽ#�M�G6|:y��D�@p�ASG���QF�<�|ҬȸA�"�|��EH�ዐ� �!��/B�'\_��O�)� |R>A�"�|��E��|W��.㹪�n����=�MA�p���|}�w�R<W���G�����OY��� �o���ɅO^�-/����?��=��&���u]�����Ck�4x���GϘ1-���n{�K���WA�"�|��EH�ዐ� �!��/B�'\_��O�)� |R>A�")\_p��?�r������t�qj|�f����~TOĝ��o�L&vߧ�m�{��g?d\_��7����\*�5r�iA8Q��H�LB��Ki�jݦOy'`}��לɴ+9�7�ZB����M�~�c��dO%o���=����~ip�f!�,��q����OS;��Y&RӁC:��~��kw��Ao�d�=���t���ǶS�\{�V�9��v݂o����ex�b�:A��Of�~.�z̙��m��X���+o\��]F�U��E���,V+^� ������А & 0�z�VJHH9���m�D�����&�D�ĳ޾\_�[��  W��ӧ�&��7.c(�s�!�Q��v��(Yx��7��yh�{#��hwr͗�M�1H��е�5�K0�o�Z��N��� �ߧ���}�'G�~�T� �B��S��&L�4mȬ���S.�X4j�$���I���/;V�\_�4�A�m�{� |zo� |R>A�"�|��EH�ዐ� �!��/B�'\_��O�)� |R>A�"�|�\�Ƞe?�y�:ي��")?�'o�}+{��6�#�~���y/�M=�{b�;(Ku���լ�/h��W�6\*�q���ޚ����{�۵�����1�U�r�OGm����'\*r��6���\_T
^q�9��ޯ\_��~ݯ���<�8�j��5���)�z�K,�0ɸq���f7$8k=��uL:;Ư��iνr�� �ҨE='m3i�u:���hz�S��!��O{��t|niNI(�����\*Coߜ����Z�Mb�5���=������u�;זΜ�N���Cvm���C~\_e]�}���V��o�=�VM�P
�xz���Q�>}AW��ק9�A�wE���;��຾\_Em���~o|�sN;���H{+�۠:�V��vHU;�=�T����Z1.�m����ǜ��ӼUQ�Ujˎ�3�/��\_�9�c���=��f�w�5+[�ש|w��/g�}��Z$�a���\_��;��
[�:���^֛ۍ�ԣ �5�O~58jƻF�j�\*�} ��Wu�0���ߏ���s�w�m'M� �������]>��\��k�Uz)���1#UL�E���RJr��#�`�V����@sZ� `L)�hݗ�2�r�!�G<ר��O���m��y����F�� \_��B��kV�|�����=����ʏ���8���F>��s�t�|���=��/ޙ���ȕRM^m��ϸ��ӱ;WVo;`���g����y!�?��� �)�3oĻ)?ws}��W��8��o\_<s�l̹�1�d܍c$�v�gu��5�\_��/��;y���GZ�%khՇ���Sʄ5}������nH�gKt����f���>0ܸp��\_v�ݟ�弹�����Ё�6Hݺ㌭��gފs�}��%Yܖ�k�U���73��N�@p�/��w\_�f-��M��:}���s�6u����}��>>��\*5y$�����ˬN�J��8K�����&]�:��]&n������\_>��Tu�<�0��@{�N�ENj';��I�m�w�E�ԣ2 ��G-�iۗo>x�^Ͻ1|m$�|�pU~V�:�RE���}�\_�Š|��rX�j��:�ݘj������RӺ�:
y�y�e����Ѱ�g�֫��� }�sn�FRRp�'�hX�n�z�
�����]
j����ś�[=�p1����U��U��UP���a�+��8J˻�Ba�v����:��̈�#�Uq\�w�Z�7Fum^�G\_�Fx��󹺠|����u�Q �l�G}��]��7�/��B�y
�+ �-\_�n��ڡ������e��غa�ڡ�s�P���>�����Y�����8��׾��"�I�-g��x��/�I;������[W�̺k���sG���}�ݞ�&�o՜�y��LX�u�9�ɘ���G���̼x��W��4���0��a�-��R�+��!���=;�P��-�ȹ�r��73�R[%� �/�p��aKWۮ�2}��@�cǤSk7��~�{�O�Ɖٯ�n��\1�ʷ��rІ\_)��a�-'lqY;����n�ff�Jμ������w ���Z�/�|��EH�ዐ� �!��/B�'\_��O�)� |R>A�"�|��EH��x�|Q6����w��sd��+�?�e2�y�~g�,�Y�t��ջ��9��oƵ���Aw����L�s{i�N8#��c�͘y����  I���W�)���& ��?;a΀�O<�Bp��)ο��ח��^��}�+7i� ���E�f@��֝�l�k��eɔ|%.>���i)EN���(�����o�h�]o�OM�����5��]�G˂K!A�F�A�-K@�.\_l��<�p~���fn��1@�L��$�Un&�0�.0��Aw�G�X�k��2n�#
  �j�W;4o��Y[E���^��[���6�9� ]� �:�y����[n�O�,�`پ`�ic�������}޼��p���y|�����Z��&�Hx�|������}��G��%�I�q��
G@RR���̅ՑcM�q,�XkLD����B��]8�o��a?�r�@����]zu�i� �e���$��f�ʔ��� F�1���ND���\_ĸ%���=lsj��a ,) )fd�Z���%�]-�vH'��� N�s���`���X}�a��:�Á4�'��G��W�������+���i�)� }�w?�;",Дxdç��NT74udψe��c��'͊��|�()��.A�"��>A�"�|��EH�ዐ� �!��/B�'\_��O�)� |R>A�"�|��EH��U��zF���w^�\*?o~�}+s�\*�W5>X����
XA�s��;O�\���u�'���ңCg��o����=cƴخ~�]�}$�\*|؀~7�9˗!��य़����gT���cM&vߧ�m�{��g?�>@���'�K��]?Z�䕋�Ϋ��W8�j��5���$\_w�\_�y�}�[�����?-/Z��x��[y<���/oNo���
۴�"��[4�Įo���m�J���m|���+F��`�ј�V|��ؼe�\��
���S&tO�ٲ;�>�=���r�����Cv���;�Ͳ�����!����V7����m�o�������k��d�B��N���Cvm���C~�S�b����{lϺU;T�\*�l�1\_�=����m�?������5���?9jrʫQ���>}����>��~�R�48e`�?��>s�U�&�WO9y�b|\���8�#��ٴ!Zb��+���951.���ߵ4�C���;����у��l�N�}+{Q�L����N���u�^���d?�Y����
�edd\*�t�A���i2pN/����d�`P��U(�� W=9tJ�2g|w�ZmD����GG�T����o�����i�\_
-D�����'�5�����.x���������wz��.����TP5�?�w�����٥��{{L��pEw�Mgzd����sq��Z�oq~ٰ�?�3��#�ǿP���/
��,���g)[����� �~��uO��{<
<��)�[\�W�KM�t���k���RC������u�������+4���|��8m�QsV&��{������X�]����=�Ӣ�G��F.]s���ڏ?�߽z�1���yidbxD�B��h��~������9���c�՘d�:��#o/�����Q�~�'���
�E僃M �����9�׬7�ya�)�E=�V�������E�꽷hDK������Ȋ7z�=d��g�m���x@p��ޱJԦ߮�ٗ��U�������N����=�t��^U�9��v݂o����ex=7�.��>?�<����֓�x<|�
���0I����KOXrVҒ|����r�
�����I"%Հ�]�\j�;�ݧ�o��T����xhNK3y�]Tn7d���U��I`�ں�>�����RNٱ�ۉ3g������n�?�U�.��w���õ�SVv����Mq��M3��s��c��,o�������
�+ u���̋L�Y�|�+W���1#Uj���]�������.�ߪ����ezp�n�A�y=y�[O�b��=��� ����\_�����L-Za���}��ώ9RiW�/��|r�ѳ�i�L���I���K�:�,�{fu~ik��Û6��q�g��ce�˂�6lP��Oq�T���T������U�7^O2
�$�[)!!�<���Ë�U��bP�f����r\_���ų1Y�t��|�s^5{"���ܾ�e�bx���'o�Jsܓ���m|2FY��� ���������~��W�<������/P+{rǘa0�z} �Y�>��MNMCp�2J~Y}Pr��@!=��Ό;s�l̹�T����a��t~y���5k��n�fױ�sgΞK���I\*���]>m�;W'4~�e��[e�͊�u�O�Ju�]u7;�\_�[��  W��ӧ�&PU@p]��m��7n7;e�{^���pu^1�2=WR�nw?�H��/b̒��̟�9�b�����\*��Yc�e��غa�ڡ��ϭ���>ݹY�F�ޜ�j����=y��Ϗ�G���9�Ŧ�~��Gw^�$�^�����]5{/B��|玨��\*x���ѓ��\_�RӺ�:}�JS�(�����^ңE�f���og:��4 �����;��fu����ʯ&?\�x ���G{�z�i�f���ڼ�j^���h�u�3M��k�ʄ>�Y���/���g}�=V�A�g�VL�z�ݕ�ꎭ�ʼA�"��'\_��|��EH�ዐ� �!��/B�'\_��O�)� |R>A�"�\*ߕǮ����V �(!x�|�j�����w���n3f�R�m~@����Llp�Ϩ�;[�
�gm�+�]�޻.�V �(x�}>��>�K�����U��\*�;�Y� �^����u�/�k� �{�w���'-~���Y�DY<�'�d��+��Bx�qo�T�Y^�����u�ODI�#��1n���gfۜZ�z KJBB��.�5j���\*똄\*���GZ��D���A�=<���ڰu������׭Ӣ���"����^� ^��|�(�A�"��>A�"�|��EH�ዐ� �!��/B�'\_��O�)� |R>A�"�|��EH�ዐ� �!��/B�'\_��)�op"&��    IEND�B`�

=== Content from access.redhat.com_3d577c3f_20250115_114610.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.youtube.com_6c0f97f0_20250114_193001.html ===
[00:00] [Music]
[00:14] okay so the next talk is going to be by
[00:18] Teo longin also known as teimo login
[00:22] he's a security consultant and a
[00:23] researcher he will be talking about a
[00:25] new technique called SMTP smuggling for
[00:29] spoofing emails and exploit one of the
[00:31] most widely used services on the
[00:32] internet thank you give it up for
[00:35] [Applause]
[00:41] Timo thank you thank you for the
[00:43] introduction so first of all a big fat
[00:47] sorry for me personally and from Sault
[00:50] for this absolute dumpster fire of a
[00:53] vulnerability disclosure so specifically
[00:56] sorry to Vita and Victor for having to
[00:59] well fix post fix and to all the CIS
[01:03] admins Worldwide having to apply these
[01:05] fixes during Christmas
[01:07] holidays and also
[01:10] however yeah also however big thanks to
[01:15] V and Victor for their commitment and
[01:18] also big thanks to the community for
[01:21] pushing this issue for releasing tools
[01:24] and so on and for
[01:28] okay
[01:31] [Applause]
[01:35] and for everyone that has no idea what
[01:37] is going on let me catch you up to speed
[01:40] so about a year ago I was just finish
[01:43] finishing up some DNS research and I was
[01:45] looking for a new research Target when I
[01:49] probably found the easiest way to hack a
[01:52] company and all that just with one
[01:55] simple Google
[01:58] search
[02:00] and it might sound stupid but this led
[02:03] me into the direction of something that
[02:05] I already knew but I never really
[02:07] realized and that is that fishing is
[02:10] still the number one initial axis Vector
[02:13] into a company and then it hit me like
[02:16] why don't I look at SMTP the simple mail
[02:19] transfer protocol which is used to send
[02:21] like billions of emails each day across
[02:24] the globe for like the past 40 years so
[02:27] my journey went on from DNS to MTP and
[02:30] today I'm introducing SMTP smuggling a
[02:33] novel technique for spoing
[02:35] emails who am I my name is Timo longin I
[02:39] work as a security consultant at second
[02:41] SE consult and a day I do penetration
[02:44] tests and at night I do vulnerability
[02:46] research and for like the past 3 years
[02:49] I've been looking at lots of DNS
[02:51] vulnerabilities and I've published lots
[02:53] of blog posts and
[02:55] tools and yeah I had to move on and the
[02:59] last time time someone from Sault had a
[03:01] talk at the
[03:03] CCC it was about
[03:08] dildos and I know that I have to
[03:10] disappoint at least some of you but this
[03:13] talk is not about penetrating the human
[03:15] life
[03:16] form however it is about penetrating
[03:19] SMTP protocol barriers so to see how
[03:24] this works well we must first understand
[03:26] how sending emails in general works so
[03:29] here we have a pretty simple email
[03:31] infrastructure we have a mail user agent
[03:34] for example Thunderbird and Thunderbird
[03:36] like wants to send an email via user
[03:39] outlook.com for example so now if we
[03:42] want to send an email that way we must
[03:44] first authenticate against the Outlook
[03:47] mail transfer agent or outbound SMTP
[03:52] server and once we've authenticated
[03:54] we're now allowed to send an email as
[03:56] user
[03:58] outlook.com and and only as user
[04:01] outlook.com and this email then gets
[04:03] transferred over to the receiver inbound
[04:06] SMTP server and this inbound SMTP server
[04:09] is now checking the email for
[04:11] authenticity and the most popular way of
[04:14] doing this is via SPF so the receiver
[04:18] inbound server is basically getting the
[04:20] SPF record via DNS for outlook.com and
[04:24] then it sees okay these IP addresses and
[04:26] IP ranges are allowed to send emails for
[04:30] outlook.com and since in this case the
[04:32] legitimate Outlook SMTP server or
[04:35] outbound SMTP server sent the email well
[04:38] the inbound receiver accepts it and now
[04:42] of course there is well a very
[04:44] interesting question and the question is
[04:47] well is is it possible for an attacker
[04:50] to send an email for example from admin
[04:53] at outlook.com or from a spoofed email
[04:56] address and this is what we're going to
[04:58] look at today and that's more more or
[04:59] less the goal of This
[05:01] research and I don't know if you've
[05:03] realized but the colors of these servers
[05:06] and I cannot unced but they really
[05:08] remind me of SpongeBob and
[05:11] Patrick and therefore we're going to
[05:13] refer to them as
[05:15] such so the general goal of This
[05:18] research and the premise of this re
[05:20] research was like finding a way to spoof
[05:23] emails and I was like okay why not take
[05:26] vulnerabilities from other text based
[05:29] product protols like
[05:31] HTTP and put them into
[05:34] SMTP and there was just one HTTP
[05:37] vulnerability that really fit the bill
[05:40] and that is HTTP request
[05:43] smuggling and the thing is we again see
[05:46] we have SpongeBob and Patrick but in
[05:48] this case in the HTTP world so what
[05:51] happens here is SpongBob is getting a
[05:54] request a post request over the
[05:57] internet and the interesting thing about
[06:00] this post request is that it has two
[06:03] headers
[06:05] specifying how to handle the post
[06:07] requist data it has a Content length
[06:09] header specifying 43 bytes and it also
[06:12] has a transfer encoding header and now
[06:15] SpongeBob has to decide okay well how do
[06:17] I handle the post data now and SpongeBob
[06:20] decides to use the content length and
[06:23] since the content length is 43 bytes
[06:26] well all the red highlighted data is
[06:28] forwarded to p Patrick and Patrick is
[06:30] not like okay I have no idea what to do
[06:33] so am I interpreting the content length
[06:35] or the transfer en coding but now
[06:36] Patrick is interpreting the transfer
[06:38] encoding and now we have an
[06:40] interpretation
[06:41] difference SpongeBob uses the content
[06:44] length Patrick is using the transfer
[06:47] encoding and since the transfer encoding
[06:49] specifies chunked and the first chunk is
[06:51] zero well the rest of the data that
[06:54] SpongeBob transferred is now interpreted
[06:56] as a second request which which now
[06:59] basically means that SpongeBob sees one
[07:01] request and Patrick sees two requests
[07:04] and the second request can have like or
[07:06] can Target an arbitrary path like for
[07:09] example admin which in this example is
[07:11] only accessible
[07:13] internally which is of course a problem
[07:16] and I was like okay why not take these
[07:18] interpretation differences and put them
[07:20] into SMTP and to understand or to get
[07:24] close to understanding how this works at
[07:26] least we must first look at the SMTP
[07:30] protocol itself so SMTP basically looks
[07:33] like this we have two main components we
[07:35] have in red SMTP commands and we have in
[07:38] blue the message data and to send a
[07:42] message now we must first send the SMTP
[07:46] commands so we must first introduce
[07:48] ourselves we must specify a sender
[07:50] address one or more recipient addresses
[07:53] and then we send a data command to tell
[07:57] the receiving SMTP server to essentially
[08:01] yeah now receive the message data and
[08:04] then we send message data we specify a
[08:07] from address again we specify a two
[08:09] address we specify a subject and then
[08:12] comes the message body and at some point
[08:14] when we now want to stop transferring
[08:16] the message data we must send something
[08:19] that is called an end of data sequence
[08:22] which is a carage return line feed.
[08:25] carriage return line
[08:27] feed and now was like well maybe we can
[08:30] use that to somehow confuse SMTP server
[08:36] implementations and the idea was
[08:38] basically that we have SpongeBob again
[08:41] and we submit an email to
[08:44] SpongeBob and this email contains
[08:47] something very weird it is something
[08:49] that looks like an end of data sequence
[08:51] but it's not an end of data sequence
[08:54] because it's not RFC conform but like
[08:56] someone could mistake it for an end of
[08:59] data sequence so SpongeBob looks at this
[09:01] and it's like okay this is not the thing
[09:03] from the RFC I'm not going to interpret
[09:05] this as n of data sequence so the the
[09:08] next or the message data that follows to
[09:10] this is still like message data until
[09:12] the actual end of data sequence comes
[09:16] and now SpongeBob sends this over to
[09:18] Patrick and now Patrick is like uh yeah
[09:20] I don't really care about rfc's so what
[09:23] I do is well I interpret this fake end
[09:26] of data sequence as an actual end of
[09:28] data sequence
[09:29] and the problem here is that everything
[09:31] following this end of data sequence is
[09:33] now interpreted as SMTP
[09:36] commands and what we can do now as an
[09:39] attacker is we can specify SMTP commands
[09:42] that send another email so even though
[09:45] SpongeBob only saw one big email Patrick
[09:48] is now seeing two smaller emails and the
[09:51] problem is that the second email can
[09:54] have like arbitrary SMTP commands
[09:56] meaning it could come from admin at
[09:58] Outlook look.com or
[10:00] whatever so yeah that's the theory at
[10:04] least and to see if this really
[10:07] works I first of all checked out some
[10:10] SMTP server implementations by simply
[10:12] connecting to some servers via tnet or
[10:15] via
[10:16] netcat and when I did that and I sent
[10:19] the data command first of all it looked
[10:21] like very RFC conform so basically when
[10:25] you send the data command the server
[10:26] asks you to stop this data stream via
[10:29] carryer turn line feed. carer turn Line
[10:32] Feed but then I also found some servers
[10:34] that just say well just send me a DOT on
[10:37] Al line by itself and the thing with
[10:39] this do on Al line by itself is that
[10:41] it's very much dependent on the
[10:43] operating system that you're on meaning
[10:46] on Windows this could be a carriage
[10:48] return line feed. carriage return line
[10:50] feed on Linux this could be a line feed
[10:53] doline
[10:54] feed and at that point I I thought I was
[10:57] on to something so
[11:00] I checked something out and the first
[11:02] thing I tried is like using these kinds
[11:05] of line feeds Carriage returns dots and
[11:08] trying to like stuff them through
[11:10] SpongeBob so I wrote an SMTP analysis
[11:13] client which basically sends emails
[11:16] containing fake end of data sequences
[11:18] for example line feed. linefeed and I
[11:21] sent them through various kinds of SMTP
[11:23] software this includes email services
[11:25] like Gmail like Outlook like GMX but Al
[11:29] email software like send mail like
[11:31] postfix XM Microsoft uh Exchange Server
[11:34] and so on and now on the inbound side on
[11:38] the inbound receiver side I checked
[11:41] which fake sequences actually go through
[11:44] so can I send a line feed. line feed
[11:48] through an outbound server and in most
[11:51] cases it doesn't work like a line feed.
[11:54] line feed very often just gets filtered
[11:56] or removed from the initial email
[12:00] but in some
[12:01] cases it just goes through without a
[12:04] change and this was the case for GMX so
[12:08] basically I send an email from GMX to my
[12:11] analysis server and the line feed.
[12:13] carriage return line feed sequence did
[12:15] not get filtered whatsoever so now what
[12:17] I did is I created a proof of concept
[12:21] here where first of all we s an email
[12:23] then we have this fake end of data
[12:25] sequence and then we have SMTP commands
[12:28] and data for a second email so now if
[12:31] this proof of concept works we should
[12:33] receive two emails on our receiver end
[12:37] and I sent all of this to Gmail and
[12:39] Gmail was like yeah this is not an end
[12:42] of data sequence and you can see that
[12:45] because everything after this end of
[12:47] data sequence is still interpreted as
[12:48] message
[12:49] data but in some cases it actually works
[12:54] and this was the first case of
[12:56] successful SMTP smuggling so from GMX to
[13:00] FastMail and we can see that it works
[13:03] because well we have two emails we have
[13:04] first of all user at gmx.net and
[13:07] secondly an email from admin gmx.net
[13:10] that passes SPF and Demar checks as well
[13:13] because it comes from the actual server
[13:16] from
[13:19] [Applause]
[13:27] GMX and I was like okay this is super
[13:32] sick but I was thinking so we have this
[13:35] second email and everything can be in
[13:37] there like the sender address can be
[13:39] anything so why not try other domains
[13:43] that point to the server of
[13:46] GMX and then I analyzed the SPF record
[13:49] and I realized well there we have the
[13:52] GMX SPF record but this is very similar
[13:56] to the web de SP PF record which is also
[14:00] very similar to the one of
[14:02] yonos and the thing is that we can now
[14:05] spoof like 1.35 million domains with
[14:08] this so if you don't know yonos they're
[14:11] like a super big hosting provider and
[14:13] they also provide emailing services and
[14:15] yeah they have like all these 1.35
[14:17] million domains pointing here so yeah I
[14:22] had of course had to try this so here's
[14:24] an email from admin at
[14:27] webd and now of course there's a
[14:29] question of does this work everywhere
[14:32] because as I said this only works with
[14:35] servers that interpret well non RFC
[14:38] conform end of data sequences like line
[14:40] feed. carry to return
[14:41] linefeed so we can smuggle or spoof
[14:44] these 1.35 million domains to well some
[14:49] servers so essentially we have 1.4
[14:52] million postfix instances and like 150k
[14:55] sand mail instances and this works well
[14:58] because they interpret car interpret
[15:01] Line feed. Car linefeed confusing myself
[15:03] here as n of data
[15:06] sequence and I was like okay this is
[15:08] pretty severe but there is more so I
[15:12] looked at outlook.com as well and
[15:15] Outlook gave me a very weird uh error
[15:18] message because they were like bare line
[15:20] feeds are illegal and I was like oh damn
[15:23] they they know what I'm doing
[15:27] here
[15:29] and therefore I analyzed it like okay
[15:32] you're not going to scare me with that
[15:33] one so then I found out well line feed.
[15:36] carriage Line Feed is also possible
[15:48] here yeah so let's have some
[15:50] fun the thing is however at that point I
[15:52] wasn't really sure if I'm going insane
[15:54] or if this actually works so I needed
[15:56] some kind of Sanity check and
[15:59] therefore I sent an email from
[16:00] admin@outlook.com to some
[16:03] co-workers and the idea behind this is
[16:06] if they react to this it works otherwise
[16:09] I'm insane
[16:11] so
[16:16] yeah and maybe now for a more
[16:19] International example because this is
[16:21] very Austrian I guess I don't know so
[16:27] yeah
[16:30] I guess you also understand this if you
[16:32] don't speak
[16:33] German and now you might be like okay we
[16:36] can send text based spoofed emails but
[16:39] you're not going to like fool anyone
[16:41] with this but thing is like we can
[16:43] smuggle basically anything HTML included
[16:47] so here I sent an email a fishing email
[16:51] an an unusual signin activity email from
[16:54] no reply at outlook.com from the actual
[16:57] outlook.com server was to myself and it
[17:00] just went
[17:02] through yeah but again what's what's
[17:07] possible with this and I was wondering
[17:10] so we can spoof outlook.com but what
[17:13] what else can we do with this so I
[17:16] looked at the SPF record and it was well
[17:20] weird in terms of weirdly familiar
[17:23] because this is not only the SPF record
[17:25] of outlook.com but also the SPF record
[17:28] of like millions of other
[17:31] domains because this is actually like
[17:35] the SPF record from exchange online
[17:39] because outlook.com sends its emails
[17:41] well Across The Exchange online
[17:43] infrastructure so yeah now we can
[17:46] basically spoof them all so I again had
[17:49] to test this
[17:57] one
[18:06] but the thing is here this only worked
[18:08] on a technical level so I didn't get the
[18:12] race so what's the impact essentially we
[18:15] can spoof from millions of domains but
[18:18] who accepts these emails again post fix
[18:21] and send mail however only postfix and
[18:24] sand mail instances they do not support
[18:26] the bat command and the bat command is
[18:29] like an alternative to the data command
[18:31] and if that is supported it doesn't
[18:34] work so that was outbound SMTP smuggling
[18:38] so that is like one part of it but then
[18:40] there is also inbound SMTP smuggling and
[18:44] with outbound SMTP smuggling the issue
[18:46] was basically at the outbound server
[18:48] because the outbound server basically
[18:51] failed to filter or insufficiently
[18:53] filtered like fake end of data sequences
[18:56] like line feed. Carri feed so now with
[19:00] Microsoft and GMX and then there's also
[19:03] inbound SMTP smuggling and this happens
[19:06] when there is just an inbound server
[19:09] that interprets such a wild end of data
[19:12] sequence that the outbound server would
[19:15] never even get the idea of filtering
[19:17] that and I found exactly that with Cisco
[19:20] secure of course
[19:22] email Cloud
[19:25] Gateway so because what they do is they
[19:28] clean the message and every bare Line
[19:31] Feed and every bare Carri turn character
[19:34] now gets replaced with a carriage return
[19:36] line feed so essentially a carriage
[19:39] return. carriage return gets interpreted
[19:42] as end of data
[19:46] [Applause]
[19:53] sequence and the issue of course is now
[19:57] that this Carri return. carar return
[19:59] does not get filtered at all basically
[20:02] so there are of course some service that
[20:04] filter this but we have again exchange
[20:06] online iCloud sent mail postfix and so
[20:09] many others that just let this through
[20:11] and I guess it kind of makes sense to
[20:13] let this through because I wouldn't get
[20:14] the idea of filtering that
[20:16] either so I had to test this out
[20:20] again and unfortunately or well
[20:24] technically it worked again but I did
[20:25] not receive any Apple devices not that I
[20:28] wanted that anyways but
[20:33] yeah what's the impact here so
[20:35] essentially we can spoof from even more
[20:38] domains as before like we have exchange
[20:40] online we have iCloud we have all post
[20:43] fix and
[20:44] sendmail and we can spoof to companies
[20:48] that can actually afford this stuff so
[20:50] like pretty big companies here this also
[20:54] includes like 40 other uh 40K other
[20:57] domains and that that's only the ones
[20:59] that are hosted in a cloud so they're
[21:01] also on Prime but I wasn't able to
[21:03] enumerate
[21:05] them yeah and now to the part that's
[21:08] probably interesting to you or to the
[21:11] most at least so the responsible
[21:14] disclosure so essentially on a purely
[21:17] technical level regarding inbound and
[21:20] outbound servers who's at fault here so
[21:22] essentially we have inbound servers that
[21:24] are never supposed or not supposed to
[21:26] interpret anything else as end of data
[21:28] sequence then a carriage return line
[21:30] feed. carriage return line feed at least
[21:32] by the RFC and then there are outbound
[21:35] SMTP servers that are not supposed to
[21:37] send Carriage returns and line feeds
[21:40] independent of each other so yeah
[21:42] basically everyone's at fault so we sent
[21:44] that to GMX and they were like super
[21:47] thankful and they were like okay we're
[21:49] going to fix this right away 10 days
[21:51] later they fixed this they said okay can
[21:54] we recheck this we recheck this they
[21:56] actually fixed this they paid us a small
[21:59] Bounty they even put us in their back
[22:02] Bounty Hall of Fame and all all on like
[22:05] that was a 10 out of 10
[22:07] [Applause]
[22:14] experience I'm going to send them this
[22:16] clip of you clapping thank you and yeah
[22:20] it really felt like we should have paid
[22:22] them the back bound you because yeah but
[22:25] the thing is from here it just goes
[22:27] downhill
[22:29] so we have Microsoft and Microsoft was
[22:32] like yeah this is like a moderate risk
[22:35] vulnerability
[22:37] because I don't know I guess they have
[22:39] bigger fish to fry but yeah
[22:43] anyways so we sent it to them and like 3
[22:47] months later they closed the case and
[22:49] said yeah all right it's fixed no bnie
[22:52] whatsoever so okay but the thing is at
[22:55] that point well I already got what I
[22:57] want wanted and that's an email from
[23:00] admin
[23:04] microsoft.com and now to Cisco well
[23:07] Cisco was like okay this is not a
[23:09] vulnerability this is a documented and
[23:12] configurable
[23:23] [Applause]
[23:25] feature and we were like okay that's a
[23:27] weird feature because
[23:30] like we can spoof some emails with that
[23:34] so yeah we said okay at least like tell
[23:37] your customers about this feature that
[23:39] it's maybe not the best default feature
[23:42] but yeah
[23:44] anyways yeah they said
[23:47] no
[23:49] yeah so then we were like okay we got
[23:52] this whole big SMTP smuggling issue
[23:54] Cisco doesn't want to fix anything
[23:56] Microsoft at that point was was
[23:58] vulnerable and we take this case to C CC
[24:02] and C CC for all of you that don't know
[24:04] that is the C coordination Center and
[24:07] they basically handle all these big
[24:08] vulnerabilities so that could have a
[24:10] worldwide impact and we sent this to
[24:12] them and they actually accepted the case
[24:15] and now you're like in this Vince portal
[24:18] this which is basically a big glorified
[24:20] chat room with 14 vendors we have like
[24:23] sent mail Microsoft Cisco uh Google in
[24:26] there and yeah so now you can start
[24:29] talking about the vulnerability and the
[24:31] first conversation was basically with
[24:33] Cisco still saying that they're not
[24:35] vulnerable you know yeah it's not a bug
[24:38] it's a feature and yeah essentially they
[24:42] were still like it's not a vulnerability
[24:44] and then sis uh CC was like yeah this is
[24:47] not a vulnerability for some reason okay
[24:50] so what about the general SMTP smuggling
[24:53] problem so what about postfix and sent
[24:56] mail interpreting non RFC conform and of
[24:58] data
[25:00] sequences so first of all sent mail was
[25:02] in this Vince portal to begin with so
[25:05] from the start they got all the puc's
[25:07] all the messages all yeah everything and
[25:11] they were like they didn't say anything
[25:14] and then what about postfix because
[25:17] they're 10 times larger essentially C CC
[25:20] was like first of all I don't know why
[25:22] they didn't add them to the case
[25:24] directly but they sent them an email or
[25:27] contacted them VI email but forgot to
[25:29] mention SMTP smuggling so now we're here
[25:33] thinking that they told po so we thought
[25:35] that they told postfix sent mail
[25:37] apparently didn't care C CC sides with
[25:41] Cisco regarding this feature so now
[25:44] we're like okay CIS uh Cisco yeah is
[25:47] definitely vulnerable we've confirmed
[25:49] that so we would like to publish this
[25:51] any blog post and that's where all the
[25:53] problem
[25:54] starts so we said okay okay we would
[25:58] like to publish this any blog post and
[26:00] we would warn Cisco customers about the
[26:02] feature and CC is like go ahead so just
[26:08] send us the link to the blog post once
[26:10] this is
[26:11] published and we were like yeah we go
[26:15] ahead with that and now basically we
[26:17] opened Pandora's Box because now 1.6
[26:21] million post M uh post fix and send mail
[26:24] instances on the internet are vulnerable
[26:26] meaning now if there is another case of
[26:29] outbound SMTP smuggling you can smuggle
[26:32] to post fix and send mail
[26:35] still does that mean second consult is
[26:37] not at fault at all of course sa consult
[26:39] is at fault because we published this
[26:41] blog post thinking that the impact of
[26:44] all of this is way lower than it
[26:46] actually is based on our great
[26:49] conversation with CTC and Vince in
[26:51] general and also if we would have just
[26:54] double checked that with postfix that
[26:56] this is really not not an issue none of
[26:58] this would have happened because postfix
[27:00] is very adamant about the fact that this
[27:02] is actually an
[27:03] issue so yeah in conclusion what does
[27:07] this mean please fix your postfix
[27:09] service you can find more information
[27:11] about that on the postfix website also
[27:14] please fix your Cisco service you can
[27:16] find more information about that on the
[27:18] second consult blog
[27:26] post
[27:30] [Applause]
[27:31] in the end however there is some kind of
[27:34] Sil Silver Lining at least because now
[27:36] postfix is directly in the Vince case
[27:39] and they've already made some great
[27:41] contributions so we're not putting our
[27:43] head in the sand and we're actively
[27:44] somehow trying to close Pandora's Box
[27:47] again and what does that mean
[27:49] essentially more research on like SMTP
[27:53] smuggling I mean asked straty before to
[27:55] like look at this more but yeah this
[27:58] didn't really end well and more blog
[28:01] posts more research first first and
[28:03] foremost um more vendors in the Vince
[28:06] case so we're trying to get everything
[28:08] fixed right now and again we are very
[28:10] sorry that this happened in the first
[28:13] place and
[28:16] finally something that probably all of
[28:18] you know anyways do not trust emails
[28:22] blindly especially not
[28:26] now thank you
[28:38] [Applause]
[28:45] nice thank you let's go with the Q&A um
[28:48] please go ahead hello I one small
[28:52] question the C CC stuff was this
[28:55] communicated via email and could you not
[28:59] have sent the mail at Cisco
[29:02] CD um yeah I mean we could have done
[29:06] that and created some kind of love
[29:07] triangle between Bill Gates Elon Musk
[29:10] and someone else I guess
[29:13] but yeah no we didn't see this email
[29:16] unfortunately like we saw it after that
[29:19] yeah but then it was kind of too late
[29:24] unfortunately uh hi thank you appreciate
[29:27] the work um can you maybe tell us a
[29:30] little bit about the timeline like when
[29:33] did you first discover this like how
[29:35] fresh this was first discovered so I
[29:38] started the research in June this year
[29:41] so basically we I had a research project
[29:43] at Sault for like 10 days and I was like
[29:46] okay these 10 days they're not going to
[29:47] be enough so I started 10 days earlier
[29:50] and then I like found SMTP smuggling on
[29:54] day six and yeah then it just goes on
[29:57] from telling this GMX Outlook or
[30:01] Microsoft and Cisco because they had
[30:04] these severe cases of SMTP smuggling
[30:06] meaning outbound and inbound and then we
[30:08] went ahead and told this to cery because
[30:10] there seems to be a general issue with
[30:13] SMTP smuggling worldwide and timeline
[30:16] wise I don't have it here right now but
[30:18] it is in the second Sal blog post and
[30:22] yeah but is is there a specific date
[30:25] that you want to know no no just I'll
[30:27] check the blog post
[30:29] thanks
[30:31] one hello um thank you for the good talk
[30:37] here um I wanted to ask is there any
[30:39] evidence or any suggestions that this
[30:42] has been used already um because this
[30:46] seems like a well pretty easy exploit to
[30:50] use so I might imagine it has been used
[30:53] already yeah I've mean I mean I received
[30:56] some comments on on my Reddit post and
[30:58] it was like yeah this is super old but
[31:01] thing
[31:02] is medium severity yeah probably no I I
[31:07] don't know I don't know really I I
[31:09] looked at lots of research but nothing
[31:11] really said otherwise so that's why I
[31:13] called it the novel vulnerability so I
[31:15] don't
[31:26] know
[31:27] [Music]
[31:38] la
