=== Content from lists.fedoraproject.org_08df3a04_20250114_225531.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-RBEOAFKRARQHTDIYSL723XAFJ2Q6624X.mbox.gz?message=RBEOAFKRARQHTDIYSL723XAFJ2Q6624X "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/#RBEOAFKRARQHTDIYSL723XAFJ2Q6624X)

# [SECURITY] Fedora 39 Update: cacti-spine-1.2.27-1.fc39

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

31 May
2024

31 May
'24

2:14 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-27a594f71d
2024-05-31 02:13:07.316161
--------------------------------------------------------------------------------

Name : cacti-spine
Product : Fedora 39
Version : 1.2.27
Release : 1.fc39
URL : <https://cacti.net>
Summary : Threaded poller for Cacti written in C
Description :
Spine is a supplemental poller for Cacti that makes use of pthreads to achieve
excellent performance.

--------------------------------------------------------------------------------
Update Information:

Update cacti and cacti-spine to version 1.2.27. This includes the upstream fixes
for many CVEs, including a critical remote code execution bug.
<https://github.com/Cacti/cacti/blob/release/1.2.27/CHANGELOG>
<https://github.com/Cacti/spine/blob/release/1.2.27/CHANGELOG>
--------------------------------------------------------------------------------
ChangeLog:

\* Wed May 22 2024 Carl George carlwgeorge@fedoraproject.org - 1.2.27-1
- Update to version 1.2.27
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2255602 - CVE-2023-49084 cacti: RCE when managing links [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2255602>
[ 2 ] Bug #2255606 - CVE-2023-49086 cacti: XSS when adding new devices [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2255606>
[ 3 ] Bug #2255667 - CVE-2023-49085 CVE-2023-49088 CVE-2023-50250 CVE-2023-51448 cacti: Multiple vulnerabilities [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2255667>
[ 4 ] Bug #2280482 - CVE-2024-34340 cacti: authentication bypass when using older password hashes [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280482>
[ 5 ] Bug #2280497 - CVE-2024-29894 cacti: XSS vulnerability when using JavaScript based messaging API [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280497>
[ 6 ] Bug #2280500 - CVE-2024-31458 CVE-2024-31459 CVE-2024-31460 cacti: multiple vulnerabilities [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280500>
[ 7 ] Bug #2280503 - CVE-2024-31443 CVE-2024-31444 CVE-2024-31445 cacti: multiple vulnerabilties [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280503>
[ 8 ] Bug #2280506 - CVE-2024-25641 cacti: remote code execution vulnerability [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280506>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-27a594f71d' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/#RBEOAFKRARQHTDIYSL723XAFJ2Q6624X)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from github.com_53c999e1_20250114_225529.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fblob%2F5f6f65c215d663a775950b2d9db35edbaf07d680%2Fmanagers.php)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fblob%2F5f6f65c215d663a775950b2d9db35edbaf07d680%2Fmanagers.php)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Cacti%2Fcacti)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Cacti](/Cacti)
/
**[cacti](/Cacti/cacti)**
Public

* [Notifications](/login?return_to=%2FCacti%2Fcacti) You must be signed in to change notification settings
* [Fork
  406](/login?return_to=%2FCacti%2Fcacti)
* [Star
   1.7k](/login?return_to=%2FCacti%2Fcacti)

* [Code](/Cacti/cacti)
* [Issues
  144](/Cacti/cacti/issues)
* [Pull requests
  1](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects
  0](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

Additional navigation options

* [Code](/Cacti/cacti)
* [Issues](/Cacti/cacti/issues)
* [Pull requests](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

## Files

 5f6f65c
## Breadcrumbs

1. [cacti](/Cacti/cacti/tree/5f6f65c215d663a775950b2d9db35edbaf07d680)
/
# managers.php

Copy path Blame  Blame
## Latest commit

## History

[History](/Cacti/cacti/commits/5f6f65c215d663a775950b2d9db35edbaf07d680/managers.php)1096 lines (917 loc) · 35.6 KB 5f6f65c
## Breadcrumbs

1. [cacti](/Cacti/cacti/tree/5f6f65c215d663a775950b2d9db35edbaf07d680)
/
# managers.php

Top
## File metadata and controls

* Code
* Blame

1096 lines (917 loc) · 35.6 KB[Raw](https://github.com/Cacti/cacti/raw/5f6f65c215d663a775950b2d9db35edbaf07d680/managers.php)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000<?php/\* +-------------------------------------------------------------------------+ | Copyright (C) 2004-2023 The Cacti Group | | | | This program is free software; you can redistribute it and/or | | modify it under the terms of the GNU General Public License | | as published by the Free Software Foundation; either version 2 | | of the License, or (at your option) any later version. | | | | This program is distributed in the hope that it will be useful, | | but WITHOUT ANY WARRANTY; without even the implied warranty of | | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the | | GNU General Public License for more details. | +-------------------------------------------------------------------------+ | Cacti: The Complete RRDtool-based Graphing Solution | +-------------------------------------------------------------------------+ | This code is designed, written, and maintained by the Cacti Group. See | | about.php and/or the AUTHORS file for specific developer information. | +-------------------------------------------------------------------------+ | http://www.cacti.net/ | +-------------------------------------------------------------------------+\*/
include('./include/auth.php');
$actions = array( 1 => \_\_('Delete'), 2 => \_\_('Disable'), 3 => \_\_('Enable'),);
$mactions = array( 1 => \_\_('Disable'), 2 => \_\_('Enable'));
$tabs\_manager\_edit = array( 'general' => \_\_('General'), 'notifications' => \_\_('Notifications'), 'logs' => \_\_('Logs'),);
/\* set default action \*/set\_default\_action();
get\_filter\_request\_var('tab', FILTER\_CALLBACK, array('options' => 'sanitize\_search\_string'));
switch (get\_request\_var('action')) { case 'save': form\_save();
 break; case 'actions': form\_actions();
 break; case 'edit': top\_header(); manager\_edit(); bottom\_footer();
 break;
 default: top\_header(); manager(); bottom\_footer();
 break;}
function manager() { global $config, $actions, $item\_rows;
 /\* ================= input validation and session storage ================= \*/ $filters = array( 'rows' => array( 'filter' => FILTER\_VALIDATE\_INT, 'pageset' => true, 'default' => '-1' ), 'page' => array( 'filter' => FILTER\_VALIDATE\_INT, 'default' => '1' ), 'filter' => array( 'filter' => FILTER\_DEFAULT, 'pageset' => true, 'default' => '' ), 'sort\_column' => array( 'filter' => FILTER\_CALLBACK, 'default' => 'hostname', 'options' => array('options' => 'sanitize\_search\_string') ), 'sort\_direction' => array( 'filter' => FILTER\_CALLBACK, 'default' => 'ASC', 'options' => array('options' => 'sanitize\_search\_string') ) );
 validate\_store\_request\_vars($filters, 'sess\_snmp\_mgr'); /\* ================= input validation ================= \*/
 if (get\_request\_var('rows') == '-1') { $rows = read\_config\_option('num\_rows\_table'); } else { $rows = get\_request\_var('rows'); }
 ?> <script type="text/javascript"> function applyFilter() { strURL = 'managers.php'; strURL += '?filter=' + $('#filter').val(); strURL += '&rows=' + $('#rows').val(); loadUrl({url:strURL}) }
 function clearFilter() { strURL = 'managers.php?clear=1'; loadUrl({url:strURL}) }
 $(function() { $('#refresh').click(function() { applyFilter(); });
 $('#clear').click(function() { clearFilter(); });
 $('#form\_snmpagent\_managers').submit(function(event) { event.preventDefault(); applyFilter(); }); }); </script> <?php
 html\_start\_box(\_\_('SNMP Notification Receivers'), '100%', '', '3', 'center', 'managers.php?action=edit');
 ?> <tr class='even noprint'> <td> <form id='form\_snmpagent\_managers' action='managers.php'> <table class='filterTable'> <tr> <td> <?php print \_\_('Search'); ?> </td> <td> <input type='text' class='ui-state-default ui-corner-all' id='filter' size='25' value='<?php print html\_escape\_request\_var('filter');?>' onChange='applyFilter()'> </td> <td> <?php print \_\_('Receivers'); ?> </td> <td> <select id='rows' onChange='applyFilter()'> <option value='-1'<?php print(get\_request\_var('rows') == '-1' ? ' selected>':'>') . \_\_('Default');?></option> <?php if (cacti\_sizeof($item\_rows)) { foreach ($item\_rows as $key => $value) { print "<option value='" . $key . "'";
 if (get\_request\_var('rows') == $key) { print ' selected'; } print '>' . html\_escape($value) . '</option>'; } } ?> </select> </td> <td> <span> <input type='button' class='ui-button ui-corner-all ui-widget' id='refresh' value='<?php print \_\_esc('Go');?>' title='<?php print \_\_esc('Set/Refresh Filters');?>'> <input type='button' class='ui-button ui-corner-all ui-widget' id='clear' value='<?php print \_\_esc('Clear');?>' title='<?php print \_\_esc('Clear Filters');?>'> </span> </td> </tr> </table> </form> </td> </tr> <?php html\_end\_box();
 /\* form the 'where' clause for our main sql query \*/ $sql\_where = 'WHERE ( sm.hostname LIKE ' . db\_qstr('%' . get\_request\_var('filter') . '%') . ' OR sm.description LIKE ' . db\_qstr('%' . get\_request\_var('filter') . '%') . ')';
 $total\_rows = db\_fetch\_cell("SELECT COUNT(sm.id) FROM snmpagent\_managers AS sm $sql\_where");
 $sql\_order = get\_order\_string(); $sql\_limit = ' LIMIT ' . ($rows \* (get\_request\_var('page') - 1)) . ',' . $rows;
 $managers = db\_fetch\_assoc("SELECT sm.id, sm.description, sm.hostname, sm.disabled, smn.count\_notify, snl.count\_log FROM snmpagent\_managers AS sm LEFT JOIN ( SELECT COUNT(\*) as count\_notify, manager\_id FROM snmpagent\_managers\_notifications GROUP BY manager\_id ) AS smn ON smn.manager\_id = sm.id LEFT JOIN ( SELECT COUNT(\*) as count\_log, manager\_id FROM snmpagent\_notifications\_log GROUP BY manager\_id ) AS snl ON snl.manager\_id = sm.id $sql\_where $sql\_order $sql\_limit");
 $display\_text = array( 'description' => array( \_\_('Description'), 'ASC'), 'id' => array( \_\_('Id'), 'ASC'), 'disabled' => array( \_\_('Status'), 'ASC'), 'hostname' => array( \_\_('Hostname'), 'ASC'), 'count\_notify' => array( \_\_('Notifications'), 'ASC'), 'count\_log' => array( \_\_('Logs'), 'ASC') );
 /\* generate page list \*/ $nav = html\_nav\_bar('managers.php?filter=' . get\_request\_var('filter'), MAX\_DISPLAY\_PAGES, get\_request\_var('page'), $rows, $total\_rows, 11, \_\_('Receivers'), 'page', 'main');
 form\_start('managers.php', 'chk');
 print $nav;
 html\_start\_box('', '100%', '', '3', 'center', '');
 html\_header\_sort\_checkbox($display\_text, get\_request\_var('sort\_column'), get\_request\_var('sort\_direction'), false);
 $i = 0;
 if (cacti\_sizeof($managers)) { foreach ($managers as $item) { $description = filter\_value($item['description'], get\_request\_var('filter')); $hostname = filter\_value($item['hostname'], get\_request\_var('filter')); form\_alternate\_row('line' . $item['id'], false); form\_selectable\_cell('<a class="linkEditMain" href="' . html\_escape(CACTI\_PATH\_URL . 'managers.php?action=edit&id=' . $item['id']) . '">' . html\_escape($description) . '</a>', $item['id']); form\_selectable\_cell($item['id'], $item['id']); form\_selectable\_cell($item['disabled'] ? '<span class="deviceDown">' . \_\_('Disabled') . '</span>' : '<span class="deviceUp">' . \_\_('Enabled') . '</span>', $item['id']); form\_selectable\_ecell($hostname, $item['id']); form\_selectable\_cell('<a class="linkEditMain" href="' . html\_escape(CACTI\_PATH\_URL . 'managers.php?action=edit&tab=notifications&id=' . $item['id']) . '">' . ($item['count\_notify'] ? $item['count\_notify'] : 0) . '</a>' , $item['id']); form\_selectable\_cell('<a class="linkEditMain" href="' . html\_escape(CACTI\_PATH\_URL . 'managers.php?action=edit&tab=logs&id=' . $item['id']) . '">' . ($item['count\_log'] ? $item['count\_log'] : 0) . '</a>', $item['id']); form\_checkbox\_cell($item['description'], $item['id']); form\_end\_row(); } } else { print '<tr><td><em>' . \_\_('No SNMP Notification Receivers') . '</em></td></tr>'; }
 html\_end\_box(false);
 if (cacti\_sizeof($managers)) { print $nav; }
 form\_hidden\_box('action\_receivers', '1', '');
 draw\_actions\_dropdown($actions);
 form\_end();}
function manager\_edit() { global $config, $snmp\_auth\_protocols, $snmp\_priv\_protocols, $snmp\_versions, $tabs\_manager\_edit, $fields\_manager\_edit, $mactions;
 /\* ================= input validation ================= \*/ get\_filter\_request\_var('id'); /\* ==================================================== \*/
 if (!isset\_request\_var('tab')) { set\_request\_var('tab', 'general'); } $id = (isset\_request\_var('id') ? get\_request\_var('id') : '0');
 if ($id) { $manager = db\_fetch\_row\_prepared('SELECT \* FROM snmpagent\_managers WHERE id = ?', array(get\_request\_var('id'))); $header\_label = \_\_esc('SNMP Notification Receiver [edit: %s]', $manager['description']); } else { $header\_label = \_\_('SNMP Notification Receiver [new]'); }
 if (cacti\_sizeof($tabs\_manager\_edit) && isset\_request\_var('id')) { $i = 0;
 /\* draw the tabs \*/ print "<div class='tabs'><nav><ul role='tablist'>";
 foreach (array\_keys($tabs\_manager\_edit) as $tab\_short\_name) { if (($id == 0 && $tab\_short\_name != 'general')) { print "<li class='subTab'><a href='#' " . (($tab\_short\_name == get\_request\_var('tab')) ? "class='selected'" : '') . "'>" . $tabs\_manager\_edit[$tab\_short\_name] . '</a></li>'; } else { print "<li class='subTab'><a " . (($tab\_short\_name == get\_request\_var('tab')) ? "class='selected'" : '') . " href='" . html\_escape(CACTI\_PATH\_URL . 'managers.php?action=edit&id=' . get\_request\_var('id') . '&tab=' . $tab\_short\_name) . "'>" . $tabs\_manager\_edit[$tab\_short\_name] . '</a></li>'; }
 $i++; }
 print '</ul></nav></div>';
 if (read\_config\_option('legacy\_menu\_nav') != 'on') { ?> <script type='text/javascript'>
 $(function() { $('.subTab').find('a').click(function(event) { event.preventDefault();
 strURL = $(this).attr('href'); strURL += (strURL.indexOf('?') > 0 ? '&':'?'); loadUrl({url:strURL}) }); }); </script> <?php } }
 switch(get\_request\_var('tab')) { case 'notifications': manager\_notifications($id, $header\_label);
 break; case 'logs': manager\_logs($id, $header\_label);
 break;
 default: form\_start('managers.php');
 html\_start\_box($header\_label, '100%', true, '3', 'center', '');
 draw\_edit\_form( array( 'config' => array('no\_form\_tag' => true), 'fields' => inject\_form\_variables($fields\_manager\_edit, (isset($manager) ? $manager : array())) ) );
 html\_end\_box(true, true);
 form\_save\_button('managers.php', 'return');
 ?> <script type='text/javascript'>
 // Need to set this for global snmpv3 functions to remain sane between edits snmp\_security\_initialized = false;
 $(function() { setSNMP(); }); </script> <?php }
 ?> <script language='javascript' type='text/javascript' > $('.tooltip').tooltip({ track: true, position: { collision: 'flipfit' }, content: function() { return DOMPurify.sanitize($(this).attr('title')); } }); </script> <?php}
function manager\_notifications($id, $header\_label) { global $item\_rows, $mactions;
 $mibs = db\_fetch\_assoc('SELECT DISTINCT mib FROM snmpagent\_cache'); $registered\_mibs = array();
 if ($mibs && $mibs > 0) { foreach ($mibs as $mib) { $registered\_mibs[] = $mib['mib']; } }
 /\* ================= input validation ================= \*/ if (!$id | !is\_numeric($id)) { die\_html\_input\_error('id'); }
 if (!in\_array(get\_request\_var('mib'), $registered\_mibs, true) && get\_request\_var('mib') != '-1' && get\_request\_var('mib') != '') { die\_html\_input\_error('mib'); } /\* ==================================================== \*/
 /\* ================= input validation and session storage ================= \*/ $filters = array( 'rows' => array( 'filter' => FILTER\_VALIDATE\_INT, 'pageset' => true, 'default' => '-1' ), 'page' => array( 'filter' => FILTER\_VALIDATE\_INT, 'default' => '1' ), 'filter' => array( 'filter' => FILTER\_DEFAULT, 'pageset' => true, 'default' => '' ), 'mib' => array( 'filter' => FILTER\_CALLBACK, 'pageset' => true, 'default' => '-1', 'options' => array('options' => 'sanitize\_search\_string') ), 'sort\_column' => array( 'filter' => FILTER\_CALLBACK, 'default' => 'name', 'options' => array('options' => 'sanitize\_search\_string') ), 'sort\_direction' => array( 'filter' => FILTER\_CALLBACK, 'default' => 'ASC', 'options' => array('options' => 'sanitize\_search\_string') ) );
 validate\_store\_request\_vars($filters, 'sess\_snmp\_cache'); /\* ================= input validation ================= \*/
 if (get\_request\_var('rows') == '-1') { $rows = read\_config\_option('num\_rows\_table'); } else { $rows = get\_request\_var('rows'); }
 html\_start\_box($header\_label, '100%', '', '3', 'center', '');
 ?> <script type='text/javascript'>
 function applyFilter() { strURL = 'managers.php?action=edit&tab=notifications&id=<?php print $id; ?>'; strURL += '&mib=' + $('#mib').val(); strURL += '&rows=' + $('#rows').val(); strURL += '&filter=' + $('#filter').val();
 loadUrl({url:strURL}) }
 function clearFilter() { strURL = 'managers.php?action=edit&tab=notifications&id=<?php print $id; ?>&clear=1'; loadUrl({url:strURL}) }
 $(function() { $('#refresh').click(function() { applyFilter(); });
 $('#clear').click(function() { clearFilter(); });
 $('#form\_snmpagent\_managers').submit(function(event) { event.preventDefault(); applyFilter(); }); });
 </script> <tr class='even noprint'> <td> <form id='form\_snmpagent\_managers' name='form\_snmpagent\_managers' action='managers.php'> <table class='filterTable'> <tr> <td> <?php print \_\_('MIB');?> </td> <td> <select id='mib' name='mib' onChange='applyFilter()'> <option value='-1'<?php if (get\_request\_var('mib') == '-1') {?> selected<?php }?>><?php print \_\_('Any');?></option> <?php if (cacti\_sizeof($mibs)) { foreach ($mibs as $mib) { print "<option value='" . html\_escape($mib['mib']) . "'";
 if (get\_request\_var('mib') == $mib['mib']) { print ' selected'; } print '>' . html\_escape($mib['mib']) . '</option>'; } } ?> </select> </td> <td> <?php print \_\_('Search');?> </td> <td> <input type='text' class='ui-state-default ui-corner-all' id='filter' size='25' value='<?php print html\_escape\_request\_var('filter');?>' onChange='applyFilter()'> </td> <td> <?php print \_\_('Receivers');?> </td> <td> <select id='rows' name='rows' onChange='applyFilter()'> <option value='-1'<?php print(get\_request\_var('rows') == '-1' ? ' selected>':'>') . \_\_('Default');?></option> <?php if (cacti\_sizeof($item\_rows)) { foreach ($item\_rows as $key => $value) { print "<option value='" . $key . "'";
 if (get\_request\_var('rows') == $key) { print ' selected'; } print '>' . html\_escape($value) . '</option>'; } } ?> </select> </td> <td> <span> <input type='button' class='ui-button ui-corner-all ui-widget' id='refresh' value='<?php print \_\_esc('Go');?>' title='<?php print \_\_esc('Set/Refresh Filters');?>'> <input type='button' class='ui-button ui-corner-all ui-widget' id='clear' value='<?php print \_\_esc('Clear');?>' title='<?php print \_\_esc('Clear Filters');?>'> </span> </td> </tr> </table> </form> </td> </tr> <?php
 html\_end\_box();
 $sql\_where = " AND `kind`='Notification'";
 /\* filter by host \*/ if (get\_request\_var('mib') == '-1') { /\* Show all items \*/ } elseif (!isempty\_request\_var('mib')) { $sql\_where .= " AND snmpagent\_cache.mib='" . get\_request\_var('mib') . "'"; } /\* filter by search string \*/ if (get\_request\_var('filter') != '') { $sql\_where .= ' AND ( `oid` LIKE ' . db\_qstr('%' . get\_request\_var('filter') . '%') . ' OR `name` LIKE ' . db\_qstr('%' . get\_request\_var('filter') . '%') . ' OR `mib` LIKE ' . db\_qstr('%' . get\_request\_var('filter') . '%') . ')'; } $sql\_where .= ' ORDER by `oid`';
 form\_start('managers.php', 'chk');
 /\* FIXME: Change SQL Queries to not use WHERE 1 \*/ $total\_rows = db\_fetch\_cell("SELECT COUNT(\*) FROM snmpagent\_cache WHERE 1 $sql\_where");
 $snmp\_cache\_sql = "SELECT \* FROM snmpagent\_cache WHERE 1 $sql\_where LIMIT " . ($rows \* (get\_request\_var('page') - 1)) . ',' . $rows; $snmp\_cache = db\_fetch\_assoc($snmp\_cache\_sql);
 $registered\_notifications = db\_fetch\_assoc\_prepared('SELECT notification, mib FROM snmpagent\_managers\_notifications WHERE manager\_id = ?', array($id)); $notifications = array();
 if ($registered\_notifications && cacti\_sizeof($registered\_notifications) > 0) { foreach ($registered\_notifications as $registered\_notification) { $notifications[$registered\_notification['mib']][$registered\_notification['notification']] = 1; } }
 $display\_text = array( \_\_('Name'), \_\_('OID'), \_\_('MIB'), \_\_('Kind'), \_\_('Max-Access'), \_\_('Monitored') );
 /\* generate page list \*/ $nav = html\_nav\_bar('managers.php?action=edit&id=' . $id . '&tab=notifications&mib=' . get\_request\_var('mib') . '&filter=' . get\_request\_var('filter'), MAX\_DISPLAY\_PAGES, get\_request\_var('page'), $rows, $total\_rows, cacti\_sizeof($display\_text) + 1, \_\_('Notifications'), 'page', 'main');
 print $nav;
 html\_start\_box('', '100%', '', '3', 'center', '');
 html\_header\_checkbox($display\_text, true, 'managers.php?action=edit&tab=notifications&id=' . $id);
 if (cacti\_sizeof($snmp\_cache)) { foreach ($snmp\_cache as $item) { $row\_id = $item['mib'] . '\_\_' . $item['name']; $oid = filter\_value($item['oid'], get\_request\_var('filter')); $name = filter\_value($item['name'], get\_request\_var('filter')); $mib = filter\_value($item['mib'], get\_request\_var('filter'));
 form\_alternate\_row('line' . $row\_id, false);
 if ($item['description']) { print '<td><a href="#" title="<div class=\'header\'>' . $name . '</div><div class=\'content preformatted\'>' . $item['description']. '</div>" class="tooltip">' . $name . '</a></td>'; } else { form\_selectable\_cell($name, $row\_id); }
 form\_selectable\_cell($oid, $row\_id); form\_selectable\_cell($mib, $row\_id); form\_selectable\_cell($item['kind'], $row\_id); form\_selectable\_cell($item['max-access'],$row\_id); form\_selectable\_cell(((isset($notifications[$item['mib']]) && isset($notifications[$item['mib']][$item['name']])) ? '<span class="deviceUp">' . \_\_('Enabled'):'<span class="deviceDown">' . \_\_('Disabled')) . '</span>', $row\_id); form\_checkbox\_cell($item['oid'], $row\_id); form\_end\_row(); } } else { print '<tr><td><em>' . \_\_('No SNMP Notifications') . '</em></td></tr>'; }
 ?> <input type='hidden' name='id' value='<?php print get\_request\_var('id'); ?>'> <?php
 html\_end\_box(false);
 if (cacti\_sizeof($snmp\_cache)) { print $nav; }
 draw\_actions\_dropdown($mactions);
 form\_end();}
function manager\_logs($id, $header\_label) { $severity\_levels = array( SNMPAGENT\_EVENT\_SEVERITY\_LOW => 'LOW', SNMPAGENT\_EVENT\_SEVERITY\_MEDIUM => 'MEDIUM', SNMPAGENT\_EVENT\_SEVERITY\_HIGH => 'HIGH', SNMPAGENT\_EVENT\_SEVERITY\_CRITICAL => 'CRITICAL' );
 $severity\_colors = array( SNMPAGENT\_EVENT\_SEVERITY\_LOW => '#00FF00', SNMPAGENT\_EVENT\_SEVERITY\_MEDIUM => '#FFFF00', SNMPAGENT\_EVENT\_SEVERITY\_HIGH => '#FF0000', SNMPAGENT\_EVENT\_SEVERITY\_CRITICAL => '#FF00FF' );
 if (isset\_request\_var('purge')) { db\_execute\_prepared('DELETE FROM snmpagent\_notifications\_log WHERE manager\_id = ?', array($id)); set\_request\_var('clear', true); }
 /\* ================= input validation ================= \*/ if (!$id | !is\_numeric($id)) { die\_html\_input\_error('id'); }
 if (!in\_array(get\_request\_var('severity'), array\_keys($severity\_levels), true) && get\_request\_var('severity') != '-1' && get\_request\_var('severity') != '') { die\_html\_input\_error('severity'); }
 /\* ==================================================== \*/
 /\* ================= input validation and session storage ================= \*/ $filters = array( 'rows' => array( 'filter' => FILTER\_VALIDATE\_INT, 'pageset' => true, 'default' => '-1' ), 'page' => array( 'filter' => FILTER\_VALIDATE\_INT, 'default' => '1' ), 'filter' => array( 'filter' => FILTER\_DEFAULT, 'pageset' => true, 'default' => '' ), 'severity' => array( 'filter' => FILTER\_VALIDATE\_INT, 'default' => '-1' ) );
 validate\_store\_request\_vars($filters, 'sess\_snmp\_logs'); /\* ================= input validation ================= \*/
 if (get\_request\_var('rows') == '-1') { $rows = read\_config\_option('num\_rows\_table'); } else { $rows = get\_request\_var('rows'); }
 html\_start\_box($header\_label, '100%', '', '3', 'center', '');
 ?> <script type='text/javascript'>
 function applyFilter(objForm) { strURL = '?severity=' + $('#severity').val(); strURL += '&filter=' + $('#filter').val(); strURL += '&action=edit&tab=logs&id=<?php print get\_request\_var('id'); ?>'; loadUrl({url:strURL}) }
 function showTooltip(e, div, title, desc) { div.style.display = 'inline'; div.style.position = 'fixed'; div.style.backgroundColor = '#EFFCF0'; div.style.border = 'solid 1px grey'; div.style.padding = '10px'; div.innerHTML = '<b>' + title + '</b><div style="padding-left:10px; padding-right:5px;"><pre>' + desc + '</pre></div>'; div.style.left = e.clientX + 15 + 'px'; div.style.top = e.clientY + 15 + 'px'; }
 function hideTooltip(div) { div.style.display = 'none'; }
 function highlightStatus(selectID){ if ($('#status\_' + selectID).val() == 'ON') { $('#status\_' + selectID).css('background-color', 'LawnGreen'); }else { $('#status\_' + selectID).css('background-color', 'OrangeRed'); } }
 </script> <tr class='even'> <td> <form name='form\_snmpagent\_manager\_logs' action='managers.php'> <table class='filterTable'> <tr> <td> <?php print \_\_('Search');?> </td> <td> <input type='text' class='ui-state-default ui-corner-all' id='filter' size='25' value='<?php print html\_escape\_request\_var('filter');?>'> </td> <td> <?php print \_\_('Severity');?> </td> <td> <select id='severity' onChange='applyFilter()'> <option value='-1'<?php if (get\_request\_var('severity') == '-1') {?> selected<?php }?>><?php print \_\_('Any');?></option> <?php foreach ($severity\_levels as $level => $name) { print "<option value='" . $level . "'";
 if (get\_request\_var('severity') == $level) { print ' selected'; } print '>' . $name . '</option>'; } ?> </select> </td> <td> <span> <input type='button' class='ui-button ui-corner-all ui-widget' id='refresh' value='<?php print \_\_esc('Go');?>' title='<?php print \_\_esc('Set/Refresh Filters');?>'> <input type='button' class='ui-button ui-corner-all ui-widget' id='clear' value='<?php print \_\_esc('Clear');?>' title='<?php print \_\_esc('Clear Filters');?>'> <input type='button' class='ui-button ui-corner-all ui-widget' id='purge' value='<?php print \_\_esc('Purge');?>' title='<?php print \_\_esc('Purge Notification Log');?>'> </span> </td> </tr> </table> <input type='hidden' name='action' value='edit'> <input type='hidden' name='tab' value='logs'> <input type='hidden' id='id' value='<?php print get\_request\_var('id'); ?>'> </form> </td> </tr> <?php
 html\_end\_box();
 $sql\_where = " snl.manager\_id='" . $id . "'";
 /\* filter by severity \*/ if (get\_request\_var('severity') == '-1') { /\* Show all items \*/ } elseif (!isempty\_request\_var('severity')) { $sql\_where .= " AND snl.severity='" . get\_request\_var('severity') . "'"; }
 /\* filter by search string \*/ if (get\_request\_var('filter') != '') { $sql\_where .= ' AND (`varbinds` LIKE ' . db\_qstr('%' . get\_request\_var('filter') . '%') . ')'; }
 $sql\_where .= ' ORDER by `id` DESC'; $sql\_query = "SELECT snl.\*, sc.description FROM snmpagent\_notifications\_log AS snl LEFT JOIN snmpagent\_cache AS sc ON sc.name = snl.notification WHERE $sql\_where LIMIT " . ($rows \* (get\_request\_var('page') - 1)) . ',' . $rows;
 form\_start('managers.php', 'chk');
 $total\_rows = db\_fetch\_cell("SELECT COUNT(\*) FROM snmpagent\_notifications\_log AS snl WHERE $sql\_where");
 $logs = db\_fetch\_assoc($sql\_query);
 $display\_text = array( '', \_\_('Time'), \_\_('Notification'), \_\_('Varbinds') );
 $nav = html\_nav\_bar('managers.php?action=exit&id=' . $id . '&tab=logs&mib=' . get\_request\_var('mib') . '&filter=' . get\_request\_var('filter'), MAX\_DISPLAY\_PAGES, get\_request\_var('page'), $rows, $total\_rows, cacti\_sizeof($display\_text), \_\_('Receivers'), 'page', 'main');
 print $nav;
 html\_start\_box('', '100%', '', '3', 'center', '');
 html\_header($display\_text);
 if (cacti\_sizeof($logs)) { foreach ($logs as $item) { $varbinds = filter\_value($item['varbinds'], get\_request\_var('filter'));
 form\_alternate\_row('line' . $item['id'], true);
 print "<td title='" . \_\_esc('Severity Level') . ': ' . $severity\_levels[$item['severity']] . "' style='width:10px;background-color: " . $severity\_colors[$item['severity']] . ";border-top:1px solid white;border-bottom:1px solid white;'></td>"; print "<td class='nowrap'>" . date('Y/m/d H:i:s', $item['time']) . '</td>';
 if ($item['description']) { $description = ''; $lines = preg\_split('/\r\n|\r|\n/', $item['description']);
 foreach ($lines as $line) { $description .= html\_escape(trim($line)) . '<br>'; } print '<td><a href="#" onMouseOut="hideTooltip(snmpagentTooltip)" onMouseMove="showTooltip(event, snmpagentTooltip, \'' . $item['notification'] . '\', \'' . $description . '\')">' . $item['notification'] . '</a></td>'; } else { print "<td>{$item['notification']}</td>"; } print "<td>$varbinds</td>"; form\_end\_row(); } } else { print '<tr><td><em>' . \_\_('No SNMP Notification Log Entries') . '</em></td></tr>'; }
 html\_end\_box();
 if (cacti\_sizeof($logs)) { print $nav; }
 ?> <input type='hidden' name='id' value='<?php print get\_filter\_request\_var('id'); ?>'> <div style='display:none' id='snmpagentTooltip'></div> <?php}
function form\_save() { if (!isset\_request\_var('tab')) { set\_request\_var('tab', 'general'); }
 /\* ================= input validation ================= \*/ get\_filter\_request\_var('id'); get\_filter\_request\_var('max\_log\_size');
 if (!in\_array(get\_nfilter\_request\_var('max\_log\_size'), range(1,31), true)) { die\_html\_input\_error('max\_log\_size'); } /\* ================= input validation ================= \*/
 switch(get\_nfilter\_request\_var('tab')) { case 'notifications': header('Location: managers.php?action=edit&tab=notifications&id=' . get\_request\_var('id'));
 break;
 default: $save['id'] = get\_request\_var('id'); $save['description'] = form\_input\_validate(trim(get\_nfilter\_request\_var('description')), 'description', '', false, 3); $save['hostname'] = form\_input\_validate(trim(get\_nfilter\_request\_var('hostname')), 'hostname', '', false, 3); $save['disabled'] = form\_input\_validate(get\_nfilter\_request\_var('disabled'), 'disabled', '^on$', true, 3); $save['max\_log\_size'] = get\_nfilter\_request\_var('max\_log\_size'); $save['snmp\_version'] = form\_input\_validate(get\_nfilter\_request\_var('snmp\_version'), 'snmp\_version', '^[1-3]$', false, 3); $save['snmp\_community'] = form\_input\_validate(get\_nfilter\_request\_var('snmp\_community'), 'snmp\_community', '', true, 3);
 if ($save['snmp\_version'] == 3) { $save['snmp\_username'] = form\_input\_validate(get\_nfilter\_request\_var('snmp\_username'), 'snmp\_username', '', true, 3); $save['snmp\_password'] = form\_input\_validate(get\_nfilter\_request\_var('snmp\_password'), 'snmp\_password', '', true, 3); $save['snmp\_auth\_protocol'] = form\_input\_validate(get\_nfilter\_request\_var('snmp\_auth\_protocol'), 'snmp\_auth\_protocol', "^\[None\]|MD5|SHA$", true, 3); $save['snmp\_priv\_passphrase'] = form\_input\_validate(get\_nfilter\_request\_var('snmp\_priv\_passphrase'), 'snmp\_priv\_passphrase', '', true, 3); $save['snmp\_priv\_protocol'] = form\_input\_validate(get\_nfilter\_request\_var('snmp\_priv\_protocol'), 'snmp\_priv\_protocol', "^\[None\]|DES|AES128$", true, 3); $save['snmp\_engine\_id'] = form\_input\_validate(get\_request\_var\_post('snmp\_engine\_id'), 'snmp\_engine\_id', '', false, 3); } else { $save['snmp\_username'] = ''; $save['snmp\_password'] = ''; $save['snmp\_auth\_protocol'] = ''; $save['snmp\_priv\_passphrase'] = ''; $save['snmp\_priv\_protocol'] = ''; $save['snmp\_engine\_id'] = ''; }
 $save['snmp\_port'] = form\_input\_validate(get\_nfilter\_request\_var('snmp\_port'), 'snmp\_port', '^[0-9]+$', false, 3); $save['snmp\_message\_type'] = form\_input\_validate(get\_nfilter\_request\_var('snmp\_message\_type'), 'snmp\_message\_type', '^[1-2]$', false, 3); $save['notes'] = form\_input\_validate(get\_nfilter\_request\_var('notes'), 'notes', '', true, 3);
 if ($save['snmp\_version'] == 3 && ($save['snmp\_password'] != get\_nfilter\_request\_var('snmp\_password\_confirm'))) { raise\_message(4); }
 if ($save['snmp\_version'] == 3 && ($save['snmp\_priv\_passphrase'] != get\_nfilter\_request\_var('snmp\_priv\_passphrase\_confirm'))) { raise\_message(4); }
 $manager\_id = 0;
 if (!is\_error\_message()) { $manager\_id = sql\_save($save, 'snmpagent\_managers'); raise\_message(($manager\_id)? 1 : 2); }
 break; }
 header('Location: managers.php?action=edit&id=' . (empty($manager\_id) ? get\_nfilter\_request\_var('id') : $manager\_id));}
function form\_actions() { global $actions, $mactions;
 if (isset\_request\_var('selected\_items')) { if (isset\_request\_var('action\_receivers')) { $selected\_items = cacti\_unserialize(stripslashes(get\_nfilter\_request\_var('selected\_graphs\_array')));
 if ($selected\_items != false) { if (get\_nfilter\_request\_var('drp\_action') == '1') { // delete db\_execute('DELETE FROM snmpagent\_managers WHERE id IN (' . implode(',' ,$selected\_items) . ')'); db\_execute('DELETE FROM snmpagent\_managers\_notifications WHERE manager\_id IN (' . implode(',' ,$selected\_items) . ')'); db\_execute('DELETE FROM snmpagent\_notifications\_log WHERE manager\_id IN (' . implode(',' ,$selected\_items) . ')'); } elseif (get\_nfilter\_request\_var('drp\_action') == '2') { // disable db\_execute("UPDATE snmpagent\_managers SET disabled = 'on' WHERE id IN (" . implode(',' ,$selected\_items) . ')'); } elseif (get\_nfilter\_request\_var('drp\_action') == '3') { // enable db\_execute("UPDATE snmpagent\_managers SET disabled = '' WHERE id IN (" . implode(',' ,$selected\_items) . ')'); }
 header('Location: managers.php');
 exit; } } elseif (isset\_request\_var('action\_receiver\_notifications')) { /\* ================= input validation ================= \*/ get\_filter\_request\_var('id'); /\* ==================================================== \*/
 $selected\_items = cacti\_unserialize(stripslashes(get\_nfilter\_request\_var('selected\_items')));
 if ($selected\_items !== false) { if (get\_nfilter\_request\_var('drp\_action') == '1') { // disable foreach ($selected\_items as $mib => $notifications) { foreach ($notifications as $notification => $state) { db\_execute\_prepared('DELETE FROM snmpagent\_managers\_notifications WHERE `manager\_id` = ? AND `mib` = ? AND `notification` = ? LIMIT 1', array(get\_nfilter\_request\_var('id'), $mib, $notification)); } } } elseif (get\_nfilter\_request\_var('drp\_action') == '2') { // enable foreach ($selected\_items as $mib => $notifications) { foreach ($notifications as $notification => $state) { db\_execute\_prepared('INSERT IGNORE INTO snmpagent\_managers\_notifications (`manager\_id`, `notification`, `mib`) VALUES (?, ?, ?)', array(get\_nfilter\_request\_var('id'), $notification, $mib)); } } } }
 header('Location: managers.php?action=edit&id=' . get\_nfilter\_request\_var('id') . '&tab=notifications');
 exit; } } elseif (isset\_request\_var('action\_receivers')) { $ilist = ''; $iarray = array();[View remainder of file in raw view](https://github.com/Cacti/cacti/raw/5f6f65c215d663a775950b2d9db35edbaf07d680/managers.php)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_cbcd178f_20250114_225530.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fsecurity%2Fadvisories%2FGHSA-w85f-7c4w-7594)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fsecurity%2Fadvisories%2FGHSA-w85f-7c4w-7594)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Cacti%2Fcacti)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Cacti](/Cacti)
/
**[cacti](/Cacti/cacti)**
Public

* [Notifications](/login?return_to=%2FCacti%2Fcacti) You must be signed in to change notification settings
* [Fork
  406](/login?return_to=%2FCacti%2Fcacti)
* [Star
   1.7k](/login?return_to=%2FCacti%2Fcacti)

* [Code](/Cacti/cacti)
* [Issues
  144](/Cacti/cacti/issues)
* [Pull requests
  1](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects
  0](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

Additional navigation options

* [Code](/Cacti/cacti)
* [Issues](/Cacti/cacti/issues)
* [Pull requests](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

# SQL Injection vulnerability when managing SNMP Notification Receivers

High

[netniV](/netniV)
published
GHSA-w85f-7c4w-7594
Dec 20, 2023

## Package

Cacti

## Affected versions

1.2.25

## Patched versions

None

## Description

### Summary

There is a Blind SQL Injection (SQLi) vulnerability within the SNMP Notification Receivers feature in the file `‘managers.php’`.

An authenticated attacker with the “Settings/Utilities” permission can send a crafted HTTP GET request to the endpoint `‘/cacti/managers.php’` with an SQLi payload in the `‘selected_graphs_array’` HTTP GET parameter.

### Details

The vulnerability occurs in the function `‘form_actions’` in the file `‘managers.php’`.

[![image](https://user-images.githubusercontent.com/54151096/269646672-baf3cbbe-3560-4c5c-984e-6d5f0fc8edfd.png)](https://user-images.githubusercontent.com/54151096/269646672-baf3cbbe-3560-4c5c-984e-6d5f0fc8edfd.png)

Passing the `‘selected_items’` and `‘action_receivers’` HTTP parameters (1. and 2.) allows access to the dangerous statement (3.), which performs deserialization of the provided value.

The function `‘get_nfilter_request_var’` performs no sanitization, as shown by the description of the function from a comment above its definition, it “returns the value of the request variable deferring any filtering”. Similarly, `‘stripslashes’` simply removes any backslashes from the input that are escaping quotes, and so also does not perform meaningful sanitization.

The `‘cacti_unserialize’` function makes use of the `‘allowed_classes’` argument to remove any vectors for [PHP Object Injection](https://owasp.org/www-community/vulnerabilities/PHP_Object_Injection), but does not otherwise perform any sanitization on the deserialized value.

[![image](https://user-images.githubusercontent.com/54151096/269647415-c276759e-9077-4bb2-bb47-ece0d62bcf23.png)](https://user-images.githubusercontent.com/54151096/269647415-c276759e-9077-4bb2-bb47-ece0d62bcf23.png)

Passing a value in the parameter `‘selected_graphs_array’` that will deserialize allows entering the subsequent conditional block. Passing a value of 1,2, or 3 in the parameter `‘drp_action’` (4.) allows entering a block in which raw SQL queries are constructed, and subsequently executed on the database via `‘db_execute’`. In each of these blocks SQLi is possible.

The array `‘$selected_items’` is imploded (joined) and then directly concatenated into the SQL query.

Therefore, to exploit this, an attacker could send a serialized array containing a string with a SQLi payload, which would be:

* deserialized to an in-memory array,
* joined into a single string,
* concatenated into a raw SQL query,
* executed on the database.

### PoC

The vulnerability may be triggered by signing into a low privilege account that has the “Settings/Utilities” permission and making an HTTP GET request to the endpoint `‘/cacti/managers.php’`. The screenshot below shows reproduction in BurpSuite.

Note that it is required there is at least 1 row in the affected tables for the injection to trigger. Testing data can be added through the user interface on the endpoint `‘/cacti/managers.php’`.

[![image](https://user-images.githubusercontent.com/54151096/269648806-c367609e-1b71-4d50-87f5-6d0970e4b721.png)](https://user-images.githubusercontent.com/54151096/269648806-c367609e-1b71-4d50-87f5-6d0970e4b721.png)

A PoC script that uses the injection to demonstrate a legitimate attack via this vector can be provided to the Cacti maintainers upon request.

### Impact

Using a time-based blind SQLi technique the attacker can disclose Cacti database contents, and depending on database configuration, may be able to achieve further impacts such as arbitrary file read, or even potentially remote code execution via arbitrary file write.

### Credit

Credit for discover goes to Synopsys CyRC researcher [Matthew Hogg](https://github.com/gg0h)

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

### CVE ID

CVE-2023-51448

### Weaknesses

[CWE-89](/advisories?query=cwe%3A89)

### Credits

* [![@bronallo-bd](https://avatars.githubusercontent.com/u/54151096?s=40&v=4)](/bronallo-bd)
  [bronallo-bd](/bronallo-bd)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


