Based on the provided information, here's an analysis of the vulnerability described:

**Root Cause of Vulnerability:**

- A race condition exists during Navidrome's startup sequence. The authentication module initializes before the module responsible for generating and persisting the random JWT secret key.
- As a result, the authentication module falls back to using a hardcoded secret key: "not so secret".
- This hardcoded secret is used to validate JWT tokens until the instance is restarted.
- An error that was meant to be logged when the fallback value is used does not get logged due to another bug, preventing the operator from becoming aware of the issue.

**Weaknesses/Vulnerabilities Present:**

- **Authentication Bypass:** The hardcoded JWT secret allows attackers to forge valid JWT tokens.
- **Race Condition:** Improper initialization order causes the fallback to the weak, hardcoded secret.
- **Lack of Error Logging:** A bug prevents the logging of the fallback to hardcoded secret, which would have indicated the vulnerability.
- **Use of Hardcoded Credential:** Using the hardcoded "not so secret" as a fallback allows for easy exploitation.

**Impact of Exploitation:**

- **Unauthorized Access:** Attackers can gain access to any existing user account by forging a JWT with the corresponding username in the `sub` claim.
- **Data Manipulation:** Attackers can create, delete, or modify user playlists, bookmarks, media annotations, shares, and radios.
- **Information Disclosure:** Attackers can retrieve user's email addresses (PII) through the `getUser` operation.
- **Denial of Service (Potential):** Attackers can use media retrieval operations, potentially affecting system availability.

**Attack Vectors:**

- **Network-based:** The vulnerability is exploitable over the network via the `/rest/` endpoint.

**Required Attacker Capabilities/Position:**

- **Network Access:** The attacker needs network access to the Navidrome instance.
- **Knowledge of Usernames:** The attacker needs to know valid usernames on the Navidrome instance to create corresponding JWTs.
- **Ability to Forge JWT:** The attacker needs the capability to generate a JWT signed with the hardcoded "not so secret" key.

**Additional Details:**

- The vulnerability is only exploitable on instances that haven't been restarted since the initial setup.
- Restarting Navidrome loads the persisted random key, preventing further exploitation of this vulnerability.
- The vulnerable component is the Subsonic endpoint, which is often left unprotected in typical deployments.
- The provided PoC demonstrates how to generate a valid JWT and use it to bypass authentication.

**CVSS Score:**

- CVSS v3.1 Score: 8.6 (High)
- Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H