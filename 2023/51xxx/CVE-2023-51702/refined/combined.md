=== Content from github.com_5a16d86b_20250115_090455.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fairflow%2Fpull%2F29498)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fairflow%2Fpull%2F29498)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=apache%2Fairflow)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apache](/apache)
/
**[airflow](/apache/airflow)**
Public

* [Notifications](/login?return_to=%2Fapache%2Fairflow) You must be signed in to change notification settings
* [Fork
  14.5k](/login?return_to=%2Fapache%2Fairflow)
* [Star
   38.3k](/login?return_to=%2Fapache%2Fairflow)

* [Code](/apache/airflow)
* [Issues
  1.1k](/apache/airflow/issues)
* [Pull requests
  136](/apache/airflow/pulls)
* [Discussions](/apache/airflow/discussions)
* [Actions](/apache/airflow/actions)
* [Projects
  16](/apache/airflow/projects)
* [Security](/apache/airflow/security)
* [Insights](/apache/airflow/pulse)

Additional navigation options

* [Code](/apache/airflow)
* [Issues](/apache/airflow/issues)
* [Pull requests](/apache/airflow/pulls)
* [Discussions](/apache/airflow/discussions)
* [Actions](/apache/airflow/actions)
* [Projects](/apache/airflow/projects)
* [Security](/apache/airflow/security)
* [Insights](/apache/airflow/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fapache%2Fairflow%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fapache%2Fairflow%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# add missing read for K8S config file from conn in deferred `KubernetesPodOperator` #29498

 Merged

[potiuk](/potiuk)
merged 7 commits into
[apache:main](/apache/airflow/tree/main "apache/airflow:main")
from
[hussein-awala:fix/deferrable\_k8s\_pod\_op](/hussein-awala/airflow/tree/fix/deferrable_k8s_pod_op "hussein-awala/airflow:fix/deferrable_k8s_pod_op")

Apr 22, 2023

 Merged

# [add missing read for K8S config file from conn in deferred `KubernetesPodOperator`](#top) #29498

[potiuk](/potiuk)
merged 7 commits into
[apache:main](/apache/airflow/tree/main "apache/airflow:main")
from
[hussein-awala:fix/deferrable\_k8s\_pod\_op](/hussein-awala/airflow/tree/fix/deferrable_k8s_pod_op "hussein-awala/airflow:fix/deferrable_k8s_pod_op")

Apr 22, 2023

[Conversation
19](/apache/airflow/pull/29498)
[Commits
7](/apache/airflow/pull/29498/commits)
[Checks
0](/apache/airflow/pull/29498/checks)
[Files changed](/apache/airflow/pull/29498/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=60&v=4)](/hussein-awala)

Copy link

Member

### @hussein-awala **[hussein-awala](/hussein-awala)** commented [Feb 12, 2023](#issue-1581429235)

closes: [#29488](https://github.com/apache/airflow/issues/29488)

---

The async execute method of `KubernetesPodOperator` doesn't check if the `config_path` is provided in the connection extra, this PR fixes this by extracting the config path in order to read it and convert it to dictionary.

Sorry, something went wrong.

All reactions

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[add missing read for conf file from connection](/apache/airflow/pull/29498/commits/72a191338e199e0005c98dc97cca94f6a9d57181 "add missing read for conf file from connection")`

`[72a1913](/apache/airflow/pull/29498/commits/72a191338e199e0005c98dc97cca94f6a9d57181)`

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
requested a review
from [jedcunningham](/jedcunningham)
as a [code owner](/apache/airflow/blob/ca7161b2ecab8e7851a823ab22354934caf89bfd/.github/CODEOWNERS#L63)
[February 12, 2023 22:15](#event-8499103312)

[![@boring-cyborg](https://avatars.githubusercontent.com/in/50386?s=40&v=4)](/apps/boring-cyborg)
[boring-cyborg](/apps/boring-cyborg)
bot
added
[provider:cncf-kubernetes](/apache/airflow/labels/provider%3Acncf-kubernetes)
Kubernetes provider related issues
[area:providers](/apache/airflow/labels/area%3Aproviders)
labels
[Feb 12, 2023](#event-8499103373)

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[add a test for the different methods to provide the config file path](/apache/airflow/pull/29498/commits/8ffa8eb71b63dde28ebdc631acf6e78a7a9a80c9 "add a test for the different methods to provide the config file path")`

`[8ffa8eb](/apache/airflow/pull/29498/commits/8ffa8eb71b63dde28ebdc631acf6e78a7a9a80c9)`

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
changed the title
~~[WIP] add missing read for K8S config file from conn in deferred `KubernetesPodOperator`~~
add missing read for K8S config file from conn in deferred `KubernetesPodOperator`
[Feb 13, 2023](#event-8499262652)

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[change loading order to config_file, connection then env var](/apache/airflow/pull/29498/commits/8f40fbb5bc4f91f35302a01cd39fd9214248acf1 "change loading order to config_file, connection then env var")`

`[8f40fbb](/apache/airflow/pull/29498/commits/8f40fbb5bc4f91f35302a01cd39fd9214248acf1)`

[![raphaelauv](https://avatars.githubusercontent.com/u/10202690?s=60&v=4)](/raphaelauv)

**[raphaelauv](/raphaelauv)**
reviewed
[Feb 13, 2023](#pullrequestreview-1295814225)

 [View reviewed changes](/apache/airflow/pull/29498/files/8f40fbb5bc4f91f35302a01cd39fd9214248acf1)

[airflow/providers/cncf/kubernetes/operators/kubernetes\_pod.py](/apache/airflow/pull/29498/files/8f40fbb5bc4f91f35302a01cd39fd9214248acf1#diff-947f9f98b4aedccee6dd81558568c350c738f5da050aad1224d8b48ec43677cd)
Outdated

|  |  | @@ -565,7 +565,16 @@ def execute\_async(self, context: Context): | |
| --- | --- | --- | --- |
|  |  |  |
|  |  | def convert\_config\_file\_to\_dict(self): |
|  |  | """Converts passed config\_file to dict format.""" |
|  |  | config\_file = self.config\_file if self.config\_file else os.environ.get(KUBE\_CONFIG\_ENV\_VAR) |
|  |  | config\_file = None |

Copy link

Contributor

### @raphaelauv **[raphaelauv](/raphaelauv)** [Feb 13, 2023](#discussion_r1104585339)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

thanks [@hussein-awala](https://github.com/hussein-awala) for proposing this fix.

why the async need the function `convert_config_file_to_dict`and not the sync ?

Look like the async was implemented not fully following this pattern -> [#20578](https://github.com/apache/airflow/pull/20578)

your PR fix the problems for the extra `config_path` , there is a risk that another is missing or new in the future would need "manual" fix like this

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @hussein-awala **[hussein-awala](/hussein-awala)** [Feb 14, 2023](#discussion_r1105145411)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I am not sure about the initial reason to convert the file into dictionary before creating the trigger, it may be to avoid copying the config file to the triggerer, where the pod is created on the worker using the sync hook and the waiting task is running on the triggerer and it uses the async hook.

> here is a risk that another is missing or new in the future would need "manual" fix like this

With this fix, we cover all options currently available to provide the configuration file, and yes, if we add a new one in the future, we must add it on the sync hook and in this method.

[@VladaZakharova](https://github.com/VladaZakharova) can you please explain what was the motivation to convert the config file to a dictionary before creating the trigger?

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @VladaZakharova **[VladaZakharova](/VladaZakharova)** [Feb 14, 2023](#discussion_r1105742245) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Hi Team!

This was implemented to that config file was converted to dict to be passed to trigger and then hook to establish connection.

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @raphaelauv **[raphaelauv](/raphaelauv)** [Feb 14, 2023](#discussion_r1105921373)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

what do you mean by `lighten the credential management` ?

the hook is not re instantiate at every run of the trigger ?

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @VladaZakharova **[VladaZakharova](/VladaZakharova)** [Feb 14, 2023](#discussion_r1106341027)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

We needed a way to pass config file to the trigger to create a client for kubernetes, but using file system to communicate with trigger was not a good solution. So then we added a possibility to pass all config file parameters as a dict.

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @hussein-awala **[hussein-awala](/hussein-awala)** [Feb 14, 2023](#discussion_r1106458479)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

To respect the pattern mentioned by [@raphaelauv](https://github.com/raphaelauv), I will try loading the config file in the async hook, this should work where the triggerer is initiated once.

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @bjankie1 **[bjankie1](/bjankie1)** [Feb 24, 2023](#discussion_r1116981921)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Please mind that all FS operations are blocking side effects. It's violating asyncio contract and can cause additional error logs informing about blocking code.

Sorry, something went wrong.

All reactions

 [![@potiuk](https://avatars.githubusercontent.com/u/595491?s=40&v=4)](/potiuk)
[potiuk](/potiuk)
requested a review
from [dstandish](/dstandish)
[February 20, 2023 09:32](#event-8559420780)

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Feb 20, 2023](#issuecomment-1436627597)

| [@hussein-awala](https://github.com/hussein-awala) I guess you will be still changing the config access pattern on that one ? Do I understand correctly? |
| --- |

All reactions

Sorry, something went wrong.

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=80&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)

Copy link

Member

Author

### **[hussein-awala](/hussein-awala)** commented [Feb 20, 2023](#issuecomment-1436659985)

| I guess you will be still changing the config access pattern on that one ? Do I understand correctly?  Yes, I'm testing loading the config file in the triggerer instead of loading it in the worker and pass it as a dict.  I convert the PR to draft until I finish testing |
| --- |

All reactions

Sorry, something went wrong.

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
marked this pull request as draft
[February 20, 2023 09:56](#event-8559654131)

[![@VladaZakharova](https://avatars.githubusercontent.com/u/80038284?s=80&u=415a931a4183490d453877063371b24e7cd3b7db&v=4)](/VladaZakharova)

Copy link

Contributor

### **[VladaZakharova](/VladaZakharova)** commented [Feb 20, 2023](#issuecomment-1436702119) • edited Loading

| Hi! May i ask in which format you will pass the config file to trigger? So it will be just a file passed as a parameter to trigger? Or how? |
| --- |

All reactions

Sorry, something went wrong.

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[load the config file in the triggerer instead of loading it in the wo…](/apache/airflow/pull/29498/commits/e7b0e39557602ae215cc8722a97ec6b43df1c3ab "load the config file in the triggerer instead of loading it in the worker and pass it as a dict")`
 …

`[e7b0e39](/apache/airflow/pull/29498/commits/e7b0e39557602ae215cc8722a97ec6b43df1c3ab)`

```
…rker and pass it as a dict
```

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=80&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)

Copy link

Member

Author

### **[hussein-awala](/hussein-awala)** commented [Feb 21, 2023](#issuecomment-1437703231)

| Hi! May i ask in which format you will pass the config file to trigger? So it will be just a file passed as a parameter to trigger? Or how?  [@VladaZakharova](https://github.com/VladaZakharova) - Yes, I pass the file path and let the triggerer loads it. Can you check my last commit?  BTW, I am not sure if loading the config file from the env var `KUBECONFIG` is a good idea or not, because it's difficult to decide when we need to load it and when we don't. |
| --- |

All reactions

Sorry, something went wrong.

[![@raphaelauv](https://avatars.githubusercontent.com/u/10202690?s=80&u=e6f86f5c0c3026a15d6b51792fa3e532b12f1371&v=4)](/raphaelauv)

Copy link

Contributor

### **[raphaelauv](/raphaelauv)** commented [Feb 21, 2023](#issuecomment-1438040543)

| Loading the config file from the env KUBECONFIG is deprecated in latest provider version |
| --- |

All reactions

Sorry, something went wrong.

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[fix deferrable mode tests](/apache/airflow/pull/29498/commits/a007a76373b19faa7da00e026239fa5966bbb7e3 "fix deferrable mode tests")`

`[a007a76](/apache/airflow/pull/29498/commits/a007a76373b19faa7da00e026239fa5966bbb7e3)`

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
marked this pull request as ready for review
[February 22, 2023 00:55](#event-8576139669)

[![raphaelauv](https://avatars.githubusercontent.com/u/10202690?s=60&v=4)](/raphaelauv)

**[raphaelauv](/raphaelauv)**
approved these changes
[Feb 23, 2023](#pullrequestreview-1312119036)

 [View reviewed changes](/apache/airflow/pull/29498/files)

Copy link

Contributor

### @raphaelauv **[raphaelauv](/raphaelauv)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM

Sorry, something went wrong.

All reactions

[![@raphaelauv](https://avatars.githubusercontent.com/u/10202690?s=40&u=e6f86f5c0c3026a15d6b51792fa3e532b12f1371&v=4)](/raphaelauv)
[raphaelauv](/raphaelauv)
mentioned this pull request
[Mar 14, 2023](#ref-issue-1623412479)

[KPO (async) log full config\_dict in triggerer
#30097](/apache/airflow/issues/30097)

Closed

2 tasks

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [Apr 11, 2023](#issuecomment-1502498247)

| This pull request has been automatically marked as stale because it has not had recent activity. It will be closed in 5 days if no further activity occurs. Thank you for your contributions. |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[stale](/apache/airflow/labels/stale)
Stale PRs per the .github/workflows/stale.yml policy file
label
[Apr 11, 2023](#event-8968150065)

[![@raphaelauv](https://avatars.githubusercontent.com/u/10202690?s=80&u=e6f86f5c0c3026a15d6b51792fa3e532b12f1371&v=4)](/raphaelauv)

Copy link

Contributor

### **[raphaelauv](/raphaelauv)** commented [Apr 13, 2023](#issuecomment-1506630940)

| [@hussein-awala](https://github.com/hussein-awala) the PR have conflicts , could you rebase on main , thank you 👍 |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
removed
the
[stale](/apache/airflow/labels/stale)
Stale PRs per the .github/workflows/stale.yml policy file
label
[Apr 14, 2023](#event-9002276005)

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
[force-pushed](/apache/airflow/compare/839b3c126e5ed7768187ad07d29a1ef6b9784ce3..59d76b8ad71c5babcd1ffe02804b1705b4ce0c39)
the
fix/deferrable\_k8s\_pod\_op

branch
4 times, most recently
from
[`839b3c1`](/apache/airflow/commit/839b3c126e5ed7768187ad07d29a1ef6b9784ce3) to
[`59d76b8`](/apache/airflow/commit/59d76b8ad71c5babcd1ffe02804b1705b4ce0c39)  [Compare](/apache/airflow/compare/839b3c126e5ed7768187ad07d29a1ef6b9784ce3..59d76b8ad71c5babcd1ffe02804b1705b4ce0c39)
[April 14, 2023 23:40](#event-9012332956)

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[Merge branch 'main' into fix/deferrable_k8s_pod_op](/apache/airflow/pull/29498/commits/24885c668dc952d6bc5bdb5fefefd88429871258 "Merge branch 'main' into fix/deferrable_k8s_pod_op")`

`[24885c6](/apache/airflow/pull/29498/commits/24885c668dc952d6bc5bdb5fefefd88429871258)`

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
[force-pushed](/apache/airflow/compare/59d76b8ad71c5babcd1ffe02804b1705b4ce0c39..24885c668dc952d6bc5bdb5fefefd88429871258)
the
fix/deferrable\_k8s\_pod\_op

branch
from
[`59d76b8`](/apache/airflow/commit/59d76b8ad71c5babcd1ffe02804b1705b4ce0c39) to
[`24885c6`](/apache/airflow/commit/24885c668dc952d6bc5bdb5fefefd88429871258)  [Compare](/apache/airflow/compare/59d76b8ad71c5babcd1ffe02804b1705b4ce0c39..24885c668dc952d6bc5bdb5fefefd88429871258)
[April 15, 2023 00:28](#event-9012446084)

[![eladkal](https://avatars.githubusercontent.com/u/45845474?s=60&v=4)](/eladkal)

**[eladkal](/eladkal)**
reviewed
[Apr 15, 2023](#pullrequestreview-1386449461)

 [View reviewed changes](/apache/airflow/pull/29498/files/24885c668dc952d6bc5bdb5fefefd88429871258)

[airflow/providers/cncf/kubernetes/operators/pod.py](/apache/airflow/pull/29498/files/24885c668dc952d6bc5bdb5fefefd88429871258#diff-93707635f12195e7b94d14cf99675542592a28a6eb552895fb3ff37d42713740)
Outdated

Comment on lines
566
 to
573

|  |  | def convert\_config\_file\_to\_dict(self): |
| --- | --- | --- |
|  |  | """Converts passed config\_file to dict format.""" |
|  |  | config\_file = self.config\_file if self.config\_file else os.environ.get(KUBE\_CONFIG\_ENV\_VAR) |
|  |  | if config\_file: |
|  |  | with open(config\_file) as f: |
|  |  | self.\_config\_dict = yaml.safe\_load(f) |
|  |  | else: |
|  |  | self.\_config\_dict = None |

Copy link

Contributor

### @eladkal **[eladkal](/eladkal)** [Apr 15, 2023](#discussion_r1167490656)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

is removing this function considered a breaking change?

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @hussein-awala **[hussein-awala](/hussein-awala)** [Apr 15, 2023](#discussion_r1167555764)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

In my opinion, this method is used as a private method since it only updates some attributes in the class instances without returning any value. However, it's possible that someone could extend the operator class and use it. Should we deprecate it and remove it in the next major release, or should we add a breaking change note?

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @eladkal **[eladkal](/eladkal)** [Apr 15, 2023](#discussion_r1167624973)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

So lets deprecate first. Just to be on the safe side.

Sorry, something went wrong.

All reactions

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
mentioned this pull request
[Apr 15, 2023](#ref-pullrequest-1629966757)

[Add provider for Apache Kafka
#30175](/apache/airflow/pull/30175)
 Merged

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
[force-pushed](/apache/airflow/compare/bdef8215a6d86e2d4975a2bebb43834c19f5b591..1a87f6e84d1953ad69f07490cec7d65378fc9c8b)
the
fix/deferrable\_k8s\_pod\_op

branch
from
[`bdef821`](/apache/airflow/commit/bdef8215a6d86e2d4975a2bebb43834c19f5b591) to
[`1a87f6e`](/apache/airflow/commit/1a87f6e84d1953ad69f07490cec7d65378fc9c8b)  [Compare](/apache/airflow/compare/bdef8215a6d86e2d4975a2bebb43834c19f5b591..1a87f6e84d1953ad69f07490cec7d65378fc9c8b)
[April 18, 2023 00:04](#event-9030098681)

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[restore convert_config_file_to_dict method and deprecate it](/apache/airflow/pull/29498/commits/5bc37f212a81f88a8ad48ca4a98f8927d6d6f2ef "restore convert_config_file_to_dict method and deprecate it")`

`[5bc37f2](/apache/airflow/pull/29498/commits/5bc37f212a81f88a8ad48ca4a98f8927d6d6f2ef)`

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
[force-pushed](/apache/airflow/compare/1a87f6e84d1953ad69f07490cec7d65378fc9c8b..5bc37f212a81f88a8ad48ca4a98f8927d6d6f2ef)
the
fix/deferrable\_k8s\_pod\_op

branch
from
[`1a87f6e`](/apache/airflow/commit/1a87f6e84d1953ad69f07490cec7d65378fc9c8b) to
[`5bc37f2`](/apache/airflow/commit/5bc37f212a81f88a8ad48ca4a98f8927d6d6f2ef)  [Compare](/apache/airflow/compare/1a87f6e84d1953ad69f07490cec7d65378fc9c8b..5bc37f212a81f88a8ad48ca4a98f8927d6d6f2ef)
[April 18, 2023 00:07](#event-9030115813)

[![potiuk](https://avatars.githubusercontent.com/u/595491?s=60&v=4)](/potiuk)

**[potiuk](/potiuk)**
approved these changes
[Apr 22, 2023](#pullrequestreview-1396762709)

 [View reviewed changes](/apache/airflow/pull/29498/files/5bc37f212a81f88a8ad48ca4a98f8927d6d6f2ef)

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Apr 22, 2023](#issuecomment-1518711435)

| LGTM. [@eladkal](https://github.com/eladkal) ? |
| --- |

All reactions

Sorry, something went wrong.

[![eladkal](https://avatars.githubusercontent.com/u/45845474?s=60&v=4)](/eladkal)

**[eladkal](/eladkal)**
approved these changes
[Apr 22, 2023](#pullrequestreview-1396762935)

 [View reviewed changes](/apache/airflow/pull/29498/files/5bc37f212a81f88a8ad48ca4a98f8927d6d6f2ef)

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=40&v=4)](/potiuk)
[potiuk](/potiuk)
merged commit [`b5296b7`](/apache/airflow/commit/b5296b74361bfe2449033eca5f732c4a4377f6bb)
into
apache:main

[Apr 22, 2023](https://github.com/apache/airflow/pull/29498#event-9073411819)

[![@eladkal](https://avatars.githubusercontent.com/u/45845474?s=40&v=4)](/eladkal)
[eladkal](/eladkal)
mentioned this pull request
[May 16, 2023](#ref-issue-1712379712)

[Status of testing Providers that were prepared on May 19, 2023
#31322](/apache/airflow/issues/31322)

Closed

80 tasks

[![@bjankie1](https://avatars.githubusercontent.com/u/1985820?s=40&v=4)](/bjankie1)
[bjankie1](/bjankie1)
mentioned this pull request
[Dec 29, 2023](#ref-issue-1915046446)

[Invalid kube-config file. Expected key current-context in kube-config when using deferrable=True
#34644](/apache/airflow/issues/34644)

Closed

2 tasks

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Jan 24, 2024](#ref-issue-2098334467)

[x/vulndb: potential Go vuln in github.com/apache/airflow: CVE-2023-51702
golang/vulndb#2475](/golang/vulndb/issues/2475)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fairflow%2Fpull%2F29498)

Reviewers

[![@VladaZakharova](https://avatars.githubusercontent.com/u/80038284?s=40&v=4)](/VladaZakharova) [VladaZakharova](/VladaZakharova)

VladaZakharova left review comments

[![@bjankie1](https://avatars.githubusercontent.com/u/1985820?s=40&v=4)](/bjankie1) [bjankie1](/bjankie1)

bjankie1 left review comments

[![@eladkal](https://avatars.githubusercontent.com/u/45845474?s=40&v=4)](/eladkal) [eladkal](/eladkal)

eladkal approved these changes

[![@raphaelauv](https://avatars.githubusercontent.com/u/10202690?s=40&v=4)](/raphaelauv) [raphaelauv](/raphaelauv)

raphaelauv approved these changes

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=40&v=4)](/potiuk) [potiuk](/potiuk)

potiuk approved these changes

[![@jedcunningham](https://avatars.githubusercontent.com/u/66968678?s=40&v=4)](/jedcunningham) [jedcunningham](/jedcunningham)

 Awaiting requested review from jedcunningham

[![@dstandish](https://avatars.githubusercontent.com/u/15932138?s=40&v=4)](/dstandish) [dstandish](/dstandish)

 Awaiting requested review from dstandish

Assignees

No one assigned

Labels

[area:providers](/apache/airflow/labels/area%3Aproviders)
[provider:cncf-kubernetes](/apache/airflow/labels/provider%3Acncf-kubernetes)
Kubernetes provider related issues

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [KPO - deferrable - Invalid kube-config file. Expected key contexts in kube-config](https://github.com/apache/airflow/issues/29488)

6 participants

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=52&v=4)](/hussein-awala) [![@potiuk](https://avatars.githubusercontent.com/u/595491?s=52&v=4)](/potiuk) [![@VladaZakharova](https://avatars.githubusercontent.com/u/80038284?s=52&v=4)](/VladaZakharova) [![@raphaelauv](https://avatars.githubusercontent.com/u/10202690?s=52&v=4)](/raphaelauv) [![@bjankie1](https://avatars.githubusercontent.com/u/1985820?s=52&v=4)](/bjankie1) [![@eladkal](https://avatars.githubusercontent.com/u/45845474?s=52&v=4)](/eladkal)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_4c329c22_20250115_090457.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fairflow%2Fpull%2F30110)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fairflow%2Fpull%2F30110)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=apache%2Fairflow)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apache](/apache)
/
**[airflow](/apache/airflow)**
Public

* [Notifications](/login?return_to=%2Fapache%2Fairflow) You must be signed in to change notification settings
* [Fork
  14.5k](/login?return_to=%2Fapache%2Fairflow)
* [Star
   38.3k](/login?return_to=%2Fapache%2Fairflow)

* [Code](/apache/airflow)
* [Issues
  1.1k](/apache/airflow/issues)
* [Pull requests
  136](/apache/airflow/pulls)
* [Discussions](/apache/airflow/discussions)
* [Actions](/apache/airflow/actions)
* [Projects
  16](/apache/airflow/projects)
* [Security](/apache/airflow/security)
* [Insights](/apache/airflow/pulse)

Additional navigation options

* [Code](/apache/airflow)
* [Issues](/apache/airflow/issues)
* [Pull requests](/apache/airflow/pulls)
* [Discussions](/apache/airflow/discussions)
* [Actions](/apache/airflow/actions)
* [Projects](/apache/airflow/projects)
* [Security](/apache/airflow/security)
* [Insights](/apache/airflow/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fapache%2Fairflow%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fapache%2Fairflow%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Avoid logging sensitive information in triggerer job log #30110

 Merged

[potiuk](/potiuk)
merged 8 commits into
[apache:main](/apache/airflow/tree/main "apache/airflow:main")
from
[hussein-awala:fix/triggerer\_log](/hussein-awala/airflow/tree/fix/triggerer_log "hussein-awala/airflow:fix/triggerer_log")

Apr 6, 2023

 Merged

# [Avoid logging sensitive information in triggerer job log](#top) #30110

[potiuk](/potiuk)
merged 8 commits into
[apache:main](/apache/airflow/tree/main "apache/airflow:main")
from
[hussein-awala:fix/triggerer\_log](/hussein-awala/airflow/tree/fix/triggerer_log "hussein-awala/airflow:fix/triggerer_log")

Apr 6, 2023

[Conversation
7](/apache/airflow/pull/30110)
[Commits
8](/apache/airflow/pull/30110/commits)
[Checks
0](/apache/airflow/pull/30110/checks)
[Files changed](/apache/airflow/pull/30110/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=60&v=4)](/hussein-awala)

Copy link

Member

### @hussein-awala **[hussein-awala](/hussein-awala)** commented [Mar 15, 2023](#issue-1624494840)

closes: [#30097](https://github.com/apache/airflow/issues/30097)

---

The triggerer job [logs the trigger name](https://github.com/apache/airflow/blob/main/airflow/jobs/triggerer_job.py#L592-L593), which is [repr(trigger\_instance)](https://github.com/apache/airflow/blob/main/airflow/jobs/triggerer_job.py#L488), so it logs all the fields in the `trigger_instance` even if they contain sensitive. We have some different options to fix this:

* use [redact](https://github.com/apache/airflow/blob/main/airflow/utils/log/secrets_masker.py#L111-L111) in `__repr__` method -> difficult to detect all the sensitive information
* add a new attribute to hide some fields -> it can work, but we need to identify all the sensitive fields in each new trigger
* simply change the trigger name -> IMHO it's the best solution, also the trigger name should be significant and related to the task instance

Sorry, something went wrong.

All reactions

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[Change trigger name to task id instead of repr(trigger) to avoid logg…](/apache/airflow/pull/30110/commits/70816131576c081788abb90f7d3146b423af27cc "Change trigger name to task id instead of repr(trigger) to avoid logging sensitive information")`
 …

`[7081613](/apache/airflow/pull/30110/commits/70816131576c081788abb90f7d3146b423af27cc)`

```
…ing sensitive information
```

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
requested a review
from [dstandish](/dstandish)
as a [code owner](/apache/airflow/blob/63d92664927647b29d586db2fc9adcfafddc473d/.github/CODEOWNERS#L53)
[March 15, 2023 00:14](#event-8749621691)

[![@boring-cyborg](https://avatars.githubusercontent.com/in/50386?s=40&v=4)](/apps/boring-cyborg)
[boring-cyborg](/apps/boring-cyborg)
bot
added
the
[area:Scheduler](/apache/airflow/labels/area%3AScheduler)
including HA (high availability) scheduler
label
[Mar 15, 2023](#event-8749621824)

[![uranusjr](https://avatars.githubusercontent.com/u/605277?s=60&v=4)](/uranusjr)

**[uranusjr](/uranusjr)**
reviewed
[Mar 15, 2023](#pullrequestreview-1340602832)

 [View reviewed changes](/apache/airflow/pull/30110/files/70816131576c081788abb90f7d3146b423af27cc)

[airflow/jobs/triggerer\_job.py](/apache/airflow/pull/30110/files/70816131576c081788abb90f7d3146b423af27cc#diff-a5a8f5ab18cc034fa7a64181443415a1cd86aca1ce43a3aaa39e73262941118b)
Outdated

Show resolved

Hide resolved

 [hussein-awala](/hussein-awala)
added 2 commits
[March 20, 2023 19:59](#commits-pushed-82cb293)

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[replace execution_date by run_id](/apache/airflow/pull/30110/commits/82cb293c7b11a254129b2db8c1ce90e91449fd46 "replace execution_date by run_id")`

`[82cb293](/apache/airflow/pull/30110/commits/82cb293c7b11a254129b2db8c1ce90e91449fd46)`

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[fix unit tests](/apache/airflow/pull/30110/commits/ccdd599f8611d3a2634f542b7b3ff604c31ad824 "fix unit tests")`

`[ccdd599](/apache/airflow/pull/30110/commits/ccdd599f8611d3a2634f542b7b3ff604c31ad824)`

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
requested a review
from [uranusjr](/uranusjr)
[March 20, 2023 22:57](#event-8799953024)

[![o-nikolas](https://avatars.githubusercontent.com/u/65743084?s=60&v=4)](/o-nikolas)

**[o-nikolas](/o-nikolas)**
reviewed
[Mar 21, 2023](#pullrequestreview-1349731674)

 [View reviewed changes](/apache/airflow/pull/30110/files/ccdd599f8611d3a2634f542b7b3ff604c31ad824)

[tests/jobs/test\_triggerer\_job.py](/apache/airflow/pull/30110/files/ccdd599f8611d3a2634f542b7b3ff604c31ad824#diff-02359b2cc957e3a9be05ce055322558b36359c13572afc38f14f62a6dfae01c3)
Outdated

Show resolved

Hide resolved

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[add test for sensitive info in log](/apache/airflow/pull/30110/commits/99254540dfb3891d6bbe63ceba5be81aa64b19b1 "add test for sensitive info in log")`

`[9925454](/apache/airflow/pull/30110/commits/99254540dfb3891d6bbe63ceba5be81aa64b19b1)`

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
requested a review
from [o-nikolas](/o-nikolas)
[April 1, 2023 21:36](#event-8905026084)

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[Merge branch 'main' into fix/triggerer_log](/apache/airflow/pull/30110/commits/ddedb1df6603e4c9974d6a2da527a28046b8cc10 "Merge branch 'main' into fix/triggerer_log")`

`[ddedb1d](/apache/airflow/pull/30110/commits/ddedb1df6603e4c9974d6a2da527a28046b8cc10)`

[![o-nikolas](https://avatars.githubusercontent.com/u/65743084?s=60&v=4)](/o-nikolas)

**[o-nikolas](/o-nikolas)**
approved these changes
[Apr 2, 2023](#pullrequestreview-1368006430)

 [View reviewed changes](/apache/airflow/pull/30110/files/ddedb1df6603e4c9974d6a2da527a28046b8cc10)

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[Merge branch 'main' into fix/triggerer_log](/apache/airflow/pull/30110/commits/d243ae9f4fc3d967f76f82f29b49a5c7f3bb5844 "Merge branch 'main' into fix/triggerer_log")`

`[d243ae9](/apache/airflow/pull/30110/commits/d243ae9f4fc3d967f76f82f29b49a5c7f3bb5844)`

[![uranusjr](https://avatars.githubusercontent.com/u/605277?s=60&v=4)](/uranusjr)

**[uranusjr](/uranusjr)**
reviewed
[Apr 3, 2023](#pullrequestreview-1368903331)

 [View reviewed changes](/apache/airflow/pull/30110/files/d243ae9f4fc3d967f76f82f29b49a5c7f3bb5844)

[airflow/jobs/triggerer\_job.py](/apache/airflow/pull/30110/files/d243ae9f4fc3d967f76f82f29b49a5c7f3bb5844#diff-a5a8f5ab18cc034fa7a64181443415a1cd86aca1ce43a3aaa39e73262941118b)
Outdated

Show resolved

Hide resolved

 [hussein-awala](/hussein-awala)
added 2 commits
[April 6, 2023 00:01](#commits-pushed-caed3a7)

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[Add try_number to trigger key](/apache/airflow/pull/30110/commits/caed3a732c4979e6897dc1d7043521ba78b84ec1 "Add try_number to trigger key")`

`[caed3a7](/apache/airflow/pull/30110/commits/caed3a732c4979e6897dc1d7043521ba78b84ec1)`

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[Merge branch 'main' into fix/triggerer_log](/apache/airflow/pull/30110/commits/cfedc0d8ceefa0d2e6a6d2c23bc57208ff24822d "Merge branch 'main' into fix/triggerer_log")`

`[cfedc0d](/apache/airflow/pull/30110/commits/cfedc0d8ceefa0d2e6a6d2c23bc57208ff24822d)`

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
requested a review
from [uranusjr](/uranusjr)
[April 5, 2023 22:03](#event-8939814915)

[![uranusjr](https://avatars.githubusercontent.com/u/605277?s=60&v=4)](/uranusjr)

**[uranusjr](/uranusjr)**
approved these changes
[Apr 6, 2023](#pullrequestreview-1374158028)

 [View reviewed changes](/apache/airflow/pull/30110/files/cfedc0d8ceefa0d2e6a6d2c23bc57208ff24822d)

[![potiuk](https://avatars.githubusercontent.com/u/595491?s=60&v=4)](/potiuk)

**[potiuk](/potiuk)**
approved these changes
[Apr 6, 2023](#pullrequestreview-1374714214)

 [View reviewed changes](/apache/airflow/pull/30110/files/cfedc0d8ceefa0d2e6a6d2c23bc57208ff24822d)

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Apr 6, 2023](#issuecomment-1498949737)

| Nice one. |
| --- |

All reactions

Sorry, something went wrong.

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=40&v=4)](/potiuk)
[potiuk](/potiuk)
merged commit [`274d9c3`](/apache/airflow/commit/274d9c3508179ae8b0f705d9787e8200be7718e1)
into
apache:main

[Apr 6, 2023](https://github.com/apache/airflow/pull/30110#event-8945192604)

[![@eladkal](https://avatars.githubusercontent.com/u/45845474?s=40&u=c4049156fea2df31eebe693f545edadb7acc84e0&v=4)](/eladkal)
[eladkal](/eladkal)
added this to the [Airflow 2.5.4](/apache/airflow/milestone/71) milestone
[Apr 7, 2023](#event-8951257232)

[![@eladkal](https://avatars.githubusercontent.com/u/45845474?s=40&u=c4049156fea2df31eebe693f545edadb7acc84e0&v=4)](/eladkal)
[eladkal](/eladkal)
added
the
[type:bug-fix](/apache/airflow/labels/type%3Abug-fix)
Changelog: Bug Fixes
label
[Apr 7, 2023](#event-8951257551)

[![@ephraimbuddy](https://avatars.githubusercontent.com/u/4122866?s=40&u=cdf7ca9a551a310373f575749c4b159602900c9a&v=4)](/ephraimbuddy)
[ephraimbuddy](/ephraimbuddy)
modified the milestones:
[Airflow 2.5.4](/apache/airflow/milestone/71),
[Airflow 2.6.0](/apache/airflow/milestone/67)
[Apr 13, 2023](#event-8999214273)

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Jan 24, 2024](#ref-issue-2098334467)

[x/vulndb: potential Go vuln in github.com/apache/airflow: CVE-2023-51702
golang/vulndb#2475](/golang/vulndb/issues/2475)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fairflow%2Fpull%2F30110)

Reviewers

[![@o-nikolas](https://avatars.githubusercontent.com/u/65743084?s=40&v=4)](/o-nikolas) [o-nikolas](/o-nikolas)

o-nikolas approved these changes

[![@uranusjr](https://avatars.githubusercontent.com/u/605277?s=40&v=4)](/uranusjr) [uranusjr](/uranusjr)

uranusjr approved these changes

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=40&v=4)](/potiuk) [potiuk](/potiuk)

potiuk approved these changes

[![@dstandish](https://avatars.githubusercontent.com/u/15932138?s=40&v=4)](/dstandish) [dstandish](/dstandish)

 Awaiting requested review from dstandish

 dstandish is a code owner

Assignees

No one assigned

Labels

[area:Scheduler](/apache/airflow/labels/area%3AScheduler)
including HA (high availability) scheduler
[type:bug-fix](/apache/airflow/labels/type%3Abug-fix)
Changelog: Bug Fixes

Projects

None yet

Milestone

 [**Airflow 2.6.0**](/apache/airflow/milestone/67 "Airflow 2.6.0")

Development

Successfully merging this pull request may close these issues.

 [KPO (async) log full config\_dict in triggerer](https://github.com/apache/airflow/issues/30097)

6 participants

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=52&v=4)](/hussein-awala) [![@potiuk](https://avatars.githubusercontent.com/u/595491?s=52&v=4)](/potiuk) [![@uranusjr](https://avatars.githubusercontent.com/u/605277?s=52&v=4)](/uranusjr) [![@o-nikolas](https://avatars.githubusercontent.com/u/65743084?s=52&v=4)](/o-nikolas) [![@ephraimbuddy](https://avatars.githubusercontent.com/u/4122866?s=52&v=4)](/ephraimbuddy) [![@eladkal](https://avatars.githubusercontent.com/u/45845474?s=52&v=4)](/eladkal)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_15ca0945_20250115_090500.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fairflow%2Fpull%2F36492)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fairflow%2Fpull%2F36492)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=apache%2Fairflow)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apache](/apache)
/
**[airflow](/apache/airflow)**
Public

* [Notifications](/login?return_to=%2Fapache%2Fairflow) You must be signed in to change notification settings
* [Fork
  14.5k](/login?return_to=%2Fapache%2Fairflow)
* [Star
   38.3k](/login?return_to=%2Fapache%2Fairflow)

* [Code](/apache/airflow)
* [Issues
  1.1k](/apache/airflow/issues)
* [Pull requests
  136](/apache/airflow/pulls)
* [Discussions](/apache/airflow/discussions)
* [Actions](/apache/airflow/actions)
* [Projects
  16](/apache/airflow/projects)
* [Security](/apache/airflow/security)
* [Insights](/apache/airflow/pulse)

Additional navigation options

* [Code](/apache/airflow)
* [Issues](/apache/airflow/issues)
* [Pull requests](/apache/airflow/pulls)
* [Discussions](/apache/airflow/discussions)
* [Actions](/apache/airflow/actions)
* [Projects](/apache/airflow/projects)
* [Security](/apache/airflow/security)
* [Insights](/apache/airflow/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fapache%2Fairflow%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fapache%2Fairflow%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Support encryption for triggers parameters #36492

 Merged

[hussein-awala](/hussein-awala)
merged 6 commits into
[apache:main](/apache/airflow/tree/main "apache/airflow:main")
from
[hussein-awala:trigger\_encryption](/hussein-awala/airflow/tree/trigger_encryption "hussein-awala/airflow:trigger_encryption")

Jan 9, 2024

 Merged

# [Support encryption for triggers parameters](#top) #36492

[hussein-awala](/hussein-awala)
merged 6 commits into
[apache:main](/apache/airflow/tree/main "apache/airflow:main")
from
[hussein-awala:trigger\_encryption](/hussein-awala/airflow/tree/trigger_encryption "hussein-awala/airflow:trigger_encryption")

Jan 9, 2024

[Conversation
41](/apache/airflow/pull/36492)
[Commits
6](/apache/airflow/pull/36492/commits)
[Checks
53](/apache/airflow/pull/36492/checks)
[Files changed](/apache/airflow/pull/36492/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=60&v=4)](/hussein-awala)

Copy link

Member

### @hussein-awala **[hussein-awala](/hussein-awala)** commented [Dec 29, 2023](#issue-2060465553)

This PR implements a way to encrypt some of the trigger parameters using fernet before storing them in the database.

Sorry, something went wrong.

All reactions

 [hussein-awala](/hussein-awala)
added 2 commits
[December 30, 2023 00:47](#commits-pushed-c9a7f74)

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[Implement a way to encrypt some trigger params stored in the DB](/apache/airflow/pull/36492/commits/c9a7f74d08d21d3801ec78e1ba002a79cbedccef "Implement a way to encrypt some trigger params stored in the DB")`

`[c9a7f74](/apache/airflow/pull/36492/commits/c9a7f74d08d21d3801ec78e1ba002a79cbedccef)`

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[Update deferring doc](/apache/airflow/pull/36492/commits/1b64a1f9dfd66faf33ce75dd6e829755cafc455f "Update deferring doc")`

`[1b64a1f](/apache/airflow/pull/36492/commits/1b64a1f9dfd66faf33ce75dd6e829755cafc455f)`

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
added this to the [Airflow 2.8.1](/apache/airflow/milestone/85) milestone
[Dec 29, 2023](#event-11359029999)

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
requested review from
[dstandish](/dstandish),
[potiuk](/potiuk),
[kaxil](/kaxil),
[ashb](/ashb) and
[XD-DENG](/XD-DENG)
as [code owners](/apache/airflow/blob/f070efa95c9c1aafffec76a2a24f2b58961ff39c/.github/CODEOWNERS#L53)
[December 29, 2023 23:49](#event-11359030015)

[![@boring-cyborg](https://avatars.githubusercontent.com/in/50386?s=40&v=4)](/apps/boring-cyborg)
[boring-cyborg](/apps/boring-cyborg)
bot
added
[area:Scheduler](/apache/airflow/labels/area%3AScheduler)
including HA (high availability) scheduler
[area:Triggerer](/apache/airflow/labels/area%3ATriggerer)
[kind:documentation](/apache/airflow/labels/kind%3Adocumentation)
labels
[Dec 29, 2023](#event-11359030077)

[![potiuk](https://avatars.githubusercontent.com/u/595491?s=60&v=4)](/potiuk)

**[potiuk](/potiuk)**
previously approved these changes
[Dec 30, 2023](#pullrequestreview-1799259031)

 [View reviewed changes](/apache/airflow/pull/36492/files/1b64a1f9dfd66faf33ce75dd6e829755cafc455f)

Copy link

Member

### @potiuk **[potiuk](/potiuk)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM - but let's wait for others to review as well.

Sorry, something went wrong.

 👍
1
 hussein-awala reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![dirrao](https://avatars.githubusercontent.com/u/39794726?s=60&v=4)](/dirrao)

**[dirrao](/dirrao)**
reviewed
[Dec 30, 2023](#pullrequestreview-1799276083)

 [View reviewed changes](/apache/airflow/pull/36492/files/1b64a1f9dfd66faf33ce75dd6e829755cafc455f)

Copy link

Contributor

### @dirrao **[dirrao](/dirrao)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Nice work.

Can't we access the variables and connections from the trigger run?

What is the recommended pattern for accessing the sensitive information from the trigger run?

Sorry, something went wrong.

All reactions

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Dec 30, 2023](#issuecomment-1872463217) • edited Loading

| Nice work. Can't we access the variables and connections from the trigger run? What is the recommended pattern for accessing the sensitive information from the trigger run?  We can - when we instantiate trigger, not when it runs (when it runs it runs in async-io event loop and it can only access disk, networking and any other resources via asynchronous calls - which means that accessign them has to follow async/await semantics. And When Trigger is deserialized by the Triggerer, the deserializing does not run regular `__init__` calll on the Trigger class - it just `deserializes` it from the DB.  And yes - we could potentially implement some `_post_deserialize` call to retrieve sensitive information from secrets or variables - however in a number of cases this means that Triggerer would have to access **some** authentication information to retrieve it. For example it would have to have the same "account" credentials that worker has or sometimes it might mean that it would have to have access to (say) same kubernetes config or .aws or .gcs authentication in order to retrieve that data.  While it is possible, it adds additional requirement on `triggerer` process - it would have to have the same authentication information set in its environment as `worker` has. But this is not necessary in most cases - as long as "serialization/deserialization" has all the necessary information. |
| --- |

All reactions

Sorry, something went wrong.

[![@dirrao](https://avatars.githubusercontent.com/u/39794726?s=80&v=4)](/dirrao)

Copy link

Contributor

### **[dirrao](/dirrao)** commented [Dec 30, 2023](#issuecomment-1872469573)

| Nice work. Can't we access the variables and connections from the trigger run? What is the recommended pattern for accessing the sensitive information from the trigger run?  We can - when we instantiate trigger, not when it runs (when it runs it runs in async-io event loop and it can only access disk, networking and any other resources via asynchronous calls - which means that accessign them has to follow async/await semantics. And When Trigger is deserialized by the Triggerer, the deserializing does not run regular `__init__` calll on the Trigger class - it just `deserializes` it from the DB.  And yes - we could potentially implement some `_post_deserialize` call to retrieve sensitive information from secrets or variables - however in a number of cases this means that Triggerer would have to access **some** authentication information to retrieve it. For example it would have to have the same "account" credentials that worker has or sometimes it might mean that it would have to have access to (say) same kubernetes config or .aws or .gcs authentication in order to retrieve that data.  While it is possible, it adds additional requirement on `triggerer` process - it would have to have the same authentication information set in its environment as `worker` has. But this is not necessary in most cases - as long as "serialization/deserialization" has all the necessary information.  Thanks for the detailed explanation. We usually access secrets from either disk or connections or encrypted variables in airflow. We can access the same in the trigger while it is running the event loop. Check the same in the below S3 Trigger. We usually don't generate new secrets at runtime in the worker and share them with trigger   [airflow/airflow/providers/amazon/aws/triggers/s3.py](https://github.com/apache/airflow/blob/2bc34ffcb5e830544e024e085f36481a33852f49/airflow/providers/amazon/aws/triggers/s3.py#L86)  Line 86 in [2bc34ff](/apache/airflow/commit/2bc34ffcb5e830544e024e085f36481a33852f49)   |  | async with self.hook.async\_conn as client: | | --- | --- | |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Dec 30, 2023](#issuecomment-1872474138) • edited Loading

| We usually access secrets from either disk or connections or encrypted variables in airflow  Correct. This is possible, no doubt about it.  But it might quite a bit complex for a number of Triggers. I am not sure how the `async_hook` works. But if you would like to use Airflow's Connection (either from the DB or from Secrets) I think it would not work (It would need async-aware access to the DB or Secrets). I would love to see how it can work in this case ? Could you please explain it - maybe I am missing something? I believe it uses the built-in async aiobotocore credental/session retrieval but that would not use Airfow's Connections/Secrets? Or am I wrong ?  Also in some cases (like for example when authentication information is coming from externally mounted volumes) is simply not available. Good exmple is when you have a managed service where the authentication information is available on a mounted volume, but the volume is not mounted in Triggerer. . Yes. This is a limitation of this particular service, but it also shows a more general problem where Triggerer would need generally the same auth environment that worker (which might not be desired or possible). |
| --- |

All reactions

Sorry, something went wrong.

[![eladkal](https://avatars.githubusercontent.com/u/45845474?s=60&v=4)](/eladkal)

**[eladkal](/eladkal)**
approved these changes
[Dec 30, 2023](#pullrequestreview-1799534737)

 [View reviewed changes](/apache/airflow/pull/36492/files/1b64a1f9dfd66faf33ce75dd6e829755cafc455f)

[![@dirrao](https://avatars.githubusercontent.com/u/39794726?s=80&v=4)](/dirrao)

Copy link

Contributor

### **[dirrao](/dirrao)** commented [Dec 30, 2023](#issuecomment-1872477618)

| We usually access secrets from either disk or connections or encrypted variables in airflow  Correct. This is possible, no doubt about it.  But it might quite a bit complex for a number of Triggers. I am not sure how the `async_hook` works. But if you would like to use Airflow's Connection (either from the DB or from Secrets) I think it would not work (It would need async-aware access to the DB or Secrets). I would love to see how it can work in this case ? Could you please explain it - maybe I am missing something? I believe it uses the built-in async aiobotocore credental/session retrieval but that would not use Airfow's Connections/Secrets? Or am I wrong ?  Yes. You are right. I will verify and update you on the DB access.  Also in some cases (like for example when authentication information is coming from externally mounted volumes) is simply not available. Good exmple is when you have a managed service where the authentication information is available on a mounted volume, but the volume is not mounted in Triggerer. . Yes. This is a limitation of this particular service, but it also shows a more general problem where Triggerer would need generally the same auth environment that worker (which might not be desired or possible).  Yes. It make sense. |
| --- |

All reactions

Sorry, something went wrong.

[![dirrao](https://avatars.githubusercontent.com/u/39794726?s=60&v=4)](/dirrao)

**[dirrao](/dirrao)**
approved these changes
[Dec 30, 2023](#pullrequestreview-1799535479)

 [View reviewed changes](/apache/airflow/pull/36492/files/1b64a1f9dfd66faf33ce75dd6e829755cafc455f)

[![potiuk](https://avatars.githubusercontent.com/u/595491?s=60&v=4)](/potiuk)

**[potiuk](/potiuk)**
reviewed
[Dec 30, 2023](#pullrequestreview-1799555807)

 [View reviewed changes](/apache/airflow/pull/36492/files/1b64a1f9dfd66faf33ce75dd6e829755cafc455f)

[airflow/models/trigger.py](/apache/airflow/pull/36492/files/1b64a1f9dfd66faf33ce75dd6e829755cafc455f#diff-3d13622d326f0c5cb736bb4fa5b0f3eb4e3d1e86b4b85fb0fb8503a2a8e10a89)

Show resolved

Hide resolved

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
dismissed
[potiuk](/potiuk)’s [stale review](#pullrequestreview-1799259031)
[December 30, 2023 12:59](#event-11359937307)

Testing conversation resolution

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
requested a review
from [potiuk](/potiuk)
[December 30, 2023 13:00](#event-11359938609)

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=80&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)

Copy link

Member

Author

### **[hussein-awala](/hussein-awala)** commented [Dec 30, 2023](#issuecomment-1872524654)

| ``` Merging is blocked The base branch requires all conversations on code to be resolved.  ```  🎉 |
| --- |

 👍
1
 potiuk reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Dec 30, 2023](#issuecomment-1872524904)

| And resolving the conversation enables merging. All cool :) |
| --- |

All reactions

Sorry, something went wrong.

[![@dirrao](https://avatars.githubusercontent.com/u/39794726?s=80&v=4)](/dirrao)

Copy link

Contributor

### **[dirrao](/dirrao)** commented [Dec 30, 2023](#issuecomment-1872529072)

| We usually access secrets from either disk or connections or encrypted variables in airflow  Correct. This is possible, no doubt about it. But it might quite a bit complex for a number of Triggers. I am not sure how the `async_hook` works. But if you would like to use Airflow's Connection (either from the DB or from Secrets) I think it would not work (It would need async-aware access to the DB or Secrets). I would love to see how it can work in this case ? Could you please explain it - maybe I am missing something? I believe it uses the built-in async aiobotocore credental/session retrieval but that would not use Airfow's Connections/Secrets? Or am I wrong ?  Yes. You are right. I will verify and update you on the DB access.  I have tried accessing the variables from the trigger run function multiple times after multiple context switches in event loop. I can access the variable values without any issues. I am sure we can access the connection details similarly. So, that we can avoid reshaping complete connection details through trigger kw\_args.  Also in some cases (like for example when authentication information is coming from externally mounted volumes) is simply not available. Good exmple is when you have a managed service where the authentication information is available on a mounted volume, but the volume is not mounted in Triggerer. . Yes. This is a limitation of this particular service, but it also shows a more general problem where Triggerer would need generally the same auth environment that worker (which might not be desired or possible).  Yes. It make sense. |
| --- |

All reactions

Sorry, something went wrong.

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Dec 30, 2023](#issuecomment-1872533458)

| I have tried accessing the variables from the trigger run function multiple times after multiple context switches in event loop. I can access the variable values without any issues  Yes. Accessing will work. But the fact that you can do it - does not mean you should :).  The problem is that if you do it during the event loop, the access (if not using async/await) will block - in I/O or networking and when it is blocked, no other triggers are running because event loop runs synchronously. See what happens (and warnings you get) when you just "sleep()" for a second or so. Or give your Triggered fractional CPU (say 0.05) - then you will see that even short - 50ms blocking operation will be disastrous for the event loop. |
| --- |

All reactions

Sorry, something went wrong.

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=80&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)

Copy link

Member

Author

### **[hussein-awala](/hussein-awala)** commented [Dec 30, 2023](#issuecomment-1872534368)

| The problem is that if you do it during the event loop, the access (if not using async/await) will block - in I/O or networking and when it is blocked, no other triggers are running because event loop runs synchronously. See what happens (and warnings you get) when you just "sleep()" for a second or so. Or give your Triggered fractional CPU (say 0.05) - then you will see that even short - 50ms blocking operation will be disastrous for the event loop.  I'm running a POC to make this easily possible without blocking the event loop and will create a new AIP soon 🤞 |
| --- |

All reactions

Sorry, something went wrong.

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Dec 30, 2023](#issuecomment-1872534863)

| I'm running a POC to make this easily possible without blocking the event loop and will create a new AIP soon 🤞  👀 |
| --- |

All reactions

Sorry, something went wrong.

[![@dirrao](https://avatars.githubusercontent.com/u/39794726?s=80&v=4)](/dirrao)

Copy link

Contributor

### **[dirrao](/dirrao)** commented [Dec 30, 2023](#issuecomment-1872537980)

| I have tried accessing the variables from the trigger run function multiple times after multiple context switches in event loop. I can access the variable values without any issues  Yes. Accessing will work. But the fact that you can do it - does not mean you should :).  The problem is that if you do it during the event loop, the access (if not using async/await) will block - in I/O or networking and when it is blocked, no other triggers are running because event loop runs synchronously. See what happens (and warnings you get) when you just "sleep()" for a second or so. Or give your Triggered fractional CPU (say 0.05) - then you will see that even short - 50ms blocking operation will be disastrous for the event loop.  Yes. You are right. It makes even more sense in the case of request/response APIs. However, in airflow, the trigger might run for seconds/minutes/hours (ex: S3KeyTrigger, KubernetesPodTrigger, etc.). I believe accessing the credentials one time should be ok. |
| --- |

All reactions

Sorry, something went wrong.

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Dec 30, 2023](#issuecomment-1872543877)

| Yes. You are right. It makes even more sense in the case of request/response APIs. However, in airflow, the trigger might run for seconds/minutes/hours (ex: S3KeyTrigger, KubernetesPodTrigger, etc.). I believe accessing the credentials one time should be ok.  Not necessarily. This is generally a very bad idea to make a blocking call in event loop. All kinds of problems - even DNS lookup hanging for a second will heavily impact the ability of Triggerer. It is supposed to handle 1000s of triggers running in single even loop. So even if one of the triggers occasionally hangs for a second, it might have enormous impact on performance of trigger. |
| --- |

All reactions

Sorry, something went wrong.

8 hidden items

Load more…

 [![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
requested a review
from [jscheffl](/jscheffl)
[January 9, 2024 00:04](#event-11423753886)

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[Merge branch 'main' into trigger_encryption](/apache/airflow/pull/36492/commits/5396e4a482cce2d283bed13cf8039e3239d98438 "Merge branch 'main' into trigger_encryption")`

`[5396e4a](/apache/airflow/pull/36492/commits/5396e4a482cce2d283bed13cf8039e3239d98438)`

[![jscheffl](https://avatars.githubusercontent.com/u/95105677?s=60&v=4)](/jscheffl)

**[jscheffl](/jscheffl)**
approved these changes
[Jan 9, 2024](#pullrequestreview-1812111049)

 [View reviewed changes](/apache/airflow/pull/36492/files/66e9bfe4262988f2071aa9b54efc5af5b2e4b6db)

Copy link

Contributor

### @jscheffl **[jscheffl](/jscheffl)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I do not fully and hardly insist on improvements of pytest, take it as "recommondation". Approving in advance ;-D

Sorry, something went wrong.

All reactions

[tests/models/test\_trigger.py](/apache/airflow/pull/36492/files/1b64a1f9dfd66faf33ce75dd6e829755cafc455f#diff-7e10cf719bac8116763b53b24b1f3dd4dad5afd786c2b971973c18372d8995d5)
Outdated

Show resolved

Hide resolved

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&v=4)](/hussein-awala)

`[Update the test](/apache/airflow/pull/36492/commits/1e620c0f2f19adb1047bed523eed661f37ca7980 "Update the test")`

`[1e620c0](/apache/airflow/pull/36492/commits/1e620c0f2f19adb1047bed523eed661f37ca7980)`

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=80&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)

Copy link

Member

Author

### **[hussein-awala](/hussein-awala)** commented [Jan 9, 2024](#issuecomment-1883893010) • edited Loading

| I do not fully and hardly insist on improvements of pytest, take it as "recommondation". Approving in advance ;-D  I just updated the test.  Actually, since we test the loaded value:  ```     loaded_trigger: SensitiveKwargsTrigger = TriggerRunner().trigger_row_to_trigger_instance(         trigger_row, SensitiveKwargsTrigger     )     assert loaded_trigger.param1 == "value1"     assert loaded_trigger.param2 == "value2" ```  we don't care how the value is stored, we just need to check that it is not the original one, as you suggested. 👍 |
| --- |

 👍
1
 jscheffl reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=80&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)

Copy link

Member

Author

### **[hussein-awala](/hussein-awala)** commented [Jan 9, 2024](#issuecomment-1883957216)

| The PR was open for two weeks. Since there are no objections to the proposed solution, I will merge it. |
| --- |

All reactions

Sorry, something went wrong.

 Hide details
View details

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
merged commit [`8fb55f2`](/apache/airflow/commit/8fb55f2127be379bf25ed5fd6d2933417e8da439)
into
apache:main

[Jan 9, 2024](https://github.com/apache/airflow/pull/36492#event-11436809736)
53 checks passed

[![@dstandish](https://avatars.githubusercontent.com/u/15932138?s=80&v=4)](/dstandish)

Copy link

Contributor

### **[dstandish](/dstandish)** commented [Jan 10, 2024](#issuecomment-1884255741)

| Hi, just saw this. Just curious, why not just always encrypt, instead of forcing each implementer to mess with the kwargs naming? |
| --- |

All reactions

Sorry, something went wrong.

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Jan 10, 2024](#issuecomment-1884389895) • edited Loading

| Hi, just saw this. Just curious, why not just always encrypt, instead of forcing each implementer to mess with the kwargs naming?  My take: encrypting all of it makes trigger data opaque and difficult to diagnose in case of problems.  Also In the future optimisation cases it makes it impossible (or very slow) to do some housekeeping. Good example of this is encrypted uses session in users db. We could not delete old sessions without seeing all the metadata there that was encrypted in blob - for example we have not been able to do very efficient "historical session" deletion because session creation time was part of the blob.  The current implementation uses ExtendedJson to store kwargs in the DB - which in modern dbs (even MySQL(!) we could make efficient queries for kwargs. I can easily imagine the use of it for particular types of triggers (Find all deferred KPOs that have been using this namespace for example) . I think - for example - when we go to multitenancy and even (maybe in the future) to multi-multi-tenancy, this kind of queryable metadata might become really useful even for internal Airflow stuff. But even now it can provide valueable information and diagnostics for some power users. |
| --- |

All reactions

Sorry, something went wrong.

[![@jscheffl](https://avatars.githubusercontent.com/u/95105677?s=80&u=3341be6f8aab84d77f0ffc5667d17bea874c27d2&v=4)](/jscheffl)

Copy link

Contributor

### **[jscheffl](/jscheffl)** commented [Jan 10, 2024](#issuecomment-1884625637)

| Hi, just saw this. Just curious, why not just always encrypt, instead of forcing each implementer to mess with the kwargs naming?  My take: encrypting all of it makes trigger data opaque and difficult to diagnose in case of problems.  Also In the future optimisation cases it makes it impossible (or very slow) to do some housekeeping. Good example of this is encrypted uses session in users db. We could not delete old sessions without seeing all the metadata there that was encrypted in blob - for example we have not been able to do very efficient "historical session" deletion because session creation time was part of the blob.  The current implementation uses ExtendedJson to store kwargs in the DB - which in modern dbs (even MySQL(!) we could make efficient queries for kwargs. I can easily imagine the use of it for particular types of triggers (Find all deferred KPOs that have been using this namespace for example) . I think - for example - when we go to multitenancy and even (maybe in the future) to multi-multi-tenancy, this kind of queryable metadata might become really useful even for internal Airflow stuff. But even now it can provide valueable information and diagnostics for some power users.  Mhm, I agree on "Troubleshooting" encryption is making it harder - but the Picked JSON/Object data anyway can not be queried on DB Level w/o Python.  Consindering that the Triggering information is very volatile (I am not sure but was expecting after a task is completed it is clened-up and does not pile-up?) it would be really reasonable to encrypt just all. Then less code is needed. |
| --- |

All reactions

Sorry, something went wrong.

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Jan 10, 2024](#issuecomment-1884639602)

| Consindering that the Triggering information is very volatile (I am not sure but was expecting after a task is completed it is clened-up and does not pile-up?) it would be really reasonable to encrypt just all. Then less code is needed.  Fair point (but JSON data can be queried in modern DBs) |
| --- |

All reactions

Sorry, something went wrong.

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Jan 10, 2024](#issuecomment-1884640857)

| <https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-json/> |
| --- |

All reactions

Sorry, something went wrong.

[![@ephraimbuddy](https://avatars.githubusercontent.com/u/4122866?s=40&u=cdf7ca9a551a310373f575749c4b159602900c9a&v=4)](/ephraimbuddy)
[ephraimbuddy](/ephraimbuddy)
added
the
[type:bug-fix](/apache/airflow/labels/type%3Abug-fix)
Changelog: Bug Fixes
label
[Jan 10, 2024](#event-11445122250)

[![@jscheffl](https://avatars.githubusercontent.com/u/95105677?s=80&u=3341be6f8aab84d77f0ffc5667d17bea874c27d2&v=4)](/jscheffl)

Copy link

Contributor

### **[jscheffl](/jscheffl)** commented [Jan 10, 2024](#issuecomment-1885745806)

| <https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-json/>  ..but I assume we don't want to implement N different dialects for all supported DBs - and anyway once we retrieve the data we need to get all the data anyway, not a subset. |
| --- |

All reactions

Sorry, something went wrong.

[ephraimbuddy](/ephraimbuddy)
pushed a commit
that referenced
this pull request
[Jan 11, 2024](#ref-commit-4314571)
[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala) [![@ephraimbuddy](https://avatars.githubusercontent.com/u/4122866?s=40&v=4)](/ephraimbuddy)

`[Support encryption for triggers parameters (](/apache/airflow/commit/4314571c31bc91274b7566bec49b15815b824c17 "Support encryption for triggers parameters (#36492)

* Implement a way to encrypt some trigger params stored in the DB

* Update deferring doc

* Create a variable for encryption prefix

* Update the test

(cherry picked from commit 8fb55f2127be379bf25ed5fd6d2933417e8da439)")[#36492](https://github.com/apache/airflow/pull/36492)[)](/apache/airflow/commit/4314571c31bc91274b7566bec49b15815b824c17 "Support encryption for triggers parameters (#36492)

* Implement a way to encrypt some trigger params stored in the DB

* Update deferring doc

* Create a variable for encryption prefix

* Update the test

(cherry picked from commit 8fb55f2127be379bf25ed5fd6d2933417e8da439)")`
…

`[4314571](/apache/airflow/commit/4314571c31bc91274b7566bec49b15815b824c17)`

```
* Implement a way to encrypt some trigger params stored in the DB

* Update deferring doc

* Create a variable for encryption prefix

* Update the test

(cherry picked from commit [8fb55f2](https://github.com/apache/airflow/commit/8fb55f2127be379bf25ed5fd6d2933417e8da439))
```

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Jan 14, 2024](#issuecomment-1891093315)

| Yeah. I am fine with encrypting it all. It does not seem too problemattic and it has the nice property of securing EVERYTHING. |
| --- |

All reactions

Sorry, something went wrong.

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=80&v=4)](/potiuk)

Copy link

Member

### **[potiuk](/potiuk)** commented [Jan 14, 2024](#issuecomment-1891093372)

| [@hussein-awala](https://github.com/hussein-awala) - what do you think? |
| --- |

All reactions

Sorry, something went wrong.

[![@ephraimbuddy](https://avatars.githubusercontent.com/u/4122866?s=40&u=cdf7ca9a551a310373f575749c4b159602900c9a&v=4)](/ephraimbuddy)
[ephraimbuddy](/ephraimbuddy)
modified the milestones:
[Airflow 2.8.1](/apache/airflow/milestone/85),
[Airflow 2.9.0](/apache/airflow/milestone/86)
[Jan 15, 2024](#event-11491677446)

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
mentioned this pull request
[Jan 15, 2024](#ref-pullrequest-2082711564)

[Encrypt all string trigger attributes
#36801](/apache/airflow/pull/36801)
 Closed

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Jan 24, 2024](#ref-issue-2098334467)

[x/vulndb: potential Go vuln in github.com/apache/airflow: CVE-2023-51702
golang/vulndb#2475](/golang/vulndb/issues/2475)

Closed

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=40&u=cbbc60943d3fedfb869e49b604020a821f589659&v=4)](/hussein-awala)
[hussein-awala](/hussein-awala)
mentioned this pull request
[Mar 17, 2024](#ref-pullrequest-2190896989)

[Encrypt all trigger attributes
#38233](/apache/airflow/pull/38233)
 Merged

[ephraimbuddy](/ephraimbuddy)
added a commit
to astronomer/airflow
that referenced
this pull request
[Mar 18, 2024](#ref-commit-1e093a8)
[![@ephraimbuddy](https://avatars.githubusercontent.com/u/4122866?s=40&u=cdf7ca9a551a310373f575749c4b159602900c9a&v=4)](/ephraimbuddy)

`[Revert "Support encryption for triggers parameters (](/astronomer/airflow/commit/1e093a885e111b3ed9ba1a4ac0cc7b76e8ea7257 "Revert \"Support encryption for triggers parameters (#36492)\"

This reverts commit 8fb55f2127be379bf25ed5fd6d2933417e8da439.")[apache#36492](https://github.com/apache/airflow/pull/36492)[)"](/astronomer/airflow/commit/1e093a885e111b3ed9ba1a4ac0cc7b76e8ea7257 "Revert \"Support encryption for triggers parameters (#36492)\"

This reverts commit 8fb55f2127be379bf25ed5fd6d2933417e8da439.")`
…

`[1e093a8](/astronomer/airflow/commit/1e093a885e111b3ed9ba1a4ac0cc7b76e8ea7257)`

```
This reverts commit [8fb55f2](https://github.com/astronomer/airflow/commit/8fb55f2127be379bf25ed5fd6d2933417e8da439).
```

[ephraimbuddy](/ephraimbuddy)
added a commit
that referenced
this pull request
[Mar 18, 2024](#ref-commit-671ba75)
[![@ephraimbuddy](https://avatars.githubusercontent.com/u/4122866?s=40&u=cdf7ca9a551a310373f575749c4b159602900c9a&v=4)](/ephraimbuddy)

`[Revert "Support encryption for triggers parameters (](/apache/airflow/commit/671ba7573824314395ee413449bd78f2bced5de3 "Revert \"Support encryption for triggers parameters (#36492)\" (#38253)

This reverts commit 8fb55f2127be379bf25ed5fd6d2933417e8da439.")[#36492](https://github.com/apache/airflow/pull/36492)[)" (](/apache/airflow/commit/671ba7573824314395ee413449bd78f2bced5de3 "Revert \"Support encryption for triggers parameters (#36492)\" (#38253)

This reverts commit 8fb55f2127be379bf25ed5fd6d2933417e8da439.")[#38253](https://github.com/apache/airflow/pull/38253)[)](/apache/airflow/commit/671ba7573824314395ee413449bd78f2bced5de3 "Revert \"Support encryption for triggers parameters (#36492)\" (#38253)

This reverts commit 8fb55f2127be379bf25ed5fd6d2933417e8da439.")`
…

`[671ba75](/apache/airflow/commit/671ba7573824314395ee413449bd78f2bced5de3)`

```
This reverts commit [8fb55f2](https://github.com/apache/airflow/commit/8fb55f2127be379bf25ed5fd6d2933417e8da439).
```

[![@ephraimbuddy](https://avatars.githubusercontent.com/u/4122866?s=40&u=cdf7ca9a551a310373f575749c4b159602900c9a&v=4)](/ephraimbuddy)
[ephraimbuddy](/ephraimbuddy)
removed
the
[type:bug-fix](/apache/airflow/labels/type%3Abug-fix)
Changelog: Bug Fixes
label
[Mar 18, 2024](#event-12149769142)

[![@ephraimbuddy](https://avatars.githubusercontent.com/u/4122866?s=40&u=cdf7ca9a551a310373f575749c4b159602900c9a&v=4)](/ephraimbuddy)
[ephraimbuddy](/ephraimbuddy)
added
the
[changelog:skip](/apache/airflow/labels/changelog%3Askip)
Changes that should be skipped from the changelog (CI, tests, etc..)
label
[Mar 25, 2024](#event-12230885427)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fairflow%2Fpull%2F36492)

Reviewers

[![@jscheffl](https://avatars.githubusercontent.com/u/95105677?s=40&v=4)](/jscheffl) [jscheffl](/jscheffl)

jscheffl approved these changes

[![@eladkal](https://avatars.githubusercontent.com/u/45845474?s=40&v=4)](/eladkal) [eladkal](/eladkal)

eladkal approved these changes

[![@dirrao](https://avatars.githubusercontent.com/u/39794726?s=40&v=4)](/dirrao) [dirrao](/dirrao)

dirrao approved these changes

[![@dstandish](https://avatars.githubusercontent.com/u/15932138?s=40&v=4)](/dstandish) [dstandish](/dstandish)

 Awaiting requested review from dstandish

 dstandish is a code owner

[![@kaxil](https://avatars.githubusercontent.com/u/8811558?s=40&v=4)](/kaxil) [kaxil](/kaxil)

 Awaiting requested review from kaxil

[![@ashb](https://avatars.githubusercontent.com/u/34150?s=40&v=4)](/ashb) [ashb](/ashb)

 Awaiting requested review from ashb

 ashb is a code owner

[![@XD-DENG](https://avatars.githubusercontent.com/u/11539188?s=40&v=4)](/XD-DENG) [XD-DENG](/XD-DENG)

 Awaiting requested review from XD-DENG

 XD-DENG is a code owner

[![@potiuk](https://avatars.githubusercontent.com/u/595491?s=40&v=4)](/potiuk) [potiuk](/potiuk)

 Awaiting requested review from potiuk

 potiuk is a code owner

Assignees

No one assigned

Labels

[area:Scheduler](/apache/airflow/labels/area%3AScheduler)
including HA (high availability) scheduler
[area:Triggerer](/apache/airflow/labels/area%3ATriggerer)
[changelog:skip](/apache/airflow/labels/changelog%3Askip)
Changes that should be skipped from the changelog (CI, tests, etc..)
[kind:documentation](/apache/airflow/labels/kind%3Adocumentation)

Projects

None yet

Milestone

 [**Airflow 2.9.0**](/apache/airflow/milestone/86 "Airflow 2.9.0")

Development

Successfully merging this pull request may close these issues.

7 participants

[![@hussein-awala](https://avatars.githubusercontent.com/u/21311487?s=52&v=4)](/hussein-awala) [![@potiuk](https://avatars.githubusercontent.com/u/595491?s=52&v=4)](/potiuk) [![@dirrao](https://avatars.githubusercontent.com/u/39794726?s=52&v=4)](/dirrao) [![@dstandish](https://avatars.githubusercontent.com/u/15932138?s=52&v=4)](/dstandish) [![@jscheffl](https://avatars.githubusercontent.com/u/95105677?s=52&v=4)](/jscheffl) [![@eladkal](https://avatars.githubusercontent.com/u/45845474?s=52&v=4)](/eladkal) [![@ephraimbuddy](https://avatars.githubusercontent.com/u/4122866?s=52&v=4)](/ephraimbuddy)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.apache.org_f2fe49af_20250115_090500.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from www.openwall.com_0f15c4a7_20250115_090452.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <47c1e8f8-cd39-813f-13b4-54988cb1c6ae@apache.org>
Date: Wed, 24 Jan 2024 11:06:28 +0000
From: Ephraim Anierobi <ephraimanierobi@...che.org>
To: oss-security@...ts.openwall.com
Subject: CVE-2023-51702: Apache Airflow CNCF Kubernetes provider, Apache
 Airflow: Kubernetes configuration file saved without encryption in the
 Metadata and logged as plain text in the Triggerer service

Severity: moderate

Affected versions:

- Apache Airflow CNCF Kubernetes provider 5.2.0 before 7.0.0
- Apache Airflow 2.3.0 before 2.6.1

Description:

Since version 5.2.0, when using deferrable mode with the path of a Kubernetes configuration file for authentication, the Airflow worker serializes this configuration file as a dictionary and sends it to the triggerer by storing it in metadata without any encryption. Additionally, if used with an Airflow version between 2.3.0 and 2.6.0, the configuration dictionary will be logged as plain text in the triggerer service without masking. This allows anyone with access to the metadata or triggerer log to obtain the configuration file and use it to access the Kubernetes cluster.

This behavior was changed in version 7.0.0, which stopped serializing the file contents and started providing the file path instead to read the contents into the trigger. Users are recommended to upgrade to version 7.0.0, which fixes this issue.

Credit:

Hussein Awala (finder)
Hussein Awala (remediation developer)

References:

<https://github.com/apache/airflow/pull/29498>
<https://github.com/apache/airflow/pull/30110>
<https://github.com/apache/airflow/pull/36492>
<https://airflow.apache.org/>
<https://www.cve.org/CVERecord?id=CVE-2023-51702>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


