=== Content from support.apple.com_50a87053_20250114_230224.html ===


* [Apple](https://www.apple.com/)
* + [Store](https://www.apple.com/us/shop/goto/store)
  + [Mac](https://www.apple.com/mac/)
  + [iPad](https://www.apple.com/ipad/)
  + [iPhone](https://www.apple.com/iphone/)
  + [Watch](https://www.apple.com/watch/)
  + [Vision](https://www.apple.com/apple-vision-pro/)
  + [AirPods](https://www.apple.com/airpods/)
  + [TV & Home](https://www.apple.com/tv-home/)
  + [Entertainment](https://www.apple.com/entertainment/)
  + [Accessories](https://www.apple.com/us/shop/goto/buy_accessories)
  + [Support](https://support.apple.com/?cid=gn-ols-home-hp-tab)
* 0+

# About the security content of macOS Sonoma 14.4

This document describes the security content of macOS Sonoma 14.4.

## About Apple security updates

For our customers' protection, Apple doesn't disclose, discuss, or confirm security issues until an investigation has occurred and patches or releases are available. Recent releases are listed on the [Apple security releases](https://support.apple.com/kb/HT201222) page.

Apple security documents reference vulnerabilities by [CVE-ID](https://www.cve.org/About/Overview) when possible.

For more information about security, see the [Apple Product Security](https://support.apple.com/kb/HT201220) page.

## macOS Sonoma 14.4

Released March 7, 2024

### Accessibility

Available for: macOS Sonoma

Impact: A malicious app may be able to observe user data in log entries related to accessibility notifications

Description: A privacy issue was addressed with improved private data redaction for log entries.

CVE-2024-23291

### Admin Framework

Available for: macOS Sonoma

Impact: An app may be able to elevate privileges

Description: A logic issue was addressed with improved checks.

CVE-2024-23276: Kirin (@Pwnrin)

### Airport

Available for: macOS Sonoma

Impact: An app may be able to read sensitive location information

Description: This issue was addressed with improved redaction of sensitive information.

CVE-2024-23227: Brian McNulty

### AppKit

Available for: macOS Sonoma

Impact: An unprivileged app may be able to log keystrokes in other apps including those using secure input mode

Description: A logic issue was addressed with improved restrictions.

CVE-2024-27886: Stephan Casas and an anonymous researcher

Entry added July 29, 2024

### AppleMobileFileIntegrity

Available for: macOS Sonoma

Impact: Entitlements and privacy permissions granted to this app may be used by a malicious app

Description: This issue was addressed with improved checks.

CVE-2024-23233: Mickey Jin (@patch1t)

### AppleMobileFileIntegrity

Available for: macOS Sonoma

Impact: An app may be able to modify protected parts of the file system

Description: A downgrade issue affecting Intel-based Mac computers was addressed with additional code-signing restrictions.

CVE-2024-23269: Mickey Jin (@patch1t)

### AppleMobileFileIntegrity

Available for: macOS Sonoma

Impact: An app may be able to elevate privileges

Description: This issue was addressed by removing the vulnerable code.

CVE-2024-23288: Wojciech Regula of SecuRing (wojciechregula.blog) and Kirin (@Pwnrin)

### Bluetooth

Available for: macOS Sonoma

Impact: An attacker in a privileged network position may be able to inject keystrokes by spoofing a keyboard

Description: The issue was addressed with improved checks.

CVE-2024-23277: Marc Newlin of SkySafe

### ColorSync

Available for: macOS Sonoma

Impact: Processing a file may lead to unexpected app termination or arbitrary code execution

Description: The issue was addressed with improved memory handling.

CVE-2024-23247: m4yfly with TianGong Team of Legendsec at Qi'anxin Group

### ColorSync

Available for: macOS Sonoma

Impact: Processing a file may lead to a denial-of-service or potentially disclose memory contents

Description: The issue was addressed with improved memory handling.

CVE-2024-23248: m4yfly with TianGong Team of Legendsec at Qi'anxin Group

CVE-2024-23249: m4yfly with TianGong Team of Legendsec at Qi'anxin Group

### CoreBluetooth - LE

Available for: macOS Sonoma

Impact: An app may be able to access Bluetooth-connected microphones without user permission

Description: An access issue was addressed with improved access restrictions.

CVE-2024-23250: Guilherme Rambo of Best Buddy Apps (rambo.codes)

### Disk Images

Available for: macOS Sonoma

Impact: An app may be able to break out of its sandbox

Description: The issue was addressed with improved checks.

CVE-2024-23299: an anonymous researcher

Entry added May 29, 2024

### Dock

Available for: macOS Sonoma

Impact: An app from a standard user account may be able to escalate privilege after admin user login

Description: A logic issue was addressed with improved restrictions.

CVE-2024-23244: Csaba Fitzl (@theevilbit) of OffSec

### ExtensionKit

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: A privacy issue was addressed with improved private data redaction for log entries.

CVE-2024-23205

### file

Available for: macOS Sonoma

Impact: Processing a file may lead to a denial-of-service or potentially disclose memory contents

Description: This issue was addressed with improved checks.

CVE-2022-48554

### Find My

Available for: macOS Sonoma

Impact: A malicious application may be able to access Find My data

Description: This issue was addressed with improved redaction of sensitive information.

CVE-2024-23229: Joshua Jewett (@JoshJewett33)

Entry added May 13, 2024

### Foundation

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: A logic issue was addressed with improved checks.

CVE-2024-27789: Mickey Jin (@patch1t)

Entry added May 13, 2024

### Image Capture

Available for: macOS Sonoma

Impact: An app may be able to access a user's Photos Library

Description: A permissions issue was addressed with additional restrictions.

CVE-2024-23253: Mickey Jin (@patch1t)

### Image Processing

Available for: macOS Sonoma

Impact: An app may be able to execute arbitrary code with kernel privileges

Description: The issue was addressed with improved memory handling.

CVE-2024-23270: an anonymous researcher

### ImageIO

Available for: macOS Sonoma

Impact: Processing an image may result in disclosure of process memory

Description: The issue was addressed with improved memory handling.

CVE-2024-23257: Junsung Lee working with Trend Micro Zero Day Initiative

### ImageIO

Available for: macOS Sonoma

Impact: Processing an image may lead to arbitrary code execution

Description: An out-of-bounds read was addressed with improved input validation.

CVE-2024-23258: Zhenjiang Zhao of pangu team, Qianxin, and Amir Bazine and Karsten K√∂nig of CrowdStrike Counter Adversary Operations

Entry updated May 29, 2024

### ImageIO

Available for: macOS Sonoma

Impact: Processing an image may lead to arbitrary code execution

Description: A buffer overflow issue was addressed with improved memory handling.

CVE-2024-23286: Junsung Lee working with Trend Micro Zero Day Initiative, Amir Bazine and Karsten K√∂nig of CrowdStrike Counter Adversary Operations, Dohyun Lee (@l33d0hyun), and Lyutoon and Mr.R

Entry updated May 29, 2024

### Intel Graphics Driver

Available for: macOS Sonoma

Impact: An app may be able to execute arbitrary code with kernel privileges

Description: An out-of-bounds write issue was addressed with improved input validation.

CVE-2024-23234: Murray Mike

### Kerberos v5 PAM module

Available for: macOS Sonoma

Impact: An app may be able to modify protected parts of the file system

Description: The issue was addressed with improved checks.

CVE-2024-23266: Pedro T√¥rres (@t0rr3sp3dr0)

### Kernel

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: A race condition was addressed with additional validation.

CVE-2024-23235

### Kernel

Available for: macOS Sonoma

Impact: An app may be able to cause unexpected system termination or write kernel memory

Description: A memory corruption vulnerability was addressed with improved locking.

CVE-2024-23265: Xinru Chi of Pangu Lab

### Kernel

Available for: macOS Sonoma

Impact: An attacker with arbitrary kernel read and write capability may be able to bypass kernel memory protections. Apple is aware of a report that this issue may have been exploited.

Description: A memory corruption issue was addressed with improved validation.

CVE-2024-23225

### libarchive

Available for: macOS Sonoma

Impact: A maliciously crafted ZIP archive may bypass Gatekeeper checks

Description: This issue was addressed with improved checks.

CVE-2024-27853: koocola

Entry added July 29, 2024

### libxpc

Available for: macOS Sonoma

Impact: An app may be able to break out of its sandbox

Description: The issue was addressed with improved checks.

CVE-2024-23278: an anonymous researcher

### libxpc

Available for: macOS Sonoma

Impact: An app may be able to execute arbitrary code out of its sandbox or with certain elevated privileges

Description: The issue was addressed with improved memory handling.

CVE-2024-0258: ali yabuz

### MediaRemote

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: A privacy issue was addressed with improved private data redaction for log entries.

CVE-2024-23279: an anonymous researcher

### Messages

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: A privacy issue was addressed with improved handling of temporary files.

CVE-2024-23287: Kirin (@Pwnrin)

### Metal

Available for: macOS Sonoma

Impact: An application may be able to read restricted memory

Description: A validation issue was addressed with improved input sanitization.

CVE-2024-23264: Meysam Firouzi @R00tkitsmm working with Trend Micro Zero Day Initiative

### Music

Available for: macOS Sonoma

Impact: An app may be able to create symlinks to protected regions of the disk

Description: This issue was addressed with improved handling of symlinks.

CVE-2024-23285: @08Tc3wBB of Jamf

### Music

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: A privacy issue was addressed with improved private data redaction for log entries.

CVE-2024-27809: an anonymous researcher

Entry added July 29, 2024

### Notes

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: A privacy issue was addressed with improved private data redaction for log entries.

CVE-2024-23283

### NSSpellChecker

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: A path handling issue was addressed with improved validation.

CVE-2024-27887: Mickey Jin (@patch1t)

Entry added July 29, 2024

### OpenSSH

Available for: macOS Sonoma

Impact: Multiple issues in OpenSSH

Description: Multiple issues were addressed by updating to OpenSSH 9.6.

CVE-2023-48795

CVE-2023-51384

CVE-2023-51385

### PackageKit

Available for: macOS Sonoma

Impact: An app may be able to modify protected parts of the file system

Description: A logic issue was addressed with improved state management.

CVE-2022-42816: Mickey Jin (@patch1t)

### PackageKit

Available for: macOS Sonoma

Impact: An app may be able to overwrite arbitrary files

Description: A path handling issue was addressed with improved validation.

CVE-2024-23216: Pedro T√¥rres (@t0rr3sp3dr0)

### PackageKit

Available for: macOS Sonoma

Impact: An app may be able to bypass certain Privacy preferences

Description: The issue was addressed with improved checks.

CVE-2024-23267: Mickey Jin (@patch1t)

### PackageKit

Available for: macOS Sonoma

Impact: An app may be able to elevate privileges

Description: An injection issue was addressed with improved input validation.

CVE-2024-23268: Mickey Jin (@patch1t), Pedro T√¥rres (@t0rr3sp3dr0)

CVE-2024-23274: Bohdan Stasiuk (@Bohdan\_Stasiuk)

### PackageKit

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: A logic issue was addressed with improved checks.

CVE-2023-42853: Mickey Jin (@patch1t)

### PackageKit

Available for: macOS Sonoma

Impact: An app may be able to access protected user data

Description: A race condition was addressed with additional validation.

CVE-2024-23275: Mickey Jin (@patch1t)

### PackageKit

Available for: macOS Sonoma

Impact: An app may be able to modify protected parts of the file system

Description: A permissions issue was addressed by removing vulnerable code and adding additional checks.

CVE-2024-27888: Mickey Jin (@patch1t)

Entry added July 29, 2024

### Photos

Available for: macOS Sonoma

Impact: Photos in the Hidden Photos Album may be viewed without authentication

Description: An authentication issue was addressed with improved state management.

CVE-2024-23255: Harsh Tyagi

### QuartzCore

Available for: macOS Sonoma

Impact: Processing malicious input may lead to code execution

Description: This issue was addressed by removing the vulnerable code.

CVE-2024-23294: Wojciech Regula of SecuRing (wojciechregula.blog)

### RTKit

Available for: macOS Sonoma

Impact: An attacker with arbitrary kernel read and write capability may be able to bypass kernel memory protections. Apple is aware of a report that this issue may have been exploited.

Description: A memory corruption issue was addressed with improved validation.

CVE-2024-23296

### Safari

Available for: macOS Sonoma

Impact: Processing web content may lead to a denial-of-service

Description: The issue was addressed with improved checks.

CVE-2024-23259: Lyra Rebane (rebane2001)

### Safari Private Browsing

Available for: macOS Sonoma

Impact: Private Browsing tabs may be accessed without authentication

Description: This issue was addressed through improved state management.

CVE-2024-23273: Matej Rabzelj

### Sandbox

Available for: macOS Sonoma

Impact: An app may be able to edit NVRAM variables

Description: An access issue was addressed with improved access restrictions.

CVE-2024-23238

### Sandbox

Available for: macOS Sonoma

Impact: An app may be able to leak sensitive user information

Description: A race condition was addressed with improved state handling.

CVE-2024-23239: Mickey Jin (@patch1t)

### Sandbox

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: A logic issue was addressed with improved restrictions.

CVE-2024-23290: Wojciech Regula of SecuRing (wojciechregula.blog)

### Screen Capture

Available for: macOS Sonoma

Impact: An app may be able to capture a user's screen

Description: A privacy issue was addressed with improved handling of temporary files.

CVE-2024-23232: Yiƒüit Can YILMAZ (@yilmazcanyigit)

### Share Sheet

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: A privacy issue was addressed with improved private data redaction for log entries.

CVE-2024-23231: Kirin (@Pwnrin) and luckyu (@uuulucky)

### SharedFileList

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: This issue was addressed with improved file handling.

CVE-2024-23230: Mickey Jin (@patch1t)

### Shortcuts

Available for: macOS Sonoma

Impact: Third-party shortcuts may use a legacy action from Automator to send events to apps without user consent

Description: This issue was addressed by adding an additional prompt for user consent.

CVE-2024-23245: an anonymous researcher

### Shortcuts

Available for: macOS Sonoma

Impact: An app may be able to access information about a user's contacts

Description: This issue was addressed with improved data protection.

CVE-2024-23292: KÂÆù and LFY@secsys from Fudan University

### Siri

Available for: macOS Sonoma

Impact: A person with physical access to a device may be able to use Siri to access private calendar information

Description: A lock screen issue was addressed with improved state management.

CVE-2024-23289: Lewis Hardy

### Siri

Available for: macOS Sonoma

Impact: An attacker with physical access may be able to use Siri to access sensitive user data

Description: This issue was addressed through improved state management.

CVE-2024-23293: Bistrit Dahal

### Spotlight

Available for: macOS Sonoma

Impact: An app may be able to leak sensitive user information

Description: This issue was addressed through improved state management.

CVE-2024-23241

### Storage Services

Available for: macOS Sonoma

Impact: An attacker may gain access to protected parts of the file system

Description: A logic issue was addressed with improved checks.

CVE-2024-23272: Mickey Jin (@patch1t)

Entry updated May 13, 2024

### Synapse

Available for: macOS Sonoma

Impact: An app may be able to view Mail data

Description: A privacy issue was addressed by not logging contents of text fields.

CVE-2024-23242

### System Settings

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: This issue was addressed with improved state management.

CVE-2024-23281: Joshua Jewett (@JoshJewett33)

### TCC

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: This issue was addressed by adding an additional prompt for user consent.

CVE-2024-27792: Mickey Jin (@patch1t)

Entry added May 29, 2024

### Time Zone

Available for: macOS Sonoma

Impact: An attacker may be able to read information belonging to another user

Description: A logic issue was addressed with improved state management.

CVE-2024-23261: Matthew Loewen

Entry added July 29, 2024

### TV App

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: This issue was addressed by removing additional entitlements.

CVE-2024-23260: Joshua Jewett (@JoshJewett33)

### UIKit

Available for: macOS Sonoma

Impact: An app may be able to break out of its sandbox

Description: This issue was addressed by removing the vulnerable code.

CVE-2024-23246: Deutsche Telekom Security GmbH sponsored by Bundesamt f√ºr Sicherheit in der Informationstechnik

### WebKit

Available for: macOS Sonoma

Impact: Processing web content may lead to arbitrary code execution

Description: The issue was addressed with improved memory handling.

WebKit Bugzilla: 259694

CVE-2024-23226: Pwn2car

### WebKit

Available for: macOS Sonoma

Impact: A malicious website may exfiltrate audio data cross-origin

Description: The issue was addressed with improved UI handling.

WebKit Bugzilla: 263795

CVE-2024-23254: James Lee (@Windowsrcer)

### WebKit

Available for: macOS Sonoma

Impact: Processing maliciously crafted web content may prevent Content Security Policy from being enforced

Description: A logic issue was addressed with improved validation.

WebKit Bugzilla: 264811

CVE-2024-23263: Johan Carlsson (joaxcar)

### WebKit

Available for: macOS Sonoma

Impact: A maliciously crafted webpage may be able to fingerprint the user

Description: An injection issue was addressed with improved validation.

WebKit Bugzilla: 266703

CVE-2024-23280: an anonymous researcher

### WebKit

Available for: macOS Sonoma

Impact: Processing maliciously crafted web content may prevent Content Security Policy from being enforced

Description: A logic issue was addressed with improved state management.

WebKit Bugzilla: 267241

CVE-2024-23284: Georg Felber and Marco Squarcina

## Additional recognition

### AppKit

We would like to acknowledge Stephan Casas and an anonymous researcher for their assistance.

Entry updated May 29, 2024

### CoreAnimation

We would like to acknowledge Junsung Lee for their assistance.

### CoreMotion

We would like to acknowledge Eric Dorphy of Twin Cities App Dev LLC for their assistance.

### Endpoint Security

We would like to acknowledge Matthew White for their assistance.

### Find My

We would like to acknowledge Meng Zhang (È≤∏ËêΩ) of NorthSea for their assistance.

### Kernel

We would like to acknowledge Tarek Joumaa (@tjkr0wn) and Ïù¥Ï§ÄÏÑ±(Junsung Lee) for their assistance.

### libxml2

We would like to acknowledge OSS-Fuzz, and Ned Williamson of Google Project Zero for their assistance.

### libxpc

We would like to acknowledge Rasmus Sten, F-Secure (Mastodon: @pajp@blog.dll.nu), and an anonymous researcher for their assistance.

### Model I/O

We would like to acknowledge Junsung Lee for their assistance.

### Photos

We would like to acknowledge Abhay Kailasia (@abhay\_kailasia) of Lakshmi Narain College Of Technology Bhopal for their assistance.

### Power Management

We would like to acknowledge Pan ZhenPeng (@Peterpan0927) of STAR Labs SG Pte. Ltd. for their assistance.

### Safari

We would like to acknowledge Abhinav Saraswat, Matthew C, and Ïù¥ÎèôÌïò (Lee Dong Ha of ZeroPointer Lab) for their assistance.

### Sandbox

We would like to acknowledge Wojciech Regula of SecuRing (wojciechregula.blog) and Zhongquan Li (@Guluisacat) for their assistance.

Entry added July 29, 2024

### SharedFileList

We would like to acknowledge Phil Schneider of Canva for their assistance.

### Shortcuts

We would like to acknowledge Yusuf Kelany for their assistance.

Entry added July 29, 2024

### Siri

We would like to acknowledge Bistrit Dahal for their assistance.

### Storage Driver

We would like to acknowledge Liang Wei of PixiePoint Security for their assistance.

### SystemMigration

We would like to acknowledge Eugene Gershnik for their assistance.

### TCC

We would like to acknowledge Mickey Jin (@patch1t) for their assistance.

### WebKit

We would like to acknowledge Nan Wang (@eternalsakura13) of 360 Vulnerability Research Institute, Valentino Dalla Valle, Pedro Bernardo, Marco Squarcina, and Lorenzo Veronese of TU Wien for their assistance.

Information about products not manufactured by Apple, or independent websites not controlled or tested by Apple, is provided without recommendation or endorsement. Apple assumes no responsibility with regard to the selection, performance, or use of third-party websites or products. Apple makes no representations regarding third-party website accuracy or reliability. [Contact the vendor](https://support.apple.com/103190) for additional information.

Published Date:¬†August 13, 2024

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don‚Äôt include any personal information in your comment.
Submit

Thanks for your feedback.

## Apple Footer

[Ô£ø
Apple](https://www.apple.com)

1. [Support](https://support.apple.com)
2. About the security content of macOS Sonoma 14.4

[United States](https://support.apple.com/en-us/120895/localeselector "Choose your country or region")

Copyright ¬© 2025 Apple Inc. All rights reserved.
 [Privacy Policy](https://www.apple.com/legal/privacy/en-ww/) [Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html) [Sales and Refunds](https://www.apple.com/shop/goto/help/sales_refunds) [Site Map](https://www.apple.com/sitemap/)



=== Content from security.gentoo.org_6f6097fa_20250114_230221.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# OpenSSH: Multiple Vulnerabilities ‚Äî GLSA **202312-17**

Multiple vulnerabilities have been discovered in OpenSSH, the worst of which could lead to code execution.

### Affected packages

| Package | **net-misc/openssh** on all architectures |
| --- | --- |
| Affected versions | < **9.6\_p1** |
| Unaffected versions | >= **9.6\_p1** |

### Background

OpenSSH is a free application suite consisting of server and clients that replace tools like telnet, rlogin, rcp and ftp with more secure versions offering additional functionality.

### Description

Multiple vulnerabilities have been discovered in OpenSSH. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All OpenSSH users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-misc/openssh-9.6_p1"

```
### References

* [CVE-2023-48795](https://nvd.nist.gov/vuln/detail/CVE-2023-48795)
* [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)
* [CVE-2023-51385,CVE-2023-48795](https://nvd.nist.gov/vuln/detail/CVE-2023-51385%2CCVE-2023-48795)

**Release date**

December 28, 2023

**Latest revision**

December 28, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [920292](https://bugs.gentoo.org/show_bug.cgi?id=920292)
* [920722](https://bugs.gentoo.org/show_bug.cgi?id=920722)

### Questions or comments?

Please feel free to contact us.

**¬© 2001‚Äì2020 Gentoo Foundation, Inc.**



=== Content from www.openwall.com_f0643cdb_20250114_230227.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <fac431e499f4d173@cvs.openbsd.org>
Date: Mon, 18 Dec 2023 08:33:10 -0700 (MST)
From: Damien Miller <djm@....openbsd.org>
To: oss-security@...ts.openwall.com
Subject: Announce: OpenSSH 9.6 released

OpenSSH 9.6 has just been released. It will be available from the
mirrors listed at <https://www.openssh.com/> shortly.

OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support.

Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
<https://www.openssh.com/donations.html>

Changes since OpenSSH 9.5
=========================

This release contains a number of security fixes, some small features
and bugfixes.

Security
========

This release contains fixes for a newly-discovered weakness in the
SSH transport protocol, a logic error relating to constrained PKCS#11
keys in ssh-agent(1) and countermeasures for programs that invoke
ssh(1) with user or hostnames containing invalid characters.

 * ssh(1), sshd(8): implement protocol extensions to thwart the
   so-called "Terrapin attack" discovered by Fabian B√§umer, Marcus
   Brinkmann and J√∂rg Schwenk. This attack allows a MITM to effect a
   limited break of the integrity of the early encrypted SSH transport
   protocol by sending extra messages prior to the commencement of
   encryption, and deleting an equal number of consecutive messages
   immediately after encryption starts. A peer SSH client/server
   would not be able to detect that messages were deleted.

   While cryptographically novel, the security impact of this attack
   is fortunately very limited as it only allows deletion of
   consecutive messages, and deleting most messages at this stage of
   the protocol prevents user user authentication from proceeding and
   results in a stuck connection.

   The most serious identified impact is that it lets a MITM to
   delete the SSH2_MSG_EXT_INFO message sent before authentication
   starts, allowing the attacker to disable a subset of the keystroke
   timing obfuscation features introduced in OpenSSH 9.5. There is no
   other discernable impact to session secrecy or session integrity.

   OpenSSH 9.6 addresses this protocol weakness through a new "strict
   KEX" protocol extension that will be automatically enabled when
   both the client and server support it. This extension makes
   two changes to the SSH transport protocol to improve the integrity
   of the initial key exchange.

   Firstly, it requires endpoints to terminate the connection if any
   unnecessary or unexpected message is received during key exchange
   (including messages that were previously legal but not strictly
   required like SSH2_MSG_DEBUG). This removes most malleability from
   the early protocol.

   Secondly, it resets the Message Authentication Code counter at the
   conclusion of each key exchange, preventing previously inserted
   messages from being able to make persistent changes to the
   sequence number across completion of a key exchange. Either of
   these changes should be sufficient to thwart the Terrapin Attack.

   More details of these changes are in the PROTOCOL file in the
   OpenSSH source distribition.

 * ssh-agent(1): when adding PKCS#11-hosted private keys while
   specifying destination constraints, if the PKCS#11 token returned
   multiple keys then only the first key had the constraints applied.
   Use of regular private keys, FIDO tokens and unconstrained keys
   are unaffected.

 * ssh(1): if an invalid user or hostname that contained shell
   metacharacters was passed to ssh(1), and a ProxyCommand,
   LocalCommand directive or "match exec" predicate referenced the
   user or hostname via %u, %h or similar expansion token, then
   an attacker who could supply arbitrary user/hostnames to ssh(1)
   could potentially perform command injection depending on what
   quoting was present in the user-supplied ssh_config(5) directive.

   This situation could arise in the case of git submodules, where
   a repository could contain a submodule with shell characters in
   its user/hostname. Git does not ban shell metacharacters in user
   or host names when checking out repositories from untrusted
   sources.

   Although we believe it is the user's responsibility to ensure
   validity of arguments passed to ssh(1), especially across a
   security boundary such as the git example above, OpenSSH 9.6 now
   bans most shell metacharacters from user and hostnames supplied
   via the command-line. This countermeasure is not guaranteed to be
   effective in all situations, as it is infeasible for ssh(1) to
   universally filter shell metacharacters potentially relevant to
   user-supplied commands.

   User/hostnames provided via ssh_config(5) are not subject to these
   restrictions, allowing configurations that use strange names to
   continue to be used, under the assumption that the user knows what
   they are doing in their own configuration files.

Potentially incompatible changes
--------------------------------

 * ssh(1), sshd(8): the RFC4254 connection/channels protocol provides
   a TCP-like window mechanism that limits the amount of data that
   can be sent without acceptance from the peer. In cases where this
   limit was exceeded by a non-conforming peer SSH implementation,
   ssh(1)/sshd(8) previously discarded the extra data. From OpenSSH
   9.6, ssh(1)/sshd(8) will now terminate the connection if a peer
   exceeds the window limit by more than a small grace factor. This
   change should have no effect of SSH implementations that follow
   the specification.

New features
------------

 * ssh(1): add a %j token that expands to the configured ProxyJump
   hostname (or the empty string if this option is not being used)
   that can be used in a number of ssh_config(5) keywords. bz3610

 * ssh(1): add ChannelTimeout support to the client, mirroring the
   same option in the server and allowing ssh(1) to terminate
   quiescent channels.

 * ssh(1), sshd(8), ssh-add(1), ssh-keygen(1): add support for
   reading ED25519 private keys in PEM PKCS8 format. Previously
   only the OpenSSH private key format was supported.

 * ssh(1), sshd(8): introduce a protocol extension to allow
   renegotiation of acceptable signature algorithms for public key
   authentication after the server has learned the username being
   used for authentication. This allows varying sshd_config(5)
   PubkeyAcceptedAlgorithms in a "Match user" block.

 * ssh-add(1), ssh-agent(1): add an agent protocol extension to allow
   specifying certificates when loading PKCS#11 keys. This allows the
   use of certificates backed by PKCS#11 private keys in all OpenSSH
   tools that support ssh-agent(1). Previously only ssh(1) supported
   this use-case.

Bugfixes
--------

 * ssh(1): when deciding whether to enable the keystroke timing
   obfuscation, enable it only if a channel with a TTY is active.

 * ssh(1): switch mainloop from poll(3) to ppoll(3) and mask signals
   before checking flags set in signal handler. Avoids potential
   race condition between signaling ssh to exit and polling. bz3531

 * ssh(1): when connecting to a destination with both the
   AddressFamily and CanonicalizeHostname directives in use,
   the AddressFamily directive could be ignored. bz5326

 * sftp(1): correct handling of the limits@...nssh.com option when
   the server returned an unexpected message.

 * A number of fixes to the PuTTY and Dropbear regress/integration
   tests.

 * ssh(1): release GSS OIDs only at end of authentication, avoiding
   unnecessary init/cleanup cycles. bz2982

 * ssh_config(5): mention "none" is a valid argument to IdentityFile
   in the manual. bz3080

 * scp(1): improved debugging for paths from the server rejected for
   not matching the client's glob(3) pattern in old SCP/RCP protocol
   mode.

 * ssh-agent(1): refuse signing operations on destination-constrained
   keys if a previous session-bind operation has failed. This may
   prevent a fail-open situation in future if a user uses a mismatched
   ssh(1) client and ssh-agent(1) where the client supports a key type
   that the agent does not support.

Portability
-----------

 * Better identify unsupported and unstable compiler flags, such as
   -fzero-call-used-regs which has been unstable across a several
   clang releases.

 * A number of fixes to regression test reliability and log
   collection.

 * Update the OpenSSL dependency in the RPM specification.

 * sshd(8): for OpenSolaris systems that support privilege limitation
   via the getpflags() interface, prefer using the newer PRIV_XPOLICY
   to PRIV_LIMIT. bz2833

Checksums:
==========

 - SHA1 (openssh-9.6.tar.gz) = a6d4cb69811e879e2f158c2e597fd9f444b26506
 - SHA256 (openssh-9.6.tar.gz) = nejPUhSnG1R1sOmIBi/t+HMNvsRqfN/DJgjwIU2tvqg=

 - SHA1 (openssh-9.6p1.tar.gz) = de300d09ec79fdbf37de4e6672cce4161439f2c3
 - SHA256 (openssh-9.6p1.tar.gz) = kQIRwHJVqMWtZUORtA7lmABxDdgRndU2LeCThap6d3w=

Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available from the mirror sites:
<https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/RELEASE_KEY.asc>

Reporting Bugs:
===============

- Please read <https://www.openssh.com/report.html>
  Security bugs should be reported directly to openssh@...nssh.com

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.debian.org_571ef86c_20250114_230220.html ===


---

[[Date Prev](msg00016.html)][[Date Next](msg00018.html)]
[[Thread Prev](msg00016.html)][[Thread Next](msg00018.html)]
[[Date Index](maillist.html#00017)]
[[Thread Index](threads.html#00017)]

# [SECURITY] [DLA 3694-1] openssh security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3694-1] openssh security update
* *From*: Santiago Ruano Rinc√≥n <santiago@freexian.com>
* *Date*: Mon, 25 Dec 2023 21:22:30 -0500
* *Message-id*: <[[üîé]](/msgid-search/ZYo45sDlsUyGT_cf%40novelo)¬†[ZYo45sDlsUyGT\_cf@novelo](msg00017.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3694-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Santiago Ruano Rinc√≥n
December 25, 2023                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : openssh
Version        : 1:7.9p1-10+deb10u4
CVE ID         : CVE-2021-41617 CVE-2023-48795 CVE-2023-51385
Debian Bug     : 995130

Several vulnerabilities have been discovered in OpenSSH, an implementation of
the SSH protocol suite.

CVE-2021-41617

    It was discovered that sshd failed to correctly initialise supplemental
    groups when executing an AuthorizedKeysCommand or
    AuthorizedPrincipalsCommand, where a AuthorizedKeysCommandUser or
    AuthorizedPrincipalsCommandUser directive has been set to run the command
    as a different user. Instead these commands would inherit the groups that
    sshd was started with.

CVE-2023-48795

    Fabian Baeumer, Marcus Brinkmann and Joerg Schwenk discovered that the SSH
    protocol is prone to a prefix truncation attack, known as the "Terrapin
    attack". This attack allows a MITM attacker to effect a limited break of the
    integrity of the early encrypted SSH transport protocol by sending extra
    messages prior to the commencement of encryption, and deleting an equal
    number of consecutive messages immediately after encryption starts.

    Details can be found at <https://terrapin-attack.com/>

CVE-2023-51385

    It was discovered that if an invalid user or hostname that contained shell
    metacharacters was passed to ssh, and a ProxyCommand, LocalCommand
    directive or "match exec" predicate referenced the user or hostname via
    expansion tokens, then an attacker who could supply arbitrary
    user/hostnames to ssh could potentially perform command injection. The
    situation could arise in case of git repositories with submodules, where the
    repository could contain a submodule with shell characters in its user or
    hostname.

For Debian 10 buster, these problems have been fixed in version
1:7.9p1-10+deb10u4.

We recommend that you upgrade your openssh packages.

For the detailed security status of openssh please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/openssh>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgp79xW1QnDI_.pgp)**

*Description:* PGP signature

---



=== Content from vin01.github.io_10fa0370_20250114_230224.html ===

[Vin01's Blog](/piptagole/)

[About](/piptagole/about/)

# SSH ProxyCommand == unexpected code execution (CVE-2023-51385)

Dec 20, 2023

## Summary

SSH‚Äôs `ProxyCommand` is a feature quite widely used to proxy ssh connections by allowing to specify custom commands to be used to connect to the server. Arguments to this directive may contain tokens like `%h`, `%u` which refer to hostname and username respectively.

When coming from untrusted sources, a hostname can be malicious and look something like **`malicious-command`** (backticks would allow a command to be executed in shell)

[More info in docs which describe this feature in detail](https://man.openbsd.org/ssh_config#ProxyCommand)

## Let‚Äôs review an example

Taking an example based on the [docs](https://man.openbsd.org/ssh_config#ProxyCommand)

```
Host *.example.com
  ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p

```

In this case, there is no sanitization of hostname and if `%h` contains a malicious hostname, it may allow command execution.

## Can I haz PoC?

What good is all this without a PoC? So here we go! Once you have added the above example to your `.ssh/config`, try following which should pop a calculator on OS X.

```
git clone https://github.com/vin01/poc-proxycommand-vulnerable --recurse-submodules

```

Even if the ProxyCommand is being used with single quotes to sanitize arguments i.e. '%h', it is not sufficient since an attacker controlled hostname might itself contain a single quote and defeat quoting.

PoC 2:

```
git clone https://github.com/vin01/poc-proxycommand-vulnerable-v2 --recurse-submodules

```
## Remediation

Update to:

* [OpenSSH 9.6p1](https://www.openssh.com/txt/release-9.6)
* [libssh 0.10.6 and 0.9.8](https://www.libssh.org/security/advisories/CVE-2023-6004.txt)

## Vulnerable usage out in the wild

* <https://help.okta.com/asa/en-us/content/topics/adv_server_access/docs/custom-ssh-client.htm>
* <https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/use-cases/ssh/>
* <https://cloud.google.com/iap/docs/tcp-by-host>
* <https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-getting-started-enable-ssh-connections.html>
* <https://goteleport.com/docs/connect-your-client/tsh/>
* [Tunneling ssh client over tor with netcat](https://en.wikibooks.org/wiki/OpenSSH/Cookbook/Proxies_and_Jump_Hosts#Tunneling_the_SSH_Client_Over_Tor_with_Netcat)

## CVEs and references

* [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)
* [CVE-2023-6004](https://access.redhat.com/security/cve/cve-2023-6004)

## My sincere thanks to:

* Kevin Roh @ Okta for brilliant triaging and impact assessment
* Jakub Jelen @ libssh for timely follow up and communication
* Damien Miller and others @ Openssh for patches and discussions
* Maintainers @ Git for discussions to define a potential trust boundary between ssh and git

**[How to donate to OpenSSH/OpenBSD](https://www.openbsd.org/donations.html)**

## Vin01's Blog

* Vin01's Blog
* vinci+ghp [at] protonmail.ch

* [vin01](https://github.com/vin01)

A collection of tidbits which might do some good out there or at least be interesting for some of you.



=== Content from www.openssh.com_e1395e9d_20250114_230226.html ===
OpenSSH 9.6 was released on 2023-12-18. It is available from the
mirrors listed at https://www.openssh.com/.
OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support.
Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
https://www.openssh.com/donations.html
Changes since OpenSSH 9.5
=========================
This release contains a number of security fixes, some small features
and bugfixes.
Security
========
This release contains fixes for a newly-discovered weakness in the
SSH transport protocol, a logic error relating to constrained PKCS#11
keys in ssh-agent(1) and countermeasures for programs that invoke
ssh(1) with user or hostnames containing invalid characters.
\* ssh(1), sshd(8): implement protocol extensions to thwart the
so-called "Terrapin attack" discovered by Fabian B√É¬§umer, Marcus
Brinkmann and J√É¬∂rg Schwenk. This attack allows a MITM to effect a
limited break of the integrity of the early encrypted SSH transport
protocol by sending extra messages prior to the commencement of
encryption, and deleting an equal number of consecutive messages
immediately after encryption starts. A peer SSH client/server
would not be able to detect that messages were deleted.
While cryptographically novel, the security impact of this attack
is fortunately very limited as it only allows deletion of
consecutive messages, and deleting most messages at this stage of
the protocol prevents user user authentication from proceeding and
results in a stuck connection.
The most serious identified impact is that it lets a MITM to
delete the SSH2\_MSG\_EXT\_INFO message sent before authentication
starts, allowing the attacker to disable a subset of the keystroke
timing obfuscation features introduced in OpenSSH 9.5. There is no
other discernable impact to session secrecy or session integrity.
OpenSSH 9.6 addresses this protocol weakness through a new "strict
KEX" protocol extension that will be automatically enabled when
both the client and server support it. This extension makes
two changes to the SSH transport protocol to improve the integrity
of the initial key exchange.
Firstly, it requires endpoints to terminate the connection if any
unnecessary or unexpected message is received during key exchange
(including messages that were previously legal but not strictly
required like SSH2\_MSG\_DEBUG). This removes most malleability from
the early protocol.
Secondly, it resets the Message Authentication Code counter at the
conclusion of each key exchange, preventing previously inserted
messages from being able to make persistent changes to the
sequence number across completion of a key exchange. Either of
these changes should be sufficient to thwart the Terrapin Attack.
More details of these changes are in the PROTOCOL file in the
OpenSSH source distribition.
\* ssh-agent(1): when adding PKCS#11-hosted private keys while
specifying destination constraints, if the PKCS#11 token returned
multiple keys then only the first key had the constraints applied.
Use of regular private keys, FIDO tokens and unconstrained keys
are unaffected.
\* ssh(1): if an invalid user or hostname that contained shell
metacharacters was passed to ssh(1), and a ProxyCommand,
LocalCommand directive or "match exec" predicate referenced the
user or hostname via %u, %h or similar expansion token, then
an attacker who could supply arbitrary user/hostnames to ssh(1)
could potentially perform command injection depending on what
quoting was present in the user-supplied ssh\_config(5) directive.
This situation could arise in the case of git submodules, where
a repository could contain a submodule with shell characters in
its user/hostname. Git does not ban shell metacharacters in user
or host names when checking out repositories from untrusted
sources.
Although we believe it is the user's responsibility to ensure
validity of arguments passed to ssh(1), especially across a
security boundary such as the git example above, OpenSSH 9.6 now
bans most shell metacharacters from user and hostnames supplied
via the command-line. This countermeasure is not guaranteed to be
effective in all situations, as it is infeasible for ssh(1) to
universally filter shell metacharacters potentially relevant to
user-supplied commands.
User/hostnames provided via ssh\_config(5) are not subject to these
restrictions, allowing configurations that use strange names to
continue to be used, under the assumption that the user knows what
they are doing in their own configuration files.
Potentially incompatible changes
--------------------------------
\* ssh(1), sshd(8): the RFC4254 connection/channels protocol provides
a TCP-like window mechanism that limits the amount of data that
can be sent without acceptance from the peer. In cases where this
limit was exceeded by a non-conforming peer SSH implementation,
ssh(1)/sshd(8) previously discarded the extra data. From OpenSSH
9.6, ssh(1)/sshd(8) will now terminate the connection if a peer
exceeds the window limit by more than a small grace factor. This
change should have no effect of SSH implementations that follow
the specification.
New features
------------
\* ssh(1): add a %j token that expands to the configured ProxyJump
hostname (or the empty string if this option is not being used)
that can be used in a number of ssh\_config(5) keywords. bz3610
\* ssh(1): add ChannelTimeout support to the client, mirroring the
same option in the server and allowing ssh(1) to terminate
quiescent channels.
\* ssh(1), sshd(8), ssh-add(1), ssh-keygen(1): add support for
reading ED25519 private keys in PEM PKCS8 format. Previously
only the OpenSSH private key format was supported.
\* ssh(1), sshd(8): introduce a protocol extension to allow
renegotiation of acceptable signature algorithms for public key
authentication after the server has learned the username being
used for authentication. This allows varying sshd\_config(5)
PubkeyAcceptedAlgorithms in a "Match user" block.
\* ssh-add(1), ssh-agent(1): add an agent protocol extension to allow
specifying certificates when loading PKCS#11 keys. This allows the
use of certificates backed by PKCS#11 private keys in all OpenSSH
tools that support ssh-agent(1). Previously only ssh(1) supported
this use-case.
Bugfixes
--------
\* ssh(1): when deciding whether to enable the keystroke timing
obfuscation, enable it only if a channel with a TTY is active.
\* ssh(1): switch mainloop from poll(3) to ppoll(3) and mask signals
before checking flags set in signal handler. Avoids potential
race condition between signaling ssh to exit and polling. bz3531
\* ssh(1): when connecting to a destination with both the
AddressFamily and CanonicalizeHostname directives in use,
the AddressFamily directive could be ignored. bz5326
\* sftp(1): correct handling of the limits@openssh.com option when
the server returned an unexpected message.
\* A number of fixes to the PuTTY and Dropbear regress/integration
tests.
\* ssh(1): release GSS OIDs only at end of authentication, avoiding
unnecessary init/cleanup cycles. bz2982
\* ssh\_config(5): mention "none" is a valid argument to IdentityFile
in the manual. bz3080
\* scp(1): improved debugging for paths from the server rejected for
not matching the client's glob(3) pattern in old SCP/RCP protocol
mode.
\* ssh-agent(1): refuse signing operations on destination-constrained
keys if a previous session-bind operation has failed. This may
prevent a fail-open situation in future if a user uses a mismatched
ssh(1) client and ssh-agent(1) where the client supports a key type
that the agent does not support.
Portability
-----------
\* Better identify unsupported and unstable compiler flags, such as
-fzero-call-used-regs which has been unstable across a several
clang releases.
\* A number of fixes to regression test reliability and log
collection.
\* Update the OpenSSL dependency in the RPM specification.
\* sshd(8): for OpenSolaris systems that support privilege limitation
via the getpflags() interface, prefer using the newer PRIV\_XPOLICY
to PRIV\_LIMIT. bz2833
Checksums:
==========
- SHA1 (openssh-9.6.tar.gz) = a6d4cb69811e879e2f158c2e597fd9f444b26506
- SHA256 (openssh-9.6.tar.gz) = nejPUhSnG1R1sOmIBi/t+HMNvsRqfN/DJgjwIU2tvqg=
- SHA1 (openssh-9.6p1.tar.gz) = de300d09ec79fdbf37de4e6672cce4161439f2c3
- SHA256 (openssh-9.6p1.tar.gz) = kQIRwHJVqMWtZUORtA7lmABxDdgRndU2LeCThap6d3w=
Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available from the mirror sites:
https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/RELEASE\_KEY.asc
Reporting Bugs:
===============
- Please read https://www.openssh.com/report.html
Security bugs should be reported directly to openssh@openssh.com


=== Content from www.openwall.com_e63183e8_20250114_230219.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20231226161624.GA21138@openwall.com>
Date: Tue, 26 Dec 2023 17:16:24 +0100
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2023-51385, CVE-2023-6004: OpenSSH, libssh: Security weakness in ProxyCommand handling

Hi,

This was previously announced as mitigated in OpenSSH 9.6:

<https://www.openwall.com/lists/oss-security/2023/12/18/2>

and is now known as CVE-2023-51385 described as follows:

> In ssh in OpenSSH before 9.6, OS command injection might occur if a user
> name or host name has shell metacharacters, and this name is referenced
> by an expansion token in certain situations.  For example, an untrusted
> Git repository can have a submodule with shell metacharacters in a user
> name or host name.

The corresponding libssh issue got assigned CVE-2023-6004, with their
advisory here:

<https://www.libssh.org/security/advisories/CVE-2023-6004.txt>

and quoted below:

> ===========================================================
> == Subject:     Security weakness in ProxyCommand handling
> ==
> == CVE ID#:     CVE-2023-6004
> ==
> == Versions:    0.10.x, 0.9.x, 0.8.x
> ==
> == Summary:     ProxyCommand/ProxyJump features enable to inject
>                 malicious code through hostname
> ==
> ===========================================================
>
> ===========
> Description
> ===========
>
> Using the ProxyCommand or the ProxyJump feature enables users to exploit
> unchecked hostname syntax on the client, which enables to inject malicious code
> into the command of the above-mentioned features through the hostname parameter.
>
> User interaction is required to exploit this issue.
>
> ==================
> Patch Availability
> ==================
>
> Patches addressing the issues have been posted to:
> <https://www.libssh.org/security/>
> Additionally, libssh 0.10, 0.9 have been issued
> as security releases to correct the defect.  SSH administrators are
> advised to upgrade to these releases or apply the patch as soon
> as possible.
>
> ==================
> CVSSv3 calculation
> ==================
> CVSS:3.0/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N (3.9)
>
> ==========
> Workaround
> ==========
>
> Sanitize hostname input
>
> =======
> Credits
> =======
>
> Originally reported by Vinci (<https://github.com/vin01>).
> Patches provided by Norbert Pocs of the libssh team.
>
> ==========================================================
> == The libssh team
> ==========================================================

Incidentally, NIST NVD's current CVSS 3.1 score for OpenSSH's
CVE-2023-51385 is a ridiculous 9.8.  Quite usual for CVSS and NVD.

There's a blog post on exploitation via git submodules and on
"Vulnerable usage out in the wild" here:

<https://vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html>

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.debian.org_49a09f41_20250114_230225.html ===


---

[[Date Prev](msg00282.html)][[Date Next](msg00284.html)]
[[Thread Prev](msg00282.html)][[Thread Next](msg00284.html)]
[[Date Index](maillist.html#00283)]
[[Thread Index](threads.html#00283)]

# [SECURITY] [DSA 5586-1] openssh security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5586-1] openssh security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Fri, 22 Dec 2023 08:59:42 +0000
* *Message-id*: <[[üîé]](/msgid-search/E1rGbNe-007wMs-Ue%40seger.debian.org)¬†[E1rGbNe-007wMs-Ue@seger.debian.org](msg00283.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5586-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
December 22, 2023                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : openssh
CVE ID         : CVE-2021-41617 CVE-2023-28531 CVE-2023-48795 CVE-2023-51384
                 CVE-2023-51385
Debian Bug     : 995130 1033166

Several vulnerabilities have been discovered in OpenSSH, an
implementation of the SSH protocol suite.

CVE-2021-41617

    It was discovered that sshd failed to correctly initialise
    supplemental groups when executing an AuthorizedKeysCommand or
    AuthorizedPrincipalsCommand, where a AuthorizedKeysCommandUser or
    AuthorizedPrincipalsCommandUser directive has been set to run the
    command as a different user. Instead these commands would inherit
    the groups that sshd was started with.

CVE-2023-28531

    Luci Stanescu reported that a error prevented constraints being
    communicated to the ssh-agent when adding smartcard keys to the
    agent with per-hop destination constraints, resulting in keys being
    added without constraints.

CVE-2023-48795

    Fabian Baeumer, Marcus Brinkmann and Joerg Schwenk discovered that
    the SSH protocol is prone to a prefix truncation attack, known as
    the "Terrapin attack". This attack allows a MITM attacker to effect
    a limited break of the integrity of the early encrypted SSH
    transport protocol by sending extra messages prior to the
    commencement of encryption, and deleting an equal number of
    consecutive messages immediately after encryption starts.

    Details can be found at <https://terrapin-attack.com/>

CVE-2023-51384

    It was discovered that when PKCS#11-hosted private keys were
    added while specifying destination constraints, if the PKCS#11
    token returned multiple keys then only the first key had the
    constraints applied.

CVE-2023-51385

    It was discovered that if an invalid user or hostname that contained
    shell metacharacters was passed to ssh, and a ProxyCommand,
    LocalCommand directive or "match exec" predicate referenced the user
    or hostname via expansion tokens, then an attacker who could supply
    arbitrary user/hostnames to ssh could potentially perform command
    injection. The situation could arise in case of git repositories
    with submodules, where the repository could contain a submodule with
    shell characters in its user or hostname.

For the oldstable distribution (bullseye), these problems have been fixed
in version 1:8.4p1-5+deb11u3.

For the stable distribution (bookworm), these problems have been fixed in
version 1:9.2p1-2+deb12u2.

We recommend that you upgrade your openssh packages.

For the detailed security status of openssh please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/openssh>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmWFTwlfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0S6PRAAkBJzc/CFQgXLtms7bom/Vw750vvqEVhj7ojOPHbmpoppVIjFR768C5Z6
AO5HiP/uH1tk0x2zejbPhXRgLK/2PEuCTA/4w7UeTzYIGve3IVKVgNs+/sgWQBuK
M1xj8zL1PLkRi6rSXAvGpTxqdCtWC61AWHOl1Q03w3usilETJKDsulOBb9sQ9Uid
xSRxDUAS//gyRdW+K3D9HsPYJAW/oSu4tJO+UXI1WJTDY1N/i0cq7yH16YXzbEcV
dhttLyR5fWx000fSsaaWXgYUS2sSYUfOKPfw4xdePpdeBYNumnpehjfCED5C61EQ
os4uvEDi15X8M599/+u0oLVJJFXVSfZ4W1ecFWcFAvMny70F0s1a7AxQCcN3sXkt
kLAuOXJHmmhBeqSj1kVKoLcg4WSlCdglRr6KgiXqUVvfUBsWhseoyGJ3jST3PQcZ
70/lIJofavLJdFQHlPTXs7lDnFttgzuB3xE5wM7TeXs5L2l9QI0W64YCtWthqApL
c7KjPGmAx7xYOOp+aHclsP74nBVZs6tcvHPf9Y/1OK30XkoMbuW0+oH1rCu6EGs0
F6Th1FneTwRN2NEhzpQMr+34m0T8H7oymiQmi9C+ZDhCBDRcpN4sATYNh70Y/t6y
i8k/vZcCCfLxQgdiay5JJCWJPf1pvvmPbgMLs4WVELr/6E9xIR0=
=2W//
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_303023d2_20250114_230220.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenssh%2Fopenssh-portable%2Fcommit%2F7ef3787c84b6b524501211b11a26c742f829af1a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenssh%2Fopenssh-portable%2Fcommit%2F7ef3787c84b6b524501211b11a26c742f829af1a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openssh%2Fopenssh-portable)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openssh](/openssh)
/
**[openssh-portable](/openssh/openssh-portable)**
Public

* [Notifications](/login?return_to=%2Fopenssh%2Fopenssh-portable) You must be signed in to change notification settings
* [Fork
  1.8k](/login?return_to=%2Fopenssh%2Fopenssh-portable)
* [Star
   3.2k](/login?return_to=%2Fopenssh%2Fopenssh-portable)

* [Code](/openssh/openssh-portable)
* [Pull requests
  109](/openssh/openssh-portable/pulls)
* [Actions](/openssh/openssh-portable/actions)
* [Security](/openssh/openssh-portable/security)
* [Insights](/openssh/openssh-portable/pulse)

Additional navigation options

* [Code](/openssh/openssh-portable)
* [Pull requests](/openssh/openssh-portable/pulls)
* [Actions](/openssh/openssh-portable/actions)
* [Security](/openssh/openssh-portable/security)
* [Insights](/openssh/openssh-portable/pulse)

## Commit

[Permalink](/openssh/openssh-portable/commit/7ef3787c84b6b524501211b11a26c742f829af1a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

upstream: ban user/hostnames with most shell metacharacters

[Browse files](/openssh/openssh-portable/tree/7ef3787c84b6b524501211b11a26c742f829af1a)
Browse the repository at this point in the history

```
This makes ssh(1) refuse user or host names provided on the
commandline that contain most shell metacharacters.

Some programs that invoke ssh(1) using untrusted data do not filter
metacharacters in arguments they supply. This could create
interactions with user-specified ProxyCommand and other directives
that allow shell injection attacks to occur.

It's a mistake to invoke ssh(1) with arbitrary untrusted arguments,
but getting this stuff right can be tricky, so this should prevent
most obvious ways of creating risky situations. It however is not
and cannot be perfect: ssh(1) has no practical way of interpreting
what shell quoting rules are in use and how they interact with the
user's specified ProxyCommand.

To allow configurations that use strange user or hostnames to
continue to work, this strictness is applied only to names coming
from the commandline. Names specified using User or Hostname
directives in ssh_config(5) are not affected.

feedback/ok millert@ markus@ dtucker@ deraadt@

OpenBSD-Commit-ID: 3b487348b5964f3e77b6b4d3da4c3b439e94b2d9
```

* Loading branch information

[![@djmdjm](https://avatars.githubusercontent.com/u/170281?s=40&v=4)](/djmdjm)

[djmdjm](/openssh/openssh-portable/commits?author=djmdjm "View all commits by djmdjm")
committed
Dec 18, 2023

1 parent
[0cb50ee](/openssh/openssh-portable/commit/0cb50eefdd29f0fec31d0e71cc4b004a5f704e67)

commit 7ef3787

Showing
**1 changed file**
with
**40 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

41 changes: 40 additions & 1 deletion

41
[ssh.c](#diff-ce646b350d7e1b7ca792b15463c7ce19fd0979286424bb3d569e36ab5e435039 "ssh.c")

Show comments

[View file](/openssh/openssh-portable/blob/7ef3787c84b6b524501211b11a26c742f829af1a/ssh.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | /\* $OpenBSD: ssh.c,v 1.598 2023/10/12 02:48:43 djm Exp $ \*/ |
|  |  | /\* $OpenBSD: ssh.c,v 1.599 2023/12/18 14:47:44 djm Exp $ \*/ |
|  |  | /\* |
|  |  | \* Author: Tatu Ylonen <ylo@cs.hut.fi> |
|  |  | \* Copyright (c) 1995 Tatu Ylonen <ylo@cs.hut.fi>, Espoo, Finland |
| Expand Down  Expand Up | | @@ -626,6 +626,41 @@ ssh\_conn\_info\_free(struct ssh\_conn\_info \*cinfo) |
|  |  | free(cinfo); |
|  |  | } |
|  |  |  |
|  |  | static int |
|  |  | valid\_hostname(const char \*s) |
|  |  | { |
|  |  | size\_t i; |
|  |  |  |
|  |  | if (\*s == '-') |
|  |  | return 0; |
|  |  | for (i = 0; s[i] != 0; i++) { |
|  |  | if (strchr("'`\"$\\;&<>|(){}", s[i]) != NULL || |
|  |  | isspace((u\_char)s[i]) || iscntrl((u\_char)s[i])) |
|  |  | return 0; |
|  |  | } |
|  |  | return 1; |
|  |  | } |
|  |  |  |
|  |  | static int |
|  |  | valid\_ruser(const char \*s) |
|  |  | { |
|  |  | size\_t i; |
|  |  |  |
|  |  | if (\*s == '-') |
|  |  | return 0; |
|  |  | for (i = 0; s[i] != 0; i++) { |
|  |  | if (strchr("'`\";&<>|(){}", s[i]) != NULL) |
|  |  | return 0; |
|  |  | /\* Disallow '-' after whitespace \*/ |
|  |  | if (isspace((u\_char)s[i]) && s[i + 1] == '-') |
|  |  | return 0; |
|  |  | /\* Disallow \ in last position \*/ |
|  |  | if (s[i] == '\\' && s[i + 1] == '\0') |
|  |  | return 0; |
|  |  | } |
|  |  | return 1; |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \* Main program for the ssh client. |
|  |  | \*/ |
| Expand Down  Expand Up | | @@ -1118,6 +1153,10 @@ main(int ac, char \*\*av) |
|  |  | if (!host) |
|  |  | usage(); |
|  |  |  |
|  |  | if (!valid\_hostname(host)) |
|  |  | fatal("hostname contains invalid characters"); |
|  |  | if (options.user != NULL && !valid\_ruser(options.user)) |
|  |  | fatal("remote username contains invalid characters"); |
|  |  | options.host\_arg = xstrdup(host); |
|  |  |  |
|  |  | /\* Initialize the command to execute on remote host. \*/ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7ef3787`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenssh%2Fopenssh-portable%2Fcommit%2F7ef3787c84b6b524501211b11a26c742f829af1a) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from seclists.org_c51996d1_20250114_230219.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](20)
[By Date](date.html#21)
[![Next](/images/right-icon-16x16.png)](22)

[![Previous](/images/left-icon-16x16.png)](20)
[By Thread](index.html#21)
[![Next](/images/right-icon-16x16.png)](22)

![](/shared/images/nst-icons.svg#search)

# APPLE-SA-03-07-2024-2 macOS Sonoma 14.4

---

*From*: Apple Product Security via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Thu, 07 Mar 2024 18:22:30 -0800

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

APPLE-SA-03-07-2024-2 macOS Sonoma 14.4

macOS Sonoma 14.4 addresses the following issues.
Information about the security content is also available at
<https://support.apple.com/kb/HT214084>.

Apple maintains a Security Releases page at
<https://support.apple.com/HT201222> which lists recent
software updates with security advisories.

Accessibility
Available for: macOS Sonoma
Impact: A malicious app may be able to observe user data in log entries
related to accessibility notifications
Description: A privacy issue was addressed with improved private data
redaction for log entries.
CVE-2024-23291

Admin Framework
Available for: macOS Sonoma
Impact: An app may be able to elevate privileges
Description: A logic issue was addressed with improved checks.
CVE-2024-23276: Kirin (@Pwnrin)

Airport
Available for: macOS Sonoma
Impact: An app may be able to read sensitive location information
Description: This issue was addressed with improved redaction of
sensitive information.
CVE-2024-23227: Brian McNulty

AppleMobileFileIntegrity
Available for: macOS Sonoma
Impact: Entitlements and privacy permissions granted to this app may be
used by a malicious app
Description: This issue was addressed with improved checks.
CVE-2024-23233: Mickey Jin (@patch1t)

AppleMobileFileIntegrity
Available for: macOS Sonoma
Impact: An app may be able to modify protected parts of the file system
Description: A downgrade issue affecting Intel-based Mac computers was
addressed with additional code-signing restrictions.
CVE-2024-23269: Mickey Jin (@patch1t)

AppleMobileFileIntegrity
Available for: macOS Sonoma
Impact: An app may be able to elevate privileges
Description: This issue was addressed by removing the vulnerable code.
CVE-2024-23288: Wojciech Regula of SecuRing (wojciechregula.blog) and
Kirin (@Pwnrin)

Bluetooth
Available for: macOS Sonoma
Impact: An attacker in a privileged network position may be able to
inject keystrokes by spoofing a keyboard
Description: The issue was addressed with improved checks.
CVE-2024-23277: Marc Newlin of SkySafe

ColorSync
Available for: macOS Sonoma
Impact: Processing a file may lead to unexpected app termination or
arbitrary code execution
Description: The issue was addressed with improved memory handling.
CVE-2024-23247: m4yfly with TianGong Team of Legendsec at Qi'anxin Group

ColorSync
Available for: macOS Sonoma
Impact: Processing a file may lead to a denial-of-service or potentially
disclose memory contents
Description: The issue was addressed with improved memory handling.
CVE-2024-23248: m4yfly with TianGong Team of Legendsec at Qi'anxin Group
CVE-2024-23249: m4yfly with TianGong Team of Legendsec at Qi'anxin Group

CoreBluetooth - LE
Available for: macOS Sonoma
Impact: An app may be able to access Bluetooth-connected microphones
without user permission
Description: An access issue was addressed with improved access
restrictions.
CVE-2024-23250: Guilherme Rambo of Best Buddy Apps (rambo.codes)

Dock
Available for: macOS Sonoma
Impact: An app from a standard user account may be able to escalate
privilege after admin user login
Description: A logic issue was addressed with improved restrictions.
CVE-2024-23244: Csaba Fitzl (@theevilbit) of OffSec

ExtensionKit
Available for: macOS Sonoma
Impact: An app may be able to access sensitive user data
Description: A privacy issue was addressed with improved private data
redaction for log entries.
CVE-2024-23205

file
Available for: macOS Sonoma
Impact: Processing a file may lead to a denial-of-service or potentially
disclose memory contents
Description: This issue was addressed with improved checks.
CVE-2022-48554

Image Capture
Available for: macOS Sonoma
Impact: An app may be able to access a user's Photos Library
Description: A permissions issue was addressed with additional
restrictions.
CVE-2024-23253: Mickey Jin (@patch1t)

Image Processing
Available for: macOS Sonoma
Impact: An app may be able to execute arbitrary code with kernel
privileges
Description: The issue was addressed with improved memory handling.
CVE-2024-23270: an anonymous researcher

ImageIO
Available for: macOS Sonoma
Impact: Processing an image may result in disclosure of process memory
Description: The issue was addressed with improved memory handling.
CVE-2024-23257: Junsung Lee working with Trend Micro Zero Day Initiative

ImageIO
Available for: macOS Sonoma
Impact: Processing an image may lead to arbitrary code execution
Description: An out-of-bounds read was addressed with improved input
validation.
CVE-2024-23258: Zhenjiang Zhao of pangu team, Qianxin

ImageIO
Available for: macOS Sonoma
Impact: Processing an image may lead to arbitrary code execution
Description: A buffer overflow issue was addressed with improved memory
handling.
CVE-2024-23286: Dohyun Lee (@l33d0hyun)

Intel Graphics Driver
Available for: macOS Sonoma
Impact: An app may be able to execute arbitrary code with kernel
privileges
Description: An out-of-bounds write issue was addressed with improved
input validation.
CVE-2024-23234: Murray Mike

Kerberos v5 PAM module
Available for: macOS Sonoma
Impact: An app may be able to modify protected parts of the file system
Description: The issue was addressed with improved checks.
CVE-2024-23266: Pedro T√¥rres (@t0rr3sp3dr0)

Kernel
Available for: macOS Sonoma
Impact: An app may be able to access user-sensitive data
Description: A race condition was addressed with additional validation.
CVE-2024-23235

Kernel
Available for: macOS Sonoma
Impact: An app may be able to cause unexpected system termination or
write kernel memory
Description: A memory corruption vulnerability was addressed with
improved locking.
CVE-2024-23265: Xinru Chi of Pangu Lab

Kernel
Available for: macOS Sonoma
Impact: An attacker with arbitrary kernel read and write capability may
be able to bypass kernel memory protections. Apple is aware of a report
that this issue may have been exploited.
Description: A memory corruption issue was addressed with improved
validation.
CVE-2024-23225

libxpc
Available for: macOS Sonoma
Impact: An app may be able to break out of its sandbox
Description: The issue was addressed with improved checks.
CVE-2024-23278: an anonymous researcher

libxpc
Available for: macOS Sonoma
Impact: An app may be able to execute arbitrary code out of its sandbox
or with certain elevated privileges
Description: The issue was addressed with improved memory handling.
CVE-2024-0258: ali yabuz

MediaRemote
Available for: macOS Sonoma
Impact: An app may be able to access user-sensitive data
Description: A privacy issue was addressed with improved private data
redaction for log entries.
CVE-2024-23279: an anonymous researcher

Messages
Available for: macOS Sonoma
Impact: An app may be able to access user-sensitive data
Description: A privacy issue was addressed with improved handling of
temporary files.
CVE-2024-23287: Kirin (@Pwnrin)

Metal
Available for: macOS Sonoma
Impact: An application may be able to read restricted memory
Description: A validation issue was addressed with improved input
sanitization.
CVE-2024-23264: Meysam Firouzi @R00tkitsmm working with Trend Micro Zero
Day Initiative

Music
Available for: macOS Sonoma
Impact: An app may be able to create symlinks to protected regions of
the disk
Description: This issue was addressed with improved handling of
symlinks.
CVE-2024-23285: @08Tc3wBB of Jamf

Notes
Available for: macOS Sonoma
Impact: An app may be able to access user-sensitive data
Description: A privacy issue was addressed with improved private data
redaction for log entries.
CVE-2024-23283

OpenSSH
Available for: macOS Sonoma
Impact: Multiple issues in OpenSSH
Description: Multiple issues were addressed by updating to OpenSSH 9.6.
CVE-2023-48795
CVE-2023-51384
CVE-2023-51385

PackageKit
Available for: macOS Sonoma
Impact: An app may be able to modify protected parts of the file system
Description: A logic issue was addressed with improved state management.
CVE-2022-42816: Mickey Jin (@patch1t)

PackageKit
Available for: macOS Sonoma
Impact: An app may be able to overwrite arbitrary files
Description: A path handling issue was addressed with improved
validation.
CVE-2024-23216: Pedro T√¥rres (@t0rr3sp3dr0)

PackageKit
Available for: macOS Sonoma
Impact: An app may be able to bypass certain Privacy preferences
Description: The issue was addressed with improved checks.
CVE-2024-23267: Mickey Jin (@patch1t)

PackageKit
Available for: macOS Sonoma
Impact: An app may be able to elevate privileges
Description: An injection issue was addressed with improved input
validation.
CVE-2024-23268: Mickey Jin (@patch1t), Pedro T√¥rres (@t0rr3sp3dr0)
CVE-2024-23274: Bohdan Stasiuk (@Bohdan_Stasiuk)

PackageKit
Available for: macOS Sonoma
Impact: An app may be able to access user-sensitive data
Description: A logic issue was addressed with improved checks.
CVE-2023-42853: Mickey Jin (@patch1t)

PackageKit
Available for: macOS Sonoma
Impact: An app may be able to access protected user data
Description: A race condition was addressed with additional validation.
CVE-2024-23275: Mickey Jin (@patch1t)

Photos
Available for: macOS Sonoma
Impact: Photos in the Hidden Photos Album may be viewed without
authentication
Description: An authentication issue was addressed with improved state
management.
CVE-2024-23255: Harsh Tyagi

QuartzCore
Available for: macOS Sonoma
Impact: Processing malicious input may lead to code execution
Description: This issue was addressed by removing the vulnerable code.
CVE-2024-23294: Wojciech Regula of SecuRing (wojciechregula.blog)

RTKit
Available for: macOS Sonoma
Impact: An attacker with arbitrary kernel read and write capability may
be able to bypass kernel memory protections. Apple is aware of a report
that this issue may have been exploited.
Description: A memory corruption issue was addressed with improved
validation.
CVE-2024-23296

Safari
Available for: macOS Sonoma
Impact: Processing web content may lead to a denial-of-service
Description: The issue was addressed with improved checks.
CVE-2024-23259: Lyra Rebane (rebane2001)

Safari Private Browsing
Available for: macOS Sonoma
Impact: Private Browsing tabs may be accessed without authentication
Description: This issue was addressed through improved state management.
CVE-2024-23273: Matej Rabzelj

Sandbox
Available for: macOS Sonoma
Impact: An app may be able to edit NVRAM variables
Description: An access issue was addressed with improved access
restrictions.
CVE-2024-23238

Sandbox
Available for: macOS Sonoma
Impact: An app may be able to leak sensitive user information
Description: A race condition was addressed with improved state
handling.
CVE-2024-23239: Mickey Jin (@patch1t)

Sandbox
Available for: macOS Sonoma
Impact: An app may be able to access user-sensitive data
Description: A logic issue was addressed with improved restrictions.
CVE-2024-23290: Wojciech Regula of SecuRing (wojciechregula.blog)

Screen Capture
Available for: macOS Sonoma
Impact: An app may be able to capture a user's screen
Description: A privacy issue was addressed with improved handling of
temporary files.
CVE-2024-23232: Yiƒüit Can YILMAZ (@yilmazcanyigit)

Share Sheet
Available for: macOS Sonoma
Impact: An app may be able to access user-sensitive data
Description: A privacy issue was addressed with improved private data
redaction for log entries.
CVE-2024-23231: Kirin (@Pwnrin) and luckyu (@uuulucky)

SharedFileList
Available for: macOS Sonoma
Impact: An app may be able to access sensitive user data
Description: This issue was addressed with improved file handling.
CVE-2024-23230: Mickey Jin (@patch1t)

Shortcuts
Available for: macOS Sonoma
Impact: Third-party shortcuts may use a legacy action from Automator to
send events to apps without user consent
Description: This issue was addressed by adding an additional prompt for
user consent.
CVE-2024-23245: an anonymous researcher

Shortcuts
Available for: macOS Sonoma
Impact: An app may be able to access information about a user's contacts
Description: This issue was addressed with improved data protection.
CVE-2024-23292: KÂÆù and LFY@secsys from Fudan University

Siri
Available for: macOS Sonoma
Impact: A person with physical access to a device may be able to use
Siri to access private calendar information
Description: A lock screen issue was addressed with improved state
management.
CVE-2024-23289: Lewis Hardy

Siri
Available for: macOS Sonoma
Impact: An attacker with physical access may be able to use Siri to
access sensitive user data
Description: This issue was addressed through improved state management.
CVE-2024-23293: Bistrit Dahal

Spotlight
Available for: macOS Sonoma
Impact: An app may be able to leak sensitive user information
Description: This issue was addressed through improved state management.
CVE-2024-23241

Storage Services
Available for: macOS Sonoma
Impact: A user may gain access to protected parts of the file system
Description: A logic issue was addressed with improved checks.
CVE-2024-23272: Mickey Jin (@patch1t)

Synapse
Available for: macOS Sonoma
Impact: An app may be able to view Mail data
Description: A privacy issue was addressed by not logging contents of
text fields.
CVE-2024-23242

System Settings
Available for: macOS Sonoma
Impact: An app may be able to access sensitive user data
Description: This issue was addressed with improved state management.
CVE-2024-23281: Joshua Jewett (@JoshJewett33)

TV App
Available for: macOS Sonoma
Impact: An app may be able to access user-sensitive data
Description: This issue was addressed by removing additional
entitlements.
CVE-2024-23260: Joshua Jewett (@JoshJewett33)

UIKit
Available for: macOS Sonoma
Impact: An app may be able to break out of its sandbox
Description: This issue was addressed by removing the vulnerable code.
CVE-2024-23246: Deutsche Telekom Security GmbH sponsored by Bundesamt
f√ºr Sicherheit in der Informationstechnik

WebKit
Available for: macOS Sonoma
Impact: Processing web content may lead to arbitrary code execution
Description: The issue was addressed with improved memory handling.
WebKit Bugzilla: 259694
CVE-2024-23226: Pwn2car

WebKit
Available for: macOS Sonoma
Impact: Processing web content may lead to a denial-of-service
Description: The issue was addressed with improved memory handling.
WebKit Bugzilla: 263758
CVE-2024-23252: anbu1024 of SecANT

WebKit
Available for: macOS Sonoma
Impact: A malicious website may exfiltrate audio data cross-origin
Description: The issue was addressed with improved UI handling.
WebKit Bugzilla: 263795
CVE-2024-23254: James Lee (@Windowsrcer)

WebKit
Available for: macOS Sonoma
Impact: Processing maliciously crafted web content may prevent Content
Security Policy from being enforced
Description: A logic issue was addressed with improved validation.
WebKit Bugzilla: 264811
CVE-2024-23263: Johan Carlsson (joaxcar)

WebKit
Available for: macOS Sonoma
Impact: A maliciously crafted webpage may be able to fingerprint the
user
Description: An injection issue was addressed with improved validation.
WebKit Bugzilla: 266703
CVE-2024-23280: an anonymous researcher

WebKit
Available for: macOS Sonoma
Impact: Processing maliciously crafted web content may prevent Content
Security Policy from being enforced
Description: A logic issue was addressed with improved state management.
WebKit Bugzilla: 267241
CVE-2024-23284: Georg Felber and Marco Squarcina

Additional recognition

AppKit
We would like to acknowledge Stephan Casas for their assistance.

CoreAnimation
We would like to acknowledge Junsung Lee for their assistance.

CoreMotion
We would like to acknowledge Eric Dorphy of Twin Cities App Dev LLC for
their assistance.

Endpoint Security
We would like to acknowledge Matthew White for their assistance.

Find My
We would like to acknowledge Meng Zhang (È≤∏ËêΩ) of NorthSea for their
assistance.

Kernel
We would like to acknowledge Tarek Joumaa (@tjkr0wn) and Ïù¥Ï§ÄÏÑ±(Junsung
Lee) for their assistance.

libarchive
We would like to acknowledge koocola for their assistance.

libxml2
We would like to acknowledge OSS-Fuzz, and Ned Williamson of Google
Project Zero for their assistance.

libxpc
We would like to acknowledge Rasmus Sten, F-Secure (Mastodon:
@pajp () blog dll nu), and an anonymous researcher for their assistance.

Model I/O
We would like to acknowledge Junsung Lee for their assistance.

Photos
We would like to acknowledge Abhay Kailasia (@abhay_kailasia) of Lakshmi
Narain College Of Technology Bhopal for their assistance.

Power Management
We would like to acknowledge Pan ZhenPeng (@Peterpan0927) of STAR Labs
SG Pte. Ltd. for their assistance.

Safari
We would like to acknowledge Abhinav Saraswat, Matthew C, and Ïù¥ÎèôÌïò (Lee
Dong Ha of ZeroPointer Lab) for their assistance.

SharedFileList
We would like to acknowledge Phil Schneider of Canva for their
assistance.

Siri
We would like to acknowledge Bistrit Dahal for their assistance.

Storage Driver
We would like to acknowledge Liang Wei of PixiePoint Security for their
assistance.

SystemMigration
We would like to acknowledge Eugene Gershnik for their assistance.

TCC
We would like to acknowledge Mickey Jin (@patch1t) for their assistance.

WebKit
We would like to acknowledge Nan Wang (@eternalsakura13) of 360
Vulnerability Research Institute, Valentino Dalla Valle, Pedro Bernardo,
Marco Squarcina, and Lorenzo Veronese of TU Wien for their assistance.

macOS Sonoma 14.4 may be obtained from the Mac App Store or Apple's
Software Downloads web site: <https://support.apple.com/downloads/>
All information is also posted on the Apple Security Releases
web site: <https://support.apple.com/en-us/HT201222>.

This message is signed with Apple's Product Security PGP key,
and details are available at:
<https://www.apple.com/support/security/pgp/>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEsz9altA7uTI+rE/qX+5d1TXaIvoFAmXqcXAACgkQX+5d1TXa
IvpeHg/9EJ6w/Qpy5iPL/p+w/QhBOErWjzSmr0jAQbnQvL/HLJw43IG2Ty+UyjKD
HX4noLOuq3ik88VWgJiGYjPUXim9z74zwTH/zvkvJ9kU0gHIYY6yWLOoI9axFVt1
m2aGAj3+4/z2QR5/2M7oT0Tdqyf2v5+cnRqAnjh8I5C4dEkjQpWeNbFi4a5e/HFp
zppjrow2wiZkwpeiueN5BVNy6rePKCInJqWQ4V5jFFcEi/kZROYTt39BZt9KyAhJ
5TA3HTvn+/HVuDqxOpubB+ryhk75PB5Lha7KdLu0jRGLgggye18MZWcp0Pc5NnQG
cHfomN8y87dV8wlo/GZZ21/flDUFY441uB6bc79+WeR5wZu6Tvr2fhIN5FAFXUtm
EevVhnmEeeraTo+aBoG3cak8vUrm+/PP3no3KkSrQoxxAd/dNuPzwRTax8uRzQBA
OiT5SJep9qGKXFn/4TcJNI1zwgV1ynjksVyIxANEulhew697+C3jgpoA2VoHtwpI
mWz4Dhib7EcPZ+Kbf4Pl4BlConQhKJnJb0LYTyshgu79g2xup7/ejVPYqLTv4HzB
ocFr6I8vRLt0Y7qzUMPrqH1RikIOLPGbEH5weTgRnIioCcRj8hWkM+0gt3MrKYSC
uuUX/u54sR/5c8H5Rv/j/S0kPvEmDGri73i3G8n7qI1ceqiI7Xw=
=cGUh
-----END PGP SIGNATURE-----

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](20)
[By Date](date.html#21)
[![Next](/images/right-icon-16x16.png)](22)

[![Previous](/images/left-icon-16x16.png)](20)
[By Thread](index.html#21)
[![Next](/images/right-icon-16x16.png)](22)

### Current thread:

* **APPLE-SA-03-07-2024-2 macOS Sonoma 14.4** *Apple Product Security via Fulldisclosure (Mar 13)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from security.netapp.com_9c873c82_20250114_230222.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
√¶¬ó¬•√¶¬ú¬¨√®¬™¬û

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [January 2024 OpenSSH Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20240105-0005)

## January 2024 OpenSSH Vulnerabilities in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close √ó

#### Subscribe to NTAP-20240105-0005 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240105-0005 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close √ó

#### Unsubscribe from NTAP-20240105-0005 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240105-0005 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240105-0005
**Version:**
23.0

**Last updated:**
11/22/2024

**Status:**
Interim.

**CVEs:** CVE-2023-51384, CVE-2023-51385

Overview
#### Summary

Multiple NetApp products incorporate OpenSSH. OpenSSH versions prior to 9.6 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information or addition or modification of data.

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information or addition or modification of data.

E-Series SANtricity OS Controller Software 11.x:

Affected only by CVE-2023-51385.

Active IQ Unified Manager for VMware vSphere

Affected only by CVE-2023-51385.

ONTAP 9 (formerly Clustered Data ONTAP):

Affected by only CVE-2023-51385.

ONTAP Select Deploy administration utility:

Affected only by CVE-2023-51385 in versions 9.12.1 and 9.13.1.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2023-51384](https://nvd.nist.gov/vuln/detail/CVE-2023-51384) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N |
| [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385) | 6.5 (MEDIUM) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://www.openssh.com/txt/release-9.6>

Affected Products
#### Affected Products

* AFF Baseboard Management Controller (BMC) - A700s
* Active IQ Unified Manager for VMware vSphere
* Brocade Fabric Operating System Firmware
* E-Series SANtricity OS Controller Software 11.x
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* ONTAP 9
* ONTAP Select Deploy administration utility

#### Products Under Investigation

* NetApp HCI Compute Node (Bootstrap OS)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* ONTAP tools for VMware vSphere 10

#### Products Not Affected

* AFF BIOS - A700s
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade SAN Navigator (SANnav)
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x
* Terraform Provider for ONTAP

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **Brocade Fabric Operating System Firmware** | Fixed in Brocade Fabric Operating System Firmware v9.2.2. |
| **E-Series SANtricity OS Controller Software 11.x** | <https://mysupport.netapp.com/site/products/all/details/eseries-santricityos/downloads-tab/download/62735/11.80.1GA> |
| **FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400** | <https://mysupport.netapp.com/site/downloads/firmware/system-firmware-diagnostics/download/SYSTEM/30804196_ontap/BMC_FW_308-04196_13.11.zip> |
| **FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250** | <https://mysupport.netapp.com/site/downloads/firmware/system-firmware-diagnostics/download/SYSTEM/30804197_ontap/BMC_FW_308-04197_15.12.zip> |
| **ONTAP 9** | <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.9.1P20> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.10.1P19> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.11.1P16> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.12.1P12> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.13.1P9> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.14.1P2> |
| **ONTAP Select Deploy administration utility** | <https://mysupport.netapp.com/site/products/all/details/ontapselect-deploy/downloads-tab/download/62910/9.14.1> |

#### Workarounds

E-Series SANtricity OS Controller Software 11.x:

Disable remote login if enabled. It is disabled by default.

https://docs.netapp.com/us-en/e-series-santricity/sm-hardware/allow-remote-login.html

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240105-0005>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240105 | Initial Public Release |
| 2.0 | 20240109 | E-Series SANtricity OS Controller Software 11.x added to Workarounds and Impact |
| 3.0 | 20240116 | Element .NET SDK, Element JAVA SDK, Element Powershell Tools, Element Python SDK, StorageGRID (formerly StorageGRID Webscale), and StorageGRID Baseboard Management Controller (BMC) moved to Products Not Affected and ONTAP Select Deploy administration utility moved to Affected Products |
| 4.0 | 20240124 | Active IQ Unified Manager for VMware vSphere and ONTAP 9 (formerly Clustered Data ONTAP) moved to Affected Products and Astra Control Center, FAS/AFF Baseboard Management Controller (BMC) - A320, FAS/AFF Baseboard Management Controller (BMC) - A800/C800, FAS/AFF Baseboard Management Controller (BMC) - A900/9500, FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750, FAS/AFF Baseboard Management Controller (BMC) - FAS2820, FAS/AFF Service Processor - A300/8200/A200/2650/2620, FAS/AFF Service Processor - A700/9000, and ONTAP tools for VMware vSphere 9 moved to Products Not Affected |
| 5.0 | 20240206 | FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250 moved to Affected Products |
| 6.0 | 20240307 | SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine moved to Products Not Affected |
| 7.0 | 20240415 | FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400 moved to Affected Products |
| 8.0 | 20240416 | ONTAP 9.14.1P2 (formerly Clustered Data ONTAP) added to Software Versions and Fixes |
| 9.0 | 20240425 | ONTAP 9.12.1P12 (formerly Clustered Data ONTAP) added to Software Versions and Fixes |
| 10.0 | 20240508 | ONTAP 9.13.1P9 (formerly Clustered Data ONTAP) added to Software Versions and Fixes |
| 11.0 | 20240621 | ONTAP 9.11.1P16 (formerly Clustered Data ONTAP) added to Software Versions and Fixes |
| 12.0 | 20240626 | ONTAP 9 (formerly Clustered Data ONTAP) Fix details added. |
| 13.0 | 20240701 | ONTAP 9.9.1P20 (formerly Clustered Data ONTAP) added to Software Versions and Fixes |
| 14.0 | 20240719 | Corrected E-Series SANtricity OS Controller Software 11.x fix link |
| 15.0 | 20240807 | Brocade Fabric Operating System Firmware moved to Affected Products |
| 16.0 | 20240814 | ONTAP 9.10.1P19 (formerly Clustered Data ONTAP) added to Software Versions and Fixes |
| 17.0 | 20240930 | FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400 moved to Affected Products |
| 18.0 | 20241003 | After additional review ONTAP 9 (formerly Clustered Data ONTAP) is not Affected by CVE-2023-51384 - added to Impact, FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250 moved to Affected Products |
| 19.0 | 20241022 | AFF Baseboard Management Controller (BMC) - A700s moved to Affected Products |
| 20.0 | 20241101 | ONTAP Select Deploy administration utility added to Impact and Software Versions and Fixes |
| 21.0 | 20241105 | FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250 added to Software Versions and Fixes |
| 22.0 | 20241114 | FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400 added to Software Versions and Fixes |
| 23.0 | 20241122 | Brocade Fabric Operating System Firmware added to Software Versions and Fixes |

This document is provided solely for informational purposes. All information is based upon NetApp√¢¬Ä¬ôs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. √Ç¬© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ¬©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)


