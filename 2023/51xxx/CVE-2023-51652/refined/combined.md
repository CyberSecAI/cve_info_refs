=== Content from github.com_7cd7b8e1_20250114_192937.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspassarop%2Fantisamy-dotnet%2Fsecurity%2Fadvisories%2FGHSA-8x6f-956f-q43w)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspassarop%2Fantisamy-dotnet%2Fsecurity%2Fadvisories%2FGHSA-8x6f-956f-q43w)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=spassarop%2Fantisamy-dotnet)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[spassarop](/spassarop)
/
**[antisamy-dotnet](/spassarop/antisamy-dotnet)**
Public

* [Notifications](/login?return_to=%2Fspassarop%2Fantisamy-dotnet) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fspassarop%2Fantisamy-dotnet)
* [Star
   3](/login?return_to=%2Fspassarop%2Fantisamy-dotnet)

* [Code](/spassarop/antisamy-dotnet)
* [Issues
  0](/spassarop/antisamy-dotnet/issues)
* [Pull requests
  0](/spassarop/antisamy-dotnet/pulls)
* [Actions](/spassarop/antisamy-dotnet/actions)
* [Wiki](/spassarop/antisamy-dotnet/wiki)
* [Security](/spassarop/antisamy-dotnet/security)
* [Insights](/spassarop/antisamy-dotnet/pulse)

Additional navigation options

* [Code](/spassarop/antisamy-dotnet)
* [Issues](/spassarop/antisamy-dotnet/issues)
* [Pull requests](/spassarop/antisamy-dotnet/pulls)
* [Actions](/spassarop/antisamy-dotnet/actions)
* [Wiki](/spassarop/antisamy-dotnet/wiki)
* [Security](/spassarop/antisamy-dotnet/security)
* [Insights](/spassarop/antisamy-dotnet/pulse)

# mXSS when preserving comments

Moderate

[spassarop](/spassarop)
published
GHSA-8x6f-956f-q43w
Jan 2, 2024

## Package

nuget

OWASP.AntiSamy
([NuGet](/advisories?query=ecosystem%3Anuget))

## Affected versions

< 1.2.0

## Patched versions

1.2.0

## Description

# Impact

There is a potential for a mutation XSS (mXSS) vulnerability in AntiSamy caused by flawed parsing of the HTML being sanitized. To be subject to this vulnerability the `preserveComments` directive must be enabled in your policy file and also allow for certain tags at the same time. As a result, certain crafty inputs can result in elements in comment tags being interpreted as executable when using AntiSamy's sanitized output.

# Patches

Patched in OWASP AntiSamy .NET 1.2.0 and later. See important remediation details in the reference given below.

# Workarounds

If you cannot upgrade to a fixed version of the library, the following mitigation can be applied until you can upgrade: Manually edit your AntiSamy policy file (e.g., antisamy.xml) by deleting the `preserveComments` directive or setting its value to `false`, if present. Also it would be useful to make AntiSamy remove the `noscript` tag by adding this in your tag definitions under the `<tagrules>` node (or deleting it entirely if present):

```
<tag name="noscript" action="remove"/>
```

As the previously mentioned policy settings are preconditions for the mXSS attack to work, changing them as recommended should be sufficient to protect you against this vulnerability when using a vulnerable version of this library. However, the existing bug would still be present in AntiSamy or its parser dependency (HtmlAgilityPack). The safety of this workaround relies on configurations that may change in the future and don't address the root cause of the vulnerability. As such, it is strongly recommended to upgrade to a fixed version of AntiSamy.

# For more information

If you have any questions or comments about this advisory:

Email one of the project co-leaders, listed on the [OWASP AntiSamy project](https://owasp.org/www-project-antisamy/) page, under "Leaders".

### Severity

Moderate

6.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
Low

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

### CVE ID

CVE-2023-51652

### Weaknesses

No CWEs

### Credits

* [![@leeN](https://avatars.githubusercontent.com/u/49810?s=40&v=4)](/leeN)
  [leeN](/leeN)
  Reporter
* [![@spassarop](https://avatars.githubusercontent.com/u/30912689?s=40&v=4)](/spassarop)
  [spassarop](/spassarop)
  Remediation developer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_68d3631c_20250114_192936.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspassarop%2Fantisamy-dotnet%2Fcommit%2F8117911933e75a25cd0054ef017577486338444a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspassarop%2Fantisamy-dotnet%2Fcommit%2F8117911933e75a25cd0054ef017577486338444a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=spassarop%2Fantisamy-dotnet)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[spassarop](/spassarop)
/
**[antisamy-dotnet](/spassarop/antisamy-dotnet)**
Public

* [Notifications](/login?return_to=%2Fspassarop%2Fantisamy-dotnet) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fspassarop%2Fantisamy-dotnet)
* [Star
   3](/login?return_to=%2Fspassarop%2Fantisamy-dotnet)

* [Code](/spassarop/antisamy-dotnet)
* [Issues
  0](/spassarop/antisamy-dotnet/issues)
* [Pull requests
  0](/spassarop/antisamy-dotnet/pulls)
* [Actions](/spassarop/antisamy-dotnet/actions)
* [Wiki](/spassarop/antisamy-dotnet/wiki)
* [Security](/spassarop/antisamy-dotnet/security)
* [Insights](/spassarop/antisamy-dotnet/pulse)

Additional navigation options

* [Code](/spassarop/antisamy-dotnet)
* [Issues](/spassarop/antisamy-dotnet/issues)
* [Pull requests](/spassarop/antisamy-dotnet/pulls)
* [Actions](/spassarop/antisamy-dotnet/actions)
* [Wiki](/spassarop/antisamy-dotnet/wiki)
* [Security](/spassarop/antisamy-dotnet/security)
* [Insights](/spassarop/antisamy-dotnet/pulse)

## Commit

[Permalink](/spassarop/antisamy-dotnet/commit/8117911933e75a25cd0054ef017577486338444a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#12](https://github.com/spassarop/antisamy-dotnet/pull/12) from spassarop/develop

[Browse files](/spassarop/antisamy-dotnet/tree/8117911933e75a25cd0054ef017577486338444a)
Browse the repository at this point in the history

```
Changes for v1.2.0
```

* Loading branch information

[![@spassarop](https://avatars.githubusercontent.com/u/30912689?s=40&v=4)](/spassarop)

[spassarop](/spassarop/antisamy-dotnet/commits?author=spassarop "View all commits by spassarop")
authored
Dec 21, 2023

2 parents
[550e9b7](/spassarop/antisamy-dotnet/commit/550e9b7dd10bdd87be430e8b6c5c208d04ae55ce)
+
[c166525](/spassarop/antisamy-dotnet/commit/c166525d1ad780b02fb4e42f4b8ec471f2acaf3d)

commit 8117911

 Show file tree

 Hide file tree

Showing
**42 changed files**
with
**156 additions**
and
**86 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .github/workflows

  + .github/workflows/codeql-analysis.yml
    [codeql-analysis.yml](#diff-63bd641104d10e25f141d518a16b22a151d125e12701df2f9e79734b23b90188)
  + .github/workflows/netcore\_and\_netframework.yml
    [netcore\_and\_netframework.yml](#diff-4c0c83d51ba439e67faf89bd8dafdfb299e00ee2259431602030afd4ba5c7959)
* LICENSE
  [LICENSE](#diff-c693279643b8cd5d248172d9c22cb7cf4ed163a3c98c8a3f69c2717edd3eacb7)
* OWASP.AntiSamy

  + AntiSamyPolicyExamples

    - OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy-anythinggoes.xml
      [antisamy-anythinggoes.xml](#diff-c04a5d3de33905f26f12ce03794cc41080cbb27feb4836766357909f21e37102)
    - OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy-ebay.xml
      [antisamy-ebay.xml](#diff-64124e86f88df2620b280f65c4e85fc8d9f45062a4645f2a15d3f3b60e7761a1)
    - OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy-myspace.xml
      [antisamy-myspace.xml](#diff-3838403fc69d8fcfd400eed842395e9a3d353bac46ad7012f0e725fac4760a45)
    - OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy.xml
      [antisamy.xml](#diff-a964d5175fdbdc819eb26ea10057701705b9a824592a525a28f9c71d791e19f4)
  + Css

    - OWASP.AntiSamy/Css/CssScanner.cs
      [CssScanner.cs](#diff-ced236296e056778774bab0309f4249238b916fd831c80e51dfb9b56bb829c93)
  + Exceptions

    - OWASP.AntiSamy/Exceptions/ParseException.cs
      [ParseException.cs](#diff-2102e2785b459cb611c21bb251f7f12b873223b033c3aa89029328af4fa5b4f5)
    - OWASP.AntiSamy/Exceptions/PolicyException.cs
      [PolicyException.cs](#diff-a85dfa4b7407da627a7d9768307b70ac03438dae63113dc317c560e352276230)
    - OWASP.AntiSamy/Exceptions/ScanException.cs
      [ScanException.cs](#diff-2d761e7a444af9337f3b6f1d9944d90ecb3a2b7f34f465af4d722fb1003a2ac3)
    - OWASP.AntiSamy/Exceptions/UnknownSelectorException.cs
      [UnknownSelectorException.cs](#diff-a0a6202c5be374060669e075d5a4ffdaf69fbc02de70f86693757316aec2cbae)
  + Html

    - OWASP.AntiSamy/Html/AntiSamy.cs
      [AntiSamy.cs](#diff-303bee8c187fbc0c1ab6eb3dc71009ab240da8c517b9d28d8ff3d082747b883f)
    - OWASP.AntiSamy/Html/CleanResults.cs
      [CleanResults.cs](#diff-671b6ba0cdfaba39fbf73284271bca1dc57b857cbacf40ec4b4c12b73620bf2e)
    - OWASP.AntiSamy/Html/InternalPolicy.cs
      [InternalPolicy.cs](#diff-725497f99a23f304ad952d84103c6866668344733a22f679c97375f67e1f8250)
    - Model

      * OWASP.AntiSamy/Html/Model/AntiSamyPattern.cs
        [AntiSamyPattern.cs](#diff-7a6d39483c0901fc9c33076b8e91e24d01a3bb0a303089e143a24da991dcc123)
      * OWASP.AntiSamy/Html/Model/Attribute.cs
        [Attribute.cs](#diff-ee53f394fdb422cdb93f7873e835c293ed416788266be842b6338f6280c53581)
      * OWASP.AntiSamy/Html/Model/Property.cs
        [Property.cs](#diff-4433a2f18a16c570e4b06970c34c3409ff38f0818152ff4bbc116cf27f584c92)
      * OWASP.AntiSamy/Html/Model/Tag.cs
        [Tag.cs](#diff-8f761bf7e4c96ca402692fdf8e5d2e95dea53cd0b097c850e7f4e1baeb2b6463)
    - OWASP.AntiSamy/Html/ParseContext.cs
      [ParseContext.cs](#diff-919940330d0b1ef3a578c338a36a4dc248e1e99eb2314b82da45029e7c576bd4)
    - OWASP.AntiSamy/Html/Policy.cs
      [Policy.cs](#diff-a6bb1a459bde1fe57421988658e0f0050464b16dfc2ad456b0373ed323daf3ed)
    - Scan

      * OWASP.AntiSamy/Html/Scan/AntiSamyDomScanner.cs
        [AntiSamyDomScanner.cs](#diff-502073fa459244fa752c711b0586f70c9e017975b3062e6f29c57c9f943b64e3)
      * OWASP.AntiSamy/Html/Scan/Constants.cs
        [Constants.cs](#diff-471f2dabbe950bc63f45faa96b3d70f5271a8583228698e45af123e32e33434e)
    - OWASP.AntiSamy/Html/TagMatcher.cs
      [TagMatcher.cs](#diff-dea463d21ed3a023af685179d2bcf15a0cf86c29a99ff14f51adfc6aaf4c6187)
    - Util

      * OWASP.AntiSamy/Html/Util/DictionaryExtensions.cs
        [DictionaryExtensions.cs](#diff-90a3986b4a46818251ab42eee104a46e6a2231de3961d5e4070b8be559f1a03f)
      * OWASP.AntiSamy/Html/Util/ErrorMessageUtil.cs
        [ErrorMessageUtil.cs](#diff-9f6d7c54e40ccbea1a64b32ea2c39b2ff1866e0a640704298994debbd44e8636)
      * OWASP.AntiSamy/Html/Util/HtmlEntityEncoder.cs
        [HtmlEntityEncoder.cs](#diff-a1cfe609b22cb9da3b4e26d6d79d96fa5fc32681cbe801613528d9e40de68e21)
      * OWASP.AntiSamy/Html/Util/PolicyParserUtil.cs
        [PolicyParserUtil.cs](#diff-e4dc5c7e5a4ed46c03e8d540d57919ef8c6e8f88c17a59fd2239bab368f4d128)
      * OWASP.AntiSamy/Html/Util/SpecialCharactersEncoder.cs
        [SpecialCharactersEncoder.cs](#diff-3b0e6740446f2c8ac99ed8644922dcc5f26f27ec0024899b8405badf79825a20)
      * OWASP.AntiSamy/Html/Util/XmlUtil.cs
        [XmlUtil.cs](#diff-9293e07a68bda7a050429e5655e1d1683830b81416b922eefdb76b2fd2ef2fba)
  + OWASP.AntiSamy/OWASP.AntiSamy.csproj
    [OWASP.AntiSamy.csproj](#diff-dd1fceeb01bed3e8148677a0b41e829d0b175dbcbce8222487a4f59d819bad46)
  + Properties

    - OWASP.AntiSamy/Properties/AssemblyInfo.cs
      [AssemblyInfo.cs](#diff-59506c8b80484cc3e0a7f1a581b040a1952a269d31ad97d353a249b2f5bd84f4)
* OWASP.AntiSamyTests

  + Html

    - OWASP.AntiSamyTests/Html/AntiSamyTest.cs
      [AntiSamyTest.cs](#diff-cc358aca2b9535c27890dc1a9aef479b424314fdd5b17b0bfefbb86c5d256729)
    - OWASP.AntiSamyTests/Html/LiteralTest.cs
      [LiteralTest.cs](#diff-a7e3c690a3c02512e1ce507370f7fd305c34084fa7f06b98a131c212ac63ef80)
    - OWASP.AntiSamyTests/Html/LocalizationTest.cs
      [LocalizationTest.cs](#diff-99ea2b51fc3a2d235b41a8a54c7fe881a3ae88515a5ec514815652d46b4d662b)
    - Model

      * OWASP.AntiSamyTests/Html/Model/TagTest.cs
        [TagTest.cs](#diff-da22b3e06e48353af2f30ce8cd8b3f6e6d22cebfd2340bfb4f78a21bc1256d03)
    - OWASP.AntiSamyTests/Html/PolicyTest.cs
      [PolicyTest.cs](#diff-088e640657059dbba8acaeb01b26445e6667ae17091a9420e2e36d73eaf9d605)
    - OWASP.AntiSamyTests/Html/TagMatcherTest.cs
      [TagMatcherTest.cs](#diff-b7c9ad26a4b3a7233fec55160e64473083364ccb5bf804d716fdd8133078207c)
  + OWASP.AntiSamyTests/OWASP.AntiSamyTests.csproj
    [OWASP.AntiSamyTests.csproj](#diff-1becece8e90d294cef93ef5b32daf6dc34d37b2510a7e221269d19bab18e54db)
  + OWASP.AntiSamyTests/TestConstants.cs
    [TestConstants.cs](#diff-4bebf6e5ce5d8e18e69f7f996915c92f832cc1313fd3d296881b0368d768837a)
  + OWASP.AntiSamyTests/TestPolicy.cs
    [TestPolicy.cs](#diff-9a1d0c5a26ffd8308d412478fee06c771714e5d15ab51d06175c2e563ce249fe)
* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)

## There are no files selected for viewing

17 changes: 6 additions & 11 deletions

17
[.github/workflows/codeql-analysis.yml](#diff-63bd641104d10e25f141d518a16b22a151d125e12701df2f9e79734b23b90188 ".github/workflows/codeql-analysis.yml")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/.github/workflows/codeql-analysis.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -57,7 +57,7 @@ jobs: |
|  |  |  |
|  |  | # Initializes the CodeQL tools for scanning. |
|  |  | - name: Initialize CodeQL |
|  |  | uses: github/codeql-action/init@v1 |
|  |  | uses: github/codeql-action/init@v2 |
|  |  | with: |
|  |  | languages: ${{ matrix.language }} |
|  |  | # If you wish to specify custom queries, you can do so here or in a config file. |
| Expand All | | @@ -66,21 +66,16 @@ jobs: |
|  |  | # queries: ./path/to/local/query, your-org/your-repo/queries@main |
|  |  |  |
|  |  | # This prevents errors when automatically installing SDK. |
|  |  | # CodeQL does not install .NET 5.0 nor 6.0. |
|  |  | - name: Setup .NET 5.0 SDK+Runtime |
|  |  | # CodeQL does not install .NET 8.0. |
|  |  | - name: Setup .NET 8.0 SDK+Runtime |
|  |  | uses: actions/setup-dotnet@v1.7.2 |
|  |  | with: |
|  |  | dotnet-version: 5.0.404 |
|  |  |  |
|  |  | - name: Setup .NET 6.0 SDK+Runtime |
|  |  | uses: actions/setup-dotnet@v1.7.2 |
|  |  | with: |
|  |  | dotnet-version: 6.0.101 |
|  |  | dotnet-version: 8.0.100 |
|  |  |  |
|  |  | # Autobuild attempts to build any compiled languages (C/C++, C#, or Java). |
|  |  | # If this step fails, then you should remove it and run the build manually (see below) |
|  |  | - name: Autobuild |
|  |  | uses: github/codeql-action/autobuild@v1 |
|  |  | uses: github/codeql-action/autobuild@v2 |
|  |  |  |
|  |  | # ℹ️ Command-line programs to run using the OS shell. |
|  |  | # 📚 https://git.io/JvXDl |
| Expand All | | @@ -94,4 +89,4 @@ jobs: |
|  |  | # make release |
|  |  |  |
|  |  | - name: Perform CodeQL Analysis |
|  |  | uses: github/codeql-action/analyze@v1 |
|  |  | uses: github/codeql-action/analyze@v2 |

14 changes: 2 additions & 12 deletions

14
[.github/workflows/netcore\_and\_netframework.yml](#diff-4c0c83d51ba439e67faf89bd8dafdfb299e00ee2259431602030afd4ba5c7959 ".github/workflows/netcore_and_netframework.yml")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/.github/workflows/netcore_and_netframework.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -40,20 +40,10 @@ jobs: |
|  |  | # Checks-out your repository under $GITHUB\_WORKSPACE, so your job can access it |
|  |  | - uses: actions/checkout@v2 |
|  |  |  |
|  |  | - name: Setup .NET Core SDK+Runtime |
|  |  | - name: Setup .NET 8.0 SDK+Runtime |
|  |  | uses: actions/setup-dotnet@v1.7.2 |
|  |  | with: |
|  |  | dotnet-version: 3.1.x |
|  |  |  |
|  |  | - name: Setup .NET 5.0 SDK+Runtime |
|  |  | uses: actions/setup-dotnet@v1.7.2 |
|  |  | with: |
|  |  | dotnet-version: 5.0.404 |
|  |  |  |
|  |  | - name: Setup .NET 6.0 SDK+Runtime |
|  |  | uses: actions/setup-dotnet@v1.7.2 |
|  |  | with: |
|  |  | dotnet-version: 6.0.101 |
|  |  | dotnet-version: 8.0.100 |
|  |  |  |
|  |  | - name: Setup MSBuild for .NET Framework |
|  |  | uses: microsoft/setup-msbuild@v1 |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[LICENSE](#diff-c693279643b8cd5d248172d9c22cb7cf4ed163a3c98c8a3f69c2717edd3eacb7 "LICENSE")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/LICENSE)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,6 +1,6 @@ |
|  |  | BSD 3-Clause License |
|  |  |  |
|  |  | Copyright (c) 2022, spassarop |
|  |  | Copyright (c) 2023, spassarop |
|  |  | All rights reserved. |
|  |  |  |
|  |  | Redistribution and use in source and binary forms, with or without |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy-anythinggoes.xml](#diff-c04a5d3de33905f26f12ce03794cc41080cbb27feb4836766357909f21e37102 "OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy-anythinggoes.xml")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy-anythinggoes.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -41,7 +41,7 @@ http://www.w3.org/TR/html401/struct/global.html |
|  |  |  |
|  |  | <regexp name="anything" value=".\*"/> |
|  |  | <regexp name="numberOrPercent" value="(\d)+(%{0,1})"/> |
|  |  | <regexp name="paragraph" value="([\p{L}\p{N},'\.\s\-\_\(\)]|&amp;[0-9]{2};)\*"/> |
|  |  | <regexp name="paragraph" value="[\p{L}\p{N},'.\s\-\_\(\)&amp;;]\*"/> |
|  |  | <regexp name="htmlId" value="[a-zA-Z0-9\:\-\_\.]+"/> |
|  |  | <regexp name="htmlTitle" value="[\p{L}\p{N}\s\-\_',:\[\]!\./\\\(\)&amp;]\*"/> <!-- force non-empty with a '+' at the end instead of '\*' --> |
|  |  | <regexp name="htmlClass" value="[a-zA-Z0-9\s,\-\_]+"/> |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy-ebay.xml](#diff-64124e86f88df2620b280f65c4e85fc8d9f45062a4645f2a15d3f3b60e7761a1 "OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy-ebay.xml")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy-ebay.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -39,7 +39,7 @@ http://www.w3.org/TR/html401/struct/global.html |
|  |  |  |
|  |  | <regexp name="anything" value=".\*"/> |
|  |  | <regexp name="numberOrPercent" value="(\d)+(%{0,1})"/> |
|  |  | <regexp name="paragraph" value="([\p{L}\p{N},'\.\s\-\_\(\)]|&amp;[0-9]{2};)\*"/> |
|  |  | <regexp name="paragraph" value="[\p{L}\p{N},'.\s\-\_\(\)&amp;;]\*"/> |
|  |  | <regexp name="htmlId" value="[a-zA-Z0-9\:\-\_\.]+"/> |
|  |  | <regexp name="htmlTitle" value="[\p{L}\p{N}\s\-\_',:\[\]!\./\\\(\)&amp;]\*"/> <!-- force non-empty with a '+' at the end instead of '\*' --> |
|  |  | <regexp name="htmlClass" value="[a-zA-Z0-9\s,\-\_]+"/> |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy-myspace.xml](#diff-3838403fc69d8fcfd400eed842395e9a3d353bac46ad7012f0e725fac4760a45 "OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy-myspace.xml")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy-myspace.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -41,7 +41,7 @@ http://www.w3.org/TR/html401/struct/global.html |
|  |  |  |
|  |  | <regexp name="anything" value=".\*"/> |
|  |  | <regexp name="numberOrPercent" value="(\d)+(%{0,1})"/> |
|  |  | <regexp name="paragraph" value="([\p{L}\p{N},'\.\s\-\_\(\)]|&amp;[0-9]{2};)\*"/> |
|  |  | <regexp name="paragraph" value="[\p{L}\p{N},'.\s\-\_\(\)&amp;;]\*"/> |
|  |  | <regexp name="htmlId" value="[a-zA-Z0-9\:\-\_\.]+"/> |
|  |  | <regexp name="htmlTitle" value="[\p{L}\p{N}\s\-\_',:\[\]!\./\\\(\)&amp;]\*"/> <!-- force non-empty with a '+' at the end instead of '\*' --> |
|  |  | <regexp name="htmlClass" value="[a-zA-Z0-9\s,\-\_]+"/> |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy.xml](#diff-a964d5175fdbdc819eb26ea10057701705b9a824592a525a28f9c71d791e19f4 "OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy.xml")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/AntiSamyPolicyExamples/antisamy.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -44,7 +44,7 @@ http://www.w3.org/TR/html401/struct/global.html |
|  |  |  |
|  |  | <regexp name="anything" value=".\*"/> |
|  |  | <regexp name="numberOrPercent" value="(\d)+(%{0,1})"/> |
|  |  | <regexp name="paragraph" value="([\p{L}\p{N},'\.\s\-\_\(\)]|&amp;[0-9]{2};)\*"/> |
|  |  | <regexp name="paragraph" value="[\p{L}\p{N},'.\s\-\_\(\)&amp;;]\*"/> |
|  |  | <regexp name="htmlId" value="[a-zA-Z0-9\:\-\_\.]+"/> |
|  |  | <regexp name="htmlTitle" value="[\p{L}\p{N}\s\-\_',:\[\]!\./\\\(\)&amp;]\*"/> |
|  |  | <!-- force non-empty with a '+' at the end instead of '\*' --> |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Css/CssScanner.cs](#diff-ced236296e056778774bab0309f4249238b916fd831c80e51dfb9b56bb829c93 "OWASP.AntiSamy/Css/CssScanner.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Css/CssScanner.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2022, Jerry Hoff, Caner Patir, Sebastián Passaro |
|  |  | \* Copyright (c) 2023, Jerry Hoff, Caner Patir, Sebastián Passaro |
|  |  | \* |
|  |  | \* |
|  |  | \* All rights reserved. |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Exceptions/ParseException.cs](#diff-2102e2785b459cb611c21bb251f7f12b873223b033c3aa89029328af4fa5b4f5 "OWASP.AntiSamy/Exceptions/ParseException.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Exceptions/ParseException.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2022, Caner Patir, Sebastián Passaro |
|  |  | \* Copyright (c) 2023, Caner Patir, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Exceptions/PolicyException.cs](#diff-a85dfa4b7407da627a7d9768307b70ac03438dae63113dc317c560e352276230 "OWASP.AntiSamy/Exceptions/PolicyException.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Exceptions/PolicyException.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Exceptions/ScanException.cs](#diff-2d761e7a444af9337f3b6f1d9944d90ecb3a2b7f34f465af4d722fb1003a2ac3 "OWASP.AntiSamy/Exceptions/ScanException.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Exceptions/ScanException.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Exceptions/UnknownSelectorException.cs](#diff-a0a6202c5be374060669e075d5a4ffdaf69fbc02de70f86693757316aec2cbae "OWASP.AntiSamy/Exceptions/UnknownSelectorException.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Exceptions/UnknownSelectorException.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | ﻿/\* |
|  |  | \* Copyright (c) 2009-2022, Sebastián Passaro |
|  |  | \* Copyright (c) 2009-2023, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/AntiSamy.cs](#diff-303bee8c187fbc0c1ab6eb3dc71009ab240da8c517b9d28d8ff3d082747b883f "OWASP.AntiSamy/Html/AntiSamy.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/AntiSamy.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

47 changes: 38 additions & 9 deletions

47
[OWASP.AntiSamy/Html/CleanResults.cs](#diff-671b6ba0cdfaba39fbf73284271bca1dc57b857cbacf40ec4b4c12b73620bf2e "OWASP.AntiSamy/Html/CleanResults.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/CleanResults.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down  Expand Up | | @@ -29,11 +29,31 @@ |
|  |  | namespace OWASP.AntiSamy.Html |
|  |  | { |
|  |  | /// <summary> |
|  |  | /// This class contains the results of a scan. |
|  |  | /// |
|  |  | /// The list of error messages (<see cref="GetErrorMessages"/>) will let the user know |
|  |  | /// what, if any HTML errors existed, and what, if any, security or |
|  |  | /// validation-related errors existed, and what was done about them. |
|  |  | /// This class contains the results of a scan. It primarily provides access to the clean sanitized |
|  |  | /// HTML, per the AntiSamy sanitization policy applied. It also provides access to some utility |
|  |  | /// information, like possible error messages and error message counts. |
|  |  | /// |
|  |  | /// <para>WARNING: The ONLY output from the class you can completely rely on is the CleanResults output. |
|  |  | /// As stated in the documentation, neither the <see cref="GetErrorMessages"/> nor the <see cref="GetNumberOfErrors"/> methods |
|  |  | /// subtly answer the question "is this safe input?" in the affirmative if it returns an empty list. |
|  |  | /// You must always use the sanitized 'Clean' input and there is no way to be sure the input passed in had no attacks. |
|  |  | /// </para> |
|  |  | /// |
|  |  | /// <para>The serialization and deserialization process that is critical to the effectiveness of the |
|  |  | /// sanitizer is purposefully lossy and will filter out attacks via a number of attack vectors. |
|  |  | /// Unfortunately, one of the tradeoffs of this strategy is that AntiSamy doesn't always know in |
|  |  | /// retrospect that an attack was seen. Thus, the <see cref="GetErrorMessages"/> API is there to help users |
|  |  | /// understand whether their well-intentioned input meets the requirements of the system, not help a |
|  |  | /// developer detect if an attack was present. |
|  |  | /// </para> |
|  |  | /// |
|  |  | /// <para>The list of error messages (<see cref="errorMessages"/>) will let the user know what, if any |
|  |  | /// HTML errors existed, and what, if any, security or validation-related errors were detected, and |
|  |  | /// what was done about them. NOTE: As just stated, the absence of error messages does NOT mean there |
|  |  | /// were no attacks in the input that was sanitized out. You CANNOT rely on the <see cref="errorMessages"/> to tell |
|  |  | /// you if the input was dangerous. You MUST use the output of <see cref="GetCleanHtml"/> to ensure your output |
|  |  | /// is safe. |
|  |  | /// </para> |
|  |  | /// </summary> |
|  |  | public class CleanResults |
|  |  | { |
| Expand Down  Expand Up | | @@ -74,11 +94,17 @@ public CleanResults(DateTime startOfScan, DateTime endOfScan, string cleanHTML, |
|  |  | /// <param name="cleanHtml"></param> |
|  |  | public void SetCleanHtml(string cleanHtml) => this.cleanHtml = cleanHtml; |
|  |  |  |
|  |  | /// <summary> Return the filtered HTML as a string.</summary> |
|  |  | /// <summary> |
|  |  | /// Return the filtered HTML as a string. This output is the ONLY output you can trust to be safe. |
|  |  | /// The absence of error messages does NOT indicate the input was safe. |
|  |  | /// </summary> |
|  |  | /// <returns> A string object which contains the serialized, safe HTML.</returns> |
|  |  | public string GetCleanHtml() => cleanHtml; |
|  |  |  |
|  |  | /// <summary> Return a list of error messages.</summary> |
|  |  | /// <summary> |
|  |  | /// Return a list of error messages -- but an empty list returned does not mean there was no attack |
|  |  | /// present, due to the serialization and deserialization process automatically cleaning up some attacks. |
|  |  | /// </summary> |
|  |  | /// <returns> A <see cref="List{String}"/> object which contains the error messages after a scan.</returns> |
|  |  | public List<string> GetErrorMessages() => errorMessages; |
|  |  |  |
| Expand All | | @@ -98,7 +124,10 @@ public CleanResults(DateTime startOfScan, DateTime endOfScan, string cleanHTML, |
|  |  | /// <param name="msg">An error message to append to the list of aggregate error messages during filtering.</param> |
|  |  | public void AddErrorMessage(string msg) => errorMessages.Add(msg); |
|  |  |  |
|  |  | /// <summary> Return the number of errors encountered during filtering.</summary> |
|  |  | /// <summary> |
|  |  | /// Return the number of errors encountered during filtering. Note that 0 errors does NOT |
|  |  | /// mean the input was safe. Only the output of <see cref="GetCleanHtml"/> can be considered safe. |
|  |  | /// </summary> |
|  |  | public int GetNumberOfErrors() => errorMessages.Count; |
|  |  | } |
|  |  | } |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/InternalPolicy.cs](#diff-725497f99a23f304ad952d84103c6866668344733a22f679c97375f67e1f8250 "OWASP.AntiSamy/Html/InternalPolicy.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/InternalPolicy.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Kristian Rosenvold, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Kristian Rosenvold, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/Model/AntiSamyPattern.cs](#diff-7a6d39483c0901fc9c33076b8e91e24d01a3bb0a303089e143a24da991dcc123 "OWASP.AntiSamy/Html/Model/AntiSamyPattern.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Model/AntiSamyPattern.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/Model/Attribute.cs](#diff-ee53f394fdb422cdb93f7873e835c293ed416788266be842b6338f6280c53581 "OWASP.AntiSamy/Html/Model/Attribute.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Model/Attribute.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/Model/Property.cs](#diff-4433a2f18a16c570e4b06970c34c3409ff38f0818152ff4bbc116cf27f584c92 "OWASP.AntiSamy/Html/Model/Property.cs")

Show comments

Show annotations

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Model/Property.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/Model/Tag.cs](#diff-8f761bf7e4c96ca402692fdf8e5d2e95dea53cd0b097c850e7f4e1baeb2b6463 "OWASP.AntiSamy/Html/Model/Tag.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Model/Tag.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/ParseContext.cs](#diff-919940330d0b1ef3a578c338a36a4dc248e1e99eb2314b82da45029e7c576bd4 "OWASP.AntiSamy/Html/ParseContext.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/ParseContext.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2007-2022, Arshan Dabirsiaghi, Jason Li, Kristian Rosenvold, Sebastián Passaro |
|  |  | \* Copyright (c) 2007-2023, Arshan Dabirsiaghi, Jason Li, Kristian Rosenvold, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/Policy.cs](#diff-a6bb1a459bde1fe57421988658e0f0050464b16dfc2ad456b0373ed323daf3ed "OWASP.AntiSamy/Html/Policy.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Policy.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

13 changes: 11 additions & 2 deletions

13
[OWASP.AntiSamy/Html/Scan/AntiSamyDomScanner.cs](#diff-502073fa459244fa752c711b0586f70c9e017975b3062e6f29c57c9f943b64e3 "OWASP.AntiSamy/Html/Scan/AntiSamyDomScanner.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Scan/AntiSamyDomScanner.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2009-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2009-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down  Expand Up | | @@ -136,7 +136,7 @@ public CleanResults Scan(string html) |
|  |  |  |
|  |  | // All the cleaned HTML |
|  |  | string finalCleanHTML = Policy.PreservesSpace ? htmlDocument.DocumentNode.InnerHtml : htmlDocument.DocumentNode.InnerHtml.Trim(); |
|  |  |  |
|  |  |  |
|  |  | // Encode special/international characters if stated by policy |
|  |  | if (Policy.EntityEncodesInternationalCharacters) |
|  |  | { |
| Expand Down  Expand Up | | @@ -371,6 +371,15 @@ private void ValidateTag(HtmlNode node, HtmlNode parentNode, string tagName, Tag |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \* Parse every <noscript> node content as plain text by replacing its content with its transformation. |
|  |  | \* Covers a case when preserving comments and how the underlying parser works, where a bug arises. |
|  |  | \*/ |
|  |  | if (tagName.ToLowerInvariant() == "noscript" && Policy.PreservesComments) |
|  |  | { |
|  |  | node.ParentNode.ReplaceChild(parentNode.OwnerDocument.CreateTextNode(node.InnerText), node); |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \* Go through the attributes in the tainted tag and validate them against the values we have for them. |
|  |  | \* If we don't have a rule for the attribute we remove the attribute. |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/Scan/Constants.cs](#diff-471f2dabbe950bc63f45faa96b3d70f5271a8583228698e45af123e32e33434e "OWASP.AntiSamy/Html/Scan/Constants.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Scan/Constants.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/TagMatcher.cs](#diff-dea463d21ed3a023af685179d2bcf15a0cf86c29a99ff14f51adfc6aaf4c6187 "OWASP.AntiSamy/Html/TagMatcher.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/TagMatcher.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2013-2022, Kristian Rosenvold, Sebastián Passaro |
|  |  | \* Copyright (c) 2013-2023, Kristian Rosenvold, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/Util/DictionaryExtensions.cs](#diff-90a3986b4a46818251ab42eee104a46e6a2231de3961d5e4070b8be559f1a03f "OWASP.AntiSamy/Html/Util/DictionaryExtensions.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Util/DictionaryExtensions.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2022, Sebastián Passaro |
|  |  | \* Copyright (c) 2023, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/Util/ErrorMessageUtil.cs](#diff-9f6d7c54e40ccbea1a64b32ea2c39b2ff1866e0a640704298994debbd44e8636 "OWASP.AntiSamy/Html/Util/ErrorMessageUtil.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Util/ErrorMessageUtil.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2022, Sebastián Passaro |
|  |  | \* Copyright (c) 2023, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/Util/HtmlEntityEncoder.cs](#diff-a1cfe609b22cb9da3b4e26d6d79d96fa5fc32681cbe801613528d9e40de68e21 "OWASP.AntiSamy/Html/Util/HtmlEntityEncoder.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Util/HtmlEntityEncoder.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/Util/PolicyParserUtil.cs](#diff-e4dc5c7e5a4ed46c03e8d540d57919ef8c6e8f88c17a59fd2239bab368f4d128 "OWASP.AntiSamy/Html/Util/PolicyParserUtil.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Util/PolicyParserUtil.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Arshan Dabirsiaghi, Jason Li, Kristian Rosenvold, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Arshan Dabirsiaghi, Jason Li, Kristian Rosenvold, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/Util/SpecialCharactersEncoder.cs](#diff-3b0e6740446f2c8ac99ed8644922dcc5f26f27ec0024899b8405badf79825a20 "OWASP.AntiSamy/Html/Util/SpecialCharactersEncoder.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Util/SpecialCharactersEncoder.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2022, Sebastián Passaro |
|  |  | \* Copyright (c) 2023, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[OWASP.AntiSamy/Html/Util/XmlUtil.cs](#diff-9293e07a68bda7a050429e5655e1d1683830b81416b922eefdb76b2fd2ef2fba "OWASP.AntiSamy/Html/Util/XmlUtil.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/8117911933e75a25cd0054ef017577486338444a/OWASP.AntiSamy/Html/Util/XmlUtil.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2008-2022, Jerry Hoff, Sebastián Passaro |
|  |  | \* Copyright (c) 2008-2023, Jerry Hoff, Sebastián Passaro |
|  |  | \* |
|  |  | \* All rights reserved. |
|  |  | \* |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8117911`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspassarop%2Fantisamy-dotnet%2Fcommit%2F8117911933e75a25cd0054ef017577486338444a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_02a3f99f_20250114_192934.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspassarop%2Fantisamy-dotnet%2Fcommit%2F7e500daef6ad9c10e97c68feab78f4cb6e3083c6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspassarop%2Fantisamy-dotnet%2Fcommit%2F7e500daef6ad9c10e97c68feab78f4cb6e3083c6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=spassarop%2Fantisamy-dotnet)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[spassarop](/spassarop)
/
**[antisamy-dotnet](/spassarop/antisamy-dotnet)**
Public

* [Notifications](/login?return_to=%2Fspassarop%2Fantisamy-dotnet) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fspassarop%2Fantisamy-dotnet)
* [Star
   3](/login?return_to=%2Fspassarop%2Fantisamy-dotnet)

* [Code](/spassarop/antisamy-dotnet)
* [Issues
  0](/spassarop/antisamy-dotnet/issues)
* [Pull requests
  0](/spassarop/antisamy-dotnet/pulls)
* [Actions](/spassarop/antisamy-dotnet/actions)
* [Wiki](/spassarop/antisamy-dotnet/wiki)
* [Security](/spassarop/antisamy-dotnet/security)
* [Insights](/spassarop/antisamy-dotnet/pulse)

Additional navigation options

* [Code](/spassarop/antisamy-dotnet)
* [Issues](/spassarop/antisamy-dotnet/issues)
* [Pull requests](/spassarop/antisamy-dotnet/pulls)
* [Actions](/spassarop/antisamy-dotnet/actions)
* [Wiki](/spassarop/antisamy-dotnet/wiki)
* [Security](/spassarop/antisamy-dotnet/security)
* [Insights](/spassarop/antisamy-dotnet/pulse)

## Commit

[Permalink](/spassarop/antisamy-dotnet/commit/7e500daef6ad9c10e97c68feab78f4cb6e3083c6)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add more tests for mXSS

[Browse files](/spassarop/antisamy-dotnet/tree/7e500daef6ad9c10e97c68feab78f4cb6e3083c6)
Browse the repository at this point in the history

* Loading branch information

[![@spassarop](https://avatars.githubusercontent.com/u/30912689?s=40&v=4)](/spassarop)

[spassarop](/spassarop/antisamy-dotnet/commits?author=spassarop "View all commits by spassarop")
committed
Jul 3, 2023

1 parent
[849e9f5](/spassarop/antisamy-dotnet/commit/849e9f5a4b5235bf5b5552c897a15567d6bf063d)

commit 7e500da

Showing
**1 changed file**
with
**4 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[OWASP.AntiSamyTests/Html/AntiSamyTest.cs](#diff-cc358aca2b9535c27890dc1a9aef479b424314fdd5b17b0bfefbb86c5d256729 "OWASP.AntiSamyTests/Html/AntiSamyTest.cs")

Show comments

[View file](/spassarop/antisamy-dotnet/blob/7e500daef6ad9c10e97c68feab78f4cb6e3083c6/OWASP.AntiSamyTests/Html/AntiSamyTest.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -903,6 +903,10 @@ public void TestSmuggledTagsInStyleContent() |
|  |  | .Should().NotContain("script"); |
|  |  | antisamy.Scan("<select<style/>k<input<</>input/onfocus=alert(1)>", policy).GetCleanHtml() |
|  |  | .Should().NotContain("input"); |
|  |  | antisamy.Scan("<style/><listing/>]]><noembed></style><img src=x onerror=mxss(1)></noembed>", policy).GetCleanHtml() |
|  |  | .Should().NotContain("mxss"); |
|  |  | antisamy.Scan("<style/><math>'<noframes ></style><img src=x onerror=mxss(1)></noframes>'", policy).GetCleanHtml() |
|  |  | .Should().NotContain("mxss"); |
|  |  | } |
|  |  |  |
|  |  | [Test] |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7e500da`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspassarop%2Fantisamy-dotnet%2Fcommit%2F7e500daef6ad9c10e97c68feab78f4cb6e3083c6) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


