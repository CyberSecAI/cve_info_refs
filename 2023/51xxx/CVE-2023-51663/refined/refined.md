```
{
  "vulnerability_details": {
    "root_cause": "Hail Batch relies on OIDC email claims to verify the validity of a user's domain, rather than the OAuth2 'sub' claim.",
    "weaknesses": [
      "The system trusts email claims from OIDC providers without proper verification.",
      "Allows creation of multiple accounts using Google's '+' email redirection."
    ],
    "impact": "An attacker can create multiple accounts without corresponding real accounts in the organization, potentially leading to unauthorized resource usage and financial cost if trial Hail Batch billing projects are enabled.",
    "attack_vectors": [
      "Creating a Microsoft or Google account and changing the email address.",
      "Creating multiple Google accounts using the 'real_user_email_name+random_id@example.org' format.",
      "For Microsoft, an Azure AD Administrator can change an email address without verification."
    ],
    "required_attacker_capabilities": [
        "Ability to create accounts with Microsoft or Google.",
        "For Microsoft, requires Azure AD Administrator access (which can be obtained by creating a free Azure tenant)"
        
    ],
    "additional_details": [
       "The attacker cannot impersonate another user because in Azure the `sub` from the OAuth2 response is used, and Google does email verification",
      "The attacker does not have access to any private data as new service principals or service accounts are not granted any privileges.",
       "A future change will prevent users from creating multiple accounts using Google's `+` email redirection."
    ]
  }
}
```