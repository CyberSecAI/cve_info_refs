=== Content from github.com_130fed8c_20250114_223228.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fweidai11%2Fcryptopp%2Fissues%2F1247)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fweidai11%2Fcryptopp%2Fissues%2F1247)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=weidai11%2Fcryptopp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[weidai11](/weidai11)
/
**[cryptopp](/weidai11/cryptopp)**
Public

* [Notifications](/login?return_to=%2Fweidai11%2Fcryptopp) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fweidai11%2Fcryptopp)
* [Star
   5k](/login?return_to=%2Fweidai11%2Fcryptopp)

* [Code](/weidai11/cryptopp)
* [Issues
  52](/weidai11/cryptopp/issues)
* [Pull requests
  11](/weidai11/cryptopp/pulls)
* [Actions](/weidai11/cryptopp/actions)
* [Projects
  0](/weidai11/cryptopp/projects)
* [Security](/weidai11/cryptopp/security)
* [Insights](/weidai11/cryptopp/pulse)

Additional navigation options

* [Code](/weidai11/cryptopp)
* [Issues](/weidai11/cryptopp/issues)
* [Pull requests](/weidai11/cryptopp/pulls)
* [Actions](/weidai11/cryptopp/actions)
* [Projects](/weidai11/cryptopp/projects)
* [Security](/weidai11/cryptopp/security)
* [Insights](/weidai11/cryptopp/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fweidai11%2Fcryptopp%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fweidai11%2Fcryptopp%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Crypto++ vulnerable to the Marvin Attack #1247

Open

[tomato42](/tomato42) opened this issue
Nov 12, 2023
· 1 comment

Open

# [Crypto++ vulnerable to the Marvin Attack](#top) #1247

[tomato42](/tomato42) opened this issue
Nov 12, 2023
· 1 comment

Labels
[Security Bug](/weidai11/cryptopp/labels/Security%20Bug)

## Comments

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=80&v=4)](/tomato42)

Copy link

### **[tomato42](/tomato42)** commented [Nov 12, 2023](#issue-1989391420) • edited Loading

| Crypto++ Issue Report I've verified that the Crypto++ is vulnerable to the [Marvin Attack](https://people.redhat.com/~hkario/marvin/)—a timing variant of the well-known Bleichenbacher attack.  I've executed the test on ArchLinux, using crypto++ 8.9.0 from the Arch repository. The reproducer is available in the [marvin-toolkit](https://github.com/tomato42/marvin-toolkit/tree/master/example/crypto%2B%2B) repository. It was compiled with a simple `g++ -o time_decrypt -lcryptopp time_decrypt.cpp`.  When executed on AMD Ryzen 5 5600X, I'm able to detect a side-channel signal when performing decryption with PKCS#1 v1.5 padding. The results are statistically significant with just few hundred measurement pairs, but below I'm showing results of a run with 100k repeats to show the size of the side-channel more clearly.  The test summary:  ``` Sign test mean p-value: 0.2339, median p-value: 4.255e-12, min p-value: 3.18e-88 Friedman test (chisquare approximation) for all samples p-value: 0.0 Worst pair: 1(no_header_with_payload_48), 5(valid_0) Mean of differences: 3.61457e-07s, 95% CI: 2.63026e-07s, 4.577243e-07s (±9.735e-08s) Median of differences: 4.80000e-07s, 95% CI: 4.30000e-07s, 5.200001e-07s (±4.500e-08s) Trimmed mean (5%) of differences: 3.84809e-07s, 95% CI: 3.26061e-07s, 4.382825e-07s (±5.611e-08s) Trimmed mean (25%) of differences: 4.82399e-07s, 95% CI: 4.37442e-07s, 5.255875e-07s (±4.407e-08s) Trimmed mean (45%) of differences: 4.77529e-07s, 95% CI: 4.31482e-07s, 5.214141e-07s (±4.497e-08s) Trimean of differences: 4.63125e-07s, 95% CI: 4.07500e-07s, 5.025002e-07s (±4.750e-08s) Layperson explanation: Definite side-channel detected, implementation is VULNERABLE  ```  [conf_interval_plot_trim_mean_25](https://private-user-images.githubusercontent.com/618246/282299431-15a4e163-c2b5-4c06-a54f-259f8161d58b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTQyNDcsIm5iZiI6MTczNjg5Mzk0NywicGF0aCI6Ii82MTgyNDYvMjgyMjk5NDMxLTE1YTRlMTYzLWMyYjUtNGMwNi1hNTRmLTI1OWY4MTYxZDU4Yi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMjMyMjdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mNzkyM2JiMGQzN2JmYmE3MzczMGJhYjY2NjUxMDdlMTljZjI5ZTMxNjI2ZWZmZDBhNjFjOWJhMjA3NzA4MWFkJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.16AvcvklazthOsABv7D7aQ2NUTEfNYxcwF2ETlSmq2g) legend:  ``` ID,Name 0,header_only 1,no_header_with_payload_48 2,no_padding_48 3,no_structure 4,signature_padding_8 5,valid_0 6,valid_48 7,valid_192 8,valid_246 9,valid_repeated_byte_payload_246_1 10,valid_repeated_byte_payload_246_255 11,zero_byte_in_padding_48_4  ```  Explanation for the ciphertexts is in the [`step2.py`](https://github.com/tomato42/marvin-toolkit/blob/master/step2.py) file.  As can be read from the graph, there's a clear difference between valid (probes 5, 6, and 7) and invalid ciphertexts. Moreover, the probe 2 is significantly different from others, which suggests a side-channel leakage in the numerical library (the last multiplication to apply deblinder, the last Montgormery reduction, or conversion of the arbitrary precision integer to a byte string), which means that that *all* padding modes that use the same RSADP() primitive will be similarly vulnerable, that means RSA-OAEP too.  (side note: I'm not a C++ programmer, so any help to make the reproducer cleaner, and command-line configurable, like the ones for openssl, pyca-cryptography, etc. will be really appreciated) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@noloader](https://avatars.githubusercontent.com/u/3538226?s=40&u=254e47b655f2f85bc78c793cbc5a2f44331191fe&v=4)](/noloader)
[noloader](/noloader)
added
the
[Security Bug](/weidai11/cryptopp/labels/Security%20Bug)
label
[Nov 15, 2023](#event-10970291994)

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=80&v=4)](/tomato42)

Copy link

Author

### **[tomato42](/tomato42)** commented [Jan 29, 2024](#issuecomment-1913787716)

| [@noloader](https://github.com/noloader) any progress on this? |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fweidai11%2Fcryptopp%2Fissues%2F1247)

Assignees

No one assigned

Labels

[Security Bug](/weidai11/cryptopp/labels/Security%20Bug)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=52&v=4)](/tomato42) [![@noloader](https://avatars.githubusercontent.com/u/3538226?s=52&v=4)](/noloader)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


