The provided content describes a stored Cross-Site Scripting (XSS) vulnerability in OpenKM version 7.1.40.

- **Root cause of vulnerability:** The vulnerability lies in the lack of proper sanitization of user-supplied input within the 'text' parameter when creating a note on a file.
- **Weaknesses/vulnerabilities present:** The primary vulnerability is a stored XSS vulnerability. The application does not properly sanitize user-provided input before storing it, which allows an attacker to inject malicious JavaScript code.
- **Impact of exploitation:** An attacker can inject malicious JavaScript code via the 'text' parameter when creating a note. When a user opens the note, the stored XSS payload is executed within the user's browser. This can lead to various impacts, including:
    - Theft of sensitive information
    - Session hijacking
    - Distribution of malware
- **Attack vectors:** The attack vector is through the 'text' parameter in a POST request to the `/openkm/rest/note/nodes/{NODE-ID}` endpoint.
- **Required attacker capabilities/position:**
    - The attacker needs to be an authenticated user within the OpenKM application.
    - The attacker needs the ability to create a note on a file.