=== Content from cheatsheetseries.owasp.org_d8877584_20250114_205245.html ===


[Skip to content](#sql-injection-prevention-cheat-sheet)

[![logo](../assets/OWASP_Logo.svg)](../index.html "OWASP Cheat Sheet Series")

OWASP Cheat Sheet Series

SQL Injection Prevention

Initializing search

[OWASP/CheatSheetSeries](https://github.com/OWASP/CheatSheetSeries "Go to repository")

[![logo](../assets/OWASP_Logo.svg)](../index.html "OWASP Cheat Sheet Series")
OWASP Cheat Sheet Series

[OWASP/CheatSheetSeries](https://github.com/OWASP/CheatSheetSeries "Go to repository")

* [Introduction](../index.html)
* [Index Alphabetical](../Glossary.html)
* [Index ASVS](../IndexASVS.html)
* [Index MASVS](../IndexMASVS.html)
* [Index Proactive Controls](../IndexProactiveControls.html)
* [Index Top 10](../IndexTopTen.html)
* Cheatsheets

  Cheatsheets
  + [AJAX Security](AJAX_Security_Cheat_Sheet.html)
  + [Abuse Case](Abuse_Case_Cheat_Sheet.html)
  + [Access Control](Access_Control_Cheat_Sheet.html)
  + [Attack Surface Analysis](Attack_Surface_Analysis_Cheat_Sheet.html)
  + [Authentication](Authentication_Cheat_Sheet.html)
  + [Authorization](Authorization_Cheat_Sheet.html)
  + [Authorization Testing Automation](Authorization_Testing_Automation_Cheat_Sheet.html)
  + [Bean Validation](Bean_Validation_Cheat_Sheet.html)
  + [Browser Extension Vulnerabilities](Browser_Extension_Vulnerabilities_Cheat_Sheet.html)
  + [C-Based Toolchain Hardening](C-Based_Toolchain_Hardening_Cheat_Sheet.html)
  + [CI CD Security](CI_CD_Security_Cheat_Sheet.html)
  + [Choosing and Using Security Questions](Choosing_and_Using_Security_Questions_Cheat_Sheet.html)
  + [Clickjacking Defense](Clickjacking_Defense_Cheat_Sheet.html)
  + [Content Security Policy](Content_Security_Policy_Cheat_Sheet.html)
  + [Credential Stuffing Prevention](Credential_Stuffing_Prevention_Cheat_Sheet.html)
  + [Cross-Site Request Forgery Prevention](Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html)
  + [Cross Site Scripting Prevention](Cross_Site_Scripting_Prevention_Cheat_Sheet.html)
  + [Cryptographic Storage](Cryptographic_Storage_Cheat_Sheet.html)
  + [DOM Clobbering Prevention](DOM_Clobbering_Prevention_Cheat_Sheet.html)
  + [DOM based XSS Prevention](DOM_based_XSS_Prevention_Cheat_Sheet.html)
  + [Database Security](Database_Security_Cheat_Sheet.html)
  + [Denial of Service](Denial_of_Service_Cheat_Sheet.html)
  + [Deserialization](Deserialization_Cheat_Sheet.html)
  + [Django REST Framework](Django_REST_Framework_Cheat_Sheet.html)
  + [Django Security](Django_Security_Cheat_Sheet.html)
  + [Docker Security](Docker_Security_Cheat_Sheet.html)
  + [DotNet Security](DotNet_Security_Cheat_Sheet.html)
  + [Error Handling](Error_Handling_Cheat_Sheet.html)
  + [File Upload](File_Upload_Cheat_Sheet.html)
  + [Forgot Password](Forgot_Password_Cheat_Sheet.html)
  + [GraphQL](GraphQL_Cheat_Sheet.html)
  + [HTML5 Security](HTML5_Security_Cheat_Sheet.html)
  + [HTTP Headers](HTTP_Headers_Cheat_Sheet.html)
  + [HTTP Strict Transport Security](HTTP_Strict_Transport_Security_Cheat_Sheet.html)
  + [Infrastructure as Code Security](Infrastructure_as_Code_Security_Cheat_Sheet.html)
  + [Injection Prevention](Injection_Prevention_Cheat_Sheet.html)
  + [Injection Prevention in Java](Injection_Prevention_in_Java_Cheat_Sheet.html)
  + [Input Validation](Input_Validation_Cheat_Sheet.html)
  + [Insecure Direct Object Reference Prevention](Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html)
  + [JAAS](JAAS_Cheat_Sheet.html)
  + [JSON Web Token for Java](JSON_Web_Token_for_Java_Cheat_Sheet.html)
  + [Java Security](Java_Security_Cheat_Sheet.html)
  + [Key Management](Key_Management_Cheat_Sheet.html)
  + [Kubernetes Security](Kubernetes_Security_Cheat_Sheet.html)
  + [LDAP Injection Prevention](LDAP_Injection_Prevention_Cheat_Sheet.html)
  + [Laravel](Laravel_Cheat_Sheet.html)
  + [Legacy Application Management](Legacy_Application_Management_Cheat_Sheet.html)
  + [Logging](Logging_Cheat_Sheet.html)
  + [Logging Vocabulary](Logging_Vocabulary_Cheat_Sheet.html)
  + [Mass Assignment](Mass_Assignment_Cheat_Sheet.html)
  + [Microservices Security](Microservices_Security_Cheat_Sheet.html)
  + [Microservices based Security Arch Doc](Microservices_based_Security_Arch_Doc_Cheat_Sheet.html)
  + [Mobile Application Security](Mobile_Application_Security_Cheat_Sheet.html)
  + [Multifactor Authentication](Multifactor_Authentication_Cheat_Sheet.html)
  + [NPM Security](NPM_Security_Cheat_Sheet.html)
  + [Network Segmentation](Network_Segmentation_Cheat_Sheet.html)
  + [NodeJS Docker](NodeJS_Docker_Cheat_Sheet.html)
  + [Nodejs Security](Nodejs_Security_Cheat_Sheet.html)
  + [OAuth2](OAuth2_Cheat_Sheet.html)
  + [OS Command Injection Defense](OS_Command_Injection_Defense_Cheat_Sheet.html)
  + [PHP Configuration](PHP_Configuration_Cheat_Sheet.html)
  + [Password Storage](Password_Storage_Cheat_Sheet.html)
  + [Pinning](Pinning_Cheat_Sheet.html)
  + [Prototype Pollution Prevention](Prototype_Pollution_Prevention_Cheat_Sheet.html)
  + [Query Parameterization](Query_Parameterization_Cheat_Sheet.html)
  + [REST Assessment](REST_Assessment_Cheat_Sheet.html)
  + [REST Security](REST_Security_Cheat_Sheet.html)
  + [Ruby on Rails](Ruby_on_Rails_Cheat_Sheet.html)
  + [SAML Security](SAML_Security_Cheat_Sheet.html)
  + SQL Injection Prevention

    [SQL Injection Prevention](SQL_Injection_Prevention_Cheat_Sheet.html)

    Table of contents
    - [Introduction](#introduction)
    - [What Is a SQL Injection Attack?](#what-is-a-sql-injection-attack)
    - [Anatomy of A Typical SQL Injection Vulnerability](#anatomy-of-a-typical-sql-injection-vulnerability)
    - [Primary Defenses](#primary-defenses)
      * [Defense Option 1: Prepared Statements (with Parameterized Queries)](#defense-option-1-prepared-statements-with-parameterized-queries)
        + [Safe Java Prepared Statement Example](#safe-java-prepared-statement-example)
        + [Safe C# .NET Prepared Statement Example](#safe-c-net-prepared-statement-example)
        + [Hibernate Query Language (HQL) Prepared Statement (Named Parameters) Example](#hibernate-query-language-hql-prepared-statement-named-parameters-example)
        + [Other Examples of Safe Prepared Statements](#other-examples-of-safe-prepared-statements)
      * [Defense Option 2: Stored Procedures](#defense-option-2-stored-procedures)
        + [Safe Approach to Stored Procedures](#safe-approach-to-stored-procedures)
        + [When Stored Procedures Can Increase Risk](#when-stored-procedures-can-increase-risk)
        + [Safe Java Stored Procedure Example](#safe-java-stored-procedure-example)
        + [Safe VB .NET Stored Procedure Example](#safe-vb-net-stored-procedure-example)
      * [Defense Option 3: Allow-list Input Validation](#defense-option-3-allow-list-input-validation)
        + [Sample Of Safe Table Name Validation](#sample-of-safe-table-name-validation)
        + [Safest Use Of Dynamic SQL Generation (DISCOURAGED)](#safest-use-of-dynamic-sql-generation-discouraged)
        + [Sample of Safer Dynamic Query Generation (DISCOURAGED)](#sample-of-safer-dynamic-query-generation-discouraged)
      * [Defense Option 4: STRONGLY DISCOURAGED: Escaping All User-Supplied Input](#defense-option-4-strongly-discouraged-escaping-all-user-supplied-input)
    - [Additional Defenses](#additional-defenses)
      * [Least Privilege](#least-privilege)
        + [Minimizing Application and OS Privileges](#minimizing-application-and-os-privileges)
        + [Details Of Least Privilege When Developing](#details-of-least-privilege-when-developing)
        + [Least Admin Privileges For Multiple DBs](#least-admin-privileges-for-multiple-dbs)
        + [Enhancing Least Privilege with SQL Views](#enhancing-least-privilege-with-sql-views)
      * [Allow-list Input Validation](#allow-list-input-validation)
    - [Related Articles](#related-articles)
  + [Secrets Management](Secrets_Management_Cheat_Sheet.html)
  + [Secure Cloud Architecture](Secure_Cloud_Architecture_Cheat_Sheet.html)
  + [Secure Product Design](Secure_Product_Design_Cheat_Sheet.html)
  + [Securing Cascading Style Sheets](Securing_Cascading_Style_Sheets_Cheat_Sheet.html)
  + [Server Side Request Forgery Prevention](Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html)
  + [Session Management](Session_Management_Cheat_Sheet.html)
  + [Software Supply Chain Security](Software_Supply_Chain_Security_Cheat_Sheet.html)
  + [Symfony](Symfony_Cheat_Sheet.html)
  + [TLS Cipher String](TLS_Cipher_String_Cheat_Sheet.html)
  + [Third Party Javascript Management](Third_Party_Javascript_Management_Cheat_Sheet.html)
  + [Threat Modeling](Threat_Modeling_Cheat_Sheet.html)
  + [Transaction Authorization](Transaction_Authorization_Cheat_Sheet.html)
  + [Transport Layer Protection](Transport_Layer_Protection_Cheat_Sheet.html)
  + [Transport Layer Security](Transport_Layer_Security_Cheat_Sheet.html)
  + [Unvalidated Redirects and Forwards](Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html)
  + [User Privacy Protection](User_Privacy_Protection_Cheat_Sheet.html)
  + [Virtual Patching](Virtual_Patching_Cheat_Sheet.html)
  + [Vulnerability Disclosure](Vulnerability_Disclosure_Cheat_Sheet.html)
  + [Vulnerable Dependency Management](Vulnerable_Dependency_Management_Cheat_Sheet.html)
  + [Web Service Security](Web_Service_Security_Cheat_Sheet.html)
  + [XML External Entity Prevention](XML_External_Entity_Prevention_Cheat_Sheet.html)
  + [XML Security](XML_Security_Cheat_Sheet.html)
  + [XSS Filter Evasion](XSS_Filter_Evasion_Cheat_Sheet.html)
  + [XS Leaks](XS_Leaks_Cheat_Sheet.html)

Table of contents

* [Introduction](#introduction)
* [What Is a SQL Injection Attack?](#what-is-a-sql-injection-attack)
* [Anatomy of A Typical SQL Injection Vulnerability](#anatomy-of-a-typical-sql-injection-vulnerability)
* [Primary Defenses](#primary-defenses)
  + [Defense Option 1: Prepared Statements (with Parameterized Queries)](#defense-option-1-prepared-statements-with-parameterized-queries)
    - [Safe Java Prepared Statement Example](#safe-java-prepared-statement-example)
    - [Safe C# .NET Prepared Statement Example](#safe-c-net-prepared-statement-example)
    - [Hibernate Query Language (HQL) Prepared Statement (Named Parameters) Example](#hibernate-query-language-hql-prepared-statement-named-parameters-example)
    - [Other Examples of Safe Prepared Statements](#other-examples-of-safe-prepared-statements)
  + [Defense Option 2: Stored Procedures](#defense-option-2-stored-procedures)
    - [Safe Approach to Stored Procedures](#safe-approach-to-stored-procedures)
    - [When Stored Procedures Can Increase Risk](#when-stored-procedures-can-increase-risk)
    - [Safe Java Stored Procedure Example](#safe-java-stored-procedure-example)
    - [Safe VB .NET Stored Procedure Example](#safe-vb-net-stored-procedure-example)
  + [Defense Option 3: Allow-list Input Validation](#defense-option-3-allow-list-input-validation)
    - [Sample Of Safe Table Name Validation](#sample-of-safe-table-name-validation)
    - [Safest Use Of Dynamic SQL Generation (DISCOURAGED)](#safest-use-of-dynamic-sql-generation-discouraged)
    - [Sample of Safer Dynamic Query Generation (DISCOURAGED)](#sample-of-safer-dynamic-query-generation-discouraged)
  + [Defense Option 4: STRONGLY DISCOURAGED: Escaping All User-Supplied Input](#defense-option-4-strongly-discouraged-escaping-all-user-supplied-input)
* [Additional Defenses](#additional-defenses)
  + [Least Privilege](#least-privilege)
    - [Minimizing Application and OS Privileges](#minimizing-application-and-os-privileges)
    - [Details Of Least Privilege When Developing](#details-of-least-privilege-when-developing)
    - [Least Admin Privileges For Multiple DBs](#least-admin-privileges-for-multiple-dbs)
    - [Enhancing Least Privilege with SQL Views](#enhancing-least-privilege-with-sql-views)
  + [Allow-list Input Validation](#allow-list-input-validation)
* [Related Articles](#related-articles)

# SQL Injection Prevention Cheat Sheet[¶](#sql-injection-prevention-cheat-sheet "Permanent link")

## Introduction[¶](#introduction "Permanent link")

This cheat sheet will help you prevent SQL injection flaws in your applications. It will define what SQL injection is, explain where those flaws occur, and provide four options for defending against SQL injection attacks. [SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection) attacks are common because:

1. SQL Injection vulnerabilities are very common, and
2. The application's database is a frequent target for attackers because it typically contains interesting/critical data.

## What Is a SQL Injection Attack?[¶](#what-is-a-sql-injection-attack "Permanent link")

Attackers can use SQL injection on an application if it has dynamic database queries that use string concatenation and user supplied input. To avoid SQL injection flaws, developers need to:

1. Stop writing dynamic queries with string concatenation or
2. Prevent malicious SQL input from being included in executed queries.

There are simple techniques for preventing SQL injection vulnerabilities and they can be used with practically any kind of programming language and any type of database. While XML databases can have similar problems (e.g., XPath and XQuery injection), these techniques can be used to protect them as well.

## Anatomy of A Typical SQL Injection Vulnerability[¶](#anatomy-of-a-typical-sql-injection-vulnerability "Permanent link")

A common SQL injection flaw in Java is below. Because its unvalidated "customerName" parameter is simply appended to the query, an attacker can enter SQL code into that query and the application would take the attacker's code and execute it on the database.

```
String query = "SELECT account_balance FROM user_data WHERE user_name = "
             + request.getParameter("customerName");
try {
    Statement statement = connection.createStatement( ... );
    ResultSet results = statement.executeQuery( query );
}

...

```
## Primary Defenses[¶](#primary-defenses "Permanent link")

* **Option 1: Use of Prepared Statements (with Parameterized Queries)**
* **Option 2: Use of Properly Constructed Stored Procedures**
* **Option 3: Allow-list Input Validation**
* **Option 4: STRONGLY DISCOURAGED: Escaping All User Supplied Input**

### Defense Option 1: Prepared Statements (with Parameterized Queries)[¶](#defense-option-1-prepared-statements-with-parameterized-queries "Permanent link")

When developers are taught how to write database queries, they should be told to use prepared statements with variable binding (aka parameterized queries). Prepared statements are simple to write and easier to understand than dynamic queries, and parameterized queries force the developer to define all SQL code first and pass in each parameter to the query later.

If database queries use this coding style, the database will always distinguish between code and data, regardless of what user input is supplied. Also, prepared statements ensure that an attacker cannot change the intent of a query, even if SQL commands are inserted by an attacker.

#### Safe Java Prepared Statement Example[¶](#safe-java-prepared-statement-example "Permanent link")

In the safe Java example below, if an attacker were to enter the userID as `tom' or '1'='1`, the parameterized query would look for a username that literally matches the entire string `tom' or '1'='1`. Thus, the database would be protected against injections of malicious SQL code.

The following code example uses a `PreparedStatement`, Java's implementation of a parameterized query, to execute the same database query.

```
// This should REALLY be validated too
String custname = request.getParameter("customerName");
// Perform input validation to detect attacks
String query = "SELECT account_balance FROM user_data WHERE user_name = ? ";
PreparedStatement pstmt = connection.prepareStatement( query );
pstmt.setString( 1, custname);
ResultSet results = pstmt.executeQuery( );

```
#### Safe C# .NET Prepared Statement Example[¶](#safe-c-net-prepared-statement-example "Permanent link")

In .NET, the creation and execution of the query doesn't change. Just pass the parameters to the query using the `Parameters.Add()` call as shown below.

```
String query = "SELECT account_balance FROM user_data WHERE user_name = ?";
try {
  OleDbCommand command = new OleDbCommand(query, connection);
  command.Parameters.Add(new OleDbParameter("customerName", CustomerName Name.Text));
  OleDbDataReader reader = command.ExecuteReader();
  // …
} catch (OleDbException se) {
  // error handling
}

```

While we have shown examples in Java and .NET, practically all other languages (including Cold Fusion and Classic ASP) support parameterized query interfaces. Even SQL abstraction layers, like the [Hibernate Query Language](http://hibernate.org/) (HQL) with the same type of injection problems (called [HQL Injection](http://cwe.mitre.org/data/definitions/564.html)) support parameterized queries as well:

#### Hibernate Query Language (HQL) Prepared Statement (Named Parameters) Example[¶](#hibernate-query-language-hql-prepared-statement-named-parameters-example "Permanent link")

```
// This is an unsafe HQL statement
Query unsafeHQLQuery = session.createQuery("from Inventory where productID='"+userSuppliedParameter+"'");
// Here is a safe version of the same query using named parameters
Query safeHQLQuery = session.createQuery("from Inventory where productID=:productid");
safeHQLQuery.setParameter("productid", userSuppliedParameter);

```
#### Other Examples of Safe Prepared Statements[¶](#other-examples-of-safe-prepared-statements "Permanent link")

If you need examples of prepared queries/parameterized languages, including Ruby, PHP, Cold Fusion, Perl, and Rust, see the [Query Parameterization Cheat Sheet](Query_Parameterization_Cheat_Sheet.html) or this [site](http://bobby-tables.com/).

Generally, developers like prepared statements because all the SQL code stays within the application, which makes applications relatively database independent.

### Defense Option 2: Stored Procedures[¶](#defense-option-2-stored-procedures "Permanent link")

Though stored procedures are not always safe from SQL injection, developers can use certain standard stored procedure programming constructs. This approach has the same effect as using parameterized queries, as long as the stored procedures are implemented safely (which is the norm for most stored procedure languages).

#### Safe Approach to Stored Procedures[¶](#safe-approach-to-stored-procedures "Permanent link")

If stored procedures are needed, the safest approach to using them requires the developer to build SQL statements with parameters that are automatically parameterized, unless the developer does something largely out of the norm. The difference between prepared statements and stored procedures is that the SQL code for a stored procedure is defined and stored in the database itself, then called from the application. Since prepared statements and safe stored procedures are equally effective in preventing SQL injection, your organization should choose the approach that makes the most sense for you.

#### When Stored Procedures Can Increase Risk[¶](#when-stored-procedures-can-increase-risk "Permanent link")

Occasionally, stored procedures can increase risk when a system is attacked. For example, on MS SQL Server, you have three main default roles: `db_datareader`, `db_datawriter` and `db_owner`. Before stored procedures came into use, DBAs would give `db_datareader` or `db_datawriter` rights to the webservice's user, depending on the requirements.

However, stored procedures require execute rights, a role not available by default. In some setups where user management has been centralized, but is limited to those 3 roles, web apps would have to run as `db_owner` so stored procedures could work. Naturally, that means that if a server is breached, the attacker has full rights to the database, where previously, they might only have had read-access.

#### Safe Java Stored Procedure Example[¶](#safe-java-stored-procedure-example "Permanent link")

The following code example uses Java's implementation of the stored procedure interface (`CallableStatement`) to execute the same database query. The `sp_getAccountBalance` stored procedure has to be predefined in the database and use the same functionality as the query above.

```
// This should REALLY be validated
String custname = request.getParameter("customerName");
try {
  CallableStatement cs = connection.prepareCall("{call sp_getAccountBalance(?)}");
  cs.setString(1, custname);
  ResultSet results = cs.executeQuery();
  // … result set handling
} catch (SQLException se) {
  // … logging and error handling
}

```
#### Safe VB .NET Stored Procedure Example[¶](#safe-vb-net-stored-procedure-example "Permanent link")

The following code example uses a `SqlCommand`, .NET's implementation of the stored procedure interface, to execute the same database query. The `sp_getAccountBalance` stored procedure must be predefined in the database and use the same functionality as the query defined above.

```
 Try
   Dim command As SqlCommand = new SqlCommand("sp_getAccountBalance", connection)
   command.CommandType = CommandType.StoredProcedure
   command.Parameters.Add(new SqlParameter("@CustomerName", CustomerName.Text))
   Dim reader As SqlDataReader = command.ExecuteReader()
   '...
 Catch se As SqlException
   'error handling
 End Try

```
### Defense Option 3: Allow-list Input Validation[¶](#defense-option-3-allow-list-input-validation "Permanent link")

If you are faced with parts of SQL queries that can't use bind variables, such as table names, column names, or sort order indicators (ASC or DESC), input validation or query redesign is the most appropriate defense. When table or column names are needed, ideally those values come from the code and not from user parameters.

#### Sample Of Safe Table Name Validation[¶](#sample-of-safe-table-name-validation "Permanent link")

WARNING: Using user parameter values to target table or column names is a symptom of poor design and a full rewrite should be considered if time allows. If that is not possible, developers should map the parameter values to the legal/expected table or column names to make sure unvalidated user input doesn't end up in the query.

In the example below, since `tableName` is identified as one of the legal and expected values for a table name in this query, it can be directly appended to the SQL query. Keep in mind that generic table validation functions can lead to data loss if table names are used in queries where they are not expected.

```
String tableName;
switch(PARAM):
  case "Value1": tableName = "fooTable";
                 break;
  case "Value2": tableName = "barTable";
                 break;
  ...
  default      : throw new InputValidationException("unexpected value provided"
                                                  + " for table name");

```
#### Safest Use Of Dynamic SQL Generation (DISCOURAGED)[¶](#safest-use-of-dynamic-sql-generation-discouraged "Permanent link")

When we say a stored procedure is "implemented safely," that means it does not include any unsafe dynamic SQL generation. Developers do not usually generate dynamic SQL inside stored procedures. However, it can be done, but should be avoided.

If it can't be avoided, the stored procedure must use input validation or proper escaping, as described in this article, to make sure that all user supplied input to the stored procedure can't be used to inject SQL code into the dynamically generated query. Auditors should always look for uses of `sp_execute`, `execute` or `exec` within SQL Server stored procedures. Similar audit guidelines are necessary for similar functions for other vendors.

#### Sample of Safer Dynamic Query Generation (DISCOURAGED)[¶](#sample-of-safer-dynamic-query-generation-discouraged "Permanent link")

For something simple like a sort order, it is best if the user supplied input is converted to a boolean, and then that boolean is used to select the safe value to append to the query. This is a very standard need in dynamic query creation.

For example:

```
public String someMethod(boolean sortOrder) {
 String SQLquery = "some SQL ... order by Salary " + (sortOrder ? "ASC" : "DESC");`
 ...

```

Any time user input can be converted to a non-String, like a date, numeric, boolean, enumerated type, etc. before it is appended to a query, or used to select a value to append to the query, this ensures it is safe to do so.

Input validation is also recommended as a secondary defense in ALL cases, even when using bind variables as discussed earlier in this article. More techniques on how to implement strong input validation is described in the [Input Validation Cheat Sheet](Input_Validation_Cheat_Sheet.html).

### Defense Option 4: STRONGLY DISCOURAGED: Escaping All User-Supplied Input[¶](#defense-option-4-strongly-discouraged-escaping-all-user-supplied-input "Permanent link")

In this approach, the developer will escape all user input before putting it in a query. It is very database specific in its implementation. This methodology is frail compared to other defenses, and we CANNOT guarantee that this option will prevent all SQL injections in all situations.

If an application is built from scratch or requires low risk tolerance, it should be built or re-written using parameterized queries, stored procedures, or some kind of Object Relational Mapper (ORM) that builds your queries for you.

## Additional Defenses[¶](#additional-defenses "Permanent link")

Beyond adopting one of the four primary defenses, we also recommend adopting all of these additional defenses to provide defense in depth. These additional defenses are:

* **Least Privilege**
* **Allow-list Input Validation**

### Least Privilege[¶](#least-privilege "Permanent link")

To minimize the potential damage of a successful SQL injection attack, you should minimize the privileges assigned to every database account in your environment. Start from the ground up to determine what access rights your application accounts require, rather than trying to figure out what access rights you need to take away.

Make sure that accounts that only need read access are only granted read access to the tables they need access to. DO NOT ASSIGN DBA OR ADMIN TYPE ACCESS TO YOUR APPLICATION ACCOUNTS. We understand that this is easy, and everything just "works" when you do it this way, but it is very dangerous.

#### Minimizing Application and OS Privileges[¶](#minimizing-application-and-os-privileges "Permanent link")

SQL injection is not the only threat to your database data. Attackers can simply change the parameter values from one of the legal values they are presented with, to a value that is unauthorized for them, but the application itself might be authorized to access. As such, minimizing the privileges granted to your application will reduce the likelihood of such unauthorized access attempts, even when an attacker is not trying to use SQL injection as part of their exploit.

While you are at it, you should minimize the privileges of the operating system account that the DBMS runs under. Don't run your DBMS as root or system! Most DBMSs run out of the box with a very powerful system account. For example, MySQL runs as system on Windows by default! Change the DBMS's OS account to something more appropriate, with restricted privileges.

#### Details Of Least Privilege When Developing[¶](#details-of-least-privilege-when-developing "Permanent link")

If an account only needs access to portions of a table, consider creating a view that limits access to that portion of the data and assigning the account access to the view instead of the underlying table. Rarely, if ever, grant create or delete access to database accounts.

If you adopt a policy where you use stored procedures everywhere, and don't allow application accounts to directly execute their own queries, then restrict those accounts to only be able to execute the stored procedures they need. Don't grant them any rights directly to the tables in the database.

#### Least Admin Privileges For Multiple DBs[¶](#least-admin-privileges-for-multiple-dbs "Permanent link")

The designers of web applications should avoid using the same owner/admin account in the web applications to connect to the database. Different DB users should be used for different web applications.

In general, each separate web application that requires access to the database should have a designated database user account that the application will use to connect to the DB. That way, the designer of the application can have good granularity in the access control, thus reducing the privileges as much as possible. Each DB user will then have select access to only what it needs, and write-access as needed.

As an example, a login page requires read access to the username and password fields of a table, but no write access of any form (no insert, update, or delete). However, the sign-up page certainly requires insert privilege to that table; this restriction can only be enforced if these web apps use different DB users to connect to the database.

#### Enhancing Least Privilege with SQL Views[¶](#enhancing-least-privilege-with-sql-views "Permanent link")

You can use SQL views to further increase the granularity of access by limiting the read access to specific fields of a table or joins of tables. It could have additional benefits.

For example, if the system is required (perhaps due to some specific legal requirements) to store the passwords of the users, instead of salted-hashed passwords, the designer could use views to compensate for this limitation. They could revoke all access to the table (from all DB users except the owner/admin) and create a view that outputs the hash of the password field and not the field itself.

Any SQL injection attack that succeeds in stealing DB information will be restricted to stealing the hash of the passwords (could even be a keyed hash), since no DB user for any of the web applications has access to the table itself.

### Allow-list Input Validation[¶](#allow-list-input-validation "Permanent link")

In addition to being a primary defense when nothing else is possible (e.g., when a bind variable isn't legal), input validation can also be a secondary defense used to detect unauthorized input before it is passed to the SQL query. For more information please see the [Input Validation Cheat Sheet](Input_Validation_Cheat_Sheet.html). Proceed with caution here. Validated data is not necessarily safe to insert into SQL queries via string building.

## Related Articles[¶](#related-articles "Permanent link")

**SQL Injection Attack Cheat Sheets**:

The following articles describe how to exploit different kinds of SQL injection vulnerabilities on various platforms (that this article was created to help you avoid):

* [SQL Injection Cheat Sheet](https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/)
* Bypassing WAF's with SQLi - [SQL Injection Bypassing WAF](https://owasp.org/www-community/attacks/SQL_Injection_Bypassing_WAF)

**Description of SQL Injection Vulnerabilities**:

* OWASP article on [SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection) Vulnerabilities
* OWASP article on [Blind\_SQL\_Injection](https://owasp.org/www-community/attacks/Blind_SQL_Injection) Vulnerabilities

**How to Avoid SQL Injection Vulnerabilities**:

* [OWASP Developers Guide](https://github.com/OWASP/DevGuide) article on how to avoid SQL injection vulnerabilities
* OWASP Cheat Sheet that provides [numerous language specific examples of parameterized queries using both Prepared Statements and Stored Procedures](Query_Parameterization_Cheat_Sheet.html)
* [The Bobby Tables site (inspired by the XKCD webcomic) has numerous examples in different languages of parameterized Prepared Statements and Stored Procedures](http://bobby-tables.com/)

**How to Review Code for SQL Injection Vulnerabilities**:

* [OWASP Code Review Guide](https://wiki.owasp.org/index.php/Category%3AOWASP_Code_Review_Project) article on how to [Review Code for SQL Injection](https://wiki.owasp.org/index.php/Reviewing_Code_for_SQL_Injection) Vulnerabilities

**How to Test for SQL Injection Vulnerabilities**:

* [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide) article on how to [Test for SQL Injection](https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection.html) Vulnerabilities

©Copyright  - Cheat Sheets Series Team - This work is licensed under [Creative Commons Attribution-ShareAlike 4.0 International](https://creativecommons.org/licenses/by-sa/4.0/).

Made with
[Material for MkDocs](https://squidfunk.github.io/mkdocs-material/)



=== Content from github.com_015e50fc_20250114_205246.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FVauP%2FCVE-IDs%2Fblob%2Fmain%2Fproof_of_concept.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FVauP%2FCVE-IDs%2Fblob%2Fmain%2Fproof_of_concept.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=VauP%2FCVE-IDs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[VauP](/VauP)
/
**[CVE-IDs](/VauP/CVE-IDs)**
Public

* [Notifications](/login?return_to=%2FVauP%2FCVE-IDs) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FVauP%2FCVE-IDs)
* [Star
   0](/login?return_to=%2FVauP%2FCVE-IDs)

* [Code](/VauP/CVE-IDs)
* [Issues
  0](/VauP/CVE-IDs/issues)
* [Pull requests
  0](/VauP/CVE-IDs/pulls)
* [Actions](/VauP/CVE-IDs/actions)
* [Projects
  0](/VauP/CVE-IDs/projects)
* [Security](/VauP/CVE-IDs/security)
* [Insights](/VauP/CVE-IDs/pulse)

Additional navigation options

* [Code](/VauP/CVE-IDs)
* [Issues](/VauP/CVE-IDs/issues)
* [Pull requests](/VauP/CVE-IDs/pulls)
* [Actions](/VauP/CVE-IDs/actions)
* [Projects](/VauP/CVE-IDs/projects)
* [Security](/VauP/CVE-IDs/security)
* [Insights](/VauP/CVE-IDs/pulse)

## Files

 main
## Breadcrumbs

1. [CVE-IDs](/VauP/CVE-IDs/tree/main)
/
# proof\_of\_concept.md

Copy path Blame  Blame
## Latest commit

## History

[History](/VauP/CVE-IDs/commits/main/proof_of_concept.md)46 lines (25 loc) · 2.5 KB main
## Breadcrumbs

1. [CVE-IDs](/VauP/CVE-IDs/tree/main)
/
# proof\_of\_concept.md

Top
## File metadata and controls

* Preview
* Code
* Blame

46 lines (25 loc) · 2.5 KB[Raw](https://github.com/VauP/CVE-IDs/raw/refs/heads/main/proof_of_concept.md)

**Vulnerability Name:** SQL Injection on GeoSiap ERP (2.2.167.02 ) login form

**Date of Discovery:** 17 November 2023

**Product version:** 2.2.167.02

**Author:** vgdpx

**Vulnerability Description:** Any public user/guest (unauthenticated) can inject malicious SQL query in order to affect the execution of predefined SQL commands via the "codLogin" parameter on the login form. Upon successful of SQL injection attack, attacker can read sensitive data from the database or modify database data.
GeoSiap is an ERP system for government applications, used by approximately 25 cities, meaning that this is an extremely critical vulnerability, which could result in the leakage of millions of people's data.

**Vulnerable URL:** \_<http://localhost/websis/siapegov/recursos_humanos/grh/grh_rh_online.php>

**Proof of Concept:**

**1)** In an application running ERP GeoSiap version 2.2.167.02, we can test the codLogin parameter with a simple time-based injection "codLogin=test') AND 4848=(SELECT 4848 FROM PG\_SLEEP(5)) we can assume that the database used is PostgresSQL.

**Fetching database info**

[![Fetching](https://github.com/VauP/CVE-IDs/raw/main/Databases.png?raw=true)](https://github.com/VauP/CVE-IDs/blob/main/Databases.png?raw=true)

**2)** With this information, we can automate the process with the help of SQLMap, and easily gain full access to the database.

**Dump database name = public**

[![Dump](https://github.com/VauP/CVE-IDs/raw/83dfc0ec5ecb79ee960b87c41a1d7089b6d2d4a7/Dump.png?raw=true)](https://github.com/VauP/CVE-IDs/blob/83dfc0ec5ecb79ee960b87c41a1d7089b6d2d4a7/Dump.png?raw=true)

**3)** Once we know this, a basic google dorks (intitle: "Servicos On-line 2.2.167.02" login) is able to return all the cities that use the same vulnerable version, and we get the result that approximately 25 cities use this system.

**Dorks results**

[![Dorks](https://github.com/VauP/CVE-IDs/raw/main/Dorks.png?raw=true)](https://github.com/VauP/CVE-IDs/blob/main/Dorks.png?raw=true)

**Consequences:**

* Confidentiality: Since SQL databases generally hold sensitive data, loss of confidentiality is a frequent problem with SQL Injection vulnerabilities.
* Integrity: Just as it may be possible to read sensitive information eg client/customer sensitive data, it is also possible to make changes or even delete this information with a SQL Injection attack.

**Mitigation:** Use of Prepared Statements (with Parameterized Queries). It would also be good to sanitize the input parameters to eliminate unwanted characters.

**References for Mitigation Vulnerability:** <https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html>

**References:**

* <https://github.com/VauP/CVE-IDs>
* <https://owasp.org/www-community/attacks/SQL_Injection>

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from owasp.org_112a8c2e_20250114_205247.html ===


For full functionality of this site it is necessary to enable JavaScript. Here are the  [instructions how to enable JavaScript in your web browser](http://turnonjs.com/).

[![OWASP logo](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

[![](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

 [Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

This website uses cookies to analyze our traffic and only share that information with our analytics partners.

Accept

x

[Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

# SQL Injection

**Contributor(s):** kingthorin, zbraiterman

## Overview

A [SQL injection](https://owasp.org/www-community/attacks/SQL_Injection) attack consists of insertion
or “injection” of a SQL query via the input data from the client to the
application. A successful SQL injection exploit can read sensitive data
from the database, modify database data (Insert/Update/Delete), execute
administration operations on the database (such as shutdown the DBMS),
recover the content of a given file present on the DBMS file system and
in some cases issue commands to the operating system. SQL injection
attacks are a type of injection attack, in which SQL commands
are injected into data-plane input in order to affect the execution of
predefined SQL commands.

## Threat Modeling

* SQL injection attacks allow attackers to spoof identity, tamper with existing data, cause repudiation issues such as voiding transactions or changing balances, allow the complete disclosure of all data on the system, destroy the data or make it otherwise unavailable, or become administrators of the database server.
* SQL Injection is very common with PHP and ASP applications due to the prevalence of older functional interfaces. Due to the nature of programmatic interfaces available, J2EE and ASP.NET applications are less likely to have easily exploited SQL injections.
* The severity of SQL Injection attacks is limited by the attacker’s skill and imagination, and to a lesser extent, defense in depth countermeasures, such as low privilege connections to the database server and so on. In general, consider SQL Injection a high impact severity.

## Related Security Activities

### How to Avoid SQL Injection Vulnerabilities

See the OWASP [SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html).
See the OWASP [Query Parameterization Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html).

### How to Review Code for SQL Injection Vulnerabilities

See the [OWASP Code Review Guide](https://owasp.org/www-project-code-review-guide/) article on how to Review Code for SQL Injection vulnerabilities.

### How to Test for SQL Injection Vulnerabilities

See the [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/) for information on testing for SQL Injection vulnerabilities.

### How to Bypass Web Application Firewalls with SQLi

See the OWASP Article on [using SQL Injection to bypass a WAF](SQL_Injection_Bypassing_WAF)

## Description

SQL injection attack occurs when:

1. An unintended data enters a program from an untrusted source.
2. The data is used to dynamically construct a SQL query

The main consequences are:

* **Confidentiality**: Since SQL databases generally hold sensitive data, loss of confidentiality is a frequent problem with SQL Injection vulnerabilities.
* **Authentication**: If poor SQL commands are used to check user names and passwords, it may be possible to connect to a system as another user with no previous knowledge of the password.
* **Authorization**: If authorization information is held in a SQL database, it may be possible to change this information through the successful exploitation of a SQL Injection vulnerability.
* **Integrity**: Just as it may be possible to read sensitive information, it is also possible to make changes or even delete this information with a SQL Injection attack.

## Risk Factors

The platform affected can be:

* Language: SQL
* Platform: Any (requires interaction with a SQL database)

SQL Injection has become a common
issue with database-driven web sites. The flaw is easily detected, and
easily exploited, and as such, any site or software package with even a
minimal user base is likely to be subject to an attempted attack of this
kind.

Essentially, the attack is accomplished by placing a meta character into
data input to then place SQL commands in the control plane, which did
not exist there before. This flaw depends on the fact that SQL makes no
real distinction between the control and data planes.

## Examples

### Example 1

In SQL:
`select id, firstname, lastname from authors`

If one provided: `Firstname: evil'ex` and `Lastname: Newman`

the query string becomes:

`select id, firstname, lastname from authors where firstname = 'evil'ex' and lastname ='newman'`

which the database attempts to run as:

`Incorrect syntax near il' as the database tried to execute evil.`

A safe version of the above SQL statement could be coded in Java as:

```
String firstname = req.getParameter("firstname");
String lastname = req.getParameter("lastname");
// FIXME: do your own validation to detect attacks
String query = "SELECT id, firstname, lastname FROM authors WHERE firstname = ? and lastname = ?";
PreparedStatement pstmt = connection.prepareStatement( query );
pstmt.setString( 1, firstname );
pstmt.setString( 2, lastname );
try
{
    ResultSet results = pstmt.execute( );
}

```
### Example 2

The following C# code dynamically constructs and executes a SQL query
that searches for items matching a specified name. The query restricts
the items displayed to those where owner matches the user name of the
currently-authenticated user.

```
...
string userName = ctx.getAuthenticatedUserName();
string query = "SELECT * FROM items WHERE owner = '"
                + userName + "' AND itemname = '"
                + ItemName.Text + "'";
sda = new SqlDataAdapter(query, conn);
DataTable dt = new DataTable();
sda.Fill(dt);
...

```

The query that this code intends to execute follows:

```
SELECT * FROM items
WHERE owner =
AND itemname = ;

```

However, because the query is constructed dynamically by concatenating a
constant base query string and a user input string, the query only
behaves correctly if `itemName` does not contain a single-quote character.
If an attacker with the user name wiley enters the string `"name' OR
'a'='a"` for `itemName`, then the query becomes the following:

```
SELECT * FROM items
WHERE owner = 'wiley'
AND itemname = 'name' OR 'a'='a';

```

The addition of the `OR 'a'='a'` condition causes the where clause to
always evaluate to true, so the query becomes logically equivalent to
the much simpler query:

`SELECT * FROM items;`

This simplification of the query allows the attacker to bypass the
requirement that the query only return items owned by the authenticated
user; the query now returns all entries stored in the items table,
regardless of their specified owner.

### Example 3

This example examines the effects of a different malicious value passed
to the query constructed and executed in Example 1. If an attacker with
the user name hacker enters the string `"name'); DELETE FROM items; --"`
for `itemName`, then the query becomes the following two queries:

```
SELECT * FROM items
WHERE owner = 'hacker'
AND itemname = 'name';

DELETE FROM items;

--'

```

Many database servers, including Microsoft® SQL Server 2000, allow
multiple SQL statements separated by semicolons to be executed at once.
While this attack string results in an error in Oracle and other
database servers that do not allow the batch-execution of statements
separated by semicolons, in databases that do allow batch execution,
this type of attack allows the attacker to execute arbitrary commands
against the database.

Notice the trailing pair of hyphens (`--`), which specifies to most database servers that the remainder of the statement is to be treated as
a comment and not executed. In this case the comment character serves to remove the trailing single-quote left over from the modified query. In a
database where comments are not allowed to be used in this way, the general attack could still be made effective using a trick similar to
the one shown in Example 1. If an attacker enters the string `"name'); DELETE FROM items; SELECT \* FROM items WHERE 'a'='a"`, the following
three valid statements will be created:

```
SELECT * FROM items
WHERE owner = 'hacker'
AND itemname = 'name';

DELETE FROM items;

SELECT * FROM items WHERE 'a'='a';

```

One traditional approach to preventing SQL injection attacks is to
handle them as an input validation problem and either accept only
characters from an allow list of safe values or identify and escape a
deny list of potentially malicious values. An allow list can be a very
effective means of enforcing strict input validation rules, but
parameterized SQL statements require less maintenance and can offer more
guarantees with respect to security. As is almost always the case,
deny listing is riddled with loopholes that make it ineffective at
preventing SQL injection attacks. For example, attackers can:

* Target fields that are not quoted
* Find ways to bypass the need for certain escaped meta-characters
* Use stored procedures to hide the injected meta-characters

Manually escaping characters in input to SQL queries can help, but it
will not make your application secure from SQL injection attacks.

Another solution commonly proposed for dealing with SQL injection
attacks is to use stored procedures. Although stored procedures prevent
some types of SQL injection attacks, they fail to protect against many
others. For example, the following PL/SQL procedure is vulnerable to the
same SQL injection attack shown in the first example.

```
procedure get_item (
    itm_cv IN OUT ItmCurTyp,
    usr in varchar2,
    itm in varchar2)
is
    open itm_cv for ' SELECT * FROM items WHERE ' ||
            'owner = '''|| usr ||
            ' AND itemname = ''' || itm || '''';
end get_item;

```

Stored procedures typically help prevent SQL injection attacks by
limiting the types of statements that can be passed to their parameters.
However, there are many ways around the limitations and many interesting
statements that can still be passed to stored procedures. Again, stored
procedures can prevent some exploits, but they will not make your
application secure against SQL injection attacks.

## Related [Attacks](https://owasp.org/www-community/attacks/)

* [SQL Injection Bypassing WAF](https://www.owasp.org/index.php/SQL_Injection_Bypassing_WAF)
* [Blind SQL Injection](Blind_SQL_Injection)
* [Code Injection](Code_Injection)
* [Double Encoding](../Double_Encoding)
* [ORM Injection](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.7-Testing_for_ORM_Injection.html)

## References

* [SQL Injection Knowledge Base](https://book.hacktricks.xyz/pentesting-web/sql-injection) - A reference guide for MySQL, MSSQL and Oracle SQL Injection attacks.
* [GreenSQL Open Source SQL Injection Filter](http://www.greensql.net/) - An Open Source database firewall used to protect databases from SQL injection attacks.
* [An Introduction to SQL Injection Attacks for Oracle Developers](https://web.archive.org/web/20151005235207/http%3A//www.net-security.org/dl/articles/IntegrigyIntrotoSQLInjectionAttacks.pdf)
  + This also includes recommended defenses.

[Category:Injection](https://owasp.org/www-community/Injection_Flaws)

---

[Watch](https://github.com/owasp/www-community/subscription)
[Star](https://github.com/owasp/www-community)

**The OWASP® Foundation** works to improve the security of software through its community-led open source software projects,
hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.
### Important Community Links

* [Community](/www-community/)
* Attacks (You are here)
* [Vulnerabilities](/www-community/vulnerabilities)
* [Controls](/www-community/controls)

### Upcoming OWASP Global Events

## Corporate Supporters

[Become a corporate supporter](https://owasp.org/supporters)

* [HOME](https://owasp.org/)
* [PROJECTS](https://owasp.org/projects/)
* [CHAPTERS](https://owasp.org/chapters/)
* [EVENTS](https://owasp.org/events/)
* [ABOUT](https://owasp.org/about/)
* [PRIVACY](https://owasp.org/www-policy/operational/privacy)
* [SITEMAP](https://owasp.org/sitemap/)
* [CONTACT](https://owasp.org/contact/)

OWASP, the OWASP logo, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, and LASCON are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our [General Disclaimer](/www-policy/operational/general-disclaimer.html). OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2025, OWASP Foundation, Inc.


