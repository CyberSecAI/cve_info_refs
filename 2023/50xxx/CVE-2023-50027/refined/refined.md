Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**

*   The `BaproductzoommagnifierZoomModuleFrontController::run()` method in the "Best Zoom Magnifier Effect - BAZoom Magnifier" module for PrestaShop has insecure SQL calls. Specifically, the module uses user-supplied input (`id_langs`, `id_shop`) directly in SQL queries without proper sanitization.

**Weaknesses/vulnerabilities present:**

*   **SQL Injection (CWE-89):** The primary vulnerability is SQL injection. The module takes user-provided parameters and incorporates them directly into SQL queries, allowing an attacker to manipulate these queries. The vulnerability occurs in the following part of the code:

```php
$search .=" AND id_lang='$id_lang' AND id_shop = '".(int) $id_shop."'";
```
This code is vulnerable because the `$id_lang` variable is not sanitized or validated before being used in the SQL query, allowing for the injection of malicious SQL code. The `$id_shop` variable is casted to an int, preventing SQL injection on that particular variable.

**Impact of exploitation:**

*   **Critical severity (9.8):** This SQL injection vulnerability is classified as critical due to its potential impact.
*   **Data breaches:** Attackers can gain unauthorized access to sensitive data, including customer information, payment details, and admin credentials.
*   **Complete system compromise:** The attacker could obtain admin access and potentially take full control of the PrestaShop installation.
*   **Data manipulation/removal:** Attackers can modify or delete data within the database, potentially disrupting the website's functionality.
*   **Webskimming:** The vulnerability is actively being exploited to inject webskimmers, which are used to steal credit card information.
*   **Hijacking of emails:** Attackers can rewrite SMTP settings to intercept or manipulate emails.

**Attack vectors:**

*   **Network:** The attack vector is over the network. The vulnerability is triggered through HTTP requests.
*   **Simple HTTP call:** The SQL injection can be exploited via a simple HTTP call to the vulnerable endpoint.

**Required attacker capabilities/position:**

*   **No privileges required:** The attacker does not need any prior authentication or user privileges to exploit the vulnerability.
*   **No user interaction:** The attacker can exploit the vulnerability without any user interaction.
*   **Guest Access:** A guest user is capable of exploiting this vulnerability.

**Additional details:**

*   The exploit is actively being used to deploy webskimmers to steal credit card data, highlighting the real-world danger of this vulnerability.
*   The module controller path can be concealed, which makes detecting the exploit via conventional frontend logs difficult. Attackers often conceal the path in the HTTP requests, with server logs only displaying a `POST /`.
*   The proof of concept (PoC) shows how a malicious SQL query can be injected using the `id_langs` parameter.
*   The provided patch shows the vulnerable line of code was modified to properly sanitize the `id_lang` variable. The fix replaces the string interpolation `'$id_lang'` with the cast to integer `(int) $id_lang`.

The advisory also offers general recommendations such as updating to the latest PrestaShop version, changing the default database prefix, and implementing a Web Application Firewall (WAF).