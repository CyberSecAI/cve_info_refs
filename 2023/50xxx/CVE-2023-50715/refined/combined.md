=== Content from github.com_92742cd5_20250114_191127.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhome-assistant%2Fcore%2Fcommit%2Fdbfc5ea8f96bde6cd165892f5a6a6f9a65731c76)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhome-assistant%2Fcore%2Fcommit%2Fdbfc5ea8f96bde6cd165892f5a6a6f9a65731c76)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=home-assistant%2Fcore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[home-assistant](/home-assistant)
/
**[core](/home-assistant/core)**
Public

* [Notifications](/login?return_to=%2Fhome-assistant%2Fcore) You must be signed in to change notification settings
* [Fork
  31.9k](/login?return_to=%2Fhome-assistant%2Fcore)
* [Star
   75.8k](/login?return_to=%2Fhome-assistant%2Fcore)

* [Code](/home-assistant/core)
* [Issues
  2.9k](/home-assistant/core/issues)
* [Pull requests
  482](/home-assistant/core/pulls)
* [Actions](/home-assistant/core/actions)
* [Projects
  2](/home-assistant/core/projects)
* [Security](/home-assistant/core/security)
* [Insights](/home-assistant/core/pulse)

Additional navigation options

* [Code](/home-assistant/core)
* [Issues](/home-assistant/core/issues)
* [Pull requests](/home-assistant/core/pulls)
* [Actions](/home-assistant/core/actions)
* [Projects](/home-assistant/core/projects)
* [Security](/home-assistant/core/security)
* [Insights](/home-assistant/core/pulse)

## Commit

[Permalink](/home-assistant/core/commit/dbfc5ea8f96bde6cd165892f5a6a6f9a65731c76)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Disable user profiles on login screen ([#105749](https://github.com/home-assistant/core/pull/105749))

[Browse files](/home-assistant/core/tree/dbfc5ea8f96bde6cd165892f5a6a6f9a65731c76)
Browse the repository at this point in the history

* Loading branch information

[![@frenck](https://avatars.githubusercontent.com/u/195327?s=40&v=4)](/frenck)

[frenck](/home-assistant/core/commits?author=frenck "View all commits by frenck")
committed
Dec 14, 2023

1 parent
[4aa03b3](/home-assistant/core/commit/4aa03b33f65e552c4639ced55e092ff6c6e1213d)

commit dbfc5ea

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**7 additions**
and
**102 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* homeassistant/components

  + auth

    - homeassistant/components/auth/login\_flow.py
      [login\_flow.py](#diff-a4edfd4762e9988bece1cb8036f97a03bbe325b079d053988727efa96ba72607)
  + person

    - homeassistant/components/person/\_\_init\_\_.py
      [\_\_init\_\_.py](#diff-0727241d262c4baeb282e9c9bcfa2d40870efaa0dee914391cf0f6e678da9919)
* tests/components

  + auth

    - tests/components/auth/test\_login\_flow.py
      [test\_login\_flow.py](#diff-413165ae72f4ca09088bcbc211861d591a54cbe19192095291e3de479f76ef49)
  + person

    - tests/components/person/test\_init.py
      [test\_init.py](#diff-aa252be67455a0f7e55fd71f89250b20ee9d49157ed7a7a0fb0701245adcdd74)

## There are no files selected for viewing

21 changes: 0 additions & 21 deletions

21
[homeassistant/components/auth/login\_flow.py](#diff-a4edfd4762e9988bece1cb8036f97a03bbe325b079d053988727efa96ba72607 "homeassistant/components/auth/login_flow.py")

Show comments

[View file](/home-assistant/core/blob/dbfc5ea8f96bde6cd165892f5a6a6f9a65731c76/homeassistant/components/auth/login_flow.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -91,7 +91,6 @@ |
|  |  | from homeassistant.components.http.view import HomeAssistantView |
|  |  | from homeassistant.core import HomeAssistant |
|  |  | from homeassistant.helpers.network import is\_cloud\_connection |
|  |  | from homeassistant.util.network import is\_local |
|  |  |  |
|  |  | from . import indieauth |
|  |  |  |
| Expand Down  Expand Up | | @@ -165,8 +164,6 @@ async def get(self, request: web.Request) -> web.Response: |
|  |  |  |
|  |  | providers = [] |
|  |  | for provider in hass.auth.auth\_providers: |
|  |  | additional\_data = {} |
|  |  |  |
|  |  | if provider.type == "trusted\_networks": |
|  |  | if cloud\_connection: |
|  |  | # Skip quickly as trusted networks are not available on cloud |
| Expand All | | @@ -179,30 +176,12 @@ async def get(self, request: web.Request) -> web.Response: |
|  |  | except InvalidAuthError: |
|  |  | # Not a trusted network, so we don't expose that trusted\_network authenticator is setup |
|  |  | continue |
|  |  | elif ( |
|  |  | provider.type == "homeassistant" |
|  |  | and not cloud\_connection |
|  |  | and is\_local(remote\_address) |
|  |  | and "person" in hass.config.components |
|  |  | ): |
|  |  | # We are local, return user id and username |
|  |  | users = await provider.store.async\_get\_users() |
|  |  | additional\_data["users"] = { |
|  |  | user.id: credentials.data["username"] |
|  |  | for user in users |
|  |  | for credentials in user.credentials |
|  |  | if ( |
|  |  | credentials.auth\_provider\_type == provider.type |
|  |  | and credentials.auth\_provider\_id == provider.id |
|  |  | ) |
|  |  | } |
|  |  |  |
|  |  | providers.append( |
|  |  | { |
|  |  | "name": provider.name, |
|  |  | "id": provider.id, |
|  |  | "type": provider.type, |
|  |  | \*\*additional\_data, |
|  |  | } |
|  |  | ) |
|  |  |  |
| Expand Down | |  |

36 changes: 4 additions & 32 deletions

36
[homeassistant/components/person/\_\_init\_\_.py](#diff-0727241d262c4baeb282e9c9bcfa2d40870efaa0dee914391cf0f6e678da9919 "homeassistant/components/person/__init__.py")

Show comments

[View file](/home-assistant/core/blob/dbfc5ea8f96bde6cd165892f5a6a6f9a65731c76/homeassistant/components/person/__init__.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,7 +2,6 @@ |
|  |  | from \_\_future\_\_ import annotations |
|  |  |  |
|  |  | from http import HTTPStatus |
|  |  | from ipaddress import ip\_address |
|  |  | import logging |
|  |  | from typing import Any |
|  |  |  |
| Expand Down  Expand Up | | @@ -51,12 +50,10 @@ |
|  |  | ) |
|  |  | from homeassistant.helpers.entity\_component import EntityComponent |
|  |  | from homeassistant.helpers.event import async\_track\_state\_change\_event |
|  |  | from homeassistant.helpers.network import is\_cloud\_connection |
|  |  | from homeassistant.helpers.restore\_state import RestoreEntity |
|  |  | from homeassistant.helpers.storage import Store |
|  |  | from homeassistant.helpers.typing import ConfigType |
|  |  | from homeassistant.loader import bind\_hass |
|  |  | from homeassistant.util.network import is\_local |
|  |  |  |
|  |  | \_LOGGER = logging.getLogger(\_\_name\_\_) |
|  |  |  |
| Expand Down  Expand Up | | @@ -588,33 +585,8 @@ class ListPersonsView(HomeAssistantView): |
|  |  |  |
|  |  | async def get(self, request: web.Request) -> web.Response: |
|  |  | """Return a list of persons if request comes from a local IP.""" |
|  |  | try: |
|  |  | remote\_address = ip\_address(request.remote) # type: ignore[arg-type] |
|  |  | except ValueError: |
|  |  | return self.json\_message( |
|  |  | message="Invalid remote IP", |
|  |  | status\_code=HTTPStatus.BAD\_REQUEST, |
|  |  | message\_code="invalid\_remote\_ip", |
|  |  | ) |
|  |  |  |
|  |  | hass: HomeAssistant = request.app["hass"] |
|  |  | if is\_cloud\_connection(hass) or not is\_local(remote\_address): |
|  |  | return self.json\_message( |
|  |  | message="Not local", |
|  |  | status\_code=HTTPStatus.BAD\_REQUEST, |
|  |  | message\_code="not\_local", |
|  |  | ) |
|  |  |  |
|  |  | yaml, storage, \_ = hass.data[DOMAIN] |
|  |  | persons = [\*yaml.async\_items(), \*storage.async\_items()] |
|  |  |  |
|  |  | return self.json( |
|  |  | { |
|  |  | person[ATTR\_USER\_ID]: { |
|  |  | ATTR\_NAME: person[ATTR\_NAME], |
|  |  | CONF\_PICTURE: person.get(CONF\_PICTURE), |
|  |  | } |
|  |  | for person in persons |
|  |  | if person.get(ATTR\_USER\_ID) |
|  |  | } |
|  |  | return self.json\_message( |
|  |  | message="Not local", |
|  |  | status\_code=HTTPStatus.BAD\_REQUEST, |
|  |  | message\_code="not\_local", |
|  |  | ) |

13 changes: 1 addition & 12 deletions

13
[tests/components/auth/test\_login\_flow.py](#diff-413165ae72f4ca09088bcbc211861d591a54cbe19192095291e3de479f76ef49 "tests/components/auth/test_login_flow.py")

Show comments

[View file](/home-assistant/core/blob/dbfc5ea8f96bde6cd165892f5a6a6f9a65731c76/tests/components/auth/test_login_flow.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,12 +1,10 @@ |
|  |  | """Tests for the login flow.""" |
|  |  | from collections.abc import Callable |
|  |  | from http import HTTPStatus |
|  |  | from typing import Any |
|  |  | from unittest.mock import patch |
|  |  |  |
|  |  | import pytest |
|  |  |  |
|  |  | from homeassistant.auth.models import User |
|  |  | from homeassistant.core import HomeAssistant |
|  |  | from homeassistant.setup import async\_setup\_component |
|  |  |  |
| Expand Down  Expand Up | | @@ -67,22 +65,16 @@ async def \_test\_fetch\_auth\_providers\_home\_assistant( |
|  |  | hass: HomeAssistant, |
|  |  | aiohttp\_client: ClientSessionGenerator, |
|  |  | ip: str, |
|  |  | additional\_expected\_fn: Callable[[User], dict[str, Any]], |
|  |  | ) -> None: |
|  |  | """Test fetching auth providers for homeassistant auth provider.""" |
|  |  | client = await async\_setup\_auth( |
|  |  | hass, aiohttp\_client, [{"type": "homeassistant"}], custom\_ip=ip |
|  |  | ) |
|  |  |  |
|  |  | provider = hass.auth.auth\_providers[0] |
|  |  | credentials = await provider.async\_get\_or\_create\_credentials({"username": "hello"}) |
|  |  | user = await hass.auth.async\_get\_or\_create\_user(credentials) |
|  |  |  |
|  |  | expected = { |
|  |  | "name": "Home Assistant Local", |
|  |  | "type": "homeassistant", |
|  |  | "id": None, |
|  |  | \*\*additional\_expected\_fn(user), |
|  |  | } |
|  |  |  |
|  |  | resp = await client.get("/auth/providers") |
| Expand All | | @@ -105,9 +97,7 @@ async def test\_fetch\_auth\_providers\_home\_assistant\_person\_not\_loaded( |
|  |  | ip: str, |
|  |  | ) -> None: |
|  |  | """Test fetching auth providers for homeassistant auth provider, where person integration is not loaded.""" |
|  |  | await \_test\_fetch\_auth\_providers\_home\_assistant( |
|  |  | hass, aiohttp\_client, ip, lambda \_: {} |
|  |  | ) |
|  |  | await \_test\_fetch\_auth\_providers\_home\_assistant(hass, aiohttp\_client, ip) |
|  |  |  |
|  |  |  |
|  |  | @pytest.mark.parametrize( |
| Expand All | | @@ -134,7 +124,6 @@ async def test\_fetch\_auth\_providers\_home\_assistant\_person\_loaded( |
|  |  | hass, |
|  |  | aiohttp\_client, |
|  |  | ip, |
|  |  | lambda user: {"users": {user.id: user.name}} if is\_local else {}, |
|  |  | ) |
|  |  |  |
|  |  |  |
| Expand Down | |  |

39 changes: 2 additions & 37 deletions

39
[tests/components/person/test\_init.py](#diff-aa252be67455a0f7e55fd71f89250b20ee9d49157ed7a7a0fb0701245adcdd74 "tests/components/person/test_init.py")

Show comments

[View file](/home-assistant/core/blob/dbfc5ea8f96bde6cd165892f5a6a6f9a65731c76/tests/components/person/test_init.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,4 @@ |
|  |  | """The tests for the person component.""" |
|  |  | from collections.abc import Callable |
|  |  | from http import HTTPStatus |
|  |  | from typing import Any |
|  |  | from unittest.mock import patch |
| Expand Down  Expand Up | | @@ -31,7 +30,6 @@ |
|  |  | from .conftest import DEVICE\_TRACKER, DEVICE\_TRACKER\_2 |
|  |  |  |
|  |  | from tests.common import MockUser, mock\_component, mock\_restore\_cache |
|  |  | from tests.test\_util import mock\_real\_ip |
|  |  | from tests.typing import ClientSessionGenerator, WebSocketGenerator |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -852,42 +850,10 @@ async def test\_entities\_in\_person(hass: HomeAssistant) -> None: |
|  |  | ] |
|  |  |  |
|  |  |  |
|  |  | @pytest.mark.parametrize( |
|  |  | ("ip", "status\_code", "expected\_fn"), |
|  |  | [ |
|  |  | ( |
|  |  | "192.168.0.10", |
|  |  | HTTPStatus.OK, |
|  |  | lambda user: { |
|  |  | user["user\_id"]: {"name": user["name"], "picture": user["picture"]} |
|  |  | }, |
|  |  | ), |
|  |  | ( |
|  |  | "::ffff:192.168.0.10", |
|  |  | HTTPStatus.OK, |
|  |  | lambda user: { |
|  |  | user["user\_id"]: {"name": user["name"], "picture": user["picture"]} |
|  |  | }, |
|  |  | ), |
|  |  | ( |
|  |  | "1.2.3.4", |
|  |  | HTTPStatus.BAD\_REQUEST, |
|  |  | lambda \_: {"code": "not\_local", "message": "Not local"}, |
|  |  | ), |
|  |  | ( |
|  |  | "2001:db8::1", |
|  |  | HTTPStatus.BAD\_REQUEST, |
|  |  | lambda \_: {"code": "not\_local", "message": "Not local"}, |
|  |  | ), |
|  |  | ], |
|  |  | ) |
|  |  | async def test\_list\_persons( |
|  |  | hass: HomeAssistant, |
|  |  | hass\_client\_no\_auth: ClientSessionGenerator, |
|  |  | hass\_admin\_user: MockUser, |
|  |  | ip: str, |
|  |  | status\_code: HTTPStatus, |
|  |  | expected\_fn: Callable[[dict[str, Any]], dict[str, Any]], |
|  |  | ) -> None: |
|  |  | """Test listing persons from a not local ip address.""" |
|  |  |  |
| Expand All | | @@ -902,11 +868,10 @@ async def test\_list\_persons( |
|  |  | assert await async\_setup\_component(hass, DOMAIN, config) |
|  |  |  |
|  |  | await async\_setup\_component(hass, "api", {}) |
|  |  | mock\_real\_ip(hass.http.app)(ip) |
|  |  | client = await hass\_client\_no\_auth() |
|  |  |  |
|  |  | resp = await client.get("/api/person/list") |
|  |  |  |
|  |  | assert resp.status == status\_code |
|  |  | assert resp.status == HTTPStatus.BAD\_REQUEST |
|  |  | result = await resp.json() |
|  |  | assert result == expected\_fn(admin) |
|  |  | assert result == {"code": "not\_local", "message": "Not local"} |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `dbfc5ea`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhome-assistant%2Fcore%2Fcommit%2Fdbfc5ea8f96bde6cd165892f5a6a6f9a65731c76) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_79364710_20250114_191128.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhome-assistant%2Fcore%2Fsecurity%2Fadvisories%2FGHSA-jqpc-rc7g-vf83)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhome-assistant%2Fcore%2Fsecurity%2Fadvisories%2FGHSA-jqpc-rc7g-vf83)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=home-assistant%2Fcore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[home-assistant](/home-assistant)
/
**[core](/home-assistant/core)**
Public

* [Notifications](/login?return_to=%2Fhome-assistant%2Fcore) You must be signed in to change notification settings
* [Fork
  31.9k](/login?return_to=%2Fhome-assistant%2Fcore)
* [Star
   75.8k](/login?return_to=%2Fhome-assistant%2Fcore)

* [Code](/home-assistant/core)
* [Issues
  2.9k](/home-assistant/core/issues)
* [Pull requests
  482](/home-assistant/core/pulls)
* [Actions](/home-assistant/core/actions)
* [Projects
  2](/home-assistant/core/projects)
* [Security](/home-assistant/core/security)
* [Insights](/home-assistant/core/pulse)

Additional navigation options

* [Code](/home-assistant/core)
* [Issues](/home-assistant/core/issues)
* [Pull requests](/home-assistant/core/pulls)
* [Actions](/home-assistant/core/actions)
* [Projects](/home-assistant/core/projects)
* [Security](/home-assistant/core/security)
* [Insights](/home-assistant/core/pulse)

# User accounts disclosed to unauthenticated actors on the LAN

Moderate

[frenck](/frenck)
published
GHSA-jqpc-rc7g-vf83
Dec 14, 2023

## Package

No package listed

## Affected versions

< 2023.12.2

## Patched versions

2023.12.3

## Description

### Summary

The login page discloses all active user accounts to any unauthenticated browsing request originating on the Local Area Network.

### Details

Starting the [Home Assistant 2023.12 release](https://www.home-assistant.io/blog/2023/12/06/release-202312/), the login page returns all currently active user accounts to browsing requests from the Local Area Network. Tests showed that this occurs when:

* The request is not authenticated and
* The request originated locally, meaning on the Home Assistant host local subnet or any other private subnet (`10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, fd00::/8, ::ffff:10.0.0.0/104, ::ffff:172.16.0.0/108, ::ffff:192.168.0.0/112`)

The rationale behind this is to make the login more user-friendly (see [release blog post](https://www.home-assistant.io/blog/2023/12/06/release-202312/)) and an experience better aligned with other applications that have multiple user-profiles.

However, as a result, all accounts are displayed regardless of them having logged in or not and for any device that navigates to the server. This disclosure is mitigated by the fact that it only occurs for requests originating from a LAN address. But note that this applies to the local subnet where Home Assistant resides and to any private subnet that can reach it.

### PoC

1. Place a Home Assistant instance on a private subnet, i.e., 192.168.1.0/24.
2. Create a few users, let's say, three.
3. From any (or another) private subnet on the LAN, like 192.168.2.0/24, open an incognito browser window (to ensure that the browser has no cookies from Home Assistant and therefore is demonstrably unauthenticated) and navigate to the Home Assistant URL.
4. The login page will display all three users, including their profile photo.

### Impact

The following CVSS string could be shaped to describe the overall impact of this issue:

AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

As seen, the Exploitability metrics are high, and the Impact metrics are low. This is fitting because the problem does not constitute a critical one, but at the same time, it is trivial to exploit. Still, since the mitigation can be so easily implemented in code to eliminate a typical case of information disclosure, it would certainly be worth pursuing.

### Severity

Moderate

4.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Adjacent

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

### CVE ID

CVE-2023-50715

### Weaknesses

No CWEs

### Credits

* [![@r01k](https://avatars.githubusercontent.com/u/19595786?s=40&v=4)](/r01k)
  [r01k](/r01k)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


