=== Content from www.scitepress.org_92e42e1f_20250114_210842.html ===
SmartBulbsCanBeHackedtoHackintoYourHouseholdDavideBonaventura1a,SergioEsposito2bandGiampaoloBella1c1DipartimentodiMatematicaeInformatica,Universit`adiCatania,Catania,Italy2InformationSecurityGroup,RoyalHolloway,UniversityofLondon,Egham,U.K.Keywords:IoT,SmartHomes,SmartDevices,SmartBulb,PenetrationTest,VulnerabilityAssessment.Abstract:TheIoTisgettingmoreandmorepervasive.Eventhesimplestdevices,suchasalightbulboranelectricalplug,aremade“smart”andcontrollablebyoursmartphone.ThispaperdescribesthefindingsobtainedbyapplyingthePETIoTkillchaintoconductaVulnerabilityAssessmentandPenetrationTestingsessiononasmartbulb,theTapoL530EbyTp-Link,currentlybestselleronAmazonItaly.Wefoundthatfourvulnera-bilitiesaffectthebulb,twoofHighseverityandtwoofMediumseverityaccordingtotheCVSSv3.1scoringsystem.Inshort,authenticationisnotwellaccountedforandconfidentialityisinsufficientlyachievedbytheimplementedcryptographicmeasures.Inconsequence,anattackerwhoisnearbythebulbcanoperateatwillnotjustthebulbbutalldevicesoftheTapofamilythattheusermayhaveonherTapoaccount.Moreover,theattackercanlearnthevictim’sWi-Fipassword,therebyescalatinghismaliciouspotentialconsiderably.Thepaperterminateswithanoutlineofpossiblefixes.1INTRODUCTIONTheInternetofThings(IoT)surroundspeoplevirtu-allyeverywhereduetotheincreasingnumberofde-vicesthatbecomecomputerisedandinterconnected—itmayevenpervadepeople’sbodiesthankstotheriseofimplantablemedicaldevicesandwearabledevices.IoTdevicesexceeded13.8billionin2021andareexpectedtodoubleby2025(Howarth,2023).Thisworldofdevicesleadstoamassiveattacksur-facewithasignificantincreaseinthenumberofen-trypointsforhackersand,correspondingly,securityandprivacychallengesforresearchersandengineerstoface.WhilethefullrangeandinherentdiversityofIoTdevicescannotbeoverestimated,safetycriticalde-vices,suchasself-drivingcars,IndustrialControlSystems(ICS)andtheirsecurityandprivacychal-lenges,riskdrawingtoomuchattentiontothedetri-mentofinexpensivedevices,suchasthoseforhomeautomation.Itmustbestressedthatanyhomeau-tomationissuewouldbehighlyimpactfulduetotheenormoususeofsuchdevicesworldwide,whichisalsofavouredbyageneralpricedecrease.Weobservethatsimilarconsiderationsapplytoahttps://orcid.org/0009-0004-4463-7991bhttps://orcid.org/0000-0001-9904-9821chttps://orcid.org/0000-0002-7615-8643smartbulbs,whosehijackingmayhavesecurityim-plications,e.g.,helpathiefabusethevictim’selec-tricityconsumption,thenprivacyimplications,e.g.,helpthethiefprofilethevictim’spatternsofusagehencetheirhabitsand,ultimately,safetyimplications,e.g.,ultimatelyhelpthethiefunderstandifahouse-holdiscurrentlyemptyornot.Followingtheseob-servations,thispaperrestsonthefollowingresearchquestion:Whatvulnerabilitiesaffectbest-sellerlightbulbs?Whatconsequencesdotheyhaveontheenduser’ssecurity,privacyandsafety?1.1ContributionsOurexperimentsapplythe(stepsofthe)PETIoTkillchain(Bellaetal.,2023)toconductaVulnerabilityAssessmentandPenetrationTesting(VAPT)ontheTp-LinkTapoSmartWi-FiLightBulb,Multicolor(L530E),currentlybest-selleronAmazonItaly,Fig-ure1.TheTapoL530Eisacloud-enabledmulticolorSmartBulbthatcanbecontrolledthroughtheTapoproprietaryapplication.TheuserneedstoinstallitonanAndroidoriOSmobiledeviceandthencre-ateaTapoaccount.ThesmartbulbusesWi-Fitech-nologyforconnectivity.So,unlikemanyothersmartbulbsrequiringadedicatedhub,theusercanenjoytheL530EasisbysimplyconnectingittotheirhomeWi-Finetwork.218Bonaventura,D.,Esposito,S.andBella,G.SmartBulbsCanBeHackedtoHackintoYourHousehold.DOI:10.5220/0012092900003555InProceedingsofthe20thInternationalConferenceonSecurityandCryptography(SECRYPT2023),pages218-229ISBN:978-989-758-666-8;ISSN:2184-7711Copyrightc(cid:13)2023bySCITEPRESS–ScienceandTechnologyPublications,Lda.UnderCClicense(CCBY-NC-ND4.0)Figure1:TheTapoL530EonAmazon.it.Contrarilytoapotentialbeliefthatsmartbulbsarenotworthprotectingorhacking,wefoundoutthatthismodelsuffersfourvulnerabilitiesthatarenottriv-ialand,mostimportantly,mayhaveadramaticim-pact:1.Vulnerability1.LackofauthenticationofthesmartbulbwiththeTapoapp,8.8CVSSscore,Highseverity.Theappdoesnotgetanyguaranteeabouttheidentityofitspeer.Therefore,anyonecanauthenticatetotheappandpretendtobethesmartbulb.2.Vulnerability2.Hard-coded,shortsharedsecret,7.6CVSSscore,Highseverity.ThesecretusedbyboththeTapoappandthesmartbulbisshortandexposedbyboththecodefragmentsrunbytheappandbythesmartbulb.3.Vulnerability3.Lackofrandomnessduringsymmetricencryption,4.6CVSSscore,Mediumseverity.Theinitialisationvectors(IVs)usedbytheTapoappandthesmartbulbarestatic,andeachcommunicationsessionusesasingle,fixedIVforeachmessage.4.Vulnerability4.Insufficientmessagefreshness,5.7CVSSscore,Mediumseverity.Neithertheappnorthesmartbulbimplementsappropriatemeasurestocheckthefreshnessofmessagesthattheyreceive.Ourexploitationexperimentsofsuchvulnerabilitiesdemonstratethatamaliciousattackerwhostandsinproximityofthetargetsmartbulb,henceoftheWi-Fiaccesspointtowhichthebulbismeanttobecon-nected,canexploitthebulbinvariousways.Vul-nerability1meansthattheattackerimpersonatesthebulbandreceivestheuser’sTapocredentialsaswellastheuser’sWi-FicredentialsfromtheTapoapp.Toachievethis,thebulbmustbeinsetupmode,whenitexposesitsownSSID.Alternatively,ifthebulbisalreadyconfiguredandworking,thentheat-tackermountsasimpleWi-Fideauthenticationattackagainstthebulbandrepeatsituntiltheuserattemptstosetupthebulbagaintorestoreit.Theattackermayalsointerleaveanothersession:byleveragingthecredentialsjustobtained,heimper-sonatestheuserthroughthesetupofthebulbandre-ceivesasessionkeyfromthedevice,whichhemaythenrelaybacktotheuser.Therefore,theattackeref-fectivelymountsaman-in-the-middleattack.More-over,duringdevicesetup,theTapoappalsoreleasestheWi-Ficredentialstotheattacker,therebycausingaclearescalationofthemaliciouspotentialforotherattacksrequiringlocalaccess.Vulnerability2meansthattheattackercanobtainthekeythattheTapoappandthesmartbulbshareandusefortheauthenticationandtheintegrityofthemes-sagesexchangedduringtheinitialdiscoveryphase,describedinSection5.1.Thankstotheknowledgeofthekey,theattackercanviolatetheintegrityandauthenticationofthemessagesofthisphase.Vulnerability3meansthattheattackerunder-standstheconsequencesofcertainencryptedmes-sagesonthetargetdevicedespitethefactthathedoesnotunderstandtheprecisecleartextinsideeachmes-sage.Therefore,theattackermayattempttore-usethosemessagesatwilltooperatethedeviceaseachmessagedetermines.Incombinationwithvulnerabil-ity4,theattackerisassuredthatwhatevermessagehereplayswillbeacceptedbythebulb,henceaDenial-of-Service(DoS)attackbecomespossible.1.2EthicsandResponsibleDisclosureAllexperimentsperformedonTapoL530Eonlyin-volvedevices,Wi-Finetworks,accounts,emails,andpasswordsownedsolelybytheauthorsofthiswork.Duringtheexperiments,nousernorthird-partydatawereaccessed.WedutifullycontactedTp-LinkviatheirVulner-abilityResearchProgram(VRP),reportingallfourvulnerabilitieswefound.Theyacknowledgedallofthemandinformedusthattheystartedworkingonfixesbothattheappandatthebulbfirmwarelevels,planningtoreleasetheminduecourse.1.3PaperSummaryThispapercontinueswithashortaccountofthere-latedwork(§2).Itthenunfoldsthesixphasesofthechosenmethodology,i.e.,thePETIoTkillchain,onSmartBulbsCanBeHackedtoHackintoYourHousehold219thechosentarget,i.e.,theTapoL530E(§3through§8).Finally,itdrawstherelevantconclusions(§9).2RELATEDWORKThesecurityandprivacyaspectsofIoTdevicesarebecomingmoreandmoreimportantand,correspond-ingly,therelatedworkconcerningsuchdevicesisverywide.Duetospaceconstraints,thissectionisreducedtotheliteratureentriesthataremostrelevanttothecoreofthispaper.In2021,itwasshownthatprintersarecommondeviceswhosenetworkedusemaysufferatleastthreeattacks(BellaandBiondi,2019).Thefirstattack,zombiesfortraditionalDDoS,showshowsomeprint-ersmaysufferfromvulnerabilitiesthatwouldtrans-formthemintoexploitablezombies.Thesecondat-tack,paperDoS,showshowalargenumberofprint-ersarefoundtohonourunauthenticatedprintingre-quests.Thethirdattack,privacyinfringement,showshowthesedevicesbeararemarkableriskofdatabreach.Later,thesameauthorscontributedtosim-ilarexperimentsagainstVoIPphones(Biondietal.,2020).Ourworkfollowsasimilarmethodology.In2022,aliteraturesurveyforunderstandingIoTsecuritythreatsandchallengesappeared(NathandNath,2022).Itisdividedintothreeparts.Thefirstpartcontainsananalysisofthemainthreatsandat-tacks,alsoanalysingtheIoTecosystemfromfourper-spectives:devices,internalnetworkservices,externalnetworkservicesandusers.ThesecondpartcontainsastudyonrecentIoTmalwareattacks.Finally,thegeneralsecurityrequirementsandchallengestoad-dressthedevisedattackcategoriesarediscussed.Thisworkwasinspirationalforourexperiments.PETIoTisarecentcyberKillChain(KC)specifi-callydevelopedtoguideVAPTsessionsoverIoTde-vices(Bellaetal.,2023)withafocusondetectingtheirnetworkvulnerabilities.TheKCisdemonstratedontheTapoC200IPcamerabyTp-Link,enablingthediscoveryofthreeseverevulnerabilities:Improperneutralisationofinboundpackets;Insufficiententropyinencryptednotifications;Cleartexttransmissionofvideostream.Eachofthevulnerabilitiesfoundisex-ploitedthroughdifferentattackscenarios,andappro-priateremediationmeasuresareillustratedaspossiblefixes.WefollowedPETIoTstrictlythroughourwork,ascanbeseenbythestepsdiscussedbelow.In2018,apenetrationtestingsessionontheTrad-frismartbulbproducedbyIKEAwasreported(Dalvietal.,2018).Thearticledescribesfourdifferentat-tacks.HackingSmartLightBulbviaBluetoothal-lowstheattackertocontrolthebulb.IKEATradfriGatewayExploitallowstheattackertocompromisetheZigBeeTradfrigatewaybymanagingtobreakthefirmwareupdate.DenialofServiceAttackallowstheattackertoperformaDoSattackagainstthegatewaybyfloodingitwithUDPpackets.IdentitySpoofingal-lowstheattackertoimpersonatetheCoAPclientandcontrolthesmartbulbs.ThisworkiscloselyrelatedtooursbutrevolvesaroundtheZigBeeprotocolanddoesnotachieveescalationtolocalWi-Fiaccess.3EXPERIMENTSETUPWebegindefiningtheexperimentsetup,accordinglywiththePETIoTkillchain.Oursetupisnon-invasive,asthesmartbulbisnottamperedwith.Itincludes:•AWi-Fiswitchtoprovidelocalconnectivity.•ASmartbulbTaposeriesL530withHardwareVersion1.0.0andFirmwareVersion1.1.9.•ASamsungsmartphonerunningAndroid11andtheTapoappVersion2.8.14.•AnUbuntu22.04machinewith5.15.0-47kerneltorunallsoftwareneededfortheexperiments.Tobeabletouseallthebulbfeatures,itisnecessarytocreateaTapoaccountandloginintoit.DependingonwhetherthesmartbulbisalreadyassociatedwithaTapoaccountornot,andthenetworkconfigurationused,weidentifythreedifferentsetups.Inallthreesetups,thesmartphonehasaccesstotheTapoaccounttowhichthesmartbulbisassociated,ortowhichtheuserwantstoassociateit.3.1SetupAThecontextoftheSetupAisasfollows.•TheuserhaspreviouslyassociatedhersmartbulbwiththeTapoapponherphone.Duringtheasso-ciationprocess,theuserconnectsthesmartbulbtoacertainnetworkX.•TheUbuntudeviceandtheuser’sphonearebothconnectedtothesamenetworkYasshowninFig-ure2—thisisnotnecessarilythenetworkXtowhichtheTapoL530Eisconnected.ThissetupdoesnotrequiretheUbuntudevicetohaveaccesstothenetworktowhichthesmartbulbisconnected,butonlytobeconnectedtothesamenetworkastheTapoapp.Therefore,theusercould,forexample,connecttoapublicnetworktoturnoffalightthatmayhavebeenmistakenlyleftonathome.SECRYPT2023-20thInternationalConferenceonSecurityandCryptography220Figure2:SetupA,networkwithoutalocalsmartbulb.3.2SetupBThecontextoftheSetupBisasfollows.•TheuserhaspreviouslyassociatedhersmartbulbwiththeTapoapponherphone.Duringtheasso-ciationprocess,theuserconnectsthesmartbulbtoacertainnetworkX.•TheUbuntudeviceandtheuser’sphonearebothconnectedtothesamenetworkXtowhichthesmartbulbisconnected,asshowninFigure3.•TheUbuntudevicehascompletecontrolofthenetworkX.ItisabletocarryoutanARPspoof-ingattack,i.e.,tointerceptdataframes,modifythenetworktrafficorpreventitfromreachingitsintendedrecipient.Figure3:SetupB,networkwithaconfiguredsmartbulb.Thissetuprequirestheactivepresenceofthesmartbulb.Inaddition,thesetuprequirestheUbuntudevicetohaveaccesstothenetworktowhichthesmartbulbisconnected,typicallythevictim’slocalnetwork.Therefore,alldevicesusedareconnectedviaWi-Fitothesameaccesspoint.3.3SetupCThecontextoftheSetupCisasfollows.•TheuserwantstoassociatethenewlyresetornotyetconfiguredsmartbulbwithherTapoaccount.•TheTapoapp(hence,theuser)believestobecon-nectedtothenetworkXcreatedbythesmartbulb,butitisactuallyconnectedtoanetworkYcon-trolledbytheUbuntudevice.•TheUbuntudeviceisconnectedbothtothenet-workcreatedbythesmartbulbandtothenetworkcontrolledbyitself.Thissetupoccurswhenthesmartbulbhasbeenre-setorhasnotbeenconfiguredyet.AsdetailedinSec-tion5.3.1,thesmartbulbstartsapublicaccesspointtowhichtheusermustconnecttocompletethesetup.ThenetworkconfigurationisshowninFigure4.Figure4:SetupC,networkwithanon-configuredbulb.TheWi-Fideauthenticationattackallowstheat-tackertoeasilygetSetupC.AWi-Fideauthenticationattackisatypeofdenial-of-serviceattackthattargetscommunicationsbetweenadeviceandaWi-Fiwire-lessaccesspoint(KristiyantoandErnastuti,2020).Thankstothisattack,theattackercandeauthenticatethesmartbulbfromthenetworktowhichitiscon-nected,forcingtheusertorepeatitssetupprocess.TheWi-Fideauthenticationattackrequirestheaccesspointandconnecteddevicesnottouse802.11worWPA3.Althoughinliteraturethereareothertheoret-icallyfeasiblemethodstoperformthedeauthentica-tionattackanyway(Schepersetal.,2022),wedidnottestthem.InSetupC,weassumethatthenetworktowhichthesmartbulbisconnectedisanetworkwherethedeauthenticationattackcanbeperformed.OnewaytomountitwouldbetoleverageAircrack-ng(d’OtreppedeBouvette,2023),asdescribedinablog(Alopix,2023).Theattackrequirestheadver-sarytoknowthevictimdevice’sMACaddress,how-ever,itispossibletolistallMACaddressesconnectedtonearbyaccesspointsbysimplylisteningtothetraf-SmartBulbsCanBeHackedtoHackintoYourHousehold221fic,sotheadversaryhasashortandfinitelistofad-dressestotry.Afterthevictimresetsthesmartbulb,itenterssetupmode.InSetupC,theUbuntudeviceneedstheTapoapptoconnecttothenetworkitcontrolsandnottothenetworkstartedbythesmartbulb—hence,theadversaryperformsanotherWi-Fideau-thenticationattacktodeauthenticatethephonerun-ningtheTapoappfromthenetworkstartedbythesmartbulb,arguablyinducingthevictimtore-attempttoconnect,eventuallyusingtheadversary-controllednetworkwiththesameSSID.AsthenetworkstartedbythesmartbulbisanunprotectedWi-Fi4(802.11n)network,inthislattercasethedeauthenticationat-tackwillalwayswork.Intuitively,thissetupassumesthattheUbuntudeviceiscloseenoughtothenetworkstartedbythesmartbulbtoheartheemittedcarrier.4INFORMATIONGATHERINGAfterthesetupwecanproceedtothecollectionofinformation.ThefollowingtoolsareinstalledontheUbuntudevice:•Ettercap(Ettercap,2023),asuiteoftoolstoper-formMITMattacksusedontheUbuntudevicetocontrolthenetwork.•Wireshark(Wireshark,2023),anetworkprotocolanalyser(orpacketsniffer)usedtocaptureandanalysetraffic.Thesmartbulbfirmwaresourcecodeisnotpubliclyavailable.Therefore,theoffensiveactivitiesareper-formedinblack-boxmode.ThankstothemessagescapturedwithWiresharkitispossibletodistinguishbetweenthreedifferenttypesofcommunications.Theydifferaccordingtothesenderandthereceiverofthevariousmessagesbe-longingtothem.Thethreedifferenttypesofcommu-nicationsweidentifiedare:(a)communicationsApp-Cloud,includingallmessagesexchangedbetweentheTapoAppandtheCloudServer;(b)communicationsBulb-App,includingallmessagesexchangedbetweenthesmartbulbandtheTapoApp;(c)communica-tionsCloud-Bulb,includingallmessagesexchangedbetweentheCloudServerandthesmartbulb.WhenthephonerunningtheTapoappisnotconnectedtothesamenetworkasthelightbulb,communicationshappenthroughthecloud,combiningApp-CloudandCloud-Bulbcommunications–otherwise,theytakeplacelocallywithBulb-Appcommunications.Allcommunicationsthroughthecloud,i.e.,App-CloudandCloud-Bulb,areencrypted.TheytakeplacethroughtheuseofasecureTLSchannelthatensuresauthenticity,integrity,andconfidentialityofthemessages,eventhoughtheyaretransmittedovertheInternet.Instead,allBulb-AppcommunicationsareexchangedviaHTTPmessages.TheirpayloadsareencryptedusingtheAES128blockcipherinCBCmode.TheinitialisationvectorandthecryptographickeyusedforthisprotocolareexchangedusingtheTapo“SymmetricKeyExchangeProtocol”(TSKEP),whichisdescribedbelowinSection5.2.Thispro-tocolonlygeneratestrafficoverthelocalWi-Finet-work,notthroughtheInternet.OuroffensiveactivitiesonlytargetBulb-Appcom-munications,andignoretheothers.5TRAFFICANALYSISThankstotheinformationobtainedduringtheprevi-ousphase,itisnowpossibletoanalysethenetworktrafficprofitably.TheAPIexposedbythesmartbulbisverysim-ilartoaRemoteProcedureCall(RPC).TheJSONsentbytheapptothesmartbulbcontainsthenameofthemethodtobeinvokedanditsparameters.Theresponsessentbythesmartbulbtotheappcontainanerrorcoderepresentingtheoutcomeoftheopera-tion(whetheritwassuccessfullyexecutedortheerroroccurred)withanoptionalresult.AllJSONsareex-changedviathepayloadsofHTTPmessages.BeforetheTapoappstartsusingtheAPIexposedbythebulb,itmustperformtwopreliminarysteps:locatethesmartbulbwithinthenetworktowhichitisconnected,andexchangeasymmetrickeywiththesmartbulbtoencryptmessages.Therefore,thecom-municationbetweensmartbulbandTapoappcanbesummarisedinthreemacro-steps:•BulbDiscovery–itallowstheTapoapptolocatethesmartbulbwithinthelocalnetworkandtogetthesmartbulb’scurrentconfiguration.•TapoSymmetricKeyExchangeProtocol–execut-ingtheTSKEPprotocolallowstheTapoappandsmartbulbtoexchangeasymmetrickey.•Smartbulbusage–itconsistsinusingtheactualsmartbulbappprotocol.Thesemacro-stepsaredescribedindetailbelow.5.1BulbDiscoverySmartbulbconfigurationsmaychangeovertime.Forexample,theIPaddressassignedtoitbytheDHCPservermighthavechanged,itmightstartusingadif-ferentencryptionschemeafteranupdate,oritmighthavejustbeenreset.BeforetheTapoappcanstartSECRYPT2023-20thInternationalConferenceonSecurityandCryptography222communicatingwiththesmartbulb,itmustlocatethesmartbulbwithinthelocalnetworkandgetitscur-rentconfiguration.Todothis,theTapoappconnectstotheUDPservicelisteningonthe20002portofthesmartbulb,asrepresentedinFigure5.Figure5:Tapo(local)Devicedicovery.ThepayloadformatofsuchUDPmessagesisrep-resentedinTable1.Itcanbeexplainedasfollows:•Bytesinpositions[0:3]and[6:7]arestatic.Theirvaluesneverchange.•Thedatalengthfieldcontainsthelengthofthedatafield,whichcontainsthedataexchangedbe-tweenTapoappandsmartbulb.Whenthedatafieldisempty(i.e.,whenithaslength0)thebitsofthisfieldareallsetto0.•Thenoncefieldcontainsa4-bytestringrandomlygeneratedbytheTapoapp.ThestringisinsertedinthebulbdiscoveryrequestmessagefromtheTapoappandquotedbythesmartbulbinthebulbdiscoveryresponsemessagefromthesmartbulb.ThisallowstheTapoapptoobtainguaran-teesaboutthefreshnessoftheresponsereceivedfromthesmartbulb.•Logically,thechecksumfieldmustbeexcludedfromthecomputationofthechecksumitself—instead,asecretkeyofthesamelengthisusedinitsplaceforthechecksumcomputation.Thisse-cretkeyishard-codedinboththeTapoappandthesmartbulb,hence,thechecksumactslikeaMessageAuthenticationCode(MAC).Thisfieldallowsthereceivertounderstandthatthemessagearrivesintactasitissent.ThealgorithmusedforthechecksumcalculationistheCyclicRedun-dancyCheck32(CRC-32),achecksumalgorithmthathashesbytesequencesto32bitvalues.•Thedatafieldcontainsdifferentinformationde-pendingonwhetheritisabulbdiscoveryre-questorabulbdiscoveryresponseandwhetherthesmartbulbisconfiguredornot.Table1:FormatofthepayloadofUDPmessages.Octet0123Offset00x020x000x000x014Datalength0x110x008Nonce12Checksum...Data5.2TapoSymmetricKeyExchangeProtocolThisstepusestheRPCAPIexposedbythesmartbulbonport80.AllexchangedmessagesareHTTPmes-sages,soatthetransportlayer,onlytheTCPproto-colisused.TheTSKEP,representedinFigure6,al-lowsTapoappandsmartbulbtoexchangea128-bitAESkeyandanIVtoencryptthepayloadofvariousHTTPmessages.Theprotocolconsistsoffourdiffer-entmessages:1.RSApublickeytransmission2.AESkeytransmission3.Login4.TokentransmissionFigure6:TapoSymmetricKeyExchangeProtocol.Attheendofthisphase,Tapoappandsmartbulbgetashort-termsharedsecrettoencryptallsubse-quenttraffic.Thankstothecredentialstoredduringthesetupphase,forthesmartbulbthesecretisalsoauthenticated.5.3SmartBulbSetupThissectionfocusesonthetwopossibleconfigura-tionsforthesmartbulbandspecifiesthemindepthfollowingourtrafficanalysisefforts.SmartBulbsCanBeHackedtoHackintoYourHousehold2235.3.1SmartBulbTurnedonandnotConfiguredBeforeasmartbulbTapoL530Ecanbeused,itmustbeassociatedwithaTapoaccount.Therearetworea-sonswhyasmartbulbmaynotbeassociatedwithanyaccounts:becauseithasbeenreset,orithasnotbeenconfiguredyet.InthisSection,wediscusstheprocessofassociatingthesmartbulbwithaTapoaccount.AnunconfiguredornewlyresetsmartbulbstartsapublicaccesspointwithSSIDTapoBulbXXXX,whereXXXXarefourdecimalplaces.Thesmartbulbalsoactsasaswitchwithinthenetworkitgenerates.InordertoconfigureitandassociateitwiththeirTapoaccount,theusermustconnecttotheWi-Finetworkstartedbythesmartbulbitself.Afterthat,theTapoapptriestolocatethesmartbulb.Todothis,itstartssendingbulbdiscoveryre-questmessagestobroadcast.Inthiscase,thedatafieldofthesemessagesisempty.Aftertheidentifica-tionofthesmartbulb,theTapoappstartstheTSKEPprotocolwithit.ThevaluessetintheloginmessageasusernameandpasswordarefixedvaluesthattheTapoappuseseverytimeitconfiguresanewdevice.Oncethesymmetrickeyisobtained,TapoappsendstothesmartbulbtheSSIDandthepasswordoftheWi-Finetworktowhichthesmartbulbmustconnect.TheTapoappalsosendsthecredentialsoftheTapoaccounttowhichitmustbeassociated.Thecredentialsarethenstoredbythesmartbulb.Throughthesecredentials,smartbulbisabletoauthenticateallsubsequentrequestsofTapoapp.Atthispoint,thesmartbulbturnsitsaccesspointoffandconnectstothespecifiedWi-Finetwork.Thesmartbulbstartscommunicatingwiththecloudservertocompleteitssetup.Hence,theWi-FinetworktowhichthesmartbulbconnectsmusthaveInternetaccess.5.3.2SmartBulbAlreadyConfiguredLetusnowconsiderthecasewherethesmartbulbisassociatedwithaTapoaccountanditisreadytobeused.Asmentionedbefore,itcanbecontrolledeitherlocallyorremotelyviatheTapocloud.Todoso,theTapoapplicationinitiallytriestolocatethesmartbulbwithinthenetworkwithabulbdiscoveryrequestmes-sage.Ifitdetectsit(i.e.,itgetsaresponse)thentheinteractionhappenslocallyviaBulb-Appcommuni-cations,whicharethesubjectofouranalysis.Other-wise,iftheTapoappdoesnotreceiveanyvalidbulbdiscoveryresponse,thenittriestocheckthesmartbulbremotely.Ifthesmartbulbisnotdetectableevenremotelythenitisdeterminedoffline.6VULNERABILITYASSESSMENTTheassessmentfollowingtheinformationgatheredsofarhighlightsfourvulnerabilities.Vulnerability1–LackoftheSmartBulbAuthen-ticationwiththeTapoApp.ImproperAuthentica-tion(MITRE,2006a)inTapoL503Eallowsanadja-centattackertoimpersonatetheTapoL530EwiththeTapoappduringtheTSKEPstep.IntheTSKEPstep,unliketheBulbDiscoverystep,theprotocolusedtoexchangethesessionkeydoesnotgivetheTapoappanyevidenceofitspeer’sidentity.Hence,anattackerisabletoauthenticatetotheTapoappastheTapoL530Eorasanotherdevice:infact,thisvulnerabilityispresentinallTaposmartdevicesthatusetheTSKEPprotocol.TheCVSSv3.1scorethatwecalculateis8.8,meaningHighseverity.Precisely:AttackVector:Adjacent;AttackComplexity:Low;PrivilegesRe-quired:None;UserInteraction:Required;Scope:Changed;Confidentiality:High;Integrity:High;Availability:High.Inparticular,AttackComplex-ityislowbecausetheattackercouldimpersonatethebulbbyimplementingtheprotocolmessagestore-spondtothecallingapp.Followingthat,hecouldobtaintheuserpasswordontheTapoapp,thenfullyimpersonatetheuserandmanipulateatwillanytargetTapodeviceofthesameuser.Precisely,byimperson-atingthebulbatsetuptimeasexplainedabove,theattackerwouldreceivethevictim’sWi-FiSSIDandpasswordfromtheTapoapp,sothathecouldthenimpersonatetheuserbyherpasswordateachsessionwiththetargetdevice,whichcouldbeanyTapode-viceoftheuser’s.Theattackercouldalsoobtainthedevice-chosensessionkey,whichhecouldthenrelaytotheuser’sgenuineappandeffectivelyinterpose.Vulnerability2–Hard-CodedShortCheck-sumSharedSecret.ProtectionMechanismFail-ure(MITRE,2008)inTapoL503EallowsanadjacentattackertoobtainthesecretusedforauthenticationduringtheBulbDiscoveryphase.ThesharedsecretusedforBulbDiscovery’smes-sagesauthenticationisshortandhard-codedbothintheTapoappandintheTapoL530E.Therefore,itcanbeobtainedinthefollowingways:1.Brueforcing,becauseofitsshortness.2.DecompilingtheTapoapp.TheCVSSv3.1scorethatwecalculateis7.6,meaningHighseverity.Precisely:AttackVector:SECRYPT2023-20thInternationalConferenceonSecurityandCryptography224Adjacent;AttackComplexity:Low;PrivilegesRe-quired:None;UserInteraction:Required;Scope:Unchanged;Confidentiality:Low;Integrity:High;Availability:High.Theknowledgeofthesharedse-cretprovidestotheattackertheabilitytoeditandtocreateBulbDiscoverymessages.Specifically,theat-tackerisabletogeneratefakebulbdiscoveryrequeststolocateallsmartbulbs,orgenerallyTapodevicesus-ingthesameprotocol,connectedwithinthesamenet-work.Meanwhile,theabilitytoeditvalidmessagesallowstheattackertoeditthebulbdiscoveryresponsemessagessentfromthesmartbulbtotheTapoapp.Vulnerability3–LackofRandomnessDuringSymmetricEncryption.UseofaCryptographicPrimitivewithaRiskyImplementation(MITRE,2020)inTapoL503Eallowsanadjacentattackertomakethecryptographicschemedeterministic.TheIVusedinAES128-CBCschemeisgeneratedtogetherwiththekeyandremainsunchangedfortheentirelifeofthekey.Therefore,theencryptionofthesamemessagesproducesthesameciphertext.TheCVSSv3.1scorethatwecalculateis4.6,meaningMediumseverity.Precisely:AttackVec-tor:Adjacent;AttackComplexity:Low;PrivilegesRequired:None;UserInteraction:Required;Scope:Unchanged;Confidentiality:Low;Integrity:None;Availability:Low.Whentheuserinteractswiththedevicetherebygeneratingtraffic,theattackercandistinguishrepeatedmessageswithoutdecipheringthem,yetinferwhatmessagesleadtowhatconse-quences,suchasturningthebulboff.Hecouldthenmanipulatethebulbbyrepeatingthosemessages.Vulnerability4–InsufficientMessageFreshness.PredictablefromObservableState(MITRE,2006b)inTapoL503EallowsanadjacentattackertoreplaymessagesthatareconsideredvalidbothfromtheTapoL530EandtheTapoapp.ThesmartbulbandtheTapoappdonotcheckthefreshnessortheduplicityofthereceivedmessages.Theyonlycheckthatthesessionkeywithwhichthemessagesareencryptedisstillvalid,i.e.,notolderthan24hours.TheCVSSv3.1scorethatwecalculateis5.7,meaningMediumseverity.Precisely:AttackVec-tor:Adjacent;AttackComplexity:Low;PrivilegesRequired:None;UserInteraction:Required;Scope:Unchanged;Confidentiality:None;Integrity:None;Availability:High.Similarlytothepreviousvulnera-bility,theattackercanleverageuser-generatedtraffic,thistimetoreplaymessagesthatboththebulbandtheappwillcertainlyacceptbecauseofthelackofappropriatefreshnessmeasures.7EXPLOITATIONThisSectionshowshowanattackercanexploitthevulnerabilitieswefoundinarealenvironment.Weshow5attackscenarios,inwhichtheattackerexploitsoneormorevulnerabilitiestoachievetheirmaliciousgoals.Wevalidatedeachattackscenariobymanu-allyexecutingthestepsillustratedintheforthcom-ingsections,henceallreportedattacksarefeasibleinpractice.AsnotedabovethroughtheCVSSscores,theirlikelihoodisdeterminedbytheAdjacentAttackVector,theLowAttackComplexity,theNoPrivilegesRequiredandtheRequiredUserInteraction.7.1AttackScenario1-FakeBulbDiscoveryMessagesGenerationInthisexperimentweexploited:•Vulnerability2,withthegoalofgettingtheabilitytocreatefakeBulbDiscoverymessages.Thisexperimentcanbeconductedineverysce-nariopresentedinSection3.Forthisattack,itisfirstnecessarytogetholdofaUDPmessage.Inourcase,wehavechosentousearealbulbdiscoveryre-questmessage,becausetheyareeasytoget.ThesemessagesarebroadcastbytheTapoappeverytimeitisopened,regardlessofthenetworktowhichitisconnected.Togetavalidone,wejustcapturethetrafficusingWiresharkanduseafiltertoextractallUDPmessagessentinbroadcaste.g.,byusingthefil-terudp&&ip.dst==255.255.255.255.OnceaUDPmessageisobtained,wecanperformanofflinebrute-forceattacktogetthesecretsharedbetweentheTapoappandthesmartbulb.Atthispoint,neitherthesmartbulbnortheTapoappneedstobeactiveany-moretocompletetheattack.Inoursetup,thebrute-forceattackalwayssucceededin140minutesonav-erage.Thisgrantstheadversarytheabilitytocreatefakebulbdiscoveryrequestandresponsemessages:theformerallowstheattackertoidentifyallTapodevicesthatusethesameprotocolandthesamekey,onanynetworkheconnectsto,whilethelatterallowstheat-tackertorespondtotheTapoapp’srequestmessageswithfalseconfigurations.7.2AttackScenario2-PasswordExfiltrationfromTapoUserAccountInthisexperimentweexploited,inorder:•Vulnerability2,withthegoalofgettingtheabilitytocreatefakebulbdiscoveryresponsemessages,SmartBulbsCanBeHackedtoHackintoYourHousehold225•Vulnerability1,withthegoalofgettingtheabilitytoauthenticateastheTapoL530EtotheTapoapp.ThecontextinwhichweconducttheexperimentisSetupAdescribedinSection3.1.Tocarryoutthisattack,theadversaryneedstoobtaintheownerIdofthevictimTapoaccount,andtheUDPporttowhichthevictimsendsherbulbdiscoveryrequestmessages(inourcase,port20002).TheattackdiagramisshowninFigure7.Figure7:Sequencechartfortheattacker’simpersonationofthebulb.TheexploitationbeginsthemomentthevictimopensherownTapoapp.Whentheappisopen,itstartsbroadcastingbulbdiscoveryrequestmessages.Duringtheattack,theattackerexploitshisabilitytocreatefakebulbdiscoveryresponsemessagestore-spondtovariousbulbdiscoveryrequestfromthevic-tim.TheattackersetsthebulbdiscoveryresponsemessagesfieldsasshowninListing1:•ItsetstheownerfieldtotheownerIdofthevic-tim.ThisistomaketheTapoappthinkthereisadeviceofitsownonthenetworktostartTSKEP.•Itsetstheipandportfieldstopointtoanadversary-controlledserver.{"result":{"device_id":"bd1e...9348","owner":"Victim’sownerId","device_type":"SMART.TAPOBULB","device_model":"L530ESeries","ip":"Attacker’sIP","mac":"Attacker’sMAC","factory_default":false,"is_support_iot_cloud":true,"mgt_encrypt_schm":{"is_support_https":false,"encrypt_type":"AES","http_port":80}},"error_code":0}Listing1:JSONattackscenario2.Afterreceivingtheresponse,theTapoappthinksthatithassuccessfullycompletedtheBulbDiscov-eryphasebylocatingitsowndevicewithinthenet-work.Therefore,itstartstheTSKEPprotocolwiththeattackingdevice.Becauseofvulnerability1,theTSKEPprotocoldoesnotgivetheTapoappanyev-idenceabouttheidentityoftheinterlocutor.Forthisreason,theTapoappassumesthatthenewlyreceivedkeyissharedwithanassociateddevice,whileitissharedwiththeattackerinstead.Hence,theadversaryisabletodecrypttheLoginmessageoftheTSKEPprotocolandgetthepasswordandthehashoftheemailofthevictim’sTapoaccount.Theattackcanbesummarisedasfollows:•TheattackergetstheBulbDiscoverysharedkeyandcreatesfakebulbdiscoveryresponsemes-sages.Therefore,theauthenticationofthebulbdiscoveryresponsemessagefails.•TheTapoappexecutestheTSKEPprotocolwiththeattackerinsteadofthesmartbulb.Therefore,authenticationofthesmartbulbwiththeTapoappfails.Thisresultsinanintegrityloss.•TheTapoappsharesthekeywiththeattacker,hencethedistributionofthesessionkeyfails.Thisresultsinanavailabilityloss.•Theattackercanviolatetheconfidentialityofthemessagesandgetthepasswordandthehashoftheemailofthevictim’sTapoaccount.Thisresultsinaconfidentialityloss.7.3AttackScenario3-MITMAttackwithaConfiguredTapoL530EInthisexperimentweexploited:•Vulnerability1,withthegoalofgettingtheabilitytoauthenticateastheTapoL530EtotheTapoapp.ThecontextinwhichweconducttheexperimentisSetupBdescribedinSection3.2.TheattackermakesindependentconnectionswiththevictimsandrelaysmessagesbetweenthemtomakethembelievetheyaretalkingdirectlytoeachotheroveraprivateSECRYPT2023-20thInternationalConferenceonSecurityandCryptography226connection.WhentheTapoappstartstheTSKEPwiththesmartbulb,theattackerinterceptstheRSAkeytransmissionmessageandblocksitsreceptionfromthesmartbulb.Inparallel,hestartsanewses-sionwiththesmartbulbfromwhichhegetsanewsessionkey.Thesessionkeyreceivedbytheat-tackerfromthesmartbulbisthenencryptedwiththepreviouslyreceivedRSApublickeyandsenttotheTapoapp.Duetovulnerability1,theTapoappex-pectstosharethereceivedkeyonlywiththesmartbulb,butitissharingitwiththeadversaryinstead.Hence,theattackernowhasthekeythatTapoappandsmartbulbusetoencryptallsubsequentcommu-nicationmessages.Therefore,heiscapableofdeci-pheringthemandviolatingtheirconfidentialityandintegrity,forexamplebydecryptingthemessages,modifyingtheircontents,re-encryptingandthenfor-wardingthem.Thisissummarisedintheattackdia-gramshowninFigure8.Figure8:Sequencechartfortheattacker’sMITMbetweenappandbulb.Hence,theattackconsistsofthefollowingsteps:•TheTapoappexecutestheprotocolwiththeat-tackerinsteadofthesmartbulb,therefore,theau-thenticationprocessfails.•TheTapoappsharesthekeywiththeattackerandnotwiththesmartbulb,hence,thedistributionofthesessionkeyfails.•TheattackerauthenticatesthekeysharedwiththesmartbulbthankstothecredentialsreceivedfromtheTapoapp,therefore,theauthenticationoftheTapoappwiththesmartbulbfails.•Theattackerrelaysmessagesbetweenthetwoses-sionstomakeTapoappandsmartbulbbelievetheyaretalkingtoeachother,hence,theconfi-dentialityandtheintegrityofmessagesislost.7.4AttackScenario4-ReplayAttackwiththeSmartBulbasVictimInthisexperimentweexploited:•Vulnerability4,withthegoalofgettingtheabilitytoreplaybotholdandreplicatedmessages.ThecontextinwhichweconducttheexperimentisSetupBdescribedinSection3.2.Thisattackscenarioisdividedintothreephases.Specifically,inthiscase,itisalsonecessarythattheattackerhasalineofsightonthebulbtocompletetheattack.Duringthefirstphase,WiresharkisusedtosniffthetrafficofaBulb-Appcommunication.Duringthiscommunication,theappsendstothesmartbulbbothgetmessages,torequestthevalueofsomestatuspa-rameters,andsetmessages,torequestthesmartbulbtochangethevalueofsomeofitsinternalparameters.Duringtheexperiment,wearenotawareofthesym-metrickeyusedbyboththesmartbulbandtheTapoapptoencryptthemessages.Duringthesecondphaseoftheexperiment,wereplicateallmessageswepreviouslycaptured.Hence,foreachmessagewedeterminewhetheritwasagetorsetmessagesimplybyobservinghowthebulbbe-havesaftereachmessage.Foreverysetmessage,wetakenoteofthechangethatitcausedonthelightbulb.Duringthethirdphase,wearbitrarilyreplicatethesetmessagestothesmartbulb,managingtomakechangestoitsinternalstate,withouthavingaTapoaccountassociatedwithit.Messagescontinuetobeacceptedbythesmartbulbuntilthesessionkeywithwhichtheyareencryptedexpires.7.5AttackScenario5-MITMAttackwithanUnconfiguredTapoL530EInthisexperimentweexploited:•Vulnerability1,withthegoalofgettingtheabilitytoauthenticateastheTapoL530EtotheTapoapp.ThecontextinwhichweconducttheexperimentisSetupCdescribedinSection3.3.Thisattacksce-narioexploitsthefactthatnotonlytheTapoapp,butanyone(includingtheattacker),canconnecttotheWi-Finetworkstartedbythesmartbulbduringthesetupphase.Itisimportantthattheattackingdeviceactsasabridgebetweenthetwonetworks.Theat-tackermustflowallbulbdiscoveryrequestmessagesSmartBulbsCanBeHackedtoHackintoYourHousehold227fromthenetworkitcontrolstothesmartbulbnet-work,andviceversaforbulbdiscoveryresponsemes-sages.Otherwise,theTapoappwouldnotbeabletodetectthesmartbulbandthereforewouldnevertrytostarttheTSKEPwithit.Subsequently,vulnerability1isexploitedinthesamewayshowninSectionAttackScenario7.3,sotheadversaryisabletoviolatetheconfidentialityofthesessionkeybetweenthesmartbulbandtheTapoapp.Atsomepointinthecommunication,theTapoappsendstheJSONshowninListing2:{"method":"set_qs_info","params":{"account"{"password":"Tapopassword","username":"Tapoemail"},"extra_info":{"specs":"EU"},"time":{"region":"Europe/Rome","time_diff":60,"timestamp":1660032435},"wireless":{"key_type":"wpa2_psk","password":"Wi-Fipassword","ssid":"ssidWi-Fi"}},"requestTimeMils":1660032438365,"terminalUUID":"..."}’Listing2:JSONattackscenario5.Becauseusernames,Tapopasswords,SSIDs,andWi-Fipasswordsaresentinbase64encoding,theat-tackerisabletodecodeandstealthem.8FIXINGThisSectionoutlinespossiblemitigationsfortheidentifiedvulnerabilities,markingthelaststepofthePETIoTkillchain.Mostmeasuresconsistofsimplemodificationstotherelevantprotocols,inparticulartostrengthenthecryptographicmeasures.ThesecanbeimplementedviasoftwareupdatestobepushedtotheaffecteddevicesviaInternet,sowebelievethesefixestobeeasilydeployablewiththealreadyexistingupdateproceduresFixforVulnerability1.Thisvulnerabilityisthemostcomplexanddangerous.Itisnoteasytofindasimplefixtoitbecausetheprotocolshouldbewidelyrevised.OurproposedfixrequiresthesmartbulbtosignthemessageofAESkeytransmissionwithanasymmetric,privatekey.ThevalidityofthatkeyastobelongtothebulbcouldbeverifiedbytheappviaadigitalcertificatetoretrievefromtheCloudServerduringtheassociationofthebulbwiththeapp.Ofcourse,suchacertificateshouldchainuptoarootcertificatetobesecurelystoredwiththeapp.Allthiswouldallowtheapptogetevidenceabouttheau-thenticityoftheresponse,i.e.,thattheresponsereallycomesfromthesmartbulb.Inconsequence,theappwilleventuallystoreallcertificatesoftheassociateddevices.FixforVulnerability2.Onepossiblesolutiontofixthisvulnerabilityistheactivepresenceofthecloudserver.ThisentityshouldperiodicallyassigneachTapoaccountafreshkeytousewhencalculatingthechecksumwithinBulbDiscoverymessages.ThekeyassignedtoaTapoaccountshouldthenbecommuni-catedtoalldevicesassociatedwithit.Thebenefitsofthefixcanbesummarizedasfollows:•Thekeyisnothard-coded,sotheattackerwouldnolongerbeabletogetitbydecompilingtheTapoapporthefirmwareofaTapodevice.•Eachaccounthasitsownkey,therefore,compro-misingaTapoaccount,orakey,wouldnotresultincompromisingthekeysofotherTapoaccounts.•Thekeyshouldbelongandrandomenoughbycurrentstandardssothatbrute-forceattackswouldnotbeprofitableanymore.•Thekeyisalwaysfresh,soevenifanattackerweretogetthekeyofaTapoaccount,thelatterwouldnotbecompromisedforever,butonlyuntilthevalidityofthestolenkeyexpiresandthecloudserverassignsanewkeytoit.Itwouldalsobeusefultouseacollision-resistantcryptographichashfunctionforthechecksum.Ex-amplesofcryptographichashfunctionsareSHA-224orSHA3-224.FixforVulnerability3.ThisvulnerabilitycanbefixedbymakingtheIVdynamic,i.e.,usingdiffer-entIVstoencryptdifferentmessages.ThisshouldbedonebyboththeTapoappandtheTapoL530E.TheIVusedtoencrypttheJSONcontainedintheparamsfieldcouldthenbeincludedasafieldintheplainpartofJSONcontainedinBulb-Appcommunications.FixforVulnerability4.Thetimestampcontain-ingthemessagecreationmomentincludedinJSONshouldbeverifiedbysmartbulbandtheTapoapp.Checkingthecreationtimestampwouldpreventre-centmessagesfrombeingpassedoffasfreshbyanSECRYPT2023-20thInternationalConferenceonSecurityandCryptography228attacker.Inaddition,thevariousmessagesexchangedshouldcontainasequencenumber,whichwouldpre-ventduplicatemessages.9CONCLUSIONSWeidentifiedfourvulnerabilitiesintheTapoL530E,whichwewereabletopracticallyexploitinfivedif-ferentattackscenarioswithvaryingimpactsontheusers’security,privacyandsafety.Ofthefourvul-nerabilities,twoareofHighseverityandtwoareofMediumseverity,accordingtotheirCVSSscore.Overall,weobservethattheexperimentsetuphadtobedesignedwithcareduetothethreescenariosthatwerepossible.Followingthat,theinformationgather-ingstepwasratherlargeandcomplicated,muchmorethanitcouldbereportedinthispaperduetospaceconstraints.Thevulnerabilityassessmentwasverysurprising.Forexample,whiledeauthenticationisroutinelypossible,wewerenotpreparedtodiscoverpasswordsintheclearandweakcryptography.Ex-ploitingthevulnerabilitieswasmoderatelychalleng-ingbutdevisingappropriatefixeswasharder.Onewaytointerpretsuchfindingscouldbethat“small”IoTdevicesmayhaveraisedinsufficientcy-bersecurityattentionthusfar,i.e.,insufficientcyber-securitymeasuresduetoapreconceptionthattheymaynotbeworthhackingorexploiting.Ourworkpinsdownthispreconceptionaswrong,atleastbe-causethescopeofourattacksexpandsontoallde-vicesoftheTapofamilyavictimmayuseand,mostimportantly,potentiallyontotheentirevictim’sWi-Finetwork,whichtheattackerisenabledtopenetrate.Whilemoreandmoreexperimentswillcertainlyfollowonsimilarbulbsandotherinexpensivedevices,wearguethattheevidencewehavegatheredthusfarissufficienttocallforafullerapplicationofazerotrustmodeltotheIoTdomain.Withdozensofyearsofcybersecurityexperienceaccumulatedbytheinter-nationalcommunitythusfar,itshouldbepossibletofindaffordablewaystoachievethatinduecourse.REFERENCESAlopix(2023).Wifideauthattackin2min-utes!https://systemweakness.com/wifi-deauth-attack-in-2-minutes-d1fb55112305.Bella,G.andBiondi,P.(2019).Youovertrustyourprinter.InProc.ofthe2ndInternationalWorkshoponSafety,securiTy,andpRivacyInautomotiVesystEms(STRIVE’19),LNCS11699,pages264–274.Springer.Bella,G.,Biondi,P.,Bognanni,S.,andEsposito,S.(2023.).PETIoT:PEnetrationTestingtheInternetofThings.ElsevierInternetofThings,22.Biondi,P.,Bognanni,S.,andBella,G.(2020).VoIPCanStillBeExploited—Badly.InProc.ofthe5thInter-nationalConferenceonFogandMobileEdgeCom-puting,(FMEC’20),pages237–243.IEEE.Dalvi,A.,Maddala,S.,andSuvarna,D.(2018).Threatmodellingofsmartlightbulb.In2018FourthInter-nationalConferenceonComputingCommunicationControlandAutomation(ICCUBEA),pages1–4.d’OtreppedeBouvette,T.(2023).Aircrack-ng.https://www.aircrack-ng.org/.Ettercap(2023).Ettercapproject.https://www.ettercap-project.org/.Howarth,J.(2023).80+amazingiotstatistics(2023-2030).https://explodingtopics.com/blog/iot-stats.Kristiyanto,Y.andErnastuti,E.(2020).Analysisofdeauthenticationattackonieee802.11connectivitybasedoniottechnologyusingexternalpenetrationtest.CommIT(CommunicationandInformationTech-nology)Journal,14(1):45–51.MITRE(2006a).Cwe-287:Improperauthentication.https://cwe.mitre.org/data/definitions/287.html.MITRE(2006b).Cwe-341:Predictablefromobservablestate.https://cwe.mitre.org/data/definitions/341.html.MITRE(2008).Cwe-693:Protectionmechanismfailure.https://cwe.mitre.org/data/definitions/693.html.MITRE(2020).Cwe-1240:Useofacryptographicprim-itivewithariskyimplementation.https://cwe.mitre.org/data/definitions/1240.html.Nath,R.andNath,H.V.(2022).Criticalanalysisofthelayeredandsystematicapproachesforunderstandingiotsecuritythreatsandchallenges.ComputersandElectricalEngineering.Schepers,D.,Ranganathan,A.,andVanhoef,M.(2022).Ontherobustnessofwi-fideauthenticationcounter-measures.InProceedingsofthe15thACMConfer-enceonSecurityandPrivacyinWirelessandMobileNetworks,WiSec’22,page245–256,NewYork,NY,USA.AssociationforComputingMachinery.Wireshark(2023).Wiresharkproject.https://www.wireshark.org/.SmartBulbsCanBeHackedtoHackintoYourHousehold229

=== Content from www.scitepress.org_584ef313_20250114_210847.html ===


![loading](App_Themes/BookStore/images/Loading.gif)

* [Home](HomePage.aspx)
* [About Us](AboutUs.aspx)
* [Ethics of Publication](EthicsOfPublication.aspx)
* [Ethics of Review](EthicsOfReview.aspx)
* [Contacts](Contact.aspx)
* [Sitemap](Sitemap.aspx)

[Papers](PublishedPapers/)
[Papers/2022](PublishedPapers/2022)
[Papers](http://scitepress.net/PublishedPapers/)
[Papers/2022](http://scitepress.net/PublishedPapers/2022)

* [Login](Login.aspx)
* [Sign-Up](Signup.aspx)

# [Scitepress Logo](HomePage.aspx)

The Search is performed on all of the following fields:Note: Please use complete words only.

* Publication Title
* Abstract
* Publication Keywords
* DOI
* Proceeding Title
* Proceeding Foreword
* ISBN (Completed)
* Insticc Ontology
* Author Affiliation
* Author Name
* Editor Name

If you already have a Primoris Account you can use the same username/password here.

{1}

##LOC[OK]##

{1}

##LOC[OK]##
##LOC[Cancel]##

{1}

##LOC[OK]##
##LOC[Cancel]##

Research.Publish.Connect.

![](App_Themes/BookStore/images/RadMenu.png)

* Proceedings
* Papers
* Authors
* Affiliations
* [Advanced Search](AdvancedSearch.aspx)

\*Please fill out at least one Field.
\*Value must be an number!

| Title: |  |
| --- | --- |
| ISBN: |  |
| Year: |  |
| Acronym: |  |
| Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

[Advanced Search Proceedings](AdvancedSearch.aspx?SearchCriteria=Proceedings)
Search
If you're looking for an exact phrase use quotation marks on text fields.
\*Please fill out at least one Field.

| Title: |  |
| --- | --- |
| Author: |  |
| Affiliation: |  |
| Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

[Advanced Search Papers](AdvancedSearch.aspx?SearchCriteria=Papers)
Search
If you're looking for an exact phrase use quotation marks on text fields.
\*Please fill out at least one Field.

| Name: |  |
| --- | --- |
| Affiliation: |  |
| Country: | Select a Country Ascension Island Andorra United Arab Emirates Afghanistan Antigua and Barbuda Anguilla Albania Armenia Netherlands Antilles Angola Antarctica Argentina American Samoa Austria Australia Aruba Aland Islands Azerbaijan Bosnia and Herzegovina Barbados Bangladesh Belgium Burkina Faso Bulgaria Bahrain Burundi Benin Bermuda Brunei Darussalam Bolivia Brazil Bahamas Bhutan Bouvet Island Botswana Belarus Belize Canada Cocos (Keeling) Islands Congo, The Democratic Republic of the Central African Republic Congo, Republic of Switzerland Cote d'Ivoire Cook Islands Chile Cameroon China Colombia Costa Rica Cuba Cape Verde Christmas Island Cyprus Czech Republic Germany Djibouti Denmark Dominica Dominican Republic Algeria Ecuador Estonia Egypt Western Sahara Eritrea Spain Ethiopia Finland Fiji Falkland Islands (Malvinas) Micronesia, Federal State of Faroe Islands France Gabon Grenada Georgia French Guiana Guernsey Ghana Gibraltar Greenland Gambia Guinea Guadeloupe Equatorial Guinea Greece South Georgia and the South Sandwich Islands Guatemala Guam Guinea-Bissau Guyana Hong Kong Heard and McDonald Islands Honduras Croatia Haiti Hungary Indonesia Ireland Israel Isle of Man India British Indian Ocean Territory Iraq Iran, Islamic Republic of Iceland Italy Jersey Jamaica Jordan Japan Kenya Kyrgyzstan Cambodia Kiribati Comoros Saint Kitts and Nevis Korea, Democratic People's Republic Korea, Republic of Kuwait Cayman Islands Kazakhstan Lao People's Democratic Republic Lebanon Saint Lucia Liechtenstein Sri Lanka Liberia Lesotho Lithuania Luxembourg Latvia Libyan Arab Jamahiriya Morocco Monaco Moldova, Republic of Montenegro Madagascar Marshall Islands Macedonia, The Former Yugoslav Republic of Mali Myanmar Mongolia Macau Northern Mariana Islands Martinique Mauritania Montserrat Malta Mauritius Maldives Malawi Mexico Malaysia Mozambique Namibia New Caledonia Niger Norfolk Island Nigeria Nicaragua Netherlands Norway Nepal Nauru Niue New Zealand Oman Panama Peru French Polynesia Papua New Guinea Philippines Pakistan Poland Saint Pierre and Miquelon Pitcairn Island Puerto Rico Palestinian Territory, Occupied Portugal Palau Paraguay Qatar Reunion Island Romania Serbia Russian Federation Rwanda Saudi Arabia Solomon Islands Seychelles Sudan Sweden Singapore Saint Helena Slovenia Svalbard and Jan Mayen Islands Slovak Republic Sierra Leone San Marino Senegal Somalia Suriname Sao Tome and Principe El Salvador Syrian Arab Republic Swaziland Turks and Caicos Islands Chad French Southern Territories Togo Thailand Tajikistan Tokelau Timor-Leste Turkmenistan Tunisia Tonga Turkey Trinidad and Tobago Tuvalu Taiwan Tanzania Ukraine Uganda United Kingdom United States Minor Outlying Islands United States Uruguay Uzbekistan Holy See (Vatican City State) Saint Vincent and the Grenadines Venezuela Virgin Islands, British Virgin Islands, US Vietnam Vanuatu Wallis and Futuna Islands Western Samoa Kosovo Yemen Mayotte Yugoslavia South Africa Zambia Zimbabwe |
| Conference: |  |
| Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

[Advanced Search Authors](AdvancedSearch.aspx?SearchCriteria=Authors)
Search
If you're looking for an exact phrase use quotation marks on text fields.
\*Please fill out at least one Field.

| Name: |  |
| --- | --- |
| Country: | Select a Country Ascension Island Andorra United Arab Emirates Afghanistan Antigua and Barbuda Anguilla Albania Armenia Netherlands Antilles Angola Antarctica Argentina American Samoa Austria Australia Aruba Aland Islands Azerbaijan Bosnia and Herzegovina Barbados Bangladesh Belgium Burkina Faso Bulgaria Bahrain Burundi Benin Bermuda Brunei Darussalam Bolivia Brazil Bahamas Bhutan Bouvet Island Botswana Belarus Belize Canada Cocos (Keeling) Islands Congo, The Democratic Republic of the Central African Republic Congo, Republic of Switzerland Cote d'Ivoire Cook Islands Chile Cameroon China Colombia Costa Rica Cuba Cape Verde Christmas Island Cyprus Czech Republic Germany Djibouti Denmark Dominica Dominican Republic Algeria Ecuador Estonia Egypt Western Sahara Eritrea Spain Ethiopia Finland Fiji Falkland Islands (Malvinas) Micronesia, Federal State of Faroe Islands France Gabon Grenada Georgia French Guiana Guernsey Ghana Gibraltar Greenland Gambia Guinea Guadeloupe Equatorial Guinea Greece South Georgia and the South Sandwich Islands Guatemala Guam Guinea-Bissau Guyana Hong Kong Heard and McDonald Islands Honduras Croatia Haiti Hungary Indonesia Ireland Israel Isle of Man India British Indian Ocean Territory Iraq Iran, Islamic Republic of Iceland Italy Jersey Jamaica Jordan Japan Kenya Kyrgyzstan Cambodia Kiribati Comoros Saint Kitts and Nevis Korea, Democratic People's Republic Korea, Republic of Kuwait Cayman Islands Kazakhstan Lao People's Democratic Republic Lebanon Saint Lucia Liechtenstein Sri Lanka Liberia Lesotho Lithuania Luxembourg Latvia Libyan Arab Jamahiriya Morocco Monaco Moldova, Republic of Montenegro Madagascar Marshall Islands Macedonia, The Former Yugoslav Republic of Mali Myanmar Mongolia Macau Northern Mariana Islands Martinique Mauritania Montserrat Malta Mauritius Maldives Malawi Mexico Malaysia Mozambique Namibia New Caledonia Niger Norfolk Island Nigeria Nicaragua Netherlands Norway Nepal Nauru Niue New Zealand Oman Panama Peru French Polynesia Papua New Guinea Philippines Pakistan Poland Saint Pierre and Miquelon Pitcairn Island Puerto Rico Palestinian Territory, Occupied Portugal Palau Paraguay Qatar Reunion Island Romania Serbia Russian Federation Rwanda Saudi Arabia Solomon Islands Seychelles Sudan Sweden Singapore Saint Helena Slovenia Svalbard and Jan Mayen Islands Slovak Republic Sierra Leone San Marino Senegal Somalia Suriname Sao Tome and Principe El Salvador Syrian Arab Republic Swaziland Turks and Caicos Islands Chad French Southern Territories Togo Thailand Tajikistan Tokelau Timor-Leste Turkmenistan Tunisia Tonga Turkey Trinidad and Tobago Tuvalu Taiwan Tanzania Ukraine Uganda United Kingdom United States Minor Outlying Islands United States Uruguay Uzbekistan Holy See (Vatican City State) Saint Vincent and the Grenadines Venezuela Virgin Islands, British Virgin Islands, US Vietnam Vanuatu Wallis and Futuna Islands Western Samoa Kosovo Yemen Mayotte Yugoslavia South Africa Zambia Zimbabwe |
| Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

[Advanced Search Affiliations](AdvancedSearch.aspx?SearchCriteria=Affiliations)
Search
If you're looking for an exact phrase use quotation marks on text fields.

+ Proceedings
  Proceedings Search
  \*Please fill out at least one Field.
  \*Value must be an number!

  ![Proceedings](App_Themes/BookStore/images/publications-scitepress.png)

  - | Title: |  |
    | --- | --- |
    | ISBN: |  |
    | Year: |  |
    | Acronym: |  |
    | Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

    [Advanced Search Proceedings](AdvancedSearch.aspx?SearchCriteria=Proceedings)
    Search
  - If you're looking for an exact phrase use quotation marks on text fields.
+ Papers
  Papers Search
  \*Please fill out at least one Field.

  ![Papers](App_Themes/BookStore/images/papers-scitepress.png)

  - | Title: |  |
    | --- | --- |
    | Author: |  |
    | Affiliation: |  |
    | Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

    [Advanced Search Papers](AdvancedSearch.aspx?SearchCriteria=Papers)
    Search
  - If you're looking for an exact phrase use quotation marks on text fields.
+ Authors
  Authors Search
  \*Please fill out at least one Field.

  ![Authors](App_Themes/BookStore/images/student-scitepress.png)

  - | Name: |  |
    | --- | --- |
    | Affiliation: |  |
    | Country: | Select a Country Afghanistan Aland Islands Albania Algeria American Samoa Andorra Angola Anguilla Antarctica Antigua and Barbuda Argentina Armenia Aruba Ascension Island Australia Austria Azerbaijan Bahamas Bahrain Bangladesh Barbados Belarus Belgium Belize Benin Bermuda Bhutan Bolivia Bosnia and Herzegovina Botswana Bouvet Island Brazil British Indian Ocean Territory Brunei Darussalam Bulgaria Burkina Faso Burundi Cambodia Cameroon Canada Cape Verde Cayman Islands Central African Republic Chad Chile China Christmas Island Cocos (Keeling) Islands Colombia Comoros Congo, Republic of Congo, The Democratic Republic of the Cook Islands Costa Rica Cote d'Ivoire Croatia Cuba Cyprus Czech Republic Denmark Djibouti Dominica Dominican Republic Ecuador Egypt El Salvador Equatorial Guinea Eritrea Estonia Ethiopia Falkland Islands (Malvinas) Faroe Islands Fiji Finland France French Guiana French Polynesia French Southern Territories Gabon Gambia Georgia Germany Ghana Gibraltar Greece Greenland Grenada Guadeloupe Guam Guatemala Guernsey Guinea Guinea-Bissau Guyana Haiti Heard and McDonald Islands Holy See (Vatican City State) Honduras Hong Kong Hungary Iceland India Indonesia Iran, Islamic Republic of Iraq Ireland Isle of Man Israel Italy Jamaica Japan Jersey Jordan Kazakhstan Kenya Kiribati Korea, Democratic People's Republic Korea, Republic of Kosovo Kuwait Kyrgyzstan Lao People's Democratic Republic Latvia Lebanon Lesotho Liberia Libyan Arab Jamahiriya Liechtenstein Lithuania Luxembourg Macau Macedonia, The Former Yugoslav Republic of Madagascar Malawi Malaysia Maldives Mali Malta Marshall Islands Martinique Mauritania Mauritius Mayotte Mexico Micronesia, Federal State of Moldova, Republic of Monaco Mongolia Montenegro Montserrat Morocco Mozambique Myanmar Namibia Nauru Nepal Netherlands Netherlands Antilles New Caledonia New Zealand Nicaragua Niger Nigeria Niue Norfolk Island Northern Mariana Islands Norway Oman Pakistan Palau Palestinian Territory, Occupied Panama Papua New Guinea Paraguay Peru Philippines Pitcairn Island Poland Portugal Puerto Rico Qatar Reunion Island Romania Russian Federation Rwanda Saint Helena Saint Kitts and Nevis Saint Lucia Saint Pierre and Miquelon Saint Vincent and the Grenadines San Marino Sao Tome and Principe Saudi Arabia Senegal Serbia Seychelles Sierra Leone Singapore Slovak Republic Slovenia Solomon Islands Somalia South Africa South Georgia and the South Sandwich Islands Spain Sri Lanka Sudan Suriname Svalbard and Jan Mayen Islands Swaziland Sweden Switzerland Syrian Arab Republic Taiwan Tajikistan Tanzania Thailand Timor-Leste Togo Tokelau Tonga Trinidad and Tobago Tunisia Turkey Turkmenistan Turks and Caicos Islands Tuvalu Uganda Ukraine United Arab Emirates United Kingdom United States United States Minor Outlying Islands Uruguay Uzbekistan Vanuatu Venezuela Vietnam Virgin Islands, British Virgin Islands, US Wallis and Futuna Islands Western Sahara Western Samoa Yemen Yugoslavia Zambia Zimbabwe |
    | Conference: |  |
    | Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

    [Advanced Search Authors](AdvancedSearch.aspx?SearchCriteria=Authors)
    Search
  - If you're looking for an exact phrase use quotation marks on text fields.
+ [Advanced Search](AdvancedSearch.aspx)

![](App_Themes/BookStore/images/PopupInfo.png)
The Search is performed on all of the following fields:Note: Please use complete words only.

* Publication Title
* Abstract
* Publication Keywords
* DOI
* Proceeding Title
* Proceeding Foreword
* ISBN (Completed)
* Insticc Ontology
* Author Affiliation
* Author Name
* Editor Name

If you're looking for an exact phrase use quotation marks on text fields.

## Paper

Smart Bulbs Can Be Hacked to Hack into Your HouseholdTopics:
IoT Security and Privacy
In
[Proceedings of the 20th International Conference on Security and Cryptography SECRYPT - Volume 1,](ProceedingsDetails.aspx?ID=2eUGmj5Uwn0=&t=1)
218-229,
2023
, Rome, Italy

![](Telerik.Web.UI.WebResource.axd?imgid=d5a58abcef9c41399fc3cb3ebd47fdd7&type=rbi)

![](Telerik.Web.UI.WebResource.axd?imgid=24be782c05e64302a18c0cac86520340&type=rbi)

Authors:
[Davide Bonaventura](PersonProfile.aspx?PersonAccountID=CAJlLtRba2M=&t=1)
1
;
[Sergio Esposito](PersonProfile.aspx?PersonAccountID=KAbgQtKiW1E=&t=1)
2
 and
[Giampaolo Bella](PersonProfile.aspx?PersonAccountID=mY5Y2c9nC2I=&t=1)
1

Affiliations:
1
[Dipartimento di Matematica e Informatica, Università di Catania, Catania, Italy](AffiliationsProfile.aspx?Org=JtvLsNYXP47FkEnenjyXxgXo9q/V/FjW+uMczXPBUXYialCMTB4cYVqLQMg5iOIeVTwZeNEOM/1npIStZZIvXEAxvjoP9lcEtBhCVycjYroD/TsRf+yUow==&t=1)
;
2
[Information Security Group, Royal Holloway, University of London, Egham, U.K.](AffiliationsProfile.aspx?Org=I+up3G/n8mIlkXWSIW5M3x0gZC/RzAEbU81IYnLwuc4EEYKpUkTvqgndfszgYKsvdp9Z37jCqVCRNysg2YyQSFcvsR5IHlXV0IJsIO4L2NY=&t=1)

 Keyword(s):
IoT, Smart Homes, Smart Devices, Smart Bulb, Penetration Test, Vulnerability Assessment.

Abstract:
The IoT is getting more and more pervasive. Even the simplest devices, such as a light bulb or an electrical plug, are made “smart” and controllable by our smartphone. This paper describes the findings obtained by applying the PETIoT kill chain to conduct a Vulnerability Assessment and Penetration Testing session on a smart bulb, the Tapo L530E by Tp-Link, currently best seller on Amazon Italy. We found that four vulnerabilities affect the bulb, two of High severity and two of Medium severity according to the CVSS v3.1 scoring system. In short, authentication is not well accounted for and confidentiality is insufficiently achieved by the implemented cryptographic measures. In consequence, an attacker who is nearby the bulb can operate at will not just the bulb but all devices of the Tapo family that the user may have on her Tapo account. Moreover, the attacker can learn the victim’s Wi-Fi password, thereby escalating his malicious potential considerably. The paper terminates with an
outline of possible fixes.
(More)

The IoT is getting more and more pervasive. Even the simplest devices, such as a light bulb or an electrical plug, are made “smart” and controllable by our smartphone. This paper describes the findings obtained by applying the PETIoT kill chain to conduct a Vulnerability Assessment and Penetration Testing session on a smart bulb, the Tapo L530E by Tp-Link, currently best seller on Amazon Italy. We found that four vulnerabilities affect the bulb, two of High severity and two of Medium severity according to the CVSS v3.1 scoring system. In short, authentication is not well accounted for and confidentiality is insufficiently achieved by the implemented cryptographic measures. In consequence, an attacker who is nearby the bulb can operate at will not just the bulb but all devices of the Tapo family that the user may have on her Tapo account. Moreover, the attacker can learn the victim’s Wi-Fi password, thereby escalating his malicious potential considerably. The paper terminates with an outline of possible fixes.

![](App_Themes/BookStore/images/PopupInfoLarge.png)
![](App_Themes/BookStore/images/pdf_download.png)Full TextDownload
Please type the code
![](Telerik.Web.UI.WebResource.axd?type=rca&isc=true&guid=ab0b9e44-593b-4d8f-9293-f01b4fbcf935)Generate New Image

Enter text above before pressing **[Download]** (case sensitive)

![](App_Themes/BookStore/images/88x31.png)
[CC BY-NC-ND 4.0](https://creativecommons.org/licenses/by-nc-nd/4.0/)![Sign In](App_Themes/BookStore/images/info-sign-th.png)
![](App_Themes/BookStore/images/PopupInfo.png)
Guests can use SciTePress Digital Library without having a SciTePress account. However, guests have limited access to downloading full text versions of papers and no access to special options.

Guests can use SciTePress Digital Library without having a SciTePress account. However, guests have limited access to downloading full text versions of papers and no access to special options.

Guest:
[Register as new SciTePress user](Signup.aspx)
now for free.
![Sign In](App_Themes/BookStore/images/info-sign-th.png)
![](App_Themes/BookStore/images/PopupInfo.png)
Download limit per month - 500 recent papers or 4000 papers more than 2 years old.

SciTePress user:
 [please login](Login.aspx).
![PDF Image](App_Themes/BookStore/images/pdf_icon_large.png)My Papers
![PopUp Banner](App_Themes/BookStore/images/PopupInfo.png)
Unable to see papers previously downloaded, because you haven't logged in as SciTePress Member.
If you are already a member
 [please login.](Login.aspx)

You are not signed in, therefore limits apply to your IP address 109.78.161.61In the current month:
Recent papers:
 100
available of
 100
total

2+ years older papers:
 200
available of
 200
total

![Popup Banner](App_Themes/BookStore/images/PopupInfoLarge.png)![PDF Button](App_Themes/BookStore/images/pdf_download.png)Full TextDownload
Please type the code
![](Telerik.Web.UI.WebResource.axd?type=rca&isc=true&guid=551bcd67-2f32-4bf4-b586-34fcfbd171c2)Generate New Image

Enter the captcha text before pressing **[Download]** (case sensitive)

Paper citation in several formats:

* Harvard
* Bibtex
* EndNote

Bonaventura, D., Esposito, S. and Bella, G. (2023). **Smart Bulbs Can Be Hacked to Hack into Your Household**. In *Proceedings of the 20th International Conference on Security and Cryptography - SECRYPT*; ISBN 978-989-758-666-8; ISSN 2184-7711, SciTePress, pages 218-229. DOI: 10.5220/0012092900003555
@conference{secrypt23,
author={Davide Bonaventura and Sergio Esposito and Giampaolo Bella},
title={Smart Bulbs Can Be Hacked to Hack into Your Household},
booktitle={Proceedings of the 20th International Conference on Security and Cryptography - SECRYPT},
year={2023},
pages={218-229},
publisher={SciTePress},
organization={INSTICC},
doi={10.5220/0012092900003555},
isbn={978-989-758-666-8},
issn={2184-7711},
}
TY - CONF

JO - Proceedings of the 20th International Conference on Security and Cryptography - SECRYPT
TI - Smart Bulbs Can Be Hacked to Hack into Your Household
SN - 978-989-758-666-8
IS - 2184-7711
AU - Bonaventura, D.
AU - Esposito, S.
AU - Bella, G.
PY - 2023
SP - 218
EP - 229
DO - 10.5220/0012092900003555
PB - SciTePress

![](App_Themes/BookStore/images/scitepress.png "Science Technology Publications")
- Science and Technology Publications, Lda.
RESOURCES

[Proceedings](ProceedingsList.aspx)

[Papers](TopicsFilter.aspx)

[Authors](Authors.aspx)

[Ontology](OntologyTree.aspx)

CONTACTS

Science and Technology Publications, Lda

Avenida de S. Francisco Xavier, Lote 7 Cv. C,

2900-616 Setúbal, Portugal.

Phone: +351 265 520 185 (National fixed network call)

Fax: +351 265 520 186

EXTERNAL LINKS

[PRIMORIS](http://www.insticc.org/Primoris/)

[INSTICC](http://www.insticc.org/Portal/)

[SCITEVENTS](http://www.scitevents.com/)

[CROSSREF](http://www.crossref.org/)

PROCEEDINGS SUBMITTED FOR INDEXATION BY:

[dblp](http://dblp.uni-trier.de/)

[Ei Compendex](http://www.engineeringvillage.com/)

 [SCOPUS](http://www.scopus.com)

[Semantic Scholar](https://www.semanticscholar.org/)

[Google Scholar](https://scholar.google.com/)

[Microsoft Academic](https://academic.microsoft.com/home)

© 2021 SciTePress, Science and Technology Publications, Lda - All rights reserved.

<style>
#socialicons>a span { top: 0px; left: -100%; -webkit-transition: all 0.3s ease; -moz-transition: all 0.3s ease-in-out; -o-transition: all 0.3s ease-in-out; -ms-transition: all 0.3s ease-in-out; transition: all 0.3s ease-in-out;}
#socialicons>ahover div{left: 0px;}
</style>



=== Content from arxiv.org_2d8712f5_20250114_210830.html ===

[Skip to main content](#content)

[![Cornell University](/static/browse/0.3.4/images/icons/cu/cornell-reduced-white-SMALL.svg)](https://www.cornell.edu/)
We gratefully acknowledge support from the Simons Foundation, [member institutions](https://info.arxiv.org/about/ourmembers.html), and all contributors.
[Donate](https://info.arxiv.org/about/donate.html)

[![arxiv logo](/static/browse/0.3.4/images/arxiv-logo-one-color-white.svg)](/) > [cs](/list/cs/recent) > arXiv:2308.09019

[Help](https://info.arxiv.org/help) | [Advanced Search](https://arxiv.org/search/advanced)

All fields
Title
Author
Abstract
Comments
Journal reference
ACM classification
MSC classification
Report number
arXiv identifier
DOI
ORCID
arXiv author ID
Help pages
Full text

Search

[![arXiv logo](/static/browse/0.3.4/images/arxiv-logomark-small-white.svg)](https://arxiv.org/)
[![Cornell University Logo](/static/browse/0.3.4/images/icons/cu/cornell-reduced-white-SMALL.svg)](https://www.cornell.edu/)
open search

GO

open navigation menu
## quick links

* [Login](https://arxiv.org/login)
* [Help Pages](https://info.arxiv.org/help)
* [About](https://info.arxiv.org/about)

# Computer Science > Cryptography and Security

**arXiv:2308.09019** (cs)

[Submitted on 17 Aug 2023]
# Title:Smart Bulbs can be Hacked to Hack into your Household

Authors:[Davide Bonaventura](https://arxiv.org/search/cs?searchtype=author&query=Bonaventura,+D), [Sergio Esposito](https://arxiv.org/search/cs?searchtype=author&query=Esposito,+S), [Giampaolo Bella](https://arxiv.org/search/cs?searchtype=author&query=Bella,+G) View a PDF of the paper titled Smart Bulbs can be Hacked to Hack into your Household, by Davide Bonaventura and 1 other authors
[View PDF](/pdf/2308.09019)
> Abstract:The IoT is getting more and more pervasive. Even the simplest devices, such as a light bulb or an electrical plug, are made "smart" and controllable by our smartphone. This paper describes the findings obtained by applying the PETIoT kill chain to conduct a Vulnerability Assessment and Penetration Testing session on a smart bulb, the Tapo L530E by Tp-Link, currently best seller on Amazon Italy. We found that four vulnerabilities affect the bulb, two of High severity and two of Medium severity according to the CVSS v3.1 scoring system. In short, authentication is not well accounted for and confidentiality is insufficiently achieved by the implemented cryptographic measures. In consequence, an attacker who is nearby the bulb can operate at will not just the bulb but all devices of the Tapo family that the user may have on her Tapo account. Moreover, the attacker can learn the victim's Wi-Fi password, thereby escalating his malicious potential considerably. The paper terminates with an outline of possible fixes.

| Subjects: | Cryptography and Security (cs.CR) |
| --- | --- |
| Cite as: | [arXiv:2308.09019](https://arxiv.org/abs/2308.09019) [cs.CR] |
|  | (or  [arXiv:2308.09019v1](https://arxiv.org/abs/2308.09019v1) [cs.CR] for this version) |
|  | <https://doi.org/10.48550/arXiv.2308.09019>  Focus to learn more    arXiv-issued DOI via DataCite |
| Journal reference: | In Proceedings of the 20th International Conference on Security and Cryptography (2023), ISBN 978-989-758-666-8, ISSN 2184-7711, pages 218-229 |
| Related DOI: | <https://doi.org/10.5220/0012092900003555>  Focus to learn more   DOI(s) linking to related resources |

## Submission history

From: Davide Bonaventura [[view email](/show-email/7608b7e9/2308.09019)]
 **[v1]**
Thu, 17 Aug 2023 14:48:04 UTC (990 KB)

Full-text links:
## Access Paper:

View a PDF of the paper titled Smart Bulbs can be Hacked to Hack into your Household, by Davide Bonaventura and 1 other authors* [View PDF](/pdf/2308.09019)
* [TeX Source](/src/2308.09019)
* [Other Formats](/format/2308.09019)

[view license](http://arxiv.org/licenses/nonexclusive-distrib/1.0/ "Rights to this article")

Current browse context: cs.CR
[< prev](/prevnext?id=2308.09019&function=prev&context=cs.CR "previous in cs.CR (accesskey p)")

  |
[next >](/prevnext?id=2308.09019&function=next&context=cs.CR "next in cs.CR (accesskey n)")

[new](/list/cs.CR/new)
 |
[recent](/list/cs.CR/recent)
 | [2023-08](/list/cs.CR/2023-08)
Change to browse by:
[cs](/abs/2308.09019?context=cs)

### References & Citations

* [NASA ADS](https://ui.adsabs.harvard.edu/abs/arXiv%3A2308.09019)
* [Google Scholar](https://scholar.google.com/scholar_lookup?arxiv_id=2308.09019)
* [Semantic Scholar](https://api.semanticscholar.org/arXiv%3A2308.09019)

[a](/static/browse/0.3.4/css/cite.css)
export BibTeX citation
Loading...

## BibTeX formatted citation

×

loading...

Data provided by:

### Bookmark

[![BibSonomy logo](/static/browse/0.3.4/images/icons/social/bibsonomy.png)](http://www.bibsonomy.org/BibtexHandler?requTask=upload&url=https://arxiv.org/abs/2308.09019&description=Smart Bulbs can be Hacked to Hack into your Household "Bookmark on BibSonomy")
[![Reddit logo](/static/browse/0.3.4/images/icons/social/reddit.png)](https://reddit.com/submit?url=https://arxiv.org/abs/2308.09019&title=Smart Bulbs can be Hacked to Hack into your Household "Bookmark on Reddit")

Bibliographic Tools
# Bibliographic and Citation Tools

Bibliographic Explorer Toggle

Bibliographic Explorer *([What is the Explorer?](https://info.arxiv.org/labs/showcase.html#arxiv-bibliographic-explorer))*

Connected Papers Toggle

Connected Papers *([What is Connected Papers?](https://www.connectedpapers.com/about))*

Litmaps Toggle

Litmaps *([What is Litmaps?](https://www.litmaps.co/))*

scite.ai Toggle

scite Smart Citations *([What are Smart Citations?](https://www.scite.ai/))*

Code, Data, Media
# Code, Data and Media Associated with this Article

alphaXiv Toggle

alphaXiv *([What is alphaXiv?](https://alphaxiv.org/))*

Links to Code Toggle

CatalyzeX Code Finder for Papers *([What is CatalyzeX?](https://www.catalyzex.com))*

DagsHub Toggle

DagsHub *([What is DagsHub?](https://dagshub.com/))*

GotitPub Toggle

Gotit.pub *([What is GotitPub?](http://gotit.pub/faq))*

Huggingface Toggle

Hugging Face *([What is Huggingface?](https://huggingface.co/huggingface))*

Links to Code Toggle

Papers with Code *([What is Papers with Code?](https://paperswithcode.com/))*

ScienceCast Toggle

ScienceCast *([What is ScienceCast?](https://sciencecast.org/welcome))*

Demos
# Demos

Replicate Toggle

Replicate *([What is Replicate?](https://replicate.com/docs/arxiv/about))*

Spaces Toggle

Hugging Face Spaces *([What is Spaces?](https://huggingface.co/docs/hub/spaces))*

Spaces Toggle

TXYZ.AI *([What is TXYZ.AI?](https://txyz.ai))*

Related Papers
# Recommenders and Search Tools

Link to Influence Flower

Influence Flower *([What are Influence Flowers?](https://influencemap.cmlab.dev/))*

Core recommender toggle

CORE Recommender *([What is CORE?](https://core.ac.uk/services/recommender))*

* Author
* Venue
* Institution
* Topic

About arXivLabs

# arXivLabs: experimental projects with community collaborators

arXivLabs is a framework that allows collaborators to develop and share new arXiv features directly on our website.

Both individuals and organizations that work with arXivLabs have embraced and accepted our values of openness, community, excellence, and user data privacy. arXiv is committed to these values and only works with partners that adhere to them.

Have an idea for a project that will add value for arXiv's community? [**Learn more about arXivLabs**](https://info.arxiv.org/labs/index.html).

[Which authors of this paper are endorsers?](/auth/show-endorsers/2308.09019) |
Disable MathJax ([What is MathJax?](https://info.arxiv.org/help/mathjax.html))

* [About](https://info.arxiv.org/about)
* [Help](https://info.arxiv.org/help)

* contact arXivClick here to contact arXiv
   [Contact](https://info.arxiv.org/help/contact.html)
* subscribe to arXiv mailingsClick here to subscribe
   [Subscribe](https://info.arxiv.org/help/subscribe)

* [Copyright](https://info.arxiv.org/help/license/index.html)
* [Privacy Policy](https://info.arxiv.org/help/policies/privacy_policy.html)

* [Web Accessibility Assistance](https://info.arxiv.org/help/web_accessibility.html)
* [arXiv Operational Status](https://status.arxiv.org)

  Get status notifications via
  [email](https://subscribe.sorryapp.com/24846f03/email/new)
  or [slack](https://subscribe.sorryapp.com/24846f03/slack/new)



=== Content from www.dmi.unict.it_c3002955_20250114_210833.html ===


[IoT can be Hacked to Hack into your Household](#page-top)

* [Work](#work)
* [Attacks](#attacks)
* [Responsible Disclosure](#disclosure)
* [Paper](#paper)
* [CVE](#cve)
* [Q&A](#Q&A)

# IoT can be Hacked to Hack into your Household

After conducting a Penetration Testing session across multiple devices within the TP-Link Tapo IoT
ecosystem, we identified **four** vulnerabilities enabling five different potential attacks
### Work

"IoT can be Hacked to Hack into your Household" is the description of a Penetration Testing session
on five different IoT devices belonging the TP-Link Tapo IoT ecosystem. The studied device are the
Tapo L530E, the Tapo L510E V2, the Tapo L630, the Tapo C200, and the Tapo P100. During the session
we found **four** vulnerabilities that allow to perform five attacks. Due to the authentication not well
accounted for and the confidentiality not sufficiently guaranteed by the implemented cryptographic
measures, the attacker can operate at will all devices of the Tapo family that the user may have on
her Tapo account and learn the victim's Wi-Fi password, thereby escalating his malicious potential
considerably.

The tested firmware's versions of each device are:

|  | Vulnerable version | Fixed version |
| --- | --- | --- |
| L530E | 1.1.9 | 1.2.4 |
| L510E | 1.0.8 | 1.1.0 |
| L630 | 1.0.3 | 1.0.4 |
| P100 | 1.4.9 and 1.4.16 | 1.5.0 |
| C200 | 1.1.18 | - |

Tp-Link acknowledged the issues we responsibly reported through their Product Security Advisory
(PSA). We actively collaborated with them, by testing the fixes and confirming
the attack scenarios are no longer exploitable or do not give the attacker any advantage.
Tp-Link confirmed that they already released the necessary fixes to address the vulnerabilities and
that the changes do not affect the normal use and stability of the products.

The vulnerabilites that affect each device are:

|  | Vulnerability 1 | Vulnerability 2 | Vulnerability 3 | Vulnerability 4 |
| --- | --- | --- | --- | --- |
| L530E | 🐞 | 🐞 | 🐞 | 🐞 |
| L510E | 🐞 | 🐞 | 🐞 | 🐞 |
| L630 | 🐞 | 🐞 | 🐞 | 🐞 |
| P100 | 🐞 | 🐞 | 🐞 | 🐞 |
| C200 | 🛡️ | 🐞 | 🛡️ | 🛡️ |

🐞 if the vulnerability is present, 🛡️ otherwise.

---

## Attacks

* **Attack scenario 1 - Fake Device Discovery messages generation.**

  The attacker discovers the secret used by the smart device and Tapo application to
  authenticate discovery messages from compatible devices connected to the network, so he can
  authenticate fake messages.
* **Attack scenario 2 - Password exfiltration from Tapo user account.**

  The attacker authenticates himself as the smart device with the Tapo application, so
  he can obtain the credentials used by the Tapo application with the smart device. The
  attacker
  can obtain the password and email hash of the victim's Tapo account.
* **Attack scenario 3 - MITM attack with a configured Tapo device.**

  The attacker performs a MITM attack on the communication between the smart device and the
  Tapo
  application, so he is able to violate the confidentiality of all messages belonging to the
  communication.
* **Attack scenario 4 - Replay attack with the Tapo device as victim.**

  The attacker replicates old messages to both the smart device and the Tapo application, so
  he
  can arbitrarily change the state of the smart device.
* **Attack scenario 5 - MITM attack with an unconfigured Tapo device.**

  The attacker performs a Wi-Fi deauthentication attack in order to force the user to reset
  the
  smart device, so he can perform a MITM attack and obtain the SSID and password of the
  victim's
  local network and the credentials used by the victim to authenticate with the Tapo
  application. The credentials consist of the victim's Tapo account email and password.

|  | Attack Scenario 1 | Attack Scenario 2 | Attack Scenario 3 | Attack Scenario 4 | Attack Scenario 5 |
| --- | --- | --- | --- | --- | --- |
| L530E | ✅ | ✅ | ✅ | ✅ | ✅ |
| L510E | ✅ | ✅ | ✅ | ✅ | ✅ |
| L630 | ✅ | ✅ | ✅ | ✅ | ✅ |
| P100 | ✅ | ✅ | ✅ | ✅ | 🚫 |
| C200 | ✅ | ❌ | ❌ | ❌ | ❌ |

✅ if the attack scenario is feasible on the target device,
❌ if the attack scenario is not feasible because the communication is encapsulated within a TLS
channel,
🚫 if the attack scenario is not feasible because the configuration is done on the Bluetooth
channel.

---

## Responsible Disclosure

Complete Timeline of the Responsible Disclosure Process

* **June 2022**
  Research on Tapo L530E starts!
* **25th February 2023**  We start the responsible disclosure process by
  reporting all found undesirable behaviours and potential vulnerabilities to TP-Link, via
  their TP-Link Product Security Advisory. Our report includes the lack of authentication
  of the smart bulb with the Tapo app, the hard-coded, short shared secret, the lack of
  randomness during symmetric encryption, the insufficient message freshness.
* **1st March 2023**
  First response from TP-Link. TP-Link handled this vulnerability without delay, responded
  positively to the vulnerability report, and started the validation fix as soon as
  possible.
* **11th April 2023**
  After a first review of the report, TP-Link does not object to our decision to submit
  our research paper to venues for publication.
* **23rd April 2023**
  "Smart Bulbs can be Hacked to Hack into your Household" paper is accepted to the [**SECRYPT 2023**
  conference](https://secrypt.scitevents.org/)!
* **16th June 2023**
  TP-Link has confirmed a valid solution and is releasing new firmwares to fix the issue.
* **19th June 2023**
  Agreed deadline for the disclosure.
* **12th July 2023**
  Vulnerability is disclosed via publication of a paper on SciTePress.
* **September 2023**
  Research on Tapo L510E, Tapo L630, Tapo P100 and Tapo C200 starts!
* **11th October 2023**
  We report the found vulnerabilities to the TP-Link Product Security Advisory.
* **5th December 2023**
  TP-Link confirms the found vulnerabilities for these products as well, and releases a
  fix for all of them.
* **12th March 2024**
  Agreed deadline for the disclosure of the vulnerabilites on the other devices.

---

## Paper

Smart Bulbs can be Hacked to Hack into your Household

*Smart Bulbs can be Hacked to Hack into your Household* was reported by **Davide
Bonaventura** (UniversitÃ  degli Studi di Catania), **Sergio Esposito** (Royal Holloway
University of London)
and **Giampaolo Bella**
(UniversitÃ  degli Studi di Catania). The paper is published on the *20th SECRYPT
International Conference on Security and Cryptography **(SECRYPT 2023)***'s proceedings.

##### Davide Bonaventura

Master Student at UniversitÃ  degli Studi di Catania

 [Visit
linkedin](https://www.linkedin.com/in/davide-bonaventura-a44281229/)

##### Sergio Esposito

PhD Student at Royal Holloway University of London

 [Visit
homepage](https://s3lab.isg.rhul.ac.uk/authors/sergio-esposito/)

##### Giampaolo Bella

Associate Professor (with Italian MIUR habilitation as Full
Professor) at UniversitÃ  degli Studi di Catania

 [Visit homepage](https://www.dmi.unict.it/giamp/)

 [Read our
paper](https://www.scitepress.org/Papers/2023/120929/120929.pdf)
 Cite our paper
##### Cite Smart Bulbs Can Be Hacked to Hack into Your Household

Bonaventura, D.; Esposito, S. and Bella, G. (2023). Smart Bulbs Can Be Hacked to Hack into Your Household. In Proceedings of the 20th International Conference on Security and Cryptography, ISBN 978-989-758-666-8, ISSN 2184-7711, pages 218-229.

 Copy to clipboard

---

## CVE

Common Vulnerabilities and Exposures

CVE Entries assigned to the vulnerabilities described in our paper, **Smart Bulbs can be Hacked to
Hack into your Household**, are the following:

* [CVE-2023-38906](https://www.cve.org/CVERecord?id=CVE-2023-38906) for *Lack of the
  Smart Bulb Authentication with the Tapo App*
* [CVE-2023-38907](https://www.cve.org/CVERecord?id=CVE-2023-38907) for *Hard-Coded
  Short Checksum Shared Secret*
* [CVE-2023-38908](https://www.cve.org/CVERecord?id=CVE-2023-38908) for *Lack of
  Randomness During Symmetric Encryption*
* [CVE-2023-38909](https://www.cve.org/CVERecord?id=CVE-2023-38909) for *Insufficient
  Message Freshness*

---

## Q&A

Questions and Answers
## **Are the attacks possible on my Tapo devices?**

***Most likely.*** We have tested the attacks using the following
devices:

* A smart bulb Tapo series L530 with Firmware Version 1.1.9
* A smart bulb Tapo series L510 with Firmware Version 1.0.8
* A smart bulb Tapo series L630 with Firmware Version 1.0.3
* A smart plug Tapo series L630 with Firmware Version 1.4.9 and 1.4.16
* A smart camera Tapo series L630 with Firmware Version 1.1.18
* A Tapo application Version 2.8.14

Most likely the attack also works with other versions prior to the versions containing
the fix.

## **What other Tapo devices are afflicted by the attacks?**

***All Tapo devices using the described protocol.*** Vulnerabilities
are not implementation-oriented, but design-oriented. This means that all devices using
the same protocol used by the tested devices are vulnerable to the described attacks.

## **Someone got my Tapo credentials as well as my Wi-Fi credentials! What can I do?**

***Change the password of both your Tapo account and your Wi-Fi
network.*** This allows you to disconnect all devices connected
without your consent to your Tapo account or/and your Wi-Fi network.

## **What steps can I take to mitigate the risk of the attacks?**

***Make sure that only devices known to you have access to the Wi-Fi network
your smart device is connected to.*** The attacker can only carry out
attacks when he is able to communicate directly with the smart device.

***When you reset your smart device, pay attention to the Wi-Fi network you
connect to complete the configuration process.*** The network you are
connected to may be controlled by the attacker and not the network started by your smart
device.

***Make sure you do not disclose your tapoId.*** The tapoId
allows your Tapo application to recognize the devices associated with your account. The
attacker through it is able to authenticate to your Tapo application as a device
associated with it.

## **Have the vulnerabilites been exploited in the wild?**

***We are not aware of the vulnerabilites being exploited in the
wild.***

## **Is there a fix?**

***Yes.*** TP-Link has released a new version both of firmwares and
application that is attacks resistant. Make sure you update both.


