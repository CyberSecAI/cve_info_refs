=== Content from rodelllemit.medium.com_5e005756_20250114_192103.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fea7389be3d33&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Frodelllemit.medium.com%2Finsecure-permissions-vulnerability-in-raidenftpd-v2-4-build-4005-2016-04-01-ea7389be3d33&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Frodelllemit.medium.com%2Finsecure-permissions-vulnerability-in-raidenftpd-v2-4-build-4005-2016-04-01-ea7389be3d33&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2023–38960: Insecure Permission vulnerability in RaidenFTPD v2.4 build 4005 (2016/04/01)

[![@ro0taddict](https://miro.medium.com/v2/resize:fill:88:88/0*4NOZN5_O9KCLgqRL.jpg)](/?source=post_page---byline--ea7389be3d33--------------------------------)

[@ro0taddict](/?source=post_page---byline--ea7389be3d33--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5c044fe856d3&operation=register&redirect=https%3A%2F%2Frodelllemit.medium.com%2Finsecure-permissions-vulnerability-in-raidenftpd-v2-4-build-4005-2016-04-01-ea7389be3d33&user=%40ro0taddict&userId=5c044fe856d3&source=post_page-5c044fe856d3--byline--ea7389be3d33---------------------post_header-----------)

4 min read·Feb 10, 2024

--

Listen

Share

Vendor Affected:

RaidenFTPD / Raiden Professional Server / Team John Long Software

RaidenFTPD v2.4 build 4005;

Affected Component:

C:\RaidenServer\ folder and the executable files inside it

Attack Vector:

A regular user with a local access on the Windows hosts that RaidenFTPD v2.4 is running may perform a privilege escalation attack by dll hijacking or or simply replacing the binary that is associated to a Windows Service(RaidenFTPDService, or any Windows service that is associated to this FTP server). Escalating privilege is dependent if the original FTP Admin or the owner of the Windows hosts enabled the Windows Service (e.g. RaidenFTPDService) when the FTP was first setup.

Description:

Improper permission in C:\RaidenServer\ folder and the executable files inside in RaidenFTPD v2.4 build 4005 that may lead to complete compromise of the data hosted in the FTP server and the main Windows host. This attack is possible when a limited-privilege malicious user with a local access on the Windows host performs code execution and privilege escalation by performing dll hijacking, or simply replacing the binary that is associated to a Windows Service(RaidenFTPDService, etc.)

Steps to replicate:

Login as a high privilege user. Download the RaidenFTPD binary. Install and create a Windows Service.

![]()![]()

In the image below, notice that it will create its own folder outside “Program Files” or “Program Files (x86”.

Select “Start”

![]()

Confirm that the Windows Service has been created.

![]()![]()

Log in as a low privilege user.

![]()

Check the running “RaidenFTPDService”.

![]()

Check the permission of the “rfsvc.exe” binary.

![]()

Based on the image above, users under “Authenticated Users” group are allowed to modify the executable file.

![]()

Create your desired payload.

![]()

Set up the listener.

![]()

One complexity on this vulnerability during testing was the service itself is running with a high privilege. The windows service is also using the binary so when trying to overwrite it, an attacker cant overwrite it directly.

![]()![]()

To do a proof of concept, stop the Windows service using a high privilege user (Lab user)”.

Then as a low priv user, overwrite the binary that is associated to the FTP Windows service.

![]()

Go back to the high privilege user and run the application.

![]()

Recommendation:

Use the “Program Files” or “Program Files (x86) as the default home folder of the application”.

![]()![]()

References:

<http://www.raidenmaild.com/download/raidenftpd2.exe>

--

--

[![@ro0taddict](https://miro.medium.com/v2/resize:fill:96:96/0*4NOZN5_O9KCLgqRL.jpg)](/?source=post_page---post_author_info--ea7389be3d33--------------------------------)[![@ro0taddict](https://miro.medium.com/v2/resize:fill:128:128/0*4NOZN5_O9KCLgqRL.jpg)](/?source=post_page---post_author_info--ea7389be3d33--------------------------------)Follow[## Written by @ro0taddict](/?source=post_page---post_author_info--ea7389be3d33--------------------------------)[41 Followers](/followers?source=post_page---post_author_info--ea7389be3d33--------------------------------)·[55 Following](/following?source=post_page---post_author_info--ea7389be3d33--------------------------------)

InfoSec enthusiast; Lifelong learner

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----ea7389be3d33--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----ea7389be3d33--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----ea7389be3d33--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----ea7389be3d33--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----ea7389be3d33--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----ea7389be3d33--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ea7389be3d33--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ea7389be3d33--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----ea7389be3d33--------------------------------)[Teams](https://medium.com/business?source=post_page-----ea7389be3d33--------------------------------)


