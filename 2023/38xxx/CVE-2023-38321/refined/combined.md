=== Content from github.com_46548177_20250114_191900.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FopenNDS%2FopenNDS%2Fblob%2Fmaster%2FChangeLog)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FopenNDS%2FopenNDS%2Fblob%2Fmaster%2FChangeLog)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=openNDS%2FopenNDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openNDS](/openNDS)
/
**[openNDS](/openNDS/openNDS)**
Public

* [Notifications](/login?return_to=%2FopenNDS%2FopenNDS) You must be signed in to change notification settings
* [Fork
  88](/login?return_to=%2FopenNDS%2FopenNDS)
* [Star
   338](/login?return_to=%2FopenNDS%2FopenNDS)

* [Code](/openNDS/openNDS)
* [Issues
  4](/openNDS/openNDS/issues)
* [Pull requests
  1](/openNDS/openNDS/pulls)
* [Actions](/openNDS/openNDS/actions)
* [Projects
  0](/openNDS/openNDS/projects)
* [Security](/openNDS/openNDS/security)
* [Insights](/openNDS/openNDS/pulse)

Additional navigation options

* [Code](/openNDS/openNDS)
* [Issues](/openNDS/openNDS/issues)
* [Pull requests](/openNDS/openNDS/pulls)
* [Actions](/openNDS/openNDS/actions)
* [Projects](/openNDS/openNDS/projects)
* [Security](/openNDS/openNDS/security)
* [Insights](/openNDS/openNDS/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from openwrt.org_382f5d28_20250114_191901.html ===


[![OpenWrt Wiki](/_media/logo.png)OpenWrt Wiki](/start "OpenWrt Wiki")

* Tools
  + User Tools
  + [Log In](/docs/guide-user/services/captive-portal/opennds?do=login&sectok= "Log In")
  + Site Tools
  + [Recent Changes](/docs/guide-user/services/captive-portal/opennds?do=recent "Recent Changes [r]")
  + [Media Manager](/docs/guide-user/services/captive-portal/opennds?do=media&ns=docs%3Aguide-user%3Aservices%3Acaptive-portal "Media Manager")
  + [Sitemap](/docs/guide-user/services/captive-portal/opennds?do=index "Sitemap [x]")
  + Page Tools
  + [Show pagesource](/docs/guide-user/services/captive-portal/opennds?do=edit "Show pagesource [v]")
  + [Old revisions](/docs/guide-user/services/captive-portal/opennds?do=revisions "Old revisions [o]")
  + [Backlinks](/docs/guide-user/services/captive-portal/opennds?do=backlink "Backlinks")
  + [Back to top](#dokuwiki__top "Back to top [t]")

* Translations of this page
  + Translations of this page [?](/meta/translation "meta:translation")
  + [English (en)](/docs/guide-user/services/captive-portal/opennds "English")
  + [|العربية (ar)](/ar/docs/guide-user/services/captive-portal/opennds "|العربية")
  + [Česky (cs)](/cs/docs/guide-user/services/captive-portal/opennds "Česky")
  + [Deutsch (de)](/de/docs/guide-user/services/captive-portal/opennds "Deutsch")
  + [Español (es)](/es/docs/guide-user/services/captive-portal/opennds "Español")
  + [Français (fr)](/fr/docs/guide-user/services/captive-portal/opennds "Français")
  + [Magyar (hu)](/hu/docs/guide-user/services/captive-portal/opennds "Magyar")
  + [Italiano (it)](/it/docs/guide-user/services/captive-portal/opennds "Italiano")
  + [日本語 (ja)](/ja/docs/guide-user/services/captive-portal/opennds "日本語")
  + [한국어 (ko)](/ko/docs/guide-user/services/captive-portal/opennds "한국어")
  + [Polski (pl)](/pl/docs/guide-user/services/captive-portal/opennds "Polski")
  + [Português (pt)](/pt/docs/guide-user/services/captive-portal/opennds "Português")
  + [Português (pt-br)](/pt-br/docs/guide-user/services/captive-portal/opennds "Português")
  + [Русский (ru)](/ru/docs/guide-user/services/captive-portal/opennds "Русский")
  + [Türkçe (tr)](/tr/docs/guide-user/services/captive-portal/opennds "Türkçe")
  + [Українська (uk)](/uk/docs/guide-user/services/captive-portal/opennds "Українська")
  + [Tiếng Việt (vi)](/vi/docs/guide-user/services/captive-portal/opennds "Tiếng Việt")
  + [中文 (zh)](/zh/docs/guide-user/services/captive-portal/opennds "中文")
  + [繁體中文 (zh-tw)](/zh-tw/docs/guide-user/services/captive-portal/opennds "繁體中文")

* [Log In](/docs/guide-user/services/captive-portal/opennds?do=login&sectok= "Log In")

---

1. You are here
2. [Home](/start "start")
3. [Documentation](/docs/start "docs:start")
4. [User guide](/docs/guide-user/start "docs:guide-user:start")
5. [Additional services](/docs/guide-user/services/start "docs:guide-user:services:start")
6. [Captive portals (splash pages for free or paid WiFi)](/docs/guide-user/services/captive-portal/start "docs:guide-user:services:captive-portal:start")
7. [OpenNDS Captive Portal](/docs/guide-user/services/captive-portal/opennds "docs:guide-user:services:captive-portal:opennds")

---

 Learn about OpenWrt
#### Learn about OpenWrt

* [Supported devices](/supported_devices "supported_devices")
* [Packages](/packages/start "packages:start")
* [Downloads](/downloads "downloads")
* [Documentation](/docs/start "docs:start")
  + [Quick start guide](/docs/guide-quick-start/start "docs:guide-quick-start:start")
  + [User guide](/docs/guide-user/start "docs:guide-user:start")
  + [Developer guide](/docs/guide-developer/start "docs:guide-developer:start")
* [Security](/docs/guide-developer/security "docs:guide-developer:security")
* [FAQ](/faq "faq")
* [Forum](https://forum.openwrt.org/ "https://forum.openwrt.org/")
#### Contributing

* [Submitting patches](/submitting-patches "submitting-patches")
* [Reporting bugs](/bugs "bugs")
* [Contributing to wiki](/wiki/wikirules "wiki:wikirules")
#### Project

* [About OpenWrt](/about "about")
* [Rules](/rules "rules")
* [Infrastructure](/infrastructure "infrastructure")
* [Donate](/donate "donate")
* [Merchandise](/merchandise "merchandise")
* [Website](/wiki/start "wiki:start")
* [Trademark policy](/trademark "trademark")
* [License](/license "license")
* [Contacts](/contact "contact")

* [Show pagesource](/docs/guide-user/services/captive-portal/opennds?do=edit "Show pagesource [v]")
* [Old revisions](/docs/guide-user/services/captive-portal/opennds?do=revisions "Old revisions [o]")
* [Backlinks](/docs/guide-user/services/captive-portal/opennds?do=backlink "Backlinks")
* [Back to top](#dokuwiki__top "Back to top [t]")

×
####

###### Table of Contents

* [OpenNDS Captive Portal](#opennds_captive_portal)
  + [Overview](#overview)
  + [Documentation](#documentation)
  + [Official Repository](#official_repository)
  + [How OpenNDS (NDS) works](#how_opennds_nds_works)
    - [NDS comes with multiple default Splash Page options](#nds_comes_with_multiple_default_splash_page_options)
    - [FAS, or Forward Authentication Service](#fas_or_forward_authentication_service)
    - [A Note on Captive Portal Detection (CPD)](#a_note_on_captive_portal_detection_cpd)

# OpenNDS Captive Portal

## Overview

openNDS (open Network Demarcation Service) is a high performance, small footprint, Captive Portal.

It provides a border control gateway between a public local area network and the Internet.

It supports all ranges between small stand alone venues through to large mesh networks with multiple portal entry points.

Both the client driven Captive Portal Detection (CPD) method and gateway driven Captive Portal Identification method (CPI - RFC 8910 and RFC 8908) are supported.

In its default configuration, openNDS offers a dynamically generated and adaptive splash page sequence. Internet access is granted by a click to continue button, accepting Terms of Service. A simple option enables input forms for user login.

The package incorporates the FAS API allowing many flexible customisation options.

The creation of sophisticated third party authentication applications is fully supported.

Internet hosted https portals can be implemented with no security errors, to inspire maximum user confidence.

## Documentation

Full documentation can be found at:

[https://opennds.readthedocs.io](https://opennds.readthedocs.io "https://opennds.readthedocs.io")

## Official Repository

The official repository can be found here:

[https://github.com/openNDS/openNDS](https://github.com/openNDS/openNDS "https://github.com/openNDS/openNDS")

## How OpenNDS (NDS) works

OpenNDS is a Captive Portal Engine. Any Captive Portal, including NDS, will have two main components:

* Something that does the capturing, and
* Something to provide a Portal for client users to log in.

A wireless router will typically be running OpenWrt or some other Linux distribution.

A router, by definition, will have two or more interfaces, at least one to connect to the wide area network (WAN) or Internet feed, and at least one connecting to the local area network (LAN).

Each LAN interface must also act as the Default IP Gateway for its LAN, ideally with the interface serving IP addresses to client devices using DHCP.

Multiple LAN interfaces can be combined into a single bridge interface. For example, ethernet, 2.4Ghz and 5Ghz networks are typically combined into a single bridge interface. Logical interface names will be assigned such as eth0, wlan0, wlan1 etc. with the combined bridge interface named as br-lan.

NDS will manage one or more of them of them. This will typically be br-lan, the bridge to both the wireless and wired LAN, but could be, for example, wlan0 if you wanted NDS to work just on the wireless interface.

#### Summary of Operation

By default, NDS blocks everything.

A client will find out it is in a captured state by one of two basic methods:

##### 1. Captive Portal Detection (CPD)

CPD is a client driven process available on all modern mobile devices, most desktop operating systems and most browsers. The CPD process automatically issues a port 80 request on connection to a network as a means of probing for a captive state.

Sometimes known as a “canary test”, this process, driven by the client, has evolved over a number of years to be a reliable de-facto standard. openNDS detects this probing and serves a special “splash” web page sequence to the connecting client device.

##### 2. Captive Portal Identification (CPI)

CPI is a Gateway driven process as defined in standards RFC8910 (Captive-Portal Identification in DHCP and Router Advertisements) and RFC8908 (Captive Portal API).
A gateway router informs a connecting client that it is in a captive state by providing a url at which a client can access for authentication.
A client may access this url to be served the same portal “splash” page sequence as it would have in the traditional CPD method.

Alternatively, a client may use this url to access the RFC8908 Captive Portal API, ultimately being served a splash page sequence for authentication.

From openNDS v9.5.0, The CPI method is supported in both forms and enabled by default. It can be disabled in a config option.

Note: Very few client devices support CPI at the time of writing (November 2021)

Update: Most new devices now support CPI at least to some degree, indicating a probable “S” curve adoption. (January 2023)

#### The Portal

The client browser is redirected to the Portal component. This is a web service that is configured to know how to communicate with the core engine of NDS.
This is commonly known as the “Splash Page”.

NDS has its own web server built in and is used in the basic modes of operation to serve the Portal “Splash” pages to the client browser. Alternatively, a separate web server can be used.

### NDS comes with multiple default Splash Page options

* A trivial Click to Continue splash page sequence (default configuration)
* A Client User form requiring Name and Email address to be entered.
* Admin definable themed page sequences, supporting optional remote content

A single uci config option is used to choose the default splash page sequence for client login.

For the simple “Click to Continue” pages:

```
 option login_option_enabled '1'

```

For the “username/email” pages:

```
 option login_option_enabled '2'
```

For admin defined Themespec pages:

```
 option login_option_enabled '3'

```

The default splash page options can be customised or a complete specialised Portal can be written by the installer (See ThemeSpec, FAS, PreAuth in the documentation).

### FAS, or Forward Authentication Service

FAS, or Forward Authentication Service may use the web server embedded in NDS, a separate web server installed on the NDS router, a web server residing on the local network or an Internet hosted web server.

The user of the client device will always be expected to complete some actions on the splash or captive portal page.
Once the user on the client device has successfully completed the splash page actions, that page then links directly back to NDS.

For security, NDS expects to receive a token, hashed using a pre-shared key.

If this hashed token is valid, NDS then “authenticates” the client device, allowing access to the Internet.

Post authentication processing extensions may be added to NDS (See BinAuth in the documentation). Once NDS has received the valid token it will, if enabled, call a BinAuth script.

BinAuth Post Authentication processing is most often used to provide a mechanism for generating local client access logs.

Binauth can override the FAS and deny access or override quotas and data rate restrictions that may be set by the FAS or globally in the configuration.

If FAS Secure is enabled (Levels 1 (default), 2 and 3), the client authentication token is kept secret at all times. Instead, faskey is used to generate a hashed id value (hid) and this is sent by openNDS to the FAS. The FAS must then in turn generate a new return hash id (rhid) to return to openNDS in its authentication request.

**If set to “0” The FAS is enforced by NDS to use http protocol.** The client token is sent to the FAS in clear text in the query string of the redirect along with authaction and redir. This method is easy to bypass and useful only for the simplest systems where security does not matter.

**If set to “1” The FAS is enforced by NDS to use http protocol.** A base64 encoded query string containing the hid is sent to the FAS, along with the clientip, clientmac, gatewayname, client\_hid, gatewayaddress, authdir, originurl, clientif and custom parameters and variables.

Should the sha256sum utility not be available, openNDS will terminate with an error message on startup.

**If set to “2” The FAS is enforced by NDS to use http protocol.**

clientip, clientmac, gatewayname, client\_hid, gatewayaddress, authdir, originurl and clientif are encrypted using faskey and passed to FAS in the query string.

The query string will also contain a randomly generated initialization vector to be used by the FAS for decryption.

The cipher used is “AES-256-CBC”.

The “php-cli” package and the “php-openssl” module must both be installed for fas\_secure level 2.

openNDS does not depend on this package and module, but will exit gracefully if this package and module are not installed when this level is set.

The FAS must use the query string passed initialisation vector and the pre shared fas\_key to decrypt the query string. An example FAS level 2 php script (fas-aes.php) is stored in the /etc/opennds directory and also supplied in the source code. This should be copied the the web root of a suitable web server for use.

**If set to “3” The FAS is enforced by openNDS to use https protocol.** Level 3 is the same as level 2 except the use of https protocol is enforced for FAS. In addition, the “authmon” daemon is loaded. This allows the external FAS, after client verification, to effectively traverse inbound firewalls and address translation to achieve NDS authentication without generating browser security warnings or errors. An example FAS level 3 php script (fas-aes-https.php) is pre-installed in the /etc/opennds directory and also supplied in the source code. This should be copied the the web root of a suitable web server for use.

Option faskey has a default value. It is recommended that this is set to some secret value in the config file and the FAS script set to use a matching value, ie faskey must be pre-shared with FAS.

### A Note on Captive Portal Detection (CPD)

All modern mobile devices, most desktop operating systems and most browsers now have a CPD process that automatically issues a port 80 request on connection to a network. NDS detects this and serves a special “splash” web page to the connecting client device.

The port 80 html request made by the client CPD can be one of many vendor specific URLs.

Typical CPD URLs used are, for example:

* [http://captive.apple.com/hotspot-detect.html](http://captive.apple.com/hotspot-detect.html "http://captive.apple.com/hotspot-detect.html")
* [http://connectivitycheck.gstatic.com/generate\_204](http://connectivitycheck.gstatic.com/generate_204 "http://connectivitycheck.gstatic.com/generate_204")
* [http://connectivitycheck.platform.hicloud.com/generate\_204](http://connectivitycheck.platform.hicloud.com/generate_204 "http://connectivitycheck.platform.hicloud.com/generate_204")
* [http://www.samsung.com/](http://www.samsung.com/ "http://www.samsung.com/")
* [http://detectportal.firefox.com/success.txt](http://detectportal.firefox.com/success.txt "http://detectportal.firefox.com/success.txt")
* Plus many more

It is important to remember that CPD is designed primarily for mobile devices to automatically detect the presence of a portal and to trigger the login page, without having to resort to breaking SSL/TLS security by requiring the portal to redirect port 443 for example.

Just about all current CPD implementations work very well but some compromises are necessary depending on the application.

The vast majority of devices attaching to a typical Captive Portal are mobile devices. CPD works well giving the initial login page.

For a typical guest wifi, eg a coffee shop, bar, club, hotel etc., a device connects, the Internet is accessed for a while, then the user takes the device out of range.

When taken out of range, a typical mobile device begins periodically polling the wireless spectrum for SSIDs that it knows about to try to obtain a connection again, subject to timeouts to preserve battery life.

Most Captive Portals have a session duration limit (openNDS included).

If a previously logged in device returns to within the coverage of the portal, the previously used SSID is recognised and CPD is triggered and tests for an Internet connection in the normal way. Within the session duration limit of the portal, the Internet connection will be established, if the session has expired, the splash page will be displayed again.

Early mobile device implementations of CPD used to poll their detection URL at regular intervals, typically around 30 to 300 seconds. This would trigger the Portal splash page quite quickly if the device stayed in range and the session limit had been reached.

However it was very quickly realised that this polling kept the WiFi on the device enabled continuously having a very negative effect on battery life, so this polling whilst connected was either increased to a very long interval or removed all together (depending on vendor) to preserve battery charge. As most mobile devices come and go into and out of range, this is not an issue.

**A common issue raised is:**

*“My devices show the splash page when they first connect, but when the authorization expires, they just announce there is no internet connection. I have to make them “forget” the wireless network to see the splash page again. Is this how is it supposed to work?”*

This is normal, but you will find just manually disconnecting or turning WiFi off and on will simulate a “going out of range”, initialising an immediate trigger of the CPD. One or any combination of these solutions should work, again depending on the particular vendor's implementation of CPD.

In contrast, most laptop/desktop operating systems, and browser versions for these still implement CPD polling whilst online as battery considerations are not so important.

For example, Gnome desktop has its own built in CPD browser with a default interval of 300 seconds. Firefox also defaults to something like 300 seconds. Windows 10 is similar.

This IS how it is supposed to work, but does involve some compromises.

The best solution is to set the session timeout to a value greater than the expected length of time a client device is likely to be present. Experience shows a limit of 24 hours covers most situations eg bars, clubs, coffee shops, motels etc. If for example an hotel has guests regularly staying for a few days, then increase the session timeout as required.

Staff at the venue could have their devices added to the Trusted List if appropriate, but experience shows, it is better not to do this as they very soon learn what to do and can help guests who encounter the issue. (Anything that reduces support calls is good!)

Most such issues with CPD are potentially solved by the use of CPI instead but would require its adoption by all client device vendors.
CPI is a new standard that is evolving as it is universally adopted. At the time of writing, most new devices support it to some degree.

This website uses cookies. By using the website, you agree with storing cookies on your computer. Also you acknowledge that you have read and understand our Privacy Policy. If you do not agree leave the website.OK[More information about cookies](https://en.wikipedia.org/wiki/HTTP_cookie)

* Last modified: 2023/01/13 20:48
* by bluewavenet

**Self-registration in the wiki has been disabled.

If you want to contribute to the OpenWrt wiki, please post [HERE](https://forum.openwrt.org/t/applying-for-openwrt-wiki-account/101671 "https://forum.openwrt.org/t/applying-for-openwrt-wiki-account/101671") in the forum or ask on IRC for access.**

---

[![cc](/lib/tpl/bootstrap3/images/license/cc.png) ![by](/lib/tpl/bootstrap3/images/license/by.png) ![sa](/lib/tpl/bootstrap3/images/license/sa.png)](https://creativecommons.org/licenses/by-sa/4.0/deed.en "CC Attribution-Share Alike 4.0 International")

Except where otherwise noted, content on this wiki is licensed under the following license:
[CC Attribution-Share Alike 4.0 International](https://creativecommons.org/licenses/by-sa/4.0/deed.en "CC Attribution-Share Alike 4.0 International")

![](/lib/exe/taskrunner.php?id=docs%3Aguide-user%3Aservices%3Acaptive-portal%3Aopennds&1736882340)



=== Content from source.sierrawireless.com_2eab5116_20250114_191906.html ===
SWI-PSA-2023-006 R3

Product Security Advisory: ALEOS Security Advisory

Sierra Wireless Advisory: SWI-PSA-2023-006 R3

Release History

Revision

Date

Notes

R3

R2

R1

11 December 2023  Revised with additional detail on the impact of specific

mitigation as well as clarifying language.

07 December 2023  Revised to include additional vulnerabilities in OpenNDS with

guidance on their impact on ALEOS.

28 November 2023

Initial Release

Summary

Sierra Wireless was recently informed of eight security vulnerabilities in ALEOS, the operating system

used in certain Sierra Wireless AirLink Routers, including the MP70, RV50x, RV55, LX40, LX60 ES450

and GX450. Sierra Wireless was also informed of fourteen vulnerabilities affecting OpenNDS, an

open-source component used in ALEOS to provide simple captive portal functionality, eight of which

affect ALEOS in the configuration supplied by Sierra Wireless. The vulnerabilities are present in ALEOS

4.16 and earlier versions and have been remediated in ALEOS 4.17 released in October 2023.

CVE ID

Description

CVSSv3.1

CVE-2023-40458

The ACEManager component of ALEOS 4.16 and earlier uses an

7.5

open-source component which is vulnerable to an infinite loop

condition, which could potentially allow a remote attacker to trigger a

Denial of Service (DoS) condition for ACEManager without impairing

Page 1 / 9

SWI-PSA-2023-006 R3

other router functions. This condition is cleared by restarting the

device.

CVE-2023-40459

The ACEManager component of ALEOS  4.16 and earlier does not

7.5

adequately perform input sanitization during authentication, which

could potentially result in a Denial of Service (DoS) condition for

ACEManager without impairing other router functions. ACEManager

recovers from the DoS condition by restarting within ten seconds of

becoming unavailable.

CVE-2023-40460

The ACEManager component of ALEOS 4.16 and earlier does not

7.1

validate uploaded file names and types, which could potentially allow

an authenticated user to perform client-side script execution within

ACEManager, altering the device functionality until the device is

restarted.

CVE-2023-40461

The ACEManager component of ALEOS 4.16 and earlier allows an

8.1

authenticated user with Administrator privileges to access a file

upload field which does not fully validate the file name, creating a

Stored Cross-Site Scripting condition.

CVE-2023-40462

The ACEManager component of ALEOS  4.16 and earlier does not

7.5

perform input sanitization during authentication, which could

potentially result in a Denial of Service (DoS) condition for

ACEManager without impairing other router functions. ACEManager

recovers from the DoS condition by restarting within ten seconds of

becoming unavailable.

CVE-2023-40463  When configured in debugging mode by an authenticated user with

8.1

administrative privileges, ALEOS 4.16 and earlier store the SHA512

Page 2 / 9

SWI-PSA-2023-006 R3

hash of the common root password for that version in a directory

accessible to a user with root privileges or equivalent access.

CVE-2023-40464

Several versions of ALEOS, including ALEOS 4.16.0, use a hardcoded

8.1

SSL certificate and private key. An attacker with access to these items

could potentially perform a man in the middle attack between the

ACEManager client and ACEManager server.

CVE-2023-40465

Several versions of ALEOS, including ALEOS 4.16.0, include an open-

DoS

source third-party component which can be exploited from the local

area network, resulting in a Denial of Service condition for the captive

portal. This vulnerability could potentially be exploited to trigger

Remote Code Execution in the root context.

4.3

RCE

8.3

OpenNDS Vulnerabilities

The vulnerabilities noted below were disclosed by OpenNDS, an open-source component used within

ALEOS. While many of these vulnerabilities are not applicable to ALEOS in the configuration used by

Sierra Wireless, remediations were introduced in the ALEOS 4.17.0.12 release. OpenNDS is not used

by ALEOS 4.9.x.

The vulnerabilities in OpenNDS noted in this Security Bulletin are not exploitable if the ‘Simple Captive

Portal’ is not enabled in ALEOS.

Note: RV50 devices, while no longer supported, do not include WiFi functionality and therefore are

not impacted by these vulnerabilities.

Page 3 / 9

SWI-PSA-2023-006 R3

CVE ID

Description

CVSSv3.1

CVE-2023-38313

OpenNDS has a NULL-pointer dereference that leads to a DoS. The

6.5

issue can be triggered with a crafted GET request to /opennds_auth/

with a missing client-redirect query string parameter and client-token

and custom query string parameters set to arbitrary values. The issue

occurs when a client is about to be authenticated and takes place via

a different code path than CVE-2023-38314. Triggering the issue

crashes the OpenNDS daemon and denies Internet access to any

client that attempts to connect with this captive portal.

This vulnerability affects ALEOS prior to release 4.17.0.12.

CVE-2023-38314

OpenNDS has a NULL-pointer dereference that leads to a DoS. The

6.5

issue can be triggered with a crafted GET request to /opennds_auth/

with a missing client-redirect query string parameter and a client-

token query string parameter set to an arbitrary value. The issue

occurs while a client is not yet authenticated. Triggering the issue

crashes the OpenNDS daemon and denies Internet access to any

client that attempts to connect with this captive portal.

This vulnerability affects ALEOS prior to release 4.17.0.12.

CVE-2023-38315

OpenNDS has a NULL-pointer dereference that leads to a DoS. The

6.5

issue can be triggered with a crafted GET request to /opennds_auth/

with a missing client-token query string parameter. Triggering the

issue crashes the OpenNDS daemon and denies Internet access to

any client that attempts to connect with this captive portal.

This vulnerability affects ALEOS prior to release 4.17.0.12.

Page 4 / 9

SWI-PSA-2023-006 R3

CVE-2023-38320

OpenNDS has a NULL-pointer dereference that leads to a DoS. The

6.5

issue can be triggered via a crafted GET request to /opennds_auth/

with a missing custom query string parameter and client-token and

redirect query string parameters set to arbitrary values. Triggering

the issue 6.5 DoS TRUE Sierra:21 – Living on the Edge 9 crashes the

OpenNDS daemon and denies Internet access to any client that

attempts to connect with this captive portal.

This vulnerability affects ALEOS prior to release 4.17.0.12.

CVE-2023-38321

OpenNDS has a NULL-pointer dereference that leads to a DoS. The

6.5

issue can be triggered via a crafted GET request to /opennds_auth/

with a missing custom query string parameter and client-token and

redirect query string parameters set to arbitrary values. Triggering

the issue 6.5 DoS TRUE Sierra:21 – Living on the Edge 9 crashes the

OpenNDS daemon and denies Internet access to any client that

attempts to connect with this captive portal.

This vulnerability affects ALEOS prior to release 4.17.0.12.

CVE-2023-38322

OpenNDS has a NULL-pointer dereference that leads to a DoS. The

6.5

issue can be triggered via a crafted GET request to /opennds_auth/

with a missing User-Agent header and client-token, custom, and

redirect query string parameters set to arbitrary values. The issue

occurs when a client is about to be authenticated and happens via a

different code path than CVE-2023-38320. Triggering the issue

crashes the OpenNDS daemon and denies Internet access to any

client that attempts to connect with this captive portal.

This vulnerability affects ALEOS prior to release 4.17.0.12.

Page 5 / 9

SWI-PSA-2023-006 R3

CVE-2023-38316  When the custom URL unescape callback is enabled in OpenNDS,

8.8

unauthenticated attackers can execute arbitrary OS commands by

inserting them into the URL portion of the GET request.

This vulnerability is not exposed in the released ALEOS

configuration of OpenNDS.

CVE-2023-38317

OpenNDS does not sanitize the network interface name entry in the

6.7

configuration file, allowing attackers that have direct or indirect

access to the file to execute arbitrary OS commands.

This vulnerability is not exposed in the released ALEOS

configuration of OpenNDS.

CVE-2023-38318

OpenNDS does not sanitize the gateway FQDN entry in the

6.7

configuration file, allowing attackers that have direct or indirect

access to the file to execute arbitrary OS commands.

This vulnerability is not exposed in the released ALEOS

configuration of OpenNDS.

CVE-2023-38319

OpenNDS does not sanitize the FAS key entry in the configuration file,

6.7

allowing attackers that have direct or indirect access to the file to

execute arbitrary OS commands.

This vulnerability is not exposed in the released ALEOS

configuration of OpenNDS.

CVE-2023-38323

OpenNDS does not sanitize the status path script entry in the

6.7

configuration file, allowing attackers that have direct or indirect

access to the file to execute arbitrary OS commands.

Page 6 / 9

SWI-PSA-2023-006 R3

This vulnerability is not exposed in the released ALEOS

configuration of OpenNDS.

CVE-2023-38324  When OpenNDS is configured as FAS, and the default FAS key is used,

4.3

users can skip the splash page sequence and authenticate directly.

This vulnerability affects ALEOS prior to release 4.17.0.12.

CVE-2023-41101

OpenNDS (and the original NoDogSplash project) do not validate the

9.6

length of the query string of pre-authenticated GET requests. This

leads to a stack-based buffer overflow in NoDogSplash and OpenNDS

versions 9.x and earlier, and to a heap-based buffer overflow in

OpenNDS versions 10.x and onward. Attackers may exploit the issue

for DoS or to execute arbitrary code.

This vulnerability affects ALEOS prior to release 4.17.0.12.

CVE-2023-41102

OpenNDS (up to version 10.1.2) has multiple memory leaks due to not

4.3

freeing up allocated memory. This may lead to a DoS due to the

consumption of all available memory.

This vulnerability is not exposed in the released ALEOS

configuration of OpenNDS.

Page 7 / 9

SWI-PSA-2023-006 R3

Affected Products

These vulnerabilities, with the exception of OpenNDS vulnerabilities which do not affect ALEOS 4.9.x,

affect all AirLink routers running ALEOS software releases prior to version 4.9.9 (ES450, GX450) and

prior to 4.17.0.12 (MP70, RV50x, RV55, LX40, LX60).

Recommended Actions

If your gateway (MP70, RV50x, RV55, LX40, LX60) is on ALEOS 4.16 upgrade to ALEOS 4.17.0.12 as

soon as possible.

If your gateway is on a release earlier than ALEOS 4.16 upgrade to ALEOS 4.16, then to ALEOS

4.17.0.12 as soon as possible.

 If your gateway (ES450, GX450) is on release ALEOS 4.9.X upgrade to ALEOS 4.9.9 as soon as

possible.

Pending upgrade, the following mitigations are recommended:

1. Always use strong, and ideally unique random credentials for your devices.

2. Disable, if previously enabled, access to ACEManager on the WAN and make use of the Sierra

Wireless Airlink Management System (ALMS) or an alternative device management platform for

remote management of your ALEOS devices. Disabling access to ACEManager on the WAN will

reduce the attack surface, limiting exploitation of vulnerabilities affecting ACEManager to the LAN

and WLAN interfaces.

3. If you must leave ACEManager accessible via the WAN, restrict access using measures such as

Private APN, VPN, or the ALEOS Trusted IP feature that restricts access to specific hosts.

4. Disable the diagnostic shell, if previously enabled, on AirLink devices when not being used for

diagnostic purposes.

Page 8 / 9

SWI-PSA-2023-006 R3

6. Disable, if previously enabled and not in use, ‘Simple Captive Portal’ on the device to prevent

OpenNDS from launching. If ‘Simple Captive Portal’ is disabled, OpenNDS vulnerabilities will not be

exploitable.

5. Sierra Wireless recommends that customers using devices which are no longer supported and not

receiving the 4.17.0.12 or 4.9.9 updates refesh those devices with actively supported devices.

Note: For devices that are no longer supported, such as the RV50, we recommend following the

above recommended actions to mitigate the security risk.

Credit
Sierra Wireless would like to thank Dr. Stanislav Dashevskyi of ForeScout for bringing these issues to

our attention. We encourage anyone with a security concern related to Sierra Wireless products to

please contact us at security@sierrawireless.com.

Support Contact Information
Sierra Wireless Technical Support is available by phone or web portal from 6:00 to 17:00 PST,

Monday to Friday.

Phone (Toll-Free): 1-877-687-7795
Web: https://www.sierrawireless.com/support/community-portal/

Security Bulletins
To see the latest security updates from Sierra Wireless, please visit:
https://www.sierrawireless.com/company/security/

Page 9 / 9


