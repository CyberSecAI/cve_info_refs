=== Content from www.scitepress.org_584ef313_20250114_181140.html ===


![loading](App_Themes/BookStore/images/Loading.gif)

* [Home](HomePage.aspx)
* [About Us](AboutUs.aspx)
* [Ethics of Publication](EthicsOfPublication.aspx)
* [Ethics of Review](EthicsOfReview.aspx)
* [Contacts](Contact.aspx)
* [Sitemap](Sitemap.aspx)

[Papers](PublishedPapers/)
[Papers/2022](PublishedPapers/2022)
[Papers](http://scitepress.net/PublishedPapers/)
[Papers/2022](http://scitepress.net/PublishedPapers/2022)

* [Login](Login.aspx)
* [Sign-Up](Signup.aspx)

# [Scitepress Logo](HomePage.aspx)

The Search is performed on all of the following fields:Note: Please use complete words only.

* Publication Title
* Abstract
* Publication Keywords
* DOI
* Proceeding Title
* Proceeding Foreword
* ISBN (Completed)
* Insticc Ontology
* Author Affiliation
* Author Name
* Editor Name

If you already have a Primoris Account you can use the same username/password here.

{1}

##LOC[OK]##

{1}

##LOC[OK]##
##LOC[Cancel]##

{1}

##LOC[OK]##
##LOC[Cancel]##

Research.Publish.Connect.

![](App_Themes/BookStore/images/RadMenu.png)

* Proceedings
* Papers
* Authors
* Affiliations
* [Advanced Search](AdvancedSearch.aspx)

\*Please fill out at least one Field.
\*Value must be an number!

| Title: |  |
| --- | --- |
| ISBN: |  |
| Year: |  |
| Acronym: |  |
| Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

[Advanced Search Proceedings](AdvancedSearch.aspx?SearchCriteria=Proceedings)
Search
If you're looking for an exact phrase use quotation marks on text fields.
\*Please fill out at least one Field.

| Title: |  |
| --- | --- |
| Author: |  |
| Affiliation: |  |
| Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

[Advanced Search Papers](AdvancedSearch.aspx?SearchCriteria=Papers)
Search
If you're looking for an exact phrase use quotation marks on text fields.
\*Please fill out at least one Field.

| Name: |  |
| --- | --- |
| Affiliation: |  |
| Country: | Select a Country Ascension Island Andorra United Arab Emirates Afghanistan Antigua and Barbuda Anguilla Albania Armenia Netherlands Antilles Angola Antarctica Argentina American Samoa Austria Australia Aruba Aland Islands Azerbaijan Bosnia and Herzegovina Barbados Bangladesh Belgium Burkina Faso Bulgaria Bahrain Burundi Benin Bermuda Brunei Darussalam Bolivia Brazil Bahamas Bhutan Bouvet Island Botswana Belarus Belize Canada Cocos (Keeling) Islands Congo, The Democratic Republic of the Central African Republic Congo, Republic of Switzerland Cote d'Ivoire Cook Islands Chile Cameroon China Colombia Costa Rica Cuba Cape Verde Christmas Island Cyprus Czech Republic Germany Djibouti Denmark Dominica Dominican Republic Algeria Ecuador Estonia Egypt Western Sahara Eritrea Spain Ethiopia Finland Fiji Falkland Islands (Malvinas) Micronesia, Federal State of Faroe Islands France Gabon Grenada Georgia French Guiana Guernsey Ghana Gibraltar Greenland Gambia Guinea Guadeloupe Equatorial Guinea Greece South Georgia and the South Sandwich Islands Guatemala Guam Guinea-Bissau Guyana Hong Kong Heard and McDonald Islands Honduras Croatia Haiti Hungary Indonesia Ireland Israel Isle of Man India British Indian Ocean Territory Iraq Iran, Islamic Republic of Iceland Italy Jersey Jamaica Jordan Japan Kenya Kyrgyzstan Cambodia Kiribati Comoros Saint Kitts and Nevis Korea, Democratic People's Republic Korea, Republic of Kuwait Cayman Islands Kazakhstan Lao People's Democratic Republic Lebanon Saint Lucia Liechtenstein Sri Lanka Liberia Lesotho Lithuania Luxembourg Latvia Libyan Arab Jamahiriya Morocco Monaco Moldova, Republic of Montenegro Madagascar Marshall Islands Macedonia, The Former Yugoslav Republic of Mali Myanmar Mongolia Macau Northern Mariana Islands Martinique Mauritania Montserrat Malta Mauritius Maldives Malawi Mexico Malaysia Mozambique Namibia New Caledonia Niger Norfolk Island Nigeria Nicaragua Netherlands Norway Nepal Nauru Niue New Zealand Oman Panama Peru French Polynesia Papua New Guinea Philippines Pakistan Poland Saint Pierre and Miquelon Pitcairn Island Puerto Rico Palestinian Territory, Occupied Portugal Palau Paraguay Qatar Reunion Island Romania Serbia Russian Federation Rwanda Saudi Arabia Solomon Islands Seychelles Sudan Sweden Singapore Saint Helena Slovenia Svalbard and Jan Mayen Islands Slovak Republic Sierra Leone San Marino Senegal Somalia Suriname Sao Tome and Principe El Salvador Syrian Arab Republic Swaziland Turks and Caicos Islands Chad French Southern Territories Togo Thailand Tajikistan Tokelau Timor-Leste Turkmenistan Tunisia Tonga Turkey Trinidad and Tobago Tuvalu Taiwan Tanzania Ukraine Uganda United Kingdom United States Minor Outlying Islands United States Uruguay Uzbekistan Holy See (Vatican City State) Saint Vincent and the Grenadines Venezuela Virgin Islands, British Virgin Islands, US Vietnam Vanuatu Wallis and Futuna Islands Western Samoa Kosovo Yemen Mayotte Yugoslavia South Africa Zambia Zimbabwe |
| Conference: |  |
| Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

[Advanced Search Authors](AdvancedSearch.aspx?SearchCriteria=Authors)
Search
If you're looking for an exact phrase use quotation marks on text fields.
\*Please fill out at least one Field.

| Name: |  |
| --- | --- |
| Country: | Select a Country Ascension Island Andorra United Arab Emirates Afghanistan Antigua and Barbuda Anguilla Albania Armenia Netherlands Antilles Angola Antarctica Argentina American Samoa Austria Australia Aruba Aland Islands Azerbaijan Bosnia and Herzegovina Barbados Bangladesh Belgium Burkina Faso Bulgaria Bahrain Burundi Benin Bermuda Brunei Darussalam Bolivia Brazil Bahamas Bhutan Bouvet Island Botswana Belarus Belize Canada Cocos (Keeling) Islands Congo, The Democratic Republic of the Central African Republic Congo, Republic of Switzerland Cote d'Ivoire Cook Islands Chile Cameroon China Colombia Costa Rica Cuba Cape Verde Christmas Island Cyprus Czech Republic Germany Djibouti Denmark Dominica Dominican Republic Algeria Ecuador Estonia Egypt Western Sahara Eritrea Spain Ethiopia Finland Fiji Falkland Islands (Malvinas) Micronesia, Federal State of Faroe Islands France Gabon Grenada Georgia French Guiana Guernsey Ghana Gibraltar Greenland Gambia Guinea Guadeloupe Equatorial Guinea Greece South Georgia and the South Sandwich Islands Guatemala Guam Guinea-Bissau Guyana Hong Kong Heard and McDonald Islands Honduras Croatia Haiti Hungary Indonesia Ireland Israel Isle of Man India British Indian Ocean Territory Iraq Iran, Islamic Republic of Iceland Italy Jersey Jamaica Jordan Japan Kenya Kyrgyzstan Cambodia Kiribati Comoros Saint Kitts and Nevis Korea, Democratic People's Republic Korea, Republic of Kuwait Cayman Islands Kazakhstan Lao People's Democratic Republic Lebanon Saint Lucia Liechtenstein Sri Lanka Liberia Lesotho Lithuania Luxembourg Latvia Libyan Arab Jamahiriya Morocco Monaco Moldova, Republic of Montenegro Madagascar Marshall Islands Macedonia, The Former Yugoslav Republic of Mali Myanmar Mongolia Macau Northern Mariana Islands Martinique Mauritania Montserrat Malta Mauritius Maldives Malawi Mexico Malaysia Mozambique Namibia New Caledonia Niger Norfolk Island Nigeria Nicaragua Netherlands Norway Nepal Nauru Niue New Zealand Oman Panama Peru French Polynesia Papua New Guinea Philippines Pakistan Poland Saint Pierre and Miquelon Pitcairn Island Puerto Rico Palestinian Territory, Occupied Portugal Palau Paraguay Qatar Reunion Island Romania Serbia Russian Federation Rwanda Saudi Arabia Solomon Islands Seychelles Sudan Sweden Singapore Saint Helena Slovenia Svalbard and Jan Mayen Islands Slovak Republic Sierra Leone San Marino Senegal Somalia Suriname Sao Tome and Principe El Salvador Syrian Arab Republic Swaziland Turks and Caicos Islands Chad French Southern Territories Togo Thailand Tajikistan Tokelau Timor-Leste Turkmenistan Tunisia Tonga Turkey Trinidad and Tobago Tuvalu Taiwan Tanzania Ukraine Uganda United Kingdom United States Minor Outlying Islands United States Uruguay Uzbekistan Holy See (Vatican City State) Saint Vincent and the Grenadines Venezuela Virgin Islands, British Virgin Islands, US Vietnam Vanuatu Wallis and Futuna Islands Western Samoa Kosovo Yemen Mayotte Yugoslavia South Africa Zambia Zimbabwe |
| Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

[Advanced Search Affiliations](AdvancedSearch.aspx?SearchCriteria=Affiliations)
Search
If you're looking for an exact phrase use quotation marks on text fields.

+ Proceedings
  Proceedings Search
  \*Please fill out at least one Field.
  \*Value must be an number!

  ![Proceedings](App_Themes/BookStore/images/publications-scitepress.png)

  - | Title: |  |
    | --- | --- |
    | ISBN: |  |
    | Year: |  |
    | Acronym: |  |
    | Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

    [Advanced Search Proceedings](AdvancedSearch.aspx?SearchCriteria=Proceedings)
    Search
  - If you're looking for an exact phrase use quotation marks on text fields.
+ Papers
  Papers Search
  \*Please fill out at least one Field.

  ![Papers](App_Themes/BookStore/images/papers-scitepress.png)

  - | Title: |  |
    | --- | --- |
    | Author: |  |
    | Affiliation: |  |
    | Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

    [Advanced Search Papers](AdvancedSearch.aspx?SearchCriteria=Papers)
    Search
  - If you're looking for an exact phrase use quotation marks on text fields.
+ Authors
  Authors Search
  \*Please fill out at least one Field.

  ![Authors](App_Themes/BookStore/images/student-scitepress.png)

  - | Name: |  |
    | --- | --- |
    | Affiliation: |  |
    | Country: | Select a Country Afghanistan Aland Islands Albania Algeria American Samoa Andorra Angola Anguilla Antarctica Antigua and Barbuda Argentina Armenia Aruba Ascension Island Australia Austria Azerbaijan Bahamas Bahrain Bangladesh Barbados Belarus Belgium Belize Benin Bermuda Bhutan Bolivia Bosnia and Herzegovina Botswana Bouvet Island Brazil British Indian Ocean Territory Brunei Darussalam Bulgaria Burkina Faso Burundi Cambodia Cameroon Canada Cape Verde Cayman Islands Central African Republic Chad Chile China Christmas Island Cocos (Keeling) Islands Colombia Comoros Congo, Republic of Congo, The Democratic Republic of the Cook Islands Costa Rica Cote d'Ivoire Croatia Cuba Cyprus Czech Republic Denmark Djibouti Dominica Dominican Republic Ecuador Egypt El Salvador Equatorial Guinea Eritrea Estonia Ethiopia Falkland Islands (Malvinas) Faroe Islands Fiji Finland France French Guiana French Polynesia French Southern Territories Gabon Gambia Georgia Germany Ghana Gibraltar Greece Greenland Grenada Guadeloupe Guam Guatemala Guernsey Guinea Guinea-Bissau Guyana Haiti Heard and McDonald Islands Holy See (Vatican City State) Honduras Hong Kong Hungary Iceland India Indonesia Iran, Islamic Republic of Iraq Ireland Isle of Man Israel Italy Jamaica Japan Jersey Jordan Kazakhstan Kenya Kiribati Korea, Democratic People's Republic Korea, Republic of Kosovo Kuwait Kyrgyzstan Lao People's Democratic Republic Latvia Lebanon Lesotho Liberia Libyan Arab Jamahiriya Liechtenstein Lithuania Luxembourg Macau Macedonia, The Former Yugoslav Republic of Madagascar Malawi Malaysia Maldives Mali Malta Marshall Islands Martinique Mauritania Mauritius Mayotte Mexico Micronesia, Federal State of Moldova, Republic of Monaco Mongolia Montenegro Montserrat Morocco Mozambique Myanmar Namibia Nauru Nepal Netherlands Netherlands Antilles New Caledonia New Zealand Nicaragua Niger Nigeria Niue Norfolk Island Northern Mariana Islands Norway Oman Pakistan Palau Palestinian Territory, Occupied Panama Papua New Guinea Paraguay Peru Philippines Pitcairn Island Poland Portugal Puerto Rico Qatar Reunion Island Romania Russian Federation Rwanda Saint Helena Saint Kitts and Nevis Saint Lucia Saint Pierre and Miquelon Saint Vincent and the Grenadines San Marino Sao Tome and Principe Saudi Arabia Senegal Serbia Seychelles Sierra Leone Singapore Slovak Republic Slovenia Solomon Islands Somalia South Africa South Georgia and the South Sandwich Islands Spain Sri Lanka Sudan Suriname Svalbard and Jan Mayen Islands Swaziland Sweden Switzerland Syrian Arab Republic Taiwan Tajikistan Tanzania Thailand Timor-Leste Togo Tokelau Tonga Trinidad and Tobago Tunisia Turkey Turkmenistan Turks and Caicos Islands Tuvalu Uganda Ukraine United Arab Emirates United Kingdom United States United States Minor Outlying Islands Uruguay Uzbekistan Vanuatu Venezuela Vietnam Virgin Islands, British Virgin Islands, US Wallis and Futuna Islands Western Sahara Western Samoa Yemen Yugoslavia Zambia Zimbabwe |
    | Conference: |  |
    | Subject: | Select a Subject Artificial Intelligence Biomedical Engineering Cloud Computing Computational Intelligence Computer Vision, Visualization and Computer Graphics Computer-Supported Education Data Engineering  Energy and Economy Enterprise Information Systems Health Engineering and Technology Applications Human-Computer Interaction Informatics in Control, Automation and Robotics Information and Systems Security Knowledge-Based Systems Operational Research Pattern Recognition Photonics, Optics and Laser Technology Sensor Networks Simulation and Modeling Software Engineering Sport Science Research and Technology Telecommunications Web Information Systems and Technologies |

    [Advanced Search Authors](AdvancedSearch.aspx?SearchCriteria=Authors)
    Search
  - If you're looking for an exact phrase use quotation marks on text fields.
+ [Advanced Search](AdvancedSearch.aspx)

![](App_Themes/BookStore/images/PopupInfo.png)
The Search is performed on all of the following fields:Note: Please use complete words only.

* Publication Title
* Abstract
* Publication Keywords
* DOI
* Proceeding Title
* Proceeding Foreword
* ISBN (Completed)
* Insticc Ontology
* Author Affiliation
* Author Name
* Editor Name

If you're looking for an exact phrase use quotation marks on text fields.

## Paper

Smart Bulbs Can Be Hacked to Hack into Your HouseholdTopics:
IoT Security and Privacy
In
[Proceedings of the 20th International Conference on Security and Cryptography SECRYPT - Volume 1,](ProceedingsDetails.aspx?ID=2eUGmj5Uwn0=&t=1)
218-229,
2023
, Rome, Italy

![](Telerik.Web.UI.WebResource.axd?imgid=5842d09f283c4f6388175ec8584ac770&type=rbi)

![](Telerik.Web.UI.WebResource.axd?imgid=9f9beb9bc4c64d359796a2b3fed02ab6&type=rbi)

Authors:
[Davide Bonaventura](PersonProfile.aspx?PersonAccountID=CAJlLtRba2M=&t=1)
1
;
[Sergio Esposito](PersonProfile.aspx?PersonAccountID=KAbgQtKiW1E=&t=1)
2
 and
[Giampaolo Bella](PersonProfile.aspx?PersonAccountID=mY5Y2c9nC2I=&t=1)
1

Affiliations:
1
[Dipartimento di Matematica e Informatica, Università di Catania, Catania, Italy](AffiliationsProfile.aspx?Org=JtvLsNYXP47FkEnenjyXxgXo9q/V/FjW+uMczXPBUXYialCMTB4cYVqLQMg5iOIeVTwZeNEOM/1npIStZZIvXEAxvjoP9lcEtBhCVycjYroD/TsRf+yUow==&t=1)
;
2
[Information Security Group, Royal Holloway, University of London, Egham, U.K.](AffiliationsProfile.aspx?Org=I+up3G/n8mIlkXWSIW5M3x0gZC/RzAEbU81IYnLwuc4EEYKpUkTvqgndfszgYKsvdp9Z37jCqVCRNysg2YyQSFcvsR5IHlXV0IJsIO4L2NY=&t=1)

 Keyword(s):
IoT, Smart Homes, Smart Devices, Smart Bulb, Penetration Test, Vulnerability Assessment.

Abstract:
The IoT is getting more and more pervasive. Even the simplest devices, such as a light bulb or an electrical plug, are made “smart” and controllable by our smartphone. This paper describes the findings obtained by applying the PETIoT kill chain to conduct a Vulnerability Assessment and Penetration Testing session on a smart bulb, the Tapo L530E by Tp-Link, currently best seller on Amazon Italy. We found that four vulnerabilities affect the bulb, two of High severity and two of Medium severity according to the CVSS v3.1 scoring system. In short, authentication is not well accounted for and confidentiality is insufficiently achieved by the implemented cryptographic measures. In consequence, an attacker who is nearby the bulb can operate at will not just the bulb but all devices of the Tapo family that the user may have on her Tapo account. Moreover, the attacker can learn the victim’s Wi-Fi password, thereby escalating his malicious potential considerably. The paper terminates with an
outline of possible fixes.
(More)

The IoT is getting more and more pervasive. Even the simplest devices, such as a light bulb or an electrical plug, are made “smart” and controllable by our smartphone. This paper describes the findings obtained by applying the PETIoT kill chain to conduct a Vulnerability Assessment and Penetration Testing session on a smart bulb, the Tapo L530E by Tp-Link, currently best seller on Amazon Italy. We found that four vulnerabilities affect the bulb, two of High severity and two of Medium severity according to the CVSS v3.1 scoring system. In short, authentication is not well accounted for and confidentiality is insufficiently achieved by the implemented cryptographic measures. In consequence, an attacker who is nearby the bulb can operate at will not just the bulb but all devices of the Tapo family that the user may have on her Tapo account. Moreover, the attacker can learn the victim’s Wi-Fi password, thereby escalating his malicious potential considerably. The paper terminates with an outline of possible fixes.

![](App_Themes/BookStore/images/PopupInfoLarge.png)
![](App_Themes/BookStore/images/pdf_download.png)Full TextDownload
Please type the code
![](Telerik.Web.UI.WebResource.axd?type=rca&isc=true&guid=cabe2ef6-f902-4e6e-96e6-b20f27a859c2)Generate New Image

Enter text above before pressing **[Download]** (case sensitive)

![](App_Themes/BookStore/images/88x31.png)
[CC BY-NC-ND 4.0](https://creativecommons.org/licenses/by-nc-nd/4.0/)![Sign In](App_Themes/BookStore/images/info-sign-th.png)
![](App_Themes/BookStore/images/PopupInfo.png)
Guests can use SciTePress Digital Library without having a SciTePress account. However, guests have limited access to downloading full text versions of papers and no access to special options.

Guests can use SciTePress Digital Library without having a SciTePress account. However, guests have limited access to downloading full text versions of papers and no access to special options.

Guest:
[Register as new SciTePress user](Signup.aspx)
now for free.
![Sign In](App_Themes/BookStore/images/info-sign-th.png)
![](App_Themes/BookStore/images/PopupInfo.png)
Download limit per month - 500 recent papers or 4000 papers more than 2 years old.

SciTePress user:
 [please login](Login.aspx).
![PDF Image](App_Themes/BookStore/images/pdf_icon_large.png)My Papers
![PopUp Banner](App_Themes/BookStore/images/PopupInfo.png)
Unable to see papers previously downloaded, because you haven't logged in as SciTePress Member.
If you are already a member
 [please login.](Login.aspx)

You are not signed in, therefore limits apply to your IP address 109.78.161.61In the current month:
Recent papers:
 100
available of
 100
total

2+ years older papers:
 200
available of
 200
total

![Popup Banner](App_Themes/BookStore/images/PopupInfoLarge.png)![PDF Button](App_Themes/BookStore/images/pdf_download.png)Full TextDownload
Please type the code
![](Telerik.Web.UI.WebResource.axd?type=rca&isc=true&guid=bcb0de64-34b4-4289-9014-6d05fead93c0)Generate New Image

Enter the captcha text before pressing **[Download]** (case sensitive)

Paper citation in several formats:

* Harvard
* Bibtex
* EndNote

Bonaventura, D., Esposito, S. and Bella, G. (2023). **Smart Bulbs Can Be Hacked to Hack into Your Household**. In *Proceedings of the 20th International Conference on Security and Cryptography - SECRYPT*; ISBN 978-989-758-666-8; ISSN 2184-7711, SciTePress, pages 218-229. DOI: 10.5220/0012092900003555
@conference{secrypt23,
author={Davide Bonaventura and Sergio Esposito and Giampaolo Bella},
title={Smart Bulbs Can Be Hacked to Hack into Your Household},
booktitle={Proceedings of the 20th International Conference on Security and Cryptography - SECRYPT},
year={2023},
pages={218-229},
publisher={SciTePress},
organization={INSTICC},
doi={10.5220/0012092900003555},
isbn={978-989-758-666-8},
issn={2184-7711},
}
TY - CONF

JO - Proceedings of the 20th International Conference on Security and Cryptography - SECRYPT
TI - Smart Bulbs Can Be Hacked to Hack into Your Household
SN - 978-989-758-666-8
IS - 2184-7711
AU - Bonaventura, D.
AU - Esposito, S.
AU - Bella, G.
PY - 2023
SP - 218
EP - 229
DO - 10.5220/0012092900003555
PB - SciTePress

![](App_Themes/BookStore/images/scitepress.png "Science Technology Publications")
- Science and Technology Publications, Lda.
RESOURCES

[Proceedings](ProceedingsList.aspx)

[Papers](TopicsFilter.aspx)

[Authors](Authors.aspx)

[Ontology](OntologyTree.aspx)

CONTACTS

Science and Technology Publications, Lda

Avenida de S. Francisco Xavier, Lote 7 Cv. C,

2900-616 Setúbal, Portugal.

Phone: +351 265 520 185 (National fixed network call)

Fax: +351 265 520 186

EXTERNAL LINKS

[PRIMORIS](http://www.insticc.org/Primoris/)

[INSTICC](http://www.insticc.org/Portal/)

[SCITEVENTS](http://www.scitevents.com/)

[CROSSREF](http://www.crossref.org/)

PROCEEDINGS SUBMITTED FOR INDEXATION BY:

[dblp](http://dblp.uni-trier.de/)

[Ei Compendex](http://www.engineeringvillage.com/)

 [SCOPUS](http://www.scopus.com)

[Semantic Scholar](https://www.semanticscholar.org/)

[Google Scholar](https://scholar.google.com/)

[Microsoft Academic](https://academic.microsoft.com/home)

© 2021 SciTePress, Science and Technology Publications, Lda - All rights reserved.

<style>
#socialicons>a span { top: 0px; left: -100%; -webkit-transition: all 0.3s ease; -moz-transition: all 0.3s ease-in-out; -o-transition: all 0.3s ease-in-out; -ms-transition: all 0.3s ease-in-out; transition: all 0.3s ease-in-out;}
#socialicons>ahover div{left: 0px;}
</style>



=== Content from arxiv.org_8f20fecc_20250114_181131.html ===
3
2
0
2

g
u
A
7
1

]

R
C
.
s
c
[

1
v
9
1
0
9
0
.
8
0
3
2
:
v
i
X
r
a

Smart Bulbs can be Hacked to Hack into your
Household*

1st Davide Bonaventura
Dipartimento di Matematica e Informatica
Universit`a di Catania
Catania, Italy
d.bonaventura@studium.unict.it
orcid.org/0009-0004-4463-7991

2nd Sergio Esposito
Information Security Group
Royal Holloway
University of London
Egham, UK
sergio.esposito.2019@live.rhul.ac.uk
orcid.org/0000-0001-9904-9821

3rd Giampaolo Bella
Dipartimento di Matematica e Informatica
Universit`a di Catania
Catania, Italy
giamp@dmi.unict.it
orcid.org/0000-0002-7615-8643

Abstract—The IoT is getting more and more pervasive. Even
the simplest devices, such as a light bulb or an electrical plug,
are made “smart” and controllable by our smartphone. This
paper describes the findings obtained by applying the PETIoT
kill chain to conduct a Vulnerability Assessment and Penetration
Testing session on a smart bulb, the Tapo L530E by Tp-Link,
currently best seller on Amazon Italy. We found that four
vulnerabilities affect the bulb, two of High severity and two of
Medium severity according to the CVSS v3.1 scoring system. In
short, authentication is not well accounted for and confidentiality
is insufficiently achieved by the implemented cryptographic
measures. In consequence, an attacker who is nearby the bulb
can operate at will not just the bulb but all devices of the
Tapo family that the user may have on her Tapo account.
Moreover, the attacker can learn the victim’s Wi-Fi password,
thereby escalating his malicious potential considerably. The paper
terminates with an outline of possible fixes.

Index Terms—IoT, smart homes, smart devices, smart bulb,

penetration test, vulnerability assessment.

I. INTRODUCTION

The Internet of Things (IoT) surrounds people virtually
everywhere due to the increasing number of devices that be-
come computerised and interconnected — it may even pervade
people’s bodies thanks to the rise of implantable medical
devices and wearable devices. IoT devices exceeded 13.8
billion in 2021 and are expected to double by 2025 [Howarth,
2023]. This world of devices leads to a massive attack surface
with a significant increase in the number of entry points for
hackers and, correspondingly, security and privacy challenges
for researchers and engineers to face.

While the full range and inherent diversity of IoT devices
cannot be overestimated, safety critical devices, such as self-
driving cars, Industrial Control Systems (ICS) and their secu-
rity and privacy challenges, risk drawing too much attention to
the detriment of inexpensive devices, such as those for home
automation. It must be stressed that any home automation issue
would be highly impactful due to the enormous use of such
devices worldwide, which is also favoured by a general price
decrease.

In Proceedings of the 20th International Conference on Security and
Cryptography (Secrypt 2023), ISBN 978-989-758-666-8, ISSN 2184-7711,
pages 218-229. DOI: 10.5220/0012092900003555

We observe that similar considerations apply to smart bulbs,
whose hijacking may have security implications, e.g., help a
thief abuse the victim’s electricity consumption, then privacy
implications, e.g., help the thief profile the victim’s patterns of
usage hence their habits and, ultimately, safety implications,
e.g., ultimately help the thief understand if a household is cur-
rently empty or not. Following these observations, this paper
rests on the following research question: What vulnerabilities
affect best-seller light bulbs? What consequences do they have
on the end user’s security, privacy and safety?

A. Contributions

Our experiments apply the (steps of the) PETIoT kill
chain [Bella et al., 2023] to conduct a Vulnerability Assess-
ment and Penetration Testing (VAPT) on the Tp-Link Tapo
Smart Wi-Fi Light Bulb, Multicolor (L530E), currently best-
seller on Amazon Italy, Fig. 1. The Tapo L530E is a cloud-
enabled multicolor Smart Bulb that can be controlled through
the Tapo proprietary application. The user needs to install
it on an Android or iOS mobile device and then create a
technology for
Tapo account. The smart bulb uses Wi-Fi
connectivity. So, unlike many other smart bulbs requiring a
dedicated hub, the user can enjoy the L530E as is by simply
connecting it to their home Wi-Fi network.

Contrarily to a potential belief that smart bulbs are not worth
protecting or hacking, we found out that this model suffers
four vulnerabilities that are not trivial and, most importantly,
may have a dramatic impact:

1) Vulnerability 1. Lack of authentication of the smart bulb
with the Tapo app, 8.8 CVSS score, High severity. The
app does not get any guarantee about the identity of its
peer. Therefore, anyone can authenticate to the app and
pretend to be the smart bulb.

2) Vulnerability 2. Hard-coded, short shared secret, 7.6
CVSS score, High severity. The secret used by both the
Tapo app and the smart bulb is short and exposed by
both the code fragments run by the app and by the smart
bulb.

3) Vulnerability 3. Lack of randomness during symmetric
encryption, 4.6 CVSS score, Medium severity. The ini-

device despite the fact that he does not understand the precise
cleartext inside each message. Therefore, the attacker may
attempt to re-use those messages at will to operate the device
as each message determines. In combination with vulnerability
4, the attacker is assured that whatever message he replays
will be accepted by the bulb, hence a Denial-of-Service (DoS)
attack becomes possible.

B. Ethics and Responsible Disclosure

All experiments performed on Tapo L530E only involve de-
vices, Wi-Fi networks, accounts, emails, and passwords owned
solely by the authors of this work. During the experiments, no
user nor third-party data were accessed.

We dutifully contacted Tp-Link via their Vulnerability Re-
search Program (VRP), reporting all four vulnerabilities we
found. They acknowledged all of them and informed us that
they started working on fixes both at the app and at the bulb
firmware levels, planning to release them in due course.

C. Paper Summary

This paper continues with a short account of the related
work (§II). It
then unfolds the six phases of the chosen
methodology, i.e., the PETIoT kill chain, on the chosen target,
i.e., the Tapo L530E (§III through §VIII). Finally, it draws the
relevant conclusions (§IX).

II. RELATED WORK

The security and privacy aspects of IoT devices are becom-
ing more and more important and, correspondingly, the related
work concerning such devices is very wide. Due to space
constraints, this section is reduced to the literature entries that
are most relevant to the core of this paper.

In 2021, it was shown that printers are common devices
whose networked use may suffer at least three attacks [Bella
and Biondi, 2019]. The first attack, zombies for traditional
DDoS, shows how some printers may suffer from vulnera-
bilities that would transform them into exploitable zombies.
The second attack, paper DoS, shows how a large number
of printers are found to honour unauthenticated printing re-
quests. The third attack, privacy infringement, shows how
these devices bear a remarkable risk of data breach. Later,
the same authors contributed to similar experiments against
VoIP phones [Biondi et al., 2020]. Our work follows a similar
methodology.

In 2022, a literature survey for understanding IoT security
threats and challenges appeared [Nath and Nath, 2022]. It is
divided into three parts. The first part contains an analysis of
the main threats and attacks, also analysing the IoT ecosystem
internal network services,
from four perspectives: devices,
external network services and users. The second part contains
a study on recent IoT malware attacks. Finally, the general
security requirements and challenges to address the devised
attack categories are discussed. This work was inspirational
for our experiments.

PETIoT is a recent cyber Kill Chain (KC) specifically de-
veloped to guide VAPT sessions over IoT devices [Bella et al.,

Fig. 1. The Tapo L530E on Amazon.it

tialisation vectors (IVs) used by the Tapo app and the
smart bulb are static, and each communication session
uses a single, fixed IV for each message.

4) Vulnerability 4.

Insufficient message freshness, 5.7
CVSS score, Medium severity. Neither the app nor the
smart bulb implements appropriate measures to check
the freshness of messages that they receive.

Our exploitation experiments of such vulnerabilities demon-
strate that a malicious attacker who stands in proximity of
the target smart bulb, hence of the Wi-Fi access point to
which the bulb is meant to be connected, can exploit the
bulb in various ways. Vulnerability 1 means that the attacker
impersonates the bulb and receives the user’s Tapo credentials
as well as the user’s Wi-Fi credentials from the Tapo app.
To achieve this, the bulb must be in setup mode, when it
exposes its own SSID. Alternatively, if the bulb is already
configured and working, then the attacker mounts a simple
Wi-Fi deauthentication attack against the bulb and repeats it
until the user attempts to setup the bulb again to restore it.

The attacker may also interleave another session: by lever-
aging the credentials just obtained, he impersonates the user
through the setup of the bulb and receives a session key
from the device, which he may then relay back to the user.
Therefore, the attacker effectively mounts a man-in-the-middle
the Tapo app also
attack. Moreover, during device setup,
releases the Wi-Fi credentials to the attacker, thereby causing
a clear escalation of the malicious potential for other attacks
requiring local access.

Vulnerability 2 means that the attacker can obtain the key
that the Tapo app and the smart bulb share and use for the
authentication and the integrity of the messages exchanged
during the initial discovery phase, described in Section V-A.
Thanks to the knowledge of the key, the attacker can violate
the integrity and authentication of the messages of this phase.
the attacker understands the
consequences of certain encrypted messages on the target

Vulnerability 3 means that

2023] with a focus on detecting their network vulnerabilities.
The KC is demonstrated on the Tapo C200 IP camera by
Tp-Link, enabling the discovery of three severe vulnerabili-
ties: Improper neutralisation of inbound packets; Insufficient
entropy in encrypted notifications; Cleartext transmission of
video stream. Each of the vulnerabilities found is exploited
through different attack scenarios, and appropriate remediation
measures are illustrated as possible fixes. We followed PETIoT
strictly through our work, as can be seen by the steps discussed
below.

In 2018, a penetration testing session on the Tradfri smart
bulb produced by IKEA was reported [Dalvi et al., 2018].
The article describes four different attacks. Hacking Smart
Light Bulb via Bluetooth allows the attacker to control the
bulb. IKEA Tradfri Gateway Exploit allows the attacker to
compromise the ZigBee Tradfri gateway by managing to break
the firmware update. Denial of Service Attack allows the
attacker to perform a DoS attack against
the gateway by
flooding it with UDP packets. Identity Spoofing allows the
attacker to impersonate the CoAP client and control the smart
bulbs. This work is closely related to ours but revolves around
the ZigBee protocol and does not achieve escalation to local
Wi-Fi access.

III. EXPERIMENT SETUP

We begin defining the experiment setup, accordingly with
the PETIoT kill chain. Our setup is non-invasive, as the smart
bulb is not tampered with. It includes:

• A Wi-Fi switch to provide local connectivity.
• A Smart bulb Tapo series L530 with Hardware Version

1.0.0 and Firmware Version 1.1.9.

• A Samsung smartphone running Android 11 and the Tapo

app Version 2.8.14.

• An Ubuntu 22.04 machine with 5.15.0-47 kernel to run

all software needed for the experiments.

To be able to use all the bulb features, it is necessary to create
a Tapo account and login into it. Depending on whether the
smart bulb is already associated with a Tapo account or not,
and the network configuration used, we identify three different
setups. In all three setups, the smartphone has access to the
Tapo account to which the smart bulb is associated, or to which
the user wants to associate it.

A. Setup A

The context of the Setup A is as follows.
• The user has previously associated her smart bulb with the
Tapo app on her phone. During the association process,
the user connects the smart bulb to a certain network X.
• The Ubuntu device and the user’s phone are both con-
nected to the same network Y as shown in Fig. 2 —
this is not necessarily the network X to which the Tapo
L530E is connected.

This setup does not require the Ubuntu device to have access
to the network to which the smart bulb is connected, but
only to be connected to the same network as the Tapo app.

Fig. 2. Setup A, network without a local smart bulb

Therefore, the user could, for example, connect to a public
network to turn off a light that may have been mistakenly left
on at home.

B. Setup B

The context of the Setup B is as follows.
• The user has previously associated her smart bulb with the
Tapo app on her phone. During the association process,
the user connects the smart bulb to a certain network X.
• The Ubuntu device and the user’s phone are both con-
nected to the same network X to which the smart bulb
is connected, as shown in Fig. 3.

• The Ubuntu device has complete control of the network
X. It is able to carry out an ARP spoofing attack, i.e.,
to intercept data frames, modify the network traffic or
prevent it from reaching its intended recipient.

Fig. 3. Setup B, network with a configured smart bulb

This setup requires the active presence of the smart bulb. In
addition, the setup requires the Ubuntu device to have access
to the network to which the smart bulb is connected, typically
the victim’s local network. Therefore, all devices used are
connected via Wi-Fi to the same access point.

C. Setup C

The context of the Setup C is as follows.
• The user wants to associate the newly reset or not yet

configured smart bulb with her Tapo account.

• The Tapo app (hence, the user) believes to be connected
to the network X created by the smart bulb, but it is
actually connected to a network Y controlled by the
Ubuntu device.

• The Ubuntu device is connected both to the network
created by the smart bulb and to the network controlled
by itself.

This setup occurs when the smart bulb has been reset or
has not been configured yet. As detailed in Section V-C1, the
smart bulb starts a public access point to which the user must
connect to complete the setup. The network configuration is
shown in Fig. 4.

Fig. 4. Setup C, network with a non-configured bulb

The Wi-Fi deauthentication attack allows the attacker to
easily get Setup C. A Wi-Fi deauthentication attack is a type of
denial-of-service attack that targets communications between
a device and a Wi-Fi wireless access point [Kristiyanto and
Ernastuti, 2020]. Thanks to this attack, the attacker can deau-
thenticate the smart bulb from the network to which it is
connected, forcing the user to repeat its setup process. The
Wi-Fi deauthentication attack requires the access point and
connected devices not to use 802.11w or WPA3. Although
in literature there are other theoretically feasible methods to
perform the deauthentication attack anyway [Schepers et al.,
2022], we did not test them. In Setup C, we assume that the
network to which the smart bulb is connected is a network
where the deauthentication attack can be performed. One way
to mount it would be to leverage Aircrack-ng [d’Otreppe de
Bouvette, 2023], as described in a blog [Alopix, 2023]. The
attack requires the adversary to know the victim device’s MAC
address, however, it is possible to list all MAC addresses
connected to nearby access points by simply listening to the
traffic, so the adversary has a short and finite list of addresses
to try.

by the smart bulb — hence, the adversary performs another
Wi-Fi deauthentication attack to deauthenticate the phone
running the Tapo app from the network started by the smart
bulb, arguably inducing the victim to re-attempt to connect,
eventually using the adversary-controlled network with the
same SSID. As the network started by the smart bulb is an
unprotected Wi-Fi 4 (802.11n) network, in this latter case the
deauthentication attack will always work. Intuitively, this setup
assumes that the Ubuntu device is close enough to the network
started by the smart bulb to hear the emitted carrier.

IV. INFORMATION GATHERING

After the setup we can proceed to the collection of informa-
tion. The following tools are installed on the Ubuntu device:
• Ettercap [Ettercap, 2023], a suite of tools to perform
MITM attacks used on the Ubuntu device to control the
network.

• Wireshark [Wireshark, 2023], a network protocol analyser
(or packet sniffer) used to capture and analyse traffic.
The smart bulb firmware source code is not publicly available.
Therefore, the offensive activities are performed in black-box
mode.

Thanks to the messages captured with Wireshark it
is
possible to distinguish between three different types of com-
munications. They differ according to the sender and the
receiver of the various messages belonging to them. The
three different types of communications we identified are:
(a) communications App-Cloud, including all messages ex-
changed between the Tapo App and the Cloud Server; (b)
communications Bulb-App, including all messages exchanged
between the smart bulb and the Tapo App; (c) communications
Cloud-Bulb, including all messages exchanged between the
Cloud Server and the smart bulb. When the phone running the
Tapo app is not connected to the same network as the light
bulb, communications happen through the cloud, combining
App-Cloud and Cloud-Bulb communications – otherwise, they
take place locally with Bulb-App communications.

All communications through the cloud, i.e., App-Cloud and
Cloud-Bulb, are encrypted. They take place through the use
of a secure TLS channel that ensures authenticity, integrity,
and confidentiality of the messages, even though they are
transmitted over the Internet. Instead, all Bulb-App commu-
nications are exchanged via HTTP messages. Their payloads
are encrypted using the AES128 block cipher in CBC mode.
The initialisation vector and the cryptographic key used for
this protocol are exchanged using the Tapo “Symmetric Key
Exchange Protocol” (TSKEP), which is described below in
Section V-B. This protocol only generates traffic over the local
Wi-Fi network, not through the Internet.

Our offensive activities only target Bulb-App communica-

tions, and ignore the others.

V. TRAFFIC ANALYSIS

After the victim resets the smart bulb, it enters setup mode.
In Setup C, the Ubuntu device needs the Tapo app to connect
to the network it controls and not to the network started

Thanks to the information obtained during the previous
phase, it is now possible to analyse the network traffic prof-
itably.

The API exposed by the smart bulb is very similar to a
Remote Procedure Call (RPC). The JSON sent by the app to
the smart bulb contains the name of the method to be invoked
and its parameters. The responses sent by the smart bulb to
the app contain an error code representing the outcome of the
operation (whether it was successfully executed or the error
occurred) with an optional result. All JSONs are exchanged
via the payloads of HTTP messages.

Before the Tapo app starts using the API exposed by the
bulb, it must perform two preliminary steps: locate the smart
bulb within the network to which it is connected, and exchange
a symmetric key with the smart bulb to encrypt messages.
Therefore, the communication between smart bulb and Tapo
app can be summarised in three macro-steps:

• Bulb Discovery – it allows the Tapo app to locate the
smart bulb within the local network and to get the smart
bulb’s current configuration.

• Tapo Symmetric Key Exchange Protocol – executing the
TSKEP protocol allows the Tapo app and smart bulb to
exchange a symmetric key.

• Smart bulb usage – it consists in using the actual smart

bulb app protocol.

These macro-steps are described in detail below.

A. Bulb Discovery

Smart bulb configurations may change over time. For ex-
ample, the IP address assigned to it by the DHCP server
might have changed, it might start using a different encryption
scheme after an update, or it might have just been reset. Before
the Tapo app can start communicating with the smart bulb, it
must locate the smart bulb within the local network and get
its current configuration. To do this, the Tapo app connects to
the UDP service listening on the 20002 port of the smart bulb,
as represented in Fig. 5.

Fig. 5. Tapo (local) Device dicovery

The payload format of such UDP messages is represented

in Table I. It can be explained as follows:

• Bytes in positions [0:3] and [6:7] are static. Their values

never change.

by the smart bulb in the bulb discovery response message
from the smart bulb. This allows the Tapo app to obtain
guarantees about the freshness of the response received
from the smart bulb.

• Logically,

the checksum field must be excluded from
the computation of the checksum itself — instead, a
secret key of the same length is used in its place for
the checksum computation. This secret key is hard-
coded in both the Tapo app and the smart bulb, hence,
the checksum acts like a Message Authentication Code
(MAC). This field allows the receiver to understand that
the message arrives intact as it is sent. The algorithm used
for the checksum calculation is the Cyclic Redundancy
Check 32 (CRC-32), a checksum algorithm that hashes
byte sequences to 32 bit values.

• The data field contains different information depending
on whether it is a bulb discovery request or a bulb dis-
covery response and whether the smart bulb is configured
or not.

1
0
0x02
0x00
Data length

Octet
2
0x00
0x11

3
0x01
0x00

Nonce
Checksum
Data

Offset

0
4
8
12
...

TABLE I
FORMAT OF THE PAYLOAD OF UDP MESSAGES

B. Tapo Symmetric Key Exchange Protocol

This step uses the RPC API exposed by the smart bulb
on port 80. All exchanged messages are HTTP messages, so
at the transport layer, only the TCP protocol is used. The
TSKEP, represented in Fig. 6, allows Tapo app and smart
bulb to exchange a 128-bit AES key and an IV to encrypt
the payload of various HTTP messages. The protocol consists
of four different messages:

1) RSA public key transmission
2) AES key transmission
3) Login
4) Token transmission
At the end of this phase, Tapo app and smart bulb get
a short-term shared secret to encrypt all subsequent traffic.
Thanks to the credential stored during the setup phase, for the
smart bulb the secret is also authenticated.

C. Smart Bulb Setup

• The data length field contains the length of the data field,
which contains the data exchanged between Tapo app and
smart bulb. When the data field is empty (i.e., when it
has length 0) the bits of this field are all set to 0.

• The nonce field contains a 4-byte string randomly gener-
ated by the Tapo app. The string is inserted in the bulb
discovery request message from the Tapo app and quoted

This section focuses on the two possible configurations for
the smart bulb and specifies them in depth following our traffic
analysis efforts.

1) Smart bulb turned on and not configured: Before a smart
bulb Tapo L530E can be used, it must be associated with a
Tapo account. There are two reasons why a smart bulb may
not be associated with any accounts: because it has been reset,

VI. VULNERABILITY ASSESSMENT

The assessment following the information gathered so far

highlights four vulnerabilities.

a) Vulnerability 1 – Lack of the smart bulb authentication
with the Tapo app.: Improper Authentication [MITRE, 2006a]
in Tapo L503E allows an adjacent attacker to impersonate the
Tapo L530E with the Tapo app during the TSKEP step.

In the TSKEP step, unlike the Bulb Discovery step, the
protocol used to exchange the session key does not give the
Tapo app any evidence of its peer’s identity. Hence, an attacker
is able to authenticate to the Tapo app as the Tapo L530E or
as another device: in fact, this vulnerability is present in all
Tapo smart devices that use the TSKEP protocol.

The CVSS v3.1 score that we calculate is 8.8, meaning High
severity. Precisely: Attack Vector: Adjacent; Attack Com-
plexity: Low; Privileges Required: None; User Interaction:
Required; Scope: Changed; Confidentiality: High; Integrity:
High; Availability: High. In particular, Attack Complexity
is low because the attacker could impersonate the bulb by
implementing the protocol messages to respond to the calling
app. Following that, he could obtain the user password on the
Tapo app, then fully impersonate the user and manipulate at
will any target Tapo device of the same user. Precisely, by
impersonating the bulb at setup time as explained above, the
attacker would receive the victim’s Wi-Fi SSID and password
from the Tapo app, so that he could then impersonate the user
by her password at each session with the target device, which
could be any Tapo device of the user’s. The attacker could
also obtain the device-chosen session key, which he could then
relay to the user’s genuine app and effectively interpose.

b) Vulnerability 2 – Hard-coded short checksum shared
secret.: Protection Mechanism Failure [MITRE, 2008] in Tapo
L503E allows an adjacent attacker to obtain the secret used
for authentication during the Bulb Discovery phase.

The shared secret used for Bulb Discovery’s messages
authentication is short and hard-coded both in the Tapo app
and in the Tapo L530E. Therefore, it can be obtained in the
following ways:

1) Brueforcing, because of its shortness.
2) Decompiling the Tapo app.
The CVSS v3.1 score that we calculate is 7.6, meaning High
severity. Precisely: Attack Vector: Adjacent; Attack Com-
plexity: Low; Privileges Required: None; User Interaction:
Required; Scope: Unchanged; Confidentiality: Low; Integrity:
High; Availability: High. The knowledge of the shared secret
provides to the attacker the ability to edit and to create
Bulb Discovery messages. Specifically, the attacker is able
to generate fake bulb discovery requests to locate all smart
bulbs, or generally Tapo devices using the same protocol,
connected within the same network. Meanwhile, the ability
to edit valid messages allows the attacker to edit the bulb
discovery response messages sent from the smart bulb to the
Tapo app.

c) Vulnerability 3 – Lack of randomness during symmet-
ric encryption.: Use of a Cryptographic Primitive with a Risky

Fig. 6. Tapo Symmetric Key Exchange Protocol

or it has not been configured yet. In this Section, we discuss
the process of associating the smart bulb with a Tapo account.
An unconfigured or newly reset smart bulb starts a public
access point with SSID Tapo Bulb XXXX, where XXXX
are four decimal places. The smart bulb also acts as a switch
within the network it generates. In order to configure it and
associate it with their Tapo account, the user must connect to
the Wi-Fi network started by the smart bulb itself.

After that, the Tapo app tries to locate the smart bulb. To
do this, it starts sending bulb discovery request messages to
broadcast. In this case, the data field of these messages is
empty. After the identification of the smart bulb, the Tapo app
starts the TSKEP protocol with it. The values set in the login
message as username and password are fixed values that
the Tapo app uses every time it configures a new device.

Once the symmetric key is obtained, Tapo app sends to the
smart bulb the SSID and the password of the Wi-Fi network
to which the smart bulb must connect. The Tapo app also
sends the credentials of the Tapo account to which it must be
associated. The credentials are then stored by the smart bulb.
Through these credentials, smart bulb is able to authenticate
all subsequent requests of Tapo app. At this point, the smart
bulb turns its access point off and connects to the specified
Wi-Fi network. The smart bulb starts communicating with the
cloud server to complete its setup. Hence, the Wi-Fi network
to which the smart bulb connects must have Internet access.
2) Smart bulb already configured: Let us now consider the
case where the smart bulb is associated with a Tapo account
and it is ready to be used. As mentioned before, it can be
controlled either locally or remotely via the Tapo cloud. To do
so, the Tapo application initially tries to locate the smart bulb
within the network with a bulb discovery request message. If it
detects it (i.e., it gets a response) then the interaction happens
locally via Bulb-App communications, which are the subject
of our analysis. Otherwise, if the Tapo app does not receive
any valid bulb discovery response, then it tries to check the
smart bulb remotely. If the smart bulb is not detectable even
remotely then it is determined offline.

Implementation [MITRE, 2020] in Tapo L503E allows an adja-
cent attacker to make the cryptographic scheme deterministic.
The IV used in AES128-CBC scheme is generated together
with the key and remains unchanged for the entire life of the
key. Therefore, the encryption of the same messages produces
the same ciphertext.

The CVSS v3.1 score that we calculate is 4.6, meaning
Medium severity. Precisely: Attack Vector: Adjacent; Attack
Complexity: Low; Privileges Required: None; User Inter-
action: Required; Scope: Unchanged; Confidentiality: Low;
Integrity: None; Availability: Low. When the user interacts
with the device thereby generating traffic, the attacker can
distinguish repeated messages without deciphering them, yet
infer what messages lead to what consequences, such as
turning the bulb off. He could then manipulate the bulb by
repeating those messages.

d) Vulnerability 4 – Insufficient message freshness.:

Predictable from Observable State [MITRE, 2006b] in Tapo
L503E allows an adjacent attacker to replay messages that are
considered valid both from the Tapo L530E and the Tapo app.
The smart bulb and the Tapo app do not check the freshness
or the duplicity of the received messages. They only check that
the session key with which the messages are encrypted is still
valid, i.e., not older than 24 hours.

The CVSS v3.1 score that we calculate is 5.7, meaning
Medium severity. Precisely: Attack Vector: Adjacent; Attack
Complexity: Low; Privileges Required: None; User Inter-
action: Required; Scope: Unchanged; Confidentiality: None;
Integrity: None; Availability: High. Similarly to the previous
vulnerability, the attacker can leverage user-generated traffic,
this time to replay messages that both the bulb and the app will
certainly accept because of the lack of appropriate freshness
measures.

VII. EXPLOITATION

This Section shows how an attacker can exploit the vul-
nerabilities we found in a real environment. We show 5
attack scenarios, in which the attacker exploits one or more
vulnerabilities to achieve their malicious goals. We validated
each attack scenario by manually executing the steps illustrated
in the forthcoming sections, hence all reported attacks are
feasible in practice. As noted above through the CVSS scores,
their likelihood is determined by the Adjacent Attack Vector,
the Low Attack Complexity, the No Privileges Required and
the Required User Interaction.

A. Attack scenario 1 - Fake Bulb Discovery messages gener-
ation

In this experiment we exploited:
• Vulnerability 2, with the goal of getting the ability to

create fake Bulb Discovery messages.

every time it is opened, regardless of the network to which
it is connected. To get a valid one, we just capture the traffic
using Wireshark and use a filter to extract all UDP messages
sent in broadcast e.g., by using the filter udp && ip.dst
== 255.255.255.255. Once a UDP message is obtained,
we can perform an offline brute-force attack to get the secret
shared between the Tapo app and the smart bulb. At this point,
neither the smart bulb nor the Tapo app needs to be active
anymore to complete the attack. In our setup, the brute-force
attack always succeeded in 140 minutes on average.

This grants the adversary the ability to create fake bulb
discovery request and response messages: the former allows
the attacker to identify all Tapo devices that use the same
protocol and the same key, on any network he connects to,
while the latter allows the attacker to respond to the Tapo
app’s request messages with false configurations.

B. Attack scenario 2 - Password exfiltration from Tapo user
account

In this experiment we exploited, in order:
• Vulnerability 2, with the goal of getting the ability to

create fake bulb discovery response messages,

• Vulnerability 1, with the goal of getting the ability to

authenticate as the Tapo L530E to the Tapo app.

The context in which we conduct the experiment is Setup
A described in Section III-A. To carry out this attack, the
adversary needs to obtain the ownerId of the victim Tapo
account, and the UDP port to which the victim sends her
bulb discovery request messages (in our case, port 20002).
The attack diagram is shown in Fig. 7.

Fig. 7. Sequence chart for the attacker’s impersonation of the bulb

This experiment can be conducted in every scenario pre-
sented in Section III. For this attack, it is first necessary to
get hold of a UDP message. In our case, we have chosen to
use a real bulb discovery request message, because they are
easy to get. These messages are broadcast by the Tapo app

The exploitation begins the moment the victim opens her
own Tapo app. When the app is open, it starts broadcasting
bulb discovery request messages. During the attack, the at-
tacker exploits his ability to create fake bulb discovery re-
sponse messages to respond to various bulb discovery request

from the victim. The attacker sets the bulb discovery response
messages fields as shown in Listing 1:

the victim’s Tapo account. This results in a confidentiality
loss.

• It sets the owner field to the ownerId of the victim. This
is to make the Tapo app think there is a device of its own
on the network to start TSKEP.

• It sets the ip and port fields to point to an adversary-

controlled server.

{

"result": {

"device_id": "bd1e...9348",
"owner": "Victim’s ownerId",
"device_type":

"SMART.TAPOBULB",

"device_model":

"L530E Series",

"ip": "Attacker’s IP",
"mac": "Attacker’s MAC",
"factory_default": false,
"is_support_iot_cloud": true,
"mgt_encrypt_schm": {

"is_support_https": false,
"encrypt_type": "AES",
"http_port": 80

}

},
"error_code": 0

}

Listing 1. JSON attack scenario 2

After receiving the response,

the Tapo app thinks that
it has successfully completed the Bulb Discovery phase by
locating its own device within the network. Therefore, it starts
the TSKEP protocol with the attacking device. Because of
vulnerability 1, the TSKEP protocol does not give the Tapo
app any evidence about the identity of the interlocutor. For
this reason, the Tapo app assumes that the newly received key
is shared with an associated device, while it is shared with the
attacker instead. Hence, the adversary is able to decrypt the
Login message of the TSKEP protocol and get the password
and the hash of the email of the victim’s Tapo account.

The attack can be summarised as follows:

• The attacker gets the Bulb Discovery shared key and
creates fake bulb discovery response messages. Therefore,
the authentication of the bulb discovery response message
fails.

• The Tapo app executes the TSKEP protocol with the at-
tacker instead of the smart bulb. Therefore, authentication
of the smart bulb with the Tapo app fails. This results in
an integrity loss.

• The Tapo app shares the key with the attacker, hence the
distribution of the session key fails. This results in an
availability loss.

• The attacker can violate the confidentiality of the mes-
sages and get the password and the hash of the email of

C. Attack scenario 3 - MITM attack with a configured Tapo
L530E

In this experiment we exploited:
• Vulnerability 1, with the goal of getting the ability to

authenticate as the Tapo L530E to the Tapo app.

The context in which we conduct the experiment is Setup
B described in Section III-B. The attacker makes independent
connections with the victims and relays messages between
them to make them believe they are talking directly to each
other over a private connection. When the Tapo app starts the
TSKEP with the smart bulb, the attacker intercepts the RSA
key transmission message and blocks its reception from the
smart bulb. In parallel, he starts a new session with the smart
bulb from which he gets a new session key. The session key
received by the attacker from the smart bulb is then encrypted
with the previously received RSA public key and sent to the
Tapo app. Due to vulnerability 1, the Tapo app expects to
share the received key only with the smart bulb, but it is
sharing it with the adversary instead. Hence, the attacker now
has the key that Tapo app and smart bulb use to encrypt all
subsequent communication messages. Therefore, he is capable
of deciphering them and violating their confidentiality and
integrity, for example by decrypting the messages, modifying
their contents, re-encrypting and then forwarding them. This
is summarised in the attack diagram shown in Fig. 8.

Fig. 8. Sequence chart for the attacker’s MITM between app and bulb

Hence, the attack consists of the following steps:

• The Tapo app executes the protocol with the attacker
instead of the smart bulb, therefore, the authentication
process fails.

• The Tapo app shares the key with the attacker and not
with the smart bulb, hence, the distribution of the session
key fails.

• The attacker authenticates the key shared with the smart
bulb thanks to the credentials received from the Tapo
app, therefore, the authentication of the Tapo app with
the smart bulb fails.

• The attacker relays messages between the two sessions to
make Tapo app and smart bulb believe they are talking
to each other, hence, the confidentiality and the integrity
of messages is lost.

D. Attack scenario 4 - Replay attack with the Smart bulb as
victim

In this experiment we exploited:
• Vulnerability 4, with the goal of getting the ability to

replay both old and replicated messages.

The context in which we conduct the experiment is Setup B
described in Section III-B. This attack scenario is divided into
three phases. Specifically, in this case, it is also necessary that
the attacker has a line of sight on the bulb to complete the
attack.

During the first phase, Wireshark is used to sniff the traffic
of a Bulb-App communication. During this communication, the
app sends to the smart bulb both get messages, to request the
value of some status parameters, and set messages, to request
the smart bulb to change the value of some of its internal
parameters. During the experiment, we are not aware of the
symmetric key used by both the smart bulb and the Tapo app
to encrypt the messages.

During the second phase of the experiment, we replicate all
messages we previously captured. Hence, for each message
we determine whether it was a get or set message simply by
observing how the bulb behaves after each message. For every
set message, we take note of the change that it caused on the
light bulb.

During the third phase, we arbitrarily replicate the set
messages to the smart bulb, managing to make changes to
its internal state, without having a Tapo account associated
with it. Messages continue to be accepted by the smart bulb
until the session key with which they are encrypted expires.

E. Attack scenario 5 - MITM attack with an unconfigured Tapo
L530E

In this experiment we exploited:
• Vulnerability 1, with the goal of getting the ability to

authenticate as the Tapo L530E to the Tapo app.

The context in which we conduct the experiment is Setup
C described in Section III-C. This attack scenario exploits the
fact that not only the Tapo app, but anyone (including the
attacker), can connect to the Wi-Fi network started by the
smart bulb during the setup phase. It is important that the
attacking device acts as a bridge between the two networks.
The attacker must flow all bulb discovery request messages
from the network it controls to the smart bulb network, and
vice versa for bulb discovery response messages. Otherwise,

the Tapo app would not be able to detect the smart bulb
and therefore would never try to start the TSKEP with it.
Subsequently, vulnerability 1 is exploited in the same way
shown in Section Attack Scenario VII-C, so the adversary is
able to violate the confidentiality of the session key between
the smart bulb and the Tapo app.

At some point in the communication, the Tapo app sends

the JSON shown in Listing 2:

{

"method":"set_qs_info",
"params":{

"account"{

"password":"Tapo password",
"username":"Tapo email"

},
"extra_info":{"specs":"EU"},
"time":{"region":"Europe/Rome","

time_diff":60,"timestamp":1660032435
},

"wireless":{

"key_type":"wpa2_psk",
"password":"Wi-Fi password",
"ssid":"ssid Wi-Fi"}

},
"requestTimeMils":1660032438365,
"terminalUUID":"..."}’

Listing 2. JSON attack scenario 5

Because usernames, Tapo passwords, SSIDs, and Wi-Fi
passwords are sent in base64 encoding, the attacker is able
to decode and steal them.

VIII. FIXING

This Section outlines possible mitigations for the identified
vulnerabilities, marking the last step of the PETIoT kill
chain. Most measures consist of simple modifications to the
relevant protocols, in particular to strengthen the cryptographic
measures. These can be implemented via software updates to
be pushed to the affected devices via Internet, so we believe
these fixes to be easily deployable with the already existing
update procedures

a) Fix for Vulnerability 1.: This vulnerability is the most
complex and dangerous. It is not easy to find a simple fix to it
because the protocol should be widely revised. Our proposed
fix requires the smart bulb to sign the message of AES key
transmission with an asymmetric, private key. The validity of
that key as to belong to the bulb could be verified by the
app via a digital certificate to retrieve from the Cloud Server
during the association of the bulb with the app. Of course,
such a certificate should chain up to a root certificate to be
securely stored with the app. All this would allow the app to
get evidence about the authenticity of the response, i.e., that
the response really comes from the smart bulb. In consequence,
the app will eventually store all certificates of the associated
devices.

b) Fix for Vulnerability 2.: One possible solution to fix
this vulnerability is the active presence of the cloud server.
This entity should periodically assign each Tapo account a
fresh key to use when calculating the checksum within Bulb
Discovery messages. The key assigned to a Tapo account
should then be communicated to all devices associated with
it. The benefits of the fix can be summarized as follows:

• The key is not hard-coded, so the attacker would no
longer be able to get it by decompiling the Tapo app
or the firmware of a Tapo device.

• Each account has its own key, therefore, compromising a
Tapo account, or a key, would not result in compromising
the keys of other Tapo accounts.

• The key should be long and random enough by current
standards so that brute-force attacks would not be prof-
itable anymore.

• The key is always fresh, so even if an attacker were to
get the key of a Tapo account, the latter would not be
compromised forever, but only until the validity of the
stolen key expires and the cloud server assigns a new
key to it.

It would also be useful to use a collision-resistant crypto-
graphic hash function for the checksum. Examples of cryp-
tographic hash functions are SHA-224 or SHA3-224.

c) Fix for Vulnerability 3.: This vulnerability can be
fixed by making the IV dynamic, i.e., using different IVs to
encrypt different messages. This should be done by both the
Tapo app and the Tapo L530E. The IV used to encrypt the
JSON contained in the params field could then be included
as a field in the plain part of JSON contained in Bulb-App
communications.

d) Fix for Vulnerability 4.: The timestamp containing
the message creation moment included in JSON should be
verified by smart bulb and the Tapo app. Checking the creation
timestamp would prevent recent messages from being passed
off as fresh by an attacker. In addition, the various messages
exchanged should contain a sequence number, which would
prevent duplicate messages.

IX. CONCLUSIONS

We identified four vulnerabilities in the Tapo L530E, which
we were able to practically exploit in five different attack
scenarios with varying impacts on the users’ security, privacy
and safety. Of the four vulnerabilities, two are of High severity
and two are of Medium severity, according to their CVSS
score.

Overall, we observe that the experiment setup had to be
designed with care due to the three scenarios that were
possible. Following that, the information gathering step was
rather large and complicated, much more than it could be
reported in this paper due to space constraints. The vulner-
ability assessment was very surprising. For example, while
deauthentication is routinely possible, we were not prepared
to discover passwords in the clear and weak cryptography.
Exploiting the vulnerabilities was moderately challenging but
devising appropriate fixes was harder.

One way to interpret such findings could be that “small” IoT
devices may have raised insufficient cybersecurity attention
thus far, i.e., insufficient cybersecurity measures due to a pre-
conception that they may not be worth hacking or exploiting.
Our work pins down this preconception as wrong, at least
because the scope of our attacks expands onto all devices
of the Tapo family a victim may use and, most importantly,
potentially onto the entire victim’s Wi-Fi network, which the
attacker is enabled to penetrate.

While more and more experiments will certainly follow on
similar bulbs and other inexpensive devices, we argue that the
evidence we have gathered thus far is sufficient to call for
a fuller application of a zero trust model to the IoT domain.
With dozens of years of cybersecurity experience accumulated
by the international community thus far, it should be possible
to find affordable ways to achieve that in due course.

REFERENCES

[Alopix, 2023] Alopix (2023). Wifi deauth attack in 2 minutes! https://
systemweakness.com/wifi-deauth-attack-in-2-minutes-d1fb55112305.
[Bella and Biondi, 2019] Bella, G. and Biondi, P. (2019). You overtrust your
In Proc. of the 2nd International Workshop on Safety, securiTy,
printer.
and pRivacy In automotiVe systEms (STRIVE’19), LNCS 11699, pages
264–274. Springer.

[Bella et al., 2023] Bella, G., Biondi, P., Bognanni, S., and Esposito, S.
(2023.). PETIoT: PEnetration Testing the Internet of Things. Elsevier
Internet of Things, 22.

[Biondi et al., 2020] Biondi, P., Bognanni, S., and Bella, G. (2020). VoIP
the 5th International
Can Still Be Exploited — Badly.
Conference on Fog and Mobile Edge Computing, (FMEC’20), pages 237–
243. IEEE.

In Proc. of

[Dalvi et al., 2018] Dalvi, A., Maddala, S., and Suvarna, D. (2018). Threat
modelling of smart light bulb. In 2018 Fourth International Conference
on Computing Communication Control and Automation (ICCUBEA), pages
1–4.

[d’Otreppe de Bouvette, 2023] d’Otreppe de Bouvette, T. (2023). Aircrack-

ng. https://www.aircrack-ng.org/.

[Ettercap, 2023] Ettercap (2023). Ettercap project. https://www.ettercap-

project.org/.

[Howarth, 2023] Howarth, J. (2023). 80+ amazing iot statistics (2023-2030).

https://explodingtopics.com/blog/iot-stats.

[Kristiyanto and Ernastuti, 2020] Kristiyanto, Y. and Ernastuti, E. (2020).
Analysis of deauthentication attack on ieee 802.11 connectivity based on
iot technology using external penetration test. CommIT (Communication
and Information Technology) Journal, 14(1):45–51.

[MITRE, 2006a] MITRE (2006a). Cwe-287: Improper authentication. https:

//cwe.mitre.org/data/definitions/287.html.

[MITRE, 2006b] MITRE (2006b). Cwe-341: Predictable from observable

state. https://cwe.mitre.org/data/definitions/341.html.

[MITRE, 2008] MITRE (2008). Cwe-693: Protection mechanism failure.

https://cwe.mitre.org/data/definitions/693.html.

[MITRE, 2020] MITRE (2020). Cwe-1240: Use of a cryptographic prim-
itive with a risky implementation. https://cwe.mitre.org/data/definitions/
1240.html.

[Nath and Nath, 2022] Nath, R. and Nath, H. V. (2022). Critical analysis
of the layered and systematic approaches for understanding iot security
threats and challenges. Computers and Electrical Engineering.

[Schepers et al., 2022] Schepers, D., Ranganathan, A., and Vanhoef, M.
(2022). On the robustness of wi-fi deauthentication countermeasures. In
Proceedings of the 15th ACM Conference on Security and Privacy in
Wireless and Mobile Networks, WiSec ’22, page 245–256, New York, NY,
USA. Association for Computing Machinery.

[Wireshark, 2023] Wireshark (2023).

Wireshark project.

https://

www.wireshark.org/.



=== Content from arxiv.org_2d8712f5_20250114_181129.html ===

[Skip to main content](#content)

[![Cornell University](/static/browse/0.3.4/images/icons/cu/cornell-reduced-white-SMALL.svg)](https://www.cornell.edu/)
We gratefully acknowledge support from the Simons Foundation, [member institutions](https://info.arxiv.org/about/ourmembers.html), and all contributors.
[Donate](https://info.arxiv.org/about/donate.html)

[![arxiv logo](/static/browse/0.3.4/images/arxiv-logo-one-color-white.svg)](/) > [cs](/list/cs/recent) > arXiv:2308.09019

[Help](https://info.arxiv.org/help) | [Advanced Search](https://arxiv.org/search/advanced)

All fields
Title
Author
Abstract
Comments
Journal reference
ACM classification
MSC classification
Report number
arXiv identifier
DOI
ORCID
arXiv author ID
Help pages
Full text

Search

[![arXiv logo](/static/browse/0.3.4/images/arxiv-logomark-small-white.svg)](https://arxiv.org/)
[![Cornell University Logo](/static/browse/0.3.4/images/icons/cu/cornell-reduced-white-SMALL.svg)](https://www.cornell.edu/)
open search

GO

open navigation menu
## quick links

* [Login](https://arxiv.org/login)
* [Help Pages](https://info.arxiv.org/help)
* [About](https://info.arxiv.org/about)

# Computer Science > Cryptography and Security

**arXiv:2308.09019** (cs)

[Submitted on 17 Aug 2023]
# Title:Smart Bulbs can be Hacked to Hack into your Household

Authors:[Davide Bonaventura](https://arxiv.org/search/cs?searchtype=author&query=Bonaventura,+D), [Sergio Esposito](https://arxiv.org/search/cs?searchtype=author&query=Esposito,+S), [Giampaolo Bella](https://arxiv.org/search/cs?searchtype=author&query=Bella,+G) View a PDF of the paper titled Smart Bulbs can be Hacked to Hack into your Household, by Davide Bonaventura and 1 other authors
[View PDF](/pdf/2308.09019)
> Abstract:The IoT is getting more and more pervasive. Even the simplest devices, such as a light bulb or an electrical plug, are made "smart" and controllable by our smartphone. This paper describes the findings obtained by applying the PETIoT kill chain to conduct a Vulnerability Assessment and Penetration Testing session on a smart bulb, the Tapo L530E by Tp-Link, currently best seller on Amazon Italy. We found that four vulnerabilities affect the bulb, two of High severity and two of Medium severity according to the CVSS v3.1 scoring system. In short, authentication is not well accounted for and confidentiality is insufficiently achieved by the implemented cryptographic measures. In consequence, an attacker who is nearby the bulb can operate at will not just the bulb but all devices of the Tapo family that the user may have on her Tapo account. Moreover, the attacker can learn the victim's Wi-Fi password, thereby escalating his malicious potential considerably. The paper terminates with an outline of possible fixes.

| Subjects: | Cryptography and Security (cs.CR) |
| --- | --- |
| Cite as: | [arXiv:2308.09019](https://arxiv.org/abs/2308.09019) [cs.CR] |
|  | (or  [arXiv:2308.09019v1](https://arxiv.org/abs/2308.09019v1) [cs.CR] for this version) |
|  | <https://doi.org/10.48550/arXiv.2308.09019>  Focus to learn more    arXiv-issued DOI via DataCite |
| Journal reference: | In Proceedings of the 20th International Conference on Security and Cryptography (2023), ISBN 978-989-758-666-8, ISSN 2184-7711, pages 218-229 |
| Related DOI: | <https://doi.org/10.5220/0012092900003555>  Focus to learn more   DOI(s) linking to related resources |

## Submission history

From: Davide Bonaventura [[view email](/show-email/7608b7e9/2308.09019)]
 **[v1]**
Thu, 17 Aug 2023 14:48:04 UTC (990 KB)

Full-text links:
## Access Paper:

View a PDF of the paper titled Smart Bulbs can be Hacked to Hack into your Household, by Davide Bonaventura and 1 other authors* [View PDF](/pdf/2308.09019)
* [TeX Source](/src/2308.09019)
* [Other Formats](/format/2308.09019)

[view license](http://arxiv.org/licenses/nonexclusive-distrib/1.0/ "Rights to this article")

Current browse context: cs.CR
[< prev](/prevnext?id=2308.09019&function=prev&context=cs.CR "previous in cs.CR (accesskey p)")

  |
[next >](/prevnext?id=2308.09019&function=next&context=cs.CR "next in cs.CR (accesskey n)")

[new](/list/cs.CR/new)
 |
[recent](/list/cs.CR/recent)
 | [2023-08](/list/cs.CR/2023-08)
Change to browse by:
[cs](/abs/2308.09019?context=cs)

### References & Citations

* [NASA ADS](https://ui.adsabs.harvard.edu/abs/arXiv%3A2308.09019)
* [Google Scholar](https://scholar.google.com/scholar_lookup?arxiv_id=2308.09019)
* [Semantic Scholar](https://api.semanticscholar.org/arXiv%3A2308.09019)

[a](/static/browse/0.3.4/css/cite.css)
export BibTeX citation
Loading...

## BibTeX formatted citation

×

loading...

Data provided by:

### Bookmark

[![BibSonomy logo](/static/browse/0.3.4/images/icons/social/bibsonomy.png)](http://www.bibsonomy.org/BibtexHandler?requTask=upload&url=https://arxiv.org/abs/2308.09019&description=Smart Bulbs can be Hacked to Hack into your Household "Bookmark on BibSonomy")
[![Reddit logo](/static/browse/0.3.4/images/icons/social/reddit.png)](https://reddit.com/submit?url=https://arxiv.org/abs/2308.09019&title=Smart Bulbs can be Hacked to Hack into your Household "Bookmark on Reddit")

Bibliographic Tools
# Bibliographic and Citation Tools

Bibliographic Explorer Toggle

Bibliographic Explorer *([What is the Explorer?](https://info.arxiv.org/labs/showcase.html#arxiv-bibliographic-explorer))*

Connected Papers Toggle

Connected Papers *([What is Connected Papers?](https://www.connectedpapers.com/about))*

Litmaps Toggle

Litmaps *([What is Litmaps?](https://www.litmaps.co/))*

scite.ai Toggle

scite Smart Citations *([What are Smart Citations?](https://www.scite.ai/))*

Code, Data, Media
# Code, Data and Media Associated with this Article

alphaXiv Toggle

alphaXiv *([What is alphaXiv?](https://alphaxiv.org/))*

Links to Code Toggle

CatalyzeX Code Finder for Papers *([What is CatalyzeX?](https://www.catalyzex.com))*

DagsHub Toggle

DagsHub *([What is DagsHub?](https://dagshub.com/))*

GotitPub Toggle

Gotit.pub *([What is GotitPub?](http://gotit.pub/faq))*

Huggingface Toggle

Hugging Face *([What is Huggingface?](https://huggingface.co/huggingface))*

Links to Code Toggle

Papers with Code *([What is Papers with Code?](https://paperswithcode.com/))*

ScienceCast Toggle

ScienceCast *([What is ScienceCast?](https://sciencecast.org/welcome))*

Demos
# Demos

Replicate Toggle

Replicate *([What is Replicate?](https://replicate.com/docs/arxiv/about))*

Spaces Toggle

Hugging Face Spaces *([What is Spaces?](https://huggingface.co/docs/hub/spaces))*

Spaces Toggle

TXYZ.AI *([What is TXYZ.AI?](https://txyz.ai))*

Related Papers
# Recommenders and Search Tools

Link to Influence Flower

Influence Flower *([What are Influence Flowers?](https://influencemap.cmlab.dev/))*

Core recommender toggle

CORE Recommender *([What is CORE?](https://core.ac.uk/services/recommender))*

* Author
* Venue
* Institution
* Topic

About arXivLabs

# arXivLabs: experimental projects with community collaborators

arXivLabs is a framework that allows collaborators to develop and share new arXiv features directly on our website.

Both individuals and organizations that work with arXivLabs have embraced and accepted our values of openness, community, excellence, and user data privacy. arXiv is committed to these values and only works with partners that adhere to them.

Have an idea for a project that will add value for arXiv's community? [**Learn more about arXivLabs**](https://info.arxiv.org/labs/index.html).

[Which authors of this paper are endorsers?](/auth/show-endorsers/2308.09019) |
Disable MathJax ([What is MathJax?](https://info.arxiv.org/help/mathjax.html))

* [About](https://info.arxiv.org/about)
* [Help](https://info.arxiv.org/help)

* contact arXivClick here to contact arXiv
   [Contact](https://info.arxiv.org/help/contact.html)
* subscribe to arXiv mailingsClick here to subscribe
   [Subscribe](https://info.arxiv.org/help/subscribe)

* [Copyright](https://info.arxiv.org/help/license/index.html)
* [Privacy Policy](https://info.arxiv.org/help/policies/privacy_policy.html)

* [Web Accessibility Assistance](https://info.arxiv.org/help/web_accessibility.html)
* [arXiv Operational Status](https://status.arxiv.org)

  Get status notifications via
  [email](https://subscribe.sorryapp.com/24846f03/email/new)
  or [slack](https://subscribe.sorryapp.com/24846f03/slack/new)



=== Content from www.scitepress.org_92e42e1f_20250114_181137.html ===
SmartBulbsCanBeHackedtoHackintoYourHouseholdDavideBonaventura1a,SergioEsposito2bandGiampaoloBella1c1DipartimentodiMatematicaeInformatica,Universit`adiCatania,Catania,Italy2InformationSecurityGroup,RoyalHolloway,UniversityofLondon,Egham,U.K.Keywords:IoT,SmartHomes,SmartDevices,SmartBulb,PenetrationTest,VulnerabilityAssessment.Abstract:TheIoTisgettingmoreandmorepervasive.Eventhesimplestdevices,suchasalightbulboranelectricalplug,aremade“smart”andcontrollablebyoursmartphone.ThispaperdescribesthefindingsobtainedbyapplyingthePETIoTkillchaintoconductaVulnerabilityAssessmentandPenetrationTestingsessiononasmartbulb,theTapoL530EbyTp-Link,currentlybestselleronAmazonItaly.Wefoundthatfourvulnera-bilitiesaffectthebulb,twoofHighseverityandtwoofMediumseverityaccordingtotheCVSSv3.1scoringsystem.Inshort,authenticationisnotwellaccountedforandconfidentialityisinsufficientlyachievedbytheimplementedcryptographicmeasures.Inconsequence,anattackerwhoisnearbythebulbcanoperateatwillnotjustthebulbbutalldevicesoftheTapofamilythattheusermayhaveonherTapoaccount.Moreover,theattackercanlearnthevictim’sWi-Fipassword,therebyescalatinghismaliciouspotentialconsiderably.Thepaperterminateswithanoutlineofpossiblefixes.1INTRODUCTIONTheInternetofThings(IoT)surroundspeoplevirtu-allyeverywhereduetotheincreasingnumberofde-vicesthatbecomecomputerisedandinterconnected—itmayevenpervadepeople’sbodiesthankstotheriseofimplantablemedicaldevicesandwearabledevices.IoTdevicesexceeded13.8billionin2021andareexpectedtodoubleby2025(Howarth,2023).Thisworldofdevicesleadstoamassiveattacksur-facewithasignificantincreaseinthenumberofen-trypointsforhackersand,correspondingly,securityandprivacychallengesforresearchersandengineerstoface.WhilethefullrangeandinherentdiversityofIoTdevicescannotbeoverestimated,safetycriticalde-vices,suchasself-drivingcars,IndustrialControlSystems(ICS)andtheirsecurityandprivacychal-lenges,riskdrawingtoomuchattentiontothedetri-mentofinexpensivedevices,suchasthoseforhomeautomation.Itmustbestressedthatanyhomeau-tomationissuewouldbehighlyimpactfulduetotheenormoususeofsuchdevicesworldwide,whichisalsofavouredbyageneralpricedecrease.Weobservethatsimilarconsiderationsapplytoahttps://orcid.org/0009-0004-4463-7991bhttps://orcid.org/0000-0001-9904-9821chttps://orcid.org/0000-0002-7615-8643smartbulbs,whosehijackingmayhavesecurityim-plications,e.g.,helpathiefabusethevictim’selec-tricityconsumption,thenprivacyimplications,e.g.,helpthethiefprofilethevictim’spatternsofusagehencetheirhabitsand,ultimately,safetyimplications,e.g.,ultimatelyhelpthethiefunderstandifahouse-holdiscurrentlyemptyornot.Followingtheseob-servations,thispaperrestsonthefollowingresearchquestion:Whatvulnerabilitiesaffectbest-sellerlightbulbs?Whatconsequencesdotheyhaveontheenduser’ssecurity,privacyandsafety?1.1ContributionsOurexperimentsapplythe(stepsofthe)PETIoTkillchain(Bellaetal.,2023)toconductaVulnerabilityAssessmentandPenetrationTesting(VAPT)ontheTp-LinkTapoSmartWi-FiLightBulb,Multicolor(L530E),currentlybest-selleronAmazonItaly,Fig-ure1.TheTapoL530Eisacloud-enabledmulticolorSmartBulbthatcanbecontrolledthroughtheTapoproprietaryapplication.TheuserneedstoinstallitonanAndroidoriOSmobiledeviceandthencre-ateaTapoaccount.ThesmartbulbusesWi-Fitech-nologyforconnectivity.So,unlikemanyothersmartbulbsrequiringadedicatedhub,theusercanenjoytheL530EasisbysimplyconnectingittotheirhomeWi-Finetwork.218Bonaventura,D.,Esposito,S.andBella,G.SmartBulbsCanBeHackedtoHackintoYourHousehold.DOI:10.5220/0012092900003555InProceedingsofthe20thInternationalConferenceonSecurityandCryptography(SECRYPT2023),pages218-229ISBN:978-989-758-666-8;ISSN:2184-7711Copyrightc(cid:13)2023bySCITEPRESS–ScienceandTechnologyPublications,Lda.UnderCClicense(CCBY-NC-ND4.0)Figure1:TheTapoL530EonAmazon.it.Contrarilytoapotentialbeliefthatsmartbulbsarenotworthprotectingorhacking,wefoundoutthatthismodelsuffersfourvulnerabilitiesthatarenottriv-ialand,mostimportantly,mayhaveadramaticim-pact:1.Vulnerability1.LackofauthenticationofthesmartbulbwiththeTapoapp,8.8CVSSscore,Highseverity.Theappdoesnotgetanyguaranteeabouttheidentityofitspeer.Therefore,anyonecanauthenticatetotheappandpretendtobethesmartbulb.2.Vulnerability2.Hard-coded,shortsharedsecret,7.6CVSSscore,Highseverity.ThesecretusedbyboththeTapoappandthesmartbulbisshortandexposedbyboththecodefragmentsrunbytheappandbythesmartbulb.3.Vulnerability3.Lackofrandomnessduringsymmetricencryption,4.6CVSSscore,Mediumseverity.Theinitialisationvectors(IVs)usedbytheTapoappandthesmartbulbarestatic,andeachcommunicationsessionusesasingle,fixedIVforeachmessage.4.Vulnerability4.Insufficientmessagefreshness,5.7CVSSscore,Mediumseverity.Neithertheappnorthesmartbulbimplementsappropriatemeasurestocheckthefreshnessofmessagesthattheyreceive.Ourexploitationexperimentsofsuchvulnerabilitiesdemonstratethatamaliciousattackerwhostandsinproximityofthetargetsmartbulb,henceoftheWi-Fiaccesspointtowhichthebulbismeanttobecon-nected,canexploitthebulbinvariousways.Vul-nerability1meansthattheattackerimpersonatesthebulbandreceivestheuser’sTapocredentialsaswellastheuser’sWi-FicredentialsfromtheTapoapp.Toachievethis,thebulbmustbeinsetupmode,whenitexposesitsownSSID.Alternatively,ifthebulbisalreadyconfiguredandworking,thentheat-tackermountsasimpleWi-Fideauthenticationattackagainstthebulbandrepeatsituntiltheuserattemptstosetupthebulbagaintorestoreit.Theattackermayalsointerleaveanothersession:byleveragingthecredentialsjustobtained,heimper-sonatestheuserthroughthesetupofthebulbandre-ceivesasessionkeyfromthedevice,whichhemaythenrelaybacktotheuser.Therefore,theattackeref-fectivelymountsaman-in-the-middleattack.More-over,duringdevicesetup,theTapoappalsoreleasestheWi-Ficredentialstotheattacker,therebycausingaclearescalationofthemaliciouspotentialforotherattacksrequiringlocalaccess.Vulnerability2meansthattheattackercanobtainthekeythattheTapoappandthesmartbulbshareandusefortheauthenticationandtheintegrityofthemes-sagesexchangedduringtheinitialdiscoveryphase,describedinSection5.1.Thankstotheknowledgeofthekey,theattackercanviolatetheintegrityandauthenticationofthemessagesofthisphase.Vulnerability3meansthattheattackerunder-standstheconsequencesofcertainencryptedmes-sagesonthetargetdevicedespitethefactthathedoesnotunderstandtheprecisecleartextinsideeachmes-sage.Therefore,theattackermayattempttore-usethosemessagesatwilltooperatethedeviceaseachmessagedetermines.Incombinationwithvulnerabil-ity4,theattackerisassuredthatwhatevermessagehereplayswillbeacceptedbythebulb,henceaDenial-of-Service(DoS)attackbecomespossible.1.2EthicsandResponsibleDisclosureAllexperimentsperformedonTapoL530Eonlyin-volvedevices,Wi-Finetworks,accounts,emails,andpasswordsownedsolelybytheauthorsofthiswork.Duringtheexperiments,nousernorthird-partydatawereaccessed.WedutifullycontactedTp-LinkviatheirVulner-abilityResearchProgram(VRP),reportingallfourvulnerabilitieswefound.Theyacknowledgedallofthemandinformedusthattheystartedworkingonfixesbothattheappandatthebulbfirmwarelevels,planningtoreleasetheminduecourse.1.3PaperSummaryThispapercontinueswithashortaccountofthere-latedwork(§2).Itthenunfoldsthesixphasesofthechosenmethodology,i.e.,thePETIoTkillchain,onSmartBulbsCanBeHackedtoHackintoYourHousehold219thechosentarget,i.e.,theTapoL530E(§3through§8).Finally,itdrawstherelevantconclusions(§9).2RELATEDWORKThesecurityandprivacyaspectsofIoTdevicesarebecomingmoreandmoreimportantand,correspond-ingly,therelatedworkconcerningsuchdevicesisverywide.Duetospaceconstraints,thissectionisreducedtotheliteratureentriesthataremostrelevanttothecoreofthispaper.In2021,itwasshownthatprintersarecommondeviceswhosenetworkedusemaysufferatleastthreeattacks(BellaandBiondi,2019).Thefirstattack,zombiesfortraditionalDDoS,showshowsomeprint-ersmaysufferfromvulnerabilitiesthatwouldtrans-formthemintoexploitablezombies.Thesecondat-tack,paperDoS,showshowalargenumberofprint-ersarefoundtohonourunauthenticatedprintingre-quests.Thethirdattack,privacyinfringement,showshowthesedevicesbeararemarkableriskofdatabreach.Later,thesameauthorscontributedtosim-ilarexperimentsagainstVoIPphones(Biondietal.,2020).Ourworkfollowsasimilarmethodology.In2022,aliteraturesurveyforunderstandingIoTsecuritythreatsandchallengesappeared(NathandNath,2022).Itisdividedintothreeparts.Thefirstpartcontainsananalysisofthemainthreatsandat-tacks,alsoanalysingtheIoTecosystemfromfourper-spectives:devices,internalnetworkservices,externalnetworkservicesandusers.ThesecondpartcontainsastudyonrecentIoTmalwareattacks.Finally,thegeneralsecurityrequirementsandchallengestoad-dressthedevisedattackcategoriesarediscussed.Thisworkwasinspirationalforourexperiments.PETIoTisarecentcyberKillChain(KC)specifi-callydevelopedtoguideVAPTsessionsoverIoTde-vices(Bellaetal.,2023)withafocusondetectingtheirnetworkvulnerabilities.TheKCisdemonstratedontheTapoC200IPcamerabyTp-Link,enablingthediscoveryofthreeseverevulnerabilities:Improperneutralisationofinboundpackets;Insufficiententropyinencryptednotifications;Cleartexttransmissionofvideostream.Eachofthevulnerabilitiesfoundisex-ploitedthroughdifferentattackscenarios,andappro-priateremediationmeasuresareillustratedaspossiblefixes.WefollowedPETIoTstrictlythroughourwork,ascanbeseenbythestepsdiscussedbelow.In2018,apenetrationtestingsessionontheTrad-frismartbulbproducedbyIKEAwasreported(Dalvietal.,2018).Thearticledescribesfourdifferentat-tacks.HackingSmartLightBulbviaBluetoothal-lowstheattackertocontrolthebulb.IKEATradfriGatewayExploitallowstheattackertocompromisetheZigBeeTradfrigatewaybymanagingtobreakthefirmwareupdate.DenialofServiceAttackallowstheattackertoperformaDoSattackagainstthegatewaybyfloodingitwithUDPpackets.IdentitySpoofingal-lowstheattackertoimpersonatetheCoAPclientandcontrolthesmartbulbs.ThisworkiscloselyrelatedtooursbutrevolvesaroundtheZigBeeprotocolanddoesnotachieveescalationtolocalWi-Fiaccess.3EXPERIMENTSETUPWebegindefiningtheexperimentsetup,accordinglywiththePETIoTkillchain.Oursetupisnon-invasive,asthesmartbulbisnottamperedwith.Itincludes:•AWi-Fiswitchtoprovidelocalconnectivity.•ASmartbulbTaposeriesL530withHardwareVersion1.0.0andFirmwareVersion1.1.9.•ASamsungsmartphonerunningAndroid11andtheTapoappVersion2.8.14.•AnUbuntu22.04machinewith5.15.0-47kerneltorunallsoftwareneededfortheexperiments.Tobeabletouseallthebulbfeatures,itisnecessarytocreateaTapoaccountandloginintoit.DependingonwhetherthesmartbulbisalreadyassociatedwithaTapoaccountornot,andthenetworkconfigurationused,weidentifythreedifferentsetups.Inallthreesetups,thesmartphonehasaccesstotheTapoaccounttowhichthesmartbulbisassociated,ortowhichtheuserwantstoassociateit.3.1SetupAThecontextoftheSetupAisasfollows.•TheuserhaspreviouslyassociatedhersmartbulbwiththeTapoapponherphone.Duringtheasso-ciationprocess,theuserconnectsthesmartbulbtoacertainnetworkX.•TheUbuntudeviceandtheuser’sphonearebothconnectedtothesamenetworkYasshowninFig-ure2—thisisnotnecessarilythenetworkXtowhichtheTapoL530Eisconnected.ThissetupdoesnotrequiretheUbuntudevicetohaveaccesstothenetworktowhichthesmartbulbisconnected,butonlytobeconnectedtothesamenetworkastheTapoapp.Therefore,theusercould,forexample,connecttoapublicnetworktoturnoffalightthatmayhavebeenmistakenlyleftonathome.SECRYPT2023-20thInternationalConferenceonSecurityandCryptography220Figure2:SetupA,networkwithoutalocalsmartbulb.3.2SetupBThecontextoftheSetupBisasfollows.•TheuserhaspreviouslyassociatedhersmartbulbwiththeTapoapponherphone.Duringtheasso-ciationprocess,theuserconnectsthesmartbulbtoacertainnetworkX.•TheUbuntudeviceandtheuser’sphonearebothconnectedtothesamenetworkXtowhichthesmartbulbisconnected,asshowninFigure3.•TheUbuntudevicehascompletecontrolofthenetworkX.ItisabletocarryoutanARPspoof-ingattack,i.e.,tointerceptdataframes,modifythenetworktrafficorpreventitfromreachingitsintendedrecipient.Figure3:SetupB,networkwithaconfiguredsmartbulb.Thissetuprequirestheactivepresenceofthesmartbulb.Inaddition,thesetuprequirestheUbuntudevicetohaveaccesstothenetworktowhichthesmartbulbisconnected,typicallythevictim’slocalnetwork.Therefore,alldevicesusedareconnectedviaWi-Fitothesameaccesspoint.3.3SetupCThecontextoftheSetupCisasfollows.•TheuserwantstoassociatethenewlyresetornotyetconfiguredsmartbulbwithherTapoaccount.•TheTapoapp(hence,theuser)believestobecon-nectedtothenetworkXcreatedbythesmartbulb,butitisactuallyconnectedtoanetworkYcon-trolledbytheUbuntudevice.•TheUbuntudeviceisconnectedbothtothenet-workcreatedbythesmartbulbandtothenetworkcontrolledbyitself.Thissetupoccurswhenthesmartbulbhasbeenre-setorhasnotbeenconfiguredyet.AsdetailedinSec-tion5.3.1,thesmartbulbstartsapublicaccesspointtowhichtheusermustconnecttocompletethesetup.ThenetworkconfigurationisshowninFigure4.Figure4:SetupC,networkwithanon-configuredbulb.TheWi-Fideauthenticationattackallowstheat-tackertoeasilygetSetupC.AWi-Fideauthenticationattackisatypeofdenial-of-serviceattackthattargetscommunicationsbetweenadeviceandaWi-Fiwire-lessaccesspoint(KristiyantoandErnastuti,2020).Thankstothisattack,theattackercandeauthenticatethesmartbulbfromthenetworktowhichitiscon-nected,forcingtheusertorepeatitssetupprocess.TheWi-Fideauthenticationattackrequirestheaccesspointandconnecteddevicesnottouse802.11worWPA3.Althoughinliteraturethereareothertheoret-icallyfeasiblemethodstoperformthedeauthentica-tionattackanyway(Schepersetal.,2022),wedidnottestthem.InSetupC,weassumethatthenetworktowhichthesmartbulbisconnectedisanetworkwherethedeauthenticationattackcanbeperformed.OnewaytomountitwouldbetoleverageAircrack-ng(d’OtreppedeBouvette,2023),asdescribedinablog(Alopix,2023).Theattackrequirestheadver-sarytoknowthevictimdevice’sMACaddress,how-ever,itispossibletolistallMACaddressesconnectedtonearbyaccesspointsbysimplylisteningtothetraf-SmartBulbsCanBeHackedtoHackintoYourHousehold221fic,sotheadversaryhasashortandfinitelistofad-dressestotry.Afterthevictimresetsthesmartbulb,itenterssetupmode.InSetupC,theUbuntudeviceneedstheTapoapptoconnecttothenetworkitcontrolsandnottothenetworkstartedbythesmartbulb—hence,theadversaryperformsanotherWi-Fideau-thenticationattacktodeauthenticatethephonerun-ningtheTapoappfromthenetworkstartedbythesmartbulb,arguablyinducingthevictimtore-attempttoconnect,eventuallyusingtheadversary-controllednetworkwiththesameSSID.AsthenetworkstartedbythesmartbulbisanunprotectedWi-Fi4(802.11n)network,inthislattercasethedeauthenticationat-tackwillalwayswork.Intuitively,thissetupassumesthattheUbuntudeviceiscloseenoughtothenetworkstartedbythesmartbulbtoheartheemittedcarrier.4INFORMATIONGATHERINGAfterthesetupwecanproceedtothecollectionofinformation.ThefollowingtoolsareinstalledontheUbuntudevice:•Ettercap(Ettercap,2023),asuiteoftoolstoper-formMITMattacksusedontheUbuntudevicetocontrolthenetwork.•Wireshark(Wireshark,2023),anetworkprotocolanalyser(orpacketsniffer)usedtocaptureandanalysetraffic.Thesmartbulbfirmwaresourcecodeisnotpubliclyavailable.Therefore,theoffensiveactivitiesareper-formedinblack-boxmode.ThankstothemessagescapturedwithWiresharkitispossibletodistinguishbetweenthreedifferenttypesofcommunications.Theydifferaccordingtothesenderandthereceiverofthevariousmessagesbe-longingtothem.Thethreedifferenttypesofcommu-nicationsweidentifiedare:(a)communicationsApp-Cloud,includingallmessagesexchangedbetweentheTapoAppandtheCloudServer;(b)communicationsBulb-App,includingallmessagesexchangedbetweenthesmartbulbandtheTapoApp;(c)communica-tionsCloud-Bulb,includingallmessagesexchangedbetweentheCloudServerandthesmartbulb.WhenthephonerunningtheTapoappisnotconnectedtothesamenetworkasthelightbulb,communicationshappenthroughthecloud,combiningApp-CloudandCloud-Bulbcommunications–otherwise,theytakeplacelocallywithBulb-Appcommunications.Allcommunicationsthroughthecloud,i.e.,App-CloudandCloud-Bulb,areencrypted.TheytakeplacethroughtheuseofasecureTLSchannelthatensuresauthenticity,integrity,andconfidentialityofthemessages,eventhoughtheyaretransmittedovertheInternet.Instead,allBulb-AppcommunicationsareexchangedviaHTTPmessages.TheirpayloadsareencryptedusingtheAES128blockcipherinCBCmode.TheinitialisationvectorandthecryptographickeyusedforthisprotocolareexchangedusingtheTapo“SymmetricKeyExchangeProtocol”(TSKEP),whichisdescribedbelowinSection5.2.Thispro-tocolonlygeneratestrafficoverthelocalWi-Finet-work,notthroughtheInternet.OuroffensiveactivitiesonlytargetBulb-Appcom-munications,andignoretheothers.5TRAFFICANALYSISThankstotheinformationobtainedduringtheprevi-ousphase,itisnowpossibletoanalysethenetworktrafficprofitably.TheAPIexposedbythesmartbulbisverysim-ilartoaRemoteProcedureCall(RPC).TheJSONsentbytheapptothesmartbulbcontainsthenameofthemethodtobeinvokedanditsparameters.Theresponsessentbythesmartbulbtotheappcontainanerrorcoderepresentingtheoutcomeoftheopera-tion(whetheritwassuccessfullyexecutedortheerroroccurred)withanoptionalresult.AllJSONsareex-changedviathepayloadsofHTTPmessages.BeforetheTapoappstartsusingtheAPIexposedbythebulb,itmustperformtwopreliminarysteps:locatethesmartbulbwithinthenetworktowhichitisconnected,andexchangeasymmetrickeywiththesmartbulbtoencryptmessages.Therefore,thecom-municationbetweensmartbulbandTapoappcanbesummarisedinthreemacro-steps:•BulbDiscovery–itallowstheTapoapptolocatethesmartbulbwithinthelocalnetworkandtogetthesmartbulb’scurrentconfiguration.•TapoSymmetricKeyExchangeProtocol–execut-ingtheTSKEPprotocolallowstheTapoappandsmartbulbtoexchangeasymmetrickey.•Smartbulbusage–itconsistsinusingtheactualsmartbulbappprotocol.Thesemacro-stepsaredescribedindetailbelow.5.1BulbDiscoverySmartbulbconfigurationsmaychangeovertime.Forexample,theIPaddressassignedtoitbytheDHCPservermighthavechanged,itmightstartusingadif-ferentencryptionschemeafteranupdate,oritmighthavejustbeenreset.BeforetheTapoappcanstartSECRYPT2023-20thInternationalConferenceonSecurityandCryptography222communicatingwiththesmartbulb,itmustlocatethesmartbulbwithinthelocalnetworkandgetitscur-rentconfiguration.Todothis,theTapoappconnectstotheUDPservicelisteningonthe20002portofthesmartbulb,asrepresentedinFigure5.Figure5:Tapo(local)Devicedicovery.ThepayloadformatofsuchUDPmessagesisrep-resentedinTable1.Itcanbeexplainedasfollows:•Bytesinpositions[0:3]and[6:7]arestatic.Theirvaluesneverchange.•Thedatalengthfieldcontainsthelengthofthedatafield,whichcontainsthedataexchangedbe-tweenTapoappandsmartbulb.Whenthedatafieldisempty(i.e.,whenithaslength0)thebitsofthisfieldareallsetto0.•Thenoncefieldcontainsa4-bytestringrandomlygeneratedbytheTapoapp.ThestringisinsertedinthebulbdiscoveryrequestmessagefromtheTapoappandquotedbythesmartbulbinthebulbdiscoveryresponsemessagefromthesmartbulb.ThisallowstheTapoapptoobtainguaran-teesaboutthefreshnessoftheresponsereceivedfromthesmartbulb.•Logically,thechecksumfieldmustbeexcludedfromthecomputationofthechecksumitself—instead,asecretkeyofthesamelengthisusedinitsplaceforthechecksumcomputation.Thisse-cretkeyishard-codedinboththeTapoappandthesmartbulb,hence,thechecksumactslikeaMessageAuthenticationCode(MAC).Thisfieldallowsthereceivertounderstandthatthemessagearrivesintactasitissent.ThealgorithmusedforthechecksumcalculationistheCyclicRedun-dancyCheck32(CRC-32),achecksumalgorithmthathashesbytesequencesto32bitvalues.•Thedatafieldcontainsdifferentinformationde-pendingonwhetheritisabulbdiscoveryre-questorabulbdiscoveryresponseandwhetherthesmartbulbisconfiguredornot.Table1:FormatofthepayloadofUDPmessages.Octet0123Offset00x020x000x000x014Datalength0x110x008Nonce12Checksum...Data5.2TapoSymmetricKeyExchangeProtocolThisstepusestheRPCAPIexposedbythesmartbulbonport80.AllexchangedmessagesareHTTPmes-sages,soatthetransportlayer,onlytheTCPproto-colisused.TheTSKEP,representedinFigure6,al-lowsTapoappandsmartbulbtoexchangea128-bitAESkeyandanIVtoencryptthepayloadofvariousHTTPmessages.Theprotocolconsistsoffourdiffer-entmessages:1.RSApublickeytransmission2.AESkeytransmission3.Login4.TokentransmissionFigure6:TapoSymmetricKeyExchangeProtocol.Attheendofthisphase,Tapoappandsmartbulbgetashort-termsharedsecrettoencryptallsubse-quenttraffic.Thankstothecredentialstoredduringthesetupphase,forthesmartbulbthesecretisalsoauthenticated.5.3SmartBulbSetupThissectionfocusesonthetwopossibleconfigura-tionsforthesmartbulbandspecifiesthemindepthfollowingourtrafficanalysisefforts.SmartBulbsCanBeHackedtoHackintoYourHousehold2235.3.1SmartBulbTurnedonandnotConfiguredBeforeasmartbulbTapoL530Ecanbeused,itmustbeassociatedwithaTapoaccount.Therearetworea-sonswhyasmartbulbmaynotbeassociatedwithanyaccounts:becauseithasbeenreset,orithasnotbeenconfiguredyet.InthisSection,wediscusstheprocessofassociatingthesmartbulbwithaTapoaccount.AnunconfiguredornewlyresetsmartbulbstartsapublicaccesspointwithSSIDTapoBulbXXXX,whereXXXXarefourdecimalplaces.Thesmartbulbalsoactsasaswitchwithinthenetworkitgenerates.InordertoconfigureitandassociateitwiththeirTapoaccount,theusermustconnecttotheWi-Finetworkstartedbythesmartbulbitself.Afterthat,theTapoapptriestolocatethesmartbulb.Todothis,itstartssendingbulbdiscoveryre-questmessagestobroadcast.Inthiscase,thedatafieldofthesemessagesisempty.Aftertheidentifica-tionofthesmartbulb,theTapoappstartstheTSKEPprotocolwithit.ThevaluessetintheloginmessageasusernameandpasswordarefixedvaluesthattheTapoappuseseverytimeitconfiguresanewdevice.Oncethesymmetrickeyisobtained,TapoappsendstothesmartbulbtheSSIDandthepasswordoftheWi-Finetworktowhichthesmartbulbmustconnect.TheTapoappalsosendsthecredentialsoftheTapoaccounttowhichitmustbeassociated.Thecredentialsarethenstoredbythesmartbulb.Throughthesecredentials,smartbulbisabletoauthenticateallsubsequentrequestsofTapoapp.Atthispoint,thesmartbulbturnsitsaccesspointoffandconnectstothespecifiedWi-Finetwork.Thesmartbulbstartscommunicatingwiththecloudservertocompleteitssetup.Hence,theWi-FinetworktowhichthesmartbulbconnectsmusthaveInternetaccess.5.3.2SmartBulbAlreadyConfiguredLetusnowconsiderthecasewherethesmartbulbisassociatedwithaTapoaccountanditisreadytobeused.Asmentionedbefore,itcanbecontrolledeitherlocallyorremotelyviatheTapocloud.Todoso,theTapoapplicationinitiallytriestolocatethesmartbulbwithinthenetworkwithabulbdiscoveryrequestmes-sage.Ifitdetectsit(i.e.,itgetsaresponse)thentheinteractionhappenslocallyviaBulb-Appcommuni-cations,whicharethesubjectofouranalysis.Other-wise,iftheTapoappdoesnotreceiveanyvalidbulbdiscoveryresponse,thenittriestocheckthesmartbulbremotely.Ifthesmartbulbisnotdetectableevenremotelythenitisdeterminedoffline.6VULNERABILITYASSESSMENTTheassessmentfollowingtheinformationgatheredsofarhighlightsfourvulnerabilities.Vulnerability1–LackoftheSmartBulbAuthen-ticationwiththeTapoApp.ImproperAuthentica-tion(MITRE,2006a)inTapoL503Eallowsanadja-centattackertoimpersonatetheTapoL530EwiththeTapoappduringtheTSKEPstep.IntheTSKEPstep,unliketheBulbDiscoverystep,theprotocolusedtoexchangethesessionkeydoesnotgivetheTapoappanyevidenceofitspeer’sidentity.Hence,anattackerisabletoauthenticatetotheTapoappastheTapoL530Eorasanotherdevice:infact,thisvulnerabilityispresentinallTaposmartdevicesthatusetheTSKEPprotocol.TheCVSSv3.1scorethatwecalculateis8.8,meaningHighseverity.Precisely:AttackVector:Adjacent;AttackComplexity:Low;PrivilegesRe-quired:None;UserInteraction:Required;Scope:Changed;Confidentiality:High;Integrity:High;Availability:High.Inparticular,AttackComplex-ityislowbecausetheattackercouldimpersonatethebulbbyimplementingtheprotocolmessagestore-spondtothecallingapp.Followingthat,hecouldobtaintheuserpasswordontheTapoapp,thenfullyimpersonatetheuserandmanipulateatwillanytargetTapodeviceofthesameuser.Precisely,byimperson-atingthebulbatsetuptimeasexplainedabove,theattackerwouldreceivethevictim’sWi-FiSSIDandpasswordfromtheTapoapp,sothathecouldthenimpersonatetheuserbyherpasswordateachsessionwiththetargetdevice,whichcouldbeanyTapode-viceoftheuser’s.Theattackercouldalsoobtainthedevice-chosensessionkey,whichhecouldthenrelaytotheuser’sgenuineappandeffectivelyinterpose.Vulnerability2–Hard-CodedShortCheck-sumSharedSecret.ProtectionMechanismFail-ure(MITRE,2008)inTapoL503EallowsanadjacentattackertoobtainthesecretusedforauthenticationduringtheBulbDiscoveryphase.ThesharedsecretusedforBulbDiscovery’smes-sagesauthenticationisshortandhard-codedbothintheTapoappandintheTapoL530E.Therefore,itcanbeobtainedinthefollowingways:1.Brueforcing,becauseofitsshortness.2.DecompilingtheTapoapp.TheCVSSv3.1scorethatwecalculateis7.6,meaningHighseverity.Precisely:AttackVector:SECRYPT2023-20thInternationalConferenceonSecurityandCryptography224Adjacent;AttackComplexity:Low;PrivilegesRe-quired:None;UserInteraction:Required;Scope:Unchanged;Confidentiality:Low;Integrity:High;Availability:High.Theknowledgeofthesharedse-cretprovidestotheattackertheabilitytoeditandtocreateBulbDiscoverymessages.Specifically,theat-tackerisabletogeneratefakebulbdiscoveryrequeststolocateallsmartbulbs,orgenerallyTapodevicesus-ingthesameprotocol,connectedwithinthesamenet-work.Meanwhile,theabilitytoeditvalidmessagesallowstheattackertoeditthebulbdiscoveryresponsemessagessentfromthesmartbulbtotheTapoapp.Vulnerability3–LackofRandomnessDuringSymmetricEncryption.UseofaCryptographicPrimitivewithaRiskyImplementation(MITRE,2020)inTapoL503Eallowsanadjacentattackertomakethecryptographicschemedeterministic.TheIVusedinAES128-CBCschemeisgeneratedtogetherwiththekeyandremainsunchangedfortheentirelifeofthekey.Therefore,theencryptionofthesamemessagesproducesthesameciphertext.TheCVSSv3.1scorethatwecalculateis4.6,meaningMediumseverity.Precisely:AttackVec-tor:Adjacent;AttackComplexity:Low;PrivilegesRequired:None;UserInteraction:Required;Scope:Unchanged;Confidentiality:Low;Integrity:None;Availability:Low.Whentheuserinteractswiththedevicetherebygeneratingtraffic,theattackercandistinguishrepeatedmessageswithoutdecipheringthem,yetinferwhatmessagesleadtowhatconse-quences,suchasturningthebulboff.Hecouldthenmanipulatethebulbbyrepeatingthosemessages.Vulnerability4–InsufficientMessageFreshness.PredictablefromObservableState(MITRE,2006b)inTapoL503EallowsanadjacentattackertoreplaymessagesthatareconsideredvalidbothfromtheTapoL530EandtheTapoapp.ThesmartbulbandtheTapoappdonotcheckthefreshnessortheduplicityofthereceivedmessages.Theyonlycheckthatthesessionkeywithwhichthemessagesareencryptedisstillvalid,i.e.,notolderthan24hours.TheCVSSv3.1scorethatwecalculateis5.7,meaningMediumseverity.Precisely:AttackVec-tor:Adjacent;AttackComplexity:Low;PrivilegesRequired:None;UserInteraction:Required;Scope:Unchanged;Confidentiality:None;Integrity:None;Availability:High.Similarlytothepreviousvulnera-bility,theattackercanleverageuser-generatedtraffic,thistimetoreplaymessagesthatboththebulbandtheappwillcertainlyacceptbecauseofthelackofappropriatefreshnessmeasures.7EXPLOITATIONThisSectionshowshowanattackercanexploitthevulnerabilitieswefoundinarealenvironment.Weshow5attackscenarios,inwhichtheattackerexploitsoneormorevulnerabilitiestoachievetheirmaliciousgoals.Wevalidatedeachattackscenariobymanu-allyexecutingthestepsillustratedintheforthcom-ingsections,henceallreportedattacksarefeasibleinpractice.AsnotedabovethroughtheCVSSscores,theirlikelihoodisdeterminedbytheAdjacentAttackVector,theLowAttackComplexity,theNoPrivilegesRequiredandtheRequiredUserInteraction.7.1AttackScenario1-FakeBulbDiscoveryMessagesGenerationInthisexperimentweexploited:•Vulnerability2,withthegoalofgettingtheabilitytocreatefakeBulbDiscoverymessages.Thisexperimentcanbeconductedineverysce-nariopresentedinSection3.Forthisattack,itisfirstnecessarytogetholdofaUDPmessage.Inourcase,wehavechosentousearealbulbdiscoveryre-questmessage,becausetheyareeasytoget.ThesemessagesarebroadcastbytheTapoappeverytimeitisopened,regardlessofthenetworktowhichitisconnected.Togetavalidone,wejustcapturethetrafficusingWiresharkanduseafiltertoextractallUDPmessagessentinbroadcaste.g.,byusingthefil-terudp&&ip.dst==255.255.255.255.OnceaUDPmessageisobtained,wecanperformanofflinebrute-forceattacktogetthesecretsharedbetweentheTapoappandthesmartbulb.Atthispoint,neitherthesmartbulbnortheTapoappneedstobeactiveany-moretocompletetheattack.Inoursetup,thebrute-forceattackalwayssucceededin140minutesonav-erage.Thisgrantstheadversarytheabilitytocreatefakebulbdiscoveryrequestandresponsemessages:theformerallowstheattackertoidentifyallTapodevicesthatusethesameprotocolandthesamekey,onanynetworkheconnectsto,whilethelatterallowstheat-tackertorespondtotheTapoapp’srequestmessageswithfalseconfigurations.7.2AttackScenario2-PasswordExfiltrationfromTapoUserAccountInthisexperimentweexploited,inorder:•Vulnerability2,withthegoalofgettingtheabilitytocreatefakebulbdiscoveryresponsemessages,SmartBulbsCanBeHackedtoHackintoYourHousehold225•Vulnerability1,withthegoalofgettingtheabilitytoauthenticateastheTapoL530EtotheTapoapp.ThecontextinwhichweconducttheexperimentisSetupAdescribedinSection3.1.Tocarryoutthisattack,theadversaryneedstoobtaintheownerIdofthevictimTapoaccount,andtheUDPporttowhichthevictimsendsherbulbdiscoveryrequestmessages(inourcase,port20002).TheattackdiagramisshowninFigure7.Figure7:Sequencechartfortheattacker’simpersonationofthebulb.TheexploitationbeginsthemomentthevictimopensherownTapoapp.Whentheappisopen,itstartsbroadcastingbulbdiscoveryrequestmessages.Duringtheattack,theattackerexploitshisabilitytocreatefakebulbdiscoveryresponsemessagestore-spondtovariousbulbdiscoveryrequestfromthevic-tim.TheattackersetsthebulbdiscoveryresponsemessagesfieldsasshowninListing1:•ItsetstheownerfieldtotheownerIdofthevic-tim.ThisistomaketheTapoappthinkthereisadeviceofitsownonthenetworktostartTSKEP.•Itsetstheipandportfieldstopointtoanadversary-controlledserver.{"result":{"device_id":"bd1e...9348","owner":"Victim’sownerId","device_type":"SMART.TAPOBULB","device_model":"L530ESeries","ip":"Attacker’sIP","mac":"Attacker’sMAC","factory_default":false,"is_support_iot_cloud":true,"mgt_encrypt_schm":{"is_support_https":false,"encrypt_type":"AES","http_port":80}},"error_code":0}Listing1:JSONattackscenario2.Afterreceivingtheresponse,theTapoappthinksthatithassuccessfullycompletedtheBulbDiscov-eryphasebylocatingitsowndevicewithinthenet-work.Therefore,itstartstheTSKEPprotocolwiththeattackingdevice.Becauseofvulnerability1,theTSKEPprotocoldoesnotgivetheTapoappanyev-idenceabouttheidentityoftheinterlocutor.Forthisreason,theTapoappassumesthatthenewlyreceivedkeyissharedwithanassociateddevice,whileitissharedwiththeattackerinstead.Hence,theadversaryisabletodecrypttheLoginmessageoftheTSKEPprotocolandgetthepasswordandthehashoftheemailofthevictim’sTapoaccount.Theattackcanbesummarisedasfollows:•TheattackergetstheBulbDiscoverysharedkeyandcreatesfakebulbdiscoveryresponsemes-sages.Therefore,theauthenticationofthebulbdiscoveryresponsemessagefails.•TheTapoappexecutestheTSKEPprotocolwiththeattackerinsteadofthesmartbulb.Therefore,authenticationofthesmartbulbwiththeTapoappfails.Thisresultsinanintegrityloss.•TheTapoappsharesthekeywiththeattacker,hencethedistributionofthesessionkeyfails.Thisresultsinanavailabilityloss.•Theattackercanviolatetheconfidentialityofthemessagesandgetthepasswordandthehashoftheemailofthevictim’sTapoaccount.Thisresultsinaconfidentialityloss.7.3AttackScenario3-MITMAttackwithaConfiguredTapoL530EInthisexperimentweexploited:•Vulnerability1,withthegoalofgettingtheabilitytoauthenticateastheTapoL530EtotheTapoapp.ThecontextinwhichweconducttheexperimentisSetupBdescribedinSection3.2.TheattackermakesindependentconnectionswiththevictimsandrelaysmessagesbetweenthemtomakethembelievetheyaretalkingdirectlytoeachotheroveraprivateSECRYPT2023-20thInternationalConferenceonSecurityandCryptography226connection.WhentheTapoappstartstheTSKEPwiththesmartbulb,theattackerinterceptstheRSAkeytransmissionmessageandblocksitsreceptionfromthesmartbulb.Inparallel,hestartsanewses-sionwiththesmartbulbfromwhichhegetsanewsessionkey.Thesessionkeyreceivedbytheat-tackerfromthesmartbulbisthenencryptedwiththepreviouslyreceivedRSApublickeyandsenttotheTapoapp.Duetovulnerability1,theTapoappex-pectstosharethereceivedkeyonlywiththesmartbulb,butitissharingitwiththeadversaryinstead.Hence,theattackernowhasthekeythatTapoappandsmartbulbusetoencryptallsubsequentcommu-nicationmessages.Therefore,heiscapableofdeci-pheringthemandviolatingtheirconfidentialityandintegrity,forexamplebydecryptingthemessages,modifyingtheircontents,re-encryptingandthenfor-wardingthem.Thisissummarisedintheattackdia-gramshowninFigure8.Figure8:Sequencechartfortheattacker’sMITMbetweenappandbulb.Hence,theattackconsistsofthefollowingsteps:•TheTapoappexecutestheprotocolwiththeat-tackerinsteadofthesmartbulb,therefore,theau-thenticationprocessfails.•TheTapoappsharesthekeywiththeattackerandnotwiththesmartbulb,hence,thedistributionofthesessionkeyfails.•TheattackerauthenticatesthekeysharedwiththesmartbulbthankstothecredentialsreceivedfromtheTapoapp,therefore,theauthenticationoftheTapoappwiththesmartbulbfails.•Theattackerrelaysmessagesbetweenthetwoses-sionstomakeTapoappandsmartbulbbelievetheyaretalkingtoeachother,hence,theconfi-dentialityandtheintegrityofmessagesislost.7.4AttackScenario4-ReplayAttackwiththeSmartBulbasVictimInthisexperimentweexploited:•Vulnerability4,withthegoalofgettingtheabilitytoreplaybotholdandreplicatedmessages.ThecontextinwhichweconducttheexperimentisSetupBdescribedinSection3.2.Thisattackscenarioisdividedintothreephases.Specifically,inthiscase,itisalsonecessarythattheattackerhasalineofsightonthebulbtocompletetheattack.Duringthefirstphase,WiresharkisusedtosniffthetrafficofaBulb-Appcommunication.Duringthiscommunication,theappsendstothesmartbulbbothgetmessages,torequestthevalueofsomestatuspa-rameters,andsetmessages,torequestthesmartbulbtochangethevalueofsomeofitsinternalparameters.Duringtheexperiment,wearenotawareofthesym-metrickeyusedbyboththesmartbulbandtheTapoapptoencryptthemessages.Duringthesecondphaseoftheexperiment,wereplicateallmessageswepreviouslycaptured.Hence,foreachmessagewedeterminewhetheritwasagetorsetmessagesimplybyobservinghowthebulbbe-havesaftereachmessage.Foreverysetmessage,wetakenoteofthechangethatitcausedonthelightbulb.Duringthethirdphase,wearbitrarilyreplicatethesetmessagestothesmartbulb,managingtomakechangestoitsinternalstate,withouthavingaTapoaccountassociatedwithit.Messagescontinuetobeacceptedbythesmartbulbuntilthesessionkeywithwhichtheyareencryptedexpires.7.5AttackScenario5-MITMAttackwithanUnconfiguredTapoL530EInthisexperimentweexploited:•Vulnerability1,withthegoalofgettingtheabilitytoauthenticateastheTapoL530EtotheTapoapp.ThecontextinwhichweconducttheexperimentisSetupCdescribedinSection3.3.Thisattacksce-narioexploitsthefactthatnotonlytheTapoapp,butanyone(includingtheattacker),canconnecttotheWi-Finetworkstartedbythesmartbulbduringthesetupphase.Itisimportantthattheattackingdeviceactsasabridgebetweenthetwonetworks.Theat-tackermustflowallbulbdiscoveryrequestmessagesSmartBulbsCanBeHackedtoHackintoYourHousehold227fromthenetworkitcontrolstothesmartbulbnet-work,andviceversaforbulbdiscoveryresponsemes-sages.Otherwise,theTapoappwouldnotbeabletodetectthesmartbulbandthereforewouldnevertrytostarttheTSKEPwithit.Subsequently,vulnerability1isexploitedinthesamewayshowninSectionAttackScenario7.3,sotheadversaryisabletoviolatetheconfidentialityofthesessionkeybetweenthesmartbulbandtheTapoapp.Atsomepointinthecommunication,theTapoappsendstheJSONshowninListing2:{"method":"set_qs_info","params":{"account"{"password":"Tapopassword","username":"Tapoemail"},"extra_info":{"specs":"EU"},"time":{"region":"Europe/Rome","time_diff":60,"timestamp":1660032435},"wireless":{"key_type":"wpa2_psk","password":"Wi-Fipassword","ssid":"ssidWi-Fi"}},"requestTimeMils":1660032438365,"terminalUUID":"..."}’Listing2:JSONattackscenario5.Becauseusernames,Tapopasswords,SSIDs,andWi-Fipasswordsaresentinbase64encoding,theat-tackerisabletodecodeandstealthem.8FIXINGThisSectionoutlinespossiblemitigationsfortheidentifiedvulnerabilities,markingthelaststepofthePETIoTkillchain.Mostmeasuresconsistofsimplemodificationstotherelevantprotocols,inparticulartostrengthenthecryptographicmeasures.ThesecanbeimplementedviasoftwareupdatestobepushedtotheaffecteddevicesviaInternet,sowebelievethesefixestobeeasilydeployablewiththealreadyexistingupdateproceduresFixforVulnerability1.Thisvulnerabilityisthemostcomplexanddangerous.Itisnoteasytofindasimplefixtoitbecausetheprotocolshouldbewidelyrevised.OurproposedfixrequiresthesmartbulbtosignthemessageofAESkeytransmissionwithanasymmetric,privatekey.ThevalidityofthatkeyastobelongtothebulbcouldbeverifiedbytheappviaadigitalcertificatetoretrievefromtheCloudServerduringtheassociationofthebulbwiththeapp.Ofcourse,suchacertificateshouldchainuptoarootcertificatetobesecurelystoredwiththeapp.Allthiswouldallowtheapptogetevidenceabouttheau-thenticityoftheresponse,i.e.,thattheresponsereallycomesfromthesmartbulb.Inconsequence,theappwilleventuallystoreallcertificatesoftheassociateddevices.FixforVulnerability2.Onepossiblesolutiontofixthisvulnerabilityistheactivepresenceofthecloudserver.ThisentityshouldperiodicallyassigneachTapoaccountafreshkeytousewhencalculatingthechecksumwithinBulbDiscoverymessages.ThekeyassignedtoaTapoaccountshouldthenbecommuni-catedtoalldevicesassociatedwithit.Thebenefitsofthefixcanbesummarizedasfollows:•Thekeyisnothard-coded,sotheattackerwouldnolongerbeabletogetitbydecompilingtheTapoapporthefirmwareofaTapodevice.•Eachaccounthasitsownkey,therefore,compro-misingaTapoaccount,orakey,wouldnotresultincompromisingthekeysofotherTapoaccounts.•Thekeyshouldbelongandrandomenoughbycurrentstandardssothatbrute-forceattackswouldnotbeprofitableanymore.•Thekeyisalwaysfresh,soevenifanattackerweretogetthekeyofaTapoaccount,thelatterwouldnotbecompromisedforever,butonlyuntilthevalidityofthestolenkeyexpiresandthecloudserverassignsanewkeytoit.Itwouldalsobeusefultouseacollision-resistantcryptographichashfunctionforthechecksum.Ex-amplesofcryptographichashfunctionsareSHA-224orSHA3-224.FixforVulnerability3.ThisvulnerabilitycanbefixedbymakingtheIVdynamic,i.e.,usingdiffer-entIVstoencryptdifferentmessages.ThisshouldbedonebyboththeTapoappandtheTapoL530E.TheIVusedtoencrypttheJSONcontainedintheparamsfieldcouldthenbeincludedasafieldintheplainpartofJSONcontainedinBulb-Appcommunications.FixforVulnerability4.Thetimestampcontain-ingthemessagecreationmomentincludedinJSONshouldbeverifiedbysmartbulbandtheTapoapp.Checkingthecreationtimestampwouldpreventre-centmessagesfrombeingpassedoffasfreshbyanSECRYPT2023-20thInternationalConferenceonSecurityandCryptography228attacker.Inaddition,thevariousmessagesexchangedshouldcontainasequencenumber,whichwouldpre-ventduplicatemessages.9CONCLUSIONSWeidentifiedfourvulnerabilitiesintheTapoL530E,whichwewereabletopracticallyexploitinfivedif-ferentattackscenarioswithvaryingimpactsontheusers’security,privacyandsafety.Ofthefourvul-nerabilities,twoareofHighseverityandtwoareofMediumseverity,accordingtotheirCVSSscore.Overall,weobservethattheexperimentsetuphadtobedesignedwithcareduetothethreescenariosthatwerepossible.Followingthat,theinformationgather-ingstepwasratherlargeandcomplicated,muchmorethanitcouldbereportedinthispaperduetospaceconstraints.Thevulnerabilityassessmentwasverysurprising.Forexample,whiledeauthenticationisroutinelypossible,wewerenotpreparedtodiscoverpasswordsintheclearandweakcryptography.Ex-ploitingthevulnerabilitieswasmoderatelychalleng-ingbutdevisingappropriatefixeswasharder.Onewaytointerpretsuchfindingscouldbethat“small”IoTdevicesmayhaveraisedinsufficientcy-bersecurityattentionthusfar,i.e.,insufficientcyber-securitymeasuresduetoapreconceptionthattheymaynotbeworthhackingorexploiting.Ourworkpinsdownthispreconceptionaswrong,atleastbe-causethescopeofourattacksexpandsontoallde-vicesoftheTapofamilyavictimmayuseand,mostimportantly,potentiallyontotheentirevictim’sWi-Finetwork,whichtheattackerisenabledtopenetrate.Whilemoreandmoreexperimentswillcertainlyfollowonsimilarbulbsandotherinexpensivedevices,wearguethattheevidencewehavegatheredthusfarissufficienttocallforafullerapplicationofazerotrustmodeltotheIoTdomain.Withdozensofyearsofcybersecurityexperienceaccumulatedbytheinter-nationalcommunitythusfar,itshouldbepossibletofindaffordablewaystoachievethatinduecourse.REFERENCESAlopix(2023).Wifideauthattackin2min-utes!https://systemweakness.com/wifi-deauth-attack-in-2-minutes-d1fb55112305.Bella,G.andBiondi,P.(2019).Youovertrustyourprinter.InProc.ofthe2ndInternationalWorkshoponSafety,securiTy,andpRivacyInautomotiVesystEms(STRIVE’19),LNCS11699,pages264–274.Springer.Bella,G.,Biondi,P.,Bognanni,S.,andEsposito,S.(2023.).PETIoT:PEnetrationTestingtheInternetofThings.ElsevierInternetofThings,22.Biondi,P.,Bognanni,S.,andBella,G.(2020).VoIPCanStillBeExploited—Badly.InProc.ofthe5thInter-nationalConferenceonFogandMobileEdgeCom-puting,(FMEC’20),pages237–243.IEEE.Dalvi,A.,Maddala,S.,andSuvarna,D.(2018).Threatmodellingofsmartlightbulb.In2018FourthInter-nationalConferenceonComputingCommunicationControlandAutomation(ICCUBEA),pages1–4.d’OtreppedeBouvette,T.(2023).Aircrack-ng.https://www.aircrack-ng.org/.Ettercap(2023).Ettercapproject.https://www.ettercap-project.org/.Howarth,J.(2023).80+amazingiotstatistics(2023-2030).https://explodingtopics.com/blog/iot-stats.Kristiyanto,Y.andErnastuti,E.(2020).Analysisofdeauthenticationattackonieee802.11connectivitybasedoniottechnologyusingexternalpenetrationtest.CommIT(CommunicationandInformationTech-nology)Journal,14(1):45–51.MITRE(2006a).Cwe-287:Improperauthentication.https://cwe.mitre.org/data/definitions/287.html.MITRE(2006b).Cwe-341:Predictablefromobservablestate.https://cwe.mitre.org/data/definitions/341.html.MITRE(2008).Cwe-693:Protectionmechanismfailure.https://cwe.mitre.org/data/definitions/693.html.MITRE(2020).Cwe-1240:Useofacryptographicprim-itivewithariskyimplementation.https://cwe.mitre.org/data/definitions/1240.html.Nath,R.andNath,H.V.(2022).Criticalanalysisofthelayeredandsystematicapproachesforunderstandingiotsecuritythreatsandchallenges.ComputersandElectricalEngineering.Schepers,D.,Ranganathan,A.,andVanhoef,M.(2022).Ontherobustnessofwi-fideauthenticationcounter-measures.InProceedingsofthe15thACMConfer-enceonSecurityandPrivacyinWirelessandMobileNetworks,WiSec’22,page245–256,NewYork,NY,USA.AssociationforComputingMachinery.Wireshark(2023).Wiresharkproject.https://www.wireshark.org/.SmartBulbsCanBeHackedtoHackintoYourHousehold229

=== Content from www.dmi.unict.it_c3002955_20250114_181132.html ===


[IoT can be Hacked to Hack into your Household](#page-top)

* [Work](#work)
* [Attacks](#attacks)
* [Responsible Disclosure](#disclosure)
* [Paper](#paper)
* [CVE](#cve)
* [Q&A](#Q&A)

# IoT can be Hacked to Hack into your Household

After conducting a Penetration Testing session across multiple devices within the TP-Link Tapo IoT
ecosystem, we identified **four** vulnerabilities enabling five different potential attacks
### Work

"IoT can be Hacked to Hack into your Household" is the description of a Penetration Testing session
on five different IoT devices belonging the TP-Link Tapo IoT ecosystem. The studied device are the
Tapo L530E, the Tapo L510E V2, the Tapo L630, the Tapo C200, and the Tapo P100. During the session
we found **four** vulnerabilities that allow to perform five attacks. Due to the authentication not well
accounted for and the confidentiality not sufficiently guaranteed by the implemented cryptographic
measures, the attacker can operate at will all devices of the Tapo family that the user may have on
her Tapo account and learn the victim's Wi-Fi password, thereby escalating his malicious potential
considerably.

The tested firmware's versions of each device are:

|  | Vulnerable version | Fixed version |
| --- | --- | --- |
| L530E | 1.1.9 | 1.2.4 |
| L510E | 1.0.8 | 1.1.0 |
| L630 | 1.0.3 | 1.0.4 |
| P100 | 1.4.9 and 1.4.16 | 1.5.0 |
| C200 | 1.1.18 | - |

Tp-Link acknowledged the issues we responsibly reported through their Product Security Advisory
(PSA). We actively collaborated with them, by testing the fixes and confirming
the attack scenarios are no longer exploitable or do not give the attacker any advantage.
Tp-Link confirmed that they already released the necessary fixes to address the vulnerabilities and
that the changes do not affect the normal use and stability of the products.

The vulnerabilites that affect each device are:

|  | Vulnerability 1 | Vulnerability 2 | Vulnerability 3 | Vulnerability 4 |
| --- | --- | --- | --- | --- |
| L530E | 🐞 | 🐞 | 🐞 | 🐞 |
| L510E | 🐞 | 🐞 | 🐞 | 🐞 |
| L630 | 🐞 | 🐞 | 🐞 | 🐞 |
| P100 | 🐞 | 🐞 | 🐞 | 🐞 |
| C200 | 🛡️ | 🐞 | 🛡️ | 🛡️ |

🐞 if the vulnerability is present, 🛡️ otherwise.

---

## Attacks

* **Attack scenario 1 - Fake Device Discovery messages generation.**

  The attacker discovers the secret used by the smart device and Tapo application to
  authenticate discovery messages from compatible devices connected to the network, so he can
  authenticate fake messages.
* **Attack scenario 2 - Password exfiltration from Tapo user account.**

  The attacker authenticates himself as the smart device with the Tapo application, so
  he can obtain the credentials used by the Tapo application with the smart device. The
  attacker
  can obtain the password and email hash of the victim's Tapo account.
* **Attack scenario 3 - MITM attack with a configured Tapo device.**

  The attacker performs a MITM attack on the communication between the smart device and the
  Tapo
  application, so he is able to violate the confidentiality of all messages belonging to the
  communication.
* **Attack scenario 4 - Replay attack with the Tapo device as victim.**

  The attacker replicates old messages to both the smart device and the Tapo application, so
  he
  can arbitrarily change the state of the smart device.
* **Attack scenario 5 - MITM attack with an unconfigured Tapo device.**

  The attacker performs a Wi-Fi deauthentication attack in order to force the user to reset
  the
  smart device, so he can perform a MITM attack and obtain the SSID and password of the
  victim's
  local network and the credentials used by the victim to authenticate with the Tapo
  application. The credentials consist of the victim's Tapo account email and password.

|  | Attack Scenario 1 | Attack Scenario 2 | Attack Scenario 3 | Attack Scenario 4 | Attack Scenario 5 |
| --- | --- | --- | --- | --- | --- |
| L530E | ✅ | ✅ | ✅ | ✅ | ✅ |
| L510E | ✅ | ✅ | ✅ | ✅ | ✅ |
| L630 | ✅ | ✅ | ✅ | ✅ | ✅ |
| P100 | ✅ | ✅ | ✅ | ✅ | 🚫 |
| C200 | ✅ | ❌ | ❌ | ❌ | ❌ |

✅ if the attack scenario is feasible on the target device,
❌ if the attack scenario is not feasible because the communication is encapsulated within a TLS
channel,
🚫 if the attack scenario is not feasible because the configuration is done on the Bluetooth
channel.

---

## Responsible Disclosure

Complete Timeline of the Responsible Disclosure Process

* **June 2022**
  Research on Tapo L530E starts!
* **25th February 2023**  We start the responsible disclosure process by
  reporting all found undesirable behaviours and potential vulnerabilities to TP-Link, via
  their TP-Link Product Security Advisory. Our report includes the lack of authentication
  of the smart bulb with the Tapo app, the hard-coded, short shared secret, the lack of
  randomness during symmetric encryption, the insufficient message freshness.
* **1st March 2023**
  First response from TP-Link. TP-Link handled this vulnerability without delay, responded
  positively to the vulnerability report, and started the validation fix as soon as
  possible.
* **11th April 2023**
  After a first review of the report, TP-Link does not object to our decision to submit
  our research paper to venues for publication.
* **23rd April 2023**
  "Smart Bulbs can be Hacked to Hack into your Household" paper is accepted to the [**SECRYPT 2023**
  conference](https://secrypt.scitevents.org/)!
* **16th June 2023**
  TP-Link has confirmed a valid solution and is releasing new firmwares to fix the issue.
* **19th June 2023**
  Agreed deadline for the disclosure.
* **12th July 2023**
  Vulnerability is disclosed via publication of a paper on SciTePress.
* **September 2023**
  Research on Tapo L510E, Tapo L630, Tapo P100 and Tapo C200 starts!
* **11th October 2023**
  We report the found vulnerabilities to the TP-Link Product Security Advisory.
* **5th December 2023**
  TP-Link confirms the found vulnerabilities for these products as well, and releases a
  fix for all of them.
* **12th March 2024**
  Agreed deadline for the disclosure of the vulnerabilites on the other devices.

---

## Paper

Smart Bulbs can be Hacked to Hack into your Household

*Smart Bulbs can be Hacked to Hack into your Household* was reported by **Davide
Bonaventura** (UniversitÃ  degli Studi di Catania), **Sergio Esposito** (Royal Holloway
University of London)
and **Giampaolo Bella**
(UniversitÃ  degli Studi di Catania). The paper is published on the *20th SECRYPT
International Conference on Security and Cryptography **(SECRYPT 2023)***'s proceedings.

##### Davide Bonaventura

Master Student at UniversitÃ  degli Studi di Catania

 [Visit
linkedin](https://www.linkedin.com/in/davide-bonaventura-a44281229/)

##### Sergio Esposito

PhD Student at Royal Holloway University of London

 [Visit
homepage](https://s3lab.isg.rhul.ac.uk/authors/sergio-esposito/)

##### Giampaolo Bella

Associate Professor (with Italian MIUR habilitation as Full
Professor) at UniversitÃ  degli Studi di Catania

 [Visit homepage](https://www.dmi.unict.it/giamp/)

 [Read our
paper](https://www.scitepress.org/Papers/2023/120929/120929.pdf)
 Cite our paper
##### Cite Smart Bulbs Can Be Hacked to Hack into Your Household

Bonaventura, D.; Esposito, S. and Bella, G. (2023). Smart Bulbs Can Be Hacked to Hack into Your Household. In Proceedings of the 20th International Conference on Security and Cryptography, ISBN 978-989-758-666-8, ISSN 2184-7711, pages 218-229.

 Copy to clipboard

---

## CVE

Common Vulnerabilities and Exposures

CVE Entries assigned to the vulnerabilities described in our paper, **Smart Bulbs can be Hacked to
Hack into your Household**, are the following:

* [CVE-2023-38906](https://www.cve.org/CVERecord?id=CVE-2023-38906) for *Lack of the
  Smart Bulb Authentication with the Tapo App*
* [CVE-2023-38907](https://www.cve.org/CVERecord?id=CVE-2023-38907) for *Hard-Coded
  Short Checksum Shared Secret*
* [CVE-2023-38908](https://www.cve.org/CVERecord?id=CVE-2023-38908) for *Lack of
  Randomness During Symmetric Encryption*
* [CVE-2023-38909](https://www.cve.org/CVERecord?id=CVE-2023-38909) for *Insufficient
  Message Freshness*

---

## Q&A

Questions and Answers
## **Are the attacks possible on my Tapo devices?**

***Most likely.*** We have tested the attacks using the following
devices:

* A smart bulb Tapo series L530 with Firmware Version 1.1.9
* A smart bulb Tapo series L510 with Firmware Version 1.0.8
* A smart bulb Tapo series L630 with Firmware Version 1.0.3
* A smart plug Tapo series L630 with Firmware Version 1.4.9 and 1.4.16
* A smart camera Tapo series L630 with Firmware Version 1.1.18
* A Tapo application Version 2.8.14

Most likely the attack also works with other versions prior to the versions containing
the fix.

## **What other Tapo devices are afflicted by the attacks?**

***All Tapo devices using the described protocol.*** Vulnerabilities
are not implementation-oriented, but design-oriented. This means that all devices using
the same protocol used by the tested devices are vulnerable to the described attacks.

## **Someone got my Tapo credentials as well as my Wi-Fi credentials! What can I do?**

***Change the password of both your Tapo account and your Wi-Fi
network.*** This allows you to disconnect all devices connected
without your consent to your Tapo account or/and your Wi-Fi network.

## **What steps can I take to mitigate the risk of the attacks?**

***Make sure that only devices known to you have access to the Wi-Fi network
your smart device is connected to.*** The attacker can only carry out
attacks when he is able to communicate directly with the smart device.

***When you reset your smart device, pay attention to the Wi-Fi network you
connect to complete the configuration process.*** The network you are
connected to may be controlled by the attacker and not the network started by your smart
device.

***Make sure you do not disclose your tapoId.*** The tapoId
allows your Tapo application to recognize the devices associated with your account. The
attacker through it is able to authenticate to your Tapo application as a device
associated with it.

## **Have the vulnerabilites been exploited in the wild?**

***We are not aware of the vulnerabilites being exploited in the
wild.***

## **Is there a fix?**

***Yes.*** TP-Link has released a new version both of firmwares and
application that is attacks resistant. Make sure you update both.


