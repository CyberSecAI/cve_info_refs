=== Content from discuss.hashicorp.com_18e0db3f_20250114_201124.html ===


[HashiCorp Discuss](/)

# [HCSEC-2023-17 - Vault’s KV Diff Viewer Allowed HTML Injection](/t/hcsec-2023-17-vault-s-kv-diff-viewer-allowed-html-injection/54814)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

June 9, 2023, 4:52pm

1

**Bulletin ID:** HCSEC-2023-17

**Affected Products / Versions:** Vault and Vault Enterprise since 1.10.0; fixed in 1.14.0, 1.13.3, 1.12.7 and 1.11.11.

**Publication Date:** June 9, 2023

**Summary**

Vault and Vault Enterprise’s (Vault) key-value v2 (kv-v2) diff viewer allowed HTML injection into the Vault web UI through key values. This vulnerability, CVE-2023-2121, is fixed in Vault 1.14.0, 1.13.3, 1.12.7, and 1.11.11.

**Background**

Vault 1.10.0 introduced the ability to easily review the diff between two revisions of [kv-v2](https://developer.hashicorp.com/vault/docs/secrets/kv/kv-v2) key-value secrets in Vault’s web UI.

**Details**

A user with write privileges to a kv-v2 secrets engine mount could provide a string that would be incorrectly sanitized and rendered as raw HTML by Vault’s web UI.

By default, Vault’s content Security Policy prevents the execution of inline JavaScript, therefore preventing exposure to cross-site-scripting via this vector. (Vault uses three main mechanisms for preventing cross-site scripting; strong typing and input validation on the backend, framework-provided output encoding on the frontend, and a [restrictive, customizable](https://developer.hashicorp.com/vault/tutorials/operations/customize-http-headers) content security policy that includes `script-src 'self'` by default.)

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Vault Enterprise 1.14.0, 1.13.3, 1.12.7, and 1.11.11, or newer. Please refer to [Upgrading Vault](https://learn.hashicorp.com/tutorials/vault/sop-upgrade?in=vault/standard-procedures) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by Michal Zaczek of Securitum.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2021-19 - Vault’s UI Cached User-Viewed Secrets Between Shared Browser Sessions](https://discuss.hashicorp.com/t/hcsec-2021-19-vault-s-ui-cached-user-viewed-secrets-between-shared-browser-sessions/28166)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7694 | August 12, 2021 |
| [HCSEC-2021-33 - Vault’s KV Secrets Engine With Integrated Storage Exposed to Authenticated Denial of Service](https://discuss.hashicorp.com/t/hcsec-2021-33-vault-s-kv-secrets-engine-with-integrated-storage-exposed-to-authenticated-denial-of-service/33157)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7061 | December 14, 2021 |
| [HCSEC-2022-08 - Vault Enterprise’s Tokenization Transform Configuration Endpoint May Expose Transform Key](https://discuss.hashicorp.com/t/hcsec-2022-08-vault-enterprise-s-tokenization-transform-configuration-endpoint-may-expose-transform-key/36599)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7176 | March 4, 2022 |
| [HCSEC-2021-13 - Vault GitHub Action Did Not Correctly Mask Multi-Line Secrets In Output](https://discuss.hashicorp.com/t/hcsec-2021-13-vault-github-action-did-not-correctly-mask-multi-line-secrets-in-output/24128)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7596 | May 6, 2021 |
| [Vault 1.9.0-rc1 released!](https://discuss.hashicorp.com/t/vault-1-9-0-rc1-released/31563)  [Vault](/c/vault/30) [vault-release-oss-ent](https://discuss.hashicorp.com/tag/vault-release-oss-ent) | 2 | 719 | November 10, 2021 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


