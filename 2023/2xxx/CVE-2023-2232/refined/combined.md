=== Content from gitlab.com_9fee0686_20250115_100914.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-2232.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-2232.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-2232.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-2232.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ðŸ¤– GitLab Bot ðŸ¤–'s avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ðŸ¤– GitLab Bot ðŸ¤–")](/gitlab-bot)

  Jun 28, 2023

  [c2d86445](/gitlab-org/cves/-/commit/c2d864450569ecb2447bb04ff49172f08009b2c7)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/c2d864450569ecb2447bb04ff49172f08009b2c7)
  Â·
  c2d86445

  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Jun 28, 2023

  c2d86445

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/c2d864450569ecb2447bb04ff49172f08009b2c7)
  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Jun 28, 2023

Loading



=== Content from gitlab.com_6991fe76_20250115_100915.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# ReDoS in Jira prefix

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #1934802](https://hackerone.com/reports/1934802)** by `yvvdwf` on 2023-04-05, assigned to [@dcouture](/dcouture "Dominic Couture"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

Hi,

Gitlab recently add a new feature that allows specifying a [regex](https://gitlab.com/gitlab-org/gitlab/-/blob/47d8aca44eaa0a4f403e7ad76d86dee23e80d2e6/app/models/integrations/jira.rb#L351) to recognize Jira issues:

```
###  app/models/integrations/jira.rb#L351
    def jira_issue_match_regex
      match_regex = (jira_issue_regex.presence || Gitlab::Regex.jira_issue_key_regex)

      /\b#{jira_issue_prefix}(?<issue>#{match_regex})/
    end
```

`jira_issue_prefix` and `jira_issue_regex` are user input which can cause ReDoS attack

##### Steps to reproduce

This feature is available on gitlab.com but not yet on user instance, so I tested this on gitlab.com and confirm it via Gitpod:

1. In an existing project, or create a new project, enable Jira integration:

* fill the required inputs as you want but the two following allows ReDoS:
* `Jira issue regex`: `((a|b)+|c)+$`
* `Jira issue prefix`: `JIRA`

[![jira-setting.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/3bd3e3aa888cf93f316754b3953e1179fd2423ff/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36646262323334342d343931312d346135642d623666612d3133313238316136373530622f6a6972612d73657474696e672e706e67)

2. Open a new issue:

* `title`: `test-jira`
* `Write`: `JIRAaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa1`
* click `Save changes` button
* we can see that the `puma` server uses `100%` CPU, then restarts after 5 minutes.

[![issue.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/4173464bb52cf927300a0071796408bf6cbf8f4d/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63356231663435612d363234302d343165312d396330632d3761383361346461373830392f69737375652e706e67)

Error on gitlab.com:

[![500_Error_-_GitLab.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/08b922c8d66f3a8836dd256ff62b625300ec3609/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f31626439616139322d353161642d346264372d383566372d6462646661363534353861662f3530305f4572726f725f2d5f4769744c61622e706e67)

##### Impact

This ReDoS issue causes deny of service at the back-end

##### What is the current *bug* behavior?

User input is not sanitized

##### What is the expected *correct* behavior?

User input should be sanitized before using in a regex

##### Output of checks

This bug happens on GitLab.com

#### Impact

This ReDoS issue causes deny of service at the back-end

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [issue.png](https://h1.sec.gitlab.net/a/c5b1f45a-6240-41e1-9c0c-7a83a4da7809/issue.png)
* [jira-setting.png](https://h1.sec.gitlab.net/a/6dbb2344-4911-4a5d-b6fa-131281a6750b/jira-setting.png)
* [500\_Error\_-\_GitLab.png](https://h1.sec.gitlab.net/a/1bd9aa92-51ad-4bd7-85f7-dbdfa65458af/500_Error_-_GitLab.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


