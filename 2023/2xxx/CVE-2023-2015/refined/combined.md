=== Content from gitlab.com_ca682b77_20250114_183040.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Reflected XSS in Report Abuse Functionality

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #1941091](https://hackerone.com/reports/1941091)** by `akadrian` on 2023-04-10, assigned to [@ameyadarshan](/ameyadarshan "Ameya Darshan"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

The Report Abuse functionality which can be triggered for example from snippet comments is vulnerable to reflected xss.

Vulnereble url:

<https://gitlab.com/-/abuse_reports/new?ref_url=javascript:alert(44);/%2Froot%2Fvictim-project1%2F-%2Fsnippets%2F3%23note_125&user_id=12743360>

Vulnerable parameter: ref\_url

##### Steps to reproduce

1. Create two gitlab accounts called: Victim and Attacker
2. Note id of each previously created user id
3. Take following url and change user\_id to Victim or Attacker id, in my case user\_id=2 is an id of victim user:

   <https://YOUR-HOST/-/abuse_reports/new?ref_url=javascript:alert(44);/%2Froot%2Fvictim-project1%2F-%2Fsnippets%2F3%23note_125&user_id=2>
4. Open the url in victim session
5. Click on "Cancel" button and javascript should launch. On self-hosted gitlab there is no CSP- protection so it will be run without the need of bypassinng CSP. On SaaS gitlab version CSP will block this but you should see alert in console.

##### Impact

It's a reflected XSS issue which can lead to account takeover, making actions on user behalf.

##### What is the current *bug* behavior?

ref\_url parameter value is reflected with no filtering applied which leads to XSS vulnerability

##### What is the expected *correct* behavior?

ref\_url parameter value should be validated on server side allowing only http or https schemes. Also html encoding should be

applied to avoid script injection.

#### Impact

Attacker could exploit this vulnerability to make actions on user behalf or even steal access to victim accounts.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [recording-1681146571184.webm](https://h1.sec.gitlab.net/a/7de16428-e604-41e1-b357-00d44ae558d0/recording-1681146571184.webm)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_5b755225_20250114_183039.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-2015.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-2015.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-2015.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-2015.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ðŸ¤– GitLab Bot ðŸ¤–'s avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ðŸ¤– GitLab Bot ðŸ¤–")](/gitlab-bot)

  Jun 06, 2023

  [c4fb8467](/gitlab-org/cves/-/commit/c4fb8467c212168aca07c0d4f2185ed51486be7e)
  [Publishing 0 updated advisories and 10 new advisories](/gitlab-org/cves/-/commit/c4fb8467c212168aca07c0d4f2185ed51486be7e)
  Â·
  c4fb8467

  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Jun 06, 2023

  c4fb8467

  [Publishing 0 updated advisories and 10 new advisories](/gitlab-org/cves/-/commit/c4fb8467c212168aca07c0d4f2185ed51486be7e)
  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Jun 06, 2023

Loading


