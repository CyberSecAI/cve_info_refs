=== Content from gitlab.com_929be00a_20250114_224333.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Privilege escalation from maintainer to owner by importing members from a project

⚠ **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #1934811](https://hackerone.com/reports/1934811)** by `theluci` on 2023-04-05, assigned to [@greg](/greg "Greg Myers"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

Hello, this bug is similar to #1576230.

The fix to [#356975 (closed)](https://gitlab.com/gitlab-org/gitlab/-/issues/356975 "A member able to upgrade their/other member role to owner role") can be bypassed if a maintainer import members from a project.

#### Summary

A maintainer of a project can upgrade or downgrade a members role or invite new members to the project.

However, to protect against privilege escalation from maintainer to owner. Gitlab doesn't allow the maintainer to invite new members with the owner role.

[![m1.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/aa43334515fc16dfaae2d5ca0c00b3b26b805adb/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34323130333730372d643532322d343661322d393562322d3930623461613630333461352f6d312e706e67)

Neither does it allow to upgrade a members role to owner.

[![m2.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/b5560190d44308ca863ba3f884b96fe852642982/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f32366365643432352d353562362d343236312d616662312d3730323034303134376236342f6d322e706e67)

The check is also implemented in the api, so that a maintainer cannot escalate privileges by changing `"access_level":50`

However, the check is not implemented when ***importing members from a project*** and **a malicious maintainer can invite his another account as the owner of a project.**

#### Steps to reproduce

`victim` is the owner of project `victim-project`

`attacker1` is the maintainer of `victim-project`

1. `attacker1` creates a project `attacker-project` and invite his another account `attacker2` as the owner.
2. `attacker1` goes to `victim-project` membership page.

`https://gitlab.com/<victim-group>/<victim-project>/-/project_members`

3. `attacker1` clicks on **Import from a project**
4. `attacker1` selects `attacker-project`

`attacker2` is now the owner of the `victim-project`

(Optional)

5. `attacker2` can now upgrade `attacker1` as the owner and remove `attacker2` account if he wishes.

#### POC

[Import\_from\_a\_project.mp4](https://user-content.gitlab-static.net/568be2918c6077895b94f4c17d8ae4aac84ce471/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34316162366266322d323639312d343236332d613736632d6262633764343636373538652f496d706f72745f66726f6d5f615f70726f6a6563742e6d7034 "Download 'Import_from_a_project.mp4'")

#### Impact

A malicious maintainer can escalate his privileges to that of an owner.

He gains access to owner functions such as -

1. Delete project
2. Archive project
3. Transfer project to another namespace
4. Delete merge requests etc.

#### Output of checks

This bug happens on GitLab.com (Probably on instance too)

#### Impact

A malicious maintainer can escalate his privileges to that of an owner.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [m1.png](https://h1.sec.gitlab.net/a/42103707-d522-46a2-95b2-90b4aa6034a5/m1.png)
* [m2.png](https://h1.sec.gitlab.net/a/26ced425-55b6-4261-afb1-702040147b64/m2.png)
* [Import\_from\_a\_project.mp4](https://h1.sec.gitlab.net/a/41ab6bf2-2691-4263-a76c-bbc7d466758e/Import_from_a_project.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_70623979_20250114_224331.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-2485.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-2485.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-2485.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-2485.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![Michael Henriksen's avatar](/uploads/-/system/user/avatar/7539010/avatar.png?width=64 "Michael Henriksen")](/mhenriksen)

  Sep 30, 2024

  [4d03cee4](/gitlab-org/cves/-/commit/4d03cee424ee9d753361bb23addf161c2467b281)
  [Update titles on updated records](/gitlab-org/cves/-/commit/4d03cee424ee9d753361bb23addf161c2467b281)
  ·
  4d03cee4

  [Michael Henriksen](/mhenriksen) authored Sep 30, 2024

  4d03cee4

  [Update titles on updated records](/gitlab-org/cves/-/commit/4d03cee424ee9d753361bb23addf161c2467b281)
  [Michael Henriksen](/mhenriksen) authored Sep 30, 2024

Loading


