```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is caused by insufficient sanitization of user-supplied input when creating or deleting classification store groups, collections, and properties within the Pimcore application. Specifically, the application did not properly sanitize user-provided names for these entities before using them in confirmation messages or when sending them to the server, allowing an attacker to inject malicious code into the application’s UI.",
    "weaknesses": [
      "Cross-Site Scripting (XSS) vulnerability exists because user-controlled data is used in generating UI elements (confirmation dialogs) without proper encoding or sanitization.",
       "The application uses `Ext.Msg.confirm` to display confirmation dialogs. These dialogs used to display user-provided data (group names, collection names, property names) without sanitization.",
       "The application uses client-side JavaScript to construct confirmation dialogs, before sending names to server-side for processing."
    ],
    "impact": "An attacker can inject arbitrary JavaScript code into the application’s interface through the classification store functionality. This could allow the attacker to execute malicious scripts in the browser of any user who interacts with the affected parts of the application, potentially leading to session hijacking, data theft, or other malicious actions.",
    "attack_vectors": "The attack vector is through the user interface of the Pimcore administration panel, specifically within the data object management section where classification store entities (groups, collections, properties) are created or deleted. An attacker would need to provide malicious input as names for these entities.",
    "required_capabilities": "An attacker needs to be a user with the ability to create or delete classification store groups, collections or properties within the Pimcore administration panel. This typically requires having administrative privileges or specific roles with access to data object management features."
  },
  "affected_files": [
    {
      "file": "bundles/AdminBundle/Controller/Admin/DataObject/ClassificationstoreController.php",
      "changes": "Sanitization of input names for groups, stores, and collections using SecurityHelper::getStringWithoutControlChars."
    },
    {
      "file": "bundles/AdminBundle/Resources/public/js/pimcore/helpers.js",
      "changes": "Added `pimcore.helpers.getStringWithoutControlChars` function to sanitize strings by removing control characters."
    },
    {
      "file": "bundles/AdminBundle/Resources/public/js/pimcore/object/classificationstore/collectionsPanel.js",
      "changes": "Implemented sanitization using `pimcore.helpers.getStringWithoutControlChars` for collection names and related group names in confirmation dialogs."
    },
    {
        "file": "bundles/AdminBundle/Resources/public/js/pimcore/object/classificationstore/groupsPanel.js",
      "changes":"Implemented sanitization using `pimcore.helpers.getStringWithoutControlChars` for group names and related key names in confirmation dialogs."
    },
    {
        "file": "bundles/AdminBundle/Resources/public/js/pimcore/object/classificationstore/propertiesPanel.js",
      "changes": "Implemented sanitization using `pimcore.helpers.getStringWithoutControlChars` for property names in confirmation dialogs."
    },
    {
      "file": "lib/Security/SecurityHelper.php",
      "changes": "Added `getStringWithoutControlChars` function to remove specific characters from input strings."
    }
  ]
}
```