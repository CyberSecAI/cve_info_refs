=== Content from gitlab.com_4e336ad1_20250115_080811.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-2478.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-2478.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-2478.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-2478.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ðŸ¤– GitLab Bot ðŸ¤–'s avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ðŸ¤– GitLab Bot ðŸ¤–")](/gitlab-bot)

  May 07, 2023

  [36bfb98b](/gitlab-org/cves/-/commit/36bfb98be82b74d85d0800897cbe4afa1d5e4953)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/36bfb98be82b74d85d0800897cbe4afa1d5e4953)
  Â·
  36bfb98b

  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored May 07, 2023

  36bfb98b

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/36bfb98be82b74d85d0800897cbe4afa1d5e4953)
  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored May 07, 2023

Loading



=== Content from gitlab.com_ff44800d_20250115_080813.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Malicious Runner Attachment via GraphQL

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #1969599](https://hackerone.com/reports/1969599)** by `yvvdwf` on 2023-05-02, assigned to [@rshambhuni](/rshambhuni "Rohit Shambhuni"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

Hi,

This GraphQL [endpoint](https://gitlab.com/gitlab-org/gitlab/-/blob/67ce9025952987c04081feec14d3f30dbf6788e8/app/graphql/mutations/ci/runner/update.rb) allows to associate a runner to a project without checking whether the current user has permission on the project. It leads to the ability to assign a (malicious) runner to any project. Consequently this is a possible attack vector to ["steal"](https://docs.gitlab.com/runner/security/#cloning-a-runner) runner jobs.

### Step to reproduce

0. Prepare: as victim, to create a private project. Note the project ID, e.g., `111111111`.
1. As attacker:

   1.1 In an existing project, or create a new one, go to `Settings`/`CI/CD`/`Runners`. Follow the steps in `Project runners`to setup a runner for this project.

   1.2. After registering the runner, edit it by unchecking `Lock to current projects`, then click `Save changes`

   1.3. Note the ID of the runner, e.g., `999999999`

   1.4. Open <https://gitlab.com/-/graphql-explorer>, and run the following query after **replacing** IDs of your runner and victim project:

```
mutation  {
  runnerUpdate(input:{id: "gid://gitlab/Ci::Runner/999999999",
    associatedProjects: ["gid://gitlab/Project/111111111"]
  }){
  	runner {
      ownerProject {fullPath}
    }
    errors
	}
}
```

2. As the victim, open the private project and goto `Settings`/`CI/CD`/`Runners`. You should see that the runner is now in the list of `Assigned project runners`

   2.1 Add `.gitlab-ci.yml` file to the project, if it does not exist, using the following content:

```
build-job:
  script:
    - echo "This script will be runned in a malicious runner"
```

2.2 When going to `CI/CD`/`Jobs`, you should see that the job is executed by the runner above

#### Impact

The impact should be similar with [CVE-2022-0735](https://about.gitlab.com/releases/2022/02/25/critical-security-release-gitlab-14-8-2-released/#runner-registration-token-disclosure-through-quick-actions) (`CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N`, 9.6).. That is, an unauthorized user is able to steal runner jobs which are used to uncover private information, such as, project code, [CI/CD job tokens](https://docs.gitlab.com/ee/ci/jobs/ci_job_token.html)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


