=== Content from gitlab.com_e21b52a1_20250114_234556.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Bypassing tags protection in GitLab

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #1908423](https://hackerone.com/reports/1908423)** by `inspector-ambitious` on 2023-03-15, assigned to [@ottilia\_westerlund](/ottilia_westerlund "Ottilia Westerlund"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

### Summary

I believe I discovered a bug that allows an attacker to spoof protected tags, that could potentially lead a victim to download malicious code.

### Steps to reproduce

We will distinguish 2 users to reproduce this vulnerability:

* `victim01` the victim
* `inspector-ambitious` the attacker

#### In victim context (`root`): The initial setup

1. Create a new private repository called `tag-protection-bypass`

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/b491c4d81c79ea15e66b383ade1df18e24a693e8/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64393139323263632d646133322d343536322d616666632d3530383732353234383461332f696d6167652e706e67)

2. Invite `inspector-ambitious` as a member of the project in `Project Information > Members`

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/3ad45f7af01c40b62e8945a38ff4c750bc8ca75e/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65646336326630632d303738342d343332302d623464342d6666636563373262653531372f696d6167652e706e67)

3. Go to `Settings > Repository`, expand the `Protected tags` and create a new rule

   Tag: `v*`

   Allowed to create: `Maintainers`

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/b696a33340bc4f0c645c5b9ebb37f7fb1db05abe/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65336138316638382d323137632d343866662d613231652d6134616235353462653163632f696d6167652e706e67)

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/221a9df6d6ae962ba70cfd8ae95e2a845ba107aa/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64653838363963652d376465662d346536322d623731302d3365623832633961636134632f696d6167652e706e67)

So at this stage `inspector-ambitious` should not be able to create tags since they are protected.

#### In attacker context (`inspector-ambitious`): The attack

1. Create a branch called `v1` containing an empty malicious file (for demonstration)

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/b3bfd3c590d447848c9a14e725c4e7a093ed8bd8/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f30323265656566352d653961622d343962652d616364382d3661333038623538356436612f696d6167652e706e67)

2. Click repository `Tags` links

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/466daf2ca5104ca99d60b6b9458ca58c6ca127a2/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62376239386436312d343134662d343834362d396139382d3166336330623032663362382f696d6167652e706e67)

(there is no tags created yet)

2. Click on `New Tag`
3. Set the tag name to `refs/tags/v1` and the Create from to `v1`, create the tag

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/d080b2db2b5dfc9023b3ea628d92a3cbac5c60c4/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64366462316265662d633132392d343463312d383831662d3736653434666236386635622f696d6167652e706e67)

4. a 404 appears but the tag is created

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/aef21edaa09d872f8aadf3d9f666e4d0a5991868/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36616631636237622d303837352d346133652d613639322d6165663730656161333265342f696d6167652e706e67)

5. Go back to the repo tags list, the tag now appears as protected !

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/548363794f69c2abb31726f55f97695f8c282723/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f39666535326636642d396437662d343238302d386566362d6539363632306362663264642f696d6167652e706e67)

Please note that clicking the tag does not work because a 404 is thrown, but the download

Source code feature will still work.

What I believe is happening in the background is that since the tag v1 reference cannot be resolved the download of the source code fallback to the content of the branch v1.

##### Impact

A victim can end up downloading malicious source code.

##### Output of checks

This bug happens on GitLab.com

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [image.png](https://h1.sec.gitlab.net/a/e3a81f88-217c-48ff-a21e-a4ab554be1cc/image.png)
* [image.png](https://h1.sec.gitlab.net/a/de8869ce-7def-4e62-b710-3eb82c9aca4c/image.png)
* [image.png](https://h1.sec.gitlab.net/a/d91922cc-da32-4562-affc-5087252484a3/image.png)
* [image.png](https://h1.sec.gitlab.net/a/edc62f0c-0784-4320-b4d4-ffcec72be517/image.png)
* [image.png](https://h1.sec.gitlab.net/a/b7b98d61-414f-4846-9a98-1f3c0b02f3b8/image.png)
* [image.png](https://h1.sec.gitlab.net/a/6af1cb7b-0875-4a3e-a692-aef70eaa32e4/image.png)
* [image.png](https://h1.sec.gitlab.net/a/9fe52f6d-9d7f-4280-8ef6-e96620cbf2dd/image.png)
* [image.png](https://h1.sec.gitlab.net/a/022eeef5-e9ab-49be-acd8-6a308b585d6a/image.png)
* [image.png](https://h1.sec.gitlab.net/a/d6db1bef-c129-44c1-881f-76e44fb68f5b/image.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_8c85734a_20250114_234554.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-2001.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-2001.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-2001.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-2001.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ðŸ¤– GitLab Bot ðŸ¤–'s avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ðŸ¤– GitLab Bot ðŸ¤–")](/gitlab-bot)

  Jun 06, 2023

  [c4fb8467](/gitlab-org/cves/-/commit/c4fb8467c212168aca07c0d4f2185ed51486be7e)
  [Publishing 0 updated advisories and 10 new advisories](/gitlab-org/cves/-/commit/c4fb8467c212168aca07c0d4f2185ed51486be7e)
  Â·
  c4fb8467

  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Jun 06, 2023

  c4fb8467

  [Publishing 0 updated advisories and 10 new advisories](/gitlab-org/cves/-/commit/c4fb8467c212168aca07c0d4f2185ed51486be7e)
  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Jun 06, 2023

Loading


