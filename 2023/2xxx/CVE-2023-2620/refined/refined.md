```
{
  "Root cause of vulnerability": "The fix for a previous vulnerability (CVE-2022-4342) that aimed to prevent leaking masked webhook secrets was bypassed due to insufficient validation logic when updating webhook URLs with masked secrets. The validation logic failed to detect a specific sequence of URL modifications, allowing an attacker to retrieve the masked secret.",
  "Weaknesses/vulnerabilities present": "The vulnerability lies in the flawed validation logic within the reset_url_variables method. This method is intended to clear url_variables if the URL changes and contains masked parts. The vulnerability is caused by the fact that the url_changed? check can be bypassed, and that the interpolated_url_was == interpolated_url condition can also be met even after modifying the target url if the mask remains the same",
  "Impact of exploitation": "A malicious maintainer can leak masked secrets from webhook URLs by manipulating the URL and masking configurations. This allows unauthorized access to sensitive information, which could lead to further compromise of systems or data.",
  "Attack vectors": "The attack vector is through the web interface where maintainers can configure project webhooks.",
  "Required attacker capabilities/position": "The attacker needs to be a maintainer of a project and be able to edit webhook settings. The attacker needs the victim to have already configured a webhook with masked secrets."
}
```