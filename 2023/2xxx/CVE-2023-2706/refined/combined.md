=== Content from lana.codes_5fc0eabc_20250115_100917.html ===

[Skip to content](#content)

[![Lana Report](https://lana.report/wp-content/uploads/lana-report-inverse-text-logo-with-mascot.png)](https://lana.report/)

* [Front Page](https://lana.report/)
* [Reports](https://lana.report/vulnerability/)
* [Publications](https://lana.report/publication/)

1. [Lana Report](https://lana.report/)
2. [Publications](https://lana.report/publication/)

### OTP Login/Signup Woocommerce by XootiX WordPress plugin Authentication Bypass

REPORT ID: 87b5e80e-fd5b-47c3-bf82-088bdf4573b5

The plugin contains an Auth Bypass vulnerability. To bypass authentication, we only need to know the user‚Äôs phone number. Depending on whose phone number we know, we may even be given an administrator role on the website.

#### Let‚Äôs check the plugin

The `request_otp()` method in the `Xoo_Ml_Phone_Verification` class generates and sends an otp with the following code:

```
$otp = Xoo_Ml_Otp_Handler::sendOTPSMS( $phone_code, $phone_no );
```

but the otp is also returned in the ajax response:

```
wp_send_json(array(
	'otp_sent' 	=> 1,
	'otp' 		=> $otp,
	'phone' 	=> $phone_code.$phone_no,
	'phone_no' 	=> $phone_no,
	'phone_code'=> $phone_code,
	'error' 	=> 0,
	'otp_txt' 	=> sprintf( __( 'Please enter the OTP sent to <br> %s', 'mobile-login-woocommerce' ), $phone_code.$phone_no ),
));
```

The problem is that the password, which should only be received by the user via sms, becomes public in this way.

#### Let‚Äôs configure the plugin

Vulnerability is only present at Amazon and Twilio Phone Operator.

In the plugin settings, under the Phone tab, select ‚ÄúAmazon‚Äù for the ‚ÄúPhone Operator‚Äù. Then, under the Services tab, in the Amazon SNS Settings, enter the ‚ÄúAccess key‚Äù and ‚ÄúSecret access key‚Äù.

Then, in the user profile, we need to set the ‚ÄúPhone‚Äù.

These settings are required to log in to the website using otp.

#### Let‚Äôs see how we can exploit this vulnerability

All we have to do is check the request response, the easiest way is with the browser console.

[![](https://lana.report/wp-content/uploads/mobile-login-woocommerce-otp-login-screenshot.png)](https://lana.report/wp-content/uploads/mobile-login-woocommerce-otp-login-screenshot.png)

Screenshot: OTP Login/Signup Woocommerce *‚Äì Login with OTP at WooCommerce*

[![](https://lana.report/wp-content/uploads/mobile-login-woocommerce-enter-otp-screenshot.png)](https://lana.report/wp-content/uploads/mobile-login-woocommerce-enter-otp-screenshot.png)

Screenshot: OTP Login/Signup Woocommerce *‚Äì Enter OTP, and and the password in reponse*

As we can see in the screenshot, the password is included in the json in the response:

```
{"error":0,"otp":461129,"otp_sent":1,"otp_txt":"Please enter the OTP sent to <br> +3630xxxxxxx","phone":"+3630xxxxxxx","phone_code":"+36","phone_no":"30xxxxxxx"}
```

If we enter this password in the ‚ÄúEnter OTP‚Äù field and click on the Login with OTP button, we will log in to the given user.

#### Note

As we can see on the screenshot, we received the same OTP from the service provider via SMS:

[![](https://lana.report/wp-content/uploads/mobile-login-woocommerce-sms-screenshot-with-phone.png)](https://lana.report/wp-content/uploads/mobile-login-woocommerce-sms-screenshot-with-phone.png)

Screenshot: OTP Login/Signup Woocommerce *‚Äì SMS from the provider*

#### Try it

Feel free to try and use the lana.solutions/vdb WordPress websites for testing. I have set the roles and capabilities, so you can only get low level access to the website.

Website: <https://lana.solutions/vdb/xootix-mobile-login-woocommerce/my-account/>

### References

Source Code
<https://wordpress.org/plugins/mobile-login-woocommerce/>

Repository
<https://plugins.svn.wordpress.org/mobile-login-woocommerce/>

CVE
[CVE-2023-2706](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2706)

### Let's discuss

### Attributes

Catgory
WordPress Plugin

Vulnerability Discovered
2023-05-14

Post Published
2023-05-16

Post Updated
2023-06-13

Affected Version
<= 2.2

### Classification

Type
Authentication Bypass

### Researcher

Name
[Istv√°n M√°rton](https://lana.report "Visit Istv√°n M√°rton‚Äôs website")

Email
[[email¬†protected]](/cdn-cgi/l/email-protection#b6dfd8d0d9f6dad7d8d798d5d9d2d3c5)

### Tags

authentication bypass
exploit
wordpress plugin

### Advertisement

### Support Us?

We would truly appreciate it if you bought us a bunny (food for a snow leopard).

[![buy me a bunny!](https://img.buymeacoffee.com/button-api/?text=buy me a bunny!&emoji=üê∞&slug=lanacodes&button_colour=0776eb&font_colour=ffffff&font_family=Lato&outline_colour=ffffff&coffee_colour=FFDD00)](https://www.buymeacoffee.com/lanacodes)

![](https://lana.report/wp-content/uploads/lana-report-inverse-text-logo-with-mascot.png)

The Lana Report is a database containing vulnerabilities researched and published by Lana Solutions.

### General

* [Vulnerabilities](https://lana.report/vulnerability/)
* [Publications](https://lana.report/publication/)

### Lana Solutions

* [Lana Codes](https://lana.codes/)
### Wordfence

* [Bug Bounty Program](https://wordfence.com/refer/lanareport)

### Socials

* [Telegram](https://t.me/LanaReport)
* [Twitter](https://twitter.com/LanaReport)

Lana Report ¬© 2024 All Rights Reserved.

Made with üíô by [Lana Codes](https://lana.codes/)



=== Content from plugins.trac.wordpress.org_e53229f8_20250115_100926.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ‚ÜóÔ∏é](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ‚ÜóÔ∏é](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ‚ÜóÔ∏é](https://central.wordcamp.org/)
  + [Meetups ‚ÜóÔ∏é](https://www.meetup.com/pro/wordpress/)
  + [Job Board ‚ÜóÔ∏é](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ‚ÜóÔ∏é](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ‚ÜóÔ∏é](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D2912731%2540mobile-login-woocommerce%26old%3D2912731%2540mobile-login-woocommerce)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ‚Üê [Previous Change](/changeset/2898956/mobile-login-woocommerce "Changeset 2898956 for mobile-login-woocommerce")
* [Next Change](/changeset/2912733/mobile-login-woocommerce "Changeset 2912733 for mobile-login-woocommerce") ‚Üí

---

# Changeset [2912731](/changeset/2912731 "Show full changeset") for [mobile-login-woocommerce](/browser/mobile-login-woocommerce?rev=2912731 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
05/16/2023 03:08:09 AM
([20 months](/timeline?from=2023-05-16T03%3A08%3A09Z&precision=second "See timeline at 05/16/2023 03:08:09 AM") ago)

Author:
xootix
Message:

2.3 release

Location:
[mobile-login-woocommerce/trunk](/browser/mobile-login-woocommerce/trunk?rev=2912731)
Files:

3 edited

* [includes/class-xoo-ml-verification.php](/browser/mobile-login-woocommerce/trunk/includes/class-xoo-ml-verification.php?rev=2912731 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [readme.txt](/browser/mobile-login-woocommerce/trunk/readme.txt?rev=2912731 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [xoo-ml-main.php](/browser/mobile-login-woocommerce/trunk/xoo-ml-main.php?rev=2912731 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [mobile-login-woocommerce/trunk/includes/class-xoo-ml-verification.php](/changeset/2912731/mobile-login-woocommerce/trunk/includes/class-xoo-ml-verification.php "Show the changeset 2912731 restricted to mobile-login-woocommerce/trunk/includes/class-xoo-ml-verification.php")

  | [r2818479](/browser/mobile-login-woocommerce/trunk/includes/class-xoo-ml-verification.php?rev=2818479#L360 "Show revision 2818479 of this file in browser") | [r2912731](/browser/mobile-login-woocommerce/trunk/includes/class-xoo-ml-verification.php?rev=2912731#L360 "Show revision 2912731 of this file in browser") |  |
  | --- | --- | --- |
  | 360 | 360 | wp\_send\_json(array( |
  | 361 | 361 | 'otp\_sent'¬† => 1, |
  | 362 |  | 'otp'¬† ¬† ¬† ¬†=> $otp, |
  |  | 362 | //'otp'¬† ¬† ¬† ¬† ¬†=> $otp, |
  | 363 | 363 | 'phone'¬† ¬† ¬†=> $phone\_code.$phone\_no, |
  | 364 | 364 | 'phone\_no'¬† => $phone\_no, |
* ## [mobile-login-woocommerce/trunk/readme.txt](/changeset/2912731/mobile-login-woocommerce/trunk/readme.txt "Show the changeset 2912731 restricted to mobile-login-woocommerce/trunk/readme.txt")

  | [r2898956](/browser/mobile-login-woocommerce/trunk/readme.txt?rev=2898956#L6 "Show revision 2898956 of this file in browser") | [r2912731](/browser/mobile-login-woocommerce/trunk/readme.txt?rev=2912731#L6 "Show revision 2912731 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Requires at least: 3.0.1 |
  | 7 | 7 | Tested up to: 6.2 |
  | 8 |  | Stable tag: 2.~~2~~ |
  |  | 8 | Stable tag: 2.3 |
  | 9 | 9 | License: GPLv2 |
  | 10 | 10 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | [‚Ä¶](/browser/mobile-login-woocommerce/trunk/readme.txt?rev=2898956#L91) | [‚Ä¶](/browser/mobile-login-woocommerce/trunk/readme.txt?rev=2912731#L91) |  |
  | 91 | 91 | == Changelog == |
  | 92 | 92 |  |
  |  | 93 | = 2.3 = |
  |  | 94 | \* Fix - Security issues |
  |  | 95 |  |
  | 93 | 96 | = 2.2 = |
  | 94 | 97 | \* New - Added option to auto remove 0 |
* ## [mobile-login-woocommerce/trunk/xoo-ml-main.php](/changeset/2912731/mobile-login-woocommerce/trunk/xoo-ml-main.php "Show the changeset 2912731 restricted to mobile-login-woocommerce/trunk/xoo-ml-main.php")

  | [r2818479](/browser/mobile-login-woocommerce/trunk/xoo-ml-main.php?rev=2818479#L4 "Show revision 2818479 of this file in browser") | [r2912731](/browser/mobile-login-woocommerce/trunk/xoo-ml-main.php?rev=2912731#L4 "Show revision 2912731 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: http://xootix.com/mobile-login-woocommerce |
  | 5 | 5 | \* Author: XootiX |
  | 6 |  | \* Version: 2.~~2~~ |
  |  | 6 | \* Version: 2.3 |
  | 7 | 7 | \* Text Domain: mobile-login-woocommerce |
  | 8 | 8 | \* Domain Path: /languages |
  | [‚Ä¶](/browser/mobile-login-woocommerce/trunk/xoo-ml-main.php?rev=2818479#L21) | [‚Ä¶](/browser/mobile-login-woocommerce/trunk/xoo-ml-main.php?rev=2912731#L21) |  |
  | 21 | 21 | define("XOO\_ML\_URL",plugins\_url('',\_\_FILE\_\_)); // plugin url |
  | 22 | 22 | define("XOO\_ML\_PLUGIN\_BASENAME",plugin\_basename( \_\_FILE\_\_ )); |
  | 23 |  | define("XOO\_ML\_VERSION","2.~~2~~"); //Plugin version |
  |  | 23 | define("XOO\_ML\_VERSION","2.3"); //Plugin version |
  | 24 | 24 |  |
  | 25 | 25 | /\*\* |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2912731)
* [Zip Archive](?format=zip&new=2912731)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_a2fd4c8f_20250115_100923.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ‚ÜóÔ∏é](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ‚ÜóÔ∏é](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ‚ÜóÔ∏é](https://central.wordcamp.org/)
  + [Meetups ‚ÜóÔ∏é](https://www.meetup.com/pro/wordpress/)
  + [Job Board ‚ÜóÔ∏é](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ‚ÜóÔ∏é](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ‚ÜóÔ∏é](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fmobile-login-woocommerce%2Ftags%2F2.2%2Fincludes%2Fclass-xoo-ml-verification.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ‚Üê [Previous Revision](/browser/mobile-login-woocommerce/trunk/includes/class-xoo-ml-verification.php?rev=2616153 "Revision 2616153")
* [Next Revision](/browser/mobile-login-woocommerce/trunk/includes/class-xoo-ml-verification.php?rev=2912731 "Revision 2912731") ‚Üí
* [Blame](/browser/mobile-login-woocommerce/trunk/includes/class-xoo-ml-verification.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/mobile-login-woocommerce/tags/2.2/includes/class-xoo-ml-verification.php)

---

# [source:](/browser?order=name "Go to repository root") [mobile-login-woocommerce](/browser/mobile-login-woocommerce?order=name "View mobile-login-woocommerce")/[tags](/browser/mobile-login-woocommerce/tags?order=name "View tags")/[2.2](/browser/mobile-login-woocommerce/tags/2.2?order=name "View 2.2")/[includes](/browser/mobile-login-woocommerce/tags/2.2/includes?order=name "View includes")/[class-xoo-ml-verification.php](/browser/mobile-login-woocommerce/tags/2.2/includes/class-xoo-ml-verification.php?order=name "View class-xoo-ml-verification.php")

View diff against:

View revision:

| [Last change](/changeset/2818479/mobile-login-woocommerce/trunk/includes/class-xoo-ml-verification.php "View differences") on this file was [2818479](/changeset/2818479/ "View changeset 2818479"), checked in by xootix, [2 years ago](/timeline?from=2022-11-15T17%3A32%3A23Z&precision=second "See timeline at 11/15/2022 05:32:23 PM") |
| --- |
| 2.2 release |
| **File size:** 17.5 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | if¬†(¬†!¬†defined(¬†'ABSPATH'¬†)¬†)¬†{ |
| [4](#L4) | exit;¬†// Exit if accessed directly |
| [5](#L5) | } |
| [6](#L6) |  |
| [7](#L7) |  |
| [8](#L8) | class¬†Xoo\_Ml\_Phone\_Verification{ |
| [9](#L9) |  |
| [10](#L10) | public¬†static¬†$ip\_address; |
| [11](#L11) |  |
| [12](#L12) | public¬†function¬†\_\_construct(){ |
| [13](#L13) | $this->hooks(); |
| [14](#L14) | } |
| [15](#L15) |  |
| [16](#L16) | /\*\* |
| [17](#L17) | \* Hooks |
| [18](#L18) | \*/ |
| [19](#L19) | public¬†function¬†hooks(){ |
| [20](#L20) |  |
| [21](#L21) | add\_action(¬†'wp\_ajax\_xoo\_ml\_request\_otp',¬†array(¬†$this,¬†'request\_otp'¬†)¬†); |
| [22](#L22) | add\_action(¬†'wp\_ajax\_nopriv\_xoo\_ml\_request\_otp',¬†array(¬†$this,¬†'request\_otp'¬†)¬†); |
| [23](#L23) |  |
| [24](#L24) | add\_action(¬†'wp\_ajax\_xoo\_ml\_otp\_form\_submit',¬†array(¬†$this,¬†'process\_otp\_form'¬†)¬†); |
| [25](#L25) | add\_action(¬†'wp\_ajax\_nopriv\_xoo\_ml\_otp\_form\_submit',¬†array(¬†$this,¬†'process\_otp\_form'¬†)¬†); |
| [26](#L26) |  |
| [27](#L27) | add\_action(¬†'wp\_ajax\_xoo\_ml\_resend\_otp',¬†array(¬†$this,¬†'resendOTP'¬†)¬†); |
| [28](#L28) | add\_action(¬†'wp\_ajax\_nopriv\_xoo\_ml\_resend\_otp',¬†array(¬†$this,¬†'resendOTP'¬†)¬†); |
| [29](#L29) |  |
| [30](#L30) | add\_action(¬†'init',¬†array(¬†$this,¬†'request\_otp'¬†),¬†5¬†); |
| [31](#L31) |  |
| [32](#L32) | add\_action(¬†'user\_register',¬†array(¬†$this,¬†'handle\_phone\_on\_user\_registration'¬†)¬†); |
| [33](#L33) |  |
| [34](#L34) | add\_filter(¬†'authenticate',¬†array(¬†$this,¬†'process\_login'¬†),¬†5,¬†3¬†); |
| [35](#L35) |  |
| [36](#L36) | add\_action(¬†'xoo\_ml\_otp\_validation\_success',¬†array(¬†$this,¬†'wc\_myaccount\_update\_phone'¬†),¬†10,¬†2¬†); |
| [37](#L37) | add\_action(¬†'xoo\_ml\_otp\_validation\_success',¬†array(¬†$this,¬†'login\_user\_with\_otp'¬†),¬†10,¬†2¬†); |
| [38](#L38) |  |
| [39](#L39) |  |
| [40](#L40) | add\_action(¬†'wp\_ajax\_nopriv\_xoo\_ml\_login\_with\_otp',¬†array(¬†$this,¬†'process\_login\_with\_otp\_form'¬†)¬†); |
| [41](#L41) |  |
| [42](#L42) | } |
| [43](#L43) |  |
| [44](#L44) |  |
| [45](#L45) | /\*\* |
| [46](#L46) | \* Update phone from woocommerce my account page |
| [47](#L47) | \* |
| [48](#L48) | \* @param¬† ¬† ¬† ¬†string¬† ¬† ¬† ¬† ¬† $parent\_form\_type¬† ¬† ¬† ¬†Parent form type - update in this case |
| [49](#L49) | \* @param¬† ¬† ¬† ¬†array¬† ¬† ¬† ¬† ¬† ¬†$otp\_data¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†User phone otp data |
| [50](#L50) | \*/ |
| [51](#L51) |  |
| [52](#L52) | public¬†function¬†wc\_myaccount\_update\_phone(¬†$parent\_form\_type,¬†$otp\_data¬†){ |
| [53](#L53) |  |
| [54](#L54) | if(¬†$parent\_form\_type¬†===¬†'update\_user'¬†){ |
| [55](#L55) | $user\_id¬†=¬†get\_current\_user\_id(); |
| [56](#L56) | update\_user\_meta(¬†$user\_id,¬†'xoo\_ml\_phone\_no',¬†sanitize\_text\_field(¬†$otp\_data['phone\_no']¬†)¬†); |
| [57](#L57) | update\_user\_meta(¬†$user\_id,¬†'xoo\_ml\_phone\_code',¬†sanitize\_text\_field(¬†$otp\_data['phone\_code']¬†)¬†); |
| [58](#L58) | update\_user\_meta( |
| [59](#L59) | $user\_id, |
| [60](#L60) | 'xoo\_ml\_phone\_display', |
| [61](#L61) | sanitize\_text\_field(¬†$otp\_data['phone\_code']¬†)¬†.¬†sanitize\_text\_field(¬†$otp\_data['phone\_no']¬†) |
| [62](#L62) | ); |
| [63](#L63) | } |
| [64](#L64) |  |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | /\*\* |
| [68](#L68) | \* Login user with OTP after OTP Verification |
| [69](#L69) | \* |
| [70](#L70) | \* @param¬† ¬† ¬† ¬†string¬† ¬† ¬† ¬† ¬† $parent\_form\_type¬† ¬† ¬† ¬†Parent form type |
| [71](#L71) | \* @param¬† ¬† ¬† ¬†array¬† ¬† ¬† ¬† ¬† ¬†$otp\_data¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†User phone otp data |
| [72](#L72) | \*/ |
| [73](#L73) |  |
| [74](#L74) | public¬†function¬†login\_user\_with\_otp(¬†$parent\_form\_type,¬†$otp\_data¬†){ |
| [75](#L75) |  |
| [76](#L76) | if(¬†$parent\_form\_type¬†===¬†'login\_with\_otp'¬†){ |
| [77](#L77) |  |
| [78](#L78) | $user¬†=¬†xoo\_ml\_get\_user\_by\_phone(¬†$otp\_data['phone\_no'],¬†$otp\_data['phone\_code']¬†); |
| [79](#L79) |  |
| [80](#L80) | if(¬†$user¬†){ |
| [81](#L81) | //Logging user |
| [82](#L82) | wp\_clear\_auth\_cookie(); |
| [83](#L83) | wp\_set\_current\_user¬†(¬†$user->ID¬†); |
| [84](#L84) | wp\_set\_auth\_cookie¬† (¬†$user->ID¬†); |
| [85](#L85) |  |
| [86](#L86) | $redirect¬†=¬†''; |
| [87](#L87) |  |
| [88](#L88) | if¬†(¬†isset(¬†$\_POST['parentFormData'][¬†'redirect'¬†]¬†)¬†)¬†{ |
| [89](#L89) | $redirect¬†=¬†sanitize\_url(¬†$\_POST['parentFormData'][¬†'redirect'¬†]¬†); |
| [90](#L90) | } |
| [91](#L91) |  |
| [92](#L92) | $redirect¬†=¬†wp\_validate\_redirect(¬†apply\_filters(¬†'xoo\_ml\_login\_with\_otp\_redirect',¬†sanitize\_url(¬†$redirect¬†)¬†)¬†); |
| [93](#L93) |  |
| [94](#L94) |  |
| [95](#L95) |  |
| [96](#L96) | wp\_send\_json(array( |
| [97](#L97) | 'redirect'¬† ¬† ¬† =>¬†$redirect, |
| [98](#L98) | 'error'¬† ¬† ¬† ¬† ¬†=>¬†0, |
| [99](#L99) | 'notice'¬† ¬† ¬† ¬† =>¬†xoo\_ml\_add\_notice(¬†\_\_(¬†'Login successful',¬†'mobile-login-woocommerce'¬†),¬†'success'¬†) |
| [100](#L100) | )); |
| [101](#L101) | } |
| [102](#L102) | } |
| [103](#L103) |  |
| [104](#L104) | } |
| [105](#L105) |  |
| [106](#L106) | /\*\* |
| [107](#L107) | \* Login with username/Phone and password |
| [108](#L108) | \* |
| [109](#L109) | \* @param¬† ¬† ¬† ¬†object¬† ¬† ¬† ¬† ¬† $user¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†User object if exists |
| [110](#L110) | \* @param¬† ¬† ¬† ¬†string¬† ¬† ¬† ¬† ¬† $username¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†Username/Phone |
| [111](#L111) | \* @param¬† ¬† ¬† ¬†string¬† ¬† ¬† ¬† ¬† $password¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†Password |
| [112](#L112) | \*/ |
| [113](#L113) | public¬†function¬†process\_login(¬†$user,¬†$username,¬†$password¬†){ |
| [114](#L114) |  |
| [115](#L115) | $user\_to\_login¬†=¬†null; |
| [116](#L116) |  |
| [117](#L117) | //Check if username provided is a phone number |
| [118](#L118) | $phone\_user¬†=¬†xoo\_ml\_get\_user\_by\_phone(¬†$username¬†); |
| [119](#L119) |  |
| [120](#L120) | if(¬†!$phone\_user¬†){ |
| [121](#L121) | return¬†$user; |
| [122](#L122) | } |
| [123](#L123) |  |
| [124](#L124) | //if password validates |
| [125](#L125) | if¬†(¬†wp\_check\_password(¬†$password,¬†$phone\_user->user\_pass,¬†$phone\_user->ID¬†)¬†){ |
| [126](#L126) | return¬†$phone\_user; |
| [127](#L127) | } |
| [128](#L128) |  |
| [129](#L129) | return¬†$user; |
| [130](#L130) |  |
| [131](#L131) | } |
| [132](#L132) |  |
| [133](#L133) | /\*\* |
| [134](#L134) | \* Forms with phone input field |
| [135](#L135) | \* |
| [136](#L136) | \* @param¬† ¬† ¬† ¬†string¬† ¬† ¬† ¬† ¬† $form\_type¬† ¬† ¬† ¬† ¬† ¬† ¬† Form type |
| [137](#L137) | \*/ |
| [138](#L138) | public¬†static¬†function¬†is\_a\_phone\_form(){ |
| [139](#L139) |  |
| [140](#L140) | $settings¬†=¬†xoo\_ml\_helper()->get\_phone\_option(); |
| [141](#L141) |  |
| [142](#L142) | $forms¬†=¬†array( |
| [143](#L143) | array( |
| [144](#L144) | 'key'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†=>¬†'xoo-ml-login-with-otp', |
| [145](#L145) | 'value'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†=>¬†1, |
| [146](#L146) | 'form'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† =>¬†'login\_with\_otp', |
| [147](#L147) | 'required'¬† ¬† ¬† ¬† ¬† ¬† ¬† =>¬†'yes', |
| [148](#L148) | 'cc\_required'¬† ¬†=>¬†$settings['l-enable-cc-field']¬†===¬†'yes'¬†?¬†'yes'¬†:¬†'no', |
| [149](#L149) | ) |
| [150](#L150) | ); |
| [151](#L151) |  |
| [152](#L152) | if(¬†class\_exists(¬†'woocommerce'¬†)¬†&&¬†$settings['r-enable-phone']¬†===¬†"yes"¬† ){ |
| [153](#L153) | $forms[]¬†=¬†array( |
| [154](#L154) | 'key'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†=>¬†'woocommerce-register-nonce', |
| [155](#L155) | 'value'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†=>¬†'', |
| [156](#L156) | 'form'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† =>¬†'register\_user', |
| [157](#L157) | 'required'¬† ¬† ¬† ¬† ¬† ¬† ¬† =>¬†$settings['r-phone-field']¬†===¬†'required'¬†?¬†'yes'¬†:¬†'no', |
| [158](#L158) | 'cc\_required'¬† ¬†=>¬†$settings['r-enable-cc-field']¬†===¬†'yes'¬†?¬†'yes'¬†:¬†'no', |
| [159](#L159) | ); |
| [160](#L160) |  |
| [161](#L161) | $forms[]¬†=¬†array( |
| [162](#L162) | 'key'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†=>¬†'save-account-details-nonce', |
| [163](#L163) | 'value'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†=>¬†'', |
| [164](#L164) | 'form'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† =>¬†'update\_user', |
| [165](#L165) | 'required'¬† ¬† ¬† ¬† ¬† ¬† ¬† =>¬†$settings['r-phone-field']¬†===¬†'required'¬†?¬†'yes'¬†:¬†'no', |
| [166](#L166) | 'cc\_required'¬† ¬†=>¬†$settings['r-enable-cc-field']¬†===¬†'yes'¬†?¬†'yes'¬†:¬†'no', |
| [167](#L167) | ); |
| [168](#L168) |  |
| [169](#L169) |  |
| [170](#L170) | } |
| [171](#L171) |  |
| [172](#L172) | $forms¬†=¬†apply\_filters(¬†'xoo\_ml\_get\_phone\_forms',¬†$forms¬†); |
| [173](#L173) |  |
| [174](#L174) | foreach(¬†$forms¬†as¬†$form¬†){ |
| [175](#L175) | if(¬†isset(¬†$\_POST[¬†$form['key']¬†]¬†)¬†&&¬†(¬†!$form[¬†'value'¬†]¬†||¬†$\_POST[¬†$form['key']¬†]¬†==¬†$form['value']¬†)¬†){ |
| [176](#L176) | return¬†$form; |
| [177](#L177) | break; |
| [178](#L178) | } |
| [179](#L179) | } |
| [180](#L180) |  |
| [181](#L181) | } |
| [182](#L182) |  |
| [183](#L183) |  |
| [184](#L184) | /\*\* |
| [185](#L185) | \* Save phone fields on user registration |
| [186](#L186) | \* |
| [187](#L187) | \* @param¬† ¬† ¬† ¬†int¬† ¬† ¬†$user\_id¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† User ID |
| [188](#L188) | \*/ |
| [189](#L189) | public¬†function¬†handle\_phone\_on\_user\_registration(¬†$user\_id¬†){ |
| [190](#L190) |  |
| [191](#L191) | //Proceed only if user is registered with a phone number |
| [192](#L192) | if(¬†!isset(¬†$\_POST['xoo-ml-reg-phone']¬†)¬†||¬†!isset(¬†$\_POST['xoo-ml-form-token']¬†)¬†){ |
| [193](#L193) | return; |
| [194](#L194) | } |
| [195](#L195) |  |
| [196](#L196) | $phone\_otp\_data¬†=¬†Xoo\_Ml\_Otp\_Handler::get\_otp\_data(); |
| [197](#L197) | if(¬†!$phone\_otp\_data['verified']¬†)¬†return; |
| [198](#L198) |  |
| [199](#L199) | $phone\_code¬†=¬†sanitize\_text\_field(¬†$phone\_otp\_data['phone\_code']¬†); |
| [200](#L200) | $phone¬† ¬† ¬† ¬† ¬† =¬†sanitize\_text\_field(¬†$phone\_otp\_data['phone\_no']¬†); |
| [201](#L201) |  |
| [202](#L202) | update\_user\_meta(¬†$user\_id,¬†'xoo\_ml\_phone\_no',¬†$phone¬†); |
| [203](#L203) | update\_user\_meta(¬†$user\_id,¬†'xoo\_ml\_phone\_code',¬†$phone\_code¬†); |
| [204](#L204) | update\_user\_meta(¬†$user\_id,¬†'xoo\_ml\_phone\_display',¬†$phone\_code.$phone¬†); |
| [205](#L205) |  |
| [206](#L206) | if(¬†class\_exists(¬†'woocommerce'¬†)¬†){ |
| [207](#L207) | update\_user\_meta(¬†$user\_id,¬†'billing\_phone',¬†$phone\_code.$phone¬†); |
| [208](#L208) | } |
| [209](#L209) |  |
| [210](#L210) |  |
| [211](#L211) | } |
| [212](#L212) |  |
| [213](#L213) | /\*\* |
| [214](#L214) | \* Resend OTP |
| [215](#L215) | \* |
| [216](#L216) | \*/ |
| [217](#L217) | public¬†function¬†resendOTP(){ |
| [218](#L218) |  |
| [219](#L219) | try¬†{ |
| [220](#L220) |  |
| [221](#L221) | $SMSSent¬†=¬†Xoo\_Ml\_Otp\_Handler::resendOTPSMS(); |
| [222](#L222) |  |
| [223](#L223) | if(¬†is\_wp\_error(¬†$SMSSent¬†)¬†){ |
| [224](#L224) | throw¬†new¬†Xoo\_Exception(¬†$SMSSent¬†); |
| [225](#L225) | } |
| [226](#L226) |  |
| [227](#L227) | $data¬†=¬†Xoo\_Ml\_Otp\_Handler::get\_otp\_data(); |
| [228](#L228) |  |
| [229](#L229) | wp\_send\_json(array( |
| [230](#L230) | 'otp\_sent'¬† ¬† ¬† =>¬†1, |
| [231](#L231) | 'phone'¬† ¬† ¬† ¬† ¬†=>¬†$data['phone\_code'].$data['phone\_no'], |
| [232](#L232) | 'phone\_no'¬† ¬† ¬† =>¬†$data['phone\_no'], |
| [233](#L233) | 'phone\_code'=>¬†$data['phone\_code'], |
| [234](#L234) | 'error'¬† ¬† ¬† ¬† ¬†=>¬†0, |
| [235](#L235) | 'notice'¬† ¬† ¬† ¬† =>¬†xoo\_ml\_add\_notice(¬†\_\_(¬†'OTP Resent',¬†'mobile-login-woocommerce'¬†),¬†'success'¬†) |
| [236](#L236) | )); |
| [237](#L237) |  |
| [238](#L238) | }¬†catch¬†(Exception¬†$e)¬†{ |
| [239](#L239) |  |
| [240](#L240) | do\_action(¬†'xoo\_ml\_otp\_resend\_failed',¬†Xoo\_Ml\_Otp\_Handler::get\_otp\_data(),¬†$e¬†); |
| [241](#L241) |  |
| [242](#L242) | wp\_send\_json(array( |
| [243](#L243) | 'error'¬† ¬† ¬† ¬† ¬† =>¬†1, |
| [244](#L244) | 'error\_code'¬†=>¬†$e->getWpErrorCode(), |
| [245](#L245) | 'notice'¬† ¬† ¬† ¬† ¬†=>¬†xoo\_ml\_add\_notice(¬†$e->getMessage(),¬†'error'¬†) |
| [246](#L246) | )); |
| [247](#L247) | } |
| [248](#L248) |  |
| [249](#L249) |  |
| [250](#L250) | } |
| [251](#L251) |  |
| [252](#L252) | /\*\* |
| [253](#L253) | \* Process form with phone input field |
| [254](#L254) | \* |
| [255](#L255) | \*/ |
| [256](#L256) | public¬†function¬†request\_otp(){ |
| [257](#L257) |  |
| [258](#L258) | $phoneFormData¬†=¬†self::is\_a\_phone\_form(); |
| [259](#L259) |  |
| [260](#L260) | if(¬†!$phoneFormData¬†)¬†return; |
| [261](#L261) |  |
| [262](#L262) | try¬†{ |
| [263](#L263) |  |
| [264](#L264) | //If phone field is empty |
| [265](#L265) | if(¬†(¬†!isset(¬†$\_POST['xoo-ml-reg-phone']¬†)¬†||¬†!trim(¬†$\_POST['xoo-ml-reg-phone']¬†)¬† ||¬†!isset(¬†$\_POST['xoo-ml-form-token']¬†)¬†)¬†&&¬†$phoneFormData['required']¬†===¬†'yes'¬†){ |
| [266](#L266) | throw¬†new¬†Xoo\_Exception(¬†\_\_(¬†'Phone field cannot be empty',¬†'mobile-login-woocommerce'¬†)¬†); |
| [267](#L267) | } |
| [268](#L268) |  |
| [269](#L269) | //Check for phone code |
| [270](#L270) | if(¬†(¬†!isset(¬†$\_POST['xoo-ml-reg-phone-cc']¬†)¬†||¬†!$\_POST['xoo-ml-reg-phone-cc']¬†)¬†&&¬†$phoneFormData['cc\_required']¬†===¬†'yes'¬†){ |
| [271](#L271) | throw¬†new¬†Xoo\_Exception(¬†\_\_(¬†'Please select country code',¬†'mobile-login-woocommerce'¬†)¬†); |
| [272](#L272) | } |
| [273](#L273) |  |
| [274](#L274) |  |
| [275](#L275) | $phone\_no¬† ¬† ¬† ¬†=¬†isset(¬†$\_POST['xoo-ml-reg-phone']¬†)¬†?¬†sanitize\_text\_field(¬†trim(¬†$\_POST['xoo-ml-reg-phone']¬†)¬†)¬†:¬†''; |
| [276](#L276) | $phone\_code¬†=¬†isset(¬†$\_POST['xoo-ml-reg-phone-cc']¬†)¬†?¬†sanitize\_text\_field(¬†$\_POST['xoo-ml-reg-phone-cc']¬†):¬†''; |
| [277](#L277) | $form\_type¬† ¬† ¬† =¬†isset(¬†$\_POST['xoo-ml-form-type']¬†)¬†?¬†sanitize\_text\_field(¬†$\_POST['xoo-ml-form-type']¬†)¬†:¬†''; |
| [278](#L278) |  |
| [279](#L279) |  |
| [280](#L280) | if(¬†!$phone\_code¬†&&¬†$form\_type¬†!==¬†'login\_with\_otp'¬†){ |
| [281](#L281) | $phone\_code¬†=¬†xoo\_ml\_helper()->get\_phone\_option('r-default-country-code-type')¬†===¬†'geolocation'¬†&&¬†Xoo\_Ml\_Geolocation::get\_phone\_code()¬†?¬†Xoo\_Ml\_Geolocation::get\_phone\_code()¬†:¬†xoo\_ml\_helper()->get\_phone\_option('r-default-country-code'); |
| [282](#L282) | } |
| [283](#L283) |  |
| [284](#L284) | $phone\_otp\_data¬†=¬†Xoo\_Ml\_Otp\_Handler::get\_otp\_data(); |
| [285](#L285) |  |
| [286](#L286) | if(¬†!is\_array(¬†$phone\_otp\_data¬†)¬†){ |
| [287](#L287) | $phone\_otp\_data¬†=¬†array(); |
| [288](#L288) | } |
| [289](#L289) |  |
| [290](#L290) | $form\_validation¬†=¬†apply\_filters(¬†'xoo\_ml\_phone\_form\_validation',¬†new¬†WP\_Error(),¬†$form\_type,¬†$phone\_code,¬†$phone\_no,¬†$phone\_otp\_data¬†); |
| [291](#L291) |  |
| [292](#L292) | if(¬†$form\_validation->get\_error\_code()¬†){ |
| [293](#L293) | throw¬†new¬†Xoo\_Exception(¬†$form\_validation->get\_error\_message()¬†); |
| [294](#L294) | } |
| [295](#L295) |  |
| [296](#L296) | if(¬†!$phone\_no¬†){ |
| [297](#L297) | return;¬†//Exit if phone number is optional and not provided |
| [298](#L298) | } |
| [299](#L299) |  |
| [300](#L300) |  |
| [301](#L301) | $user¬†=¬†xoo\_ml\_get\_user\_by\_phone(¬†$phone\_no,¬†$phone\_code¬†); |
| [302](#L302) |  |
| [303](#L303) | if(¬†$user¬†){ |
| [304](#L304) |  |
| [305](#L305) | //Update form |
| [306](#L306) | if(¬†$phoneFormData['form']¬†===¬†'update\_user'¬†){ |
| [307](#L307) | if(¬†$user->ID¬†===¬†get\_current\_user\_id()¬†){ |
| [308](#L308) | return;¬†// exit as number not changed |
| [309](#L309) | } |
| [310](#L310) | else{ |
| [311](#L311) | throw¬†new¬†Xoo\_Exception(¬†\_\_(¬†'Sorry, this phone number is already in use.',¬†'mobile-login-woocommerce'¬†)¬†); |
| [312](#L312) | } |
| [313](#L313) | } |
| [314](#L314) |  |
| [315](#L315) | //Register form |
| [316](#L316) | if(¬†$phoneFormData['form']¬†===¬†'register\_user'¬†){ |
| [317](#L317) | $loginNotice¬† =¬† \_\_(¬†'Sorry, this phone number is already in use.',¬†'mobile-login-woocommerce'¬†); |
| [318](#L318) | $loginNotice¬†.=¬†defined(¬†'XOO\_EL\_VERSION'¬†)¬†?¬†'<span class="xoo-el-login-tgr">'.\_\_(¬†'Please login',¬†'mobile-login-woocommerce'¬†).'</span>'¬†:¬†\_\_(¬†'Please login',¬†'mobile-login-woocommerce'¬†); |
| [319](#L319) | throw¬†new¬†Xoo\_Exception(¬†$loginNotice¬†); |
| [320](#L320) | } |
| [321](#L321) |  |
| [322](#L322) | } |
| [323](#L323) |  |
| [324](#L324) |  |
| [325](#L325) | if(¬†$phoneFormData['form']¬†===¬†'login\_with\_otp'¬†){ |
| [326](#L326) | if(¬†!$user¬†){ |
| [327](#L327) | throw¬†new¬†Xoo\_Exception(¬†\_\_(¬†'We cannot find an account with that mobile number',¬†'mobile-login-woocommerce'¬†)¬†); |
| [328](#L328) | } |
| [329](#L329) | else{ |
| [330](#L330) | $phone\_code¬†=¬†get\_user\_meta(¬†$user->ID,¬†'xoo\_ml\_phone\_code',¬†true¬†); |
| [331](#L331) | $phone\_no¬† ¬† ¬† ¬†=¬†get\_user\_meta(¬†$user->ID,¬†'xoo\_ml\_phone\_no',¬†true¬†); |
| [332](#L332) | } |
| [333](#L333) | } |
| [334](#L334) |  |
| [335](#L335) |  |
| [336](#L336) | //If phone has been verified, return |
| [337](#L337) | if(¬†$phone\_no¬†&&¬†isset(¬†$phone\_otp\_data[¬†'phone\_no'¬†]¬†)¬†&&¬†$phone\_otp\_data['phone\_no']¬†===¬†$phone\_no¬†&&¬†isset(¬†$phone\_otp\_data[¬†'phone\_code'¬†]¬†)¬†&&¬†$phone\_otp\_data['phone\_code']¬†===¬†$phone\_code¬†&&¬†isset(¬†$phone\_otp\_data['verified']¬†)¬†&&¬†$phone\_otp\_data['verified']¬†&&¬†isset(¬†$phone\_otp\_data['form\_token']¬†)¬†&&¬†$phone\_otp\_data['form\_token']¬†===¬†$\_POST['xoo-ml-form-token']¬† ){ |
| [338](#L338) | return; |
| [339](#L339) | } |
| [340](#L340) |  |
| [341](#L341) |  |
| [342](#L342) | //Send OTP SMS only if its ajax call. |
| [343](#L343) | if(¬†!wp\_doing\_ajax()¬†){ |
| [344](#L344) | throw¬†new¬†Xoo\_Exception(¬†\_\_(¬†'Please verify your mobile number',¬†'mobile-login-woocommerce'¬†)¬†); |
| [345](#L345) | }; |
| [346](#L346) |  |
| [347](#L347) |  |
| [348](#L348) | if(¬†!$phone\_no¬†||¬†!$phone\_code¬†){ |
| [349](#L349) | return; |
| [350](#L350) | } |
| [351](#L351) |  |
| [352](#L352) | $otp¬†=¬†Xoo\_Ml\_Otp\_Handler::sendOTPSMS(¬†$phone\_code,¬†$phone\_no¬†); |
| [353](#L353) |  |
| [354](#L354) | if(¬†is\_wp\_error(¬†$otp¬†)¬†){ |
| [355](#L355) | throw¬†new¬†Xoo\_Exception(¬†$otp->get\_error\_message()¬†); |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | do\_action(¬†'xoo\_ml\_request\_otp\_sent',¬†$phone\_code,¬†$phone\_no,¬†$phone\_otp\_data¬†); |
| [359](#L359) |  |
| [360](#L360) | wp\_send\_json(array( |
| [361](#L361) | 'otp\_sent'¬† ¬† ¬† =>¬†1, |
| [362](#L362) | 'otp'¬† ¬† ¬† ¬† ¬† ¬†=>¬†$otp, |
| [363](#L363) | 'phone'¬† ¬† ¬† ¬† ¬†=>¬†$phone\_code.$phone\_no, |
| [364](#L364) | 'phone\_no'¬† ¬† ¬† =>¬†$phone\_no, |
| [365](#L365) | 'phone\_code'=>¬†$phone\_code, |
| [366](#L366) | 'error'¬† ¬† ¬† ¬† ¬†=>¬†0, |
| [367](#L367) | 'otp\_txt'¬† ¬† ¬† ¬†=>¬†sprintf(¬†\_\_(¬†'Please enter the OTP sent to <br> %s',¬†'mobile-login-woocommerce'¬†),¬†$phone\_code.$phone\_no¬†), |
| [368](#L368) | )); |
| [369](#L369) |  |
| [370](#L370) |  |
| [371](#L371) | }¬†catch¬†(Exception¬†$e)¬†{ |
| [372](#L372) |  |
| [373](#L373) | $notice¬†=¬†apply\_filters(¬†'xoo\_ml\_request\_otp\_failed\_notice',¬†$e->getMessage(),¬†$e¬†); |
| [374](#L374) |  |
| [375](#L375) | do\_action(¬†'xoo\_ml\_request\_otp\_failed',¬†$e¬†); |
| [376](#L376) |  |
| [377](#L377) | if(¬†wp\_doing\_ajax()¬†){ |
| [378](#L378) | wp\_send\_json(array( |
| [379](#L379) | 'error'¬† ¬† ¬† ¬† ¬†=>¬†1, |
| [380](#L380) | 'notice'¬† ¬† ¬† ¬† =>¬†xoo\_ml\_add\_notice(¬†$notice,¬†'error'¬†) |
| [381](#L381) | )); |
| [382](#L382) | } |
| [383](#L383) | else{ |
| [384](#L384) | if(¬†class\_exists('woocommerce')¬†){ |
| [385](#L385) | wc\_add\_notice(¬†$notice,¬†'error'¬†); |
| [386](#L386) | wp\_safe\_redirect(¬†$\_SERVER['HTTP\_REFERER']¬†); |
| [387](#L387) | exit; |
| [388](#L388) | } |
| [389](#L389) |  |
| [390](#L390) | wp\_die(¬†$notice¬†); |
| [391](#L391) | } |
| [392](#L392) |  |
| [393](#L393) |  |
| [394](#L394) | } |
| [395](#L395) |  |
| [396](#L396) |  |
| [397](#L397) | } |
| [398](#L398) |  |
| [399](#L399) | public¬†function¬†process\_otp\_form(){ |
| [400](#L400) |  |
| [401](#L401) | try¬†{ |
| [402](#L402) |  |
| [403](#L403) | if(¬†isset(¬†$\_POST['otp']¬†)¬†){ |
| [404](#L404) |  |
| [405](#L405) | $phone\_otp\_data¬†=¬†Xoo\_Ml\_Otp\_Handler::get\_otp\_data(); |
| [406](#L406) |  |
| [407](#L407) | $notice¬†=¬†false; |
| [408](#L408) |  |
| [409](#L409) | if(¬†!is\_array(¬†$phone\_otp\_data¬†)¬†){ |
| [410](#L410) | $phone\_otp\_data¬†=¬†array(); |
| [411](#L411) | } |
| [412](#L412) |  |
| [413](#L413) | //Check for incorrect limit |
| [414](#L414) | if(¬†isset(¬†$phone\_otp\_data['incorrect']¬†)¬†&&¬†$phone\_otp\_data['incorrect']¬†>¬†xoo\_ml\_helper()->get\_phone\_option('otp-incorrect-limit')¬†){ |
| [415](#L415) | throw¬†new¬†Xoo\_Exception(¬†\_\_(¬†'Number of tries exceeded, Please try again in few minutes',¬†'mobile-login-woocommerce'¬†)¬†); |
| [416](#L416) | } |
| [417](#L417) |  |
| [418](#L418) | //Handle firebase verification |
| [419](#L419) | if(¬†xoo\_ml\_helper()->get\_phone\_option('m-operator')¬†===¬†'firebase'¬†){ |
| [420](#L420) |  |
| [421](#L421) |  |
| [422](#L422) |  |
| [423](#L423) | if(¬†isset(¬†$\_POST['firebase\_error']¬†)¬†){ |
| [424](#L424) | $fb\_error¬†=¬†json\_decode¬†(¬†stripslashes(¬†$\_POST['firebase\_error']¬†)¬†); |
| [425](#L425) |  |
| [426](#L426) | if(¬†$fb\_error->code¬†===¬†'auth/code-expired'¬†){ |
| [427](#L427) | throw¬†new¬†Xoo\_Exception(¬†\_\_(¬†'OTP Expired',¬†'mobile-login-woocommerce'¬†)¬†); |
| [428](#L428) | } |
| [429](#L429) | elseif(¬†$fb\_error->code¬†===¬†'auth/invalid-verification-code'¬†){ |
| [430](#L430) | //do nothing |
| [431](#L431) | } |
| [432](#L432) | else{ |
| [433](#L433) | $notice¬†=¬†esc\_html(¬†$fb\_error->message¬†); |
| [434](#L434) | } |
| [435](#L435) | } |
| [436](#L436) |  |
| [437](#L437) | if(¬†isset(¬†$\_POST['firebase\_idToken']¬†)¬†){ |
| [438](#L438) |  |
| [439](#L439) | $args¬†=¬†array( |
| [440](#L440) | 'method'¬† ¬† ¬† =>¬†'POST', |
| [441](#L441) | 'body'¬† ¬† ¬† ¬† =>¬†array( |
| [442](#L442) | 'idToken'¬†=>¬†sanitize\_text\_field(¬†$\_POST['firebase\_idToken']¬†), |
| [443](#L443) | ) |
| [444](#L444) | ); |
| [445](#L445) |  |
| [446](#L446) | //Validate user token |
| [447](#L447) | $validate\_raw¬† ¬†=¬†wp\_remote\_post(¬†"https://identitytoolkit.googleapis.com/v1/accounts:lookup?key=".xoo\_ml\_helper()->get\_service\_option('fb-api-key'),¬†$args¬†); |
| [448](#L448) | $fb\_body¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† =¬†json\_decode(¬†$validate\_raw['body']¬†); |
| [449](#L449) |  |
| [450](#L450) | if(¬†is\_object(¬†$fb\_body¬†)¬†&&¬†!empty(¬†$fb\_body->users¬†)¬†){ |
| [451](#L451) | if(¬†$fb\_body->users[0]->phoneNumber¬†===¬†(¬†$phone\_otp\_data['phone\_code'].$phone\_otp\_data['phone\_no']¬†)¬†||¬†$fb\_body->users[0]->phoneNumber¬†===¬†(¬†$phone\_otp\_data['phone\_code'].ltrim(¬†$phone\_otp\_data['phone\_no'],¬†'0'¬†)¬†)¬†){ |
| [452](#L452) | $firebaseVerified¬†=¬†true; |
| [453](#L453) | } |
| [454](#L454) | } |
| [455](#L455) |  |
| [456](#L456) | } |
| [457](#L457) | } |
| [458](#L458) |  |
| [459](#L459) | if(¬†isset(¬†$firebaseVerified¬†)¬†||¬†(¬†isset(¬†$phone\_otp\_data['otp']¬†)¬†&&¬†(¬†$phone\_otp\_data['otp']¬†===¬†(int)¬†$\_POST['otp']¬†)¬†)¬†){ |
| [460](#L460) |  |
| [461](#L461) | if(¬†isset(¬†$phone\_otp\_data['expiry']¬†)¬†&&¬†strtotime('now')¬†>¬†(int)¬†$phone\_otp\_data['expiry']¬†){ |
| [462](#L462) | throw¬†new¬†Xoo\_Exception(¬†\_\_(¬†'OTP Expired',¬†'mobile-login-woocommerce'¬†)¬†); |
| [463](#L463) | } |
| [464](#L464) |  |
| [465](#L465) | Xoo\_Ml\_Otp\_Handler::set\_otp\_data(¬†array( |
| [466](#L466) | 'verified'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† =>¬†true, |
| [467](#L467) | 'form\_token'¬† ¬† ¬† ¬† ¬† ¬† =>¬†sanitize\_text\_field(¬†$\_POST['token']¬†), |
| [468](#L468) | 'incorrect'¬† ¬† ¬† ¬† ¬† ¬† ¬†=>¬†0, |
| [469](#L469) | 'sent\_items'¬† ¬† ¬† ¬† ¬† ¬† =>¬†0, |
| [470](#L470) | 'expiry'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† =>¬†'', |
| [471](#L471) | 'created'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†=>¬†'', |
| [472](#L472) | )¬†); |
| [473](#L473) |  |
| [474](#L474) | $parent\_form\_type¬†=¬†isset(¬†$\_POST['parentFormData']¬†)¬†&&¬†isset(¬†$\_POST['parentFormData']['xoo-ml-form-type']¬†)¬†?¬†sanitize\_text\_field(¬†$\_POST['parentFormData']['xoo-ml-form-type']¬†)¬†:¬†''; |
| [475](#L475) |  |
| [476](#L476) | //Hook functions on OTP verification |
| [477](#L477) | do\_action(¬†'xoo\_ml\_otp\_validation\_success',¬†$parent\_form\_type,¬†Xoo\_Ml\_Otp\_Handler::get\_otp\_data()¬†); |
| [478](#L478) |  |
| [479](#L479) | $notice¬†=¬†$parent\_form\_type¬†===¬†'update\_user'¬†?¬†\_\_(¬†'Your number has been successfully updated',¬†'mobile-login-woocommerce'¬†)¬†:¬†\_\_(¬†'Thank you for verifying your number.',¬†'mobile-login-woocommerce'¬†); |
| [480](#L480) |  |
| [481](#L481) | $notice¬†=¬†apply\_filters(¬†'xoo\_ml\_otp\_validation\_success\_notice',¬†$notice,¬†$parent\_form\_type,¬†Xoo\_Ml\_Otp\_Handler::get\_otp\_data()¬†); |
| [482](#L482) |  |
| [483](#L483) | wp\_send\_json(array( |
| [484](#L484) | 'error'¬† ¬† ¬† ¬† ¬†=>¬†0, |
| [485](#L485) | 'notice'¬† ¬† ¬† ¬† =>¬†xoo\_ml\_add\_notice(¬†$notice,¬†'success'¬†) |
| [486](#L486) | )); |
| [487](#L487) |  |
| [488](#L488) | } |
| [489](#L489) |  |
| [490](#L490) | $incorrect¬†=¬†isset(¬†$phone\_otp\_data['incorrect']¬†)¬†?¬†$phone\_otp\_data['incorrect']¬†+¬†1¬†:¬†1; |
| [491](#L491) |  |
| [492](#L492) | Xoo\_Ml\_Otp\_Handler::set\_otp\_data(¬†'incorrect',¬†$incorrect¬†); |
| [493](#L493) |  |
| [494](#L494) | } |
| [495](#L495) |  |
| [496](#L496) | throw¬†new¬†Xoo\_Exception(¬†$notice¬†?¬†$notice¬†:¬†\_\_(¬†'Invalid OTP',¬†'mobile-login-woocommerce'¬†)¬†); |
| [497](#L497) |  |
| [498](#L498) | }¬†catch¬†(Exception¬†$e)¬†{ |
| [499](#L499) |  |
| [500](#L500) | $notice¬†=¬†apply\_filters(¬†'xoo\_ml\_otp\_errors',¬†$e->getMessage()¬†); |
| [501](#L501) |  |
| [502](#L502) | wp\_send\_json(array( |
| [503](#L503) | 'error'¬† ¬† ¬† ¬† ¬†=>¬†1, |
| [504](#L504) | 'notice'¬† ¬† ¬† ¬† =>¬†xoo\_ml\_add\_notice(¬†$notice,¬†'error'¬†) |
| [505](#L505) | )); |
| [506](#L506) | } |
| [507](#L507) |  |
| [508](#L508) | } |
| [509](#L509) |  |
| [510](#L510) | /\*\* |
| [511](#L511) | \* Process login with OTP Form |
| [512](#L512) | \* |
| [513](#L513) | \* @param¬† ¬† ¬† ¬†int¬† ¬† ¬†$user\_id¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† User ID |
| [514](#L514) | \*/ |
| [515](#L515) | public¬†function¬†process\_login\_with\_otp\_form(){ |
| [516](#L516) |  |
| [517](#L517) | try¬†{ |
| [518](#L518) |  |
| [519](#L519) | if(¬†!isset(¬†$\_POST['xoo-ml-reg-phone']¬†)¬†||¬†!trim($\_POST['xoo-ml-reg-phone'])¬†){ |
| [520](#L520) | throw¬†new¬†Xoo\_Exception(¬†\_\_(¬†'Phone field cannot be empty',¬†'mobile-login-woocommerce'¬†)¬†); |
| [521](#L521) | } |
| [522](#L522) |  |
| [523](#L523) | if(¬† xoo\_ml\_helper()->get\_phone\_option('l-enable-cc-field')¬†===¬†"yes"¬†&&¬†(¬†!isset(¬†$\_POST['xoo-ml-reg-phone-cc']¬†)¬†||¬†!trim(¬†$\_POST['xoo-ml-reg-phone-cc']¬†)¬†)¬†){ |
| [524](#L524) | throw¬†new¬†Xoo\_Exception(¬†\_\_(¬†'Country code cannot be empty',¬†'mobile-login-woocommerce'¬†)¬†); |
| [525](#L525) | } |
| [526](#L526) |  |
| [527](#L527) | //Here phone\_no can be with country code. |
| [528](#L528) | $phone\_no¬† ¬† ¬† ¬†=¬†sanitize\_text\_field(¬†$\_POST['xoo-ml-reg-phone']¬†); |
| [529](#L529) | $phone\_code¬†=¬†isset(¬†$\_POST['xoo-ml-reg-phone-cc']¬†)¬†?¬†sanitize\_text\_field(¬†trim(¬†$\_POST['xoo-ml-reg-phone-cc']¬†)¬†)¬†:¬†''; |
| [530](#L530) |  |
| [531](#L531) | $phone\_user¬†=¬†xoo\_ml\_get\_user\_by\_phone(¬†$phone\_no,¬†$phone\_code¬†); |
| [532](#L532) |  |
| [533](#L533) | if(¬†!$phone\_user¬†){ |
| [534](#L534) | throw¬†new¬†Xoo\_Exception(¬†\_\_(¬†'We cannot find an account with that mobile number',¬†'mobile-login-woocommerce'¬†)¬†); |
| [535](#L535) | } |
| [536](#L536) |  |
| [537](#L537) | $phone\_no¬† ¬† ¬† ¬†=¬†xoo\_ml\_get\_user\_phone(¬†$phone\_user->ID,¬†'number'¬†); |
| [538](#L538) | $phone\_code¬†=¬†xoo\_ml\_get\_user\_phone(¬†$phone\_user->ID,¬†'code'¬†); |
| [539](#L539) |  |
| [540](#L540) | if(¬†!$phone\_code¬†){ |
| [541](#L541) | throw¬†new¬†Xoo\_Exception(¬†\_\_(¬†'Something went wrong. Please contact site administrator.',¬†'mobile-login-woocommerce'¬†)¬†); |
| [542](#L542) | } |
| [543](#L543) |  |
| [544](#L544) | //Send OTP SMS |
| [545](#L545) | $otp¬†=¬†Xoo\_Ml\_Otp\_Handler::sendOTPSMS(¬†$phone\_code,¬†$phone\_no¬†); |
| [546](#L546) |  |
| [547](#L547) | if(¬†is\_wp\_error(¬†$otp¬†)¬†){ |
| [548](#L548) | throw¬†new¬†Xoo\_Exception(¬†$otp->get\_error\_message()¬†); |
| [549](#L549) | } |
| [550](#L550) |  |
| [551](#L551) | wp\_send\_json(array( |
| [552](#L552) | 'otp\_sent'¬† ¬† ¬† ¬† ¬† ¬† ¬† =>¬†1, |
| [553](#L553) | 'phone\_code'¬† ¬† =>¬†$phone\_code, |
| [554](#L554) | 'phone\_no'¬† ¬† ¬† ¬† ¬† ¬† ¬† =>¬†$phone\_no, |
| [555](#L555) | 'error'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†=>¬†0, |
| [556](#L556) | 'otp\_txt'¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†=>¬†sprintf(¬†\_\_(¬†'Please enter the OTP sent to <br> %s',¬†'mobile-login-woocommerce'¬†),¬†$phone\_code.$phone\_no¬†), |
| [557](#L557) | )); |
| [558](#L558) |  |
| [559](#L559) | }¬†catch¬†(¬†Exception¬†$e¬†)¬†{ |
| [560](#L560) |  |
| [561](#L561) | $notice¬†=¬†apply\_filters(¬†'xoo\_ml\_login\_with\_otp\_errors',¬†$e->getMessage()¬†); |
| [562](#L562) |  |
| [563](#L563) | wp\_send\_json(array( |
| [564](#L564) | 'error'¬† ¬† ¬† ¬† ¬†=>¬†1, |
| [565](#L565) | 'notice'¬† ¬† ¬† ¬† =>¬†xoo\_ml\_add\_notice(¬†$notice,¬†'error'¬†) |
| [566](#L566) | )); |
| [567](#L567) | } |
| [568](#L568) |  |
| [569](#L569) |  |
| [570](#L570) | } |
| [571](#L571) |  |
| [572](#L572) |  |
| [573](#L573) | } |
| [574](#L574) |  |
| [575](#L575) | new¬†Xoo\_Ml\_Phone\_Verification(); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/mobile-login-woocommerce/tags/2.2/includes/class-xoo-ml-verification.php?format=txt)
* [Original Format](/export/3222755/mobile-login-woocommerce/tags/2.2/includes/class-xoo-ml-verification.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_8af264b6_20250115_100928.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# OTP Login Woocommerce & Gravity Forms <= 2.2 - Authentication Bypass to Privilege Escalation

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel) ¬†¬†>¬†¬†  [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities) ¬†¬†>¬†¬† OTP Login Woocommerce & Gravity Forms <= 2.2 - Authentication Bypass to Privilege Escalation

8.1

**Improper Authentication**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2023-2706](https://www.cve.org/CVERecord?id=CVE-2023-2706) |
| --- | --- |
| CVSS | 8.1 (High) |
| Publicly Published | May 16, 2023 |
| Last Updated | June 5, 2023 |
| Researcher | [Istv√°n M√°rton - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/lana-codes) |

### Description

The OTP Login Woocommerce & Gravity Forms plugin for WordPress is vulnerable to authentication bypass. This is due to the fact that when generating OTP codes for users to use in order to login via phone number, the plugin returns these codes in an AJAX response. This makes it possible for unauthenticated attackers to obtain login codes for administrators. This does require an attacker have access to the phone number configured for an account, which can be obtained via social engineering or reconnaissance.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/mobile-login-woocommerce/tags/2.2/includes/class-xoo-ml-verification.php#L362)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2912731%40mobile-login-woocommerce&new=2912731%40mobile-login-woocommerce&sfp_email=&sfph_mail=)
* [lana.codes](https://lana.codes/lanavdb/87b5e80e-fd5b-47c3-bf82-088bdf4573b5/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fmobile-login-woocommerce%2Fotp-login-woocommerce-gravity-forms-22-authentication-bypass-to-privilege-escalation&t=OTP%20Login%20Woocommerce%20%26%20Gravity%20Forms%20%3C%3D%202.2%20-%20Authentication%20Bypass%20to%20Privilege%20Escalation "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fmobile-login-woocommerce%2Fotp-login-woocommerce-gravity-forms-22-authentication-bypass-to-privilege-escalation&text=OTP%20Login%20Woocommerce%20%26%20Gravity%20Forms%20%3C%3D%202.2%20-%20Authentication%20Bypass%20to%20Privilege%20Escalation "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fmobile-login-woocommerce%2Fotp-login-woocommerce-gravity-forms-22-authentication-bypass-to-privilege-escalation "LinkedIn")
Email

## Vulnerability Details for OTP Login Woocommerce (Login with OTP)

#### [OTP Login Woocommerce (Login with OTP)](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/mobile-login-woocommerce)

| Software Type | Plugin |
| --- | --- |
| Software Slug | mobile-login-woocommerce [(view on wordpress.org)](https://wordpress.org/plugins/mobile-login-woocommerce) |
| Patched? | Yes |
| Remediation | Update to version 2.3, or a newer patched version |
| Affected Version | * <= 2.2 |
| Patched Version | * 2.3 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE¬Æ). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


