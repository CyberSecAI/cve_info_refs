=== Content from www.debian.org_a09497a1_20250114_223014.html ===


---

[[Date Prev](msg00119.html)][[Date Next](msg00121.html)]
[[Thread Prev](msg00119.html)][[Thread Next](msg00121.html)]
[[Date Index](maillist.html#00120)]
[[Thread Index](threads.html#00120)]

# [SECURITY] [DSA 5429-1] wireshark security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5429-1] wireshark security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 15 Jun 2023 18:05:29 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZItS6b%2Bkz0Eh5Pl1%40seger.debian.org)Â [ZItS6b+kz0Eh5Pl1@seger.debian.org](msg00120.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5429-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
June 15, 2023                         <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : wireshark
CVE ID         : CVE-2023-0666 CVE-2023-0668 CVE-2023-1161 CVE-2023-1992
                 CVE-2023-1993 CVE-2023-1994 CVE-2023-2854 CVE-2023-2855
                 CVE-2023-2856 CVE-2023-2857 CVE-2023-2858 CVE-2023-2879
                 CVE-2023-2952

Multiple vulnerabilities have been discocvered in Wireshark, a network
protocol analyzer which could result in denial of service or the
execution of arbitrary code.

For the stable distribution (bookworm), these problems have been fixed in
version 4.0.6-1~deb12u1.

We recommend that you upgrade your wireshark packages.

For the detailed security status of wireshark please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/wireshark>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmSLUgEACgkQEMKTtsN8
Tjb1eA//ZRvTFE+TUSJE6M81F5ul/jUvJr9BXp0yrMMO2PUhD364FNFNr7rTEKqI
csL6Tn7ovBlMvp+DTczWb0A5Kvk6/VdYXo92u4sErOSu+m6d0klOX7hwQbzg7fmp
t3LwJz/eVHDIBgNY7NCGVHgWJ2OpOSPtvo78Qejd9SpXATFv/OzsPKL3rhfgoxj8
KY49mZqvPaRp3m60LSJigNhXtb14RNoyGQpYYBnsIDAkGUR+gb9Hr7PLhbMGdvJk
XeQXwZsqp2HFdxOEKdwDPABpltBUjpClycD2sMzmXhgEdcbyuAFgvVWWmLxtgIxt
3bvFXTpQ8SSePWKCZaOnrWnmtUzrkN1WKyfrlwvB3zY+H7QDO66nSuRvQ0+8dJoJ
fCKn9H14B8BqcynRJEanJzNZ13rvV5l1843Is17SbY8KmBAEGADmYckvx3d1kGDm
FGNC5tqdAmoZCuXHzfZuN5rWWdBMV3Z18QN1gpv0LdEh5hQf6fzb1M0xcuibbVh6
a6b3RTtwNQtH+BUcaD+Ma64zpjQShHJ9NyjC0F2MhJBFpWRiwvO+mgtVxmRPkFZf
x0OvOT+7koUOut1MiaKMEwbEIYZP9lCD6+WMtv2xaJW7BrCmSneVHNXH56707D7k
nfnh5Y9t0G5NT70NhOutdgokTvfjoEQln6kSG2t80nWScRyYWek=
=4yeF
-----END PGP SIGNATURE-----

```

---



=== Content from gitlab.com_b4aa5115_20250114_223006.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-2855.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-2855.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-2855.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-2855.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ðŸ¤– GitLab Bot ðŸ¤–'s avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ðŸ¤– GitLab Bot ðŸ¤–")](/gitlab-bot)

  May 24, 2023

  [b553cc06](/gitlab-org/cves/-/commit/b553cc063ef5889195c801ffddf85bac0c958786)
  [Publishing 0 updated advisories and 2 new advisories](/gitlab-org/cves/-/commit/b553cc063ef5889195c801ffddf85bac0c958786)
  Â·
  b553cc06

  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored May 24, 2023

  b553cc06

  [Publishing 0 updated advisories and 2 new advisories](/gitlab-org/cves/-/commit/b553cc063ef5889195c801ffddf85bac0c958786)
  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored May 24, 2023

Loading



=== Content from security.gentoo.org_227704e5_20250114_223008.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Wireshark: Multiple Vulnerabilities â€” GLSA **202309-02**

Multiple vulnerabilities have been found in Wireshark, the worst of which could result in denial of service.

### Affected packages

| Package | **net-analyzer/wireshark** on all architectures |
| --- | --- |
| Affected versions | < **4.0.6** |
| Unaffected versions | >= **4.0.6** |

### Background

Wireshark is a versatile network protocol analyzer.

### Description

Multiple vulnerabilities have been discovered in Wireshark. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Wireshark users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-analyzer/wireshark-4.0.6"

```
### References

* [CVE-2022-3725](https://nvd.nist.gov/vuln/detail/CVE-2022-3725)
* [CVE-2023-0666](https://nvd.nist.gov/vuln/detail/CVE-2023-0666)
* [CVE-2023-0667](https://nvd.nist.gov/vuln/detail/CVE-2023-0667)
* [CVE-2023-0668](https://nvd.nist.gov/vuln/detail/CVE-2023-0668)
* [CVE-2023-1161](https://nvd.nist.gov/vuln/detail/CVE-2023-1161)
* [CVE-2023-1992](https://nvd.nist.gov/vuln/detail/CVE-2023-1992)
* [CVE-2023-1993](https://nvd.nist.gov/vuln/detail/CVE-2023-1993)
* [CVE-2023-1994](https://nvd.nist.gov/vuln/detail/CVE-2023-1994)
* [CVE-2023-2854](https://nvd.nist.gov/vuln/detail/CVE-2023-2854)
* [CVE-2023-2855](https://nvd.nist.gov/vuln/detail/CVE-2023-2855)
* [CVE-2023-2856](https://nvd.nist.gov/vuln/detail/CVE-2023-2856)
* [CVE-2023-2857](https://nvd.nist.gov/vuln/detail/CVE-2023-2857)
* [CVE-2023-2858](https://nvd.nist.gov/vuln/detail/CVE-2023-2858)
* [CVE-2023-2879](https://nvd.nist.gov/vuln/detail/CVE-2023-2879)
* [CVE-2023-2952](https://nvd.nist.gov/vuln/detail/CVE-2023-2952)
* WNPA-SEC-2022-07
* WNPA-SEC-2023-08
* WNPA-SEC-2023-09
* WNPA-SEC-2023-10
* WNPA-SEC-2023-11

**Release date**

September 17, 2023

**Latest revision**

September 17, 2023: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [878421](https://bugs.gentoo.org/show_bug.cgi?id=878421)
* [899548](https://bugs.gentoo.org/show_bug.cgi?id=899548)
* [904248](https://bugs.gentoo.org/show_bug.cgi?id=904248)
* [907133](https://bugs.gentoo.org/show_bug.cgi?id=907133)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from www.wireshark.org_b60bc739_20250114_223014.html ===

## wnpa-sec-2023-12 Â· Candump log file parser crash

## Summary

**Name:** Candump log file parser crash

**Docid:** wnpa-sec-2023-12

**Date:** May 24, 2023

**Affected versions:** 4.0.0 to 4.0.5, 3.6.0 to 3.6.13

**Fixed versions:** 4.0.6, 3.6.14

**References:**

[Wireshark issue 19062](https://gitlab.com/wireshark/wireshark/-/issues/19062).

[CVE-2023-2855](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2855).

## Details

### Description

The Candump log file parser could crash.
Discovered by Huascar Tejeda.

## Impact

It may be possible to make Wireshark
crash

by convincing
someone to read a malformed packet trace file.

## Resolution

Upgrade to Wireshark 4.0.6, 3.6.14 or later.



=== Content from gitlab.com_d4055e00_20250114_223007.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stack-buffer-overflow in candump\_write\_packet

**Description:**

A stack-buffer-overflow vulnerability has been identified in Wireshark 4.0.5's `candump_write_packet` function. This issue occurs when processing a specially crafted payload, which results in a crash and potentially code execution.

Tested on: Ubuntu 22.04.2 LTS

Steps to reproduce:

1. Download and install Wireshark 4.0.5
2. Run `tshark -r trigger`

**Result:**

```
$ xxd -g1 trigger
00000000: 28 30 2e 30 29 09 30 09 30 30 30 23 52 39        (0.0).0.000#R9

$ tshark -r trigger
*** buffer overflow detected ***: terminated
Aborted

# After recompiling with "CANDUMP_DEBUG"
$ tshark -r trigger
candump_parse: Trying candump file decoder
candump_parse: Starting parser at offset 0
run_candump_parser: Starting parsing
yy_reduce: read message
run_candump_parser: Done (0)
candump_parse: Success
candump_open: This is our file
candump_read: Try reading at offset 0
candump_parse: Trying candump file decoder
candump_parse: Starting parser at offset 0
run_candump_parser: Starting parsing
yy_reduce: read message
run_candump_parser: Done (0)
candump_parse: Success
candump_read: Stopped at offset 14
*** buffer overflow detected ***: terminated
Aborted
```

*The hexdump output shows the contents of the trigger file, which contains data that will cause the buffer overflow when parsed by Wireshark.*

**Technical details:**

The issue can be traced back to the `candump_write_packet` function in the `wiretap/candump.c` file. The ASAN report indicates a **WRITE** operation of size **9** at address `0x7fffffffdb88`, which overflows the `can_frame.sroa.660` variable in the stack.

The root cause of the vulnerability appears to be the use of the memcpy function in the `candump_write_packet` function at **line 83**. The memcpy function is called with a length value that is larger than the destination buffer, causing a buffer overflow:

```
#define CAN_MAX_DLEN   8

typedef struct can_frame {
    guint32 can_id;                       /* 32 bit CAN_ID + EFF/RTR/ERR flags */
    guint8  can_dlc;                      /* frame payload length in byte (0 .. CAN_MAX_DLEN) */
    guint8  __pad;                        /* padding */
    guint8  __res0;                       /* reserved / padding */
    guint8  __res1;                       /* reserved / padding */
    guint8  data[CAN_MAX_DLEN];
} can_frame_t;

memcpy(can_frame.data, msg->data.data, msg->data.length);

> b *candump_write_packet+612:

   $rdi = 0x00007fffffffdd78 â†’ 0x0000000000000000,
   $rsi = 0x00007fffffffde12 â†’ 0x0000000000000000,
 â†’ $rdx = 0x0000000000000009
 â†’   0x42ba84 <candump_write_packet+612> call   0x406f30 <memcpy@plt>
```

The can\_frame structure is used to store CAN (Controller Area Network) frames, including the CAN ID, data length code (DLC), and the actual data. The issue here is that `msg->data.length` is **9**, which is larger than the size of the destination buffer `can_frame.data` (**8** bytes). This results in a buffer overflow when memcpy tries to copy 9 bytes from the source buffer to the destination buffer, which can only accommodate 8 bytes.

**Mitigation:**

To address this vulnerability, it is necessary to add a check before the memcpy call to ensure that the length of the source data does not exceed the size of the destination buffer:

```
if (msg->data.length <= CAN_MAX_DLEN)
	memcpy(can_frame.data, msg->data.data, msg->data.length);
```

I've tested the proposed patch and confirmed that it successfully processes the trigger file without causing a buffer overflow. If you would like me to submit a pull request with the implemented fix, please let me know and I will be happy to contribute.

**Attachments:**

* Trigger file
* ASAN Output
* GDB Backtrace

I'd also like to request a CVE ID for this vulnerability.

Please let me know if you need any additional information or assistance in addressing this vulnerability.

Regards,

HuÃ¡scar

[trigger](/-/project/7898047/uploads/f34829cd2d69069c2dc10cfb7e0aa22b/trigger)
[ASAN.txt](/-/project/7898047/uploads/c7616d4648c63c8f6180b7d04e997402/ASAN.txt)
[GDB\_Backtrace.txt](/-/project/7898047/uploads/68b1806961c99c473a7e64197ade65a3/GDB_Backtrace.txt)

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


