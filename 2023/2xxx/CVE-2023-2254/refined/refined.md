- **Root cause of vulnerability**: The plugin does not properly sanitize some of its settings, specifically the "Button Text" field.
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS).
- **Impact of exploitation**: An attacker with high privileges (Admin+) can inject malicious JavaScript code that will be executed when other users view a page containing the shortcode. This could lead to a variety of impacts, including session hijacking, data theft, or defacement.
- **Attack vectors**: The attacker needs to be logged in as a high-privilege user and modify the "Button Text" field in the plugin settings with the malicious payload. Then they need to add the `[kofi]` tag to a page. When a user views that page, the XSS payload executes.
- **Required attacker capabilities/position**: The attacker must have admin or higher level access to the WordPress site. The attacker must also have the ability to edit plugin settings and add the shortcode `[kofi]` to a page.