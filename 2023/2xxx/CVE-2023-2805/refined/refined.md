- **Root cause of vulnerability**: The `set_add_agent_leaves` AJAX function in the SupportCandy plugin does not properly sanitize and escape the `agents[]` parameter before using it in a SQL statement.
- **Weaknesses/vulnerabilities present**: SQL Injection (SQLi) vulnerability.
- **Impact of exploitation**: An attacker can execute arbitrary SQL queries on the database. This can lead to data exfiltration, modification, or deletion, and potentially lead to complete compromise of the application. In the provided PoC, a `SLEEP(10)` query is injected, causing a 10-second delay. This demonstrates the capability to inject SQL statements.
- **Attack vectors**: The vulnerability is triggered by sending a crafted POST request to the `admin-ajax.php` endpoint with a malicious `agents[]` parameter when calling the `wpsc_set_add_agent_leaves` action.
- **Required attacker capabilities/position**: The attacker must have administrative privileges or higher to exploit this vulnerability. The attacker needs to access the "Support Agents > Leaves" section of the plugin's admin panel.