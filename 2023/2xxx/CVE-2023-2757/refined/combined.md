=== Content from plugins.trac.wordpress.org_01650b78_20250115_084356.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwaiting%2Ftags%2F0.6.2%2Ftemplates%2Ftemplates.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/waiting/tags/0.6.2/templates/templates.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/waiting/tags/0.6.2/templates/templates.php)

---

# [source:](/browser?order=name "Go to repository root") [waiting](/browser/waiting?order=name "View waiting")/[tags](/browser/waiting/tags?order=name "View tags")/[0.6.2](/browser/waiting/tags/0.6.2?order=name "View 0.6.2")/[templates](/browser/waiting/tags/0.6.2/templates?order=name "View templates")/[templates.php](/browser/waiting/tags/0.6.2/templates/templates.php?order=name "View templates.php")

View diff against:

View revision:

| [Last change](/changeset/2826039/waiting/tags/0.6.2/templates/templates.php "View differences") on this file was [2826039](/changeset/2826039/ "View changeset 2826039"), checked in by plugin.builders, [2 years ago](/timeline?from=2022-11-29T15%3A34%3A16Z&precision=second "See timeline at 11/29/2022 03:34:16 PM") |
| --- |
| Version 0.6.2 released |
| **File size:** 22.2 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <script type="text/template" id="pbc-main-tmpl"> |
| [2](#L2) | <div class="yrc-content" style="background:#fff;padding:.1em;margin-bottom:2em"> |
| [3](#L3) | <div class="yrc-content-header wpb-clr" style="padding:1em 1em 0"> |
| [4](#L4) | <h3 class="wpb-float-left" style="margin:0">Message from Waiting Developer</h3> |
| [5](#L5) | </div> |
| [6](#L6) | <div class="widefat" style="padding:0 1em 1em;margin-top:-.5em"> |
| [7](#L7) | <p>We're providing custom development services to fund our new projects:</p> |
| [8](#L8) | <div id="pb-custom-services"> |
| [9](#L9) | <div> |
| [10](#L10) | <p class="wpb-pointer" style="margin-bottom:0em"><i class="dashicons dashicons-arrow-down-alt2"></i> Custom plugin development</p> |
| [11](#L11) | <ul class="pb-hidden" style="list-style:inside;margin-left:1em;margin-top:.5em"> |
| [12](#L12) | <li>Custom WordPress development led by developer with 8+ years of experience.</li> |
| [13](#L13) | </ul> |
| [14](#L14) | </div> |
| [15](#L15) | <div> |
| [16](#L16) | <p class="wpb-pointer" style="margin-bottom:0em"><i class="dashicons dashicons-arrow-down-alt2"></i> Web scraping (for leads, research and programmatic SEO)</p> |
| [17](#L17) | <ul class="pb-hidden" style="list-style:inside;margin-left:1em;margin-top:.5em"> |
| [18](#L18) | <li>Web scraping and data enrichment. Monitor data sources and be the first to know.</li> |
| [19](#L19) | <li>We can provide data never seen before by Google. Email us to see how it's possible.</li> |
| [20](#L20) | <li>Import scraped data to WordPress.</li> |
| [21](#L21) | </ul> |
| [22](#L22) | </div> |
| [23](#L23) | <div> |
| [24](#L24) | <p class="wpb-pointer" style="margin-bottom:0em"><i class="dashicons dashicons-arrow-down-alt2"></i> Data visualizaion (with React, D3, OSM, Mapbox)</p> |
| [25](#L25) | <ul class="pb-hidden" style="list-style:inside;margin-left:1em;margin-top:.5em"> |
| [26](#L26) | <li>Build dashboards with scraped or other data.</li> |
| [27](#L27) | <li>Companies use public data to build dashboards which act as lead magnets. |
| [28](#L28) | See <a href="https://www.adt.com/crime" target="\_blank">this example</a>, email us for more. |
| [29](#L29) | </li> |
| [30](#L30) | </ul> |
| [31](#L31) | </div> |
| [32](#L32) | </div> |
| [33](#L33) | <div> |
| [34](#L34) | <p style="margin:1.5em auto .75em">We are based in <span id="pb-c-s-country"></span> so our services will be relatively low-cost for you.</p> |
| [35](#L35) | <a class="button" target="\_blank" href="mailto:enquiry@plugin.builders?subject=Custom Development" style="display:inline-flex;align-items:center"> |
| [36](#L36) | <i class="dashicons dashicons-email-alt" style="margin-right:.5em"></i> Ask Question |
| [37](#L37) | </a> |
| [38](#L38) | </div> |
| [39](#L39) | </div> |
| [40](#L40) | </div> |
| [41](#L41) | <div class="pb-hidden" style="background:#fff;margin-bottom:1.5em"> |
| [42](#L42) | <div class="yrc-content-header wpb-clr"> |
| [43](#L43) | <h2 class="wpb-float-left" style="margin:0;padding:1em 1em 0">Waiting PRO</h2> |
| [44](#L44) | </div> |
| [45](#L45) | <div class="widefat" style="padding:0 1em 1em"> |
| [46](#L46) | <ul style="list-style:inside"> |
| [47](#L47) | <li>Cookies</li> |
| [48](#L48) | <li>Evergreen countdowns</li> |
| [49](#L49) | <li>User timezone</li> |
| [50](#L50) | <li>More styles & on finish options</li> |
| [51](#L51) | <div><strong>-----Also for free-----</strong></div> |
| [52](#L52) | <li> |
| [53](#L53) | Fast support - within hours |
| [54](#L54) | (see: <a href="https://wordpress.org/support/plugin/waiting/" target="\_blank">https://wordpress.org/support/plugin/waiting/</a>) |
| [55](#L55) | </li> |
| [56](#L56) | <li>Custom CSS, we don't act greedy for simple customisations</li> |
| [57](#L57) | </ul> |
| [58](#L58) | <div> |
| [59](#L59) | <a class="button button-primary"  target="\_blank" href="https://plugin.builders/waiting/?from=wp&v=<?php echo WPB\_Waiting::$version; ?>#pricing">Upgrade</a> |
| [60](#L60) | <a class="button" href="mailto:enquiry@plugin.builders?subject=Waiting Enquiry">Pre-Purchase Question?</a> |
| [61](#L61) | </div> |
| [62](#L62) | </div> |
| [63](#L63) | </div> |
| [64](#L64) | <div id="pbc-downs" class="wpb-hidden"> |
| [65](#L65) | <table class="widefat"> |
| [66](#L66) | <thead> |
| [67](#L67) | <tr> |
| [68](#L68) | <th><?php \_e('Name', 'waiting'); ?></th> |
| [69](#L69) | <th><?php \_e('To', 'waiting'); ?></th> |
| [70](#L70) | <th><?php \_e('Shortcode', 'waiting'); ?></th> |
| [71](#L71) | <th></th> |
| [72](#L72) | <th></th> |
| [73](#L73) | </tr> |
| [74](#L74) | </thead> |
| [75](#L75) | <tbody></tbody> |
| [76](#L76) | </table> |
| [77](#L77) | <button id="pbc-new-countdown" class="button button-primary"><?php \_e('Add New', 'waiting'); ?></button> |
| [78](#L78) | </div> |
| [79](#L79) | <div id="pbc-editor"></div> |
| [80](#L80) | <div id="pbc-feedback"> |
| [81](#L81) | <a class="button" href="mailto:suggest@plugin.builders?subject=Extend Waiting"><?php \_e('Suggest Feature', 'waiting'); ?></a> |
| [82](#L82) | <a class="button" href="mailto:support@plugin.builders?subject=Waiting Problem"><?php \_e('Report Issue', 'waiting'); ?></a> |
| [83](#L83) | <a class="button" href="https://wordpress.org/support/view/plugin-reviews/waiting?#postform" target="\_blank"><?php \_e('Write a review', 'waiting'); ?></a> |
| [84](#L84) | <a class="button" href="http://plugin.builders/waiting/docs" target="\_blank"><?php \_e('Docs & Troubleshooting', 'waiting'); ?></a> |
| [85](#L85) | </div> |
| [86](#L86) | <div id="pbc-demos" class=""></div> |
| [87](#L87) | </script> |
| [88](#L88) |  |
| [89](#L89) | <script type="text/template" id="pbc-duration-tmpl"> |
| [90](#L90) | <label><input type="number" min="0" max="999999" name="pbc\_insta" value="<%- parseInt(meta.insta[0]) ? (meta.occurence[0][1]/1000) : 0 %>" class="wpb-raw"/><?php \_e('Seconds', 'waiting'); ?></label> |
| [91](#L91) | </script> |
| [92](#L92) |  |
| [93](#L93) | <script type="text/template" id="pbc-countdown-date-tmpl"> |
| [94](#L94) | <div class="pbc-field wpb-inline"> |
| [95](#L95) | <input name="to\_date" value="<%= oto.date %>" class="wpb-raw pbc-date-picker"/> |
| [96](#L96) | </div> |
| [97](#L97) | <div class="pbc-field wpb-inline"> |
| [98](#L98) | <input name="to\_hours" type="number" min="0" max="23" value="<%= oto.h %>" class="wpb-raw"/> |
| [99](#L99) | <input name="to\_mins" type="number" min="0" max="59" value="<%= oto.mi %>" class="wpb-raw"/> |
| [100](#L100) | <input name="to\_secs" type="number" min="0" max="59" value="<%= oto.s %>" class="wpb-raw"/> |
| [101](#L101) | </div> |
| [102](#L102) | </script> |
| [103](#L103) |  |
| [104](#L104) | <script type="text/template" id="pbc-countdown-start-date-tmpl"> |
| [105](#L105) | <div class="pbc-field wpb-inline"> |
| [106](#L106) | <input name="start\_date" value="<%= ostart.date %>" class="wpb-raw pbc-date-picker"/> |
| [107](#L107) | </div> |
| [108](#L108) | <div class="pbc-field wpb-inline"> |
| [109](#L109) | <input name="start\_hours" type="number" min="0" max="23" value="<%= ostart.h %>" class="wpb-raw"/> |
| [110](#L110) | <input name="start\_mins" type="number" min="0" max="59" value="<%= ostart.mi %>" class="wpb-raw"/> |
| [111](#L111) | <input name="start\_secs" type="number" min="0" max="59" value="<%= ostart.s %>" class="wpb-raw"/> |
| [112](#L112) | </div> |
| [113](#L113) | </script> |
| [114](#L114) |  |
| [115](#L115) | <script type="text/template" id="pbc-countdown-tmpl"> |
| [116](#L116) | <form class="pbc-pane" id="pbc-form"> |
| [117](#L117) | <div class="pbc-row"> |
| [118](#L118) | <div class="pbc-row-label wpb-inline"><?php \_e('Name', 'waiting'); ?></div> |
| [119](#L119) | <div class="pbc-row-field wpb-inline"> |
| [120](#L120) | <input name="name" value="<%= down.meta.name %>" class="wpb-raw"/> <small><?php \_e('Must be unique', 'waiting'); ?></small> |
| [121](#L121) | </div> |
| [122](#L122) | </div> |
| [123](#L123) |  |
| [124](#L124) | <div class="pbc-row"> |
| [125](#L125) | <div class="pbc-row-label wpb-inline"><?php \_e('Countdown', 'waiting'); ?> <?php \_e('To', 'waiting'); ?></div> |
| [126](#L126) | <div class="pbc-row-field wpb-inline" id="cd\_to"> |
| [127](#L127) | <% var insta = parseInt(down.meta.insta[0]); %> |
| [128](#L128) | <div class="pbc-field wpb-inline"> |
| [129](#L129) | <label><input type="radio" name="pbc\_to" value="to" <%-  insta ? '' : 'checked' %>/><?php \_e('Date', 'waiting'); ?></label> |
| [130](#L130) | </div> |
| [131](#L131) | <div class="wpb-inline <%- insta ? 'wpb-force-hide' : '' %>" data-cd="to"> |
| [132](#L132) | <%= PBC.dateTemplate(oto, down.meta.coffset) %> |
| [133](#L133) | </div></br> |
| [134](#L134) | <div class="pbc-field wpb-inline"> |
| [135](#L135) | <label><input type="radio" name="pbc\_to" value="insta" <%- insta ? 'checked' : '' %>/><?php \_e('Duration', 'waiting'); ?></label> |
| [136](#L136) | </div> |
| [137](#L137) | <div class="pbc-field wpb-inline <%- insta ? '' : 'wpb-force-hide' %>" data-cd="insta"> |
| [138](#L138) | <%= PBC.durationTemplate(down) %> |
| [139](#L139) | </div> |
| [140](#L140) | </div> |
| [141](#L141) | </div> |
| [142](#L142) |  |
| [143](#L143) | <div class="pbc-row"> |
| [144](#L144) | <div class="pbc-row-label wpb-inline"><?php \_e('Countdown', 'waiting'); ?> <?php \_e('From', 'waiting'); ?></div> |
| [145](#L145) | <div class="pbc-row-field wpb-inline" id="cd\_from"> |
| [146](#L146) | <div class="wpb-inline"> |
| [147](#L147) | <%= PBC.startDateTemplate(down.meta.occurence[0][0], down.meta.coffset) %> |
| [148](#L148) | </div> |
| [149](#L149) | </div> |
| [150](#L150) | </div> |
| [151](#L151) |  |
| [152](#L152) | <div class="pbc-row pbc-manual-starts <%- parseInt(down.meta.insta[0]) ? '' : 'wpb-hidden' %>" id="pbc-start-on-click"> |
| [153](#L153) | <div class="pbc-row-label wpb-inline"><?php \_e('Start on clicking', 'waiting'); ?></div> |
| [154](#L154) | <div class="pbc-row-field wpb-inline"> |
| [155](#L155) | <div class="wpb-inline" style="width:100%"> |
| [156](#L156) | <input type="text" name="start\_on\_click" value="<%= down.meta.start\_on\_click %>" class="wpb-raw" style="width:100%"/> |
| [157](#L157) | <p style="margin:.25em 0;">Enter CSS selectors separated by commas, countdown'll start / restart upon clicking on them.</p> |
| [158](#L158) | </div> |
| [159](#L159) | </div> |
| [160](#L160) | </div> |
| [161](#L161) |  |
| [162](#L162) | <div class="pbc-row"> |
| [163](#L163) | <div class="pbc-row-label wpb-inline"><?php \_e('Timezone', 'waiting'); ?></div> |
| [164](#L164) | <div class="pbc-row-field wpb-inline" id="pbc-timezone-field"> |
| [165](#L165) | <div class="pbc-field wpb-inline"> |
| [166](#L166) | <label><input type="radio" name="timezone" value="WP" |
| [167](#L167) | <%- down.meta.timezone === 'WP' ? 'checked' : '' %> class=""/><?php \_e('WordPress', 'waiting'); ?></label> |
| [168](#L168) | </div> |
| [169](#L169) | <div class="pbc-field wpb-inline"> |
| [170](#L170) | <label><input type="radio" name="timezone" value="UTC" |
| [171](#L171) | <%- down.meta.timezone === 'UTC' ? 'checked' : '' %> class=""/><?php \_e('UTC', 'waiting'); ?></label> |
| [172](#L172) | </div> |
| [173](#L173) | </div> |
| [174](#L174) | </div> |
| [175](#L175) |  |
| [176](#L176) | <div class="pbc-row"> |
| [177](#L177) | <div class="pbc-row-label wpb-inline"><?php \_e('Units', 'waiting'); ?></div> |
| [178](#L178) | <div class="pbc-row-field wpb-inline pbc-unit-field"> |
| [179](#L179) | <% |
| [180](#L180) | units.forEach(function(unit){ %> |
| [181](#L181) | <div class="pbc-field wpb-inline"> |
| [182](#L182) | <label><input type="checkbox" name="unit[]" value="<%= unit %>" |
| [183](#L183) | <%- down.meta.units.indexOf(unit) > -1 ? 'checked' : '' %>/><%= PBCUtils.lang.units[unit] %></label> |
| [184](#L184) | </div> |
| [185](#L185) | <% }); |
| [186](#L186) | %> |
| [187](#L187) | </div> |
| [188](#L188) | </div> |
| [189](#L189) |  |
| [190](#L190) | <div class="pbc-row"> |
| [191](#L191) | <div class="pbc-row-label wpb-inline"><?php \_e('Labels', 'waiting'); ?></div> |
| [192](#L192) | <div class="pbc-row-field wpb-inline"> |
| [193](#L193) | <div class="pbc-field wpb-inline"> |
| [194](#L194) | <label><input type="checkbox" name="shorten\_label" |
| [195](#L195) | <%- parseInt(down.style.shorten\_label) ? 'checked' : '' %> class="wpb-raw" /><?php \_e('Shorten', 'waiting'); ?></label> |
| [196](#L196) | </div> |
| [197](#L197) | <div class="pbc-field wpb-inline"> |
| [198](#L198) | <label><input type="checkbox" name="lowercase\_label" |
| [199](#L199) | <%- parseInt(down.style.lowercase\_label) ? 'checked' : '' %>  class="wpb-raw" /><?php \_e('Lowercase', 'waiting'); ?></label> |
| [200](#L200) | </div> |
| [201](#L201) | </div> |
| [202](#L202) | </div> |
| [203](#L203) |  |
| [204](#L204) | <div class="pbc-row"> |
| [205](#L205) | <div class="pbc-row-label wpb-inline"><?php \_e('Font', 'waiting'); ?></div> |
| [206](#L206) | <div class="pbc-row-field wpb-inline" id="pbc-fonts"> |
| [207](#L207) | <%= PBC.fontTemplate() %> |
| [208](#L208) | </div> |
| [209](#L209) | </div> |
| [210](#L210) |  |
| [211](#L211) | <div class="pbc-row"> |
| [212](#L212) | <div class="pbc-row-label wpb-inline">Style |
| [213](#L213) | </div><div class="pbc-row-field wpb-inline" id="pbc-styles-field"> |
| [214](#L214) | <a class="button pbc-choose-style" id="pbc-edit-style"><?php \_e('Edit', 'waiting'); ?></a> |
| [215](#L215) | <a class="button wpb-force-hide" id="pbc-toggle-style"><?php \_e('Toggle', 'waiting'); ?></a> |
| [216](#L216) | <div id="pbc-styles"></div> |
| [217](#L217) | </div> |
| [218](#L218) | </div> |
| [219](#L219) |  |
| [220](#L220) | <% if(!PBC.free){ %> |
| [221](#L221) | <div class="pbc-row"> |
| [222](#L222) | <div class="pbc-row-label wpb-inline"><?php \_e('Resize', 'waiting'); ?></div> |
| [223](#L223) | <div class="pbc-row-field wpb-inline"> |
| [224](#L224) | <label><input type="checkbox" name="resize" <%- parseInt(down.style.resize) ? 'checked' : '' %> class="wpb-raw"/><?php \_e('Expand width to parent element\'s size.', 'waiting'); ?></label> |
| [225](#L225) | </div> |
| [226](#L226) | </div> |
| [227](#L227) | <% } %> |
| [228](#L228) |  |
| [229](#L229) | <% var fin = down.meta.onfinish; %> |
| [230](#L230) | <div class="pbc-row" id="pbc-onfinish-row"> |
| [231](#L231) | <div class="pbc-row-label wpb-inline"><?php \_e('On Finish', 'waiting'); ?></div> |
| [232](#L232) | <div class="pbc-row-field wpb-inline" id="pbc-onfinish-field"> |
| [233](#L233) | <div class="pbc-option" data-name="nothing"> |
| [234](#L234) | <div class="pbc-option-label"><?php \_e('Nothing', 'waiting'); ?></div> |
| [235](#L235) | </div> |
| [236](#L236) | <div class="pbc-option" data-name="hide"> |
| [237](#L237) | <div class="pbc-option-label"><?php \_e('Hide', 'waiting'); ?> <?php \_e('Countdown', 'waiting'); ?></div> |
| [238](#L238) | </div> |
| [239](#L239) | <div class="pbc-option" data-name="redirect"> |
| [240](#L240) | <div class="pbc-option-label"><?php \_e('Redirect', 'waiting'); ?></div> |
| [241](#L241) | <div class="pbc-option-field"> |
| [242](#L242) | <input type="text" value="<%- fin[0] === 'redirect' ? fin[1][0] : '' %>" placeholder="<?php \_e('URL', 'waiting'); ?>"/> |
| [243](#L243) | </div> |
| [244](#L244) | </div> |
| [245](#L245) | <div class="pbc-option" data-name="event"> |
| [246](#L246) | <div class="pbc-option-label"><?php \_e('Trigger DOM events (click, hover etc.)', 'waiting'); ?></div> |
| [247](#L247) | <div class="pbc-option-field"> |
| [248](#L248) | <input type="text" value="<%- fin[0] === 'event' ? fin[1][0] : '' %>" placeholder="<?php \_e('selector', 'waiting'); ?>"/> |
| [249](#L249) | <input type="text" value="<%- fin[0] === 'event' ? fin[1][1] : '' %>" placeholder="<?php \_e('event', 'waiting'); ?>"/> |
| [250](#L250) | </div> |
| [251](#L251) | </div> |
| [252](#L252) | </div> |
| [253](#L253) | </div> |
| [254](#L254) |  |
| [255](#L255) | <div class="pbc-form-save"> |
| [256](#L256) | <div class="pbc-form-message"></div> |
| [257](#L257) | <button class="button button-primary"><?php \_e('Save', 'waiting'); ?></button> |
| [258](#L258) | <a class="button pbc-cancel-form"><?php \_e('Cancel', 'waiting'); ?></a> |
| [259](#L259) | <% if(down.meta.id !== 'nw'){ %> |
| [260](#L260) | <a class="button" id="pbc-delete-form"><?php \_e('Delete', 'waiting'); ?></a> |
| [261](#L261) | <% } %> |
| [262](#L262) | </div> |
| [263](#L263) | </form> |
| [264](#L264) | </br> |
| [265](#L265) | <small><?php \_e('Some changes won\'t take effect in preview', 'waiting'); ?>.</small> |
| [266](#L266) | </script> |
| [267](#L267) |  |
| [268](#L268) | <script type="text/template" id="pbc-down-tmpl"> |
| [269](#L269) | <tr data-down="<%= id %>" class="pbc-down"> |
| [270](#L270) | <td><span><%= d.meta.name %></span></td> |
| [271](#L271) | <td><span><%- parseInt(d.meta.insta[0]) ? (d.meta.occurence[0][1]/1000)+' <?php \_e('seconds', 'waiting'); ?>' : (oto.date + ' ' + oto.time) %></span></td> |
| [272](#L272) | <td><span>[waiting name="<%= d.meta.name %>"]</span></td> |
| [273](#L273) | <td><a class="button pbc-edit" data-down="<%= id %>"><?php \_e('Edit', 'waiting'); ?></a></td> |
| [274](#L274) | <td><a class="button pbc-copy" data-down="<%= id %>"><?php \_e('Duplicate', 'waiting'); ?></a></td> |
| [275](#L275) | </tr> |
| [276](#L276) | </script> |
| [277](#L277) |  |
| [278](#L278) | <script type="text/template" id="pbc-html-styles-tmpl"> |
| [279](#L279) | <% var css = style.css, scl = 16; %> |
| [280](#L280) |  |
| [281](#L281) | <div class="pbc-row" id="pbc-style-toolbar"></div> |
| [282](#L282) |  |
| [283](#L283) | <div class="pbc-row wpb-force-hide"> |
| [284](#L284) | <div class="pbc-row-label wpb-inline">Wrapper</div> |
| [285](#L285) | <div class="pbc-row-field wpb-inline"> |
| [286](#L286) | <div class="pbc-field wpb-inline"> |
| [287](#L287) | <label><input name="wrapper\_bg" value="#000" data-default-color="#000" |
| [288](#L288) | data-keys="0-2, .pbc-shell, background, 0" class="wpb-color"/><?php \_e('Background', 'waiting'); ?></label> |
| [289](#L289) | </div> |
| [290](#L290) | </div> |
| [291](#L291) | </div> |
| [292](#L292) | <% if(style.type[1] && !PBC.free){ %> |
| [293](#L293) | <div class="pbc-row"> |
| [294](#L294) | <div class="pbc-row-field wpb-inline"> |
| [295](#L295) | <div class="pbc-field wpb-inline"> |
| [296](#L296) | <label><input type="radio" name="3do" value="1" data-keys="type-3,  , , 1" |
| [297](#L297) | <%- style.type[3] ? 'checked' : '' %>/><?php \_e('Horizontal', 'waiting'); ?></label> |
| [298](#L298) | </div> |
| [299](#L299) | <div class="pbc-field wpb-inline"> |
| [300](#L300) | <label><input type="radio" name="3do" value="0" data-keys="type-3,  , , 1" |
| [301](#L301) | <%- style.type[3] ? '' : 'checked' %>/><?php \_e('Vertical', 'waiting'); ?></label> |
| [302](#L302) | </div> |
| [303](#L303) | </div> |
| [304](#L304) | </div> |
| [305](#L305) | <% } %> |
| [306](#L306) |  |
| [307](#L307) | <div class="pbc-row"> |
| [308](#L308) | <div class="pbc-row-label wpb-inline"><?php \_e('Unit', 'waiting'); ?></div> |
| [309](#L309) | <div class="pbc-row-field wpb-inline"> |
| [310](#L310) | <div class="pbc-field wpb-inline"> |
| [311](#L311) | <label><input name="unit\_color" value="<%= css.num[2] %>" data-default-color='#000' " |
| [312](#L312) | data-keys="num-2, .pbc-num, color, 0" class="wpb-color"/><?php \_e('Color', 'waiting'); ?></label> |
| [313](#L313) | </div> |
| [314](#L314) |  |
| [315](#L315) | <div class="pbc-field wpb-inline"> |
| [316](#L316) | <label><input name="unit\_bg"  value="<%= css.num[1] %>" |
| [317](#L317) | data-keys="num-1, .pbc-num,.pbc-unit-content, background, 0" class="wpb-color"/><?php \_e('Background', 'waiting'); ?></label> |
| [318](#L318) | </div> |
| [319](#L319) |  |
| [320](#L320) | <div class="pbc-field wpb-inline"> |
| [321](#L321) | <label><input name="unit\_height" readonly data-range="[0, 150]" value="<%= css.content[0] \* scl %>" |
| [322](#L322) | data-keys="content-0, .pbc-unit-content, height, 1" class="wpb-number-input"/><?php \_e('Height', 'waiting'); ?></label> |
| [323](#L323) | </div> |
| [324](#L324) | <% if(style.type[0] !== 'canvas'){ %> |
| [325](#L325) | <div class="pbc-field wpb-inline"> |
| [326](#L326) | <label><input name="unit\_height" readonly data-range="[0, 150]" value="<%= css.unit[1] \* scl %>" |
| [327](#L327) | data-keys="unit-1, .pbc-unit, width, 1" class="wpb-number-input"/><?php \_e('Width', 'waiting'); ?></label> |
| [328](#L328) | </div> |
| [329](#L329) | <% } %> |
| [330](#L330) |  |
| [331](#L331) | <div class="pbc-field wpb-inline"> |
| [332](#L332) | <label><input name="unit\_font\_size" readonly data-range="[0, 100]" value="<%= css.num[0] \* scl %>" |
| [333](#L333) | data-keys="num-0, .pbc-num, font-size, 1" class="wpb-number-input"/><?php \_e('Font size', 'waiting'); ?></label> |
| [334](#L334) | </div> |
| [335](#L335) |  |
| [336](#L336) | <div class="pbc-field wpb-inline"> |
| [337](#L337) | <label><input name="unit\_margin\_right" readonly data-range="[0, 25]" value="<%= css.unit[2] \* scl %>" |
| [338](#L338) | data-keys="unit-2, .pbc-unit, margin-right, 1" class="wpb-number-input"/><?php \_e('Margin', 'waiting'); ?>-<?php \_e('Right', 'waiting'); ?></label> |
| [339](#L339) | </div> |
| [340](#L340) |  |
| [341](#L341) | <% if(!style.type[1]){ %> |
| [342](#L342) | <div class="pbc-field wpb-inline"> |
| [343](#L343) | <label><input name="unit\_border\_radius" readonly data-range="[0, 50]" value="<%= css.unit[4] \* scl %>" |
| [344](#L344) | data-keys="unit-4, .pbc-unit, border-radius, 1" class="wpb-number-input"/><?php \_e('Rounded corners', 'waiting'); ?></label> |
| [345](#L345) | </div> |
| [346](#L346) | <% } %> |
| [347](#L347) |  |
| [348](#L348) | <div class="pbc-field wpb-inline"> |
| [349](#L349) | <label><input type="checkbox" name="label\_show" <%- parseInt(css.unit[5]) ? 'checked' : '' %> |
| [350](#L350) | data-keys="unit-5, .pbc-unit, display, 0"/><?php \_e('Hide if Zero', 'waiting'); ?> <small>(<?php \_e('except last one', 'waiting'); ?>)</small></label> |
| [351](#L351) | </div> |
| [352](#L352) | </div> |
| [353](#L353) | </div> |
| [354](#L354) |  |
| [355](#L355) | <div class="pbc-row"> |
| [356](#L356) | <div class="pbc-row-label wpb-inline"><?php \_e('Label', 'waiting'); ?></div> |
| [357](#L357) | <div class="pbc-row-field wpb-inline"> |
| [358](#L358) | <div class="pbc-field wpb-inline"> |
| [359](#L359) | <label><input name="" readonly data-range="[0, 50]" value="<%= css.label[0] \* scl %>" |
| [360](#L360) | data-keys="label-0, .pbc-label, font-size, 1" class="wpb-number-input"/><?php \_e('Font-size', 'waiting'); ?></label> |
| [361](#L361) | </div> |
| [362](#L362) |  |
| [363](#L363) | <div class="pbc-field wpb-inline"> |
| [364](#L364) | <label><input name="" value="<%= css.label[2] %>" |
| [365](#L365) | data-keys="label-2, .pbc-label, color, 0" class="wpb-color"/><?php \_e('Color', 'waiting'); ?></label> |
| [366](#L366) | </div> |
| [367](#L367) | <% if(style.type[0] !== 'canvas'){ %> |
| [368](#L368) | <div class="pbc-field wpb-inline"> |
| [369](#L369) | <label><input name="" value="<%= css.label[1] %>" |
| [370](#L370) | data-keys="label-1, .pbc-label, background, 0" class="wpb-color"/><?php \_e('Background', 'waiting'); ?></label> |
| [371](#L371) | </div> |
| [372](#L372) | <% } %> |
| [373](#L373) |  |
| [374](#L374) | <div class="pbc-field wpb-inline"> |
| [375](#L375) | <label><input name="" readonly data-range="[0, 10]" value="<%= css.label[3] \* scl %>" |
| [376](#L376) | data-keys="label-3, .pbc-label, margin-top, 1" class="wpb-number-input"/><?php \_e('Margin', 'waiting'); ?></label> |
| [377](#L377) | </div> |
| [378](#L378) |  |
| [379](#L379) | <% if(style.type[0] === 'html'){ %> |
| [380](#L380) | <div class="pbc-field wpb-inline"> |
| [381](#L381) | <label><input type="checkbox" name="" <%- parseInt(css.label[5]) ? 'checked' : '' %> |
| [382](#L382) | data-keys="label-5, .pbc-label, display, 0"/><?php \_e('Top', 'waiting'); ?></label> |
| [383](#L383) | </div> |
| [384](#L384) | <% } %> |
| [385](#L385) |  |
| [386](#L386) | <div class="pbc-field wpb-inline"> |
| [387](#L387) | <label><input type="checkbox" name="label\_show" <%- parseInt(css.label[4]) ? 'checked' : '' %> |
| [388](#L388) | data-keys="label-4, .pbc-label, display, 0"/><?php \_e('Show', 'waiting'); ?></label> |
| [389](#L389) | </div> |
| [390](#L390) | </div> |
| [391](#L391) | </div> |
| [392](#L392) |  |
| [393](#L393) | <div class="pbc-row"> |
| [394](#L394) | <div class="pbc-row-label wpb-inline"><?php \_e('Align', 'waiting'); ?></div> |
| [395](#L395) | <div class="pbc-row-field wpb-inline"> |
| [396](#L396) | <div class="pbc-field wpb-inline"> |
| [397](#L397) | <label><input type="radio" name="pbc\_align" value="left" <%- (css.unit[7] === 'left') ? 'checked' : '' %> |
| [398](#L398) | data-keys="unit-7, .pbc-shell, text-align, 0"/><?php \_e('Left', 'waiting'); ?></label> |
| [399](#L399) | </div> |
| [400](#L400) | <div class="pbc-field wpb-inline"> |
| [401](#L401) | <label><input type="radio" name="pbc\_align" value="center" <%- (css.unit[7] === 'center') ? 'checked' : '' %> |
| [402](#L402) | data-keys="unit-7, .pbc-shell, text-align, 0"/><?php \_e('Center', 'waiting'); ?></label> |
| [403](#L403) | </div> |
| [404](#L404) | <div class="pbc-field wpb-inline"> |
| [405](#L405) | <label><input type="radio" name="pbc\_align" value="right" <%- (css.unit[7] === 'right') ? 'checked' : '' %> |
| [406](#L406) | data-keys="unit-7, .pbc-shell, text-align, 0"/><?php \_e('Right', 'waiting'); ?></label> |
| [407](#L407) | </div> |
| [408](#L408) | </div> |
| [409](#L409) | </div> |
| [410](#L410) | </script> |
| [411](#L411) |  |
| [412](#L412) | <script type="text/template" id="pbc-font-tmpl"> |
| [413](#L413) | <select> |
| [414](#L414) | <% for(var font in PBC.fonts){ %> |
| [415](#L415) | <option value="<%= PBC.fonts[font] %>" <%- chosen\_font === PBC.fonts[font] ? 'selected' : '' %>><%= font %></option> |
| [416](#L416) | <% } %> |
| [417](#L417) | </select> |
| [418](#L418) | </script> |
| [419](#L419) |  |
| [420](#L420) | <script type="text/template" id="pbc-lang-form-tmpl"> |
| [421](#L421) | <form id="pbc-lang-form" class="pbc-front-form"> |
| [422](#L422) | <h2 class="pbc-front-form-header wpb-pointer"><?php \_e('Quick Translation', 'waiting'); ?></h2> |
| [423](#L423) | <div class="pbc-front-form-inputs wpb-zero"> |
| [424](#L424) | <% for(var term in units){ %> |
| [425](#L425) | <div class="pbc-field wpb-inline"> |
| [426](#L426) | <label><%= PBC.lang.unit\_labels[term] %><input type="text" name="<%= term %>" value="<%= units[term] %>"/></label> |
| [427](#L427) | </div> |
| [428](#L428) | <% } %> |
| [429](#L429) | <div><button class="button button-primary"><?php \_e('Save', 'waiting'); ?></button></div> |
| [430](#L430) | </div> |
| [431](#L431) | </form> |
| [432](#L432) |  |
| [433](#L433) | <form id="pbc-other-settings" class="pbc-front-form"> |
| [434](#L434) | <h2 class="pbc-front-form-header wpb-pointer"><?php \_e('On Uninstall', 'waiting'); ?></h2> |
| [435](#L435) | <div class="wpb-zero pbc-front-form-inputs "> |
| [436](#L436) | <div class="pbc-row-field wpb-inline"> |
| [437](#L437) | <div class="pbc-field wpb-inline"> |
| [438](#L438) | <label><input type="checkbox" name="clean\_on\_uninstall" class="wpb-raw" |
| [439](#L439) | <?php echo get\_option('waiting\_clean\_on\_uninstall') ? 'checked' : '' ?> /><?php \_e('Delete countdowns on Uninstall', 'waiting'); ?></label> |
| [440](#L440) | </div> |
| [441](#L441) | </div> |
| [442](#L442) | <div><button class="button button-primary"><?php \_e('Save', 'waiting'); ?></button></div> |
| [443](#L443) | </div> |
| [444](#L444) | </form> |
| [445](#L445) |  |
| [446](#L446) | <div id="pbc-do-upgrade" style="background:#fff;padding:1em;margin-top:1.5em"> |
| [447](#L447) | <h3>Pro version features:</h3> |
| [448](#L448) | <ul> |
| [449](#L449) | <li>Multiple kind of circular styles.</li> |
| [450](#L450) | <li>3D flip styles (calendar & book).</li> |
| [451](#L451) | <li>User's timezone.</li> |
| [452](#L452) | <li>Start / Restart countdown when clicking on a button etc. <b>New</b></li> |
| [453](#L453) | <li>Set cookie to not restart countdown on page reload ( While counting down to seconds. ).</li> |
| [454](#L454) | <li>Literally countless animation directions.</li> |
| [455](#L455) | <li>Multiple countdowns on same page.</li> |
| [456](#L456) | <li>On finish options: Replace countdown with HTML, play YouTube video, play sound.</li> |
| [457](#L457) | <li>Send emails on countdown finish. <b>New</b></li> |
| [458](#L458) | <li>Start / restart coundown on clicking on elements, beep on finish. <b>New</b></li> |
| [459](#L459) | <li>Evergreen countdowns (sticky on top or bottom of the screen).</li> |
| [460](#L460) | <li>Fast effective support (also for the free version :) ).</li> |
| [461](#L461) | </ul> |
| [462](#L462) | <a class="button button-primary"  target="\_blank" href="https://plugin.builders/waiting/?from=wp&v=<?php echo WPB\_Waiting::$version; ?>#pricing">Upgrade</a> |
| [463](#L463) | <a class="button" href="mailto:enquiry@plugin.builders?subject=Waiting Enquiry">Pre-Purchase Question?</a> |
| [464](#L464) | </div> |
| [465](#L465) | </script> |
| [466](#L466) |  |
| [467](#L467) | <script type="text/javascript"> |
| [468](#L468) | <?php |
| [469](#L469) | $terms = WPB\_Waiting::$terms; |
| [470](#L470) | $terms['aui'] = array( |
| [471](#L471) | 'saving' => \_\_('Saving', 'waiting'), |
| [472](#L472) | 'deleting' => \_\_('Deleting', 'waiting') |
| [473](#L473) | ); |
| [474](#L474) | ?> |
| [475](#L475) | var pbc\_translated\_terms = <?php echo json\_encode( $terms ); ?> |
| [476](#L476) | </script> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/waiting/tags/0.6.2/templates/templates.php?format=txt)
* [Original Format](/export/3222685/waiting/tags/0.6.2/templates/templates.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_abef5a8e_20250115_084411.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwaiting%2Ftags%2F0.6.2%2Fwaiting.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/waiting/tags/0.6.2/waiting.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/waiting/tags/0.6.2/waiting.php)

---

# [source:](/browser?order=name "Go to repository root") [waiting](/browser/waiting?order=name "View waiting")/[tags](/browser/waiting/tags?order=name "View tags")/[0.6.2](/browser/waiting/tags/0.6.2?order=name "View 0.6.2")/[waiting.php](/browser/waiting/tags/0.6.2/waiting.php?order=name "View waiting.php")

View diff against:

View revision:

| [Last change](/changeset/2826039/waiting/tags/0.6.2/waiting.php "View differences") on this file was [2826039](/changeset/2826039/ "View changeset 2826039"), checked in by plugin.builders, [2 years ago](/timeline?from=2022-11-29T15%3A34%3A16Z&precision=second "See timeline at 11/29/2022 03:34:16 PM") |
| --- |
| Version 0.6.2 released |
| **File size:** 19.5 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* @package Waiting |
| [4](#L4) | \* @version 0.6.2 |
| [5](#L5) | \*/ |
| [6](#L6) | /\* |
| [7](#L7) | Plugin Name: Waiting |
| [8](#L8) | Plugin URI: https://plugin.builders/waiting/?from=plugins |
| [9](#L9) | Description: One-click countdowns. |
| [10](#L10) | Author: Plugin Builders |
| [11](#L11) | Author URI: https://plugin.builders/?from=plugins |
| [12](#L12) | Version: 0.6.2 |
| [13](#L13) | Text Domain: waiting |
| [14](#L14) | Domain Path: languages |
| [15](#L15) | \*/ |
| [16](#L16) |  |
| [17](#L17) | if( !defined( 'ABSPATH' ) ) exit; |
| [18](#L18) |  |
| [19](#L19) |  |
| [20](#L20) | class WPB\_Waiting{ |
| [21](#L21) | static $version = '0.6.2'; |
| [22](#L22) | static $version\_file = '0.6.2'; |
| [23](#L23) | static $terms = array(); |
| [24](#L24) |  |
| [25](#L25) | function \_\_construct(){ |
| [26](#L26) | $this->translateTerms(); |
| [27](#L27) |  |
| [28](#L28) | global $wpdb; |
| [29](#L29) | $this->table = $wpdb->prefix.'waiting'; |
| [30](#L30) | $this->checkIfTableUpdated(); |
| [31](#L31) |  |
| [32](#L32) | register\_activation\_hook(\_\_FILE\_\_, array($this, 'createTable')); |
| [33](#L33) | register\_uninstall\_hook(\_\_FILE\_\_, array('WPB\_Waiting', 'onUninstall')); |
| [34](#L34) |  |
| [35](#L35) | add\_action('admin\_menu', array($this, 'createMenu')); |
| [36](#L36) | add\_action('admin\_init', array($this, 'deploy')); |
| [37](#L37) | add\_action('widgets\_init', array($this, 'regWidget')); |
| [38](#L38) | add\_action('plugins\_loaded', array($this, 'loadTextDomain') ); |
| [39](#L39) |  |
| [40](#L40) | add\_action('admin\_enqueue\_scripts', array($this, 'loadDashJs')); |
| [41](#L41) | add\_action('wp\_enqueue\_scripts', array($this, 'loadJs')); |
| [42](#L42) |  |
| [43](#L43) | add\_action('wp\_ajax\_pbc\_save\_downs', array($this, 'saveDown')); |
| [44](#L44) | add\_action('wp\_ajax\_pbc\_get\_downs', array($this, 'getDowns')); |
| [45](#L45) | add\_action('wp\_ajax\_pbc\_delete\_down', array($this, 'deleteDown')); |
| [46](#L46) | add\_action('wp\_ajax\_pbc\_save\_lang', array($this, 'saveLang')); |
| [47](#L47) | add\_action('wp\_ajax\_pbc\_save\_other\_settings', array($this, 'saveOtherSettings')); |
| [48](#L48) | add\_action('wp\_ajax\_pbc\_get\_fonts', array($this, 'getFonts')); |
| [49](#L49) |  |
| [50](#L50) | add\_action('pbc\_admin\_script', array($this, 'adminScript')); |
| [51](#L51) |  |
| [52](#L52) | add\_shortcode('waiting', array($this, 'shortcode') ); |
| [53](#L53) | } |
| [54](#L54) |  |
| [55](#L55) | public function loadTextDomain(){ |
| [56](#L56) | load\_plugin\_textdomain( 'waiting', false, dirname( plugin\_basename( \_\_FILE\_\_ ) ) . '/languages' ); |
| [57](#L57) | } |
| [58](#L58) |  |
| [59](#L59) | public function createMenu(){ |
| [60](#L60) | add\_menu\_page( |
| [61](#L61) | 'Waiting', |
| [62](#L62) | 'Waiting', |
| [63](#L63) | apply\_filters('waiting\_page\_roles', 'manage\_options'), |
| [64](#L64) | 'waiting', |
| [65](#L65) | array($this, 'pageTemplate'), |
| [66](#L66) | 'div' |
| [67](#L67) | ); |
| [68](#L68) | } |
| [69](#L69) |  |
| [70](#L70) | public function pageTemplate(){ ?> |
| [71](#L71) | <div class="wrap"> |
| [72](#L72) | <div id="wpb-top"> |
| [73](#L73) | <a class="button pbc-cancel-form wpb-force-hide" id="pbc-back">Cancel</a> |
| [74](#L74) | <div id="waiting-icon" class="wpb-inline"></div> |
| [75](#L75) | <h2 class="wpb-inline" id="waiting-title">Waiting</h2> |
| [76](#L76) | </div> |
| [77](#L77) | <div id="pbc-wrapper" data-version="<?php echo self::$version; ?>"> |
| [78](#L78) | <img src="<?php echo site\_url('wp-admin/images/spinner.gif'); ?>" id="pbc-init-loader"/> |
| [79](#L79) | </div> |
| [80](#L80) | </div> |
| [81](#L81) | <?php |
| [82](#L82) | $this->templates(); |
| [83](#L83) | } |
| [84](#L84) |  |
| [85](#L85) | public function templates(){ |
| [86](#L86) | do\_action('pbc\_templates'); |
| [87](#L87) | include 'templates/templates.php'; |
| [88](#L88) | } |
| [89](#L89) |  |
| [90](#L90) |  |
| [91](#L91) | public function deploy(){} |
| [92](#L92) |  |
| [93](#L93) | public function getDateFormat(){ |
| [94](#L94) | switch( get\_option('date\_format') ) { |
| [95](#L95) | //Predefined WP date formats |
| [96](#L96) | case 'F j, Y': |
| [97](#L97) | return( 'MM dd, yy' ); |
| [98](#L98) | break; |
| [99](#L99) | case 'Y/m/d': |
| [100](#L100) | return( 'yy/mm/dd' ); |
| [101](#L101) | break; |
| [102](#L102) | case 'Y-m-d': |
| [103](#L103) | return( 'yy-mm-dd' ); |
| [104](#L104) | break; |
| [105](#L105) | case 'm/d/Y': |
| [106](#L106) | return( 'mm/dd/yy' ); |
| [107](#L107) | break; |
| [108](#L108) | case 'd/m/Y': |
| [109](#L109) | return( 'dd/mm/yy' ); |
| [110](#L110) | break; |
| [111](#L111) | default: |
| [112](#L112) | return( 'dd/mm/yy' ); |
| [113](#L113) | } |
| [114](#L114) | } |
| [115](#L115) |  |
| [116](#L116) | public function adminScript(){ |
| [117](#L117) | wp\_register\_script('pbc\_admin\_settings', plugins\_url('/js/admin.js?v='.self::$version, \_\_FILE\_\_), array('pbc\_script'), null, 1); |
| [118](#L118) | wp\_enqueue\_script('pbc\_admin\_settings'); |
| [119](#L119) | wp\_localize\_script('pbc\_admin\_settings', 'waiting\_i18n', array( |
| [120](#L120) | 'is\_rtl' => is\_rtl(), |
| [121](#L121) | 'date\_format' => $this->getDateFormat() |
| [122](#L122) | )); |
| [123](#L123) | } |
| [124](#L124) |  |
| [125](#L125) | public function loadDashJs($hook){ |
| [126](#L126) | if($hook === 'toplevel\_page\_waiting'){ |
| [127](#L127) | wp\_register\_script('pb\_countdown', plugins\_url('/js/jquery.countdown.js', \_\_FILE\_\_), array('jquery'), null, 1); |
| [128](#L128) | wp\_enqueue\_script('pb\_countdown'); |
| [129](#L129) | wp\_enqueue\_script('wp-color-picker'); |
| [130](#L130) | wp\_register\_script('pbc\_script', plugins\_url('/js/pbc.js?v='.self::$version, \_\_FILE\_\_), array('pb\_countdown', 'underscore', 'wp-color-picker'), null, 1); |
| [131](#L131) | wp\_enqueue\_script('pbc\_script'); |
| [132](#L132) | do\_action('pbc\_admin\_script'); |
| [133](#L133) | wp\_register\_style('pbc\_admin\_style', plugins\_url('/css/admin-style.css?v='.self::$version, \_\_FILE\_\_)); |
| [134](#L134) | wp\_enqueue\_style('pbc\_admin\_style'); |
| [135](#L135) | wp\_register\_style('pbc\_style', plugins\_url('/css/style.css?v='.self::$version, \_\_FILE\_\_)); |
| [136](#L136) | wp\_enqueue\_style('pbc\_style'); |
| [137](#L137) | wp\_enqueue\_style('wp-color-picker'); |
| [138](#L138) | wp\_enqueue\_script('jquery-ui-datepicker'); |
| [139](#L139) | wp\_register\_style('pbc-jquery-ui', '//ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css'); |
| [140](#L140) | wp\_enqueue\_style( 'pbc-jquery-ui' ); |
| [141](#L141) | } |
| [142](#L142) | $this->menuIconStyle(); |
| [143](#L143) | } |
| [144](#L144) |  |
| [145](#L145) | public function loadJs(){ |
| [146](#L146) | wp\_enqueue\_script( 'jquery' ); |
| [147](#L147) | } |
| [148](#L148) |  |
| [149](#L149) | public function menuIconStyle(){ |
| [150](#L150) | ?> |
| [151](#L151) | <style> |
| [152](#L152) | #toplevel\_page\_waiting.wp-not-current-submenu .wp-menu-image{ |
| [153](#L153) | background:url(<?php echo plugins\_url('/images/waiting-menu-icon.png', \_\_FILE\_\_); ?>) no-repeat 8px; |
| [154](#L154) | } |
| [155](#L155) | #toplevel\_page\_waiting.wp-not-current-submenu .wp-menu-image:hover{ |
| [156](#L156) | background:url(<?php echo plugins\_url('/images/waiting-menu-icon-hover.png', \_\_FILE\_\_); ?>) no-repeat 8px; |
| [157](#L157) | } |
| [158](#L158) | #toplevel\_page\_waiting.current .wp-menu-image{ |
| [159](#L159) | background:url(<?php echo plugins\_url('/images/waiting-menu-icon-current.png', \_\_FILE\_\_); ?>) no-repeat 8px; |
| [160](#L160) | } |
| [161](#L161) | #waiting-icon{ |
| [162](#L162) | width:35px; height:35px; |
| [163](#L163) | background:url(<?php echo plugins\_url('/images/waiting-icon.png', \_\_FILE\_\_); ?>) no-repeat; |
| [164](#L164) | background-size:contain; |
| [165](#L165) | } |
| [166](#L166) | </style> |
| [167](#L167) | <?php |
| [168](#L168) | } |
| [169](#L169) |  |
| [170](#L170) |  |
| [171](#L171) | public function createTable(){ |
| [172](#L172) | $charset\_collate = ''; |
| [173](#L173) | require\_once(ABSPATH.'wp-admin/includes/upgrade.php'); |
| [174](#L174) |  |
| [175](#L175) | if(!empty($wpdb->charset)) $charset\_collate = "DEFAULT CHARACTER SET {$wpdb->charset}"; |
| [176](#L176) |  |
| [177](#L177) | if(!empty($wpdb->collate)) $charset\_collate .= " COLLATE {$wpdb->collate}"; |
| [178](#L178) |  |
| [179](#L179) | $sql = |
| [180](#L180) | "CREATE TABLE IF NOT EXISTS `".$this->table."` ( |
| [181](#L181) | `id` int(11) NOT NULL AUTO\_INCREMENT, |
| [182](#L182) | `name` varchar(255) NOT NULL, |
| [183](#L183) | `template` tinyint(1) NOT NULL DEFAULT '0', |
| [184](#L184) | `data` longtext NOT NULL, |
| [185](#L185) | `offertext` text NOT NULL, |
| [186](#L186) | `replacetext` text NOT NULL, |
| [187](#L187) | `extras` longtext NOT NULL, |
| [188](#L188) | PRIMARY KEY (`id`) |
| [189](#L189) | ) $charset\_collate;"; |
| [190](#L190) |  |
| [191](#L191) | dbDelta($sql); |
| [192](#L192) | } |
| [193](#L193) |  |
| [194](#L194) | public static function onUninstall(){ |
| [195](#L195) | global $wpdb; |
| [196](#L196) |  |
| [197](#L197) | if( get\_option('waiting\_clean\_on\_uninstall') ){ |
| [198](#L198) | $sql = "DROP TABLE IF EXISTS ".$wpdb->prefix.'waiting'; |
| [199](#L199) | $wpdb->query($sql); |
| [200](#L200) | delete\_option('waiting\_clean\_on\_uninstall'); |
| [201](#L201) | delete\_option('pbc\_version'); |
| [202](#L202) | delete\_option('pbc\_waiting\_license\_key'); |
| [203](#L203) | delete\_option('pbc\_waiting\_name'); |
| [204](#L204) | delete\_option('pbc\_license\_status'); |
| [205](#L205) | } |
| [206](#L206) | } |
| [207](#L207) |  |
| [208](#L208) | public function checkIfTableUpdated(){ |
| [209](#L209) | $version = get\_option('pbc\_version'); |
| [210](#L210) | if( !$version ) $this->upgradeTable(); |
| [211](#L211) | else update\_option('pbc\_version', WPB\_Waiting::$version); |
| [212](#L212) | } |
| [213](#L213) |  |
| [214](#L214) | public function upgradeTable(){ |
| [215](#L215) | global $wpdb; |
| [216](#L216) |  |
| [217](#L217) | $sql = "SHOW TABLES LIKE 'wp\_waiting'"; |
| [218](#L218) | $table = $wpdb->query($sql); |
| [219](#L219) |  |
| [220](#L220) | if( $table && $this->table !== 'wp\_waiting'){ |
| [221](#L221) | $sql = 'RENAME TABLE wp\_waiting TO '.$this->table; |
| [222](#L222) | $wpdb->query( $sql ); |
| [223](#L223) | } |
| [224](#L224) |  |
| [225](#L225) | if( $table ){ |
| [226](#L226) | $sql = 'ALTER TABLE '.$this->table.' ADD `extras` longtext NOT NULL'; |
| [227](#L227) | $wpdb->query( $sql ); |
| [228](#L228) | } |
| [229](#L229) |  |
| [230](#L230) | update\_option('pbc\_version', WPB\_Waiting::$version); |
| [231](#L231) | } |
| [232](#L232) |  |
| [233](#L233) | public function regWidget(){ |
| [234](#L234) | register\_widget('WaitingWidget'); |
| [235](#L235) | } |
| [236](#L236) |  |
| [237](#L237) | public function getDowns(){ |
| [238](#L238) | global $wpdb; $re = array(); |
| [239](#L239) | $downs = $wpdb->get\_results('SELECT \* FROM '.$this->table); |
| [240](#L240) |  |
| [241](#L241) | foreach($downs as $down){ |
| [242](#L242) | $re[] = $this->downDetail( $down ); |
| [243](#L243) | } |
| [244](#L244) |  |
| [245](#L245) | wp\_send\_json($re); |
| [246](#L246) | } |
| [247](#L247) |  |
| [248](#L248) | public function inZone( $down ){ |
| [249](#L249) | if($down['meta']['timezone'] !== 'USER'){ |
| [250](#L250) | $now = new DateTime( "NOW" ); |
| [251](#L251) | $tmz = ($down['meta']['timezone'] === 'WP') ? $this->getTimezone() : 'UTC'; |
| [252](#L252) |  |
| [253](#L253) | $now->setTimezone(new DateTimeZone( $tmz )); |
| [254](#L254) | $down['meta']['offset'] = ($tmz === 'UTC') ? $down['meta']['offset'] : (($now->getOffset()/60) + $down['meta']['offset']); |
| [255](#L255) | } else $down['meta']['offset'] = 0; |
| [256](#L256) | return $down; |
| [257](#L257) | } |
| [258](#L258) |  |
| [259](#L259) | public function saveDown(){ |
| [260](#L260) | $down = $this->sanitize( $\_POST['pbc\_down'] ); |
| [261](#L261) |  |
| [262](#L262) | $re = array(); |
| [263](#L263) | $id = $down['meta']['id']; |
| [264](#L264) | $down = $this->inZone( $down ); |
| [265](#L265) | $re[] = $this->countdownTo($down); |
| [266](#L266) |  |
| [267](#L267) | $html = $down['html']; |
| [268](#L268) | unset($down['html']); |
| [269](#L269) |  |
| [270](#L270) | $html['replacetext'] = isset($html['replacetext']) ? $html['replacetext'] : ''; |
| [271](#L271) | $html['offertext'] = isset($html['offertext']) ? $html['offertext'] : ''; |
| [272](#L272) |  |
| [273](#L273) | global $wpdb; |
| [274](#L274) | if($id === 'nw'){ |
| [275](#L275) | $wpdb->insert($this->table, array( |
| [276](#L276) | 'name' => $down['meta']['name'], |
| [277](#L277) | 'data' => maybe\_serialize($down), |
| [278](#L278) | 'offertext' => $html['offertext'], |
| [279](#L279) | 'replacetext' => $html['replacetext'] |
| [280](#L280) | )); |
| [281](#L281) | $re[] = $wpdb->insert\_id; |
| [282](#L282) | } else { |
| [283](#L283) | $extras = maybe\_unserialize( $wpdb->get\_var("SELECT `extras` FROM ".$this->table." WHERE `id` = ".$id) ); |
| [284](#L284) | if( isset( $extras['emailed'] ) ) unset( $extras['emailed'] ); |
| [285](#L285) | $sql = "UPDATE ".$this->table." |
| [286](#L286) | SET |
| [287](#L287) | `name` = %s, |
| [288](#L288) | `data` = %s, |
| [289](#L289) | `offertext` = %s, |
| [290](#L290) | `replacetext` = %s, |
| [291](#L291) | `extras` = %s |
| [292](#L292) | WHERE id = ".$id; |
| [293](#L293) | //echo $wpdb->prepare( $sql, array($down['meta']['name'], maybe\_serialize($down), $html['offertext'], $html['replacetext'], maybe\_serialize( $extras ) ) ); |
| [294](#L294) | $wpdb->query( $wpdb->prepare( $sql, array($down['meta']['name'], maybe\_serialize($down), $html['offertext'], $html['replacetext'], maybe\_serialize( $extras ) ) )); |
| [295](#L295) | $re[] = $id; |
| [296](#L296) | } |
| [297](#L297) | wp\_send\_json($re); |
| [298](#L298) | } |
| [299](#L299) |  |
| [300](#L300) | public static function getTimestampWithFallback( $time ){ |
| [301](#L301) | return method\_exists('DateTime', 'getTimestamp') ? |
| [302](#L302) | $time->getTimestamp() : $time->format('U'); |
| [303](#L303) | } |
| [304](#L304) |  |
| [305](#L305) | static function secondsToTime($seconds) { |
| [306](#L306) | $dtF = new \DateTime('@0'); |
| [307](#L307) | $dtT = new \DateTime("@$seconds"); |
| [308](#L308) | return $dtF->diff($dtT)->format('%a %h %i %s'); |
| [309](#L309) | } |
| [310](#L310) |  |
| [311](#L311) | public static function countdownTo( $down ){ |
| [312](#L312) | $ofs = $down['meta']['offset']\*60; |
| [313](#L313) |  |
| [314](#L314) | $from = round($down['meta']['occurence'][0][0]); |
| [315](#L315) | $from = new DateTime( '@'.$from ); |
| [316](#L316) | $from = self::getTimestampWithFallback( $from ); |
| [317](#L317) | $from -= $ofs; |
| [318](#L318) |  |
| [319](#L319) | if($down['meta']['insta'][0]){          // Countdown to duration |
| [320](#L320) | return array($from\*1000, $down['meta']['occurence'][0][1]\*1000); |
| [321](#L321) | } |
| [322](#L322) |  |
| [323](#L323) | $to = $down['meta']['occurence'][0][1]; |
| [324](#L324) | $to = new DateTime( '@'.$to ); |
| [325](#L325) | $to = self::getTimestampWithFallback( $to ); |
| [326](#L326) | $to -= $ofs; |
| [327](#L327) |  |
| [328](#L328) | $now = self::getTimestampWithFallback( new DateTime() ); |
| [329](#L329) |  |
| [330](#L330) | if( $to - $now  < 1 ){ |
| [331](#L331) | //$to = 1000; //next start; |
| [332](#L332) | } |
| [333](#L333) |  |
| [334](#L334) | //if(!is\_admin()) var\_dump( [$to-$now, self::secondsToTime($to-$now)] ); |
| [335](#L335) |  |
| [336](#L336) | return array($from\*1000, $to\*1000); |
| [337](#L337) | } |
| [338](#L338) |  |
| [339](#L339) | public function deleteDown(){ |
| [340](#L340) | global $wpdb; |
| [341](#L341) | $key = sanitize\_text\_field( $\_POST['pbc\_down'] ); |
| [342](#L342) | $re = $wpdb->query("DELETE FROM ".$this->table." WHERE id = $key"); |
| [343](#L343) | echo $re; |
| [344](#L344) | die(); |
| [345](#L345) | } |
| [346](#L346) |  |
| [347](#L347) | public static function getDown( $name ){ |
| [348](#L348) | global $wpdb; |
| [349](#L349) | $down = $wpdb->get\_row( $wpdb->prepare( "SELECT \* FROM ".$wpdb->prefix."waiting WHERE `name` = %s", array( addslashes($name) )) ); |
| [350](#L350) | return self::downDetail( $down, true ); |
| [351](#L351) | } |
| [352](#L352) |  |
| [353](#L353) | public static function sss($s){ |
| [354](#L354) | return stripslashes( html\_entity\_decode($s) ); |
| [355](#L355) | } |
| [356](#L356) |  |
| [357](#L357) | public static function downDetail( $down, $single = false ){ |
| [358](#L358) | if(!$down) return false; |
| [359](#L359) | $id = $down->id; |
| [360](#L360) | $down->data = maybe\_unserialize($down->data); |
| [361](#L361) | $down->data['html'] = array('offertext' => self::sss($down->offertext), 'replacetext' => self::sss($down->replacetext), 'd'=>''); |
| [362](#L362) | $down->data['meta']['id'] = $id; |
| [363](#L363) | $down->data['meta']['name'] = stripslashes($down->data['meta']['name']) ; |
| [364](#L364) | $down->data['meta']['to'] = self::countdownTo($down->data); |
| [365](#L365) | if($single) unset($down->data['meta']['occurence']); |
| [366](#L366) | return $down->data; |
| [367](#L367) | } |
| [368](#L368) |  |
| [369](#L369) | public static function getTimezone() { |
| [370](#L370) | if ( $timezone = get\_option( 'timezone\_string' ) ) |
| [371](#L371) | return $timezone; |
| [372](#L372) |  |
| [373](#L373) | if ( 0 === ( $utc\_offset = get\_option( 'gmt\_offset', 0 ) ) ) |
| [374](#L374) | return 'UTC'; |
| [375](#L375) |  |
| [376](#L376) | // adjust UTC offset from hours to seconds |
| [377](#L377) | $utc\_offset \*= 3600; |
| [378](#L378) |  |
| [379](#L379) | if ( $timezone = timezone\_name\_from\_abbr( '', $utc\_offset, 0 ) ) { |
| [380](#L380) | return $timezone; |
| [381](#L381) | } |
| [382](#L382) |  |
| [383](#L383) | $is\_dst = date( 'I' ); |
| [384](#L384) |  |
| [385](#L385) | foreach ( timezone\_abbreviations\_list() as $abbr ) { |
| [386](#L386) | foreach ( $abbr as $city ) { |
| [387](#L387) | if ( $city['dst'] == $is\_dst && $city['offset'] == $utc\_offset ) |
| [388](#L388) | return $city['timezone\_id']; |
| [389](#L389) | } |
| [390](#L390) | } |
| [391](#L391) |  |
| [392](#L392) | // fallback to UTC |
| [393](#L393) | return 'UTC'; |
| [394](#L394) | } |
| [395](#L395) |  |
| [396](#L396) | public static function downs(){ |
| [397](#L397) | global $wpdb; |
| [398](#L398) | return $wpdb->get\_results('SELECT `name` from '.$wpdb->prefix.'waiting'); |
| [399](#L399) | } |
| [400](#L400) |  |
| [401](#L401) |  |
| [402](#L402) | /\*\* |
| [403](#L403) |  |
| [404](#L404) | Shortcode |
| [405](#L405) |  |
| [406](#L406) | \*\*/ |
| [407](#L407) |  |
| [408](#L408) | public function shortcode($atts){ |
| [409](#L409) | $atts = shortcode\_atts( |
| [410](#L410) | array( |
| [411](#L411) | 'name' => '', |
| [412](#L412) | ), $atts ); |
| [413](#L413) |  |
| [414](#L414) | return self::output( $atts['name'] ); |
| [415](#L415) | } |
| [416](#L416) |  |
| [417](#L417) | public static function output( $name ){ |
| [418](#L418) | $name = html\_entity\_decode($name); |
| [419](#L419) | if(!$name) return ''; |
| [420](#L420) | if($down = self::getDown($name)) |
| [421](#L421) | return self::outputString( $down ); |
| [422](#L422) | return '<span class="pbc-wrong-shortcode"></span>'; |
| [423](#L423) | } |
| [424](#L424) |  |
| [425](#L425) | public function translateTerms(){ |
| [426](#L426) |  |
| [427](#L427) | /\*$url = home\_url(add\_query\_arg(null,null)); |
| [428](#L428) |  |
| [429](#L429) | // Write English term for each unit below. |
| [430](#L430) |  |
| [431](#L431) | $English = array( |
| [432](#L432) | 'years' => 'English for years', |
| [433](#L433) | 'months' => '', |
| [434](#L434) | 'weeks' => '', |
| [435](#L435) | 'days' => '', |
| [436](#L436) | 'hours' => '', |
| [437](#L437) | 'minutes' => '', |
| [438](#L438) | 'seconds' => 'e' |
| [439](#L439) | ); |
| [440](#L440) |  |
| [441](#L441) | // Write Thai term for each unit below. |
| [442](#L442) |  |
| [443](#L443) | $Thai = array( |
| [444](#L444) | 'years' => 'Thai for years', |
| [445](#L445) | 'months' => '', |
| [446](#L446) | 'weeks' => '', |
| [447](#L447) | 'days' => '', |
| [448](#L448) | 'hours' => '', |
| [449](#L449) | 'minutes' => '', |
| [450](#L450) | 'seconds' => 't' |
| [451](#L451) | ); |
| [452](#L452) |  |
| [453](#L453) | self::$terms['units'] = ( strpos($url, 'thai') === false ? $English : $Thai ); |
| [454](#L454) | \*/ |
| [455](#L455) |  |
| [456](#L456) | self::$terms['fui'] = array(); |
| [457](#L457) |  |
| [458](#L458) | //return false; |
| [459](#L459) |  |
| [460](#L460) | $units = get\_option('pbc\_unit\_terms'); |
| [461](#L461) | self::$terms['units'] = $units ? $units : array( |
| [462](#L462) | 'years' => \_\_('Years', 'waiting'), |
| [463](#L463) | 'months' => \_\_('Months', 'waiting'), |
| [464](#L464) | 'weeks' => \_\_('Weeks', 'waiting'), |
| [465](#L465) | 'days' => \_\_('Days', 'waiting'), |
| [466](#L466) | 'hours' => \_\_('Hours', 'waiting'), |
| [467](#L467) | 'minutes' => \_\_('Minutes', 'waiting'), |
| [468](#L468) | 'seconds' => \_\_('Seconds', 'waiting') |
| [469](#L469) | ); |
| [470](#L470) | } |
| [471](#L471) |  |
| [472](#L472) | public function getFonts(){ |
| [473](#L473) | include 'templates/fonts.php'; |
| [474](#L474) | wp\_send\_json( pbcGoogleFonts() ); |
| [475](#L475) | } |
| [476](#L476) |  |
| [477](#L477) | public static function outputString( $down ){ |
| [478](#L478) | $cd\_url = plugins\_url('/js/jquery.countdown.js', \_\_FILE\_\_); |
| [479](#L479) | $url = plugins\_url('/js/pbc.js?v='.self::$version, \_\_FILE\_\_); |
| [480](#L480) | $css\_url = plugins\_url('/css/style.css?v='.self::$version, \_\_FILE\_\_); |
| [481](#L481) | $font\_url = '//fonts.googleapis.com/css?family='.$down['style']['css']['unit'][3]; |
| [482](#L482) |  |
| [483](#L483) | $html = $down['html']; |
| [484](#L484) |  |
| [485](#L485) | unset($down['html']); |
| [486](#L486) | unset($down['extras']); |
| [487](#L487) | if( $down['meta']['onfinish'][0] === 'email' ) |
| [488](#L488) | unset( $down['meta']['onfinish'][1] ); |
| [489](#L489) |  |
| [490](#L490) | return '<div class="pbc-cover wpb-inline" dir="ltr" data-pbc-setup="" data-countdown="'. htmlentities( json\_encode($down) ) .'">'. |
| [491](#L491) | self::rawDowntexts($html) |
| [492](#L492) | .'</div> |
| [493](#L493) | <script data-cfasync="false" type="text/javascript"> |
| [494](#L494) | var PBCUtils = PBCUtils || {}; |
| [495](#L495) | PBCUtils.ajaxurl = "'. admin\_url( 'admin-ajax.php' ) .'"; |
| [496](#L496) | PBCUtils.url = "'. plugins\_url('/', \_\_FILE\_\_) .'"; |
| [497](#L497) | (function(){ |
| [498](#L498) | if(!PBCUtils.loaded){ |
| [499](#L499) | PBCUtils.loaded = true; |
| [500](#L500) | function PBC\_Loader(){ |
| [501](#L501) | PBCUtils.lang = '.json\_encode(self::$terms).'; |
| [502](#L502) | var script = document.createElement("script"); |
| [503](#L503) | script.src = "'. $cd\_url .'"; |
| [504](#L504) | script.setAttribute("data-cfasync", "false"); |
| [505](#L505) | script.setAttribute("type", "text/javascript"); |
| [506](#L506) | document.querySelector("head").appendChild(script); |
| [507](#L507) |  |
| [508](#L508) | script = document.createElement("script"); |
| [509](#L509) | script.setAttribute("data-cfasync", "false"); |
| [510](#L510) | script.setAttribute("type", "text/javascript"); |
| [511](#L511) | script.src = "'. $url .'"; |
| [512](#L512) | document.querySelector("head").appendChild(script); |
| [513](#L513) | var style = document.createElement("link"); |
| [514](#L514) | style.rel = "stylesheet"; |
| [515](#L515) | style.href = "'. $css\_url .'"; |
| [516](#L516) | style.type = "text/css"; |
| [517](#L517) | document.querySelector("head").appendChild(style);'. |
| [518](#L518) | ( |
| [519](#L519) | $down['style']['css']['unit'][3] === 'inherit' ? '' : |
| [520](#L520) | 'style = document.createElement("link"); |
| [521](#L521) | style.rel = "stylesheet"; |
| [522](#L522) | style.href = "'. $font\_url .'"; |
| [523](#L523) | style.type = "text/css"; |
| [524](#L524) | document.querySelector("head").appendChild(style);' |
| [525](#L525) | ).' |
| [526](#L526) | } |
| [527](#L527) | if(window.jQuery){PBC\_Loader();}else { var pbctimer2324 = window.setInterval(function(){ |
| [528](#L528) | if(window.jQuery){PBC\_Loader(); window.clearInterval(pbctimer2324); } |
| [529](#L529) | }, 250);} |
| [530](#L530) | '. |
| [531](#L531) | '} else { if(PBCUtils.em) PBCUtils.em.trigger("pbc.run");} |
| [532](#L532) | }()); |
| [533](#L533) | </script>'; |
| [534](#L534) | } |
| [535](#L535) |  |
| [536](#L536) | public static function rawDowntexts( $htmls ){ |
| [537](#L537) | $text = ''; |
| [538](#L538) | foreach($htmls as $key=>$html){ |
| [539](#L539) | $text .= '<div class="wpb-force-hide pbc-downtext-raw pbc-'.$key.'-raw">'.$html.'</div>'; |
| [540](#L540) | } |
| [541](#L541) | return $text; |
| [542](#L542) | } |
| [543](#L543) |  |
| [544](#L544) | public function saveLang(){ |
| [545](#L545) | $lang = $this->sanitize( $\_POST['pbc\_lang'] ); |
| [546](#L546) | echo update\_option('pbc\_unit\_terms', $lang); |
| [547](#L547) | die(); |
| [548](#L548) | } |
| [549](#L549) |  |
| [550](#L550) | public function saveOtherSettings(){ |
| [551](#L551) | $clean = intval( $\_POST['pbc\_clean\_on\_uninstall'] ); |
| [552](#L552) | echo update\_option('waiting\_clean\_on\_uninstall', $clean); |
| [553](#L553) | die(); |
| [554](#L554) | } |
| [555](#L555) |  |
| [556](#L556) | /\*\* |
| [557](#L557) |  |
| [558](#L558) | Sanitizing |
| [559](#L559) |  |
| [560](#L560) | \*\*/ |
| [561](#L561) |  |
| [562](#L562) | public $fields = array('offertext' => 'html', 'replacetext' => 'html'); |
| [563](#L563) |  |
| [564](#L564) | public function sanitize($ins){ |
| [565](#L565) | return $this->validation( $ins ); |
| [566](#L566) | } |
| [567](#L567) |  |
| [568](#L568) | public function validation( $ins ){ |
| [569](#L569) | $rins = array(); |
| [570](#L570) | foreach($ins as $key=>$value){ |
| [571](#L571) | $rins[$key] = $this->validateField( $key, $value ); |
| [572](#L572) | } |
| [573](#L573) | return $rins; |
| [574](#L574) | } |
| [575](#L575) |  |
| [576](#L576) | public function validateField( $k, $val ){ |
| [577](#L577) | if(is\_array($val)){ |
| [578](#L578) | $clean\_val = $this->validation( $val ); |
| [579](#L579) | } else { |
| [580](#L580) | $clean\_val = $this->cleanse( |
| [581](#L581) | ( array\_key\_exists($k, $this->fields) ? $this->fields[$k] : 'string' ), |
| [582](#L582) | $val); |
| [583](#L583) | } |
| [584](#L584) | return $clean\_val; |
| [585](#L585) | } |
| [586](#L586) |  |
| [587](#L587) | public function cleanse($type, $value){ |
| [588](#L588) | switch($type){ |
| [589](#L589) | case 'int': |
| [590](#L590) | return intval($value); |
| [591](#L591) | break; |
| [592](#L592) | case 'url': |
| [593](#L593) | return esc\_url($value); |
| [594](#L594) | break; |
| [595](#L595) | case 'html': |
| [596](#L596) | return esc\_html( wp\_kses\_post( (string)$value ) ); |
| [597](#L597) | break; |
| [598](#L598) | default: |
| [599](#L599) | return sanitize\_text\_field($value); |
| [600](#L600) | break; |
| [601](#L601) | } |
| [602](#L602) | } |
| [603](#L603) |  |
| [604](#L604) | } |
| [605](#L605) |  |
| [606](#L606) |  |
| [607](#L607) |  |
| [608](#L608) | class WaitingWidget extends WP\_Widget{ |
| [609](#L609) |  |
| [610](#L610) | public $wpb\_id = 'wpb\_waiting'; |
| [611](#L611) | public $wpb\_name = 'Waiting'; |
| [612](#L612) | public $wpb\_description = 'One-click countdowns'; |
| [613](#L613) |  |
| [614](#L614) | function \_\_construct(){ |
| [615](#L615) | parent::\_\_construct( |
| [616](#L616) | $this->wpb\_id, |
| [617](#L617) | \_\_($this->wpb\_name, 'waiting'), |
| [618](#L618) | array('description' => \_\_($this->wpb\_description, 'waiting')) |
| [619](#L619) | ); |
| [620](#L620) | } |
| [621](#L621) |  |
| [622](#L622) | public function widget($args, $instance){ |
| [623](#L623) | echo $args['before\_widget']; ?> |
| [624](#L624) | <?php echo $args['before\_title'] . apply\_filters( 'widget\_title', $instance['title'] ). $args['after\_title']; ?> |
| [625](#L625) | <div class="pbc-wrapper"> |
| [626](#L626) | <?php echo WPB\_Waiting::output( $instance['key'] ); ?> |
| [627](#L627) | </div> |
| [628](#L628) | <?php echo $args['after\_widget']; |
| [629](#L629) | } |
| [630](#L630) |  |
| [631](#L631) | public function form($instance){ |
| [632](#L632) | $title = empty($instance['title']) ? '' : $instance['title']; |
| [633](#L633) | $key = empty($instance['key']) ? '' : $instance['key']; |
| [634](#L634) | ?> |
| [635](#L635) |  |
| [636](#L636) | <div> |
| [637](#L637) | <label for="<?php echo $this->get\_field\_id('title'); ?>"><?php \_e('Title', 'waiting'); ?>:</label> |
| [638](#L638) | <input class="widefat" id="<?php echo $this->get\_field\_id('title'); ?>" name="<?php echo $this->get\_field\_name('title'); ?>" value="<?php echo $title; ?>" /> |
| [639](#L639) | </div> |
| [640](#L640) |  |
| [641](#L641) | <div> |
| [642](#L642) | <label for="<?php echo $this->get\_field\_id('key'); ?>"><?php \_e('Name', 'waiting'); ?>:</label> |
| [643](#L643) | <select class="widefat" id="<?php echo $this->get\_field\_id('key'); ?>" name="<?php echo $this->get\_field\_name('key'); ?>"> |
| [644](#L644) | <?php foreach(WPB\_Waiting::downs() as $d): ?> |
| [645](#L645) | <option value="<?php echo $d->name; ?>" <?php echo $d->name == $key ? 'selected' : ''; ?>><?php echo $d->name; ?></option> |
| [646](#L646) | <?php endforeach; ?> |
| [647](#L647) | <select/> |
| [648](#L648) | </div> |
| [649](#L649) |  |
| [650](#L650) | <?php |
| [651](#L651) | } |
| [652](#L652) |  |
| [653](#L653) | public function update($n, $o){ |
| [654](#L654) | $instance = array(); |
| [655](#L655) | $instance['title'] = $n['title'] ? $n['title'] : ''; |
| [656](#L656) | $instance['key'] = $n['key'] ? $n['key'] : 'Please select one'; |
| [657](#L657) | return $instance; |
| [658](#L658) | } |
| [659](#L659) |  |
| [660](#L660) | } |
| [661](#L661) |  |
| [662](#L662) |  |
| [663](#L663) |  |
| [664](#L664) | new WPB\_Waiting(); |
| [665](#L665) |  |
| [666](#L666) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/waiting/tags/0.6.2/waiting.php?format=txt)
* [Original Format](/export/3222685/waiting/tags/0.6.2/waiting.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_b40f6ec1_20250115_084413.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Waiting: One-click countdowns <= 0.6.2 - Missing Authorization Checks leading to Authenticated (Subscriber+) Stored Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Waiting: One-click countdowns <= 0.6.2 - Missing Authorization Checks leading to Authenticated (Subscriber+) Stored Cross-Site Scripting

7.4

**Missing Authorization**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L)

| CVE | [CVE-2023-2757](https://www.cve.org/CVERecord?id=CVE-2023-2757) |
| --- | --- |
| CVSS | 7.4 (High) |
| Publicly Published | May 17, 2023 |
| Last Updated | January 22, 2024 |
| Researcher | [István Márton - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/lana-codes) |

### Description

The Waiting: One-click countdowns plugin for WordPress is vulnerable to authorization bypass due to a missing capability check on 'saveLang' functions in versions up to, and including, 0.6.2. This could lead to Cross-Site Scripting due to insufficient input sanitization and output escaping. This makes it possible for subscriber-level attackers to access functions to save plugin data that can potentially lead to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/waiting/tags/0.6.2/templates/templates.php#L426)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/waiting/tags/0.6.2/waiting.php#L544)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwaiting%2Fwaiting-one-click-countdowns-062-missing-authorization-checks-leading-to-authenticated-subscriber-stored-cross-site-scripting&t=Waiting%3A%20One-click%20countdowns%20%3C%3D%200.6.2%20-%20Missing%20Authorization%20Checks%20leading%20to%20Authenticated%20%28Subscriber%2B%29%20Stored%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwaiting%2Fwaiting-one-click-countdowns-062-missing-authorization-checks-leading-to-authenticated-subscriber-stored-cross-site-scripting&text=Waiting%3A%20One-click%20countdowns%20%3C%3D%200.6.2%20-%20Missing%20Authorization%20Checks%20leading%20to%20Authenticated%20%28Subscriber%2B%29%20Stored%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwaiting%2Fwaiting-one-click-countdowns-062-missing-authorization-checks-leading-to-authenticated-subscriber-stored-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for Waiting: One-click countdowns

#### [Waiting: One-click countdowns](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/waiting)

| Software Type | Plugin |
| --- | --- |
| Software Slug | waiting [(view on wordpress.org)](https://wordpress.org/plugins/waiting) |
| Patched? | No |
| Remediation | No known patch available. Please review the vulnerability's details in depth and employ mitigations based on your organization's risk tolerance. It may be best to uninstall the affected software and find a replacement. |
| Affected Version | * <= 0.6.2 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


