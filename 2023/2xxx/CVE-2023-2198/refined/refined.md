```json
{
  "vulnerability": {
    "root_cause": "The vulnerability is caused by a regular expression denial-of-service (ReDoS) in the `inline_diff_filter` method.",
    "weaknesses": [
      "The regular expression `/(?:[\\-\](.*?)\-\]|\{\\-\}(.*?)\-\})/` used in the `inline_diff_filter` method is vulnerable to backtracking when processing specially crafted strings.",
      "The vulnerability lies within the `InlineDiffFilter` that processes Markdown fields."
     ],
    "impact": "An unauthenticated attacker can cause a denial-of-service (DoS) by sending crafted requests to the `preview_markdown` endpoint, leading to high CPU usage, delayed responses, and eventually, an unresponsive GitLab instance. This also affects other components that rely on HTTP communication with the instance, such as integrations, runners, and GitLab Pages.",
    "attack_vector": "An attacker sends a crafted JSON payload containing a long string of `[-{-` repeated many times to the `/groups/[PUBLIC_GROUP_NAME]/preview_markdown` endpoint.",
    "attacker_capabilities": "The attacker does not need to be authenticated, and can trigger the vulnerability via an unauthenticated request. The attacker needs to be able to send HTTP requests to the GitLab instance."
  },
  "technical_details": {
    "vulnerable_code": "The vulnerable regex exists in `lib/banzai/filter/inline_diff_filter.rb`:\n```ruby\ndef inline_diff_filter(text)\n  html_content = text.gsub(/(?:[\\-\](.*?)\-\]|\{\\-\}(.*?)\-\})/, '<span class=\"idiff left right deletion\">\\1\\2</span>')\n```\n",
    "payload_example": "The crafted string can be easily generated with the Ruby code `\"[-{-" * 250_000` and is submitted within the JSON payload for the `preview_markdown` endpoint.",
    "steps_to_reproduce": [
      "Set up a GitLab instance and create a public group.",
      "Obtain the CSRF token and session ID of an unauthenticated user by accessing the public group page.",
      "Construct a curl command with the CSRF token, session ID and crafted payload.",
       "Repeatedly send the crafted request to `/groups/[PUBLIC_GROUP_NAME]/preview_markdown` endpoint."
   ]
  },
    "cvss_score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H (8.6 High)"
}
```