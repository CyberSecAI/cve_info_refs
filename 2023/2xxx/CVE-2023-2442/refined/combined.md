=== Content from gitlab.com_ac13120a_20250115_102441.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored-XSS with CSP-bypass in Merge requests

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #1965750](https://hackerone.com/reports/1965750)** by `yvvdwf` on 2023-04-28, assigned to [@rshambhuni](/rshambhuni "Rohit Shambhuni"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

Hi,

Gitlab recently [added icon to indicate fork](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/116284 "Merge request header: add icon to indicate fork") in the Merge requests page. This modification indicates `source_branch` as `html_safe`, which can cause XSS:

```
###  https://gitlab.com/gitlab-org/gitlab/-/blob/f728534d7f6a357cf049cfd7a640a32504a1b9d6/app/helpers/merge_requests_helper.rb#L251
    branch_title = if merge_request.for_fork?
                     _('%{source_project_path}:%{source_branch}').html_safe % { source_project_path: merge_request.source_project_path.html_safe, source_branch: merge_request.source_branch.html_safe }
                   else
                     merge_request.source_branch
                   end
```

### Reproduce

1. Within the current user, e.g., `user_a`, create a public project `user_a/a`
2. Switch to another user, e.g., `user_b`:

   2.1. Fork `https://gitlab.com/user_a/a` to a public project `user_b/b`

   2.2. Clone `user_b/b` to your local machine using `ssh`: `git clone git@gitlab.com:user_b/b`

   2.3. Push a new branch to `user_b/b`:

```
   git clone git@gitlab.com:user_b/b
   cd b
   git push origin HEAD:"XSS<i/class=hidden><form/class=gl-show-field-errors><input/title='<script>alert(document.domain)</script>'>"
```

2.4. Back to the website gitlab.com, create a new merge request from the created branch above to `user_a/a`

2.5. After creating the merge request, you should see a popup that is created by `<script>alert(document.domain)</script>`

3. The XSS should be existing at: `https://gitlab.com/user_a/a/-/merge_requests/1`
4. Example: <https://gitlab.com/yvvdwf/test-xss-in-merge-request-via-fork/-/merge_requests/1> (in private mode)

#### Impact

Stored-XSS with CSP-bypass allows attackers to execute arbitrary actions on behalf of victims at the client side.

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_35522373_20250115_102440.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-2442.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-2442.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-2442.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-2442.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ðŸ¤– GitLab Bot ðŸ¤–'s avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ðŸ¤– GitLab Bot ðŸ¤–")](/gitlab-bot)

  Jun 06, 2023

  [25568919](/gitlab-org/cves/-/commit/25568919c641051953c2fea95017e4a390b1d902)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/25568919c641051953c2fea95017e4a390b1d902)
  Â·
  25568919

  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Jun 06, 2023

  25568919

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/25568919c641051953c2fea95017e4a390b1d902)
  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Jun 06, 2023

Loading


