=== Content from medium.com_be68bcad_20250115_092920.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F685bb1675dfb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40cyberninja717%2Freflected-cross-site-scripting-vulnerability-in-ellucian-ethos-identity-cas-logout-page-685bb1675dfb&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40cyberninja717%2Freflected-cross-site-scripting-vulnerability-in-ellucian-ethos-identity-cas-logout-page-685bb1675dfb&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# **Reflected Cross-Site Scripting Vulnerability in Ellucian Ethos Identity CAS Logout Page**

[![Cyberninja717](https://miro.medium.com/v2/resize:fill:88:88/1*EbUPXbIdqT5rwNa5bAHiDQ.jpeg)](/%40cyberninja717?source=post_page---byline--685bb1675dfb--------------------------------)

[Cyberninja717](/%40cyberninja717?source=post_page---byline--685bb1675dfb--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F583ea7eba1d4&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40cyberninja717%2Freflected-cross-site-scripting-vulnerability-in-ellucian-ethos-identity-cas-logout-page-685bb1675dfb&user=Cyberninja717&userId=583ea7eba1d4&source=post_page-583ea7eba1d4--byline--685bb1675dfb---------------------post_header-----------)

3 min read·May 20, 2023

--

1

Listen

Share

**By: Andrew Schoonmaker and Clint Kehr**

*The authors would like to thank the Ellucian Product Security Team for their partnership and swift action in remediating this vulnerability.*

Summary: We identified a Reflected Cross-Site Scripting (XSS) vulnerability in the Ellucian Ethos Identity CAS logout endpoint. This is only exploitable in a CAS deployment.

CVSS: 4.7 (Medium)

<https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N>

We wrote this blog to highlight the process we followed to escalate an arbitrary domain redirect into a cross-site scripting (XSS) vulnerability that required bypassing strong input validation controls.

In late April 2023, we discovered when logging out of a college website, that there was a “url” parameter present within the URI that controlled a redirect value in an html [tag](https://www.w3schools.com/tags/tag_a.asp) stating, “Return to your application.”

Changing the url parameter to an arbitrary origin, such as “example.com,” or “abcd” created an [href](https://www.w3schools.com/tags/att_a_href.asp) attribute to that domain:

![]()

(Figure 1: “url” parameter allows for arbitrary origins reflected in an href attribute)

Further research resulted in finding a second parameter, “service,” also allowing arbitrary origins to be rendered as an href attribute.

![]()

(Figure 2: “service” parameter allows for arbitrary origins reflected in an href attribute)

Attempting to use the word “javascript,” along with a colon resulted in the payload being blocked by the WAF.

Analyzing the HTML further, we added a double quote along with a closing angle bracket, which allowed for successful HTML injection.

![]()

(Figure 3: String breakout from href attribute)

Through trial and error of HTML tags, we were able to discover that only a few were able to bypass WAF protections. These included <iframe>, <svg>, and <image>. We were then able to inject iframes from 3rd party domains into the webpage.

![]()

(Figure 4: Bypassing WAF protections to inject an iframe from a 3rd party source)

Although manipulating the href attribute to an arbitrary origin and HTML injection was sufficient to prove a vulnerability existed, we wanted to further prove out XSS was possible. We experimented with Javascript [events](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet) and learned some, like “onload” were blocked, whereas “onerror” was allowed.

![]()

(Figure 5: WAF Bypass using Javascript “onerror” event)

With the significant hurdles attempting to bypass input validation controls, we were finally able to find a successful bypass with the following payload:

**https://<redacted>/cas/logout?url=http://example.com%22%3E%3Csvg%3E%3Cimage%20xlink:href=%22path/to/image.jpg%22%20onerror=confirm(document.location)%3E**

![]()

(Figure 6: full bypass resulting in successful XSS)

After successfully bypassing the WAF and executing XSS, we discovered that other colleges were using the same software and possibly vulnerable. We then contacted the vendor, Ellucian, and reported the vulnerability to them. Below is the timeline of events.

Timeline:

April 19, 2023 — Vulnerability discovered

April 20, 2023 — Ellucian Product Security Team notified

May 9, 2023 — Vulnerability remediated by Ellucian

May 20, 2023 — assigned [CVE-2023-2822](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2822)

[Pentesting](/tag/pentesting?source=post_page-----685bb1675dfb--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----685bb1675dfb--------------------------------)[Ethical Hacking](/tag/ethical-hacking?source=post_page-----685bb1675dfb--------------------------------)[Bug Bounty](/tag/bug-bounty?source=post_page-----685bb1675dfb--------------------------------)[Hacking](/tag/hacking?source=post_page-----685bb1675dfb--------------------------------)

--

--

1

[![Cyberninja717](https://miro.medium.com/v2/resize:fill:96:96/1*EbUPXbIdqT5rwNa5bAHiDQ.jpeg)](/%40cyberninja717?source=post_page---post_author_info--685bb1675dfb--------------------------------)[![Cyberninja717](https://miro.medium.com/v2/resize:fill:128:128/1*EbUPXbIdqT5rwNa5bAHiDQ.jpeg)](/%40cyberninja717?source=post_page---post_author_info--685bb1675dfb--------------------------------)Follow[## Written by Cyberninja717](/%40cyberninja717?source=post_page---post_author_info--685bb1675dfb--------------------------------)[24 Followers](/%40cyberninja717/followers?source=post_page---post_author_info--685bb1675dfb--------------------------------)·[24 Following](/%40cyberninja717/following?source=post_page---post_author_info--685bb1675dfb--------------------------------)

a humble student of infosec traveling the cyberverse for knowledge

Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----685bb1675dfb--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----685bb1675dfb--------------------------------)[About](/about?autoplay=1&source=post_page-----685bb1675dfb--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----685bb1675dfb--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----685bb1675dfb--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----685bb1675dfb--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----685bb1675dfb--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----685bb1675dfb--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----685bb1675dfb--------------------------------)[Teams](/business?source=post_page-----685bb1675dfb--------------------------------)



=== Content from medium.com_b9655679_20250115_092920.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F685bb1675dfb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40cyberninja717%2Freflected-cross-site-scripting-vulnerability-in-ellucian-ethos-identity-cas-logout-page-685bb1675dfb&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40cyberninja717%2Freflected-cross-site-scripting-vulnerability-in-ellucian-ethos-identity-cas-logout-page-685bb1675dfb&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# **Reflected Cross-Site Scripting Vulnerability in Ellucian Ethos Identity CAS Logout Page**

[![Cyberninja717](https://miro.medium.com/v2/resize:fill:88:88/1*EbUPXbIdqT5rwNa5bAHiDQ.jpeg)](/%40cyberninja717?source=post_page---byline--685bb1675dfb--------------------------------)

[Cyberninja717](/%40cyberninja717?source=post_page---byline--685bb1675dfb--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F583ea7eba1d4&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40cyberninja717%2Freflected-cross-site-scripting-vulnerability-in-ellucian-ethos-identity-cas-logout-page-685bb1675dfb&user=Cyberninja717&userId=583ea7eba1d4&source=post_page-583ea7eba1d4--byline--685bb1675dfb---------------------post_header-----------)

3 min read·May 20, 2023

--

1

Listen

Share

**By: Andrew Schoonmaker and Clint Kehr**

*The authors would like to thank the Ellucian Product Security Team for their partnership and swift action in remediating this vulnerability.*

Summary: We identified a Reflected Cross-Site Scripting (XSS) vulnerability in the Ellucian Ethos Identity CAS logout endpoint. This is only exploitable in a CAS deployment.

CVSS: 4.7 (Medium)

<https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N>

We wrote this blog to highlight the process we followed to escalate an arbitrary domain redirect into a cross-site scripting (XSS) vulnerability that required bypassing strong input validation controls.

In late April 2023, we discovered when logging out of a college website, that there was a “url” parameter present within the URI that controlled a redirect value in an html [tag](https://www.w3schools.com/tags/tag_a.asp) stating, “Return to your application.”

Changing the url parameter to an arbitrary origin, such as “example.com,” or “abcd” created an [href](https://www.w3schools.com/tags/att_a_href.asp) attribute to that domain:

![]()

(Figure 1: “url” parameter allows for arbitrary origins reflected in an href attribute)

Further research resulted in finding a second parameter, “service,” also allowing arbitrary origins to be rendered as an href attribute.

![]()

(Figure 2: “service” parameter allows for arbitrary origins reflected in an href attribute)

Attempting to use the word “javascript,” along with a colon resulted in the payload being blocked by the WAF.

Analyzing the HTML further, we added a double quote along with a closing angle bracket, which allowed for successful HTML injection.

![]()

(Figure 3: String breakout from href attribute)

Through trial and error of HTML tags, we were able to discover that only a few were able to bypass WAF protections. These included <iframe>, <svg>, and <image>. We were then able to inject iframes from 3rd party domains into the webpage.

![]()

(Figure 4: Bypassing WAF protections to inject an iframe from a 3rd party source)

Although manipulating the href attribute to an arbitrary origin and HTML injection was sufficient to prove a vulnerability existed, we wanted to further prove out XSS was possible. We experimented with Javascript [events](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet) and learned some, like “onload” were blocked, whereas “onerror” was allowed.

![]()

(Figure 5: WAF Bypass using Javascript “onerror” event)

With the significant hurdles attempting to bypass input validation controls, we were finally able to find a successful bypass with the following payload:

**https://<redacted>/cas/logout?url=http://example.com%22%3E%3Csvg%3E%3Cimage%20xlink:href=%22path/to/image.jpg%22%20onerror=confirm(document.location)%3E**

![]()

(Figure 6: full bypass resulting in successful XSS)

After successfully bypassing the WAF and executing XSS, we discovered that other colleges were using the same software and possibly vulnerable. We then contacted the vendor, Ellucian, and reported the vulnerability to them. Below is the timeline of events.

Timeline:

April 19, 2023 — Vulnerability discovered

April 20, 2023 — Ellucian Product Security Team notified

May 9, 2023 — Vulnerability remediated by Ellucian

May 20, 2023 — assigned [CVE-2023-2822](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2822)

[Pentesting](/tag/pentesting?source=post_page-----685bb1675dfb--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----685bb1675dfb--------------------------------)[Ethical Hacking](/tag/ethical-hacking?source=post_page-----685bb1675dfb--------------------------------)[Bug Bounty](/tag/bug-bounty?source=post_page-----685bb1675dfb--------------------------------)[Hacking](/tag/hacking?source=post_page-----685bb1675dfb--------------------------------)

--

--

1

[![Cyberninja717](https://miro.medium.com/v2/resize:fill:96:96/1*EbUPXbIdqT5rwNa5bAHiDQ.jpeg)](/%40cyberninja717?source=post_page---post_author_info--685bb1675dfb--------------------------------)[![Cyberninja717](https://miro.medium.com/v2/resize:fill:128:128/1*EbUPXbIdqT5rwNa5bAHiDQ.jpeg)](/%40cyberninja717?source=post_page---post_author_info--685bb1675dfb--------------------------------)Follow[## Written by Cyberninja717](/%40cyberninja717?source=post_page---post_author_info--685bb1675dfb--------------------------------)[24 Followers](/%40cyberninja717/followers?source=post_page---post_author_info--685bb1675dfb--------------------------------)·[24 Following](/%40cyberninja717/following?source=post_page---post_author_info--685bb1675dfb--------------------------------)

a humble student of infosec traveling the cyberverse for knowledge

Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----685bb1675dfb--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----685bb1675dfb--------------------------------)[About](/about?autoplay=1&source=post_page-----685bb1675dfb--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----685bb1675dfb--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----685bb1675dfb--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----685bb1675dfb--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----685bb1675dfb--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----685bb1675dfb--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----685bb1675dfb--------------------------------)[Teams](/business?source=post_page-----685bb1675dfb--------------------------------)


