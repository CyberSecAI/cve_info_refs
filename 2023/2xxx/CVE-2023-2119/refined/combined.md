=== Content from www.wordfence.com_96a82c6d_20250114_214827.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Responsive Filterable Portfolio <= 1.0.19 - Reflected Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Responsive Filterable Portfolio <= 1.0.19 - Reflected Cross-Site Scripting

6.1

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2023-2119](https://www.cve.org/CVERecord?id=CVE-2023-2119) |
| --- | --- |
| CVSS | 6.1 (Medium) |
| Publicly Published | April 17, 2023 |
| Last Updated | January 22, 2024 |
| Researcher | [Marco Wotschka - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/marco-wotschka) |

### Description

The Responsive Filterable Portfolio plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the search\_term parameter in versions up to, and including, 1.0.19 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wp-responsive-thumbnail-slider/trunk/wp-responsive-images-thumbnail-slider.php)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2808922%40responsive-filterable-portfolio%2Ftags%2F1.0.19&new=2899431%40responsive-filterable-portfolio%2Ftags%2F1.0.20)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fresponsive-filterable-portfolio%2Fresponsive-filterable-portfolio-1019-reflected-cross-site-scripting&t=Responsive%20Filterable%20Portfolio%20%3C%3D%201.0.19%20-%20Reflected%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fresponsive-filterable-portfolio%2Fresponsive-filterable-portfolio-1019-reflected-cross-site-scripting&text=Responsive%20Filterable%20Portfolio%20%3C%3D%201.0.19%20-%20Reflected%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fresponsive-filterable-portfolio%2Fresponsive-filterable-portfolio-1019-reflected-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for Responsive Filterable Portfolio

#### [Responsive Filterable Portfolio](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/responsive-filterable-portfolio)

| Software Type | Plugin |
| --- | --- |
| Software Slug | responsive-filterable-portfolio [(view on wordpress.org)](https://wordpress.org/plugins/responsive-filterable-portfolio) |
| Patched? | Yes |
| Remediation | Update to version 1.0.20, or a newer patched version |
| Affected Version | * <= 1.0.19 |
| Patched Version | * 1.0.20 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_178b02aa_20250114_214825.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D2899431%2540responsive-filterable-portfolio%252Ftags%252F1.0.20%26old%3D2808922%2540responsive-filterable-portfolio%252Ftags%252F1.0.19)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/2808922/responsive-filterable-portfolio/tags/1.0.19?old=2899431&old_path=%2Fresponsive-filterable-portfolio%2Ftags%2F1.0.20)

---

# Changes from [responsive-filterable-portfolio/tags/1.0.19](/browser/responsive-filterable-portfolio/tags/1.0.19?rev=2808922 "Show entry in browser") at [r2808922](/changeset/2808922 "Show full changeset") to [responsive-filterable-portfolio/tags/1.0.20](/browser/responsive-filterable-portfolio/tags/1.0.20?rev=2899431 "Show entry in browser") at [r2899431](/changeset/2899431 "Show full changeset")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[responsive-filterable-portfolio/tags/1.0.20](/browser/responsive-filterable-portfolio/tags/1.0.20?rev=2899431)
Files:

31 edited

* [css/admincss.css](/browser/responsive-filterable-portfolio/tags/1.0.20/css/admincss.css?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file0 "Show differences"))
* [css/filterMediank-lbox.css](/browser/responsive-filterable-portfolio/tags/1.0.20/css/filterMediank-lbox.css?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file1 "Show differences"))
* [css/filterMediank.css](/browser/responsive-filterable-portfolio/tags/1.0.20/css/filterMediank.css?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file2 "Show differences"))
* [images/300x250-animated.gif](/browser/responsive-filterable-portfolio/tags/1.0.20/images/300x250-animated.gif?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file3 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/300x250-animated.gif?rev=2670726 "Show previous version in browser"))
* [images/300x250.gif](/browser/responsive-filterable-portfolio/tags/1.0.20/images/300x250.gif?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file4 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/300x250.gif?rev=2808922 "Show previous version in browser"))
* [images/300x250.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/300x250.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file5 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/300x250.png?rev=2670726 "Show previous version in browser"))
* [images/ajax-loader.gif](/browser/responsive-filterable-portfolio/tags/1.0.20/images/ajax-loader.gif?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file6 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/ajax-loader.gif?rev=2670726 "Show previous version in browser"))
* [images/asc.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/asc.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file7 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/asc.png?rev=2670726 "Show previous version in browser"))
* [images/bx\_loader.gif](/browser/responsive-filterable-portfolio/tags/1.0.20/images/bx_loader.gif?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file8 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/bx_loader.gif?rev=2670726 "Show previous version in browser"))
* [images/desc.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/desc.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file9 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/desc.png?rev=2670726 "Show previous version in browser"))
* [images/g-suite-promo-code-4.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/g-suite-promo-code-4.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file10 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/g-suite-promo-code-4.png?rev=2670726 "Show previous version in browser"))
* [images/link.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/link.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file11 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/link.png?rev=2670726 "Show previous version in browser"))
* [images/no-image-selected.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/no-image-selected.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file12 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/no-image-selected.png?rev=2670726 "Show previous version in browser"))
* [images/no-img.jpeg](/browser/responsive-filterable-portfolio/tags/1.0.20/images/no-img.jpeg?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file13 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/no-img.jpeg?rev=2670726 "Show previous version in browser"))
* [images/paypaldonate.jpg](/browser/responsive-filterable-portfolio/tags/1.0.20/images/paypaldonate.jpg?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file14 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/paypaldonate.jpg?rev=2670726 "Show previous version in browser"))
* [images/playico.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/playico.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file15 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/playico.png?rev=2670726 "Show previous version in browser"))
* [images/red-play.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/red-play.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file16 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/red-play.png?rev=2670726 "Show previous version in browser"))
* [images/video.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/video.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file17 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/video.png?rev=2670726 "Show previous version in browser"))
* [images/vl-box/controls.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/vl-box/controls.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file18 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/vl-box/controls.png?rev=2670726 "Show previous version in browser"))
* [images/vl-box/loading.gif](/browser/responsive-filterable-portfolio/tags/1.0.20/images/vl-box/loading.gif?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file19 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/vl-box/loading.gif?rev=2670726 "Show previous version in browser"))
* [images/vl-box/player\_play.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/vl-box/player_play.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file20 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/vl-box/player_play.png?rev=2670726 "Show previous version in browser"))
* [images/vl-box/playico.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/vl-box/playico.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file21 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/vl-box/playico.png?rev=2670726 "Show previous version in browser"))
* [images/vl-box/playico2.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/vl-box/playico2.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file22 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/vl-box/playico2.png?rev=2670726 "Show previous version in browser"))
* [images/wpforms-336x280v1.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/wpforms-336x280v1.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file23 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/wpforms-336x280v1.png?rev=2670726 "Show previous version in browser"))
* [images/zoom.png](/browser/responsive-filterable-portfolio/tags/1.0.20/images/zoom.png?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file24 "Show differences"))
  ([previous](/browser/responsive-filterable-portfolio/tags/1.0.19/images/zoom.png?rev=2670726 "Show previous version in browser"))
* [js/filterMediank-lbox-js.js](/browser/responsive-filterable-portfolio/tags/1.0.20/js/filterMediank-lbox-js.js?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file25 "Show differences"))
* [js/filterMediank.js](/browser/responsive-filterable-portfolio/tags/1.0.20/js/filterMediank.js?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file26 "Show differences"))
* [js/jquery.validate.js](/browser/responsive-filterable-portfolio/tags/1.0.20/js/jquery.validate.js?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file27 "Show differences"))
* [languages/responsive-filterable-portfolio.pot](/browser/responsive-filterable-portfolio/tags/1.0.20/languages/responsive-filterable-portfolio.pot?rev=2899431 "Show entry in browser")
  (modified)
  ([1 prop](#file28 "Show differences"))
* [readme.txt](/browser/responsive-filterable-portfolio/tags/1.0.20/readme.txt?rev=2899431 "Show entry in browser")
  (modified)
  ([2 diffs, 1 prop](#file29 "Show differences"))
* [wp-best-portfolio.php](/browser/responsive-filterable-portfolio/tags/1.0.20/wp-best-portfolio.php?rev=2899431 "Show entry in browser")
  (modified)
  ([8 diffs, 1 prop](#file30 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [responsive-filterable-portfolio/tags/1.0.20/css/admincss.css](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/css/admincss.css?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fcss%2Fadmincss.css "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/css/admincss.css")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/css/filterMediank-lbox.css](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/css/filterMediank-lbox.css?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fcss%2FfilterMediank-lbox.css "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/css/filterMediank-lbox.css")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/css/filterMediank.css](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/css/filterMediank.css?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fcss%2FfilterMediank.css "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/css/filterMediank.css")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/300x250-animated.gif](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/300x250-animated.gif?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2F300x250-animated.gif "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/300x250-animated.gif")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/300x250.gif](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/300x250.gif?old=2808922&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2F300x250.gif "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/300x250.gif")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/300x250.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/300x250.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2F300x250.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/300x250.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/ajax-loader.gif](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/ajax-loader.gif?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fajax-loader.gif "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/ajax-loader.gif")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/asc.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/asc.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fasc.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/asc.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/bx\_loader.gif](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/bx_loader.gif?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fbx_loader.gif "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/bx_loader.gif")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/desc.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/desc.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fdesc.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/desc.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/g-suite-promo-code-4.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/g-suite-promo-code-4.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fg-suite-promo-code-4.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/g-suite-promo-code-4.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/link.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/link.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Flink.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/link.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/no-image-selected.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/no-image-selected.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fno-image-selected.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/no-image-selected.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/no-img.jpeg](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/no-img.jpeg?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fno-img.jpeg "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/no-img.jpeg")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/paypaldonate.jpg](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/paypaldonate.jpg?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fpaypaldonate.jpg "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/paypaldonate.jpg")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/playico.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/playico.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fplayico.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/playico.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/red-play.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/red-play.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fred-play.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/red-play.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/video.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/video.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fvideo.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/video.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/vl-box/controls.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/vl-box/controls.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fvl-box%2Fcontrols.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/vl-box/controls.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/vl-box/loading.gif](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/vl-box/loading.gif?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fvl-box%2Floading.gif "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/vl-box/loading.gif")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/vl-box/player\_play.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/vl-box/player_play.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fvl-box%2Fplayer_play.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/vl-box/player_play.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/vl-box/playico.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/vl-box/playico.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fvl-box%2Fplayico.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/vl-box/playico.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/vl-box/playico2.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/vl-box/playico2.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fvl-box%2Fplayico2.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/vl-box/playico2.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/wpforms-336x280v1.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/wpforms-336x280v1.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fwpforms-336x280v1.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/wpforms-336x280v1.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/images/zoom.png](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/images/zoom.png?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fimages%2Fzoom.png "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/images/zoom.png")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/js/filterMediank-lbox-js.js](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/js/filterMediank-lbox-js.js?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fjs%2FfilterMediank-lbox-js.js "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/js/filterMediank-lbox-js.js")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/js/filterMediank.js](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/js/filterMediank.js?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fjs%2FfilterMediank.js "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/js/filterMediank.js")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/js/jquery.validate.js](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/js/jquery.validate.js?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fjs%2Fjquery.validate.js "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/js/jquery.validate.js")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/languages/responsive-filterable-portfolio.pot](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/languages/responsive-filterable-portfolio.pot?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Flanguages%2Fresponsive-filterable-portfolio.pot "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/languages/responsive-filterable-portfolio.pot")

  + Property
    **svn:executable**
    deleted
* ## [responsive-filterable-portfolio/tags/1.0.20/readme.txt](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/readme.txt?old=2808922&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Freadme.txt "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/readme.txt")

  + Property
    **svn:executable**
    deleted

  | [r2808922](/browser/responsive-filterable-portfolio/tags/1.0.19/readme.txt?rev=2808922#L4 "Show revision 2808922 of this file in browser") | [r2899431](/browser/responsive-filterable-portfolio/tags/1.0.20/readme.txt?rev=2899431#L4 "Show revision 2899431 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Tags:media grid,video portfolio plugin,portfolio gallery,portfolio grid gallery,responsive media gallery,wordpress filterable portfolio plugin,wordpress media gallery,wordpress media gallery lightbox,wordpress portfolio lightbox,wordpress free popup plugin |
  | 5 | 5 | Requires at least:3.0 |
  | 6 |  | Tested up to:6.~~1~~ |
  | 7 |  | Version:1.0.~~19~~ |
  | 8 |  | Stable tag:1.0.~~19~~ |
  |  | 6 | Tested up to:6.2 |
  |  | 7 | Version:1.0.20 |
  |  | 8 | Stable tag:1.0.20 |
  | 9 | 9 | License:GPLv2 or later |
  | 10 | 10 | License URI:http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/responsive-filterable-portfolio/tags/1.0.19/readme.txt?rev=2808922#L126) | […](/browser/responsive-filterable-portfolio/tags/1.0.20/readme.txt?rev=2899431#L126) |  |
  | 126 | 126 | == Changelog == |
  | 127 | 127 |  |
  |  | 128 | = 1.0.20 = |
  |  | 129 |  |
  |  | 130 | \* Fixed vulnerability |
  |  | 131 | \* Tested with WordPress 6.2 |
  |  | 132 |  |
  |  | 133 |  |
  | 128 | 134 | = 1.0.19 = |
  | 129 | 135 |  |
* ## [responsive-filterable-portfolio/tags/1.0.20/wp-best-portfolio.php](/changeset/2899431/responsive-filterable-portfolio/tags/1.0.20/wp-best-portfolio.php?old=2670726&old_path=responsive-filterable-portfolio%2Ftags%2F1.0.19%2Fwp-best-portfolio.php "Show the [2808922:2899431] differences restricted to responsive-filterable-portfolio/tags/1.0.20/wp-best-portfolio.php")

  + Property
    **svn:executable**
    deleted

  | [r2808922](/browser/responsive-filterable-portfolio/tags/1.0.19/wp-best-portfolio.php?rev=2670726#L6 "Show revision 2808922 of this file in browser") | [r2899431](/browser/responsive-filterable-portfolio/tags/1.0.20/wp-best-portfolio.php?rev=2899431#L6 "Show revision 2899431 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | \* Description:This is beautiful responsive portfolio grid with responsive lightbox.Add any number of images,links,video from admin panel. |
  | 7 | 7 | \* Author:I Thirteen Web Solution |
  | 8 |  | \* Version:1.0.~~19~~ |
  |  | 8 | \* Version:1.0.20 |
  | 9 | 9 | \* Text Domain:responsive-filterable-portfolio |
  | 10 | 10 | \* Domain Path: /languages |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
  | 13 |  | add\_filter~~( 'widget\_text', 'do\_shortcode'~~ ); |
  | 14 |  | add\_action~~( 'admin\_menu', 'rfp\_responsive\_portfolio\_plus\_lightbox\_add\_admin\_menu'~~ ); |
  | 15 |  |  |
  | 16 |  | register\_activation\_hook~~( \_\_FILE\_\_, 'rfp\_install\_responsive\_portfolio\_plus\_lightbox'~~ ); |
  | 17 |  | register\_deactivation\_hook(\_\_FILE\_\_,'rfp\_responsive\_filterable\_portfolio\_remove\_access\_capabilities'); |
  | 18 |  | add\_action~~( 'wp\_enqueue\_scripts', 'rfp\_responsive\_portfolio\_plus\_lightbox\_load\_styles\_and\_js'~~ ); |
  | 19 |  | add\_shortcode~~( 'print\_responsive\_portfolio\_plus\_lightbox', 'rfp\_print\_responsive\_portfolio\_plus\_lightbox\_func'~~ ); |
  | 20 |  | add\_action~~( 'admin\_notices', 'rfp\_responsive\_portfolio\_plus\_lightbox\_admin\_notices'~~ ); |
  | 21 |  |  |
  | 22 |  | add\_action(~~'wp\_ajax\_rfp\_check\_file\_exist\_portfolio', 'rfp\_check\_file\_exist\_portfolio\_callback'~~ ); |
  | 23 |  | add\_action(~~'wp\_ajax\_rfp\_get\_youtube\_info\_portfolio', 'rfp\_get\_youtube\_info\_portfolio\_callback'~~ ); |
  | 24 |  | add\_action(~~'wp\_ajax\_rfp\_get\_metacafe\_info\_portfolio', 'rfp\_get\_metacafe\_info\_portfolio\_callback'~~ ); |
  | 25 |  | add\_filter(~~'user\_has\_cap', 'rfp\_responsive\_filterable\_portfolio\_admin\_cap\_list' , 10, 4~~ ); |
  |  | 13 | add\_filter('widget\_text', 'do\_shortcode'); |
  |  | 14 | add\_action('admin\_menu', 'rfp\_responsive\_portfolio\_plus\_lightbox\_add\_admin\_menu'); |
  |  | 15 |  |
  |  | 16 | register\_activation\_hook(\_\_FILE\_\_, 'rfp\_install\_responsive\_portfolio\_plus\_lightbox'); |
  |  | 17 | register\_deactivation\_hook(\_\_FILE\_\_, 'rfp\_responsive\_filterable\_portfolio\_remove\_access\_capabilities'); |
  |  | 18 | add\_action('wp\_enqueue\_scripts', 'rfp\_responsive\_portfolio\_plus\_lightbox\_load\_styles\_and\_js'); |
  |  | 19 | add\_shortcode('print\_responsive\_portfolio\_plus\_lightbox', 'rfp\_print\_responsive\_portfolio\_plus\_lightbox\_func'); |
  |  | 20 | add\_action('admin\_notices', 'rfp\_responsive\_portfolio\_plus\_lightbox\_admin\_notices'); |
  |  | 21 |  |
  |  | 22 | add\_action('wp\_ajax\_rfp\_check\_file\_exist\_portfolio', 'rfp\_check\_file\_exist\_portfolio\_callback'); |
  |  | 23 | add\_action('wp\_ajax\_rfp\_get\_youtube\_info\_portfolio', 'rfp\_get\_youtube\_info\_portfolio\_callback'); |
  |  | 24 | add\_action('wp\_ajax\_rfp\_get\_metacafe\_info\_portfolio', 'rfp\_get\_metacafe\_info\_portfolio\_callback'); |
  |  | 25 | add\_filter('user\_has\_cap', 'rfp\_responsive\_filterable\_portfolio\_admin\_cap\_list', 10, 4); |
  | 26 | 26 | add\_action('plugins\_loaded', 'load\_lang\_for\_responsive\_filterable\_portfolio'); |
  | 27 | 27 |  |
  | 28 | 28 | function load\_lang\_for\_responsive\_filterable\_portfolio() { |
  | 29 |  |  |
  | 30 |  | load\_plugin\_textdomain( 'responsive-filterable-portfolio', false, basename( dirname( \_\_FILE\_\_ ) ) . '/languages/' ); |
  | 31 |  | add\_filter( 'map\_meta\_cap',  'map\_rfp\_responsive\_filterable\_portfolio\_meta\_caps', 10, 4 ); |
  | 32 |  | } |
  | 33 |  |  |
  | 34 |  |  |
  | 35 |  | function rfp\_responsive\_filterable\_portfolio\_admin\_cap\_list($allcaps, $caps, $args, $user){ |
  | 36 |  |  |
  | 37 |  |  |
  | 38 |  | if ( ! in\_array( 'administrator', $user->roles ) ) { |
  |  | 29 |  |
  |  | 30 | load\_plugin\_textdomain('responsive-filterable-portfolio', false, basename(dirname(\_\_FILE\_\_)) . '/languages/'); |
  |  | 31 | add\_filter('map\_meta\_cap', 'map\_rfp\_responsive\_filterable\_portfolio\_meta\_caps', 10, 4); |
  |  | 32 | } |
  |  | 33 |  |
  |  | 34 | function rfp\_responsive\_filterable\_portfolio\_admin\_cap\_list($allcaps, $caps, $args, $user) { |
  |  | 35 |  |
  |  | 36 |  |
  |  | 37 | if (!in\_array('administrator', $user->roles)) { |
  | 39 | 38 |  |
  | 40 | 39 | return $allcaps; |
  |  | 40 | } else { |
  |  | 41 |  |
  |  | 42 | if (!isset($allcaps['rfp\_filterablel\_portfolio\_settings'])) { |
  |  | 43 |  |
  |  | 44 | $allcaps['rfp\_filterablel\_portfolio\_settings'] = true; |
  |  | 45 | } |
  |  | 46 |  |
  |  | 47 | if (!isset($allcaps['rfp\_filterablel\_portfolio\_view\_media'])) { |
  |  | 48 |  |
  |  | 49 | $allcaps['rfp\_filterablel\_portfolio\_view\_media'] = true; |
  |  | 50 | } |
  |  | 51 | if (!isset($allcaps['rfp\_filterablel\_portfolio\_add\_media'])) { |
  |  | 52 |  |
  |  | 53 | $allcaps['rfp\_filterablel\_portfolio\_add\_media'] = true; |
  |  | 54 | } |
  |  | 55 | if (!isset($allcaps['rfp\_filterablel\_portfolio\_edit\_media'])) { |
  |  | 56 |  |
  |  | 57 | $allcaps['rfp\_filterablel\_portfolio\_edit\_media'] = true; |
  |  | 58 | } |
  |  | 59 | if (!isset($allcaps['rfp\_filterablel\_portfolio\_delete\_media'])) { |
  |  | 60 |  |
  |  | 61 | $allcaps['rfp\_filterablel\_portfolio\_delete\_media'] = true; |
  |  | 62 | } |
  |  | 63 | if (!isset($allcaps['rfp\_filterablel\_portfolio\_preview'])) { |
  |  | 64 |  |
  |  | 65 | $allcaps['rfp\_filterablel\_portfolio\_preview'] = true; |
  |  | 66 | } |
  | 41 | 67 | } |
  | 42 |  | else{ |
  | 43 |  |  |
  | 44 |  | if(!isset($allcaps['rfp\_filterablel\_portfolio\_settings'])){ |
  | 45 |  |  |
  | 46 |  | $allcaps['rfp\_filterablel\_portfolio\_settings']=true; |
  | 47 |  | } |
  | 48 |  |  |
  | 49 |  | if(!isset($allcaps['rfp\_filterablel\_portfolio\_view\_media'])){ |
  | 50 |  |  |
  | 51 |  | $allcaps['rfp\_filterablel\_portfolio\_view\_media']=true; |
  | 52 |  | } |
  | 53 |  | if(!isset($allcaps['rfp\_filterablel\_portfolio\_add\_media'])){ |
  | 54 |  |  |
  | 55 |  | $allcaps['rfp\_filterablel\_portfolio\_add\_media']=true; |
  | 56 |  | } |
  | 57 |  | if(!isset($allcaps['rfp\_filterablel\_portfolio\_edit\_media'])){ |
  | 58 |  |  |
  | 59 |  | $allcaps['rfp\_filterablel\_portfolio\_edit\_media']=true; |
  | 60 |  | } |
  | 61 |  | if(!isset($allcaps['rfp\_filterablel\_portfolio\_delete\_media'])){ |
  | 62 |  |  |
  | 63 |  | $allcaps['rfp\_filterablel\_portfolio\_delete\_media']=true; |
  | 64 |  | } |
  | 65 |  | if(!isset($allcaps['rfp\_filterablel\_portfolio\_preview'])){ |
  | 66 |  |  |
  | 67 |  | $allcaps['rfp\_filterablel\_portfolio\_preview']=true; |
  | 68 |  | } |
  | 69 |  |  |
  | 70 |  |  |
  |  | 68 |  |
  |  | 69 | return $allcaps; |
  |  | 70 | } |
  |  | 71 |  |
  |  | 72 | function map\_rfp\_responsive\_filterable\_portfolio\_meta\_caps(array $caps, $cap, $user\_id, array $args) { |
  |  | 73 |  |
  |  | 74 |  |
  |  | 75 | if (!in\_array($cap, array( |
  |  | 76 | 'rfp\_filterablel\_portfolio\_settings', |
  |  | 77 | 'rfp\_filterablel\_portfolio\_view\_media', |
  |  | 78 | 'rfp\_filterablel\_portfolio\_add\_media', |
  |  | 79 | 'rfp\_filterablel\_portfolio\_edit\_media', |
  |  | 80 | 'rfp\_filterablel\_portfolio\_delete\_media', |
  |  | 81 | 'rfp\_filterablel\_portfolio\_preview', |
  |  | 82 | ), true)) { |
  |  | 83 |  |
  |  | 84 | return $caps; |
  | 71 | 85 | } |
  | 72 | 86 |  |
  | 73 |  | return $allcaps; |
  | 74 |  |  |
  |  | 87 |  |
  |  | 88 |  |
  |  | 89 |  |
  |  | 90 | $caps = array(); |
  |  | 91 |  |
  |  | 92 | switch ($cap) { |
  |  | 93 |  |
  |  | 94 | case 'rfp\_filterablel\_portfolio\_settings': |
  |  | 95 | $caps[] = 'rfp\_filterablel\_portfolio\_settings'; |
  |  | 96 | break; |
  |  | 97 |  |
  |  | 98 | case 'rfp\_filterablel\_portfolio\_view\_media': |
  |  | 99 | $caps[] = 'rfp\_filterablel\_portfolio\_view\_media'; |
  |  | 100 | break; |
  |  | 101 |  |
  |  | 102 | case 'rfp\_filterablel\_portfolio\_add\_media': |
  |  | 103 | $caps[] = 'rfp\_filterablel\_portfolio\_add\_media'; |
  |  | 104 | break; |
  |  | 105 |  |
  |  | 106 | case 'rfp\_filterablel\_portfolio\_edit\_media': |
  |  | 107 | $caps[] = 'rfp\_filterablel\_portfolio\_edit\_media'; |
  |  | 108 | break; |
  |  | 109 |  |
  |  | 110 | case 'rfp\_filterablel\_portfolio\_delete\_media': |
  |  | 111 | $caps[] = 'rfp\_filterablel\_portfolio\_delete\_media'; |
  |  | 112 | break; |
  |  | 113 |  |
  |  | 114 | case 'rfp\_filterablel\_portfolio\_preview': |
  |  | 115 | $caps[] = 'rfp\_filterablel\_portfolio\_preview'; |
  |  | 116 | break; |
  |  | 117 |  |
  |  | 118 | default: |
  |  | 119 | $caps[] = 'do\_not\_allow'; |
  |  | 120 | break; |
  |  | 121 | } |
  |  | 122 |  |
  |  | 123 |  |
  |  | 124 | return apply\_filters('rfp\_responsive\_filterable\_portfolio\_meta\_caps', $caps, $cap, $user\_id, $args); |
  | 75 | 125 | } |
  | 76 | 126 |  |
  | 77 |  | ~~function map\_rfp\_responsive\_filterable\_portfolio\_meta\_caps( array $caps, $cap, $user\_id, array $args  ) {~~ |
  | 78 |  |  |
  | 79 |  |  |
  | 80 |  | ~~if ( ! in\_array( $cap, array(~~ |
  | 81 |  | ~~'rfp\_filterablel\_portfolio\_settings',~~ |
  | 82 |  | ~~'rfp\_filterablel\_portfolio\_view\_media',~~ |
  | 83 |  | ~~'rfp\_filterablel\_portfolio\_add\_media',~~ |
  | 84 |  | ~~'rfp\_filterablel\_portfolio\_edit\_media',~~ |
  | 85 |  | ~~'rfp\_filterablel\_portfolio\_delete\_media',~~ |
  | 86 |  | ~~'rfp\_filterablel\_portfolio\_preview',~~ |
  | 87 |  |  |
  | 88 |  | ~~), true ) ) {~~ |
  | 89 |  |  |
  | 90 |  | ~~return $caps;~~ |
  | 91 |  | ~~}~~ |
  | 92 |  |  |
  | 93 |  |  |
  | 94 |  |  |
  | 95 |  |  |
  | 96 |  | ~~$caps = array();~~ |
  | 97 |  |  |
  | 98 |  | ~~switch ( $cap ) {~~ |
  | 99 |  |  |
  | 100 |  | ~~case 'rfp\_filterablel\_portfolio\_settings':~~ |
  | 101 |  | ~~$caps[] = 'rfp\_filterablel\_portfolio\_settings';~~ |
  | 102 |  | ~~break;~~ |
  | 103 |  |  |
  | 104 |  | ~~case 'rfp\_filterablel\_portfolio\_view\_media':~~ |
  | 105 |  | ~~$caps[] = 'rfp\_filterablel\_portfolio\_view\_media';~~ |
  | 106 |  | ~~break;~~ |
  | 107 |  |  |
  | 108 |  | ~~case 'rfp\_filterablel\_portfolio\_add\_media':~~ |
  | 109 |  | ~~$caps[] = 'rfp\_filterablel\_portfolio\_add\_media';~~ |
  | 110 |  | ~~break;~~ |
  | 111 |  |  |
  | 112 |  | ~~case 'rfp\_filterablel\_portfolio\_edit\_media':~~ |
  | 113 |  | ~~$caps[] = 'rfp\_filterablel\_portfolio\_edit\_media';~~ |
  | 114 |  | ~~break;~~ |
  | 115 |  |  |
  | 116 |  | ~~case 'rfp\_filterablel\_portfolio\_delete\_media':~~ |
  | 117 |  | ~~$caps[] = 'rfp\_filterablel\_portfolio\_delete\_media';~~ |
  | 118 |  | ~~break;~~ |
  | 119 |  |  |
  | 120 |  | ~~case 'rfp\_filterablel\_portfolio\_preview':~~ |
  | 121 |  | ~~$caps[] = 'rfp\_filterablel\_portfolio\_preview';~~ |
  | 122 |  | ~~break;~~ |
  | 123 |  |  |
  | 124 |  | ~~default:~~ |
  | 125 |  |  |
  | 126 |  | ~~$caps[] = 'do\_not\_allow';~~ |
  | 127 |  | ~~break;~~ |
  | 128 |  | ~~}~~ |
  | 129 |  |  |
  | 130 |  |  |
  | 131 |  | ~~return apply\_filters( 'rfp\_responsive\_filterable\_portfolio\_meta\_caps', $caps, $cap, $user\_id, $args );~~ |
  | 132 |  | ~~}~~ |
  | 133 |  |  |
  | 134 | 127 | function rfp\_responsive\_filterable\_portfolio\_add\_access\_capabilities() { |
  | 135 |  |  |
  |  | 128 |  |
  | 136 | 129 | // Capabilities for all roles. |
  | 137 |  | $roles = array( 'administrator' ); |
  | 138 |  | foreach ( $roles as $role ) { |
  | 139 |  |  |
  | 140 |  | $role = get\_role( $role ); |
  | 141 |  | if ( empty( $role ) ) { |
  | 142 |  | continue; |
  | 143 |  | } |
  | 144 |  |  |
  | 145 |  |  |
  | 146 |  | if(!$role->has\_cap( 'rfp\_filterablel\_portfolio\_settings' ) ){ |
  | 147 |  |  |
  | 148 |  | $role->add\_cap( 'rfp\_filterablel\_portfolio\_settings' ); |
  | 149 |  | } |
  | 150 |  |  |
  | 151 |  | if(!$role->has\_cap( 'rfp\_filterablel\_portfolio\_view\_media' ) ){ |
  | 152 |  |  |
  | 153 |  | $role->add\_cap( 'rfp\_filterablel\_portfolio\_view\_media' ); |
  | 154 |  | } |
  | 155 |  |  |
  | 156 |  |  |
  | 157 |  | if(!$role->has\_cap( 'rfp\_filterablel\_portfolio\_add\_media' ) ){ |
  | 158 |  |  |
  | 159 |  | $role->add\_cap( 'rfp\_filterablel\_portfolio\_add\_media' ); |
  | 160 |  | } |
  | 161 |  |  |
  | 162 |  | if(!$role->has\_cap( 'rfp\_filterablel\_portfolio\_edit\_media' ) ){ |
  | 163 |  |  |
  | 164 |  | $role->add\_cap( 'rfp\_filterablel\_portfolio\_edit\_media' ); |
  | 165 |  | } |
  | 166 |  |  |
  | 167 |  | if(!$role->has\_cap( 'rfp\_filterablel\_portfolio\_delete\_media' ) ){ |
  | 168 |  |  |
  | 169 |  | $role->add\_cap( 'rfp\_filterablel\_portfolio\_delete\_media' ); |
  | 170 |  | } |
  | 171 |  |  |
  | 172 |  | if(!$role->has\_cap( 'rfp\_filterablel\_portfolio\_preview' ) ){ |
  | 173 |  |  |
  | 174 |  | $role->add\_cap( 'rfp\_filterablel\_portfolio\_preview' ); |
  | 175 |  | } |
  | 176 |  |  |
  | 177 |  |  |
  | 178 |  |  |
  |  | 130 | $roles = array('administrator'); |
  |  | 131 | foreach ($roles as $role) { |
  |  | 132 |  |
  |  | 133 | $role = get\_role($role); |
  |  | 134 | if (empty($role)) { |
  |  | 135 | continue; |
  |  | 136 | } |
  |  | 137 |  |
  |  | 138 |  |
  |  | 139 | if (!$role->has\_cap('rfp\_filterablel\_portfolio\_settings')) { |
  |  | 140 |  |
  |  | 141 | $role->add\_cap('rfp\_filterablel\_portfolio\_settings'); |
  |  | 142 | } |
  |  | 143 |  |
  |  | 144 | if (!$role->has\_cap('rfp\_filterablel\_portfolio\_view\_media')) { |
  |  | 145 |  |
  |  | 146 | $role->add\_cap('rfp\_filterablel\_portfolio\_view\_media'); |
  |  | 147 | } |
  |  | 148 |  |
  |  | 149 |  |
  |  | 150 | if (!$role->has\_cap('rfp\_filterablel\_portfolio\_add\_media')) { |
  |  | 151 |  |
  |  | 152 | $role->add\_cap('rfp\_filterablel\_portfolio\_add\_media'); |
  |  | 153 | } |
  |  | 154 |  |
  |  | 155 | if (!$role->has\_cap('rfp\_filterablel\_portfolio\_edit\_media')) { |
  |  | 156 |  |
  |  | 157 | $role->add\_cap('rfp\_filterablel\_portfolio\_edit\_media'); |
  |  | 158 | } |
  |  | 159 |  |
  |  | 160 | if (!$role->has\_cap('rfp\_filterablel\_portfolio\_delete\_media')) { |
  |  | 161 |  |
  |  | 162 | $role->add\_cap('rfp\_filterablel\_portfolio\_delete\_media'); |
  |  | 163 | } |
  |  | 164 |  |
  |  | 165 | if (!$role->has\_cap('rfp\_filterablel\_portfolio\_preview')) { |
  |  | 166 |  |
  |  | 167 | $role->add\_cap('rfp\_filterablel\_portfolio\_preview'); |
  |  | 168 | } |
  | 179 | 169 | } |
  | 180 |  |  |
  |  | 170 |  |
  | 181 | 171 | $user = wp\_get\_current\_user(); |
  | 182 | 172 | $user->get\_role\_caps(); |
  | 183 |  |  |
  | 184 | 173 | } |
  | 185 | 174 |  |
  | 186 |  | function rfp\_responsive\_filterable\_portfolio\_remove\_access\_capabilities(){ |
  | 187 |  |  |
  | 188 |  | global $wp\_roles; |
  | 189 |  |  |
  | 190 |  | if (~~! isset( $wp\_roles )~~ ) { |
  | 191 |  | ~~$wp~~\_roles = new WP\_Roles(); |
  |  | 175 | function rfp\_responsive\_filterable\_portfolio\_remove\_access\_capabilities() { |
  |  | 176 |  |
  |  | 177 | global $wp\_\_roles; |
  |  | 178 |  |
  |  | 179 | if (!isset($wp\_\_roles)) { |
  |  | 180 | $wp\_\_roles = new WP\_Roles(); |
  | 192 | 181 | } |
  | 193 | 182 |  |
  | 194 |  | foreach ( $wp\_roles->roles as $role => $details ) { |
  | 195 |  | $role = $wp\_roles->get\_role( $role ); |
  | 196 |  | if ( empty( $role ) ) { |
  | 197 |  | continue; |
  | 198 |  | } |
  | 199 |  |  |
  | 200 |  | $role->remove\_cap( 'rfp\_filterablel\_portfolio\_settings'); |
  | 201 |  | $role->remove\_cap( 'rfp\_filterablel\_portfolio\_view\_media'); |
  | 202 |  | $role->remove\_cap( 'rfp\_filterablel\_portfolio\_add\_media'); |
  | 203 |  | $role->remove\_cap( 'rfp\_filterablel\_portfolio\_edit\_media'); |
  | 204 |  | $role->remove\_cap( 'rfp\_filterablel\_portfolio\_delete\_media'); |
  | 205 |  | $role->remove\_cap( 'rfp\_filterablel\_portfolio\_preview'); |
  | 206 |  |  |
  | 207 |  |  |
  |  | 183 | foreach ($wp\_\_roles->roles as $role => $details) { |
  |  | 184 | $role = $wp\_\_roles->get\_role($role); |
  |  | 185 | if (empty($role)) { |
  |  | 186 | continue; |
  |  | 187 | } |
  |  | 188 |  |
  |  | 189 | $role->remove\_cap('rfp\_filterablel\_portfolio\_settings'); |
  |  | 190 | $role->remove\_cap('rfp\_filterablel\_portfolio\_view\_media'); |
  |  | 191 | $role->remove\_cap('rfp\_filterablel\_portfolio\_add\_media'); |
  |  | 192 | $role->remove\_cap('rfp\_filterablel\_portfolio\_edit\_media'); |
  |  | 193 | $role->remove\_cap('rfp\_filterablel\_portfolio\_delete\_media'); |
  |  | 194 | $role->remove\_cap('rfp\_filterablel\_portfolio\_preview'); |
  | 208 | 195 | } |
  | 209 | 196 |  |
  | […](/browser/responsive-filterable-portfolio/tags/1.0.19/wp-best-portfolio.php?rev=2670726#L211) | […](/browser/responsive-filterable-portfolio/tags/1.0.20/wp-best-portfolio.php?rev=2899431#L198) |  |
  | 211 | 198 | $user = wp\_get\_current\_user(); |
  | 212 | 199 | $user->get\_role\_caps(); |
  | 213 |  |  |
  | 214 | 200 | } |
  | 215 | 201 |  |
  | 216 |  | function rfp\_save\_image($url,~~$saveto)~~{ |
  | 217 |  |  |
  | 218 |  | $raw = wp\_remote\_retrieve\_body(~~wp\_remote\_get( $url )~~ ); |
  | 219 |  |  |
  | 220 |  | if~~(file\_exists($saveto))~~{ |
  |  | 202 | function rfp\_save\_image($url, $saveto) { |
  |  | 203 |  |
  |  | 204 | $raw = wp\_remote\_retrieve\_body(wp\_remote\_get($url)); |
  |  | 205 |  |
  |  | 206 | if (file\_exists($saveto)) { |
  | 221 | 207 | @unlink($saveto); |
  | 222 | 208 | } |
  | 223 |  | $fp = @fopen($saveto,'x'); |
  |  | 209 | $fp = @fopen($saveto, 'x'); |
  | 224 | 210 | @fwrite($fp, $raw); |
  | 225 | 211 | @fclose($fp); |
  | 226 |  |  |
  | 227 | 212 | } |
  | 228 | 213 |  |
  | 229 |  |  |
  | 230 |  | function rfp\_get\_youtube\_info\_portfolio\_callback(){ |
  | 231 |  |  |
  | 232 |  | if(isset($\_POST) and is\_array($\_POST) and  isset($\_POST['url'])){ |
  | 233 |  |  |
  | 234 |  |  |
  | 235 |  | $retrieved\_nonce = ''; |
  | 236 |  |  |
  | 237 |  | if (isset($\_POST['vNonce']) and $\_POST['vNonce'] != '') { |
  | 238 |  |  |
  | 239 |  | $retrieved\_nonce = $\_POST['vNonce']; |
  | 240 |  | } |
  | 241 |  | if (!wp\_verify\_nonce($retrieved\_nonce, 'vNonce')) { |
  | 242 |  |  |
  | 243 |  |  |
  | 244 |  | wp\_die('Security check fail'); |
  | 245 |  | } |
  | 246 |  |  |
  | 247 |  |  |
  | 248 |  | $vid=htmlentities(sanitize\_text\_field($\_POST['vid'])); |
  | 249 |  | $url=$\_POST['url']; |
  | 250 |  | $output=  wp\_remote\_retrieve\_body( wp\_remote\_get( $url ) ); |
  | 251 |  |  |
  | 252 |  | $output=json\_decode($output); |
  | 253 |  |  |
  | 254 |  |  |
  | 255 |  |  |
  | 256 |  |  |
  | 257 |  | $videoInfo=  wp\_remote\_retrieve\_body( wp\_remote\_get( "https://www.youtube.com/watch?v=$vid")); |
  | 258 |  |  |
  | 259 |  | $pattern = '/\\"shortDescription\\":(.\*)\\"isCrawlable\\"/Uis'; |
  | 260 |  | $vinfo=''; |
  | 261 |  | if(preg\_match\_all($pattern, $videoInfo, $matches)) { |
  | 262 |  | if(is\_array($matches) and isset($matches[1])){ |
  | 263 |  | if(isset($matches[1][0])){ |
  | 264 |  | $vinfo= stripcslashes($matches[1][0]); |
  | 265 |  | } |
  | 266 |  | } |
  | 267 |  | } |
  | 268 |  |  |
  | 269 |  | $breaks = array("<br />","<br>","<br/>"); |
  | 270 |  | $vinfo = str\_ireplace($breaks, "\r\n", $vinfo); |
  | 271 |  | $vinfo=trim($vinfo); |
  | 272 |  | $vinfo=trim($vinfo,','); |
  | 273 |  | $vinfo=trim($vinfo,'"'); |
  | 274 |  | $vinfo=rtrim($vinfo,'"'); |
  | 275 |  | $vinfo=ltrim($vinfo,'"'); |
  | 276 |  | $vinfo=trim($vinfo,'"'); |
  | 277 |  | $vinfo=trim($vinfo,','); |
  | 278 |  |  |
  | 279 |  | $return=array(); |
  | 280 |  | if(is\_object($output)){ |
  | 281 |  |  |
  | 282 |  | $return['title']=$output->title; |
  | 283 |  | $return['thumbnail\_url']=$output->thumbnail\_url; |
  | 284 |  | $return['description']=$vinfo; |
  | 285 |  |  |
  | 286 |  | } |
  | 287 |  |  |
  | 288 |  | echo json\_encode($return); |
  | 289 |  | exit; |
  | 290 |  |  |
  |  | 214 | function rfp\_get\_youtube\_info\_portfolio\_callback() { |
  |  | 215 |  |
  |  | 216 | if (isset($\_POST) && is\_array($\_POST) && isset($\_POST['url'])) { |
  |  | 217 |  |
  |  | 218 |  |
  |  | 219 | $retrieved\_nonce = isset($\_REQUEST['vNonce']) ? sanitize\_text\_field(wp\_unslash($\_REQUEST['vNonce'])) : ''; // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotSanitized, WordPress.Security.NonceVerification.NoNonceVerification |
  |  | 220 |  |
  |  | 221 | if (!wp\_verify\_nonce($retrieved\_nonce, 'vNonce')) { |
  |  | 222 |  |
  |  | 223 |  |
  |  | 224 | wp\_die('Security check fail'); |
  |  | 225 | } |
  |  | 226 |  |
  |  | 227 |  |
  |  | 228 | $vid = ( isset($\_POST['vid']) ) ? htmlentities(sanitize\_text\_field($\_POST['vid'])) : ''; |
  |  | 229 | $url = isset($\_POST['url']) ? esc\_url\_raw($\_POST['url']) : ''; |
  |  | 230 | $output = wp\_remote\_retrieve\_body(wp\_remote\_get($url)); |
  |  | 231 |  |
  |  | 232 | $output = json\_decode($output); |
  |  | 233 |  |
  |  | 234 | $videoInfo = wp\_remote\_retrieve\_body(wp\_remote\_get("https://www.youtube.com/watch?v=$vid")); |
  |  | 235 |  |
  |  | 236 | $pattern = '/\\"shortDescription\\":(.\*)\\"isCrawlable\\"/Uis'; |
  |  | 237 | $vinfo = ''; |
  |  | 238 | if (preg\_match\_all($pattern, $videoInfo, $matches)) { |
  |  | 239 | if (is\_array($matches) && isset($matches[1])) { |
  |  | 240 | if (isset($matches[1][0])) { |
  |  | 241 | $vinfo = stripcslashes($matches[1][0]); |
  |  | 242 | } |
  |  | 243 | } |
  |  | 244 | } |
  |  | 245 |  |
  |  | 246 | $breaks = array('<br />', '<br>', '<br/>'); |
  |  | 247 | $vinfo = str\_ireplace($breaks, "\r\n", $vinfo); |
  |  | 248 | $vinfo = trim($vinfo); |
  |  | 249 | $vinfo = trim($vinfo, ','); |
  |  | 250 | $vinfo = trim($vinfo, '"'); |
  |  | 251 | $vinfo = rtrim($vinfo, '"'); |
  |  | 252 | $vinfo = ltrim($vinfo, '"'); |
  |  | 253 | $vinfo = trim($vinfo, '"'); |
  |  | 254 | $vinfo = trim($vinfo, ','); |
  |  | 255 |  |
  |  | 256 | $return = array(); |
  |  | 257 | if (is\_object($output)) { |
  |  | 258 |  |
  |  | 259 | $return['title'] = $output->title; |
  |  | 260 | $return['thumbnail\_url'] = $output->thumbnail\_url; |
  |  | 261 | $return['description'] = $vinfo; |
  |  | 262 | } |
  |  | 263 |  |
  |  | 264 | echo json\_encode($return); |
  |  | 265 | exit; |
  | 291 | 266 | } |
  | 292 |  |  |
  | 293 | 267 | } |
  | 294 | 268 |  |
  | 295 |  |  |
  | 296 |  |  |
  | 297 | 269 | function rfp\_check\_file\_exist\_portfolio\_callback() { |
  | 298 |  |  |
  | 299 |  | if(isset($\_POST) and is\_array($\_POST) and  isset($\_POST['url'])){ |
  | 300 |  |  |
  | 301 |  |  |
  | 302 |  | $retrieved\_nonce = ''; |
  | 303 |  |  |
  | 304 |  | if (isset($\_POST['vNonce']) and $\_POST['vNonce'] != '') { |
  | 305 |  |  |
  | 306 |  | $retrieved\_nonce = $\_POST['vNonce']; |
  | 307 |  | } |
  | 308 |  | if (!wp\_verify\_nonce($retrieved\_nonce, 'vNonce')) { |
  | 309 |  |  |
  | 310 |  |  |
  | 311 |  | wp\_die('Security check fail'); |
  | 312 |  | } |
  | 313 |  |  |
  | 314 |  | $response = wp\_remote\_get(sanitize\_text\_field($\_POST['url'])); |
  | 315 |  | $httpCode = wp\_remote\_retrieve\_response\_code( $response ); |
  | 316 |  |  |
  | 317 |  |  |
  | 318 |  | echo trim((string)$httpCode);die; |
  | 319 |  |  |
  | 320 |  | } |
  | 321 |  | //echo die; |
  | 322 |  |  |
  |  | 270 |  |
  |  | 271 | if (isset($\_POST) && is\_array($\_POST) && isset($\_POST['url'])) { |
  |  | 272 |  |
  |  | 273 |  |
  |  | 274 | $retrieved\_nonce = isset($\_REQUEST['vNonce']) ? sanitize\_text\_field(wp\_unslash($\_REQUEST['vNonce'])) : ''; // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotSanitized, WordPress.Security.NonceVerification.NoNonceVerification |
  |  | 275 | if (!wp\_verify\_nonce($retrieved\_nonce, 'vNonce')) { |
  |  | 276 |  |
  |  | 277 |  |
  |  | 278 | wp\_die('Security check fail'); |
  |  | 279 | } |
  |  | 280 |  |
  |  | 281 | $response = wp\_remote\_get(esc\_url\_raw($\_POST['url'])); |
  |  | 282 | $httpCode = wp\_remote\_retrieve\_response\_code($response); |
  |  | 283 |  |
  |  | 284 | echo esc\_html((string) $httpCode); |
  |  | 285 | die; |
  |  | 286 | } |
  |  | 287 | //echo die; |
  | 323 | 288 | } |
  | 324 | 289 |  |
  | […](/browser/responsive-filterable-portfolio/tags/1.0.19/wp-best-portfolio.php?rev=2670726#L327) | […](/browser/responsive-filterable-portfolio/tags/1.0.20/wp-best-portfolio.php?rev=2899431#L292) |  |
  | 327 | 292 | return @substr($headers[0], 9, 3); |
  | 328 | 293 | } |
  |  | 294 |  |
  | 329 | 295 | function rfp\_get\_metacafe\_info\_portfolio\_callback() { |
  | 330 |  |  |
  | 331 |  | if (isset($\_POST) and is\_array($\_POST) and isset($\_POST['url'])) { |
  | 332 |  |  |
  | 333 |  | $retrieved\_nonce = ''; |
  | 334 |  |  |
  | 335 |  | if (isset($\_POST['vNonce']) and $\_POST['vNonce'] != '') { |
  | 336 |  |  |
  | 337 |  | $retrieved\_nonce = $\_POST['vNonce']; |
  | 338 |  | } |
  |  | 296 |  |
  |  | 297 | if (isset($\_POST) && is\_array($\_POST) && isset($\_POST['url'])) { |
  |  | 298 |  |
  |  | 299 | $retrieved\_nonce = isset($\_REQUEST['vNonce']) ? sanitize\_text\_field(wp\_unslash($\_REQUEST['vNonce'])) : ''; // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotSanitized, WordPress.Security.NonceVerification.NoNonceVerification |
  | 339 | 300 | if (!wp\_verify\_nonce($retrieved\_nonce, 'vNonce')) { |
  | 340 | 301 |  |
  | […](/browser/responsive-filterable-portfolio/tags/1.0.19/wp-best-portfolio.php?rev=2670726#L342) | […](/browser/responsive-filterable-portfolio/tags/1.0.20/wp-best-portfolio.php?rev=2899431#L303) |  |
  | 342 | 303 | wp\_die('Security check fail'); |
  | 343 | 304 | } |
  | 344 |  |  |
  | 345 |  | $videoUrl = trim($\_POST['url']); |
  | 346 |  |  |
  | 347 |  |  |
  | 348 |  |  |
  | 349 |  | $videoInfo = wp\_remote\_retrieve\_body( wp\_remote\_get($videoUrl)); |
  | 350 |  |  |
  | 351 |  |  |
  |  | 305 |  |
  |  | 306 | $videoUrl = isset($\_POST['url']) ? esc\_url\_raw($\_POST['url']) : ''; |
  |  | 307 |  |
  |  | 308 | $videoInfo = wp\_remote\_retrieve\_body(wp\_remote\_get($videoUrl)); |
  |  | 309 |  |
  | 352 | 310 | $doc = new DomDocument(); |
  | 353 | 311 | $doc->validateOnParse = false; |
  | 354 |  | $doc->loadHTML('<?xml encoding="utf-8" ?>'~~.~~$videoInfo); |
  |  | 312 | $doc->loadHTML('<?xml encoding="utf-8" ?>' . $videoInfo); |
  | 355 | 313 | $xpath = new DomXpath($doc); |
  | 356 |  | $imgUrl~~=~~''; |
  | 357 |  | $title~~=~~''; |
  | 358 |  | $description~~=~~''; |
  |  | 314 | $imgUrl = ''; |
  |  | 315 | $title = ''; |
  |  | 316 | $description = ''; |
  | 359 | 317 | $entries = $xpath->query("//video[@id='video']/@poster"); |
  | 360 |  | foreach~~($entries as $element)~~{ |
  | 361 |  |  |
  | 362 |  | $imgUrl= $element->nodeValue; |
  |  | 318 | foreach ($entries as $element) { |
  |  | 319 |  |
  |  | 320 | $imgUrl = $element->nodeValue; |
  | 363 | 321 | break; |
  | 364 | 322 | } |
  | 365 |  |  |
  |  | 323 |  |
  | 366 | 324 | $entries = $xpath->query('//h5[contains(@class, "font-size-21")]'); |
  | 367 |  |  |
  | 368 |  | foreach~~($entries as $element)~~{ |
  | 369 |  |  |
  | 370 |  | $title~~= $description= $element->textContent;~~ |
  |  | 325 |  |
  |  | 326 | foreach ($entries as $element) { |
  |  | 327 |  |
  |  | 328 | $title = $element->textContent; |
  | 371 | 329 | break; |
  | 372 | 330 | } |
  | 373 |  |  |
  |  | 331 |  |
  | 374 | 332 | $entries = $xpath->query('//p/span[contains(@class, "d-inline-flex")]'); |
  | 375 |  |  |
  | 376 |  | foreach~~($entries as $element)~~{ |
  | 377 |  |  |
  | 378 |  | $description~~= $description= $element->textContent;~~ |
  |  | 333 |  |
  |  | 334 | foreach ($entries as $element) { |
  |  | 335 |  |
  |  | 336 | $description = $element->textContent; |
  | 379 | 337 | break; |
  | 380 | 338 | } |
  | 381 |  |  |
  | 382 |  |  |
  | 383 |  | // $description = strip\_tags($description); |
  |  | 339 |  |
  |  | 340 |  |
  |  | 341 | // $description = strip\_tags($description); |
  | 384 | 342 | $description = preg\_replace('/(?<=Ranked)\b.\*/is', '', $description); |
  | 385 | 343 | $description = str\_replace('Ranked', '', $description); |
  | […](/browser/responsive-filterable-portfolio/tags/1.0.19/wp-best-portfolio.php?rev=2670726#L388) | […](/browser/responsive-filterable-portfolio/tags/1.0.20/wp-best-portfolio.php?rev=2899431#L346) |  |
  | 388 | 346 | $description = str\_replace('&amp;', '', $description); |
  | 389 | 347 |  |
  | 390 |  |  |
  | 391 |  |  |
  | 392 |  |  |
  | 393 |  |  |
  | 394 |  | $returnArray = array('vid' => $vid, 'HdnMediaSelection' => $imgUrl, "videotitle" => $title, 'videotitleurl' => $videoUrl, "video\_description" => $description); |
  | 395 |  | $returnArray = json\_encode($returnArray); |
  | 396 |  | echo $returnArray; |
  |  | 348 | $returnArray = array('vid' => $vid, 'HdnMediaSelection' => $imgUrl, 'videotitle' => $title, 'videotitleurl' => $videoUrl, 'video\_description' => $description); |
  |  | 349 | echo wp\_json\_encode($returnArray); |
  | 397 | 350 | die; |
  | 398 | 351 | } |
  | 399 |  | e~~cho die~~; |
  |  | 352 | exit; |
  | 400 | 353 | } |
  | 401 | 354 |  |
  | 402 | 355 | function rfp\_responsive\_portfolio\_plus\_lightbox\_admin\_notices() { |
  | 403 |  | ~~if (is\_plugin\_active ( 'responsive-filterable-portfolio/wp-best-portfolio.php'~~ )) { |
  | 404 |  |  |
  | 405 |  | ~~$uploads = wp\_upload\_dir~~ (); |
  | 406 |  | $baseDir = $uploads ['basedir']; |
  | 407 |  | ~~$baseDir = str\_replace ( "\\", "/", $baseDir~~ ); |
  | 408 |  | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  | 409 |  |  |
  | 410 |  | ~~if (file\_exists ( $pathToImagesFolder ) and is\_dir ( $pathToImagesFolder~~ )) { |
  | 411 |  |  |
  | 412 |  | ~~if (! is\_writable ( $pathToImagesFolder~~ )) { |
  | 413 |  | ~~echo "<div class='updated'><p>".\_\_ ( 'Responsive portfolio with lightbox is active but does not have write permission on','responsive-filterable-portfolio' )."</p><p><b> " . $pathToImagesFolder . "</b> ".\_\_ ( ' directory.Please allow write permission.','responsive-filterable-portfolio' )."</p></div> "~~; |
  | 414 |  | } |
  | 415 |  | } else { |
  | 416 |  |  |
  | 417 |  | ~~wp\_mkdir\_p ( $pathToImagesFolder~~ ); |
  | 418 |  | ~~if (! file\_exists ( $pathToImagesFolder ) and ! is\_dir ( $pathToImagesFolder~~ )) { |
  | 419 |  | ~~echo "<div class='updated'><p>".\_\_ ( 'Responsive portfolio with lightbox is active but plugin does not have permission to create directory','responsive-filterable-portfolio' )."</p><p><b>" . $pathToImagesFolder . "</b> ",\_\_ ( '.Please create wp-best-portfolio directory inside upload directory and allow write permission.','responsive-filterable-portfolio' )."</p></div> "~~; |
  | 420 |  | } |
  | 421 |  | } |
  | 422 |  | } |
  |  | 356 | if (is\_plugin\_active('responsive-filterable-portfolio/wp-best-portfolio.php')) { |
  |  | 357 |  |
  |  | 358 | $uploads = wp\_upload\_dir(); |
  |  | 359 | $baseDir = $uploads ['basedir']; |
  |  | 360 | $baseDir = str\_replace('\\', '/', $baseDir); |
  |  | 361 | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  |  | 362 |  |
  |  | 363 | if (file\_exists($pathToImagesFolder) && is\_dir($pathToImagesFolder)) { |
  |  | 364 |  |
  |  | 365 | if (!is\_writable($pathToImagesFolder)) { |
  |  | 366 | echo "<div class='updated'><p>" . esc\_html(\_\_('Responsive portfolio with lightbox is active but does not have write permission on', 'responsive-filterable-portfolio')) . '</p><p><b> ' . $pathToImagesFolder . '</b> ' . esc\_html(\_\_(' directory.Please allow write permission.', 'responsive-filterable-portfolio')) . '</p></div> '; |
  |  | 367 | } |
  |  | 368 | } else { |
  |  | 369 |  |
  |  | 370 | wp\_mkdir\_p($pathToImagesFolder); |
  |  | 371 | if (!file\_exists($pathToImagesFolder) && !is\_dir($pathToImagesFolder)) { |
  |  | 372 | echo "<div class='updated'><p>" . esc\_html(\_\_('Responsive portfolio with lightbox is active but plugin does not have permission to create directory', 'responsive-filterable-portfolio') . '</p><p><b>' . $pathToImagesFolder . '</b> ', esc\_html(\_\_('.Please create wp-best-portfolio directory inside upload directory and allow write permission.', 'responsive-filterable-portfolio'))) . '</p></div> '; |
  |  | 373 | } |
  |  | 374 | } |
  |  | 375 | } |
  | 423 | 376 | } |
  |  | 377 |  |
  | 424 | 378 | function rfp\_responsive\_portfolio\_plus\_lightbox\_load\_styles\_and\_js() { |
  | 425 |  | if (! is\_admin ()) { |
  | 426 |  |  |
  | 427 |  | wp\_register\_style ( 'filterMediank', plugins\_url ( '/css/filterMediank.css', \_\_FILE\_\_ ) ); |
  | 428 |  | wp\_register\_style ( 'filterMediank-lbox', plugins\_url ( '/css/filterMediank-lbox.css', \_\_FILE\_\_ ),array(),'1.0.15'  ); |
  | 429 |  | wp\_register\_script ( 'filterMediank', plugins\_url ( '/js/filterMediank.js', \_\_FILE\_\_ ),array('jquery'),'1.0.19' ); |
  | 430 |  | wp\_register\_script ( 'filterMediank-lbox-js', plugins\_url ( '/js/filterMediank-lbox-js.js', \_\_FILE\_\_ ),array('jquery'),'1.0.14' ); |
  | 431 |  |  |
  | 432 |  | } |
  |  | 379 | if (!is\_admin()) { |
  |  | 380 |  |
  |  | 381 | wp\_register\_style('filterMediank', plugins\_url('/css/filterMediank.css', \_\_FILE\_\_)); |
  |  | 382 | wp\_register\_style('filterMediank-lbox', plugins\_url('/css/filterMediank-lbox.css', \_\_FILE\_\_), array(), '1.0.15'); |
  |  | 383 | wp\_register\_script('filterMediank', plugins\_url('/js/filterMediank.js', \_\_FILE\_\_), array('jquery'), '1.0.19'); |
  |  | 384 | wp\_register\_script('filterMediank-lbox-js', plugins\_url('/js/filterMediank-lbox-js.js', \_\_FILE\_\_), array('jquery'), '1.0.14'); |
  |  | 385 | } |
  | 433 | 386 | } |
  |  | 387 |  |
  | 434 | 388 | function rfp\_install\_responsive\_portfolio\_plus\_lightbox() { |
  | 435 |  | global $wpdb; |
  | 436 |  | $table\_name = $wpdb->prefix . "e\_portfolio"; |
  | 437 |  |  |
  | 438 |  |  |
  | 439 |  | $charset\_collate = $wpdb->get\_charset\_collate(); |
  | 440 |  |  |
  | 441 |  | $sql = "CREATE TABLE " . $table\_name . " ( |
  |  | 389 | global $wpdb; |
  |  | 390 | $table\_name = $wpdb->prefix . 'e\_portfolio'; |
  |  | 391 |  |
  |  | 392 | $charset\_collate = $wpdb->get\_charset\_collate(); |
  |  | 393 |  |
  |  | 394 | $sql = 'CREATE TABLE ' . $table\_name . " ( |
  | 442 | 395 | `id` int(11) NOT NULL AUTO\_INCREMENT, |
  | 443 | 396 | `media\_type` varchar(10) NOT NULL, |
  | […](/browser/responsive-filterable-portfolio/tags/1.0.19/wp-best-portfolio.php?rev=2670726#L457) | […](/browser/responsive-filterable-portfolio/tags/1.0.20/wp-best-portfolio.php?rev=2899431#L410) |  |
  | 457 | 410 |  |
  | 458 | 411 | "; |
  | 459 |  |  |
  | 460 |  | require\_once (ABSPATH . 'wp-admin/includes/upgrade.php'); |
  | 461 |  | dbDelta ( $sql ); |
  | 462 |  |  |
  | 463 |  | $best\_portfolio\_grid\_settings=array( |
  | 464 |  |  |
  | 465 |  | 'BackgroundColor'=>'#FFFFFF', |
  | 466 |  | 'imagewidth'=>'273', |
  | 467 |  | 'imageheight'=>'160', |
  | 468 |  | 'imageMargin'=>'15', |
  | 469 |  | 'show\_filters'=>'1', |
  | 470 |  | 'resize\_images'=>'1', |
  | 471 |  | 'AllKeywordTranslate'=>'All', |
  | 472 |  |  |
  | 473 |  | ); |
  | 474 |  |  |
  | 475 |  |  |
  | 476 |  | $existingopt=get\_option('best\_portfolio\_grid\_settings'); |
  | 477 |  | if(!is\_array($existingopt)){ |
  | 478 |  |  |
  | 479 |  | update\_option('best\_portfolio\_grid\_settings',$best\_portfolio\_grid\_settings); |
  | 480 |  |  |
  | 481 |  | } |
  | 482 |  | else{ |
  | 483 |  |  |
  | 484 |  | $flag=false; |
  | 485 |  | if(!isset($existingopt['resize\_images'])){ |
  | 486 |  |  |
  | 487 |  | $flag=true; |
  | 488 |  | $existingopt['resize\_images']='1'; |
  | 489 |  |  |
  |  | 412 |  |
  |  | 413 | require\_once (ABSPATH . 'wp-admin/includes/upgrade.php'); |
  |  | 414 | dbDelta($sql); |
  |  | 415 |  |
  |  | 416 | $best\_portfolio\_grid\_settings = array( |
  |  | 417 | 'BackgroundColor' => '#FFFFFF', |
  |  | 418 | 'imagewidth' => '273', |
  |  | 419 | 'imageheight' => '160', |
  |  | 420 | 'imageMargin' => '15', |
  |  | 421 | 'show\_filters' => '1', |
  |  | 422 | 'resize\_images' => '1', |
  |  | 423 | 'AllKeywordTranslate' => 'All', |
  |  | 424 | ); |
  |  | 425 |  |
  |  | 426 | $existingopt = get\_option('best\_portfolio\_grid\_settings'); |
  |  | 427 | if (!is\_array($existingopt)) { |
  |  | 428 |  |
  |  | 429 | update\_option('best\_portfolio\_grid\_settings', $best\_portfolio\_grid\_settings); |
  |  | 430 | } else { |
  |  | 431 |  |
  |  | 432 | $flag = false; |
  |  | 433 | if (!isset($existingopt['resize\_images'])) { |
  |  | 434 |  |
  |  | 435 | $flag = true; |
  |  | 436 | $existingopt['resize\_images'] = '1'; |
  |  | 437 | } |
  |  | 438 |  |
  |  | 439 | if ($flag == true) { |
  |  | 440 |  |
  |  | 441 | update\_option('best\_portfolio\_grid\_settings', $existingopt); |
  |  | 442 | } |
  |  | 443 | } |
  |  | 444 |  |
  |  | 445 |  |
  |  | 446 |  |
  |  | 447 | $uploads = wp\_upload\_dir(); |
  |  | 448 | $baseDir = $uploads ['basedir']; |
  |  | 449 | $baseDir = str\_replace('\\', '/', $baseDir); |
  |  | 450 | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  |  | 451 | wp\_mkdir\_p($pathToImagesFolder); |
  |  | 452 |  |
  |  | 453 | rfp\_responsive\_filterable\_portfolio\_add\_access\_capabilities(); |
  |  | 454 | } |
  |  | 455 |  |
  |  | 456 | function rfp\_responsive\_portfolio\_plus\_lightbox\_add\_admin\_menu() { |
  |  | 457 |  |
  |  | 458 | $hook\_suffix = add\_menu\_page(\_\_('Responsive Portfolio', 'responsive-filterable-portfolio'), \_\_('Responsive Portfolio', 'responsive-filterable-portfolio'), 'rfp\_filterablel\_portfolio\_settings', 'responsive\_portfolio\_with\_lightbox', 'rfp\_responsive\_portfolio\_with\_lightbox\_admin\_options\_func'); |
  |  | 459 | $hook\_suffix = add\_submenu\_page('responsive\_portfolio\_with\_lightbox', \_\_('Portfolio Settings', 'responsive-filterable-portfolio'), \_\_('Portfolio Settings', 'responsive-filterable-portfolio'), 'rfp\_filterablel\_portfolio\_settings', 'responsive\_portfolio\_with\_lightbox', 'rfp\_responsive\_portfolio\_with\_lightbox\_admin\_options\_func'); |
  |  | 460 | $hook\_suffix\_image = add\_submenu\_page('responsive\_portfolio\_with\_lightbox', \_\_('Manage Media', 'responsive-filterable-portfolio'), \_\_('Manage Media', 'responsive-filterable-portfolio'), 'rfp\_filterablel\_portfolio\_view\_media', 'responsive\_portfolio\_with\_lightbox\_media\_management', 'rfp\_responsive\_portfolio\_with\_lightbox\_media\_management\_func'); |
  |  | 461 | $hook\_suffix\_prev = add\_submenu\_page('responsive\_portfolio\_with\_lightbox', \_\_('Preview Portfolio', 'responsive-filterable-portfolio'), \_\_('Preview Portfolio', 'responsive-filterable-portfolio'), 'rfp\_filterablel\_portfolio\_preview', 'responsive\_portfolio\_with\_lightbox\_media\_preview', 'rfp\_responsive\_portfolio\_with\_lightbox\_media\_preview\_func'); |
  |  | 462 |  |
  |  | 463 | add\_action('load-' . $hook\_suffix, 'rfp\_responsive\_portfolio\_gallery\_plus\_lightbox\_add\_admin\_init'); |
  |  | 464 | add\_action('load-' . $hook\_suffix\_image, 'rfp\_responsive\_portfolio\_gallery\_plus\_lightbox\_add\_admin\_init'); |
  |  | 465 | add\_action('load-' . $hook\_suffix\_prev, 'rfp\_responsive\_portfolio\_gallery\_plus\_lightbox\_add\_admin\_init'); |
  |  | 466 |  |
  |  | 467 | rfp\_responsive\_portfolio\_plus\_lightbox\_admin\_scripts\_init(); |
  |  | 468 | } |
  |  | 469 |  |
  |  | 470 | function rfp\_responsive\_portfolio\_gallery\_plus\_lightbox\_add\_admin\_init() { |
  |  | 471 |  |
  |  | 472 |  |
  |  | 473 | $url = plugin\_dir\_url(\_\_FILE\_\_); |
  |  | 474 |  |
  |  | 475 | wp\_enqueue\_style('filterMediank', plugins\_url('/css/filterMediank.css', \_\_FILE\_\_)); |
  |  | 476 | wp\_enqueue\_style('filterMediank-lbox', plugins\_url('/css/filterMediank-lbox.css', \_\_FILE\_\_)); |
  |  | 477 | wp\_enqueue\_style('admincss', plugins\_url('/css/admincss.css', \_\_FILE\_\_)); |
  |  | 478 | wp\_enqueue\_script('jquery'); |
  |  | 479 | wp\_enqueue\_script('jquery.validate', $url . 'js/jquery.validate.js'); |
  |  | 480 | wp\_enqueue\_script('filterMediank', plugins\_url('/js/filterMediank.js', \_\_FILE\_\_)); |
  |  | 481 | wp\_enqueue\_script('filterMediank-lbox-js', $url . 'js/filterMediank-lbox-js.js'); |
  |  | 482 |  |
  |  | 483 | rfp\_responsive\_portfolio\_plus\_lightbox\_admin\_scripts\_init(); |
  |  | 484 | } |
  |  | 485 |  |
  |  | 486 | function rfp\_responsive\_portfolio\_with\_lightbox\_admin\_options\_func() { |
  |  | 487 |  |
  |  | 488 |  |
  |  | 489 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_settings')) { |
  |  | 490 |  |
  |  | 491 | wp\_die(\_\_('Access Denied', 'responsive-filterable-portfolio')); |
  |  | 492 | } |
  |  | 493 |  |
  |  | 494 | $action = 'gridview'; |
  |  | 495 | if (isset($\_GET ['action']) && $\_GET ['action'] != '') { |
  |  | 496 |  |
  |  | 497 | $action = sanitize\_text\_field($\_GET ['action']); |
  |  | 498 | } |
  |  | 499 |  |
  |  | 500 |  |
  |  | 501 | $url = plugin\_dir\_url(\_\_FILE\_\_); |
  |  | 502 |  |
  |  | 503 | if (isset($\_POST ['btnsave'])) { |
  |  | 504 |  |
  |  | 505 | if (!check\_admin\_referer('action\_image\_add\_edit', 'add\_edit\_image\_nonce')) { |
  |  | 506 |  |
  |  | 507 | wp\_die('Security check fail'); |
  |  | 508 | } |
  |  | 509 |  |
  |  | 510 | $imageheight = (int) trim(htmlentities(sanitize\_text\_field($\_POST['imageheight']))); |
  |  | 511 | $imagewidth = (int) trim(htmlentities(sanitize\_text\_field($\_POST['imagewidth']), ENT\_QUOTES)); |
  |  | 512 | $imageMargin = (int) trim(htmlentities(sanitize\_text\_field($\_POST['imageMargin']), ENT\_QUOTES)); |
  |  | 513 | $BackgroundColor = trim(htmlentities(sanitize\_text\_field($\_POST['BackgroundColor']), ENT\_QUOTES)); |
  |  | 514 | $AllKeywordTranslate = trim(htmlentities(sanitize\_text\_field($\_POST['AllKeywordTranslate']), ENT\_QUOTES)); |
  |  | 515 | $show\_filters = htmlentities(sanitize\_text\_field($\_POST['show\_filters']), ENT\_QUOTES); |
  |  | 516 | $resize\_images = htmlentities(sanitize\_text\_field($\_POST['resize\_images']), ENT\_QUOTES); |
  |  | 517 |  |
  |  | 518 | $best\_portfolio\_grid\_settings = array( |
  |  | 519 | 'BackgroundColor' => $BackgroundColor, |
  |  | 520 | 'imagewidth' => $imagewidth, |
  |  | 521 | 'imageheight' => $imageheight, |
  |  | 522 | 'imageMargin' => $imageMargin, |
  |  | 523 | 'show\_filters' => $show\_filters, |
  |  | 524 | 'AllKeywordTranslate' => $AllKeywordTranslate, |
  |  | 525 | 'resize\_images' => $resize\_images |
  |  | 526 | ); |
  |  | 527 |  |
  |  | 528 | update\_option('best\_portfolio\_grid\_settings', $best\_portfolio\_grid\_settings); |
  |  | 529 |  |
  |  | 530 | $wp\_best\_portfolio\_msg = array(); |
  |  | 531 | $wp\_best\_portfolio\_msg['type'] = 'succ'; |
  |  | 532 | $wp\_best\_portfolio\_msg['message'] = \_\_('Settings saved successfully.', 'responsive-filterable-portfolio'); |
  |  | 533 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 534 |  |
  |  | 535 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox'; |
  |  | 536 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 537 | exit(); |
  |  | 538 | } |
  |  | 539 |  |
  |  | 540 |  |
  |  | 541 |  |
  |  | 542 | $settings = get\_option('best\_portfolio\_grid\_settings'); |
  |  | 543 | if (!isset($settings['resize\_images'])) { |
  |  | 544 |  |
  |  | 545 | $settings['resize\_images'] = 1; |
  |  | 546 | } |
  |  | 547 | ?> |
  |  | 548 | <div id="poststuff" > |
  |  | 549 | <div id="post-body" class="metabox-holder columns-2" > |
  |  | 550 | <div id="post-body-content"> |
  |  | 551 |  |
  |  | 552 | <div class="wrap"> |
  |  | 553 | <table><tr> |
  |  | 554 | <td> |
  |  | 555 | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
  |  | 556 | <div id="fb-root"></div> |
  |  | 557 | <script>(function (d, s, id) { |
  |  | 558 | var js, fjs = d.getElementsByTagName(s)[0]; |
  |  | 559 | if (d.getElementById(id)) |
  |  | 560 | return; |
  |  | 561 | js = d.createElement(s); |
  |  | 562 | js.id = id; |
  |  | 563 | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
  |  | 564 | fjs.parentNode.insertBefore(js, fjs); |
  |  | 565 | }(document, 'script', 'facebook-jssdk'));</script> |
  |  | 566 | </td> |
  |  | 567 | <td> |
  |  | 568 | <a target="\_blank" title="Donate" href="https://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
  |  | 569 | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url('images/paypaldonate.jpg', \_\_FILE\_\_); ?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
  |  | 570 | </a> |
  |  | 571 | </td> |
  |  | 572 | </tr> |
  |  | 573 | </table> |
  |  | 574 | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/wordpress-responsive-media-portfolio-grid.html"><?php \_\_('UPGRADE TO PRO VERSION', 'responsive-filterable-portfolio'); ?></a></h3></span> |
  |  | 575 |  |
  |  | 576 | <?php |
  |  | 577 | $messages = get\_option('wp\_best\_portfolio\_msg'); |
  |  | 578 | $type = ''; |
  |  | 579 | $message = ''; |
  |  | 580 | if (isset($messages['type']) && $messages['type'] != '') { |
  |  | 581 |  |
  |  | 582 | $type = $messages['type']; |
  |  | 583 | $message = $messages['message']; |
  | 490 | 584 | } |
  | 491 |  |  |
  | 492 |  | if($flag==true){ |
  | 493 |  |  |
  | 494 |  | update\_option('best\_portfolio\_grid\_settings', $existingopt); |
  | 495 |  |  |
  | 496 |  | } |
  | 497 |  | } |
  | 498 |  |  |
  | 499 |  |  |
  | 500 |  |  |
  | 501 |  | $uploads = wp\_upload\_dir (); |
  | 502 |  | $baseDir = $uploads ['basedir']; |
  | 503 |  | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
  | 504 |  | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  | 505 |  | wp\_mkdir\_p ( $pathToImagesFolder ); |
  | 506 |  |  |
  | 507 |  | rfp\_responsive\_filterable\_portfolio\_add\_access\_capabilities(); |
  | 508 |  |  |
  |  | 585 |  |
  |  | 586 |  |
  |  | 587 | if (trim($type) == 'err') { |
  |  | 588 | echo "<div class='notice notice-error is-dismissible'><p>"; |
  |  | 589 | echo $message; |
  |  | 590 | echo '</p></div>'; |
  |  | 591 | } else if (trim($type) == 'succ') { |
  |  | 592 | echo "<div class='notice notice-success is-dismissible'><p>"; |
  |  | 593 | echo $message; |
  |  | 594 | echo '</p></div>'; |
  |  | 595 | } |
  |  | 596 |  |
  |  | 597 |  |
  |  | 598 |  |
  |  | 599 | update\_option('wp\_best\_portfolio\_msg', array()); |
  |  | 600 | ?> |
  |  | 601 |  |
  |  | 602 | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/wordpress-responsive-media-portfolio-grid.html"><?php echo \_\_('UPGRADE TO PRO VERSION', 'responsive-filterable-portfolio'); ?></a></h3></span> |
  |  | 603 | <h2><?php echo \_\_('Edit Portfolio', 'responsive-filterable-portfolio'); ?></h2> |
  |  | 604 | <br> |
  |  | 605 | <div id="poststuff"> |
  |  | 606 | <div id="post-body" class="metabox-holder columns-2"> |
  |  | 607 | <div id="post-body-content"> |
  |  | 608 | <form method="post" action="" id="scrollersettiings" |
  |  | 609 | name="scrollersettiings"> |
  |  | 610 |  |
  |  | 611 | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  |  | 612 | <h3> |
  |  | 613 | <label><?php echo \_\_('Grid Background color', 'responsive-filterable-portfolio'); ?></label> |
  |  | 614 | </h3> |
  |  | 615 | <div class="inside"> |
  |  | 616 | <table> |
  |  | 617 | <tr> |
  |  | 618 | <td><input type="text" id="BackgroundColor" size="30" |
  |  | 619 | name="BackgroundColor" |
  |  | 620 | value="<?php echo $settings['BackgroundColor']; ?>" |
  |  | 621 | style="width: 100px;"> |
  |  | 622 | <div style="clear: both"></div> |
  |  | 623 | <div></div></td> |
  |  | 624 | </tr> |
  |  | 625 | </table> |
  |  | 626 |  |
  |  | 627 | <div style="clear: both"></div> |
  |  | 628 | </div> |
  |  | 629 | </div> |
  |  | 630 | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  |  | 631 | <h3> |
  |  | 632 | <label><?php echo \_\_('Thumbnail Height', 'responsive-filterable-portfolio'); ?></label> |
  |  | 633 | </h3> |
  |  | 634 | <div class="inside"> |
  |  | 635 | <table> |
  |  | 636 | <tr> |
  |  | 637 | <td><input type="text" id="imageheight" size="30" |
  |  | 638 | name="imageheight" |
  |  | 639 | value="<?php echo $settings['imageheight']; ?>" |
  |  | 640 | style="width: 100px;"> |
  |  | 641 | <div style="clear: both"></div> |
  |  | 642 | <div></div></td> |
  |  | 643 | </tr> |
  |  | 644 | </table> |
  |  | 645 |  |
  |  | 646 | <div style="clear: both"></div> |
  |  | 647 | </div> |
  |  | 648 | </div> |
  |  | 649 | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  |  | 650 | <h3> |
  |  | 651 | <label><?php echo \_\_('Thumbnail Width', 'responsive-filterable-portfolio'); ?></label> |
  |  | 652 | </h3> |
  |  | 653 | <div class="inside"> |
  |  | 654 | <table> |
  |  | 655 | <tr> |
  |  | 656 | <td><input type="text" id="imagewidth" size="30" |
  |  | 657 | name="imagewidth" |
  |  | 658 | value="<?php echo $settings['imagewidth']; ?>" |
  |  | 659 | style="width: 100px;"> |
  |  | 660 | <div style="clear: both"></div> |
  |  | 661 | <div></div></td> |
  |  | 662 | </tr> |
  |  | 663 | </table> |
  |  | 664 |  |
  |  | 665 | <div style="clear: both"></div> |
  |  | 666 | </div> |
  |  | 667 | </div> |
  |  | 668 | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  |  | 669 | <h3> |
  |  | 670 | <label><?php echo \_\_('Thumbnail Margin', 'responsive-filterable-portfolio'); ?></label> |
  |  | 671 | </h3> |
  |  | 672 | <div class="inside"> |
  |  | 673 | <table> |
  |  | 674 | <tr> |
  |  | 675 | <td><input type="text" id="imageMargin" size="30" |
  |  | 676 | name="imageMargin" |
  |  | 677 | value="<?php echo $settings['imageMargin']; ?>" |
  |  | 678 | style="width: 100px;"> |
  |  | 679 | <div style="clear: both; padding-top: 5px"><?php echo \_\_('Gap between two images', 'responsive-filterable-portfolio'); ?></div> |
  |  | 680 | <div></div></td> |
  |  | 681 | </tr> |
  |  | 682 | </table> |
  |  | 683 |  |
  |  | 684 | <div style="clear: both"></div> |
  |  | 685 | </div> |
  |  | 686 | </div> |
  |  | 687 | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  |  | 688 | <h3> |
  |  | 689 | <label><?php echo \_\_('All Keyword Translate', 'responsive-filterable-portfolio'); ?></label> |
  |  | 690 | </h3> |
  |  | 691 | <div class="inside"> |
  |  | 692 | <table> |
  |  | 693 | <tr> |
  |  | 694 | <td><input type="text" id="AllKeywordTranslate" size="30" |
  |  | 695 | name="AllKeywordTranslate" |
  |  | 696 | value="<?php echo $settings['AllKeywordTranslate']; ?>" |
  |  | 697 | style="width: 100px;"> |
  |  | 698 | <div style="clear: both; padding-top: 5px"><?php echo \_\_('Used in filter', 'responsive-filterable-portfolio'); ?></div> |
  |  | 699 | <div></div></td> |
  |  | 700 | </tr> |
  |  | 701 | </table> |
  |  | 702 |  |
  |  | 703 | <div style="clear: both"></div> |
  |  | 704 | </div> |
  |  | 705 | </div> |
  |  | 706 | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  |  | 707 | <h3> |
  |  | 708 | <label><?php echo \_\_('Show Filter ?', 'responsive-filterable-portfolio'); ?></label> |
  |  | 709 | </h3> |
  |  | 710 | <div class="inside"> |
  |  | 711 | <table> |
  |  | 712 | <tr> |
  |  | 713 | <td><input style="width: 20px;" type='radio' |
  |  | 714 | <?php |
  |  | 715 | if ($settings ['show\_filters'] == true) { |
  |  | 716 | echo "checked='checked'"; |
  |  | 717 | } |
  |  | 718 | ?> |
  |  | 719 | name='show\_filters' value='1'><?php echo \_\_('Yes', 'responsive-filterable-portfolio'); ?> &nbsp;<input |
  |  | 720 | style="width: 20px;" type='radio' name='show\_filters' |
  |  | 721 | <?php |
  |  | 722 | if ($settings ['show\_filters'] == false) { |
  |  | 723 | echo "checked='checked'"; |
  |  | 724 | } |
  |  | 725 | ?> |
  |  | 726 | value='0'><?php echo \_\_('No', 'responsive-filterable-portfolio'); ?> |
  |  | 727 | <div style="clear: both"></div> |
  |  | 728 | <div></div></td> |
  |  | 729 | </tr> |
  |  | 730 | </table> |
  |  | 731 | <div style="clear: both"></div> |
  |  | 732 | </div> |
  |  | 733 | </div> |
  |  | 734 | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  |  | 735 | <h3> |
  |  | 736 | <label><?php echo \_\_('Resize image physically?', 'responsive-filterable-portfolio'); ?></label> |
  |  | 737 | </h3> |
  |  | 738 | <div class="inside"> |
  |  | 739 | <table> |
  |  | 740 | <tr> |
  |  | 741 | <td><input style="width: 20px;" type='radio' |
  |  | 742 | <?php |
  |  | 743 | if ($settings ['resize\_images'] == true) { |
  |  | 744 | echo "checked='checked'"; |
  |  | 745 | } |
  |  | 746 | ?> |
  |  | 747 | name='resize\_images' value='1'><?php echo \_\_('yes', 'responsive-filterable-portfolio'); ?> &nbsp;<input |
  |  | 748 | style="width: 20px;" type='radio' name='resize\_images' |
  |  | 749 | <?php |
  |  | 750 | if ($settings ['resize\_images'] == false) { |
  |  | 751 | echo "checked='checked'"; |
  |  | 752 | } |
  |  | 753 | ?> |
  |  | 754 | value='0'><?php echo \_\_('No', 'responsive-filterable-portfolio'); ?> |
  |  | 755 | <div style="clear: both"></div> |
  |  | 756 | <div></div></td> |
  |  | 757 | </tr> |
  |  | 758 | </table> |
  |  | 759 | <div style="clear: both"></div> |
  |  | 760 | </div> |
  |  | 761 | </div> |
  |  | 762 | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
  |  | 763 | <input type="submit" |
  |  | 764 | name="btnsave" id="btnsave" |
  |  | 765 | value="<?php echo \_\_('Save Changes', 'responsive-filterable-portfolio'); ?>" |
  |  | 766 | class="button-primary">&nbsp;&nbsp;<input type="button" |
  |  | 767 | name="cancle" id="cancle" value="<?php echo \_\_('Cancel', 'responsive-filterable-portfolio'); ?>" class="button-primary" |
  |  | 768 | onclick="location.href = 'admin.php?page=responsive\_portfolio\_with\_lightbox'"> |
  |  | 769 |  |
  |  | 770 | </form> |
  |  | 771 | <script type="text/javascript"> |
  |  | 772 |  |
  |  | 773 | jQuery(document).ready(function () { |
  |  | 774 |  |
  |  | 775 | jQuery("#scrollersettiings").validate({ |
  |  | 776 | rules: { |
  |  | 777 |  |
  |  | 778 | BackgroundColor: { |
  |  | 779 | required: true, |
  |  | 780 | maxlength: 7 |
  |  | 781 | }, |
  |  | 782 | imageheight: { |
  |  | 783 | required: true, |
  |  | 784 | digits: true, |
  |  | 785 | maxlength: 15 |
  |  | 786 | }, |
  |  | 787 | imagewidth: { |
  |  | 788 | required: true, |
  |  | 789 | digits: true, |
  |  | 790 | maxlength: 15 |
  |  | 791 | }, |
  |  | 792 | imageMargin: { |
  |  | 793 | required: true, |
  |  | 794 | number: true, |
  |  | 795 | maxlength: 15 |
  |  | 796 | }, |
  |  | 797 | AllKeywordTranslate: { |
  |  | 798 | required: true, |
  |  | 799 | maxlength: 200 |
  |  | 800 | }, |
  |  | 801 | resize\_images: { |
  |  | 802 | maxlength: 200 |
  |  | 803 | } |
  |  | 804 |  |
  |  | 805 |  |
  |  | 806 |  |
  |  | 807 | }, |
  |  | 808 | errorClass: "image\_error", |
  |  | 809 | errorPlacement: function (error, element) { |
  |  | 810 | error.appendTo(element.next().next()); |
  |  | 811 | } |
  |  | 812 |  |
  |  | 813 |  |
  |  | 814 | }) |
  |  | 815 |  |
  |  | 816 | jQuery('#BackgroundColor').wpColorPicker(); |
  |  | 817 | }); |
  |  | 818 | </script> |
  |  | 819 |  |
  |  | 820 | </div> |
  |  | 821 | </div> |
  |  | 822 | </div> |
  |  | 823 |  |
  |  | 824 |  |
  |  | 825 | <div id="postbox-container-1" class="postbox-container" > |
  |  | 826 |  |
  |  | 827 | <div class="postbox"> |
  |  | 828 | <h3 class="hndle"><span></span><?php echo \_\_('Access All Themes In One Price', 'responsive-filterable-portfolio'); ?></h3> |
  |  | 829 | <div class="inside"> |
  |  | 830 | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"> |
  |  | 831 | <img border="0" src="<?php echo plugins\_url('images/300x250.gif', \_\_FILE\_\_); ?>" width="250" height="250"> |
  |  | 832 | </a></center> |
  |  | 833 |  |
  |  | 834 | <div style="margin:10px 5px"> |
  |  | 835 |  |
  |  | 836 | </div> |
  |  | 837 | </div></div> |
  |  | 838 | <div class="postbox"> |
  |  | 839 | <h3 class="hndle"><span></span><?php echo \_\_('Google For Business Coupon', 'responsive-filterable-portfolio'); ?></h3> |
  |  | 840 | <div class="inside"> |
  |  | 841 | <center><a href="https://goo.gl/OJBuHT" target="\_blank"> |
  |  | 842 | <img src="<?php echo plugins\_url('images/g-suite-promo-code-4.png', \_\_FILE\_\_); ?>" width="250" height="250" border="0"> |
  |  | 843 | </a></center> |
  |  | 844 | <div style="margin:10px 5px"> |
  |  | 845 | </div> |
  |  | 846 | </div> |
  |  | 847 |  |
  |  | 848 | </div> |
  |  | 849 |  |
  |  | 850 | </div> |
  |  | 851 | </div> |
  |  | 852 | </div> |
  |  | 853 | <div class="clear"></div> |
  |  | 854 | </div> |
  |  | 855 | </div> |
  |  | 856 | <?php |
  | 509 | 857 | } |
  | 510 |  | function rfp\_responsive\_portfolio\_plus\_lightbox\_add\_admin\_menu() { |
  | 511 |  |  |
  | 512 |  | $hook\_suffix = add\_menu\_page ( \_\_ ( 'Responsive Portfolio','responsive-filterable-portfolio' ), \_\_ ( 'Responsive Portfolio','responsive-filterable-portfolio' ), 'rfp\_filterablel\_portfolio\_settings', 'responsive\_portfolio\_with\_lightbox', 'rfp\_responsive\_portfolio\_with\_lightbox\_admin\_options\_func' ); |
  | 513 |  | $hook\_suffix=add\_submenu\_page ( 'responsive\_portfolio\_with\_lightbox', \_\_ ( 'Portfolio Settings','responsive-filterable-portfolio' ), \_\_ ( 'Portfolio Settings','responsive-filterable-portfolio' ), 'rfp\_filterablel\_portfolio\_settings', 'responsive\_portfolio\_with\_lightbox', 'rfp\_responsive\_portfolio\_with\_lightbox\_admin\_options\_func' ); |
  | 514 |  | $hook\_suffix\_image=add\_submenu\_page ( 'responsive\_portfolio\_with\_lightbox', \_\_ ( 'Manage Media','responsive-filterable-portfolio' ), \_\_ ( 'Manage Media','responsive-filterable-portfolio' ), 'rfp\_filterablel\_portfolio\_view\_media', 'responsive\_portfolio\_with\_lightbox\_media\_management', 'rfp\_responsive\_portfolio\_with\_lightbox\_media\_management\_func' ); |
  | 515 |  | $hook\_suffix\_prev=add\_submenu\_page ( 'responsive\_portfolio\_with\_lightbox', \_\_ ( 'Preview Portfolio','responsive-filterable-portfolio' ), \_\_ ( 'Preview Portfolio','responsive-filterable-portfolio' ), 'rfp\_filterablel\_portfolio\_preview', 'responsive\_portfolio\_with\_lightbox\_media\_preview', 'rfp\_responsive\_portfolio\_with\_lightbox\_media\_preview\_func' ); |
  | 516 |  |  |
  | 517 |  | add\_action( 'load-' . $hook\_suffix , 'rfp\_responsive\_portfolio\_gallery\_plus\_lightbox\_add\_admin\_init' ); |
  | 518 |  | add\_action( 'load-' . $hook\_suffix\_image , 'rfp\_responsive\_portfolio\_gallery\_plus\_lightbox\_add\_admin\_init' ); |
  | 519 |  | add\_action( 'load-' . $hook\_suffix\_prev , 'rfp\_responsive\_portfolio\_gallery\_plus\_lightbox\_add\_admin\_init' ); |
  | 520 |  |  |
  | 521 |  | rfp\_responsive\_portfolio\_plus\_lightbox\_admin\_scripts\_init(); |
  | 522 |  |  |
  | 523 |  | } |
  | 524 |  | function rfp\_responsive\_portfolio\_gallery\_plus\_lightbox\_add\_admin\_init() { |
  | 525 |  |  |
  | 526 |  |  |
  | 527 |  | $url = plugin\_dir\_url ( \_\_FILE\_\_ ); |
  | 528 |  |  |
  | 529 |  | wp\_enqueue\_style ( 'filterMediank', plugins\_url ( '/css/filterMediank.css', \_\_FILE\_\_ ) ); |
  | 530 |  | wp\_enqueue\_style ( 'filterMediank-lbox', plugins\_url ( '/css/filterMediank-lbox.css', \_\_FILE\_\_ ) ); |
  | 531 |  | wp\_enqueue\_style ( 'admincss', plugins\_url ( '/css/admincss.css', \_\_FILE\_\_ ) ); |
  | 532 |  | wp\_enqueue\_script ( 'jquery' ); |
  | 533 |  | wp\_enqueue\_script ( 'jquery.validate', $url . 'js/jquery.validate.js' ); |
  | 534 |  | wp\_enqueue\_script ( 'filterMediank', plugins\_url ( '/js/filterMediank.js', \_\_FILE\_\_ ) ); |
  | 535 |  | wp\_enqueue\_script ( 'filterMediank-lbox-js', $url . 'js/filterMediank-lbox-js.js' ); |
  | 536 |  |  |
  | 537 |  |  |
  | 538 |  | rfp\_responsive\_portfolio\_plus\_lightbox\_admin\_scripts\_init(); |
  | 539 |  | } |
  | 540 |  |  |
  | 541 |  | function rfp\_responsive\_portfolio\_with\_lightbox\_admin\_options\_func() { |
  | 542 |  |  |
  | 543 |  |  |
  | 544 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_settings' ) ) { |
  | 545 |  |  |
  | 546 |  | wp\_die( \_\_( "Access Denied", "responsive-filterable-portfolio" ) ); |
  | 547 |  |  |
  | 548 |  | } |
  | 549 |  |  |
  | 550 |  | $action = 'gridview'; |
  | 551 |  | if (isset ( $\_GET ['action'] ) and $\_GET ['action'] != '') { |
  | 552 |  |  |
  | 553 |  | $action = trim ( $\_GET ['action'] ); |
  | 554 |  | } |
  | 555 |  |  |
  | 556 |  |  |
  | 557 |  | $url = plugin\_dir\_url ( \_\_FILE\_\_ ); |
  | 558 |  |  |
  | 559 |  | if (isset ( $\_POST ['btnsave'] )) { |
  | 560 |  |  |
  | 561 |  | if (!check\_admin\_referer('action\_image\_add\_edit', 'add\_edit\_image\_nonce')) { |
  | 562 |  |  |
  | 563 |  | wp\_die('Security check fail'); |
  | 564 |  | } |
  | 565 |  |  |
  | 566 |  | $imageheight = (int)trim(htmlentities(sanitize\_text\_field( $\_POST['imageheight'] ))); |
  | 567 |  | $imagewidth = (int)trim (htmlentities(sanitize\_text\_field( $\_POST['imagewidth'] ),ENT\_QUOTES)); |
  | 568 |  | $imageMargin = (int)trim ( htmlentities(sanitize\_text\_field($\_POST['imageMargin'] ),ENT\_QUOTES)); |
  | 569 |  | $BackgroundColor = trim ( htmlentities(sanitize\_text\_field($\_POST['BackgroundColor'] ),ENT\_QUOTES)); |
  | 570 |  | $AllKeywordTranslate = trim ( htmlentities(sanitize\_text\_field($\_POST['AllKeywordTranslate'] ),ENT\_QUOTES)); |
  | 571 |  | $show\_filters = htmlentities(sanitize\_text\_field($\_POST['show\_filters']),ENT\_QUOTES); |
  | 572 |  | $resize\_images = htmlentities(sanitize\_text\_field($\_POST['resize\_images']),ENT\_QUOTES); |
  | 573 |  |  |
  | 574 |  | $best\_portfolio\_grid\_settings=array( |
  | 575 |  |  |
  | 576 |  | 'BackgroundColor'=>$BackgroundColor, |
  | 577 |  | 'imagewidth'=>$imagewidth, |
  | 578 |  | 'imageheight'=>$imageheight, |
  | 579 |  | 'imageMargin'=>$imageMargin, |
  | 580 |  | 'show\_filters'=>$show\_filters, |
  | 581 |  | 'AllKeywordTranslate'=>$AllKeywordTranslate, |
  | 582 |  | 'resize\_images'=>$resize\_images |
  | 583 |  |  |
  | 584 |  | ); |
  | 585 |  |  |
  | 586 |  |  |
  | 587 |  | update\_option('best\_portfolio\_grid\_settings',$best\_portfolio\_grid\_settings); |
  | 588 |  |  |
  | 589 |  | $wp\_best\_portfolio\_msg=array(); |
  | 590 |  | $wp\_best\_portfolio\_msg['type']='succ'; |
  | 591 |  | $wp\_best\_portfolio\_msg['message']= \_\_('Settings saved successfully.','responsive-filterable-portfolio'); |
  | 592 |  | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  | 593 |  |  |
  | 594 |  | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox'; |
  | 595 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 596 |  | exit (); |
  | 597 |  | } |
  | 598 |  |  |
  | 599 |  |  |
  | 600 |  |  |
  | 601 |  | $settings = get\_option('best\_portfolio\_grid\_settings'); |
  | 602 |  | if(!isset($settings['resize\_images'])){ |
  | 603 |  |  |
  | 604 |  | $settings['resize\_images']=1; |
  | 605 |  |  |
  | 606 |  | } |
  | 607 |  |  |
  | 608 |  |  |
  | 609 |  | ?> |
  | 610 |  | <div id="poststuff" > |
  | 611 |  | <div id="post-body" class="metabox-holder columns-2" > |
  | 612 |  | <div id="post-body-content"> |
  | 613 |  |  |
  | 614 |  | <div class="wrap"> |
  | 615 |  | <table><tr> |
  | 616 |  | <td> |
  | 617 |  | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
  | 618 |  | <div id="fb-root"></div> |
  | 619 |  | <script>(function(d, s, id) { |
  |  | 858 |  |
  |  | 859 | function rfp\_responsive\_portfolio\_with\_lightbox\_media\_management\_func() { |
  |  | 860 | $action = 'gridview'; |
  |  | 861 | global $wpdb; |
  |  | 862 |  |
  |  | 863 | if (isset($\_GET ['action']) && $\_GET ['action'] != '') { |
  |  | 864 |  |
  |  | 865 | $action = sanitize\_text\_field($\_GET ['action']); |
  |  | 866 | } |
  |  | 867 | ?> |
  |  | 868 |  |
  |  | 869 | <?php |
  |  | 870 | if (strtolower($action) == strtolower('gridview')) { |
  |  | 871 |  |
  |  | 872 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_view\_media')) { |
  |  | 873 |  |
  |  | 874 | wp\_die(\_\_('Access Denied', 'responsive-filterable-portfolio')); |
  |  | 875 | } |
  |  | 876 |  |
  |  | 877 | $wpcurrentdir = dirname(\_\_FILE\_\_); |
  |  | 878 | $wpcurrentdir = str\_replace('\\', '/', $wpcurrentdir); |
  |  | 879 |  |
  |  | 880 | $uploads = wp\_upload\_dir(); |
  |  | 881 | $baseurl = $uploads ['baseurl']; |
  |  | 882 | $baseurl .= '/wp-best-portfolio/'; |
  |  | 883 |  |
  |  | 884 | if (isset($\_GET['order\_by'])) { |
  |  | 885 |  |
  |  | 886 | $order\_by = sanitize\_text\_field($\_GET['order\_by']); |
  |  | 887 | } |
  |  | 888 |  |
  |  | 889 | if (isset($\_GET['order\_pos'])) { |
  |  | 890 |  |
  |  | 891 | $order\_pos = sanitize\_text\_field($\_GET['order\_pos']); |
  |  | 892 | } |
  |  | 893 |  |
  |  | 894 | $search\_term\_ = ''; |
  |  | 895 | if (isset($\_GET['search\_term'])) { |
  |  | 896 |  |
  |  | 897 | $search\_term\_ = '&search\_term=' . esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
  |  | 898 | } |
  |  | 899 | ?> |
  |  | 900 |  |
  |  | 901 | <div id="poststuff" > |
  |  | 902 | <div id="post-body" class="metabox-holder columns-2" > |
  |  | 903 | <div id="post-body-content"> |
  |  | 904 | <div class="wrap"> |
  |  | 905 |  |
  |  | 906 | <table><tr> |
  |  | 907 | <td> |
  |  | 908 | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
  |  | 909 | <div id="fb-root"></div> |
  |  | 910 | <script>(function (d, s, id) { |
  | 620 | 911 | var js, fjs = d.getElementsByTagName(s)[0]; |
  | 621 |  | if (d.getElementById(id)) return; |
  | 622 |  | js = d.createElement(s); js.id = id; |
  |  | 912 | if (d.getElementById(id)) |
  |  | 913 | return; |
  |  | 914 | js = d.createElement(s); |
  |  | 915 | js.id = id; |
  | 623 | 916 | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
  | 624 | 917 | fjs.parentNode.insertBefore(js, fjs); |
  | 625 |  | }(document, 'script', 'facebook-jssdk'));</script> |
  | 626 |  | </td> |
  |  | 918 | }(document, 'script', 'facebook-jssdk'));</script> |
  |  | 919 | </td> |
  | 627 | 920 | <td> |
  | 628 |  | <a target="\_blank" title="Donate" href="http~~s~~://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
  | 629 |  | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url(~~'images/paypaldonate.jpg', \_\_FILE\_\_ ) ;~~?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
  |  | 921 | <a target="\_blank" title="Donate" href="http://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
  |  | 922 | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url('images/paypaldonate.jpg', \_\_FILE\_\_); ?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
  | 630 | 923 | </a> |
  | 631 | 924 | </td> |
  | 632 | 925 | </tr> |
  | 633 | 926 | </table> |
  | 634 |  | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/wordpress-responsive-media-portfolio-grid.html"><?php \_\_('UPGRADE TO PRO VERSION','responsive-filterable-portfolio');?></a></h3></span> |
  | 635 |  |  |
  |  | 927 | <span><h3 style="color: blue;"><a target="\_blank" href="http://www.i13websolution.com/wordpress-responsive-media-portfolio-grid.html"><?php echo \_\_('UPGRADE TO PRO VERSION', 'responsive-filterable-portfolio'); ?></a></h3></span> |
  | 636 | 928 | <?php |
  | 637 |  | $messages=get\_option('wp\_best\_portfolio\_msg'); |
  | 638 |  | $type=''; |
  | 639 |  | $message=''; |
  | 640 |  | if(isset($messages['type']) and $messages['type']!=""){ |
  | 641 |  |  |
  | 642 |  | $type=$messages['type']; |
  | 643 |  | $message=$messages['message']; |
  | 644 |  |  |
  | 645 |  | } |
  | 646 |  |  |
  | 647 |  |  |
  | 648 |  | if(trim($type)=='err'){ echo "<div class='notice notice-error is-dismissible'><p>"; echo $message; echo "</p></div>";} |
  | 649 |  | else if(trim($type)=='succ'){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $message; echo "</p></div>";} |
  | 650 |  |  |
  | 651 |  |  |
  | 652 |  |  |
  | 653 |  | update\_option('wp\_best\_portfolio\_msg', array()); |
  | 654 |  | ?> |
  | 655 |  | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/wordpress-responsive-media-portfolio-grid.html"><?php echo \_\_('UPGRADE TO PRO VERSION','responsive-filterable-portfolio');?></a></h3></span> |
  | 656 |  | <h2><?php echo \_\_('Edit Portfolio',"responsive-filterable-portfolio");?></h2> |
  | 657 |  | <br> |
  | 658 |  | <div id="poststuff"> |
  | 659 |  | <div id="post-body" class="metabox-holder columns-2"> |
  | 660 |  | <div id="post-body-content"> |
  | 661 |  | <form method="post" action="" id="scrollersettiings" |
  | 662 |  | name="scrollersettiings"> |
  | 663 |  |  |
  | 664 |  | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  | 665 |  | <h3> |
  | 666 |  | <label><?php echo \_\_('Grid Background color','responsive-filterable-portfolio');?></label> |
  | 667 |  | </h3> |
  | 668 |  | <div class="inside"> |
  | 669 |  | <table> |
  | 670 |  | <tr> |
  | 671 |  | <td><input type="text" id="BackgroundColor" size="30" |
  | 672 |  | name="BackgroundColor" |
  | 673 |  | value="<?php echo $settings['BackgroundColor']; ?>" |
  | 674 |  | style="width: 100px;"> |
  | 675 |  | <div style="clear: both"></div> |
  | 676 |  | <div></div></td> |
  | 677 |  | </tr> |
  | 678 |  | </table> |
  | 679 |  |  |
  | 680 |  | <div style="clear: both"></div> |
  | 681 |  | </div> |
  | 682 |  | </div> |
  | 683 |  | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  | 684 |  | <h3> |
  | 685 |  | <label><?php echo \_\_('Thumbnail Height','responsive-filterable-portfolio');?></label> |
  | 686 |  | </h3> |
  | 687 |  | <div class="inside"> |
  | 688 |  | <table> |
  | 689 |  | <tr> |
  | 690 |  | <td><input type="text" id="imageheight" size="30" |
  | 691 |  | name="imageheight" |
  | 692 |  | value="<?php echo $settings['imageheight']; ?>" |
  | 693 |  | style="width: 100px;"> |
  | 694 |  | <div style="clear: both"></div> |
  | 695 |  | <div></div></td> |
  | 696 |  | </tr> |
  | 697 |  | </table> |
  | 698 |  |  |
  | 699 |  | <div style="clear: both"></div> |
  | 700 |  | </div> |
  | 701 |  | </div> |
  | 702 |  | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  | 703 |  | <h3> |
  | 704 |  | <label><?php echo \_\_('Thumbnail Width','responsive-filterable-portfolio');?></label> |
  | 705 |  | </h3> |
  | 706 |  | <div class="inside"> |
  | 707 |  | <table> |
  | 708 |  | <tr> |
  | 709 |  | <td><input type="text" id="imagewidth" size="30" |
  | 710 |  | name="imagewidth" |
  | 711 |  | value="<?php echo $settings['imagewidth']; ?>" |
  | 712 |  | style="width: 100px;"> |
  | 713 |  | <div style="clear: both"></div> |
  | 714 |  | <div></div></td> |
  | 715 |  | </tr> |
  | 716 |  | </table> |
  | 717 |  |  |
  | 718 |  | <div style="clear: both"></div> |
  | 719 |  | </div> |
  | 720 |  | </div> |
  | 721 |  | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  | 722 |  | <h3> |
  | 723 |  | <label><?php echo \_\_('Thumbnail Margin','responsive-filterable-portfolio');?></label> |
  | 724 |  | </h3> |
  | 725 |  | <div class="inside"> |
  | 726 |  | <table> |
  | 727 |  | <tr> |
  | 728 |  | <td><input type="text" id="imageMargin" size="30" |
  | 729 |  | name="imageMargin" |
  | 730 |  | value="<?php echo $settings['imageMargin']; ?>" |
  | 731 |  | style="width: 100px;"> |
  | 732 |  | <div style="clear: both; padding-top: 5px"><?php echo \_\_('Gap between two images','responsive-filterable-portfolio');?></div> |
  | 733 |  | <div></div></td> |
  | 734 |  | </tr> |
  | 735 |  | </table> |
  | 736 |  |  |
  | 737 |  | <div style="clear: both"></div> |
  | 738 |  | </div> |
  | 739 |  | </div> |
  | 740 |  | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  | 741 |  | <h3> |
  | 742 |  | <label><?php echo \_\_('All Keyword Translate','responsive-filterable-portfolio');?></label> |
  | 743 |  | </h3> |
  | 744 |  | <div class="inside"> |
  | 745 |  | <table> |
  | 746 |  | <tr> |
  | 747 |  | <td><input type="text" id="AllKeywordTranslate" size="30" |
  | 748 |  | name="AllKeywordTranslate" |
  | 749 |  | value="<?php echo $settings['AllKeywordTranslate']; ?>" |
  | 750 |  | style="width: 100px;"> |
  | 751 |  | <div style="clear: both; padding-top: 5px"><?php echo \_\_('Used in filter','responsive-filterable-portfolio');?></div> |
  | 752 |  | <div></div></td> |
  | 753 |  | </tr> |
  | 754 |  | </table> |
  | 755 |  |  |
  | 756 |  | <div style="clear: both"></div> |
  | 757 |  | </div> |
  | 758 |  | </div> |
  | 759 |  | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  | 760 |  | <h3> |
  | 761 |  | <label><?php echo \_\_('Show Filter ?','responsive-filterable-portfolio');?></label> |
  | 762 |  | </h3> |
  | 763 |  | <div class="inside"> |
  | 764 |  | <table> |
  | 765 |  | <tr> |
  | 766 |  | <td><input style="width: 20px;" type='radio' |
  | 767 |  | <?php |
  | 768 |  | if ($settings ['show\_filters'] == true) { |
  | 769 |  | echo "checked='checked'"; |
  | 770 |  | } |
  | 771 |  | ?> |
  | 772 |  | name='show\_filters' value='1'><?php echo \_\_('Yes','responsive-filterable-portfolio');?> &nbsp;<input |
  | 773 |  | style="width: 20px;" type='radio' name='show\_filters' |
  | 774 |  | <?php |
  | 775 |  | if ($settings ['show\_filters'] == false) { |
  | 776 |  | echo "checked='checked'"; |
  | 777 |  | } |
  | 778 |  | ?> |
  | 779 |  | value='0'><?php echo \_\_('No','responsive-filterable-portfolio');?> |
  | 780 |  | <div style="clear: both"></div> |
  | 781 |  | <div></div></td> |
  | 782 |  | </tr> |
  | 783 |  | </table> |
  | 784 |  | <div style="clear: both"></div> |
  | 785 |  | </div> |
  | 786 |  | </div> |
  | 787 |  | <div class="stuffbox" id="namediv" style="width: 100%;"> |
  | 788 |  | <h3> |
  | 789 |  | <label><?php echo \_\_('Resize image physically?','responsive-filterable-portfolio');?></label> |
  | 790 |  | </h3> |
  | 791 |  | <div class="inside"> |
  | 792 |  | <table> |
  | 793 |  | <tr> |
  | 794 |  | <td><input style="width: 20px;" type='radio' |
  | 795 |  | <?php |
  | 796 |  | if ($settings ['resize\_images'] == true) { |
  | 797 |  | echo "checked='checked'"; |
  | 798 |  | } |
  | 799 |  | ?> |
  | 800 |  | name='resize\_images' value='1'><?php echo \_\_('yes','responsive-filterable-portfolio');?> &nbsp;<input |
  | 801 |  | style="width: 20px;" type='radio' name='resize\_images' |
  | 802 |  | <?php |
  | 803 |  | if ($settings ['resize\_images'] == false) { |
  | 804 |  | echo "checked='checked'"; |
  | 805 |  | } |
  | 806 |  | ?> |
  | 807 |  | value='0'><?php echo \_\_('No','responsive-filterable-portfolio');?> |
  | 808 |  | <div style="clear: both"></div> |
  | 809 |  | <div></div></td> |
  | 810 |  | </tr> |
  | 811 |  | </table> |
  | 812 |  | <div style="clear: both"></div> |
  | 813 |  | </div> |
  | 814 |  | </div> |
  | 815 |  | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
  | 816 |  | <input type="submit" |
  | 817 |  | name="btnsave" id="btnsave" |
  | 818 |  | value="<?php echo \_\_('Save Changes','responsive-filterable-portfolio');?>" |
  | 819 |  | class="button-primary">&nbsp;&nbsp;<input type="button" |
  | 820 |  | name="cancle" id="cancle" value="<?php echo \_\_('Cancel','responsive-filterable-portfolio');?>" class="button-primary" |
  | 821 |  | onclick="location.href = 'admin.php?page=responsive\_portfolio\_with\_lightbox'"> |
  | 822 |  |  |
  | 823 |  | </form> |
  | 824 |  | <script type="text/javascript"> |
  | 825 |  |  |
  | 826 |  | jQuery(document).ready(function() { |
  | 827 |  |  |
  | 828 |  | jQuery("#scrollersettiings").validate({ |
  | 829 |  | rules: { |
  | 830 |  |  |
  | 831 |  | BackgroundColor:{ |
  | 832 |  | required:true, |
  | 833 |  | maxlength:7 |
  | 834 |  | }, |
  | 835 |  | imageheight:{ |
  | 836 |  | required:true, |
  | 837 |  | digits:true, |
  | 838 |  | maxlength:15 |
  | 839 |  | }, |
  | 840 |  | imagewidth:{ |
  | 841 |  | required:true, |
  | 842 |  | digits:true, |
  | 843 |  | maxlength:15 |
  | 844 |  | }, |
  | 845 |  | imageMargin:{ |
  | 846 |  | required:true, |
  | 847 |  | number:true, |
  | 848 |  | maxlength:15 |
  | 849 |  | }, |
  | 850 |  | AllKeywordTranslate:{ |
  | 851 |  | required:true, |
  | 852 |  | maxlength:200 |
  | 853 |  | }, |
  | 854 |  | resize\_images:{ |
  | 855 |  | maxlength:200 |
  | 856 |  | } |
  | 857 |  |  |
  | 858 |  |  |
  | 859 |  |  |
  | 860 |  | }, |
  | 861 |  | errorClass: "image\_error", |
  | 862 |  | errorPlacement: function(error, element) { |
  | 863 |  | error.appendTo(element.next().next()); |
  | 864 |  | } |
  | 865 |  |  |
  | 866 |  |  |
  | 867 |  | }) |
  | 868 |  |  |
  | 869 |  | jQuery('#BackgroundColor').wpColorPicker(); |
  | 870 |  | }); |
  | 871 |  | </script> |
  | 872 |  |  |
  | 873 |  | </div> |
  | 874 |  | </div> |
  | 875 |  | </div> |
  | 876 |  |  |
  | 877 |  |  |
  | 878 |  | <div id="postbox-container-1" class="postbox-container" > |
  | 879 |  |  |
  | 880 |  | <div class="postbox"> |
  | 881 |  | <h3 class="hndle"><span></span><?php echo \_\_('Access All Themes In One Price','responsive-filterable-portfolio');?></h3> |
  | 882 |  | <div class="inside"> |
  | 883 |  | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"> |
  | 884 |  | <img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_);?>" width="250" height="250"> |
  | 885 |  | </a></center> |
  | 886 |  |  |
  | 887 |  | <div style="margin:10px 5px"> |
  | 888 |  |  |
  | 889 |  | </div> |
  | 890 |  | </div></div> |
  | 891 |  | <div class="postbox"> |
  | 892 |  | <h3 class="hndle"><span></span><?php echo \_\_('Google For Business Coupon','responsive-filterable-portfolio');?></h3> |
  | 893 |  | <div class="inside"> |
  | 894 |  | <center><a href="https://goo.gl/OJBuHT" target="\_blank"> |
  | 895 |  | <img src="<?php echo plugins\_url( 'images/g-suite-promo-code-4.png', \_\_FILE\_\_ );?>" width="250" height="250" border="0"> |
  | 896 |  | </a></center> |
  | 897 |  | <div style="margin:10px 5px"> |
  | 898 |  | </div> |
  | 899 |  | </div> |
  | 900 |  |  |
  |  | 929 | $messages = get\_option('wp\_best\_portfolio\_msg'); |
  |  | 930 | $type = ''; |
  |  | 931 | $message = ''; |
  |  | 932 | if (isset($messages ['type']) && $messages ['type'] != '') { |
  |  | 933 |  |
  |  | 934 | $type = $messages ['type']; |
  |  | 935 | $message = $messages ['message']; |
  |  | 936 | } |
  |  | 937 |  |
  |  | 938 | if (trim($type) == 'err') { |
  |  | 939 | echo "<div class='notice notice-error is-dismissible'><p>"; |
  |  | 940 | echo $message; |
  |  | 941 | echo '</p></div>'; |
  |  | 942 | } else if (trim($type) == 'succ') { |
  |  | 943 | echo "<div class='notice notice-success is-dismissible'><p>"; |
  |  | 944 | echo $message; |
  |  | 945 | echo '</p></div>'; |
  |  | 946 | } |
  |  | 947 |  |
  |  | 948 |  |
  |  | 949 | update\_option('wp\_best\_portfolio\_msg', array()); |
  |  | 950 | ?> |
  |  | 951 |  |
  |  | 952 | <div style="width: 100%;"> |
  |  | 953 | <div style="float: left; width: 100%;"> |
  |  | 954 | <div class="icon32 icon32-posts-post" id="icon-edit"> |
  |  | 955 | <br> |
  |  | 956 | </div> |
  |  | 957 | <h2> |
  |  | 958 | <?php echo \_\_('Media', 'responsive-filterable-portfolio'); ?><a class="button add-new-h2" href="admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management&action=addedit"><?php echo \_\_('Add New', 'responsive-filterable-portfolio'); ?></a> |
  |  | 959 | </h2> |
  |  | 960 | <br /> |
  |  | 961 |  |
  |  | 962 | <form method="POST" action="admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management&action=deleteselected" id="posts-filter" onkeypress="return event.keyCode != 13;"> |
  |  | 963 | <div class="alignleft actions"> |
  |  | 964 | <select name="action\_upper" id="action\_upper"> |
  |  | 965 | <option selected="selected" value="-1"><?php echo \_\_('Bulk Actions', 'responsive-filterable-portfolio'); ?></option> |
  |  | 966 | <option value="delete"><?php echo \_\_('Delete', 'responsive-filterable-portfolio'); ?></option> |
  |  | 967 | </select> |
  |  | 968 | <input type="submit" value="<?php echo \_\_('Apply', 'responsive-filterable-portfolio'); ?>" class="button-secondary action" id="deleteselected" name="deleteselected" onclick="return confirmDelete\_bulk();"> |
  | 901 | 969 | </div> |
  | 902 |  |  |
  | 903 |  | </div> |
  | 904 |  | </div> |
  | 905 |  | </div> |
  | 906 |  | <div class="clear"></div> |
  | 907 |  | </div> |
  | 908 |  | </div> |
  | 909 |  | <?php |
  | 910 |  |  |
  | 911 |  | } |
  | 912 |  | function rfp\_responsive\_portfolio\_with\_lightbox\_media\_management\_func() { |
  | 913 |  | $action = 'gridview'; |
  | 914 |  | global $wpdb; |
  | 915 |  |  |
  | 916 |  |  |
  | 917 |  |  |
  | 918 |  | if (isset ( $\_GET ['action'] ) and $\_GET ['action'] != '') { |
  | 919 |  |  |
  | 920 |  | $action = trim ( $\_GET ['action'] ); |
  | 921 |  | } |
  | 922 |  | ?> |
  | 923 |  |  |
  | 924 |  | <?php |
  | 925 |  | if (strtolower ( $action ) == strtolower ( 'gridview' )) { |
  | 926 |  |  |
  | 927 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_view\_media' ) ) { |
  | 928 |  |  |
  | 929 |  | wp\_die( \_\_( "Access Denied", "responsive-filterable-portfolio" ) ); |
  | 930 |  |  |
  | 931 |  |  |
  | 932 |  | } |
  | 933 |  |  |
  | 934 |  | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
  | 935 |  | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
  | 936 |  |  |
  | 937 |  | $uploads = wp\_upload\_dir (); |
  | 938 |  | $baseurl = $uploads ['baseurl']; |
  | 939 |  | $baseurl .= '/wp-best-portfolio/'; |
  | 940 |  |  |
  | 941 |  | if(isset($\_GET['order\_by'])){ |
  | 942 |  |  |
  | 943 |  | $order\_by=trim($\_GET['order\_by']); |
  | 944 |  | } |
  | 945 |  |  |
  | 946 |  | if(isset($\_GET['order\_pos'])){ |
  | 947 |  |  |
  | 948 |  | $order\_pos=trim($\_GET['order\_pos']); |
  | 949 |  | } |
  | 950 |  |  |
  | 951 |  | $search\_term\_=''; |
  | 952 |  | if(isset($\_GET['search\_term'])){ |
  | 953 |  |  |
  | 954 |  | $search\_term\_='&search\_term='.urlencode($\_GET['search\_term']); |
  | 955 |  | } |
  | 956 |  | ?> |
  | 957 |  | <div id="poststuff" > |
  | 958 |  | <div id="post-body" class="metabox-holder columns-2" > |
  | 959 |  | <div id="post-body-content"> |
  | 960 |  | <div class="wrap"> |
  | 961 |  |  |
  | 962 |  | <table><tr> |
  | 963 |  | <td> |
  | 964 |  | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
  | 965 |  | <div id="fb-root"></div> |
  | 966 |  | <script>(function(d, s, id) { |
  | 967 |  | var js, fjs = d.getElementsByTagName(s)[0]; |
  | 968 |  | if (d.getElementById(id)) return; |
  | 969 |  | js = d.createElement(s); js.id = id; |
  | 970 |  | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
  | 971 |  | fjs.parentNode.insertBefore(js, fjs); |
  | 972 |  | }(document, 'script', 'facebook-jssdk'));</script> |
  | 973 |  | </td> |
  |  | 970 | <?php |
  |  | 971 | $sliderid = '0'; |
  |  | 972 | if (isset($\_GET['sliderid']) && $\_GET['sliderid'] != '') { |
  |  | 973 | $sliderid = (int) trim($\_GET['sliderid']); |
  |  | 974 | } |
  |  | 975 |  |
  |  | 976 | $setacrionpage = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management&sliderid=' . $sliderid; |
  |  | 977 |  |
  |  | 978 | if (isset($\_GET['order\_by']) && $\_GET['order\_by'] != '') { |
  |  | 979 | $setacrionpage .= '&order\_by=' . sanitize\_text\_field($\_GET['order\_by']); |
  |  | 980 | } |
  |  | 981 |  |
  |  | 982 | if (isset($\_GET['order\_pos']) && $\_GET['order\_pos'] != '') { |
  |  | 983 | $setacrionpage .= '&order\_pos=' . sanitize\_text\_field($\_GET['order\_pos']); |
  |  | 984 | } |
  |  | 985 |  |
  |  | 986 | $seval = ''; |
  |  | 987 | if (isset($\_GET['search\_term']) && $\_GET['search\_term'] != '') { |
  |  | 988 | $seval = sanitize\_text\_field($\_GET['search\_term']); |
  |  | 989 | } |
  |  | 990 | ?> |
  |  | 991 | <br class="clear"> |
  |  | 992 | <?php |
  |  | 993 | global $wpdb; |
  |  | 994 | $settings = get\_option('best\_portfolio\_grid\_settings'); |
  |  | 995 |  |
  |  | 996 | $order\_by = 'id'; |
  |  | 997 | $order\_pos = 'asc'; |
  |  | 998 |  |
  |  | 999 | if (isset($\_GET['order\_by'])) { |
  |  | 1000 |  |
  |  | 1001 | $order\_by = sanitize\_text\_field($\_GET['order\_by']); |
  |  | 1002 | } |
  |  | 1003 |  |
  |  | 1004 | if (isset($\_GET['order\_pos'])) { |
  |  | 1005 |  |
  |  | 1006 | $order\_pos = sanitize\_text\_field($\_GET['order\_pos']); |
  |  | 1007 | } |
  |  | 1008 | $search\_term = ''; |
  |  | 1009 | if (isset($\_GET['search\_term'])) { |
  |  | 1010 |  |
  |  | 1011 | $search\_term = sanitize\_text\_field(esc\_sql($\_GET['search\_term'])); |
  |  | 1012 | } |
  |  | 1013 |  |
  |  | 1014 | $query = 'SELECT \* FROM ' . $wpdb->prefix . 'e\_portfolio '; |
  |  | 1015 | $queryCount = 'SELECT count(\*) FROM ' . $wpdb->prefix . 'e\_portfolio '; |
  |  | 1016 | if ($search\_term != '') { |
  |  | 1017 | $query .= " where id like '%$search\_term%' or title like '%$search\_term%' "; |
  |  | 1018 | $queryCount .= " where id like '%$search\_term%' or title like '%$search\_term%' "; |
  |  | 1019 | } |
  |  | 1020 |  |
  |  | 1021 | $order\_by = sanitize\_text\_field(sanitize\_sql\_orderby($order\_by)); |
  |  | 1022 | $order\_pos = sanitize\_text\_field(sanitize\_sql\_orderby($order\_pos)); |
  |  | 1023 |  |
  |  | 1024 | $query .= " order by $order\_by $order\_pos"; |
  |  | 1025 |  |
  |  | 1026 | //$rows = $wpdb->get\_results ( $query ,'ARRAY\_A' ); |
  |  | 1027 | $rowsCount = $wpdb->get\_var($queryCount); |
  |  | 1028 | ?> |
  |  | 1029 | <div style="padding-top:5px;padding-bottom:5px"> |
  |  | 1030 | <b><?php echo \_\_('Search', 'best-testimonial-slider'); ?> : </b> |
  |  | 1031 | <input type="text" value="<?php echo esc\_html($seval); ?>" id="search\_term" name="search\_term">&nbsp; |
  |  | 1032 | <input type='button'  value='<?php echo \_\_('Search', 'best-testimonial-slider'); ?>' name='searchusrsubmit' class='button-primary' id='searchusrsubmit' onclick="SearchredirectTO();" >&nbsp; |
  |  | 1033 | <input type='button'  value='<?php echo \_\_('Reset Search', 'best-testimonial-slider'); ?>' name='searchreset' class='button-primary' id='searchreset' onclick="ResetSearch();" > |
  |  | 1034 | </div> |
  |  | 1035 | <script type="text/javascript" > |
  |  | 1036 | jQuery('#search\_term').on("keyup", function (e) { |
  |  | 1037 | if (e.which == 13) { |
  |  | 1038 |  |
  |  | 1039 | SearchredirectTO(); |
  |  | 1040 | } |
  |  | 1041 | }); |
  |  | 1042 | function SearchredirectTO() { |
  |  | 1043 | var redirectto = '<?php echo $setacrionpage; ?>'; |
  |  | 1044 | var searchval = jQuery('#search\_term').val(); |
  |  | 1045 | redirectto = redirectto + '&search\_term=' + jQuery.trim(encodeURIComponent(searchval)); |
  |  | 1046 | window.location.href = redirectto; |
  |  | 1047 | } |
  |  | 1048 | function ResetSearch() { |
  |  | 1049 |  |
  |  | 1050 | var redirectto = '<?php echo $setacrionpage; ?>'; |
  |  | 1051 | window.location.href = redirectto; |
  |  | 1052 | exit; |
  |  | 1053 | } |
  |  | 1054 | </script> |
  |  | 1055 | <?php $setacrionpage=esc\_html($setacrionpage);?> |
  |  | 1056 | <div id="no-more-tables"> |
  |  | 1057 | <table cellspacing="0" id="gridTbl" class="table-bordered table-striped table-condensed cf wp-list-table widefat"> |
  |  | 1058 |  |
  |  | 1059 | <thead> |
  |  | 1060 | <tr> |
  |  | 1061 | <th class="manage-column column-cb check-column" scope="col"><input type="checkbox"></th> |
  |  | 1062 | <?php if ($order\_by == 'id' && $order\_pos == 'asc') : ?> |
  |  | 1063 |  |
  |  | 1064 | <th><a href="<?php echo $setacrionpage; ?>&order\_by=id&order\_pos=desc<?php echo $search\_term\_; ?>"><?php echo \_\_('Id', 'best-testimonial-slider'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
  |  | 1065 | <?php else : ?> |
  |  | 1066 | <?php if ($order\_by == 'id') : ?> |
  |  | 1067 | <th><a href="<?php echo $setacrionpage; ?>&order\_by=id&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Id', 'best-testimonial-slider'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
  |  | 1068 | <?php else : ?> |
  |  | 1069 | <th><a href="<?php echo $setacrionpage; ?>&order\_by=id&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Id', 'best-testimonial-slider'); ?></a></th> |
  |  | 1070 | <?php endif; ?> |
  |  | 1071 | <?php endif; ?> |
  |  | 1072 | <?php if ($order\_by == 'media\_type' && $order\_pos == 'asc') : ?> |
  |  | 1073 |  |
  |  | 1074 | <th><a href="<?php echo $setacrionpage; ?>&order\_by=media\_type&order\_pos=desc<?php echo $search\_term\_; ?>"><?php echo \_\_('Media Type', 'best-testimonial-slider'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
  |  | 1075 | <?php else : ?> |
  |  | 1076 | <?php if ($order\_by == 'media\_type') : ?> |
  |  | 1077 | <th><a href="<?php echo $setacrionpage; ?>&order\_by=media\_type&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Media Type', 'best-testimonial-slider'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
  |  | 1078 | <?php else : ?> |
  |  | 1079 | <th><a href="<?php echo $setacrionpage; ?>&order\_by=media\_type&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Media Type', 'best-testimonial-slider'); ?></a></th> |
  |  | 1080 | <?php endif; ?> |
  |  | 1081 | <?php endif; ?> |
  |  | 1082 | <?php if ($order\_by == 'title' && $order\_pos == 'asc') : ?> |
  |  | 1083 |  |
  |  | 1084 | <th><a href="<?php echo $setacrionpage; ?>&order\_by=title&order\_pos=desc<?php echo $search\_term\_; ?>"><?php echo \_\_('Title', 'best-testimonial-slider'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
  |  | 1085 | <?php else : ?> |
  |  | 1086 | <?php if ($order\_by == 'title') : ?> |
  |  | 1087 | <th><a href="<?php echo $setacrionpage; ?>&order\_by=title&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Title', 'best-testimonial-slider'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
  |  | 1088 | <?php else : ?> |
  |  | 1089 | <th><a href="<?php echo $setacrionpage; ?>&order\_by=title&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Title', 'best-testimonial-slider'); ?></a></th> |
  |  | 1090 | <?php endif; ?> |
  |  | 1091 | <?php endif; ?> |
  |  | 1092 | <th><span></span></th> |
  |  | 1093 | <?php if ($order\_by == 'createdon' && $order\_pos == 'asc') : ?> |
  |  | 1094 |  |
  |  | 1095 | <th><a href="<?php echo $setacrionpage; ?>&order\_by=createdon&order\_pos=desc<?php echo $search\_term\_; ?>"><?php echo \_\_('Published On', 'best-testimonial-slider'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
  |  | 1096 | <?php else : ?> |
  |  | 1097 | <?php if ($order\_by == 'createdon') : ?> |
  |  | 1098 | <th><a href="<?php echo $setacrionpage; ?>&order\_by=createdon&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Published On', 'best-testimonial-slider'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
  |  | 1099 | <?php else : ?> |
  |  | 1100 | <th><a href="<?php echo $setacrionpage; ?>&order\_by=createdon&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Published On', 'best-testimonial-slider'); ?></a></th> |
  |  | 1101 | <?php endif; ?> |
  |  | 1102 | <?php endif; ?> |
  |  | 1103 | <th><span><?php echo \_\_('Edit', 'responsive-filterable-portfolio'); ?></span></th> |
  |  | 1104 | <th><span><?php echo \_\_('Delete', 'responsive-filterable-portfolio'); ?></span></th> |
  |  | 1105 | </tr> |
  |  | 1106 | </thead> |
  |  | 1107 |  |
  |  | 1108 | <tbody id="the-list"> |
  |  | 1109 | <?php |
  |  | 1110 | if ($rowsCount > 0) { |
  |  | 1111 |  |
  |  | 1112 | global $wp\_rewrite; |
  |  | 1113 | $rows\_per\_page = 15; |
  |  | 1114 |  |
  |  | 1115 | $current = ( isset($\_GET ['paged']) ) ? ( (int) htmlentities(sanitize\_text\_field($\_GET ['paged']), ENT\_QUOTES) ) : 1; |
  |  | 1116 | $pagination\_args = array( |
  |  | 1117 | 'base' => @add\_query\_arg('paged', '%#%'), |
  |  | 1118 | 'format' => '', |
  |  | 1119 | 'total' => ceil($rowsCount / $rows\_per\_page), |
  |  | 1120 | 'current' => $current, |
  |  | 1121 | 'show\_all' => false, |
  |  | 1122 | 'type' => 'plain' |
  |  | 1123 | ); |
  |  | 1124 |  |
  |  | 1125 | $offset = ( $current - 1 ) \* $rows\_per\_page; |
  |  | 1126 | $query .= " limit $offset, $rows\_per\_page"; |
  |  | 1127 | $rows = $wpdb->get\_results($query, ARRAY\_A); |
  |  | 1128 | $delRecNonce = wp\_create\_nonce('delete\_image'); |
  |  | 1129 | foreach ($rows as $row) { |
  |  | 1130 |  |
  |  | 1131 |  |
  |  | 1132 | $id = $row ['id']; |
  |  | 1133 | $editlink = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management&action=addedit&id=$id"; |
  |  | 1134 | $deletelink = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management&action=delete&id=$id&nonce=$delRecNonce"; |
  |  | 1135 |  |
  |  | 1136 | $outputimgmain = $baseurl . $row ['image\_name'] . '?rand=' . rand(0, 5000); |
  |  | 1137 | ?> |
  |  | 1138 | <tr valign="top"> |
  |  | 1139 | <td class="alignCenter check-column" data-title="Select Record"><input type="checkbox" value="<?php echo $row['id']; ?>" name="thumbnails[]"></td> |
  |  | 1140 | <td data-title="<?php echo \_\_('Id', 'responsive-filterable-portfolio'); ?>" class="alignCenter"><?php echo $row['id']; ?></td> |
  |  | 1141 | <td data-title="Video Type" class="alignCenter"> |
  |  | 1142 | <div> |
  |  | 1143 | <strong><?php echo $row['media\_type']; ?></strong> |
  |  | 1144 | </div> |
  |  | 1145 | </td> |
  |  | 1146 | <td data-title="<?php echo \_\_('Title', 'responsive-filterable-portfolio'); ?>" class="alignCenter"> |
  |  | 1147 | <div> |
  |  | 1148 | <strong><?php echo $row['title']; ?></strong> |
  |  | 1149 | </div> |
  |  | 1150 | </td> |
  |  | 1151 | <td class="alignCenter"><img src="<?php echo $outputimgmain; ?>" style="width: 100px" height="100px" /></td> |
  |  | 1152 |  |
  |  | 1153 | <td data-title="<?php echo \_\_('Published On', 'responsive-filterable-portfolio'); ?>" class="alignCenter"><?php echo $row['createdon']; ?></td> |
  |  | 1154 | <td data-title="<?php echo \_\_('Edit', 'responsive-filterable-portfolio'); ?>" class="alignCenter"> |
  |  | 1155 | <strong><a href='<?php echo $editlink; ?>' title="edit"><?php echo \_\_('Edit', 'responsive-filterable-portfolio'); ?></a></strong> |
  |  | 1156 | </td> |
  |  | 1157 | <td data-title="<?php echo \_\_('Delete', 'responsive-filterable-portfolio'); ?>" class="alignCenter"> |
  |  | 1158 | <strong> |
  |  | 1159 | <a href='<?php echo $deletelink; ?>' onclick="return confirmDelete();" title="delete"><?php echo \_\_('Delete', 'responsive-filterable-portfolio'); ?></a> |
  |  | 1160 | </strong> |
  |  | 1161 | </td> |
  |  | 1162 | </tr> |
  |  | 1163 | <?php |
  |  | 1164 | } |
  |  | 1165 | } else { |
  |  | 1166 | ?> |
  |  | 1167 | <tr valign="top" class="" id=""> |
  |  | 1168 | <td colspan="9" data-title="<?php echo \_\_('No Record', 'responsive-filterable-portfolio'); ?>" align="center"><strong><?php echo \_\_('No portfolio Found', 'responsive-filterable-portfolio'); ?></strong></td> |
  |  | 1169 | </tr> |
  |  | 1170 | <?php |
  |  | 1171 | } |
  |  | 1172 | ?> |
  |  | 1173 |  |
  |  | 1174 | </tbody> |
  |  | 1175 | </table> |
  |  | 1176 | </div> |
  |  | 1177 | <?php |
  |  | 1178 | if ($rowsCount > 0) { |
  |  | 1179 | echo "<div class='pagination' style='padding-top:10px'>"; |
  |  | 1180 | echo paginate\_links($pagination\_args); |
  |  | 1181 | echo '</div>'; |
  |  | 1182 | } |
  |  | 1183 | ?> |
  |  | 1184 | <br /> |
  |  | 1185 | <div class="alignleft actions"> |
  |  | 1186 | <select name="action" id="action\_bottom"> |
  |  | 1187 | <option selected="selected" value="-1"><?php echo \_\_('Bulk Actions', 'responsive-filterable-portfolio'); ?></option> |
  |  | 1188 | <option value="delete"><?php echo \_\_('Delete', 'responsive-filterable-portfolio'); ?></option> |
  |  | 1189 | </select> |
  |  | 1190 | <?php wp\_nonce\_field('action\_settings\_mass\_delete', 'mass\_delete\_nonce'); ?> |
  |  | 1191 | <input type="submit" value="<?php echo \_\_('Apply', 'responsive-filterable-portfolio'); ?>" class="button-secondary action" id="deleteselected" name="deleteselected" onclick="return confirmDelete\_bulk();"> |
  |  | 1192 | </div> |
  |  | 1193 |  |
  |  | 1194 | </form> |
  |  | 1195 | <script type="text/JavaScript"> |
  |  | 1196 |  |
  |  | 1197 | function  confirmDelete\_bulk(){ |
  |  | 1198 | var topval=document.getElementById("action\_bottom").value; |
  |  | 1199 | var bottomVal=document.getElementById("action\_upper").value; |
  |  | 1200 |  |
  |  | 1201 | if(topval=='delete' || bottomVal=='delete'){ |
  |  | 1202 |  |
  |  | 1203 |  |
  |  | 1204 | var agree=confirm("<?php echo \_\_('Are you sure you want to delete selected media ?', 'responsive-filterable-portfolio'); ?>"); |
  |  | 1205 | if (agree) |
  |  | 1206 | return true ; |
  |  | 1207 | else |
  |  | 1208 | return false; |
  |  | 1209 | } |
  |  | 1210 | } |
  |  | 1211 |  |
  |  | 1212 | function  confirmDelete(){ |
  |  | 1213 | var agree=confirm("<?php echo \_\_('Are you sure you want to delete this media ?', 'responsive-filterable-portfolio'); ?>"); |
  |  | 1214 | if (agree) |
  |  | 1215 | return true ; |
  |  | 1216 | else |
  |  | 1217 | return false; |
  |  | 1218 | } |
  |  | 1219 | </script> |
  |  | 1220 |  |
  |  | 1221 | <br class="clear"> |
  |  | 1222 | </div> |
  |  | 1223 | <div style="clear: both;"></div> |
  |  | 1224 | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
  |  | 1225 |  |
  |  | 1226 |  |
  |  | 1227 | </div> |
  |  | 1228 | <h3><?php echo \_\_('To print this video gallery into WordPress Post/Page use below code', 'responsive-filterable-portfolio'); ?></h3> |
  |  | 1229 | <input type="text" |
  |  | 1230 | value='[print\_responsive\_portfolio\_plus\_lightbox] ' |
  |  | 1231 | style="width: 400px; height: 30px" |
  |  | 1232 | onclick="this.focus(); |
  |  | 1233 | this.select()" /> |
  |  | 1234 | <div class="clear"></div> |
  |  | 1235 | <h3><?php echo \_\_('To print this video gallery into WordPress theme/template PHP files use below code', 'responsive-filterable-portfolio'); ?></h3> |
  |  | 1236 | <?php |
  |  | 1237 | $shortcode = '[print\_responsive\_portfolio\_plus\_lightbox]'; |
  |  | 1238 | ?> |
  |  | 1239 | <input type="text" |
  |  | 1240 | value="&lt;?php echo do\_shortcode('<?php echo htmlentities($shortcode, ENT\_QUOTES); ?>'); ?&gt;" |
  |  | 1241 | style="width: 400px; height: 30px" |
  |  | 1242 | onclick="this.focus(); |
  |  | 1243 | this.select()" /> |
  |  | 1244 | <div class="clear"></div> |
  |  | 1245 | </div> |
  |  | 1246 | </div> |
  |  | 1247 | <div id="postbox-container-1" class="postbox-container" > |
  |  | 1248 |  |
  |  | 1249 | <div class="postbox"> |
  |  | 1250 | <h3 class="hndle"><span></span><?php echo \_\_('Access All Themes In One Price', 'responsive-filterable-portfolio'); ?></h3> |
  |  | 1251 | <div class="inside"> |
  |  | 1252 | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"> |
  |  | 1253 | <img border="0" src="<?php echo plugins\_url('images/300x250.gif', \_\_FILE\_\_); ?>" width="250" height="250"> |
  |  | 1254 | </a></center> |
  |  | 1255 |  |
  |  | 1256 | <div style="margin:10px 5px"> |
  |  | 1257 |  |
  |  | 1258 | </div> |
  |  | 1259 | </div> |
  |  | 1260 |  |
  |  | 1261 | </div> |
  |  | 1262 | <div class="postbox"> |
  |  | 1263 | <h3 class="hndle"><span></span><?php echo \_\_('Google For Business Coupon', 'responsive-filterable-portfolio'); ?></h3> |
  |  | 1264 | <div class="inside"> |
  |  | 1265 | <center><a href="https://goo.gl/OJBuHT" target="\_blank"> |
  |  | 1266 | <img src="<?php echo plugins\_url('images/g-suite-promo-code-4.png', \_\_FILE\_\_); ?>" width="250" height="250" border="0"> |
  |  | 1267 | </a></center> |
  |  | 1268 | <div style="margin:10px 5px"> |
  |  | 1269 | </div> |
  |  | 1270 | </div> |
  |  | 1271 |  |
  |  | 1272 | </div> |
  |  | 1273 |  |
  |  | 1274 | </div> |
  |  | 1275 | </div> |
  |  | 1276 | </div> |
  |  | 1277 | <?php |
  |  | 1278 | } else if (strtolower($action) == strtolower('addedit')) { |
  |  | 1279 |  |
  |  | 1280 | $url = plugin\_dir\_url(\_\_FILE\_\_); |
  |  | 1281 |  |
  |  | 1282 | $vNonce = wp\_create\_nonce('vNonce'); |
  |  | 1283 |  |
  |  | 1284 | if (isset($\_POST ['btnsave'])) { |
  |  | 1285 |  |
  |  | 1286 | if (!check\_admin\_referer('action\_image\_add\_edit', 'add\_edit\_image\_nonce')) { |
  |  | 1287 |  |
  |  | 1288 | wp\_die('Security check fail'); |
  |  | 1289 | } |
  |  | 1290 | $uploads = wp\_upload\_dir(); |
  |  | 1291 | $baseDir = $uploads ['basedir']; |
  |  | 1292 | $baseDir = str\_replace('\\', '/', $baseDir); |
  |  | 1293 | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  |  | 1294 |  |
  |  | 1295 | if (isset($\_POST['media\_type']) && $\_POST['media\_type'] == 'video') { |
  |  | 1296 |  |
  |  | 1297 | $media\_type = trim($\_POST['media\_type']); |
  |  | 1298 | $vtype = trim(htmlentities(sanitize\_text\_field($\_POST ['vtype']), ENT\_QUOTES)); |
  |  | 1299 | $videourl = trim(htmlentities(esc\_url\_raw($\_POST ['videourl']), ENT\_QUOTES)); |
  |  | 1300 | // echo $videourl;die; |
  |  | 1301 | $vid = uniqid('vid\_'); |
  |  | 1302 | $embed\_url = ''; |
  |  | 1303 | if ($vtype == 'youtube') { |
  |  | 1304 | // parse |
  |  | 1305 |  |
  |  | 1306 | $parseUrl = @parse\_url($videourl); |
  |  | 1307 | if (is\_array($parseUrl)) { |
  |  | 1308 |  |
  |  | 1309 | $queryStr = $parseUrl ['query']; |
  |  | 1310 | parse\_str($queryStr, $array); |
  |  | 1311 | if (is\_array($array) && isset($array ['v'])) { |
  |  | 1312 |  |
  |  | 1313 | $vid = $array ['v']; |
  |  | 1314 | } |
  |  | 1315 | } |
  |  | 1316 |  |
  |  | 1317 | $embed\_url = "//www.youtube.com/embed/$vid"; |
  |  | 1318 | } else if ($vtype == 'metacafe') { |
  |  | 1319 |  |
  |  | 1320 | $end = end(explode('/', rtrim($videourl, '/'))); |
  |  | 1321 |  |
  |  | 1322 | $vid = 0; |
  |  | 1323 | if ($end) { |
  |  | 1324 |  |
  |  | 1325 | $vid = $end; |
  |  | 1326 | } |
  |  | 1327 |  |
  |  | 1328 |  |
  |  | 1329 | $embed\_url = $videourl; |
  |  | 1330 | $embed\_url = str\_replace('/watch/', '/embed/', $embed\_url); |
  |  | 1331 | } |
  |  | 1332 |  |
  |  | 1333 |  |
  |  | 1334 |  |
  |  | 1335 | $HdnMediaSelection = trim(htmlentities(esc\_url\_raw($\_POST ['HdnMediaSelection']), ENT\_QUOTES)); |
  |  | 1336 | $videotitle = trim(htmlentities(sanitize\_text\_field($\_POST ['title']), ENT\_QUOTES)); |
  |  | 1337 | $videotitleurl = trim(htmlentities(esc\_url\_raw($\_POST ['murl']), ENT\_QUOTES)); |
  |  | 1338 | $mtag = trim(htmlentities(sanitize\_text\_field($\_POST ['mtag']), ENT\_QUOTES)); |
  |  | 1339 |  |
  |  | 1340 | $videotitle = str\_replace("'", '’', $videotitle); |
  |  | 1341 | $videotitle = str\_replace('"', '&quot;', $videotitle); |
  |  | 1342 |  |
  |  | 1343 | $mtag = str\_replace("'", '’', $mtag); |
  |  | 1344 | $mtag = str\_replace('"', '&quot;', $mtag); |
  |  | 1345 |  |
  |  | 1346 | if (isset($\_POST ['open\_link\_in'])) { |
  |  | 1347 | $open\_link\_in = 1; |
  |  | 1348 | } else { |
  |  | 1349 | $open\_link\_in = 0; |
  |  | 1350 | } |
  |  | 1351 |  |
  |  | 1352 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 1353 | // edit save |
  |  | 1354 | if (isset($\_POST ['videoid'])) { |
  |  | 1355 |  |
  |  | 1356 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_edit\_media')) { |
  |  | 1357 |  |
  |  | 1358 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 1359 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1360 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1361 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator', 'responsive-filterable-portfolio'); |
  |  | 1362 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1363 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1364 | exit(); |
  |  | 1365 | } |
  |  | 1366 |  |
  |  | 1367 | try { |
  |  | 1368 |  |
  |  | 1369 | $videoidEdit = intval(htmlentities(sanitize\_text\_field($\_POST ['videoid']), ENT\_QUOTES)); |
  |  | 1370 | if (trim($\_POST ['HdnMediaSelection']) != '') { |
  |  | 1371 |  |
  |  | 1372 | $pInfo = pathinfo($HdnMediaSelection); |
  |  | 1373 | $ext = $pInfo ['extension']; |
  |  | 1374 | $imagename = $vid . '\_big.' . $ext; |
  |  | 1375 | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  |  | 1376 |  |
  |  | 1377 | @copy($HdnMediaSelection, $imageUploadTo); |
  |  | 1378 | if (!file\_exists($imageUploadTo)) { |
  |  | 1379 | rfp\_save\_image($HdnMediaSelection, $imageUploadTo); |
  |  | 1380 | } |
  |  | 1381 |  |
  |  | 1382 | $settings = get\_option('best\_portfolio\_grid\_settings'); |
  |  | 1383 | $imageheight = $settings ['imageheight']; |
  |  | 1384 | $imagewidth = $settings ['imagewidth']; |
  |  | 1385 | @unlink($pathToImagesFolder . '/' . $vid . '\_big\_' . $imageheight . '\_' . $imagewidth . '.' . $ext); |
  |  | 1386 | } |
  |  | 1387 |  |
  |  | 1388 | $query = 'update ' . $wpdb->prefix . "e\_portfolio |
  |  | 1389 | set media\_type='$media\_type', vtype='$vtype',vid='$vid',murl='$videourl',embed\_url='$embed\_url',image\_name='$imagename',HdnMediaSelection='$HdnMediaSelection', |
  |  | 1390 | title='$videotitle',videourl='$videotitleurl',mtag='$mtag', |
  |  | 1391 | open\_link\_in=$open\_link\_in  where id=$videoidEdit"; |
  |  | 1392 |  |
  |  | 1393 | //echo $query;die; |
  |  | 1394 | $wpdb->query($query); |
  |  | 1395 |  |
  |  | 1396 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1397 | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  |  | 1398 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Video updated successfully.', 'responsive-filterable-portfolio'); |
  |  | 1399 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1400 | } catch (Exception $e) { |
  |  | 1401 |  |
  |  | 1402 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1403 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1404 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while adding video', 'responsive-filterable-portfolio'); |
  |  | 1405 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1406 | } |
  |  | 1407 |  |
  |  | 1408 |  |
  |  | 1409 |  |
  |  | 1410 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1411 | exit(); |
  |  | 1412 | } else { |
  |  | 1413 |  |
  |  | 1414 |  |
  |  | 1415 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_add\_media')) { |
  |  | 1416 |  |
  |  | 1417 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 1418 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1419 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1420 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator', 'responsive-filterable-portfolio'); |
  |  | 1421 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1422 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1423 | exit(); |
  |  | 1424 | } |
  |  | 1425 |  |
  |  | 1426 | $createdOn = date('Y-m-d h:i:s'); |
  |  | 1427 | if (function\_exists('date\_i18n')) { |
  |  | 1428 |  |
  |  | 1429 | $createdOn = date\_i18n('Y-m-d' . ' ' . get\_option('time\_format'), false, false); |
  |  | 1430 | if (get\_option('time\_format') == 'H:i') { |
  |  | 1431 | $createdOn = date('Y-m-d H:i:s', strtotime($createdOn)); |
  |  | 1432 | } else { |
  |  | 1433 | $createdOn = date('Y-m-d h:i:s', strtotime($createdOn)); |
  |  | 1434 | } |
  |  | 1435 | } |
  |  | 1436 |  |
  |  | 1437 | try { |
  |  | 1438 |  |
  |  | 1439 | if (trim($\_POST ['HdnMediaSelection']) != '') { |
  |  | 1440 | $pInfo = pathinfo($HdnMediaSelection); |
  |  | 1441 | $ext = $pInfo ['extension']; |
  |  | 1442 | $imagename = $vid . '\_big.' . $ext; |
  |  | 1443 | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  |  | 1444 | @copy($HdnMediaSelection, $imageUploadTo); |
  |  | 1445 | if (!file\_exists($imageUploadTo)) { |
  |  | 1446 | rfp\_save\_image($HdnMediaSelection, $imageUploadTo); |
  |  | 1447 | } |
  |  | 1448 | } |
  |  | 1449 |  |
  |  | 1450 | $query = 'INSERT INTO ' . $wpdb->prefix . "e\_portfolio |
  |  | 1451 | (media\_type,image\_name,title,murl,mtag,open\_link\_in, |
  |  | 1452 | vtype,vid,videourl,embed\_url,HdnMediaSelection,createdon) |
  |  | 1453 | VALUES ('$media\_type','$imagename','$videotitle','$videourl','$mtag', |
  |  | 1454 | $open\_link\_in,'$vtype','$vid','$videourl','$embed\_url','$HdnMediaSelection', '$createdOn')"; |
  |  | 1455 |  |
  |  | 1456 | $wpdb->query($query); |
  |  | 1457 |  |
  |  | 1458 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1459 | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  |  | 1460 | $wp\_best\_portfolio\_msg ['message'] = \_\_('New video added successfully.', 'responsive-filterable-portfolio'); |
  |  | 1461 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1462 | } catch (Exception $e) { |
  |  | 1463 |  |
  |  | 1464 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1465 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1466 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while adding video', 'responsive-filterable-portfolio'); |
  |  | 1467 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1468 | } |
  |  | 1469 |  |
  |  | 1470 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1471 | exit(); |
  |  | 1472 | } |
  |  | 1473 | } else if (isset($\_POST['media\_type']) && $\_POST['media\_type'] == 'image') { |
  |  | 1474 |  |
  |  | 1475 | $vid = uniqid('vid\_'); |
  |  | 1476 | $media\_type = trim(htmlentities(sanitize\_text\_field($\_POST['media\_type']), ENT\_QUOTES)); |
  |  | 1477 | $HdnMediaSelection = trim(htmlentities(sanitize\_text\_field($\_POST ['HdnMediaSelection\_image']), ENT\_QUOTES)); |
  |  | 1478 | $mtitle = trim(htmlentities(sanitize\_text\_field($\_POST ['title']), ENT\_QUOTES)); |
  |  | 1479 | $murl = trim(htmlentities(esc\_url\_raw($\_POST ['murl']), ENT\_QUOTES)); |
  |  | 1480 | $mtag = trim(htmlentities(sanitize\_text\_field($\_POST ['mtag']), ENT\_QUOTES)); |
  |  | 1481 |  |
  |  | 1482 | $mtitle = str\_replace("'", '’', $mtitle); |
  |  | 1483 | $mtitle = str\_replace('"', '&quot;', $mtitle); |
  |  | 1484 |  |
  |  | 1485 | $mtag = str\_replace("'", '’', $mtag); |
  |  | 1486 | $mtag = str\_replace('"', '&quot;', $mtag); |
  |  | 1487 |  |
  |  | 1488 | if (isset($\_POST ['open\_link\_in'])) { |
  |  | 1489 | $open\_link\_in = 1; |
  |  | 1490 | } else { |
  |  | 1491 | $open\_link\_in = 0; |
  |  | 1492 | } |
  |  | 1493 |  |
  |  | 1494 |  |
  |  | 1495 |  |
  |  | 1496 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 1497 | // edit save |
  |  | 1498 | if (isset($\_POST ['imageid'])) { |
  |  | 1499 |  |
  |  | 1500 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_edit\_media')) { |
  |  | 1501 |  |
  |  | 1502 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 1503 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1504 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1505 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator', 'responsive-filterable-portfolio'); |
  |  | 1506 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1507 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1508 | exit(); |
  |  | 1509 | } |
  |  | 1510 |  |
  |  | 1511 | try { |
  |  | 1512 |  |
  |  | 1513 | $videoidEdit = intval(htmlentities(sanitize\_text\_field($\_POST ['imageid']), ENT\_QUOTES)); |
  |  | 1514 | if (trim($\_POST ['HdnMediaSelection\_image']) != '') { |
  |  | 1515 |  |
  |  | 1516 | $pInfo = pathinfo($HdnMediaSelection); |
  |  | 1517 | $ext = $pInfo ['extension']; |
  |  | 1518 | $imagename = $vid . '\_big.' . $ext; |
  |  | 1519 | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  |  | 1520 |  |
  |  | 1521 | @copy($HdnMediaSelection, $imageUploadTo); |
  |  | 1522 | if (!file\_exists($imageUploadTo)) { |
  |  | 1523 | rfp\_save\_image($HdnMediaSelection, $imageUploadTo); |
  |  | 1524 | } |
  |  | 1525 |  |
  |  | 1526 | $settings = get\_option('best\_portfolio\_grid\_settings'); |
  |  | 1527 | $imageheight = $settings ['imageheight']; |
  |  | 1528 | $imagewidth = $settings ['imagewidth']; |
  |  | 1529 | @unlink($pathToImagesFolder . '/' . $vid . '\_big\_' . $imageheight . '\_' . $imagewidth . '.' . $ext); |
  |  | 1530 | } |
  |  | 1531 |  |
  |  | 1532 | $query = 'update ' . $wpdb->prefix . "e\_portfolio |
  |  | 1533 | set media\_type='$media\_type', murl='$murl',image\_name='$imagename',HdnMediaSelection='$HdnMediaSelection', |
  |  | 1534 | title='$mtitle',mtag='$mtag', |
  |  | 1535 | open\_link\_in=$open\_link\_in  where id=$videoidEdit"; |
  |  | 1536 |  |
  |  | 1537 | //echo $query;die; |
  |  | 1538 | $wpdb->query($query); |
  |  | 1539 |  |
  |  | 1540 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1541 | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  |  | 1542 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Image updated successfully.', 'responsive-filterable-portfolio'); |
  |  | 1543 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1544 | } catch (Exception $e) { |
  |  | 1545 |  |
  |  | 1546 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1547 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1548 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while adding image', 'responsive-filterable-portfolio'); |
  |  | 1549 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1550 | } |
  |  | 1551 |  |
  |  | 1552 |  |
  |  | 1553 |  |
  |  | 1554 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1555 | exit(); |
  |  | 1556 | } else { |
  |  | 1557 |  |
  |  | 1558 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_add\_media')) { |
  |  | 1559 |  |
  |  | 1560 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 1561 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1562 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1563 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator', 'responsive-filterable-portfolio'); |
  |  | 1564 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1565 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1566 | exit(); |
  |  | 1567 | } |
  |  | 1568 | $createdOn = date('Y-m-d h:i:s'); |
  |  | 1569 | if (function\_exists('date\_i18n')) { |
  |  | 1570 |  |
  |  | 1571 | $createdOn = date\_i18n('Y-m-d' . ' ' . get\_option('time\_format'), false, false); |
  |  | 1572 | if (get\_option('time\_format') == 'H:i') { |
  |  | 1573 | $createdOn = date('Y-m-d H:i:s', strtotime($createdOn)); |
  |  | 1574 | } else { |
  |  | 1575 | $createdOn = date('Y-m-d h:i:s', strtotime($createdOn)); |
  |  | 1576 | } |
  |  | 1577 | } |
  |  | 1578 |  |
  |  | 1579 | try { |
  |  | 1580 |  |
  |  | 1581 | if (trim($\_POST ['HdnMediaSelection\_image']) != '') { |
  |  | 1582 | $pInfo = pathinfo($HdnMediaSelection); |
  |  | 1583 | $ext = $pInfo ['extension']; |
  |  | 1584 | $imagename = $vid . '\_big.' . $ext; |
  |  | 1585 | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  |  | 1586 | @copy($HdnMediaSelection, $imageUploadTo); |
  |  | 1587 | if (!file\_exists($imageUploadTo)) { |
  |  | 1588 | rfp\_save\_image($HdnMediaSelection, $imageUploadTo); |
  |  | 1589 | } |
  |  | 1590 | } |
  |  | 1591 |  |
  |  | 1592 | $query = 'INSERT INTO ' . $wpdb->prefix . "e\_portfolio |
  |  | 1593 | (media\_type,image\_name,title,murl,mtag,open\_link\_in, |
  |  | 1594 | HdnMediaSelection,createdon) |
  |  | 1595 | VALUES ('$media\_type','$imagename','$mtitle','$murl','$mtag', |
  |  | 1596 | $open\_link\_in,'$HdnMediaSelection', '$createdOn')"; |
  |  | 1597 |  |
  |  | 1598 | $wpdb->query($query); |
  |  | 1599 |  |
  |  | 1600 | //echo $wpdb->last\_error;die; |
  |  | 1601 |  |
  |  | 1602 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1603 | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  |  | 1604 | $wp\_best\_portfolio\_msg ['message'] = \_\_('New image added successfully.', 'responsive-filterable-portfolio'); |
  |  | 1605 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1606 | } catch (Exception $e) { |
  |  | 1607 |  |
  |  | 1608 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1609 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1610 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while adding image', 'responsive-filterable-portfolio'); |
  |  | 1611 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1612 | } |
  |  | 1613 |  |
  |  | 1614 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1615 | exit(); |
  |  | 1616 | } |
  |  | 1617 | } else if (isset($\_POST['media\_type']) && $\_POST['media\_type'] == 'link') { |
  |  | 1618 |  |
  |  | 1619 | $vid = uniqid('vid\_'); |
  |  | 1620 | $media\_type = trim(htmlentities(sanitize\_text\_field($\_POST['media\_type']), ENT\_QUOTES)); |
  |  | 1621 | $HdnMediaSelection = trim(htmlentities(esc\_url\_raw($\_POST ['HdnMediaSelection\_link']), ENT\_QUOTES)); |
  |  | 1622 | $mtitle = trim(htmlentities(sanitize\_text\_field($\_POST ['title']), ENT\_QUOTES)); |
  |  | 1623 |  |
  |  | 1624 | $mtag = trim(htmlentities(sanitize\_text\_field($\_POST ['mtag']), ENT\_QUOTES)); |
  |  | 1625 | $murl = trim(htmlentities(esc\_url\_raw($\_POST ['murl']), ENT\_QUOTES)); |
  |  | 1626 |  |
  |  | 1627 | $mtitle = str\_replace("'", '’', $mtitle); |
  |  | 1628 | $mtitle = str\_replace('"', '&quot;', $mtitle); |
  |  | 1629 |  |
  |  | 1630 | $mtag = str\_replace("'", '’', $mtag); |
  |  | 1631 | $mtag = str\_replace('"', '&quot;', $mtag); |
  |  | 1632 |  |
  |  | 1633 | if (isset($\_POST ['open\_link\_in'])) { |
  |  | 1634 | $open\_link\_in = 1; |
  |  | 1635 | } else { |
  |  | 1636 | $open\_link\_in = 0; |
  |  | 1637 | } |
  |  | 1638 |  |
  |  | 1639 |  |
  |  | 1640 |  |
  |  | 1641 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 1642 | // edit save |
  |  | 1643 | if (isset($\_POST ['linkid'])) { |
  |  | 1644 |  |
  |  | 1645 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_edit\_media')) { |
  |  | 1646 |  |
  |  | 1647 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 1648 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1649 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1650 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator', 'responsive-filterable-portfolio'); |
  |  | 1651 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1652 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1653 | exit(); |
  |  | 1654 | } |
  |  | 1655 |  |
  |  | 1656 | try { |
  |  | 1657 |  |
  |  | 1658 | $videoidEdit = htmlentities(sanitize\_text\_field($\_POST ['linkid']), ENT\_QUOTES); |
  |  | 1659 | if (trim($\_POST ['HdnMediaSelection\_link']) != '') { |
  |  | 1660 |  |
  |  | 1661 | $pInfo = pathinfo($HdnMediaSelection); |
  |  | 1662 | $ext = $pInfo ['extension']; |
  |  | 1663 | $imagename = $vid . '\_big.' . $ext; |
  |  | 1664 | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  |  | 1665 |  |
  |  | 1666 | @copy($HdnMediaSelection, $imageUploadTo); |
  |  | 1667 | if (!file\_exists($imageUploadTo)) { |
  |  | 1668 | rfp\_save\_image($HdnMediaSelection, $imageUploadTo); |
  |  | 1669 | } |
  |  | 1670 |  |
  |  | 1671 |  |
  |  | 1672 | $settings = get\_option('best\_portfolio\_grid\_settings'); |
  |  | 1673 | $imageheight = $settings ['imageheight']; |
  |  | 1674 | $imagewidth = $settings ['imagewidth']; |
  |  | 1675 | @unlink($pathToImagesFolder . '/' . $vid . '\_big\_' . $imageheight . '\_' . $imagewidth . '.' . $ext); |
  |  | 1676 | } |
  |  | 1677 |  |
  |  | 1678 | $query = 'update ' . $wpdb->prefix . "e\_portfolio |
  |  | 1679 | set media\_type='$media\_type', murl='$murl',image\_name='$imagename',HdnMediaSelection='$HdnMediaSelection', |
  |  | 1680 | title='$mtitle',mtag='$mtag', |
  |  | 1681 | open\_link\_in=$open\_link\_in  where id=$videoidEdit"; |
  |  | 1682 |  |
  |  | 1683 | //echo $query;die; |
  |  | 1684 | $wpdb->query($query); |
  |  | 1685 |  |
  |  | 1686 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1687 | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  |  | 1688 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Link updated successfully.', 'responsive-filterable-portfolio'); |
  |  | 1689 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1690 | } catch (Exception $e) { |
  |  | 1691 |  |
  |  | 1692 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1693 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1694 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while adding link', 'responsive-filterable-portfolio'); |
  |  | 1695 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1696 | } |
  |  | 1697 |  |
  |  | 1698 |  |
  |  | 1699 |  |
  |  | 1700 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1701 | exit(); |
  |  | 1702 | } else { |
  |  | 1703 |  |
  |  | 1704 |  |
  |  | 1705 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_add\_media')) { |
  |  | 1706 |  |
  |  | 1707 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 1708 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1709 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1710 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator', 'responsive-filterable-portfolio'); |
  |  | 1711 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1712 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1713 | exit(); |
  |  | 1714 | } |
  |  | 1715 |  |
  |  | 1716 | $createdOn = date('Y-m-d h:i:s'); |
  |  | 1717 | if (function\_exists('date\_i18n')) { |
  |  | 1718 |  |
  |  | 1719 | $createdOn = date\_i18n('Y-m-d' . ' ' . get\_option('time\_format'), false, false); |
  |  | 1720 | if (get\_option('time\_format') == 'H:i') { |
  |  | 1721 | $createdOn = date('Y-m-d H:i:s', strtotime($createdOn)); |
  |  | 1722 | } else { |
  |  | 1723 | $createdOn = date('Y-m-d h:i:s', strtotime($createdOn)); |
  |  | 1724 | } |
  |  | 1725 | } |
  |  | 1726 |  |
  |  | 1727 | try { |
  |  | 1728 |  |
  |  | 1729 | if (trim($\_POST ['HdnMediaSelection\_link']) != '') { |
  |  | 1730 | $pInfo = pathinfo($HdnMediaSelection); |
  |  | 1731 | $ext = $pInfo ['extension']; |
  |  | 1732 | $imagename = $vid . '\_big.' . $ext; |
  |  | 1733 | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  |  | 1734 | @copy($HdnMediaSelection, $imageUploadTo); |
  |  | 1735 | if (!file\_exists($imageUploadTo)) { |
  |  | 1736 | rfp\_save\_image($HdnMediaSelection, $imageUploadTo); |
  |  | 1737 | } |
  |  | 1738 | } |
  |  | 1739 |  |
  |  | 1740 | $query = 'INSERT INTO ' . $wpdb->prefix . "e\_portfolio |
  |  | 1741 | (media\_type,image\_name,title,murl,mtag,open\_link\_in, |
  |  | 1742 | HdnMediaSelection,createdon) |
  |  | 1743 | VALUES ('$media\_type','$imagename','$mtitle','$murl','$mtag', |
  |  | 1744 | $open\_link\_in,'$HdnMediaSelection', '$createdOn')"; |
  |  | 1745 |  |
  |  | 1746 | $wpdb->query($query); |
  |  | 1747 |  |
  |  | 1748 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1749 | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  |  | 1750 | $wp\_best\_portfolio\_msg ['message'] = \_\_('New link added successfully.', 'responsive-filterable-portfolio'); |
  |  | 1751 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1752 | } catch (Exception $e) { |
  |  | 1753 |  |
  |  | 1754 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1755 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1756 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while adding link', 'responsive-filterable-portfolio'); |
  |  | 1757 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1758 | } |
  |  | 1759 |  |
  |  | 1760 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1761 | exit(); |
  |  | 1762 | } |
  |  | 1763 | } |
  |  | 1764 | } else { |
  |  | 1765 |  |
  |  | 1766 | $uploads = wp\_upload\_dir(); |
  |  | 1767 | $baseurl = $uploads ['baseurl']; |
  |  | 1768 | $baseurl .= '/wp-best-portfolio/'; |
  |  | 1769 | ?> |
  |  | 1770 | <div id="poststuff" > |
  |  | 1771 | <div id="post-body" class="metabox-holder columns-2" > |
  |  | 1772 | <div id="post-body-content"> |
  |  | 1773 | <table><tr> |
  |  | 1774 | <td> |
  |  | 1775 | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
  |  | 1776 | <div id="fb-root"></div> |
  |  | 1777 | <script>(function (d, s, id) { |
  |  | 1778 | var js, fjs = d.getElementsByTagName(s)[0]; |
  |  | 1779 | if (d.getElementById(id)) |
  |  | 1780 | return; |
  |  | 1781 | js = d.createElement(s); |
  |  | 1782 | js.id = id; |
  |  | 1783 | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
  |  | 1784 | fjs.parentNode.insertBefore(js, fjs); |
  |  | 1785 | }(document, 'script', 'facebook-jssdk'));</script> |
  |  | 1786 | </td> |
  | 974 | 1787 | <td> |
  | 975 | 1788 | <a target="\_blank" title="Donate" href="http://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
  | 976 |  | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url(~~'images/paypaldonate.jpg', \_\_FILE\_\_ ) ;~~?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
  |  | 1789 | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url('images/paypaldonate.jpg', \_\_FILE\_\_); ?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
  | 977 | 1790 | </a> |
  | 978 | 1791 | </td> |
  | 979 | 1792 | </tr> |
  | 980 | 1793 | </table> |
  | 981 |  | <span><h3 style="color: blue;"><a target="\_blank" href="http://www.i13websolution.com/wordpress-responsive-media-portfolio-grid.html"><?php echo \_\_('UPGRADE TO PRO VERSION','responsive-filterable-portfolio');?></a></h3></span> |
  | 982 |  | <?php |
  | 983 |  | $messages = get\_option ( 'wp\_best\_portfolio\_msg' ); |
  | 984 |  | $type = ''; |
  | 985 |  | $message = ''; |
  | 986 |  | if (isset ( $messages ['type'] ) and $messages ['type'] != "") { |
  | 987 |  |  |
  | 988 |  | $type = $messages ['type']; |
  | 989 |  | $message = $messages ['message']; |
  | 990 |  | } |
  | 991 |  |  |
  | 992 |  | if(trim($type)=='err'){ echo "<div class='notice notice-error is-dismissible'><p>"; echo $message; echo "</p></div>";} |
  | 993 |  | else if(trim($type)=='succ'){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $message; echo "</p></div>";} |
  | 994 |  |  |
  | 995 |  |  |
  | 996 |  | update\_option ( 'wp\_best\_portfolio\_msg', array () ); |
  | 997 |  | ?> |
  | 998 |  |  |
  | 999 |  | <div style="width: 100%;"> |
  | 1000 |  | <div style="float: left; width: 100%;"> |
  | 1001 |  | <div class="icon32 icon32-posts-post" id="icon-edit"> |
  | 1002 |  | <br> |
  | 1003 |  | </div> |
  | 1004 |  | <h2> |
  | 1005 |  | <?php echo \_\_('Media','responsive-filterable-portfolio');?><a class="button add-new-h2" href="admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management&action=addedit"><?php echo \_\_('Add New','responsive-filterable-portfolio');?></a> |
  | 1006 |  | </h2> |
  | 1007 |  | <br /> |
  | 1008 |  |  |
  | 1009 |  | <form method="POST" action="admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management&action=deleteselected" id="posts-filter" onkeypress="return event.keyCode != 13;"> |
  | 1010 |  | <div class="alignleft actions"> |
  | 1011 |  | <select name="action\_upper" id="action\_upper"> |
  | 1012 |  | <option selected="selected" value="-1"><?php echo \_\_('Bulk Actions','responsive-filterable-portfolio');?></option> |
  | 1013 |  | <option value="delete"><?php echo \_\_('Delete','responsive-filterable-portfolio');?></option> |
  | 1014 |  | </select> |
  | 1015 |  | <input type="submit" value="<?php echo \_\_('Apply','responsive-filterable-portfolio');?>" class="button-secondary action" id="deleteselected" name="deleteselected" onclick="return confirmDelete\_bulk();"> |
  | 1016 |  | </div> |
  | 1017 |  | <?php |
  | 1018 |  |  |
  | 1019 |  | $sliderid="0"; |
  | 1020 |  | if(isset($\_GET['sliderid']) and $\_GET['sliderid']!=""){ |
  | 1021 |  | $sliderid=(int)trim($\_GET['sliderid']); |
  | 1022 |  | } |
  | 1023 |  |  |
  | 1024 |  | $setacrionpage='admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management&sliderid='.$sliderid; |
  | 1025 |  |  |
  | 1026 |  | if(isset($\_GET['order\_by']) and $\_GET['order\_by']!=""){ |
  | 1027 |  | $setacrionpage.='&order\_by='.$\_GET['order\_by']; |
  | 1028 |  | } |
  | 1029 |  |  |
  | 1030 |  | if(isset($\_GET['order\_pos']) and $\_GET['order\_pos']!=""){ |
  | 1031 |  | $setacrionpage.='&order\_pos='.$\_GET['order\_pos']; |
  | 1032 |  | } |
  | 1033 |  |  |
  | 1034 |  | $seval=""; |
  | 1035 |  | if(isset($\_GET['search\_term']) and $\_GET['search\_term']!=""){ |
  | 1036 |  | $seval=trim($\_GET['search\_term']); |
  | 1037 |  | } |
  | 1038 |  |  |
  | 1039 |  | ?> |
  | 1040 |  | <br class="clear"> |
  | 1041 |  | <?php |
  | 1042 |  | global $wpdb; |
  | 1043 |  | $settings = get\_option('best\_portfolio\_grid\_settings'); |
  | 1044 |  |  |
  | 1045 |  |  |
  | 1046 |  | $order\_by='id'; |
  | 1047 |  | $order\_pos="asc"; |
  | 1048 |  |  |
  | 1049 |  | if(isset($\_GET['order\_by'])){ |
  | 1050 |  |  |
  | 1051 |  | $order\_by=trim($\_GET['order\_by']); |
  | 1052 |  | } |
  | 1053 |  |  |
  | 1054 |  | if(isset($\_GET['order\_pos'])){ |
  | 1055 |  |  |
  | 1056 |  | $order\_pos=trim($\_GET['order\_pos']); |
  | 1057 |  | } |
  | 1058 |  | $search\_term=''; |
  | 1059 |  | if(isset($\_GET['search\_term'])){ |
  | 1060 |  |  |
  | 1061 |  | $search\_term= sanitize\_text\_field(esc\_sql($\_GET['search\_term'])); |
  | 1062 |  | } |
  | 1063 |  |  |
  | 1064 |  | $query = "SELECT \* FROM " . $wpdb->prefix . "e\_portfolio "; |
  | 1065 |  | $queryCount = "SELECT count(\*) FROM " . $wpdb->prefix . "e\_portfolio "; |
  | 1066 |  | if($search\_term!=''){ |
  | 1067 |  | $query.=" where id like '%$search\_term%' or title like '%$search\_term%' "; |
  | 1068 |  | $queryCount.=" where id like '%$search\_term%' or title like '%$search\_term%' "; |
  | 1069 |  | } |
  | 1070 |  |  |
  | 1071 |  | $order\_by=sanitize\_text\_field(sanitize\_sql\_orderby($order\_by)); |
  | 1072 |  | $order\_pos=sanitize\_text\_field(sanitize\_sql\_orderby($order\_pos)); |
  | 1073 |  |  |
  | 1074 |  | $query.=" order by $order\_by $order\_pos"; |
  | 1075 |  |  |
  | 1076 |  |  |
  | 1077 |  | //$rows = $wpdb->get\_results ( $query ,'ARRAY\_A' ); |
  | 1078 |  | $rowsCount=$wpdb->get\_var($queryCount); |
  | 1079 |  |  |
  | 1080 |  | ?> |
  | 1081 |  | <div style="padding-top:5px;padding-bottom:5px"> |
  | 1082 |  | <b><?php echo \_\_( 'Search','best-testimonial-slider');?> : </b> |
  | 1083 |  | <input type="text" value="<?php echo $seval;?>" id="search\_term" name="search\_term">&nbsp; |
  | 1084 |  | <input type='button'  value='<?php echo \_\_( 'Search','best-testimonial-slider');?>' name='searchusrsubmit' class='button-primary' id='searchusrsubmit' onclick="SearchredirectTO();" >&nbsp; |
  | 1085 |  | <input type='button'  value='<?php echo \_\_( 'Reset Search','best-testimonial-slider');?>' name='searchreset' class='button-primary' id='searchreset' onclick="ResetSearch();" > |
  | 1086 |  | </div> |
  | 1087 |  | <script type="text/javascript" > |
  | 1088 |  | jQuery('#search\_term').on("keyup", function(e) { |
  | 1089 |  | if (e.which == 13) { |
  | 1090 |  |  |
  | 1091 |  | SearchredirectTO(); |
  | 1092 |  | } |
  | 1093 |  | }); |
  | 1094 |  | function SearchredirectTO(){ |
  | 1095 |  | var redirectto='<?php echo $setacrionpage; ?>'; |
  | 1096 |  | var searchval=jQuery('#search\_term').val(); |
  | 1097 |  | redirectto=redirectto+'&search\_term='+jQuery.trim(encodeURIComponent(searchval)); |
  | 1098 |  | window.location.href=redirectto; |
  | 1099 |  | } |
  | 1100 |  | function ResetSearch(){ |
  | 1101 |  |  |
  | 1102 |  | var redirectto='<?php echo $setacrionpage; ?>'; |
  | 1103 |  | window.location.href=redirectto; |
  | 1104 |  | exit; |
  | 1105 |  | } |
  | 1106 |  | </script> |
  | 1107 |  | <div id="no-more-tables"> |
  | 1108 |  | <table cellspacing="0" id="gridTbl" class="table-bordered table-striped table-condensed cf wp-list-table widefat"> |
  | 1109 |  |  |
  | 1110 |  | <thead> |
  | 1111 |  | <tr> |
  | 1112 |  | <th class="manage-column column-cb check-column" scope="col"><input type="checkbox"></th> |
  | 1113 |  | <?php if($order\_by=="id" and $order\_pos=="asc"):?> |
  | 1114 |  |  |
  | 1115 |  | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','best-testimonial-slider');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
  | 1116 |  | <?php else:?> |
  | 1117 |  | <?php if($order\_by=="id"):?> |
  | 1118 |  | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','best-testimonial-slider');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
  | 1119 |  | <?php else:?> |
  | 1120 |  | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','best-testimonial-slider');?></a></th> |
  | 1121 |  | <?php endif;?> |
  | 1122 |  | <?php endif;?> |
  | 1123 |  | <?php if($order\_by=="media\_type" and $order\_pos=="asc"):?> |
  | 1124 |  |  |
  | 1125 |  | <th><a href="<?php echo $setacrionpage;?>&order\_by=media\_type&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Media Type','best-testimonial-slider');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
  | 1126 |  | <?php else:?> |
  | 1127 |  | <?php if($order\_by=="media\_type"):?> |
  | 1128 |  | <th><a href="<?php echo $setacrionpage;?>&order\_by=media\_type&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Media Type','best-testimonial-slider');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
  | 1129 |  | <?php else:?> |
  | 1130 |  | <th><a href="<?php echo $setacrionpage;?>&order\_by=media\_type&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Media Type','best-testimonial-slider');?></a></th> |
  | 1131 |  | <?php endif;?> |
  | 1132 |  | <?php endif;?> |
  | 1133 |  | <?php if($order\_by=="title" and $order\_pos=="asc"):?> |
  | 1134 |  |  |
  | 1135 |  | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','best-testimonial-slider');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
  | 1136 |  | <?php else:?> |
  | 1137 |  | <?php if($order\_by=="title"):?> |
  | 1138 |  | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','best-testimonial-slider');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
  | 1139 |  | <?php else:?> |
  | 1140 |  | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','best-testimonial-slider');?></a></th> |
  | 1141 |  | <?php endif;?> |
  | 1142 |  | <?php endif;?> |
  | 1143 |  | <th><span></span></th> |
  | 1144 |  | <?php if($order\_by=="createdon" and $order\_pos=="asc"):?> |
  | 1145 |  |  |
  | 1146 |  | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','best-testimonial-slider');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
  | 1147 |  | <?php else:?> |
  | 1148 |  | <?php if($order\_by=="createdon"):?> |
  | 1149 |  | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','best-testimonial-slider');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
  | 1150 |  | <?php else:?> |
  | 1151 |  | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','best-testimonial-slider');?></a></th> |
  | 1152 |  | <?php endif;?> |
  | 1153 |  | <?php endif;?> |
  | 1154 |  | <th><span><?php echo \_\_('Edit','responsive-filterable-portfolio');?></span></th> |
  | 1155 |  | <th><span><?php echo \_\_('Delete','responsive-filterable-portfolio');?></span></th> |
  | 1156 |  | </tr> |
  | 1157 |  | </thead> |
  | 1158 |  |  |
  | 1159 |  | <tbody id="the-list"> |
  | 1160 |  | <?php |
  | 1161 |  | if ($rowsCount > 0) { |
  | 1162 |  |  |
  | 1163 |  | global $wp\_rewrite; |
  | 1164 |  | $rows\_per\_page = 15; |
  | 1165 |  |  |
  | 1166 |  | $current = (isset($\_GET ['paged'])) ? ((int) htmlentities(sanitize\_text\_field($\_GET ['paged']),ENT\_QUOTES)) : 1; |
  | 1167 |  | $pagination\_args = array ( |
  | 1168 |  | 'base' => @add\_query\_arg ( 'paged', '%#%' ), |
  | 1169 |  | 'format' => '', |
  | 1170 |  | 'total' => ceil ( $rowsCount / $rows\_per\_page ), |
  | 1171 |  | 'current' => $current, |
  | 1172 |  | 'show\_all' => false, |
  | 1173 |  | 'type' => 'plain' |
  | 1174 |  | ); |
  | 1175 |  |  |
  | 1176 |  | $offset = ($current - 1) \* $rows\_per\_page; |
  | 1177 |  | $query.=" limit $offset, $rows\_per\_page"; |
  | 1178 |  | $rows = $wpdb->get\_results ( $query,ARRAY\_A); |
  | 1179 |  | $delRecNonce = wp\_create\_nonce('delete\_image'); |
  | 1180 |  | foreach ($rows as $row) { |
  | 1181 |  |  |
  | 1182 |  |  |
  | 1183 |  | $id = $row ['id']; |
  | 1184 |  | $editlink = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management&action=addedit&id=$id"; |
  | 1185 |  | $deletelink = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management&action=delete&id=$id&nonce=$delRecNonce"; |
  | 1186 |  |  |
  | 1187 |  | $outputimgmain = $baseurl . $row ['image\_name'].'?rand='.  rand(0, 5000); |
  | 1188 |  | ?> |
  | 1189 |  | <tr valign="top"> |
  | 1190 |  | <td class="alignCenter check-column" data-title="Select Record"><input type="checkbox" value="<?php echo $row['id'] ?>" name="thumbnails[]"></td> |
  | 1191 |  | <td data-title="<?php echo \_\_('Id','responsive-filterable-portfolio');?>" class="alignCenter"><?php echo $row['id']; ?></td> |
  | 1192 |  | <td data-title="Video Type" class="alignCenter"> |
  | 1193 |  | <div> |
  | 1194 |  | <strong><?php echo $row['media\_type']; ?></strong> |
  | 1195 |  | </div> |
  | 1196 |  | </td> |
  | 1197 |  | <td data-title="<?php echo \_\_('Title','responsive-filterable-portfolio');?>" class="alignCenter"> |
  | 1198 |  | <div> |
  | 1199 |  | <strong><?php echo $row['title']; ?></strong> |
  | 1200 |  | </div> |
  | 1201 |  | </td> |
  | 1202 |  | <td class="alignCenter"><img src="<?php echo $outputimgmain; ?>" style="width: 100px" height="100px" /></td> |
  | 1203 |  |  |
  | 1204 |  | <td data-title="<?php echo \_\_('Published On','responsive-filterable-portfolio');?>" class="alignCenter"><?php echo $row['createdon'] ?></td> |
  | 1205 |  | <td data-title="<?php echo \_\_('Edit','responsive-filterable-portfolio');?>" class="alignCenter"> |
  | 1206 |  | <strong><a href='<?php echo $editlink; ?>' title="edit"><?php echo \_\_('Edit','responsive-filterable-portfolio');?></a></strong> |
  | 1207 |  | </td> |
  | 1208 |  | <td data-title="<?php echo \_\_('Delete','responsive-filterable-portfolio');?>" class="alignCenter"> |
  | 1209 |  | <strong> |
  | 1210 |  | <a href='<?php echo $deletelink; ?>' onclick="return confirmDelete();" title="delete"><?php echo \_\_('Delete','responsive-filterable-portfolio');?></a> |
  | 1211 |  | </strong> |
  | 1212 |  | </td> |
  | 1213 |  | </tr> |
  | 1214 |  | <?php |
  | 1215 |  |  |
  | 1216 |  | } |
  | 1217 |  | } |
  | 1218 |  | else { |
  | 1219 |  | ?> |
  | 1220 |  | <tr valign="top" class="" id=""> |
  | 1221 |  | <td colspan="9" data-title="<?php echo \_\_('No Record','responsive-filterable-portfolio');?>" align="center"><strong><?php echo \_\_('No portfolio Found','responsive-filterable-portfolio');?></strong></td> |
  | 1222 |  | </tr> |
  | 1223 |  | <?php |
  | 1224 |  | } |
  | 1225 |  | ?> |
  | 1226 |  | </tbody> |
  | 1227 |  | </table> |
  | 1228 |  | </div> |
  | 1229 |  | <?php |
  | 1230 |  | if ($rowsCount > 0) { |
  | 1231 |  | echo "<div class='pagination' style='padding-top:10px'>"; |
  | 1232 |  | echo paginate\_links ( $pagination\_args ); |
  | 1233 |  | echo "</div>"; |
  | 1234 |  | } |
  | 1235 |  | ?> |
  | 1236 |  | <br /> |
  | 1237 |  | <div class="alignleft actions"> |
  | 1238 |  | <select name="action" id="action\_bottom"> |
  | 1239 |  | <option selected="selected" value="-1"><?php echo \_\_('Bulk Actions','responsive-filterable-portfolio');?></option> |
  | 1240 |  | <option value="delete"><?php echo \_\_('Delete','responsive-filterable-portfolio');?></option> |
  | 1241 |  | </select> |
  | 1242 |  | <?php wp\_nonce\_field('action\_settings\_mass\_delete', 'mass\_delete\_nonce'); ?> |
  | 1243 |  | <input type="submit" value="<?php echo \_\_('Apply','responsive-filterable-portfolio');?>" class="button-secondary action" id="deleteselected" name="deleteselected" onclick="return confirmDelete\_bulk();"> |
  | 1244 |  | </div> |
  | 1245 |  |  |
  | 1246 |  | </form> |
  | 1247 |  | <script type="text/JavaScript"> |
  | 1248 |  |  |
  | 1249 |  | function  confirmDelete\_bulk(){ |
  | 1250 |  | var topval=document.getElementById("action\_bottom").value; |
  | 1251 |  | var bottomVal=document.getElementById("action\_upper").value; |
  | 1252 |  |  |
  | 1253 |  | if(topval=='delete' || bottomVal=='delete'){ |
  | 1254 |  |  |
  | 1255 |  |  |
  | 1256 |  | var agree=confirm("<?php echo \_\_('Are you sure you want to delete selected media ?','responsive-filterable-portfolio');?>"); |
  | 1257 |  | if (agree) |
  | 1258 |  | return true ; |
  | 1259 |  | else |
  | 1260 |  | return false; |
  | 1261 |  | } |
  | 1262 |  | } |
  | 1263 |  |  |
  | 1264 |  | function  confirmDelete(){ |
  | 1265 |  | var agree=confirm("<?php echo \_\_('Are you sure you want to delete this media ?','responsive-filterable-portfolio');?>"); |
  | 1266 |  | if (agree) |
  | 1267 |  | return true ; |
  | 1268 |  | else |
  | 1269 |  | return false; |
  | 1270 |  | } |
  | 1271 |  | </script> |
  | 1272 |  |  |
  | 1273 |  | <br class="clear"> |
  | 1274 |  | </div> |
  | 1275 |  | <div style="clear: both;"></div> |
  | 1276 |  | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
  | 1277 |  |  |
  | 1278 |  |  |
  | 1279 |  | </div> |
  | 1280 |  | <h3><?php echo \_\_('To print this video gallery into WordPress Post/Page use below code','responsive-filterable-portfolio');?></h3> |
  | 1281 |  | <input type="text" |
  | 1282 |  | value='[print\_responsive\_portfolio\_plus\_lightbox] ' |
  | 1283 |  | style="width: 400px; height: 30px" |
  | 1284 |  | onclick="this.focus(); this.select()" /> |
  | 1285 |  | <div class="clear"></div> |
  | 1286 |  | <h3><?php echo \_\_('To print this video gallery into WordPress theme/template PHP files use below code','responsive-filterable-portfolio');?></h3> |
  | 1287 |  | <?php |
  | 1288 |  | $shortcode = '[print\_responsive\_portfolio\_plus\_lightbox]'; |
  | 1289 |  | ?> |
  | 1290 |  | <input type="text" |
  | 1291 |  | value="&lt;?php echo do\_shortcode('<?php echo htmlentities($shortcode, ENT\_QUOTES); ?>'); ?&gt;" |
  | 1292 |  | style="width: 400px; height: 30px" |
  | 1293 |  | onclick="this.focus(); this.select()" /> |
  | 1294 |  | <div class="clear"></div> |
  | 1295 |  | </div> |
  | 1296 |  | </div> |
  | 1297 |  | <div id="postbox-container-1" class="postbox-container" > |
  | 1298 |  |  |
  | 1299 |  | <div class="postbox"> |
  | 1300 |  | <h3 class="hndle"><span></span><?php echo \_\_('Access All Themes In One Price','responsive-filterable-portfolio');?></h3> |
  | 1301 |  | <div class="inside"> |
  | 1302 |  | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"> |
  | 1303 |  | <img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"> |
  | 1304 |  | </a></center> |
  | 1305 |  |  |
  | 1306 |  | <div style="margin:10px 5px"> |
  | 1307 |  |  |
  | 1308 |  | </div> |
  | 1309 |  | </div> |
  | 1310 |  |  |
  | 1311 |  | </div> |
  | 1312 |  | <div class="postbox"> |
  | 1313 |  | <h3 class="hndle"><span></span><?php echo \_\_('Google For Business Coupon','responsive-filterable-portfolio');?></h3> |
  | 1314 |  | <div class="inside"> |
  | 1315 |  | <center><a href="https://goo.gl/OJBuHT" target="\_blank"> |
  | 1316 |  | <img src="<?php echo plugins\_url( 'images/g-suite-promo-code-4.png', \_\_FILE\_\_ );?>" width="250" height="250" border="0"> |
  | 1317 |  | </a></center> |
  | 1318 |  | <div style="margin:10px 5px"> |
  | 1319 |  | </div> |
  | 1320 |  | </div> |
  | 1321 |  |  |
  | 1322 |  | </div> |
  | 1323 |  |  |
  | 1324 |  | </div> |
  | 1325 |  | </div> |
  | 1326 |  | </div> |
  | 1327 |  | <?php |
  | 1328 |  | } |
  | 1329 |  | else if (strtolower ( $action ) == strtolower ( 'addedit' )) { |
  | 1330 |  |  |
  | 1331 |  | $url = plugin\_dir\_url ( \_\_FILE\_\_ ); |
  | 1332 |  |  |
  | 1333 |  | $vNonce = wp\_create\_nonce('vNonce'); |
  | 1334 |  |  |
  | 1335 |  | if (isset ( $\_POST ['btnsave'] )) { |
  | 1336 |  |  |
  | 1337 |  | if (!check\_admin\_referer('action\_image\_add\_edit', 'add\_edit\_image\_nonce')) { |
  | 1338 |  |  |
  | 1339 |  | wp\_die('Security check fail'); |
  | 1340 |  | } |
  | 1341 |  | $uploads = wp\_upload\_dir (); |
  | 1342 |  | $baseDir = $uploads ['basedir']; |
  | 1343 |  | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
  | 1344 |  | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  | 1345 |  |  |
  | 1346 |  | if(isset($\_POST['media\_type']) and $\_POST['media\_type']=='video'){ |
  | 1347 |  |  |
  | 1348 |  | $media\_type=trim($\_POST['media\_type']); |
  | 1349 |  | $vtype = trim ( htmlentities(sanitize\_text\_field( $\_POST ['vtype'] ),ENT\_QUOTES) ); |
  | 1350 |  | $videourl = trim ( htmlentities(esc\_url\_raw($\_POST ['videourl'] ),ENT\_QUOTES)); |
  | 1351 |  | // echo $videourl;die; |
  | 1352 |  | $vid = uniqid ( 'vid\_' ); |
  | 1353 |  | $embed\_url=''; |
  | 1354 |  | if ($vtype == 'youtube') { |
  | 1355 |  | // parse |
  | 1356 |  |  |
  | 1357 |  | $parseUrl = @parse\_url ( $videourl ); |
  | 1358 |  | if (is\_array ( $parseUrl )) { |
  | 1359 |  |  |
  | 1360 |  | $queryStr = $parseUrl ['query']; |
  | 1361 |  | parse\_str ( $queryStr, $array ); |
  | 1362 |  | if (is\_array ( $array ) and isset ( $array ['v'] )) { |
  | 1363 |  |  |
  | 1364 |  | $vid = $array ['v']; |
  | 1365 |  | } |
  | 1366 |  | } |
  | 1367 |  |  |
  | 1368 |  | $embed\_url="//www.youtube.com/embed/$vid"; |
  | 1369 |  | } |
  | 1370 |  |  |
  | 1371 |  | else if ($vtype == 'metacafe') { |
  | 1372 |  |  |
  | 1373 |  | $end = end(explode('/', rtrim($videourl, '/'))); |
  | 1374 |  |  |
  | 1375 |  | $vid = 0; |
  | 1376 |  | if ($end) { |
  | 1377 |  |  |
  | 1378 |  | $vid = $end; |
  | 1379 |  | } |
  | 1380 |  |  |
  | 1381 |  |  |
  | 1382 |  | $embed\_url = $videourl; |
  | 1383 |  | $embed\_url=  str\_replace("/watch/", "/embed/", $embed\_url); |
  | 1384 |  |  |
  | 1385 |  | } |
  | 1386 |  |  |
  | 1387 |  |  |
  | 1388 |  |  |
  | 1389 |  | $HdnMediaSelection = trim ( htmlentities(esc\_url\_raw($\_POST ['HdnMediaSelection'] ),ENT\_QUOTES)); |
  | 1390 |  | $videotitle = trim ( htmlentities(sanitize\_text\_field($\_POST ['title'] ),ENT\_QUOTES)) ; |
  | 1391 |  | $videotitleurl = trim ( htmlentities(esc\_url\_raw($\_POST ['murl'] ),ENT\_QUOTES)); |
  | 1392 |  | $mtag = trim (htmlentities(sanitize\_text\_field( $\_POST ['mtag'] ),ENT\_QUOTES)); |
  | 1393 |  |  |
  | 1394 |  |  |
  | 1395 |  | $videotitle = str\_replace("'","’",$videotitle); |
  | 1396 |  | $videotitle = str\_replace('"', '&quot;', $videotitle); |
  | 1397 |  |  |
  | 1398 |  |  |
  | 1399 |  | $mtag = str\_replace("'","’",$mtag); |
  | 1400 |  | $mtag = str\_replace('"', '&quot;', $mtag); |
  | 1401 |  |  |
  | 1402 |  |  |
  | 1403 |  | if (isset ( $\_POST ['open\_link\_in'] )) |
  | 1404 |  | $open\_link\_in = 1; |
  | 1405 |  | else |
  | 1406 |  | $open\_link\_in = 0; |
  | 1407 |  |  |
  | 1408 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 1409 |  | // edit save |
  | 1410 |  | if (isset ( $\_POST ['videoid'] )) { |
  | 1411 |  |  |
  | 1412 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_edit\_media' ) ) { |
  | 1413 |  |  |
  | 1414 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 1415 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1416 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1417 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator','responsive-filterable-portfolio'); |
  | 1418 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1419 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1420 |  | exit (); |
  | 1421 |  |  |
  | 1422 |  |  |
  | 1423 |  | } |
  | 1424 |  |  |
  | 1425 |  | try { |
  | 1426 |  |  |
  | 1427 |  | $videoidEdit=intval(htmlentities(sanitize\_text\_field($\_POST ['videoid']),ENT\_QUOTES)); |
  | 1428 |  | if (trim ( $\_POST ['HdnMediaSelection'] ) != '') { |
  | 1429 |  |  |
  | 1430 |  | $pInfo = pathinfo ( $HdnMediaSelection ); |
  | 1431 |  | $ext = $pInfo ['extension']; |
  | 1432 |  | $imagename = $vid . '\_big.' . $ext; |
  | 1433 |  | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  | 1434 |  |  |
  | 1435 |  | @copy ( $HdnMediaSelection, $imageUploadTo ); |
  | 1436 |  | if(!file\_exists($imageUploadTo)){ |
  | 1437 |  | rfp\_save\_image($HdnMediaSelection,$imageUploadTo); |
  | 1438 |  | } |
  | 1439 |  |  |
  | 1440 |  | $settings = get\_option( 'best\_portfolio\_grid\_settings' ); |
  | 1441 |  | $imageheight = $settings ['imageheight']; |
  | 1442 |  | $imagewidth = $settings ['imagewidth']; |
  | 1443 |  | @unlink($pathToImagesFolder.'/'.$vid . '\_big\_'.$imageheight.'\_'.$imagewidth.'.'.$ext); |
  | 1444 |  | } |
  | 1445 |  |  |
  | 1446 |  | $query = "update " . $wpdb->prefix . "e\_portfolio |
  | 1447 |  | set media\_type='$media\_type', vtype='$vtype',vid='$vid',murl='$videourl',embed\_url='$embed\_url',image\_name='$imagename',HdnMediaSelection='$HdnMediaSelection', |
  | 1448 |  | title='$videotitle',videourl='$videotitleurl',mtag='$mtag', |
  | 1449 |  | open\_link\_in=$open\_link\_in  where id=$videoidEdit"; |
  | 1450 |  |  |
  | 1451 |  | //echo $query;die; |
  | 1452 |  | $wpdb->query ( $query ); |
  | 1453 |  |  |
  | 1454 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1455 |  | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  | 1456 |  | $wp\_best\_portfolio\_msg ['message'] =  \_\_('Video updated successfully.','responsive-filterable-portfolio'); |
  | 1457 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1458 |  | } |
  | 1459 |  | catch ( Exception $e ) { |
  | 1460 |  |  |
  | 1461 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1462 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1463 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while adding video','responsive-filterable-portfolio'); |
  | 1464 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1465 |  |  |
  | 1466 |  |  |
  | 1467 |  | } |
  | 1468 |  |  |
  | 1469 |  |  |
  | 1470 |  |  |
  | 1471 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1472 |  | exit (); |
  | 1473 |  |  |
  | 1474 |  | } |
  | 1475 |  | else { |
  | 1476 |  |  |
  | 1477 |  |  |
  | 1478 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_add\_media' ) ) { |
  | 1479 |  |  |
  | 1480 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 1481 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1482 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1483 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator','responsive-filterable-portfolio'); |
  | 1484 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1485 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1486 |  | exit (); |
  | 1487 |  |  |
  | 1488 |  |  |
  | 1489 |  | } |
  | 1490 |  |  |
  | 1491 |  | $createdOn = date ( 'Y-m-d h:i:s' ); |
  | 1492 |  | if (function\_exists ( 'date\_i18n' )) { |
  | 1493 |  |  |
  | 1494 |  | $createdOn = date\_i18n ( 'Y-m-d' . ' ' . get\_option ( 'time\_format' ), false, false ); |
  | 1495 |  | if (get\_option ( 'time\_format' ) == 'H:i') |
  | 1496 |  | $createdOn = date ( 'Y-m-d H:i:s', strtotime ( $createdOn ) ); |
  | 1497 |  | else |
  | 1498 |  | $createdOn = date ( 'Y-m-d h:i:s', strtotime ( $createdOn ) ); |
  |  | 1794 | <span><h3 style="color: blue;"><a target="\_blank" href="http://www.i13websolution.com/wordpress-responsive-media-portfolio-grid.html"><?php echo \_\_('UPGRADE TO PRO VERSION', 'responsive-filterable-portfolio'); ?></a></h3></span> |
  |  | 1795 |  |
  |  | 1796 | <div class="wrap"> |
  |  | 1797 | <?php |
  |  | 1798 | if (isset($\_GET ['id']) && intval($\_GET['id']) > 0) { |
  |  | 1799 |  |
  |  | 1800 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_edit\_media')) { |
  |  | 1801 |  |
  |  | 1802 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 1803 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1804 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1805 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator', 'responsive-filterable-portfolio'); |
  |  | 1806 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1807 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1808 | exit(); |
  | 1499 | 1809 | } |
  | 1500 |  |  |
  | 1501 |  | try { |
  | 1502 |  |  |
  | 1503 |  | if (trim ( $\_POST ['HdnMediaSelection'] ) != '') { |
  | 1504 |  | $pInfo = pathinfo ( $HdnMediaSelection ); |
  | 1505 |  | $ext = $pInfo ['extension']; |
  | 1506 |  | $imagename = $vid . '\_big.' . $ext; |
  | 1507 |  | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  | 1508 |  | @copy ( $HdnMediaSelection, $imageUploadTo ); |
  | 1509 |  | if(!file\_exists($imageUploadTo)){ |
  | 1510 |  | rfp\_save\_image($HdnMediaSelection,$imageUploadTo); |
  | 1511 |  | } |
  | 1512 |  | } |
  | 1513 |  |  |
  | 1514 |  | $query = "INSERT INTO " . $wpdb->prefix . "e\_portfolio |
  | 1515 |  | (media\_type,image\_name,title,murl,mtag,open\_link\_in, |
  | 1516 |  | vtype,vid,videourl,embed\_url,HdnMediaSelection,createdon) |
  | 1517 |  | VALUES ('$media\_type','$imagename','$videotitle','$videourl','$mtag', |
  | 1518 |  | $open\_link\_in,'$vtype','$vid','$videourl','$embed\_url','$HdnMediaSelection', '$createdOn')"; |
  | 1519 |  |  |
  | 1520 |  |  |
  | 1521 |  | $wpdb->query ( $query ); |
  | 1522 |  |  |
  | 1523 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1524 |  | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  | 1525 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('New video added successfully.','responsive-filterable-portfolio'); |
  | 1526 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1527 |  |  |
  | 1528 |  | } |
  | 1529 |  | catch ( Exception $e ) { |
  | 1530 |  |  |
  | 1531 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1532 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1533 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while adding video','responsive-filterable-portfolio'); |
  | 1534 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1535 |  | } |
  | 1536 |  |  |
  | 1537 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1538 |  | exit (); |
  | 1539 |  | } |
  | 1540 |  |  |
  | 1541 |  | } |
  | 1542 |  | else if(isset($\_POST['media\_type']) and $\_POST['media\_type']=='image'){ |
  | 1543 |  |  |
  | 1544 |  | $vid = uniqid ( 'vid\_' ); |
  | 1545 |  | $media\_type=trim(htmlentities(sanitize\_text\_field($\_POST['media\_type']),ENT\_QUOTES)); |
  | 1546 |  | $HdnMediaSelection = trim ( htmlentities(sanitize\_text\_field($\_POST ['HdnMediaSelection\_image'] ),ENT\_QUOTES)); |
  | 1547 |  | $mtitle = trim ( htmlentities(sanitize\_text\_field($\_POST ['title'] ),ENT\_QUOTES)) ; |
  | 1548 |  | $murl = trim ( htmlentities(esc\_url\_raw($\_POST ['murl'] ),ENT\_QUOTES)); |
  | 1549 |  | $mtag = trim ( htmlentities(sanitize\_text\_field($\_POST ['mtag'] ),ENT\_QUOTES)); |
  | 1550 |  |  |
  | 1551 |  |  |
  | 1552 |  |  |
  | 1553 |  |  |
  | 1554 |  | $mtitle = str\_replace("'","’",$mtitle); |
  | 1555 |  | $mtitle = str\_replace('"', '&quot;', $mtitle); |
  | 1556 |  |  |
  | 1557 |  |  |
  | 1558 |  | $mtag = str\_replace("'","’",$mtag); |
  | 1559 |  | $mtag = str\_replace('"', '&quot;', $mtag); |
  | 1560 |  |  |
  | 1561 |  |  |
  | 1562 |  | if (isset ( $\_POST ['open\_link\_in'] )) |
  | 1563 |  | $open\_link\_in = 1; |
  | 1564 |  | else |
  | 1565 |  | $open\_link\_in = 0; |
  | 1566 |  |  |
  | 1567 |  |  |
  | 1568 |  |  |
  | 1569 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 1570 |  | // edit save |
  | 1571 |  | if (isset ( $\_POST ['imageid'] )) { |
  | 1572 |  |  |
  | 1573 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_edit\_media' ) ) { |
  | 1574 |  |  |
  | 1575 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 1576 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1577 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1578 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator','responsive-filterable-portfolio'); |
  | 1579 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1580 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1581 |  | exit (); |
  | 1582 |  |  |
  | 1583 |  |  |
  | 1584 |  | } |
  | 1585 |  |  |
  | 1586 |  | try { |
  | 1587 |  |  |
  | 1588 |  | $videoidEdit=intval(htmlentities(sanitize\_text\_field($\_POST ['imageid']),ENT\_QUOTES)); |
  | 1589 |  | if (trim ( $\_POST ['HdnMediaSelection\_image'] ) != '') { |
  | 1590 |  |  |
  | 1591 |  | $pInfo = pathinfo ( $HdnMediaSelection ); |
  | 1592 |  | $ext = $pInfo ['extension']; |
  | 1593 |  | $imagename = $vid . '\_big.' . $ext; |
  | 1594 |  | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  | 1595 |  |  |
  | 1596 |  | @copy ( $HdnMediaSelection, $imageUploadTo ); |
  | 1597 |  | if(!file\_exists($imageUploadTo)){ |
  | 1598 |  | rfp\_save\_image($HdnMediaSelection,$imageUploadTo); |
  | 1599 |  | } |
  | 1600 |  |  |
  | 1601 |  | $settings = get\_option( 'best\_portfolio\_grid\_settings' ); |
  | 1602 |  | $imageheight = $settings ['imageheight']; |
  | 1603 |  | $imagewidth = $settings ['imagewidth']; |
  | 1604 |  | @unlink($pathToImagesFolder.'/'.$vid . '\_big\_'.$imageheight.'\_'.$imagewidth.'.'.$ext); |
  | 1605 |  | } |
  | 1606 |  |  |
  | 1607 |  | $query = "update " . $wpdb->prefix . "e\_portfolio |
  | 1608 |  | set media\_type='$media\_type', murl='$murl',image\_name='$imagename',HdnMediaSelection='$HdnMediaSelection', |
  | 1609 |  | title='$mtitle',mtag='$mtag', |
  | 1610 |  | open\_link\_in=$open\_link\_in  where id=$videoidEdit"; |
  | 1611 |  |  |
  | 1612 |  | //echo $query;die; |
  | 1613 |  | $wpdb->query ( $query ); |
  | 1614 |  |  |
  | 1615 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1616 |  | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  | 1617 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Image updated successfully.','responsive-filterable-portfolio'); |
  | 1618 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1619 |  | } |
  | 1620 |  | catch ( Exception $e ) { |
  | 1621 |  |  |
  | 1622 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1623 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1624 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while adding image','responsive-filterable-portfolio'); |
  | 1625 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1626 |  |  |
  | 1627 |  |  |
  | 1628 |  | } |
  | 1629 |  |  |
  | 1630 |  |  |
  | 1631 |  |  |
  | 1632 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1633 |  | exit (); |
  | 1634 |  | } |
  | 1635 |  | else { |
  | 1636 |  |  |
  | 1637 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_add\_media' ) ) { |
  | 1638 |  |  |
  | 1639 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 1640 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1641 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1642 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator','responsive-filterable-portfolio'); |
  | 1643 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1644 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1645 |  | exit (); |
  | 1646 |  |  |
  | 1647 |  |  |
  |  | 1810 |  |
  |  | 1811 | $id = intval($\_GET ['id']); |
  |  | 1812 |  |
  |  | 1813 | $query = 'SELECT \* FROM ' . $wpdb->prefix . "e\_portfolio WHERE id=$id"; |
  |  | 1814 |  |
  |  | 1815 | $myrow = $wpdb->get\_row($query); |
  |  | 1816 |  |
  |  | 1817 | if (is\_object($myrow)) { |
  |  | 1818 |  |
  |  | 1819 | $media\_type = $myrow->media\_type; |
  |  | 1820 | $vtype = $myrow->vtype; |
  |  | 1821 | $title = $myrow->title; |
  |  | 1822 | $murl = $myrow->murl; |
  |  | 1823 | $mtag = $myrow->mtag; |
  |  | 1824 | $image\_name = $myrow->image\_name; |
  |  | 1825 | $video\_url = $myrow->murl; |
  |  | 1826 | $HdnMediaSelection = $myrow->HdnMediaSelection; |
  |  | 1827 | $videotitle = $myrow->title; |
  |  | 1828 | $videotitleurl = $myrow->videourl; |
  |  | 1829 | $open\_link\_in = $myrow->open\_link\_in; |
  | 1648 | 1830 | } |
  | 1649 |  | $createdOn = date ( 'Y-m-d h:i:s' ); |
  | 1650 |  | if (function\_exists ( 'date\_i18n' )) { |
  | 1651 |  |  |
  | 1652 |  | $createdOn = date\_i18n ( 'Y-m-d' . ' ' . get\_option ( 'time\_format' ), false, false ); |
  | 1653 |  | if (get\_option ( 'time\_format' ) == 'H:i') |
  | 1654 |  | $createdOn = date ( 'Y-m-d H:i:s', strtotime ( $createdOn ) ); |
  | 1655 |  | else |
  | 1656 |  | $createdOn = date ( 'Y-m-d h:i:s', strtotime ( $createdOn ) ); |
  | 1657 |  | } |
  | 1658 |  |  |
  | 1659 |  | try { |
  | 1660 |  |  |
  | 1661 |  | if (trim ( $\_POST ['HdnMediaSelection\_image'] ) != '') { |
  | 1662 |  | $pInfo = pathinfo ( $HdnMediaSelection ); |
  | 1663 |  | $ext = $pInfo ['extension']; |
  | 1664 |  | $imagename = $vid . '\_big.' . $ext; |
  | 1665 |  | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  | 1666 |  | @copy ( $HdnMediaSelection, $imageUploadTo ); |
  | 1667 |  | if(!file\_exists($imageUploadTo)){ |
  | 1668 |  | rfp\_save\_image($HdnMediaSelection,$imageUploadTo); |
  | 1669 |  | } |
  | 1670 |  | } |
  | 1671 |  |  |
  | 1672 |  | $query = "INSERT INTO " . $wpdb->prefix . "e\_portfolio |
  | 1673 |  | (media\_type,image\_name,title,murl,mtag,open\_link\_in, |
  | 1674 |  | HdnMediaSelection,createdon) |
  | 1675 |  | VALUES ('$media\_type','$imagename','$mtitle','$murl','$mtag', |
  | 1676 |  | $open\_link\_in,'$HdnMediaSelection', '$createdOn')"; |
  | 1677 |  |  |
  | 1678 |  |  |
  | 1679 |  | $wpdb->query ( $query ); |
  | 1680 |  |  |
  | 1681 |  | //echo $wpdb->last\_error;die; |
  | 1682 |  |  |
  | 1683 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1684 |  | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  | 1685 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('New image added successfully.','responsive-filterable-portfolio'); |
  | 1686 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1687 |  | } catch ( Exception $e ) { |
  | 1688 |  |  |
  | 1689 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1690 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1691 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while adding image','responsive-filterable-portfolio'); |
  | 1692 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1693 |  | } |
  | 1694 |  |  |
  | 1695 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1696 |  | exit (); |
  | 1697 |  | } |
  | 1698 |  |  |
  | 1699 |  |  |
  | 1700 |  | } |
  | 1701 |  | else if(isset($\_POST['media\_type']) and $\_POST['media\_type']=='link'){ |
  | 1702 |  |  |
  | 1703 |  | $vid = uniqid ( 'vid\_' ); |
  | 1704 |  | $media\_type=trim(htmlentities(sanitize\_text\_field($\_POST['media\_type']),ENT\_QUOTES)); |
  | 1705 |  | $HdnMediaSelection = trim (htmlentities(esc\_url\_raw( $\_POST ['HdnMediaSelection\_link'] ),ENT\_QUOTES)); |
  | 1706 |  | $mtitle = trim (htmlentities(sanitize\_text\_field( $\_POST ['title'] ),ENT\_QUOTES)); |
  | 1707 |  |  |
  | 1708 |  | $mtag = trim ( htmlentities(sanitize\_text\_field($\_POST ['mtag'] ),ENT\_QUOTES)); |
  | 1709 |  | $murl = trim ( htmlentities(esc\_url\_raw($\_POST ['murl'] ),ENT\_QUOTES)); |
  | 1710 |  |  |
  | 1711 |  |  |
  | 1712 |  | $mtitle = str\_replace("'","’",$mtitle); |
  | 1713 |  | $mtitle = str\_replace('"', '&quot;', $mtitle); |
  | 1714 |  |  |
  | 1715 |  |  |
  | 1716 |  | $mtag = str\_replace("'","’",$mtag); |
  | 1717 |  | $mtag = str\_replace('"', '&quot;', $mtag); |
  | 1718 |  |  |
  | 1719 |  |  |
  | 1720 |  | if (isset ( $\_POST ['open\_link\_in'] )) |
  | 1721 |  | $open\_link\_in = 1; |
  | 1722 |  | else |
  | 1723 |  | $open\_link\_in = 0; |
  | 1724 |  |  |
  | 1725 |  |  |
  | 1726 |  |  |
  | 1727 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 1728 |  | // edit save |
  | 1729 |  | if (isset ( $\_POST ['linkid'] )) { |
  | 1730 |  |  |
  | 1731 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_edit\_media' ) ) { |
  | 1732 |  |  |
  | 1733 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 1734 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1735 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1736 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator','responsive-filterable-portfolio'); |
  | 1737 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1738 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1739 |  | exit (); |
  | 1740 |  |  |
  | 1741 |  |  |
  | 1742 |  | } |
  | 1743 |  |  |
  | 1744 |  | try { |
  | 1745 |  |  |
  | 1746 |  | $videoidEdit=htmlentities(sanitize\_text\_field($\_POST ['linkid']),ENT\_QUOTES); |
  | 1747 |  | if (trim ( $\_POST ['HdnMediaSelection\_link'] ) != '') { |
  | 1748 |  |  |
  | 1749 |  | $pInfo = pathinfo ( $HdnMediaSelection ); |
  | 1750 |  | $ext = $pInfo ['extension']; |
  | 1751 |  | $imagename = $vid . '\_big.' . $ext; |
  | 1752 |  | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  | 1753 |  |  |
  | 1754 |  | @copy ( $HdnMediaSelection, $imageUploadTo ); |
  | 1755 |  | if(!file\_exists($imageUploadTo)){ |
  | 1756 |  | rfp\_save\_image($HdnMediaSelection,$imageUploadTo); |
  | 1757 |  | } |
  | 1758 |  |  |
  | 1759 |  |  |
  | 1760 |  | $settings = get\_option( 'best\_portfolio\_grid\_settings' ); |
  | 1761 |  | $imageheight = $settings ['imageheight']; |
  | 1762 |  | $imagewidth = $settings ['imagewidth']; |
  | 1763 |  | @unlink($pathToImagesFolder.'/'.$vid . '\_big\_'.$imageheight.'\_'.$imagewidth.'.'.$ext); |
  | 1764 |  | } |
  | 1765 |  |  |
  | 1766 |  | $query = "update " . $wpdb->prefix . "e\_portfolio |
  | 1767 |  | set media\_type='$media\_type', murl='$murl',image\_name='$imagename',HdnMediaSelection='$HdnMediaSelection', |
  | 1768 |  | title='$mtitle',mtag='$mtag', |
  | 1769 |  | open\_link\_in=$open\_link\_in  where id=$videoidEdit"; |
  | 1770 |  |  |
  | 1771 |  | //echo $query;die; |
  | 1772 |  | $wpdb->query ( $query ); |
  | 1773 |  |  |
  | 1774 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1775 |  | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  | 1776 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Link updated successfully.','responsive-filterable-portfolio'); |
  | 1777 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1778 |  | } |
  | 1779 |  | catch ( Exception $e ) { |
  | 1780 |  |  |
  | 1781 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1782 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1783 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while adding link','responsive-filterable-portfolio'); |
  | 1784 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1785 |  |  |
  | 1786 |  |  |
  | 1787 |  | } |
  | 1788 |  |  |
  | 1789 |  |  |
  | 1790 |  |  |
  | 1791 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1792 |  | exit (); |
  | 1793 |  |  |
  | 1794 |  |  |
  | 1795 |  | } |
  | 1796 |  | else { |
  | 1797 |  |  |
  | 1798 |  |  |
  | 1799 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_add\_media' ) ) { |
  | 1800 |  |  |
  | 1801 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 1802 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1803 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1804 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator','responsive-filterable-portfolio'); |
  | 1805 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1806 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1807 |  | exit (); |
  | 1808 |  |  |
  | 1809 |  |  |
  | 1810 |  | } |
  | 1811 |  |  |
  | 1812 |  | $createdOn = date ( 'Y-m-d h:i:s' ); |
  | 1813 |  | if (function\_exists ( 'date\_i18n' )) { |
  | 1814 |  |  |
  | 1815 |  | $createdOn = date\_i18n ( 'Y-m-d' . ' ' . get\_option ( 'time\_format' ), false, false ); |
  | 1816 |  | if (get\_option ( 'time\_format' ) == 'H:i') |
  | 1817 |  | $createdOn = date ( 'Y-m-d H:i:s', strtotime ( $createdOn ) ); |
  | 1818 |  | else |
  | 1819 |  | $createdOn = date ( 'Y-m-d h:i:s', strtotime ( $createdOn ) ); |
  | 1820 |  | } |
  | 1821 |  |  |
  | 1822 |  | try { |
  | 1823 |  |  |
  | 1824 |  | if (trim ( $\_POST ['HdnMediaSelection\_link'] ) != '') { |
  | 1825 |  | $pInfo = pathinfo ( $HdnMediaSelection ); |
  | 1826 |  | $ext = $pInfo ['extension']; |
  | 1827 |  | $imagename = $vid . '\_big.' . $ext; |
  | 1828 |  | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  | 1829 |  | @copy ( $HdnMediaSelection, $imageUploadTo ); |
  | 1830 |  | if(!file\_exists($imageUploadTo)){ |
  | 1831 |  | rfp\_save\_image($HdnMediaSelection,$imageUploadTo); |
  | 1832 |  | } |
  | 1833 |  | } |
  | 1834 |  |  |
  | 1835 |  | $query = "INSERT INTO " . $wpdb->prefix . "e\_portfolio |
  | 1836 |  | (media\_type,image\_name,title,murl,mtag,open\_link\_in, |
  | 1837 |  | HdnMediaSelection,createdon) |
  | 1838 |  | VALUES ('$media\_type','$imagename','$mtitle','$murl','$mtag', |
  | 1839 |  | $open\_link\_in,'$HdnMediaSelection', '$createdOn')"; |
  | 1840 |  |  |
  | 1841 |  |  |
  | 1842 |  | $wpdb->query ( $query ); |
  | 1843 |  |  |
  | 1844 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1845 |  | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  | 1846 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('New link added successfully.','responsive-filterable-portfolio'); |
  | 1847 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1848 |  | } |
  | 1849 |  | catch ( Exception $e ) { |
  | 1850 |  |  |
  | 1851 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1852 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1853 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while adding link','responsive-filterable-portfolio'); |
  | 1854 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1855 |  | } |
  | 1856 |  |  |
  | 1857 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1858 |  | exit (); |
  | 1859 |  | } |
  | 1860 |  |  |
  | 1861 |  |  |
  | 1862 |  | } |
  | 1863 |  |  |
  | 1864 |  |  |
  | 1865 |  | } |
  | 1866 |  | else { |
  | 1867 |  |  |
  | 1868 |  | $uploads = wp\_upload\_dir (); |
  | 1869 |  | $baseurl = $uploads ['baseurl']; |
  | 1870 |  | $baseurl .= '/wp-best-portfolio/'; |
  | 1871 |  | ?> |
  | 1872 |  | <div id="poststuff" > |
  | 1873 |  | <div id="post-body" class="metabox-holder columns-2" > |
  | 1874 |  | <div id="post-body-content"> |
  | 1875 |  | <table><tr> |
  | 1876 |  | <td> |
  | 1877 |  | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
  | 1878 |  | <div id="fb-root"></div> |
  | 1879 |  | <script>(function(d, s, id) { |
  | 1880 |  | var js, fjs = d.getElementsByTagName(s)[0]; |
  | 1881 |  | if (d.getElementById(id)) return; |
  | 1882 |  | js = d.createElement(s); js.id = id; |
  | 1883 |  | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
  | 1884 |  | fjs.parentNode.insertBefore(js, fjs); |
  | 1885 |  | }(document, 'script', 'facebook-jssdk'));</script> |
  | 1886 |  | </td> |
  | 1887 |  | <td> |
  | 1888 |  | <a target="\_blank" title="Donate" href="http://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
  | 1889 |  | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ ) ;?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
  | 1890 |  | </a> |
  | 1891 |  | </td> |
  | 1892 |  | </tr> |
  | 1893 |  | </table> |
  | 1894 |  | <span><h3 style="color: blue;"><a target="\_blank" href="http://www.i13websolution.com/wordpress-responsive-media-portfolio-grid.html"><?php echo \_\_('UPGRADE TO PRO VERSION','responsive-filterable-portfolio');?></a></h3></span> |
  | 1895 |  |  |
  | 1896 |  | <div class="wrap"> |
  | 1897 |  | <?php |
  | 1898 |  | if (isset ( $\_GET ['id'] ) and intval($\_GET['id']) > 0) { |
  | 1899 |  |  |
  | 1900 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_edit\_media' ) ) { |
  | 1901 |  |  |
  | 1902 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 1903 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1904 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1905 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator','responsive-filterable-portfolio'); |
  | 1906 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1907 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1908 |  | exit (); |
  | 1909 |  |  |
  | 1910 |  |  |
  | 1911 |  | } |
  | 1912 |  |  |
  | 1913 |  | $id = intval($\_GET ['id']); |
  | 1914 |  |  |
  | 1915 |  | $query = "SELECT \* FROM " . $wpdb->prefix . "e\_portfolio WHERE id=$id"; |
  | 1916 |  |  |
  | 1917 |  | $myrow = $wpdb->get\_row ( $query ); |
  | 1918 |  |  |
  | 1919 |  | if (is\_object ( $myrow )) { |
  | 1920 |  |  |
  | 1921 |  | $media\_type =  $myrow->media\_type ; |
  | 1922 |  | $vtype =  $myrow->vtype ; |
  | 1923 |  | $title =  $myrow->title ; |
  | 1924 |  | $murl =   $myrow->murl; |
  | 1925 |  | $mtag =  $myrow->mtag ; |
  | 1926 |  | $image\_name = $myrow->image\_name; |
  | 1927 |  | $video\_url = $myrow->murl ; |
  | 1928 |  | $HdnMediaSelection = $myrow->HdnMediaSelection; |
  | 1929 |  | $videotitle = $myrow->title; |
  | 1930 |  | $videotitleurl=$myrow->videourl; |
  | 1931 |  | $open\_link\_in = $myrow->open\_link\_in; |
  | 1932 |  |  |
  | 1933 |  | } |
  | 1934 |  | ?> |
  | 1935 |  | <h2><?php echo \_\_('Update Media','responsive-filterable-portfolio');?></h2><?php |
  | 1936 |  | } |
  | 1937 |  | else { |
  | 1938 |  |  |
  | 1939 |  | $media\_type = ''; |
  |  | 1831 | ?> |
  |  | 1832 | <h2><?php echo \_\_('Update Media', 'responsive-filterable-portfolio'); ?></h2> |
  |  | 1833 | <?php |
  |  | 1834 | } else { |
  |  | 1835 |  |
  |  | 1836 | $media\_type = ''; |
  | 1940 | 1837 | $vtype = ''; |
  | 1941 | 1838 | $murl = ''; |
  | […](/browser/responsive-filterable-portfolio/tags/1.0.19/wp-best-portfolio.php?rev=2670726#L1946) | […](/browser/responsive-filterable-portfolio/tags/1.0.20/wp-best-portfolio.php?rev=2899431#L1843) |  |
  | 1946 | 1843 | $HdnMediaSelection = ''; |
  | 1947 | 1844 | $videotitle = ''; |
  | 1948 |  | $videotitleurl~~=~~''; |
  |  | 1845 | $videotitleurl = ''; |
  | 1949 | 1846 | $open\_link\_in = ''; |
  | 1950 |  |  |
  | 1951 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_add\_media' ) ) { |
  | 1952 |  |  |
  | 1953 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 1954 |  | $wp\_best\_portfolio\_msg = array (); |
  | 1955 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 1956 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator','responsive-filterable-portfolio'); |
  | 1957 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 1958 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1959 |  | exit (); |
  | 1960 |  |  |
  | 1961 |  |  |
  |  | 1847 |  |
  |  | 1848 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_add\_media')) { |
  |  | 1849 |  |
  |  | 1850 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 1851 | $wp\_best\_portfolio\_msg = array(); |
  |  | 1852 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 1853 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator', 'responsive-filterable-portfolio'); |
  |  | 1854 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 1855 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 1856 | exit(); |
  | 1962 | 1857 | } |
  | 1963 |  |  |
  | 1964 |  | ?> |
  | 1965 |  | <h2><?php echo \_\_('Add Media','responsive-filterable-portfolio');?></h2> |
  | 1966 |  | <?php } ?> |
  | 1967 |  | <br /> |
  | 1968 |  | <div id="poststuff"> |
  | 1969 |  | <div id="post-body" class="metabox-holder columns-2"> |
  | 1970 |  | <div id="post-body-content"> |
  | 1971 |  |  |
  | 1972 |  | <div class="stuffbox" id="mediatype" style="width: 100%"> |
  | 1973 |  | <h3> |
  | 1974 |  | <label for="link\_name"><?php echo \_\_('Media Type','responsive-filterable-portfolio');?> (<span |
  | 1975 |  | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Choose Media Type','responsive-filterable-portfolio');?></span>) |
  | 1976 |  | </label> |
  | 1977 |  | </h3> |
  | 1978 |  | <div class="inside"> |
  | 1979 |  | <div> |
  | 1980 |  | <input type="radio" value="image" name="media\_type\_p" <?php if($media\_type=='image'): ?> checked='checked' <?php endif;?> style="width: 15px" id="type\_image" /><?php echo \_\_('Image','responsive-filterable-portfolio');?>&nbsp;&nbsp; |
  | 1981 |  | <input type="radio" value="video" name="media\_type\_p" <?php if($media\_type=='video'): ?> checked='checked' <?php endif;?> style="width: 15px" id="type\_video" /><?php echo \_\_('Video','responsive-filterable-portfolio');?>&nbsp;&nbsp; |
  | 1982 |  | <input <?php if($media\_type=='link'): ?> checked='checked' <?php endif;?> type="radio" value="link" name="media\_type\_p" style="width: 15px" id="type\_link" /><?php echo \_\_('Link','responsive-filterable-portfolio');?>&nbsp;&nbsp; |
  | 1983 |  |  |
  | 1984 |  | </div> |
  | 1985 |  | <div style="clear: both"></div> |
  | 1986 |  | <div></div> |
  | 1987 |  | <div style="clear: both"></div> |
  | 1988 |  | <br /> |
  | 1989 |  |  |
  | 1990 |  | </div> |
  | 1991 |  |  |
  | 1992 |  | <script> |
  | 1993 |  |  |
  | 1994 |  | jQuery(document).ready(function() { |
  | 1995 |  | jQuery("input[name = 'media\_type\_p']").click(function(){ |
  | 1996 |  | var radioValue = jQuery("input[name='media\_type\_p']:checked").val(); |
  | 1997 |  | if(radioValue=='video'){ |
  | 1998 |  |  |
  | 1999 |  | jQuery("#addvideo").show(500); |
  | 2000 |  | jQuery("#addimage\_").hide(500); |
  | 2001 |  | jQuery("#addlink\_").hide(500); |
  | 2002 |  |  |
  |  | 1858 | ?> |
  |  | 1859 | <h2><?php echo \_\_('Add Media', 'responsive-filterable-portfolio'); ?></h2> |
  |  | 1860 | <?php } ?> |
  |  | 1861 | <br /> |
  |  | 1862 | <div id="poststuff"> |
  |  | 1863 | <div id="post-body" class="metabox-holder columns-2"> |
  |  | 1864 | <div id="post-body-content"> |
  |  | 1865 |  |
  |  | 1866 | <div class="stuffbox" id="mediatype" style="width: 100%"> |
  |  | 1867 | <h3> |
  |  | 1868 | <label for="link\_name"><?php echo \_\_('Media Type', 'responsive-filterable-portfolio'); ?> (<span |
  |  | 1869 | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Choose Media Type', 'responsive-filterable-portfolio'); ?></span>) |
  |  | 1870 | </label> |
  |  | 1871 | </h3> |
  |  | 1872 | <div class="inside"> |
  |  | 1873 | <div> |
  |  | 1874 | <input type="radio" value="image" name="media\_type\_p" |
  |  | 1875 | <?php |
  |  | 1876 | if ($media\_type == 'image') : |
  |  | 1877 | ?> |
  |  | 1878 | checked='checked' <?php endif; ?> style="width: 15px" id="type\_image" /><?php echo \_\_('Image', 'responsive-filterable-portfolio'); ?>&nbsp;&nbsp; |
  |  | 1879 | <input type="radio" value="video" name="media\_type\_p" |
  |  | 1880 | <?php |
  |  | 1881 | if ($media\_type == 'video') : |
  |  | 1882 | ?> |
  |  | 1883 | checked='checked' <?php endif; ?> style="width: 15px" id="type\_video" /><?php echo \_\_('Video', 'responsive-filterable-portfolio'); ?>&nbsp;&nbsp; |
  |  | 1884 | <input |
  |  | 1885 | <?php |
  |  | 1886 | if ($media\_type == 'link') : |
  |  | 1887 | ?> |
  |  | 1888 | checked='checked' <?php endif; ?> type="radio" value="link" name="media\_type\_p" style="width: 15px" id="type\_link" /><?php echo \_\_('Link', 'responsive-filterable-portfolio'); ?>&nbsp;&nbsp; |
  |  | 1889 |  |
  |  | 1890 | </div> |
  |  | 1891 | <div style="clear: both"></div> |
  |  | 1892 | <div></div> |
  |  | 1893 | <div style="clear: both"></div> |
  |  | 1894 | <br /> |
  |  | 1895 |  |
  |  | 1896 | </div> |
  |  | 1897 |  |
  |  | 1898 | <script> |
  |  | 1899 |  |
  |  | 1900 | jQuery(document).ready(function () { |
  |  | 1901 | jQuery("input[name = 'media\_type\_p']").click(function () { |
  |  | 1902 | var radioValue = jQuery("input[name='media\_type\_p']:checked").val(); |
  |  | 1903 | if (radioValue == 'video') { |
  |  | 1904 |  |
  |  | 1905 | jQuery("#addvideo").show(500); |
  |  | 1906 | jQuery("#addimage\_").hide(500); |
  |  | 1907 | jQuery("#addlink\_").hide(500); |
  |  | 1908 |  |
  |  | 1909 | } else if (radioValue == 'image') { |
  |  | 1910 |  |
  |  | 1911 | jQuery("#addvideo").hide(500); |
  |  | 1912 | jQuery("#addimage\_").show(500); |
  |  | 1913 | jQuery("#addlink\_").hide(500); |
  |  | 1914 | } else if (radioValue == 'link') { |
  |  | 1915 |  |
  |  | 1916 | jQuery("#addlink\_").show(500); |
  |  | 1917 | jQuery("#addvideo").hide(500); |
  |  | 1918 | jQuery("#addimage\_").hide(500); |
  |  | 1919 |  |
  |  | 1920 | } |
  |  | 1921 |  |
  |  | 1922 | }); |
  |  | 1923 |  |
  |  | 1924 | <?php if (isset($\_GET['id']) && (int) $\_GET['id'] > 0) : ?> |
  |  | 1925 |  |
  |  | 1926 | <?php if ($media\_type == 'video') : ?> |
  |  | 1927 | jQuery("#type\_video").trigger('click'); |
  |  | 1928 | <?php elseif ($media\_type == 'image') : ?> |
  |  | 1929 | jQuery("#type\_image").trigger('click'); |
  |  | 1930 | <?php elseif ($media\_type == 'link') : ?> |
  |  | 1931 | jQuery("#type\_link").trigger('click'); |
  |  | 1932 | <?php endif; ?> |
  |  | 1933 |  |
  |  | 1934 | <?php endif; ?> |
  |  | 1935 |  |
  |  | 1936 | }); |
  |  | 1937 |  |
  |  | 1938 |  |
  |  | 1939 | </script> |
  |  | 1940 | </div> |
  |  | 1941 | <form method="post" action="" id="addvideo" name="addvideo" enctype="multipart/form-data" style="display:none"> |
  |  | 1942 |  |
  |  | 1943 | <input type="hidden" name="media\_type" id="media\_type" value="video" /> |
  |  | 1944 | <div class="stuffbox" id="videoinfo\_div\_1" style="width: 100%;"> |
  |  | 1945 | <h3> |
  |  | 1946 | <label for="link\_name"><?php echo \_\_('Video Information', 'responsive-filterable-portfolio'); ?> (<span |
  |  | 1947 | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Choose Video Site', 'responsive-filterable-portfolio'); ?></span>) |
  |  | 1948 | </label> |
  |  | 1949 | </h3> |
  |  | 1950 | <div class="inside"> |
  |  | 1951 | <div> |
  |  | 1952 | <input type="radio" value="youtube" name="vtype" |
  |  | 1953 | <?php |
  |  | 1954 | if ($vtype == 'youtube') : |
  |  | 1955 | ?> |
  |  | 1956 | checked='checked' <?php endif; ?> style="width: 15px" id="type\_youtube" /><?php echo \_\_('Youtube', 'responsive-filterable-portfolio'); ?>&nbsp;&nbsp; |
  |  | 1957 | <input |
  |  | 1958 | <?php |
  |  | 1959 | if ($vtype == 'metacafe') : |
  |  | 1960 | ?> |
  |  | 1961 | checked='checked' <?php endif; ?> type="radio" value="metacafe" name="vtype" |
  |  | 1962 | style="width: 15px" id="type\_metacafe" /><?php echo \_\_('Metacafe', 'responsive-filterable-portfolio'); ?>&nbsp;&nbsp; |
  |  | 1963 |  |
  |  | 1964 | </div> |
  |  | 1965 | <div style="clear: both"></div> |
  |  | 1966 | <div></div> |
  |  | 1967 | <div style="clear: both"></div> |
  |  | 1968 | <br /> |
  |  | 1969 | <div> |
  |  | 1970 | <b><?php echo \_\_('Video Url', 'responsive-filterable-portfolio'); ?></b> <input style="width:98%" type="text" id="videourl" class="url" tabindex="1"  name="videourl" value="<?php echo $video\_url; ?>"> |
  |  | 1971 | </div> |
  |  | 1972 | <div style="clear: both"></div> |
  |  | 1973 | <div></div> |
  |  | 1974 | <div style="clear: both"></div> |
  |  | 1975 | <div style="clear: both"> |
  |  | 1976 | <div id="youtube\_note" style="font-size:12px;display:none"> |
  |  | 1977 | <?php echo \_\_('Please do not use youtube.be, instead of use youtube.com', 'responsive-filterable-portfolio'); ?> |
  |  | 1978 | </div> |
  |  | 1979 | </div> |
  |  | 1980 | </div> |
  |  | 1981 | </div> |
  |  | 1982 | <div class="stuffbox" id="videoinfo\_div\_2" style="width: 100%;"> |
  |  | 1983 | <h3> |
  |  | 1984 | <label for="link\_name"><?php echo \_\_('Video Thumbnail Information', 'responsive-filterable-portfolio'); ?></label> |
  |  | 1985 | </h3> |
  |  | 1986 | <div class="inside" id="fileuploaddiv"> |
  |  | 1987 | <?php if ($image\_name != '') { ?> |
  |  | 1988 | <div> |
  |  | 1989 | <b><?php echo \_\_('Current Image', 'responsive-filterable-portfolio'); ?>: </b> |
  |  | 1990 | <br/> |
  |  | 1991 | <img id="img\_disp" name="img\_disp" |
  |  | 1992 | src="<?php echo $baseurl . $image\_name; ?>" /> |
  |  | 1993 | </div> |
  |  | 1994 | <?php } else { ?> |
  |  | 1995 | <img |
  |  | 1996 | src="<?php echo plugins\_url('/images/no-img.jpeg', \_\_FILE\_\_); ?>" |
  |  | 1997 | id="img\_disp" name="img\_disp" /> |
  |  | 1998 |  |
  |  | 1999 | <?php } ?> |
  |  | 2000 | <br /> <a |
  |  | 2001 | href="javascript:;" class="niks\_media" |
  |  | 2002 | id="videoFromExternalSite"  ><b><?php echo \_\_('Click Here to get video information and thumbnail', 'responsive-filterable-portfolio'); ?><span id='fromval'> <?php echo \_\_('From', 'responsive-filterable-portfolio'); ?> <?php echo $vtype; ?></span> |
  |  | 2003 | </b></a>&nbsp;<img |
  |  | 2004 | src="<?php echo plugins\_url('/images/ajax-loader.gif', \_\_FILE\_\_); ?>" |
  |  | 2005 | style="display: none" id="loading\_img" name="loading\_img" /> |
  |  | 2006 | <div style="clear: both"></div> |
  |  | 2007 | <div></div> |
  |  | 2008 | <div class="uploader"> |
  |  | 2009 | <br /> <b style="margin-left: 50px;">OR</b> |
  |  | 2010 | <div style="clear: both; margin-top: 15px;"></div> |
  |  | 2011 |  |
  |  | 2012 | <a |
  |  | 2013 | href="javascript:;" class="niks\_media" id="myMediaUploader"><b><?php echo \_\_('Click Here to upload custom video thumbnail', 'responsive-filterable-portfolio'); ?></b></a> |
  |  | 2014 |  |
  |  | 2015 | <br /> <br /> |
  |  | 2016 | <div> |
  |  | 2017 | <input id="HdnMediaSelection" name="HdnMediaSelection" |
  |  | 2018 | type="hidden" value="<?php echo $HdnMediaSelection; ?>" /> |
  |  | 2019 | </div> |
  |  | 2020 | <div style="clear: both"></div> |
  |  | 2021 | <div></div> |
  |  | 2022 | <div style="clear: both"></div> |
  |  | 2023 |  |
  |  | 2024 | <br /> |
  |  | 2025 | </div> |
  |  | 2026 | <script> |
  |  | 2027 |  |
  |  | 2028 |  |
  |  | 2029 | function GetParameterValues(param, str) { |
  |  | 2030 | var return\_p = ''; |
  |  | 2031 | var url = str.slice(str.indexOf('?') + 1).split('&'); |
  |  | 2032 | for (var i = 0; i < url.length; i++) { |
  |  | 2033 | var urlparam = url[i].split('='); |
  |  | 2034 | if (urlparam[0] == param) { |
  |  | 2035 | return\_p = urlparam[1]; |
  |  | 2036 | } |
  |  | 2037 | } |
  |  | 2038 | return return\_p; |
  |  | 2039 | } |
  |  | 2040 |  |
  |  | 2041 |  |
  |  | 2042 |  |
  |  | 2043 | function UrlExists(url, cb) { |
  |  | 2044 | jQuery.ajax({ |
  |  | 2045 | url: url, |
  |  | 2046 | dataType: 'text', |
  |  | 2047 | type: 'GET', |
  |  | 2048 | complete: function (xhr) { |
  |  | 2049 | if (typeof cb === 'function') |
  |  | 2050 | cb.apply(this, [xhr.status]); |
  |  | 2051 | } |
  |  | 2052 | }); |
  |  | 2053 | } |
  |  | 2054 |  |
  |  | 2055 |  |
  |  | 2056 |  |
  |  | 2057 |  |
  |  | 2058 | jQuery(document).ready(function () { |
  |  | 2059 |  |
  |  | 2060 |  |
  |  | 2061 | jQuery("input:radio[name=vtype]").click(function () { |
  |  | 2062 |  |
  |  | 2063 |  |
  |  | 2064 | var value = jQuery(this).val(); |
  |  | 2065 | jQuery("#fromval").html(" from " + value); |
  |  | 2066 | if (value == "youtube") { |
  |  | 2067 |  |
  |  | 2068 | jQuery("#youtube\_note").show(); |
  |  | 2069 | } else { |
  |  | 2070 |  |
  |  | 2071 | jQuery("#youtube\_note").hide(); |
  |  | 2072 | } |
  |  | 2073 | }); |
  |  | 2074 |  |
  |  | 2075 | jQuery("#videoFromExternalSite").click(function () { |
  |  | 2076 |  |
  |  | 2077 |  |
  |  | 2078 | var videoService = jQuery('input[name="vtype"]:checked').length; |
  |  | 2079 | var videourlVal = jQuery.trim(jQuery("#videourl").val()); |
  |  | 2080 | var flag = true; |
  |  | 2081 | if (videourlVal == '' && videoService == 0) { |
  |  | 2082 |  |
  |  | 2083 | alert('Please select video site.\nPlease enter video url.'); |
  |  | 2084 | jQuery("input:radio[name=vtype]").focus(); |
  |  | 2085 | flag = false; |
  |  | 2086 |  |
  |  | 2087 | } else if (videoService == 0) { |
  |  | 2088 |  |
  |  | 2089 | alert('Please select video site.'); |
  |  | 2090 | jQuery("input:radio[name=vtype]").focus(); |
  |  | 2091 | flag = false; |
  |  | 2092 | } else if (videourlVal == '') { |
  |  | 2093 |  |
  |  | 2094 | alert('Please enter video url.'); |
  |  | 2095 | jQuery("#videourl").focus(); |
  |  | 2096 | flag = false; |
  |  | 2097 | } |
  |  | 2098 |  |
  |  | 2099 | if (flag) { |
  |  | 2100 |  |
  |  | 2101 | setTimeout(function () { |
  |  | 2102 | jQuery("#loading\_img").show(); |
  |  | 2103 | }, 100); |
  |  | 2104 |  |
  |  | 2105 | var selectedRadio = jQuery('input[name=vtype]'); |
  |  | 2106 | var checkedValueRadio = selectedRadio.filter(':checked').val(); |
  |  | 2107 | if (checkedValueRadio == 'youtube') { |
  |  | 2108 | var vId = GetParameterValues('v', videourlVal); |
  |  | 2109 | if (vId != '') { |
  |  | 2110 |  |
  |  | 2111 |  |
  |  | 2112 | var tumbnailImg = 'https://img.youtube.com/vi/' + vId + '/maxresdefault.jpg'; |
  |  | 2113 |  |
  |  | 2114 | var data = { |
  |  | 2115 | 'action': 'rfp\_check\_file\_exist\_portfolio', |
  |  | 2116 | 'url': tumbnailImg, |
  |  | 2117 | 'vNonce': '<?php echo $vNonce; ?>' |
  |  | 2118 | }; |
  |  | 2119 |  |
  |  | 2120 | jQuery.post(ajaxurl, data, function (response) { |
  |  | 2121 |  |
  |  | 2122 |  |
  |  | 2123 |  |
  |  | 2124 | var youtubeJsonUri = 'https://www.youtube.com/oembed?url=https://www.youtube.com/watch%3Fv=' + vId + '&format=json'; |
  |  | 2125 | var data\_youtube = { |
  |  | 2126 | 'action': 'rfp\_get\_youtube\_info\_portfolio', |
  |  | 2127 | 'url': youtubeJsonUri, |
  |  | 2128 | 'vid': vId, |
  |  | 2129 | 'vNonce': '<?php echo $vNonce; ?>' |
  |  | 2130 | }; |
  |  | 2131 |  |
  |  | 2132 | jQuery.post(ajaxurl, data\_youtube, function (data) { |
  |  | 2133 |  |
  |  | 2134 | data = jQuery.parseJSON(data); |
  |  | 2135 |  |
  |  | 2136 | if (typeof data == 'object') { |
  |  | 2137 | if (typeof data == 'object') { |
  |  | 2138 |  |
  |  | 2139 | if (data.title != '' && data.title != '') { |
  |  | 2140 | jQuery("#title").val(data.title); |
  |  | 2141 | } |
  |  | 2142 | jQuery("#murl").val(videourlVal); |
  |  | 2143 |  |
  |  | 2144 | if (response == '404' && data.thumbnail\_url != '') { |
  |  | 2145 | tumbnailImg = data.thumbnail\_url; |
  |  | 2146 | } else { |
  |  | 2147 | tumbnailImg = 'https://img.youtube.com/vi/' + vId + '/0.jpg'; |
  |  | 2148 | } |
  |  | 2149 |  |
  |  | 2150 | jQuery("#img\_disp").attr('src', tumbnailImg); |
  |  | 2151 | jQuery("#HdnMediaSelection").val(tumbnailImg); |
  |  | 2152 | jQuery("#loading\_img").hide(); |
  |  | 2153 |  |
  |  | 2154 | } |
  |  | 2155 |  |
  | 2003 | 2156 | } |
  | 2004 |  | else if(radioValue=='image'){ |
  | 2005 |  |  |
  | 2006 |  | jQuery("#addvideo").hide(500); |
  | 2007 |  | jQuery("#addimage\_").show(500); |
  | 2008 |  | jQuery("#addlink\_").hide(500); |
  | 2009 |  | } |
  | 2010 |  | else if(radioValue=='link'){ |
  | 2011 |  |  |
  | 2012 |  | jQuery("#addlink\_").show(500); |
  | 2013 |  | jQuery("#addvideo").hide(500); |
  | 2014 |  | jQuery("#addimage\_").hide(500); |
  | 2015 |  |  |
  | 2016 |  | } |
  | 2017 |  |  |
  | 2018 |  | }); |
  | 2019 |  |  |
  | 2020 |  | <?php if(isset($\_GET['id']) and (int) $\_GET['id']>0):?> |
  | 2021 |  |  |
  | 2022 |  | <?php if($media\_type=='video') :?> |
  | 2023 |  | jQuery("#type\_video").trigger('click'); |
  | 2024 |  | <?php elseif($media\_type=='image'):?> |
  | 2025 |  | jQuery("#type\_image").trigger('click'); |
  | 2026 |  | <?php elseif($media\_type=='link'):?> |
  | 2027 |  | jQuery("#type\_link").trigger('click'); |
  | 2028 |  | <?php endif;?> |
  | 2029 |  |  |
  | 2030 |  | <?php endif;?> |
  | 2031 |  |  |
  | 2032 |  | }); |
  | 2033 |  |  |
  | 2034 |  |  |
  | 2035 |  | </script> |
  | 2036 |  | </div> |
  | 2037 |  | <form method="post" action="" id="addvideo" name="addvideo" enctype="multipart/form-data" style="display:none"> |
  | 2038 |  |  |
  | 2039 |  | <input type="hidden" name="media\_type" id="media\_type" value="video" /> |
  | 2040 |  | <div class="stuffbox" id="videoinfo\_div\_1" style="width: 100%;"> |
  | 2041 |  | <h3> |
  | 2042 |  | <label for="link\_name"><?php echo \_\_('Video Information','responsive-filterable-portfolio');?> (<span |
  | 2043 |  | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Choose Video Site','responsive-filterable-portfolio');?></span>) |
  | 2044 |  | </label> |
  | 2045 |  | </h3> |
  | 2046 |  | <div class="inside"> |
  | 2047 |  | <div> |
  | 2048 |  | <input type="radio" value="youtube" name="vtype" |
  | 2049 |  | <?php if($vtype=='youtube'): ?> checked='checked' <?php endif;?> style="width: 15px" id="type\_youtube" /><?php echo \_\_('Youtube','responsive-filterable-portfolio');?>&nbsp;&nbsp; |
  | 2050 |  | <input <?php if($vtype=='metacafe'): ?> checked='checked' <?php endif;?> type="radio" value="metacafe" name="vtype" |
  | 2051 |  | style="width: 15px" id="type\_metacafe" /><?php echo \_\_('Metacafe','responsive-filterable-portfolio');?>&nbsp;&nbsp; |
  | 2052 |  |  |
  | 2053 |  | </div> |
  | 2054 |  | <div style="clear: both"></div> |
  | 2055 |  | <div></div> |
  | 2056 |  | <div style="clear: both"></div> |
  | 2057 |  | <br /> |
  | 2058 |  | <div> |
  | 2059 |  | <b><?php echo \_\_('Video Url','responsive-filterable-portfolio');?></b> <input style="width:98%" type="text" id="videourl" class="url" tabindex="1"  name="videourl" value="<?php echo $video\_url; ?>"> |
  | 2060 |  | </div> |
  | 2061 |  | <div style="clear: both"></div> |
  | 2062 |  | <div></div> |
  | 2063 |  | <div style="clear: both"></div> |
  | 2064 |  | <div style="clear: both"> |
  | 2065 |  | <div id="youtube\_note" style="font-size:12px;display:none"> |
  | 2066 |  | <?php echo \_\_('Please do not use youtube.be, instead of use youtube.com','responsive-filterable-portfolio');?> |
  | 2067 |  | </div> |
  | 2068 |  | </div> |
  | 2069 |  | </div> |
  | 2070 |  | </div> |
  | 2071 |  | <div class="stuffbox" id="videoinfo\_div\_2" style="width: 100%;"> |
  | 2072 |  | <h3> |
  | 2073 |  | <label for="link\_name"><?php echo \_\_('Video Thumbnail Information','responsive-filterable-portfolio');?></label> |
  | 2074 |  | </h3> |
  | 2075 |  | <div class="inside" id="fileuploaddiv"> |
  | 2076 |  | <?php if ($image\_name != "") { ?> |
  | 2077 |  | <div> |
  | 2078 |  | <b><?php echo \_\_('Current Image','responsive-filterable-portfolio');?>: </b> |
  | 2079 |  | <br/> |
  | 2080 |  | <img id="img\_disp" name="img\_disp" |
  | 2081 |  | src="<?php echo $baseurl . $image\_name; ?>" /> |
  | 2082 |  | </div> |
  | 2083 |  | <?php }else{ ?> |
  | 2084 |  | <img |
  | 2085 |  | src="<?php echo plugins\_url('/images/no-img.jpeg', \_\_FILE\_\_); ?>" |
  | 2086 |  | id="img\_disp" name="img\_disp" /> |
  | 2087 |  |  |
  | 2088 |  | <?php } ?> |
  | 2089 |  | <br /> <a |
  | 2090 |  | href="javascript:;" class="niks\_media" |
  | 2091 |  | id="videoFromExternalSite"  ><b><?php echo \_\_('Click Here to get video information and thumbnail','responsive-filterable-portfolio');?><span id='fromval'> <?php echo \_\_('From','responsive-filterable-portfolio');?> <?php echo $vtype;?></span> |
  | 2092 |  | </b></a>&nbsp;<img |
  | 2093 |  | src="<?php echo plugins\_url('/images/ajax-loader.gif', \_\_FILE\_\_); ?>" |
  | 2094 |  | style="display: none" id="loading\_img" name="loading\_img" /> |
  | 2095 |  | <div style="clear: both"></div> |
  | 2096 |  | <div></div> |
  | 2097 |  | <div class="uploader"> |
  | 2098 |  | <br /> <b style="margin-left: 50px;">OR</b> |
  | 2099 |  | <div style="clear: both; margin-top: 15px;"></div> |
  | 2100 |  |  |
  | 2101 |  | <a |
  | 2102 |  | href="javascript:;" class="niks\_media" id="myMediaUploader"><b><?php echo \_\_('Click Here to upload custom video thumbnail','responsive-filterable-portfolio');?></b></a> |
  | 2103 |  |  |
  | 2104 |  | <br /> <br /> |
  | 2105 |  | <div> |
  | 2106 |  | <input id="HdnMediaSelection" name="HdnMediaSelection" |
  | 2107 |  | type="hidden" value="<?php echo $HdnMediaSelection;?>" /> |
  | 2108 |  | </div> |
  | 2109 |  | <div style="clear: both"></div> |
  | 2110 |  | <div></div> |
  | 2111 |  | <div style="clear: both"></div> |
  | 2112 |  |  |
  | 2113 |  | <br /> |
  | 2114 |  | </div> |
  | 2115 |  | <script> |
  | 2116 |  |  |
  | 2117 |  |  |
  | 2118 |  | function GetParameterValues(param,str) { |
  | 2119 |  | var return\_p=''; |
  | 2120 |  | var url = str.slice(str.indexOf('?') + 1).split('&'); |
  | 2121 |  | for (var i = 0; i < url.length; i++) { |
  | 2122 |  | var urlparam = url[i].split('='); |
  | 2123 |  | if (urlparam[0] == param) { |
  | 2124 |  | return\_p= urlparam[1]; |
  | 2125 |  | } |
  | 2126 |  | } |
  | 2127 |  | return return\_p; |
  | 2128 |  | } |
  | 2129 |  |  |
  | 2130 |  |  |
  | 2131 |  |  |
  | 2132 |  | function UrlExists(url, cb){ |
  | 2133 |  | jQuery.ajax({ |
  | 2134 |  | url:      url, |
  | 2135 |  | dataType: 'text', |
  | 2136 |  | type:     'GET', |
  | 2137 |  | complete:  function(xhr){ |
  | 2138 |  | if(typeof cb === 'function') |
  | 2139 |  | cb.apply(this, [xhr.status]); |
  | 2140 |  | } |
  | 2141 |  | }); |
  | 2142 |  | } |
  | 2143 |  |  |
  | 2144 |  |  |
  | 2145 |  |  |
  | 2146 |  |  |
  | 2147 |  | jQuery(document).ready(function() { |
  | 2148 |  |  |
  | 2149 |  |  |
  | 2150 |  | jQuery("input:radio[name=vtype]").click(function() { |
  | 2151 |  |  |
  | 2152 |  |  |
  | 2153 |  | var value = jQuery(this).val(); |
  | 2154 |  | jQuery("#fromval").html(" from " + value); |
  | 2155 |  | if(value=="youtube"){ |
  | 2156 |  |  |
  | 2157 |  | jQuery("#youtube\_note").show(); |
  | 2158 |  | } |
  | 2159 |  | else{ |
  | 2160 |  |  |
  | 2161 |  | jQuery("#youtube\_note").hide(); |
  | 2162 |  | } |
  | 2163 |  | }); |
  | 2164 |  |  |
  | 2165 |  | jQuery("#videoFromExternalSite").click(function() { |
  | 2166 |  |  |
  | 2167 |  |  |
  | 2168 |  | var videoService = jQuery('input[name="vtype"]:checked').length; |
  | 2169 |  | var videourlVal = jQuery.trim(jQuery("#videourl").val()); |
  | 2170 |  | var flag = true; |
  | 2171 |  | if (videourlVal == '' && videoService == 0){ |
  | 2172 |  |  |
  | 2173 |  | alert('Please select video site.\nPlease enter video url.'); |
  | 2174 |  | jQuery("input:radio[name=vtype]").focus(); |
  | 2175 |  | flag = false; |
  | 2176 |  |  |
  | 2177 |  | } |
  | 2178 |  | else if (videoService == 0){ |
  | 2179 |  |  |
  | 2180 |  | alert('Please select video site.'); |
  | 2181 |  | jQuery("input:radio[name=vtype]").focus(); |
  | 2182 |  | flag = false; |
  | 2183 |  | } |
  | 2184 |  | else if (videourlVal == ''){ |
  | 2185 |  |  |
  | 2186 |  | alert('Please enter video url.'); |
  | 2187 |  | jQuery("#videourl").focus(); |
  | 2188 |  | flag = false; |
  | 2189 |  | } |
  | 2190 |  |  |
  | 2191 |  | if (flag){ |
  | 2192 |  |  |
  | 2193 |  | setTimeout(function() { |
  | 2194 |  | jQuery("#loading\_img").show(); |
  | 2195 |  | }, 100); |
  | 2196 |  |  |
  | 2197 |  | var selectedRadio = jQuery('input[name=vtype]'); |
  | 2198 |  | var checkedValueRadio = selectedRadio.filter(':checked').val(); |
  | 2199 |  | if (checkedValueRadio == 'youtube') { |
  | 2200 |  | var vId = GetParameterValues('v', videourlVal); |
  | 2201 |  | if(vId!=''){ |
  | 2202 |  |  |
  | 2203 |  |  |
  | 2204 |  | var tumbnailImg='https://img.youtube.com/vi/'+vId+'/maxresdefault.jpg'; |
  | 2205 |  |  |
  | 2206 |  | var data = { |
  | 2207 |  | 'action': 'rfp\_check\_file\_exist\_portfolio', |
  | 2208 |  | 'url': tumbnailImg, |
  | 2209 |  | 'vNonce':'<?php echo $vNonce; ?>' |
  | 2210 |  | }; |
  | 2211 |  |  |
  | 2212 |  | jQuery.post(ajaxurl, data, function(response) { |
  | 2213 |  |  |
  | 2214 |  |  |
  | 2215 |  |  |
  | 2216 |  | var youtubeJsonUri='https://www.youtube.com/oembed?url=https://www.youtube.com/watch%3Fv='+vId+'&format=json'; |
  | 2217 |  | var data\_youtube = { |
  | 2218 |  | 'action': 'rfp\_get\_youtube\_info\_portfolio', |
  | 2219 |  | 'url': youtubeJsonUri, |
  | 2220 |  | 'vid':vId, |
  | 2221 |  | 'vNonce':'<?php echo $vNonce; ?>' |
  | 2222 |  | }; |
  | 2223 |  |  |
  | 2224 |  | jQuery.post(ajaxurl, data\_youtube, function(data) { |
  | 2225 |  |  |
  | 2226 |  | data = jQuery.parseJSON(data); |
  | 2227 |  |  |
  | 2228 |  | if(typeof data =='object'){ |
  | 2229 |  | if(typeof data =='object'){ |
  | 2230 |  |  |
  | 2231 |  | if(data.title!='' && data.title!=''){ |
  | 2232 |  | jQuery("#title").val(data.title); |
  | 2233 |  | } |
  | 2234 |  | jQuery("#murl").val(videourlVal); |
  | 2235 |  |  |
  | 2236 |  | if(response=='404' && data.thumbnail\_url!=''){ |
  | 2237 |  | tumbnailImg=data.thumbnail\_url; |
  | 2238 |  | } |
  | 2239 |  | else{ |
  | 2240 |  | tumbnailImg='https://img.youtube.com/vi/'+vId+'/0.jpg'; |
  | 2241 |  | } |
  | 2242 |  |  |
  | 2243 |  | jQuery("#img\_disp").attr('src', tumbnailImg); |
  | 2244 |  | jQuery("#HdnMediaSelection").val(tumbnailImg); |
  | 2245 |  | jQuery("#loading\_img").hide(); |
  | 2246 |  |  |
  | 2247 |  | } |
  | 2248 |  |  |
  | 2249 |  | } |
  | 2250 |  | jQuery("#loading\_img").hide(); |
  | 2251 |  | }) |
  | 2252 |  |  |
  | 2253 |  |  |
  | 2254 |  | }); |
  | 2255 |  |  |
  | 2256 |  | } |
  | 2257 |  | else{ |
  | 2258 |  | alert('Could not found such video'); |
  | 2259 |  | jQuery("#loading\_img").hide(); |
  | 2260 |  | } |
  | 2261 |  | } |
  | 2262 |  |  |
  | 2263 |  | else if(checkedValueRadio == 'metacafe'){ |
  | 2264 |  |  |
  | 2265 |  | jQuery("#loading\_img").show(); |
  | 2266 |  | var data = { |
  | 2267 |  | 'action': 'rfp\_get\_metacafe\_info\_portfolio', |
  | 2268 |  | 'url': videourlVal, |
  | 2269 |  | 'vNonce':'<?php echo $vNonce; ?>' |
  | 2270 |  | }; |
  | 2271 |  |  |
  | 2272 |  | jQuery.post(ajaxurl, data,function(response) { |
  | 2273 |  |  |
  | 2274 |  | obj = jQuery.parseJSON(response); |
  | 2275 |  | jQuery("#HdnMediaSelection").val(obj.HdnMediaSelection); |
  | 2276 |  | jQuery("#title").val(jQuery.trim(obj.videotitle)); |
  | 2277 |  | jQuery("#murl").val(obj.videotitleurl); |
  | 2278 |  | jQuery("#img\_disp").attr('src', obj.HdnMediaSelection); |
  | 2279 |  | jQuery("#loading\_img").hide(); |
  | 2280 |  | }); |
  | 2281 |  |  |
  | 2282 |  |  |
  | 2283 |  | } |
  | 2284 |  |  |
  | 2285 |  |  |
  | 2286 |  | jQuery("#loading\_img").hide(); |
  | 2287 |  | } |
  | 2288 |  |  |
  | 2289 |  | setTimeout(function() { |
  | 2290 |  | jQuery("#loading\_img").hide(); |
  | 2291 |  | }, 2000); |
  | 2292 |  |  |
  | 2293 |  | }); |
  | 2294 |  | //uploading files variable |
  | 2295 |  | var custom\_file\_frame; |
  | 2296 |  | jQuery("#myMediaUploader").click(function(event) { |
  | 2297 |  | event.preventDefault(); |
  | 2298 |  | //If the frame already exists, reopen it |
  | 2299 |  | if (typeof (custom\_file\_frame) !== "undefined") { |
  | 2300 |  | custom\_file\_frame.close(); |
  | 2301 |  | } |
  | 2302 |  |  |
  | 2303 |  | //Create WP media frame. |
  | 2304 |  | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
  | 2305 |  | //Title of media manager frame |
  | 2306 |  | title: "WP Media Uploader", |
  | 2307 |  | library: { |
  | 2308 |  | type: 'image' |
  | 2309 |  | }, |
  | 2310 |  | button: { |
  | 2311 |  | //Button text |
  | 2312 |  | text: "Set Image" |
  | 2313 |  | }, |
  | 2314 |  | //Do not allow multiple files, if you want multiple, set true |
  | 2315 |  | multiple: false |
  | 2316 |  | }); |
  | 2317 |  | //callback for selected image |
  | 2318 |  | custom\_file\_frame.on('select', function() { |
  | 2319 |  |  |
  | 2320 |  | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
  | 2321 |  | var validExtensions = new Array(); |
  | 2322 |  | validExtensions[0] = 'jpg'; |
  | 2323 |  | validExtensions[1] = 'jpeg'; |
  | 2324 |  | validExtensions[2] = 'png'; |
  | 2325 |  | validExtensions[3] = 'gif'; |
  | 2326 |  |  |
  | 2327 |  | var inarr = parseInt(jQuery.inArray(attachment.subtype, validExtensions)); |
  | 2328 |  | if (inarr > 0 && attachment.type.toLowerCase() == 'image'){ |
  | 2329 |  |  |
  | 2330 |  | var titleTouse = ""; |
  | 2331 |  |  |
  | 2332 |  | if (jQuery.trim(attachment.title) != ''){ |
  | 2333 |  |  |
  | 2334 |  | titleTouse = jQuery.trim(attachment.title); |
  | 2335 |  | } |
  | 2336 |  | else if (jQuery.trim(attachment.caption) != ''){ |
  | 2337 |  |  |
  | 2338 |  | titleTouse = jQuery.trim(attachment.caption); |
  | 2339 |  | } |
  | 2340 |  |  |
  | 2341 |  |  |
  | 2342 |  | // jQuery("#videotitle").val(titleTouse); |
  | 2343 |  |  |
  | 2344 |  | if (attachment.id != ''){ |
  | 2345 |  |  |
  | 2346 |  | jQuery("#HdnMediaSelection").val(attachment.url); |
  | 2347 |  | jQuery("#img\_disp").attr('src', attachment.url); |
  | 2348 |  |  |
  | 2349 |  | } |
  | 2350 |  |  |
  | 2351 |  | } |
  | 2352 |  | else{ |
  | 2353 |  |  |
  | 2354 |  | alert('Invalid image selection.'); |
  | 2355 |  | } |
  | 2356 |  | //do something with attachment variable, for example attachment.filename |
  | 2357 |  | //Object: |
  | 2358 |  | //attachment.alt - image alt |
  | 2359 |  | //attachment.author - author id |
  | 2360 |  | //attachment.caption |
  | 2361 |  | //attachment.dateFormatted - date of image uploaded |
  | 2362 |  | //attachment.description |
  | 2363 |  | //attachment.editLink - edit link of media |
  | 2364 |  | //attachment.filename |
  | 2365 |  | //attachment.height |
  | 2366 |  | //attachment.icon - don't know WTF?)) |
  | 2367 |  | //attachment.id - id of attachment |
  | 2368 |  | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
  | 2369 |  | //attachment.menuOrder |
  | 2370 |  | //attachment.mime - mime type, for example image/jpeg" |
  | 2371 |  | //attachment.name - name of attachment file, for example "my-image" |
  | 2372 |  | //attachment.status - usual is "inherit" |
  | 2373 |  | //attachment.subtype - "jpeg" if is "jpg" |
  | 2374 |  | //attachment.title |
  | 2375 |  | //attachment.type - "image" |
  | 2376 |  | //attachment.uploadedTo |
  | 2377 |  | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
  | 2378 |  | //attachment.width |
  | 2379 |  | }); |
  | 2380 |  | //Open modal |
  | 2381 |  | custom\_file\_frame.open(); |
  | 2382 |  | }); |
  | 2383 |  | }) |
  | 2384 |  | </script> |
  | 2385 |  | </div> |
  | 2386 |  | </div> |
  | 2387 |  | <div class="stuffbox" id="namediv" style="width: 100%"> |
  | 2388 |  | <h3> |
  | 2389 |  | <label for="link\_name">Video Title (<span |
  | 2390 |  | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Used into lightbox','responsive-filterable-portfolio');?></span>) |
  | 2391 |  | </label> |
  | 2392 |  | </h3> |
  | 2393 |  | <div class="inside"> |
  | 2394 |  | <div> |
  | 2395 |  | <input type="text" id="title" tabindex="1" size="30" name="title" value="<?php echo $videotitle; ?>"> |
  | 2396 |  | </div> |
  | 2397 |  | <div style="clear: both"></div> |
  | 2398 |  | <div></div> |
  | 2399 |  | <div style="clear: both"></div> |
  | 2400 |  | </div> |
  | 2401 |  | </div> |
  | 2402 |  | <div class="stuffbox" id="namediv" style="width: 100%"> |
  | 2403 |  | <h3> |
  | 2404 |  | <label for="link\_name"><?php echo \_\_('Video Title Url','responsive-filterable-portfolio');?> (<span |
  | 2405 |  | style="font-size: 11px; font-weight: normal"><?php \_e(' click on title redirect to this url.Used in lightbox for video title'); ?></span>) |
  | 2406 |  | </label> |
  | 2407 |  | </h3> |
  | 2408 |  | <div class="inside"> |
  | 2409 |  | <div> |
  | 2410 |  | <input type="text" id="murl" |
  | 2411 |  | tabindex="1" size="30" name="murl" |
  | 2412 |  | value="<?php echo $videotitleurl; ?>"> |
  | 2413 |  | </div> |
  | 2414 |  | <div style="clear: both"></div> |
  | 2415 |  | <div></div> |
  | 2416 |  | <div style="clear: both"></div> |
  | 2417 |  |  |
  | 2418 |  | </div> |
  | 2419 |  | </div> |
  | 2420 |  | <div class="stuffbox" id="namediv" style="width: 100%"> |
  | 2421 |  | <h3> |
  | 2422 |  | <label for="mtag"><?php echo \_\_('Media Tags','responsive-filterable-portfolio');?> (<span |
  | 2423 |  | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Tags used for filter on grid.You can add comma separated values.','responsive-filterable-portfolio');?></span>) |
  | 2424 |  | </label> |
  | 2425 |  | </h3> |
  | 2426 |  | <div class="inside"> |
  | 2427 |  | <div> |
  | 2428 |  | <input type="text" id="mtag" |
  | 2429 |  | tabindex="1" size="30" name="mtag" |
  | 2430 |  | value="<?php echo $mtag; ?>"> |
  | 2431 |  | </div> |
  | 2432 |  | <div style="clear: both"></div> |
  | 2433 |  | <div></div> |
  | 2434 |  | <div style="clear: both"></div> |
  | 2435 |  |  |
  | 2436 |  | </div> |
  | 2437 |  | </div> |
  | 2438 |  | <div class="stuffbox" id="namediv" style="width: 100%"> |
  | 2439 |  | <h3> |
  | 2440 |  | <label><?php echo \_\_('Play Video In Lightbox?','responsive-filterable-portfolio');?> (<span |
  | 2441 |  | style="font-size: 11px; font-weight: normal"><?php echo \_\_('show video in lightbox or redirect?','responsive-filterable-portfolio');?></span>) |
  | 2442 |  | </label> |
  | 2443 |  | </h3> |
  | 2444 |  | <div class="inside"> |
  | 2445 |  | <table> |
  | 2446 |  | <tr> |
  | 2447 |  | <td> |
  | 2448 |  | <div> |
  | 2449 |  | <input type="checkbox" id="open\_link\_in" size="30" |
  | 2450 |  | name="open\_link\_in" value="" |
  | 2451 |  | <?php |
  | 2452 |  | if ($open\_link\_in == true) { |
  | 2453 |  | echo "checked='checked'"; |
  | 2454 |  | } |
  | 2455 |  | ?> |
  | 2456 |  | style="width: 20px;">&nbsp;<?php echo \_\_('Show Video In Lightbox?','responsive-filterable-portfolio');?> |
  | 2457 |  | </div> |
  | 2458 |  | <div style="clear: both"></div> |
  | 2459 |  | <div></div> |
  | 2460 |  | </td> |
  | 2461 |  | </tr> |
  | 2462 |  | </table> |
  | 2463 |  | <div style="clear: both"></div> |
  | 2464 |  | </div> |
  | 2465 |  | </div> |
  | 2466 |  |  |
  | 2467 |  |  |
  | 2468 |  | <?php if (isset($\_GET['id']) and (int) $\_GET['id'] > 0) { ?> |
  | 2469 |  | <input type="hidden" name="videoid" id="videoid" value="<?php echo (int) $\_GET['id']; ?>"> |
  | 2470 |  | <?php |
  | 2471 |  | } |
  | 2472 |  | ?> |
  | 2473 |  | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
  | 2474 |  | <input type="submit" |
  | 2475 |  | onclick="" name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes','responsive-filterable-portfolio');?>" |
  | 2476 |  | class="button-primary">&nbsp;&nbsp;<input type="button" |
  | 2477 |  | name="cancle" id="cancle" value="<?php echo \_\_('Cancel','responsive-filterable-portfolio');?>" |
  | 2478 |  | class="button-primary" |
  | 2479 |  | onclick="location.href = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'"> |
  | 2480 |  |  |
  | 2481 |  | </form> |
  | 2482 |  | <form method="post" action="" id="addimage\_" name="addimage\_" enctype="multipart/form-data" style="display:none"> |
  | 2483 |  |  |
  | 2484 |  | <input type="hidden" name="media\_type" id="media\_type" value="image" /> |
  | 2485 |  | <div class="stuffbox" id="image\_info" style="width: 100%;"> |
  | 2486 |  | <h3> |
  | 2487 |  | <label for="link\_name"><?php echo \_\_('Image Information','responsive-filterable-portfolio');?></label> |
  | 2488 |  | </h3> |
  | 2489 |  | <div class="inside" id="fileuploaddiv"> |
  | 2490 |  | <?php if ($image\_name != "") { ?> |
  | 2491 |  | <div> |
  | 2492 |  | <b><?php echo \_\_('Current Image','responsive-filterable-portfolio');?>: </b> |
  | 2493 |  | <br/> |
  | 2494 |  | <img id="img\_disp\_img" name="img\_disp\_img" |
  | 2495 |  | src="<?php echo $baseurl . $image\_name; ?>" /> |
  | 2496 |  | </div> |
  | 2497 |  | <?php }else{ ?> |
  | 2498 |  | <img |
  | 2499 |  | src="<?php echo plugins\_url('/images/no-image-selected.png', \_\_FILE\_\_); ?>" |
  | 2500 |  | id="img\_disp\_img" name="img\_disp\_img" /> |
  | 2501 |  |  |
  | 2502 |  | <?php } ?> |
  | 2503 |  | <img |
  | 2504 |  | src="<?php echo plugins\_url('/images/ajax-loader.gif', \_\_FILE\_\_); ?>" |
  | 2505 |  | style="display: none" id="loading\_img" name="loading\_img" /> |
  | 2506 |  | <div style="clear: both"></div> |
  | 2507 |  | <div></div> |
  | 2508 |  | <div class="uploader"> |
  | 2509 |  |  |
  | 2510 |  | <div style="clear: both; margin-top: 15px;"></div> |
  | 2511 |  | <a |
  | 2512 |  | href="javascript:;" class="niks\_media" id="myMediaUploader\_image"><b><?php echo \_\_('Click Here to upload Image','responsive-filterable-portfolio');?></b></a> |
  | 2513 |  | <br /> <br /> |
  | 2514 |  | <div> |
  | 2515 |  | <input id="HdnMediaSelection\_image" name="HdnMediaSelection\_image" type="hidden" value="<?php echo $HdnMediaSelection;?>" /> |
  | 2516 |  | </div> |
  | 2517 |  | <div style="clear: both"></div> |
  | 2518 |  | <div></div> |
  | 2519 |  | <div style="clear: both"></div> |
  | 2520 |  |  |
  | 2521 |  | <br /> |
  | 2522 |  | </div> |
  | 2523 |  | </div> |
  | 2524 |  |  |
  | 2525 |  | <script> |
  | 2526 |  | //uploading files variable |
  | 2527 |  | var custom\_file\_frame; |
  | 2528 |  | jQuery("#myMediaUploader\_image").click(function(event) { |
  | 2529 |  | event.preventDefault(); |
  | 2530 |  | //If the frame already exists, reopen it |
  | 2531 |  | if (typeof (custom\_file\_frame) !== "undefined") { |
  | 2532 |  | custom\_file\_frame.close(); |
  | 2533 |  | } |
  | 2534 |  |  |
  | 2535 |  | //Create WP media frame. |
  | 2536 |  | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
  | 2537 |  | //Title of media manager frame |
  | 2538 |  | title: "WP Media Uploader", |
  | 2539 |  | library: { |
  | 2540 |  | type: 'image' |
  | 2541 |  | }, |
  | 2542 |  | button: { |
  | 2543 |  | //Button text |
  | 2544 |  | text: "Set Image" |
  | 2545 |  | }, |
  | 2546 |  | //Do not allow multiple files, if you want multiple, set true |
  | 2547 |  | multiple: false |
  | 2548 |  | }); |
  | 2549 |  | //callback for selected image |
  | 2550 |  | custom\_file\_frame.on('select', function() { |
  | 2551 |  |  |
  | 2552 |  | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
  | 2553 |  | var validExtensions = new Array(); |
  | 2554 |  | validExtensions[0] = 'jpg'; |
  | 2555 |  | validExtensions[1] = 'jpeg'; |
  | 2556 |  | validExtensions[2] = 'png'; |
  | 2557 |  | validExtensions[3] = 'gif'; |
  | 2558 |  |  |
  | 2559 |  | var inarr = parseInt(jQuery.inArray(attachment.subtype, validExtensions)); |
  | 2560 |  | if (inarr > 0 && attachment.type.toLowerCase() == 'image'){ |
  | 2561 |  |  |
  | 2562 |  | var titleTouse = ""; |
  | 2563 |  |  |
  | 2564 |  | if (jQuery.trim(attachment.title) != ''){ |
  | 2565 |  |  |
  | 2566 |  | titleTouse = jQuery.trim(attachment.title); |
  | 2567 |  | } |
  | 2568 |  | else if (jQuery.trim(attachment.caption) != ''){ |
  | 2569 |  |  |
  | 2570 |  | titleTouse = jQuery.trim(attachment.caption); |
  | 2571 |  | } |
  | 2572 |  |  |
  | 2573 |  |  |
  | 2574 |  |  |
  | 2575 |  | jQuery("#addimage\_ #title").val(titleTouse); |
  | 2576 |  |  |
  | 2577 |  |  |
  | 2578 |  | if (attachment.id != ''){ |
  | 2579 |  |  |
  | 2580 |  | jQuery("#HdnMediaSelection\_image").val(attachment.url); |
  | 2581 |  | jQuery("#img\_disp\_img").attr('src', attachment.url); |
  | 2582 |  |  |
  | 2583 |  | } |
  | 2584 |  |  |
  | 2585 |  | } |
  | 2586 |  | else{ |
  | 2587 |  |  |
  | 2588 |  | alert('Invalid image selection.'); |
  | 2589 |  | } |
  | 2590 |  | //do something with attachment variable, for example attachment.filename |
  | 2591 |  | //Object: |
  | 2592 |  | //attachment.alt - image alt |
  | 2593 |  | //attachment.author - author id |
  | 2594 |  | //attachment.caption |
  | 2595 |  | //attachment.dateFormatted - date of image uploaded |
  | 2596 |  | //attachment.description |
  | 2597 |  | //attachment.editLink - edit link of media |
  | 2598 |  | //attachment.filename |
  | 2599 |  | //attachment.height |
  | 2600 |  | //attachment.icon - don't know WTF?)) |
  | 2601 |  | //attachment.id - id of attachment |
  | 2602 |  | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
  | 2603 |  | //attachment.menuOrder |
  | 2604 |  | //attachment.mime - mime type, for example image/jpeg" |
  | 2605 |  | //attachment.name - name of attachment file, for example "my-image" |
  | 2606 |  | //attachment.status - usual is "inherit" |
  | 2607 |  | //attachment.subtype - "jpeg" if is "jpg" |
  | 2608 |  | //attachment.title |
  | 2609 |  | //attachment.type - "image" |
  | 2610 |  | //attachment.uploadedTo |
  | 2611 |  | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
  | 2612 |  | //attachment.width |
  | 2613 |  | }); |
  | 2614 |  | //Open modal |
  | 2615 |  | custom\_file\_frame.open(); |
  | 2616 |  | }); |
  | 2617 |  |  |
  | 2618 |  | </script> |
  | 2619 |  | </div> |
  | 2620 |  |  |
  | 2621 |  | <div class="stuffbox" id="namediv" style="width: 100%"> |
  | 2622 |  | <h3> |
  | 2623 |  | <label for="link\_name"><?php echo \_\_('Image Title','responsive-filterable-portfolio');?> (<span |
  | 2624 |  | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Used into lightbox','responsive-filterable-portfolio');?></span>) |
  | 2625 |  | </label> |
  | 2626 |  | </h3> |
  | 2627 |  | <div class="inside"> |
  | 2628 |  | <div> |
  | 2629 |  | <input type="text" id="title" tabindex="1" size="30" name="title" value="<?php echo $videotitle; ?>"> |
  | 2630 |  | </div> |
  | 2631 |  | <div style="clear: both"></div> |
  | 2632 |  | <div></div> |
  | 2633 |  | <div style="clear: both"></div> |
  | 2634 |  | </div> |
  | 2635 |  | </div> |
  | 2636 |  | <div class="stuffbox" id="namediv" style="width: 100%"> |
  | 2637 |  | <h3> |
  | 2638 |  | <label for="link\_name"><?php echo \_\_('Image Title Url','responsive-filterable-portfolio');?> (<span |
  | 2639 |  | style="font-size: 11px; font-weight: normal"><?php echo \_\_('click on title redirect to this url.Used in lightbox for image title','responsive-filterable-portfolio');?></span>) |
  | 2640 |  | </label> |
  | 2641 |  | </h3> |
  | 2642 |  | <div class="inside"> |
  | 2643 |  | <div> |
  | 2644 |  | <input type="text" id="murl" |
  | 2645 |  | tabindex="1" size="30" name="murl" |
  | 2646 |  | value="<?php echo $murl; ?>"> |
  | 2647 |  | </div> |
  | 2648 |  | <div style="clear: both"></div> |
  | 2649 |  | <div></div> |
  | 2650 |  | <div style="clear: both"></div> |
  | 2651 |  |  |
  | 2652 |  | </div> |
  | 2653 |  | </div> |
  | 2654 |  | <div class="stuffbox" id="namediv" style="width: 100%"> |
  | 2655 |  | <h3> |
  | 2656 |  | <label for="mtag"><?php echo \_\_('Media Tags','responsive-filterable-portfolio');?> (<span style="font-size: 11px; font-weight: normal"><?php echo \_\_(' Tags used for filter on grid.You can add comma separated values.','responsive-filterable-portfolio'); ?></span>) |
  | 2657 |  | </label> |
  | 2658 |  | </h3> |
  | 2659 |  | <div class="inside"> |
  | 2660 |  | <div> |
  | 2661 |  | <input type="text" id="mtag" |
  | 2662 |  | tabindex="1" size="30" name="mtag" |
  | 2663 |  | value="<?php echo $mtag; ?>"> |
  | 2664 |  | </div> |
  | 2665 |  | <div style="clear: both"></div> |
  | 2666 |  | <div></div> |
  | 2667 |  | <div style="clear: both"></div> |
  | 2668 |  |  |
  | 2669 |  | </div> |
  | 2670 |  | </div> |
  | 2671 |  |  |
  | 2672 |  | <div class="stuffbox" id="namediv" style="width: 100%"> |
  | 2673 |  | <h3> |
  | 2674 |  | <label><?php echo \_\_('Show Image In Lightbox?','responsive-filterable-portfolio');?> (<span |
  | 2675 |  | style="font-size: 11px; font-weight: normal"><?php echo \_\_('show image in lightbox or redirect ?','responsive-filterable-portfolio');?></span>) |
  | 2676 |  | </label> |
  | 2677 |  | </h3> |
  | 2678 |  | <div class="inside"> |
  | 2679 |  | <table> |
  | 2680 |  | <tr> |
  | 2681 |  | <td> |
  | 2682 |  | <div> |
  | 2683 |  | <input type="checkbox" id="open\_link\_in" size="30" |
  | 2684 |  | name="open\_link\_in" value="" |
  | 2685 |  | <?php |
  | 2686 |  | if ($open\_link\_in == true) { |
  | 2687 |  | echo "checked='checked'"; |
  | 2688 |  | } |
  | 2689 |  | ?> |
  | 2690 |  | style="width: 20px;">&nbsp;<?php echo \_\_('Show image In Lightbox?','responsive-filterable-portfolio');?> |
  | 2691 |  | </div> |
  | 2692 |  | <div style="clear: both"></div> |
  | 2693 |  | <div></div> |
  | 2694 |  | </td> |
  | 2695 |  | </tr> |
  | 2696 |  | </table> |
  | 2697 |  | <div style="clear: both"></div> |
  | 2698 |  | </div> |
  | 2699 |  | </div> |
  | 2700 |  |  |
  | 2701 |  |  |
  | 2702 |  |  |
  | 2703 |  |  |
  | 2704 |  | <?php if (isset($\_GET['id']) and intval($\_GET['id']) > 0) { ?> |
  | 2705 |  | <input type="hidden" name="imageid" id="imageid" value="<?php echo intval($\_GET['id']); ?>"> |
  | 2706 |  | <?php |
  | 2707 |  | } |
  | 2708 |  | ?> |
  | 2709 |  | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
  | 2710 |  | <input type="submit" |
  | 2711 |  | onclick="" name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes','responsive-filterable-portfolio');?>" |
  | 2712 |  | class="button-primary">&nbsp;&nbsp;<input type="button" |
  | 2713 |  | name="cancle" id="cancle" value="<?php echo \_\_('Cancel','responsive-filterable-portfolio');?>" |
  | 2714 |  | class="button-primary" |
  | 2715 |  | onclick="location.href = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'"> |
  | 2716 |  |  |
  | 2717 |  | </form> |
  | 2718 |  | <form method="post" action="" id="addlink\_" name="addlink\_" enctype="multipart/form-data" style="display:none"> |
  | 2719 |  |  |
  | 2720 |  | <input type="hidden" name="media\_type" id="media\_type" value="link" /> |
  | 2721 |  | <div class="stuffbox" id="image\_info" style="width: 100%;"> |
  | 2722 |  | <h3> |
  | 2723 |  | <label for="link\_name"><?php echo \_\_('Image Information','responsive-filterable-portfolio');?></label> |
  | 2724 |  | </h3> |
  | 2725 |  | <div class="inside" id="fileuploaddiv"> |
  | 2726 |  | <?php if ($image\_name != "") { ?> |
  | 2727 |  | <div> |
  | 2728 |  | <b><?php echo \_\_('Current Image','responsive-filterable-portfolio');?>: </b> |
  | 2729 |  | <br/> |
  | 2730 |  | <img id="img\_disp\_link" name="img\_disp\_link" |
  | 2731 |  | src="<?php echo $baseurl . $image\_name; ?>" /> |
  | 2732 |  | </div> |
  | 2733 |  | <?php }else{ ?> |
  | 2734 |  | <img |
  | 2735 |  | src="<?php echo plugins\_url('/images/no-image-selected.png', \_\_FILE\_\_); ?>" |
  | 2736 |  | id="img\_disp\_link" name="img\_disp\_link" /> |
  | 2737 |  |  |
  | 2738 |  | <?php } ?> |
  | 2739 |  | <img |
  | 2740 |  | src="<?php echo plugins\_url('/images/ajax-loader.gif', \_\_FILE\_\_); ?>" |
  | 2741 |  | style="display: none" id="loading\_img" name="loading\_img" /> |
  | 2742 |  | <div style="clear: both"></div> |
  | 2743 |  | <div></div> |
  | 2744 |  | <div class="uploader"> |
  | 2745 |  |  |
  | 2746 |  | <div style="clear: both; margin-top: 15px;"></div> |
  | 2747 |  | <a |
  | 2748 |  | href="javascript:;" class="niks\_media" id="myMediaUploader\_link"><b><?php echo \_\_('Click Here to upload Image','responsive-filterable-portfolio');?></b></a> |
  | 2749 |  | <br /> <br /> |
  | 2750 |  | <div> |
  | 2751 |  | <input id="HdnMediaSelection\_link" name="HdnMediaSelection\_link" type="hidden" value="<?php echo $HdnMediaSelection;?>" /> |
  | 2752 |  | </div> |
  | 2753 |  | <div style="clear: both"></div> |
  | 2754 |  | <div></div> |
  | 2755 |  | <div style="clear: both"></div> |
  | 2756 |  |  |
  | 2757 |  | <br /> |
  | 2758 |  | </div> |
  | 2759 |  | </div> |
  | 2760 |  |  |
  | 2761 |  | <script> |
  | 2762 |  | //uploading files variable |
  | 2763 |  | var custom\_file\_frame; |
  | 2764 |  | jQuery("#myMediaUploader\_link").click(function(event) { |
  | 2765 |  | event.preventDefault(); |
  | 2766 |  | //If the frame already exists, reopen it |
  | 2767 |  | if (typeof (custom\_file\_frame) !== "undefined") { |
  | 2768 |  | custom\_file\_frame.close(); |
  | 2769 |  | } |
  | 2770 |  |  |
  | 2771 |  | //Create WP media frame. |
  | 2772 |  | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
  | 2773 |  | //Title of media manager frame |
  | 2774 |  | title: "WP Media Uploader", |
  | 2775 |  | library: { |
  | 2776 |  | type: 'image' |
  | 2777 |  | }, |
  | 2778 |  | button: { |
  | 2779 |  | //Button text |
  | 2780 |  | text: "Set Image" |
  | 2781 |  | }, |
  | 2782 |  | //Do not allow multiple files, if you want multiple, set true |
  | 2783 |  | multiple: false |
  | 2784 |  | }); |
  | 2785 |  | //callback for selected image |
  | 2786 |  | custom\_file\_frame.on('select', function() { |
  | 2787 |  |  |
  | 2788 |  | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
  | 2789 |  | var validExtensions = new Array(); |
  | 2790 |  | validExtensions[0] = 'jpg'; |
  | 2791 |  | validExtensions[1] = 'jpeg'; |
  | 2792 |  | validExtensions[2] = 'png'; |
  | 2793 |  | validExtensions[3] = 'gif'; |
  | 2794 |  |  |
  | 2795 |  | var inarr = parseInt(jQuery.inArray(attachment.subtype, validExtensions)); |
  | 2796 |  | if (inarr > 0 && attachment.type.toLowerCase() == 'image'){ |
  | 2797 |  |  |
  | 2798 |  | var titleTouse = ""; |
  | 2799 |  |  |
  | 2800 |  | if (jQuery.trim(attachment.title) != ''){ |
  | 2801 |  |  |
  | 2802 |  | titleTouse = jQuery.trim(attachment.title); |
  | 2803 |  | } |
  | 2804 |  | else if (jQuery.trim(attachment.caption) != ''){ |
  | 2805 |  |  |
  | 2806 |  | titleTouse = jQuery.trim(attachment.caption); |
  | 2807 |  | } |
  | 2808 |  |  |
  | 2809 |  |  |
  | 2810 |  |  |
  | 2811 |  | jQuery("#addlink\_ #title").val(titleTouse); |
  | 2812 |  |  |
  | 2813 |  | if (attachment.id != ''){ |
  | 2814 |  |  |
  | 2815 |  | jQuery("#HdnMediaSelection\_link").val(attachment.url); |
  | 2816 |  | jQuery("#img\_disp\_link").attr('src', attachment.url); |
  | 2817 |  |  |
  | 2818 |  | } |
  | 2819 |  |  |
  | 2820 |  | } |
  | 2821 |  | else{ |
  | 2822 |  |  |
  | 2823 |  | alert('Invalid image selection.'); |
  | 2824 |  | } |
  | 2825 |  | //do something with attachment variable, for example attachment.filename |
  | 2826 |  | //Object: |
  | 2827 |  | //attachment.alt - image alt |
  | 2828 |  | //attachment.author - author id |
  | 2829 |  | //attachment.caption |
  | 2830 |  | //attachment.dateFormatted - date of image uploaded |
  | 2831 |  | //attachment.description |
  | 2832 |  | //attachment.editLink - edit link of media |
  | 2833 |  | //attachment.filename |
  | 2834 |  | //attachment.height |
  | 2835 |  | //attachment.icon - don't know WTF?)) |
  | 2836 |  | //attachment.id - id of attachment |
  | 2837 |  | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
  | 2838 |  | //attachment.menuOrder |
  | 2839 |  | //attachment.mime - mime type, for example image/jpeg" |
  | 2840 |  | //attachment.name - name of attachment file, for example "my-image" |
  | 2841 |  | //attachment.status - usual is "inherit" |
  | 2842 |  | //attachment.subtype - "jpeg" if is "jpg" |
  | 2843 |  | //attachment.title |
  | 2844 |  | //attachment.type - "image" |
  | 2845 |  | //attachment.uploadedTo |
  | 2846 |  | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
  | 2847 |  | //attachment.width |
  | 2848 |  | }); |
  | 2849 |  | //Open modal |
  | 2850 |  | custom\_file\_frame.open(); |
  | 2851 |  | }); |
  | 2852 |  |  |
  | 2853 |  | </script> |
  | 2854 |  | </div> |
  | 2855 |  |  |
  | 2856 |  | <div class="stuffbox" id="namediv" style="width: 100%"> |
  | 2857 |  | <h3> |
  | 2858 |  | <label for="link\_name"><?php echo \_\_('Link Title','responsive-filterable-portfolio');?> (<span |
  | 2859 |  | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Used into Caption','responsive-filterable-portfolio'); ?></span>) |
  | 2860 |  | </label> |
  | 2861 |  | </h3> |
  | 2862 |  | <div class="inside"> |
  | 2863 |  | <div> |
  | 2864 |  | <input type="text" id="title" tabindex="1" size="30" name="title" value="<?php echo $videotitle; ?>"> |
  | 2865 |  | </div> |
  | 2866 |  | <div style="clear: both"></div> |
  | 2867 |  | <div></div> |
  | 2868 |  | <div style="clear: both"></div> |
  | 2869 |  | </div> |
  | 2870 |  | </div> |
  | 2871 |  | <div class="stuffbox" id="namediv" style="width: 100%"> |
  | 2872 |  | <h3> |
  | 2873 |  | <label for="link\_name"><?php echo \_\_('Link Url','responsive-filterable-portfolio');?> (<span |
  | 2874 |  | style="font-size: 11px; font-weight: normal"><?php echo \_\_('click on image will redirect to this url.','responsive-filterable-portfolio'); ?></span>) |
  | 2875 |  | </label> |
  | 2876 |  | </h3> |
  | 2877 |  | <div class="inside"> |
  | 2878 |  | <div> |
  | 2879 |  | <input type="text" id="murl" |
  | 2880 |  | tabindex="1" size="30" name="murl" |
  | 2881 |  | value="<?php echo $murl; ?>"> |
  | 2882 |  | </div> |
  | 2883 |  | <div style="clear: both"></div> |
  | 2884 |  | <div></div> |
  | 2885 |  | <div style="clear: both"></div> |
  | 2886 |  |  |
  | 2887 |  | </div> |
  | 2888 |  | </div> |
  | 2889 |  | <div class="stuffbox" id="namediv" style="width: 100%"> |
  | 2890 |  | <h3> |
  | 2891 |  | <label for="mtag"><?php echo \_\_('Media Tags','responsive-filterable-portfolio');?> (<span |
  | 2892 |  | style="font-size: 11px; font-weight: normal"><?php echo \_\_(' Tags used for filter on grid.You can add comma separated values.','responsive-filterable-portfolio'); ?></span>) |
  | 2893 |  | </label> |
  | 2894 |  | </h3> |
  | 2895 |  | <div class="inside"> |
  | 2896 |  | <div> |
  | 2897 |  | <input type="text" id="mtag" |
  | 2898 |  | tabindex="1" size="30" name="mtag" |
  | 2899 |  | value="<?php echo $mtag; ?>"> |
  | 2900 |  | </div> |
  | 2901 |  | <div style="clear: both"></div> |
  | 2902 |  | <div></div> |
  | 2903 |  | <div style="clear: both"></div> |
  | 2904 |  |  |
  | 2905 |  | </div> |
  | 2906 |  | </div> |
  | 2907 |  |  |
  | 2908 |  |  |
  | 2909 |  | <?php if (isset($\_GET['id']) and (int) $\_GET['id'] > 0) { ?> |
  | 2910 |  | <input type="hidden" name="linkid" id="linkid" value="<?php echo (int) $\_GET['id']; ?>"> |
  | 2911 |  | <?php |
  | 2912 |  | } |
  | 2913 |  | ?> |
  | 2914 |  | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
  | 2915 |  | <input type="submit" |
  | 2916 |  | onclick="" name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes','responsive-filterable-portfolio');?>" |
  | 2917 |  | class="button-primary">&nbsp;&nbsp;<input type="button" |
  | 2918 |  | name="cancle" id="cancle" value="<?php echo \_\_('Cancel','responsive-filterable-portfolio');?>" |
  | 2919 |  | class="button-primary" |
  | 2920 |  | onclick="location.href = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'"> |
  | 2921 |  |  |
  | 2922 |  | </form> |
  | 2923 |  | <script type="text/javascript"> |
  | 2924 |  |  |
  | 2925 |  | jQuery(document).ready(function() { |
  | 2926 |  |  |
  | 2927 |  | jQuery.validator.setDefaults({ |
  | 2928 |  | ignore: [], |
  | 2929 |  | // any other default options and/or rules |
  | 2930 |  | }); |
  | 2931 |  |  |
  | 2932 |  | jQuery("#addvideo").validate({ |
  | 2933 |  | rules: { |
  | 2934 |  | videotitle: { |
  | 2935 |  | required:true, |
  | 2936 |  | maxlength: 200 |
  | 2937 |  | }, |
  | 2938 |  | vtype: { |
  | 2939 |  | required:true |
  | 2940 |  |  |
  | 2941 |  | }, |
  | 2942 |  | videourl: { |
  | 2943 |  | required:true, |
  | 2944 |  | url:true, |
  | 2945 |  | maxlength: 500 |
  | 2946 |  | }, |
  | 2947 |  | HdnMediaSelection:{ |
  | 2948 |  | required:true |
  | 2949 |  | }, |
  | 2950 |  | videotitleurl: { |
  | 2951 |  |  |
  | 2952 |  | url:true, |
  | 2953 |  | maxlength: 500 |
  | 2954 |  | }, |
  | 2955 |  | mtag:{ |
  | 2956 |  | maxlength: 5000 |
  | 2957 |  | } |
  | 2958 |  | }, |
  | 2959 |  | errorClass: "image\_error", |
  | 2960 |  | errorPlacement: function(error, element) { |
  | 2961 |  | error.appendTo(element.parent().next().next()); |
  | 2962 |  | }, messages: { |
  | 2963 |  | HdnMediaSelection: "Please select video thumbnail or Upload by wordpress media uploader.", |
  | 2964 |  |  |
  | 2965 |  | } |
  | 2966 |  |  |
  | 2967 |  | }) |
  | 2968 |  |  |
  | 2969 |  |  |
  | 2970 |  | jQuery("#addimage\_").validate({ |
  | 2971 |  | rules: { |
  | 2972 |  | HdnMediaSelection\_image:{ |
  | 2973 |  | required:true |
  | 2974 |  | }, |
  | 2975 |  | murl: { |
  | 2976 |  | maxlength: 500 |
  | 2977 |  | }, |
  | 2978 |  | mtag:{ |
  | 2979 |  | maxlength: 5000 |
  | 2980 |  | } |
  | 2981 |  | }, |
  | 2982 |  | errorClass: "image\_error", |
  | 2983 |  | errorPlacement: function(error, element) { |
  | 2984 |  | error.appendTo(element.parent().next().next()); |
  | 2985 |  | }, messages: { |
  | 2986 |  | HdnMediaSelection: "Please select image thumbnail or Upload by wordpress media uploader.", |
  | 2987 |  |  |
  | 2988 |  | } |
  | 2989 |  |  |
  | 2990 |  | }) |
  | 2991 |  | jQuery("#addlink\_").validate({ |
  | 2992 |  | rules: { |
  | 2993 |  | HdnMediaSelection\_link:{ |
  | 2994 |  | required:true |
  | 2995 |  | }, |
  | 2996 |  | murl: { |
  | 2997 |  | required:true, |
  | 2998 |  | maxlength: 500 |
  | 2999 |  | }, |
  | 3000 |  | mtag:{ |
  | 3001 |  | maxlength: 5000 |
  | 3002 |  | } |
  | 3003 |  | }, |
  | 3004 |  | errorClass: "image\_error", |
  | 3005 |  | errorPlacement: function(error, element) { |
  | 3006 |  | error.appendTo(element.parent().next().next()); |
  | 3007 |  | }, messages: { |
  | 3008 |  | HdnMediaSelection: "Please select link thumbnail or Upload by wordpress media uploader.", |
  | 3009 |  |  |
  | 3010 |  | } |
  | 3011 |  |  |
  | 3012 |  |  |
  | 3013 |  |  |
  | 3014 |  | }) |
  | 3015 |  |  |
  | 3016 |  |  |
  | 3017 |  | }); |
  | 3018 |  |  |
  | 3019 |  |  |
  | 3020 |  | </script> |
  | 3021 |  |  |
  | 3022 |  | </div> |
  | 3023 |  | </div> |
  | 3024 |  | </div> |
  | 3025 |  | </div> |
  | 3026 |  | </div> |
  | 3027 |  | <div id="postbox-container-1" class="postbox-container" > |
  |  | 2157 | jQuery("#loading\_img").hide(); |
  |  | 2158 | }) |
  |  | 2159 |  |
  |  | 2160 |  |
  |  | 2161 | }); |
  |  | 2162 |  |
  |  | 2163 | } else { |
  |  | 2164 | alert('Could not found such video'); |
  |  | 2165 | jQuery("#loading\_img").hide(); |
  |  | 2166 | } |
  |  | 2167 | } else if (checkedValueRadio == 'metacafe') { |
  |  | 2168 |  |
  |  | 2169 | jQuery("#loading\_img").show(); |
  |  | 2170 | var data = { |
  |  | 2171 | 'action': 'rfp\_get\_metacafe\_info\_portfolio', |
  |  | 2172 | 'url': videourlVal, |
  |  | 2173 | 'vNonce': '<?php echo $vNonce; ?>' |
  |  | 2174 | }; |
  |  | 2175 |  |
  |  | 2176 | jQuery.post(ajaxurl, data, function (response) { |
  |  | 2177 |  |
  |  | 2178 | obj = jQuery.parseJSON(response); |
  |  | 2179 | jQuery("#HdnMediaSelection").val(obj.HdnMediaSelection); |
  |  | 2180 | jQuery("#title").val(jQuery.trim(obj.videotitle)); |
  |  | 2181 | jQuery("#murl").val(obj.videotitleurl); |
  |  | 2182 | jQuery("#img\_disp").attr('src', obj.HdnMediaSelection); |
  |  | 2183 | jQuery("#loading\_img").hide(); |
  |  | 2184 | }); |
  |  | 2185 |  |
  |  | 2186 |  |
  |  | 2187 | } |
  |  | 2188 |  |
  |  | 2189 |  |
  |  | 2190 | jQuery("#loading\_img").hide(); |
  |  | 2191 | } |
  |  | 2192 |  |
  |  | 2193 | setTimeout(function () { |
  |  | 2194 | jQuery("#loading\_img").hide(); |
  |  | 2195 | }, 2000); |
  |  | 2196 |  |
  |  | 2197 | }); |
  |  | 2198 | //uploading files variable |
  |  | 2199 | var custom\_file\_frame; |
  |  | 2200 | jQuery("#myMediaUploader").click(function (event) { |
  |  | 2201 | event.preventDefault(); |
  |  | 2202 | //If the frame already exists, reopen it |
  |  | 2203 | if (typeof (custom\_file\_frame) !== "undefined") { |
  |  | 2204 | custom\_file\_frame.close(); |
  |  | 2205 | } |
  |  | 2206 |  |
  |  | 2207 | //Create WP media frame. |
  |  | 2208 | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
  |  | 2209 | //Title of media manager frame |
  |  | 2210 | title: "WP Media Uploader", |
  |  | 2211 | library: { |
  |  | 2212 | type: 'image' |
  |  | 2213 | }, |
  |  | 2214 | button: { |
  |  | 2215 | //Button text |
  |  | 2216 | text: "Set Image" |
  |  | 2217 | }, |
  |  | 2218 | //Do not allow multiple files, if you want multiple, set true |
  |  | 2219 | multiple: false |
  |  | 2220 | }); |
  |  | 2221 | //callback for selected image |
  |  | 2222 | custom\_file\_frame.on('select', function () { |
  |  | 2223 |  |
  |  | 2224 | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
  |  | 2225 | var validExtensions = new Array(); |
  |  | 2226 | validExtensions[0] = 'jpg'; |
  |  | 2227 | validExtensions[1] = 'jpeg'; |
  |  | 2228 | validExtensions[2] = 'png'; |
  |  | 2229 | validExtensions[3] = 'gif'; |
  |  | 2230 |  |
  |  | 2231 | var inarr = parseInt(jQuery.inArray(attachment.subtype, validExtensions)); |
  |  | 2232 | if (inarr > 0 && attachment.type.toLowerCase() == 'image') { |
  |  | 2233 |  |
  |  | 2234 | var titleTouse = ""; |
  |  | 2235 |  |
  |  | 2236 | if (jQuery.trim(attachment.title) != '') { |
  |  | 2237 |  |
  |  | 2238 | titleTouse = jQuery.trim(attachment.title); |
  |  | 2239 | } else if (jQuery.trim(attachment.caption) != '') { |
  |  | 2240 |  |
  |  | 2241 | titleTouse = jQuery.trim(attachment.caption); |
  |  | 2242 | } |
  |  | 2243 |  |
  |  | 2244 |  |
  |  | 2245 | // jQuery("#videotitle").val(titleTouse); |
  |  | 2246 |  |
  |  | 2247 | if (attachment.id != '') { |
  |  | 2248 |  |
  |  | 2249 | jQuery("#HdnMediaSelection").val(attachment.url); |
  |  | 2250 | jQuery("#img\_disp").attr('src', attachment.url); |
  |  | 2251 |  |
  |  | 2252 | } |
  |  | 2253 |  |
  |  | 2254 | } else { |
  |  | 2255 |  |
  |  | 2256 | alert('Invalid image selection.'); |
  |  | 2257 | } |
  |  | 2258 | //do something with attachment variable, for example attachment.filename |
  |  | 2259 | //Object: |
  |  | 2260 | //attachment.alt - image alt |
  |  | 2261 | //attachment.author - author id |
  |  | 2262 | //attachment.caption |
  |  | 2263 | //attachment.dateFormatted - date of image uploaded |
  |  | 2264 | //attachment.description |
  |  | 2265 | //attachment.editLink - edit link of media |
  |  | 2266 | //attachment.filename |
  |  | 2267 | //attachment.height |
  |  | 2268 | //attachment.icon - don't know WTF?)) |
  |  | 2269 | //attachment.id - id of attachment |
  |  | 2270 | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
  |  | 2271 | //attachment.menuOrder |
  |  | 2272 | //attachment.mime - mime type, for example image/jpeg" |
  |  | 2273 | //attachment.name - name of attachment file, for example "my-image" |
  |  | 2274 | //attachment.status - usual is "inherit" |
  |  | 2275 | //attachment.subtype - "jpeg" if is "jpg" |
  |  | 2276 | //attachment.title |
  |  | 2277 | //attachment.type - "image" |
  |  | 2278 | //attachment.uploadedTo |
  |  | 2279 | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
  |  | 2280 | //attachment.width |
  |  | 2281 | }); |
  |  | 2282 | //Open modal |
  |  | 2283 | custom\_file\_frame.open(); |
  |  | 2284 | }); |
  |  | 2285 | }) |
  |  | 2286 | </script> |
  |  | 2287 | </div> |
  |  | 2288 | </div> |
  |  | 2289 | <div class="stuffbox" id="namediv" style="width: 100%"> |
  |  | 2290 | <h3> |
  |  | 2291 | <label for="link\_name">Video Title (<span |
  |  | 2292 | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Used into lightbox', 'responsive-filterable-portfolio'); ?></span>) |
  |  | 2293 | </label> |
  |  | 2294 | </h3> |
  |  | 2295 | <div class="inside"> |
  |  | 2296 | <div> |
  |  | 2297 | <input type="text" id="title" tabindex="1" size="30" name="title" value="<?php echo $videotitle; ?>"> |
  |  | 2298 | </div> |
  |  | 2299 | <div style="clear: both"></div> |
  |  | 2300 | <div></div> |
  |  | 2301 | <div style="clear: both"></div> |
  |  | 2302 | </div> |
  |  | 2303 | </div> |
  |  | 2304 | <div class="stuffbox" id="namediv" style="width: 100%"> |
  |  | 2305 | <h3> |
  |  | 2306 | <label for="link\_name"><?php echo \_\_('Video Title Url', 'responsive-filterable-portfolio'); ?> (<span |
  |  | 2307 | style="font-size: 11px; font-weight: normal"><?php \_e(' click on title redirect to this url.Used in lightbox for video title'); ?></span>) |
  |  | 2308 | </label> |
  |  | 2309 | </h3> |
  |  | 2310 | <div class="inside"> |
  |  | 2311 | <div> |
  |  | 2312 | <input type="text" id="murl" |
  |  | 2313 | tabindex="1" size="30" name="murl" |
  |  | 2314 | value="<?php echo $videotitleurl; ?>"> |
  |  | 2315 | </div> |
  |  | 2316 | <div style="clear: both"></div> |
  |  | 2317 | <div></div> |
  |  | 2318 | <div style="clear: both"></div> |
  |  | 2319 |  |
  |  | 2320 | </div> |
  |  | 2321 | </div> |
  |  | 2322 | <div class="stuffbox" id="namediv" style="width: 100%"> |
  |  | 2323 | <h3> |
  |  | 2324 | <label for="mtag"><?php echo \_\_('Media Tags', 'responsive-filterable-portfolio'); ?> (<span |
  |  | 2325 | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Tags used for filter on grid.You can add comma separated values.', 'responsive-filterable-portfolio'); ?></span>) |
  |  | 2326 | </label> |
  |  | 2327 | </h3> |
  |  | 2328 | <div class="inside"> |
  |  | 2329 | <div> |
  |  | 2330 | <input type="text" id="mtag" |
  |  | 2331 | tabindex="1" size="30" name="mtag" |
  |  | 2332 | value="<?php echo $mtag; ?>"> |
  |  | 2333 | </div> |
  |  | 2334 | <div style="clear: both"></div> |
  |  | 2335 | <div></div> |
  |  | 2336 | <div style="clear: both"></div> |
  |  | 2337 |  |
  |  | 2338 | </div> |
  |  | 2339 | </div> |
  |  | 2340 | <div class="stuffbox" id="namediv" style="width: 100%"> |
  |  | 2341 | <h3> |
  |  | 2342 | <label><?php echo \_\_('Play Video In Lightbox?', 'responsive-filterable-portfolio'); ?> (<span |
  |  | 2343 | style="font-size: 11px; font-weight: normal"><?php echo \_\_('show video in lightbox or redirect?', 'responsive-filterable-portfolio'); ?></span>) |
  |  | 2344 | </label> |
  |  | 2345 | </h3> |
  |  | 2346 | <div class="inside"> |
  |  | 2347 | <table> |
  |  | 2348 | <tr> |
  |  | 2349 | <td> |
  |  | 2350 | <div> |
  |  | 2351 | <input type="checkbox" id="open\_link\_in" size="30" |
  |  | 2352 | name="open\_link\_in" value="" |
  |  | 2353 | <?php |
  |  | 2354 | if ($open\_link\_in == true) { |
  |  | 2355 | echo "checked='checked'"; |
  |  | 2356 | } |
  |  | 2357 | ?> |
  |  | 2358 | style="width: 20px;">&nbsp;<?php echo \_\_('Show Video In Lightbox?', 'responsive-filterable-portfolio'); ?> |
  |  | 2359 | </div> |
  |  | 2360 | <div style="clear: both"></div> |
  |  | 2361 | <div></div> |
  |  | 2362 | </td> |
  |  | 2363 | </tr> |
  |  | 2364 | </table> |
  |  | 2365 | <div style="clear: both"></div> |
  |  | 2366 | </div> |
  |  | 2367 | </div> |
  |  | 2368 |  |
  |  | 2369 |  |
  |  | 2370 | <?php if (isset($\_GET['id']) && (int) $\_GET['id'] > 0) { ?> |
  |  | 2371 | <input type="hidden" name="videoid" id="videoid" value="<?php echo (int) $\_GET['id']; ?>"> |
  |  | 2372 | <?php |
  |  | 2373 | } |
  |  | 2374 | ?> |
  |  | 2375 | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
  |  | 2376 | <input type="submit" |
  |  | 2377 | onclick="" name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes', 'responsive-filterable-portfolio'); ?>" |
  |  | 2378 | class="button-primary">&nbsp;&nbsp;<input type="button" |
  |  | 2379 | name="cancle" id="cancle" value="<?php echo \_\_('Cancel', 'responsive-filterable-portfolio'); ?>" |
  |  | 2380 | class="button-primary" |
  |  | 2381 | onclick="location.href = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'"> |
  |  | 2382 |  |
  |  | 2383 | </form> |
  |  | 2384 | <form method="post" action="" id="addimage\_" name="addimage\_" enctype="multipart/form-data" style="display:none"> |
  |  | 2385 |  |
  |  | 2386 | <input type="hidden" name="media\_type" id="media\_type" value="image" /> |
  |  | 2387 | <div class="stuffbox" id="image\_info" style="width: 100%;"> |
  |  | 2388 | <h3> |
  |  | 2389 | <label for="link\_name"><?php echo \_\_('Image Information', 'responsive-filterable-portfolio'); ?></label> |
  |  | 2390 | </h3> |
  |  | 2391 | <div class="inside" id="fileuploaddiv"> |
  |  | 2392 | <?php if ($image\_name != '') { ?> |
  |  | 2393 | <div> |
  |  | 2394 | <b><?php echo \_\_('Current Image', 'responsive-filterable-portfolio'); ?>: </b> |
  |  | 2395 | <br/> |
  |  | 2396 | <img id="img\_disp\_img" name="img\_disp\_img" |
  |  | 2397 | src="<?php echo $baseurl . $image\_name; ?>" /> |
  |  | 2398 | </div> |
  |  | 2399 | <?php } else { ?> |
  |  | 2400 | <img |
  |  | 2401 | src="<?php echo plugins\_url('/images/no-image-selected.png', \_\_FILE\_\_); ?>" |
  |  | 2402 | id="img\_disp\_img" name="img\_disp\_img" /> |
  |  | 2403 |  |
  |  | 2404 | <?php } ?> |
  |  | 2405 | <img |
  |  | 2406 | src="<?php echo plugins\_url('/images/ajax-loader.gif', \_\_FILE\_\_); ?>" |
  |  | 2407 | style="display: none" id="loading\_img" name="loading\_img" /> |
  |  | 2408 | <div style="clear: both"></div> |
  |  | 2409 | <div></div> |
  |  | 2410 | <div class="uploader"> |
  |  | 2411 |  |
  |  | 2412 | <div style="clear: both; margin-top: 15px;"></div> |
  |  | 2413 | <a |
  |  | 2414 | href="javascript:;" class="niks\_media" id="myMediaUploader\_image"><b><?php echo \_\_('Click Here to upload Image', 'responsive-filterable-portfolio'); ?></b></a> |
  |  | 2415 | <br /> <br /> |
  |  | 2416 | <div> |
  |  | 2417 | <input id="HdnMediaSelection\_image" name="HdnMediaSelection\_image" type="hidden" value="<?php echo $HdnMediaSelection; ?>" /> |
  |  | 2418 | </div> |
  |  | 2419 | <div style="clear: both"></div> |
  |  | 2420 | <div></div> |
  |  | 2421 | <div style="clear: both"></div> |
  |  | 2422 |  |
  |  | 2423 | <br /> |
  |  | 2424 | </div> |
  |  | 2425 | </div> |
  |  | 2426 |  |
  |  | 2427 | <script> |
  |  | 2428 | //uploading files variable |
  |  | 2429 | var custom\_file\_frame; |
  |  | 2430 | jQuery("#myMediaUploader\_image").click(function (event) { |
  |  | 2431 | event.preventDefault(); |
  |  | 2432 | //If the frame already exists, reopen it |
  |  | 2433 | if (typeof (custom\_file\_frame) !== "undefined") { |
  |  | 2434 | custom\_file\_frame.close(); |
  |  | 2435 | } |
  |  | 2436 |  |
  |  | 2437 | //Create WP media frame. |
  |  | 2438 | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
  |  | 2439 | //Title of media manager frame |
  |  | 2440 | title: "WP Media Uploader", |
  |  | 2441 | library: { |
  |  | 2442 | type: 'image' |
  |  | 2443 | }, |
  |  | 2444 | button: { |
  |  | 2445 | //Button text |
  |  | 2446 | text: "Set Image" |
  |  | 2447 | }, |
  |  | 2448 | //Do not allow multiple files, if you want multiple, set true |
  |  | 2449 | multiple: false |
  |  | 2450 | }); |
  |  | 2451 | //callback for selected image |
  |  | 2452 | custom\_file\_frame.on('select', function () { |
  |  | 2453 |  |
  |  | 2454 | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
  |  | 2455 | var validExtensions = new Array(); |
  |  | 2456 | validExtensions[0] = 'jpg'; |
  |  | 2457 | validExtensions[1] = 'jpeg'; |
  |  | 2458 | validExtensions[2] = 'png'; |
  |  | 2459 | validExtensions[3] = 'gif'; |
  |  | 2460 |  |
  |  | 2461 | var inarr = parseInt(jQuery.inArray(attachment.subtype, validExtensions)); |
  |  | 2462 | if (inarr > 0 && attachment.type.toLowerCase() == 'image') { |
  |  | 2463 |  |
  |  | 2464 | var titleTouse = ""; |
  |  | 2465 |  |
  |  | 2466 | if (jQuery.trim(attachment.title) != '') { |
  |  | 2467 |  |
  |  | 2468 | titleTouse = jQuery.trim(attachment.title); |
  |  | 2469 | } else if (jQuery.trim(attachment.caption) != '') { |
  |  | 2470 |  |
  |  | 2471 | titleTouse = jQuery.trim(attachment.caption); |
  |  | 2472 | } |
  |  | 2473 |  |
  |  | 2474 |  |
  |  | 2475 |  |
  |  | 2476 | jQuery("#addimage\_ #title").val(titleTouse); |
  |  | 2477 |  |
  |  | 2478 |  |
  |  | 2479 | if (attachment.id != '') { |
  |  | 2480 |  |
  |  | 2481 | jQuery("#HdnMediaSelection\_image").val(attachment.url); |
  |  | 2482 | jQuery("#img\_disp\_img").attr('src', attachment.url); |
  |  | 2483 |  |
  |  | 2484 | } |
  |  | 2485 |  |
  |  | 2486 | } else { |
  |  | 2487 |  |
  |  | 2488 | alert('Invalid image selection.'); |
  |  | 2489 | } |
  |  | 2490 | //do something with attachment variable, for example attachment.filename |
  |  | 2491 | //Object: |
  |  | 2492 | //attachment.alt - image alt |
  |  | 2493 | //attachment.author - author id |
  |  | 2494 | //attachment.caption |
  |  | 2495 | //attachment.dateFormatted - date of image uploaded |
  |  | 2496 | //attachment.description |
  |  | 2497 | //attachment.editLink - edit link of media |
  |  | 2498 | //attachment.filename |
  |  | 2499 | //attachment.height |
  |  | 2500 | //attachment.icon - don't know WTF?)) |
  |  | 2501 | //attachment.id - id of attachment |
  |  | 2502 | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
  |  | 2503 | //attachment.menuOrder |
  |  | 2504 | //attachment.mime - mime type, for example image/jpeg" |
  |  | 2505 | //attachment.name - name of attachment file, for example "my-image" |
  |  | 2506 | //attachment.status - usual is "inherit" |
  |  | 2507 | //attachment.subtype - "jpeg" if is "jpg" |
  |  | 2508 | //attachment.title |
  |  | 2509 | //attachment.type - "image" |
  |  | 2510 | //attachment.uploadedTo |
  |  | 2511 | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
  |  | 2512 | //attachment.width |
  |  | 2513 | }); |
  |  | 2514 | //Open modal |
  |  | 2515 | custom\_file\_frame.open(); |
  |  | 2516 | }); |
  |  | 2517 |  |
  |  | 2518 | </script> |
  |  | 2519 | </div> |
  |  | 2520 |  |
  |  | 2521 | <div class="stuffbox" id="namediv" style="width: 100%"> |
  |  | 2522 | <h3> |
  |  | 2523 | <label for="link\_name"><?php echo \_\_('Image Title', 'responsive-filterable-portfolio'); ?> (<span |
  |  | 2524 | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Used into lightbox', 'responsive-filterable-portfolio'); ?></span>) |
  |  | 2525 | </label> |
  |  | 2526 | </h3> |
  |  | 2527 | <div class="inside"> |
  |  | 2528 | <div> |
  |  | 2529 | <input type="text" id="title" tabindex="1" size="30" name="title" value="<?php echo $videotitle; ?>"> |
  |  | 2530 | </div> |
  |  | 2531 | <div style="clear: both"></div> |
  |  | 2532 | <div></div> |
  |  | 2533 | <div style="clear: both"></div> |
  |  | 2534 | </div> |
  |  | 2535 | </div> |
  |  | 2536 | <div class="stuffbox" id="namediv" style="width: 100%"> |
  |  | 2537 | <h3> |
  |  | 2538 | <label for="link\_name"><?php echo \_\_('Image Title Url', 'responsive-filterable-portfolio'); ?> (<span |
  |  | 2539 | style="font-size: 11px; font-weight: normal"><?php echo \_\_('click on title redirect to this url.Used in lightbox for image title', 'responsive-filterable-portfolio'); ?></span>) |
  |  | 2540 | </label> |
  |  | 2541 | </h3> |
  |  | 2542 | <div class="inside"> |
  |  | 2543 | <div> |
  |  | 2544 | <input type="text" id="murl" |
  |  | 2545 | tabindex="1" size="30" name="murl" |
  |  | 2546 | value="<?php echo $murl; ?>"> |
  |  | 2547 | </div> |
  |  | 2548 | <div style="clear: both"></div> |
  |  | 2549 | <div></div> |
  |  | 2550 | <div style="clear: both"></div> |
  |  | 2551 |  |
  |  | 2552 | </div> |
  |  | 2553 | </div> |
  |  | 2554 | <div class="stuffbox" id="namediv" style="width: 100%"> |
  |  | 2555 | <h3> |
  |  | 2556 | <label for="mtag"><?php echo \_\_('Media Tags', 'responsive-filterable-portfolio'); ?> (<span style="font-size: 11px; font-weight: normal"><?php echo \_\_(' Tags used for filter on grid.You can add comma separated values.', 'responsive-filterable-portfolio'); ?></span>) |
  |  | 2557 | </label> |
  |  | 2558 | </h3> |
  |  | 2559 | <div class="inside"> |
  |  | 2560 | <div> |
  |  | 2561 | <input type="text" id="mtag" |
  |  | 2562 | tabindex="1" size="30" name="mtag" |
  |  | 2563 | value="<?php echo $mtag; ?>"> |
  |  | 2564 | </div> |
  |  | 2565 | <div style="clear: both"></div> |
  |  | 2566 | <div></div> |
  |  | 2567 | <div style="clear: both"></div> |
  |  | 2568 |  |
  |  | 2569 | </div> |
  |  | 2570 | </div> |
  |  | 2571 |  |
  |  | 2572 | <div class="stuffbox" id="namediv" style="width: 100%"> |
  |  | 2573 | <h3> |
  |  | 2574 | <label><?php echo \_\_('Show Image In Lightbox?', 'responsive-filterable-portfolio'); ?> (<span |
  |  | 2575 | style="font-size: 11px; font-weight: normal"><?php echo \_\_('show image in lightbox or redirect ?', 'responsive-filterable-portfolio'); ?></span>) |
  |  | 2576 | </label> |
  |  | 2577 | </h3> |
  |  | 2578 | <div class="inside"> |
  |  | 2579 | <table> |
  |  | 2580 | <tr> |
  |  | 2581 | <td> |
  |  | 2582 | <div> |
  |  | 2583 | <input type="checkbox" id="open\_link\_in" size="30" |
  |  | 2584 | name="open\_link\_in" value="" |
  |  | 2585 | <?php |
  |  | 2586 | if ($open\_link\_in == true) { |
  |  | 2587 | echo "checked='checked'"; |
  |  | 2588 | } |
  |  | 2589 | ?> |
  |  | 2590 | style="width: 20px;">&nbsp;<?php echo \_\_('Show image In Lightbox?', 'responsive-filterable-portfolio'); ?> |
  |  | 2591 | </div> |
  |  | 2592 | <div style="clear: both"></div> |
  |  | 2593 | <div></div> |
  |  | 2594 | </td> |
  |  | 2595 | </tr> |
  |  | 2596 | </table> |
  |  | 2597 | <div style="clear: both"></div> |
  |  | 2598 | </div> |
  |  | 2599 | </div> |
  |  | 2600 |  |
  |  | 2601 |  |
  |  | 2602 |  |
  |  | 2603 |  |
  |  | 2604 | <?php if (isset($\_GET['id']) && intval($\_GET['id']) > 0) { ?> |
  |  | 2605 | <input type="hidden" name="imageid" id="imageid" value="<?php echo intval($\_GET['id']); ?>"> |
  |  | 2606 | <?php |
  |  | 2607 | } |
  |  | 2608 | ?> |
  |  | 2609 | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
  |  | 2610 | <input type="submit" |
  |  | 2611 | onclick="" name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes', 'responsive-filterable-portfolio'); ?>" |
  |  | 2612 | class="button-primary">&nbsp;&nbsp;<input type="button" |
  |  | 2613 | name="cancle" id="cancle" value="<?php echo \_\_('Cancel', 'responsive-filterable-portfolio'); ?>" |
  |  | 2614 | class="button-primary" |
  |  | 2615 | onclick="location.href = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'"> |
  |  | 2616 |  |
  |  | 2617 | </form> |
  |  | 2618 | <form method="post" action="" id="addlink\_" name="addlink\_" enctype="multipart/form-data" style="display:none"> |
  |  | 2619 |  |
  |  | 2620 | <input type="hidden" name="media\_type" id="media\_type" value="link" /> |
  |  | 2621 | <div class="stuffbox" id="image\_info" style="width: 100%;"> |
  |  | 2622 | <h3> |
  |  | 2623 | <label for="link\_name"><?php echo \_\_('Image Information', 'responsive-filterable-portfolio'); ?></label> |
  |  | 2624 | </h3> |
  |  | 2625 | <div class="inside" id="fileuploaddiv"> |
  |  | 2626 | <?php if ($image\_name != '') { ?> |
  |  | 2627 | <div> |
  |  | 2628 | <b><?php echo \_\_('Current Image', 'responsive-filterable-portfolio'); ?>: </b> |
  |  | 2629 | <br/> |
  |  | 2630 | <img id="img\_disp\_link" name="img\_disp\_link" |
  |  | 2631 | src="<?php echo $baseurl . $image\_name; ?>" /> |
  |  | 2632 | </div> |
  |  | 2633 | <?php } else { ?> |
  |  | 2634 | <img |
  |  | 2635 | src="<?php echo plugins\_url('/images/no-image-selected.png', \_\_FILE\_\_); ?>" |
  |  | 2636 | id="img\_disp\_link" name="img\_disp\_link" /> |
  |  | 2637 |  |
  |  | 2638 | <?php } ?> |
  |  | 2639 | <img |
  |  | 2640 | src="<?php echo plugins\_url('/images/ajax-loader.gif', \_\_FILE\_\_); ?>" |
  |  | 2641 | style="display: none" id="loading\_img" name="loading\_img" /> |
  |  | 2642 | <div style="clear: both"></div> |
  |  | 2643 | <div></div> |
  |  | 2644 | <div class="uploader"> |
  |  | 2645 |  |
  |  | 2646 | <div style="clear: both; margin-top: 15px;"></div> |
  |  | 2647 | <a |
  |  | 2648 | href="javascript:;" class="niks\_media" id="myMediaUploader\_link"><b><?php echo \_\_('Click Here to upload Image', 'responsive-filterable-portfolio'); ?></b></a> |
  |  | 2649 | <br /> <br /> |
  |  | 2650 | <div> |
  |  | 2651 | <input id="HdnMediaSelection\_link" name="HdnMediaSelection\_link" type="hidden" value="<?php echo $HdnMediaSelection; ?>" /> |
  |  | 2652 | </div> |
  |  | 2653 | <div style="clear: both"></div> |
  |  | 2654 | <div></div> |
  |  | 2655 | <div style="clear: both"></div> |
  |  | 2656 |  |
  |  | 2657 | <br /> |
  |  | 2658 | </div> |
  |  | 2659 | </div> |
  |  | 2660 |  |
  |  | 2661 | <script> |
  |  | 2662 | //uploading files variable |
  |  | 2663 | var custom\_file\_frame; |
  |  | 2664 | jQuery("#myMediaUploader\_link").click(function (event) { |
  |  | 2665 | event.preventDefault(); |
  |  | 2666 | //If the frame already exists, reopen it |
  |  | 2667 | if (typeof (custom\_file\_frame) !== "undefined") { |
  |  | 2668 | custom\_file\_frame.close(); |
  |  | 2669 | } |
  |  | 2670 |  |
  |  | 2671 | //Create WP media frame. |
  |  | 2672 | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
  |  | 2673 | //Title of media manager frame |
  |  | 2674 | title: "WP Media Uploader", |
  |  | 2675 | library: { |
  |  | 2676 | type: 'image' |
  |  | 2677 | }, |
  |  | 2678 | button: { |
  |  | 2679 | //Button text |
  |  | 2680 | text: "Set Image" |
  |  | 2681 | }, |
  |  | 2682 | //Do not allow multiple files, if you want multiple, set true |
  |  | 2683 | multiple: false |
  |  | 2684 | }); |
  |  | 2685 | //callback for selected image |
  |  | 2686 | custom\_file\_frame.on('select', function () { |
  |  | 2687 |  |
  |  | 2688 | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
  |  | 2689 | var validExtensions = new Array(); |
  |  | 2690 | validExtensions[0] = 'jpg'; |
  |  | 2691 | validExtensions[1] = 'jpeg'; |
  |  | 2692 | validExtensions[2] = 'png'; |
  |  | 2693 | validExtensions[3] = 'gif'; |
  |  | 2694 |  |
  |  | 2695 | var inarr = parseInt(jQuery.inArray(attachment.subtype, validExtensions)); |
  |  | 2696 | if (inarr > 0 && attachment.type.toLowerCase() == 'image') { |
  |  | 2697 |  |
  |  | 2698 | var titleTouse = ""; |
  |  | 2699 |  |
  |  | 2700 | if (jQuery.trim(attachment.title) != '') { |
  |  | 2701 |  |
  |  | 2702 | titleTouse = jQuery.trim(attachment.title); |
  |  | 2703 | } else if (jQuery.trim(attachment.caption) != '') { |
  |  | 2704 |  |
  |  | 2705 | titleTouse = jQuery.trim(attachment.caption); |
  |  | 2706 | } |
  |  | 2707 |  |
  |  | 2708 |  |
  |  | 2709 |  |
  |  | 2710 | jQuery("#addlink\_ #title").val(titleTouse); |
  |  | 2711 |  |
  |  | 2712 | if (attachment.id != '') { |
  |  | 2713 |  |
  |  | 2714 | jQuery("#HdnMediaSelection\_link").val(attachment.url); |
  |  | 2715 | jQuery("#img\_disp\_link").attr('src', attachment.url); |
  |  | 2716 |  |
  |  | 2717 | } |
  |  | 2718 |  |
  |  | 2719 | } else { |
  |  | 2720 |  |
  |  | 2721 | alert('Invalid image selection.'); |
  |  | 2722 | } |
  |  | 2723 | //do something with attachment variable, for example attachment.filename |
  |  | 2724 | //Object: |
  |  | 2725 | //attachment.alt - image alt |
  |  | 2726 | //attachment.author - author id |
  |  | 2727 | //attachment.caption |
  |  | 2728 | //attachment.dateFormatted - date of image uploaded |
  |  | 2729 | //attachment.description |
  |  | 2730 | //attachment.editLink - edit link of media |
  |  | 2731 | //attachment.filename |
  |  | 2732 | //attachment.height |
  |  | 2733 | //attachment.icon - don't know WTF?)) |
  |  | 2734 | //attachment.id - id of attachment |
  |  | 2735 | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
  |  | 2736 | //attachment.menuOrder |
  |  | 2737 | //attachment.mime - mime type, for example image/jpeg" |
  |  | 2738 | //attachment.name - name of attachment file, for example "my-image" |
  |  | 2739 | //attachment.status - usual is "inherit" |
  |  | 2740 | //attachment.subtype - "jpeg" if is "jpg" |
  |  | 2741 | //attachment.title |
  |  | 2742 | //attachment.type - "image" |
  |  | 2743 | //attachment.uploadedTo |
  |  | 2744 | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
  |  | 2745 | //attachment.width |
  |  | 2746 | }); |
  |  | 2747 | //Open modal |
  |  | 2748 | custom\_file\_frame.open(); |
  |  | 2749 | }); |
  |  | 2750 |  |
  |  | 2751 | </script> |
  |  | 2752 | </div> |
  |  | 2753 |  |
  |  | 2754 | <div class="stuffbox" id="namediv" style="width: 100%"> |
  |  | 2755 | <h3> |
  |  | 2756 | <label for="link\_name"><?php echo \_\_('Link Title', 'responsive-filterable-portfolio'); ?> (<span |
  |  | 2757 | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Used into Caption', 'responsive-filterable-portfolio'); ?></span>) |
  |  | 2758 | </label> |
  |  | 2759 | </h3> |
  |  | 2760 | <div class="inside"> |
  |  | 2761 | <div> |
  |  | 2762 | <input type="text" id="title" tabindex="1" size="30" name="title" value="<?php echo $videotitle; ?>"> |
  |  | 2763 | </div> |
  |  | 2764 | <div style="clear: both"></div> |
  |  | 2765 | <div></div> |
  |  | 2766 | <div style="clear: both"></div> |
  |  | 2767 | </div> |
  |  | 2768 | </div> |
  |  | 2769 | <div class="stuffbox" id="namediv" style="width: 100%"> |
  |  | 2770 | <h3> |
  |  | 2771 | <label for="link\_name"><?php echo \_\_('Link Url', 'responsive-filterable-portfolio'); ?> (<span |
  |  | 2772 | style="font-size: 11px; font-weight: normal"><?php echo \_\_('click on image will redirect to this url.', 'responsive-filterable-portfolio'); ?></span>) |
  |  | 2773 | </label> |
  |  | 2774 | </h3> |
  |  | 2775 | <div class="inside"> |
  |  | 2776 | <div> |
  |  | 2777 | <input type="text" id="murl" |
  |  | 2778 | tabindex="1" size="30" name="murl" |
  |  | 2779 | value="<?php echo $murl; ?>"> |
  |  | 2780 | </div> |
  |  | 2781 | <div style="clear: both"></div> |
  |  | 2782 | <div></div> |
  |  | 2783 | <div style="clear: both"></div> |
  |  | 2784 |  |
  |  | 2785 | </div> |
  |  | 2786 | </div> |
  |  | 2787 | <div class="stuffbox" id="namediv" style="width: 100%"> |
  |  | 2788 | <h3> |
  |  | 2789 | <label for="mtag"><?php echo \_\_('Media Tags', 'responsive-filterable-portfolio'); ?> (<span |
  |  | 2790 | style="font-size: 11px; font-weight: normal"><?php echo \_\_(' Tags used for filter on grid.You can add comma separated values.', 'responsive-filterable-portfolio'); ?></span>) |
  |  | 2791 | </label> |
  |  | 2792 | </h3> |
  |  | 2793 | <div class="inside"> |
  |  | 2794 | <div> |
  |  | 2795 | <input type="text" id="mtag" |
  |  | 2796 | tabindex="1" size="30" name="mtag" |
  |  | 2797 | value="<?php echo $mtag; ?>"> |
  |  | 2798 | </div> |
  |  | 2799 | <div style="clear: both"></div> |
  |  | 2800 | <div></div> |
  |  | 2801 | <div style="clear: both"></div> |
  |  | 2802 |  |
  |  | 2803 | </div> |
  |  | 2804 | </div> |
  |  | 2805 |  |
  |  | 2806 |  |
  |  | 2807 | <?php if (isset($\_GET['id']) && (int) $\_GET['id'] > 0) { ?> |
  |  | 2808 | <input type="hidden" name="linkid" id="linkid" value="<?php echo (int) $\_GET['id']; ?>"> |
  |  | 2809 | <?php |
  |  | 2810 | } |
  |  | 2811 | ?> |
  |  | 2812 | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
  |  | 2813 | <input type="submit" |
  |  | 2814 | onclick="" name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes', 'responsive-filterable-portfolio'); ?>" |
  |  | 2815 | class="button-primary">&nbsp;&nbsp;<input type="button" |
  |  | 2816 | name="cancle" id="cancle" value="<?php echo \_\_('Cancel', 'responsive-filterable-portfolio'); ?>" |
  |  | 2817 | class="button-primary" |
  |  | 2818 | onclick="location.href = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'"> |
  |  | 2819 |  |
  |  | 2820 | </form> |
  |  | 2821 | <script type="text/javascript"> |
  |  | 2822 |  |
  |  | 2823 | jQuery(document).ready(function () { |
  |  | 2824 |  |
  |  | 2825 | jQuery.validator.setDefaults({ |
  |  | 2826 | ignore: [], |
  |  | 2827 | // any other default options and/or rules |
  |  | 2828 | }); |
  |  | 2829 |  |
  |  | 2830 | jQuery("#addvideo").validate({ |
  |  | 2831 | rules: { |
  |  | 2832 | videotitle: { |
  |  | 2833 | required: true, |
  |  | 2834 | maxlength: 200 |
  |  | 2835 | }, |
  |  | 2836 | vtype: { |
  |  | 2837 | required: true |
  |  | 2838 |  |
  |  | 2839 | }, |
  |  | 2840 | videourl: { |
  |  | 2841 | required: true, |
  |  | 2842 | url: true, |
  |  | 2843 | maxlength: 500 |
  |  | 2844 | }, |
  |  | 2845 | HdnMediaSelection: { |
  |  | 2846 | required: true |
  |  | 2847 | }, |
  |  | 2848 | videotitleurl: { |
  |  | 2849 |  |
  |  | 2850 | url: true, |
  |  | 2851 | maxlength: 500 |
  |  | 2852 | }, |
  |  | 2853 | mtag: { |
  |  | 2854 | maxlength: 5000 |
  |  | 2855 | } |
  |  | 2856 | }, |
  |  | 2857 | errorClass: "image\_error", |
  |  | 2858 | errorPlacement: function (error, element) { |
  |  | 2859 | error.appendTo(element.parent().next().next()); |
  |  | 2860 | }, messages: { |
  |  | 2861 | HdnMediaSelection: "Please select video thumbnail or Upload by wordpress media uploader.", |
  |  | 2862 |  |
  |  | 2863 | } |
  |  | 2864 |  |
  |  | 2865 | }) |
  |  | 2866 |  |
  |  | 2867 |  |
  |  | 2868 | jQuery("#addimage\_").validate({ |
  |  | 2869 | rules: { |
  |  | 2870 | HdnMediaSelection\_image: { |
  |  | 2871 | required: true |
  |  | 2872 | }, |
  |  | 2873 | murl: { |
  |  | 2874 | maxlength: 500 |
  |  | 2875 | }, |
  |  | 2876 | mtag: { |
  |  | 2877 | maxlength: 5000 |
  |  | 2878 | } |
  |  | 2879 | }, |
  |  | 2880 | errorClass: "image\_error", |
  |  | 2881 | errorPlacement: function (error, element) { |
  |  | 2882 | error.appendTo(element.parent().next().next()); |
  |  | 2883 | }, messages: { |
  |  | 2884 | HdnMediaSelection: "Please select image thumbnail or Upload by wordpress media uploader.", |
  |  | 2885 |  |
  |  | 2886 | } |
  |  | 2887 |  |
  |  | 2888 | }) |
  |  | 2889 | jQuery("#addlink\_").validate({ |
  |  | 2890 | rules: { |
  |  | 2891 | HdnMediaSelection\_link: { |
  |  | 2892 | required: true |
  |  | 2893 | }, |
  |  | 2894 | murl: { |
  |  | 2895 | required: true, |
  |  | 2896 | maxlength: 500 |
  |  | 2897 | }, |
  |  | 2898 | mtag: { |
  |  | 2899 | maxlength: 5000 |
  |  | 2900 | } |
  |  | 2901 | }, |
  |  | 2902 | errorClass: "image\_error", |
  |  | 2903 | errorPlacement: function (error, element) { |
  |  | 2904 | error.appendTo(element.parent().next().next()); |
  |  | 2905 | }, messages: { |
  |  | 2906 | HdnMediaSelection: "Please select link thumbnail or Upload by wordpress media uploader.", |
  |  | 2907 |  |
  |  | 2908 | } |
  |  | 2909 |  |
  |  | 2910 |  |
  |  | 2911 |  |
  |  | 2912 | }) |
  |  | 2913 |  |
  |  | 2914 |  |
  |  | 2915 | }); |
  |  | 2916 |  |
  |  | 2917 |  |
  |  | 2918 | </script> |
  |  | 2919 |  |
  |  | 2920 | </div> |
  |  | 2921 | </div> |
  |  | 2922 | </div> |
  |  | 2923 | </div> |
  |  | 2924 | </div> |
  |  | 2925 | <div id="postbox-container-1" class="postbox-container" > |
  | 3028 | 2926 |  |
  | 3029 | 2927 | <div class="postbox"> |
  | 3030 |  | <h3 class="hndle"><span></span><?php echo \_\_('Access All Themes In One Price',~~'responsive-filterable-portfolio');~~?></h3> |
  |  | 2928 | <h3 class="hndle"><span></span><?php echo \_\_('Access All Themes In One Price', 'responsive-filterable-portfolio'); ?></h3> |
  | 3031 | 2929 | <div class="inside"> |
  | 3032 | 2930 | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"> |
  | 3033 |  | <img border="0" src="<?php echo plugins\_url(~~'images/300x250.gif', \_\_FILE\_\_ );~~?>" width="250" height="250"> |
  |  | 2931 | <img border="0" src="<?php echo plugins\_url('images/300x250.gif', \_\_FILE\_\_); ?>" width="250" height="250"> |
  | 3034 | 2932 | </a></center> |
  | 3035 | 2933 |  |
  | […](/browser/responsive-filterable-portfolio/tags/1.0.19/wp-best-portfolio.php?rev=2670726#L3039) | […](/browser/responsive-filterable-portfolio/tags/1.0.20/wp-best-portfolio.php?rev=2899431#L2937) |  |
  | 3039 | 2937 | </div></div> |
  | 3040 | 2938 | <div class="postbox"> |
  | 3041 |  | <h3 class="hndle"><span></span><?php echo \_\_('Google For Business Coupon','video-grid');?></h3> |
  | 3042 |  | <div class="inside"> |
  | 3043 |  | <center><a href="https://goo.gl/OJBuHT" target="\_blank"> |
  | 3044 |  | <img src="<?php echo plugins\_url( 'images/g-suite-promo-code-4.png', \_\_FILE\_\_ );?>" width="250" height="250" border="0"> |
  | 3045 |  | </a></center> |
  | 3046 |  | <div style="margin:10px 5px"> |
  | 3047 |  | </div> |
  |  | 2939 | <h3 class="hndle"><span></span><?php echo \_\_('Google For Business Coupon', 'video-grid'); ?></h3> |
  |  | 2940 | <div class="inside"> |
  |  | 2941 | <center><a href="https://goo.gl/OJBuHT" target="\_blank"> |
  |  | 2942 | <img src="<?php echo plugins\_url('images/g-suite-promo-code-4.png', \_\_FILE\_\_); ?>" width="250" height="250" border="0"> |
  |  | 2943 | </a></center> |
  |  | 2944 | <div style="margin:10px 5px"> |
  | 3048 | 2945 | </div> |
  | 3049 |  |  |
  | 3050 | 2946 | </div> |
  | 3051 | 2947 |  |
  |  | 2948 | </div> |
  |  | 2949 |  |
  | 3052 | 2950 | </div> |
  | 3053 |  | </div> |
  | 3054 |  | </div> |
  | 3055 |  | <?php |
  | 3056 |  | } |
  | 3057 |  | } else if (strtolower ( $action ) == strtolower ( 'delete' )) { |
  | 3058 |  |  |
  | 3059 |  | $retrieved\_nonce = ''; |
  | 3060 |  |  |
  | 3061 |  | if(isset($\_GET['nonce']) and $\_GET['nonce']!=''){ |
  | 3062 |  |  |
  | 3063 |  | $retrieved\_nonce=$\_GET['nonce']; |
  | 3064 |  |  |
  | 3065 |  | } |
  | 3066 |  | if (!wp\_verify\_nonce($retrieved\_nonce, 'delete\_image' ) ){ |
  | 3067 |  |  |
  | 3068 |  |  |
  | 3069 |  | wp\_die('Security check fail'); |
  | 3070 |  | } |
  | 3071 |  |  |
  | 3072 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_delete\_media' ) ) { |
  | 3073 |  |  |
  | 3074 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 3075 |  | $wp\_best\_portfolio\_msg = array (); |
  | 3076 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 3077 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator','responsive-filterable-portfolio'); |
  | 3078 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 3079 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 3080 |  | exit (); |
  | 3081 |  |  |
  | 3082 |  |  |
  | 3083 |  | } |
  | 3084 |  | $uploads = wp\_upload\_dir (); |
  | 3085 |  | $baseDir = $uploads ['basedir']; |
  | 3086 |  | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
  | 3087 |  | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  | 3088 |  |  |
  | 3089 |  |  |
  | 3090 |  |  |
  | 3091 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 3092 |  | $deleteId = (int) htmlentities(sanitize\_text\_field($\_GET ['id']),ENT\_QUOTES); |
  | 3093 |  |  |
  | 3094 |  | try { |
  | 3095 |  |  |
  | 3096 |  | $query = "SELECT \* FROM " . $wpdb->prefix . "e\_portfolio WHERE id=$deleteId"; |
  | 3097 |  | $myrow = $wpdb->get\_row ( $query ); |
  | 3098 |  |  |
  | 3099 |  | $settings = get\_option( 'best\_portfolio\_grid\_settings' ); |
  |  | 2951 | </div> |
  |  | 2952 | </div> |
  |  | 2953 | <?php |
  |  | 2954 | } |
  |  | 2955 | } else if (strtolower($action) == strtolower('delete')) { |
  |  | 2956 |  |
  |  | 2957 | $retrieved\_nonce = ''; |
  |  | 2958 |  |
  |  | 2959 | if (isset($\_GET['nonce']) && $\_GET['nonce'] != '') { |
  |  | 2960 |  |
  |  | 2961 | $retrieved\_nonce = sanitize\_text\_field($\_GET['nonce']); |
  |  | 2962 | } |
  |  | 2963 | if (!wp\_verify\_nonce($retrieved\_nonce, 'delete\_image')) { |
  |  | 2964 |  |
  |  | 2965 |  |
  |  | 2966 | wp\_die('Security check fail'); |
  |  | 2967 | } |
  |  | 2968 |  |
  |  | 2969 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_delete\_media')) { |
  |  | 2970 |  |
  |  | 2971 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 2972 | $wp\_best\_portfolio\_msg = array(); |
  |  | 2973 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 2974 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator', 'responsive-filterable-portfolio'); |
  |  | 2975 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 2976 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 2977 | exit(); |
  |  | 2978 | } |
  |  | 2979 | $uploads = wp\_upload\_dir(); |
  |  | 2980 | $baseDir = $uploads ['basedir']; |
  |  | 2981 | $baseDir = str\_replace('\\', '/', $baseDir); |
  |  | 2982 | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  |  | 2983 |  |
  |  | 2984 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 2985 | $deleteId = (int) htmlentities(sanitize\_text\_field($\_GET ['id']), ENT\_QUOTES); |
  |  | 2986 |  |
  |  | 2987 | try { |
  |  | 2988 |  |
  |  | 2989 | $query = 'SELECT \* FROM ' . $wpdb->prefix . "e\_portfolio WHERE id=$deleteId"; |
  |  | 2990 | $myrow = $wpdb->get\_row($query); |
  |  | 2991 |  |
  |  | 2992 | $settings = get\_option('best\_portfolio\_grid\_settings'); |
  |  | 2993 | $imageheight = $settings ['imageheight']; |
  |  | 2994 | $imagewidth = $settings ['imagewidth']; |
  |  | 2995 |  |
  |  | 2996 | if (is\_object($myrow)) { |
  |  | 2997 |  |
  |  | 2998 | $image\_name = $myrow->image\_name; |
  |  | 2999 | $wpcurrentdir = dirname(\_\_FILE\_\_); |
  |  | 3000 | $wpcurrentdir = str\_replace('\\', '/', $wpcurrentdir); |
  |  | 3001 | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
  |  | 3002 | $pInfo = pathinfo($myrow->HdnMediaSelection); |
  |  | 3003 | $ext = $pInfo ['extension']; |
  |  | 3004 |  |
  |  | 3005 | @unlink($imagetoDel); |
  |  | 3006 | @unlink($pathToImagesFolder . '/' . $myrow->vid . '\_big\_' . $imageheight . '\_' . $imagewidth . '.' . $ext); |
  |  | 3007 |  |
  |  | 3008 | $query = 'delete from  ' . $wpdb->prefix . "e\_portfolio where id=$deleteId"; |
  |  | 3009 | $wpdb->query($query); |
  |  | 3010 |  |
  |  | 3011 | $wp\_best\_portfolio\_msg = array(); |
  |  | 3012 | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  |  | 3013 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Video deleted successfully.', 'responsive-filterable-portfolio'); |
  |  | 3014 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 3015 | } |
  |  | 3016 | } catch (Exception $e) { |
  |  | 3017 |  |
  |  | 3018 | $wp\_best\_portfolio\_msg = array(); |
  |  | 3019 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 3020 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while deleting video.', 'responsive-filterable-portfolio'); |
  |  | 3021 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 3022 | } |
  |  | 3023 |  |
  |  | 3024 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 3025 | exit(); |
  |  | 3026 | } else if (strtolower($action) == strtolower('deleteselected')) { |
  |  | 3027 |  |
  |  | 3028 |  |
  |  | 3029 | if (!check\_admin\_referer('action\_settings\_mass\_delete', 'mass\_delete\_nonce')) { |
  |  | 3030 |  |
  |  | 3031 | wp\_die('Security check fail'); |
  |  | 3032 | } |
  |  | 3033 |  |
  |  | 3034 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_delete\_media')) { |
  |  | 3035 |  |
  |  | 3036 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 3037 | $wp\_best\_portfolio\_msg = array(); |
  |  | 3038 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 3039 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator', 'responsive-filterable-portfolio'); |
  |  | 3040 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 3041 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 3042 | exit(); |
  |  | 3043 | } |
  |  | 3044 |  |
  |  | 3045 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 3046 |  |
  |  | 3047 | if (isset($\_POST) && isset($\_POST ['deleteselected']) && ( $\_POST ['action'] == 'delete' or $\_POST ['action\_upper'] == 'delete' )) { |
  |  | 3048 |  |
  |  | 3049 | $uploads = wp\_upload\_dir(); |
  |  | 3050 | $baseDir = $uploads ['basedir']; |
  |  | 3051 | $baseDir = str\_replace('\\', '/', $baseDir); |
  |  | 3052 | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  |  | 3053 |  |
  |  | 3054 | if (sizeof($\_POST ['thumbnails']) > 0) { |
  |  | 3055 |  |
  |  | 3056 | $deleteto = $\_POST ['thumbnails']; |
  |  | 3057 | $implode = implode(',', $deleteto); |
  |  | 3058 |  |
  |  | 3059 | try { |
  |  | 3060 |  |
  |  | 3061 | foreach ($deleteto as $img) { |
  |  | 3062 |  |
  |  | 3063 | $img = intval($img); |
  |  | 3064 | $query = 'SELECT \* FROM ' . $wpdb->prefix . "e\_portfolio WHERE id=$img"; |
  |  | 3065 | $myrow = $wpdb->get\_row($query); |
  |  | 3066 |  |
  |  | 3067 | $settings = get\_option('best\_portfolio\_grid\_settings'); |
  | 3100 | 3068 | $imageheight = $settings ['imageheight']; |
  | 3101 | 3069 | $imagewidth = $settings ['imagewidth']; |
  | 3102 | 3070 |  |
  | 3103 |  | if (is\_object ( $myrow )) { |
  | 3104 |  |  |
  | 3105 |  | $image\_name = $myrow->image\_name; |
  | 3106 |  | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
  | 3107 |  | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
  | 3108 |  | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
  | 3109 |  | $pInfo = pathinfo ( $myrow->HdnMediaSelection ); |
  | 3110 |  | $ext = $pInfo ['extension']; |
  | 3111 |  |  |
  | 3112 |  | @unlink ( $imagetoDel ); |
  | 3113 |  | @unlink($pathToImagesFolder.'/'.$myrow->vid . '\_big\_'.$imageheight.'\_'.$imagewidth.'.'.$ext); |
  | 3114 |  |  |
  | 3115 |  | $query = "delete from  " . $wpdb->prefix . "e\_portfolio where id=$deleteId"; |
  | 3116 |  | $wpdb->query ( $query ); |
  | 3117 |  |  |
  | 3118 |  | $wp\_best\_portfolio\_msg = array (); |
  | 3119 |  | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  | 3120 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Video deleted successfully.','responsive-filterable-portfolio'); |
  | 3121 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 3122 |  | } |
  | 3123 |  | } catch ( Exception $e ) { |
  | 3124 |  |  |
  | 3125 |  | $wp\_best\_portfolio\_msg = array (); |
  | 3126 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 3127 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while deleting video.','responsive-filterable-portfolio'); |
  | 3128 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 3129 |  | } |
  | 3130 |  |  |
  | 3131 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 3132 |  | exit (); |
  | 3133 |  | } else if (strtolower ( $action ) == strtolower ( 'deleteselected' )) { |
  | 3134 |  |  |
  | 3135 |  |  |
  | 3136 |  | if(!check\_admin\_referer('action\_settings\_mass\_delete','mass\_delete\_nonce')){ |
  | 3137 |  |  |
  | 3138 |  | wp\_die('Security check fail'); |
  | 3139 |  | } |
  | 3140 |  |  |
  | 3141 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_delete\_media' ) ) { |
  | 3142 |  |  |
  | 3143 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 3144 |  | $wp\_best\_portfolio\_msg = array (); |
  | 3145 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 3146 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator','responsive-filterable-portfolio'); |
  | 3147 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 3148 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 3149 |  | exit (); |
  | 3150 |  |  |
  | 3151 |  |  |
  |  | 3071 | if (is\_object($myrow)) { |
  |  | 3072 |  |
  |  | 3073 | $image\_name = $myrow->image\_name; |
  |  | 3074 | $wpcurrentdir = dirname(\_\_FILE\_\_); |
  |  | 3075 | $wpcurrentdir = str\_replace('\\', '/', $wpcurrentdir); |
  |  | 3076 | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
  |  | 3077 |  |
  |  | 3078 | $pInfo = pathinfo($myrow->HdnMediaSelection); |
  |  | 3079 | $ext = $pInfo ['extension']; |
  |  | 3080 |  |
  |  | 3081 | @unlink($imagetoDel); |
  |  | 3082 | @unlink($pathToImagesFolder . '/' . $myrow->vid . '\_big\_' . $imageheight . '\_' . $imagewidth . '.' . $ext); |
  |  | 3083 |  |
  |  | 3084 | $query = 'delete from  ' . $wpdb->prefix . "e\_portfolio where id=$img"; |
  |  | 3085 | $wpdb->query($query); |
  |  | 3086 |  |
  |  | 3087 | $wp\_best\_portfolio\_msg = array(); |
  |  | 3088 | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  |  | 3089 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Selected videos deleted successfully.', 'responsive-filterable-portfolio'); |
  |  | 3090 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 3091 | } |
  |  | 3092 | } |
  |  | 3093 | } catch (Exception $e) { |
  |  | 3094 |  |
  |  | 3095 | $wp\_best\_portfolio\_msg = array(); |
  |  | 3096 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 3097 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while deleting videos.', 'responsive-filterable-portfolio'); |
  |  | 3098 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  | 3152 | 3099 | } |
  | 3153 |  |  |
  | 3154 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 3155 |  |  |
  | 3156 |  | if (isset ( $\_POST ) and isset ( $\_POST ['deleteselected'] ) and ($\_POST ['action'] == 'delete' or $\_POST ['action\_upper'] == 'delete')) { |
  | 3157 |  |  |
  | 3158 |  | $uploads = wp\_upload\_dir (); |
  | 3159 |  | $baseDir = $uploads ['basedir']; |
  | 3160 |  | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
  | 3161 |  | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  | 3162 |  |  |
  | 3163 |  | if (sizeof ( $\_POST ['thumbnails'] ) > 0) { |
  | 3164 |  |  |
  | 3165 |  | $deleteto = $\_POST ['thumbnails']; |
  | 3166 |  | $implode = implode ( ',', $deleteto ); |
  | 3167 |  |  |
  | 3168 |  | try { |
  | 3169 |  |  |
  | 3170 |  | foreach ( $deleteto as $img ) { |
  | 3171 |  |  |
  | 3172 |  | $img=intval($img); |
  | 3173 |  | $query = "SELECT \* FROM " . $wpdb->prefix . "e\_portfolio WHERE id=$img"; |
  | 3174 |  | $myrow = $wpdb->get\_row ( $query ); |
  | 3175 |  |  |
  | 3176 |  | $settings = get\_option( 'best\_portfolio\_grid\_settings' ); |
  | 3177 |  | $imageheight = $settings ['imageheight']; |
  | 3178 |  | $imagewidth = $settings ['imagewidth']; |
  | 3179 |  |  |
  | 3180 |  |  |
  | 3181 |  | if (is\_object ( $myrow )) { |
  | 3182 |  |  |
  | 3183 |  | $image\_name = $myrow->image\_name ; |
  | 3184 |  | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
  | 3185 |  | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
  | 3186 |  | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
  | 3187 |  |  |
  | 3188 |  | $pInfo = pathinfo ( $myrow->HdnMediaSelection ); |
  | 3189 |  | $ext = $pInfo ['extension']; |
  | 3190 |  |  |
  | 3191 |  | @unlink ( $imagetoDel ); |
  | 3192 |  | @unlink($pathToImagesFolder.'/'.$myrow->vid . '\_big\_'.$imageheight.'\_'.$imagewidth.'.'.$ext); |
  | 3193 |  |  |
  | 3194 |  |  |
  | 3195 |  | $query = "delete from  " . $wpdb->prefix . "e\_portfolio where id=$img"; |
  | 3196 |  | $wpdb->query ( $query ); |
  | 3197 |  |  |
  | 3198 |  | $wp\_best\_portfolio\_msg = array (); |
  | 3199 |  | $wp\_best\_portfolio\_msg ['type'] = 'succ'; |
  | 3200 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Selected videos deleted successfully.','responsive-filterable-portfolio'); |
  | 3201 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 3202 |  | } |
  | 3203 |  | } |
  | 3204 |  | } catch ( Exception $e ) { |
  | 3205 |  |  |
  | 3206 |  | $wp\_best\_portfolio\_msg = array (); |
  | 3207 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 3208 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Error while deleting videos.','responsive-filterable-portfolio'); |
  | 3209 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 3210 |  | } |
  | 3211 |  |  |
  | 3212 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 3213 |  | exit (); |
  | 3214 |  | } else { |
  | 3215 |  |  |
  | 3216 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 3217 |  | exit (); |
  | 3218 |  | } |
  | 3219 |  | } else { |
  | 3220 |  |  |
  | 3221 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 3222 |  | exit (); |
  | 3223 |  | } |
  | 3224 |  | } |
  |  | 3100 |  |
  |  | 3101 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 3102 | exit(); |
  |  | 3103 | } else { |
  |  | 3104 |  |
  |  | 3105 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 3106 | exit(); |
  |  | 3107 | } |
  |  | 3108 | } else { |
  |  | 3109 |  |
  |  | 3110 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 3111 | exit(); |
  |  | 3112 | } |
  |  | 3113 | } |
  | 3225 | 3114 | } |
  |  | 3115 |  |
  | 3226 | 3116 | function rfp\_responsive\_portfolio\_with\_lightbox\_media\_preview\_func() { |
  | 3227 |  |  |
  | 3228 |  | global $wpdb; |
  | 3229 |  |  |
  | 3230 |  | if ( ! current\_user\_can( 'rfp\_filterablel\_portfolio\_preview' ) ) { |
  | 3231 |  |  |
  | 3232 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management"; |
  | 3233 |  | $wp\_best\_portfolio\_msg = array (); |
  | 3234 |  | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  | 3235 |  | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator','responsive-filterable-portfolio'); |
  | 3236 |  | update\_option ( 'wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg ); |
  | 3237 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 3238 |  | exit (); |
  | 3239 |  |  |
  | 3240 |  |  |
  | 3241 |  | } |
  | 3242 |  |  |
  | 3243 |  | $pagenum = isset($\_GET['pagenum']) ? (int) absint($\_GET['pagenum']) : 1; |
  | 3244 |  |  |
  | 3245 |  | $settings = get\_option( 'best\_portfolio\_grid\_settings' ); |
  | 3246 |  |  |
  | 3247 |  | $rand\_Numb = uniqid ( 'thumnail\_slider' ); |
  | 3248 |  | $rand\_Num\_td = uniqid ( 'divSliderMain' ); |
  | 3249 |  | $rand\_var\_name = uniqid ( 'rand\_' ); |
  | 3250 |  |  |
  | 3251 |  | $location = "admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_preview"; |
  | 3252 |  |  |
  | 3253 |  | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
  | 3254 |  | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
  | 3255 |  | // $settings=get\_option('thumbnail\_slider\_settings'); |
  | 3256 |  |  |
  | 3257 |  | $uploads = wp\_upload\_dir (); |
  | 3258 |  | $baseDir = $uploads ['basedir']; |
  | 3259 |  | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
  | 3260 |  | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  | 3261 |  | $baseurl = $uploads ['baseurl']; |
  | 3262 |  | $baseurl .= '/wp-best-portfolio/'; |
  | 3263 |  |  |
  | 3264 |  | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
  | 3265 |  | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
  | 3266 |  | $randOmeAlbName = uniqid ( 'alb\_' ); |
  | 3267 |  | $randOmeRel = uniqid ( 'rel\_' ); |
  | 3268 |  | $randOmVlBox = uniqid('video\_lbox\_'); |
  | 3269 |  | $vNonce = wp\_create\_nonce('vNonce'); |
  | 3270 |  | $url = plugin\_dir\_url(\_\_FILE\_\_); |
  | 3271 |  | $loaderImg = $url . 'images/bx\_loader.gif'; |
  | 3272 |  |  |
  | 3273 |  | $LoadingBackColor=$settings ['BackgroundColor']; |
  | 3274 |  | if(strtolower($LoadingBackColor)=='none'){ |
  | 3275 |  | $LoadingBackColor='#ffffff'; |
  | 3276 |  | } |
  | 3277 |  | if(!isset($settings['resize\_images'])){ |
  | 3278 |  |  |
  | 3279 |  | $settings['resize\_images']=1; |
  | 3280 |  |  |
  | 3281 |  | } |
  | 3282 |  |  |
  | 3283 |  | ?> |
  | 3284 |  | <div id="poststuff" > |
  | 3285 |  | <div id="post-body" class="metabox-holder columns-2" > |
  | 3286 |  |  |
  | 3287 |  | <div class="post-body-content"> |
  | 3288 |  | <span><h3 style="color: blue;"><a target="\_blank" href="http://www.i13websolution.com/wordpress-responsive-media-portfolio-grid.html"><?php echo \_\_('UPGRADE TO PRO VERSION','responsive-filterable-portfolio');?></a></h3></span> |
  | 3289 |  | <h2><?php echo \_\_('Portfolio Preview','responsive-filterable-portfolio');?></h2> |
  | 3290 |  | <br /> |
  | 3291 |  | <?php if (is\_array($settings)) { ?> |
  | 3292 |  | <div id="poststuff"> |
  | 3293 |  | <div id="post-body" class="metabox-holder "> |
  | 3294 |  | <div id="post-body-content"> |
  | 3295 |  | <div style="clear: both;"></div> |
  | 3296 |  | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
  | 3297 |  |  |
  | 3298 |  | <div class="container\_"> |
  | 3299 |  |  |
  | 3300 |  | <div class="gallery\_" id="<?php echo $rand\_var\_name;?>" style="visibility:hidden"> |
  | 3301 |  | <div id="<?php echo $rand\_var\_name; ?>\_overlay\_grid" class="overlay\_grid" style="background: <?php echo $LoadingBackColor; ?> url('<?php echo $loaderImg; ?>') no-repeat scroll 50% 50%;" ></div> |
  | 3302 |  | <div id="<?php echo $rand\_Num\_td; ?>"> |
  | 3303 |  | <?php if($settings['show\_filters']):?> |
  | 3304 |  |  |
  | 3305 |  | <div id="FilerTab" class="fil"> |
  | 3306 |  | <div class="shield\_cli" id="shield\_<?php echo $rand\_var\_name;?>" ></div> |
  | 3307 |  | <?php |
  | 3308 |  | $query = 'SET SESSION group\_concat\_max\_len=150000'; |
  | 3309 |  | $wpdb->query($query); |
  | 3310 |  |  |
  | 3311 |  | $filerValsQuery="select GROUP\_CONCAT(mtag) as filters from |
  | 3312 |  | (SELECT mtag from ".$wpdb->prefix."e\_portfolio  order by createdon,id desc  ) a"; |
  | 3313 |  |  |
  | 3314 |  | $filters=$wpdb->get\_var($filerValsQuery); |
  | 3315 |  | $filtersArr=  explode(",",$filters); |
  | 3316 |  | $filtersArr=array\_unique($filtersArr); |
  | 3317 |  | sort($filtersArr); |
  | 3318 |  |  |
  | 3319 |  |  |
  | 3320 |  | ?> |
  | 3321 |  | <a href="#" class="sortLink selected" data-category="all"><?php echo $settings['AllKeywordTranslate'];?></a> |
  | 3322 |  | <?php foreach($filtersArr as $val):?> |
  | 3323 |  | <?php if(trim($val)!=''): ?> |
  | 3324 |  | <?php |
  | 3325 |  | $val=stripslashes\_deep($val); |
  | 3326 |  | $val=preg\_replace('/\\\\/', '', $val); |
  | 3327 |  | ?> |
  | 3328 |  | <a href="#" class="sortLink" data-category="<?php echo $val;?>"><?php echo $val;?></a> |
  | 3329 |  | <?php endif;?> |
  | 3330 |  | <?php endforeach;?> |
  | 3331 |  | <div class="clear\_floats"></div> |
  | 3332 |  | </div> |
  | 3333 |  | <?php endif;?> |
  | 3334 |  | <div class="photos"> |
  | 3335 |  |  |
  | 3336 |  | <div class="thumbnail\_wrap\_"> |
  | 3337 |  |  |
  | 3338 |  | <?php |
  | 3339 |  |  |
  | 3340 |  | $imageheight = $settings ['imageheight']; |
  | 3341 |  | $imagewidth = $settings ['imagewidth']; |
  | 3342 |  | $query = "SELECT \* FROM " . $wpdb->prefix . "e\_portfolio   order by createdon,id desc"; |
  | 3343 |  | $firstChild='firstimg'; |
  | 3344 |  | $rows = $wpdb->get\_results ( $query, 'ARRAY\_A' ); |
  | 3345 |  |  |
  | 3346 |  |  |
  | 3347 |  | if (count ( $rows ) > 0) { |
  | 3348 |  |  |
  | 3349 |  | foreach ( $rows as $row ) { |
  | 3350 |  |  |
  | 3351 |  | $imagename = $row ['image\_name']; |
  | 3352 |  | $video\_url = $row ['videourl']; |
  | 3353 |  | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  | 3354 |  | $imageUploadTo = str\_replace ( "\\", "/", $imageUploadTo ); |
  | 3355 |  | $pathinfo = pathinfo ( $imageUploadTo ); |
  | 3356 |  | $filenamewithoutextension = $pathinfo ['filename']; |
  | 3357 |  | $outputimg = ""; |
  | 3358 |  |  |
  | 3359 |  | $outputimgmain = $baseurl . $row ['image\_name']; |
  | 3360 |  |  |
  | 3361 |  | if($settings['resize\_images']==0){ |
  | 3362 |  |  |
  | 3363 |  | $outputimg = $baseurl . $row ['image\_name']; |
  | 3364 |  | } |
  | 3365 |  | else{ |
  | 3366 |  |  |
  | 3367 |  | $imagetoCheck = $pathToImagesFolder . '/' . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  | 3368 |  |  |
  | 3369 |  | if (file\_exists ( $imagetoCheck )) { |
  | 3370 |  | $outputimg = $baseurl . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  | 3371 |  | } else { |
  | 3372 |  |  |
  | 3373 |  | if (function\_exists ( 'wp\_get\_image\_editor' )) { |
  | 3374 |  |  |
  | 3375 |  | $image = wp\_get\_image\_editor ( $pathToImagesFolder . "/" . $row ['image\_name'] ); |
  | 3376 |  |  |
  | 3377 |  | if (! is\_wp\_error ( $image )) { |
  | 3378 |  | $image->resize ( $imagewidth, $imageheight, true ); |
  | 3379 |  | $image->save ( $imagetoCheck ); |
  | 3380 |  | $outputimg = $baseurl . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  | 3381 |  | } else { |
  | 3382 |  | $outputimg = $baseurl . $row ['image\_name']; |
  | 3383 |  | } |
  | 3384 |  | } else if (function\_exists ( 'image\_resize' )) { |
  | 3385 |  |  |
  | 3386 |  | $return = image\_resize ( $pathToImagesFolder . "/" . $row ['image\_name'], $imagewidth, $imageheight ); |
  | 3387 |  | if (! is\_wp\_error ( $return )) { |
  | 3388 |  |  |
  | 3389 |  | $isrenamed = rename ( $return, $imagetoCheck ); |
  | 3390 |  | if ($isrenamed) { |
  | 3391 |  | $outputimg = $baseurl . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  | 3392 |  | } else { |
  | 3393 |  | $outputimg = $baseurl . $row ['image\_name']; |
  | 3394 |  | } |
  | 3395 |  | } else { |
  | 3396 |  | $outputimg = $baseurl . $row ['image\_name']; |
  | 3397 |  | } |
  | 3398 |  | } else { |
  | 3399 |  |  |
  | 3400 |  | $outputimg = $baseurl . $row ['image\_name']; |
  | 3401 |  | } |
  | 3402 |  |  |
  | 3403 |  | // $url = plugin\_dir\_url(\_\_FILE\_\_)."imagestoscroll/".$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
  | 3404 |  | } |
  | 3405 |  | } |
  | 3406 |  |  |
  | 3407 |  | $media\_type=$row['media\_type']; |
  | 3408 |  | $hoverClass=''; |
  | 3409 |  | if($media\_type=="link") |
  | 3410 |  | $hoverClass="playbtnCss\_link"; |
  | 3411 |  | else if($media\_type=="video") |
  | 3412 |  | $hoverClass="playbtnCss\_video"; |
  | 3413 |  | else if($media\_type=="image") |
  | 3414 |  | $hoverClass="playbtnCss\_zoom"; |
  | 3415 |  |  |
  | 3416 |  | $title = ""; |
  | 3417 |  | $rowTitle = $row['title']; |
  | 3418 |  | $rowTitle = str\_replace("'", "’", $rowTitle); |
  | 3419 |  | $rowTitle = str\_replace('"', '”', $rowTitle); |
  | 3420 |  |  |
  | 3421 |  |  |
  | 3422 |  |  |
  | 3423 |  | $open\_link\_in = $row['open\_link\_in']; |
  | 3424 |  | $openImageInNewTab = '\_self'; |
  | 3425 |  | $embed\_url=$row['embed\_url']; |
  | 3426 |  | if($media\_type=="video"){ |
  | 3427 |  |  |
  | 3428 |  | if (trim($row['title']) != '' and trim($row['videourl']) != '') { |
  | 3429 |  |  |
  | 3430 |  | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['murl']}'>{$rowTitle}</a>"; |
  | 3431 |  |  |
  | 3432 |  | } else if (trim($row['title']) != '' and trim($row['videourl']) == '') { |
  | 3433 |  |  |
  | 3434 |  | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
  | 3435 |  |  |
  | 3436 |  | } |
  | 3437 |  | } |
  | 3438 |  | else if($media\_type=="image"){ |
  | 3439 |  |  |
  | 3440 |  | if (trim($row['title']) != '' and trim($row['murl']) != '') { |
  | 3441 |  |  |
  | 3442 |  | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['murl']}'>{$rowTitle}</a>"; |
  | 3443 |  |  |
  | 3444 |  | } else if (trim($row['title']) != '' and trim($row['murl']) == '') { |
  | 3445 |  |  |
  | 3446 |  | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
  | 3447 |  |  |
  | 3448 |  | } |
  | 3449 |  |  |
  | 3450 |  | } |
  | 3451 |  |  |
  | 3452 |  | $title= htmlentities($title); |
  | 3453 |  | ?> |
  | 3454 |  |  |
  | 3455 |  | <?php if($media\_type=='image' or $media\_type=='video') :?> |
  | 3456 |  |  |
  | 3457 |  | <?php if ($open\_link\_in == 1): ?> |
  | 3458 |  | <a data-rel="<?php echo $randOmeRel; ?>"  data-type="<?php echo $media\_type;?>" data-overlay="1" data-title="<?php echo $title; ?>" class="thumbnail\_ <?php echo $randOmVlBox; ?> <?php if($media\_type=='video'):?>   iframe <?php endif;?>" data-categories="<?php echo $row['mtag'];?>" href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>" > |
  | 3459 |  | <div class="thum\_div figure" <?php if($settings['resize\_images']==0):?> style="width:<?php echo $imagewidth;?>px;height: <?php echo $imageheight;?>px" <?php endif;?>> |
  | 3460 |  |  |
  | 3461 |  | <img <?php if($settings['resize\_images']==0):?> class="fit\_img"  <?php endif;?>  src="<?php echo $outputimg;?>" alt="<?php echo $rowTitle; ?>"  title="<?php echo $rowTitle;?>" /> |
  | 3462 |  | <div class="<?php echo $hoverClass;?>"></div> |
  | 3463 |  |  |
  | 3464 |  | </div> |
  | 3465 |  | </a> |
  | 3466 |  | <?php else: ?> |
  | 3467 |  |  |
  | 3468 |  | <a   data-type="<?php echo $media\_type;?>" data-title="<?php echo $title; ?>" class="thumbnail\_ " data-categories="<?php echo $row['mtag'];?>" href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>" > |
  | 3469 |  | <div class="thum\_div figure" <?php if($settings['resize\_images']==0):?> style="width:<?php echo $imagewidth;?>px;height: <?php echo $imageheight;?>px" <?php endif;?>> |
  | 3470 |  |  |
  | 3471 |  | <img <?php if($settings['resize\_images']==0):?> class="fit\_img"  <?php endif;?>  src="<?php echo $outputimg;?>" alt="<?php echo $rowTitle; ?>"  title="<?php echo $rowTitle;?>" /> |
  | 3472 |  |  |
  | 3473 |  | <div class="<?php echo $hoverClass;?>"></div> |
  | 3474 |  |  |
  | 3475 |  | </div> |
  | 3476 |  | </a> |
  | 3477 |  | <?php endif;?> |
  | 3478 |  |  |
  | 3479 |  | <?php else:?> |
  | 3480 |  | <a   data-type="<?php echo $media\_type;?>" class="thumbnail\_ " data-categories="<?php echo $row['mtag'];?>" href="<?php echo $row['murl']; ?>" > |
  | 3481 |  | <div class="thum\_div figure" <?php if($settings['resize\_images']==0):?> style="width:<?php echo $imagewidth;?>px;height: <?php echo $imageheight;?>px" <?php endif;?>> |
  | 3482 |  |  |
  | 3483 |  | <img <?php if($settings['resize\_images']==0):?> class="fit\_img"  <?php endif;?>  src="<?php echo $outputimg;?>" alt="<?php echo $rowTitle; ?>"  title="<?php echo $rowTitle;?>" /> |
  | 3484 |  | <div class="<?php echo $hoverClass;?>"></div> |
  | 3485 |  |  |
  | 3486 |  | </div> |
  | 3487 |  | </a> |
  | 3488 |  |  |
  | 3489 |  | <?php endif;?> |
  | 3490 |  |  |
  | 3491 |  | <?php } ?> |
  | 3492 |  |  |
  | 3493 |  | <?php } ?> |
  | 3494 |  |  |
  | 3495 |  | </div><!-- .thumbnail\_wrap end --> |
  | 3496 |  |  |
  | 3497 |  | </div> |
  | 3498 |  |  |
  | 3499 |  | </div> |
  | 3500 |  | <script> |
  | 3501 |  | <?php $uniqId = uniqid(); ?> |
  | 3502 |  | var uniqObj<?php echo $uniqId ?> = jQuery("a[rel='<?php echo $randOmeRel; ?>']"); |
  | 3503 |  |  |
  | 3504 |  | jQuery(document).ready(function() { |
  | 3505 |  |  |
  | 3506 |  |  |
  | 3507 |  |  |
  | 3508 |  | var func=jQuery('#<?php echo $rand\_Num\_td;?>').filterMediank({ |
  | 3509 |  |  |
  | 3510 |  | thumbWidth: <?php echo $settings['imagewidth'];?>, |
  | 3511 |  | thumbHeight: <?php echo $settings['imageheight'];?>, |
  | 3512 |  | thumbsSpacing:<?php echo $settings['imageMargin'];?>, |
  | 3513 |  | galleryId:"<?php echo $rand\_var\_name;?>", |
  | 3514 |  | backgroundColor:"<?php echo $settings['BackgroundColor'];?>" |
  | 3515 |  | }); |
  | 3516 |  | jQuery('#<?php echo $rand\_var\_name;?>').css('visibility','visible') |
  | 3517 |  |  |
  | 3518 |  | var globalTimer = null; |
  | 3519 |  |  |
  | 3520 |  | jQuery(window).resize(function() { |
  | 3521 |  | clearTimeout(globalTimer); |
  | 3522 |  | globalTimer = setTimeout(doneResize, 500); |
  | 3523 |  | }); |
  | 3524 |  |  |
  | 3525 |  | function doneResize(){ |
  | 3526 |  |  |
  | 3527 |  | func.resizeWin('<?php echo $rand\_var\_name;?>'); |
  | 3528 |  | } |
  | 3529 |  |  |
  | 3530 |  | jQuery(".<?php echo $randOmVlBox; ?>").fancybox\_fp({ |
  | 3531 |  |  |
  | 3532 |  | 'overlayColor':'#000000', |
  | 3533 |  | 'padding': 3, |
  | 3534 |  | 'margin': 20, |
  | 3535 |  | 'autoScale': true, |
  | 3536 |  | 'autoDimensions':true, |
  | 3537 |  | 'uniqObj':uniqObj<?php echo $uniqId; ?>, |
  | 3538 |  | 'uniqRel':'<?php echo $randOmeRel; ?>', |
  | 3539 |  | 'transitionIn':'fade', |
  | 3540 |  | 'transitionOut':'fade', |
  | 3541 |  | 'titlePosition': 'outside', |
  | 3542 |  | 'cyclic':true, |
  | 3543 |  | 'hideOnContentClick':false, |
  | 3544 |  | 'width' : 650, |
  | 3545 |  | 'height' : 400, |
  | 3546 |  | 'titleFormat': function(title, currentArray, currentIndex, currentOpts) { |
  | 3547 |  |  |
  | 3548 |  | var currtElem = jQuery('#<?php echo $rand\_Num\_td; ?> a[href="' + currentOpts.href + '"]'); |
  | 3549 |  | var isoverlay = jQuery(currtElem).attr('data-overlay') |
  | 3550 |  |  |
  | 3551 |  | if (isoverlay == "1" && jQuery.trim(title) != ""){ |
  | 3552 |  | return '<span id="fancybox\_fp-title-over">' + title + '</span>'; |
  | 3553 |  | } |
  | 3554 |  | else{ |
  | 3555 |  | return ''; |
  | 3556 |  | } |
  | 3557 |  |  |
  | 3558 |  | } |
  | 3559 |  | }); |
  | 3560 |  |  |
  | 3561 |  |  |
  | 3562 |  | }); |
  | 3563 |  | </script> |
  |  | 3117 |  |
  |  | 3118 | global $wpdb; |
  |  | 3119 |  |
  |  | 3120 | if (!current\_user\_can('rfp\_filterablel\_portfolio\_preview')) { |
  |  | 3121 |  |
  |  | 3122 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_management'; |
  |  | 3123 | $wp\_best\_portfolio\_msg = array(); |
  |  | 3124 | $wp\_best\_portfolio\_msg ['type'] = 'err'; |
  |  | 3125 | $wp\_best\_portfolio\_msg ['message'] = \_\_('Access Denied. Please contact your administrator', 'responsive-filterable-portfolio'); |
  |  | 3126 | update\_option('wp\_best\_portfolio\_msg', $wp\_best\_portfolio\_msg); |
  |  | 3127 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  |  | 3128 | exit(); |
  |  | 3129 | } |
  |  | 3130 |  |
  |  | 3131 | $pagenum = isset($\_GET['pagenum']) ? (int) absint($\_GET['pagenum']) : 1; |
  |  | 3132 |  |
  |  | 3133 | $settings = get\_option('best\_portfolio\_grid\_settings'); |
  |  | 3134 |  |
  |  | 3135 | $rand\_Numb = uniqid('thumnail\_slider'); |
  |  | 3136 | $rand\_Num\_td = uniqid('divSliderMain'); |
  |  | 3137 | $rand\_var\_name = uniqid('rand\_'); |
  |  | 3138 |  |
  |  | 3139 | $location = 'admin.php?page=responsive\_portfolio\_with\_lightbox\_media\_preview'; |
  |  | 3140 |  |
  |  | 3141 | $wpcurrentdir = dirname(\_\_FILE\_\_); |
  |  | 3142 | $wpcurrentdir = str\_replace('\\', '/', $wpcurrentdir); |
  |  | 3143 | // $settings=get\_option('thumbnail\_slider\_settings'); |
  |  | 3144 |  |
  |  | 3145 | $uploads = wp\_upload\_dir(); |
  |  | 3146 | $baseDir = $uploads ['basedir']; |
  |  | 3147 | $baseDir = str\_replace('\\', '/', $baseDir); |
  |  | 3148 | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  |  | 3149 | $baseurl = $uploads ['baseurl']; |
  |  | 3150 | $baseurl .= '/wp-best-portfolio/'; |
  |  | 3151 |  |
  |  | 3152 | $wpcurrentdir = dirname(\_\_FILE\_\_); |
  |  | 3153 | $wpcurrentdir = str\_replace('\\', '/', $wpcurrentdir); |
  |  | 3154 | $randOmeAlbName = uniqid('alb\_'); |
  |  | 3155 | $randOmeRel = uniqid('rel\_'); |
  |  | 3156 | $randOmVlBox = uniqid('video\_lbox\_'); |
  |  | 3157 | $vNonce = wp\_create\_nonce('vNonce'); |
  |  | 3158 | $url = plugin\_dir\_url(\_\_FILE\_\_); |
  |  | 3159 | $loaderImg = $url . 'images/bx\_loader.gif'; |
  |  | 3160 |  |
  |  | 3161 | $LoadingBackColor = $settings ['BackgroundColor']; |
  |  | 3162 | if (strtolower($LoadingBackColor) == 'none') { |
  |  | 3163 | $LoadingBackColor = '#ffffff'; |
  |  | 3164 | } |
  |  | 3165 | if (!isset($settings['resize\_images'])) { |
  |  | 3166 |  |
  |  | 3167 | $settings['resize\_images'] = 1; |
  |  | 3168 | } |
  |  | 3169 | ?> |
  |  | 3170 | <div id="poststuff" > |
  |  | 3171 | <div id="post-body" class="metabox-holder columns-2" > |
  |  | 3172 |  |
  |  | 3173 | <div class="post-body-content"> |
  |  | 3174 | <span><h3 style="color: blue;"><a target="\_blank" href="http://www.i13websolution.com/wordpress-responsive-media-portfolio-grid.html"><?php echo \_\_('UPGRADE TO PRO VERSION', 'responsive-filterable-portfolio'); ?></a></h3></span> |
  |  | 3175 | <h2><?php echo \_\_('Portfolio Preview', 'responsive-filterable-portfolio'); ?></h2> |
  |  | 3176 | <br /> |
  |  | 3177 | <?php if (is\_array($settings)) { ?> |
  |  | 3178 | <div id="poststuff"> |
  |  | 3179 | <div id="post-body" class="metabox-holder "> |
  |  | 3180 | <div id="post-body-content"> |
  |  | 3181 | <div style="clear: both;"></div> |
  |  | 3182 | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
  |  | 3183 |  |
  |  | 3184 | <div class="container\_"> |
  |  | 3185 |  |
  |  | 3186 | <div class="gallery\_" id="<?php echo $rand\_var\_name; ?>" style="visibility:hidden"> |
  |  | 3187 | <div id="<?php echo $rand\_var\_name; ?>\_overlay\_grid" class="overlay\_grid" style="background: <?php echo $LoadingBackColor; ?> url('<?php echo $loaderImg; ?>') no-repeat scroll 50% 50%;" ></div> |
  |  | 3188 | <div id="<?php echo $rand\_Num\_td; ?>"> |
  |  | 3189 | <?php if ($settings['show\_filters']) : ?> |
  |  | 3190 |  |
  |  | 3191 | <div id="FilerTab" class="fil"> |
  |  | 3192 | <div class="shield\_cli" id="shield\_<?php echo $rand\_var\_name; ?>" ></div> |
  |  | 3193 | <?php |
  |  | 3194 | $query = 'SET SESSION group\_concat\_max\_len=150000'; |
  |  | 3195 | $wpdb->query($query); |
  |  | 3196 |  |
  |  | 3197 | $filerValsQuery = 'select GROUP\_CONCAT(mtag) as filters from |
  |  | 3198 | (SELECT mtag from ' . $wpdb->prefix . 'e\_portfolio  order by createdon,id desc  ) a'; |
  |  | 3199 |  |
  |  | 3200 | $filters = $wpdb->get\_var($filerValsQuery); |
  |  | 3201 | $filtersArr = explode(',', $filters); |
  |  | 3202 | $filtersArr = array\_unique($filtersArr); |
  |  | 3203 | sort($filtersArr); |
  |  | 3204 | ?> |
  |  | 3205 | <a href="#" class="sortLink selected" data-category="all"><?php echo $settings['AllKeywordTranslate']; ?></a> |
  |  | 3206 | <?php foreach ($filtersArr as $val) : ?> |
  |  | 3207 | <?php if (trim($val) != '') : ?> |
  |  | 3208 | <?php |
  |  | 3209 | $val = stripslashes\_deep($val); |
  |  | 3210 | $val = preg\_replace('/\\\\/', '', $val); |
  |  | 3211 | ?> |
  |  | 3212 | <a href="#" class="sortLink" data-category="<?php echo $val; ?>"><?php echo $val; ?></a> |
  |  | 3213 | <?php endif; ?> |
  |  | 3214 | <?php endforeach; ?> |
  |  | 3215 | <div class="clear\_floats"></div> |
  | 3564 | 3216 | </div> |
  | 3565 |  |  |
  | 3566 |  | </div> |
  | 3567 |  | <?php if (is\_array($settings)) { ?> |
  | 3568 |  |  |
  | 3569 |  | <h3><?php echo \_\_('To print this video gallery into WordPress Post/Page use below code','responsive-filterable-portfolio');?></h3> |
  | 3570 |  | <input type="text" value='[print\_responsive\_portfolio\_plus\_lightbox] ' |
  | 3571 |  | style="width: 400px; height: 30px" |
  | 3572 |  | onclick="this.focus(); this.select()" /> |
  | 3573 |  | <div class="clear"></div> |
  | 3574 |  | <h3><?php echo \_\_('To print this video gallery into WordPress theme/template PHP files use below code','responsive-filterable-portfolio');?></h3> |
  | 3575 |  | <?php |
  | 3576 |  | $shortcode = '[print\_responsive\_portfolio\_plus\_lightbox]'; |
  | 3577 |  | ?> |
  | 3578 |  | <input type="text" value="&lt;?php echo do\_shortcode('<?php echo htmlentities($shortcode, ENT\_QUOTES); ?>'); ?&gt;" style="width: 400px; height: 30px" onclick="this.focus(); this.select()" /> |
  | 3579 |  | <?php } ?> |
  | 3580 |  |  |
  | 3581 |  | </div> |
  | 3582 |  |  |
  | 3583 |  | </div> |
  | 3584 |  | </div> |
  | 3585 |  | <div id="postbox-container-1" class="postbox-container" > |
  | 3586 |  |  |
  | 3587 |  | <div class="postbox"> |
  | 3588 |  | <h3 class="hndle"><span></span><?php echo \_\_('Access All Themes In One Price','responsive-filterable-portfolio');?></h3> |
  | 3589 |  | <div class="inside"> |
  | 3590 |  | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"> |
  | 3591 |  | <img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_);?>" width="250" height="250"> |
  | 3592 |  | </a></center> |
  | 3593 |  |  |
  | 3594 |  | <div style="margin:10px 5px"> |
  | 3595 |  |  |
  | 3596 |  | </div> |
  | 3597 |  | </div></div> |
  | 3598 |  | <div class="postbox"> |
  | 3599 |  | <h3 class="hndle"><span></span><?php echo \_\_('Google For Business Coupon','responsive-filterable-portfolio');?></h3> |
  | 3600 |  | <div class="inside"> |
  | 3601 |  | <center><a href="https://goo.gl/OJBuHT" target="\_blank"> |
  | 3602 |  | <img src="<?php echo plugins\_url( 'images/g-suite-promo-code-4.png', \_\_FILE\_\_ );?>" width="250" height="250" border="0"> |
  | 3603 |  | </a></center> |
  | 3604 |  | <div style="margin:10px 5px"> |
  | 3605 |  | </div> |
  | 3606 |  | </div> |
  | 3607 |  |  |
  | 3608 |  | </div> |
  | 3609 |  |  |
  | 3610 |  | </div> |
  | 3611 |  | </div> |
  | 3612 |  | </div> |
  | 3613 |  | <div class="clear"></div> |
  | 3614 |  | </div> |
  | 3615 |  |  |
  | 3616 |  | <div class="clear"></div> |
  | 3617 |  | <?php |
  | 3618 |  | } |
  | 3619 |  | } |
  | 3620 |  | function rfp\_print\_responsive\_portfolio\_plus\_lightbox\_func($atts) { |
  | 3621 |  |  |
  | 3622 |  |  |
  | 3623 |  | global $wpdb; |
  | 3624 |  |  |
  | 3625 |  |  |
  | 3626 |  | wp\_enqueue\_style('filterMediank'); |
  | 3627 |  | wp\_enqueue\_style('filterMediank-lbox'); |
  | 3628 |  | wp\_enqueue\_script('jquery'); |
  | 3629 |  | wp\_enqueue\_script('filterMediank'); |
  | 3630 |  | wp\_enqueue\_script('filterMediank-lbox-js'); |
  | 3631 |  |  |
  | 3632 |  | ob\_start(); |
  | 3633 |  | global $wpdb; |
  | 3634 |  |  |
  | 3635 |  |  |
  | 3636 |  | $settings = get\_option( 'best\_portfolio\_grid\_settings' ); |
  | 3637 |  |  |
  | 3638 |  | $rand\_Numb = uniqid ( 'thumnail\_slider' ); |
  | 3639 |  | $rand\_Num\_td = uniqid ( 'divSliderMain' ); |
  | 3640 |  | $rand\_var\_name = uniqid ( 'rand\_' ); |
  | 3641 |  |  |
  | 3642 |  |  |
  | 3643 |  | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
  | 3644 |  | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
  | 3645 |  | // $settings=get\_option('thumbnail\_slider\_settings'); |
  | 3646 |  |  |
  | 3647 |  | $uploads = wp\_upload\_dir (); |
  | 3648 |  | $baseDir = $uploads ['basedir']; |
  | 3649 |  | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
  | 3650 |  | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  | 3651 |  | $baseurl = $uploads ['baseurl']; |
  | 3652 |  | $baseurl .= '/wp-best-portfolio/'; |
  | 3653 |  |  |
  | 3654 |  | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
  | 3655 |  | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
  | 3656 |  | $randOmeAlbName = uniqid ( 'alb\_' ); |
  | 3657 |  | $randOmeRel = uniqid ( 'rel\_' ); |
  | 3658 |  | $randOmVlBox = uniqid('video\_lbox\_'); |
  | 3659 |  | $vNonce = wp\_create\_nonce('vNonce'); |
  | 3660 |  | $url = plugin\_dir\_url(\_\_FILE\_\_); |
  | 3661 |  | $loaderImg = $url . 'images/bx\_loader.gif'; |
  | 3662 |  |  |
  | 3663 |  | $LoadingBackColor=$settings ['BackgroundColor']; |
  | 3664 |  | if(strtolower($LoadingBackColor)=='none'){ |
  | 3665 |  | $LoadingBackColor='#ffffff'; |
  | 3666 |  | } |
  | 3667 |  |  |
  | 3668 |  | if (is\_array($settings)) { ?> |
  | 3669 |  |  |
  | 3670 |  | <?php |
  | 3671 |  |  |
  | 3672 |  | if(!isset($settings['resize\_images'])){ |
  | 3673 |  |  |
  | 3674 |  | $settings['resize\_images']=1; |
  | 3675 |  |  |
  | 3676 |  | } |
  | 3677 |  | ?> |
  | 3678 |  | <div style="clear: both;"></div> |
  | 3679 |  | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
  | 3680 |  |  |
  | 3681 |  | <div class="container\_"> |
  | 3682 |  |  |
  | 3683 |  | <div class="gallery\_" id="<?php echo $rand\_var\_name;?>" style="visibility:hidden"> |
  | 3684 |  | <div id="<?php echo $rand\_var\_name; ?>\_overlay\_grid" class="overlay\_grid" style="background: <?php echo $LoadingBackColor; ?> url('<?php echo $loaderImg; ?>') no-repeat scroll 50% 50%;" ></div> |
  | 3685 |  | <div id="<?php echo $rand\_Num\_td; ?>"> |
  | 3686 |  | <?php if($settings['show\_filters']):?> |
  | 3687 |  |  |
  | 3688 |  | <div id="FilerTab" class="fil"> |
  | 3689 |  | <div class="shield\_cli" id="shield\_<?php echo $rand\_var\_name;?>" ></div> |
  |  | 3217 | <?php endif; ?> |
  |  | 3218 | <div class="photos"> |
  |  | 3219 |  |
  |  | 3220 | <div class="thumbnail\_wrap\_"> |
  |  | 3221 |  |
  | 3690 | 3222 | <?php |
  | 3691 |  | ~~$query = 'SET SESSION group\_concat\_max\_len=150000';~~ |
  | 3692 |  | ~~$wpdb->query($query);~~ |
  | 3693 |  |  |
  | 3694 |  | ~~$filerValsQuery="select GROUP\_CONCAT(mtag) as filters from~~ |
  | 3695 |  | ~~(SELECT mtag from ".$wpdb->prefix."e\_portfolio  order by createdon,id desc ) a";~~ |
  | 3696 |  |  |
  | 3697 |  | ~~$filters=$wpdb->get\_var($filerValsQuery);~~ |
  | 3698 |  | ~~$filtersArr=  explode(",",$filters);~~ |
  | 3699 |  | ~~$filtersArr=array\_unique($filtersArr);~~ |
  | 3700 |  | ~~sort($filtersArr);~~ |
  | 3701 |  |  |
  | 3702 |  |  |
  | 3703 |  | ~~?>~~ |
  | 3704 |  | ~~<a href="#" class="sortLink selected" data-category="all"><?php echo $settings['AllKeywordTranslate'];?></a>~~ |
  | 3705 |  | ~~<?php foreach($filtersArr as $val):?>~~ |
  | 3706 |  | ~~<?php if(trim($val)!=''): ?>~~ |
  | 3707 |  | ~~<?php~~ |
  | 3708 |  | ~~$val=stripslashes\_deep($val);~~ |
  | 3709 |  | ~~$val=preg\_replace('/\\\\/', '', $val);~~ |
  | 3710 |  | ~~?>~~ |
  | 3711 |  | ~~<a href="#" class="sortLink" data-category="<?php echo $val;?>"><?php echo $val;?></a>~~ |
  | 3712 |  | ~~<?php endif;?>~~ |
  | 3713 |  | ~~<?php endforeach;?>~~ |
  | 3714 |  | ~~<div class="clear\_floats"></div>~~ |
  | 3715 |  | ~~</div>~~ |
  | 3716 |  | ~~<?php endif;?>~~ |
  | 3717 |  | ~~<div class="photos">~~ |
  | 3718 |  |  |
  | 3719 |  | ~~<div class="thumbnail\_wrap\_">~~ |
  | 3720 |  |  |
  | 3721 |  | ~~<?php~~ |
  | 3722 |  |  |
  | 3723 | 3223 | $imageheight = $settings ['imageheight']; |
  | 3724 | 3224 | $imagewidth = $settings ['imagewidth']; |
  | 3725 |  | $query = "SELECT \* FROM " . $wpdb->prefix . "e\_portfolio  order by createdon,id desc "; |
  | 3726 |  | $firstChild='firstimg'; |
  | 3727 |  | $rows = $wpdb->get\_results ( $query, 'ARRAY\_A' ); |
  | 3728 |  |  |
  | 3729 |  |  |
  | 3730 |  | if (count ( $rows ) > 0) { |
  | 3731 |  |  |
  | 3732 |  | foreach ( $rows as $row ) { |
  | 3733 |  |  |
  | 3734 |  | $imagename = $row ['image\_name']; |
  | 3735 |  | $video\_url = $row ['videourl']; |
  | 3736 |  | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  | 3737 |  | $imageUploadTo = str\_replace ( "\\", "/", $imageUploadTo ); |
  | 3738 |  | $pathinfo = pathinfo ( $imageUploadTo ); |
  | 3739 |  | $filenamewithoutextension = $pathinfo ['filename']; |
  | 3740 |  | $outputimg = ""; |
  | 3741 |  |  |
  | 3742 |  | $outputimgmain = $baseurl . $row ['image\_name']; |
  | 3743 |  |  |
  | 3744 |  | if($settings['resize\_images']==0){ |
  | 3745 |  |  |
  | 3746 |  | $outputimg = $baseurl . $row ['image\_name']; |
  |  | 3225 | $query = 'SELECT \* FROM ' . $wpdb->prefix . 'e\_portfolio   order by createdon,id desc'; |
  |  | 3226 | $firstChild = 'firstimg'; |
  |  | 3227 | $rows = $wpdb->get\_results($query, 'ARRAY\_A'); |
  |  | 3228 |  |
  |  | 3229 | if (count($rows) > 0) { |
  |  | 3230 |  |
  |  | 3231 | foreach ($rows as $row) { |
  |  | 3232 |  |
  |  | 3233 | $imagename = $row ['image\_name']; |
  |  | 3234 | $video\_url = $row ['videourl']; |
  |  | 3235 | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  |  | 3236 | $imageUploadTo = str\_replace('\\', '/', $imageUploadTo); |
  |  | 3237 | $pathinfo = pathinfo($imageUploadTo); |
  |  | 3238 | $filenamewithoutextension = $pathinfo ['filename']; |
  |  | 3239 | $outputimg = ''; |
  |  | 3240 |  |
  |  | 3241 | $outputimgmain = $baseurl . $row ['image\_name']; |
  |  | 3242 |  |
  |  | 3243 | if ($settings['resize\_images'] == 0) { |
  |  | 3244 |  |
  |  | 3245 | $outputimg = $baseurl . $row ['image\_name']; |
  |  | 3246 | } else { |
  |  | 3247 |  |
  |  | 3248 | $imagetoCheck = $pathToImagesFolder . '/' . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  |  | 3249 |  |
  |  | 3250 | if (file\_exists($imagetoCheck)) { |
  |  | 3251 | $outputimg = $baseurl . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  |  | 3252 | } else { |
  |  | 3253 |  |
  |  | 3254 | if (function\_exists('wp\_get\_image\_editor')) { |
  |  | 3255 |  |
  |  | 3256 | $image = wp\_get\_image\_editor($pathToImagesFolder . '/' . $row ['image\_name']); |
  |  | 3257 |  |
  |  | 3258 | if (!is\_wp\_error($image)) { |
  |  | 3259 | $image->resize($imagewidth, $imageheight, true); |
  |  | 3260 | $image->save($imagetoCheck); |
  |  | 3261 | $outputimg = $baseurl . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  |  | 3262 | } else { |
  |  | 3263 | $outputimg = $baseurl . $row ['image\_name']; |
  |  | 3264 | } |
  |  | 3265 | } else if (function\_exists('image\_resize')) { |
  |  | 3266 |  |
  |  | 3267 | $return = image\_resize($pathToImagesFolder . '/' . $row ['image\_name'], $imagewidth, $imageheight); |
  |  | 3268 | if (!is\_wp\_error($return)) { |
  |  | 3269 |  |
  |  | 3270 | $isrenamed = rename($return, $imagetoCheck); |
  |  | 3271 | if ($isrenamed) { |
  |  | 3272 | $outputimg = $baseurl . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  |  | 3273 | } else { |
  |  | 3274 | $outputimg = $baseurl . $row ['image\_name']; |
  |  | 3275 | } |
  |  | 3276 | } else { |
  |  | 3277 | $outputimg = $baseurl . $row ['image\_name']; |
  |  | 3278 | } |
  |  | 3279 | } else { |
  |  | 3280 |  |
  |  | 3281 | $outputimg = $baseurl . $row ['image\_name']; |
  |  | 3282 | } |
  |  | 3283 |  |
  |  | 3284 | // $url = plugin\_dir\_url(\_\_FILE\_\_)."imagestoscroll/".$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
  | 3747 | 3285 | } |
  | 3748 |  | else{ |
  | 3749 |  |  |
  | 3750 |  | $imagetoCheck = $pathToImagesFolder . '/' . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  | 3751 |  |  |
  | 3752 |  | if (file\_exists ( $imagetoCheck )) { |
  | 3753 |  | $outputimg = $baseurl . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  | 3754 |  | } else { |
  | 3755 |  |  |
  | 3756 |  | if (function\_exists ( 'wp\_get\_image\_editor' )) { |
  | 3757 |  |  |
  | 3758 |  | $image = wp\_get\_image\_editor ( $pathToImagesFolder . "/" . $row ['image\_name'] ); |
  | 3759 |  |  |
  | 3760 |  | if (! is\_wp\_error ( $image )) { |
  | 3761 |  | $image->resize ( $imagewidth, $imageheight, true ); |
  | 3762 |  | $image->save ( $imagetoCheck ); |
  | 3763 |  | $outputimg = $baseurl . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  | 3764 |  | } else { |
  | 3765 |  | $outputimg = $baseurl . $row ['image\_name']; |
  | 3766 |  | } |
  | 3767 |  | } else if (function\_exists ( 'image\_resize' )) { |
  | 3768 |  |  |
  | 3769 |  | $return = image\_resize ( $pathToImagesFolder . "/" . $row ['image\_name'], $imagewidth, $imageheight ); |
  | 3770 |  | if (! is\_wp\_error ( $return )) { |
  | 3771 |  |  |
  | 3772 |  | $isrenamed = rename ( $return, $imagetoCheck ); |
  | 3773 |  | if ($isrenamed) { |
  | 3774 |  | $outputimg = $baseurl . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  | 3775 |  | } else { |
  | 3776 |  | $outputimg = $baseurl . $row ['image\_name']; |
  | 3777 |  | } |
  | 3778 |  | } else { |
  | 3779 |  | $outputimg = $baseurl . $row ['image\_name']; |
  | 3780 |  | } |
  | 3781 |  | } else { |
  | 3782 |  |  |
  | 3783 |  | $outputimg = $baseurl . $row ['image\_name']; |
  | 3784 |  | } |
  | 3785 |  |  |
  | 3786 |  | // $url = plugin\_dir\_url(\_\_FILE\_\_)."imagestoscroll/".$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
  | 3787 |  | } |
  | 3788 |  | } |
  | 3789 |  |  |
  | 3790 |  | $media\_type=$row['media\_type']; |
  | 3791 |  | $hoverClass=''; |
  | 3792 |  | if($media\_type=="link") |
  | 3793 |  | $hoverClass="playbtnCss\_link"; |
  | 3794 |  | else if($media\_type=="video") |
  | 3795 |  | $hoverClass="playbtnCss\_video"; |
  | 3796 |  | else if($media\_type=="image") |
  | 3797 |  | $hoverClass="playbtnCss\_zoom"; |
  | 3798 |  |  |
  | 3799 |  | $title = ""; |
  |  | 3286 | } |
  |  | 3287 |  |
  |  | 3288 | $media\_type = $row['media\_type']; |
  |  | 3289 | $hoverClass = ''; |
  |  | 3290 | if ($media\_type == 'link') { |
  |  | 3291 | $hoverClass = 'playbtnCss\_link'; |
  |  | 3292 | } else if ($media\_type == 'video') { |
  |  | 3293 | $hoverClass = 'playbtnCss\_video'; |
  |  | 3294 | } else if ($media\_type == 'image') { |
  |  | 3295 | $hoverClass = 'playbtnCss\_zoom'; |
  |  | 3296 | } |
  |  | 3297 |  |
  |  | 3298 | $title = ''; |
  | 3800 | 3299 | $rowTitle = $row['title']; |
  | 3801 |  | $rowTitle = str\_replace("'", ~~"’"~~, $rowTitle); |
  |  | 3300 | $rowTitle = str\_replace("'", '’', $rowTitle); |
  | 3802 | 3301 | $rowTitle = str\_replace('"', '”', $rowTitle); |
  | 3803 |  |  |
  | 3804 |  |  |
  | 3805 | 3302 |  |
  | 3806 | 3303 | $open\_link\_in = $row['open\_link\_in']; |
  | 3807 | 3304 | $openImageInNewTab = '\_self'; |
  | 3808 |  | $embed\_url~~=~~$row['embed\_url']; |
  | 3809 |  | ~~if($media\_type=="video")~~{ |
  | 3810 |  |  |
  | 3811 |  | if (trim($row['title']) != '' ~~and~~ trim($row['videourl']) != '') { |
  |  | 3305 | $embed\_url = $row['embed\_url']; |
  |  | 3306 | if ($media\_type == 'video') { |
  |  | 3307 |  |
  |  | 3308 | if (trim($row['title']) != '' && trim($row['videourl']) != '') { |
  | 3812 | 3309 |  |
  | 3813 | 3310 | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['murl']}'>{$rowTitle}</a>"; |
  | 3814 |  |  |
  | 3815 |  | } else if (trim($row['title']) != '' and trim($row['videourl']) == '') { |
  |  | 3311 | } else if (trim($row['title']) != '' && trim($row['videourl']) == '') { |
  | 3816 | 3312 |  |
  | 3817 | 3313 | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
  | 3818 |  |  |
  | 3819 |  | } |
  | 3820 |  | } |
  | 3821 |  | else if($media\_type=="image"){ |
  | 3822 |  |  |
  | 3823 |  | if (trim($row['title']) != '' and trim($row['murl']) != '') { |
  |  | 3314 | } |
  |  | 3315 | } else if ($media\_type == 'image') { |
  |  | 3316 |  |
  |  | 3317 | if (trim($row['title']) != '' && trim($row['murl']) != '') { |
  | 3824 | 3318 |  |
  | 3825 | 3319 | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['murl']}'>{$rowTitle}</a>"; |
  | 3826 |  |  |
  | 3827 |  | } else if (trim($row['title']) != '' and trim($row['murl']) == '') { |
  |  | 3320 | } else if (trim($row['title']) != '' && trim($row['murl']) == '') { |
  | 3828 | 3321 |  |
  | 3829 | 3322 | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
  | 3830 |  |  |
  | 3831 |  | } |
  | 3832 |  |  |
  | 3833 |  | } |
  | 3834 |  | $title= htmlentities($title); |
  | 3835 |  | ?> |
  | 3836 |  |  |
  | 3837 |  | <?php if($media\_type=='image' or $media\_type=='video') :?> |
  | 3838 |  |  |
  | 3839 |  | <?php if ($open\_link\_in == 1): ?> |
  | 3840 |  | <a data-rel="<?php echo $randOmeRel; ?>"  data-type="<?php echo $media\_type;?>" data-overlay="1" data-title="<?php echo $title; ?>" class="thumbnail\_ <?php echo $randOmVlBox; ?> <?php if($media\_type=='video'):?>   iframe <?php endif;?>" data-categories="<?php echo $row['mtag'];?>" href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>" > |
  | 3841 |  | <div class="thum\_div figure" <?php if($settings['resize\_images']==0):?> style="width:<?php echo $imagewidth;?>px;height: <?php echo $imageheight;?>px" <?php endif;?>> |
  | 3842 |  |  |
  | 3843 |  | <img <?php if($settings['resize\_images']==0):?> class="fit\_img"  <?php endif;?> src="<?php echo $outputimg;?>" alt="<?php echo $rowTitle; ?>"  title="<?php echo $rowTitle;?>" /> |
  | 3844 |  | <div class="<?php echo $hoverClass;?>"></div> |
  | 3845 |  |  |
  | 3846 |  | </div> |
  | 3847 |  | </a> |
  | 3848 |  | <?php else: ?> |
  | 3849 |  |  |
  | 3850 |  | <a   data-type="<?php echo $media\_type;?>" data-title="<?php echo $title; ?>" class="thumbnail\_ " data-categories="<?php echo $row['mtag'];?>" href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>" > |
  | 3851 |  | <div class="thum\_div figure" <?php if($settings['resize\_images']==0):?> style="width:<?php echo $imagewidth;?>px;height: <?php echo $imageheight;?>px" <?php endif;?>> |
  | 3852 |  |  |
  | 3853 |  | <img <?php if($settings['resize\_images']==0):?> class="fit\_img"  <?php endif;?> src="<?php echo $outputimg;?>" alt="<?php echo $rowTitle; ?>"  title="<?php echo $rowTitle; ?>" /> |
  | 3854 |  | <div class="<?php echo $hoverClass;?>"></div> |
  | 3855 |  |  |
  | 3856 |  | </div> |
  | 3857 |  | </a> |
  | 3858 |  | <?php endif;?> |
  | 3859 |  |  |
  | 3860 |  | <?php else:?> |
  | 3861 |  | <a   data-type="<?php echo $media\_type;?>" class="thumbnail\_ " data-categories="<?php echo $row['mtag'];?>" href="<?php echo $row['murl']; ?>" > |
  | 3862 |  | <div class="thum\_div figure" <?php if($settings['resize\_images']==0):?> style="width:<?php echo $imagewidth;?>px;height: <?php echo $imageheight;?>px" <?php endif;?>> |
  | 3863 |  |  |
  | 3864 |  | <img <?php if($settings['resize\_images']==0):?> class="fit\_img"  <?php endif;?> src="<?php echo $outputimg;?>" alt="<?php echo $rowTitle; ?>"  title="<?php echo $rowTitle;?>" /> |
  | 3865 |  | <div class="<?php echo $hoverClass;?>"></div> |
  | 3866 |  |  |
  | 3867 |  | </div> |
  |  | 3323 | } |
  |  | 3324 | } |
  |  | 3325 |  |
  |  | 3326 | $title = htmlentities($title); |
  |  | 3327 | ?> |
  |  | 3328 |  |
  |  | 3329 | <?php if ($media\_type == 'image' or $media\_type == 'video') : ?> |
  |  | 3330 |  |
  |  | 3331 | <?php if ($open\_link\_in == 1) : ?> |
  |  | 3332 | <a data-rel="<?php echo $randOmeRel; ?>"  data-type="<?php echo $media\_type; ?>" data-overlay="1" data-title="<?php echo $title; ?>" class="thumbnail\_ <?php echo $randOmVlBox; ?> <?php |
  |  | 3333 | if ($media\_type == 'video') : |
  |  | 3334 | ?> |
  |  | 3335 | iframe <?php endif; ?>" data-categories="<?php echo $row['mtag']; ?>" href=" |
  |  | 3336 | <?php |
  |  | 3337 | if ($media\_type == 'video') : |
  |  | 3338 | ?> |
  |  | 3339 | <?php echo $embed\_url; ?> <?php |
  |  | 3340 | else : |
  |  | 3341 | ?> |
  |  | 3342 | <?php echo $outputimgmain; ?><?php endif; ?>" > |
  |  | 3343 | <div class="thum\_div figure" |
  |  | 3344 | <?php |
  |  | 3345 | if ($settings['resize\_images'] == 0) : |
  |  | 3346 | ?> |
  |  | 3347 | style="width:<?php echo $imagewidth; ?>px;height: <?php echo $imageheight; ?>px" <?php endif; ?>> |
  |  | 3348 |  |
  |  | 3349 | <img |
  |  | 3350 | <?php |
  |  | 3351 | if ($settings['resize\_images'] == 0) : |
  |  | 3352 | ?> |
  |  | 3353 | class="fit\_img"  <?php endif; ?>  src="<?php echo $outputimg; ?>" alt="<?php echo $rowTitle; ?>"  title="<?php echo $rowTitle; ?>" /> |
  |  | 3354 | <div class="<?php echo $hoverClass; ?>"></div> |
  |  | 3355 |  |
  |  | 3356 | </div> |
  |  | 3357 | </a> |
  |  | 3358 | <?php else : ?> |
  |  | 3359 |  |
  |  | 3360 | <a   data-type="<?php echo $media\_type; ?>" data-title="<?php echo $title; ?>" class="thumbnail\_ " data-categories="<?php echo $row['mtag']; ?>" href=" |
  |  | 3361 | <?php |
  |  | 3362 | if ($media\_type == 'video') : |
  |  | 3363 | ?> |
  |  | 3364 | <?php echo $embed\_url; ?> <?php |
  |  | 3365 | else : |
  |  | 3366 | ?> |
  |  | 3367 | <?php echo $outputimgmain; ?><?php endif; ?>" > |
  |  | 3368 | <div class="thum\_div figure" |
  |  | 3369 | <?php |
  |  | 3370 | if ($settings['resize\_images'] == 0) : |
  |  | 3371 | ?> |
  |  | 3372 | style="width:<?php echo $imagewidth; ?>px;height: <?php echo $imageheight; ?>px" <?php endif; ?>> |
  |  | 3373 |  |
  |  | 3374 | <img |
  |  | 3375 | <?php |
  |  | 3376 | if ($settings['resize\_images'] == 0) : |
  |  | 3377 | ?> |
  |  | 3378 | class="fit\_img"  <?php endif; ?>  src="<?php echo $outputimg; ?>" alt="<?php echo $rowTitle; ?>"  title="<?php echo $rowTitle; ?>" /> |
  |  | 3379 |  |
  |  | 3380 | <div class="<?php echo $hoverClass; ?>"></div> |
  |  | 3381 |  |
  |  | 3382 | </div> |
  |  | 3383 | </a> |
  |  | 3384 | <?php endif; ?> |
  |  | 3385 |  |
  |  | 3386 | <?php else : ?> |
  |  | 3387 | <a   data-type="<?php echo $media\_type; ?>" class="thumbnail\_ " data-categories="<?php echo $row['mtag']; ?>" href="<?php echo $row['murl']; ?>" > |
  |  | 3388 | <div class="thum\_div figure" |
  |  | 3389 | <?php |
  |  | 3390 | if ($settings['resize\_images'] == 0) : |
  |  | 3391 | ?> |
  |  | 3392 | style="width:<?php echo $imagewidth; ?>px;height: <?php echo $imageheight; ?>px" <?php endif; ?>> |
  |  | 3393 |  |
  |  | 3394 | <img |
  |  | 3395 | <?php |
  |  | 3396 | if ($settings['resize\_images'] == 0) : |
  |  | 3397 | ?> |
  |  | 3398 | class="fit\_img"  <?php endif; ?>  src="<?php echo $outputimg; ?>" alt="<?php echo $rowTitle; ?>"  title="<?php echo $rowTitle; ?>" /> |
  |  | 3399 | <div class="<?php echo $hoverClass; ?>"></div> |
  |  | 3400 |  |
  |  | 3401 | </div> |
  | 3868 | 3402 | </a> |
  | 3869 | 3403 |  |
  | 3870 |  | ~~<?php endif;~~?> |
  | 3871 |  |  |
  | 3872 |  | <?php } ?> |
  | 3873 |  |  |
  | 3874 |  | <?php } ?> |
  |  | 3404 | <?php endif; ?> |
  |  | 3405 |  |
  |  | 3406 | <?php } ?> |
  |  | 3407 |  |
  |  | 3408 | <?php } ?> |
  | 3875 | 3409 |  |
  | 3876 | 3410 | </div><!-- .thumbnail\_wrap end --> |
  | 3877 |  |  |
  | 3878 |  | </div> |
  | 3879 |  |  |
  | 3880 |  | </div> |
  | 3881 |  |  |
  | 3882 |  | <script> |
  | 3883 |  | <?php $intval= uniqid('interval\_');?> |
  | 3884 |  |  |
  | 3885 |  | var <?php echo $intval;?> = setInterval(function() { |
  | 3886 |  |  |
  | 3887 |  | if(document.readyState === 'complete') { |
  | 3888 |  |  |
  | 3889 |  | clearInterval(<?php echo $intval;?>); |
  | 3890 |  |  |
  | 3891 |  | <?php $uniqId = uniqid(); ?> |
  | 3892 |  | var uniqObj<?php echo $uniqId ?> = jQuery("a[data-rel='<?php echo $randOmeRel; ?>']"); |
  | 3893 |  |  |
  | 3894 |  |  |
  | 3895 |  | var func=jQuery('#<?php echo $rand\_Num\_td;?>').filterMediank({ |
  | 3896 |  |  |
  | 3897 |  | thumbWidth: <?php echo $settings['imagewidth'];?>, |
  | 3898 |  | thumbHeight: <?php echo $settings['imageheight'];?>, |
  | 3899 |  | thumbsSpacing:<?php echo $settings['imageMargin'];?>, |
  | 3900 |  | galleryId:"<?php echo $rand\_var\_name;?>", |
  | 3901 |  | backgroundColor:"<?php echo $settings['BackgroundColor'];?>", |
  | 3902 |  | uniqueObjId:"uniqObj<?php echo $uniqId ?>", |
  | 3903 |  | }); |
  | 3904 |  | jQuery('#<?php echo $rand\_var\_name;?>').css('visibility','visible') |
  | 3905 |  |  |
  | 3906 |  | var globalTimer = null; |
  | 3907 |  |  |
  | 3908 |  | jQuery(window).resize(function() { |
  |  | 3411 |  |
  |  | 3412 | </div> |
  |  | 3413 |  |
  |  | 3414 | </div> |
  |  | 3415 | <script> |
  |  | 3416 | <?php $uniqId = uniqid(); ?> |
  |  | 3417 | var uniqObj<?php echo $uniqId; ?> = jQuery("a[rel='<?php echo $randOmeRel; ?>']"); |
  |  | 3418 |  |
  |  | 3419 | jQuery(document).ready(function () { |
  |  | 3420 |  |
  |  | 3421 |  |
  |  | 3422 |  |
  |  | 3423 | var func = jQuery('#<?php echo $rand\_Num\_td; ?>').filterMediank({ |
  |  | 3424 |  |
  |  | 3425 | thumbWidth: <?php echo $settings['imagewidth']; ?>, |
  |  | 3426 | thumbHeight: <?php echo $settings['imageheight']; ?>, |
  |  | 3427 | thumbsSpacing:<?php echo $settings['imageMargin']; ?>, |
  |  | 3428 | galleryId: "<?php echo $rand\_var\_name; ?>", |
  |  | 3429 | backgroundColor: "<?php echo $settings['BackgroundColor']; ?>" |
  |  | 3430 | }); |
  |  | 3431 | jQuery('#<?php echo $rand\_var\_name; ?>').css('visibility', 'visible') |
  |  | 3432 |  |
  |  | 3433 | var globalTimer = null; |
  |  | 3434 |  |
  |  | 3435 | jQuery(window).resize(function () { |
  | 3909 | 3436 | clearTimeout(globalTimer); |
  | 3910 | 3437 | globalTimer = setTimeout(doneResize, 500); |
  | 3911 | 3438 | }); |
  | 3912 | 3439 |  |
  | 3913 |  | ~~function doneResize()~~{ |
  | 3914 |  |  |
  | 3915 |  | ~~func.resizeWin('<?php echo $rand\_var\_name;~~?>'); |
  | 3916 |  | } |
  | 3917 |  |  |
  | 3918 |  | jQuery(".<?php echo $randOmVlBox; ?>").fancybox\_fp({ |
  | 3919 |  |  |
  | 3920 |  | 'overlayColor':'#000000', |
  |  | 3440 | function doneResize() { |
  |  | 3441 |  |
  |  | 3442 | func.resizeWin('<?php echo $rand\_var\_name; ?>'); |
  |  | 3443 | } |
  |  | 3444 |  |
  |  | 3445 | jQuery(".<?php echo $randOmVlBox; ?>").fancybox\_fp({ |
  |  | 3446 |  |
  |  | 3447 | 'overlayColor': '#000000', |
  | 3921 | 3448 | 'padding': 3, |
  | 3922 | 3449 | 'margin': 20, |
  | 3923 | 3450 | 'autoScale': true, |
  | 3924 |  | 'autoDimensions':true, |
  | 3925 |  | 'uniqObj':uniqObj<?php echo $uniqId; ?>, |
  | 3926 |  | 'uniqRel':'<?php echo $randOmeRel; ?>', |
  | 3927 |  | 'transitionIn':'fade', |
  | 3928 |  | 'transitionOut':'fade', |
  |  | 3451 | 'autoDimensions': true, |
  |  | 3452 | 'uniqObj': uniqObj<?php echo $uniqId; ?>, |
  |  | 3453 | 'uniqRel': '<?php echo $randOmeRel; ?>', |
  |  | 3454 | 'transitionIn': 'fade', |
  |  | 3455 | 'transitionOut': 'fade', |
  | 3929 | 3456 | 'titlePosition': 'outside', |
  | 3930 |  | 'cyclic':true, |
  | 3931 |  | 'hideOnContentClick':false, |
  | 3932 |  | 'width' : 650, |
  | 3933 |  | 'height' : 400, |
  | 3934 |  | 'titleFormat': function(title, currentArray, currentIndex, currentOpts) { |
  | 3935 |  |  |
  | 3936 |  | var currtElem = jQuery('#<?php echo $rand\_Num\_td; ?> a[href="' + currentOpts.href + '"]'); |
  | 3937 |  | var isoverlay = jQuery(currtElem).attr('data-overlay') |
  | 3938 |  |  |
  | 3939 |  | if (isoverlay == "1" && jQuery.trim(title) != ""){ |
  | 3940 |  | return '<span id="fancybox\_fp-title-over">' + title + '</span>'; |
  | 3941 |  | } |
  | 3942 |  | else{ |
  | 3943 |  | return ''; |
  | 3944 |  | } |
  | 3945 |  |  |
  | 3946 |  | } |
  | 3947 |  | }); |
  | 3948 |  |  |
  |  | 3457 | 'cyclic': true, |
  |  | 3458 | 'hideOnContentClick': false, |
  |  | 3459 | 'width': 650, |
  |  | 3460 | 'height': 400, |
  |  | 3461 | 'titleFormat': function (title, currentArray, currentIndex, currentOpts) { |
  |  | 3462 |  |
  |  | 3463 | var currtElem = jQuery('#<?php echo $rand\_Num\_td; ?> a[href="' + currentOpts.href + '"]'); |
  |  | 3464 | var isoverlay = jQuery(currtElem).attr('data-overlay') |
  |  | 3465 |  |
  |  | 3466 | if (isoverlay == "1" && jQuery.trim(title) != "") { |
  |  | 3467 | return '<span id="fancybox\_fp-title-over">' + title + '</span>'; |
  |  | 3468 | } else { |
  |  | 3469 | return ''; |
  |  | 3470 | } |
  |  | 3471 |  |
  |  | 3472 | } |
  |  | 3473 | }); |
  |  | 3474 |  |
  |  | 3475 |  |
  |  | 3476 | }); |
  |  | 3477 | </script> |
  |  | 3478 | </div> |
  |  | 3479 |  |
  |  | 3480 | </div> |
  |  | 3481 | <?php if (is\_array($settings)) { ?> |
  |  | 3482 |  |
  |  | 3483 | <h3><?php echo \_\_('To print this video gallery into WordPress Post/Page use below code', 'responsive-filterable-portfolio'); ?></h3> |
  |  | 3484 | <input type="text" value='[print\_responsive\_portfolio\_plus\_lightbox] ' |
  |  | 3485 | style="width: 400px; height: 30px" |
  |  | 3486 | onclick="this.focus(); |
  |  | 3487 | this.select()" /> |
  |  | 3488 | <div class="clear"></div> |
  |  | 3489 | <h3><?php echo \_\_('To print this video gallery into WordPress theme/template PHP files use below code', 'responsive-filterable-portfolio'); ?></h3> |
  |  | 3490 | <?php |
  |  | 3491 | $shortcode = '[print\_responsive\_portfolio\_plus\_lightbox]'; |
  |  | 3492 | ?> |
  |  | 3493 | <input type="text" value="&lt;?php echo do\_shortcode('<?php echo htmlentities($shortcode, ENT\_QUOTES); ?>'); ?&gt;" style="width: 400px; height: 30px" onclick="this.focus(); |
  |  | 3494 | this.select()" /> |
  |  | 3495 | <?php } ?> |
  |  | 3496 |  |
  |  | 3497 | </div> |
  |  | 3498 |  |
  |  | 3499 | </div> |
  |  | 3500 | </div> |
  |  | 3501 | <div id="postbox-container-1" class="postbox-container" > |
  |  | 3502 |  |
  |  | 3503 | <div class="postbox"> |
  |  | 3504 | <h3 class="hndle"><span></span><?php echo \_\_('Access All Themes In One Price', 'responsive-filterable-portfolio'); ?></h3> |
  |  | 3505 | <div class="inside"> |
  |  | 3506 | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"> |
  |  | 3507 | <img border="0" src="<?php echo plugins\_url('images/300x250.gif', \_\_FILE\_\_); ?>" width="250" height="250"> |
  |  | 3508 | </a></center> |
  |  | 3509 |  |
  |  | 3510 | <div style="margin:10px 5px"> |
  |  | 3511 |  |
  |  | 3512 | </div> |
  |  | 3513 | </div></div> |
  |  | 3514 | <div class="postbox"> |
  |  | 3515 | <h3 class="hndle"><span></span><?php echo \_\_('Google For Business Coupon', 'responsive-filterable-portfolio'); ?></h3> |
  |  | 3516 | <div class="inside"> |
  |  | 3517 | <center><a href="https://goo.gl/OJBuHT" target="\_blank"> |
  |  | 3518 | <img src="<?php echo plugins\_url('images/g-suite-promo-code-4.png', \_\_FILE\_\_); ?>" width="250" height="250" border="0"> |
  |  | 3519 | </a></center> |
  |  | 3520 | <div style="margin:10px 5px"> |
  |  | 3521 | </div> |
  |  | 3522 | </div> |
  |  | 3523 |  |
  |  | 3524 | </div> |
  |  | 3525 |  |
  |  | 3526 | </div> |
  |  | 3527 | </div> |
  |  | 3528 | </div> |
  |  | 3529 | <div class="clear"></div> |
  |  | 3530 | </div> |
  |  | 3531 |  |
  |  | 3532 | <div class="clear"></div> |
  |  | 3533 | <?php |
  |  | 3534 | } |
  |  | 3535 | } |
  |  | 3536 |  |
  |  | 3537 | function rfp\_print\_responsive\_portfolio\_plus\_lightbox\_func($atts) { |
  |  | 3538 |  |
  |  | 3539 |  |
  |  | 3540 | global $wpdb; |
  |  | 3541 |  |
  |  | 3542 | wp\_enqueue\_style('filterMediank'); |
  |  | 3543 | wp\_enqueue\_style('filterMediank-lbox'); |
  |  | 3544 | wp\_enqueue\_script('jquery'); |
  |  | 3545 | wp\_enqueue\_script('filterMediank'); |
  |  | 3546 | wp\_enqueue\_script('filterMediank-lbox-js'); |
  |  | 3547 |  |
  |  | 3548 | ob\_start(); |
  |  | 3549 | global $wpdb; |
  |  | 3550 |  |
  |  | 3551 | $settings = get\_option('best\_portfolio\_grid\_settings'); |
  |  | 3552 |  |
  |  | 3553 | $rand\_Numb = uniqid('thumnail\_slider'); |
  |  | 3554 | $rand\_Num\_td = uniqid('divSliderMain'); |
  |  | 3555 | $rand\_var\_name = uniqid('rand\_'); |
  |  | 3556 |  |
  |  | 3557 | $wpcurrentdir = dirname(\_\_FILE\_\_); |
  |  | 3558 | $wpcurrentdir = str\_replace('\\', '/', $wpcurrentdir); |
  |  | 3559 | // $settings=get\_option('thumbnail\_slider\_settings'); |
  |  | 3560 |  |
  |  | 3561 | $uploads = wp\_upload\_dir(); |
  |  | 3562 | $baseDir = $uploads ['basedir']; |
  |  | 3563 | $baseDir = str\_replace('\\', '/', $baseDir); |
  |  | 3564 | $pathToImagesFolder = $baseDir . '/wp-best-portfolio'; |
  |  | 3565 | $baseurl = $uploads ['baseurl']; |
  |  | 3566 | $baseurl .= '/wp-best-portfolio/'; |
  |  | 3567 |  |
  |  | 3568 | $wpcurrentdir = dirname(\_\_FILE\_\_); |
  |  | 3569 | $wpcurrentdir = str\_replace('\\', '/', $wpcurrentdir); |
  |  | 3570 | $randOmeAlbName = uniqid('alb\_'); |
  |  | 3571 | $randOmeRel = uniqid('rel\_'); |
  |  | 3572 | $randOmVlBox = uniqid('video\_lbox\_'); |
  |  | 3573 | $vNonce = wp\_create\_nonce('vNonce'); |
  |  | 3574 | $url = plugin\_dir\_url(\_\_FILE\_\_); |
  |  | 3575 | $loaderImg = $url . 'images/bx\_loader.gif'; |
  |  | 3576 |  |
  |  | 3577 | $LoadingBackColor = $settings ['BackgroundColor']; |
  |  | 3578 | if (strtolower($LoadingBackColor) == 'none') { |
  |  | 3579 | $LoadingBackColor = '#ffffff'; |
  |  | 3580 | } |
  |  | 3581 |  |
  |  | 3582 | if (is\_array($settings)) { |
  |  | 3583 | ?> |
  |  | 3584 |  |
  |  | 3585 | <?php |
  |  | 3586 | if (!isset($settings['resize\_images'])) { |
  |  | 3587 |  |
  |  | 3588 | $settings['resize\_images'] = 1; |
  |  | 3589 | } |
  |  | 3590 | ?> |
  |  | 3591 | <div style="clear: both;"></div> |
  |  | 3592 | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
  |  | 3593 |  |
  |  | 3594 | <div class="container\_"> |
  |  | 3595 |  |
  |  | 3596 | <div class="gallery\_" id="<?php echo $rand\_var\_name; ?>" style="visibility:hidden"> |
  |  | 3597 | <div id="<?php echo $rand\_var\_name; ?>\_overlay\_grid" class="overlay\_grid" style="background: <?php echo $LoadingBackColor; ?> url('<?php echo $loaderImg; ?>') no-repeat scroll 50% 50%;" ></div> |
  |  | 3598 | <div id="<?php echo $rand\_Num\_td; ?>"> |
  |  | 3599 | <?php if ($settings['show\_filters']) : ?> |
  |  | 3600 |  |
  |  | 3601 | <div id="FilerTab" class="fil"> |
  |  | 3602 | <div class="shield\_cli" id="shield\_<?php echo $rand\_var\_name; ?>" ></div> |
  |  | 3603 | <?php |
  |  | 3604 | $query = 'SET SESSION group\_concat\_max\_len=150000'; |
  |  | 3605 | $wpdb->query($query); |
  |  | 3606 |  |
  |  | 3607 | $filerValsQuery = 'select GROUP\_CONCAT(mtag) as filters from |
  |  | 3608 | (SELECT mtag from ' . $wpdb->prefix . 'e\_portfolio  order by createdon,id desc ) a'; |
  |  | 3609 |  |
  |  | 3610 | $filters = $wpdb->get\_var($filerValsQuery); |
  |  | 3611 | $filtersArr = explode(',', $filters); |
  |  | 3612 | $filtersArr = array\_unique($filtersArr); |
  |  | 3613 | sort($filtersArr); |
  |  | 3614 | ?> |
  |  | 3615 | <a href="#" class="sortLink selected" data-category="all"><?php echo $settings['AllKeywordTranslate']; ?></a> |
  |  | 3616 | <?php foreach ($filtersArr as $val) : ?> |
  |  | 3617 | <?php if (trim($val) != '') : ?> |
  |  | 3618 | <?php |
  |  | 3619 | $val = stripslashes\_deep($val); |
  |  | 3620 | $val = preg\_replace('/\\\\/', '', $val); |
  |  | 3621 | ?> |
  |  | 3622 | <a href="#" class="sortLink" data-category="<?php echo $val; ?>"><?php echo $val; ?></a> |
  |  | 3623 | <?php endif; ?> |
  |  | 3624 | <?php endforeach; ?> |
  |  | 3625 | <div class="clear\_floats"></div> |
  |  | 3626 | </div> |
  |  | 3627 | <?php endif; ?> |
  |  | 3628 | <div class="photos"> |
  |  | 3629 |  |
  |  | 3630 | <div class="thumbnail\_wrap\_"> |
  |  | 3631 |  |
  |  | 3632 | <?php |
  |  | 3633 | $imageheight = $settings ['imageheight']; |
  |  | 3634 | $imagewidth = $settings ['imagewidth']; |
  |  | 3635 | $query = 'SELECT \* FROM ' . $wpdb->prefix . 'e\_portfolio  order by createdon,id desc '; |
  |  | 3636 | $firstChild = 'firstimg'; |
  |  | 3637 | $rows = $wpdb->get\_results($query, 'ARRAY\_A'); |
  |  | 3638 |  |
  |  | 3639 | if (count($rows) > 0) { |
  |  | 3640 |  |
  |  | 3641 | foreach ($rows as $row) { |
  |  | 3642 |  |
  |  | 3643 | $imagename = $row ['image\_name']; |
  |  | 3644 | $video\_url = $row ['videourl']; |
  |  | 3645 | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
  |  | 3646 | $imageUploadTo = str\_replace('\\', '/', $imageUploadTo); |
  |  | 3647 | $pathinfo = pathinfo($imageUploadTo); |
  |  | 3648 | $filenamewithoutextension = $pathinfo ['filename']; |
  |  | 3649 | $outputimg = ''; |
  |  | 3650 |  |
  |  | 3651 | $outputimgmain = $baseurl . $row ['image\_name']; |
  |  | 3652 |  |
  |  | 3653 | if ($settings['resize\_images'] == 0) { |
  |  | 3654 |  |
  |  | 3655 | $outputimg = $baseurl . $row ['image\_name']; |
  |  | 3656 | } else { |
  |  | 3657 |  |
  |  | 3658 | $imagetoCheck = $pathToImagesFolder . '/' . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  |  | 3659 |  |
  |  | 3660 | if (file\_exists($imagetoCheck)) { |
  |  | 3661 | $outputimg = $baseurl . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  |  | 3662 | } else { |
  |  | 3663 |  |
  |  | 3664 | if (function\_exists('wp\_get\_image\_editor')) { |
  |  | 3665 |  |
  |  | 3666 | $image = wp\_get\_image\_editor($pathToImagesFolder . '/' . $row ['image\_name']); |
  |  | 3667 |  |
  |  | 3668 | if (!is\_wp\_error($image)) { |
  |  | 3669 | $image->resize($imagewidth, $imageheight, true); |
  |  | 3670 | $image->save($imagetoCheck); |
  |  | 3671 | $outputimg = $baseurl . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  |  | 3672 | } else { |
  |  | 3673 | $outputimg = $baseurl . $row ['image\_name']; |
  |  | 3674 | } |
  |  | 3675 | } else if (function\_exists('image\_resize')) { |
  |  | 3676 |  |
  |  | 3677 | $return = image\_resize($pathToImagesFolder . '/' . $row ['image\_name'], $imagewidth, $imageheight); |
  |  | 3678 | if (!is\_wp\_error($return)) { |
  |  | 3679 |  |
  |  | 3680 | $isrenamed = rename($return, $imagetoCheck); |
  |  | 3681 | if ($isrenamed) { |
  |  | 3682 | $outputimg = $baseurl . $filenamewithoutextension . '\_' . $imageheight . '\_' . $imagewidth . '.' . $pathinfo ['extension']; |
  |  | 3683 | } else { |
  |  | 3684 | $outputimg = $baseurl . $row ['image\_name']; |
  |  | 3685 | } |
  |  | 3686 | } else { |
  |  | 3687 | $outputimg = $baseurl . $row ['image\_name']; |
  |  | 3688 | } |
  |  | 3689 | } else { |
  |  | 3690 |  |
  |  | 3691 | $outputimg = $baseurl . $row ['image\_name']; |
  | 3949 | 3692 | } |
  | 3950 |  |  |
  | 3951 |  | }, 100); |
  | 3952 |  |  |
  | 3953 |  |  |
  | 3954 |  |  |
  | 3955 |  |  |
  | 3956 |  | </script> |
  | 3957 |  |  |
  | 3958 |  | </div> |
  | 3959 |  |  |
  | 3960 |  | </div> |
  | 3961 |  |  |
  | 3962 |  | <?php } ?> |
  | 3963 |  |  |
  | 3964 |  | <div class="clear"></div> |
  | 3965 |  |  |
  | 3966 |  | <?php |
  | 3967 |  | $output = ob\_get\_clean (); |
  | 3968 |  | return $output; |
  |  | 3693 |  |
  |  | 3694 | // $url = plugin\_dir\_url(\_\_FILE\_\_)."imagestoscroll/".$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
  |  | 3695 | } |
  |  | 3696 | } |
  |  | 3697 |  |
  |  | 3698 | $media\_type = $row['media\_type']; |
  |  | 3699 | $hoverClass = ''; |
  |  | 3700 | if ($media\_type == 'link') { |
  |  | 3701 | $hoverClass = 'playbtnCss\_link'; |
  |  | 3702 | } else if ($media\_type == 'video') { |
  |  | 3703 | $hoverClass = 'playbtnCss\_video'; |
  |  | 3704 | } else if ($media\_type == 'image') { |
  |  | 3705 | $hoverClass = 'playbtnCss\_zoom'; |
  |  | 3706 | } |
  |  | 3707 |  |
  |  | 3708 | $title = ''; |
  |  | 3709 | $rowTitle = $row['title']; |
  |  | 3710 | $rowTitle = str\_replace("'", '’', $rowTitle); |
  |  | 3711 | $rowTitle = str\_replace('"', '”', $rowTitle); |
  |  | 3712 |  |
  |  | 3713 | $open\_link\_in = $row['open\_link\_in']; |
  |  | 3714 | $openImageInNewTab = '\_self'; |
  |  | 3715 | $embed\_url = $row['embed\_url']; |
  |  | 3716 | if ($media\_type == 'video') { |
  |  | 3717 |  |
  |  | 3718 | if (trim($row['title']) != '' && trim($row['videourl']) != '') { |
  |  | 3719 |  |
  |  | 3720 | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['murl']}'>{$rowTitle}</a>"; |
  |  | 3721 | } else if (trim($row['title']) != '' && trim($row['videourl']) == '') { |
  |  | 3722 |  |
  |  | 3723 | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
  |  | 3724 | } |
  |  | 3725 | } else if ($media\_type == 'image') { |
  |  | 3726 |  |
  |  | 3727 | if (trim($row['title']) != '' && trim($row['murl']) != '') { |
  |  | 3728 |  |
  |  | 3729 | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['murl']}'>{$rowTitle}</a>"; |
  |  | 3730 | } else if (trim($row['title']) != '' && trim($row['murl']) == '') { |
  |  | 3731 |  |
  |  | 3732 | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
  |  | 3733 | } |
  |  | 3734 | } |
  |  | 3735 | $title = htmlentities($title); |
  |  | 3736 | ?> |
  |  | 3737 |  |
  |  | 3738 | <?php if ($media\_type == 'image' or $media\_type == 'video') : ?> |
  |  | 3739 |  |
  |  | 3740 | <?php if ($open\_link\_in == 1) : ?> |
  |  | 3741 | <a data-rel="<?php echo $randOmeRel; ?>"  data-type="<?php echo $media\_type; ?>" data-overlay="1" data-title="<?php echo $title; ?>" class="thumbnail\_ <?php echo $randOmVlBox; ?> <?php |
  |  | 3742 | if ($media\_type == 'video') : |
  |  | 3743 | ?> |
  |  | 3744 | iframe <?php endif; ?>" data-categories="<?php echo $row['mtag']; ?>" href=" |
  |  | 3745 | <?php |
  |  | 3746 | if ($media\_type == 'video') : |
  |  | 3747 | ?> |
  |  | 3748 | <?php echo $embed\_url; ?> <?php |
  |  | 3749 | else : |
  |  | 3750 | ?> |
  |  | 3751 | <?php echo $outputimgmain; ?><?php endif; ?>" > |
  |  | 3752 | <div class="thum\_div figure" |
  |  | 3753 | <?php |
  |  | 3754 | if ($settings['resize\_images'] == 0) : |
  |  | 3755 | ?> |
  |  | 3756 | style="width:<?php echo $imagewidth; ?>px;height: <?php echo $imageheight; ?>px" <?php endif; ?>> |
  |  | 3757 |  |
  |  | 3758 | <img |
  |  | 3759 | <?php |
  |  | 3760 | if ($settings['resize\_images'] == 0) : |
  |  | 3761 | ?> |
  |  | 3762 | class="fit\_img"  <?php endif; ?> src="<?php echo $outputimg; ?>" alt="<?php echo $rowTitle; ?>"  title="<?php echo $rowTitle; ?>" /> |
  |  | 3763 | <div class="<?php echo $hoverClass; ?>"></div> |
  |  | 3764 |  |
  |  | 3765 | </div> |
  |  | 3766 | </a> |
  |  | 3767 | <?php else : ?> |
  |  | 3768 |  |
  |  | 3769 | <a   data-type="<?php echo $media\_type; ?>" data-title="<?php echo $title; ?>" class="thumbnail\_ " data-categories="<?php echo $row['mtag']; ?>" href=" |
  |  | 3770 | <?php |
  |  | 3771 | if ($media\_type == 'video') : |
  |  | 3772 | ?> |
  |  | 3773 | <?php echo $embed\_url; ?> <?php |
  |  | 3774 | else : |
  |  | 3775 | ?> |
  |  | 3776 | <?php echo $outputimgmain; ?><?php endif; ?>" > |
  |  | 3777 | <div class="thum\_div figure" |
  |  | 3778 | <?php |
  |  | 3779 | if ($settings['resize\_images'] == 0) : |
  |  | 3780 | ?> |
  |  | 3781 | style="width:<?php echo $imagewidth; ?>px;height: <?php echo $imageheight; ?>px" <?php endif; ?>> |
  |  | 3782 |  |
  |  | 3783 | <img |
  |  | 3784 | <?php |
  |  | 3785 | if ($settings['resize\_images'] == 0) : |
  |  | 3786 | ?> |
  |  | 3787 | class="fit\_img"  <?php endif; ?> src="<?php echo $outputimg; ?>" alt="<?php echo $rowTitle; ?>"  title="<?php echo $rowTitle; ?>" /> |
  |  | 3788 | <div class="<?php echo $hoverClass; ?>"></div> |
  |  | 3789 |  |
  |  | 3790 | </div> |
  |  | 3791 | </a> |
  |  | 3792 | <?php endif; ?> |
  |  | 3793 |  |
  |  | 3794 | <?php else : ?> |
  |  | 3795 | <a   data-type="<?php echo $media\_type; ?>" class="thumbnail\_ " data-categories="<?php echo $row['mtag']; ?>" href="<?php echo $row['murl']; ?>" > |
  |  | 3796 | <div class="thum\_div figure" |
  |  | 3797 | <?php |
  |  | 3798 | if ($settings['resize\_images'] == 0) : |
  |  | 3799 | ?> |
  |  | 3800 | style="width:<?php echo $imagewidth; ?>px;height: <?php echo $imageheight; ?>px" <?php endif; ?>> |
  |  | 3801 |  |
  |  | 3802 | <img |
  |  | 3803 | <?php |
  |  | 3804 | if ($settings['resize\_images'] == 0) : |
  |  | 3805 | ?> |
  |  | 3806 | class="fit\_img"  <?php endif; ?> src="<?php echo $outputimg; ?>" alt="<?php echo $rowTitle; ?>"  title="<?php echo $rowTitle; ?>" /> |
  |  | 3807 | <div class="<?php echo $hoverClass; ?>"></div> |
  |  | 3808 |  |
  |  | 3809 | </div> |
  |  | 3810 | </a> |
  |  | 3811 |  |
  |  | 3812 | <?php endif; ?> |
  |  | 3813 |  |
  |  | 3814 | <?php } ?> |
  |  | 3815 |  |
  |  | 3816 | <?php } ?> |
  |  | 3817 |  |
  |  | 3818 | </div><!-- .thumbnail\_wrap end --> |
  |  | 3819 |  |
  |  | 3820 | </div> |
  |  | 3821 |  |
  |  | 3822 | </div> |
  |  | 3823 |  |
  |  | 3824 | <script> |
  |  | 3825 | <?php $intval = uniqid('interval\_'); ?> |
  |  | 3826 |  |
  |  | 3827 | var <?php echo $intval; ?> = setInterval(function () { |
  |  | 3828 |  |
  |  | 3829 | if (document.readyState === 'complete') { |
  |  | 3830 |  |
  |  | 3831 | clearInterval(<?php echo $intval; ?>); |
  |  | 3832 |  |
  |  | 3833 | <?php $uniqId = uniqid(); ?> |
  |  | 3834 | var uniqObj<?php echo $uniqId; ?> = jQuery("a[data-rel='<?php echo $randOmeRel; ?>']"); |
  |  | 3835 |  |
  |  | 3836 |  |
  |  | 3837 | var func = jQuery('#<?php echo $rand\_Num\_td; ?>').filterMediank({ |
  |  | 3838 |  |
  |  | 3839 | thumbWidth: <?php echo $settings['imagewidth']; ?>, |
  |  | 3840 | thumbHeight: <?php echo $settings['imageheight']; ?>, |
  |  | 3841 | thumbsSpacing:<?php echo $settings['imageMargin']; ?>, |
  |  | 3842 | galleryId: "<?php echo $rand\_var\_name; ?>", |
  |  | 3843 | backgroundColor: "<?php echo $settings['BackgroundColor']; ?>", |
  |  | 3844 | uniqueObjId: "uniqObj<?php echo $uniqId; ?>", |
  |  | 3845 | }); |
  |  | 3846 | jQuery('#<?php echo $rand\_var\_name; ?>').css('visibility', 'visible') |
  |  | 3847 |  |
  |  | 3848 | var globalTimer = null; |
  |  | 3849 |  |
  |  | 3850 | jQuery(window).resize(function () { |
  |  | 3851 | clearTimeout(globalTimer); |
  |  | 3852 | globalTimer = setTimeout(doneResize, 500); |
  |  | 3853 | }); |
  |  | 3854 |  |
  |  | 3855 | function doneResize() { |
  |  | 3856 |  |
  |  | 3857 | func.resizeWin('<?php echo $rand\_var\_name; ?>'); |
  |  | 3858 | } |
  |  | 3859 |  |
  |  | 3860 | jQuery(".<?php echo $randOmVlBox; ?>").fancybox\_fp({ |
  |  | 3861 |  |
  |  | 3862 | 'overlayColor': '#000000', |
  |  | 3863 | 'padding': 3, |
  |  | 3864 | 'margin': 20, |
  |  | 3865 | 'autoScale': true, |
  |  | 3866 | 'autoDimensions': true, |
  |  | 3867 | 'uniqObj': uniqObj<?php echo $uniqId; ?>, |
  |  | 3868 | 'uniqRel': '<?php echo $randOmeRel; ?>', |
  |  | 3869 | 'transitionIn': 'fade', |
  |  | 3870 | 'transitionOut': 'fade', |
  |  | 3871 | 'titlePosition': 'outside', |
  |  | 3872 | 'cyclic': true, |
  |  | 3873 | 'hideOnContentClick': false, |
  |  | 3874 | 'width': 650, |
  |  | 3875 | 'height': 400, |
  |  | 3876 | 'titleFormat': function (title, currentArray, currentIndex, currentOpts) { |
  |  | 3877 |  |
  |  | 3878 | var currtElem = jQuery('#<?php echo $rand\_Num\_td; ?> a[href="' + currentOpts.href + '"]'); |
  |  | 3879 | var isoverlay = jQuery(currtElem).attr('data-overlay') |
  |  | 3880 |  |
  |  | 3881 | if (isoverlay == "1" && jQuery.trim(title) != "") { |
  |  | 3882 | return '<span id="fancybox\_fp-title-over">' + title + '</span>'; |
  |  | 3883 | } else { |
  |  | 3884 | return ''; |
  |  | 3885 | } |
  |  | 3886 |  |
  |  | 3887 | } |
  |  | 3888 | }); |
  |  | 3889 |  |
  |  | 3890 | } |
  |  | 3891 |  |
  |  | 3892 | }, 100); |
  |  | 3893 |  |
  |  | 3894 |  |
  |  | 3895 |  |
  |  | 3896 |  |
  |  | 3897 | </script> |
  |  | 3898 |  |
  |  | 3899 | </div> |
  |  | 3900 |  |
  |  | 3901 | </div> |
  |  | 3902 |  |
  |  | 3903 | <?php } ?> |
  |  | 3904 |  |
  |  | 3905 | <div class="clear"></div> |
  |  | 3906 |  |
  |  | 3907 | <?php |
  |  | 3908 | $output = ob\_get\_clean(); |
  |  | 3909 | return $output; |
  | 3969 | 3910 | } |
  |  | 3911 |  |
  | 3970 | 3912 | function rfp\_e\_portfolio\_get\_wp\_version() { |
  | 3971 |  | global $wp\_version; |
  | 3972 |  | return $wp\_version; |
  |  | 3913 | global $wp\_version; |
  |  | 3914 | return $wp\_version; |
  | 3973 | 3915 | } |
  | 3974 | 3916 |  |
  | 3975 | 3917 | // also we will add an option function that will check for plugin admin page or not |
  | 3976 | 3918 | function rfp\_responsive\_portfolio\_plus\_lightbox\_is\_plugin\_page() { |
  | 3977 |  | $server\_uri = "http://{$\_SERVER['HTTP\_HOST']}{$\_SERVER['REQUEST\_URI']}"; |
  | 3978 |  |  |
  | 3979 |  | foreach ( array ('responsive\_portfolio\_with\_lightbox\_media\_management','responsive\_portfolio\_with\_lightbox' |
  | 3980 |  | ) as $allowURI ) { |
  | 3981 |  | if (stristr ( $server\_uri, $allowURI )) |
  | 3982 |  | return true; |
  | 3983 |  | } |
  | 3984 |  | return false; |
  |  | 3919 | $server\_uri = "http://{$\_SERVER['HTTP\_HOST']}{$\_SERVER['REQUEST\_URI']}"; |
  |  | 3920 |  |
  |  | 3921 | foreach (array('responsive\_portfolio\_with\_lightbox\_media\_management', 'responsive\_portfolio\_with\_lightbox' |
  |  | 3922 | ) as $allowURI) { |
  |  | 3923 | if (stristr($server\_uri, $allowURI)) { |
  |  | 3924 | return true; |
  |  | 3925 | } |
  |  | 3926 | } |
  |  | 3927 | return false; |
  | 3985 | 3928 | } |
  | 3986 | 3929 |  |
  | 3987 | 3930 | // add media WP scripts |
  | 3988 | 3931 | function rfp\_responsive\_portfolio\_plus\_lightbox\_admin\_scripts\_init() { |
  | 3989 |  |  |
  | 3990 |  | if (rfp\_responsive\_portfolio\_plus\_lightbox\_is\_plugin\_page ()) { |
  | 3991 |  | // double check for WordPress version and function exists |
  | 3992 |  | if (function\_exists ( 'wp\_enqueue\_media' ) && version\_compare ( rfp\_e\_portfolio\_get\_wp\_version (), '3.5', '>=' )) { |
  | 3993 |  | // call for new media manager |
  | 3994 |  | wp\_enqueue\_media (); |
  | 3995 |  | } |
  | 3996 |  | wp\_enqueue\_style ( 'media' ); |
  | 3997 |  | wp\_enqueue\_style( 'wp-color-picker' ); |
  | 3998 |  | wp\_enqueue\_script( 'wp-color-picker' ); |
  | 3999 |  |  |
  | 4000 |  | } |
  |  | 3932 |  |
  |  | 3933 | if (rfp\_responsive\_portfolio\_plus\_lightbox\_is\_plugin\_page()) { |
  |  | 3934 | // double check for WordPress version and function exists |
  |  | 3935 | if (function\_exists('wp\_enqueue\_media') && version\_compare(rfp\_e\_portfolio\_get\_wp\_version(), '3.5', '>=')) { |
  |  | 3936 | // call for new media manager |
  |  | 3937 | wp\_enqueue\_media(); |
  |  | 3938 | } |
  |  | 3939 | wp\_enqueue\_style('media'); |
  |  | 3940 | wp\_enqueue\_style('wp-color-picker'); |
  |  | 3941 | wp\_enqueue\_script('wp-color-picker'); |
  |  | 3942 | } |
  | 4001 | 3943 | } |
  | 4002 | 3944 | ?> |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2899431&old=2808922&new_path=%2Fresponsive-filterable-portfolio%2Ftags%2F1.0.20&old_path=%2Fresponsive-filterable-portfolio%2Ftags%2F1.0.19)
* [Zip Archive](?format=zip&new=2899431&old=2808922&new_path=%2Fresponsive-filterable-portfolio%2Ftags%2F1.0.20&old_path=%2Fresponsive-filterable-portfolio%2Ftags%2F1.0.19)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


