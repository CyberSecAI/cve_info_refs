- **Root cause of vulnerability**: A transaction commit in C Xenstored doesn't properly handle negative quota values that can arise when a node is removed outside the transaction, leading to an assertion failure and crash due to an incorrect assumption that the quota will always be non-negative.
- **Weaknesses/vulnerabilities present**: The C Xenstored implementation assumes the quota will never be negative and uses an assert() to check this condition, which can lead to a crash when the assertion fails.
- **Impact of exploitation**: A malicious guest can craft a transaction that triggers the bug, crashing C Xenstored. This prevents further domain administration such as starting new guests, or adding/removing resources for existing ones.
- **Attack vectors**: A malicious guest can trigger the crash by crafting a specific transaction.
- **Required attacker capabilities/position**: The attacker needs to be a malicious guest with the ability to influence Xenstored's behavior through crafted transactions.