```
{
  "CVE-2023-34451": {
    "Metadata": {
      "Description": "The mempool maintains two data structures to keep track of outstanding transactions: a list and a map. These two data structures are supposed to be in sync all the time in the sense that the map tracks the index (if any) of the transaction in the list. Unfortunately, it is possible to have them out of sync. When this happens, the list may contain several copies of the same transaction. Because the map tracks a single index, it is then no longer possible to remove all the copies of the transaction from the list. This happens even if the duplicated transaction is later committed in a block. The only way to remove the transaction is by restarting the node.",
      "CWE": "N/A",
       "Patched versions": [
        "v0.34.29",
        "v0.37.2"
      ],
      "Affected versions": [
        "v0.37.0",
        "v0.37.1",
        "< v0.34.28"
      ]
    },
    "Root cause": "The mempool's list and map data structures for tracking transactions could get out of sync due to cache overflows. When the cache overflows, it could lead to duplicate transactions in the list while the map only tracks a single occurrence. This desynchronization made it impossible to remove all transaction copies from the list even if the duplicated transaction gets committed in a block.",
    "Vulnerabilities": [
      "The mempool's list and map data structures can get out of sync.",
      "Duplicate transactions can exist in the mempool's list.",
      "The map tracks only a single instance of a transaction even if there are duplicates.",
       "It becomes impossible to remove duplicated transactions, leading to a memory leak and continued gossip of invalid transactions."
    ],
    "Impact": "The impact is a potential memory leak, with duplicated transactions getting stuck in mempool data structures and gossiped to peers indefinitely. Attackers could exploit this to cause resource exhaustion and potentially crash target nodes.",
    "Attack vectors": [
      "Sending a transaction to the full node.",
      "Sending N different transactions to overflow the cache.",
       "Resending the first transaction again."
    ],
    "Attacker capabilities": "An attacker can be an external entity interacting with the node via RPC or an attacker with a modified (Byzantine) node that can exploit the vulnerability via p2p. They need to be able to send transactions to the full node and control the rate of transactions to overflow the mempool cache."
  }
}
```