=== Content from github.com_971e168a_20250115_081427.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcesanta%2Fmongoose%2Fcompare%2F7.9...7.10)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcesanta%2Fmongoose%2Fcompare%2F7.9...7.10)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=cesanta%2Fmongoose)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cesanta](/cesanta)
/
**[mongoose](/cesanta/mongoose)**
Public

* [Notifications](/login?return_to=%2Fcesanta%2Fmongoose) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2Fcesanta%2Fmongoose)
* [Star
   11.3k](/login?return_to=%2Fcesanta%2Fmongoose)

* [Code](/cesanta/mongoose)
* [Issues
  8](/cesanta/mongoose/issues)
* [Pull requests
  1](/cesanta/mongoose/pulls)
* [Discussions](/cesanta/mongoose/discussions)
* [Actions](/cesanta/mongoose/actions)
* [Projects
  0](/cesanta/mongoose/projects)
* [Security](/cesanta/mongoose/security)
* [Insights](/cesanta/mongoose/pulse)

Additional navigation options

* [Code](/cesanta/mongoose)
* [Issues](/cesanta/mongoose/issues)
* [Pull requests](/cesanta/mongoose/pulls)
* [Discussions](/cesanta/mongoose/discussions)
* [Actions](/cesanta/mongoose/actions)
* [Projects](/cesanta/mongoose/projects)
* [Security](/cesanta/mongoose/security)
* [Insights](/cesanta/mongoose/pulse)

[Permalink](https://github.com/cesanta/mongoose/compare/cesanta%3A4236405...cesanta%3Ab379816)
# Comparing changes

 Choose two branches to see what’s changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
cesanta/mongoose

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
7.9

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/cesanta/mongoose/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...7.10)

Could not load tags

Nothing to show

[{{ refName }}
default](/cesanta/mongoose/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...7.10)

 Loading

...

*head repository:*
cesanta/mongoose

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
7.10

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/cesanta/mongoose/compare/7.9...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/cesanta/mongoose/compare/7.9...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

9
contributors

[Commits
304](#commits_bucket)
[Files changed
1,642](#files_bucket)

 Loading

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can’t render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff 7.9...7.10`

  Retry

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.narfindustries.com_3a9255e4_20250115_081425.html ===
[All Posts](/blog)[Tags](/tags)[All Posts](/blog)[Tags](/tags)Published onThursday, July 6, 2023
# Narf Discovers Critical Vulnerabilities in Cesanta Mongoose HTTP Server

Authors

* ![avatar](/static/images/avatar.png)NameBen KallusTwitter
* ![avatar](/static/images/avatar.png)NamePrashant AnantharamanTwitter

Narf's investigation of HTTP parsers for the [DARPA SafeDocs program](https://www.darpa.mil/news-events/2023-06-14) led us to uncover three vulnerabilities in Cesanta Mongoose. This effort was part of a larger initiative in which we analyze HTTP parsers in proxies, servers, load balancers, CDNs, and clients to characterize mismatches in protocol implementations.

The first bug was an easily-triggered denial-of-service attack that can be triggered remotely. This bug was fixed in the Mongoose 7.10 release. This bug was hidden in plain sight despite Mongoose's participation in the [OSS-Fuzz](https://github.com/google/oss-fuzz) project. To trigger this vulnerability, a request must have a `Content-Length` header with a value exactly equal to the request's negated length. It's unlikely that random mutations will arrive at such a specific value. That said, it's fairly likely that OSS-Fuzz has generated fuzzing inputs with negative `Content-Length`s, but since the fuzzer has no understanding of the HTTP grammar and does not compare program output to that of other HTTP servers, it would not be aware that it triggered a bug. *Format-Aware Differential Fuzzing* is needed to compare program outputs while generating syntactically well-formed inputs.

The second vulnerability was a request smuggling vulnerability where Mongoose does not correctly interpret the `Content-Length` header in HTTP requests. This bug was fixed in the *master* branch, but releases before Mongoose 6.18 remain vulnerable. Finally, the third vulnerability is another request smuggling bug that can be triggered by injecting an empty header. This bug was fixed in the Mongoose 7.11 release.

All three vulnerabilities identified by the Narf team point to inadequate input validation in Mongoose's HTTP implementation. These examples demonstrate that HTTP is a data format of sufficient complexity to benefit from principled parser generator toolkits developed for the SafeDocs program, such as [Daedalus](https://github.com/GaloisInc/daedalus/) and [Hammer](https://github.com/UpstandingHackers/hammer/).

## Background

[Cesanta Mongoose](https://github.com/cesanta/mongoose) is a network library that supports many network protocols and platforms. It is deployed by companies such as Siemens, Schneider Electric, Broadcom, Bosch, Google, Samsung, Qualcomm, and Caterpillar, primarily to run web interfaces on embedded computers. There are presently over 2000 public IPs running Mongoose servers.[1](#user-content-fn-1) Although most of these servers are configured to not respond with the version number in the HTTP responses, several servers run a default configuration where they explicitly disclose the Mongoose version.

HTTP requests are largely understood to have three primary components: the request line, the set of headers, and the body. While this abstract view is generally straightforward to understand, it turns out that correctly delimiting these partitions is challenging because of the allowed internal complexity of each, especially given the permitted flexibility in the set of legal delimiter values. The request line states which resource is being requested, the headers are key-value pairs that specify additional request information, and the body is a sequence of bytes that constitutes the data being sent with the request. Below is an example HTTP POST request.

```
POST / HTTP/1.1
Host: narfindustries.com
Connection: Keep-Alive
accept-encoding: gzip
user-agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/114.0
accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
accept-language: en-US,en;q=0.5
Content-Type: application/x-www-form-urlencoded
Content-Length: 27
field1=value1&field2=value2

```

This apparently human-readable example request is misleading even though it is emblematic of many HTTP requests and consistent with the informal expectation that HTTP requests are generally legible to humans and well-structured in their appearance. However, the data ingest code of most web servers sees merely a flat contiguous sequence of almost arbitrary byte values.

The `Content-Length` header specifies the length of an HTTP message's body. A valid `Content-Length` header has a value consisting of one or more ASCII digits. For example, when a server receives a request with a `Content-Length` header with the value `100`, it must expect that the request body consists of 100 octets. Any HTTP request is untrusted data that an attacker controls. The attacker could always supply no request body or a body that is much larger, invalidating the assertion that the length of the body must be 100 octets.

*HTTP pipelining* is a feature of HTTP/1.1 that allows clients to send multiple HTTP requests on the same TCP connection. Servers that support pipelining can then respond to each of the received requests in sequence. Pipelining improves the performance of an HTTP server by reducing the memory and CPU burden of allocating new sockets and input buffers and reduces the time taken to establish TCP handshakes. Because pipelined HTTP requests share a connection, and there is no delimiter between messages, an HTTP parser must be able to accurately determine the boundaries between pipelined requests based on `Content-Length` alone.[2](#user-content-fn-2)

## Discovery

These bugs were discovered by configuring a collection of HTTP servers to respond to every request in order to observe the malformations that are accepted by popular HTTP parsers. During manual testing, we prefixed `Content-Length` values with `-`, and noticed that Mongoose responds in three different ways: sometimes without error, sometimes responds twice, and sometimes closes the connection. By binary searching to the values at the borderlines of the ranges that cause these behaviors, we arrived at an input that causes denial of service.

## CVE-2023-34188: Denial of Service

Mongoose employs an HTTP [shotgun parser](https://langsec.org/papers/langsec-cwes-secdev2016.pdf) that does not properly validate HTTP `Content-Length` headers, and can be fooled into endlessly reading and re-reading the same request in a busy loop. Once it has entered this state, the server cannot respond to further requests and has effectively been taken down. Mongoose accepts `Content-Length` values with a `-` prefix, and treats them as negative. This behavior occurs because Mongoose used the function `mg_to64(struct mg_str str)` to convert a string to a 64-bit signed integer. The fix for this CVE was to add a new function to only work with the `size_t` datatype and remove support for the `mg_to64` function.

When parsing a (potentially pipelined) request, Mongoose determines where the request ends by reading its headers until it encounters the end-of-headers delimiter, then adding the `Content-Length` value to the offset of the end of the delimiter. This is intended to skip forward over the message body, but if the `Content-Length` is negative, Mongoose will instead skip backward. Thus, if the `Content-Length` value is the negation of the length of the entire request, the parser will skip back to the beginning of the request and parse it again. Generating the exploit for this vulnerability is trivial.

```
# Clone the Mongoose repository
git clone https://github.com/cesanta/mongoose
# Check out a vulnerable release, build it, and start the server
cd mongoose && git checkout 7.9
make &
# Send the payload
printf "$EXPLOIT_PAYLOAD" | nc localhost 8000
# In Python 3.10.6
>>> m = hashlib.sha256()
>>> m.update(b"Narf6/26/2023" + EXPLOIT_PAYLOAD)
>>> m.digest()
b'\xf8\x9a\xaa\x95\xc5R8}\xf2"W\xdc\xba\xf6\xccP\x1aKx\xc5\x9e\xe7\xcd\x04\x0eJ^\xe9\xcf\xac\\)'

```

After that, the following message should be endlessly printed to the screen: `5bc0ae39 2 main.c:32:cb GET / 200 1946`

*Note: We will release the exploit payload at a later time.*

### Timeline

* April 27, 2023: We disclose the vulnerability to Cesanta.
* April 28, 2023: Cesanta responds, saying that they'll investigate.
* May 17, 2023: Cesanta asks that we wait 30 days before making a security advisory.
* May 18, 2023: Cesanta confirms that they can reproduce the attack, and releases Mongoose 7.10, which patches the vulnerability.
* June 17, 2023: The 30-day period ends.

## HTTP Request Smuggling via incorrect Content-Length parsing

Often, HTTP servers are configured with a proxy server that is public-facing. The proxy accepts HTTP requests and forwards them to the backend HTTP servers. In pipelined requests, request smuggling attacks could arise from mismatches between how the proxy and the backend servers interpret where various requests begin. The PortSwigger team documented request smuggling attacks by mixing Transfer-Encoding and Content-Length in the same HTTP requests.[3](#user-content-fn-3)

Let us consider the following HTTP requests:

*Message 1*

```
GET / HTTP/1.1
Host: A
Content-Length: 27
Content-Lengthh: 0
GET / HTTP/1.1
Host: A

```

*Message 2*

```
GET / HTTP/1.1
Host: A
Content-Length: 27
Content-Length: 0
GET / HTTP/1.1
Host: A

```

The only difference between the two messages is in a trailing "h" character in Message 1. However, Mongoose interprets the `Content-Lengthh` as `Content-Length` because it performed a prefix match and considered the size of the payload to be 0. Proxy servers tend to leave the `Content-Lengthh` header as is since it may be a custom header field.

A proxy server, such as H2O, accepts the first `Content-Length` value, and rewrites the request to contain only one `Content-Length` header.[4](#user-content-fn-4) Hence, passing Message 2 via H2O to Mongoose does not have the same effect as passing Message 1. Sending both messages directly to Mongoose has the same effect--it interprets the `Content-Length` to be 0, but then ignores it entirely.

### Timeline

* April 27, 2023: We disclose the vulnerability to Cesanta.
* April 28, 2023: Cesanta responds, saying that they'll investigate.
* May 17, 2023: Cesanta says that given that the bug is fixed in the master branch, they will not fix.

## Truncated Headers Causing Request Smuggling

We found that we could trick the Mongoose server into dropping headers by injecting an empty header.

```
GET / HTTP/1.1
Host: whatever
:
Content-Length: 1

```

The line with the `:` is an empty header that does not contain any key or value. In the above example, the `Content-Length` header is ignored by Mongoose. The correct way to handle this request is to either ignore only the empty header, or to treat the entire request as malformed and return a 400 response (Bad Request).

Note: HAProxy exhibited a similar error that has now been fixed: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-25725>.

### Timeline

* April 27, 2023: We disclose the vulnerability to Cesanta.
* April 28, 2023: Cesanta responds, saying that they'll investigate.
* May 17, 2023: Cesanta asks us to open an issue on GitHub since they do not consider this as a threat.
* June 26, 2023: Narf Industries reported the bug publicly at [GitHub](https://github.com/cesanta/mongoose/issues/2275), at the request of the Cesanta team.
* July 3, 2023: Cesanta releases Mongoose 7.11, fixing the reported bug.

---

*Disclaimer*: This material is based in part upon work supported by the Defense Advanced Research Projects Agency (DARPA) under Contract No. HR001119C0073. Any opinions, findings and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the Defense Advanced Research Projects Agency (DARPA).

## Footnotes

1. Shodan Search: <https://www.shodan.io/search?query=%22Mongoose%22+port%3A80>. Several Mongoose servers are also available on Port 8000 and 8080. [↩](#user-content-fnref-1)
2. Except when the requests use the chunked transfer encoding, but that's out of the scope of this blog post. [↩](#user-content-fnref-2)
3. <https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn> [↩](#user-content-fnref-3)
4. <https://github.com/h2o/h2o> [↩](#user-content-fnref-4)
## Tags

[langsec](/tags/langsec)[safedocs](/tags/safedocs)[http-research](/tags/http-research)
## Previous Article

[Narf Investigates New Methods of Detecting Emergent Behavior](/blog/narf-darpa-harden)
## Next Article

[A Not Quite Orphaned Project](/blog/a-not-quite-orphaned-project)[← Back to the blog](/blog)[Narf](https://narfindustries.com/) • [Narf Group](https://narfgroup.com/) • © 2024

=== Content from github.com_1403fd10_20250115_081426.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcesanta%2Fmongoose%2Fcommit%2F4663090a8fb036146dfe77718cff612b0101cb0f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcesanta%2Fmongoose%2Fcommit%2F4663090a8fb036146dfe77718cff612b0101cb0f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=cesanta%2Fmongoose)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cesanta](/cesanta)
/
**[mongoose](/cesanta/mongoose)**
Public

* [Notifications](/login?return_to=%2Fcesanta%2Fmongoose) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2Fcesanta%2Fmongoose)
* [Star
   11.3k](/login?return_to=%2Fcesanta%2Fmongoose)

* [Code](/cesanta/mongoose)
* [Issues
  8](/cesanta/mongoose/issues)
* [Pull requests
  1](/cesanta/mongoose/pulls)
* [Discussions](/cesanta/mongoose/discussions)
* [Actions](/cesanta/mongoose/actions)
* [Projects
  0](/cesanta/mongoose/projects)
* [Security](/cesanta/mongoose/security)
* [Insights](/cesanta/mongoose/pulse)

Additional navigation options

* [Code](/cesanta/mongoose)
* [Issues](/cesanta/mongoose/issues)
* [Pull requests](/cesanta/mongoose/pulls)
* [Discussions](/cesanta/mongoose/discussions)
* [Actions](/cesanta/mongoose/actions)
* [Projects](/cesanta/mongoose/projects)
* [Security](/cesanta/mongoose/security)
* [Insights](/cesanta/mongoose/pulse)

## Commit

[Permalink](/cesanta/mongoose/commit/4663090a8fb036146dfe77718cff612b0101cb0f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Added check for negative value for HTTP Content-Length header

[Browse files](/cesanta/mongoose/tree/4663090a8fb036146dfe77718cff612b0101cb0f)
Browse the repository at this point in the history

* Loading branch information

[![@allanpark](https://avatars.githubusercontent.com/u/20723550?s=40&v=4)](/allanpark)

[allanpark](/cesanta/mongoose/commits?author=allanpark "View all commits by allanpark")
committed
May 16, 2023

1 parent
[9088b00](/cesanta/mongoose/commit/9088b00006d869de7a5f9515c70a562d87af271e)

commit 4663090

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**10 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* mongoose.c
  [mongoose.c](#diff-ecf3de182ff552371998085abf4bda6e008c8f0b8fbbc02fc9481c41b0e3fc6b)
* src

  + src/http.c
    [http.c](#diff-4b8a915e7a0661ce6c35078f460d190a3d7212e7bf57113a26e25b74f3d4e41b)
* test

  + test/unit\_test.c
    [unit\_test.c](#diff-1bed737e839c19f83a3123cdfe6053c60fbf35324f86b517449fad5fd98d3f16)

## There are no files selected for viewing

4 changes: 3 additions & 1 deletion

4
[mongoose.c](#diff-ecf3de182ff552371998085abf4bda6e008c8f0b8fbbc02fc9481c41b0e3fc6b "mongoose.c")

Show comments

[View file](/cesanta/mongoose/blob/4663090a8fb036146dfe77718cff612b0101cb0f/mongoose.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1463,7 +1463,9 @@ int mg\_http\_parse(const char \*s, size\_t len, struct mg\_http\_message \*hm) { |
|  |  | mg\_http\_parse\_headers(s, end, hm->headers, |
|  |  | sizeof(hm->headers) / sizeof(hm->headers[0])); |
|  |  | if ((cl = mg\_http\_get\_header(hm, "Content-Length")) != NULL) { |
|  |  | hm->body.len = (size\_t) mg\_to64(\*cl); |
|  |  | int64\_t content\_len = mg\_to64(\*cl); |
|  |  | if(content\_len < 0) return -1; |
|  |  | hm->body.len = (size\_t) content\_len; |
|  |  | hm->message.len = (size\_t) req\_len + hm->body.len; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[src/http.c](#diff-4b8a915e7a0661ce6c35078f460d190a3d7212e7bf57113a26e25b74f3d4e41b "src/http.c")

Show comments

[View file](/cesanta/mongoose/blob/4663090a8fb036146dfe77718cff612b0101cb0f/src/http.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -231,7 +231,9 @@ int mg\_http\_parse(const char \*s, size\_t len, struct mg\_http\_message \*hm) { |
|  |  | mg\_http\_parse\_headers(s, end, hm->headers, |
|  |  | sizeof(hm->headers) / sizeof(hm->headers[0])); |
|  |  | if ((cl = mg\_http\_get\_header(hm, "Content-Length")) != NULL) { |
|  |  | hm->body.len = (size\_t) mg\_to64(\*cl); |
|  |  | int64\_t content\_len = mg\_to64(\*cl); |
|  |  | if(content\_len < 0) return -1; |
|  |  | hm->body.len = (size\_t) content\_len; |
|  |  | hm->message.len = (size\_t) req\_len + hm->body.len; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[test/unit\_test.c](#diff-1bed737e839c19f83a3123cdfe6053c60fbf35324f86b517449fad5fd98d3f16 "test/unit_test.c")

Show comments

[View file](/cesanta/mongoose/blob/4663090a8fb036146dfe77718cff612b0101cb0f/test/unit_test.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -790,6 +790,10 @@ static void test\_http\_server(void) { |
|  |  | ASSERT(fetch(&mgr, buf, url, "GET /..ddot HTTP/1.0\n\n") == 301); |
|  |  | ASSERT(fetch(&mgr, buf, url, "GET /..ddot/ HTTP/1.0\n\n") == 200); |
|  |  | ASSERT(cmpbody(buf, "hi\n") == 0); |
|  |  | ASSERT(fetch(&mgr, buf, url, "GET /a.txt HTTP/1.0\n" |
|  |  | "Content-Length: -123\n\n") == 0); |
|  |  | ASSERT(fetch(&mgr, buf, url, "POST /a.txt HTTP/1.0\n" |
|  |  | "Content-Length: -123\n\n") == 0); |
|  |  |  |
|  |  | { |
|  |  | extern char \*mg\_http\_etag(char \*, size\_t, size\_t, time\_t); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4663090`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcesanta%2Fmongoose%2Fcommit%2F4663090a8fb036146dfe77718cff612b0101cb0f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b3a4c172_20250115_081430.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcesanta%2Fmongoose%2Fpull%2F2197)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcesanta%2Fmongoose%2Fpull%2F2197)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=cesanta%2Fmongoose)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cesanta](/cesanta)
/
**[mongoose](/cesanta/mongoose)**
Public

* [Notifications](/login?return_to=%2Fcesanta%2Fmongoose) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2Fcesanta%2Fmongoose)
* [Star
   11.3k](/login?return_to=%2Fcesanta%2Fmongoose)

* [Code](/cesanta/mongoose)
* [Issues
  8](/cesanta/mongoose/issues)
* [Pull requests
  1](/cesanta/mongoose/pulls)
* [Discussions](/cesanta/mongoose/discussions)
* [Actions](/cesanta/mongoose/actions)
* [Projects
  0](/cesanta/mongoose/projects)
* [Security](/cesanta/mongoose/security)
* [Insights](/cesanta/mongoose/pulse)

Additional navigation options

* [Code](/cesanta/mongoose)
* [Issues](/cesanta/mongoose/issues)
* [Pull requests](/cesanta/mongoose/pulls)
* [Discussions](/cesanta/mongoose/discussions)
* [Actions](/cesanta/mongoose/actions)
* [Projects](/cesanta/mongoose/projects)
* [Security](/cesanta/mongoose/security)
* [Insights](/cesanta/mongoose/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fcesanta%2Fmongoose%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fcesanta%2Fmongoose%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Added check for negative value for HTTP Content-Length header #2197

 Merged

[scaprile](/scaprile)
merged 1 commit into
[master](/cesanta/mongoose/tree/master "cesanta/mongoose:master")
from
[BUGFIX\_handle\_http\_negative\_content\_length](/cesanta/mongoose/tree/BUGFIX_handle_http_negative_content_length "cesanta/mongoose:BUGFIX_handle_http_negative_content_length")

May 16, 2023

 Merged

# [Added check for negative value for HTTP Content-Length header](#top) #2197

[scaprile](/scaprile)
merged 1 commit into
[master](/cesanta/mongoose/tree/master "cesanta/mongoose:master")
from
[BUGFIX\_handle\_http\_negative\_content\_length](/cesanta/mongoose/tree/BUGFIX_handle_http_negative_content_length "cesanta/mongoose:BUGFIX_handle_http_negative_content_length")

May 16, 2023

[Conversation
5](/cesanta/mongoose/pull/2197)
[Commits
1](/cesanta/mongoose/pull/2197/commits)
[Checks
0](/cesanta/mongoose/pull/2197/checks)
[Files changed](/cesanta/mongoose/pull/2197/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![allanpark](https://avatars.githubusercontent.com/u/20723550?s=60&v=4)](/allanpark)

Copy link

Contributor

### @allanpark **[allanpark](/allanpark)** commented [May 16, 2023](#issue-1711910976)

Added check for negative value for HTTP Content-Length. HTTP "Bad request"(400) will be sent as responce.

Sorry, something went wrong.

All reactions

 [![@allanpark](https://avatars.githubusercontent.com/u/20723550?s=40&u=62dcbd49596af4fd254627181302833dd8791360&v=4)](/allanpark)
[allanpark](/allanpark)
requested a review
from [cpq](/cpq)
[May 16, 2023 12:19](#event-9257430873)

[![@allanpark](https://avatars.githubusercontent.com/u/20723550?s=40&u=62dcbd49596af4fd254627181302833dd8791360&v=4)](/allanpark)
[allanpark](/allanpark)
assigned [cpq](/cpq)
[May 16, 2023](#event-9257434516)

[![cpq](https://avatars.githubusercontent.com/u/601816?s=60&v=4)](/cpq)

**[cpq](/cpq)**
reviewed
[May 16, 2023](#pullrequestreview-1428524331)

 [View reviewed changes](/cesanta/mongoose/pull/2197/files)

[src/http.c](/cesanta/mongoose/pull/2197/files#diff-4b8a915e7a0661ce6c35078f460d190a3d7212e7bf57113a26e25b74f3d4e41b)
Outdated

|  |  | mg\_error(c, "HTTP parse:\n%.\*s", (int) c->recv.len, c->recv.buf); |
| --- | --- | --- |
|  |  | mg\_printf(c, "HTTP/1.0 400 Bad Request\r\n\r\n"); |
|  |  | MG\_ERROR(("%lu HTTP malformed message", c->id)); |
|  |  | mg\_iobuf\_del(&c->recv, 0, hm.message.len); |

Copy link

Member

### @cpq **[cpq](/cpq)** [May 16, 2023](#discussion_r1195128548)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I'd leave this snippet untouched.

If we fail to parse a request, chances are it was a complete garbage. There is noone there to receive the "400 Bad request", so no point to send it. I think the best way to handle is to abort the connection with `mg_error()` as we did, rather than cleaning up and trying to recover.

Sorry, something went wrong.

All reactions

[![scaprile](https://avatars.githubusercontent.com/u/6046251?s=60&v=4)](/scaprile)

**[scaprile](/scaprile)**
reviewed
[May 16, 2023](#pullrequestreview-1428524663)

 [View reviewed changes](/cesanta/mongoose/pull/2197/files)

[src/http.c](/cesanta/mongoose/pull/2197/files#diff-4b8a915e7a0661ce6c35078f460d190a3d7212e7bf57113a26e25b74f3d4e41b)
Outdated

Comment on lines
235
 to
236

|  |  | if(content\_len < 0) |
| --- | --- | --- |
|  |  | return -1; |

Copy link

Collaborator

### @scaprile **[scaprile](/scaprile)** [May 16, 2023](#discussion_r1195128773)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

For these lines we usually put everything in a single line.

Please run clang-format and it will do it for you (the format file is on a hidden dir at the root of the repo)

Sorry, something went wrong.

All reactions

[![scaprile](https://avatars.githubusercontent.com/u/6046251?s=60&v=4)](/scaprile)

**[scaprile](/scaprile)**
reviewed
[May 16, 2023](#pullrequestreview-1428525690)

 [View reviewed changes](/cesanta/mongoose/pull/2197/files)

[src/http.c](/cesanta/mongoose/pull/2197/files#diff-4b8a915e7a0661ce6c35078f460d190a3d7212e7bf57113a26e25b74f3d4e41b)
Outdated

|  |  | @@ -470,7 +473,7 @@ void mg\_http\_serve\_file(struct mg\_connection \*c, struct mg\_http\_message \*hm, | |
| --- | --- | --- | --- |
|  |  | } |
|  |  | // No luck opening .gz? Open what we've told to open |
|  |  | if (fd == NULL) fd = mg\_fs\_open(fs, path, MG\_FS\_READ); |
|  |  | } |
|  |  | } |

Copy link

Collaborator

### @scaprile **[scaprile](/scaprile)** [May 16, 2023](#discussion_r1195129425)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

clang-format

Sorry, something went wrong.

All reactions

[![cpq](https://avatars.githubusercontent.com/u/601816?s=60&v=4)](/cpq)

**[cpq](/cpq)**
reviewed
[May 16, 2023](#pullrequestreview-1428528070)

 [View reviewed changes](/cesanta/mongoose/pull/2197/files)

[test/unit\_test.c](/cesanta/mongoose/pull/2197/files#diff-1bed737e839c19f83a3123cdfe6053c60fbf35324f86b517449fad5fd98d3f16)
Outdated

|  |  | ASSERT(fetch(&mgr, buf, url, "GET /a.txt HTTP/1.0\n" |
| --- | --- | --- |
|  |  | "Content-Length: -123\n\n") == 400); |
|  |  | ASSERT(fetch(&mgr, buf, url, "POST /a.txt HTTP/1.0\n" |
|  |  | "Content-Length: -123\n\n") == 400); |

Copy link

Member

### @cpq **[cpq](/cpq)** [May 16, 2023](#discussion_r1195130997)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

If server just aborts the connection, fetch() should return 0, IMO. That's what we should check for.

Sorry, something went wrong.

All reactions

[![scaprile](https://avatars.githubusercontent.com/u/6046251?s=60&v=4)](/scaprile)

**[scaprile](/scaprile)**
reviewed
[May 16, 2023](#pullrequestreview-1428536239)

 [View reviewed changes](/cesanta/mongoose/pull/2197/files)

Copy link

Collaborator

### @scaprile **[scaprile](/scaprile)** left a comment • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Please run `make test` and cancel it, so it just builds the amalgamated sources, and include `mongoose.c` in the PR

(I bet this is the reason for that many failed tests)

Sorry, something went wrong.

All reactions

[![@allanpark](https://avatars.githubusercontent.com/u/20723550?s=40&v=4)](/allanpark)

`[Added check for negative value for HTTP Content-Length header](/cesanta/mongoose/pull/2197/commits/4663090a8fb036146dfe77718cff612b0101cb0f "Added check for negative value for HTTP Content-Length header")`

`[4663090](/cesanta/mongoose/pull/2197/commits/4663090a8fb036146dfe77718cff612b0101cb0f)`

 [![@allanpark](https://avatars.githubusercontent.com/u/20723550?s=40&u=62dcbd49596af4fd254627181302833dd8791360&v=4)](/allanpark)
[allanpark](/allanpark)
[force-pushed](/cesanta/mongoose/compare/6ccfd2d6c28a2b93f694f8f3b0085c7d6e16d973..4663090a8fb036146dfe77718cff612b0101cb0f)
the
BUGFIX\_handle\_http\_negative\_content\_length

branch
from
[`6ccfd2d`](/cesanta/mongoose/commit/6ccfd2d6c28a2b93f694f8f3b0085c7d6e16d973) to
[`4663090`](/cesanta/mongoose/commit/4663090a8fb036146dfe77718cff612b0101cb0f)  [Compare](/cesanta/mongoose/compare/6ccfd2d6c28a2b93f694f8f3b0085c7d6e16d973..4663090a8fb036146dfe77718cff612b0101cb0f)
[May 16, 2023 15:54](#event-9259859465)

[![@scaprile](https://avatars.githubusercontent.com/u/6046251?s=40&u=a0e897f0eb4a860f3b04c0f2dee8dcd485fa88cc&v=4)](/scaprile)
[scaprile](/scaprile)
merged commit [`926959a`](/cesanta/mongoose/commit/926959ab47e78302837bec864863d94dcb78a210)
into
master

[May 16, 2023](https://github.com/cesanta/mongoose/pull/2197#event-9261646397)

 [![@scaprile](https://avatars.githubusercontent.com/u/6046251?s=40&u=a0e897f0eb4a860f3b04c0f2dee8dcd485fa88cc&v=4)](/scaprile)
[scaprile](/scaprile)
deleted the
BUGFIX\_handle\_http\_negative\_content\_length

branch
[May 16, 2023 19:11](#event-9261647750)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fcesanta%2Fmongoose%2Fpull%2F2197)

Reviewers

[![@scaprile](https://avatars.githubusercontent.com/u/6046251?s=40&v=4)](/scaprile) [scaprile](/scaprile)

scaprile left review comments

[![@cpq](https://avatars.githubusercontent.com/u/601816?s=40&v=4)](/cpq) [cpq](/cpq)

cpq left review comments

Assignees

[![@cpq](https://avatars.githubusercontent.com/u/601816?s=40&v=4)](/cpq) [cpq](/cpq)

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@allanpark](https://avatars.githubusercontent.com/u/20723550?s=52&v=4)](/allanpark) [![@cpq](https://avatars.githubusercontent.com/u/601816?s=52&v=4)](/cpq) [![@scaprile](https://avatars.githubusercontent.com/u/6046251?s=52&v=4)](/scaprile)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


