=== Content from lists.debian.org_7c236359_20250114_215635.html ===


---

[[Date Prev](msg00015.html)][[Date Next](msg00017.html)]
[[Thread Prev](msg00015.html)][[Thread Next](msg00017.html)]
[[Date Index](maillist.html#00016)]
[[Thread Index](threads.html#00016)]

# [SECURITY] [DLA 3494-1] ruby-doorkeeper security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3494-1] ruby-doorkeeper security update
* *From*: "Chris Lamb" <lamby@debian.org>
* *Date*: Wed, 12 Jul 2023 14:13:40 +0100
* *Message-id*: <[[üîé]](/msgid-search/168916671611.233313.12497134726466222313%40copycat)¬†[168916671611.233313.12497134726466222313@copycat](msg00016.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3494-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                           Chris Lamb
July 12, 2023                                 <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : ruby-doorkeeper
Version        : 4.4.2-1+deb10u1
CVE ID         : CVE-2023-34246
Debian Bug     : 1038950

It was discovered that there was an issue in ruby-doorkeeper, a
OAuth2 provider for Ruby on Rails applications. Doorkeeper
automatically processed authorization requests without user consent
for public clients that have been previously approved, but public
clients are inherently vulnerable to impersonation as their identity
cannot be assured.

For Debian 10 buster, this problem has been fixed in version
4.4.2-1+deb10u1.

We recommend that you upgrade your ruby-doorkeeper packages.

For the detailed security status of ruby-doorkeeper please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/ruby-doorkeeper>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEwv5L0nHBObhsUz5GHpU+J9QxHlgFAmSuo3oACgkQHpU+J9Qx
Hlix3g//YOh1bGBfnpEeeijsJZpoc0FVLDQP+OcdXnScaZEgtuUTQyQmHShV2Tny
ywgo4YTBvZEl6n9ZNqRspRr3AZapOXnccuho2TqtwQw71UOYXCrvXVt0wDK7k1VW
NsRBsugiCfGqURnryF9DjCSX2Dt4q6pUQFcbq0sj+285nw1Tzpf8dBVYjV6slyGu
n1IdsUk6WfHAtXs4krfv4UVzHQqqbdWZ7suv3xsXlrVXuFz7dxk9eXoF5bwyhYKu
V+F+HdloLGXy6dc3tFgHX6sr/rk2ALPMh0XaWRUEeAVEwRYaz5WSg/nJp74a6JSZ
TO9azjeN9ZSDSRi139T1g79U1I3InXf6WWOfj1q6UvV3l16a7eM36UyIblBoNS81
PsLlPONBHprSZq0uorna42Er8uJWt6ZqyOg+PnMRIVHQFgbA58TOuXZzS71Eng1d
Vyvr/y1+VPG3oo5imejTqFPUc7QupCfJukTNMHwsjoWVqgUx0qJXO5VCpbztfY5f
JAcLTQZYRlJwEQ9k36SNNDO49rH+x6iG5mzpJYQnHN2kTId1FZx433XKlgywGxys
MH/2iM+JJyF2pWqolGIi0VELiKriVCxQ7cUKmNXSQ93pa95GmC/EPj1to4LvoPLX
Q/M1gPsJEhcinJQYDKCjzOr8kBBsRAfYPpAGLk2oc/i31aymhtM=
=P9Fv
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_5384ec37_20250114_215628.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdoorkeeper-gem%2Fdoorkeeper%2Fpull%2F1646)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdoorkeeper-gem%2Fdoorkeeper%2Fpull%2F1646)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=doorkeeper-gem%2Fdoorkeeper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[doorkeeper-gem](/doorkeeper-gem)
/
**[doorkeeper](/doorkeeper-gem/doorkeeper)**
Public

* [Notifications](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper)
* [Star
   5.4k](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper)

* [Code](/doorkeeper-gem/doorkeeper)
* [Issues
  38](/doorkeeper-gem/doorkeeper/issues)
* [Pull requests
  7](/doorkeeper-gem/doorkeeper/pulls)
* [Discussions](/doorkeeper-gem/doorkeeper/discussions)
* [Actions](/doorkeeper-gem/doorkeeper/actions)
* [Wiki](/doorkeeper-gem/doorkeeper/wiki)
* [Security](/doorkeeper-gem/doorkeeper/security)
* [Insights](/doorkeeper-gem/doorkeeper/pulse)

Additional navigation options

* [Code](/doorkeeper-gem/doorkeeper)
* [Issues](/doorkeeper-gem/doorkeeper/issues)
* [Pull requests](/doorkeeper-gem/doorkeeper/pulls)
* [Discussions](/doorkeeper-gem/doorkeeper/discussions)
* [Actions](/doorkeeper-gem/doorkeeper/actions)
* [Wiki](/doorkeeper-gem/doorkeeper/wiki)
* [Security](/doorkeeper-gem/doorkeeper/security)
* [Insights](/doorkeeper-gem/doorkeeper/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Block public clients automatic authorization skip #1646

 Merged

[nbulaj](/nbulaj)
merged 1 commit into
[doorkeeper-gem:main](/doorkeeper-gem/doorkeeper/tree/main "doorkeeper-gem/doorkeeper:main")
from
[polleverywhere:confidential-skip-auth](/polleverywhere/doorkeeper/tree/confidential-skip-auth "polleverywhere/doorkeeper:confidential-skip-auth")

Mar 20, 2023

 Merged

# [Block public clients automatic authorization skip](#top) #1646

[nbulaj](/nbulaj)
merged 1 commit into
[doorkeeper-gem:main](/doorkeeper-gem/doorkeeper/tree/main "doorkeeper-gem/doorkeeper:main")
from
[polleverywhere:confidential-skip-auth](/polleverywhere/doorkeeper/tree/confidential-skip-auth "polleverywhere/doorkeeper:confidential-skip-auth")

Mar 20, 2023

[Conversation
1](/doorkeeper-gem/doorkeeper/pull/1646)
[Commits
1](/doorkeeper-gem/doorkeeper/pull/1646/commits)
[Checks
0](/doorkeeper-gem/doorkeeper/pull/1646/checks)
[Files changed](/doorkeeper-gem/doorkeeper/pull/1646/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![adam-h](https://avatars.githubusercontent.com/u/604449?s=60&v=4)](/adam-h)

Copy link

Contributor

### @adam-h **[adam-h](/adam-h)** commented [Mar 17, 2023](#issue-1628921437)

Non-confidential applications should not be able to skip the authorization stop, even if they have an existing matching\_token.

From the [issue](https://github.com/doorkeeper-gem/doorkeeper/issues/1589):

> According to RFC 8252 section 8.6, the authentication server should re-prompt for user consent, since the client's identity cannot be assured simply from the client\_id parameter

Fixes [#1589](https://github.com/doorkeeper-gem/doorkeeper/issues/1589)

Sorry, something went wrong.

 üëç
1
 hickford reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![@adam-h](https://avatars.githubusercontent.com/u/604449?s=40&v=4)](/adam-h)

`[Block public clients automatic authorization skip](/doorkeeper-gem/doorkeeper/pull/1646/commits/f202079baac4c978a01ccc9a45d78fde368ac907 "Block public clients automatic authorization skip

Non-confidential applications should not be able to skip the authorization stop, even if they have an existing matching_token.

From the [issue](https://github.com/doorkeeper-gem/doorkeeper/issues/1589):
> According to RFC 8252 section 8.6, the authentication server should re-prompt for user consent, since the client's identity cannot be assured simply from the client_id parameter

Fixes https://github.com/doorkeeper-gem/doorkeeper/issues/1589")`
 ‚Ä¶

`[f202079](/doorkeeper-gem/doorkeeper/pull/1646/commits/f202079baac4c978a01ccc9a45d78fde368ac907)`

```
Non-confidential applications should not be able to skip the authorization stop, even if they have an existing matching_token.

From the [issue]([doorkeeper-gem#1589](https://github.com/doorkeeper-gem/doorkeeper/issues/1589)):
> According to RFC 8252 section 8.6, the authentication server should re-prompt for user consent, since the client's identity cannot be assured simply from the client_id parameter

Fixes [doorkeeper-gem#1589](https://github.com/doorkeeper-gem/doorkeeper/issues/1589)
```

[![nbulaj](https://avatars.githubusercontent.com/u/1443426?s=60&v=4)](/nbulaj)

**[nbulaj](/nbulaj)**
approved these changes
[Mar 20, 2023](#pullrequestreview-1348514317)

 [View reviewed changes](/doorkeeper-gem/doorkeeper/pull/1646/files/f202079baac4c978a01ccc9a45d78fde368ac907)

Copy link

Member

### @nbulaj **[nbulaj](/nbulaj)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM üëç

Thanks!

Sorry, something went wrong.

 üéâ
1
 adam-h reacted with hooray emoji

All reactions

* üéâ
  1 reaction

[![@nbulaj](https://avatars.githubusercontent.com/u/1443426?s=40&u=38021cb0fce11181786ae9daed5c68fbc1e275cf&v=4)](/nbulaj)
[nbulaj](/nbulaj)
merged commit [`313af27`](/doorkeeper-gem/doorkeeper/commit/313af27391d974d314c1869828ca80dc1ae2678c)
into
doorkeeper-gem:main

[Mar 20, 2023](https://github.com/doorkeeper-gem/doorkeeper/pull/1646#event-8794476121)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fdoorkeeper-gem%2Fdoorkeeper%2Fpull%2F1646)

Reviewers

[![@nbulaj](https://avatars.githubusercontent.com/u/1443426?s=40&v=4)](/nbulaj) [nbulaj](/nbulaj)

nbulaj approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Non-confidential apps should always re-prompt for user consent](https://github.com/doorkeeper-gem/doorkeeper/issues/1589)

2 participants

[![@adam-h](https://avatars.githubusercontent.com/u/604449?s=52&v=4)](/adam-h) [![@nbulaj](https://avatars.githubusercontent.com/u/1443426?s=52&v=4)](/nbulaj)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from lists.debian.org_e6a87d9f_20250114_215636.html ===


---

[[Date Prev](msg00009.html)][[Date Next](msg00011.html)]
[[Thread Prev](msg00009.html)][[Thread Next](msg00011.html)]
[[Date Index](maillist.html#00010)]
[[Thread Index](threads.html#00010)]

# [SECURITY] [DLA 3989-1] ruby-doorkeeper security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3989-1] ruby-doorkeeper security update
* *From*: Adrian Bunk <bunk@debian.org>
* *Date*: Mon, 9 Dec 2024 05:09:14 +0200
* *Message-id*: <[[üîé]](/msgid-search/Z1ZfWuXY2NrwSzfh%40localhost)¬†[Z1ZfWuXY2NrwSzfh@localhost](msg00010.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3989-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Adrian Bunk
December 09, 2024                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : ruby-doorkeeper
Version        : 5.3.0-2+deb11u1
CVE ID         : CVE-2023-34246
Debian Bug     : 1038950

Improper Authentication has been fixed in ruby-doorkeeper,
an OAuth 2 provider for Rails and Grape.

For Debian 11 bullseye, this problem has been fixed in version
5.3.0-2+deb11u1.

We recommend that you upgrade your ruby-doorkeeper packages.

For the detailed security status of ruby-doorkeeper please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/ruby-doorkeeper>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEOvp1f6xuoR0v9F3wiNJCh6LYmLEFAmdWX1oACgkQiNJCh6LY
mLGl+BAApWoz33xadQZ2AWaZyMKG8TVAC55xKnolN6UoqMSdTyCTYEtYLGOPeANk
m42drK+ZTTj3eCns+1uEhTZa81YoNrTI/TKXQu57JuTwaERJwfFNl8o/QbS31cNV
xuIGSxs4qvFWYtqQoYV0Os8vyl3C4lNjEGZJqxcKny1CSWyjgR5YVK3waXvtAWr3
IXd6bztyhLWC6jVSuhjUzGkbWqrHI6caT0Y4CvFbny+fs5waqiOBftk1HYGjF1fe
0fIqFEs/QmGx74sCS01CSdvTcKHKlvgfwozJ061GxEhKLyNjzRPf+gayUixlE/hg
JKfJ2q9xuRxoQld9L8JpdTUz4BIV4dSp+A5qvkF1VNtYgltLbFsNF1s/h5mFewIv
D9ro3OZ0MNb+s0aecVOqqSTsPCLvbIGMN/4uwIS7gBJdf1VBHo/y/j02mPZ8CCBL
16jbu9XI5RbfqHSpvewb2WCdstBwTAip6zM/z3JBpC8Iw+7f7alZIcu32jwgh5wR
TOVmcB9GFHLFFyAg1Fc6i0JWSvFH8KW+QyWmS8E7aygBNBZ6oKegSOX17znb3U1A
eAxiUv8QBVX2WIfX2/6ZB6GlPyk9RF1GjRALZXTTX+Tfzx5n/OonFOc1pVROGAlG
wntA08zMMOevz0GRdKCqNqpID60MXgOL/AilN7V2iQg7iE8ZOAM=
=A8xa
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_642aab56_20250115_192801.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdoorkeeper-gem%2Fdoorkeeper%2Fsecurity%2Fadvisories%2FGHSA-7w2c-w47h-789w)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdoorkeeper-gem%2Fdoorkeeper%2Fsecurity%2Fadvisories%2FGHSA-7w2c-w47h-789w)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=doorkeeper-gem%2Fdoorkeeper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[doorkeeper-gem](/doorkeeper-gem)
/
**[doorkeeper](/doorkeeper-gem/doorkeeper)**
Public

* [Notifications](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper)
* [Star
   5.4k](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper)

* [Code](/doorkeeper-gem/doorkeeper)
* [Issues
  38](/doorkeeper-gem/doorkeeper/issues)
* [Pull requests
  7](/doorkeeper-gem/doorkeeper/pulls)
* [Discussions](/doorkeeper-gem/doorkeeper/discussions)
* [Actions](/doorkeeper-gem/doorkeeper/actions)
* [Wiki](/doorkeeper-gem/doorkeeper/wiki)
* [Security](/doorkeeper-gem/doorkeeper/security)
* [Insights](/doorkeeper-gem/doorkeeper/pulse)

Additional navigation options

* [Code](/doorkeeper-gem/doorkeeper)
* [Issues](/doorkeeper-gem/doorkeeper/issues)
* [Pull requests](/doorkeeper-gem/doorkeeper/pulls)
* [Discussions](/doorkeeper-gem/doorkeeper/discussions)
* [Actions](/doorkeeper-gem/doorkeeper/actions)
* [Wiki](/doorkeeper-gem/doorkeeper/wiki)
* [Security](/doorkeeper-gem/doorkeeper/security)
* [Insights](/doorkeeper-gem/doorkeeper/pulse)

# Improper Authentication in doorkeeper

Moderate

[nbulaj](/nbulaj)
published
GHSA-7w2c-w47h-789w
Jun 12, 2023

## Package

bundler

doorkeeper
([RubyGems](/advisories?query=ecosystem%3Arubygems))

## Affected versions

<5.6.6

## Patched versions

5.6.6

## Description

OAuth RFC 8252 says <https://www.rfc-editor.org/rfc/rfc8252#section-8.6>

> the authorization server SHOULD NOT process authorization requests automatically without user consent or interaction, except when the identity of the client can be assured. **This includes the case where the user has previously approved an authorization request for a given client id**

But Doorkeeper automatically processes authorization requests without user consent for public clients that have been previously approved. Public clients are inherently vulnerable to impersonation, their identity cannot be assured.

Issue [#1589](https://github.com/doorkeeper-gem/doorkeeper/issues/1589)

Fix [#1646](https://github.com/doorkeeper-gem/doorkeeper/pull/1646)

### Severity

Moderate

4.2

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N

### CVE ID

CVE-2023-34246

### Weaknesses

[CWE-287](/advisories?query=cwe%3A287)

### Credits

* [![@hickford](https://avatars.githubusercontent.com/u/105314?s=40&v=4)](/hickford)
  [hickford](/hickford)
  Reporter
* [![@rgammans](https://avatars.githubusercontent.com/u/512223?s=40&v=4)](/rgammans)
  [rgammans](/rgammans)
  Finder
* [![@adam-h](https://avatars.githubusercontent.com/u/604449?s=40&v=4)](/adam-h)
  [adam-h](/adam-h)
  Remediation developer
* [![@nbudin](https://avatars.githubusercontent.com/u/7477?s=40&v=4)](/nbudin)
  [nbudin](/nbudin)
  Analyst
* [![@nbulaj](https://avatars.githubusercontent.com/u/1443426?s=40&v=4)](/nbulaj)
  [nbulaj](/nbulaj)
  Analyst

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from wiki.debian.org_8d48714b_20250115_192759.html ===

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")

[Wiki](/FrontPage "Debian Wiki Homepage")

[Login](/LTS?action=login)

* [FrontPage](/FrontPage)
* [RecentChanges](/RecentChanges)
* [FindPage](/FindPage)
* [HelpContents](/HelpContents)
* [LTS](/LTS)

Search:

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")
[Wiki](/FrontPage "Debian Wiki Homepage")/

* [Login](/LTS?action=login)
* Comments
* [Info](/LTS?action=info)
* [Attachments](/LTS?action=AttachFile)
* More Actions:
  Raw Text
  Print View
  Render as Docbook
  Delete Cache
  ------------------------
  Check Spelling
  Like Pages
  Local Site Map
  ------------------------
  Rename Page
  Delete Page
  ------------------------
  Subscribe User
  ------------------------
  Remove Spam
  Revert to this revision
  Package Pages
  ------------------------
  Load
  Save
  SlideShow

# * [LTS](/LTS)

[Translation(s)](/DebianWiki/EditorGuide#translation): [English](/LTS) - [Deutsch](/de/LTS) - [Espa√±ol](/es/LTS) - [Fran√ßais](/fr/LTS) - [Italiano](/it/LTS) - [ÌïúÍµ≠Ïñ¥](/ko/LTS) - [Portugu√™s](/pt/LTS) - [Portugu√™s (Brasil)](/pt_BR/LTS) - [–†—É—Å—Å–∫–∏–π](/ru/LTS)

# Debian Long Term Support

Debian Long Term Support (LTS) is a project to extend the lifetime of all Debian stable releases to (at least) 5 years. Debian LTS is not handled by the Debian Security and Release teams, but by a separate group of volunteers and companies interested in making it a success.

Thus the Debian LTS team takes over security maintenance of the various releases once the Debian Security team stops its work.

![/!\](/htdocs/debwiki/img/alert.png "/!\")

LTS ([last modified 2024-08-15 02:46:47](/LTS?action=info))

* Debian [privacy policy](https://www.debian.org/legal/privacy), Wiki [team](/Teams/DebianWiki), [bugs](https://bugs.debian.org/wiki.debian.org) and [config](https://salsa.debian.org/debian/wiki.debian.org).
* Powered by [MoinMoin](https://moinmo.in/ "This site uses the MoinMoin Wiki software.") and [Python](https://moinmo.in/Python "MoinMoin is written in Python."), with hosting provided by [Metropolitan Area Network Darmstadt](https://www.man-da.de/).



=== Content from github.com_9315e5f2_20250114_215626.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdoorkeeper-gem%2Fdoorkeeper%2Fissues%2F1589)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdoorkeeper-gem%2Fdoorkeeper%2Fissues%2F1589)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=doorkeeper-gem%2Fdoorkeeper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[doorkeeper-gem](/doorkeeper-gem)
/
**[doorkeeper](/doorkeeper-gem/doorkeeper)**
Public

* [Notifications](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper)
* [Star
   5.4k](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper)

* [Code](/doorkeeper-gem/doorkeeper)
* [Issues
  38](/doorkeeper-gem/doorkeeper/issues)
* [Pull requests
  7](/doorkeeper-gem/doorkeeper/pulls)
* [Discussions](/doorkeeper-gem/doorkeeper/discussions)
* [Actions](/doorkeeper-gem/doorkeeper/actions)
* [Wiki](/doorkeeper-gem/doorkeeper/wiki)
* [Security](/doorkeeper-gem/doorkeeper/security)
* [Insights](/doorkeeper-gem/doorkeeper/pulse)

Additional navigation options

* [Code](/doorkeeper-gem/doorkeeper)
* [Issues](/doorkeeper-gem/doorkeeper/issues)
* [Pull requests](/doorkeeper-gem/doorkeeper/pulls)
* [Discussions](/doorkeeper-gem/doorkeeper/discussions)
* [Actions](/doorkeeper-gem/doorkeeper/actions)
* [Wiki](/doorkeeper-gem/doorkeeper/wiki)
* [Security](/doorkeeper-gem/doorkeeper/security)
* [Insights](/doorkeeper-gem/doorkeeper/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Non-confidential apps should always re-prompt for user consent #1589

Closed

[nbudin](/nbudin) opened this issue
Oct 8, 2022
¬∑ 15 comments
 ¬∑ Fixed by [#1646](https://github.com/doorkeeper-gem/doorkeeper/pull/1646)

Closed

# [Non-confidential apps should always re-prompt for user consent](#top) #1589

[nbudin](/nbudin) opened this issue
Oct 8, 2022
¬∑ 15 comments
 ¬∑ Fixed by [#1646](https://github.com/doorkeeper-gem/doorkeeper/pull/1646)

Labels
[RFC](/doorkeeper-gem/doorkeeper/labels/RFC)
[security](/doorkeeper-gem/doorkeeper/labels/security)

## Comments

[![@nbudin](https://avatars.githubusercontent.com/u/7477?s=80&u=cd43f47734d7b0199eb8c5d32d4701cf3a09879b&v=4)](/nbudin)

Copy link

### **[nbudin](/nbudin)** commented [Oct 8, 2022](#issue-1402044372) ‚Ä¢ edited Loading

| (Mentioning [@rgammans](https://github.com/rgammans), since he told me about this issue and wanted to be notified about replies.) Steps to reproduce  1. Log into the server application (in whatever way is necessary to pass its `resource_owner_authenticator` check) 2. Create a non-confidential application in Doorkeeper admin 3. Initiate authentication against it using its client ID and any OAuth2 flow 4. Click "allow" to let the access grant happen 5. Initiate authentication against it again, using a flow that only includes client\_id, such as the `authorization_code` flow with PKCE  Expected behavior According to [RFC 8252 section 8.6](https://www.rfc-editor.org/rfc/rfc8252#section-8.6), the authentication server should re-prompt for user consent, since the client's identity cannot be assured simply from the client\_id parameter. (In Doorkeeper, I think this means that it should redirect to `AuthorizationsController#new`.) Actual behavior The authentication server immediately redirects with a code parameter. System configuration You can help us to understand your problem if you will share some very useful information about your project environment (don't forget to remove any confidential data if it exists).  **Doorkeeper initializer**:  ``` # config/initializers/doorkeeper.rb class NullResourceOwner   def id     nil   end end  Doorkeeper.configure do   Devise::Doorkeeper.configure_doorkeeper(self)    # Change the ORM that doorkeeper will use (needs plugins)   orm :active_record    # This block will be called to check whether the resource owner is authenticated or not.   resource_owner_authenticator do     user_signed_in? ? current_user : NullResourceOwner.new   end    # If you didn't skip applications controller from Doorkeeper routes in your application routes.rb   # file then you need to declare this block in order to restrict access to the web interface for   # adding oauth authorized applications. In other case it will return 403 Forbidden response   # every time somebody will try to access the admin web interface.   #   admin_authenticator { authorize Doorkeeper::Application.new, :manage? }    # If you are planning to use Doorkeeper in Rails 5 API-only application, then you might   # want to use API mode that will skip all the views management and change the way how   # Doorkeeper responds to a requests.   #   # api_only    # Enforce token request content type to application/x-www-form-urlencoded.   # It is not enabled by default to not break prior versions of the gem.   #   # enforce_content_type    # Authorization Code expiration time (default 10 minutes).   #   # authorization_code_expires_in 10.minutes    # Access token expiration time (default 2 hours).   # If you want to disable expiration, set this to nil.   #   # access_token_expires_in 2.hours    # Assign custom TTL for access tokens. Will be used instead of access_token_expires_in   # option if defined. `context` has the following properties available   #   # `client` - the OAuth client application (see Doorkeeper::OAuth::Client)   # `grant_type` - the grant type of the request (see Doorkeeper::OAuth)   # `scopes` - the requested scopes (see Doorkeeper::OAuth::Scopes)   #   # custom_access_token_expires_in do |context|   #   context.client.application.additional_settings.implicit_oauth_expiration   # end    # Use a custom class for generating the access token.   # See https://github.com/doorkeeper-gem/doorkeeper#custom-access-token-generator   #   access_token_generator '::Doorkeeper::JWT'    # The controller Doorkeeper::ApplicationController inherits from.   # Defaults to ActionController::Base.   # See https://github.com/doorkeeper-gem/doorkeeper#custom-base-controller   base_controller 'ApplicationController'    # Reuse access token for the same resource owner within an application (disabled by default)   # Rationale: https://github.com/doorkeeper-gem/doorkeeper/issues/383   #   # reuse_access_token    # Issue access tokens with refresh token (disabled by default), you may also   # pass a block which accepts `context` to customize when to give a refresh   # token or not. Similar to `custom_access_token_expires_in`, `context` has   # the properties:   #   # `client` - the OAuth client application (see Doorkeeper::OAuth::Client)   # `grant_type` - the grant type of the request (see Doorkeeper::OAuth)   # `scopes` - the requested scopes (see Doorkeeper::OAuth::Scopes)   #   # use_refresh_token    # Forbids creating/updating applications with arbitrary scopes that are   # not in configuration, i.e. `default_scopes` or `optional_scopes`.   # (disabled by default)   enforce_configured_scopes    # Provide support for an owner to be assigned to each registered application (disabled by default)   # Optional parameter confirmation: true (default false) if you want to enforce ownership of   # a registered application   # Note: you must also run the rails g doorkeeper:application_owner generator to provide the necessary support   #   # enable_application_owner confirmation: false    # Define access token scopes for your provider   # For more information go to   # https://github.com/doorkeeper-gem/doorkeeper/wiki/Using-Scopes   default_scopes :public   optional_scopes :openid,                   :read_profile,                   :read_signups,                   :read_events,                   :read_conventions,                   :read_organizations,                   :read_email_routing,                   :manage_profile,                   :manage_signups,                   :manage_events,                   :manage_conventions,                   :manage_organizations,                   :manage_email_routing    # Change the way client credentials are retrieved from the request object.   # By default it retrieves first from the `HTTP_AUTHORIZATION` header, then   # falls back to the `:client_id` and `:client_secret` params from the `params` object.   # Check out https://github.com/doorkeeper-gem/doorkeeper/wiki/Changing-how-clients-are-authenticated   # for more information on customization   #   # client_credentials :from_basic, :from_params    # Change the way access token is authenticated from the request object.   # By default it retrieves first from the `HTTP_AUTHORIZATION` header, then   # falls back to the `:access_token` or `:bearer_token` params from the `params` object.   # Check out https://github.com/doorkeeper-gem/doorkeeper/wiki/Changing-how-clients-are-authenticated   # for more information on customization   #   # access_token_methods :from_bearer_authorization, :from_access_token_param, :from_bearer_param    # Change the native redirect uri for client apps   # When clients register with the following redirect uri, they won't be redirected to any server and the authorization   # code will be displayed within the provider   # The value can be any string. Use nil to disable this feature. When disabled, clients must provide a valid URL   # (Similar behaviour: https://developers.google.com/accounts/docs/OAuth2InstalledApp#choosingredirecturi)   #   # native_redirect_uri 'urn:ietf:wg:oauth:2.0:oob'    # Forces the usage of the HTTPS protocol in non-native redirect uris (enabled   # by default in non-development environments). OAuth2 delegates security in   # communication to the HTTPS protocol so it is wise to keep this enabled.   #   # Callable objects such as proc, lambda, block or any object that responds to   # #call can be used in order to allow conditional checks (to allow non-SSL   # redirects to localhost for example).   #   # force_ssl_in_redirect_uri !Rails.env.development?   #   force_ssl_in_redirect_uri { |uri| uri.host != 'localhost' }    # Specify what redirect URI's you want to block during Application creation.   # Any redirect URI is whitelisted by default.   #   # You can use this option in order to forbid URI's with 'javascript' scheme   # for example.   #   # forbid_redirect_uri { |uri| uri.scheme.to_s.downcase == 'javascript' }    # Specify what grant flows are enabled in array of Strings. The valid   # strings and the flows they enable are:   #   # "authorization_code" => Authorization Code Grant Flow   # "implicit"           => Implicit Grant Flow   # "password"           => Resource Owner Password Credentials Grant Flow   # "client_credentials" => Client Credentials Grant Flow   #   # If not specified, Doorkeeper enables authorization_code and   # client_credentials.   #   # implicit and password grant flows have risks that you should understand   # before enabling:   #   http://tools.ietf.org/html/rfc6819#section-4.4.2   #   http://tools.ietf.org/html/rfc6819#section-4.4.3   #   grant_flows %w[authorization_code client_credentials]    # Hook into the strategies' request & response life-cycle in case your   # application needs advanced customization or logging:   #   # before_successful_strategy_response do |request|   #   puts "BEFORE HOOK FIRED! #{request}"   # end   #   # after_successful_strategy_response do |request, response|   #   puts "AFTER HOOK FIRED! #{request}, #{response}"   # end    # Hook into Authorization flow in order to implement Single Sign Out   # or add ny other functionality.   #   # before_successful_authorization do |controller|   #   Rails.logger.info(params.inspect)   # end   #   # after_successful_authorization do |controller|   #   controller.session[:logout_urls] <<   #     Doorkeeper::Application   #       .find_by(controller.request.params.slice(:redirect_uri))   #       .logout_uri   # end    # Under some circumstances you might want to have applications auto-approved,   # so that the user skips the authorization step.   # For example if dealing with a trusted application.   #   # skip_authorization do |resource_owner, client|   #   client.superapp? or resource_owner.admin?   # end    # WWW-Authenticate Realm (default "Doorkeeper").   #   # realm "Doorkeeper" end  Doorkeeper::JWT.configure do   # Set the payload for the JWT token. This should contain unique information   # about the user. Defaults to a randomly generated token in a hash:   #     { token: "RANDOM-TOKEN" }   token_payload do |opts|     user = User.find(opts[:resource_owner_id])      {       iat: Time.current.utc.to_i,       exp: (Time.current + opts[:expires_in].seconds).utc.to_i,       # @see JWT reserved claims - https://tools.ietf.org/html/draft-jones-json-web-token-07#page-7       jti: SecureRandom.uuid,       user: {         id: user.id,         email: user.email,         name: user.name,         first_name: user.first_name,         last_name: user.last_name       }     }   end    # Optionally set additional headers for the JWT. See   # https://tools.ietf.org/html/rfc7515#section-4.1   token_headers { |_opts| { kid: Doorkeeper::OpenidConnect.signing_key[:kid] } }    # Use the application secret specified in the access grant token. Defaults to   # `false`. If you specify `use_application_secret true`, both `secret_key` and   # `secret_key_path` will be ignored.   use_application_secret false    # Set the encryption secret. This would be shared with any other applications   # that should be able to read the payload of the token. Defaults to "secret".   secret_key ENV.fetch('OPENID_CONNECT_SIGNING_KEY', nil)&.gsub('\n', "\n")    # Specify encryption type (https://github.com/progrium/ruby-jwt). Defaults to   # `nil`.   encryption_method :RS256 end ```  **Ruby version**: `3.1.2`  **Gemfile.lock**:  Gemfile.lock content ``` GIT   remote: https://github.com/dabit/annotate_models.git   revision: f38741d005052045e4d4c2c26b009d3ade0864f3   branch: rails-7   specs:     annotate (3.1.1)       activerecord (>= 3.2, < 7.1)       rake (>= 10.4, < 14.0)  GIT   remote: https://github.com/nbudin/cloudwatch_scheduler.git   revision: 3c4a06c3bf6596663f45d05f524ddddafc09e542   branch: ruby3_rails7_compat   specs:     cloudwatch_scheduler (1.1.1)       aws-sdk-cloudwatchevents (~> 1.13)       aws-sdk-sqs (~> 1.10)       rails (>= 5.2.0)       shoryuken (>= 2.0)  GIT   remote: https://github.com/neinteractiveliterature/civil_service.git   revision: bba59c4a91c3ca61386cfca2f723031ba097da93   branch: no-double-validate   specs:     civil_service (2.3.0)       activemodel (>= 3.0.0)  GEM   remote: https://rubygems.org/   specs:     actioncable (7.0.4)       actionpack (= 7.0.4)       activesupport (= 7.0.4)       nio4r (~> 2.0)       websocket-driver (>= 0.6.1)     actionmailbox (7.0.4)       actionpack (= 7.0.4)       activejob (= 7.0.4)       activerecord (= 7.0.4)       activestorage (= 7.0.4)       activesupport (= 7.0.4)       mail (>= 2.7.1)       net-imap       net-pop       net-smtp     actionmailer (7.0.4)       actionpack (= 7.0.4)       actionview (= 7.0.4)       activejob (= 7.0.4)       activesupport (= 7.0.4)       mail (~> 2.5, >= 2.5.4)       net-imap       net-pop       net-smtp       rails-dom-testing (~> 2.0)     actionpack (7.0.4)       actionview (= 7.0.4)       activesupport (= 7.0.4)       rack (~> 2.0, >= 2.2.0)       rack-test (>= 0.6.3)       rails-dom-testing (~> 2.0)       rails-html-sanitizer (~> 1.0, >= 1.2.0)     actiontext (7.0.4)       actionpack (= 7.0.4)       activerecord (= 7.0.4)       activestorage (= 7.0.4)       activesupport (= 7.0.4)       globalid (>= 0.6.0)       nokogiri (>= 1.8.5)     actionview (7.0.4)       activesupport (= 7.0.4)       builder (~> 3.1)       erubi (~> 1.4)       rails-dom-testing (~> 2.0)       rails-html-sanitizer (~> 1.1, >= 1.2.0)     active_storage_svg_sanitizer (0.1.0)       rails (>= 5.2)     activejob (7.0.4)       activesupport (= 7.0.4)       globalid (>= 0.3.6)     activemodel (7.0.4)       activesupport (= 7.0.4)     activerecord (7.0.4)       activemodel (= 7.0.4)       activesupport (= 7.0.4)     activerecord-session_store (2.0.0)       actionpack (>= 5.2.4.1)       activerecord (>= 5.2.4.1)       multi_json (~> 1.11, >= 1.11.2)       rack (>= 2.0.8, < 3)       railties (>= 5.2.4.1)     activestorage (7.0.4)       actionpack (= 7.0.4)       activejob (= 7.0.4)       activerecord (= 7.0.4)       activesupport (= 7.0.4)       marcel (~> 1.0)       mini_mime (>= 1.1.0)     activesupport (7.0.4)       concurrent-ruby (~> 1.0, >= 1.0.2)       i18n (>= 1.6, < 2)       minitest (>= 5.1)       tzinfo (~> 2.0)     acts_as_list (0.9.16)       activerecord (>= 3.0)     addressable (2.8.0)       public_suffix (>= 2.0.2, < 5.0)     aes_key_wrap (1.1.0)     ahoy_matey (3.2.0)       activesupport (>= 5)       device_detector       geocoder (>= 1.4.5)       safely_block (>= 0.2.1)     ansi (1.5.0)     apollo_upload_server (2.1.4)       actionpack (>= 6.1.6)       graphql (>= 1.8)     ast (2.4.2)     aws-eventstream (1.2.0)     aws-partitions (1.568.0)     aws-record (2.6.0)       aws-sdk-dynamodb (~> 1.18)     aws-sdk-cloudwatchevents (1.57.0)       aws-sdk-core (~> 3, >= 3.127.0)       aws-sigv4 (~> 1.1)     aws-sdk-cloudwatchlogs (1.45.0)       aws-sdk-core (~> 3, >= 3.120.0)       aws-sigv4 (~> 1.1)     aws-sdk-core (3.130.0)       aws-eventstream (~> 1, >= 1.0.2)       aws-partitions (~> 1, >= 1.525.0)       aws-sigv4 (~> 1.1)       jmespath (~> 1.0)     aws-sdk-dynamodb (1.60.0)       aws-sdk-core (~> 3, >= 3.112.0)       aws-sigv4 (~> 1.1)     aws-sdk-kms (1.48.0)       aws-sdk-core (~> 3, >= 3.120.0)       aws-sigv4 (~> 1.1)     aws-sdk-rails (3.6.1)       aws-record (~> 2)       aws-sdk-ses (~> 1)       aws-sdk-sqs (~> 1)       aws-sessionstore-dynamodb (~> 2)       concurrent-ruby (~> 1)       railties (>= 5.2.0)     aws-sdk-s3 (1.102.0)       aws-sdk-core (~> 3, >= 3.120.0)       aws-sdk-kms (~> 1)       aws-sigv4 (~> 1.4)     aws-sdk-ses (1.38.0)       aws-sdk-core (~> 3, >= 3.112.0)       aws-sigv4 (~> 1.1)     aws-sdk-sns (1.45.0)       aws-sdk-core (~> 3, >= 3.120.0)       aws-sigv4 (~> 1.1)     aws-sdk-sqs (1.51.0)       aws-sdk-core (~> 3, >= 3.127.0)       aws-sigv4 (~> 1.1)     aws-sessionstore-dynamodb (2.0.1)       aws-sdk-dynamodb (~> 1)       rack (~> 2)     aws-sigv4 (1.4.0)       aws-eventstream (~> 1, >= 1.0.2)     backport (1.2.0)     bcrypt (3.1.16)     bcrypt (3.1.16-java)     benchmark (0.2.0)     benchmark-ips (2.10.0)     bindata (2.4.11)     bootsnap (1.9.3)       msgpack (~> 1.0)     browser (5.3.1)     builder (3.2.4)     cadmus (0.7.1)       liquid       rails (>= 5.0.0)     cadmus_navbar (0.1.0)       acts_as_list       cadmus       rails (>= 5.0.0)     cloudwatchlogger (0.3.0)       aws-sdk-cloudwatchlogs (~> 1)       multi_json (~> 1)       uuid (~> 2)     coderay (1.1.3)     concurrent-ruby (1.1.10)     crass (1.0.6)     dalli (2.7.11)     dante (0.2.0)     dead_end (1.1.7)     debug (1.1.0)       irb       reline (>= 0.2.7)     derailed_benchmarks (2.1.1)       benchmark-ips (~> 2)       dead_end       get_process_mem (~> 0)       heapy (~> 0)       memory_profiler (>= 0, < 2)       mini_histogram (>= 0.3.0)       rack (>= 1)       rack-test       rake (> 10, < 14)       ruby-statistics (>= 2.1)       thor (>= 0.19, < 2)     device_detector (1.0.5)     devise (4.8.1)       bcrypt (~> 3.0)       orm_adapter (~> 0.1)       railties (>= 4.1.0)       responders       warden (~> 1.2.3)     devise-doorkeeper (1.2.0)       devise       doorkeeper       rails     devise-encryptable (0.2.0)       devise (>= 2.1.0)     diff-lcs (1.5.0)     digest (3.1.0)     digest (3.1.0-java)     docile (1.3.4)     domain_prefix (0.4.20210906)       json       simpleidn (>= 0.0.5)     doorkeeper (5.6.0)       railties (>= 5)     doorkeeper-jwt (0.4.0)       jwt (~> 2.1)     doorkeeper-openid_connect (1.8.2)       doorkeeper (>= 5.5, < 5.7)       json-jwt (>= 1.11.0)     dotenv (2.7.6)     dotenv-rails (2.7.6)       dotenv (= 2.7.6)       railties (>= 3.2)     e2mmap (0.1.0)     errbase (0.2.1)     erubi (1.11.0)     eu_central_bank (1.6.1)       money (~> 6.13, >= 6.13.6)       nokogiri (~> 1.9)     factory_bot (6.2.0)       activesupport (>= 5.0.0)     factory_bot_rails (6.2.0)       factory_bot (~> 6.2.0)       railties (>= 5.0.0)     faker (2.19.0)       i18n (>= 1.6, < 2)     faraday (2.5.2)       faraday-net_http (>= 2.0, < 3.1)       ruby2_keywords (>= 0.0.4)     faraday-net_http (3.0.0)     ffi (1.15.5)     ffi (1.15.5-java)     flamegraph (0.9.5)     geocoder (1.6.5)     get_process_mem (0.2.7)       ffi (~> 1.0)     globalid (1.0.0)       activesupport (>= 5.0)     graphql (2.0.14)     graphql-batch (0.5.1)       graphql (>= 1.10, < 3)       promise.rb (~> 0.7.2)     graphql-rails_logger (1.2.3)       actionpack (> 5.0)       activesupport (> 5.0)       railties (> 5.0)       rouge (~> 3.0)     haml (5.2.2)       temple (>= 0.8.0)       tilt     heapy (0.2.0)       thor     httpclient (2.8.3)     i18n (1.12.0)       concurrent-ruby (~> 1.0)     icalendar (2.7.1)       ice_cube (~> 0.16)     ice_cube (0.16.3)     image_processing (1.12.2)       mini_magick (>= 4.9.5, < 5)       ruby-vips (>= 2.0.17, < 3)     io-console (0.5.11)     io-console (0.5.11-java)     irb (1.3.7)       reline (>= 0.2.7)     jaro_winkler (1.5.4)     jaro_winkler (1.5.4-java)     jmespath (1.6.1)     json (2.6.2)     json (2.6.2-java)     json-jwt (1.15.3)       activesupport (>= 4.2)       aes_key_wrap       bindata       httpclient     jwt (2.5.0)     kramdown (2.4.0)       rexml     kramdown-parser-gfm (1.1.0)       kramdown (~> 2.0)     launchy (2.4.3)       addressable (~> 2.3)     launchy (2.4.3-java)       addressable (~> 2.3)       spoon (~> 0.0.1)     letter_opener (1.7.0)       launchy (~> 2.2)     liquid (5.1.0)     listen (3.7.0)       rb-fsevent (~> 0.10, >= 0.10.3)       rb-inotify (~> 0.9, >= 0.9.10)     lograge (0.11.2)       actionpack (>= 4)       activesupport (>= 4)       railties (>= 4)       request_store (~> 1.0)     loofah (2.19.0)       crass (~> 1.0.2)       nokogiri (>= 1.5.9)     macaddr (1.7.2)       systemu (~> 2.6.5)     mail (2.7.1)       mini_mime (>= 0.1.1)     marcel (1.0.2)     memory_profiler (1.0.0)     method_source (1.0.0)     mini_histogram (0.3.1)     mini_magick (4.11.0)     mini_mime (1.1.2)     mini_portile2 (2.8.0)     minitest (5.16.3)     minitest-focus (1.3.1)       minitest (>= 4, < 6)     minitest-reporters (1.5.0)       ansi       builder       minitest (>= 5.0)       ruby-progressbar     minitest-spec-rails (6.0.4)       minitest (>= 5.0)       railties (>= 4.1)     monetize (1.9.4)       money (~> 6.12)     money (6.13.8)       i18n (>= 0.6.4, <= 2)     money-rails (1.14.0)       activesupport (>= 3.0)       monetize (~> 1.9.0)       money (~> 6.13.2)       railties (>= 3.0)     msgpack (1.4.2)     msgpack (1.4.2-java)     multi_json (1.15.0)     mysql2 (0.5.3)     net-imap (0.2.3)       digest       net-protocol       strscan     net-pop (0.1.1)       digest       net-protocol       timeout     net-protocol (0.1.3)       timeout     net-smtp (0.3.1)       digest       net-protocol       timeout     nio4r (2.5.8)     nio4r (2.5.8-java)     nokogiri (1.13.8)       mini_portile2 (~> 2.8.0)       racc (~> 1.4)     nokogiri (1.13.8-java)       racc (~> 1.4)     oj (3.13.4)     orm_adapter (0.5.0)     ox (2.14.4)     parallel (1.22.1)     parser (3.1.2.1)       ast (~> 2.4.1)     pg (1.2.3)     pg_search (2.3.5)       activerecord (>= 5.2)       activesupport (>= 5.2)     phonelib (0.6.53)     prettier (3.2.2)       syntax_tree (>= 2.7.1)       syntax_tree-haml (>= 1.1.0)       syntax_tree-rbs (>= 0.2.0)     prettier_print (0.1.0)     promise.rb (0.7.4)     pry (0.14.1)       coderay (~> 1.1)       method_source (~> 1.0)     pry (0.14.1-java)       coderay (~> 1.1)       method_source (~> 1.0)       spoon (~> 0.0)     pry-rails (0.3.9)       pry (>= 0.10.4)     pry-remote (0.1.8)       pry (~> 0.9)       slop (~> 3.0)     public_suffix (4.0.6)     puma (5.6.4)       nio4r (~> 2.0)     puma (5.6.4-java)       nio4r (~> 2.0)     pundit (2.1.1)       activesupport (>= 3.0.0)     racc (1.6.0)     racc (1.6.0-java)     rack (2.2.4)     rack-mini-profiler (2.3.3)       rack (>= 1.2.0)     rack-test (2.0.2)       rack (>= 1.3)     rails (7.0.4)       actioncable (= 7.0.4)       actionmailbox (= 7.0.4)       actionmailer (= 7.0.4)       actionpack (= 7.0.4)       actiontext (= 7.0.4)       actionview (= 7.0.4)       activejob (= 7.0.4)       activemodel (= 7.0.4)       activerecord (= 7.0.4)       activestorage (= 7.0.4)       activesupport (= 7.0.4)       bundler (>= 1.15.0)       railties (= 7.0.4)     rails-controller-testing (1.0.5)       actionpack (>= 5.0.1.rc1)       actionview (>= 5.0.1.rc1)       activesupport (>= 5.0.1.rc1)     rails-dom-testing (2.0.3)       activesupport (>= 4.2.0)       nokogiri (>= 1.6)     rails-html-sanitizer (1.4.3)       loofah (~> 2.3)     railties (7.0.4)       actionpack (= 7.0.4)       activesupport (= 7.0.4)       method_source       rake (>= 12.2)       thor (~> 1.0)       zeitwerk (~> 2.5)     rainbow (3.1.1)     rake (13.0.6)     rb-fsevent (0.11.0)     rb-inotify (0.10.1)       ffi (~> 1.0)     rbs (2.0.0)     rbtree (0.4.4)     recaptcha (5.8.1)       json     redcarpet (3.5.1)     regexp_parser (2.5.0)     reline (0.2.7)       io-console (~> 0.5)     request_store (1.5.1)       rack (>= 1.4)     responders (3.0.1)       actionpack (>= 5.0)       railties (>= 5.0)     reverse_markdown (2.1.1)       nokogiri     rexml (3.2.5)     rollbar (3.2.0)     rollbar-shoryuken (1.1.0)       aws-sdk-sqs (~> 1.20, <= 2.0)       ox (~> 2.14)       rollbar (>= 2.21, <= 4.0, < 4.0)       shoryuken (>= 4.0, <= 5.3)     rouge (3.26.0)     rubocop (1.36.0)       json (~> 2.3)       parallel (~> 1.10)       parser (>= 3.1.2.1)       rainbow (>= 2.2.2, < 4.0)       regexp_parser (>= 1.8, < 3.0)       rexml (>= 3.2.5, < 4.0)       rubocop-ast (>= 1.20.1, < 2.0)       ruby-progressbar (~> 1.7)       unicode-display_width (>= 1.4.0, < 3.0)     rubocop-ast (1.21.0)       parser (>= 3.1.1.0)     rubocop-performance (1.11.5)       rubocop (>= 1.7.0, < 2.0)       rubocop-ast (>= 0.4.0)     rubocop-rails (2.11.3)       activesupport (>= 4.2.0)       rack (>= 1.1)       rubocop (>= 1.7.0, < 2.0)     rubocop-sequel (0.3.3)       rubocop (~> 1.0)     ruby-progressbar (1.11.0)     ruby-statistics (3.0.0)     ruby-vips (2.1.4)       ffi (~> 1.12)     ruby2_keywords (0.0.5)     safely_block (0.3.0)       errbase (>= 0.1.1)     scheduled_value (1.4.0)       sorted_set (~> 1.0)     sequel (5.48.0)     set (1.0.2)     shoryuken (5.3.0)       aws-sdk-core (>= 2)       concurrent-ruby       thor     simplecov (0.21.2)       docile (~> 1.1)       simplecov-html (~> 0.11)       simplecov_json_formatter (~> 0.1)     simplecov-html (0.12.3)     simplecov_json_formatter (0.1.2)     simpleidn (0.2.1)       unf (~> 0.1.4)     skylight (5.3.2)       activesupport (>= 5.2.0)     slop (3.6.0)     solargraph (0.46.0)       backport (~> 1.2)       benchmark       bundler (>= 1.17.2)       diff-lcs (~> 1.4)       e2mmap       jaro_winkler (~> 1.5)       kramdown (~> 2.3)       kramdown-parser-gfm (~> 1.1)       parser (~> 3.0)       reverse_markdown (>= 1.0.5, < 3)       rubocop (>= 0.52)       thor (~> 1.0)       tilt (~> 2.0)       yard (~> 0.9, >= 0.9.24)     solargraph-rails (0.3.1)       activesupport       solargraph (>= 0.41.1)     sorted_set (1.0.3)       rbtree       set (~> 1.0)     sorted_set (1.0.3-java)     spoon (0.0.6)       ffi     sprockets (4.0.2)       concurrent-ruby (~> 1.0)       rack (> 1, < 3)     sprockets-rails (3.4.2)       actionpack (>= 5.2)       activesupport (>= 5.2)       sprockets (>= 3.0.0)     stackprof (0.2.17)     stripe (5.38.0)     stripe-ruby-mock (3.1.0.rc3)       dante (>= 0.2.0)       multi_json (~> 1.0)       stripe (> 5, < 6)     strscan (3.0.4)     strscan (3.0.4-java)     syntax_tree (3.3.0)       prettier_print     syntax_tree-haml (1.3.1)       haml (>= 5.2)       prettier_print       syntax_tree (>= 2.0.1)     syntax_tree-rbs (0.5.0)       prettier_print       rbs       syntax_tree (>= 2.0.1)     systemu (2.6.5)     temple (0.8.2)     term-ansicolor (1.7.1)       tins (~> 1.0)     thor (1.2.1)     tilt (2.0.11)     timeout (0.3.0)     tins (1.20.2)     twilio-ruby (5.72.0)       faraday (>= 0.9, < 3.0)       jwt (>= 1.5, <= 2.5)       nokogiri (>= 1.6, < 2.0)     typeprof (0.21.2)       rbs (>= 1.8.1)     tzinfo (2.0.5)       concurrent-ruby (~> 1.0)     tzinfo-data (1.2021.1)       tzinfo (>= 1.0.0)     unf (0.1.4)       unf_ext     unf (0.1.4-java)     unf_ext (0.0.8)     unicode-display_width (2.3.0)     uuid (2.3.9)       macaddr (~> 1.0)     warden (1.2.9)       rack (>= 2.0.9)     webrick (1.7.0)     websocket-driver (0.7.5)       websocket-extensions (>= 0.1.0)     websocket-driver (0.7.5-java)       websocket-extensions (>= 0.1.0)     websocket-extensions (0.1.5)     will_paginate (3.3.1)     with_advisory_lock (4.6.0)       activerecord (>= 4.2)     yard (0.9.28)       webrick (~> 1.7.0)     zeitwerk (2.6.0)  PLATFORMS   java   ruby  DEPENDENCIES   active_storage_svg_sanitizer   activerecord-session_store   ahoy_matey   annotate!   apollo_upload_server (= 2.1.4)   aws-sdk-rails   aws-sdk-s3   aws-sdk-sns   aws-sdk-sqs   bootsnap (>= 1.1.0)   browser   cadmus (~> 0.7.1)   cadmus_navbar (~> 0.1.0)   civil_service!   cloudwatch_scheduler!   cloudwatchlogger   dalli   dead_end   debug   derailed_benchmarks   devise   devise-doorkeeper   devise-encryptable   domain_prefix   doorkeeper (= 5.6.0)   doorkeeper-jwt   doorkeeper-openid_connect   dotenv-rails   eu_central_bank   factory_bot   factory_bot_rails   faker   flamegraph   graphql (>= 2.0)   graphql-batch   graphql-rails_logger   icalendar   image_processing (~> 1.2)   letter_opener   liquid   listen   lograge   memory_profiler   minitest-focus   minitest-reporters   minitest-spec-rails   money-rails   mysql2 (~> 0.5.3)   oj (~> 3.13.4)   parallel   pg   pg_search   phonelib   prettier (= 3.2.2)   prettier_print   pry-rails   pry-remote   puma   pundit   rack-mini-profiler   rails (= 7.0.4)   rails-controller-testing   recaptcha   redcarpet   reverse_markdown   rollbar   rollbar-shoryuken   rubocop (= 1.36.0)   rubocop-performance   rubocop-rails   rubocop-sequel   ruby-vips   scheduled_value (~> 1.4.0)   sequel   shoryuken   simplecov   skylight   solargraph   solargraph-rails (= 0.3.1)   sprockets-rails   stackprof   stripe   stripe-ruby-mock (>= 3.1.0.rc3)   syntax_tree   syntax_tree-haml   syntax_tree-rbs   term-ansicolor   twilio-ruby (~> 5.72.0)   typeprof   tzinfo-data   webrick   will_paginate   with_advisory_lock   yard  RUBY VERSION    ruby 3.1.2p20  BUNDLED WITH    2.3.4  ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
1
 hickford reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![@stale](https://avatars.githubusercontent.com/in/1724?s=80&v=4)](/apps/stale)

Copy link

### **[stale](/apps/stale) bot** commented [Jan 8, 2023](#issuecomment-1374747927)

| This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions. |
| --- |

All reactions

Sorry, something went wrong.

[![@stale](https://avatars.githubusercontent.com/in/1724?s=40&v=4)](/apps/stale)
[stale](/apps/stale)
bot
added
the
[wontfix](/doorkeeper-gem/doorkeeper/labels/wontfix)
label
[Jan 8, 2023](#event-8176092598)

[![@rgammans](https://avatars.githubusercontent.com/u/512223?s=80&v=4)](/rgammans)

Copy link

### **[rgammans](/rgammans)** commented [Jan 9, 2023](#issuecomment-1376381307)

| I'm was expected a core dev to chime about the potentially security related RFC deviation? |
| --- |

All reactions

Sorry, something went wrong.

[![@stale](https://avatars.githubusercontent.com/in/1724?s=40&v=4)](/apps/stale)
[stale](/apps/stale)
bot
removed
the
[wontfix](/doorkeeper-gem/doorkeeper/labels/wontfix)
label
[Jan 9, 2023](#event-8186240449)

[![@nbulaj](https://avatars.githubusercontent.com/u/1443426?s=80&u=38021cb0fce11181786ae9daed5c68fbc1e275cf&v=4)](/nbulaj)

Copy link

Member

### **[nbulaj](/nbulaj)** commented [Jan 10, 2023](#issuecomment-1377414165)

| Hi [@nbudin](https://github.com/nbudin) and [@rgammans](https://github.com/rgammans) . I haven't checked RC yet, but from your description it sounds correct and requires a fix. Will check deeper a little bit later. Any PRs are welcome in case you wanna to fix the issue üôá |
| --- |

All reactions

Sorry, something went wrong.

[![@nbulaj](https://avatars.githubusercontent.com/u/1443426?s=40&u=38021cb0fce11181786ae9daed5c68fbc1e275cf&v=4)](/nbulaj)
[nbulaj](/nbulaj)
added
[RFC](/doorkeeper-gem/doorkeeper/labels/RFC)
[security](/doorkeeper-gem/doorkeeper/labels/security)
labels
[Jan 10, 2023](#event-8192927333)

[adam-h](/adam-h)
added a commit
to polleverywhere/doorkeeper
that referenced
this issue
[Mar 17, 2023](#ref-commit-f202079)
[![@adam-h](https://avatars.githubusercontent.com/u/604449?s=40&u=f2fccf5605d43ff5a998712f17e688b17bfbbc92&v=4)](/adam-h)

`[Block public clients automatic authorization skip](/polleverywhere/doorkeeper/commit/f202079baac4c978a01ccc9a45d78fde368ac907 "Block public clients automatic authorization skip

Non-confidential applications should not be able to skip the authorization stop, even if they have an existing matching_token.

From the [issue](https://github.com/doorkeeper-gem/doorkeeper/issues/1589):
> According to RFC 8252 section 8.6, the authentication server should re-prompt for user consent, since the client's identity cannot be assured simply from the client_id parameter

Fixes https://github.com/doorkeeper-gem/doorkeeper/issues/1589")`
‚Ä¶

`[f202079](/polleverywhere/doorkeeper/commit/f202079baac4c978a01ccc9a45d78fde368ac907)`

```
Non-confidential applications should not be able to skip the authorization stop, even if they have an existing matching_token.

From the [issue]([doorkeeper-gem#1589](https://github.com/doorkeeper-gem/doorkeeper/issues/1589)):
> According to RFC 8252 section 8.6, the authentication server should re-prompt for user consent, since the client's identity cannot be assured simply from the client_id parameter

Fixes [doorkeeper-gem#1589](https://github.com/doorkeeper-gem/doorkeeper/issues/1589)
```

[![@adam-h](https://avatars.githubusercontent.com/u/604449?s=40&u=f2fccf5605d43ff5a998712f17e688b17bfbbc92&v=4)](/adam-h)
[adam-h](/adam-h)
mentioned this issue
[Mar 17, 2023](#ref-pullrequest-1628921437)

[Block public clients automatic authorization skip
#1646](/doorkeeper-gem/doorkeeper/pull/1646)
 Merged

[![@nbulaj](https://avatars.githubusercontent.com/u/1443426?s=40&u=38021cb0fce11181786ae9daed5c68fbc1e275cf&v=4)](/nbulaj)
[nbulaj](/nbulaj)
closed this as [completed](/doorkeeper-gem/doorkeeper/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#1646](/doorkeeper-gem/doorkeeper/pull/1646)
[Mar 20, 2023](#event-8794476509)

[![@hickford](https://avatars.githubusercontent.com/u/105314?s=80&u=67850e32006897f171cec7e03a3e93445bf86dd9&v=4)](/hickford)

Copy link

Contributor

### **[hickford](/hickford)** commented [Apr 15, 2023](#issuecomment-1509675897) ‚Ä¢ edited Loading

| Fixed in <https://github.com/doorkeeper-gem/doorkeeper/releases/tag/v5.6.6>  [@nbulaj](https://github.com/nbulaj) is there a CVE for this issue? It seems an example of "CWE-287: Improper Authentication" <https://cwe.mitre.org/data/definitions/287.html>  When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.  In this case, the actor is an OAuth client claiming the identity of some other public OAuth client |
| --- |

All reactions

Sorry, something went wrong.

[![@nbulaj](https://avatars.githubusercontent.com/u/1443426?s=80&u=38021cb0fce11181786ae9daed5c68fbc1e275cf&v=4)](/nbulaj)

Copy link

Member

### **[nbulaj](/nbulaj)** commented [Apr 18, 2023](#issuecomment-1512639879)

| No we don't have it [@hickford](https://github.com/hickford) |
| --- |

All reactions

Sorry, something went wrong.

[![@hickford](https://avatars.githubusercontent.com/u/105314?s=80&u=67850e32006897f171cec7e03a3e93445bf86dd9&v=4)](/hickford)

Copy link

Contributor

### **[hickford](/hickford)** commented [Apr 23, 2023](#issuecomment-1518980508)

| [@nbulaj](https://github.com/nbulaj) what do you think about opening a CVE? |
| --- |

All reactions

Sorry, something went wrong.

[![@nbulaj](https://avatars.githubusercontent.com/u/1443426?s=80&u=38021cb0fce11181786ae9daed5c68fbc1e275cf&v=4)](/nbulaj)

Copy link

Member

### **[nbulaj](/nbulaj)** commented [May 12, 2023](#issuecomment-1545195251)

| [@hickford](https://github.com/hickford) could you please do it? Never did it before, not sure where and what to do |
| --- |

All reactions

Sorry, something went wrong.

[![@hickford](https://avatars.githubusercontent.com/u/105314?s=80&u=67850e32006897f171cec7e03a3e93445bf86dd9&v=4)](/hickford)

Copy link

Contributor

### **[hickford](/hickford)** commented [May 12, 2023](#issuecomment-1546164672) ‚Ä¢ edited Loading

| [@nbulaj](https://github.com/nbulaj) I'm not sure either. Admins should be able to record security vulnerabilities at <https://github.com/doorkeeper-gem/doorkeeper/security>  Anyone with admin permissions to a repository can create a security advisory.  It looks like [@stefansundin](https://github.com/stefansundin) has done it before. Stefan, can you help?  Previous vulnerabilities <https://osv.dev/list?ecosystem=RubyGems&q=doorkeeper> |
| --- |

All reactions

Sorry, something went wrong.

[![@stefansundin](https://avatars.githubusercontent.com/u/1991151?s=80&v=4)](/stefansundin)

Copy link

Contributor

### **[stefansundin](/stefansundin)** commented [May 12, 2023](#issuecomment-1546215944)

| Uhh. I think [@nbulaj](https://github.com/nbulaj) did in fact create the one I helped with. [This documentation page](https://docs.github.com/en/code-security/security-advisories/repository-security-advisories/publishing-a-repository-security-advisory) says admin permissions are required, so I couldn't possibly have done it.  Probably someone with admin permissions just have to go to <https://github.com/doorkeeper-gem/doorkeeper/security> and there's probably a green button to create a new one. ü§∑  What I did do was create a proper CVE identifier. However it was a total pain so I don't recommend getting one. I submitted the form that they had but no one got back to me. A few days I got tired of waiting and I emailed someone and they replied back with a super short message ("Use [CVE-2020-10187](https://github.com/advisories/GHSA-j7vx-8mqj-cqp9 "CVE-2020-10187").").. so not the best experience lol. Just create a GitHub advisory and be satisfied with that. :) |
| --- |

All reactions

Sorry, something went wrong.

[![@hickford](https://avatars.githubusercontent.com/u/105314?s=80&u=67850e32006897f171cec7e03a3e93445bf86dd9&v=4)](/hickford)

Copy link

Contributor

### **[hickford](/hickford)** commented [May 12, 2023](#issuecomment-1546332277)

| [@stefansundin](https://github.com/stefansundin) thanks for your reply. According to <https://github.blog/2022-04-22-removing-the-stigma-of-a-cve/> these days it's easier to assign a CVE to a GHSA. |
| --- |

 üëç
1
 stefansundin reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@hickford](https://avatars.githubusercontent.com/u/105314?s=80&u=67850e32006897f171cec7e03a3e93445bf86dd9&v=4)](/hickford)

Copy link

Contributor

### **[hickford](/hickford)** commented [May 22, 2023](#issuecomment-1556677931) ‚Ä¢ edited Loading

| Admin can open a GHSA at <https://github.com/doorkeeper-gem/doorkeeper/security/advisories/new>  [image](https://private-user-images.githubusercontent.com/105314/239833012-693aef91-feea-419b-aa31-cdf4bd6a2ba2.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTIwODMsIm5iZiI6MTczNjg5MTc4MywicGF0aCI6Ii8xMDUzMTQvMjM5ODMzMDEyLTY5M2FlZjkxLWZlZWEtNDE5Yi1hYTMxLWNkZjRiZDZhMmJhMi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMTU2MjNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1iNTVhMzEwNzM5YzRlMjg3YWM5NDVjY2RkY2E1MzczZjM4NjczN2ZhN2M0N2EyOWY4ZTZhNjk0OTYyZDcxNzhlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.YwZgBxeltlx0pADnMQvpcFJCk0tXya6zA3lLBUa3AZY) |
| --- |

All reactions

Sorry, something went wrong.

[![@hickford](https://avatars.githubusercontent.com/u/105314?s=80&u=67850e32006897f171cec7e03a3e93445bf86dd9&v=4)](/hickford)

Copy link

Contributor

### **[hickford](/hickford)** commented [Jun 7, 2023](#issuecomment-1580617515)

| [@nbudin](https://github.com/nbudin) right now only admin can draft a GHSA at <https://github.com/doorkeeper-gem/doorkeeper/security/advisories/new> but if you enable "Private vulnerability reporting" at <https://github.com/doorkeeper-gem/doorkeeper/security> then non-admins should be able to draft a GHSA for admins to review |
| --- |

All reactions

Sorry, something went wrong.

[![@nbulaj](https://avatars.githubusercontent.com/u/1443426?s=80&u=38021cb0fce11181786ae9daed5c68fbc1e275cf&v=4)](/nbulaj)

Copy link

Member

### **[nbulaj](/nbulaj)** commented [Jun 8, 2023](#issuecomment-1582319836)

| Enabled [@hickford](https://github.com/hickford) , thanks üôá |
| --- |

All reactions

Sorry, something went wrong.

[![@hickford](https://avatars.githubusercontent.com/u/105314?s=80&u=67850e32006897f171cec7e03a3e93445bf86dd9&v=4)](/hickford)

Copy link

Contributor

### **[hickford](/hickford)** commented [Jun 8, 2023](#issuecomment-1583345713)

| [@nbulaj](https://github.com/nbulaj) thanks. Ready to publish at [GHSA-7w2c-w47h-789w](https://github.com/doorkeeper-gem/doorkeeper/security/advisories/GHSA-7w2c-w47h-789w "GHSA-7w2c-w47h-789w")  Maintainers and owners are able to request a CVE. Once requested, GitHub will review this advisory in order to assign a CVE |
| --- |

All reactions

Sorry, something went wrong.

[![@hickford](https://avatars.githubusercontent.com/u/105314?s=80&u=67850e32006897f171cec7e03a3e93445bf86dd9&v=4)](/hickford)

Copy link

Contributor

### **[hickford](/hickford)** commented [Jul 11, 2023](#issuecomment-1630982917)

| Published   * [GHSA-7w2c-w47h-789w](https://github.com/doorkeeper-gem/doorkeeper/security/advisories/GHSA-7w2c-w47h-789w "GHSA-7w2c-w47h-789w") * <https://www.cve.org/CVERecord?id=CVE-2023-34246> |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fdoorkeeper-gem%2Fdoorkeeper%2Fissues%2F1589)

Assignees

No one assigned

Labels

[RFC](/doorkeeper-gem/doorkeeper/labels/RFC)
[security](/doorkeeper-gem/doorkeeper/labels/security)

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Block public clients automatic authorization skip](/doorkeeper-gem/doorkeeper/pull/1646)
 [polleverywhere/doorkeeper](/polleverywhere/doorkeeper)

5 participants

[![@nbudin](https://avatars.githubusercontent.com/u/7477?s=52&v=4)](/nbudin) [![@hickford](https://avatars.githubusercontent.com/u/105314?s=52&v=4)](/hickford) [![@rgammans](https://avatars.githubusercontent.com/u/512223?s=52&v=4)](/rgammans) [![@nbulaj](https://avatars.githubusercontent.com/u/1443426?s=52&v=4)](/nbulaj) [![@stefansundin](https://avatars.githubusercontent.com/u/1991151?s=52&v=4)](/stefansundin)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from avatars.githubusercontent.com_68c59206_20250115_192802.html ===
ÔøΩÔøΩÔøΩÔøΩ ÔøΩ  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222ÔøΩÔøΩ  ( (" ÔøΩÔøΩÔøΩ          
   } !1AQa"q2ÔøΩÔøΩÔøΩ#BÔøΩÔøΩRÔøΩÔøΩ$3brÔøΩ
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ       
  w !1AQaq"2ÔøΩBÔøΩÔøΩÔøΩÔøΩ #3RÔøΩbrÔøΩ
$4ÔøΩ%ÔøΩ&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ   ? Àí0ÔøΩ PÔøΩsÔøΩÔøΩAsv"ÔøΩcXÔøΩÔøΩsÔøΩÔøΩÔøΩ ◊§ÔøΩ‘†1ÔøΩQpÔøΩÔøΩÔøΩÔøΩÔøΩlJÔøΩ:ÔøΩ\*ÔøΩOS—ù|4\_ÔøΩÔøΩÔøΩ\_nqÔøΩ}\*3ÔøΩ}ÔøΩ
ÔøΩkvW
+ÔøΩ6rJÔøΩÔøΩw4ÔøΩÔøΩÔøΩJÔøΩÔøΩ“º+ÔøΩTÔøΩ${}8ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ8xs^ÔøΩÔøΩ<ÔøΩÔøΩ.\*ÔøΩÔøΩ›ºÔøΩÔøΩÔøΩfWÔøΩTÔøΩ[ÔøΩÔøΩÔøΩ1ÔøΩÔøΩÔøΩÔøΩ0{ÔøΩv"ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩInu}KÔøΩÔøΩ 4+G
ÔøΩÀ∂HmƒìÔøΩxÔøΩ ÔøΩÔøΩÔøΩ(ÔøΩ8]ÔøΩÔøΩ#iÔøΩyÔøΩ\_“π&ÔøΩÔøΩyÔøΩ,ÔøΩÔøΩI?ÔøΩJÔøΩkÔøΩ(rÔøΩqÔøΩSÔøΩcÔøΩzÔøΩÔøΩ5ÔøΩSÔøΩQÔøΩ÷±ÔøΩÔøΩbmvÔøΩÔøΩ6ÊªùeÔøΩ)ÔøΩqÔøΩÔøΩÔøΩÔøΩ=g5ÔøΩ{ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ"9\*ÔøΩ9ÔøΩÔøΩÔøΩÔøΩrÔøΩÔøΩ>ÔøΩÔøΩdK{ÔøΩÔøΩÔøΩÔøΩÃë(T8ÔøΩÔøΩÔøΩÔøΩÔøΩ\_?ÔøΩÔøΩ7ÔøΩ/ÔøΩ«íÔøΩÔøΩSÔøΩÔøΩÔøΩÔøΩZÔøΩÔøΩbÔøΩDÔøΩÔøΩ;ÔøΩX(ÔøΩjuÔøΩÔøΩ4tÔøΩ+ÔøΩÔøΩÔøΩÔøΩWh ÔøΩÔøΩÔøΩ:ÔøΩÔøΩtÔøΩ9ÔøΩaÔøΩ bÔøΩÔøΩÔøΩÔøΩÔøΩNoÔøΩ,ÔøΩÔøΩrx1ÔøΩ\*1ÔøΩrÔøΩ<ÔøΩ⁄ìÔøΩ&ÔøΩÔøΩ ?ÔøΩÔøΩÔøΩÔøΩ¬©ÔøΩÔøΩÔøΩ}ÔøΩÔøΩyaÔøΩÔøΩsÔøΩ“É8fÔøΩrOÔøΩpÔøΩ ÔøΩ3ÔøΩ ÔøΩÔøΩk}ÔøΩAÔøΩÔøΩ"ÔøΩÔøΩOÔøΩÔøΩO!ÔøΩ;ÔøΩÔøΩÔøΩ‚§áÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ZÔøΩÔøΩRu`qÔøΩÔøΩÔøΩ)ÔøΩÔøΩnÔøΩ“™ÔøΩ0ÔøΩÔøΩÔøΩ

=== Content from github.com_2f29da25_20250114_215630.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdoorkeeper-gem%2Fdoorkeeper%2Freleases%2Ftag%2Fv5.6.6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdoorkeeper-gem%2Fdoorkeeper%2Freleases%2Ftag%2Fv5.6.6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=doorkeeper-gem%2Fdoorkeeper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[doorkeeper-gem](/doorkeeper-gem)
/
**[doorkeeper](/doorkeeper-gem/doorkeeper)**
Public

* [Notifications](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper)
* [Star
   5.4k](/login?return_to=%2Fdoorkeeper-gem%2Fdoorkeeper)

* [Code](/doorkeeper-gem/doorkeeper/tree/v5.6.6)
* [Issues
  38](/doorkeeper-gem/doorkeeper/issues)
* [Pull requests
  7](/doorkeeper-gem/doorkeeper/pulls)
* [Discussions](/doorkeeper-gem/doorkeeper/discussions)
* [Actions](/doorkeeper-gem/doorkeeper/actions)
* [Wiki](/doorkeeper-gem/doorkeeper/wiki)
* [Security](/doorkeeper-gem/doorkeeper/security)
* [Insights](/doorkeeper-gem/doorkeeper/pulse)

Additional navigation options

* [Code](/doorkeeper-gem/doorkeeper/tree/v5.6.6)
* [Issues](/doorkeeper-gem/doorkeeper/issues)
* [Pull requests](/doorkeeper-gem/doorkeeper/pulls)
* [Discussions](/doorkeeper-gem/doorkeeper/discussions)
* [Actions](/doorkeeper-gem/doorkeeper/actions)
* [Wiki](/doorkeeper-gem/doorkeeper/wiki)
* [Security](/doorkeeper-gem/doorkeeper/security)
* [Insights](/doorkeeper-gem/doorkeeper/pulse)

1. [Releases](/doorkeeper-gem/doorkeeper/releases)
2. [v5.6.6](/doorkeeper-gem/doorkeeper/releases/tag/v5.6.6)

# v5.6.6

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/doorkeeper-gem/doorkeeper/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.6.6)

 Loading

[View all tags](/doorkeeper-gem/doorkeeper/tags)

![@nbulaj](https://avatars.githubusercontent.com/u/1443426?s=40&v=4)
[nbulaj](/nbulaj)
released this
29 Mar 07:20

¬∑
[141 commits](/doorkeeper-gem/doorkeeper/compare/v5.6.6...main)
to main
since this release

[v5.6.6](/doorkeeper-gem/doorkeeper/tree/v5.6.6)

[`986115c`](/doorkeeper-gem/doorkeeper/commit/986115cc228ff30dc1ead0f4101195448994f5d4)

This commit was signed with the committer‚Äôs **verified signature**.

[![](https://avatars.githubusercontent.com/u/1443426?s=64&v=4)](/nbulaj)
[nbulaj](/nbulaj)
Nikita Bulai

GPG key ID: 0FA6B29441C25112

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

* [[#1644](https://github.com/doorkeeper-gem/doorkeeper/pull/1644)] Update HTTP headers.
* [[#1646](https://github.com/doorkeeper-gem/doorkeeper/pull/1646)] Block public clients automatic authorization skip.
* [[#1648](https://github.com/doorkeeper-gem/doorkeeper/pull/1648)] Add custom token attributes to Refresh Token Request.
* [[#1649](https://github.com/doorkeeper-gem/doorkeeper/pull/1649)] Fixed custom\_access\_token\_attributes related errors.

 Assets
2

 Loading

 üéâ
3
 boimw, aalvarado, and shimbaco reacted with hooray emoji

All reactions

* üéâ
  3 reactions

 3 people reacted

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from www.rfc-editor.org_18739956_20250114_215638.html ===

[[RFC Home](https://www.rfc-editor.org "RFC Editor")] [[TEXT](/rfc/rfc8252.txt)|[PDF](/rfc/pdfrfc/rfc8252.txt.pdf)|[HTML](/rfc/rfc8252.html)] [[Tracker](https://datatracker.ietf.org/doc/rfc8252 "IETF Datatracker information for this document")] [[IPR](https://datatracker.ietf.org/ipr/search/?rfc=8252&submit=rfc "IPR disclosures related to this document")] [[Errata](/errata/rfc8252)] [[Info page](https://www.rfc-editor.org/info/rfc8252 "Info page")]

 BEST CURRENT PRACTICE
 Errata Exist
```
Internet Engineering Task Force (IETF)                        W. Denniss
Request for Comments: 8252                                        Google
BCP: 212                                                      J. Bradley
Updates: [6749](./rfc6749)                                              Ping Identity
Category: Best Current Practice                             October 2017
ISSN: 2070-1721

                       OAuth 2.0 for Native Apps

Abstract

   OAuth 2.0 authorization requests from native apps should only be made
   through external user-agents, primarily the user's browser.  This
   specification details the security and usability reasons why this is
   the case and how native apps and authorization servers can implement
   this best practice.

Status of This Memo

   This memo documents an Internet Best Current Practice.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   BCPs is available in [Section¬†2 of RFC 7841](./rfc7841#section-2).

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <https://www.rfc-editor.org/info/rfc8252>.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to [BCP 78](https://www.rfc-editor.org/bcp/bcp78) and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<https://trustee.ietf.org/license-info>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Denniss & Bradley         Best Current Practice                 [Page 1]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

Table of Contents

   [1](#section-1).  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   [3](#page-3)
   [2](#section-2).  Notational Conventions  . . . . . . . . . . . . . . . . . . .   [3](#page-3)
   [3](#section-3).  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   [3](#page-3)
   [4](#section-4).  Overview  . . . . . . . . . . . . . . . . . . . . . . . . . .   [4](#page-4)
     [4.1](#section-4.1).  Authorization Flow for Native Apps Using the Browser  . .   [5](#page-5)
   [5](#section-5).  Using Inter-App URI Communication for OAuth . . . . . . . . .   [6](#page-6)
   [6](#section-6).  Initiating the Authorization Request from a Native App  . . .   [6](#page-6)
   [7](#section-7).  Receiving the Authorization Response in a Native App  . . . .   [7](#page-7)
     [7.1](#section-7.1).  Private-Use URI Scheme Redirection  . . . . . . . . . . .   [8](#page-8)
     [7.2](#section-7.2).  Claimed "https" Scheme URI Redirection  . . . . . . . . .   [9](#page-9)
     [7.3](#section-7.3).  Loopback Interface Redirection  . . . . . . . . . . . . .   [9](#page-9)
   [8](#section-8).  Security Considerations . . . . . . . . . . . . . . . . . . .  [10](#page-10)
     [8.1](#section-8.1).  Protecting the Authorization Code . . . . . . . . . . . .  [10](#page-10)
     [8.2](#section-8.2).  OAuth Implicit Grant Authorization Flow . . . . . . . . .  [11](#page-11)
     [8.3](#section-8.3).  Loopback Redirect Considerations  . . . . . . . . . . . .  [11](#page-11)
     [8.4](#section-8.4).  Registration of Native App Clients  . . . . . . . . . . .  [12](#page-12)
     [8.5](#section-8.5).  Client Authentication . . . . . . . . . . . . . . . . . .  [12](#page-12)
     [8.6](#section-8.6).  Client Impersonation  . . . . . . . . . . . . . . . . . .  [13](#page-13)
     [8.7](#section-8.7).  Fake External User-Agents . . . . . . . . . . . . . . . .  [13](#page-13)
     [8.8](#section-8.8).  Malicious External User-Agents  . . . . . . . . . . . . .  [14](#page-14)
     [8.9](#section-8.9).  Cross-App Request Forgery Protections . . . . . . . . . .  [14](#page-14)
     [8.10](#section-8.10). Authorization Server Mix-Up Mitigation  . . . . . . . . .  [14](#page-14)
     [8.11](#section-8.11). Non-Browser External User-Agents  . . . . . . . . . . . .  [15](#page-15)
     [8.12](#section-8.12). Embedded User-Agents  . . . . . . . . . . . . . . . . . .  [15](#page-15)
   [9](#section-9).  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  [16](#page-16)
   [10](#section-10). References  . . . . . . . . . . . . . . . . . . . . . . . . .  [16](#page-16)
     [10.1](#section-10.1).  Normative References . . . . . . . . . . . . . . . . . .  [16](#page-16)
     [10.2](#section-10.2).  Informative References . . . . . . . . . . . . . . . . .  [17](#page-17)
   [Appendix A](#appendix-A).  Server Support Checklist . . . . . . . . . . . . . .  [18](#page-18)
   [Appendix B](#appendix-B).  Platform-Specific Implementation Details . . . . . .  [18](#page-18)
     [B.1](#appendix-B.1).  iOS Implementation Details  . . . . . . . . . . . . . . .  [18](#page-18)
     [B.2](#appendix-B.2).  Android Implementation Details  . . . . . . . . . . . . .  [19](#page-19)
     [B.3](#appendix-B.3).  Windows Implementation Details  . . . . . . . . . . . . .  [19](#page-19)
     [B.4](#appendix-B.4).  macOS Implementation Details  . . . . . . . . . . . . . .  [20](#page-20)
     [B.5](#appendix-B.5).  Linux Implementation Details  . . . . . . . . . . . . . .  [21](#page-21)
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  [21](#page-21)
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  [21](#page-21)

Denniss & Bradley         Best Current Practice                 [Page 2]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

[1](#section-1).  Introduction

   [Section 9](#section-9) of the OAuth 2.0 authorization framework [[RFC6749](./rfc6749 "\"The OAuth 2.0 Authorization Framework\"")]
   documents two approaches for native apps to interact with the
   authorization endpoint: an embedded user-agent and an external user-
   agent.

   This best current practice requires that only external user-agents
   like the browser are used for OAuth by native apps.  It documents how
   native apps can implement authorization flows using the browser as
   the preferred external user-agent as well as the requirements for
   authorization servers to support such usage.

   This practice is also known as the "AppAuth pattern", in reference to
   open-source libraries [[AppAuth](#ref-AppAuth "\"AppAuth\"")] that implement it.

[2](#section-2).  Notational Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [BCP 14](https://www.rfc-editor.org/bcp/bcp14) [[RFC2119](./rfc2119 "\"Key words for use in RFCs to Indicate Requirement Levels\"")] [[RFC8174](./rfc8174 "\"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words\"")] when, and only when, they appear in all
   capitals, as shown here.

[3](#section-3).  Terminology

   In addition to the terms defined in referenced specifications, this
   document uses the following terms:

   "native app"  An app or application that is installed by the user to
      their device, as distinct from a web app that runs in the browser
      context only.  Apps implemented using web-based technology but
      distributed as a native app, so-called "hybrid apps", are
      considered equivalent to native apps for the purpose of this
      specification.

   "app"  A "native app" unless further specified.

   "app store"  An e-commerce store where users can download and
      purchase apps.

   "OAuth"  Authorization protocol specified by the OAuth 2.0
      Authorization Framework [[RFC6749](./rfc6749 "\"The OAuth 2.0 Authorization Framework\"")].

   "external user-agent"  A user-agent capable of handling the
      authorization request that is a separate entity or security domain
      to the native app making the request, such that the app cannot
      access the cookie storage, nor inspect or modify page content.

Denniss & Bradley         Best Current Practice                 [Page 3]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   "embedded user-agent"  A user-agent hosted by the native app making
      the authorization request that forms a part of the app or shares
      the same security domain such that the app can access the cookie
      storage and/or inspect or modify page content.

   "browser"  The default application launched by the operating system
      to handle "http" and "https" scheme URI content.

   "in-app browser tab"  A programmatic instantiation of the browser
      that is displayed inside a host app but that retains the full
      security properties and authentication state of the browser.  It
      has different platform-specific product names, several of which
      are detailed in [Appendix B](#appendix-B).

   "web-view"  A web browser UI (user interface) component that is
      embedded in apps to render web pages under the control of the app.

   "inter-app communication"  Communication between two apps on a
      device.

   "claimed "https" scheme URI"  Some platforms allow apps to claim an
      "https" scheme URI after proving ownership of the domain name.
      URIs claimed in such a way are then opened in the app instead of
      the browser.

   "private-use URI scheme"  As used by this document, a URI scheme
      defined by the app (following the requirements of [Section¬†3.8 of
      [RFC7595]](./rfc7595#section-3.8)) and registered with the operating system.  URI requests
      to such schemes launch the app that registered it to handle the
      request.

   "reverse domain name notation"  A naming convention based on the
      domain name system, but one where the domain components are
      reversed, for example, "app.example.com" becomes
      "com.example.app".

[4](#section-4).  Overview

   For authorizing users in native apps, the best current practice is to
   perform the OAuth authorization request in an external user-agent
   (typically the browser) rather than an embedded user-agent (such as
   one implemented with web-views).

   Previously, it was common for native apps to use embedded user-agents
   (commonly implemented with web-views) for OAuth authorization
   requests.  That approach has many drawbacks, including the host app
   being able to copy user credentials and cookies as well as the user
   needing to authenticate from scratch in each app.  See [Section 8.12](#section-8.12)

Denniss & Bradley         Best Current Practice                 [Page 4]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   for a deeper analysis of the drawbacks of using embedded user-agents
   for OAuth.

   Native app authorization requests that use the browser are more
   secure and can take advantage of the user's authentication state.
   Being able to use the existing authentication session in the browser
   enables single sign-on, as users don't need to authenticate to the
   authorization server each time they use a new app (unless required by
   the authorization server policy).

   Supporting authorization flows between a native app and the browser
   is possible without changing the OAuth protocol itself, as the OAuth
   authorization request and response are already defined in terms of
   URIs.  This encompasses URIs that can be used for inter-app
   communication.  Some OAuth server implementations that assume all
   clients are confidential web clients will need to add an
   understanding of public native app clients and the types of redirect
   URIs they use to support this best practice.

[4.1](#section-4.1).  Authorization Flow for Native Apps Using the Browser

  +~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+
  |          User Device          |
  |                               |
  | +--------------------------+  | (5) Authorization  +---------------+
  | |                          |  |     Code           |               |
  | |        Client App        |---------------------->|     Token     |
  | |                          |<----------------------|    Endpoint   |
  | +--------------------------+  | (6) Access Token,  |               |
  |   |             ^             |     Refresh Token  +---------------+
  |   |             |             |
  |   |             |             |
  |   | (1)         | (4)         |
  |   | Authorizat- | Authoriza-  |
  |   | ion Request | tion Code   |
  |   |             |             |
  |   |             |             |
  |   v             |             |
  | +---------------------------+ | (2) Authorization  +---------------+
  | |                           | |     Request        |               |
  | |          Browser          |--------------------->| Authorization |
  | |                           |<---------------------|    Endpoint   |
  | +---------------------------+ | (3) Authorization  |               |
  |                               |     Code           +---------------+
  +~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+

       Figure 1: Native App Authorization via an External User-Agent

Denniss & Bradley         Best Current Practice                 [Page 5]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   Figure 1 illustrates the interaction between a native app and the
   browser to authorize the user.

   (1)  Client app opens a browser tab with the authorization request.

   (2)  Authorization endpoint receives the authorization request,
        authenticates the user, and obtains authorization.
        Authenticating the user may involve chaining to other
        authentication systems.

   (3)  Authorization server issues an authorization code to the
        redirect URI.

   (4)  Client receives the authorization code from the redirect URI.

   (5)  Client app presents the authorization code at the token
        endpoint.

   (6)  Token endpoint validates the authorization code and issues the
        tokens requested.

[5](#section-5).  Using Inter-App URI Communication for OAuth

   Just as URIs are used for OAuth 2.0 [[RFC6749](./rfc6749 "\"The OAuth 2.0 Authorization Framework\"")] on the web to initiate
   the authorization request and return the authorization response to
   the requesting website, URIs can be used by native apps to initiate
   the authorization request in the device's browser and return the
   response to the requesting native app.

   By adopting the same methods used on the web for OAuth, benefits seen
   in the web context like the usability of a single sign-on session and
   the security of a separate authentication context are likewise gained
   in the native app context.  Reusing the same approach also reduces
   the implementation complexity and increases interoperability by
   relying on standards-based web flows that are not specific to a
   particular platform.

   To conform to this best practice, native apps MUST use an external
   user-agent to perform OAuth authorization requests.  This is achieved
   by opening the authorization request in the browser (detailed in
   [Section 6](#section-6)) and using a redirect URI that will return the
   authorization response back to the native app (defined in [Section 7](#section-7)).

Denniss & Bradley         Best Current Practice                 [Page 6]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

[6](#section-6).  Initiating the Authorization Request from a Native App

   Native apps needing user authorization create an authorization
   request URI with the authorization code grant type per [Section 4.1](#section-4.1) of
   OAuth 2.0 [[RFC6749](./rfc6749 "\"The OAuth 2.0 Authorization Framework\"")], using a redirect URI capable of being received
   by the native app.

   The function of the redirect URI for a native app authorization
   request is similar to that of a web-based authorization request.
   Rather than returning the authorization response to the OAuth
   client's server, the redirect URI used by a native app returns the
   response to the app.  Several options for a redirect URI that will
   return the authorization response to the native app in different
   platforms are documented in [Section 7](#section-7).  Any redirect URI that allows
   the app to receive the URI and inspect its parameters is viable.

   Public native app clients MUST implement the Proof Key for Code
   Exchange (PKCE [[RFC7636](./rfc7636 "\"Proof Key for Code Exchange by OAuth Public Clients\"")]) extension to OAuth, and authorization
   servers MUST support PKCE for such clients, for the reasons detailed
   in [Section 8.1](#section-8.1).

   After constructing the authorization request URI, the app uses
   platform-specific APIs to open the URI in an external user-agent.
   Typically, the external user-agent used is the default browser, that
   is, the application configured for handling "http" and "https" scheme
   URIs on the system; however, different browser selection criteria and
   other categories of external user-agents MAY be used.

   This best practice focuses on the browser as the RECOMMENDED external
   user-agent for native apps.  An external user-agent designed
   specifically for user authorization and capable of processing
   authorization requests and responses like a browser MAY also be used.
   Other external user-agents, such as a native app provided by the
   authorization server may meet the criteria set out in this best
   practice, including using the same redirection URI properties, but
   their use is out of scope for this specification.

   Some platforms support a browser feature known as "in-app browser
   tabs", where an app can present a tab of the browser within the app
   context without switching apps, but still retain key benefits of the
   browser such as a shared authentication state and security context.
   On platforms where they are supported, it is RECOMMENDED, for
   usability reasons, that apps use in-app browser tabs for the
   authorization request.

Denniss & Bradley         Best Current Practice                 [Page 7]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

[7](#section-7).  Receiving the Authorization Response in a Native App

   There are several redirect URI options available to native apps for
   receiving the authorization response from the browser, the
   availability and user experience of which varies by platform.

   To fully support this best practice, authorization servers MUST offer
   at least the three redirect URI options described in the following
   subsections to native apps.  Native apps MAY use whichever redirect
   option suits their needs best, taking into account platform-specific
   implementation details.

[7.1](#section-7.1).  Private-Use URI Scheme Redirection

   Many mobile and desktop computing platforms support inter-app
   communication via URIs by allowing apps to register private-use URI
   schemes (sometimes colloquially referred to as "custom URL schemes")
   like "com.example.app".  When the browser or another app attempts to
   load a URI with a private-use URI scheme, the app that registered it
   is launched to handle the request.

   To perform an OAuth 2.0 authorization request with a private-use URI
   scheme redirect, the native app launches the browser with a standard
   authorization request, but one where the redirection URI utilizes a
   private-use URI scheme it registered with the operating system.

   When choosing a URI scheme to associate with the app, apps MUST use a
   URI scheme based on a domain name under their control, expressed in
   reverse order, as recommended by [Section¬†3.8 of [RFC7595]](./rfc7595#section-3.8) for
   private-use URI schemes.

   For example, an app that controls the domain name "app.example.com"
   can use "com.example.app" as their scheme.  Some authorization
   servers assign client identifiers based on domain names, for example,
   "client1234.usercontent.example.net", which can also be used as the
   domain name for the scheme when reversed in the same manner.  A
   scheme such as "myapp", however, would not meet this requirement, as
   it is not based on a domain name.

   When there are multiple apps by the same publisher, care must be
   taken so that each scheme is unique within that group.  On platforms
   that use app identifiers based on reverse-order domain names, those
   identifiers can be reused as the private-use URI scheme for the OAuth
   redirect to help avoid this problem.

Denniss & Bradley         Best Current Practice                 [Page 8]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   Following the requirements of [Section¬†3.2 of [RFC3986]](./rfc3986#section-3.2), as there is
   no naming authority for private-use URI scheme redirects, only a
   single slash ("/") appears after the scheme component.  A complete
   example of a redirect URI utilizing a private-use URI scheme is:

     com.example.app:/oauth2redirect/example-provider

   When the authorization server completes the request, it redirects to
   the client's redirection URI as it would normally.  As the
   redirection URI uses a private-use URI scheme, it results in the
   operating system launching the native app, passing in the URI as a
   launch parameter.  Then, the native app uses normal processing for
   the authorization response.

[7.2](#section-7.2).  Claimed "https" Scheme URI Redirection

   Some operating systems allow apps to claim "https" scheme [[RFC7230](./rfc7230 "\"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing\"")]
   URIs in the domains they control.  When the browser encounters a
   claimed URI, instead of the page being loaded in the browser, the
   native app is launched with the URI supplied as a launch parameter.

   Such URIs can be used as redirect URIs by native apps.  They are
   indistinguishable to the authorization server from a regular web-
   based client redirect URI.  An example is:

     https://app.example.com/oauth2redirect/example-provider

   As the redirect URI alone is not enough to distinguish public native
   app clients from confidential web clients, it is REQUIRED in
   [Section 8.4](#section-8.4) that the client type be recorded during client
   registration to enable the server to determine the client type and
   act accordingly.

   App-claimed "https" scheme redirect URIs have some advantages
   compared to other native app redirect options in that the identity of
   the destination app is guaranteed to the authorization server by the
   operating system.  For this reason, native apps SHOULD use them over
   the other options where possible.

[7.3](#section-7.3).  Loopback Interface Redirection

   Native apps that are able to open a port on the loopback network
   interface without needing special permissions (typically, those on
   desktop operating systems) can use the loopback interface to receive
   the OAuth redirect.

   Loopback redirect URIs use the "http" scheme and are constructed with
   the loopback IP literal and whatever port the client is listening on.

Denniss & Bradley         Best Current Practice                 [Page 9]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   That is, "<http://127.0.0>.1:{port}/{path}" for IPv4, and
   "http://[::1]:{port}/{path}" for IPv6.  An example redirect using the
   IPv4 loopback interface with a randomly assigned port:

     <http://127.0.0.1:51004/oauth2redirect/example-provider>

   An example redirect using the IPv6 loopback interface with a randomly
   assigned port:

     http://[::1]:61023/oauth2redirect/example-provider

   The authorization server MUST allow any port to be specified at the
   time of the request for loopback IP redirect URIs, to accommodate
   clients that obtain an available ephemeral port from the operating
   system at the time of the request.

   Clients SHOULD NOT assume that the device supports a particular
   version of the Internet Protocol.  It is RECOMMENDED that clients
   attempt to bind to the loopback interface using both IPv4 and IPv6
   and use whichever is available.

[8](#section-8).  Security Considerations

[8.1](#section-8.1).  Protecting the Authorization Code

   The redirect URI options documented in [Section 7](#section-7) share the benefit
   that only a native app on the same device or the app's own website
   can receive the authorization code, which limits the attack surface.
   However, code interception by a different native app running on the
   same device may be possible.

   A limitation of using private-use URI schemes for redirect URIs is
   that multiple apps can typically register the same scheme, which
   makes it indeterminate as to which app will receive the authorization
   code.  [Section 1](#section-1) of PKCE [[RFC7636](./rfc7636 "\"Proof Key for Code Exchange by OAuth Public Clients\"")] details how this limitation can be
   used to execute a code interception attack.

   Loopback IP-based redirect URIs may be susceptible to interception by
   other apps accessing the same loopback interface on some operating
   systems.

   App-claimed "https" scheme redirects are less susceptible to URI
   interception due to the presence of the URI authority, but the app is
   still a public client; further, the URI is sent using the operating
   system's URI dispatch handler with unknown security properties.

Denniss & Bradley         Best Current Practice                [Page 10]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   The PKCE [[RFC7636](./rfc7636 "\"Proof Key for Code Exchange by OAuth Public Clients\"")] protocol was created specifically to mitigate this
   attack.  It is a proof-of-possession extension to OAuth 2.0 that
   protects the authorization code from being used if it is intercepted.
   To provide protection, this extension has the client generate a
   secret verifier; it passes a hash of this verifier in the initial
   authorization request, and must present the unhashed verifier when
   redeeming the authorization code.  An app that intercepted the
   authorization code would not be in possession of this secret,
   rendering the code useless.

   [Section 6](#section-6) requires that both clients and servers use PKCE for public
   native app clients.  Authorization servers SHOULD reject
   authorization requests from native apps that don't use PKCE by
   returning an error message, as defined in [Section 4.4.1](#section-4.4.1) of PKCE
   [[RFC7636](./rfc7636 "\"Proof Key for Code Exchange by OAuth Public Clients\"")].

[8.2](#section-8.2).  OAuth Implicit Grant Authorization Flow

   The OAuth 2.0 implicit grant authorization flow (defined in
   [Section 4.2](#section-4.2) of OAuth 2.0 [[RFC6749](./rfc6749 "\"The OAuth 2.0 Authorization Framework\"")]) generally works with the practice
   of performing the authorization request in the browser and receiving
   the authorization response via URI-based inter-app communication.
   However, as the implicit flow cannot be protected by PKCE [[RFC7636](./rfc7636 "\"Proof Key for Code Exchange by OAuth Public Clients\"")]
   (which is required in [Section 8.1](#section-8.1)), the use of the Implicit Flow with
   native apps is NOT RECOMMENDED.

   Access tokens granted via the implicit flow also cannot be refreshed
   without user interaction, making the authorization code grant flow --
   which can issue refresh tokens -- the more practical option for
   native app authorizations that require refreshing of access tokens.

[8.3](#section-8.3).  Loopback Redirect Considerations

   Loopback interface redirect URIs use the "http" scheme (i.e., without
   Transport Layer Security (TLS)).  This is acceptable for loopback
   interface redirect URIs as the HTTP request never leaves the device.

   Clients should open the network port only when starting the
   authorization request and close it once the response is returned.

   Clients should listen on the loopback network interface only, in
   order to avoid interference by other network actors.

   While redirect URIs using localhost (i.e.,
   "http://localhost:{port}/{path}") function similarly to loopback IP
   redirects described in [Section 7.3](#section-7.3), the use of localhost is NOT
   RECOMMENDED.  Specifying a redirect URI with the loopback IP literal
   rather than localhost avoids inadvertently listening on network

Denniss & Bradley         Best Current Practice                [Page 11]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   interfaces other than the loopback interface.  It is also less
   susceptible to client-side firewalls and misconfigured host name
   resolution on the user's device.

[8.4](#section-8.4).  Registration of Native App Clients

   Except when using a mechanism like Dynamic Client Registration
   [[RFC7591](./rfc7591 "\"OAuth 2.0 Dynamic Client Registration Protocol\"")] to provision per-instance secrets, native apps are
   classified as public clients, as defined by [Section 2.1](#section-2.1) of OAuth 2.0
   [[RFC6749](./rfc6749 "\"The OAuth 2.0 Authorization Framework\"")]; they MUST be registered with the authorization server as
   such.  Authorization servers MUST record the client type in the
   client registration details in order to identify and process requests
   accordingly.

   Authorization servers MUST require clients to register their complete
   redirect URI (including the path component) and reject authorization
   requests that specify a redirect URI that doesn't exactly match the
   one that was registered; the exception is loopback redirects, where
   an exact match is required except for the port URI component.

   For private-use URI scheme-based redirects, authorization servers
   SHOULD enforce the requirement in [Section 7.1](#section-7.1) that clients use
   schemes that are reverse domain name based.  At a minimum, any
   private-use URI scheme that doesn't contain a period character (".")
   SHOULD be rejected.

   In addition to the collision-resistant properties, requiring a URI
   scheme based on a domain name that is under the control of the app
   can help to prove ownership in the event of a dispute where two apps
   claim the same private-use URI scheme (where one app is acting
   maliciously).  For example, if two apps claimed "com.example.app",
   the owner of "example.com" could petition the app store operator to
   remove the counterfeit app.  Such a petition is harder to prove if a
   generic URI scheme was used.

   Authorization servers MAY request the inclusion of other platform-
   specific information, such as the app package or bundle name, or
   other information that may be useful for verifying the calling app's
   identity on operating systems that support such functions.

[8.5](#section-8.5).  Client Authentication

   Secrets that are statically included as part of an app distributed to
   multiple users should not be treated as confidential secrets, as one
   user may inspect their copy and learn the shared secret.  For this
   reason, and those stated in [Section¬†5.3.1 of [RFC6819]](./rfc6819#section-5.3.1), it is NOT
   RECOMMENDED for authorization servers to require client

Denniss & Bradley         Best Current Practice                [Page 12]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   authentication of public native apps clients using a shared secret,
   as this serves little value beyond client identification which is
   already provided by the "client_id" request parameter.

   Authorization servers that still require a statically included shared
   secret for native app clients MUST treat the client as a public
   client (as defined by [Section 2.1](#section-2.1) of OAuth 2.0 [[RFC6749](./rfc6749 "\"The OAuth 2.0 Authorization Framework\"")]), and not
   accept the secret as proof of the client's identity.  Without
   additional measures, such clients are subject to client impersonation
   (see [Section 8.6](#section-8.6)).

[8.6](#section-8.6).  Client Impersonation

   As stated in [Section 10.2](#section-10.2) of OAuth 2.0 [[RFC6749](./rfc6749 "\"The OAuth 2.0 Authorization Framework\"")], the authorization
   server SHOULD NOT process authorization requests automatically
   without user consent or interaction, except when the identity of the
   client can be assured.  This includes the case where the user has
   previously approved an authorization request for a given client id --
   unless the identity of the client can be proven, the request SHOULD
   be processed as if no previous request had been approved.

   Measures such as claimed "https" scheme redirects MAY be accepted by
   authorization servers as identity proof.  Some operating systems may
   offer alternative platform-specific identity features that MAY be
   accepted, as appropriate.

[8.7](#section-8.7).  Fake External User-Agents

   The native app that is initiating the authorization request has a
   large degree of control over the user interface and can potentially
   present a fake external user-agent, that is, an embedded user-agent
   made to appear as an external user-agent.

   When all good actors are using external user-agents, the advantage is
   that it is possible for security experts to detect bad actors, as
   anyone faking an external user-agent is provably bad.  On the other
   hand, if good and bad actors alike are using embedded user-agents,
   bad actors don't need to fake anything, making them harder to detect.
   Once a malicious app is detected, it may be possible to use this
   knowledge to blacklist the app's signature in malware scanning
   software, take removal action (in the case of apps distributed by app
   stores) and other steps to reduce the impact and spread of the
   malicious app.

   Authorization servers can also directly protect against fake external
   user-agents by requiring an authentication factor only available to
   true external user-agents.

Denniss & Bradley         Best Current Practice                [Page 13]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   Users who are particularly concerned about their security when using
   in-app browser tabs may also take the additional step of opening the
   request in the full browser from the in-app browser tab and complete
   the authorization there, as most implementations of the in-app
   browser tab pattern offer such functionality.

[8.8](#section-8.8).  Malicious External User-Agents

   If a malicious app is able to configure itself as the default handler
   for "https" scheme URIs in the operating system, it will be able to
   intercept authorization requests that use the default browser and
   abuse this position of trust for malicious ends such as phishing the
   user.

   This attack is not confined to OAuth; a malicious app configured in
   this way would present a general and ongoing risk to the user beyond
   OAuth usage by native apps.  Many operating systems mitigate this
   issue by requiring an explicit user action to change the default
   handler for "http" and "https" scheme URIs.

[8.9](#section-8.9).  Cross-App Request Forgery Protections

   [Section¬†5.3.5 of [RFC6819]](./rfc6819#section-5.3.5) recommends using the "state" parameter to
   link client requests and responses to prevent CSRF (Cross-Site
   Request Forgery) attacks.

   To mitigate CSRF-style attacks over inter-app URI communication
   channels (so called "cross-app request forgery"), it is similarly
   RECOMMENDED that native apps include a high-entropy secure random
   number in the "state" parameter of the authorization request and
   reject any incoming authorization responses without a state value
   that matches a pending outgoing authorization request.

[8.10](#section-8.10).  Authorization Server Mix-Up Mitigation

   To protect against a compromised or malicious authorization server
   attacking another authorization server used by the same app, it is
   REQUIRED that a unique redirect URI is used for each authorization
   server used by the app (for example, by varying the path component),
   and that authorization responses are rejected if the redirect URI
   they were received on doesn't match the redirect URI in an outgoing
   authorization request.

   The native app MUST store the redirect URI used in the authorization
   request with the authorization session data (i.e., along with "state"
   and other related data) and MUST verify that the URI on which the
   authorization response was received exactly matches it.

Denniss & Bradley         Best Current Practice                [Page 14]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   The requirement of [Section 8.4](#section-8.4), specifically that authorization
   servers reject requests with URIs that don't match what was
   registered, is also required to prevent such attacks.

[8.11](#section-8.11).  Non-Browser External User-Agents

   This best practice recommends a particular type of external user-
   agent: the user's browser.  Other external user-agent patterns may
   also be viable for secure and usable OAuth.  This document makes no
   comment on those patterns.

[8.12](#section-8.12).  Embedded User-Agents

   [Section 9](#section-9) of OAuth 2.0 [[RFC6749](./rfc6749 "\"The OAuth 2.0 Authorization Framework\"")] documents two approaches for native
   apps to interact with the authorization endpoint.  This best current
   practice requires that native apps MUST NOT use embedded user-agents
   to perform authorization requests and allows that authorization
   endpoints MAY take steps to detect and block authorization requests
   in embedded user-agents.  The security considerations for these
   requirements are detailed herein.

   Embedded user-agents are an alternative method for authorizing native
   apps.  These embedded user-agents are unsafe for use by third parties
   to the authorization server by definition, as the app that hosts the
   embedded user-agent can access the user's full authentication
   credential, not just the OAuth authorization grant that was intended
   for the app.

   In typical web-view-based implementations of embedded user-agents,
   the host application can record every keystroke entered in the login
   form to capture usernames and passwords, automatically submit forms
   to bypass user consent, and copy session cookies and use them to
   perform authenticated actions as the user.

   Even when used by trusted apps belonging to the same party as the
   authorization server, embedded user-agents violate the principle of
   least privilege by having access to more powerful credentials than
   they need, potentially increasing the attack surface.

   Encouraging users to enter credentials in an embedded user-agent
   without the usual address bar and visible certificate validation
   features that browsers have makes it impossible for the user to know
   if they are signing in to the legitimate site; even when they are, it
   trains them that it's OK to enter credentials without validating the
   site first.

Denniss & Bradley         Best Current Practice                [Page 15]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   Aside from the security concerns, embedded user-agents do not share
   the authentication state with other apps or the browser, requiring
   the user to log in for every authorization request, which is often
   considered an inferior user experience.

[9](#section-9).  IANA Considerations

   This document does not require any IANA actions.

   [Section 7.1](#section-7.1) specifies how private-use URI schemes are used for inter-
   app communication in OAuth protocol flows.  This document requires in
   [Section 7.1](#section-7.1) that such schemes are based on domain names owned or
   assigned to the app, as recommended in [Section¬†3.8 of [RFC7595]](./rfc7595#section-3.8).  Per
   [Section¬†6 of [RFC7595]](./rfc7595#section-6), registration of domain-based URI schemes with
   IANA is not required.

[10](#section-10).  References

[10.1](#section-10.1).  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", [BCP 14](https://www.rfc-editor.org/bcp/bcp14), [RFC 2119](./rfc2119),
              DOI 10.17487/RFC2119, March 1997,
              <<https://www.rfc-editor.org/info/rfc2119>>.

   [RFC3986]  Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
              Resource Identifier (URI): Generic Syntax", STD 66,
              [RFC 3986](./rfc3986), DOI 10.17487/RFC3986, January 2005,
              <<https://www.rfc-editor.org/info/rfc3986>>.

   [RFC6749]  Hardt, D., Ed., "The OAuth 2.0 Authorization Framework",
              [RFC 6749](./rfc6749), DOI 10.17487/RFC6749, October 2012,
              <<https://www.rfc-editor.org/info/rfc6749>>.

   [RFC7230]  Fielding, R., Ed. and J. Reschke, Ed., "Hypertext Transfer
              Protocol (HTTP/1.1): Message Syntax and Routing",
              [RFC 7230](./rfc7230), DOI 10.17487/RFC7230, June 2014,
              <<https://www.rfc-editor.org/info/rfc7230>>.

   [RFC7595]  Thaler, D., Ed., Hansen, T., and T. Hardie, "Guidelines
              and Registration Procedures for URI Schemes", [BCP 35](https://www.rfc-editor.org/bcp/bcp35),
              [RFC 7595](./rfc7595), DOI 10.17487/RFC7595, June 2015,
              <<https://www.rfc-editor.org/info/rfc7595>>.

   [RFC7636]  Sakimura, N., Ed., Bradley, J., and N. Agarwal, "Proof Key
              for Code Exchange by OAuth Public Clients", [RFC 7636](./rfc7636),
              DOI 10.17487/RFC7636, September 2015,
              <<https://www.rfc-editor.org/info/rfc7636>>.

Denniss & Bradley         Best Current Practice                [Page 16]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in [RFC](./rfc2119)
              [2119](./rfc2119) Key Words", [BCP 14](https://www.rfc-editor.org/bcp/bcp14), [RFC 8174](./rfc8174), DOI 10.17487/RFC8174,
              May 2017, <<https://www.rfc-editor.org/info/rfc8174>>.

[10.2](#section-10.2).  Informative References

   [RFC6819]  Lodderstedt, T., Ed., McGloin, M., and P. Hunt, "OAuth 2.0
              Threat Model and Security Considerations", [RFC 6819](./rfc6819),
              DOI 10.17487/RFC6819, January 2013,
              <<https://www.rfc-editor.org/info/rfc6819>>.

   [RFC7591]  Richer, J., Ed., Jones, M., Bradley, J., Machulak, M., and
              P. Hunt, "OAuth 2.0 Dynamic Client Registration Protocol",
              [RFC 7591](./rfc7591), DOI 10.17487/RFC7591, July 2015,
              <<https://www.rfc-editor.org/info/rfc7591>>.

   [AppAuth]  OpenID Connect Working Group, "AppAuth", September 2017,
              <<https://openid.net/code/AppAuth>>.

   [AppAuth.iOSmacOS]
              Wright, S., Denniss, W., et al., "AppAuth for iOS and
              macOS", February 2016,
              <<https://openid.net/code/AppAuth-iOS>>.

   [AppAuth.Android]
              McGinniss, I., Denniss, W., et al., "AppAuth for Android",
              February 2016, <<https://openid.net/code/AppAuth-Android>>.

   [SamplesForWindows]
              Denniss, W., "OAuth for Apps: Samples for Windows", July
              2016,
              <<https://openid.net/code/sample-oauth-apps-for-windows>>.

Denniss & Bradley         Best Current Practice                [Page 17]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

[Appendix A](#appendix-A).  Server Support Checklist

   OAuth servers that support native apps must:

   1.  Support private-use URI scheme redirect URIs.  This is required
       to support mobile operating systems.  See [Section 7.1](#section-7.1).

   2.  Support "https" scheme redirect URIs for use with public native
       app clients.  This is used by apps on advanced mobile operating
       systems that allow app-claimed "https" scheme URIs.  See
       [Section 7.2](#section-7.2).

   3.  Support loopback IP redirect URIs.  This is required to support
       desktop operating systems.  See [Section 7.3](#section-7.3).

   4.  Not assume that native app clients can keep a secret.  If secrets
       are distributed to multiple installs of the same native app, they
       should not be treated as confidential.  See [Section 8.5](#section-8.5).

   5.  Support PKCE [[RFC7636](./rfc7636 "\"Proof Key for Code Exchange by OAuth Public Clients\"")].  Required to protect authorization code
       grants sent to public clients over inter-app communication
       channels.  See [Section 8.1](#section-8.1)

[Appendix B](#appendix-B).  Platform-Specific Implementation Details

   This document primarily defines best practices in a generic manner,
   referencing techniques commonly available in a variety of
   environments.  This non-normative section documents implementation
   details of the best practice for various operating systems.

   The implementation details herein are considered accurate at the time
   of publishing but will likely change over time.  It is hoped that
   such a change won't invalidate the generic principles in the rest of
   the document and that those principles should take precedence in the
   event of a conflict.

[B.1](#appendix-B.1).  iOS Implementation Details

   Apps can initiate an authorization request in the browser, without
   the user leaving the app, through the "SFSafariViewController" class
   or its successor "SFAuthenticationSession", which implement the in-
   app browser tab pattern.  Safari can be used to handle requests on
   old versions of iOS without in-app browser tab functionality.

   To receive the authorization response, both private-use URI scheme
   (referred to as "custom URL scheme") redirects and claimed "https"
   scheme URIs (known as "Universal Links") are viable choices.  Apps
   can claim private-use URI schemes with the "CFBundleURLTypes" key in

Denniss & Bradley         Best Current Practice                [Page 18]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   the application's property list file, "Info.plist", and "https"
   scheme URIs using the Universal Links feature with an entitlement
   file in the app and an association file hosted on the domain.

   Claimed "https" scheme URIs are the preferred redirect choice on iOS
   9 and above due to the ownership proof that is provided by the
   operating system.

   A complete open-source sample is included in the AppAuth for iOS and
   macOS [[AppAuth.iOSmacOS](#ref-AppAuth.iOSmacOS)] library.

[B.2](#appendix-B.2).  Android Implementation Details

   Apps can initiate an authorization request in the browser, without
   the user leaving the app, through the Android Custom Tab feature,
   which implements the in-app browser tab pattern.  The user's default
   browser can be used to handle requests when no browser supports
   Custom Tabs.

   Android browser vendors should support the Custom Tabs protocol (by
   providing an implementation of the "CustomTabsService" class), to
   provide the in-app browser tab user-experience optimization to their
   users.  Chrome is one such browser that implements Custom Tabs.

   To receive the authorization response, private-use URI schemes are
   broadly supported through Android Implicit Intents.  Claimed "https"
   scheme redirect URIs through Android App Links are available on
   Android 6.0 and above.  Both types of redirect URIs are registered in
   the application's manifest.

   A complete open-source sample is included in the AppAuth for Android
   [[AppAuth.Android](#ref-AppAuth.Android)] library.

[B.3](#appendix-B.3).  Windows Implementation Details

   Both traditional and Universal Windows Platform (UWP) apps can
   perform authorization requests in the user's browser.  Traditional
   apps typically use a loopback redirect to receive the authorization
   response, and listening on the loopback interface is allowed by
   default firewall rules.  When creating the loopback network socket,
   apps SHOULD set the "SO_EXCLUSIVEADDRUSE" socket option to prevent
   other apps binding to the same socket.

   UWP apps can use private-use URI scheme redirects to receive the
   authorization response from the browser, which will bring the app to
   the foreground.  Known on the platform as "URI Activation", the URI

Denniss & Bradley         Best Current Practice                [Page 19]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

   scheme is limited to 39 characters in length, and it may include the
   "." character, making short reverse domain name based schemes (as
   required in [Section 7.1](#section-7.1)) possible.

   UWP apps can alternatively use the Web Authentication Broker API in
   Single Sign-on (SSO) mode, which is an external user-agent designed
   for authorization flows.  Cookies are shared between invocations of
   the broker but not the user's preferred browser, meaning the user
   will need to log in again, even if they have an active session in
   their browser; but the session created in the broker will be
   available to subsequent apps that use the broker.  Personalizations
   the user has made to their browser, such as configuring a password
   manager, may not be available in the broker.  To qualify as an
   external user-agent, the broker MUST be used in SSO mode.

   To use the Web Authentication Broker in SSO mode, the redirect URI
   must be of the form "msapp://{appSID}" where "{appSID}" is the app's
   security identifier (SID), which can be found in the app's
   registration information or by calling the
   "GetCurrentApplicationCallbackUri" method.  While Windows enforces
   the URI authority on such redirects, ensuring that only the app with
   the matching SID can receive the response on Windows, the URI scheme
   could be claimed by apps on other platforms without the same
   authority present; thus, this redirect type should be treated
   similarly to private-use URI scheme redirects for security purposes.

   An open-source sample demonstrating these patterns is available
   [[SamplesForWindows](#ref-SamplesForWindows)].

[B.4](#appendix-B.4).  macOS Implementation Details

   Apps can initiate an authorization request in the user's default
   browser using platform APIs for opening URIs in the browser.

   To receive the authorization response, private-use URI schemes are a
   good redirect URI choice on macOS, as the user is returned right back
   to the app they launched the request from.  These are registered in
   the application's bundle information property list using the
   "CFBundleURLSchemes" key.  Loopback IP redirects are another viable
   option, and listening on the loopback interface is allowed by default
   firewall rules.

   A complete open-source sample is included in the AppAuth for iOS and
   macOS [[AppAuth.iOSmacOS](#ref-AppAuth.iOSmacOS)] library.

Denniss & Bradley         Best Current Practice                [Page 20]
```

---

```

[RFC 8252](./rfc8252)                OAuth 2.0 for Native Apps           October 2017

[B.5](#appendix-B.5).  Linux Implementation Details

   Opening the authorization request in the user's default browser
   requires a distro-specific command: "xdg-open" is one such tool.

   The loopback redirect is the recommended redirect choice for desktop
   apps on Linux to receive the authorization response.  Apps SHOULD NOT
   set the "SO_REUSEPORT" or "SO_REUSEADDR" socket options in order to
   prevent other apps binding to the same socket.

Acknowledgements

   The authors would like to acknowledge the work of Marius Scurtescu
   and Ben Wiley Sittler, whose design for using private-use URI schemes
   in native app OAuth 2.0 clients at Google formed the basis of
   [Section 7.1](#section-7.1).

   The following individuals contributed ideas, feedback, and wording
   that shaped and formed the final specification:

   Andy Zmolek, Steven E. Wright, Brian Campbell, Nat Sakimura, Eric
   Sachs, Paul Madsen, Iain McGinniss, Rahul Ravikumar, Breno de
   Medeiros, Hannes Tschofenig, Ashish Jain, Erik Wahlstrom, Bill
   Fisher, Sudhi Umarji, Michael B. Jones, Vittorio Bertocci, Dick
   Hardt, David Waite, Ignacio Fiorentino, Kathleen Moriarty, and Elwyn
   Davies.

Authors' Addresses

   William Denniss
   Google
   1600 Amphitheatre Pkwy
   Mountain View, CA  94043
   United States of America

   Email: [rfc8252](./rfc8252)@wdenniss.com
   URI:   <http://wdenniss.com/appauth>

   John Bradley
   Ping Identity

   Phone: +1 202-630-5272
   Email: [rfc8252](./rfc8252)@ve7jtb.com
   URI:   <http://www.thread-safe.com/p/appauth.html>

Denniss & Bradley         Best Current Practice                [Page 21]

```

