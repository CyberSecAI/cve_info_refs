- **Root cause of vulnerability**: A stored Cross-Site Scripting (XSS) vulnerability exists because document names containing XSS payloads are not properly escaped before being displayed in the admin interface.
- **Weaknesses/vulnerabilities present**: Stored XSS (CWE-79) due to insufficient sanitization of document names displayed in the admin history page.
- **Impact of exploitation**: An attacker can inject malicious JavaScript code into the admin console through a crafted document name. This injected code executes within the context of the administrator's session, potentially allowing the attacker to:
    - Leak the administrator's JWT used for the websocket connection.
    - Perform actions on behalf of the administrator.
    - Access sensitive information available to the admin.
- **Attack vectors**: An attacker can create a document with a malicious XSS payload in the document name, which will be stored. When an administrator views the document history in the admin console, the malicious script is executed.
- **Required attacker capabilities/position**: The attacker needs the ability to create documents and insert the XSS payload in document names. The administrator needs to be logged in and navigate to the admin console history page to trigger the vulnerability.