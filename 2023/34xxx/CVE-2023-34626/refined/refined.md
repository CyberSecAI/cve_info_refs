The provided content discusses a SQL injection vulnerability in the "Users" function of Piwigo.

**Root cause of vulnerability:**
The vulnerability stems from the lack of sanitization of user-supplied input in the `order` and `exclude[]` parameters within the `ws_users_getList()` function. These parameters are directly concatenated into the SQL query without any input validation or escaping.

**Weaknesses/vulnerabilities present:**
- SQL Injection: The direct concatenation of user-provided `order` and `exclude[]` parameters into the SQL query allows an attacker to inject arbitrary SQL code.

**Impact of exploitation:**
- An attacker can extract sensitive data, potentially including database schema information, usernames, passwords, and other confidential data by manipulating the SQL queries.

**Attack vectors:**
- The vulnerability can be exploited by sending specially crafted HTTP requests to the `/include/ws_functions/pwg.users.php` endpoint with malicious values in `order` or `exclude[]` parameters.

**Required attacker capabilities/position:**
- The attacker needs to be able to send HTTP requests to the Piwigo instance.
- The attacker does not need to be authenticated as this endpoint is available to anyone.

**Additional details:**
- The vulnerability affects Piwigo versions up to 13.7.0.
- The issue was fixed in commit `0649ad3` and is included in the 13.8.0 release.
- The attacker used an error-based SQL injection technique to extract database names.