The content is related to CVE-2023-34103.

**Root cause of vulnerability:**
The application was not properly sanitizing HTML content in certain fields, particularly those using the Trix editor, allowing for the injection of arbitrary JavaScript code.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS) vulnerability.
- Lack of proper sanitization of user-provided HTML content in Trix fields and other areas using `HasHTMLAttributes`.
- The application used `<%== value %>` which renders raw HTML without sanitization.

**Impact of exploitation:**
- An attacker can inject and execute arbitrary JavaScript code in the context of the victim's browser.
- This can lead to account compromise, particularly for privileged users like administrators, due to the persistent nature of stored XSS.
- The attacker can perform actions such as stealing cookies, redirecting users, or manipulating data displayed to the user.

**Attack vectors:**
- A malicious user can inject JavaScript code by intercepting the request and modifying the post data when editing fields (particularly Trix fields) on the backend.
- The Trix editor itself does not allow adding custom HTML or JS tags directly, so the attacker must manipulate the data in transit.

**Required attacker capabilities/position:**
- The attacker needs to be able to interact with the application as an authenticated user (low privilege).
- Ability to intercept and modify HTTP POST requests to inject malicious code.
- No user interaction is needed by the victim, because the injected script is persistent.

**Additional details:**
- The vulnerability exists in `avo` gem versions 2.33.2 and 3.0.0.pre12 and is fixed in version 2.33.3.
- The fix involves sanitizing HTML content using the `sanitize` helper from Rails.
- The patch commit includes changes to `app/components/avo/alert_component.html.erb`, `app/components/avo/field_wrapper_component.html.erb`, `app/components/avo/fields/common/heading_component.html.erb`, `app/components/avo/fields/trix_field/edit_component.html.erb`, `app/components/avo/fields/trix_field/show_component.html.erb` and `app/components/avo/index/field_wrapper_component.html.erb`, which replace `<%== value %>` with `<%= sanitize value %>`.