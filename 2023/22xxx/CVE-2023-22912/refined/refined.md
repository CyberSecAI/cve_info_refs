```
{
  "vulnerability_details": {
    "root_cause": "The CheckUser extension in MediaWiki uses AES-CTR encryption with a nonce stored in the user's session and reused for all subsequent encryptions/decryptions. This violates the security requirements of CTR mode, which mandates a unique nonce for each encryption operation.",
    "weaknesses": [
      "Use of AES-CTR with a repeated nonce.",
      "Storing the nonce in the user's session instead of with the ciphertext."
    ],
    "impact": "An adversary with access to two ciphertexts encrypted using the same nonce can XOR the ciphertexts to obtain the XOR of the corresponding plaintexts. Given that plaintexts contain predictable patterns, this allows the adversary to decrypt the ciphertexts and extract sensitive information.",
    "attack_vectors": [
        "An attacker could potentially read log files containing the encrypted data.",
        "An attacker with access to two ciphertexts encrypted with the same nonce can decrypt the plaintexts."
    ],
    "required_capabilities": "An attacker needs access to at least two ciphertexts that have been encrypted using the same nonce. Additionally, some knowledge of the plaintext structure assists in decryption.",
    "additional_details": "The issue was addressed by generating a new nonce for each encryption and storing it with the ciphertext, rather than reusing a session-stored nonce. The vulnerability was present in the CheckUser extension. Patches were created and merged across several MediaWiki branches."
  },
  "fixes": [
    "The nonce is now generated for every encryption and stored with the ciphertext, rather than being stored in the user session."
  ]
}
```