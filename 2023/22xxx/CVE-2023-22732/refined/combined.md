=== Content from github.com_5dee0243_20250115_081612.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshopware%2Fshopware%2Fsecurity%2Fadvisories%2FGHSA-59qg-93jg-236f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshopware%2Fshopware%2Fsecurity%2Fadvisories%2FGHSA-59qg-93jg-236f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=shopware%2Fshopware)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[shopware](/shopware)
/
**[shopware](/shopware/shopware)**
Public

* [Notifications](/login?return_to=%2Fshopware%2Fshopware) You must be signed in to change notification settings
* [Fork
  1k](/login?return_to=%2Fshopware%2Fshopware)
* [Star
   2.9k](/login?return_to=%2Fshopware%2Fshopware)

* [Code](/shopware/shopware)
* [Issues
  783](/shopware/shopware/issues)
* [Pull requests
  134](/shopware/shopware/pulls)
* [Discussions](/shopware/shopware/discussions)
* [Actions](/shopware/shopware/actions)
* [Projects
  0](/shopware/shopware/projects)
* [Security](/shopware/shopware/security)
* [Insights](/shopware/shopware/pulse)

Additional navigation options

* [Code](/shopware/shopware)
* [Issues](/shopware/shopware/issues)
* [Pull requests](/shopware/shopware/pulls)
* [Discussions](/shopware/shopware/discussions)
* [Actions](/shopware/shopware/actions)
* [Projects](/shopware/shopware/projects)
* [Security](/shopware/shopware/security)
* [Insights](/shopware/shopware/pulse)

# Insufficient Session Expiration in Administration

Low

[shyim](/shyim)
published
GHSA-59qg-93jg-236f
Jan 17, 2023

## Package

composer

shopware/core
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

<= 6.4.18.0

## Patched versions

6.4.18.1

composer

shopware/platform
([Composer](/advisories?query=ecosystem%3Acomposer))

<= 6.4.18.0

6.4.18.1

## Description

### Impact

The Administration session expiration was set to one week, when an attacker has stolen the session cookie they could use it for a long period of time.

### Patches

We added an automatic logout into the Administration, so the user will be logged out when they are inactive.

### References

<https://docs.shopware.com/en/shopware-6-en/security-updates/security-update-01-2023?category=security-updates>

### Severity

Low

### CVE ID

CVE-2023-22732

### Weaknesses

[CWE-613](/advisories?query=cwe%3A613)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from docs.shopware.com_5684ed8e_20250115_081609.html ===


* [shopware.com](https://www.shopware.com/en/ "Shopware Website")
* [Blog](https://www.shopware.com/en/news/ "Shopware blog")
* [Company](https://www.shopware.com/en/company/ "Company")
* [Jobs](https://www.shopware.com/en/jobs/ "Jobs")
* [Contact](https://www.shopware.com/en/contact/ "Contact")
* [Account](https://account.shopware.com/?lang=en "Shopware Account")
* [DE](/de/shopware-6-de/sicherheitsupdates/security-update-01-2023)[EN](/en/shopware-6-en/security-updates/security-update-01-2023)
[![Shopware Docs Logo](https://assets.shopware.com/media/logos/extended/shopware_docs_horizontal_white.svg)](/en)[DE](/de/shopware-6-de/sicherheitsupdates/security-update-01-2023)[EN](/en/shopware-6-en/security-updates/security-update-01-2023)[Show all results](/en/search)

* [![YouTube](/build/images/social-media/icon-yt.6afa92ed.svg)](https://www.youtube.com/channel/UC-xCvUIPOXx6o4ZydnwIsng "Shopware Knowledge YouTube Channel")
* [![Twitter](/build/images/social-media/icon-tw.b50c68de.svg)](https://twitter.com/shopwareDevs "Shopware Developer Twitter Channel")
* [![GitHub](/build/images/social-media/icon-gh.39a3c8c9.svg)](https://github.com/shopware "Shopware GitHub")
* [![Slack](/build/images/social-media/icon-sl.dea81964.svg)](https://slack.shopware.com/ "Shopware Community on Slack")

* [Shopware 6](/en/shopware-6-en "Shopware 6 - Users")
* [Shopware 6Developers](https://developer.shopware.com/)
* [Shopware 5](/en/shopware-5-en "Shopware 5 - Users")
* [Shopware 5Developers](https://developers.shopware.com/ "Shopware 5 - Developers")
* [Account](/en/shopware-account-en "Shopware Account")

* [Shopware 6 - Users](/en/shopware-6-en "Shopware 6 - Users")* [Getting Started](/en/shopware-6-en/getting-started "Getting Started")
  * [Migration](/en/migration-en "Migration")
  * [Features](/en/shopware-6-en/features "Features")
  * [Configuration](/en/shopware-6-en/configuration "Configuration")
  * [Shopware in the cloud](/en/shopware-6-en/in-the-cloud "Shopware in the cloud")
  * [Shopware Extensions](/en/shopware-6-en/extensions "Shopware Extensions")
  * [Commercial Features](/en/shopware-6-en/features/commercial "Commercial Features")
  * [Spatial Commerce](/en/shopware-6-en/spatial-commerce "Spatial Commerce")
  * [Tutorials & FAQs](/en/shopware-6-en/tutorials-and-faq "Tutorials & FAQs")
  * [Update Guides](/en/shopware-6-en/update-guides "Update Guides")
  * [Security Updates](/en/security-updates "Security Updates")
    + [Security Update 01/2024](/en/shopware-6-en/security-updates/security-update-01-2024?category=security-updates "Security Update 01/2024")
    + [Security Update 07/2023](/en/shopware-6-en/security-updates/security-update-07-2023?category=security-updates "Security Update 07/2023")
    + [Security Update 05/2023](/en/shopware-6-en/security-updates/security-update-05-2023?category=security-updates "Security Update 05/2023")
    + [Security Update 04/2023](/en/shopware-6-en/security-updates/security-update-04-2023?category=security-updates "Security Update 04/2023")
    + [Security Update 01/2023](/en/shopware-6-en/security-updates/security-update-01-2023?category=security-updates "Security Update 01/2023")
    + [Security Update 10/2022](/en/shopware-6-en/security-updates/security-update-10-2022?category=security-updates "Security Update 10/2022")
    + [Security Update 04/2022](/en/shopware-6-en/security-updates/security-update-04-2022?category=security-updates "Security Update 04/2022")
    + [Security Update 03/2022](/en/shopware-6-en/security-updates/security-update-03-2022?category=security-updates "Security Update 03/2022")
    + [Security Update 02/2022](/en/shopware-6-en/security-updates/security-update-02-2022?category=security-updates "Security Update 02/2022")
    + [Security Update 11/2021](/en/shopware-6-en/security-updates/security-update-11-2021?category=security-updates "Security Update 11/2021")
    + [Security Update 08/2021](/en/shopware-6-en/security-updates/security-update-08-2021?category=security-updates "Security Update 08/2021")
    + [Security Update 24/06/2021](/en/shopware-6-en/security-updates/security-update-24-06-2021?category=security-updates "Security Update 24/06/2021")
    + [Security Update 06/2021](/en/shopware-6-en/security-updates/security-update-06-2021?category=security-updates "Security Update 06/2021")
    + [Security Update 04/2021](/en/shopware-6-en/security-updates/security-update-04-2021?category=security-updates "Security Update 04/2021")
    + [Security Update 03/2021](/en/shopware-6-en/security-updates/security-update-03-2021?category=security-updates "Security Update 03/2021")
    + [Security Update 02/2021](/en/shopware-6-en/security-updates/security-update-02-2021?category=security-updates "Security Update 02/2021")
    + [Security Update 12/2020](/en/shopware-6-en/security-updates/security-update-12-2020?category=security-updates "Security Update 12/2020")
    + [Security Update 10/2020](/en/shopware-6-en/security-updates/security-update-10-2020?category=security-updates "Security Update 10/2020")
    + [Security Update 09/2020](/en/shopware-6-en/security-updates/security-update-09-2020?category=security-updates "Security Update 09/2020")
    + [Security Update 07/2020](/en/shopware-6-en/security-updates/security-update-07-2020?category=security-updates "Security Update 07/2020")
    + [Security Update 05/2020](/en/shopware-6-en/security-updates/security-update-05-2020?category=security-updates "Security Update 05/2020")
    + [Security Update 03/2020](/en/shopware-6-en/security-updates/security-update-03-2020?category=security-updates "Security Update 03/2020")
    + [Security Update 02/2020](/en/shopware-6-en/security-updates/security-update-02-2020?category=security-updates "Security Update 02/2020")
    + [Security Update 08/2019](/en/shopware-6-en/security-updates/security-update-08-2019?category=security-updates "Security Update 08/2019")

---

* [Shopware 6 - Developers](/en/shopware-platform-dev-en "Shopware 6 - Developers")
* [Shopware 5 - Users](/en/shopware-5-en "Shopware 5 - Users")
* [Shopware 5 - Developers](https://developers.shopware.com/ "Shopware 5 - Developers")
* [Shopware Account](/en/shopware-account-en "Shopware Account")

---

* [shopware.com](https://www.shopware.com/en/ "Shopware Website")
* [Blog](https://www.shopware.com/en/news/ "Shopware blog")
* [Company](https://www.shopware.com/en/company/ "Company")
* [Jobs](https://www.shopware.com/en/jobs/ "Jobs")
* [Contact](https://www.shopware.com/en/contact/ "Contact")
* [Account](https://account.shopware.com/?lang=en "Shopware Account")

* [Getting Started](/en/shopware-6-en/getting-started "Getting Started")
* [Migration](/en/migration-en "Migration")
* [Features](/en/shopware-6-en/features "Features")
* [Configuration](/en/shopware-6-en/configuration "Configuration")
* [Shopware in the cloud](/en/shopware-6-en/in-the-cloud "Shopware in the cloud")
* [Shopware Extensions](/en/shopware-6-en/extensions "Shopware Extensions")
* [Commercial Features](/en/shopware-6-en/features/commercial "Commercial Features")
* [Spatial Commerce](/en/shopware-6-en/spatial-commerce "Spatial Commerce")
* [Tutorials & FAQs](/en/shopware-6-en/tutorials-and-faq "Tutorials & FAQs")
* [Update Guides](/en/shopware-6-en/update-guides "Update Guides")
* [Security Updates](/en/security-updates "Security Updates")
  + [Security Update 01/2024](/en/shopware-6-en/security-updates/security-update-01-2024?category=security-updates "Security Update 01/2024")
  + [Security Update 07/2023](/en/shopware-6-en/security-updates/security-update-07-2023?category=security-updates "Security Update 07/2023")
  + [Security Update 05/2023](/en/shopware-6-en/security-updates/security-update-05-2023?category=security-updates "Security Update 05/2023")
  + [Security Update 04/2023](/en/shopware-6-en/security-updates/security-update-04-2023?category=security-updates "Security Update 04/2023")
  + [Security Update 01/2023](/en/shopware-6-en/security-updates/security-update-01-2023?category=security-updates "Security Update 01/2023")
  + [Security Update 10/2022](/en/shopware-6-en/security-updates/security-update-10-2022?category=security-updates "Security Update 10/2022")
  + [Security Update 04/2022](/en/shopware-6-en/security-updates/security-update-04-2022?category=security-updates "Security Update 04/2022")
  + [Security Update 03/2022](/en/shopware-6-en/security-updates/security-update-03-2022?category=security-updates "Security Update 03/2022")
  + [Security Update 02/2022](/en/shopware-6-en/security-updates/security-update-02-2022?category=security-updates "Security Update 02/2022")
  + [Security Update 11/2021](/en/shopware-6-en/security-updates/security-update-11-2021?category=security-updates "Security Update 11/2021")
  + [Security Update 08/2021](/en/shopware-6-en/security-updates/security-update-08-2021?category=security-updates "Security Update 08/2021")
  + [Security Update 24/06/2021](/en/shopware-6-en/security-updates/security-update-24-06-2021?category=security-updates "Security Update 24/06/2021")
  + [Security Update 06/2021](/en/shopware-6-en/security-updates/security-update-06-2021?category=security-updates "Security Update 06/2021")
  + [Security Update 04/2021](/en/shopware-6-en/security-updates/security-update-04-2021?category=security-updates "Security Update 04/2021")
  + [Security Update 03/2021](/en/shopware-6-en/security-updates/security-update-03-2021?category=security-updates "Security Update 03/2021")
  + [Security Update 02/2021](/en/shopware-6-en/security-updates/security-update-02-2021?category=security-updates "Security Update 02/2021")
  + [Security Update 12/2020](/en/shopware-6-en/security-updates/security-update-12-2020?category=security-updates "Security Update 12/2020")
  + [Security Update 10/2020](/en/shopware-6-en/security-updates/security-update-10-2020?category=security-updates "Security Update 10/2020")
  + [Security Update 09/2020](/en/shopware-6-en/security-updates/security-update-09-2020?category=security-updates "Security Update 09/2020")
  + [Security Update 07/2020](/en/shopware-6-en/security-updates/security-update-07-2020?category=security-updates "Security Update 07/2020")
  + [Security Update 05/2020](/en/shopware-6-en/security-updates/security-update-05-2020?category=security-updates "Security Update 05/2020")
  + [Security Update 03/2020](/en/shopware-6-en/security-updates/security-update-03-2020?category=security-updates "Security Update 03/2020")
  + [Security Update 02/2020](/en/shopware-6-en/security-updates/security-update-02-2020?category=security-updates "Security Update 02/2020")
  + [Security Update 08/2019](/en/shopware-6-en/security-updates/security-update-08-2019?category=security-updates "Security Update 08/2019")
# Security Update 01/2023

## General Information

In this security release, we have resolved vulnerabilities of the threat level "critical" and "medium". Affected are all Shopware versions including 6.4.18.0. The following issues have been fixed with this security update:

NEXT-24667 - Remote code execution via Twig template functions.

NEXT-24679 - Logging data can contain sensitive information of password reset mails.

NEXT-24677 - Administration session is not cleared after long inactivity.

NEXT-23325 - Possibility to bypass selling limits within the checkout process.

NEXT-22891 - Newsletter route does not consider double-opt-in settings.

We recommend updating to the current version 6.4.18.1. You can update to 6.4.18.1 via the auto-updater or manually via the download package.
<https://www.shopware.com/en/download/#shopware-6>

For older versions, corresponding security measures are also available via the central security plugin for Shopware 6.
<https://store.shopware.com/en/detail/index/sArticle/518463/number/Swag136939272659>

#### Was this article helpful?

Rate
#### Version

6.1.0 - 6.4.18.0
## Contents

* [General Information](#general-information)
[Back to top](#start "Back to top")[![Shopware](https://assets.shopware.com/media/logos/shopware_logo_white.svg)](/en)

* [Legal notice](https://www.shopware.com/en/legal-notice/ "Legal notice")
* [Terms and Conditions](https://www.shopware.com/en/gtc/ "Terms and Conditions")
* [Developer newsletter](https://www.shopware.com/en/newsletter "Developer newsletter")
* [Shopware Website](https://www.shopware.com/en/ "Shopware Website")
* Cookie settings
[![YouTube](/build/images/social-media/icon-yt.6afa92ed.svg)](https://www.youtube.com/channel/UC-xCvUIPOXx6o4ZydnwIsng "Shopware Knowledge YouTube Channel")[![Twitter](/build/images/social-media/icon-tw.b50c68de.svg)](https://twitter.com/shopwareDevs "Shopware Developer Twitter Channel")[![GitHub](/build/images/social-media/icon-gh.39a3c8c9.svg)](https://github.com/shopware "Shopware GitHub")[![Slack](/build/images/social-media/icon-sl.dea81964.svg)](https://slack.shopware.com/ "Shopware Community on Slack")Copyright © shopware AG - All rights reserved

=== Content from github.com_8ff72277_20250115_081610.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshopware%2Fshopware%2Fcommit%2Fcd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshopware%2Fshopware%2Fcommit%2Fcd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=shopware%2Fshopware)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[shopware](/shopware)
/
**[shopware](/shopware/shopware)**
Public

* [Notifications](/login?return_to=%2Fshopware%2Fshopware) You must be signed in to change notification settings
* [Fork
  1k](/login?return_to=%2Fshopware%2Fshopware)
* [Star
   2.9k](/login?return_to=%2Fshopware%2Fshopware)

* [Code](/shopware/shopware)
* [Issues
  783](/shopware/shopware/issues)
* [Pull requests
  134](/shopware/shopware/pulls)
* [Discussions](/shopware/shopware/discussions)
* [Actions](/shopware/shopware/actions)
* [Projects
  0](/shopware/shopware/projects)
* [Security](/shopware/shopware/security)
* [Insights](/shopware/shopware/pulse)

Additional navigation options

* [Code](/shopware/shopware)
* [Issues](/shopware/shopware/issues)
* [Pull requests](/shopware/shopware/pulls)
* [Discussions](/shopware/shopware/discussions)
* [Actions](/shopware/shopware/actions)
* [Projects](/shopware/shopware/projects)
* [Security](/shopware/shopware/security)
* [Insights](/shopware/shopware/pulse)

## Commit

[Permalink](/shopware/shopware/commit/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

NEXT-24677 - Limit admin session time

[Browse files](/shopware/shopware/tree/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6)
Browse the repository at this point in the history

* Loading branch information

[![@seggewiss](https://avatars.githubusercontent.com/u/39218577?s=40&v=4)](/seggewiss)

[seggewiss](/shopware/shopware/commits?author=seggewiss "View all commits by seggewiss")
committed
Jan 3, 2023

1 parent
[7619007](/shopware/shopware/commit/7619007aa88e9f389290ac006b3afda33bb10f79)

commit cd7a89c

 Show file tree

 Hide file tree

Showing
**14 changed files**
with
**134 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* changelog/\_unreleased

  + changelog/\_unreleased/2022-12-29-implement-logout-for-inactive-users.md
    [2022-12-29-implement-logout-for-inactive-users.md](#diff-3fa9e8da129fc8ec5c67ef624cca2f2ff0dd7cece38d55f24111a06f77c0ee48)
* src/Administration/Resources/app/administration/src

  + app

    - component

      * structure/sw-admin

        + src/Administration/Resources/app/administration/src/app/component/structure/sw-admin/index.js
          [index.js](#diff-fc28ffb5dfbe5da5761db71c46d417d82433799d2a7e02b06e12029e329b8605)
        + src/Administration/Resources/app/administration/src/app/component/structure/sw-admin/sw-admin.html.twig
          [sw-admin.html.twig](#diff-7064eb4b25fe9b3c9705b286f10c5e1f08fb94e0023f4788d2daa22cbc4657db)
      * utils/sw-progress-bar

        + src/Administration/Resources/app/administration/src/app/component/utils/sw-progress-bar/index.js
          [index.js](#diff-f0e8067eb286d5b14f44f703daccf0ee61a1b9fb55a274625f9053d9c0487a00)
    - src/Administration/Resources/app/administration/src/app/main.ts
      [main.ts](#diff-7201b4a5ccf48d0520a33ea4e9e81d491360355afcad50001e936741bfc0a673)
    - service

      * src/Administration/Resources/app/administration/src/app/service/user-activity.service.spec.ts
        [user-activity.service.spec.ts](#diff-b586f6d6bac7eb622802240774aa3780b08875539bb9593b2f480afe101c9295)
      * src/Administration/Resources/app/administration/src/app/service/user-activity.service.ts
        [user-activity.service.ts](#diff-46c48df4fca800fd4a7bc5dbd218c57db51401ebbe7415d3afad1ab39c58e4db)
    - state

      * src/Administration/Resources/app/administration/src/app/state/context.store.ts
        [context.store.ts](#diff-9907eef8ac4713536db91e8c279ee0d9332fa6c4992944ca7e1c16bfc208208f)
  + core

    - factory

      * src/Administration/Resources/app/administration/src/core/factory/app-context.factory.js
        [app-context.factory.js](#diff-eaeea42782d3441d3890ef218dfdb17798f7fdb299d6438d0a6c0f7664ef77ee)
      * src/Administration/Resources/app/administration/src/core/factory/router.factory.js
        [router.factory.js](#diff-84bf351376135e221ce34242567b184a9f2866f9f8650d84e59a0a2f54cb8f28)
    - service

      * src/Administration/Resources/app/administration/src/core/service/login.service.spec.js
        [login.service.spec.js](#diff-c165a35b429e8b5effab66c0418bbbea27afe4fe5ae9b66d6d07e64a066b2460)
      * src/Administration/Resources/app/administration/src/core/service/login.service.ts
        [login.service.ts](#diff-1aa037d400a774eb23af11a1a995a0e3bca65e69b03a286c775f4d991d6b9950)
  + src/Administration/Resources/app/administration/src/global.types.ts
    [global.types.ts](#diff-7771e93fc6bb6f791782d447b4c86e0bf88c6bcd11a2d2979914709a1e081dbe)
  + module/sw-extension/component/sw-ratings/sw-extension-ratings-summary

    - src/Administration/Resources/app/administration/src/module/sw-extension/component/sw-ratings/sw-extension-ratings-summary/sw-extension-ratings-summary.spec.js
      [sw-extension-ratings-summary.spec.js](#diff-d1e6ae208f2a0b586823835ac21c05f9735d40387d013cb4bff2414fc901b675)

## There are no files selected for viewing

9 changes: 9 additions & 0 deletions

9
[changelog/\_unreleased/2022-12-29-implement-logout-for-inactive-users.md](#diff-3fa9e8da129fc8ec5c67ef624cca2f2ff0dd7cece38d55f24111a06f77c0ee48 "changelog/_unreleased/2022-12-29-implement-logout-for-inactive-users.md")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/changelog/_unreleased/2022-12-29-implement-logout-for-inactive-users.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,9 @@ |
|  |  | --- |
|  |  | title: Implement logout for inactive users |
|  |  | issue: NEXT-24677 |
|  |  | author: Sebastian Seggewiss |
|  |  | author\_email: s.seggewiss@shopware.com |
|  |  | author\_github: @seggewiss |
|  |  | --- |
|  |  | # Administration |
|  |  | \* Added 30-minute logout for inactive users |

8 changes: 8 additions & 0 deletions

8
[...Administration/Resources/app/administration/src/app/component/structure/sw-admin/index.js](#diff-fc28ffb5dfbe5da5761db71c46d417d82433799d2a7e02b06e12029e329b8605 "src/Administration/Resources/app/administration/src/app/component/structure/sw-admin/index.js")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/app/component/structure/sw-admin/index.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,6 +8,8 @@ const { Component } = Shopware; |
|  |  | Component.register('sw-admin', { |
|  |  | template, |
|  |  |  |
|  |  | inject: ['userActivityService'], |
|  |  |  |
|  |  | metaInfo() { |
|  |  | return { |
|  |  | title: this.$tc('global.sw-admin-menu.textShopwareAdmin'), |
| Expand All | | @@ -19,4 +21,10 @@ Component.register('sw-admin', { |
|  |  | return Shopware.Service('loginService').isLoggedIn(); |
|  |  | }, |
|  |  | }, |
|  |  |  |
|  |  | methods: { |
|  |  | onUserActivity: Shopware.Utils.debounce(function updateUserActivity() { |
|  |  | this.userActivityService.updateLastUserActivity(); |
|  |  | }, 5000), |
|  |  | }, |
|  |  | }); |

6 changes: 5 additions & 1 deletion

6
[...tion/Resources/app/administration/src/app/component/structure/sw-admin/sw-admin.html.twig](#diff-7064eb4b25fe9b3c9705b286f10c5e1f08fb94e0023f4788d2daa22cbc4657db "src/Administration/Resources/app/administration/src/app/component/structure/sw-admin/sw-admin.html.twig")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/app/component/structure/sw-admin/sw-admin.html.twig)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,10 @@ |
|  |  | <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks --> |
|  |  | {% block sw\_admin %} |
|  |  | <div id="app"> |
|  |  | <div |
|  |  | id="app" |
|  |  | @mousemove="onUserActivity" |
|  |  | @keyup="onUserActivity" |
|  |  | > |
|  |  | <sw-notifications ref="notifications" /> |
|  |  | <sw-duplicated-media-v2 v-if="isLoggedIn" /> |
|  |  | <router-view /> |
| Expand Down | |  |

8 changes: 8 additions & 0 deletions

8
[...inistration/Resources/app/administration/src/app/component/utils/sw-progress-bar/index.js](#diff-f0e8067eb286d5b14f44f703daccf0ee61a1b9fb55a274625f9053d9c0487a00 "src/Administration/Resources/app/administration/src/app/component/utils/sw-progress-bar/index.js")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/app/component/utils/sw-progress-bar/index.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,6 +15,8 @@ const { Component } = Shopware; |
|  |  | Component.register('sw-progress-bar', { |
|  |  | template, |
|  |  |  |
|  |  | inject: ['userActivityService'], |
|  |  |  |
|  |  | props: { |
|  |  | value: { |
|  |  | type: Number, |
| Expand Down  Expand Up | | @@ -47,4 +49,10 @@ Component.register('sw-progress-bar', { |
|  |  | }; |
|  |  | }, |
|  |  | }, |
|  |  |  |
|  |  | watch: { |
|  |  | value() { |
|  |  | this.userActivityService.updateLastUserActivity(); |
|  |  | }, |
|  |  | }, |
|  |  | }); |

4 changes: 4 additions & 0 deletions

4
[src/Administration/Resources/app/administration/src/app/main.ts](#diff-7201b4a5ccf48d0520a33ea4e9e81d491360355afcad50001e936741bfc0a673 "src/Administration/Resources/app/administration/src/app/main.ts")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/app/main.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -38,6 +38,7 @@ import ShopwareDiscountCampaignService from 'src/app/service/discount-campaign.s |
|  |  | import SearchRankingService from 'src/app/service/search-ranking.service'; |
|  |  | import SearchPreferencesService from 'src/app/service/search-preferences.service'; |
|  |  | import RecentlySearchService from 'src/app/service/recently-search.service'; |
|  |  | import UserActivityService from 'src/app/service/user-activity.service'; |
|  |  |  |
|  |  | /\*\* Import Feature \*/ |
|  |  | import Feature from 'src/core/feature'; |
| Expand Down  Expand Up | | @@ -186,4 +187,7 @@ Application |
|  |  | return new SearchPreferencesService({ |
|  |  | userConfigRepository: Shopware.Service('repositoryFactory').create('user\_config'), |
|  |  | }); |
|  |  | }) |
|  |  | .addServiceProvider('userActivityService', () => { |
|  |  | return new UserActivityService(); |
|  |  | }); |

22 changes: 22 additions & 0 deletions

22
[...Administration/Resources/app/administration/src/app/service/user-activity.service.spec.ts](#diff-b586f6d6bac7eb622802240774aa3780b08875539bb9593b2f480afe101c9295 "src/Administration/Resources/app/administration/src/app/service/user-activity.service.spec.ts")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/app/service/user-activity.service.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,22 @@ |
|  |  | import UserActivityService from './user-activity.service'; |
|  |  |  |
|  |  | describe('src/app/service/user-activity.service.ts', () => { |
|  |  | let service: UserActivityService | undefined; |
|  |  |  |
|  |  | beforeEach(() => { |
|  |  | service = new UserActivityService(); |
|  |  | }); |
|  |  |  |
|  |  | it('should instantiate', () => { |
|  |  | expect(service instanceof UserActivityService).toBe(true); |
|  |  | }); |
|  |  |  |
|  |  | it('should change last user activity', () => { |
|  |  | Shopware.Context.app.lastActivity = 0; |
|  |  | const date = new Date(); |
|  |  | const expectedResult = Math.round(+date / 1000); |
|  |  |  |
|  |  | service.updateLastUserActivity(date); |
|  |  | expect(Shopware.Context.app.lastActivity).toBe(expectedResult); |
|  |  | }); |
|  |  | }); |

12 changes: 12 additions & 0 deletions

12
[src/Administration/Resources/app/administration/src/app/service/user-activity.service.ts](#diff-46c48df4fca800fd4a7bc5dbd218c57db51401ebbe7415d3afad1ab39c58e4db "src/Administration/Resources/app/administration/src/app/service/user-activity.service.ts")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/app/service/user-activity.service.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,12 @@ |
|  |  | /\*\* |
|  |  | \* @private |
|  |  | \*/ |
|  |  | export default class UserActivityService { |
|  |  | updateLastUserActivity(date?: Date): void { |
|  |  | if (date === undefined) { |
|  |  | date = new Date(); |
|  |  | } |
|  |  |  |
|  |  | Shopware.Context.app.lastActivity = Math.round(+date / 1000); |
|  |  | } |
|  |  | } |

2 changes: 2 additions & 0 deletions

2
[src/Administration/Resources/app/administration/src/app/state/context.store.ts](#diff-9907eef8ac4713536db91e8c279ee0d9332fa6c4992944ca7e1c16bfc208208f "src/Administration/Resources/app/administration/src/app/state/context.store.ts")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/app/state/context.store.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,6 +35,7 @@ interface ContextState { |
|  |  | systemCurrencyISOCode: null | string, |
|  |  | systemCurrencyId: null | string, |
|  |  | disableExtensions: boolean, |
|  |  | lastActivity: number, |
|  |  | }, |
|  |  | api: { |
|  |  | apiPath: null | string, |
| Expand Down  Expand Up | | @@ -75,6 +76,7 @@ const ContextStore: Module<ContextState, VuexRootState> = { |
|  |  | systemCurrencyId: null, |
|  |  | systemCurrencyISOCode: null, |
|  |  | disableExtensions: false, |
|  |  | lastActivity: 0, |
|  |  | }, |
|  |  | api: { |
|  |  | apiPath: null, |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[src/Administration/Resources/app/administration/src/core/factory/app-context.factory.js](#diff-eaeea42782d3441d3890ef218dfdb17798f7fdb299d6438d0a6c0f7664ef77ee "src/Administration/Resources/app/administration/src/core/factory/app-context.factory.js")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/core/factory/app-context.factory.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -14,5 +14,11 @@ export default function createContext(context = {}) { |
|  |  | Shopware.State.commit('context/addAppValue', { key, value }); |
|  |  | }); |
|  |  |  |
|  |  | // set initial last activity to prevent immediate logout |
|  |  | Shopware.State.commit('context/addAppValue', { |
|  |  | key: 'lastActivity', |
|  |  | value: Math.round(+new Date() / 1000), |
|  |  | }); |
|  |  |  |
|  |  | return Shopware.Context.app; |
|  |  | } |

2 changes: 2 additions & 0 deletions

2
[src/Administration/Resources/app/administration/src/core/factory/router.factory.js](#diff-84bf351376135e221ce34242567b184a9f2866f9f8650d84e59a0a2f54cb8f28 "src/Administration/Resources/app/administration/src/core/factory/router.factory.js")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/core/factory/router.factory.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -83,6 +83,8 @@ export default function createRouter(Router, View, moduleFactory, LoginService) |
|  |  | const assetPath = getAssetPath(); |
|  |  |  |
|  |  | router.beforeEach((to, from, next) => { |
|  |  | Shopware.Context.app.lastActivity = Math.round(+new Date() / 1000); |
|  |  |  |
|  |  | setModuleFavicon(to, assetPath); |
|  |  | const loggedIn = LoginService.isLoggedIn(); |
|  |  | const tokenHandler = new Shopware.Helper.RefreshTokenHelper(); |
| Expand Down | |  |

28 changes: 28 additions & 0 deletions

28
[src/Administration/Resources/app/administration/src/core/service/login.service.spec.js](#diff-c165a35b429e8b5effab66c0418bbbea27afe4fe5ae9b66d6d07e64a066b2460 "src/Administration/Resources/app/administration/src/core/service/login.service.spec.js")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/core/service/login.service.spec.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -41,6 +41,7 @@ describe('core/service/login.service.js', () => { |
|  |  | }); |
|  |  |  |
|  |  | beforeEach(() => { |
|  |  | Shopware.Context.app.lastActivity = Math.round(+new Date() / 1000); |
|  |  | window.localStorage.removeItem('redirectFromLogin'); |
|  |  | document.cookie = ''; |
|  |  | }); |
| Expand Down  Expand Up | | @@ -331,6 +332,7 @@ describe('core/service/login.service.js', () => { |
|  |  |  |
|  |  | it('should start auto refresh the token after login', async () => { |
|  |  | jest.useFakeTimers(); |
|  |  | Shopware.Context.app.lastActivity = Math.round(+new Date() / 1000); |
|  |  |  |
|  |  | const { loginService, clientMock } = loginServiceFactory(); |
|  |  |  |
| Expand Down  Expand Up | | @@ -389,4 +391,30 @@ describe('core/service/login.service.js', () => { |
|  |  | const storage = loginService.getStorage(); |
|  |  | expect(storage instanceof CookieStorage).toBe(true); |
|  |  | }); |
|  |  |  |
|  |  | it('should logout inactive user', async () => { |
|  |  | // Current time in Seconds - 1501 to be one 1-second over the threshold |
|  |  | Shopware.Context.app.lastActivity = Math.round(+new Date() / 1000) - 1501; |
|  |  |  |
|  |  | const { loginService, clientMock } = loginServiceFactory(); |
|  |  | const logoutListener = jest.fn(); |
|  |  | loginService.addOnLogoutListener(logoutListener); |
|  |  |  |
|  |  | clientMock.onPost('/oauth/token') |
|  |  | .reply(200, { |
|  |  | token\_type: 'Bearer', |
|  |  | expires\_in: 600, |
|  |  | access\_token: 'aCcEsS\_tOkEn\_first', |
|  |  | refresh\_token: 'rEfReSh\_ToKeN\_first' |
|  |  | }); |
|  |  |  |
|  |  | await loginService.loginByUsername('admin', 'shopware'); |
|  |  |  |
|  |  | expect(clientMock.history.post[0]).toBeDefined(); |
|  |  | expect(clientMock.history.post[1]).toBeUndefined(); |
|  |  | expect(JSON.parse(clientMock.history.post[0].data).grant\_type).toEqual('password'); |
|  |  |  |
|  |  | expect(clientMock.history.post[1]).toBeUndefined(); |
|  |  | expect(logoutListener).toHaveBeenCalledTimes(1); |
|  |  | }); |
|  |  | }); |

20 changes: 20 additions & 0 deletions

20
[src/Administration/Resources/app/administration/src/core/service/login.service.ts](#diff-1aa037d400a774eb23af11a1a995a0e3bca65e69b03a286c775f4d991d6b9950 "src/Administration/Resources/app/administration/src/core/service/login.service.ts")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/core/service/login.service.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -242,13 +242,33 @@ export default function createLoginService( |
|  |  | clearTimeout(autoRefreshTokenTimeoutId); |
|  |  | } |
|  |  |  |
|  |  | if (lastActivityOverThreshold()) { |
|  |  | logout(); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | const timeUntilExpiry = expiryTimestamp \* 1000 - Date.now(); |
|  |  |  |
|  |  | autoRefreshTokenTimeoutId = setTimeout(() => { |
|  |  | void refreshToken(); |
|  |  | }, timeUntilExpiry / 2); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Returns true if the last user activity is over the 30-minute threshold |
|  |  | \* |
|  |  | \* @private |
|  |  | \*/ |
|  |  | function lastActivityOverThreshold(): boolean { |
|  |  | const lastActivity = Shopware.Context.app.lastActivity; |
|  |  |  |
|  |  | // (Current time in seconds) - 25 minutes |
|  |  | // 25 minutes + half the 10-minute expiry = 30 minute threshold |
|  |  | const threshold = Math.round(+new Date() / 1000) - 1500; |
|  |  |  |
|  |  | return lastActivity <= threshold; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Returns saved bearer authentication object. Either you're getting the full object or when you're specifying |
|  |  | \* the `section` argument and getting either the token or the expiry date. |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[src/Administration/Resources/app/administration/src/global.types.ts](#diff-7771e93fc6bb6f791782d447b4c86e0bf88c6bcd11a2d2979914709a1e081dbe "src/Administration/Resources/app/administration/src/global.types.ts")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/global.types.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,6 +15,7 @@ import type ExtensionSdkService from 'src/core/service/api/extension-sdk.service |
|  |  | import type CartStoreService from 'src/core/service/api/cart-store-api.api.service'; |
|  |  | import type CustomSnippetApiService from 'src/core/service/api/custom-snippet.api.service'; |
|  |  | import type LocaleFactory from 'src/core/factory/locale.factory'; |
|  |  | import type UserActivityService from 'src/app/service/user-activity.service'; |
|  |  | import type { ExtensionsState } from './app/state/extensions.store'; |
|  |  | import type { ComponentConfig } from './core/factory/component.factory'; |
|  |  | import type { TabsState } from './app/state/tabs.store'; |
| Expand Down  Expand Up | | @@ -139,6 +140,7 @@ declare global { |
|  |  | appModulesService: AppModulesService, |
|  |  | cartStoreService: CartStoreService, |
|  |  | customSnippetApiService: CustomSnippetApiService, |
|  |  | userActivityService: UserActivityService, |
|  |  | } |
|  |  | // eslint-disable-next-line @typescript-eslint/no-empty-interface |
|  |  | interface InitContainer extends SubContainer<'init'>{ |
| Expand Down | |  |

7 changes: 6 additions & 1 deletion

7
[...on/component/sw-ratings/sw-extension-ratings-summary/sw-extension-ratings-summary.spec.js](#diff-d1e6ae208f2a0b586823835ac21c05f9735d40387d013cb4bff2414fc901b675 "src/Administration/Resources/app/administration/src/module/sw-extension/component/sw-ratings/sw-extension-ratings-summary/sw-extension-ratings-summary.spec.js")

Show comments

[View file](/shopware/shopware/blob/cd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6/src/Administration/Resources/app/administration/src/module/sw-extension/component/sw-ratings/sw-extension-ratings-summary/sw-extension-ratings-summary.spec.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -22,7 +22,12 @@ describe('src/module/sw-extension/component/sw-ratings/sw-extension-ratings-summ |
|  |  | stubs: { |
|  |  | 'sw-extension-rating-stars': true, |
|  |  | 'sw-progress-bar': await Shopware.Component.build('sw-progress-bar') |
|  |  | } |
|  |  | }, |
|  |  | provide: { |
|  |  | userActivityService: { |
|  |  | updateLastUserActivity: () => {}, |
|  |  | }, |
|  |  | }, |
|  |  | }); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `cd7a89c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshopware%2Fshopware%2Fcommit%2Fcd7a89cbcd3a0428c6d1ef27b3aa15467a722ff6) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


