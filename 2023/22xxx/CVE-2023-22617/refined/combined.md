=== Content from www.openwall.com_8e2e16a3_20250114_221353.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2023/01/19/1) [[next>]](../../../2023/01/21/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1295588158.7348.1674217183817@appsuite-guard.open-xchange.com>
Date: Fri, 20 Jan 2023 13:19:43 +0100 (CET)
From: Otto Moerbeek <otto.moerbeek@...erdns.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: Security Advisory 2023-01 for PowerDNS Recursor 4.8.0
 (CVE-2023-22617)

Hello,

   Today we have released PowerDNS Recursor 4.8.1 due to a high severity
   issue found.

   Please find the full text of the advisory below.

   The [1]changelog is available.

   The [2]tarball ([3]signature) is available from our download [4]server.
   Patches are available at [5]patches. Packages for various distributions
   are available from our [6]repository.

   Note that PowerDNS Recursor 4.5.x and older releases are End of Life.
   Consult the [7]EOL policy for more details.
     __________________________________________________________________

PowerDNS Security Advisory 2023-01: unbounded recursion results in program
termination

     * CVE: CVE-2023-22617
     * Date: 20th of January 2023
     * Affects: PowerDNS Recursor 4.8.0
     * Not affected: PowerDNS Recursor < 4.8.0, PowerDNS Recursor 4.8.1
     * Severity: High
     * Impact: Denial of service
     * Exploit: This problem can be triggered by a remote attacker with
       access to the recursor by querying names from specific
       mis-configured domains
     * Risk of system compromise: None
     * Solution: Upgrade to patched version

   CVSS 3.0 score: 8.2 (High)
   <https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/>
   S:U/C:N/I:L/A:H/E:H/RL:U/RC:C

   Thanks to applied-privacy.net for reporting this issue and their assistance in diagnosing it.

References

   1. <https://docs.powerdns.com/recursor/changelog/4.8.html#change-4.8.1>
   2. <https://downloads.powerdns.com/releases/pdns-recursor-4.8.1.tar.bz2>
   3. <https://downloads.powerdns.com/releases/pdns-recursor-4.8.1.tar.bz2.sig>
   4. <https://downloads.powerdns.com/releases/>
   5. <https://downloads.powerdns.com/patches/2023-01/>
   6. <https://repo.powerdns.com/>
   7. <https://docs.powerdns.com/recursor/appendices/EOL.html>

--

kind regards,
Otto Moerbeek
PowerDNS Developer

Email: otto.moerbeek@...n-xchange.com

-------------------------------------------------------------------------------------
Open-Xchange AG, Hohenzollernring 72, 50672 Cologne, District Court Cologne HRB 95366
Managing Board: Andreas Gauger, Dirk Valbert, Frank Hoberg, Stephan Martin
Chairman of the Board: Richard Seibt

PowerDNS.COM BV, Koninginnegracht 14L, 2514 AA Den Haag, The Netherlands
Managing Director: Robert Brandt, Maxim Letski
-------------------------------------------------------------------------------------

Download attachment "[signature.asc](1/1)" of type "application/pgp-signature" (476 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from docs.powerdns.com_dc4b6e98_20250114_221354.html ===

### Navigation

* [index](../genindex.html "General Index")
* [routing table](../http-routingtable.html "HTTP Routing Table") |
* [next](powerdns-advisory-2006-01.html "PowerDNS Security Advisory 2006-01: Malformed TCP queries can lead to a buffer overflow which might be exploitable") |
* [previous](../security.html "Security of the PowerDNS Recursor") |
* [PowerDNS Recursor documentation](../indexTOC.html) »

[PowerDNS Recursor](../indexTOC.html)

#### Previous topic

[Security of the PowerDNS Recursor](../security.html "previous chapter")

#### Next topic

[PowerDNS Security Advisory 2006-01: Malformed TCP queries can lead to a buffer overflow which might be exploitable](powerdns-advisory-2006-01.html "next chapter")

## Contents

* [Introduction](../index.html)
* [Getting Started](../getting-started.html)
* [Operating PowerDNS Recursor](../running.html)
* [DNSSEC in the PowerDNS Recursor](../dnssec.html)
* [PowerDNS Recursor Settings](../settings.html)
* [PowerDNS Recursor New Style (YAML) Settings](../yamlsettings.html)
* [Advanced Configuration Using Lua](../lua-config/index.html)
* [Scripting PowerDNS Recursor](../lua-scripting/index.html)
* [DNS64 support](../dns64.html)
* [Metrics and Statistics](../metrics.html)
* [Performance Guide](../performance.html)
* [Manual Pages](../manpages/index.html)
* [Built-in Webserver and HTTP API](../http-api/index.html)
* [Security of the PowerDNS Recursor](../security.html)
* Security Advisories
  + [PowerDNS Security Advisory 2024-04: Crafted responses can lead to a denial of service due to cache inefficiencies in the Recursor](powerdns-advisory-2024-04.html)
  + [PowerDNS Security Advisory 2024-02: if recursive forwarding is configured, crafted responses can lead to a denial of service in Recursor](powerdns-advisory-2024-02.html)
  + [PowerDNS Security Advisory 2024-01: crafted DNSSEC records in a zone can lead to a denial of service in Recursor](powerdns-advisory-2024-01.html)
  + [PowerDNS Security Advisory 2023-02: Deterred spoofing attempts can lead to authoritative servers being marked unavailable](powerdns-advisory-2023-02.html)
  + [PowerDNS Security Advisory 2023-01: unbounded recursion results in program termination](powerdns-advisory-2023-01.html)
  + [PowerDNS Security Advisory 2022-02: incomplete exception handling related to protobuf message generation](powerdns-advisory-2022-02.html)
  + [PowerDNS Security Advisory 2022-01: incomplete validation of incoming IXFR transfer in Authoritative Server and Recursor](powerdns-advisory-2022-01.html)
  + [PowerDNS Security Advisory 2020-07: Cache pollution](powerdns-advisory-2020-07.html)
  + [PowerDNS Security Advisory 2020-04: Access restriction bypass](powerdns-advisory-2020-04.html)
  + [PowerDNS Security Advisory 2020-03: Information disclosure](powerdns-advisory-2020-03.html)
  + [PowerDNS Security Advisory 2020-02: Insufficient validation of DNSSEC signatures](powerdns-advisory-2020-02.html)
  + [PowerDNS Security Advisory 2020-01: Denial of Service](powerdns-advisory-2020-01.html)
  + [PowerDNS Security Advisory 2019-02: Insufficient validation of DNSSEC signatures](powerdns-advisory-2019-02.html)
  + [PowerDNS Security Advisory 2019-01: Lua hooks are not applied in certain configurations](powerdns-advisory-2019-01.html)
  + [PowerDNS Security Advisory 2018-09: Crafted query can cause a denial of service](powerdns-advisory-2018-09.html)
  + [PowerDNS Security Advisory 2018-07: Crafted query for meta-types can cause a denial of service](powerdns-advisory-2018-07.html)
  + [PowerDNS Security Advisory 2018-06: Packet cache pollution via crafted query](powerdns-advisory-2018-06.html)
  + [PowerDNS Security Advisory 2018-04: Crafted answer can cause a denial of service](powerdns-advisory-2018-04.html)
  + [PowerDNS Security Advisory 2018-01: Insufficient validation of DNSSEC signatures](powerdns-advisory-2018-01.html)
  + [PowerDNS Security Advisory 2017-08: Crafted CNAME answer can cause a denial of service](powerdns-advisory-2017-08.html)
  + [PowerDNS Security Advisory 2017-07: Memory leak in DNSSEC parsing](powerdns-advisory-2017-07.html)
  + [PowerDNS Security Advisory 2017-06: Configuration file injection in the API](powerdns-advisory-2017-06.html)
  + [PowerDNS Security Advisory 2017-05: Cross-Site Scripting in the web interface](powerdns-advisory-2017-05.html)
  + [PowerDNS Security Advisory 2017-03: Insufficient validation of DNSSEC signatures](powerdns-advisory-2017-03.html)
  + [PowerDNS Security Advisory 2016-04: Insufficient validation of TSIG signatures](powerdns-advisory-2016-04.html)
  + [PowerDNS Security Advisory 2016-02: Crafted queries can cause abnormal CPU usage](powerdns-advisory-2016-02.html)
  + [PowerDNS Security Advisory 2015-01: Label decompression bug can cause crashes or CPU spikes](powerdns-advisory-2015-01.html)
  + [PowerDNS Security Advisory 2014-02: PowerDNS Recursor 3.6.1 and earlier can be made to provide bad service](powerdns-advisory-2014-02.html)
  + [PowerDNS Security Advisory 2014-01: PowerDNS Recursor 3.6.0 can be crashed remotely](powerdns-advisory-2014-01.html)
  + [PowerDNS Security Advisory 2010-02: PowerDNS Recursor up to and including 3.1.7.1 can be spoofed into accepting bogus data](powerdns-advisory-2010-02.html)
  + [PowerDNS Security Advisory 2010-01: PowerDNS Recursor up to and including 3.1.7.1 can be brought down and probably exploited](powerdns-advisory-2010-01.html)
  + [PowerDNS Security Advisory 2008-01: System random generator can be predicted, leading to the potential to âspoofâ PowerDNS Recursor](powerdns-advisory-2008-01.html)
  + [PowerDNS Security Advisory 2006-02: Zero second CNAME TTLs can make PowerDNS exhaust allocated stack space, and crash](powerdns-advisory-2006-02.html)
  + [PowerDNS Security Advisory 2006-01: Malformed TCP queries can lead to a buffer overflow which might be exploitable](powerdns-advisory-2006-01.html)
  + [Older security advisories](#older-security-advisories)
* [Upgrade Guide](../upgrade.html)
* [Changelogs](../changelog/index.html)
* [Newly Observed Domain Tracking](../nod_udr.html)
* [Unique Domain Response](../nod_udr.html#unique-domain-response)
* [End of life statements](../appendices/EOL.html)
* [Frequently Asked Questions](../appendices/FAQ.html)
* [Compiling **PowerDNS Recursor**](../appendices/compiling.html)
* [Cryptographic software and export control](../appendices/crypto-export.html)
* [Internals of the PowerDNS Recursor](../appendices/internals.html)
* [Structured Logging Dictionary](../appendices/structuredlogging.html)
* [Conversion of old-style settings to YAML format](../appendices/yamlconversion.html)
* [PowerDNS/dnsdist license](../common/license.html)

### This Page

* [Show Source](../_sources/security-advisories/index.rst.txt)

1. [Docs](../indexTOC.html)
2. Security Advisories

# Security Advisories[Â¶](#security-advisories "Permalink to this headline")

All security advisories for the PowerDNS Recursor are listed here.

* [PowerDNS Security Advisory 2024-04: Crafted responses can lead to a denial of service due to cache inefficiencies in the Recursor](powerdns-advisory-2024-04.html)
* [PowerDNS Security Advisory 2024-02: if recursive forwarding is configured, crafted responses can lead to a denial of service in Recursor](powerdns-advisory-2024-02.html)
* [PowerDNS Security Advisory 2024-01: crafted DNSSEC records in a zone can lead to a denial of service in Recursor](powerdns-advisory-2024-01.html)
* [PowerDNS Security Advisory 2023-02: Deterred spoofing attempts can lead to authoritative servers being marked unavailable](powerdns-advisory-2023-02.html)
* [PowerDNS Security Advisory 2023-01: unbounded recursion results in program termination](powerdns-advisory-2023-01.html)
* [PowerDNS Security Advisory 2022-02: incomplete exception handling related to protobuf message generation](powerdns-advisory-2022-02.html)
* [PowerDNS Security Advisory 2022-01: incomplete validation of incoming IXFR transfer in Authoritative Server and Recursor](powerdns-advisory-2022-01.html)
* [PowerDNS Security Advisory 2020-07: Cache pollution](powerdns-advisory-2020-07.html)
* [PowerDNS Security Advisory 2020-04: Access restriction bypass](powerdns-advisory-2020-04.html)
* [PowerDNS Security Advisory 2020-03: Information disclosure](powerdns-advisory-2020-03.html)
* [PowerDNS Security Advisory 2020-02: Insufficient validation of DNSSEC signatures](powerdns-advisory-2020-02.html)
* [PowerDNS Security Advisory 2020-01: Denial of Service](powerdns-advisory-2020-01.html)
* [PowerDNS Security Advisory 2019-02: Insufficient validation of DNSSEC signatures](powerdns-advisory-2019-02.html)
* [PowerDNS Security Advisory 2019-01: Lua hooks are not applied in certain configurations](powerdns-advisory-2019-01.html)
* [PowerDNS Security Advisory 2018-09: Crafted query can cause a denial of service](powerdns-advisory-2018-09.html)
* [PowerDNS Security Advisory 2018-07: Crafted query for meta-types can cause a denial of service](powerdns-advisory-2018-07.html)
* [PowerDNS Security Advisory 2018-06: Packet cache pollution via crafted query](powerdns-advisory-2018-06.html)
* [PowerDNS Security Advisory 2018-04: Crafted answer can cause a denial of service](powerdns-advisory-2018-04.html)
* [PowerDNS Security Advisory 2018-01: Insufficient validation of DNSSEC signatures](powerdns-advisory-2018-01.html)
* [PowerDNS Security Advisory 2017-08: Crafted CNAME answer can cause a denial of service](powerdns-advisory-2017-08.html)
* [PowerDNS Security Advisory 2017-07: Memory leak in DNSSEC parsing](powerdns-advisory-2017-07.html)
* [PowerDNS Security Advisory 2017-06: Configuration file injection in the API](powerdns-advisory-2017-06.html)
* [PowerDNS Security Advisory 2017-05: Cross-Site Scripting in the web interface](powerdns-advisory-2017-05.html)
* [PowerDNS Security Advisory 2017-03: Insufficient validation of DNSSEC signatures](powerdns-advisory-2017-03.html)
* [PowerDNS Security Advisory 2016-04: Insufficient validation of TSIG signatures](powerdns-advisory-2016-04.html)
* [PowerDNS Security Advisory 2016-02: Crafted queries can cause abnormal CPU usage](powerdns-advisory-2016-02.html)
* [PowerDNS Security Advisory 2015-01: Label decompression bug can cause crashes or CPU spikes](powerdns-advisory-2015-01.html)
* [PowerDNS Security Advisory 2014-02: PowerDNS Recursor 3.6.1 and earlier can be made to provide bad service](powerdns-advisory-2014-02.html)
* [PowerDNS Security Advisory 2014-01: PowerDNS Recursor 3.6.0 can be crashed remotely](powerdns-advisory-2014-01.html)
* [PowerDNS Security Advisory 2010-02: PowerDNS Recursor up to and including 3.1.7.1 can be spoofed into accepting bogus data](powerdns-advisory-2010-02.html)
* [PowerDNS Security Advisory 2010-01: PowerDNS Recursor up to and including 3.1.7.1 can be brought down and probably exploited](powerdns-advisory-2010-01.html)
* [PowerDNS Security Advisory 2008-01: System random generator can be predicted, leading to the potential to âspoofâ PowerDNS Recursor](powerdns-advisory-2008-01.html)
* [PowerDNS Security Advisory 2006-02: Zero second CNAME TTLs can make PowerDNS exhaust allocated stack space, and crash](powerdns-advisory-2006-02.html)
* [PowerDNS Security Advisory 2006-01: Malformed TCP queries can lead to a buffer overflow which might be exploitable](powerdns-advisory-2006-01.html)

## Older security advisories[Â¶](#older-security-advisories "Permalink to this headline")

Version 3.0 of the PowerDNS recursor contains a denial of service bug which can be exploited remotely.
This bug, which we believe to only lead to a crash, has been fixed in 3.0.1.
There are no guarantees however, so an upgrade from 3.0 is highly recommended.

All versions of PowerDNS before 2.9.21.1 do not respond to certain queries.
This in itself is not a problem, but since the discovery by Dan Kaminsky of a new spoofing technique, this silence for queries PowerDNS considers invalid, within a valid domain, allows attackers more chances to feed *other* resolvers bad data.

All versions of PowerDNS before 2.9.18 contain the following two bugs, which only apply to installations running with the LDAP backend, or installations providing recursion to a limited range of IP addresses.
If any of these apply to you, an upgrade is highly advised:

* The LDAP backend did not properly escape all queries, allowing it to
  fail and not answer questions. We have not investigated further risks
  involved, but we advise LDAP users to update as quickly as possible
  (Norbert Sendetzky, Jan de Groot)
* Questions from clients denied recursion could blank out answers to
  clients who are allowed recursion services, temporarily. Reported by
  Wilco Baan. This wouldâve made it possible for outsiders to blank out
  a domain temporarily to your users. Luckily PowerDNS would send out
  SERVFAIL or Refused, and not a denial of a domainâs existence.

All versions of PowerDNS before 2.9.17 are known to suffer from remote denial of service problems which can disrupt operation.
Please upgrade to 2.9.17 as this page will only contain detailed security information from 2.9.17 onwards.

[Security of the PowerDNS Recursor](../security.html "previous chapter (use the left arrow)")

[PowerDNS Security Advisory 2006-01: Malformed TCP queries can lead to a buffer overflow which might be exploitable](powerdns-advisory-2006-01.html "next chapter (use the right arrow)")

### Navigation

* [index](../genindex.html "General Index")
* [routing table](../http-routingtable.html "HTTP Routing Table") |
* [next](powerdns-advisory-2006-01.html "PowerDNS Security Advisory 2006-01: Malformed TCP queries can lead to a buffer overflow which might be exploitable") |
* [previous](../security.html "Security of the PowerDNS Recursor") |
* [PowerDNS Recursor documentation](../indexTOC.html) »

© Copyright PowerDNS.COM BV. Created using [Sphinx](http://sphinx.pocoo.org/).


