```text
{
  "vulnerability_details": [
    {
      "root_cause": "The installer does not delete itself after successful installation. The setup process is divided into steps and an unauthenticated user can control the `$state` parameter to access certain setup steps. Specifically, attacker controlled database parameters in the `Installer` constructor are used in the `displayNewThemeDiv` method to make a database query. This leads to an unauthenticated arbitrary file read because a malicious MySQL server can request file contents via `LOAD DATA LOCAL INFILE`.",
      "weaknesses": [
        "Unauthenticated access to setup steps.",
        "Use of attacker-controlled database connection parameters.",
        "Reliance on `LOAD DATA LOCAL INFILE` with a potentially malicious server."
      ],
      "impact": "An unauthenticated remote attacker can read arbitrary files from the OpenEMR server, such as certificates, passwords, tokens, and backups.",
       "attack_vectors": [
          "Sending a crafted HTTP request to setup.php with attacker-controlled database parameters and a malicious MySQL server."
        ],
      "attacker_capabilities": "The attacker can send HTTP requests and control a MySQL server."
    },
    {
      "root_cause": "A combination of vulnerabilities allow remote code execution. A reflected XSS vulnerability in `interface/forms/eye_mag/php/eye_mag_functions.php` allows for the injection of arbitrary JavaScript code through the `REQUEST_URI`, due to the browser's rendering of HTML entities within event handlers. This is chained with an unauthenticated local file inclusion (LFI) vulnerability in `interface/forms/LBF/new.php`, where the user-controlled `formname` parameter is concatenated to a file path and included if the file exists. Finally, a file upload vulnerability in `interface/billing/edi_271.php` allows for uploading files with a `.plugin.php` extension.",
      "weaknesses": [
        "Reflected XSS via the REQUEST_URI parameter.",
        "Local File Inclusion vulnerability due to lack of sanitization of the `formname` parameter.",
        "Insecure file upload functionality with no extension validation."
      ],
      "impact": "An unauthenticated remote attacker can gain remote code execution on the OpenEMR server.",
      "attack_vectors": [
        "Crafted HTTP request to trigger reflected XSS in `eye_mag_functions.php`.",
        "File upload to `edi_271.php` with malicious PHP code as a `.plugin.php` file.",
        "Crafted HTTP request with a path traversal payload to trigger LFI in `new.php`."
      ],
       "attacker_capabilities": "The attacker can send HTTP requests, control a malicious MySQL server, and perform file uploads."
    }
  ]
}
```