- **Root cause of vulnerability**: The `change_hostname` function in `libzebra.so` constructs a command string using `snprintf` that includes the user-supplied hostname without proper sanitization. This allows for command injection when the constructed string is executed via the `system` call.

- **Weaknesses/vulnerabilities present**:
    - OS Command Injection (CWE-77): The `new_hostname` parameter in the `change_hostname` function is not sanitized, allowing an attacker to inject arbitrary commands into the string that is passed to the `system` function for execution.
    - Insufficient input validation: The `hostname_command` function only checks if the hostname starts with an alphabetic character, which is not sufficient to prevent command injection.

- **Impact of exploitation**:
    - Arbitrary command execution: An attacker can execute arbitrary OS commands on the device with the privileges of the running service, potentially leading to a complete compromise of the system.
    - Device compromise: As shown in the PoC, a simple reboot can be triggered, and more sophisticated commands can be injected for malicious purposes such as data exfiltration, malware installation or denial of service.

- **Attack vectors**:
    - Network access: The attacker needs network access to the device, either via telnet or SSH.
    - Interactive shell: The vulnerability can be exploited through the router's interactive shell once logged in with appropriate credentials.
    - Sequence of commands: The exploit involves sending a sequence of commands through the console, specifically using the `enable`, `configure terminal`, and `hostname` commands.

- **Required attacker capabilities/position**:
    - Network access to the device
    - Valid credentials to access the router's console via telnet or SSH
    - Ability to send commands through the interactive shell.