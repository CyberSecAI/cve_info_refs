=== Content from shibboleth.atlassian.net_7b4a4b58_20250114_201059.html ===


[![Custom Jira logo](/s/g2slup/b/0/f4712b4be2cf04fa8b6bf3ee00d3d60a/_/jira-logo-scaled.png)![Custom Jira icon](/s/g2slup/b/0/f4712b4be2cf04fa8b6bf3ee00d3d60a/_/jira-logo-scaled.png)](/jira)ProjectsFiltersDashboardsAppsCreateSearch[Sign in](/login.jsp)![](https://shibboleth.atlassian.net/rest/api/2/universal_avatar/view/type/project/avatar/10575?size=xxlarge)
## Shibboleth SP - C++

Software projectMenu[Reports](/projects/SSPCPP?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page)[Issues](/jira/software/c/projects/SSPCPP/issues)[Archived issuesNew](/jira/software/c/projects/SSPCPP/issues/archive)You're in a company-managed project![Loading...](data:image/svg+xml;base64...)



=== Content from shibboleth.atlassian.net_dd82e429_20250114_201100.html ===


[![Custom logo](/wiki/download/attachments/32773/atl.site.logo?version=2&modificationDate=1625679437670&cacheVersion=1&api=v2)![Custom icon](/wiki/download/attachments/32773/atl.site.logo?version=2&modificationDate=1625679437670&cacheVersion=1&api=v2)](/wiki)SpacesApps[Templates](/wiki/templates)Create[![](/wiki/download/attachments/32773/global.logo?version=1&modificationDate=1625679592127&cacheVersion=1&api=v2)
## Service Provider 3](/wiki/spaces/SP3/overview?homepageId=2058387896)

* [All content](/wiki/spaces/SP3/pages)
* [Space settings](/wiki/spaces/SP3/settings/home)

ContentResults will update as you type.

* [Configuration](/wiki/spaces/SP3/pages/2063695920/Configuration)
* [•Contributions and Extensions](/wiki/spaces/SP3/pages/2114781232/Contributions%2Band%2BExtensions)
* [Development Notes](/wiki/spaces/SP3/pages/2063696118/Development%2BNotes)
* [GeneralTopics](/wiki/spaces/SP3/pages/2065334312/GeneralTopics)
* [•How-to articles](/wiki/spaces/SP3/pages/2076410042/How-to%2Barticles)
* [HowToTopics](/wiki/spaces/SP3/pages/2065335386/HowToTopics)
* [Installation](/wiki/spaces/SP3/pages/2065335537/Installation)
  + [•InitialTesting](/wiki/spaces/SP3/pages/2067399891/InitialTesting)
  + [•Install on Windows](/wiki/spaces/SP3/pages/2065335545/Install%2Bon%2BWindows)
  + [LinuxInstall](/wiki/spaces/SP3/pages/2065335547/LinuxInstall)
  + [MacInstall](/wiki/spaces/SP3/pages/2065335546/MacInstall)
* [Productionalization](/wiki/spaces/SP3/pages/2065334322/Productionalization)
* [•ProtocolsAndInterfaces](/wiki/spaces/SP3/pages/2067400007/ProtocolsAndInterfaces)
* [•ReleaseNotes](/wiki/spaces/SP3/pages/2065335693/ReleaseNotes)
* [•SecurityAdvisories](/wiki/spaces/SP3/pages/2067399654/SecurityAdvisories)
* [•SystemRequirements](/wiki/spaces/SP3/pages/2067399657/SystemRequirements)
* [Troubleshooting](/wiki/spaces/SP3/pages/2065334299/Troubleshooting)
* [•UpgradingFromV2](/wiki/spaces/SP3/pages/2067400004/UpgradingFromV2)

[Service Provider 3](/wiki/spaces/SP3/overview?homepageId=2058387896)/[Installation](/wiki/spaces/SP3/pages/2065335537/Installation)/Install on WindowsSummarize
# Install on Windows

* ![](/wiki/aa-avatar/59fb32bbc24efb3c4ed3c977)Rod Widdowson
* ![](/wiki/aa-avatar/557058:5b78efc9-1379-42cc-a3f6-56c6ea3a0007)Scott Cantor
* ![](/wiki/aa-avatar/557058:8dc3f86f-c6fe-4d36-aff6-99fc70edc780)Mark Mark
* ![](/wiki/aa-avatar/557058:7c658942-74f0-42a9-b6dc-18975e5c9b23)Tom King
Owned by [Rod Widdowson](/wiki/people/59fb32bbc24efb3c4ed3c977?ref=confluence&src=profilecard)Last updated: [Jan 11, 2023](/wiki/pages/diffpagesbyversion.action?pageId=2065335545&selectedPageVersions=27&selectedPageVersions=28)5 min readLoading data...
### Missing VC runtime

If you encounter errors during the install or upgrade process that indicate the system can't start the shibd daemon/service process, it's likely that the installer is failing to install the Visual C++ runtime libraries for some reason, and you may have to pre-install those manually. At some point Microsoft is planning to make it impractical for us to redistribute these files with the installer, at which point this workaround is probably going to be universal.

These links may break at some point, but for now the 32-bit and 64-bit runtimes can be found at:

* [https://aka.ms/vs/15/release/VC\_redist.x86.exe](https://aka.ms/vs/15/release/VC_redist.x86.exe "https://aka.ms/vs/15/release/VC_redist.x86.exe")
* [https://aka.ms/vs/15/release/VC\_redist.x64.exe](https://aka.ms/vs/15/release/VC_redist.x64.exe "https://aka.ms/vs/15/release/VC_redist.x64.exe")

The top-level link to find them is [https://visualstudio.microsoft.com/downloads/](https://visualstudio.microsoft.com/downloads/ "https://visualstudio.microsoft.com/downloads/") via Other Tools.

* + 1.1 [Missing VC runtime](#Missing-VC-runtime)
* 2 [Installation](#Installation)
  + 2.1 [Restricting ACLs](#Restricting-ACLs)
* 3 [Upgrades](#Upgrades)
* 4 [Web Server Overview](#Web-Server-Overview)
  + 4.1 [Installation with IIS](#Installation-with-IIS)
  + 4.2 [Upgrades with IIS](#Upgrades-with-IIS)
  + 4.3 [Installation with Apache](#Installation-with-Apache)
  + 4.4 [Installation with Netscape/Sun/Oracle Java Web Server](#Installation-with-Netscape%2FSun%2FOracle-Java-Web-Server)
  + 4.5 [FastCGI Unsupported](#FastCGI-Unsupported)
* 5 [Running the Installer](#Running-the-Installer)
  + 5.1 [Shibboleth Service](#Shibboleth-Service)
  + 5.2 [Monitoring the Service](#Monitoring-the-Service)
  + 5.3 [Failure to Install](#Failure-to-Install)
    - 5.3.1 [Installing with no service start](#Installing-with-no-service-start)
    - 5.3.2 [Starting the Shibboleth Service from the command line](#Starting-the-Shibboleth-Service-from-the-command-line)
    - 5.3.3 [Windows batch file to run MSI installer by drag and drop](#Windows-batch-file-to-run-MSI-installer-by-drag-and-drop)
* 6 [Source Builds](#Source-Builds)
* 7 [Initial Testing](#Initial-Testing)
## Installation

The SP is available for Windows with modules for all the supported web servers. There is an installer available for the supported Windows Server versions, 2008 and above.

Earlier Windows and Service Pack versions are **not** usable as of V3.

Desktop versions of Windows that are of subsequent vintage will generally work but are not formally supported.

The Windows installer contains a fourth version field that indicates the patch level within a particular SP release. Initially 0, it will be incremented if patches to software included with but not part of the SP need to be updated (e.g., OpenSSL). Subsequent patch level installers will safely upgrade older versions and the [ReleaseNotes](/wiki/spaces/SP3/pages/2065335693 "/wiki/spaces/SP3/pages/2065335693") will always document exactly what library versions are included in each release.

### Restricting ACLs

Note that prior to V3.4.1, the installer did not adjust file system ACLs based on your install path. As of that version, we have added changes that are designed to provide full access to the administrative/system accounts and read access to the standard “Users” group.

Wherever you choose to install the software, you should consider reviewing and hardening the file and folder access to that location. Most of these folders and files should be read only. The daemon process runs by default as a system account and should already have the necessary access. You should if possible prevent all other access to the private key file(s) as those need not be readable by anything else, and you need not allow any writing of files, or creation of folders or files by any other users.

If you run your web server under a different user account (not a member of the `Administrators` or `Users` groups) you will need to adjust the rights if you limit read access, but the web server should not in general require any write access whatsoever to those folders or files, as in-process logging is now routed to the Event Log by default.

This can be achieved at install time by specifying the account (our group) on the command line setting the WEBSERVER\_USER property on the command line (see below)

## Upgrades

Upgrading to new releases is handled automatically when the MSI installer is used. The system prevents configuration files from being overwritten and skips "initial install" tasks like generating keys. The Shibboleth daemon is restarted by the package but you will need to restart the web server you're using yourself.

## Web Server Overview

### Installation with IIS

The plugin modules in support of IIS are always installed. If IIS itself is installed you will be prompted "Configure IIS7 module?".  Check this box to actually configure Shibboleth to run with IIS, in practice this can be done with two command.

See [this topic](/wiki/spaces/SP3/pages/2065335360 "/wiki/spaces/SP3/pages/2065335360") for details.

In contrast to older versions, no older IIS6 compatibility tools are needed.

### Upgrades with IIS

Existing installations configured to work with IIS will continue to do so, with the older ISAPI plugin updated. See [this topic](/wiki/spaces/SP3/pages/2060615835 "/wiki/spaces/SP3/pages/2060615835") for more details, particularly to migrating to the newer plugin.

### Installation with Apache

The versions of Apache available from the [http://www.apachelounge.com/](http://www.apachelounge.com/ "http://www.apachelounge.com/") web site are known to work with the modules that come with the SP package with no known restrictions.

Other versions might work, but they also might not work. Versions with significantly altered header files, such as IBM's or Oracle's will definitely not work unless you build the Shibboleth module from source.

Only Apache 2.2 and 2.4 are supported.

For more details on Apache see [this topic.](/wiki/spaces/SP3/pages/2065335062 "/wiki/spaces/SP3/pages/2065335062")

### Installation with Netscape/Sun/Oracle Java Web Server

An NSAPI module continues to be included as a transition tool for anybody still using it, but it is deprecated and we suggest moving off it as soon as possible.

### FastCGI Unsupported

As of V3, we no longer provide modules for FastCGI on Windows due to lack of formal support for the underlying FastCGI library.

## Running the Installer

The installer is run in the usual way and can be run without a UI.

The following properties can be set

| Property | Description |
| --- | --- |

| Property | Description |
| --- | --- |
| `KEYGEN_EXTRAS` | Allows extra parameters to be passed to the keygen command used during installation. For instance, `msiexec /i shibboleth-sp-3.0.0-win64.msi KEYGEN_EXTRAS="-h newSP.department.univerity.edu"` allows the addition of a subjectAltName in the generated certificate. |
| `ALWAYS_START_SERVICE` | Set this to `FALSE` to prevent the installer from starting the shibd service. This can be useful to debug installations (see below). |
| `WEBSERVER_USER` 3.4.1 | The name of a User or User group to be granted explicit read access to the installation tree. Use this if your web server runs under a restricted account. |

### Shibboleth Service

Once installation is complete, you'll need to run the Shibboleth daemon, `shibd`, at all times that the SP is in use. `shibd` is a console application that is usually installed as a Windows service.

* To run the process in console mode for testing or to diagnose major problems, supply a `-console` parameter when running it.
* If `shibd` won't start, use the `-check` option from the command line to echo most logging information to the console for debugging.

Other parameters can be used to install (or remove) `shibd` from the service database and subsequent control is generally via the Service Control Manager applet.

### Monitoring the Service

Newer versions of Windows support automatic restart of failed services. We suggest using this feature to restart shibd when it fails. Although stability is good, maximum reliability will be achieved by monitoring the process.

### Failure to Install

The most common reason for the installation failing is that the Shibboleth service (above) does not start correctly. First, refer to the note at the top of this page and rule that out. If that doesn't bear fruit, in order to debug this you can instruct the installer to **not** try to start the service by specifying that the  ALWAYS\_START\_SERVICE property contain the value FALSE.  Do this from the command line:

##### **Installing with no service start**

`c:\> msiexec /i Installer.msi ALWAYS_START_SERVICE=FALSE`

You can then use the`-check`option described above to debug why the service will not start. Usually the problem tends to be a DLL conflict with some existing copy of one of the libraries we ship, but we have generally worked around this risk by renaming all our libraries in ways that tend not to cause conflicts.

Once this is completed you can start the service manually.

##### **Starting the Shibboleth Service from the command line**

`c:\> sc start shibd_default`

In some situations attempting the installer may appear to do nothing when double-clicked, and if invoked with *msiexec /i* on the command line may throw the error "This installation package could not be opened. Verify that the package exists and that you can access it, or contact the application vendor to verify that this is a valid Windows Installer package." If this occurs, a viable workaround has found to be to create a new .bat file containing the msi install command listed below, and then drag the downloaded msi onto it.

##### **Windows batch file to run MSI installer by drag and drop**

## Source Builds

We do not recommend this option, but we have a [description](/wiki/spaces/SP3/pages/2060616478 "/wiki/spaces/SP3/pages/2060616478") of the process.

## Initial Testing

{"serverDuration": 12, "requestCorrelationId": "33570bd8e6634345b1e1dc75041901bd"}

