=== Content from packetstormsecurity.com_18cdf490_20250114_190730.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_c920b0fe_20250114_190732.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMrTuxracer%2Fadvisories%2Fblob%2Fmaster%2FCVEs%2FCVE-2023-22620.txt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMrTuxracer%2Fadvisories%2Fblob%2Fmaster%2FCVEs%2FCVE-2023-22620.txt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=MrTuxracer%2Fadvisories)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MrTuxracer](/MrTuxracer)
/
**[advisories](/MrTuxracer/advisories)**
Public

* [Notifications](/login?return_to=%2FMrTuxracer%2Fadvisories) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2FMrTuxracer%2Fadvisories)
* [Star
   32](/login?return_to=%2FMrTuxracer%2Fadvisories)

* [Code](/MrTuxracer/advisories)
* [Issues
  0](/MrTuxracer/advisories/issues)
* [Pull requests
  0](/MrTuxracer/advisories/pulls)
* [Actions](/MrTuxracer/advisories/actions)
* [Projects
  0](/MrTuxracer/advisories/projects)
* [Wiki](/MrTuxracer/advisories/wiki)
* [Security](/MrTuxracer/advisories/security)
* [Insights](/MrTuxracer/advisories/pulse)

Additional navigation options

* [Code](/MrTuxracer/advisories)
* [Issues](/MrTuxracer/advisories/issues)
* [Pull requests](/MrTuxracer/advisories/pulls)
* [Actions](/MrTuxracer/advisories/actions)
* [Projects](/MrTuxracer/advisories/projects)
* [Wiki](/MrTuxracer/advisories/wiki)
* [Security](/MrTuxracer/advisories/security)
* [Insights](/MrTuxracer/advisories/pulse)

## Files

 master
## Breadcrumbs

1. [advisories](/MrTuxracer/advisories/tree/master)
2. /[CVEs](/MrTuxracer/advisories/tree/master/CVEs)
/
# CVE-2023-22620.txt

Copy path Blame  Blame
## Latest commit

## History

[History](/MrTuxracer/advisories/commits/master/CVEs/CVE-2023-22620.txt)128 lines (99 loc) · 4.25 KB master
## Breadcrumbs

1. [advisories](/MrTuxracer/advisories/tree/master)
2. /[CVEs](/MrTuxracer/advisories/tree/master/CVEs)
/
# CVE-2023-22620.txt

Top
## File metadata and controls

* Code
* Blame

128 lines (99 loc) · 4.25 KB[Raw](https://github.com/MrTuxracer/advisories/raw/refs/heads/master/CVEs/CVE-2023-22620.txt)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128RCE Security Advisoryhttps://www.rcesecurity.com
1. ADVISORY INFORMATION=======================Product: SecurePoint UTMVendor URL: https://www.securepoint.de/en/for-companies/firewall-vpnType: Exposure of Sensitive Information to an Unauthorized Actor [CWE-200]Date found: 2023-01-05Date published: 2023-04-11CVSSv3 Score: 9.0 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H)CVE: CVE-2023-22620
2. CREDITS==========This vulnerability was discovered and researched by Julien Ahrens fromRCE Security.
3. VERSIONS AFFECTED====================SecurePoint UTM 12.2.5SecurePoint UTM 12.2.5SecurePoint UTM 12.2.4.1SecurePoint UTM 12.2.4SecurePoint UTM 12.2.3.4SecurePoint UTM 12.2.3.3SecurePoint UTM 12.2.3.2 Reseller PreviewSecurePoint UTM 12.2.3.1 Reseller Preview
4. INTRODUCTION===============With secure networks, home office, site connectivity and the protection of yourdata are easy to implement. UTM firewalls and VPN gateways from Securepoint secureyour networks - with suitable IT security solutions for small and medium-sizedbusinesses for rent, purchase or as a complete service.
(from the vendor's homepage)
5. VULNERABILITY DETAILS========================The firewall offers an administrative web panel on port 11115 and a user login panelon port 443. Both offer the endpoint at "/spcgi.cgi" which leaks the "sessionid" ofthe last active authenticated user to any unauthenticated user when the applicationprocesses an invalid authentication attempt.
However, the attacker needs two more authentication attributes to be able to successfullyauthenticate using the leaked sessionid:
1. The attacker must have the same REMOTE\_ADDR as the user whose sessionid is leaked.This isn't trivial to achieve, but exploitation is easy in configurations where any of thetwo panels are NAT'ed.
2. The attacker needs to know the User-Agent of the user whose sessionid is leaked.However, since the application does not enforce a rate limit on the authenticationendpoint, it is trivially easy to brute-force the User-Agent belonging to the leakedsession and then authenticate to the device. As the linked blog post describes, thenumber of possible User-Agents can be further reduced.
Interestingly this exploit works across both authentication panels, so an attackercan also leak the sessionId of an administrator using the user login interface and viceversa.
Successful exploits can allow an unauthenticated attacker to authenticate againstthe administrative interface without knowing the user's password. If the lastauthenticated user has administrative privileges, this means a complete compromiseof the device since it is trivially easy to escalate from admin to root using legitimatefeatures.
6. PROOF OF CONCEPT===================Wait until a user successfully authenticates against the device and then issue aninvalid authentication attempt like:
POST /spcgi.cgi HTTP/1.1Host: 192.168.175.1:11115Content-Length: 86Accept: \*/\*Content-Type: application/json; charset=UTF-8Connection: close
{"module":"auth","command":["login"],"sessionid":"","arguments":{"user":"","pass":""}}
The application then returns the last active user's sessionid:
{ "sessionid": "8d4602543120a48a4ec30762c5cad3fa", "mode": "w", "result": { "module": "server", "code": 401, "status": "Unauthorized", "message": "failure: access denied" }, "version": "11.6"}
This is also exploitable against the user interface on port 443.
7. SOLUTION===========Upgrade to version 12.2.5.1 or newer
8. REPORT TIMELINE==================2023-01-04: Discovery of the vulnerability2023-01-04: MITRE assigns CVE-2023-226202023-01-05: Contacted vendor via their security@2023-01-05: Vendor response2023-01-05: Sent full vulnerability details to vendor2023-01-06: Vendor acknowledged the vulnerability2023-01-06: Vendor asks to set the disclosure date to 2023-04-11 due to the # of affected customers2023-01-06: RCE Security agrees to the proposed disclosure date2023-01-06: Vendor publishes hotfix 12.2.5.1 which fixes the vulnerability2023-04-11: Public disclosure
9. REFERENCES==============https://www.rcesecurity.com/2023/04/securepwn-part-1-bypassing-securepoint-utms-authentication-cve-2023-22620/https://github.com/MrTuxracer/advisories

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from rcesecurity.com_5d55c50c_20250114_190734.html ===


[![RCE Security](https://www.rcesecurity.com/wp-content/uploads/2024/03/logo_small.png)](https://www.rcesecurity.com/)

* [Home](https://www.rcesecurity.com/)
* [About](https://www.rcesecurity.com/about/)
* [Services](https://www.rcesecurity.com/consulting-services/)
* [Research](https://www.rcesecurity.com/blog/)
* [Contact Us](https://www.rcesecurity.com/contact/)

Select Page

IT-Security Made In GerMany

# Continuous Penetration Testing

Small- and mid-sized organizations often lack the personnel or knowledge to cover their entire digital attack surface. We’re here for you to fill this gap!

[Contact us](https://www.rcesecurity.com/contact/)

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/3849222.png "3849222")

## Integrate security into your organization

All you have to do is give us your asset information – including domain names, IP addresses and mobile apps and we’ll do the rest.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-07-6.png)
#### Kick-Off

We’ll talk about your attack surface and you’ll give us permission to monitor it.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-02-4.png)
#### Coverage

We’ll cover all your company’s assets. 24/7.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/3168077.png "3168077")

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/6502422.png "6502422")

## The fun part.

Once we’ve got all your digital assets, we start continuously monitoring your assets for security vulnerabilities. All discovered vulnerabilities are evaluated by our certified security analysts to save you more time focusing on your business. You will never get an unchecked report!

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-01-4.png)
#### Fast & Easy for you

We’ll get in touch proactively if there is a vulnerability found; even with affected vendors!

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-09-3.png)
#### Reporting

You’ll get a report which summarizes the identified vulnerabilities and all necessary steps to remediate it.

## Additional Benefits!

We understand that the security of your data is important, which is why we store every single byte in German datacenters.

#### Data Stored in Germany

Elevating our commitment to data security and privacy, all your data is exclusively stored in a datacenter in Germany. We understand the paramount importance of aligning with stringent GDPR regulations, and by choosing our services, you gain the added assurance that your sensitive information is stored in a country renowned for its robust data protection framework

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/2961021.png "2961021")

## What we have to offer

Affordable for any budget.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-05-6.png)
#### Attack Surface Management

We continuously monitor your attack surface and notify you of any vulnerabilities discovered.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-04-6.png)
#### Penetration Tests

We also perform classic penetration tests against almost any of your assets: web apps and apis, IoT devices or thick client apps.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-07-6.png)
#### Source Code Reviews

We also perform source code reviews of applications written in Java, .NET, PHP, Python or JavaScript.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-08-6.png)
#### Bug Bounty and VDP Services

Do you want to run your own bug bounty or vulnerability disclosure program? With more than 10 years experience, we have you covered!

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-10-6.png)
#### Custom IT Security Consulation

We can assist you in security engineering related topics such as how to securely build new apps or APIs.

## Latest News

Discover our newest blog posts.

[![WordPress GiveWP POP to RCE (CVE-2024-5932)](https://www.rcesecurity.com/wp-content/uploads/2024/08/cve-2024-5932-0-400x250.png)](https://www.rcesecurity.com/2024/08/wordpress-givewp-pop-to-rce-cve-2024-5932/)
## [WordPress GiveWP POP to RCE (CVE-2024-5932)](https://www.rcesecurity.com/2024/08/wordpress-givewp-pop-to-rce-cve-2024-5932/)

A few days ago, Wordfence published a blog post about a PHP Object Injection vulnerability affecting the popular WordPress Plugin GiveWP in all versions <= 3.14.1. Since the blog post contains only information about (a part) of the POP chain used, I decided to take a look and build a fully functional Remote Code Execution exploit. This post describes how I approached the process, identifying the missing parts and building the entire POP chain.

[![Patch Diffing CVE-2023-28121 to Compromise a WooCommerce](https://www.rcesecurity.com/wp-content/uploads/2023/07/woocommerce-payments-auth-bypass-4.png)](https://www.rcesecurity.com/2023/07/patch-diffing-cve-2023-28121-to-compromise-a-woocommerce/)
## [Patch Diffing CVE-2023-28121 to Compromise a WooCommerce](https://www.rcesecurity.com/2023/07/patch-diffing-cve-2023-28121-to-compromise-a-woocommerce/)

Back in March 2023, I noticed an interesting security advisory that was published by Wordfence about a critical "Authentication Bypass and Privilege Escalation" (aka CVE-2023-28121) affecting the "WooCommerce Payments" plugin which has more than 600.000 active...

[![SecurePwn Part 2: Leaking Remote Memory Contents (CVE-2023-22897)](https://www.rcesecurity.com/wp-content/uploads/2023/04/securepwn-10.png)](https://www.rcesecurity.com/2023/04/securepwn-part-2-leaking-remote-memory-contents-cve-2023-22897/)
## [SecurePwn Part 2: Leaking Remote Memory Contents (CVE-2023-22897)](https://www.rcesecurity.com/2023/04/securepwn-part-2-leaking-remote-memory-contents-cve-2023-22897/)

While my last finding affecting SecurePoint's UTM was quite interesting already, I was hit by a really hard OpenSSL Heartbleed flashback with this one. The following exploit works against both the admin portal on port 11115 as well as the user portal on port 443....

## **Profiles**

[HackerOne](https://hackerone.com/mrtuxracer)

[Bugcrowd](https://bugcrowd.com/mrtuxracer)

[Intigriti](https://www.intigriti.com/profile/mrtuxracer)

[Yogosha](https://app.yogosha.com/r/MrTuxracer)

[Synack](https://www.synack.com/)

## Services

[Attack Surface Management](/consulting-services)

[Penetration Testing](/consulting-services)

[Source Code Review](/consulting-services)

[Bug Bounty and VDP Services](/consulting-services)

[Custom IT Security Consultation](/consulting-services)

## Connect

[Twitter](https://www.twitter.com/mrtuxracer)

[Xing](https://www.xing.com/profile/Julien_Ahrens2/)

[LinkedIn](https://www.linkedin.com/in/julien-ahrens-57ab88271/)

## Resources

[Imprint](/imprint)

[Privacy Policy](/privacy-policy/)

[Disclosure Policy](/disclosure-policy/)

[Terms of Service](/agb)

[Contact](/contact/)

[Blog](/blog/)

[Images by storyset](https://www.freepik.com/free-vector/hacker-concept-illustration_8199319.htm#query=hacking&position=7&from_view=author&uuid=0841c05c-dfd2-4ef3-89ab-011a9787f298) on Freepik

* [X](https://twitter.com/MrTuxracer)
* [RSS](https://www.rcesecurity.com/feed/)

Designed by [Elegant Themes](https://www.elegantthemes.com "Premium WordPress Themes") | Powered by [WordPress](https://www.wordpress.org)



=== Content from seclists.org_f6cbe8b1_20250114_190731.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](6)
[By Date](date.html#7)
[![Next](/images/right-icon-16x16.png)](8)

[![Previous](/images/left-icon-16x16.png)](6)
[By Thread](index.html#7)
[![Next](/images/right-icon-16x16.png)](8)

![](/shared/images/nst-icons.svg#search)

# [CVE-2023-22620] SecurePoint UTM <= 12.2.5 “spcgi.cgi” sessionId Information Disclosure Allowing Device Takeover

---

*From*: "Julien Ahrens (RCE Security)" <info () rcesecurity com>

*Date*: Tue, 11 Apr 2023 16:11:05 +0000

---

```
RCE Security Advisory
<https://www.rcesecurity.com>

1. ADVISORY INFORMATION
=======================
Product:        SecurePoint UTM
Vendor URL:     <https://www.securepoint.de/en/for-companies/firewall-vpn>
Type:           Exposure of Sensitive Information to an Unauthorized Actor [CWE-200]
Date found:     2023-01-05
Date published: 2023-04-11
CVSSv3 Score:   9.0 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H)
CVE:            CVE-2023-22620

2. CREDITS
==========
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.

3. VERSIONS AFFECTED
====================
SecurePoint UTM 12.2.5
SecurePoint UTM 12.2.5
SecurePoint UTM 12.2.4.1
SecurePoint UTM 12.2.4
SecurePoint UTM 12.2.3.4
SecurePoint UTM 12.2.3.3
SecurePoint UTM 12.2.3.2 Reseller Preview
SecurePoint UTM 12.2.3.1 Reseller Preview

4. INTRODUCTION
===============
With secure networks, home office, site connectivity and the protection of your
data are easy to implement. UTM firewalls and VPN gateways from Securepoint secure
your networks - with suitable IT security solutions for small and medium-sized
businesses for rent, purchase or as a complete service.

(from the vendor's homepage)

5. VULNERABILITY DETAILS
========================
The firewall offers an administrative web panel on port 11115 and a user login panel
on port 443. Both offer the endpoint at "/spcgi.cgi" which leaks the "sessionid" of
the last active authenticated user to any unauthenticated user when the application
processes an invalid authentication attempt.

However, the attacker needs two more authentication attributes to be able to successfully
authenticate using the leaked sessionid:

1. The attacker must have the same REMOTE_ADDR as the user whose sessionid is leaked.
This isn't trivial to achieve, but exploitation is easy in configurations where any of the
two panels are NAT'ed.

2. The attacker needs to know the User-Agent of the user whose sessionid is leaked.
However, since the application does not enforce a rate limit on the authentication
endpoint, it is trivially easy to brute-force the User-Agent belonging to the leaked
session and then authenticate to the device. As the linked blog post describes, the
number of possible User-Agents can be further reduced.

Interestingly this exploit works across both authentication panels, so an attacker
can also leak the sessionId of an administrator using the user login interface and vice
versa.

Successful exploits can allow an unauthenticated attacker to authenticate against
the administrative interface without knowing the user's password. If the last
authenticated user has administrative privileges, this means a complete compromise
of the device since it is trivially easy to escalate from admin to root using legitimate
features.

6. PROOF OF CONCEPT
===================
Wait until a user successfully authenticates against the device and then issue an
invalid authentication attempt like:

POST /spcgi.cgi HTTP/1.1
Host: 192.168.175.1:11115
Content-Length: 86
Accept: */*
Content-Type: application/json; charset=UTF-8
Connection: close

{"module":"auth","command":["login"],"sessionid":"","arguments":{"user":"","pass":""}}

The application then returns the last active user's sessionid:

{
  "sessionid": "8d4602543120a48a4ec30762c5cad3fa",
  "mode": "w",
  "result": {
    "module": "server",
    "code": 401,
    "status": "Unauthorized",
    "message": "failure: access denied"
  },
  "version": "11.6"
}

This is also exploitable against the user interface on port 443.

7. SOLUTION
===========
Upgrade to version 12.2.5.1 or newer

8. REPORT TIMELINE
==================
2023-01-04: Discovery of the vulnerability
2023-01-04: MITRE assigns CVE-2023-22620
2023-01-05: Contacted vendor via their security@
2023-01-05: Vendor response
2023-01-05: Sent full vulnerability details to vendor
2023-01-06: Vendor acknowledged the vulnerability
2023-01-06: Vendor asks to set the disclosure date to 2023-04-11 due to the # of affected customers
2023-01-06: RCE Security agrees to the proposed disclosure date
2023-01-06: Vendor publishes hotfix 12.2.5.1 which fixes the vulnerability
2023-04-11: Public disclosure

9. REFERENCES
==============
<https://www.rcesecurity.com/2023/04/securepwn-part-1-bypassing-securepoint-utms-authentication-cve-2023-22620/>
<https://github.com/MrTuxracer/advisories>

```

**Attachment:
[signature.asc](att-7/signature_asc.bin)**

*Description:* Message signed with OpenPGP

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](6)
[By Date](date.html#7)
[![Next](/images/right-icon-16x16.png)](8)

[![Previous](/images/left-icon-16x16.png)](6)
[By Thread](index.html#7)
[![Next](/images/right-icon-16x16.png)](8)

### Current thread:

* **[CVE-2023-22620] SecurePoint UTM <= 12.2.5 “spcgi.cgi” sessionId Information Disclosure Allowing Device Takeover** *Julien Ahrens (RCE Security) (Apr 18)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_7ed5c2d4_20250115_113847.html ===
RCE Security Advisory
https://www.rcesecurity.com
1. ADVISORY INFORMATION
=======================
Product: SecurePoint UTM
Vendor URL: https://www.securepoint.de/en/for-companies/firewall-vpn
Type: Exposure of Sensitive Information to an Unauthorized Actor [CWE-200]
Date found: 2023-01-05
Date published: 2023-04-11
CVSSv3 Score: 9.0 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H)
CVE: CVE-2023-22620
2. CREDITS
==========
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.
3. VERSIONS AFFECTED
====================
SecurePoint UTM 12.2.5
SecurePoint UTM 12.2.5
SecurePoint UTM 12.2.4.1
SecurePoint UTM 12.2.4
SecurePoint UTM 12.2.3.4
SecurePoint UTM 12.2.3.3
SecurePoint UTM 12.2.3.2 Reseller Preview
SecurePoint UTM 12.2.3.1 Reseller Preview
4. INTRODUCTION
===============
With secure networks, home office, site connectivity and the protection of your
data are easy to implement. UTM firewalls and VPN gateways from Securepoint secure
your networks - with suitable IT security solutions for small and medium-sized
businesses for rent, purchase or as a complete service.
(from the vendor's homepage)
5. VULNERABILITY DETAILS
========================
The firewall offers an administrative web panel on port 11115 and a user login panel
on port 443. Both offer the endpoint at "/spcgi.cgi" which leaks the "sessionid" of
the last active authenticated user to any unauthenticated user when the application
processes an invalid authentication attempt.
However, the attacker needs two more authentication attributes to be able to successfully
authenticate using the leaked sessionid:
1. The attacker must have the same REMOTE\_ADDR as the user whose sessionid is leaked.
This isn't trivial to achieve, but exploitation is easy in configurations where any of the
two panels are NAT'ed.
2. The attacker needs to know the User-Agent of the user whose sessionid is leaked.
However, since the application does not enforce a rate limit on the authentication
endpoint, it is trivially easy to brute-force the User-Agent belonging to the leaked
session and then authenticate to the device. As the linked blog post describes, the
number of possible User-Agents can be further reduced.
Interestingly this exploit works across both authentication panels, so an attacker
can also leak the sessionId of an administrator using the user login interface and vice
versa.
Successful exploits can allow an unauthenticated attacker to authenticate against
the administrative interface without knowing the user's password. If the last
authenticated user has administrative privileges, this means a complete compromise
of the device since it is trivially easy to escalate from admin to root using legitimate
features.
6. PROOF OF CONCEPT
===================
Wait until a user successfully authenticates against the device and then issue an
invalid authentication attempt like:
POST /spcgi.cgi HTTP/1.1
Host: 192.168.175.1:11115
Content-Length: 86
Accept: \*/\*
Content-Type: application/json; charset=UTF-8
Connection: close
{"module":"auth","command":["login"],"sessionid":"","arguments":{"user":"","pass":""}}
The application then returns the last active user's sessionid:
{
"sessionid": "8d4602543120a48a4ec30762c5cad3fa",
"mode": "w",
"result": {
"module": "server",
"code": 401,
"status": "Unauthorized",
"message": "failure: access denied"
},
"version": "11.6"
}
This is also exploitable against the user interface on port 443.
7. SOLUTION
===========
Upgrade to version 12.2.5.1 or newer
8. REPORT TIMELINE
==================
2023-01-04: Discovery of the vulnerability
2023-01-04: MITRE assigns CVE-2023-22620
2023-01-05: Contacted vendor via their security@
2023-01-05: Vendor response
2023-01-05: Sent full vulnerability details to vendor
2023-01-06: Vendor acknowledged the vulnerability
2023-01-06: Vendor asks to set the disclosure date to 2023-04-11 due to the # of affected customers
2023-01-06: RCE Security agrees to the proposed disclosure date
2023-01-06: Vendor publishes hotfix 12.2.5.1 which fixes the vulnerability
2023-04-11: Public disclosure
9. REFERENCES
==============
https://www.rcesecurity.com/2023/04/securepwn-part-1-bypassing-securepoint-utms-authentication-cve-2023-22620/
https://github.com/MrTuxracer/advisories

=== Content from www.rcesecurity.com_9a6bead5_20250115_113847.html ===


[![RCE Security](https://www.rcesecurity.com/wp-content/uploads/2024/03/logo_small.png)](https://www.rcesecurity.com/)

* [Home](https://www.rcesecurity.com/)
* [About](https://www.rcesecurity.com/about/)
* [Services](https://www.rcesecurity.com/consulting-services/)
* [Research](https://www.rcesecurity.com/blog/)
* [Contact Us](https://www.rcesecurity.com/contact/)

Select Page

IT-Security Made In GerMany

# Continuous Penetration Testing

Small- and mid-sized organizations often lack the personnel or knowledge to cover their entire digital attack surface. We’re here for you to fill this gap!

[Contact us](https://www.rcesecurity.com/contact/)

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/3849222.png "3849222")

## Integrate security into your organization

All you have to do is give us your asset information – including domain names, IP addresses and mobile apps and we’ll do the rest.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-07-6.png)
#### Kick-Off

We’ll talk about your attack surface and you’ll give us permission to monitor it.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-02-4.png)
#### Coverage

We’ll cover all your company’s assets. 24/7.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/3168077.png "3168077")

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/6502422.png "6502422")

## The fun part.

Once we’ve got all your digital assets, we start continuously monitoring your assets for security vulnerabilities. All discovered vulnerabilities are evaluated by our certified security analysts to save you more time focusing on your business. You will never get an unchecked report!

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-01-4.png)
#### Fast & Easy for you

We’ll get in touch proactively if there is a vulnerability found; even with affected vendors!

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-09-3.png)
#### Reporting

You’ll get a report which summarizes the identified vulnerabilities and all necessary steps to remediate it.

## Additional Benefits!

We understand that the security of your data is important, which is why we store every single byte in German datacenters.

#### Data Stored in Germany

Elevating our commitment to data security and privacy, all your data is exclusively stored in a datacenter in Germany. We understand the paramount importance of aligning with stringent GDPR regulations, and by choosing our services, you gain the added assurance that your sensitive information is stored in a country renowned for its robust data protection framework

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/2961021.png "2961021")

## What we have to offer

Affordable for any budget.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-05-6.png)
#### Attack Surface Management

We continuously monitor your attack surface and notify you of any vulnerabilities discovered.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-04-6.png)
#### Penetration Tests

We also perform classic penetration tests against almost any of your assets: web apps and apis, IoT devices or thick client apps.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-07-6.png)
#### Source Code Reviews

We also perform source code reviews of applications written in Java, .NET, PHP, Python or JavaScript.

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-08-6.png)
#### Bug Bounty and VDP Services

Do you want to run your own bug bounty or vulnerability disclosure program? With more than 10 years experience, we have you covered!

![](https://www.rcesecurity.com/wp-content/uploads/2024/02/app-marketing-icon-10-6.png)
#### Custom IT Security Consulation

We can assist you in security engineering related topics such as how to securely build new apps or APIs.

## Latest News

Discover our newest blog posts.

[![WordPress GiveWP POP to RCE (CVE-2024-5932)](https://www.rcesecurity.com/wp-content/uploads/2024/08/cve-2024-5932-0-400x250.png)](https://www.rcesecurity.com/2024/08/wordpress-givewp-pop-to-rce-cve-2024-5932/)
## [WordPress GiveWP POP to RCE (CVE-2024-5932)](https://www.rcesecurity.com/2024/08/wordpress-givewp-pop-to-rce-cve-2024-5932/)

A few days ago, Wordfence published a blog post about a PHP Object Injection vulnerability affecting the popular WordPress Plugin GiveWP in all versions <= 3.14.1. Since the blog post contains only information about (a part) of the POP chain used, I decided to take a look and build a fully functional Remote Code Execution exploit. This post describes how I approached the process, identifying the missing parts and building the entire POP chain.

[![Patch Diffing CVE-2023-28121 to Compromise a WooCommerce](https://www.rcesecurity.com/wp-content/uploads/2023/07/woocommerce-payments-auth-bypass-4.png)](https://www.rcesecurity.com/2023/07/patch-diffing-cve-2023-28121-to-compromise-a-woocommerce/)
## [Patch Diffing CVE-2023-28121 to Compromise a WooCommerce](https://www.rcesecurity.com/2023/07/patch-diffing-cve-2023-28121-to-compromise-a-woocommerce/)

Back in March 2023, I noticed an interesting security advisory that was published by Wordfence about a critical "Authentication Bypass and Privilege Escalation" (aka CVE-2023-28121) affecting the "WooCommerce Payments" plugin which has more than 600.000 active...

[![SecurePwn Part 2: Leaking Remote Memory Contents (CVE-2023-22897)](https://www.rcesecurity.com/wp-content/uploads/2023/04/securepwn-10.png)](https://www.rcesecurity.com/2023/04/securepwn-part-2-leaking-remote-memory-contents-cve-2023-22897/)
## [SecurePwn Part 2: Leaking Remote Memory Contents (CVE-2023-22897)](https://www.rcesecurity.com/2023/04/securepwn-part-2-leaking-remote-memory-contents-cve-2023-22897/)

While my last finding affecting SecurePoint's UTM was quite interesting already, I was hit by a really hard OpenSSL Heartbleed flashback with this one. The following exploit works against both the admin portal on port 11115 as well as the user portal on port 443....

## **Profiles**

[HackerOne](https://hackerone.com/mrtuxracer)

[Bugcrowd](https://bugcrowd.com/mrtuxracer)

[Intigriti](https://www.intigriti.com/profile/mrtuxracer)

[Yogosha](https://app.yogosha.com/r/MrTuxracer)

[Synack](https://www.synack.com/)

## Services

[Attack Surface Management](/consulting-services)

[Penetration Testing](/consulting-services)

[Source Code Review](/consulting-services)

[Bug Bounty and VDP Services](/consulting-services)

[Custom IT Security Consultation](/consulting-services)

## Connect

[Twitter](https://www.twitter.com/mrtuxracer)

[Xing](https://www.xing.com/profile/Julien_Ahrens2/)

[LinkedIn](https://www.linkedin.com/in/julien-ahrens-57ab88271/)

## Resources

[Imprint](/imprint)

[Privacy Policy](/privacy-policy/)

[Disclosure Policy](/disclosure-policy/)

[Terms of Service](/agb)

[Contact](/contact/)

[Blog](/blog/)

[Images by storyset](https://www.freepik.com/free-vector/hacker-concept-illustration_8199319.htm#query=hacking&position=7&from_view=author&uuid=0841c05c-dfd2-4ef3-89ab-011a9787f298) on Freepik

* [X](https://twitter.com/MrTuxracer)
* [RSS](https://www.rcesecurity.com/feed/)

Designed by [Elegant Themes](https://www.elegantthemes.com "Premium WordPress Themes") | Powered by [WordPress](https://www.wordpress.org)


