=== Content from advisory.splunk.com_fbe556b8_20250114_212712.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Modular Input REST API Requests Connect via HTTP after Certificate Validation Failure in Splunk Add-on Builder and Splunk CloudConnect SDK

**Advisory ID:** SVD-2023-0213

**CVE ID:** [CVE-2023-22943](https://www.cve.org/CVERecord?id=CVE-2023-22943)

**Published:** 2023-02-14

**Last Update:** 2023-02-14

**CVSSv3.1 Score:** 4.8, Medium

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N)

**CWE:** [CWE-636](https://cwe.mitre.org/data/definitions/636.html)

**Bug ID:** ADDON-58725

## Description

In Splunk Add-on Builder (AoB) versions below 4.1.2 and the Splunk CloudConnect SDK versions below 3.1.3, requests to third-party APIs through the REST API Modular Input incorrectly revert to using HTTP to connect after a failure to connect over HTTPS occurs. The vulnerability affects AoB and apps that AoB generates when using the REST API Modular Input functionality through its user interface. The vulnerability also potentially affects third-party apps and add-ons that call *cloudconnectlib.splunktacollectorlib.cloud\_connect\_mod\_input* directly.

## Solution

For third-party apps and add-ons that include the Splunk CloudConnect SDK, upgrade the library to 3.1.3 or higher.

For customers that use AoB for custom apps, perform the following steps to update your app or add-on:

1. Upgrade AoB to version 4.1.2 or higher. See [Install the Add-on Builder User Guide](https://docs.splunk.com/Documentation/AddonBuilder/latest/UserGuide/Installation) for more information.
2. Use AoB to edit and save the affected app. See [Configure data collection using a REST API call](https://docs.splunk.com/Documentation/AddonBuilder/latest/UserGuide/ConfigureDataCollection) for more information. It isn’t necessary to make changes to the app prior to saving it.
3. Restart Splunk Enterprise.

If the custom app or add-on is also installed on instances without AoB, you must package the upgraded custom app or add-on, then install it on the instances. See [Validate and Package](https://docs.splunk.com/Documentation/AddonBuilder/latest/UserGuide/Validate) and [Package apps](https://dev.splunk.com/enterprise/docs/releaseapps/packageapps/) for more information.

For affected apps and add-ons that are already on SplunkBase, third-party developers must publish an updated version of the app or add-on to SplunkBase. For more information, see [Publish apps for Splunk Cloud Platform or Splunk Enterprise to Splunkbase](https://dev.splunk.com/enterprise/docs/releaseapps/splunkbase/). Cloud-vetted apps are subject to the [Cloud Vetting Change Policy](https://dev.splunk.com/enterprise/docs/releaseapps/cloudvetting/#Cloud-Vetting-Change-Policy).

Note: If the REST API Modular Input connects to a self-signed URL, that connection will fail. Where applicable, use a certificate authority (CA)-signed certificate for your app or add-on. As an alternative, to fix this error on apps and add-ons that are not on SplunkBase, overwrite the certificate at *$SPLUNK\_HOME/etc/apps/<ta\_name>/bin/<ta\_name>/aob\_py3/certifi/cacert.pem* with the self-signed certificate. You cannot overwrite this certificate on apps or add-ons that you publish to SplunkBase.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Add-on Builder | 4.1 | cloudconnectlib | 4.1.1 and lower | 4.1.2 |
| Splunk CloudConnect SDK | 3.1 | - | 3.1.2 and lower | 3.1.3 |

## Mitigations and Workarounds

As an alternative to updating your custom app, if the app does not use the REST API Modular Input functionality, delete the affected file at *$SPLUNK\_HOME/etc/apps/<ta\_name>/bin/<ta\_name>/aob\_py3/cloudconnectlib/core/http.py*. If the app uses the functionality, update the file or patch it with the file changes that appear in this [pull request](https://github.com/splunk/addonfactory-cloudconnect-library/pull/144/files) on the Splunk GitHub site.

## Detections

None

## Severity

Splunk rated the vulnerability as Medium, 4.8, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N. The impact of the vulnerability might vary for each app or add-on. Where applicable, review your app or add-on and rate its vulnerability based on whether it uses the vulnerable functionality and what data the modular input sends or receives.

## Acknowledgments

Chris Green

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)
