=== Content from www.linkedin.com_4bbee05b_20250115_214530.html ===




=== Content from github.com_ebb269ca_20250115_083853.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpiuppi%2FProof-of-Concepts%2Fblob%2Fmain%2FSyracom%2FSecureLogin2FA-OpenRedirect.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpiuppi%2FProof-of-Concepts%2Fblob%2Fmain%2FSyracom%2FSecureLogin2FA-OpenRedirect.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=piuppi%2FProof-of-Concepts)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[piuppi](/piuppi)
/
**[Proof-of-Concepts](/piuppi/Proof-of-Concepts)**
Public

* [Notifications](/login?return_to=%2Fpiuppi%2FProof-of-Concepts) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fpiuppi%2FProof-of-Concepts)
* [Star
   4](/login?return_to=%2Fpiuppi%2FProof-of-Concepts)

* [Code](/piuppi/Proof-of-Concepts)
* [Pull requests
  0](/piuppi/Proof-of-Concepts/pulls)
* [Actions](/piuppi/Proof-of-Concepts/actions)
* [Projects
  0](/piuppi/Proof-of-Concepts/projects)
* [Security](/piuppi/Proof-of-Concepts/security)
* [Insights](/piuppi/Proof-of-Concepts/pulse)

Additional navigation options

* [Code](/piuppi/Proof-of-Concepts)
* [Pull requests](/piuppi/Proof-of-Concepts/pulls)
* [Actions](/piuppi/Proof-of-Concepts/actions)
* [Projects](/piuppi/Proof-of-Concepts/projects)
* [Security](/piuppi/Proof-of-Concepts/security)
* [Insights](/piuppi/Proof-of-Concepts/pulse)

## Files

 main
## Breadcrumbs

1. [Proof-of-Concepts](/piuppi/Proof-of-Concepts/tree/main)
2. /[Syracom](/piuppi/Proof-of-Concepts/tree/main/Syracom)
/
# SecureLogin2FA-OpenRedirect.md

Copy path Blame  Blame
## Latest commit

## History

[History](/piuppi/Proof-of-Concepts/commits/main/Syracom/SecureLogin2FA-OpenRedirect.md)111 lines (71 loc) · 10 KB main
## Breadcrumbs

1. [Proof-of-Concepts](/piuppi/Proof-of-Concepts/tree/main)
2. /[Syracom](/piuppi/Proof-of-Concepts/tree/main/Syracom)
/
# SecureLogin2FA-OpenRedirect.md

Top
## File metadata and controls

* Preview
* Code
* Blame

111 lines (71 loc) · 10 KB[Raw](https://github.com/piuppi/Proof-of-Concepts/raw/refs/heads/main/Syracom/SecureLogin2FA-OpenRedirect.md)
# CVE-2023-22958: The 'Secure Login (2FA) for Jira' plugin prior to version 3.1.1.0 is vulnerable to Open Redirect which would allow an attacker to redirect users to a website under his control, opening them up to a phishing attack (<https://marketplace.atlassian.com/apps/1213472/secure-login-2fa-jira>).

### Overview

**'Secure Login (2FA)'** is a Two-factor authentication (2FA) Plugin for Atlassian Tools developed by [Syracom AG](https://www.syracom.de), an independent business and IT consulting firm that is a [Atlassian](https://www.atlassian.com) Silver Solution Partner, where it focuses on designing efficient and durable business processes based on Atlassian tools.

Plugin available on Atlassian marketplace here: <https://marketplace.atlassian.com/apps/1213472/secure-login-2fa-jira>

### Vulnerability Description

#### Prior to version 3.1.1.0 of the Secure Login for Jira Plugin, the PIN validation page contains an 'Open Redirect' that would allow an attacker to redirect users to a website under his control, opening them up to a phishing attack.

An open redirect vulnerability is a type of security vulnerability that occurs when a web application allows users to be redirected to a URL of the attacker's choice. This can happen if the application does not properly validate the target of a redirect.
If the application does not properly validate the redirect URL, an attacker could craft a link that, when clicked, logs the user into the application and then redirects them to a malicious site.

### Impacts

The impacts of an open redirect vulnerability depend on how it is exploited and the attacker's goals. In general, the possible impacts of this type of vulnerability may include:

* Stealing the user's login credentials: an attacker may exploit an open redirect vulnerability to trick users into logging into a fake site, which could then steal their login credentials.
* Inducing the user to reveal sensitive information: an attacker could create a link that redirects users to a site that asks them to enter sensitive information.
* Exploiting the credibility of a legitimate site: an attacker may exploit an open redirect vulnerability to redirect users to a malicious site that may be difficult to distinguish from a legitimate site. In this way, users may be tricked into divulging sensitive information.

### Timeline

* **2022-07-21**: Discovered and reported to Atlassian Security Team.
* **2022-07-22**: In the meantime, I also opened a ticket to the plugin developer Syracom AG.
* **2022-07-22**: I added details to the Syracom ticket with a PoC in PDF format that I had also sent to Atlassian.
* **2022-07-24**: Got mail from Syracom saying, *"Hello Gianluca, thank you very much for providing us with this security information. We already have access to all the information you provided to Atlassian. The next step for us is to check the functionality. Thanks for the detailed information! Best regards".*
* **2022-07-25**: Got mail from Atlassian Security Team saying, *"Hi Gianluca Palma, We have also provided details to the developer of the plugin. Thank you for doing likewise. In case it helps our communication with the vendor is occurring via a ticket with an identifier of "AMS-\*\*\*\*\*". As this issue is not in Atlassian component we are now going to close this issue. Thank you for sending this notification to Atlassian".*
* **2022-08-23**: I sent a reminder, *"Hi Team, is there any news about this vulnerability? have you been able to reproduce it? I remain available for any clarification. Thanks and Regards, Gianluca".*
* **2022-08-23**: Got mail saying, *"Hello Gianluca, we were able to analyze the issue. Now we are working on a fix. Thanks for asking. Best regards".*
* **2022-09-20**: I sent a reminder, *"Hi Team, I would like to know if there is any good news about the fix of this issue. Thank you in advance and have a nice day. Regards, Gianluca".*
* **2022-09-21**: Got mail saying, *"Hello Gianluca, thanks for asking. We found a solution and we are now testing the Fix. This causes time because we want to be very sure that everything works as designed. Have an amazing day".*
* **2022-11-11**: I sent a reminder, *"Hi Team, is there any news about this open redirect vulnerability? Have a nice day. Thanks and Regards, Gianluca".*
* **2022-11-11**: Got mail saying, *"Hello Gianluca, we fixed the problem and the security ticket of Atlassian is in the status “patched”. We released the fix with version 3.1.1.0 on 26th October on the Atlassian Marketplace. We want to thank you very much for informing us about the bug and for the excellent description of the bug. It helped us a lot to find the bug. Please excuse the late return. Best regards".*
* **2022-11-11**: I immediately replied, *"Hi Team, thank you very much for this information. Would it be possible for you to include this vulnerability in a your public security advisory where you mention me as a security researcher who helped you address and fix this vulnerability? Thanks".*
* **2022-11-16**: I sent a reminder, *"Hi Team, could you please support me with my last request to create a Security advisory for this vulnerability on your portal? I would like to request CVE to MITRE, but without your public advisory I would have to publish a full disclosure of the vulnerability on my github with a PoC. Thanks and Regards, Gianluca".*
* **2022-11-16**: Got mail saying, *"Hi, I did not forget your request, but we are a little busy. I will check that and come back to you. Best regards".*
* **2022-12-07**: I sent a reminder, *"Hi Team, I would like to know if I can proceed with the CVE request to MITRE, and if you could then kindly publish the security advisory on your site as I had requested".*
* **2022-12-19**: Since November 16 I have not received a response, so I have reached a conclusion and I sent an email, *"Hi Team, in the meantime it has been more than a month since you fixed the vulnerability. I understand that you are busy, which is why I thought your security advisory was not necessary, so I will send the CVE request to MITRE and publish a POC on my github account. Thank you and Best Regard, Gianluca".*
* **2023-01-10**: I waited a few more days before publishing the poc, hoping to get a response on the requested Security Advisory (*which I did not receive*).
* **2023-01-10**: I requested the CVE to MITRE.
* **2023-01-11**:- I have obtained the [CVE-2023-22958](https://nvd.nist.gov/vuln/detail/CVE-2023-22958) and published the PoC

### Discovered by

#### [Gianluca Palma](https://www.linkedin.com/in/piuppi/) ([@piuppi](https://twitter.com/piuppi)) of [Engineering Ingegneria Informatica S.p.A.](https://www.eng.it)

### Proof of concept (POC)

#### Reproducing Steps

Here are the steps to reproduce it, with the relevant evidence:

* ##### The attacker can craft a malicious URL that points to the 2FA PIN validation page, below:

`https://WWW.YOUR-JIRA-PORTAL.ORG/plugins/servlet/twofactor/public/pinvalidation?target=https://youtu.be/dQw4w9WgXcQ`

as can be seen, there is a **'target'** parameter in the query string that points to the phishing site used by the attacker to steal credentials; a rickrolling link was used for this PoC.

* ##### Note that the victim user, at this stage is not yet authenticated on the JIRA portal, so they click on the link:

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Syracom/images/1.png)](/piuppi/Proof-of-Concepts/blob/main/Syracom/images/1.png)

the application performs a redirect to **'login.jsp'** page by setting the GET parameter **'os\_destination'** that contains the full link sent by the attacker:

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Syracom/images/2.png)](/piuppi/Proof-of-Concepts/blob/main/Syracom/images/2.png)

the redirect is performed:

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Syracom/images/3.png)](/piuppi/Proof-of-Concepts/blob/main/Syracom/images/3.png)

as can be seen above, the user has not yet logged in, but the content of the GET parameter **'os\_destination'** returns the malicious link initially sent by the attacker.

* ##### At this point, the victim user enters his credentials to log in:

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Syracom/images/4.png)](/piuppi/Proof-of-Concepts/blob/main/Syracom/images/4.png)

Again, as can be seen below, the login request this time sends a **POST request** always containing the parameter **"os\_destination"** with the malicious link sent by the attacker:

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Syracom/images/5.png)](/piuppi/Proof-of-Concepts/blob/main/Syracom/images/5.png)

Then the application authenticates the user and performs a **redirect (302)** to the 2FA **pinvalidation** page, sending in the query string the vulnerable parameter **'target'** specified by the attacker :

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Syracom/images/6.png)](/piuppi/Proof-of-Concepts/blob/main/Syracom/images/6.png)

the redirect is performed:

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Syracom/images/7.png)](/piuppi/Proof-of-Concepts/blob/main/Syracom/images/7.png)

* ##### at this stage the **secure Login 2FA plugin** asks the victim user to open the Authenticator app on their mobile device and enter the **OTP PIN** received, below:

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Syracom/images/8.png)](/piuppi/Proof-of-Concepts/blob/main/Syracom/images/8.png)

Next, the PIN is sent via a POST request, where, however, the vulnerable parameter **'target'** is again transmitted in GET:

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Syracom/images/9.png)](/piuppi/Proof-of-Concepts/blob/main/Syracom/images/9.png)

Finally, the application performs the reindirect (302) to the URL established by the attacker, which, for example, could faithfully reproduce the **JIRA login phishing page with an unexpected validation error related to the PIN code entered**, causing the victim user to re-enter their credentials and PIN by capturing both (*replay attack*):

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Syracom/images/10.png)](/piuppi/Proof-of-Concepts/blob/main/Syracom/images/10.png)

But for this PoC I used a Rick-rolling link ☺️

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Syracom/images/11.png)](/piuppi/Proof-of-Concepts/blob/main/Syracom/images/11.png)

### Suggestions

To mitigate the open redirection vulnerability, it is important for web application developers to properly validate redirection URLs. There are several techniques that can be used for this purpose:

* Validate redirect URLs within the same domain: developers can configure the application to only allow redirects to URLs within the same domain.
* Validate redirect URLs using a list of allowed URLs: developers can maintain a list of URLs that are allowed for redirects and validate redirect URLs based on this list.
* Validate redirect URLs using a URL validation library: several libraries are available for validating redirect URLs, such as the "validator" library in Node.js.
* Manually validate redirect URLs: developers can manually validate redirect URLs using the appropriate method for their specific web application.

Additionally, developers should avoid using query or fragment parameters to specify redirect URLs, as these can be easily modified by the attacker. Instead, they should use a more secure method such as form hidden fields to specify redirect URLs.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from marketplace.atlassian.com_aea5d3ba_20250115_132343.html ===


Skip to:

Skip to Main content[![Atlassian marketplace home](data:image/svg+xml;base64...)](/)Apps for productsCategoriesResourcesSign in![](https://marketplace.atlassian.com/product-listing/files/301ffe6b-a444-4870-a678-e39673d6f7a7?fileType=image&mode=full-fit)
# Secure Login (2FA) - Jira

by [syracom AG](https://marketplace.atlassian.com/vendors/1211842/syracom-ag)works with Jira Server 8.20.0 - 9.12.15, Jira Data Center 9.4.0 - 10.3.2 [and more](https://marketplace.atlassian.com/apps/1213472/secure-login-2fa-jira/version-history "View version history for more details")Try it freeBuy nowMore actions

OVERALL RATINGS

3.4

/4

(12)

INSTALLS

143

SUPPORT

* Partner Supported
View for: Data CenterOverviewReviewsPricingPrivacy & SecuritySupportInstallation
## Key highlights of the appStrong Security via two-factor authentication made in Germany without the need of an external system, also supporting Jira mobile

![watch Secure Login (2FA) - Jira video](https://i.ytimg.com/vi_webp/PgSfKa7KWAc/hqdefault.webp)
### Strong Security

Ensure limited access for authorized persons only via enhanced security: in addition to the username and password, a registered mobile device will be used each login time to generate a PIN code valid for half a minute.

![](https://marketplace.atlassian.com/product-listing/files/0260530a-02e9-4f56-b05d-4e4aad93cb77?fileType=image&mode=full-fit)
### Seamless Integration

Just install via Marketplace: you do not have to patch/customize anything nor does the add-on needs to communicate to a third-party system over the internet!

Jira Service Desk supported for native Jira users not agents.

![](https://marketplace.atlassian.com/product-listing/files/13e074c9-6b3c-45ed-9605-017a79081d76?fileType=image&mode=full-fit)
### Support of different mobil authenticators

Different authenticator apps are supported. You decide which one fits your needs and infrastructure:

- TOTP with (free) mobile authenticators available for iOS, Android, etc.

- hardware tokens

- FIDO2/webauthN

![](https://marketplace.atlassian.com/product-listing/files/9b1da98c-d3e1-48cf-b17e-801af0ffe7e3?fileType=image&mode=full-fit)
## Supporting media

* ![After the first login with username and password, the user have to register his mobile authenticator by scanning the QR code and enter the generated pin for validation.](https://marketplace.atlassian.com/product-listing/files/d0e90670-d31a-4493-8764-6a51d63d77eb?fileType=image&mode=crop&width=300&height=160)
* ![The integrated onboarding dialog gives the user a little explaination about how Secure Login works...](https://marketplace.atlassian.com/product-listing/files/812373e5-ab5c-4027-85c2-e5efe36f7de8?fileType=image&mode=crop&width=300&height=160)
* ![...provides an overview about compatible mobile authenticators for different operating systems...](https://marketplace.atlassian.com/product-listing/files/15068b2e-9741-4441-95d6-dd078dfc5715?fileType=image&mode=crop&width=300&height=160)
* ![...and leads him to further information about the plugin and the vendor.](https://marketplace.atlassian.com/product-listing/files/7ff5f105-8227-42de-a22e-6984835c6832?fileType=image&mode=crop&width=300&height=160)
* ![From now on, after each login with username and password, the user have to enter the pin code, generated by his mobile authenticator.](https://marketplace.atlassian.com/product-listing/files/bb99253c-b2ba-4051-bb47-ffd779a24dd0?fileType=image&mode=crop&width=300&height=160)
* ![syracom is a member of TeleTrusT, founded in 2005 by the BMI (Bundesministeriums des Innern) of the German Government, and holder of the trust seal "IT Security made in Germany".](https://marketplace.atlassian.com/product-listing/files/6df507c5-2d1a-4bf2-8f61-ceaf356c0caf?fileType=image&mode=crop&width=300&height=160)
### More details

The default login for Atlassian tools is based on username and password: this is not a strong authentication as both values can be easily passed/copied to other persons using them in parallel to the owner. A secure login depends on multiple aspects and combine e.g. knowledge with physical gadgets, which cannot be duplicated that easily. If the gadget will be stolen, it is useless without the knowledge aspect. One sample of such a secure login is a 2-factor authentication using user name/password and a mobile device as key code generator resp. authenticator.

ATTENTION: a mobile authenticator is not a barcode reader!

To use strong security, the SYRACOM add-on has to be installed and activated as described in our Administrator's Guide. Furthermore you must have an authenticator app installed on your mobile device. You can use every app which is compliant to the RFC 6238 standard. Please read the Users Guide having listed examples for different mobile phones and operation systems!

## Resources

* #### Download

  [Get the .jar file](https://marketplace.atlassian.com/download/apps/1213472/version/1220161845) downloaded to your system
* #### App documentation

  Comprehensive set of documentation from the partner on [how this app works](https://syracom-bee.atlassian.net/wiki/spaces/SL/overview)
* #### EULA

  [Get the End User License Agreement](https://syracom-bee.atlassian.net/wiki/x/AwAEDQ) for this app
## Privacy and Security

#### Privacy policy

Atlassian's privacy policy is not applicable to the use of this app. Please refer to the privacy policy provided by this app's partner.

[Partner privacy policy](https://syracom-bee.atlassian.net/wiki/spaces/SL/pages/231604246/Data%2Bsecurity%2Band%2Bprivacy%2Bstatement)
#### Security program

This app is not part of the Marketplace Bug Bounty program.

## Version information

Version 3.3.0.0•for Jira Data Center 9.4.0 - 10.3.2

Release dateJan 8th 2025SummaryFeature ReleaseDetails

* 2FA for Jira Service Management customers
* WebSudo for Secure Login Pages
* Welcome screen can be deactivated
Payment modelPaid via Atlassian[Explore all Data Center versions](https://marketplace.atlassian.com/apps/1213472/secure-login-2fa-jira/version-history?versionHistoryHosting=dataCenter)

Learn and explore

* [What’s Marketplace](https://developer.atlassian.com/platform/marketplace)
* [App installation](https://confluence.atlassian.com/upm/installing-add-ons-273875715.html)
* [About Atlassian](https://www.atlassian.com)
* [Atlassian resources](https://www.atlassian.com/resources)
* [Search and ranking](https://developer.atlassian.com/platform/marketplace/marketplace-search-results-and-rankings)
* [Atlassian events](https://www.atlassian.com/company/events)
* [Atlassian foundation](https://www.atlassianfoundation.org/)

Connect

* [Get support](https://support.atlassian.com/)
* [Partner connect](https://atlassianpartners.atlassian.net/wiki/spaces/resources/overview?mode=global)
* [Developer resources](https://developer.atlassian.com/)
* [Solution partner directory](https://partnerdirectory.atlassian.com/?page=1&expertise=Custom%20Development)
* [Atlassian communication channels](https://developer.atlassian.com/developer-guide/communication-channels/)

Follow

* [Privacy Policy](https://www.atlassian.com/legal/privacy-policy)
* [Terms of Use](https://www.atlassian.com/licensing/marketplace/termsofuse)
* Copyright © 2025 Atlassian



=== Content from twitter.com_c250280f_20250115_214542.html ===



=== Content from github.com_23fb77a8_20250115_214541.html ===
# CVE-2023-22958: The 'Secure Login (2FA) for Jira' plugin prior to version 3.1.1.0 is vulnerable to Open Redirect which would allow an attacker to redirect users to a website under his control, opening them up to a phishing attack (https://marketplace.atlassian.com/apps/1213472/secure-login-2fa-jira).
### Overview
\*\*'Secure Login (2FA)'\*\* is a Two-factor authentication (2FA) Plugin for Atlassian Tools developed by [Syracom AG](https://www.syracom.de), an independent business and IT consulting firm that is a [Atlassian](https://www.atlassian.com) Silver Solution Partner, where it focuses on designing efficient and durable business processes based on Atlassian tools.
Plugin available on Atlassian marketplace here: https://marketplace.atlassian.com/apps/1213472/secure-login-2fa-jira
### Vulnerability Description
#### Prior to version 3.1.1.0 of the Secure Login for Jira Plugin, the PIN validation page contains an 'Open Redirect' that would allow an attacker to redirect users to a website under his control, opening them up to a phishing attack.
An open redirect vulnerability is a type of security vulnerability that occurs when a web application allows users to be redirected to a URL of the attacker's choice. This can happen if the application does not properly validate the target of a redirect.
If the application does not properly validate the redirect URL, an attacker could craft a link that, when clicked, logs the user into the application and then redirects them to a malicious site.
### Impacts
The impacts of an open redirect vulnerability depend on how it is exploited and the attacker's goals. In general, the possible impacts of this type of vulnerability may include:
- Stealing the user's login credentials: an attacker may exploit an open redirect vulnerability to trick users into logging into a fake site, which could then steal their login credentials.
- Inducing the user to reveal sensitive information: an attacker could create a link that redirects users to a site that asks them to enter sensitive information.
- Exploiting the credibility of a legitimate site: an attacker may exploit an open redirect vulnerability to redirect users to a malicious site that may be difficult to distinguish from a legitimate site. In this way, users may be tricked into divulging sensitive information.
### Timeline
- \*\*2022-07-21\*\*: Discovered and reported to Atlassian Security Team.
- \*\*2022-07-22\*\*: In the meantime, I also opened a ticket to the plugin developer Syracom AG.
- \*\*2022-07-22\*\*: I added details to the Syracom ticket with a PoC in PDF format that I had also sent to Atlassian.
- \*\*2022-07-24\*\*: Got mail from Syracom saying, \_"Hello Gianluca, thank you very much for providing us with this security information. We already have access to all the information you provided to Atlassian. The next step for us is to check the functionality. Thanks for the detailed information! Best regards".\_
- \*\*2022-07-25\*\*: Got mail from Atlassian Security Team saying, \_"Hi Gianluca Palma, We have also provided details to the developer of the plugin. Thank you for doing likewise. In case it helps our communication with the vendor is occurring via a ticket with an identifier of "AMS-\*\*\*\*\*". As this issue is not in Atlassian component we are now going to close this issue. Thank you for sending this notification to Atlassian".\_
- \*\*2022-08-23\*\*: I sent a reminder, \_"Hi Team, is there any news about this vulnerability? have you been able to reproduce it? I remain available for any clarification. Thanks and Regards, Gianluca".\_
- \*\*2022-08-23\*\*: Got mail saying, \_"Hello Gianluca, we were able to analyze the issue. Now we are working on a fix. Thanks for asking. Best regards".\_
- \*\*2022-09-20\*\*: I sent a reminder, \_"Hi Team, I would like to know if there is any good news about the fix of this issue. Thank you in advance and have a nice day. Regards, Gianluca".\_
- \*\*2022-09-21\*\*: Got mail saying, \_"Hello Gianluca, thanks for asking. We found a solution and we are now testing the Fix. This causes time because we want to be very sure that everything works as designed. Have an amazing day".\_
- \*\*2022-11-11\*\*: I sent a reminder, \_"Hi Team, is there any news about this open redirect vulnerability? Have a nice day. Thanks and Regards, Gianluca".\_
- \*\*2022-11-11\*\*: Got mail saying, \_"Hello Gianluca, we fixed the problem and the security ticket of Atlassian is in the status “patched”. We released the fix with version 3.1.1.0 on 26th October on the Atlassian Marketplace. We want to thank you very much for informing us about the bug and for the excellent description of the bug. It helped us a lot to find the bug. Please excuse the late return. Best regards".\_
- \*\*2022-11-11\*\*: I immediately replied, \_"Hi Team, thank you very much for this information. Would it be possible for you to include this vulnerability in a your public security advisory where you mention me as a security researcher who helped you address and fix this vulnerability? Thanks".\_
- \*\*2022-11-16\*\*: I sent a reminder, \_"Hi Team, could you please support me with my last request to create a Security advisory for this vulnerability on your portal? I would like to request CVE to MITRE, but without your public advisory I would have to publish a full disclosure of the vulnerability on my github with a PoC. Thanks and Regards, Gianluca".\_
- \*\*2022-11-16\*\*: Got mail saying, \_"Hi, I did not forget your request, but we are a little busy. I will check that and come back to you. Best regards".\_
- \*\*2022-12-07\*\*: I sent a reminder, \_"Hi Team, I would like to know if I can proceed with the CVE request to MITRE, and if you could then kindly publish the security advisory on your site as I had requested".\_
- \*\*2022-12-19\*\*: Since November 16 I have not received a response, so I have reached a conclusion and I sent an email, \_"Hi Team, in the meantime it has been more than a month since you fixed the vulnerability. I understand that you are busy, which is why I thought your security advisory was not necessary, so I will send the CVE request to MITRE and publish a POC on my github account. Thank you and Best Regard, Gianluca".\_
- \*\*2023-01-10\*\*: I waited a few more days before publishing the poc, hoping to get a response on the requested Security Advisory (\_which I did not receive\_).
- \*\*2023-01-10\*\*: I requested the CVE to MITRE.
- \*\*2023-01-11\*\*:- I have obtained the [CVE-2023-22958](https://nvd.nist.gov/vuln/detail/CVE-2023-22958) and published the PoC
### Discovered by
#### [Gianluca Palma](https://www.linkedin.com/in/piuppi/) ([@piuppi](https://twitter.com/piuppi)) of [Engineering Ingegneria Informatica S.p.A.](https://www.eng.it)
### Proof of concept (POC)
#### Reproducing Steps
Here are the steps to reproduce it, with the relevant evidence:
- ##### The attacker can craft a malicious URL that points to the 2FA PIN validation page, below:
`https://WWW.YOUR-JIRA-PORTAL.ORG/plugins/servlet/twofactor/public/pinvalidation?target=https://youtu.be/dQw4w9WgXcQ`
as can be seen, there is a \*\*'target'\*\* parameter in the query string that points to the phishing site used by the attacker to steal credentials; a rickrolling link was used for this PoC.
- ##### Note that the victim user, at this stage is not yet authenticated on the JIRA portal, so they click on the link:
![Screenshot](images/1.png)
the application performs a redirect to \*\*'login.jsp'\*\* page by setting the GET parameter \*\*'os\_destination'\*\* that contains the full link sent by the attacker:
![Screenshot](images/2.png)
the redirect is performed:
![Screenshot](images/3.png)
as can be seen above, the user has not yet logged in, but the content of the GET parameter \*\*'os\_destination'\*\* returns the malicious link initially sent by the attacker.
- ##### At this point, the victim user enters his credentials to log in:
![Screenshot](images/4.png)
Again, as can be seen below, the login request this time sends a \*\*POST request\*\* always containing the parameter \*\*"os\_destination"\*\* with the malicious link sent by the attacker:
![Screenshot](images/5.png)
Then the application authenticates the user and performs a \*\*redirect (302)\*\* to the 2FA \*\*pinvalidation\*\* page, sending in the query string the vulnerable parameter \*\*'target'\*\* specified by the attacker :
![Screenshot](images/6.png)
the redirect is performed:
![Screenshot](images/7.png)
- ##### at this stage the \*\*secure Login 2FA plugin\*\* asks the victim user to open the Authenticator app on their mobile device and enter the \*\*OTP PIN\*\* received, below:
![Screenshot](images/8.png)
Next, the PIN is sent via a POST request, where, however, the vulnerable parameter \*\*'target'\*\* is again transmitted in GET:
![Screenshot](images/9.png)
Finally, the application performs the reindirect (302) to the URL established by the attacker, which, for example, could faithfully reproduce the \*\*JIRA login phishing page with an unexpected validation error related to the PIN code entered\*\*, causing the victim user to re-enter their credentials and PIN by capturing both (\_replay attack\_):
![Screenshot](images/10.png)
But for this PoC I used a Rick-rolling link :relaxed:
![Screenshot](images/11.png)
### Suggestions
To mitigate the open redirection vulnerability, it is important for web application developers to properly validate redirection URLs. There are several techniques that can be used for this purpose:
- Validate redirect URLs within the same domain: developers can configure the application to only allow redirects to URLs within the same domain.
- Validate redirect URLs using a list of allowed URLs: developers can maintain a list of URLs that are allowed for redirects and validate redirect URLs based on this list.
- Validate redirect URLs using a URL validation library: several libraries are available for validating redirect URLs, such as the "validator" library in Node.js.
- Manually validate redirect URLs: developers can manually validate redirect URLs using the appropriate method for their specific web application.
Additionally, developers should avoid using query or fragment parameters to specify redirect URLs, as these can be easily modified by the attacker. Instead, they should use a more secure method such as form hidden fields to specify redirect URLs.

