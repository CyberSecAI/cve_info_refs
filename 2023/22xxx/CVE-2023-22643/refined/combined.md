=== Content from bugzilla.suse.com_9a6274d9_20250114_233440.html ===


| Bugzilla – Bug 1206836 | VUL-0: CVE-2023-22643: libzypp-plugin-appdata: potential arbitrary code execution via shell injection due to `os.system` calls | Last modified: 2023-04-07 09:10:26 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1206836)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1206836**](show_bug.cgi?id=1206836)
(CVE-2023-22643)
- VUL-0: CVE-2023-22643: libzypp-plugin-appdata: potential arbitrary code execution via shell injection due to `os.system` calls

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2023-22643: libzypp-plugin-appdata: potential arbitrary code execu...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2023-22643 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Audits ([show other bugs](buglist.cgi?component=Audits&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P1 - Urgent **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Dominique Leuenberger | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/352703/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv3.1:SUSE:CVE-2023-22643:6.3:(AV:... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2023-01-04 12:36 UTC by Matthias Gerstner | | --- | --- | | Modified: | 2023-04-07 09:10 UTC ([History](show_activity.cgi?id=1206836)) | | CC List: | 6 users (show)  dimstar jcarricksmith rfrohl security-team sheela.chandran sreeves | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1206836) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Proposed patch**](attachment.cgi?id=863841 "View the content of the attachment") (631 bytes, patch)  [2023-01-04 13:48 UTC](#attach_863841 "Go to the comment associated with the attachment"), Dominique Leuenberger | [Details](attachment.cgi?id=863841&action=edit) | [Diff](attachment.cgi?id=863841&action=diff) | | [View All](attachment.cgi?bugid=1206836&action=viewall)  [Add an attachment](attachment.cgi?bugid=1206836&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1206836&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1206836#c0)  Matthias Gerstner   2023-01-04 12:36:30 UTC  ``` In [bug 1204314](show_bug.cgi?id=1204314 "RESOLVED FIXED - AUDIT-TASK: rpmlint: restrict installation of zypper plugins") I reviewed the current Zypper plugins we ship for openSUSE:Factory. libzypp-plugin-appdata is one of them.  While this plugin is a very simple and short Python script installed in      /usr/lib/zypp/plugins/appdata/InstallAppdata  it uses unsafe `os.system()` invocations that go through the shell and thus are subject to shell command injection.  We can find the following code in the script:      ```     # Install new appdata files - libzypp calls us with 6 parameters per repo:     # -R REPO_ALIAS -t REPO_TYPE -p REPO_METADATA_PATH [-R NEXT_REPO....]     # We can just blindly pass the parameters through to to helper     args=sys.argv[1:]          try:       while args[0] == "-R":         os.system("/usr/lib/AsHelper install %s %s %s %s %s %s" % (args[0], args[1], args[2], args[3], args[4], args[5]))         args=args[6:]     except IndexError:         pass     ```  So there are three potential input parameters that could contain shell code:  - REPO_ALIAS (free form string) - REPO_TYPE (typically "rpm-md") - REPO_METADATA_PATH (typically "/var/cache/zypp/raw/...")  The REPO_ALIAS is the most likely to contain dangerous characters. A reproducer to trigger this looks like this:      ```     root# zypper ar -f <http://download.opensuse.org/tumbleweed/repo/non-oss/> "; touch /root/evil ; echo "     root# zypper ref     root# ls -lh /root/evil     -rw-r--r-- 1 root root 0 Jan  4 13:25 /root/evil     ```  When checking strace then we'll find that the invocation of the plugins through zypper looks like this:  "/usr/lib/zypp/plugins/appdata/InstallAppdata", "-R", "; touch /root/evil ; echo ", "-t", "rpm-md", "-p", "/var/cache/zypp/raw/; touch _root_evil ; echo " [...]  So the REPO_METADATA_PATH also includes the alias, but it is transformed a bit, like slashes being replaced by underscores, resulting in a `touch _root_evil` that will cause this file also to come into existence in the CWD.  It is a bit bad that libzypp doesn't reject certain characters for the repository alias. But the way it is each individual plugin needs to cope with potentially dangerious input here.  The repository alias is not typically under attacker control but there could exist circumstances where this is the case, in more complex scenarios than a default SUSE installation. The exploitablility is limited, but if it can be exploited then the impact is arbitrary code execution. Thus a VUL-0 bug is justified here IMO. ``` [Comment 9](show_bug.cgi?id=1206836#c9)  Dominique Leuenberger   2023-01-05 10:24:42 UTC  ``` Outlined plan for the  update (as agreed with Robert):  Patch to be added to - SUSE:SLE-15:Update/libzypp-plugin-appdata - SUSE:SLE-15-SP1:Update/libzypp-plugin-appdata - SUSE:SLE-15-SP4:Update/libzypp-plugin-appdata  The difference between the versions is so minimal that we agreed to align the three packages  Between 15:Update and SP4:Update there are three chunks of diff:  * AppStream recommended instead of required (AppStream is only used by the KDE Software Center, not the SLE Shipped GNOME Software) * Hardcode %_prefix/lib instead of %_libexecdurL this is a NOP on SLE, as libexecdir == /usr/lib * systems service hardening added  I'm preparing the mbranch in IBS and will submit it ``` [Comment 15](show_bug.cgi?id=1206836#c15)  Robert Frohl   2023-01-17 11:51:47 UTC  ``` (In reply to Dominique Leuenberger from [comment #9](show_bug.cgi?id=1206836#c9)) > Patch to be added to > - SUSE:SLE-15:Update/libzypp-plugin-appdata > - SUSE:SLE-15-SP1:Update/libzypp-plugin-appdata > - SUSE:SLE-15-SP4:Update/libzypp-plugin-appdata  SLE-15 reached end of life in December and will not get updates anymore. ``` [Comment 16](show_bug.cgi?id=1206836#c16)  John Carrick Smith   2023-01-17 16:20:18 UTC  ``` What is currently in the update repo fails with  Wrong Digest  The expected checksum of file /var/tmp/AP_0x6MW4IW/noarch/libzypp-plugin-appdata-1.0.1+git.20180426-150400.18.3.1.noarch.rpm is 264889dc59298168d1240f66b69b21fe389936fbcf70516de628b5c8c5f99727, but the current checksum is e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.  The file has been changed by accident or by an attacker since the repository creator signed it. Using it is a big risk for the integrity and security of your system.  I can see that this is an active bug.  John ``` [Comment 17](show_bug.cgi?id=1206836#c17)  Swamp Workflow Management   2023-01-17 17:18:04 UTC  ``` SUSE-SU-2023:0095-1: An update that fixes one vulnerability is now available.  Category: security (important) Bug References: 1206836 CVE References: CVE-2023-22643 JIRA References:  Sources used: openSUSE Leap 15.4 (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150400.18.3.1 SUSE Linux Enterprise Module for Packagehub Subpackages 15-SP4 (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150400.18.3.1 SUSE Linux Enterprise Module for Desktop Applications 15-SP4 (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150400.18.3.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 18](show_bug.cgi?id=1206836#c18)  Dominique Leuenberger   2023-01-18 08:13:37 UTC  ``` :(  [   32s] libzypp-plugin-appdata.noarch: E: zypperplugin-file-digest-mismatch (Badness: 10000) /usr/lib/zypp/plugins/appdata/InstallAppdata expected sha256:659f9bdf79eebdca9f69a4924c0c3b53388ab3469c737759c1ea133eab460969, has:ba77e8dab356d70dfe0f38a63c9cced0b81d47c8af36b41f88fa30597330ff43 [   32s] A whitelisting related zypper plugin file changed in content. Packaging zypper [   32s] plugins requires a review and whitelisting by the SUSE security team. If the [   32s] package is intended for inclusion in any SUSE product please open a bug report [   32s] to request review of the package by the security team. Please refer to [   32s] [https://en.opensuse.org/openSUSE:Package_security_guidelines#audit_bugs](https://en.opensuse.org/openSUSE%3APackage_security_guidelines#audit_bugs) for [   32s] more information.  Can we please get that unblocked for Factory so I can submit this fix there too? Did not anticipate this extra loop ``` [Comment 19](show_bug.cgi?id=1206836#c19)  Matthias Gerstner   2023-01-18 08:50:18 UTC  ``` (In reply to dimstar@opensuse.org from [comment #18](show_bug.cgi?id=1206836#c18)) > Can we please get that unblocked for Factory so I can submit this fix there too? Did not anticipate this extra loop  yes this restriction got newly introduced and was the reason why I stumbled over this issue in the place. I whitelisted the vulnerable version since it was already there.  I forgot to tell you and prepare a new whitelisting. Sorry about that. I will take care of the adjustment now. ``` [Comment 20](show_bug.cgi?id=1206836#c20)  OBSbugzilla Bot   2023-01-18 10:55:04 UTC  ``` This is an autogenerated message for OBS integration: This bug (1206836) was mentioned in <https://build.opensuse.org/request/show/1059322> Factory / rpmlint ``` [Comment 21](show_bug.cgi?id=1206836#c21)  OBSbugzilla Bot   2023-01-19 18:55:10 UTC  ``` This is an autogenerated message for OBS integration: This bug (1206836) was mentioned in <https://build.opensuse.org/request/show/1059845> Factory / rpmlint ``` [Comment 22](show_bug.cgi?id=1206836#c22)  Sheela Chandran   2023-01-23 07:24:48 UTC  ``` Hello All,  There is a new conflict where customers are experiencing after the patch has been released.  /usr/lib/YaST2/bin/online_update Problem: the to be installed patch:SUSE-SLE-Module-Packagehub-Subpackages-15-SP4-2023-95-1.noarch conflicts with 'libzypp-plugin-appdata.noarch < 1.0.1+git.20180426-150400.18.3.1' provided by the installed libzypp-plugin-appdata-1.0.1+git.20180426-150400.16.5.noarch  Solution 1: deinstallation of libzypp-plugin-appdata-1.0.1+git.20180426-150400.16.5.noarch  Solution 2: do not install patch:SUSE-SLE-Module-Packagehub-Subpackages-15-SP4-2023-95-1.noarch  Choose from above solutions by number or cancel [1/2/c/d/?] (c): c  Do I need to raise a new bug for this or can be treated here itself? Please update. ``` [Comment 23](show_bug.cgi?id=1206836#c23)  Marcus Meissner   2023-01-23 10:11:47 UTC  ``` can you please check if the SLE Module Desktop Applications is enabled for updates?  It contains this package ``` [Comment 24](show_bug.cgi?id=1206836#c24)  Marcus Meissner   2023-01-23 10:14:22 UTC  ``` (e.g. the update needs both Package Hub and Desktop APplicatipons Module enabled for update) ``` [Comment 25](show_bug.cgi?id=1206836#c25)  Swamp Workflow Management   2023-01-25 17:18:46 UTC  ``` SUSE-SU-2023:0140-1: An update that solves one vulnerability and has one errata is now available.  Category: security (important) Bug References: 1181400,1206836 CVE References: CVE-2023-22643 JIRA References:  Sources used: SUSE Linux Enterprise Server for SAP 15-SP3 (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Linux Enterprise Server for SAP 15-SP2 (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Linux Enterprise Server for SAP 15-SP1 (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Linux Enterprise Server 15-SP3-LTSS (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Linux Enterprise Server 15-SP2-LTSS (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Linux Enterprise Server 15-SP1-LTSS (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Linux Enterprise Realtime Extension 15-SP3 (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Linux Enterprise High Performance Computing 15-SP3-LTSS (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Linux Enterprise High Performance Computing 15-SP3-ESPOS (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Linux Enterprise High Performance Computing 15-SP2-LTSS (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Linux Enterprise High Performance Computing 15-SP1-LTSS (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Enterprise Storage 7.1 (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Enterprise Storage 7 (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE Enterprise Storage 6 (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1 SUSE CaaS Platform 4.0 (src):    libzypp-plugin-appdata-1.0.1+git.20180426-150100.8.3.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 26](show_bug.cgi?id=1206836#c26)  Dominique Leuenberger   2023-03-01 11:55:59 UTC  ``` Fixed in upstream code base and patches have been released ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1206836)
* - [XML](show_bug.cgi?ctype=xml&id=1206836)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1206836)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1206836)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from build.opensuse.org_86e8ee84_20250115_130819.html ===

[![](https://build.opensuse.org/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--aa5cb6f11b842d915c34968e0a4de823d259dcc0/openSUSEBuildService.png)](/)

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

Log In

[![](/assets/favicon-eb1d8ba2a269175c910cae3ae95a5d0dca90274b90db45c8efe0988ec9efd85d.svg)](/)Log In

---

or

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")

* Collapse sidebar

1. Request 1059322

This request is superseded by
[request 1059845](/request/show/1059845)
([Show diff](/request/show/1059845?diff_to_superseded=1059322))

##### Overview

### Request 1059322 superseded

- Update to version 2.4.0+git20230118.aac2cf3:

 \* zypper-plugins whitelist: adjust libzypp-plugin-appdata (bsc#1206836)

 \* simplify str.split

 \* disable opensuse-tumbleweed-aarch64 due to system crash

- Update to version 2.4.0+git20230118.42ed609:

 \* Update D-Bus whitelisting for NetworkManager-libreswan (bsc#1206757)

* Created by
  [fbonazzi](/users/fbonazzi)
  almost 2 years ago
* In state
  [superseded](/request/show/1059322#request-history)
* Supersedes
  [1059288](/request/show/1059288)
* Superseded by
  [1059845](/request/show/1059845)
* Open review for

  [openSUSE:Factory:Staging:I](/project/users/openSUSE%3AFactory%3AStaging%3AI)

* [Submit rpmlint](#Submit_rpmlint2781158)

Loading...

* [Comments for request 1059322
  0](#comments)

*No comments available*

##### Request History

![Filippo Bonazzi's avatar](https://www.gravatar.com/avatar/c27e7fa1596f735a7a7364c9ae384d37?s=38&d=robohash "Filippo Bonazzi")

[fbonazzi](/users/fbonazzi)
created request
[almost 2 years ago](#request-creation "2023-01-18 10:15 UTC")

- Update to version 2.4.0+git20230118.aac2cf3:

 \* zypper-plugins whitelist: adjust libzypp-plugin-appdata (bsc#1206836)

 \* simplify str.split

 \* disable opensuse-tumbleweed-aarch64 due to system crash

- Update to version 2.4.0+git20230118.42ed609:

 \* Update D-Bus whitelisting for NetworkManager-libreswan (bsc#1206757)

---

![Saul Goodman's avatar](https://www.gravatar.com/avatar/ffc053e2eedefdebcd8cbbc514d9dc11?s=38&d=robohash "Saul Goodman")

[licensedigger](/users/licensedigger)
accepted review
[almost 2 years ago](#status-history-14888669 "2023-01-18 10:20 UTC")

ok

---

![Factory Auto's avatar](https://www.gravatar.com/avatar/3be6bec62ce4af49b4b555cbd8bd3b9d?s=38&d=robohash "Factory Auto")

[factory-auto](/users/factory-auto)
added opensuse-review-team as a reviewer
[almost 2 years ago](#status-history-14888678 "2023-01-18 10:20 UTC")

Please review sources

---

![Factory Auto's avatar](https://www.gravatar.com/avatar/3be6bec62ce4af49b4b555cbd8bd3b9d?s=38&d=robohash "Factory Auto")

[factory-auto](/users/factory-auto)
accepted review
[almost 2 years ago](#status-history-14888681 "2023-01-18 10:20 UTC")

Check script succeeded

---

![Staging Bot's avatar](https://www.gravatar.com/avatar/d41b2f36932f8e2d3648816d60497bb9?s=38&d=robohash "Staging Bot")

[staging-bot](/users/staging-bot)
set openSUSE:Factory:Staging:I as a staging project
[almost 2 years ago](#status-history-14893286 "2023-01-18 11:05 UTC")

Being evaluated by staging project "openSUSE:Factory:Staging:I"

---

![Staging Bot's avatar](https://www.gravatar.com/avatar/d41b2f36932f8e2d3648816d60497bb9?s=38&d=robohash "Staging Bot")

[staging-bot](/users/staging-bot)
accepted review
[almost 2 years ago](#status-history-14893289 "2023-01-18 11:05 UTC")

Picked "openSUSE:Factory:Staging:I"

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/5cdd10d836bdda3796cf6bc1ab2d5a78?s=38&d=robohash "Dominique Leuenberger")

[dimstar](/users/dimstar)
accepted review
[almost 2 years ago](#status-history-14893379 "2023-01-18 11:12 UTC")

---

![Filippo Bonazzi's avatar](https://www.gravatar.com/avatar/c27e7fa1596f735a7a7364c9ae384d37?s=38&d=robohash "Filippo Bonazzi")

[fbonazzi](/users/fbonazzi)
[superseded request](/request/show/1059845)
[almost 2 years ago](#status-history-14900372 "2023-01-19 18:20 UTC")

##### Package Maintainers

OK

**Locations**

* [Projects](/project)
* [Search](/search)
* [Status Monitor](/monitor)

**Help**

* [OpenBuildService.org](https://openbuildservice.org/)
* [Documentation](https://openbuildservice.org/help/manuals/)
* [API Documentation](/apidocs/index)
* [Code of Conduct](/code_of_conduct)

**Contact**

* [Support](https://openbuildservice.org/support/)
* [@OBShq](https://fosstodon.org/%40obshq)
* [Terms](https://en.opensuse.org/Terms_of_site)

openSUSE Build Service is sponsored by
[![](/assets/icons/sponsor_suse-92006bbd693f5f675ccab53afe3e9c858aada01882b490fa784d8cc8a9f4f080.png)](http://www.suse.com "Enterprise Linux you can rely on.")

[![](/assets/icons/sponsor_amd-5ec958d97e60089cad23346048c0b79d2144408deda3d0495fe023bf29ec0d7b.png)](http://www.amd.com/ "Enabling today. Inspiring tomorrow.")

[![](/assets/icons/sponsor_b1-systems-a5bc5a49e7fc7854f9a688f873b074330a68bf7d286c4fda6bd0dd2e592752da.png)](http://www.b1-systems.de/en/homepage/ "Linux / Open Source Consulting, Training, Development & Support")

[![](/assets/icons/sponsor_heinlein-dc9ce64ab5cb25a15c4fd9a1b743f7886867932283f1dace07f0599a663a222a.png)](https://www.heinlein-support.de/ "We provide Knowledge and Experience")

[![](/assets/icons/sponsor_apm-1a5a654e5e7ed3df9d4717a1d68f6c4593096304173961c8b486a3ff3bddde75.png)](https://www.apm.com "Build the future of ARMv8 on Applied Micro")

The Open Build Service is an
[openSUSE project](https://www.opensuse.org).

* [Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
* Log In
* Places

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")



=== Content from en.opensuse.org_20da7d90_20250115_130818.html ===


[![🦎](https://static.opensuse.org/favicon.svg "openSUSE")
Wiki](/)

* Navigation
  [Home](/Main_Page)[Project](/Portal%3AProject)[Distribution](/Portal%3ADistribution)[Support](/Portal%3ASupport)[Contact](/openSUSE%3ACommunication_channels)[Site map](/openSUSE%3ACategory_browse)

* Help
  [Wiki](/Portal%3AWiki)[Create a Page](/Help%3AConcept)[Change a Page](/Help%3AEditing)[Find a Page](/Help%3ASearch)

* Tools
  [What links here](/Special%3AWhatLinksHere/openSUSE%3APackage_security_guidelines "A list of all wiki pages that link here [j]")[Related changes](/Special%3ARecentChangesLinked/openSUSE%3APackage_security_guidelines "Recent changes in pages linked from this page [k]")[Special pages](/Special%3ASpecialPages "A list of all special pages [q]")Printable version[Permanent link](/index.php?title=openSUSE:Package_security_guidelines&oldid=179717 "Permanent link to this revision of the page")[Page information](/index.php?title=openSUSE:Package_security_guidelines&action=info "More information about this page")

* In other languages
  [Deutsch](http://de.opensuse.org/openSUSE%3ASicherheitsrichtlinien_f%C3%BCr_Pakete "openSUSE:Sicherheitsrichtlinien für Pakete – Deutsch")[中文](http://zh.opensuse.org/openSUSE%3APackage_security_guidelines "openSUSE:Package security guidelines – 中文")

* Log in

* [Project page](/openSUSE%3APackage_security_guidelines "View the project page [a]")
* [Discussion](/index.php?title=openSUSE_talk:Package_security_guidelines&action=edit&redlink=1 "Discussion about the content page [t]")

[View](/openSUSE%3APackage_security_guidelines)
[View source](/index.php?title=openSUSE:Package_security_guidelines&action=edit "This page is protected.
You can view its source [e]")
[History](/index.php?title=openSUSE:Package_security_guidelines&action=history "Past revisions of this page [h]")

# openSUSE:Package security guidelines

Jump to: [navigation](#mw-head),
[search](#p-search)

Packaging documentation

* [AppStore](/openSUSE%3AAppStore "openSUSE:AppStore")
* [Build Service cross distribution howto](/openSUSE%3ABuild_Service_cross_distribution_howto "openSUSE:Build Service cross distribution howto")
* [Build Service Tips and Tricks](/openSUSE%3ABuild_Service_Tips_and_Tricks "openSUSE:Build Service Tips and Tricks")
* [Build Service Tutorial](/openSUSE%3ABuild_Service_Tutorial "openSUSE:Build Service Tutorial")
* [Bundled software policy](/openSUSE%3ABundled_software_policy "openSUSE:Bundled software policy")
* [Creating a changes file (RPM)](/openSUSE%3ACreating_a_changes_file_%28RPM%29 "openSUSE:Creating a changes file (RPM)")
* [Firewalld/RPM Packaging](/Firewalld/RPM_Packaging "Firewalld/RPM Packaging")
* [Java jpackage-utils](/openSUSE%3AJava_jpackage-utils "openSUSE:Java jpackage-utils")
* [Java RPM Macros](/openSUSE%3AJava_RPM_Macros "openSUSE:Java RPM Macros")
* [Julia](/Julia "Julia")
* [Mvyskocil/Shared library packaging policy](/User%3AMvyskocil/Shared_library_packaging_policy "User:Mvyskocil/Shared library packaging policy")
* [Package Conditional Build Dependencies](/openSUSE%3APackage_Conditional_Build_Dependencies "openSUSE:Package Conditional Build Dependencies")
* [Package dependencies](/openSUSE%3APackage_dependencies "openSUSE:Package dependencies")
* [Package description guidelines](/openSUSE%3APackage_description_guidelines "openSUSE:Package description guidelines")
* [Package group guidelines](/openSUSE%3APackage_group_guidelines "openSUSE:Package group guidelines")
* [Package maintainership guide](/openSUSE%3APackage_maintainership_guide "openSUSE:Package maintainership guide")
* [Package naming guidelines](/openSUSE%3APackage_naming_guidelines "openSUSE:Package naming guidelines")
* [Package security guidelines](/openSUSE%3APackage_security_guidelines "openSUSE:Package security guidelines")
* [Package source verification](/openSUSE%3APackage_source_verification "openSUSE:Package source verification")
* [Package versioning guidelines](/openSUSE%3APackage_versioning_guidelines "openSUSE:Package versioning guidelines")
* [Packaging Bazel](/openSUSE%3APackaging_Bazel "openSUSE:Packaging Bazel")
* [Packaging Branding](/openSUSE%3APackaging_Branding "openSUSE:Packaging Branding")
* [Packaging Bundler](/openSUSE%3APackaging_Bundler "openSUSE:Packaging Bundler")
* [Packaging checks](/openSUSE%3APackaging_checks "openSUSE:Packaging checks")
* [Packaging Conventions RPM Macros](/openSUSE%3APackaging_Conventions_RPM_Macros "openSUSE:Packaging Conventions RPM Macros")
* [Packaging desktop menu categories](/openSUSE%3APackaging_desktop_menu_categories "openSUSE:Packaging desktop menu categories")
* [Packaging Electron](/openSUSE%3APackaging_Electron "openSUSE:Packaging Electron")
* [Packaging Erlang](/openSUSE%3APackaging_Erlang "openSUSE:Packaging Erlang")
* [Packaging Fonts](/openSUSE%3APackaging_Fonts "openSUSE:Packaging Fonts")
* [Packaging for transactional-updates](/openSUSE%3APackaging_for_transactional-updates "openSUSE:Packaging for transactional-updates")
* [Packaging Games](/openSUSE%3APackaging_Games "openSUSE:Packaging Games")
* [Packaging Go](/openSUSE%3APackaging_Go "openSUSE:Packaging Go")
* [Packaging guidelines change process](/openSUSE%3APackaging_guidelines_change_process "openSUSE:Packaging guidelines change process")
* [Packaging Haskell](/openSUSE%3APackaging_Haskell "openSUSE:Packaging Haskell")
* [Packaging init scripts](/openSUSE%3APackaging_init_scripts "openSUSE:Packaging init scripts")
* [Packaging Java](/openSUSE%3APackaging_Java "openSUSE:Packaging Java")
* [Packaging Lisp](/openSUSE%3APackaging_Lisp "openSUSE:Packaging Lisp")
* [Packaging Lua](/openSUSE%3APackaging_Lua "openSUSE:Packaging Lua")
* [Packaging Multiple Version guidelines](/openSUSE%3APackaging_Multiple_Version_guidelines "openSUSE:Packaging Multiple Version guidelines")
* [Packaging nodejs](/openSUSE%3APackaging_nodejs "openSUSE:Packaging nodejs")
* [Packaging Patches guidelines](/openSUSE%3APackaging_Patches_guidelines "openSUSE:Packaging Patches guidelines")
* [Packaging Perl](/openSUSE%3APackaging_Perl "openSUSE:Packaging Perl")
* [Packaging PHP](/openSUSE%3APackaging_PHP "openSUSE:Packaging PHP")
* [Packaging PyQt and SIP](/openSUSE%3APackaging_PyQt_and_SIP "openSUSE:Packaging PyQt and SIP")
* [Packaging Python](/openSUSE%3APackaging_Python "openSUSE:Packaging Python")
* [Packaging R](/openSUSE%3APackaging_R "openSUSE:Packaging R")
* [Packaging Ruby](/openSUSE%3APackaging_Ruby "openSUSE:Packaging Ruby")
* [Packaging Rust Software](/openSUSE%3APackaging_Rust_Software "openSUSE:Packaging Rust Software")
* [Packaging Rustlang](/Packaging_Rustlang "Packaging Rustlang")
* [Packaging scriptlet snippets](/openSUSE%3APackaging_scriptlet_snippets "openSUSE:Packaging scriptlet snippets")
* [Packaging vdr](/openSUSE%3APackaging_vdr "openSUSE:Packaging vdr")
* [Packaging wxWidgets](/openSUSE%3APackaging_wxWidgets "openSUSE:Packaging wxWidgets")
* [Packaging XML Schemas and Stylesheets](/openSUSE%3APackaging_XML_Schemas_and_Stylesheets "openSUSE:Packaging XML Schemas and Stylesheets")
* [Packaging/Users And Groups](/Packaging/Users_And_Groups "Packaging/Users And Groups")
* [Patches Guidelines for X11:XOrg Project](/openSUSE%3APatches_Guidelines_for_X11%3AXOrg_Project "openSUSE:Patches Guidelines for X11:XOrg Project")
* [RPM conditional builds](/openSUSE%3ARPM_conditional_builds "openSUSE:RPM conditional builds")
* [Ruby Gem Strategies](/openSUSE%3ARuby_Gem_Strategies "openSUSE:Ruby Gem Strategies")
* [Rust](/Rust "Rust")
* [Science HPC Packaging](/openSUSE%3AScience_HPC_Packaging "openSUSE:Science HPC Packaging")
* [Shared library packaging policy](/openSUSE%3AShared_library_packaging_policy "openSUSE:Shared library packaging policy")
* [Specfile guidelines](/openSUSE%3ASpecfile_guidelines "openSUSE:Specfile guidelines")
* [Specfile pseudotags](/openSUSE%3ASpecfile_pseudotags "openSUSE:Specfile pseudotags")
* [Systemd packaging guidelines](/openSUSE%3ASystemd_packaging_guidelines "openSUSE:Systemd packaging guidelines")
* [Packaging guidelines](/openSUSE%3APackaging_guidelines "openSUSE:Packaging guidelines")
* [Zig](/Zig "Zig")

The security guidelines regulate all the details of secure packaging for the openSUSE distribution. To avoid unpleasant surprises packages have to adhere to certain security policies. Exceptions from the common security policies have to be discussed with and approved by the [openSUSE:Security team](/openSUSE%3ASecurity_team "openSUSE:Security team").

## Contents

* [1 Daemons](#Daemons)
* [2 Setuid Binaries](#Setuid_Binaries)
  + [2.1 Packaging setuid binaries](#Packaging_setuid_binaries)
* [3 World Writable Directories](#World_Writable_Directories)
* [4 Group Writable Directories](#Group_Writable_Directories)
* [5 Firewall Settings](#Firewall_Settings)
* [6 DBus Services](#DBus_Services)
* [7 PolicyKit Privileges](#PolicyKit_Privileges)
* [8 Passwords](#Passwords)
* [9 Use Of Cryptography](#Use_Of_Cryptography)
* [10 Audit Bugs for the Security Team](#Audit_Bugs_for_the_Security_Team)
  + [10.1 Audit Bug Lifecycle](#Audit_Bug_Lifecycle)
  + [10.2 rpmlint Errors in Packages](#rpmlint_Errors_in_Packages)
  + [10.3 Rpmlint whitelisting based on file digests](#Rpmlint_whitelisting_based_on_file_digests)
  + [10.4 Rpmlint whitelisting errors in home and devel Projects](#Rpmlint_whitelisting_errors_in_home_and_devel_Projects)
  + [10.5 How the Whitelisting Process Works](#How_the_Whitelisting_Process_Works)
  + [10.6 Fixing Builds of Older Distributions in your Devel Project](#Fixing_Builds_of_Older_Distributions_in_your_Devel_Project)
## Daemons

* installation of a package must not activate any daemon. That means for example init scripts must not be insserv'd in %post, xinetd files must contain 'disable = yes'.
* daemons should run under an unprivileged user id. That usually means the package has to create the user in it's %pre section. Daemons should avoid running as root and must not use the 'nobody' user. It's fine to use group 'nogroup' though.
* daemons should be restarted if the package was upgraded so security updates take effect immediately
* daemons that open TCP or UDP ports or otherwise receive input from potentially untrusted networks should receive an audit from the security team prior to inclusion in the distribution.

## Setuid Binaries

Packages are not allowed to include setuid/setgid binaries unless the [SUSE Security Team](/openSUSE%3ASecurity_team "openSUSE:Security team") has reviewed the source code and granted explicit permission.

To request an audit for setuid binaries, open a bug report assigned to `security-team@suse.de` and/or send an e-mail to `security@suse.de`.

The bug report should include the exact location of the source code, the affected files and an explanation why the setuid bit is required. If the audit turns out positive, the security team will include permission settings for the new files in the 'permissions' package. The build system will reject packages with setuid binaries that are not listed in the permissions package.

In general having a setuid bit by default requires good reasons. Most of the time it's better to ship without setuid bit but including instructions how to modify /etc/permissions.local instead if needed.

setuid binaries need to be packaged specially. See the [%verify\_permissions](/openSUSE%3APackaging_Conventions_RPM_Macros#.25verify_permissions "openSUSE:Packaging Conventions RPM Macros") macro for examples.

### Packaging setuid binaries

Security-relevant permissions are handled via `/etc/permissions*` on openSUSE.
Read the files `/etc/permissions*` to learn about the basics.

If you want to create a package with suid programs:

* Add a `Requires(post): permissions` header to your spec file.
* In the `%files` section, define the attributes of the files listed in your permissions files as they are defined for `permissions.secure`. Instruct `rpmverify` to **not** check ownership or permissions.
* Add a `%post` scriptlet that sets your package's permissions according to the system's current security level.
* Add a `%verifyscript` scriptlet that checks your package's permissions according to the system's current security level.

Because the above contains a few non-obvious details, here's a stripped down example:

```
[...]
PreReq:         permissions
[...]

```
```
%if 0%{?suse_version} >= 1120
%verifyscript
%verify_permissions -e %_bindir/mysuidprogram
%endif

%post
%if 0%{?set_permissions:1}
    %set_permissions %name
%else
    %run_permissions
%endif

%files
[...]
%verify(not user group mode) %attr(0711,root,root) %_bindir/mysuidprogram
[...]

```

To do temporary builds in your home project:

* Use the package-specific permissions that can be defined through files in `/etc/permissions.d/`.

* Create `permissions{,.easy,.secure,.paranoid}` files for your package. `permissions` is used if no file `permissions.*` matching the system's current security setting is found. As a rule of thumb, `permissions.easy` should contain permissions as installed by `make install`, `permissions.paranoid` should remove all suid bits (even if this breaks functionality), and `permissions.secure` can be something in between.
* Add these permissions files as sources to the spec file, and have `%install` install them in `%buildroot/%_sysconfdir/permissions.d/packagename[.suffix]`.
* In order to avoid rpmlint's error messages about disallowed permissions files, create a file `packagename-rpmlintrc` containing the line `setBadness('permissions-unauthorized-file', 333)`, and list it as a Source in your spec file. (Modify the "333" if you have fewer or more than 3 disallowed files.)

Please note that all these workarounds must be removed before the package is submitted to the openSUSE distribution.

## World Writable Directories

In general world writable directories should be avoided. If a package desperately needs world writable directories the same rules as for setuid binaries apply.

## Group Writable Directories

There is no build check for directories writable by some special group and no review by the security-team needed. However, packagers should be aware that directories inside group writable directories cannot be packaged securely and may allow members of the group to elevate their privileges to root. In other words *never* package directories inside group writable directories.

## Firewall Settings

No package is allowed to modify SuSEfirewall's configuration file. An exception is granted for the yast2 firewall module. Any other application must use the interface offered by the yast2 firewall module to change firewall settings. Changing the firewall settings must always require explicit confirmation of the user.

## DBus Services

Programs that offer services via the system DBUS must receive an audit from the security team prior to inclusion in the distribution. In general the same rules apply as for any other daemon.

## PolicyKit Privileges

Programs that carry out privileged operations on behalf of the user (such as e.g. changing the clock) should define a PolicyKit privilege which a user is required to possess for a specific action to be carried out. Use of PolicyKit privileges has to be audited by the security team prior to inclusion in the distribution

## Passwords

Packages must not be preconfigured with fixed passwords, certificates etc. Instead, the user must be forced to set a password prior to first usage.

## Use Of Cryptography

In general packages must not implement their own cryptographic algorithms but should use either of the following implementations:

* mozilla-nss (preferred)
* openssl
* gcrypt
* gnutls
* kernel crypto interface (kernel modules only)

Preferably encryption and hash algorithms should be configurable and set to currently considered safe algorithms (e.g. AES, SHA-3). Use of MD5 or SHA-1 as cryptographic signatures are not safe anymore.

Packages should not ship their own set of trusted x509 certificates. Instead, /etc/ssl/certs should be used as fallback.

## Audit Bugs for the Security Team

A number of security related program features require a whitelisting by the SUSE security team, before they can be packaged and submitted to Factory or any [open]SUSE product. Among these are the following situations:

* binaries installed by the package carry a **setuid** or **setgid** bit. This allows regular users to run the binary with elevated privileges. These kinds of binaries are difficult to implement correctly in a secure way. Therefore, the security team would like to avoid adding any additional set\*id binaries to the distribution. If there is no way around it then a thorough review is necessary.
* new **D-Bus services** are installed by the package, that can be activated dynamically or via systemd units. D-Bus services often run as root and expose interfaces to regular users. Therefore, these cases are also security sensitive.
* **systemd services** are required to be **disabled by default**. Only a small number of packages is currently allowed to be enabled by default right after installing it. Other packages need to be enabled explicitly by the user. New default-enabled systemd services need to be reviewed as well.
* new **PAM modules** are installed by the package. They also require a security team review. Badly implemented PAM modules may cause user authentication to always succeed or otherwise badly influence security.
* new **polkit actions** or **polkit rules** are added. Polkit is an authentication framework that allows to authenticate individual operations instead of just allowing all or nothing. While this sounds (and is) good it still needs to be done right in each implementation. Therefore, this also requires a code review.
* **cron jobs** are installed in /etc/cron.\*. Cron jobs can also easily introduce security issues. Note that by now most new packages are encouraged to use systemd timers instead of classic cron jobs.
* directories installed by the package are world-writable, carry a sticky bit or a setgid bit
* devices files are installed by the package
* sudo drop-in configuration files are installed into /etc/sudoers.d
* certain security sensitive systemd-tmpfiles drop-in configuration files are installed into /usr/lib/tmpfiles.d

The SUSE security team continuously works to extend the coverage of security
sensitive package features. Therefore, this list is not exhaustive and new
restrictions can become active over time.

If you add one of these items to your package then an rpmlint error
will appear. If your package is affected by any of these restrictions and you
want to submit the package to openSUSE:Factory or another production
project then please open a bug in [Bugzilla](https://bugzilla.opensuse.org),
assign it to **security-team@suse.de** and use a summary line that follows this pattern:

```
   AUDIT-0: [package-name]: [topic]

```

So in a real example it would look like this:

```
   AUDIT-0: mypackage: review of D-Bus service org.mypackage.myservice

```

In the bug description you should state the rpmlint error message
and point to the location of the package in the build service. A member of the
security team will then take care of the review and perform the necessary
actions. One of the following bug creation templates can be used to create the
bug, you only need to fill in the preset summary and description:

* [Bug creation template for community users](https://bugzilla.opensuse.org/enter_bug.cgi?alias=&assigned_to=security-team%40suse.de&attach_text=&blocked=&bug_file_loc=http%3A%2F%2F&bug_severity=Normal&bug_status=NEW&cf_biz_priority=&cf_blocker=---&cf_foundby=---&cf_nts_priority=&comment=For%20my%20package%20found%20in%20OBS%20in%20%3Cproject%3E%3A%3Cpackage%3E%20I%20would%20like%20a%20whitelisting%20for%20the%20following%20rpmlint%20error%3A%0D%0A%0D%0A%3Crelevant%20output%20from%20build%20log%3E&component=Security&contenttypeentry=&contenttypemethod=autodetect&contenttypeselection=text%2Fplain&data=&deadline=&defined_groups=1&dependson=&description=&estimated_time=&flag_type-2=X&flag_type-3=X&flag_type-4=X&form_name=enter_bug&keywords=&maketemplate=Remember%20values%20as%20bookmarkable%20template&op_sys=Other&product=openSUSE%20Tumbleweed&qa_contact=security-team%40suse.de&rep_platform=Other&requestee_type-2=&requestee_type-4=&short_desc=AUDIT-0%3A%20%3Cpackage%20name%3E%3A%20%3Ctopic%3E&version=Current)
* [Bug creation template for SUSE internal employees](https://bugzilla.suse.com/enter_bug.cgi?alias=&assigned_to=security-team%40suse.de&attach_text=&blocked=&bug_file_loc=http%3A%2F%2F&bug_severity=Normal&bug_status=NEW&cf_biz_priority=&cf_blocker=---&cf_foundby=---&cf_nts_priority=&comment=For%20my%20package%20found%20in%20OBS%20in%20%3Cproject%3E%3A%3Cpackage%3E%20I%20would%20like%20a%20whitelisting%20for%20the%20following%20rpmlint%20error%3A%0D%0A%0D%0A%3Crelevant%20output%20from%20build%20log%3E&component=Audits&contenttypeentry=&contenttypemethod=autodetect&contenttypeselection=text%2Fplain&data=&deadline=&defined_groups=1&dependson=&description=&estimated_time=&flag_type-2=X&flag_type-3=X&flag_type-4=X&form_name=enter_bug&keywords=&maketemplate=Remember%20values%20as%20bookmarkable%20template&op_sys=Other&product=SUSE%20Security%20Incidents&qa_contact=security-team%40suse.de&rep_platform=Other&requestee_type-2=&requestee_type-4=&short_desc=AUDIT-0%3A%20%3Cpackage%20name%3E%3A%20%3Ctopic%3E&version=unspecified)

Please submit review requests early since reviewing can take a long time (at
least a couple of days, mostly a week or two, sometimes longer) and you will be
blocked from having your package added to openSUSE:Factory before the
review is finished.

#### Audit Bug Lifecycle

The original audit bug will be used as a tracker bug for all the findings identified by the security team. Individual findings will be tracked as new bugs that block the original bug and have an AUDIT-FIND tag in the bug summary field. Once the audit is finished its tag will be changed from AUDIT-0 to AUDIT-TRACKER to indicate that it is only used as a tracker for the findings and the audit itself is done.

The number suffix in AUDIT-0 provides a rough categorization of priority for the review. Zero is the default and highest priority. AUDIT-1 is for topics that don't require immediate attention. AUDIT-2 or AUDIT-STALE is for reviews that are stuck for one reason or another and cannot currently progress (as seen from the SUSE security team side).

For AUDIT bugs that are solely concerned with backporting whitelistings to other SUSE products (e.g. to SUSE Linux Enterprise), we also rename the tag to AUDIT-WHITELIST. This is an indicator that no in-depth review is going on but mostly a maintenance process.

### `rpmlint` Errors in Packages

For reference, some examples of the possible rpmlint error messages that can
occur in a package are listed in the following table:

| Category | Error Messages |
| --- | --- |
| Polkit Privileges | ``` rpmlint-integration-test.x86_64: E: polkit-untracked-privilege (Badness: 10000) org.opensuse.rpmlint-test.test1 (auth_admin:auth_admin:auth_admin_keep) rpmlint-integration-test.x86_64: E: polkit-file-unauthorized (Badness: 10000) /usr/share/polkit-1/rules.d/myrules (file digest sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855) rpmlint-integration-test.x86_64: E: polkit-file-unauthorized (Badness: 10000) /etc/polkit-1/rules.d/90-default-privs.rules (file digest sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855)  ``` |
| D-Bus Services | ``` rpmlint-integration-test.x86_64: E: dbus-file-unauthorized (Badness: 10000) /etc/dbus-1/system.d/com.suse.dbus.testing.conf (file digest sha256:fac51ad567667cdba707ac1d9410fea54110b3ee11dcf19a2eba34a1405070ac) rpmlint-integration-test.x86_64: E: dbus-file-digest-mismatch (Badness: 10000) /etc/dbus-1/system.d/rpmlint_mismatch.conf expected sha256:4a5e8e9ca514c73f1dbee55e88c4d75a235473c1d5cef4751d84016833961fdf, has:504c5a60b7173794e565755122ab77beaec9bcf208fb97a40237cb57c67b5a17  ``` |
| PAM Modules | ``` rpmlint-integration-test.x86_64: E: pam-file-unauthorized (Badness: 10000) /usr/lib64/security/mypam.so (file digest sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4 649b934ca495991b7852b855) ``` |
| Set\*id bits | ``` rpmlint-integration-test.x86_64: E: permissions-file-setuid-bit (Badness: 10000) /usr/bin/setgidbin is packaged with setuid/setgid bits (02755) rpmlint-integration-test.x86_64: E: permissions-file-setuid-bit (Badness: 10000) /usr/bin/setuidbin is packaged with setuid/setgid bits (04755)  ``` |

### Rpmlint whitelisting based on file digests

For some whitelistings the SUSE security team takes file contents into account. This means that
a whitelisting will not only apply to a certain filename a package installs, but also to the
exact content that file has. The purpose of this is for the security team to become aware of
changes in sensitive items that are either introduced upstream or by packagers.

If the content of an already whitelisted file changes you will get an error message like this:

```
rpmlint-integration-test.x86_64: E: dbus-file-digest-mismatch (Badness: 10000) /etc/dbus-1/system.d/rpmlint_mismatch.conf expected sha256:4a5e8e9ca514c73f1dbee55e88c4d75a235473c1d5cef4751d84016833961fdf, has:504c5a60b7173794e565755122ab77beaec9bcf208fb97a40237cb57c67b5a17

```

In this case please open up a **new** follow-up AUDIT bug and the security team will
review the changes and whitelist the new file digest if all is well. These
follow-up audits usually will be quicker than the initial audits.

To avoid unnecessary administration if non-functional changes are introduces to whitelisted files,
the whitelisting checks support normalization of XML and shell style configuration files. As part
of the normalization whitespace and comment lines are removed from the file and the hash digest is
calculated for the filtered file content. This means that changes in said whitespace or comments will
not trigger an rpmlint error, but only actual changes in content.

### Rpmlint whitelisting errors in home and devel Projects

The security related rpmlint errors are supposed to protect openSUSE:Factory
from packages that are more likely to introduce security issues. We don't want to block
you, however, while developing a package in a home or devel project or if you don't
intend to currently submit a package to openSUSE:Factory. Therefore
the badness values for packaging artifacts that are not whitelisted will be low
when building in home and devel projects but will be high when building in the
openSUSE:Factory project.

Remember, however, that your package will not successfully build in the openSUSE:Factory
project until a review has been performed and a whitelisting has been submitted by the
security team. This can take a longer time. So create AUDIT bugs early on if you
plan to submit such a package to Factory.

### How the Whitelisting Process Works

Once you have opened an AUDIT bug for the security team roughly the following
will happen:

* a member of the security team will confirm your request and give you some initial information.
* when a security engineer is working on the bug, findings will be documented by it as the review goes along. If any critical security concerns or issues are found then the request will be declined. Sometimes you will be asked to improve certain aspects of the package for better security. In the best case you need to do nothing else and the review passes.
* when the review has passed, the security engineer will submit a whitelisting for your package to make the rpmlint error go away.

So when will the whitelisting become effective? The whitelisting is contained
in certain OBS packages depending on the type of whitelisting:

* for polkit privileges the whitelisting is in package *Base:System/polkit-default-privs*
* for D-Bus services, PAM modules and anything not explicitly listed here the whitelisting is in package *devel:openSUSE:Factory:rpmlint/rpmlint*
* for setuid binaries the whitelisting is in package *Base:System/permissions*
* for default-enabled systemd services the whitelisting is in package *Base:System/systemd-presets-branding-openSUSE* for openSUSE and in *systemd-presets-branding-SLE* for SUSE enterprise.

The security engineer that is working on the AUDIT bug will make a
submission to the appropriate package for openSUSE:Factory. Once this
submission arrives in the OBS, an automated message is also posted in
the AUDIT bug. The review and testing process in OBS can take a couple of days
before the whitelisting is accepted to openSUSE:Factory. You can still
submit your affected package to openSUSE:Factory, too. For this to work
you should note in the submission comment that the submission should be
handled **in the same staging project as the whitelisting**
submission**. Example comment:**

```
Please handle this submission together with sr#123456 which contains
the whitelisting for this package.

```

This way your submission will be built against the whitelisting
submission in the same staging project and can successfully build.
The whitelisting update and your package update can then happen
together.

Once the whitelisting is accepted to Factory you can build your package
successfully against the openSUSE:Factory standard repository. If you
want to build against the openSUSE:Factory snapshot repository then you
will need to wait for a new Tumbleweed snapshot to be released that
contains the whitelisting update. You can determine this by following the
[Factory mailing list](https://lists.opensuse.org/opensuse-factory/) or by
looking into the *Changes files* on the
[download server](https://download.opensuse.org/tumbleweed/iso/).

When you are backporting features to older openSUSE or SUSE distributions
then it can happen that you will be needing a whitelisting backported, too.
In this case you need to inform the responsible security engineer about it
and the whitelisting will also be backported by way of a maintenance
update. You can create an AUDIT-WHITELIST bug for us to keep track of the
process.

### Fixing Builds of Older Distributions in your Devel Project

Once there is a whitelisting in place for your package and it successfully
builds against Factory you might notice that builds of your devel package
against Repositories for older existing distributions are still failing. This
is only logical, because in the older distributions no whitelisting for your
security related feature is in place and in most cases also shouldn't be.
There's two things you can do about this:

* you can simply disable the repositories for the older distributions, thereby not having them building at all anymore.
* you can ask the security-team to backport the whitelisting to the older codestreams. This should only be the exception, however.

Retrieved from "<https://en.opensuse.org/index.php?title=openSUSE:Package_security_guidelines&oldid=179717>"

[Categories](/Special%3ACategories "Special:Categories"):

* [Pages using DynamicPageList](/index.php?title=Category:Pages_using_DynamicPageList&action=edit&redlink=1 "Category:Pages using DynamicPageList (page does not exist)")
* [Packaging](/Category%3APackaging "Category:Packaging")
* [Packaging documentation](/Category%3APackaging_documentation "Category:Packaging documentation")

This page was last edited on 2 October 2023, at 10:53. Content is available under [GNU Free Documentation License 1.2](https://www.gnu.org/licenses/fdl-1.2.html) unless otherwise noted. This page has been accessed 28,792 times.

* [Privacy policy](/openSUSE%3APrivacy_policy "openSUSE:Privacy policy")
* [About openSUSE Wiki](/openSUSE%3AAbout "openSUSE:About")
* [Disclaimers](/Terms_of_site "Terms of site")

© 2001–2025 SUSE LLC, © 2005–2025 openSUSE contributors & others.

Sponsors

[![Sponsor](https://static.opensuse.org/themes/bento/images/sponsors/sponsor_ip-exchange2.png)](/Sponsors)

##### Log in

×

Username

Password

[Create account](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
Cancel
Log in



=== Content from idp-portal.suse.com_6b95d262_20250115_210051.html ===

## UCS

# Welcome to Univention Corporate Server

## JavaScript required

A browser with JavaScript enabled is required in order to use this service.

When using Internet Explorer, please check your security settings and add this address to your trusted sites.



=== Content from build.opensuse.org_292fe31d_20250115_130823.html ===

[![](https://build.opensuse.org/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--aa5cb6f11b842d915c34968e0a4de823d259dcc0/openSUSEBuildService.png)](/)

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

Log In

[![](/assets/favicon-eb1d8ba2a269175c910cae3ae95a5d0dca90274b90db45c8efe0988ec9efd85d.svg)](/)Log In

---

or

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")

* Collapse sidebar

1. Request 1059845

This request supersedes:
[request 1059322](/request/show/1059322)
([Show diff](/request/show/1059845?diff_to_superseded=1059322))

##### Overview

### Request 1059845 accepted

- Update to version 2.4.0+git20230119.40d52b0:

 \* openSUSE: new whitelisting restriction for sysctl drop-in files (bsc#1174722)

- Update to version 2.4.0+git20230118.aac2cf3:

 \* zypper-plugins whitelist: adjust libzypp-plugin-appdata (bsc#1206836)

 \* simplify str.split

 \* disable opensuse-tumbleweed-aarch64 due to system crash

- Update to version 2.4.0+git20230118.42ed609:

 \* Update D-Bus whitelisting for NetworkManager-libreswan (bsc#1206757)

* Created by
  [fbonazzi](/users/fbonazzi)
  almost 2 years ago
* In state
  [accepted](/request/show/1059845#request-history)
* Supersedes
  [1059322](/request/show/1059322)

* [Submit rpmlint](#Submit_rpmlint2782772)

Loading...

* [Comments for request 1059845
  2](#comments)

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/5cdd10d836bdda3796cf6bc1ab2d5a78?s=35&d=robohash "Dominique Leuenberger")

[Dominique Leuenberger (dimstar)](/users/dimstar)
-
[almost 2 years ago](#comment-1731422 "2023-01-23 23:16 UTC")

reviewer

Sweet - that kills the systemd package

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/5cdd10d836bdda3796cf6bc1ab2d5a78?s=35&d=robohash "Dominique Leuenberger")

[Dominique Leuenberger (dimstar)](/users/dimstar)
-
[almost 2 years ago](#comment-1731461 "2023-01-24 06:57 UTC")

reviewer

[https://build.opensuse.org/package/live\_build\_log/openSUSE:Factory:Staging:E/systemd/standard/x86\_64](https://build.opensuse.org/package/live_build_log/openSUSE%3AFactory%3AStaging%3AE/systemd/standard/x86_64)

##### Request History

![Filippo Bonazzi's avatar](https://www.gravatar.com/avatar/c27e7fa1596f735a7a7364c9ae384d37?s=38&d=robohash "Filippo Bonazzi")

[fbonazzi](/users/fbonazzi)
created request
[almost 2 years ago](#request-creation "2023-01-19 18:20 UTC")

- Update to version 2.4.0+git20230119.40d52b0:

 \* openSUSE: new whitelisting restriction for sysctl drop-in files (bsc#1174722)

- Update to version 2.4.0+git20230118.aac2cf3:

 \* zypper-plugins whitelist: adjust libzypp-plugin-appdata (bsc#1206836)

 \* simplify str.split

 \* disable opensuse-tumbleweed-aarch64 due to system crash

- Update to version 2.4.0+git20230118.42ed609:

 \* Update D-Bus whitelisting for NetworkManager-libreswan (bsc#1206757)

---

![Factory Auto's avatar](https://www.gravatar.com/avatar/3be6bec62ce4af49b4b555cbd8bd3b9d?s=38&d=robohash "Factory Auto")

[factory-auto](/users/factory-auto)
added opensuse-review-team as a reviewer
[almost 2 years ago](#status-history-14900381 "2023-01-19 18:21 UTC")

Please review sources

---

![Factory Auto's avatar](https://www.gravatar.com/avatar/3be6bec62ce4af49b4b555cbd8bd3b9d?s=38&d=robohash "Factory Auto")

[factory-auto](/users/factory-auto)
accepted review
[almost 2 years ago](#status-history-14900384 "2023-01-19 18:21 UTC")

Check script succeeded

---

![Saul Goodman's avatar](https://www.gravatar.com/avatar/ffc053e2eedefdebcd8cbbc514d9dc11?s=38&d=robohash "Saul Goodman")

[licensedigger](/users/licensedigger)
accepted review
[almost 2 years ago](#status-history-14900387 "2023-01-19 18:31 UTC")

ok

---

![Staging Bot's avatar](https://www.gravatar.com/avatar/d41b2f36932f8e2d3648816d60497bb9?s=38&d=robohash "Staging Bot")

[staging-bot](/users/staging-bot)
set openSUSE:Factory:Staging:I as a staging project
[almost 2 years ago](#status-history-14900441 "2023-01-19 19:04 UTC")

Being evaluated by staging project "openSUSE:Factory:Staging:I"

---

![Staging Bot's avatar](https://www.gravatar.com/avatar/d41b2f36932f8e2d3648816d60497bb9?s=38&d=robohash "Staging Bot")

[staging-bot](/users/staging-bot)
accepted review
[almost 2 years ago](#status-history-14900444 "2023-01-19 19:04 UTC")

Picked "openSUSE:Factory:Staging:I"

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/5cdd10d836bdda3796cf6bc1ab2d5a78?s=38&d=robohash "Dominique Leuenberger")

[dimstar](/users/dimstar)
accepted review
[almost 2 years ago](#status-history-14901800 "2023-01-20 10:38 UTC")

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
accepted review
[almost 2 years ago](#status-history-14902931 "2023-01-20 16:37 UTC")

Staging Project openSUSE:Factory:Staging:I got accepted.

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
approved review
[almost 2 years ago](#status-history-14902934 "2023-01-20 16:37 UTC")

Staging Project openSUSE:Factory:Staging:I got accepted.

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
accepted request
[almost 2 years ago](#status-history-14902937 "2023-01-20 16:37 UTC")

Staging Project openSUSE:Factory:Staging:I got accepted.

##### Package Maintainers

OK

**Locations**

* [Projects](/project)
* [Search](/search)
* [Status Monitor](/monitor)

**Help**

* [OpenBuildService.org](https://openbuildservice.org/)
* [Documentation](https://openbuildservice.org/help/manuals/)
* [API Documentation](/apidocs/index)
* [Code of Conduct](/code_of_conduct)

**Contact**

* [Support](https://openbuildservice.org/support/)
* [@OBShq](https://fosstodon.org/%40obshq)
* [Terms](https://en.opensuse.org/Terms_of_site)

openSUSE Build Service is sponsored by
[![](/assets/icons/sponsor_suse-92006bbd693f5f675ccab53afe3e9c858aada01882b490fa784d8cc8a9f4f080.png)](http://www.suse.com "Enterprise Linux you can rely on.")

[![](/assets/icons/sponsor_amd-5ec958d97e60089cad23346048c0b79d2144408deda3d0495fe023bf29ec0d7b.png)](http://www.amd.com/ "Enabling today. Inspiring tomorrow.")

[![](/assets/icons/sponsor_b1-systems-a5bc5a49e7fc7854f9a688f873b074330a68bf7d286c4fda6bd0dd2e592752da.png)](http://www.b1-systems.de/en/homepage/ "Linux / Open Source Consulting, Training, Development & Support")

[![](/assets/icons/sponsor_heinlein-dc9ce64ab5cb25a15c4fd9a1b743f7886867932283f1dace07f0599a663a222a.png)](https://www.heinlein-support.de/ "We provide Knowledge and Experience")

[![](/assets/icons/sponsor_apm-1a5a654e5e7ed3df9d4717a1d68f6c4593096304173961c8b486a3ff3bddde75.png)](https://www.apm.com "Build the future of ARMv8 on Applied Micro")

The Open Build Service is an
[openSUSE project](https://www.opensuse.org).

* [Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
* Log In
* Places

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")



=== Content from en.opensuse.org_d3cec1c4_20250115_130821.html ===


[![🦎](https://static.opensuse.org/favicon.svg "openSUSE")
Wiki](/)

* Navigation
  [Home](/Main_Page)[Project](/Portal%3AProject)[Distribution](/Portal%3ADistribution)[Support](/Portal%3ASupport)[Contact](/openSUSE%3ACommunication_channels)[Site map](/openSUSE%3ACategory_browse)

* Help
  [Wiki](/Portal%3AWiki)[Create a Page](/Help%3AConcept)[Change a Page](/Help%3AEditing)[Find a Page](/Help%3ASearch)

* Tools
  [What links here](/Special%3AWhatLinksHere/openSUSE%3APackage_security_guidelines "A list of all wiki pages that link here [j]")[Related changes](/Special%3ARecentChangesLinked/openSUSE%3APackage_security_guidelines "Recent changes in pages linked from this page [k]")[Special pages](/Special%3ASpecialPages "A list of all special pages [q]")Printable version[Permanent link](/index.php?title=openSUSE:Package_security_guidelines&oldid=179717 "Permanent link to this revision of the page")[Page information](/index.php?title=openSUSE:Package_security_guidelines&action=info "More information about this page")

* In other languages
  [Deutsch](http://de.opensuse.org/openSUSE%3ASicherheitsrichtlinien_f%C3%BCr_Pakete "openSUSE:Sicherheitsrichtlinien für Pakete – Deutsch")[中文](http://zh.opensuse.org/openSUSE%3APackage_security_guidelines "openSUSE:Package security guidelines – 中文")

* Log in

* [Project page](/openSUSE%3APackage_security_guidelines "View the project page [a]")
* [Discussion](/index.php?title=openSUSE_talk:Package_security_guidelines&action=edit&redlink=1 "Discussion about the content page [t]")

[View](/openSUSE%3APackage_security_guidelines)
[View source](/index.php?title=openSUSE:Package_security_guidelines&action=edit "This page is protected.
You can view its source [e]")
[History](/index.php?title=openSUSE:Package_security_guidelines&action=history "Past revisions of this page [h]")

# openSUSE:Package security guidelines

Jump to: [navigation](#mw-head),
[search](#p-search)

Packaging documentation

* [AppStore](/openSUSE%3AAppStore "openSUSE:AppStore")
* [Build Service cross distribution howto](/openSUSE%3ABuild_Service_cross_distribution_howto "openSUSE:Build Service cross distribution howto")
* [Build Service Tips and Tricks](/openSUSE%3ABuild_Service_Tips_and_Tricks "openSUSE:Build Service Tips and Tricks")
* [Build Service Tutorial](/openSUSE%3ABuild_Service_Tutorial "openSUSE:Build Service Tutorial")
* [Bundled software policy](/openSUSE%3ABundled_software_policy "openSUSE:Bundled software policy")
* [Creating a changes file (RPM)](/openSUSE%3ACreating_a_changes_file_%28RPM%29 "openSUSE:Creating a changes file (RPM)")
* [Firewalld/RPM Packaging](/Firewalld/RPM_Packaging "Firewalld/RPM Packaging")
* [Java jpackage-utils](/openSUSE%3AJava_jpackage-utils "openSUSE:Java jpackage-utils")
* [Java RPM Macros](/openSUSE%3AJava_RPM_Macros "openSUSE:Java RPM Macros")
* [Julia](/Julia "Julia")
* [Mvyskocil/Shared library packaging policy](/User%3AMvyskocil/Shared_library_packaging_policy "User:Mvyskocil/Shared library packaging policy")
* [Package Conditional Build Dependencies](/openSUSE%3APackage_Conditional_Build_Dependencies "openSUSE:Package Conditional Build Dependencies")
* [Package dependencies](/openSUSE%3APackage_dependencies "openSUSE:Package dependencies")
* [Package description guidelines](/openSUSE%3APackage_description_guidelines "openSUSE:Package description guidelines")
* [Package group guidelines](/openSUSE%3APackage_group_guidelines "openSUSE:Package group guidelines")
* [Package maintainership guide](/openSUSE%3APackage_maintainership_guide "openSUSE:Package maintainership guide")
* [Package naming guidelines](/openSUSE%3APackage_naming_guidelines "openSUSE:Package naming guidelines")
* [Package security guidelines](/openSUSE%3APackage_security_guidelines "openSUSE:Package security guidelines")
* [Package source verification](/openSUSE%3APackage_source_verification "openSUSE:Package source verification")
* [Package versioning guidelines](/openSUSE%3APackage_versioning_guidelines "openSUSE:Package versioning guidelines")
* [Packaging Bazel](/openSUSE%3APackaging_Bazel "openSUSE:Packaging Bazel")
* [Packaging Branding](/openSUSE%3APackaging_Branding "openSUSE:Packaging Branding")
* [Packaging Bundler](/openSUSE%3APackaging_Bundler "openSUSE:Packaging Bundler")
* [Packaging checks](/openSUSE%3APackaging_checks "openSUSE:Packaging checks")
* [Packaging Conventions RPM Macros](/openSUSE%3APackaging_Conventions_RPM_Macros "openSUSE:Packaging Conventions RPM Macros")
* [Packaging desktop menu categories](/openSUSE%3APackaging_desktop_menu_categories "openSUSE:Packaging desktop menu categories")
* [Packaging Electron](/openSUSE%3APackaging_Electron "openSUSE:Packaging Electron")
* [Packaging Erlang](/openSUSE%3APackaging_Erlang "openSUSE:Packaging Erlang")
* [Packaging Fonts](/openSUSE%3APackaging_Fonts "openSUSE:Packaging Fonts")
* [Packaging for transactional-updates](/openSUSE%3APackaging_for_transactional-updates "openSUSE:Packaging for transactional-updates")
* [Packaging Games](/openSUSE%3APackaging_Games "openSUSE:Packaging Games")
* [Packaging Go](/openSUSE%3APackaging_Go "openSUSE:Packaging Go")
* [Packaging guidelines change process](/openSUSE%3APackaging_guidelines_change_process "openSUSE:Packaging guidelines change process")
* [Packaging Haskell](/openSUSE%3APackaging_Haskell "openSUSE:Packaging Haskell")
* [Packaging init scripts](/openSUSE%3APackaging_init_scripts "openSUSE:Packaging init scripts")
* [Packaging Java](/openSUSE%3APackaging_Java "openSUSE:Packaging Java")
* [Packaging Lisp](/openSUSE%3APackaging_Lisp "openSUSE:Packaging Lisp")
* [Packaging Lua](/openSUSE%3APackaging_Lua "openSUSE:Packaging Lua")
* [Packaging Multiple Version guidelines](/openSUSE%3APackaging_Multiple_Version_guidelines "openSUSE:Packaging Multiple Version guidelines")
* [Packaging nodejs](/openSUSE%3APackaging_nodejs "openSUSE:Packaging nodejs")
* [Packaging Patches guidelines](/openSUSE%3APackaging_Patches_guidelines "openSUSE:Packaging Patches guidelines")
* [Packaging Perl](/openSUSE%3APackaging_Perl "openSUSE:Packaging Perl")
* [Packaging PHP](/openSUSE%3APackaging_PHP "openSUSE:Packaging PHP")
* [Packaging PyQt and SIP](/openSUSE%3APackaging_PyQt_and_SIP "openSUSE:Packaging PyQt and SIP")
* [Packaging Python](/openSUSE%3APackaging_Python "openSUSE:Packaging Python")
* [Packaging R](/openSUSE%3APackaging_R "openSUSE:Packaging R")
* [Packaging Ruby](/openSUSE%3APackaging_Ruby "openSUSE:Packaging Ruby")
* [Packaging Rust Software](/openSUSE%3APackaging_Rust_Software "openSUSE:Packaging Rust Software")
* [Packaging Rustlang](/Packaging_Rustlang "Packaging Rustlang")
* [Packaging scriptlet snippets](/openSUSE%3APackaging_scriptlet_snippets "openSUSE:Packaging scriptlet snippets")
* [Packaging vdr](/openSUSE%3APackaging_vdr "openSUSE:Packaging vdr")
* [Packaging wxWidgets](/openSUSE%3APackaging_wxWidgets "openSUSE:Packaging wxWidgets")
* [Packaging XML Schemas and Stylesheets](/openSUSE%3APackaging_XML_Schemas_and_Stylesheets "openSUSE:Packaging XML Schemas and Stylesheets")
* [Packaging/Users And Groups](/Packaging/Users_And_Groups "Packaging/Users And Groups")
* [Patches Guidelines for X11:XOrg Project](/openSUSE%3APatches_Guidelines_for_X11%3AXOrg_Project "openSUSE:Patches Guidelines for X11:XOrg Project")
* [RPM conditional builds](/openSUSE%3ARPM_conditional_builds "openSUSE:RPM conditional builds")
* [Ruby Gem Strategies](/openSUSE%3ARuby_Gem_Strategies "openSUSE:Ruby Gem Strategies")
* [Rust](/Rust "Rust")
* [Science HPC Packaging](/openSUSE%3AScience_HPC_Packaging "openSUSE:Science HPC Packaging")
* [Shared library packaging policy](/openSUSE%3AShared_library_packaging_policy "openSUSE:Shared library packaging policy")
* [Specfile guidelines](/openSUSE%3ASpecfile_guidelines "openSUSE:Specfile guidelines")
* [Specfile pseudotags](/openSUSE%3ASpecfile_pseudotags "openSUSE:Specfile pseudotags")
* [Systemd packaging guidelines](/openSUSE%3ASystemd_packaging_guidelines "openSUSE:Systemd packaging guidelines")
* [Packaging guidelines](/openSUSE%3APackaging_guidelines "openSUSE:Packaging guidelines")
* [Zig](/Zig "Zig")

The security guidelines regulate all the details of secure packaging for the openSUSE distribution. To avoid unpleasant surprises packages have to adhere to certain security policies. Exceptions from the common security policies have to be discussed with and approved by the [openSUSE:Security team](/openSUSE%3ASecurity_team "openSUSE:Security team").

## Contents

* [1 Daemons](#Daemons)
* [2 Setuid Binaries](#Setuid_Binaries)
  + [2.1 Packaging setuid binaries](#Packaging_setuid_binaries)
* [3 World Writable Directories](#World_Writable_Directories)
* [4 Group Writable Directories](#Group_Writable_Directories)
* [5 Firewall Settings](#Firewall_Settings)
* [6 DBus Services](#DBus_Services)
* [7 PolicyKit Privileges](#PolicyKit_Privileges)
* [8 Passwords](#Passwords)
* [9 Use Of Cryptography](#Use_Of_Cryptography)
* [10 Audit Bugs for the Security Team](#Audit_Bugs_for_the_Security_Team)
  + [10.1 Audit Bug Lifecycle](#Audit_Bug_Lifecycle)
  + [10.2 rpmlint Errors in Packages](#rpmlint_Errors_in_Packages)
  + [10.3 Rpmlint whitelisting based on file digests](#Rpmlint_whitelisting_based_on_file_digests)
  + [10.4 Rpmlint whitelisting errors in home and devel Projects](#Rpmlint_whitelisting_errors_in_home_and_devel_Projects)
  + [10.5 How the Whitelisting Process Works](#How_the_Whitelisting_Process_Works)
  + [10.6 Fixing Builds of Older Distributions in your Devel Project](#Fixing_Builds_of_Older_Distributions_in_your_Devel_Project)
## Daemons

* installation of a package must not activate any daemon. That means for example init scripts must not be insserv'd in %post, xinetd files must contain 'disable = yes'.
* daemons should run under an unprivileged user id. That usually means the package has to create the user in it's %pre section. Daemons should avoid running as root and must not use the 'nobody' user. It's fine to use group 'nogroup' though.
* daemons should be restarted if the package was upgraded so security updates take effect immediately
* daemons that open TCP or UDP ports or otherwise receive input from potentially untrusted networks should receive an audit from the security team prior to inclusion in the distribution.

## Setuid Binaries

Packages are not allowed to include setuid/setgid binaries unless the [SUSE Security Team](/openSUSE%3ASecurity_team "openSUSE:Security team") has reviewed the source code and granted explicit permission.

To request an audit for setuid binaries, open a bug report assigned to `security-team@suse.de` and/or send an e-mail to `security@suse.de`.

The bug report should include the exact location of the source code, the affected files and an explanation why the setuid bit is required. If the audit turns out positive, the security team will include permission settings for the new files in the 'permissions' package. The build system will reject packages with setuid binaries that are not listed in the permissions package.

In general having a setuid bit by default requires good reasons. Most of the time it's better to ship without setuid bit but including instructions how to modify /etc/permissions.local instead if needed.

setuid binaries need to be packaged specially. See the [%verify\_permissions](/openSUSE%3APackaging_Conventions_RPM_Macros#.25verify_permissions "openSUSE:Packaging Conventions RPM Macros") macro for examples.

### Packaging setuid binaries

Security-relevant permissions are handled via `/etc/permissions*` on openSUSE.
Read the files `/etc/permissions*` to learn about the basics.

If you want to create a package with suid programs:

* Add a `Requires(post): permissions` header to your spec file.
* In the `%files` section, define the attributes of the files listed in your permissions files as they are defined for `permissions.secure`. Instruct `rpmverify` to **not** check ownership or permissions.
* Add a `%post` scriptlet that sets your package's permissions according to the system's current security level.
* Add a `%verifyscript` scriptlet that checks your package's permissions according to the system's current security level.

Because the above contains a few non-obvious details, here's a stripped down example:

```
[...]
PreReq:         permissions
[...]

```
```
%if 0%{?suse_version} >= 1120
%verifyscript
%verify_permissions -e %_bindir/mysuidprogram
%endif

%post
%if 0%{?set_permissions:1}
    %set_permissions %name
%else
    %run_permissions
%endif

%files
[...]
%verify(not user group mode) %attr(0711,root,root) %_bindir/mysuidprogram
[...]

```

To do temporary builds in your home project:

* Use the package-specific permissions that can be defined through files in `/etc/permissions.d/`.

* Create `permissions{,.easy,.secure,.paranoid}` files for your package. `permissions` is used if no file `permissions.*` matching the system's current security setting is found. As a rule of thumb, `permissions.easy` should contain permissions as installed by `make install`, `permissions.paranoid` should remove all suid bits (even if this breaks functionality), and `permissions.secure` can be something in between.
* Add these permissions files as sources to the spec file, and have `%install` install them in `%buildroot/%_sysconfdir/permissions.d/packagename[.suffix]`.
* In order to avoid rpmlint's error messages about disallowed permissions files, create a file `packagename-rpmlintrc` containing the line `setBadness('permissions-unauthorized-file', 333)`, and list it as a Source in your spec file. (Modify the "333" if you have fewer or more than 3 disallowed files.)

Please note that all these workarounds must be removed before the package is submitted to the openSUSE distribution.

## World Writable Directories

In general world writable directories should be avoided. If a package desperately needs world writable directories the same rules as for setuid binaries apply.

## Group Writable Directories

There is no build check for directories writable by some special group and no review by the security-team needed. However, packagers should be aware that directories inside group writable directories cannot be packaged securely and may allow members of the group to elevate their privileges to root. In other words *never* package directories inside group writable directories.

## Firewall Settings

No package is allowed to modify SuSEfirewall's configuration file. An exception is granted for the yast2 firewall module. Any other application must use the interface offered by the yast2 firewall module to change firewall settings. Changing the firewall settings must always require explicit confirmation of the user.

## DBus Services

Programs that offer services via the system DBUS must receive an audit from the security team prior to inclusion in the distribution. In general the same rules apply as for any other daemon.

## PolicyKit Privileges

Programs that carry out privileged operations on behalf of the user (such as e.g. changing the clock) should define a PolicyKit privilege which a user is required to possess for a specific action to be carried out. Use of PolicyKit privileges has to be audited by the security team prior to inclusion in the distribution

## Passwords

Packages must not be preconfigured with fixed passwords, certificates etc. Instead, the user must be forced to set a password prior to first usage.

## Use Of Cryptography

In general packages must not implement their own cryptographic algorithms but should use either of the following implementations:

* mozilla-nss (preferred)
* openssl
* gcrypt
* gnutls
* kernel crypto interface (kernel modules only)

Preferably encryption and hash algorithms should be configurable and set to currently considered safe algorithms (e.g. AES, SHA-3). Use of MD5 or SHA-1 as cryptographic signatures are not safe anymore.

Packages should not ship their own set of trusted x509 certificates. Instead, /etc/ssl/certs should be used as fallback.

## Audit Bugs for the Security Team

A number of security related program features require a whitelisting by the SUSE security team, before they can be packaged and submitted to Factory or any [open]SUSE product. Among these are the following situations:

* binaries installed by the package carry a **setuid** or **setgid** bit. This allows regular users to run the binary with elevated privileges. These kinds of binaries are difficult to implement correctly in a secure way. Therefore, the security team would like to avoid adding any additional set\*id binaries to the distribution. If there is no way around it then a thorough review is necessary.
* new **D-Bus services** are installed by the package, that can be activated dynamically or via systemd units. D-Bus services often run as root and expose interfaces to regular users. Therefore, these cases are also security sensitive.
* **systemd services** are required to be **disabled by default**. Only a small number of packages is currently allowed to be enabled by default right after installing it. Other packages need to be enabled explicitly by the user. New default-enabled systemd services need to be reviewed as well.
* new **PAM modules** are installed by the package. They also require a security team review. Badly implemented PAM modules may cause user authentication to always succeed or otherwise badly influence security.
* new **polkit actions** or **polkit rules** are added. Polkit is an authentication framework that allows to authenticate individual operations instead of just allowing all or nothing. While this sounds (and is) good it still needs to be done right in each implementation. Therefore, this also requires a code review.
* **cron jobs** are installed in /etc/cron.\*. Cron jobs can also easily introduce security issues. Note that by now most new packages are encouraged to use systemd timers instead of classic cron jobs.
* directories installed by the package are world-writable, carry a sticky bit or a setgid bit
* devices files are installed by the package
* sudo drop-in configuration files are installed into /etc/sudoers.d
* certain security sensitive systemd-tmpfiles drop-in configuration files are installed into /usr/lib/tmpfiles.d

The SUSE security team continuously works to extend the coverage of security
sensitive package features. Therefore, this list is not exhaustive and new
restrictions can become active over time.

If you add one of these items to your package then an rpmlint error
will appear. If your package is affected by any of these restrictions and you
want to submit the package to openSUSE:Factory or another production
project then please open a bug in [Bugzilla](https://bugzilla.opensuse.org),
assign it to **security-team@suse.de** and use a summary line that follows this pattern:

```
   AUDIT-0: [package-name]: [topic]

```

So in a real example it would look like this:

```
   AUDIT-0: mypackage: review of D-Bus service org.mypackage.myservice

```

In the bug description you should state the rpmlint error message
and point to the location of the package in the build service. A member of the
security team will then take care of the review and perform the necessary
actions. One of the following bug creation templates can be used to create the
bug, you only need to fill in the preset summary and description:

* [Bug creation template for community users](https://bugzilla.opensuse.org/enter_bug.cgi?alias=&assigned_to=security-team%40suse.de&attach_text=&blocked=&bug_file_loc=http%3A%2F%2F&bug_severity=Normal&bug_status=NEW&cf_biz_priority=&cf_blocker=---&cf_foundby=---&cf_nts_priority=&comment=For%20my%20package%20found%20in%20OBS%20in%20%3Cproject%3E%3A%3Cpackage%3E%20I%20would%20like%20a%20whitelisting%20for%20the%20following%20rpmlint%20error%3A%0D%0A%0D%0A%3Crelevant%20output%20from%20build%20log%3E&component=Security&contenttypeentry=&contenttypemethod=autodetect&contenttypeselection=text%2Fplain&data=&deadline=&defined_groups=1&dependson=&description=&estimated_time=&flag_type-2=X&flag_type-3=X&flag_type-4=X&form_name=enter_bug&keywords=&maketemplate=Remember%20values%20as%20bookmarkable%20template&op_sys=Other&product=openSUSE%20Tumbleweed&qa_contact=security-team%40suse.de&rep_platform=Other&requestee_type-2=&requestee_type-4=&short_desc=AUDIT-0%3A%20%3Cpackage%20name%3E%3A%20%3Ctopic%3E&version=Current)
* [Bug creation template for SUSE internal employees](https://bugzilla.suse.com/enter_bug.cgi?alias=&assigned_to=security-team%40suse.de&attach_text=&blocked=&bug_file_loc=http%3A%2F%2F&bug_severity=Normal&bug_status=NEW&cf_biz_priority=&cf_blocker=---&cf_foundby=---&cf_nts_priority=&comment=For%20my%20package%20found%20in%20OBS%20in%20%3Cproject%3E%3A%3Cpackage%3E%20I%20would%20like%20a%20whitelisting%20for%20the%20following%20rpmlint%20error%3A%0D%0A%0D%0A%3Crelevant%20output%20from%20build%20log%3E&component=Audits&contenttypeentry=&contenttypemethod=autodetect&contenttypeselection=text%2Fplain&data=&deadline=&defined_groups=1&dependson=&description=&estimated_time=&flag_type-2=X&flag_type-3=X&flag_type-4=X&form_name=enter_bug&keywords=&maketemplate=Remember%20values%20as%20bookmarkable%20template&op_sys=Other&product=SUSE%20Security%20Incidents&qa_contact=security-team%40suse.de&rep_platform=Other&requestee_type-2=&requestee_type-4=&short_desc=AUDIT-0%3A%20%3Cpackage%20name%3E%3A%20%3Ctopic%3E&version=unspecified)

Please submit review requests early since reviewing can take a long time (at
least a couple of days, mostly a week or two, sometimes longer) and you will be
blocked from having your package added to openSUSE:Factory before the
review is finished.

#### Audit Bug Lifecycle

The original audit bug will be used as a tracker bug for all the findings identified by the security team. Individual findings will be tracked as new bugs that block the original bug and have an AUDIT-FIND tag in the bug summary field. Once the audit is finished its tag will be changed from AUDIT-0 to AUDIT-TRACKER to indicate that it is only used as a tracker for the findings and the audit itself is done.

The number suffix in AUDIT-0 provides a rough categorization of priority for the review. Zero is the default and highest priority. AUDIT-1 is for topics that don't require immediate attention. AUDIT-2 or AUDIT-STALE is for reviews that are stuck for one reason or another and cannot currently progress (as seen from the SUSE security team side).

For AUDIT bugs that are solely concerned with backporting whitelistings to other SUSE products (e.g. to SUSE Linux Enterprise), we also rename the tag to AUDIT-WHITELIST. This is an indicator that no in-depth review is going on but mostly a maintenance process.

### `rpmlint` Errors in Packages

For reference, some examples of the possible rpmlint error messages that can
occur in a package are listed in the following table:

| Category | Error Messages |
| --- | --- |
| Polkit Privileges | ``` rpmlint-integration-test.x86_64: E: polkit-untracked-privilege (Badness: 10000) org.opensuse.rpmlint-test.test1 (auth_admin:auth_admin:auth_admin_keep) rpmlint-integration-test.x86_64: E: polkit-file-unauthorized (Badness: 10000) /usr/share/polkit-1/rules.d/myrules (file digest sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855) rpmlint-integration-test.x86_64: E: polkit-file-unauthorized (Badness: 10000) /etc/polkit-1/rules.d/90-default-privs.rules (file digest sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855)  ``` |
| D-Bus Services | ``` rpmlint-integration-test.x86_64: E: dbus-file-unauthorized (Badness: 10000) /etc/dbus-1/system.d/com.suse.dbus.testing.conf (file digest sha256:fac51ad567667cdba707ac1d9410fea54110b3ee11dcf19a2eba34a1405070ac) rpmlint-integration-test.x86_64: E: dbus-file-digest-mismatch (Badness: 10000) /etc/dbus-1/system.d/rpmlint_mismatch.conf expected sha256:4a5e8e9ca514c73f1dbee55e88c4d75a235473c1d5cef4751d84016833961fdf, has:504c5a60b7173794e565755122ab77beaec9bcf208fb97a40237cb57c67b5a17  ``` |
| PAM Modules | ``` rpmlint-integration-test.x86_64: E: pam-file-unauthorized (Badness: 10000) /usr/lib64/security/mypam.so (file digest sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4 649b934ca495991b7852b855) ``` |
| Set\*id bits | ``` rpmlint-integration-test.x86_64: E: permissions-file-setuid-bit (Badness: 10000) /usr/bin/setgidbin is packaged with setuid/setgid bits (02755) rpmlint-integration-test.x86_64: E: permissions-file-setuid-bit (Badness: 10000) /usr/bin/setuidbin is packaged with setuid/setgid bits (04755)  ``` |

### Rpmlint whitelisting based on file digests

For some whitelistings the SUSE security team takes file contents into account. This means that
a whitelisting will not only apply to a certain filename a package installs, but also to the
exact content that file has. The purpose of this is for the security team to become aware of
changes in sensitive items that are either introduced upstream or by packagers.

If the content of an already whitelisted file changes you will get an error message like this:

```
rpmlint-integration-test.x86_64: E: dbus-file-digest-mismatch (Badness: 10000) /etc/dbus-1/system.d/rpmlint_mismatch.conf expected sha256:4a5e8e9ca514c73f1dbee55e88c4d75a235473c1d5cef4751d84016833961fdf, has:504c5a60b7173794e565755122ab77beaec9bcf208fb97a40237cb57c67b5a17

```

In this case please open up a **new** follow-up AUDIT bug and the security team will
review the changes and whitelist the new file digest if all is well. These
follow-up audits usually will be quicker than the initial audits.

To avoid unnecessary administration if non-functional changes are introduces to whitelisted files,
the whitelisting checks support normalization of XML and shell style configuration files. As part
of the normalization whitespace and comment lines are removed from the file and the hash digest is
calculated for the filtered file content. This means that changes in said whitespace or comments will
not trigger an rpmlint error, but only actual changes in content.

### Rpmlint whitelisting errors in home and devel Projects

The security related rpmlint errors are supposed to protect openSUSE:Factory
from packages that are more likely to introduce security issues. We don't want to block
you, however, while developing a package in a home or devel project or if you don't
intend to currently submit a package to openSUSE:Factory. Therefore
the badness values for packaging artifacts that are not whitelisted will be low
when building in home and devel projects but will be high when building in the
openSUSE:Factory project.

Remember, however, that your package will not successfully build in the openSUSE:Factory
project until a review has been performed and a whitelisting has been submitted by the
security team. This can take a longer time. So create AUDIT bugs early on if you
plan to submit such a package to Factory.

### How the Whitelisting Process Works

Once you have opened an AUDIT bug for the security team roughly the following
will happen:

* a member of the security team will confirm your request and give you some initial information.
* when a security engineer is working on the bug, findings will be documented by it as the review goes along. If any critical security concerns or issues are found then the request will be declined. Sometimes you will be asked to improve certain aspects of the package for better security. In the best case you need to do nothing else and the review passes.
* when the review has passed, the security engineer will submit a whitelisting for your package to make the rpmlint error go away.

So when will the whitelisting become effective? The whitelisting is contained
in certain OBS packages depending on the type of whitelisting:

* for polkit privileges the whitelisting is in package *Base:System/polkit-default-privs*
* for D-Bus services, PAM modules and anything not explicitly listed here the whitelisting is in package *devel:openSUSE:Factory:rpmlint/rpmlint*
* for setuid binaries the whitelisting is in package *Base:System/permissions*
* for default-enabled systemd services the whitelisting is in package *Base:System/systemd-presets-branding-openSUSE* for openSUSE and in *systemd-presets-branding-SLE* for SUSE enterprise.

The security engineer that is working on the AUDIT bug will make a
submission to the appropriate package for openSUSE:Factory. Once this
submission arrives in the OBS, an automated message is also posted in
the AUDIT bug. The review and testing process in OBS can take a couple of days
before the whitelisting is accepted to openSUSE:Factory. You can still
submit your affected package to openSUSE:Factory, too. For this to work
you should note in the submission comment that the submission should be
handled **in the same staging project as the whitelisting**
submission**. Example comment:**

```
Please handle this submission together with sr#123456 which contains
the whitelisting for this package.

```

This way your submission will be built against the whitelisting
submission in the same staging project and can successfully build.
The whitelisting update and your package update can then happen
together.

Once the whitelisting is accepted to Factory you can build your package
successfully against the openSUSE:Factory standard repository. If you
want to build against the openSUSE:Factory snapshot repository then you
will need to wait for a new Tumbleweed snapshot to be released that
contains the whitelisting update. You can determine this by following the
[Factory mailing list](https://lists.opensuse.org/opensuse-factory/) or by
looking into the *Changes files* on the
[download server](https://download.opensuse.org/tumbleweed/iso/).

When you are backporting features to older openSUSE or SUSE distributions
then it can happen that you will be needing a whitelisting backported, too.
In this case you need to inform the responsible security engineer about it
and the whitelisting will also be backported by way of a maintenance
update. You can create an AUDIT-WHITELIST bug for us to keep track of the
process.

### Fixing Builds of Older Distributions in your Devel Project

Once there is a whitelisting in place for your package and it successfully
builds against Factory you might notice that builds of your devel package
against Repositories for older existing distributions are still failing. This
is only logical, because in the older distributions no whitelisting for your
security related feature is in place and in most cases also shouldn't be.
There's two things you can do about this:

* you can simply disable the repositories for the older distributions, thereby not having them building at all anymore.
* you can ask the security-team to backport the whitelisting to the older codestreams. This should only be the exception, however.

Retrieved from "<https://en.opensuse.org/index.php?title=openSUSE:Package_security_guidelines&oldid=179717>"

[Categories](/Special%3ACategories "Special:Categories"):

* [Pages using DynamicPageList](/index.php?title=Category:Pages_using_DynamicPageList&action=edit&redlink=1 "Category:Pages using DynamicPageList (page does not exist)")
* [Packaging](/Category%3APackaging "Category:Packaging")
* [Packaging documentation](/Category%3APackaging_documentation "Category:Packaging documentation")

This page was last edited on 2 October 2023, at 10:53. Content is available under [GNU Free Documentation License 1.2](https://www.gnu.org/licenses/fdl-1.2.html) unless otherwise noted. This page has been accessed 28,792 times.

* [Privacy policy](/openSUSE%3APrivacy_policy "openSUSE:Privacy policy")
* [About openSUSE Wiki](/openSUSE%3AAbout "openSUSE:About")
* [Disclaimers](/Terms_of_site "Terms of site")

© 2001–2025 SUSE LLC, © 2005–2025 openSUSE contributors & others.

Sponsors

[![Sponsor](https://static.opensuse.org/themes/bento/images/sponsors/sponsor_ip-exchange2.png)](/Sponsors)

##### Log in

×

Username

Password

[Create account](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
Cancel
Log in


