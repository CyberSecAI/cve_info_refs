Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**
The `sanitize-svg` package used a deny-list approach to sanitize SVGs, which was insufficient to prevent XSS. The package was checking for `<script>` tags and `on-*` attributes, but was missing other ways to execute JavaScript within SVGs.

**Weaknesses/vulnerabilities present:**
- Inadequate sanitization of SVG content using a deny-list approach
- Failure to block JavaScript execution through `<a>` tags with `javascript:` URLs
- Failure to block JavaScript execution through `<foreignObject>` tags using `<iframe>` with `javascript:` URLs

**Impact of exploitation:**
- Cross-Site Scripting (XSS) vulnerability in applications using the `sanitize-svg` library.
- An attacker can inject malicious JavaScript code into SVG files, which can then be executed in the victim's browser. This can lead to:
  - Stealing of user cookies/session tokens
  - Defacement of the web page
  - Redirecting the user to malicious sites
  - Other malicious activities

**Attack vectors:**
- Injecting malicious SVG files containing `<a>` tags with `javascript:` URLs or `<foreignObject>` tags with `<iframe>` and `javascript:` URLs.

**Required attacker capabilities/position:**
- The attacker needs to be able to inject or upload crafted SVG files into a system that processes or displays them using the vulnerable `sanitize-svg` library.
- Attacker requires a low level of privileges.
- User interaction is required as the user must view or interact with the malicious SVG content.

**Additional details:**
- The vulnerability was fixed in version `0.4.0` of the `sanitize-svg` package.
- The vulnerability is identified as CWE-80 (Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS))
- The vulnerability was reported by @lauritzh.
- The fix involved adding the `a`, `animate`, `color-profile`, `cursor`, `discard`, `fedropshadow`, `font-face`, `font-face-format`, `font-face-name`, `font-face-src`, `font-face-uri`, `foreignobject`, `hatch`, `hatchpath`, `mesh`, `meshgradient`, `meshpatch`, `meshrow`, `missing-glyph`, `script`, `set`, `solidcolor`, `unknown`, and `use` elements to the denylist. The sanitization process was also changed to use a template tag instead of a div element.