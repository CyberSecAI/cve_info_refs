```
{
  "cveId": "CVE-2023-22895",
  "related": true,
  "info": "The vulnerability is present in the `bzip2` crate for Rust, specifically in versions prior to 0.4.4. It arises due to an integer overflow when handling large files during compression or decompression, leading to a denial-of-service condition.",
  "vulnerabilityDetails": {
    "rootCause": "The root cause lies in the `decompress` and `compress` functions within the `bzip2` crate. These functions cast the output buffer's length to `c_uint` (a 32-bit unsigned integer), and when the buffer's length exceeds the maximum value of `c_uint`, an integer overflow occurs resulting in the `avail_out` variable becoming zero.",
    "weaknesses": [
      "Integer Overflow",
      "Denial of Service (DoS)"
    ],
    "impact": "A specially crafted bzip2 compressed file, or a very large file, can trigger an infinite loop in either the compression or decompression routines, leading to a denial-of-service (DoS) situation. The affected application will hang and be rendered unusable.",
    "attackVectors": [
      "Processing of a malicious bzip2 file or a very large file."
    ],
    "attackerCapabilities": "An attacker needs the ability to supply a malicious or very large bzip2 file to the application using the vulnerable library. No special privileges or user interaction are required."
  },
  "additionalNotes": "The vulnerability affects both the `Decompress` and `Compress` implementations within the `bzip2` crate. The fix involves ensuring that the `avail_out` parameter, which represents the available output buffer size, never exceeds the maximum value of `c_uint` by using `output.len().min(c_uint::MAX as usize) as c_uint;` when setting `self.inner.raw.avail_out`. The fix is included in version 0.4.4 of the crate. This vulnerability is also known as GHSA-96jv-r488-c2rj and RUSTSEC-2023-0004."
}
```