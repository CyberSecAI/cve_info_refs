=== Content from research.splunk.com_d0f096f5_20250115_102614.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk CSRF in the SSG kvstore Client Endpoint

Updated Date: 2024-10-16
ID: 4742d5f7-ce00-45ce-9c79-5e98b43b4410
Author: Rod Soto
[Type: TTP](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

The following analytic identifies attempts to exploit a cross-site request forgery (CSRF) vulnerability in the Splunk Secure Gateway (SSG) app's kvstore\_client endpoint. It detects GET requests to the vulnerable endpoint using internal index data, focusing on specific URI paths and HTTP methods. This activity is significant because it can allow unauthorized updates to SSG KV store collections, potentially leading to data manipulation or unauthorized access. If confirmed malicious, this could enable attackers to alter critical configurations or exfiltrate sensitive information, compromising the integrity and security of the Splunk environment.

### Search

```
1`splunkda` uri_path="/*/splunkd/__raw/services/ssg/kvstore_client" method="GET" delete_field_value="spacebridge_server" status="200"
2| table splunk_server status uri delete_field_value method post_data
3| `splunk_csrf_in_the_ssg_kvstore_client_endpoint_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [splunkda](https://github.com/splunk/security_content/blob/develop/macros/splunkda.yml) | `index=_internal sourcetype=splunkd_access` |
| splunk\_csrf\_in\_the\_ssg\_kvstore\_client\_endpoint\_filter | `search *` |

`splunk_csrf_in_the_ssg_kvstore_client_endpoint_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1189](https://attack.mitre.org/techniques/T1189/) | Drive-by Compromise | Initial Access |

KillChainPhase.DELIVERY

NistCategory.DE\_CM

Cis18Value.CIS\_10

APT19
APT28
APT32
APT37
APT38
Andariel
Axiom
BRONZE BUTLER
CURIUM
Daggerfly
Dark Caracal
Darkhotel
Dragonfly
Earth Lusca
Elderwood
Lazarus Group
Leafminer
Leviathan
Machete
Magic Hound
Mustard Tempest
PLATINUM
PROMETHIUM
Patchwork
RTM
Threat Group-3390
Transparent Tribe
Turla
Windigo
Windshift
Winter Vivern

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Notable | Yes |
| Rule Title | `%name%` |
| Rule Description | `%description%` |
| Notable Event Fields | user, dest |
| Creates Risk Event | True |

This configuration file applies to all detections of type TTP. These detections will use Risk Based Alerting and generate Notable Events.
### Implementation

Requires access to internal index.

### Known False Positives

This hunting search only applies to the affected versions and setup mentioned in the description of this search, it does not extract payload so it requires manual investigation after executing search. This search will produce false positives.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Potential CSRF exploitation attempt from $splunk\_server$ | 25 | 50 | 50 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/advisories/SVD-2023-0212>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1189/splunk/splunk_csrf_in_the_ssg_kvstore_client_endpoint_data.log) | `splunkd_access.log` | `splunkd_access` |
| Integration | â Passing | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1189/splunk/splunk_csrf_in_the_ssg_kvstore_client_endpoint_data.log) | `splunkd_access.log` | `splunkd_access` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_csrf_in_the_ssg_kvstore_client_endpoint.yml) |
Version: **4**

[Detection: Splunk Command and Scripting Interpreter Risky SPL MLTK](https://research.splunk.com/application/19d0146c-2eae-4e53-8d39-1198a78fa9ca/ "Detection: Splunk Command and Scripting Interpreter Risky SPL MLTK")

[Detection: Splunk Digital Certificates Lack of Encryption](https://research.splunk.com/application/386a7ebc-737b-48cf-9ca8-5405459ed508/ "Detection: Splunk Digital Certificates Lack of Encryption")

Â© 2005 - 2024 Splunk LLC All rights reserved.



=== Content from advisory.splunk.com_60bccfd9_20250115_102613.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Cross-Site Request Forgery in the ‘ssg/kvstore\_client’ REST Endpoint in Splunk Enterprise

**Advisory ID:** SVD-2023-0212

**CVE ID:** [CVE-2023-22942](https://www.cve.org/CVERecord?id=CVE-2023-22942)

**Published:** 2023-02-14

**Last Update:** 2023-02-14

**CVSSv3.1 Score:** 5.4, Medium

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L)

**CWE:** [CWE-352](https://cwe.mitre.org/data/definitions/352.html)

**Bug ID:** SPL-232619

## Description

In Splunk Enterprise versions below 8.1.13, 8.2.10, and 9.0.4, a cross-site request forgery in the Splunk Secure Gateway (SSG) app in the ‘kvstore\_client’ REST endpoint lets a potential attacker update SSG [App Key Value Store (KV store)](https://docs.splunk.com/Documentation/Splunk/latest/Admin/AboutKVstore) collections using an HTTP GET request. SSG is a Splunk-built app that comes with Splunk Enterprise. The vulnerability affects instances with SSG and Splunk Web enabled.

## Solution

For Splunk Enterprise, upgrade versions to 8.1.13, 8.2.10, 9.0.4, or higher.

For Splunk Cloud Platform, Splunk is actively patching the Splunk Secure Gateway app and monitoring the Splunk Cloud instances.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 8.1 | Splunk Web | 8.1.12 and lower | 8.1.13 |
| Splunk Enterprise | 8.2 | Splunk Web | 8.2.0 to 8.2.9 | 8.2.10 |
| Splunk Enterprise | 9.0 | Splunk Web | 9.0.0 to 9.0.3 | 9.0.4 |

## Mitigations and Workarounds

If users do not log in to Splunk Web on indexers in a distributed environment, disable Splunk Web on those indexers. See [Disable unnecessary Splunk Enterprise components](https://docs.splunk.com/Documentation/Splunk/latest/Security/DisableunnecessarySplunkcomponents) and the [web.conf](https://docs.splunk.com/Documentation/Splunk/latest/Admin/Webconf) configuration specification file for more information on disabling Splunk Web.

Splunk Secure Gateway is a Splunk-built app that comes with Splunk Enterprise. If the Splunk instance does not use the SSG functionality, disable or delete the app. See [Manage app and add-on objects](https://docs.splunk.com/Documentation/Splunk/latest/Admin/Managingappobjects) for more information.

The SSG app is not available for download or direct update through Splunkbase.

## Detections

* [Splunk csrf in the ssg kvstore client endpoint](https://research.splunk.com/application/4742d5f7-ce00-45ce-9c79-5e98b43b4410/)

This hunting search provides information on REST method and post data that might reveal exploitation of this vulnerability.

## Severity

Splunk rated the vulnerability as Medium, 5.4, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L. The impact endpoint has limited functionality to edit minor configurations and disable minor functionality.

If the Splunk Enterprise instance does not run Splunk Web, there is no impact and the severity is Informational. If the Splunk Enterprise instance disabled or removed the SSG, there is no impact and the severity is Informational.

## Acknowledgments

Anton (therceman)

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)
