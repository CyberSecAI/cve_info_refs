=== Content from www.mozilla.org_db161f5b_20250114_222548.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-15

## Security Vulnerabilities fixed in Thunderbird 102.10

Announced
April 11, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.10

#### [#CVE-2023-29531: Out-of-bound memory access in WebGL on macOS](#CVE-2023-29531)

Reporter
DoHyun Lee
Impact
high
##### Description

An attacker could have caused an out of bounds memory access using WebGL APIs, leading to memory corruption and a potentially exploitable crash.
*This bug only affects Thunderbird for macOS. Other operating systems are unaffected.*

##### References

* [Bug 1794292](https://bugzilla.mozilla.org/show_bug.cgi?id=1794292)

#### [#CVE-2023-29532: Mozilla Maintenance Service Write-lock bypass](#CVE-2023-29532)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

A local attacker can trick the Mozilla Maintenance Service into applying an unsigned update file by pointing the service at an update file on a malicious SMB server. The update file can be replaced after the signature check, before the use, because the write-lock requested by the service does not work on a SMB server.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1806394](https://bugzilla.mozilla.org/show_bug.cgi?id=1806394)

#### [#CVE-2023-29533: Fullscreen notification obscured](#CVE-2023-29533)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A website could have obscured the fullscreen notification by using a combination of `window.open`, fullscreen requests, `window.name` assignments, and `setInterval` calls. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1814597](https://bugzilla.mozilla.org/show_bug.cgi?id=1814597)
* [Bug 1798219](https://bugzilla.mozilla.org/show_bug.cgi?id=1798219)

#### [#CVE-2023-1999: Double-free in libwebp](#CVE-2023-1999)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A double-free in libwebp could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1819244](https://bugzilla.mozilla.org/show_bug.cgi?id=1819244)

#### [#CVE-2023-29535: Potential Memory Corruption following Garbage Collector compaction](#CVE-2023-29535)

Reporter
Lukas Bernhard
Impact
high
##### Description

Following a Garbage Collector compaction, weak maps may have been accessed before they were correctly traced. This resulted in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1820543](https://bugzilla.mozilla.org/show_bug.cgi?id=1820543)

#### [#CVE-2023-29536: Invalid free from JavaScript code](#CVE-2023-29536)

Reporter
zx from qriousec
Impact
high
##### Description

An attacker could cause the memory manager to incorrectly free a pointer that addresses attacker-controlled memory, resulting in an assertion, memory corruption, or a potentially exploitable crash.

##### References

* [Bug 1821959](https://bugzilla.mozilla.org/show_bug.cgi?id=1821959)

#### [#CVE-2023-0547: Revocation status of S/Mime recipient certificates was not checked](#CVE-2023-0547)

Reporter
Paul Menzel
Impact
high
##### Description

OCSP revocation status of recipient certificates was not checked when sending S/Mime encrypted email, and revoked certificates would be accepted. Thunderbird versions from 68 to 102.9.1 were affected by this bug.

##### References

* [Bug 1811298](https://bugzilla.mozilla.org/show_bug.cgi?id=1811298)

#### [#CVE-2023-29479: Hang when processing certain OpenPGP messages](#CVE-2023-29479)

Reporter
Ribose RNP Team
Impact
moderate
##### Description

Certain malformed OpenPGP messages could trigger incorrect parsing of PKESK/SKESK packets due to a bug in the Ribose RNP library used by Thunderbird up to version 102.9.1, which would cause the Thunderbird user interface to hang. The issue was discovered using Google's oss-fuzz.

##### References

* [Bug 1824978](https://bugzilla.mozilla.org/show_bug.cgi?id=1824978)

#### [#CVE-2023-29539: Content-Disposition filename truncation leads to Reflected File Download](#CVE-2023-29539)

Reporter
Trung Pham
Impact
moderate
##### Description

When handling the filename directive in the Content-Disposition header, the filename would be truncated if the filename contained a NULL character. This could have led to reflected file download attacks potentially tricking users to install malware.

##### References

* [Bug 1784348](https://bugzilla.mozilla.org/show_bug.cgi?id=1784348)

#### [#CVE-2023-29541: Files with malicious extensions could have been downloaded unsafely on Linux](#CVE-2023-29541)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Thunderbird did not properly handle downloads of files ending in `.desktop`, which can be interpreted to run attacker-controlled commands.
*This bug only affects Thunderbird for Linux on certain Distributions. Other operating systems are unaffected, and Mozilla is unable to enumerate all affected Linux Distributions.*

##### References

* [Bug 1810191](https://bugzilla.mozilla.org/show_bug.cgi?id=1810191)

#### [#CVE-2023-29542: Bypass of file download extension restrictions](#CVE-2023-29542)

Reporter
Shaheen Fazim and Ameen Basha M K
Impact
moderate
##### Description

A newline in a filename could have been used to bypass the file extension security mechanisms that replace malicious file extensions such as .lnk with .download. This could have led to accidental execution of malicious code.
*This bug only affects Thunderbird on Windows. Other versions of Thunderbird are unaffected.*

##### References

* [Bug 1815062](https://bugzilla.mozilla.org/show_bug.cgi?id=1815062)
* [Bug 1810793](https://bugzilla.mozilla.org/show_bug.cgi?id=1810793)

#### [#CVE-2023-29545: Windows Save As dialog resolved environment variables](#CVE-2023-29545)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Similar to CVE-2023-28163, this time when choosing 'Save Link As', suggested filenames containing environment variable names would have resolved those in the context of the current user.
*This bug only affects Thunderbird on Windows. Other versions of Thunderbird are unaffected.*

##### References

* [Bug 1823077](https://bugzilla.mozilla.org/show_bug.cgi?id=1823077)

#### [#CVE-2023-1945: Memory Corruption in Safe Browsing Code](#CVE-2023-1945)

Reporter
Gabriele Svelto
Impact
moderate
##### Description

Unexpected data returned from the Safe Browsing API could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1777588](https://bugzilla.mozilla.org/show_bug.cgi?id=1777588)

#### [#CVE-2023-29548: Incorrect optimization result on ARM64](#CVE-2023-29548)

Reporter
JunYoung Park
Impact
low
##### Description

A wrong lowering instruction in the ARM64 Ion compiler resulted in a wrong optimization result.

##### References

* [Bug 1822754](https://bugzilla.mozilla.org/show_bug.cgi?id=1822754)

#### [#CVE-2023-29550: Memory safety bugs fixed in Thunderbird 102.10](#CVE-2023-29550)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew Osmond, Sebastian Hengst, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1720594%2C1751945%2C1812498%2C1814217%2C1818357%2C1818762%2C1819493%2C1820389%2C1820602%2C1821448%2C1822413%2C1824828)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_8c82a6e1_20250114_222546.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1777588)
* [XML](/show_bug.cgi?ctype=xml&id=1777588)

Closed
[Bug 1777588](/show_bug.cgi?id=1777588)
(CVE-2023-1945)

Opened 3 years ago
Closed 2 years ago

# Crash in [@ nsTArray\_Impl<T>::~nsTArray\_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash in [@ nsTArray\_Impl<T>::~nsTArray\_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]

## Categories

### (Toolkit :: Safe Browsing, defect, P2)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Safe%20Browsing#Safe%20Browsing)

Safe Browsing
▾

Toolkit :: Safe Browsing
Safe Browsing UI and service (includes phishing protection).
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Safe%20Browsing&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Safe%20Browsing&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Safe%20Browsing)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

106 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [112+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=112%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 112+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gsvelto, Assigned: dimi)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/bd10912fd8637cc64f00edd465ca8b0d?d=mm&size=40)  [dimi](/user_profile?user_id=468232)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/03fda82227c39197ab49cd9cef4e3e89?d=mm&size=40)  [gsvelto](/user_profile?user_id=448747)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/bd10912fd8637cc64f00edd465ca8b0d?d=mm&size=40)  [dimi](/user_profile?user_id=468232)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: crash, csectype-uninitialized, sec-moderate, Whiteboard: [adv-esr102.10+r])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-1945

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-uninitialized](/buglist.cgi?keywords=csectype-uninitialized&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-esr102.10+r]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ arena\_dalloc | free | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet ]](https://crash-stats.mozilla.org/signature/?signature=arena_dalloc%20%7C%20free%20%7C%20nsUrlClassifierPrefixSet%3A%3A~nsUrlClassifierPrefixSet)

[[@ free | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet ]](https://crash-stats.mozilla.org/signature/?signature=free%20%7C%20nsUrlClassifierPrefixSet%3A%3A~nsUrlClassifierPrefixSet)

[[@ je\_free | nsTArray\_Impl<T>::~nsTArray\_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet ]](https://crash-stats.mozilla.org/signature/?signature=je_free%20%7C%20nsTArray_Impl%3CT%3E%3A%3A~nsTArray_Impl%20%7C%20nsUrlClassifierPrefixSet%3A%3A~nsUrlClassifierPrefixSet)

[[@ je\_free | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet ]](https://crash-stats.mozilla.org/signature/?signature=je_free%20%7C%20nsUrlClassifierPrefixSet%3A%3A~nsUrlClassifierPrefixSet)

[[@ nsTArray\_Impl<T>::~nsTArray\_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet ]](https://crash-stats.mozilla.org/signature/?signature=nsTArray_Impl%3CT%3E%3A%3A~nsTArray_Impl%20%7C%20nsUrlClassifierPrefixSet%3A%3A~nsUrlClassifierPrefixSet)

[[@ nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet ]](https://crash-stats.mozilla.org/signature/?signature=nsUrlClassifierPrefixSet%3A%3A~nsUrlClassifierPrefixSet)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1777588 - Init variable length prefix set in constructor r=timhuang](/attachment.cgi?id=9293452)  [2 years ago](#c8)  [Dimi Lee [:dimi]](/user_profile?user_id=468232)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr102+](#c15 "2 years ago") | [Details](/attachment.cgi?id=9293452&action=edit) | [Review](/attachment.cgi?id=9293452) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9327602)  [2 years ago](#c17)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   184 bytes, text/plain |  | [Details](/attachment.cgi?id=9327602&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1777588#c0)• 3 years ago |
|  | |

Crash report: <https://crash-stats.mozilla.org/report/index/b24d3d80-faa9-41ef-ae83-1b9f90220630>

Reason: `EXCEPTION_ACCESS_VIOLATION_READ`

Top 10 frames of crashing thread:

```
0 xul.dll nsTArray_Impl<DXGI_OUTPUT_DESC1, nsTArrayInfallibleAllocator>::~nsTArray_Impl xpcom/ds/nsTArray.h:1030
1 xul.dll nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet toolkit/components/url-classifier/nsUrlClassifierPrefixSet.cpp:39
2 xul.dll nsUrlClassifierPrefixSet::Release toolkit/components/url-classifier/nsUrlClassifierPrefixSet.cpp:27
3 xul.dll mozilla::safebrowsing::VariableLengthPrefixSet::Release toolkit/components/url-classifier/VariableLengthPrefixSet.cpp:41
4 xul.dll mozilla::safebrowsing::LookupCacheV2::~LookupCacheV2 toolkit/components/url-classifier/LookupCache.h:332
5 xul.dll nsTArray_Impl<RefPtr<mozilla::safebrowsing::LookupCache>, nsTArrayInfallibleAllocator>::Clear xpcom/ds/nsTArray.h:1934
6 xul.dll mozilla::safebrowsing::Classifier::RemoveUpdateIntermediaries toolkit/components/url-classifier/Classifier.cpp:594
7 xul.dll mozilla::safebrowsing::Classifier::SwapInNewTablesAndCleanup toolkit/components/url-classifier/Classifier.cpp:689
8 xul.dll mozilla::detail::RunnableFunction<`lambda at /builds/worker/checkouts/gecko/toolkit/components/url-classifier/Classifier.cpp:772:13'>::Run xpcom/threads/nsThreadUtils.h:531
9 xul.dll nsThread::ProcessNextEvent xpcom/threads/nsThread.cpp:1174

```

Putting this in the networking component but I'm not sure if it's the right one, so feel free to move it where appropriate.

This bug is bad news. It seems that we're accessing a dead object when destroying a nsUrlClassifierPrefixSet instance. Crashes appear to be either use-after-free accesses, double-frees or wild pointer accesses, presumably because the memory we pointed to was already allocated to another object.

I don't know what's the purpose of this code but given it has URL in the name and it's happening in the main process I guess this might be *very dangerous* if an attacker can trigger it somehow.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1777588#a357_406194)• 3 years ago |

Group: network-core-security → firefox-core-securityComponent: Networking → Safe BrowsingKeywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)Product: Core → Toolkit

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1777588#c1)• 3 years ago |
|  | |

More signatures.

Crash Signature: [@ nsTArray\_Impl<T>::~nsTArray\_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]
[@ je\_free | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet] → [@ nsTArray\_Impl<T>::~nsTArray\_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]
[@ je\_free | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]
[@ arena\_dalloc | free | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]
[@ je\_free | nsTA…

|  | [Dimi Lee [:dimi]](/user_profile?user_id=468232)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1777588#c2)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1777588&comment_id=15970396 "1 revision") |
|  | |

(In reply to Gabriele Svelto [:gsvelto] from [comment #0](/show_bug.cgi?id=1777588#c0 "RESOLVED FIXED - Crash in [@ nsTArray_Impl<T>::~nsTArray_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]"))

> I don't know what's the purpose of this code but given it has URL in the name and it's happening in the main process I guess this might be *very dangerous* if an attacker can trigger it somehow.

The code path is triggered by Safe Browsing update, and it's input is coming either from data provided by Google or data provided by us, so theoretically, this shouldn't be something can be triggered by an attacker.

From the crash reports, it seems this crash signature starts to occur after Fx101. Safe Browsing code hasn't changed for quite a long time, and I didn't see any suspicious changeset in 101 (most of the changes are cleanup, testcase refactoring, etc).

If I use `nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet` to [search crash signature](https://crash-stats.mozilla.org/search/?signature=~nsUrlClassifierPrefixSet%3A%3A~nsUrlClassifierPrefixSet&date=%3E%3D2022-06-27T08%3A26%3A00.000Z&date=%3C2022-07-04T08%3A26%3A00.000Z&_facets=signature&_sort=-date&_columns=date&_columns=signature&_columns=product&_columns=version&_columns=build_id&_columns=platform#crash-reports), I can also see a few crash reports that were reported in Android, so this issue is probably not because of platform dependent changes.

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1777588#c3)• 3 years ago |
|  | |

It is possible that the bug was already present but living under a different signature (see [this one](https://crash-stats.mozilla.org/signature/?product=Firefox&signature=je_free%20%7C%20nsUrlClassifierPrefixSet%3A%3A~nsUrlClassifierPrefixSet&date=%3E%3D2022-06-27T08%3A43%3A00.000Z&date=%3C2022-07-04T08%3A43%3A00.000Z&_columns=date&_columns=product&_columns=version&_columns=build_id&_columns=platform&_columns=reason&_columns=address&_columns=moz_crash_reason_raw&_sort=-date&page=1) which might be related). That being said it's also possible that some recent change made it spike.

|  | [Dimi Lee [:dimi]](/user_profile?user_id=468232)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1777588#c4)• 3 years ago |
|  | |

oops, my bad! Please ignore my previous comment regarding

> From the crash reports, it seems this crash signature starts to occur after Fx101`.

I totally forgot that the search result only show report from a week ago...

|  | [Dimi Lee [:dimi]](/user_profile?user_id=468232)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1777588#a2138601_468232)• 2 years ago |

Assignee: nobody → dleeStatus: NEW → ASSIGNED

|  | [Dimi Lee [:dimi]](/user_profile?user_id=468232)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1777588#c5)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1777588&comment_id=16002638 "1 revision") |
|  | |

(In reply to Dimi Lee [:dimi][:dlee] from [comment #2](/show_bug.cgi?id=1777588#c2 "RESOLVED FIXED - Crash in [@ nsTArray_Impl<T>::~nsTArray_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]"))

> (In reply to Gabriele Svelto [:gsvelto] from [comment #0](/show_bug.cgi?id=1777588#c0 "RESOLVED FIXED - Crash in [@ nsTArray_Impl<T>::~nsTArray_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]"))
>
> > I don't know what's the purpose of this code but given it has URL in the name and it's happening in the main process I guess this might be *very dangerous* if an attacker can trigger it somehow.
>
> The code path is triggered by Safe Browsing update, and it's input is coming either from data provided by Google or data provided by us, so theoretically, this shouldn't be something can be triggered by an attacker.

Hi Dan, just want to confirm. Given that this crash cannot be triggered by users (SafeBrowsing update code path and data is from sb list provider), do we still consider this issue as sec-high?

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1777588#c6)• 2 years ago |
|  | |

> I totally forgot that the search result only show report from a week ago...

... by defaul. You can adjust that by clicking on the "Show Filters" twistie in the upper right.

> Given that this crash cannot be triggered by users [...], do we still consider this issue as sec-high?

We shouldn't totally discount the possibility that our trusted SafeBrowsing providers could get hacked, and we know a large number of users are running under a MITM that could be malicious. But yeah, we can lower the rating. The former is an unlikely way to target Firefox users, and the latter likely involved malware on the local machine.

Flags: needinfo?(dveditz)Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1777588#c7)• 2 years ago |
|  | |

I found another signature, this one is a double-free.

Crash Signature: [@ nsTArray\_Impl<T>::~nsTArray\_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]
[@ je\_free | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]
[@ arena\_dalloc | free | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]
[@ je\_free | nsTA… → [@ arena\_dalloc | free | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]
[@ free | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]
[@ je\_free | nsTArray\_Impl<T>::~nsTArray\_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]
[@ je\_free…

|  | [Dimi Lee [:dimi]](/user_profile?user_id=468232)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1777588#a5917388_468232)• 2 years ago |

Priority: -- → P2

|  | [Dimi Lee [:dimi]](/user_profile?user_id=468232)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1777588#c8)• 2 years ago |
|  | |

Attached file
[Bug 1777588 - Init variable length prefix set in constructor r=timhuang](attachment.cgi?id=9293452)
— [Details](attachment.cgi?id=9293452&action=edit)

|  | [Dimi Lee [:dimi]](/user_profile?user_id=468232)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1777588#a5962905_468232)• 2 years ago |

Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1777588#c9)• 2 years ago |
|  | |

Init variable length prefix set in constructor r=timhuang

<https://hg.mozilla.org/integration/autoland/rev/3d45345ab447c451dbe57133268e56b11fcd4fdc>

<https://hg.mozilla.org/mozilla-central/rev/3d45345ab447>

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1777588#c10)• 2 years ago |
|  | |

The leave-open keyword is there and there is no activity for 6 months.

:dimi, maybe it's time to close this bug?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#leave_open_no_activity.py).

Flags: needinfo?(dlee)

|  | [Dimi Lee [:dimi]](/user_profile?user_id=468232)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1777588#c11)• 2 years ago |
|  | |

I think this is fixed

Status: ASSIGNED → RESOLVEDClosed: 2 years agoFlags: needinfo?(dlee)Resolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1777588#a21864524_1689)• 2 years ago |

Group: firefox-core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1777588#a21864757_1689)• 2 years ago |

Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1777588#c12)• 2 years ago |
|  | |

[Tracking Requested - why for this release]:

This patch seems to have worked: it landed in 106, and there are no crashes in versions > 105.x. This still affects ESR-102 and it's a small and safe fix for a security bug. On the other hand the volume is very low (avg 1 crash a day on esr) and it's rated sec-moderate because it's super unreliable and only indirectly triggerable by web content.

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=%3F)Keywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---) → [csectype-uninitialized](/buglist.cgi?keywords=csectype-uninitialized&resolution=---)Target Milestone: --- → 106 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1777588#a22052215_75935)• 2 years ago |

[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=%3F) → [112+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=112%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1777588#c13)• 2 years ago |
|  | |

Please nominate this for ESR102 approval when you get a chance.

Flags: needinfo?(dlee)

|  | [Dimi Lee [:dimi]](/user_profile?user_id=468232)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1777588#c14)• 2 years ago |
|  | |

Comment on [attachment 9293452](/attachment.cgi?id=9293452 "Bug 1777588 - Init variable length prefix set in constructor r=timhuang") [[details]](/attachment.cgi?id=9293452&action=edit "Bug 1777588 - Init variable length prefix set in constructor r=timhuang")

[Bug 1777588](/show_bug.cgi?id=1777588 "RESOLVED FIXED - Crash in [@ nsTArray_Impl<T>::~nsTArray_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]") - Init variable length prefix set in constructor r=timhuang

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Firefox might crash when SafeBrowsing runs update in the background
* **Fix Landed on Version**: 106
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch doesn't change any logic or behavior. The patch simply inits a memeber variable (nullptr) in the constructor.
Flags: needinfo?(dlee)
[Attachment #9293452](/attachment.cgi?id=9293452&action=edit "Bug 1777588 - Init variable length prefix set in constructor r=timhuang") -
Flags: approval-mozilla-esr102?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1777588#c15)• 2 years ago |
|  | |

Comment on [attachment 9293452](/attachment.cgi?id=9293452 "Bug 1777588 - Init variable length prefix set in constructor r=timhuang") [[details]](/attachment.cgi?id=9293452&action=edit "Bug 1777588 - Init variable length prefix set in constructor r=timhuang")

[Bug 1777588](/show_bug.cgi?id=1777588 "RESOLVED FIXED - Crash in [@ nsTArray_Impl<T>::~nsTArray_Impl | nsUrlClassifierPrefixSet::~nsUrlClassifierPrefixSet]") - Init variable length prefix set in constructor r=timhuang

Approved for 102.10esr.

[Attachment #9293452](/attachment.cgi?id=9293452&action=edit "Bug 1777588 - Init variable length prefix set in constructor r=timhuang") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1777588#c16)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/617c262d3b6f>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1777588#a24088944_578488)• 2 years ago |

Whiteboard: [adv-esr102.10+r]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1777588#c17)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327602)
— [Details](attachment.cgi?id=9327602&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1777588#a24282155_578488)• 2 years ago |

Alias: CVE-2023-1945

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1777588#a69851320_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1777588&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Dimi Lee [:dimi]](/user_profile?user_id=468232)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_4d973e86_20250114_222547.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-14

## Security Vulnerabilities fixed in Firefox ESR 102.10

Announced
April 11, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.10

#### [#CVE-2023-29531: Out-of-bound memory access in WebGL on macOS](#CVE-2023-29531)

Reporter
DoHyun Lee
Impact
high
##### Description

An attacker could have caused an out of bounds memory access using WebGL APIs, leading to memory corruption and a potentially exploitable crash.
*This bug only affects Firefox for macOS. Other operating systems are unaffected.*

##### References

* [Bug 1794292](https://bugzilla.mozilla.org/show_bug.cgi?id=1794292)

#### [#CVE-2023-29532: Mozilla Maintenance Service Write-lock bypass](#CVE-2023-29532)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

A local attacker can trick the Mozilla Maintenance Service into applying an unsigned update file by pointing the service at an update file on a malicious SMB server. The update file can be replaced after the signature check, before the use, because the write-lock requested by the service does not work on a SMB server.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1806394](https://bugzilla.mozilla.org/show_bug.cgi?id=1806394)

#### [#CVE-2023-29533: Fullscreen notification obscured](#CVE-2023-29533)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A website could have obscured the fullscreen notification by using a combination of `window.open`, fullscreen requests, `window.name` assignments, and `setInterval` calls. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1814597](https://bugzilla.mozilla.org/show_bug.cgi?id=1814597)
* [Bug 1798219](https://bugzilla.mozilla.org/show_bug.cgi?id=1798219)

#### [#CVE-2023-1999: Double-free in libwebp](#CVE-2023-1999)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A double-free in libwebp could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1819244](https://bugzilla.mozilla.org/show_bug.cgi?id=1819244)

#### [#CVE-2023-29535: Potential Memory Corruption following Garbage Collector compaction](#CVE-2023-29535)

Reporter
Lukas Bernhard
Impact
high
##### Description

Following a Garbage Collector compaction, weak maps may have been accessed before they were correctly traced. This resulted in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1820543](https://bugzilla.mozilla.org/show_bug.cgi?id=1820543)

#### [#CVE-2023-29536: Invalid free from JavaScript code](#CVE-2023-29536)

Reporter
zx from qriousec
Impact
high
##### Description

An attacker could cause the memory manager to incorrectly free a pointer that addresses attacker-controlled memory, resulting in an assertion, memory corruption, or a potentially exploitable crash.

##### References

* [Bug 1821959](https://bugzilla.mozilla.org/show_bug.cgi?id=1821959)

#### [#CVE-2023-29539: Content-Disposition filename truncation leads to Reflected File Download](#CVE-2023-29539)

Reporter
Trung Pham
Impact
moderate
##### Description

When handling the filename directive in the Content-Disposition header, the filename would be truncated if the filename contained a NULL character. This could have led to reflected file download attacks potentially tricking users to install malware.

##### References

* [Bug 1784348](https://bugzilla.mozilla.org/show_bug.cgi?id=1784348)

#### [#CVE-2023-29541: Files with malicious extensions could have been downloaded unsafely on Linux](#CVE-2023-29541)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Firefox did not properly handle downloads of files ending in `.desktop`, which can be interpreted to run attacker-controlled commands.
*This bug only affects Firefox for Linux on certain Distributions. Other operating systems are unaffected, and Mozilla is unable to enumerate all affected Linux Distributions.*

##### References

* [Bug 1810191](https://bugzilla.mozilla.org/show_bug.cgi?id=1810191)

#### [#CVE-2023-29542: Bypass of file download extension restrictions](#CVE-2023-29542)

Reporter
Shaheen Fazim and Ameen Basha M K
Impact
moderate
##### Description

A newline in a filename could have been used to bypass the file extension security mechanisms that replace malicious file extensions such as .lnk with .download. This could have led to accidental execution of malicious code.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1815062](https://bugzilla.mozilla.org/show_bug.cgi?id=1815062)
* [Bug 1810793](https://bugzilla.mozilla.org/show_bug.cgi?id=1810793)

#### [#CVE-2023-29545: Windows Save As dialog resolved environment variables](#CVE-2023-29545)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Similar to CVE-2023-28163, this time when choosing 'Save Link As', suggested filenames containing environment variable names would have resolved those in the context of the current user.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1823077](https://bugzilla.mozilla.org/show_bug.cgi?id=1823077)

#### [#CVE-2023-1945: Memory Corruption in Safe Browsing Code](#CVE-2023-1945)

Reporter
Gabriele Svelto
Impact
moderate
##### Description

Unexpected data returned from the Safe Browsing API could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1777588](https://bugzilla.mozilla.org/show_bug.cgi?id=1777588)

#### [#CVE-2023-29548: Incorrect optimization result on ARM64](#CVE-2023-29548)

Reporter
JunYoung Park
Impact
low
##### Description

A wrong lowering instruction in the ARM64 Ion compiler resulted in a wrong optimization result.

##### References

* [Bug 1822754](https://bugzilla.mozilla.org/show_bug.cgi?id=1822754)

#### [#CVE-2023-29550: Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](#CVE-2023-29550)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew Osmond, Sebastian Hengst, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 111 and Firefox ESR 102.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1720594%2C1751945%2C1812498%2C1814217%2C1818357%2C1818762%2C1819493%2C1820389%2C1820602%2C1821448%2C1822413%2C1824828)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


