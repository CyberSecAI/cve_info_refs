- **Root cause of vulnerability**: The plugin does not properly validate passwords for password-protected files. Upon successful password validation, it generates a master key that can be used to download any password-protected file, regardless of the original file's specific password.
- **Weaknesses/vulnerabilities present**: Broken Access Control (CWE-284)
- **Impact of exploitation**: An attacker can bypass password protection and download any password-protected file on the server if they know the password for at least one protected file.
- **Attack vectors**: The vulnerability can be exploited by navigating to a download page for a password-protected file, entering a valid password, intercepting the generated download request, and manipulating the URL parameter (`wpdmdl`) to point to a different protected file.
- **Required attacker capabilities/position**: The attacker must have access to the download page of at least one password-protected file and know the correct password for that file.