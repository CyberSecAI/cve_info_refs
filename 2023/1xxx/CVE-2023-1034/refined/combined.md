=== Content from github.com_bd9e617a_20250114_214045.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsalesagility%2Fsuitecrm%2Fcommit%2Fc19f221a41706efc8d73cef95c5e362c4f86bf06)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsalesagility%2Fsuitecrm%2Fcommit%2Fc19f221a41706efc8d73cef95c5e362c4f86bf06)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=salesagility%2FSuiteCRM)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[salesagility](/salesagility)
/
**[SuiteCRM](/salesagility/SuiteCRM)**
Public

* [Notifications](/login?return_to=%2Fsalesagility%2FSuiteCRM) You must be signed in to change notification settings
* [Fork
  2.1k](/login?return_to=%2Fsalesagility%2FSuiteCRM)
* [Star
   4.6k](/login?return_to=%2Fsalesagility%2FSuiteCRM)

* [Code](/salesagility/SuiteCRM)
* [Issues
  1.2k](/salesagility/SuiteCRM/issues)
* [Pull requests
  387](/salesagility/SuiteCRM/pulls)
* [Security](/salesagility/SuiteCRM/security)
* [Insights](/salesagility/SuiteCRM/pulse)

Additional navigation options

* [Code](/salesagility/SuiteCRM)
* [Issues](/salesagility/SuiteCRM/issues)
* [Pull requests](/salesagility/SuiteCRM/pulls)
* [Security](/salesagility/SuiteCRM/security)
* [Insights](/salesagility/SuiteCRM/pulse)

## Commit

[Permalink](/salesagility/SuiteCRM/commit/c19f221a41706efc8d73cef95c5e362c4f86bf06)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

SuiteCRM 7.12.9 Release

[Browse files](/salesagility/SuiteCRM/tree/c19f221a41706efc8d73cef95c5e362c4f86bf06)
Browse the repository at this point in the history

* Loading branch information

[![@jack7anderson7](https://avatars.githubusercontent.com/u/44227185?s=40&v=4)](/jack7anderson7)

[jack7anderson7](/salesagility/SuiteCRM/commits?author=jack7anderson7 "View all commits by jack7anderson7")
committed
Jan 25, 2023

1 parent
[ba20ee5](/salesagility/SuiteCRM/commit/ba20ee5da0e7df6896cdc0d14051830a10f34d50)

commit c19f221

 Show file tree

 Hide file tree

Showing
**21 changed files**
with
**339 additions**
and
**95 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Api/V8/JsonApi/Helper

  + Api/V8/JsonApi/Helper/AttributeObjectHelper.php
    [AttributeObjectHelper.php](#diff-c202a6e57649fb10d59ac25fdee1da60292f3bbc51a35463a1b8a1d4d292f73a)
* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* data

  + data/BeanFactory.php
    [BeanFactory.php](#diff-1d05a288ab65832c59e216632c5f113f466d79bf1218f434cbab947a9704ba90)
* files.md5
  [files.md5](#diff-d420c7fc1bf4ec536cc8542f30ceab961196bb8d3fbd68280e7d82cf75526dfc)
* include

  + InlineEditing

    - include/InlineEditing/InlineEditing.php
      [InlineEditing.php](#diff-a9751c7c4f9f5c14b01b0fd4094609fd48ffe0691b2ccbc36a2f5e5e3494f18c)
  + MySugar

    - include/MySugar/MySugar.php
      [MySugar.php](#diff-a9e6b1b89b7b1b1138ea8b7db9e2b9ee20360e83f8621ca008558a78af7d941f)
  + include/utils.php
    [utils.php](#diff-02bcf7291c8a96ce9bacea53cd3effc2b2d55adfb28cda04be20f6496951f67a)
* install

  + install/install\_utils.php
    [install\_utils.php](#diff-46ee44e06294aea6c0b81a137683744befe546b6965e8d7b42d47c5a7686a165)
* lib/API/JsonApi/v1/Resource

  + lib/API/JsonApi/v1/Resource/SuiteBeanResource.php
    [SuiteBeanResource.php](#diff-55adc6d106e94c2209e6c7176bfd6b7f55f64ee49b01e080f2ee4ee9ab167a4e)
* modules

  + AOS\_Products

    - modules/AOS\_Products/AOS\_Products.php
      [AOS\_Products.php](#diff-a0f8033c2d255b4bb24901815c0544fb622f31e37bfeca6cb72094ee7018afc7)
  + Administration

    - modules/Administration/UpgradeWizard.php
      [UpgradeWizard.php](#diff-82ad03d04fd0b24d524360e0e433f9030e44f7b3b37be5354d0481ac24fb21ec)
  + Campaigns

    - modules/Campaigns/WebToPersonCapture.php
      [WebToPersonCapture.php](#diff-7383f62b3905604e9062cd0d85974331af35c229f6760744ab46a331daa58d0f)
    - modules/Campaigns/utils.php
      [utils.php](#diff-62c5f30fb0be5b22419dc44ca20a003797d342a74568ae3b345291cb5cfc2ba4)
  + Contacts

    - modules/Contacts/ContactFormBase.php
      [ContactFormBase.php](#diff-2a18b0defc300b6303c537c825729a0679c79cb4c2e6d3c99a1fa7c8623eaaa3)
  + EmailTemplates

    - modules/EmailTemplates/AttachFiles.php
      [AttachFiles.php](#diff-43900f1a2d29e8148a230a74d89adf8faa7ea7270de37cdd0f832034f33cd539)
  + Emails/include/ComposeView

    - modules/Emails/include/ComposeView/ComposeView.tpl
      [ComposeView.tpl](#diff-2b2834887f7b65c3009a97c9f2ba72e4ba600c7436c544c8a142414e06afc3f3)
  + Employees

    - modules/Employees/Employee.php
      [Employee.php](#diff-1a0b65ddce04fb609051bf2a8caa29e59bbcedfda93207d305844787833cc010)
  + Leads

    - modules/Leads/LeadFormBase.php
      [LeadFormBase.php](#diff-e3193b2e9913faac4b3cdc4cf3c20ad58e903d64498dc8ebfc10151d59b7ed18)
  + Prospects

    - modules/Prospects/ProspectFormBase.php
      [ProspectFormBase.php](#diff-b77c43b26d20e6fbf36527d755d55ee065df38341c2881021a44778213316a73)
  + Users

    - modules/Users/User.php
      [User.php](#diff-84ce4ac555dd30aad423365771cf68b51d89749221dc655000ad39dd4a85a04d)
* suitecrm\_version.php
  [suitecrm\_version.php](#diff-ee1f3c51a24e0c90a25eeabd19e8334ac6290eafd37f53388d053a4d76477320)

## There are no files selected for viewing

22 changes: 20 additions & 2 deletions

22
[Api/V8/JsonApi/Helper/AttributeObjectHelper.php](#diff-c202a6e57649fb10d59ac25fdee1da60292f3bbc51a35463a1b8a1d4d292f73a "Api/V8/JsonApi/Helper/AttributeObjectHelper.php")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/Api/V8/JsonApi/Helper/AttributeObjectHelper.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,6 +29,24 @@ public function getAttributes(\SugarBean $bean, $fields = null) |
|  |  | { |
|  |  | $bean->fixUpFormatting(); |
|  |  |  |
|  |  | $allowedField = []; |
|  |  |  |
|  |  | $fieldsToParse = $fields; |
|  |  | if (empty($fields)) { |
|  |  | $fieldsToParse = array\_keys($bean->field\_defs); |
|  |  | } |
|  |  |  |
|  |  | foreach ($fieldsToParse ?? [] as $index => $field) { |
|  |  | $isSensitive = isTrue($bean->field\_defs[$field]['sensitive'] ?? false); |
|  |  | $notApiVisible = isFalse($bean->field\_defs[$field]['api-visible'] ?? true); |
|  |  |  |
|  |  | if ($isSensitive || $notApiVisible){ |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | $allowedField[$index] = $field; |
|  |  | } |
|  |  |  |
|  |  | // using the ISO 8601 format for dates |
|  |  | $attributes = array\_map(function ($value) { |
|  |  | return is\_string($value) |
| Expand All | | @@ -38,8 +56,8 @@ public function getAttributes(\SugarBean $bean, $fields = null) |
|  |  | : $value; |
|  |  | }, $bean->toArray()); |
|  |  |  |
|  |  | if ($fields !== null) { |
|  |  | $attributes = array\_intersect\_key($attributes, array\_flip($fields)); |
|  |  | if ($allowedField !== null) { |
|  |  | $attributes = array\_intersect\_key($attributes, array\_flip($allowedField)); |
|  |  | } |
|  |  |  |
|  |  | unset($attributes['id']); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -2,7 +2,7 @@ |
|  |  | <img width="180px" height="41px" src="https://suitecrm.com/wp-content/uploads/2017/12/logo.png" align="right" /> |
|  |  | </a> |
|  |  |  |
|  |  | # SuiteCRM 7.12.8 |
|  |  | # SuiteCRM 7.12.9 |
|  |  |  |
|  |  | [![Build Status](https://travis-ci.org/salesagility/SuiteCRM.svg?branch=hotfix)](https://travis-ci.org/salesagility/SuiteCRM) |
|  |  | [![codecov](https://codecov.io/gh/salesagility/SuiteCRM/branch/hotfix/graph/badge.svg)](https://codecov.io/gh/salesagility/SuiteCRM/branch/hotfix) |
| Expand Down | |  |

45 changes: 45 additions & 0 deletions

45
[data/BeanFactory.php](#diff-1d05a288ab65832c59e216632c5f113f466d79bf1218f434cbab947a9704ba90 "data/BeanFactory.php")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/data/BeanFactory.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -151,6 +151,51 @@ public static function getBean($module, $id = null, $params = [], $deleted = tru |
|  |  | return $bean; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Returns a SugarBean object by id. |
|  |  | \* |
|  |  | \* @static |
|  |  | \* |
|  |  | \* @param string $module |
|  |  | \* @param string $id |
|  |  | \* @param array $params |
|  |  | \* A name/value array of parameters. Names: encode, deleted. |
|  |  | \* If $params is boolean we revert to the old arguments (encode, deleted), and use $params as $encode. |
|  |  | \* This will be changed to using only $params in later versions. |
|  |  | \* @param bool $deleted |
|  |  | \* @see SugarBean::retrieve |
|  |  | \* |
|  |  | \* @return SugarBean|bool |
|  |  | \*/ |
|  |  | public static function getReloadedBean($module, $id = null, $params = [], $deleted = true) |
|  |  | { |
|  |  | $params = self::convertParams($params); |
|  |  | $encode = self::hasEncodeFlag($params); |
|  |  | $deleted = self::hasDeletedFlag($params, $deleted); |
|  |  |  |
|  |  | $beanClass = self::getBeanClass($module); |
|  |  |  |
|  |  | if (!self::loadBeanFile($module)) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | if (empty($id)) { |
|  |  | return new $beanClass(); |
|  |  | } |
|  |  |  |
|  |  | /\* @var SugarBean $bean \*/ |
|  |  | $bean = new $beanClass(); |
|  |  |  |
|  |  | $result = $bean->retrieve($id, $encode, $deleted); |
|  |  |  |
|  |  | if ($result === null) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | return $bean; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Shallow beans are created by SugarBean during the fill\_in\_relationship\_fields method, and they differ from |
|  |  | \* 'complete' bean in that they do not have their own relate fields completed. |
| Expand Down | |  |

72 changes: 36 additions & 36 deletions

72
[files.md5](#diff-d420c7fc1bf4ec536cc8542f30ceab961196bb8d3fbd68280e7d82cf75526dfc "files.md5")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/files.md5)
Edit file

Delete file

Load diff

Large diffs are not rendered by default.

Oops, something went wrong.

Retry

7 changes: 6 additions & 1 deletion

7
[include/InlineEditing/InlineEditing.php](#diff-a9751c7c4f9f5c14b01b0fd4094609fd48ffe0691b2ccbc36a2f5e5e3494f18c "include/InlineEditing/InlineEditing.php")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/include/InlineEditing/InlineEditing.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -52,6 +52,11 @@ function getEditFieldHTML($module, $fieldname, $aow\_field, $view = 'EditView', $ |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | $vardef = $bean->getFieldDefinition($fieldname); |
|  |  |  |
|  |  | if (isTrue($vardef['sensitive'] ?? false) || isFalse($vardef['api-visible'] ?? true)){ |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | $value = getFieldValueFromModule($fieldname, $module, $id); |
|  |  | // use the mod\_strings for this module |
| Expand Down  Expand Up | | @@ -126,7 +131,7 @@ function getEditFieldHTML($module, $fieldname, $aow\_field, $view = 'EditView', $ |
|  |  | if (isset($vardef['name']) && ($vardef['name'] == 'date\_modified')) { |
|  |  | $vardef['name'] = 'aow\_temp\_date'; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | if (isset($vardef['help'])) { |
|  |  | $vardef['help'] = htmlspecialchars($vardef['help'],ENT\_QUOTES); |
|  |  | } |
| Expand Down | |  |

5 changes: 5 additions & 0 deletions

5
[include/MySugar/MySugar.php](#diff-a9e6b1b89b7b1b1138ea8b7db9e2b9ee20360e83f8621ca008558a78af7d941f "include/MySugar/MySugar.php")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/include/MySugar/MySugar.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -95,6 +95,11 @@ public function addDashlet() |
|  |  |  |
|  |  | $dashlets = $current\_user->getPreference('dashlets', $this->type); |
|  |  |  |
|  |  | if (!empty($\_POST['type\_module']) && stripos($\_POST['type\_module'], 'phar://') !== false) { |
|  |  | LoggerManager::getLogger()->security('MySugar:addDashlet unsecure type\_module received: ' . $\_POST['type\_module']); |
|  |  | throw new RuntimeException('Invalid type\_module'); |
|  |  | } |
|  |  |  |
|  |  | $guid = create\_guid(); |
|  |  | $options = array(); |
|  |  | if (isset($\_POST['type'], $\_POST['type\_module']) && $\_POST['type'] == 'web') { |
| Expand Down | |  |

30 changes: 28 additions & 2 deletions

30
[include/utils.php](#diff-02bcf7291c8a96ce9bacea53cd3effc2b2d55adfb28cda04be20f6496951f67a "include/utils.php")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/include/utils.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -206,6 +206,9 @@ function make\_sugar\_config(&$sugar\_config) |
|  |  | 'php3', |
|  |  | 'php4', |
|  |  | 'php5', |
|  |  | 'php6', |
|  |  | 'php7', |
|  |  | 'php8', |
|  |  | 'pl', |
|  |  | 'cgi', |
|  |  | 'py', |
| Expand Down  Expand Up | | @@ -468,6 +471,9 @@ function get\_sugar\_config\_defaults(): array |
|  |  | 'php3', |
|  |  | 'php4', |
|  |  | 'php5', |
|  |  | 'php6', |
|  |  | 'php7', |
|  |  | 'php8', |
|  |  | 'pl', |
|  |  | 'cgi', |
|  |  | 'py', |
| Expand All | | @@ -485,7 +491,8 @@ function get\_sugar\_config\_defaults(): array |
|  |  | 'png', |
|  |  | 'jpg', |
|  |  | 'jpeg', |
|  |  | 'svg' |
|  |  | 'svg', |
|  |  | 'bmp' |
|  |  | ], |
|  |  | 'allowed\_preview' => [ |
|  |  | 'pdf', |
| Expand Down  Expand Up | | @@ -1351,7 +1358,7 @@ function return\_module\_language($language, $module, $refresh = false) |
|  |  | global $currentModule; |
|  |  |  |
|  |  | // Jenny - Bug 8119: Need to check if $module is not empty |
|  |  | if (empty($module)) { |
|  |  | if (empty($module) || !isAllowedModuleName($module)) { |
|  |  | $GLOBALS['log']->warn('Variable module is not in return\_module\_language, see more info: debug\_backtrace()'); |
|  |  |  |
|  |  | return array(); |
| Expand Down  Expand Up | | @@ -6025,3 +6032,22 @@ function get\_id\_validation\_pattern(): string { |
|  |  |  |
|  |  | return $pattern; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Check if is string is an allowed module name |
|  |  | \* @param string $value |
|  |  | \* @return bool |
|  |  | \*/ |
|  |  | function isAllowedModuleName(string $value): bool { |
|  |  | if (empty($value)) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | $result = preg\_match("/^[\w\-\\_\.]+$/", $value); |
|  |  |  |
|  |  | if (!empty($result)) { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | return false; |
|  |  | } |

6 changes: 3 additions & 3 deletions

6
[install/install\_utils.php](#diff-46ee44e06294aea6c0b81a137683744befe546b6965e8d7b42d47c5a7686a165 "install/install_utils.php")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/install/install_utils.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -994,7 +994,7 @@ function handleHtaccess() |
|  |  | $restrict\_str .= <<<EOQ |
|  |  | RedirectMatch 403 {$ignoreCase}.\*\.log$ |
|  |  | RedirectMatch 403 {$ignoreCase}/+not\_imported\_.\*\.txt |
|  |  | RedirectMatch 403 {$ignoreCase}/+(soap|cache|xtemplate|data|examples|include|log4php|metadata|modules|vendor)/+.\*\.(php|tpl) |
|  |  | RedirectMatch 403 {$ignoreCase}/+(soap|cache|xtemplate|data|examples|include|log4php|metadata|modules|vendor)/+.\*\.(php|tpl|phar) |
|  |  | RedirectMatch 403 {$ignoreCase}/+emailmandelivery\.php |
|  |  | RedirectMatch 403 {$ignoreCase}/+.git |
|  |  | RedirectMatch 403 {$ignoreCase}/+.{$cacheDir} |
| Expand Down  Expand Up | | @@ -1043,7 +1043,7 @@ function handleHtaccess() |
|  |  |  |
|  |  | # CSS |
|  |  | ExpiresByType text/css "access plus 1 year" |
|  |  |  |
|  |  |  |
|  |  | # Data |
|  |  | ExpiresByType application/atom+xml "access plus 1 hour" |
|  |  | ExpiresByType application/rdf+xml "access plus 1 hour" |
| Expand Down  Expand Up | | @@ -1296,7 +1296,7 @@ function create\_default\_users() |
|  |  | global $sugar\_config; |
|  |  |  |
|  |  | require\_once('install/UserDemoData.php'); |
|  |  |  |
|  |  |  |
|  |  | //Create default admin user |
|  |  | $user = BeanFactory::newBean('Users'); |
|  |  | $user->id = 1; |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[lib/API/JsonApi/v1/Resource/SuiteBeanResource.php](#diff-55adc6d106e94c2209e6c7176bfd6b7f55f64ee49b01e080f2ee4ee9ab167a4e "lib/API/JsonApi/v1/Resource/SuiteBeanResource.php")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/lib/API/JsonApi/v1/Resource/SuiteBeanResource.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -115,6 +115,13 @@ public function fromSugarBean($sugarBean, $source = ResourceEnum::DEFAULT\_SOURCE |
|  |  | throw $exception; |
|  |  | } |
|  |  |  |
|  |  | $isSensitive = isTrue($definition['sensitive'] ?? false); |
|  |  | $notApiVisible = isFalse($definition['api-visible'] ?? true); |
|  |  |  |
|  |  | if ($isSensitive || $notApiVisible){ |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | if ($definition['type'] === 'datetime' && isset($sugarBean->$fieldName)) { |
|  |  | // Convert to DB date |
|  |  | $datetime = $dateTimeConverter->fromUser($sugarBean->$fieldName); |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[modules/AOS\_Products/AOS\_Products.php](#diff-a0f8033c2d255b4bb24901815c0544fb622f31e37bfeca6cb72094ee7018afc7 "modules/AOS_Products/AOS_Products.php")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/modules/AOS_Products/AOS_Products.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -64,6 +64,12 @@ public function save($check\_notify = false) |
|  |  | require\_once('include/upload\_file.php'); |
|  |  | $GLOBALS['log']->debug('UPLOADING PRODUCT IMAGE'); |
|  |  |  |
|  |  | $imageFileName = $\_FILES['uploadimage']['name'] ?? ''; |
|  |  | if (!has\_valid\_image\_extension('AOS\_Products Uploaded image file: ' . $imageFileName , $imageFileName)) { |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fsalesagility%2Fsuitecrm%2Fcommit%2Fc19f221a41706efc8d73cef95c5e362c4f86bf06)       Sorry, something went wrong.           Copy link    Quote reply     @lazka **[lazka](/lazka)** [Jan 26, 2023](#r98160611) Contributor   this broke the unit tests     😕 1  peter-palmer reacted with confused emoji   All reactions  * 😕   1 reaction | | |
|  |  | LoggerManager::getLogger()->fatal("AOS\_Products save - Invalid image file ext : '$imageFileName'."); |
|  |  | throw new RuntimeException('Invalid request'); |
|  |  | } |
|  |  |  |
|  |  | if (!empty($\_FILES['uploadimage']['tmp\_name']) && verify\_uploaded\_image($\_FILES['uploadimage']['tmp\_name'])) { |
|  |  | if ($\_FILES['uploadimage']['size'] > $sugar\_config['upload\_maxsize']) { |
|  |  | die($mod\_strings['LBL\_IMAGE\_UPLOAD\_FAIL'] . $sugar\_config['upload\_maxsize']); |
| Expand Down | |  |

12 changes: 9 additions & 3 deletions

12
[modules/Administration/UpgradeWizard.php](#diff-82ad03d04fd0b24d524360e0e433f9030e44f7b3b37be5354d0481ac24fb21ec "modules/Administration/UpgradeWizard.php")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/modules/Administration/UpgradeWizard.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -106,9 +106,15 @@ function unlinkTempFiles() |
|  |  | $perform = true; |
|  |  | $base\_filename = urldecode($tempFile); |
|  |  | } elseif (!empty($\_REQUEST['load\_module\_from\_dir'])) { |
|  |  | $moduleDir = $\_REQUEST['load\_module\_from\_dir']; |
|  |  | if (strpos($moduleDir, 'phar://') !== false) { |
|  |  | die(); |
|  |  | $moduleDir = $\_REQUEST['load\_module\_from\_dir'] ?? ''; |
|  |  | if (stripos($moduleDir, 'phar://') !== false) { |
|  |  | LoggerManager::getLogger()->fatal("UpgradeWizard - invalid load\_module\_from\_dir: " . $moduleDir); |
|  |  | throw new RuntimeException('Invalid request'); |
|  |  | } |
|  |  |  |
|  |  | if (strtolower(pathinfo(urldecode($\_REQUEST['upgrade\_zip\_escaped'] ?? ''), PATHINFO\_EXTENSION)) !== 'zip'){ |
|  |  | LoggerManager::getLogger()->fatal("UpgradeWizard - invalid upgrade\_zip\_escaped: " . $\_REQUEST['upgrade\_zip\_escaped'] ?? ''); |
|  |  | throw new RuntimeException("Invalid request"); |
|  |  | } |
|  |  | //copy file to proper location then call performSetup |
|  |  | copy($moduleDir . '/' . $\_REQUEST['upgrade\_zip\_escaped'], "upload://" . $\_REQUEST['upgrade\_zip\_escaped']); |
| Expand Down | |  |

13 changes: 9 additions & 4 deletions

13
[modules/Campaigns/WebToPersonCapture.php](#diff-7383f62b3905604e9062cd0d85974331af35c229f6760744ab46a331daa58d0f "modules/Campaigns/WebToPersonCapture.php")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/modules/Campaigns/WebToPersonCapture.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -54,6 +54,11 @@ |
|  |  | die('Not a valid module directory'); |
|  |  | } |
|  |  |  |
|  |  | if (!isValidWebToPersonModule($moduleDir)) { |
|  |  | LoggerManager::getLogger()->fatal('Trying to run WepToPersonCapture for invalid module: ' . $moduleDir); |
|  |  | throw new RuntimeException('Not a valid module'); |
|  |  | } |
|  |  |  |
|  |  | global $app\_strings, $sugar\_config, $timedate, $current\_user; |
|  |  |  |
|  |  | $mod\_strings = return\_module\_language($sugar\_config['default\_language'], $moduleDir); |
| Expand Down  Expand Up | | @@ -120,7 +125,7 @@ |
|  |  |  |
|  |  | //As form base items are not necessarily in place for the custom classes that extend Person, cannot use |
|  |  | //the hendleSave method of the formbase |
|  |  |  |
|  |  |  |
|  |  | $optInEmailFields = array(); |
|  |  | $optInPrefix = 'opt\_in\_'; |
|  |  |  |
| Expand Down  Expand Up | | @@ -209,8 +214,8 @@ |
|  |  | $sea->AddUpdateEmailAddress($person->email2, 0, 1); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | if (!empty($optInEmailFields)) { |
|  |  | // Look for opted out |
|  |  | $optedOut = array(); |
| Expand Down  Expand Up | | @@ -342,7 +347,7 @@ |
|  |  | $log = LoggerManager::getLogger(); |
|  |  | $log->error('Success but some error occurred: ' . implode(', ', $errors)); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | //If the custom module does not have a LBL\_THANKS\_FOR\_SUBMITTING label, default to this general one |
|  |  | echo $app\_strings['LBL\_THANKS\_FOR\_SUBMITTING']; |
|  |  | } |
| Expand Down | |  |

46 changes: 38 additions & 8 deletions

46
[modules/Campaigns/utils.php](#diff-62c5f30fb0be5b22419dc44ca20a003797d342a74568ae3b345291cb5cfc2ba4 "modules/Campaigns/utils.php")

Show comments

[View file](/salesagility/SuiteCRM/blob/c19f221a41706efc8d73cef95c5e362c4f86bf06/modules/Campaigns/utils.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -54,7 +54,7 @@ |
|  |  | \*name and list of all prospects associated with this campaign.. |
|  |  | \* |
|  |  | \*/ |
|  |  | function get\_message\_scope\_dom($campaign\_id, $campaign\_name, $db=null, $mod\_strings=array()) |
|  |  | function get\_message\_scope\_dom($campaign\_id, $campaign\_name, $db = null, $mod\_strings = array()) |
|  |  | { |
|  |  | if (empty($db)) { |
|  |  | $db = DBManagerFactory::getInstance(); |
| Expand All | | @@ -65,7 +65,7 @@ function get\_message\_scope\_dom($campaign\_id, $campaign\_name, $db=null, $mod\_stri |
|  |  | } |
|  |  |  |
|  |  | //find prospect list attached to this campaign.. |
|  |  | $query =  "SELECT prospect\_list\_id, prospect\_lists.name "; |
|  |  | $query = "SELECT prospect\_list\_id, prospect\_lists.name "; |
|  |  | $query .= "FROM prospect\_list\_campaigns "; |
|  |  | $query .= "INNER join prospect\_lists on prospect\_lists.id = prospect\_list\_campaigns.prospect\_list\_id "; |
|  |  | $query .= "WHERE prospect\_lists.deleted = 0 "; |
| Expand Down  Expand Up | | @@ -297,21 +297,21 @@ function log\_campaign\_activity($identifier, $activity, $update = true, $clicked\_ |
|  |  | //values for return array.. |
|  |  | $return\_array['target\_id'] = $row['target\_id']; |
|  |  | $return\_array['target\_type'] = $row['target\_type']; |
|  |  |  |
|  |  |  |
|  |  | // quote variable first |
|  |  | $dataArrayKeys = array\_keys($data); |
|  |  | $dataArrayKeysQuoted = array(); |
|  |  | foreach ($dataArrayKeys as $dataArrayKey) { |
|  |  | $dataArrayKeysQuoted[] = $db->quote($dataArrayKey); |
|  |  | } |
|  |  | $dataArrayKeysQuotedImplode = implode(', ', $dataArrayKeysQuoted); |
|  |  |  |
|  |  |  |
|  |  | $insert\_query = "INSERT into campaign\_log (" . $dataArrayKeysQuotedImplode . ")"; |
|  |  |  |
|  |  |  |
|  |  | $dataArrayValuesQuotedImplode = implode(', ', array\_values($data)); |
|  |  |  |
|  |  |  |
|  |  | $insert\_query .= " VALUES (" . $dataArrayValuesQuotedImplode . ")"; |
|  |  |  |
|  |  |  |
|  |  | $db->query($insert\_query); |
|  |  | } |
|  |  | } else { |
| Expand All | | @@ -331,7 +331,7 @@ function log\_campaign\_activity($identifier, $activity, $update = true, $clicked\_ |
|  |  | $rowCampaignIdQuoted = $db->quote($row['campaign\_id']); |
|  |  | $query = "SELECT campaigns.\* FROM campaigns WHERE campaigns.id = '" . $rowCampaignIdQuoted . "' "; |
|  |  | $result = $db->query($query); |
|  |  |  |
|  |  |  |
|  |  | if (!empty($result)) { |
|  |  | $c\_row = $db->fetchByAssoc($result); |
|  |  |  |
| Expand Down  Expand Up | | @@ -1160,3 +1160,33 @@ function filterFieldsFromBeans($beans) |
|  |  | } |
|  |  | return $formattedBeans; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Get valid web to person modules |
|  |  | \* @return array |
|  |  | \*/ |
|  |  | function getValidWebToPersonModules(): array |
|  |  | { |
|  |  | $superclass = 'Person'; |
|  |  | $modules = []; |
|  |  | foreach ($GLOBALS['moduleList'] as $mod) { |
|  |  | $item = BeanFactory::getBean($mod); |
|  |  | if ($item && is\_subclass\_of($item, $superclass)) { |
|  |  | $modules[] = $item->module\_name; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return $modules; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Check if it is a valid WebToPerson module |
|  |  | \* @param string $module |
|  |  | \* @return bool |
|  |  | \*/ |
|  |  | function isValidWebToPersonModule(string $module): bool |
|  |  | { |
|  |  | $validModules = getValidWebToPersonModules(); |
|  |  |  |
|  |  | return in\_array($module, $validModules, true); |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c19f221`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsalesagility%2Fsuitecrm%2Fcommit%2Fc19f221a41706efc8d73cef95c5e362c4f86bf06) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from huntr.dev_658c8633_20250114_214045.html ===


* [![logo](/horizontal-logo-wh.svg)](/)
* [Bounties](/bounties)
* [Partners](/partners)
* Community
* Info
[SUBMIT REPORT](/bounties/disclose)

Supported by [Protect AI](https://protectai.com/) and leading the way to [MLSecOps](https://mlsecops.com) and greater AI security.

© 2024

[Privacy Policy](/privacy)[Terms of Service](/terms)[Code of Conduct](/code-of-conduct)Cookie Preferences[Contact Us](/contact-us)
