=== Content from github.com_4d97af01_20250114_215528.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxiaozhuai%2Fimageinfo%2Fissues%2F1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxiaozhuai%2Fimageinfo%2Fissues%2F1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=xiaozhuai%2Fimageinfo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xiaozhuai](/xiaozhuai)
/
**[imageinfo](/xiaozhuai/imageinfo)**
Public

* [Notifications](/login?return_to=%2Fxiaozhuai%2Fimageinfo) You must be signed in to change notification settings
* [Fork
  27](/login?return_to=%2Fxiaozhuai%2Fimageinfo)
* [Star
   113](/login?return_to=%2Fxiaozhuai%2Fimageinfo)

* [Code](/xiaozhuai/imageinfo)
* [Issues
  0](/xiaozhuai/imageinfo/issues)
* [Pull requests
  0](/xiaozhuai/imageinfo/pulls)
* [Actions](/xiaozhuai/imageinfo/actions)
* [Projects
  0](/xiaozhuai/imageinfo/projects)
* [Security](/xiaozhuai/imageinfo/security)
* [Insights](/xiaozhuai/imageinfo/pulse)

Additional navigation options

* [Code](/xiaozhuai/imageinfo)
* [Issues](/xiaozhuai/imageinfo/issues)
* [Pull requests](/xiaozhuai/imageinfo/pulls)
* [Actions](/xiaozhuai/imageinfo/actions)
* [Projects](/xiaozhuai/imageinfo/projects)
* [Security](/xiaozhuai/imageinfo/security)
* [Insights](/xiaozhuai/imageinfo/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fxiaozhuai%2Fimageinfo%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fxiaozhuai%2Fimageinfo%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Security Issue Report #1

Closed

[10cksYiqiyinHangzhouTechnology](/10cksYiqiyinHangzhouTechnology) opened this issue
Feb 26, 2023
· 0 comments

Closed

# [Security Issue Report](#top) #1

[10cksYiqiyinHangzhouTechnology](/10cksYiqiyinHangzhouTechnology) opened this issue
Feb 26, 2023
· 0 comments

## Comments

[![@10cksYiqiyinHangzhouTechnology](https://avatars.githubusercontent.com/u/124653481?s=80&u=05ab073098200e0947d0f279377d00d02afbb8c8&v=4)](/10cksYiqiyinHangzhouTechnology)

Copy link

### **[10cksYiqiyinHangzhouTechnology](/10cksYiqiyinHangzhouTechnology)** commented [Feb 26, 2023](#issue-1600041028)

| [Project address](https://github.com/xiaozhuai/imageinfo)  [afl\_imageinfo](https://github.com/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/imageinfo)  [asan\_imageinfo](https://github.com/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/asan_imageinfo)  [poc:id02](https://github.com/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/id02) Build original project ``` cmake -B build . cmake --build build -- all cmake --build build -- check ``` Build afl project ``` Cmakelist.txt add：  set (CMAKE_C_COMPILER "/usr/local/bin/afl-clang-fast") set (CMAKE_CXX_COMPILER "/usr/local/bin/afl-clang-fast++")  ``` Run ``` ./imageinfo id02  ``` 02Vulnerability type READ memory access causes SEGV stack overflow. ASAN ``` ubuntu@ubuntu:~/Desktop/imageinfo/imageinfo/build$ ./imageinfo ../../build/output/default/crashes/id\:000002\,sig\:11\,src\:000007\,time\:76911\,execs\:21200\,op\:havoc\,rep\:16  AddressSanitizer:DEADLYSIGNAL ================================================================= ==3079903==ERROR: AddressSanitizer: SEGV on unknown address 0x6110010000bc (pc 0x555555583ae4 bp 0x7fffffffd7e0 sp 0x7fffffffd230 T0) ==3079903==The signal is caused by a READ memory access.     #0 0x555555583ae3 in {lambda(unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)#1}::operator()(unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&) const (/home/ubuntu/Desktop/imageinfo/imageinfo/build/imageinfo+0x2fae3)     #1 0x5555555843c1 in _ZNSt17_Function_handlerIFbmR15IIReadInterfaceRlS2_RSt6vectorISt5arrayIlLm2EESaIS5_EEEUlmS1_S2_S2_S8_E_E9_M_invokeERKSt9_Any_dataOmS1_S2_S2_S8_ (/home/ubuntu/Desktop/imageinfo/imageinfo/build/imageinfo+0x303c1)     #2 0x55555557cf11 in main (/home/ubuntu/Desktop/imageinfo/imageinfo/build/imageinfo+0x28f11)     #3 0x7ffff7068082 in __libc_start_main ../csu/libc-start.c:308     #4 0x55555556adad in _start (/home/ubuntu/Desktop/imageinfo/imageinfo/build/imageinfo+0x16dad)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV (/home/ubuntu/Desktop/imageinfo/imageinfo/build/imageinfo+0x2fae3) in {lambda(unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)#1}::operator()(unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&) const ==3079903==ABORTING ``` GDB ``` ubuntu@ubuntu:~/Desktop/imageinfo/build$ gdb --args ./imageinfo output/default/crashes/id\:000002\,sig\:11\,src\:000007\,time\:76911\,execs\:21200\,op\:havoc\,rep\:16  GNU gdb (Ubuntu 9.2-0ubuntu1~20.04.1) 9.2 Copyright (C) 2020 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html> This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. Type "show copying" and "show warranty" for details. This GDB was configured as "x86_64-linux-gnu". Type "show configuration" for configuration details. For bug reporting instructions, please see: <http://www.gnu.org/software/gdb/bugs/>. Find the GDB manual and other documentation resources online at:     <http://www.gnu.org/software/gdb/documentation/>.  For help, type "help". Type "apropos word" to search for commands related to "word"... Reading symbols from ./imageinfo...  gdb-peda$ r output/default/crashes/id\:000002\,sig\:11\,src\:000007\,time\:76911\,execs\:21200\,op\:havoc\,rep\:16  Starting program: /home/ubuntu/Desktop/imageinfo/build/imageinfo output/default/crashes/id\:000002\,sig\:11\,src\:000007\,time\:76911\,execs\:21200\,op\:havoc\,rep\:16  Program received signal SIGSEGV, Segmentation fault. [----------------------------------registers-----------------------------------] RAX: 0x65cb60 --> 0x726c646821000000 ('') RBX: 0x6  RCX: 0x100007c  RDX: 0x87  RSI: 0x4477a0 --> 0x0  RDI: 0x4477a0 --> 0x0  RBP: 0xf3000000  RSP: 0x7fffffffda10 --> 0x7fffffffda58 --> 0x65cb60 --> 0x726c646821000000 ('') RIP: 0x4113d1 (<std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2561>:	mov    esi,DWORD PTR [rax+rcx*1]) R8 : 0x1  R9 : 0x7fffffffda40 --> 0xf3  R10: 0x40456b --> 0x5f007465736d656d ('memset') R11: 0x7ffff7c61be0 --> 0x65cc50 --> 0x1a3809  R12: 0x7fffffffdbd0 --> 0xffffffffffffffff  R13: 0xf0ffffe6  R14: 0x7fffffffdbd8 --> 0xffffffffffffffff  R15: 0x4457b0 --> 0x4477a0 --> 0x0 EFLAGS: 0x10206 (carry PARITY adjust zero sign trap INTERRUPT direction overflow) [-------------------------------------code-------------------------------------]    0x4113c8 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2552>:	add    bl,0x1    0x4113cb <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2555>:	adc    bl,0x0    0x4113ce <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2558>:	mov    BYTE PTR [rsi+rdx*1],bl => 0x4113d1 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2561>:	mov    esi,DWORD PTR [rax+rcx*1]    0x4113d4 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2564>:	bswap  esi    0x4113d6 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2566>:	cmp    DWORD PTR [rax+rcx*1+0x4],0x70727069    0x4113de <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2574>:	     jne    0x411358 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2440>:	    jne    0x411358 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2440>    0x4113e4 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2580>:	     jmp    0x41138d <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2493>:	    jmp    0x41138d <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2493> [------------------------------------stack-------------------------------------] 0000| 0x7fffffffda10 --> 0x7fffffffda58 --> 0x65cb60 --> 0x726c646821000000 ('') 0008| 0x7fffffffda18 --> 0x8  0016| 0x7fffffffda20 --> 0x4  0024| 0x7fffffffda28 --> 0x0  0032| 0x7fffffffda30 --> 0x0  0040| 0x7fffffffda38 --> 0x0  0048| 0x7fffffffda40 --> 0xf3  0056| 0x7fffffffda48 --> 0x7ffff7b052f6 (<_IO_new_file_fopen+534>:	mov    rbx,rax) [------------------------------------------------------------------------------] Legend: code, data, rodata, value Stopped reason: SIGSEGV $_0::operator() (this=<optimized out>, length=0x417, ri=..., width=<optimized out>, height=<optimized out>, entrySizes=...) at /home/ubuntu/Desktop/imageinfo/imageinfo.hpp:498 498	                        uint32_t boxSize = buffer.readU32BE(offset); ``` Original code ```                     off_t offset = 0; // typedef long _off_t; off_t offset = 0;                     off_t end = metaLength;                      while (offset < end) {                         uint32_t boxSize = buffer.readU32BE(offset); // uint32_t readU32BE;                         if (buffer.cmpAnyOf(offset + 4, 4, {"iprp", "ipco"})) {                             end = offset + boxSize;                             offset += 8;                         } else if (buffer.cmp(offset + 4, 4, "ispe")) {                             width = buffer.readU32BE(offset + 12);                             height = buffer.readU32BE(offset + 16);                             return true;                         } else {                             offset += boxSize;                         }                     } ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@xiaozhuai](https://avatars.githubusercontent.com/u/4773701?s=40&u=9aadae492d9ca56a7d1d1740df98f3de233b820e&v=4)](/xiaozhuai)
[xiaozhuai](/xiaozhuai)
closed this as [not planned](/xiaozhuai/imageinfo/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3A%22not+planned%22)
Won't fix, can't repro, duplicate, stale
[Mar 27, 2023](#event-8849150586)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fxiaozhuai%2Fimageinfo%2Fissues%2F1)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@xiaozhuai](https://avatars.githubusercontent.com/u/4773701?s=52&v=4)](/xiaozhuai) [![@10cksYiqiyinHangzhouTechnology](https://avatars.githubusercontent.com/u/124653481?s=52&v=4)](/10cksYiqiyinHangzhouTechnology)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_72dfbca2_20250114_215525.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F10cksYiqiyinHangzhouTechnology%2Fimageinfo_poc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F10cksYiqiyinHangzhouTechnology%2Fimageinfo_poc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=10cksYiqiyinHangzhouTechnology%2Fimageinfo_poc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[10cksYiqiyinHangzhouTechnology](/10cksYiqiyinHangzhouTechnology)
/
**[imageinfo\_poc](/10cksYiqiyinHangzhouTechnology/imageinfo_poc)**
Public

* [Notifications](/login?return_to=%2F10cksYiqiyinHangzhouTechnology%2Fimageinfo_poc) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2F10cksYiqiyinHangzhouTechnology%2Fimageinfo_poc)
* [Star
   1](/login?return_to=%2F10cksYiqiyinHangzhouTechnology%2Fimageinfo_poc)

[1
star](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/stargazers) [0
forks](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/forks) [Branches](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/branches) [Tags](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/tags) [Activity](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/activity)
 [Star](/login?return_to=%2F10cksYiqiyinHangzhouTechnology%2Fimageinfo_poc)

 [Notifications](/login?return_to=%2F10cksYiqiyinHangzhouTechnology%2Fimageinfo_poc) You must be signed in to change notification settings

* [Code](/10cksYiqiyinHangzhouTechnology/imageinfo_poc)
* [Issues
  0](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/issues)
* [Pull requests
  0](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/pulls)
* [Actions](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/actions)
* [Projects
  0](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/projects)
* [Security](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/security)
* [Insights](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/pulse)

Additional navigation options

* [Code](/10cksYiqiyinHangzhouTechnology/imageinfo_poc)
* [Issues](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/issues)
* [Pull requests](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/pulls)
* [Actions](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/actions)
* [Projects](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/projects)
* [Security](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/security)
* [Insights](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/pulse)

# 10cksYiqiyinHangzhouTechnology/imageinfo\_poc

    main[Branches](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/branches)[Tags](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[4 Commits](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/commits/main/) | | |
| [README.md](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/README.md "README.md") | | [README.md](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/README.md "README.md") |  |  |
| [asan\_imageinfo](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/asan_imageinfo "asan_imageinfo") | | [asan\_imageinfo](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/asan_imageinfo "asan_imageinfo") |  |  |
| [id02](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/id02 "id02") | | [id02](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/id02 "id02") |  |  |
| [imageinfo](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/imageinfo "imageinfo") | | [imageinfo](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/imageinfo "imageinfo") |  |  |
| View all files | | |

## Repository files navigation

* README

[Project address](https://github.com/xiaozhuai/imageinfo)

[afl\_imageinfo](https://github.com/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/imageinfo)

[asan\_imageinfo](https://github.com/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/asan_imageinfo)

[poc:id02](https://github.com/10cksYiqiyinHangzhouTechnology/imageinfo_poc/blob/main/id02)

# Build original project

```
cmake -B build .
cmake --build build -- all
cmake --build build -- check
```

# Build afl project

```
Cmakelist.txt add：

set (CMAKE_C_COMPILER "/usr/local/bin/afl-clang-fast")
set (CMAKE_CXX_COMPILER "/usr/local/bin/afl-clang-fast++")

```

# Run

```
./imageinfo id02

```

# 02

## Vulnerability type

READ memory access causes SEGV stack overflow.

## ASAN

```
ubuntu@ubuntu:~/Desktop/imageinfo/imageinfo/build$ ./imageinfo ../../build/output/default/crashes/id\:000002\,sig\:11\,src\:000007\,time\:76911\,execs\:21200\,op\:havoc\,rep\:16
AddressSanitizer:DEADLYSIGNAL
=================================================================
==3079903==ERROR: AddressSanitizer: SEGV on unknown address 0x6110010000bc (pc 0x555555583ae4 bp 0x7fffffffd7e0 sp 0x7fffffffd230 T0)
==3079903==The signal is caused by a READ memory access.
    #0 0x555555583ae3 in {lambda(unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)#1}::operator()(unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&) const (/home/ubuntu/Desktop/imageinfo/imageinfo/build/imageinfo+0x2fae3)
    #1 0x5555555843c1 in _ZNSt17_Function_handlerIFbmR15IIReadInterfaceRlS2_RSt6vectorISt5arrayIlLm2EESaIS5_EEEUlmS1_S2_S2_S8_E_E9_M_invokeERKSt9_Any_dataOmS1_S2_S2_S8_ (/home/ubuntu/Desktop/imageinfo/imageinfo/build/imageinfo+0x303c1)
    #2 0x55555557cf11 in main (/home/ubuntu/Desktop/imageinfo/imageinfo/build/imageinfo+0x28f11)
    #3 0x7ffff7068082 in __libc_start_main ../csu/libc-start.c:308
    #4 0x55555556adad in _start (/home/ubuntu/Desktop/imageinfo/imageinfo/build/imageinfo+0x16dad)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV (/home/ubuntu/Desktop/imageinfo/imageinfo/build/imageinfo+0x2fae3) in {lambda(unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)#1}::operator()(unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&) const
==3079903==ABORTING
```

## GDB

```
ubuntu@ubuntu:~/Desktop/imageinfo/build$ gdb --args ./imageinfo output/default/crashes/id\:000002\,sig\:11\,src\:000007\,time\:76911\,execs\:21200\,op\:havoc\,rep\:16
GNU gdb (Ubuntu 9.2-0ubuntu1~20.04.1) 9.2
Copyright (C) 2020 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type "show copying" and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.

For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from ./imageinfo...

gdb-peda$ r output/default/crashes/id\:000002\,sig\:11\,src\:000007\,time\:76911\,execs\:21200\,op\:havoc\,rep\:16
Starting program: /home/ubuntu/Desktop/imageinfo/build/imageinfo output/default/crashes/id\:000002\,sig\:11\,src\:000007\,time\:76911\,execs\:21200\,op\:havoc\,rep\:16

Program received signal SIGSEGV, Segmentation fault.
[----------------------------------registers-----------------------------------]
RAX: 0x65cb60 --> 0x726c646821000000 ('')
RBX: 0x6
RCX: 0x100007c
RDX: 0x87
RSI: 0x4477a0 --> 0x0
RDI: 0x4477a0 --> 0x0
RBP: 0xf3000000
RSP: 0x7fffffffda10 --> 0x7fffffffda58 --> 0x65cb60 --> 0x726c646821000000 ('')
RIP: 0x4113d1 (<std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2561>:	mov    esi,DWORD PTR [rax+rcx*1])
R8 : 0x1
R9 : 0x7fffffffda40 --> 0xf3
R10: 0x40456b --> 0x5f007465736d656d ('memset')
R11: 0x7ffff7c61be0 --> 0x65cc50 --> 0x1a3809
R12: 0x7fffffffdbd0 --> 0xffffffffffffffff
R13: 0xf0ffffe6
R14: 0x7fffffffdbd8 --> 0xffffffffffffffff
R15: 0x4457b0 --> 0x4477a0 --> 0x0
EFLAGS: 0x10206 (carry PARITY adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x4113c8 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2552>:	add    bl,0x1
   0x4113cb <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2555>:	adc    bl,0x0
   0x4113ce <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2558>:	mov    BYTE PTR [rsi+rdx*1],bl
=> 0x4113d1 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2561>:	mov    esi,DWORD PTR [rax+rcx*1]
   0x4113d4 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2564>:	bswap  esi
   0x4113d6 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2566>:	cmp    DWORD PTR [rax+rcx*1+0x4],0x70727069
   0x4113de <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2574>:
    jne    0x411358 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2440>:	    jne    0x411358 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2440>
   0x4113e4 <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2580>:
    jmp    0x41138d <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2493>:	    jmp    0x41138d <std::_Function_handler<bool (unsigned long, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&), $_0>::_M_invoke(std::_Any_data const&, unsigned long&&, IIReadInterface&, long&, long&, std::vector<std::array<long, 2ul>, std::allocator<std::array<long, 2ul> > >&)+2493>
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffda10 --> 0x7fffffffda58 --> 0x65cb60 --> 0x726c646821000000 ('')
0008| 0x7fffffffda18 --> 0x8
0016| 0x7fffffffda20 --> 0x4
0024| 0x7fffffffda28 --> 0x0
0032| 0x7fffffffda30 --> 0x0
0040| 0x7fffffffda38 --> 0x0
0048| 0x7fffffffda40 --> 0xf3
0056| 0x7fffffffda48 --> 0x7ffff7b052f6 (<_IO_new_file_fopen+534>:	mov    rbx,rax)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
$_0::operator() (this=<optimized out>, length=0x417, ri=..., width=<optimized out>, height=<optimized out>, entrySizes=...) at /home/ubuntu/Desktop/imageinfo/imageinfo.hpp:498
498	                        uint32_t boxSize = buffer.readU32BE(offset);
```

## Original code

```
                    off_t offset = 0; // typedef long _off_t; off_t offset = 0;
                    off_t end = metaLength;

                    while (offset < end) {
                        uint32_t boxSize = buffer.readU32BE(offset); // uint32_t readU32BE;
                        if (buffer.cmpAnyOf(offset + 4, 4, {"iprp", "ipco"})) {
                            end = offset + boxSize;
                            offset += 8;
                        } else if (buffer.cmp(offset + 4, 4, "ispe")) {
                            width = buffer.readU32BE(offset + 12);
                            height = buffer.readU32BE(offset + 16);
                            return true;
                        } else {
                            offset += boxSize;
                        }
                    }
```

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/activity)
### Stars

[**1**
star](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/stargazers)
### Watchers

[**2**
watching](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/watchers)
### Forks

[**0**
forks](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2F10cksYiqiyinHangzhouTechnology%2Fimageinfo_poc&report=10cksYiqiyinHangzhouTechnology+%28user%29)

## [Releases](/10cksYiqiyinHangzhouTechnology/imageinfo_poc/releases)

No releases published

## [Packages 0](/users/10cksYiqiyinHangzhouTechnology/packages?repo_name=imageinfo_poc)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


