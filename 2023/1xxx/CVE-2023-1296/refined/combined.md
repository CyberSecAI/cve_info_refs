=== Content from discuss.hashicorp.com_9bffc589_20250114_190438.html ===


[HashiCorp Discuss](/)

# [HCSEC-2023-09 - Nomad ACLs Can Not Deny Access to Workload's Own Variables](/t/hcsec-2023-09-nomad-acls-can-not-deny-access-to-workloads-own-variables/51390)

[Security](/c/security/52)

[security-nomad](https://discuss.hashicorp.com/tag/security-nomad)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

March 13, 2023, 9:00pm

1

**Bulletin ID:** HCSEC-2023-09

**Affected Products / Versions:** Nomad and Nomad Enterprise 1.4.0 up to 1.5.0; fixed in 1.4.6 and 1.5.1.

**Publication Date:** March 13, 2023

**Summary**

A vulnerability was identified in Nomad and Nomad Enterprise (“Nomad”) such that a `deny` ACL capability could not be applied to a workload’s own variables. If included, the Nomad ACL system will silently fail to block access. This vulnerability, CVE-2023-1296, was fixed in Nomad 1.4.6 and 1.5.1.

**Background**

Nomad 1.4.0 introduced the [variables](https://developer.hashicorp.com/nomad/docs/concepts/variables) feature, and a new [workload identity](https://developer.hashicorp.com/nomad/docs/concepts/workload-identity) feature so that tasks can access their own variables without needing to create and pass a Nomad ACL token.

**Details**

An OSS user reported an unexpected behavior where adding a policy with a deny capability did not deny access to a variable, which was confirmed with internal investigation.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Nomad 1.4.6, 1.5.1, or newer. See Nomad’s [Upgrading](https://www.nomadproject.io/docs/upgrade) for general guidance on this process.

**Acknowledgement**

This issue was identified by the HashiCorp OSS community.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2023-08 - Nomad Job Submitter Privilege Escalation Using Workload Identity](https://discuss.hashicorp.com/t/hcsec-2023-08-nomad-job-submitter-privilege-escalation-using-workload-identity/51389)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5258 | March 13, 2023 |
| [HCSEC-2024-29 - Nomad Allocations Vulnerable To Privilege Escalation Within A Namespace Using Unredacted Workload Identity Token](https://discuss.hashicorp.com/t/hcsec-2024-29-nomad-allocations-vulnerable-to-privilege-escalation-within-a-namespace-using-unredacted-workload-identity-token/72119)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 178 | December 20, 2024 |
| [Nomad 1.5.1, 1.4.6, and 1.3.11 released](https://discuss.hashicorp.com/t/nomad-1-5-1-1-4-6-and-1-3-11-released/51367)  [Release Notifications](/c/release-notifications/57) [nomad-release](https://discuss.hashicorp.com/tag/nomad-release) ,  [nomad](https://discuss.hashicorp.com/tag/nomad) | 0 | 440 | March 13, 2023 |
| [HCSEC-2022-25 - Nomad’s Workload Identity Token Can List Non-sensitive Metadata For nomad/ Paths](https://discuss.hashicorp.com/t/hcsec-2022-25-nomad-s-workload-identity-token-can-list-non-sensitive-metadata-for-nomad-paths/46167)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5917 | October 28, 2022 |
| [HCSEC-2023-21 - Nomad Caller ACL Token's Secret ID is Exposed to Sentinel](https://discuss.hashicorp.com/t/hcsec-2023-21-nomad-caller-acl-tokens-secret-id-is-exposed-to-sentinel/56271)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5589 | July 19, 2023 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


