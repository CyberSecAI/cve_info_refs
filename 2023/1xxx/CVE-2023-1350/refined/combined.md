=== Content from github.com_6c2f611c_20250115_083006.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flwindolf%2Fliferea%2Fcommit%2F8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flwindolf%2Fliferea%2Fcommit%2F8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=lwindolf%2Fliferea)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lwindolf](/lwindolf)
/
**[liferea](/lwindolf/liferea)**
Public

* [Notifications](/login?return_to=%2Flwindolf%2Fliferea) You must be signed in to change notification settings
* [Fork
  129](/login?return_to=%2Flwindolf%2Fliferea)
* [Star
   832](/login?return_to=%2Flwindolf%2Fliferea)

* [Code](/lwindolf/liferea)
* [Issues
  91](/lwindolf/liferea/issues)
* [Pull requests
  10](/lwindolf/liferea/pulls)
* [Discussions](/lwindolf/liferea/discussions)
* [Actions](/lwindolf/liferea/actions)
* [Security](/lwindolf/liferea/security)
* [Insights](/lwindolf/liferea/pulse)

Additional navigation options

* [Code](/lwindolf/liferea)
* [Issues](/lwindolf/liferea/issues)
* [Pull requests](/lwindolf/liferea/pulls)
* [Discussions](/lwindolf/liferea/discussions)
* [Actions](/lwindolf/liferea/actions)
* [Security](/lwindolf/liferea/security)
* [Insights](/lwindolf/liferea/pulse)

## Commit

[Permalink](/lwindolf/liferea/commit/8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix RCE vulnerability on feed enrichment

[Browse files](/lwindolf/liferea/tree/8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59)
Browse the repository at this point in the history

```
Currently there are a few places in the code that do not check URLs for
the presence of a command prefix, allowing malicious websites to run any
command in the local system.

Trying to run feed enrichment (i.e. after option "Extract full content
from HTML5 and Google AMP" is enabled) in a subscription that produces
this item:

    <item>
      <title>Check /tmp/bad-item-link.txt</title>
      <link>|date &gt;/tmp/bad-item-link.txt</link>
    </item>

will cause Liferea to call update_request_new on URL
"|date >/tmp/bad-item-link.txt" and then blindly run the command. A
similar effect happens when running the feed enrichment in a item that
links to a document like this:

    <!DOCTYPE html>
    <html>
     <head>
      <title>AMP URL RCE PoC</title>
      <link rel="amphtml" href="|date &gt; /tmp/bad-amp-url.txt">
     </head>
     <body>
         Check the results in /tmp/bad-amp-url.txt
     </body>
    </html>

once Liferea tries to load the AMP URL.

There are other calls to update_request_* functions where URLs are
validated correctly (e.g. in feed icons and comments) and do not trigger
this vulnerability. Since the subscription update is the exception where
feed commands are supported (and welcome!) I chose to lock this feature
behind a non-persistent flag and only enable it when required. This is
safer than adding the flag in updateOptions, which is usually reused in
subordinate requests.

This failure exists since commits [b828838](https://github.com/lwindolf/liferea/commit/b8288389820a3f510ef4b21684b22439c41d95a5)
and [b67dbba](https://github.com/lwindolf/liferea/commit/b67dbba73443ab7b36fcd3c78aa803e974c0f23e) from Setember 2017.
```

* Loading branch information

[![@ittner](https://avatars.githubusercontent.com/u/110642?s=40&v=4)](/ittner) [![@lwindolf](https://avatars.githubusercontent.com/u/3315368?s=40&v=4)](/lwindolf)

[ittner](/lwindolf/liferea/commits?author=ittner "View all commits by ittner")
authored and
[lwindolf](/lwindolf/liferea/commits?author=lwindolf "View all commits by lwindolf")
committed
Mar 9, 2023

1 parent
[ed860fa](/lwindolf/liferea/commit/ed860fa49f61978f3e32eac10e18007e52e886a6)

commit 8d8b5b9

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**32 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/subscription.c
    [subscription.c](#diff-1546886004b657ac09341b34def64eff43c4f810befb73083870caa9002cfd52)
  + src/update.c
    [update.c](#diff-006e210ac50fd679f38c67325a529bc77f2f40e25e93be5883879d2867d9ba56)
  + src/update.h
    [update.h](#diff-155c84d68ef3ab1ac94b949ca2478eac47a14e8770bf3ccd92078215b83a20c5)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[src/subscription.c](#diff-1546886004b657ac09341b34def64eff43c4f810befb73083870caa9002cfd52 "src/subscription.c")

Show comments

[View file](/lwindolf/liferea/blob/8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59/src/subscription.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -282,6 +282,7 @@ subscription\_update (subscriptionPtr subscription, guint flags) |
|  |  | subscription->updateState, |
|  |  | subscription->updateOptions |
|  |  | ); |
|  |  | update\_request\_allow\_commands (request, TRUE); |
|  |  |  |
|  |  | if (subscription\_get\_filter (subscription)) |
|  |  | request->filtercmd = g\_strdup (subscription\_get\_filter (subscription)); |
| Expand Down | |  |

17 changes: 15 additions & 2 deletions

17
[src/update.c](#diff-006e210ac50fd679f38c67325a529bc77f2f40e25e93be5883879d2867d9ba56 "src/update.c")

Show comments

[View file](/lwindolf/liferea/blob/8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59/src/update.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -234,6 +234,13 @@ update\_request\_set\_auth\_value (UpdateRequest \*request, const gchar\* authValue) |
|  |  | request->authValue = g\_strdup (authValue); |
|  |  | } |
|  |  |  |
|  |  | void |
|  |  | update\_request\_allow\_commands (UpdateRequest \*request, gboolean allowCommands) |
|  |  | { |
|  |  | request->allowCommands = allowCommands; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\* update result object \*/ |
|  |  |  |
|  |  | updateResultPtr |
| Expand Down  Expand Up | | @@ -672,8 +679,14 @@ update\_job\_run (updateJobPtr job) |
|  |  |  |
|  |  | /\* everything starting with '|' is a local command \*/ |
|  |  | if (\*(job->request->source) == '|') { |
|  |  | debug1 (DEBUG\_UPDATE, "Recognized local command: %s", job->request->source); |
|  |  | update\_exec\_cmd (job); |
|  |  | if (job->request->allowCommands) { |
|  |  | debug1 (DEBUG\_UPDATE, "Recognized local command: %s", job->request->source); |
|  |  | update\_exec\_cmd (job); |
|  |  | } else { |
|  |  | debug1 (DEBUG\_UPDATE, "Refusing to run local command from unexpected source: %s", job->request->source); |
|  |  | job->result->httpstatus = 403; /\* Forbidden. \*/ |
|  |  | update\_process\_finished\_job (job); |
|  |  | } |
|  |  | return; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

16 changes: 16 additions & 0 deletions

16
[src/update.h](#diff-155c84d68ef3ab1ac94b949ca2478eac47a14e8770bf3ccd92078215b83a20c5 "src/update.h")

Show comments

[View file](/lwindolf/liferea/blob/8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59/src/update.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -103,6 +103,7 @@ struct \_UpdateRequest { |
|  |  | updateOptionsPtr options; /\*\*< Update options for the request \*/ |
|  |  | gchar \*filtercmd; /\*\*< Command will filter output of URL \*/ |
|  |  | updateStatePtr updateState; /\*\*< Update state of the requested object (etags, last modified...) \*/ |
|  |  | gboolean allowCommands; /\*\*< Allow this requests to run commands \*/ |
|  |  | }; |
|  |  |  |
|  |  | /\*\* structure to store results of the processing of an update request \*/ |
| Expand Down  Expand Up | | @@ -228,6 +229,21 @@ void update\_request\_set\_source (UpdateRequest \*request, const gchar\* source); |
|  |  | \*/ |
|  |  | void update\_request\_set\_auth\_value (UpdateRequest \*request, const gchar\* authValue); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Allows \*this\* request to run local commands. |
|  |  | \* |
|  |  | \* At first it may look this flag should be in updateOptions, but we can |
|  |  | \* take a safer path: feed commands are restricted to a few use cases while |
|  |  | \* options are propagated to downstream requests (feed enrichment, comments, |
|  |  | \* etc.), so it is a good idea to prevent these from running commands in the |
|  |  | \* local system via tricky URLs without needing to validate these options |
|  |  | \* everywhere (which is error-prone). |
|  |  | \* |
|  |  | \* @param request the update request |
|  |  | \* @param can\_run TRUE if the request can run commands, FALSE otherwise. |
|  |  | \*/ |
|  |  | void update\_request\_allow\_commands (UpdateRequest \*request, gboolean allowCommands); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Creates a new update result for the given update request. |
|  |  | \* |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8d8b5b9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flwindolf%2Fliferea%2Fcommit%2F8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


