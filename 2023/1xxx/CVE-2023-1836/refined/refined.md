```
{
  "CVE-2023-1836": {
    "related": true,
    "summary": "XSS and content injection and iframe injection when viewing raw files on IOS devices.",
    "details": "When viewing an XML file in a repository in \"raw\" mode, it can be made to render as HTML if viewed on an IOS device. On a self-hosted GitLab instance without proper CSP this will lead to full XSS on the instance. On gitlab.com CSP will block JavaScript execution but it will allow for HTML injection that can be used for open redirection or phishing.\n\nThe issue stems from a behavior in WebKit (affecting all IOS browsers) where it ignores the `content-type` header if there is a content type defined in the actual XML file. Rendering this XML `inline` will make the browsers display HTML.\n\nBy crafting a malicious XML file, an attacker can inject arbitrary HTML content, including JavaScript, into the page when viewed in raw mode on an iOS device. For self-hosted GitLab instances without a proper Content Security Policy (CSP), this leads to full XSS. On GitLab.com, the CSP blocks JavaScript execution, but HTML injection is still possible, enabling open redirection and phishing attacks.",
    "root_cause": "WebKit ignores the `content-type` header if a content type is defined in the XML file, causing it to render as HTML rather than plain text.",
    "vulnerabilities": [
      "Cross-Site Scripting (XSS) in self-hosted GitLab instances without proper CSP.",
      "HTML injection leading to open redirection and phishing attacks on GitLab.com."
    ],
    "impact": "Full XSS on self-hosted GitLab instances, potentially allowing attackers to execute arbitrary JavaScript code within the context of the victim's session. On GitLab.com, the impact is HTML injection, leading to open redirects and phishing attacks by presenting fake login screens or redirecting users to malicious websites.",
    "attack_vectors": "An attacker creates a malicious XML file containing HTML, including JavaScript or an iframe. When a user views the raw file on an iOS device, the browser renders the malicious HTML.",
    "attacker_capabilities": "The attacker needs a GitLab account and the ability to create or modify files in a repository. The vulnerability is triggered when a victim views a crafted raw XML file using a browser on an iOS device."
  }
}
```