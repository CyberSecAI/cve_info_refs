- **Root cause of vulnerability**: The plugin lacks CSRF (Cross-Site Request Forgery) protection when discarding Identity Providers (IdP).
- **Weaknesses/vulnerabilities present**: CSRF vulnerability. Specifically, the `discard` action related to Identity Providers is not protected against CSRF attacks.
- **Impact of exploitation**: An attacker can force a logged-in administrator to delete all Identity Providers.
- **Attack vectors**: The attacker crafts a malicious request to `https://example.com/wp-admin/admin.php?page=mo_oauth_settings&tab=config&action=discard` and tricks a logged-in admin into opening it. This could be achieved through social engineering, or by embedding the request in a webpage the victim might visit while logged in to the vulnerable site.
- **Required attacker capabilities/position**: The attacker needs no prior authentication, but they need to trick a logged-in administrator to visit a malicious link or page containing the crafted request.