- **Root cause of vulnerability:** The vulnerability stems from the introduction of the `identity` block in Nomad 1.5.0, which exposes workload identity tokens. These tokens, when not restricted by ACL policies, can be abused to escalate privileges.
- **Weaknesses/vulnerabilities present:** A user with `submit-job` ACL capability can submit a job that leverages the workload identity token to access the Nomad HTTP API via a unix domain socket. If the workload identity lacks specific ACL policies, it can be used to escalate to management-level privileges. The core issue is the insufficient restriction of workload identity tokens by ACL policies.
- **Impact of exploitation:** Successful exploitation allows a user with `submit-job` privileges to escalate to management-level privileges, potentially gaining full control over the Nomad environment.
- **Attack vectors:** The attack vector is through submitting a malicious Nomad job that uses the workload identity token to access the Nomad HTTP API, specifically if the token has no associated ACL policies to limit its access.
- **Required attacker capabilities/position:** The attacker needs to have the `submit-job` ACL capability.