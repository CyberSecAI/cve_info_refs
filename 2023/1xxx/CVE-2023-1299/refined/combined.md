=== Content from discuss.hashicorp.com_e6a4fd7d_20250114_191343.html ===


[HashiCorp Discuss](/)

# [HCSEC-2023-08 - Nomad Job Submitter Privilege Escalation Using Workload Identity](/t/hcsec-2023-08-nomad-job-submitter-privilege-escalation-using-workload-identity/51389)

[Security](/c/security/52)

[security-nomad](https://discuss.hashicorp.com/tag/security-nomad)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

March 13, 2023, 8:56pm

1

**Bulletin ID:** HCSEC-2023-08

**Affected Products / Versions:** Nomad and Nomad Enterprise 1.5.0; fixed in 1.5.1.

**Publication Date:** March 13, 2022

**Summary**

A vulnerability was identified in Nomad and Nomad Enterprise (“Nomad”) such that a user with the `submit-job` ACL capability can submit a job that can escalate to management-level privileges. This vulnerability, CVE-2023-1299, was introduced in Nomad 1.5.0 and fixed in Nomad 1.5.1.

**Background**

Nomad 1.4.0 introduced the concept of [workload identity](https://developer.hashicorp.com/nomad/docs/concepts/workload-identity) so that tasks can access variables without needing to access them through Nomad HTTP API with an ACL token.

In 1.5.0, the [identity block](https://developer.hashicorp.com/nomad/docs/job-specification/identity) was introduced, which exposes the workload identity token to the workload so it can access Nomad HTTP API via a unix domain socket without configuring mTLS.

**Details**

During internal testing, we discovered it was possible to abuse the workload identity to elevate to management-level privilege if the workload identity did not have any attached ACL policies.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Nomad 1.5.1 or newer. See Nomad’s [Upgrading](https://www.nomadproject.io/docs/upgrade) for general guidance on this process.

**Acknowledgement**

This issue was identified by the Nomad engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-29 - Nomad Allocations Vulnerable To Privilege Escalation Within A Namespace Using Unredacted Workload Identity Token](https://discuss.hashicorp.com/t/hcsec-2024-29-nomad-allocations-vulnerable-to-privilege-escalation-within-a-namespace-using-unredacted-workload-identity-token/72119)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 178 | December 20, 2024 |
| [HCSEC-2022-25 - Nomad’s Workload Identity Token Can List Non-sensitive Metadata For nomad/ Paths](https://discuss.hashicorp.com/t/hcsec-2022-25-nomad-s-workload-identity-token-can-list-non-sensitive-metadata-for-nomad-paths/46167)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5917 | October 28, 2022 |
| [HCSEC-2023-09 - Nomad ACLs Can Not Deny Access to Workload's Own Variables](https://discuss.hashicorp.com/t/hcsec-2023-09-nomad-acls-can-not-deny-access-to-workloads-own-variables/51390)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5253 | March 13, 2023 |
| [HCSEC-2023-13 - Nomad Unauthenticated Client Agent HTTP Request Privilege Escalation](https://discuss.hashicorp.com/t/hcsec-2023-13-nomad-unauthenticated-client-agent-http-request-privilege-escalation/52375)  [Security](/c/security/52) | 0 | 6042 | April 5, 2023 |
| [Nomad 1.5.1, 1.4.6, and 1.3.11 released](https://discuss.hashicorp.com/t/nomad-1-5-1-1-4-6-and-1-3-11-released/51367)  [Release Notifications](/c/release-notifications/57) [nomad-release](https://discuss.hashicorp.com/tag/nomad-release) ,  [nomad](https://discuss.hashicorp.com/tag/nomad) | 0 | 440 | March 13, 2023 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


