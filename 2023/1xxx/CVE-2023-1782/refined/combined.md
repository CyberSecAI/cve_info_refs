=== Content from discuss.hashicorp.com_64eafe15_20250114_200809.html ===


[HashiCorp Discuss](/)

# [HCSEC-2023-13 - Nomad Unauthenticated Client Agent HTTP Request Privilege Escalation](/t/hcsec-2023-13-nomad-unauthenticated-client-agent-http-request-privilege-escalation/52375)

[Security](/c/security/52)

[eastebry](https://discuss.hashicorp.com/u/eastebry)

April 5, 2023, 6:30pm

1

**Bulletin ID:** HCSEC-2023-13

**Affected Products / Versions:** Nomad and Nomad Enterprise 1.5.0 up to 1.5.2; fixed in 1.5.3.

**Publication Date:** April 5, 2023

**Summary**

A vulnerability was identified in Nomad and Nomad Enterprise (“Nomad”) such that an unauthenticated request sent to a client agent’s HTTP endpoint bypasses intended ACL authorizations when processed on server through internal RPCs. In doing so, unauthenticated HTTP requests can be used to submit a job to the cluster if there is no mTLS enabled. This vulnerability, CVE-2023-1782, affects Nomad from 1.5.0 up to 1.5.2 and was fixed in 1.5.3.

**Background**

Nomad server and client agents provide HTTP and RPC endpoints (ports 4646 and 4647 respectively). The RPC endpoints are exclusively used for internal Nomad communication and are secured using mTLS. The HTTP endpoints are used both internally by Nomad, and externally by administrators or operators to interact with the cluster, and are also secured using mTLS.

**Details**

Automated tooling by our security team identified it was possible to bypass ACL restrictions when submitting unauthenticated requests to a Nomad client agent’s HTTP endpoint. This behavior may be used by a malicious operator or third party with access to this endpoint.

Nomad administrators should always use mTLS for HTTP and RPC endpoints. More requirements and recommendations for a secure Nomad deployment can be found in the [security model](https://developer.hashicorp.com/nomad/docs/concepts/security).

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Nomad 1.5.3, or newer.

See Nomad’s [Upgrading](https://www.nomadproject.io/docs/upgrade) for general guidance on this process.

**Acknowledgement**

This issue was identified by the HashiCorp Security and Solutions Engineering teams.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [Nomad 1.5.3, 1.4.8, and 1.3.13 released](https://discuss.hashicorp.com/t/nomad-1-5-3-1-4-8-and-1-3-13-released/52366)  [Release Notifications](/c/release-notifications/57) [nomad-release](https://discuss.hashicorp.com/tag/nomad-release) ,  [nomad](https://discuss.hashicorp.com/tag/nomad) | 0 | 368 | April 5, 2023 |
| [HCSEC-2021-21 - Nomad Raft RPC Privilege Escalation](https://discuss.hashicorp.com/t/hcsec-2021-21-nomad-raft-rpc-privilege-escalation/29023)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 6793 | September 1, 2021 |
| [HCSEC-2020-05 - Nomad's mTLS Authorization Mechanism Susceptible to Privilege Escalation](https://discuss.hashicorp.com/t/hcsec-2020-05-nomads-mtls-authorization-mechanism-susceptible-to-privilege-escalation/18088)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 4107 | November 25, 2020 |
| [HCSEC-2020-01 - Nomad’s HTTP/RPC Services Allow Unbounded Resource Usage, Susceptible to Unauthenticated Denial of Service](https://discuss.hashicorp.com/t/hcsec-2020-01-nomad-s-http-rpc-services-allow-unbounded-resource-usage-susceptible-to-unauthenticated-denial-of-service/18084)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 4091 | November 25, 2020 |
| [HCSEC-2023-22 - Nomad Search API Leaks Information About CSI Plugins](https://discuss.hashicorp.com/t/hcsec-2023-22-nomad-search-api-leaks-information-about-csi-plugins/56272)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5700 | July 19, 2023 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


