```json
{
  "vulnerability": {
    "root_cause": "An open redirect vulnerability exists during SAML login. The redirect URL is saved in the GitLab cookies, and the user is redirected to the saved URL the next time they visit `gitlab.com/user/sign_in`.",
    "weaknesses": [
      "Open redirect during SAML login",
      "Insufficient validation of redirect URLs during SAML authentication",
      "Storage of redirect URLs in cookies without proper sanitization or validation",
       "Implicit OAuth grant misuse"
    ],
    "impact": "An attacker can steal third-party access tokens (e.g., Bitbucket, Google, Salesforce, Twitter) by exploiting the open redirect. Specifically for Bitbucket, the attacker can gain read and write access to the victim's Bitbucket account.",
    "attack_vectors": [
      "The attacker creates a malicious SAML configuration redirecting to the attacker's controlled domain.",
      "A victim logs in via SAML, which causes the malicious redirect URL to be stored in the GitLab cookies.",
        "An attacker modifies the Bitbucket OAuth response_type to 'token' to facilitate access token leakage.",
      "The victim is then redirected to the attacker's domain which now has access to the victim's Bitbucket access token",
         "Phishing: upon sign-in via `about.gitlab.com`, the victim will be redirected to the malicious domain"
    ],
    "required_attacker_capabilities": "The attacker needs to set up a group with SAML login and control an external domain where they can receive the redirected requests. The attacker must also be able to modify the response_type parameter during the Bitbucket OAuth process"
  }
}
```