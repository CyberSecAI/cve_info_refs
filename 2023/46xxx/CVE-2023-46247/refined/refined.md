```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from an incorrect calculation of storage slots needed for large arrays within Vyper smart contracts. Prior to version 0.3.8, the calculation used `math.ceil(type_.size_in_bytes / 32)`, which, due to floating-point imprecision, could lead to an underestimation of required storage slots when `type_.size_in_bytes` was slightly more than a power of 2 or overestimation when `type_.size_in_bytes` was large (> 2**46) and slightly less than a power of 2.",
    "weaknesses": [
      "Incorrect storage calculation",
      "Floating point imprecision"
    ],
    "impact": "The incorrect calculation of required storage slots could lead to overwriting of other storage variables within the smart contract. For example, writing to a large array could overwrite an adjacent variable in storage.",
    "attack_vectors": "An attacker can exploit this vulnerability by deploying a Vyper contract with a large array and then writing to specific indices within the array, causing unintended overwrites of other storage variables.",
    "required_capabilities": "The attacker needs to be able to deploy and interact with a vulnerable Vyper contract."
  },
  "affected_versions": "<=0.3.7",
  "patched_versions": "0.3.8",
  "more_details": "The vulnerability is present in the `vyper/semantics/validation/data_positions.py` file. The fix in commit `0bb7203` addresses both the floating point rounding issue and also a general lack of proper checks during storage allocation.",
  "cwe": "No CWE provided in the advisory"
}
```