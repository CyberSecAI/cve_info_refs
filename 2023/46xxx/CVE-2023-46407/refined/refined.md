Based on the provided information, this content relates to CVE-2023-46407.

**Root cause of vulnerability:**
- A previous commit (f7ac351) reduced the size of a dynamically allocated buffer, making it too small for very small alphabet sizes, leading to an out-of-bounds (OOB) read.

**Weaknesses/vulnerabilities present:**
- Out-of-bounds read vulnerability in the `read_vlc_prefix` function within the `libavcodec/jpegxl_parser.c` file. Specifically, the dynamically allocated buffer `buf` was not large enough for small alphabet sizes during level 2 VLC decoding of JPEG XL images.

**Impact of exploitation:**
- An out-of-bounds read can lead to a crash or potentially allow for more severe security breaches by reading data from memory locations beyond the intended buffer.

**Attack vectors:**
- The vulnerability is triggered when processing a crafted JPEG XL image with a small alphabet size. The specific function affected is during the decoding of level 2 variable-length codes (VLC).

**Required attacker capabilities/position:**
- An attacker needs to provide a crafted JPEG XL image as input to a system using the vulnerable FFmpeg library. This implies that the attacker needs to control the input that is processed by FFmpeg.

**Additional details:**
- The vulnerability was identified by a fuzzer and reported by Cole Dilorenzo.
- The patch (commit bf81438) restores the buffer size to `MAX_PREFIX_ALPHABET_SIZE`, preventing the OOB read. The previous patch (f7ac351) had incorrectly calculated the buffer size, causing the vulnerability when the alphabet size was small.
- The fix involves modifying the buffer allocation calculation in `libavcodec/jpegxl_parser.c` to use `MAX_PREFIX_ALPHABET_SIZE` instead of the potentially smaller `dist->alphabet_size`.
- There were multiple patch versions, with the first one using a minimum size calculation and the second one setting a fixed maximum size.
- The relevant file and function is `libavcodec/jpegxl_parser.c` and the `read_vlc_prefix` function.