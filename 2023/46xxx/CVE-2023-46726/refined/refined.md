Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2023-46726:

**Root cause of vulnerability:**

- The vulnerability stems from the way GLPI handles file paths for TLS certificates and keys in the LDAP server configuration form. Specifically, the application was not properly sanitizing file paths, and on PHP 7.4, this could lead to the execution of arbitrary code.

**Weaknesses/vulnerabilities present:**

- **Lack of File Path Sanitization:** The application did not properly validate the provided paths for TLS certificate and key files. It was possible to provide a path to a previously uploaded document in GLPI to be used as a TLS certificate or key file.
- **File inclusion:** Due to the lack of sanitization and using `ldap_set_option` with a path to a file, it's possible to include a malicious PHP file.
- **PHP 7.4 Specific Issue:** The vulnerability is only exploitable when the application is running on PHP 7.4, which is an outdated and unsupported version of PHP.

**Impact of exploitation:**

- **Remote Code Execution (RCE):** A successful exploit allows an attacker to execute arbitrary code on the server hosting the GLPI instance. This means the attacker could potentially gain full control over the server, manipulate data, or perform other malicious actions.

**Attack vectors:**

- **LDAP Server Configuration Form:** The attack vector is the LDAP server configuration form within the GLPI application, which allows administrators to specify TLS certificate and key file paths.
- **File Upload:** Attackers require the ability to upload files as GLPI documents.

**Required attacker capabilities/position:**

- **High privileges:** The attacker needs to have high privileges within GLPI to access and modify the LDAP server configuration form.
- **File Upload Access:**  The attacker must be able to upload files as a GLPI document.
- **PHP 7.4:** The targeted GLPI instance has to be running on PHP 7.4.

**Additional details:**

- The vulnerability is fixed in GLPI version 10.0.11.
- The fix involves adding a check using `Filesystem::isFilepathSafe` to ensure that paths provided for TLS certificates and keys are valid and within a safe location. The `isFilepathSafe` function now checks for the presence of schemes (like http:// or ftp://), and if present, the path is considered unsafe. If no scheme is present, it checks if the path starts with the allowed directory.
- The provided commit also introduces additional checks to ensure the files exists before calling `ldap_set_option`.
- The recommended workaround is to upgrade to PHP 8.x.
- The vulnerability was discovered by Nikita Petrov (Positive Technologies).