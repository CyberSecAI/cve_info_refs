=== Content from github.com_3d587164_20250114_183708.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpy-pdf%2Fpypdf%2Fpull%2F808)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpy-pdf%2Fpypdf%2Fpull%2F808)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=py-pdf%2Fpypdf)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[py-pdf](/py-pdf)
/
**[pypdf](/py-pdf/pypdf)**
Public

* [Notifications](/login?return_to=%2Fpy-pdf%2Fpypdf) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fpy-pdf%2Fpypdf)
* [Star
   8.6k](/login?return_to=%2Fpy-pdf%2Fpypdf)

* [Code](/py-pdf/pypdf)
* [Issues
  75](/py-pdf/pypdf/issues)
* [Pull requests
  22](/py-pdf/pypdf/pulls)
* [Discussions](/py-pdf/pypdf/discussions)
* [Actions](/py-pdf/pypdf/actions)
* [Security](/py-pdf/pypdf/security)
* [Insights](/py-pdf/pypdf/pulse)

Additional navigation options

* [Code](/py-pdf/pypdf)
* [Issues](/py-pdf/pypdf/issues)
* [Pull requests](/py-pdf/pypdf/pulls)
* [Discussions](/py-pdf/pypdf/discussions)
* [Actions](/py-pdf/pypdf/actions)
* [Security](/py-pdf/pypdf/security)
* [Insights](/py-pdf/pypdf/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpy-pdf%2Fpypdf%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpy-pdf%2Fpypdf%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fix pdf reader getting stuck when trying to read large files wihhout xref marker #808

 Merged

[MartinThoma](/MartinThoma)
merged 1 commit into
[py-pdf:main](/py-pdf/pypdf/tree/main "py-pdf/pypdf:main")
from
[montaggroup:fix-pdf-reader-getting-stuck-on-large-files-without-startxref-marker](/montaggroup/PyPDF2/tree/fix-pdf-reader-getting-stuck-on-large-files-without-startxref-marker "montaggroup/PyPDF2:fix-pdf-reader-getting-stuck-on-large-files-without-startxref-marker")

Apr 23, 2022

 Merged

# [fix pdf reader getting stuck when trying to read large files wihhout xref marker](#top) #808

[MartinThoma](/MartinThoma)
merged 1 commit into
[py-pdf:main](/py-pdf/pypdf/tree/main "py-pdf/pypdf:main")
from
[montaggroup:fix-pdf-reader-getting-stuck-on-large-files-without-startxref-marker](/montaggroup/PyPDF2/tree/fix-pdf-reader-getting-stuck-on-large-files-without-startxref-marker "montaggroup/PyPDF2:fix-pdf-reader-getting-stuck-on-large-files-without-startxref-marker")

Apr 23, 2022

[Conversation
5](/py-pdf/pypdf/pull/808)
[Commits
1](/py-pdf/pypdf/pull/808/commits)
[Checks
0](/py-pdf/pypdf/pull/808/checks)
[Files changed](/py-pdf/pypdf/pull/808/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![dsk7](https://avatars.githubusercontent.com/u/1869156?s=60&v=4)](/dsk7)

Copy link

Contributor

### @dsk7 **[dsk7](/dsk7)** commented [Apr 23, 2022](#issue-1213341450)

When trying to find the xref marker, the PDF reader code the file backwards and builds a so called line by concatenating strings in a loop.

This leads to O(n^2) performance. For files where the xref marker can not be found at the end this takes a enormous amount of time:

1mb of zeros at the end: 45.54 seconds

2mb of zeros at the end: 357.04 seconds

(measured on a laptop made in 2015)

This pull request changes the relevant section of the code to become O(n), leading to a run time of less then 1 second for both cases mentioned above. Furthermore this PR adds a test to prevent regression.

Unit tests have been run manually on Python 2.7.18 and Python 3.8.10.

Sorry, something went wrong.

 ‚ù§Ô∏è
2
 MartinThoma and brian-ev reacted with heart emoji
 üöÄ
1
 MartinThoma reacted with rocket emoji

All reactions

* ‚ù§Ô∏è
  2 reactions
* üöÄ
  1 reaction

[![@codecov-commenter](https://avatars.githubusercontent.com/u/65553080?s=80&u=b7ee84d82e25b493051d810390e97b15f716d7ef&v=4)](/codecov-commenter)

Copy link

### **[codecov-commenter](/codecov-commenter)** commented [Apr 23, 2022](#issuecomment-1107520798) ‚Ä¢ edited Loading

|  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://codecov.io/gh/py-pdf/PyPDF2/pull/808?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=py-pdf) Report Merging [#808](https://codecov.io/gh/py-pdf/PyPDF2/pull/808?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=py-pdf) ([699e1ad](https://github.com/py-pdf/pypdf/commit/699e1ad0fbdcf28396163f8ae47d0158c6f6eb27)) into [main](https://codecov.io/gh/py-pdf/PyPDF2/commit/3d659389e7561c024b5ffb9edd810e94814fa63e?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=py-pdf) ([3d65938](https://github.com/py-pdf/pypdf/commit/3d659389e7561c024b5ffb9edd810e94814fa63e)) will **not change** coverage. The diff coverage is `100.00%`.  ``` @@           Coverage Diff           @@ ##             main     #808   +/-   ## =======================================   Coverage   75.22%   75.22%            =======================================   Files          11       11              Lines        3516     3516              Branches      810      810            =======================================   Hits         2645     2645              Misses        658      658              Partials      213      213            ```  | [Impacted Files](https://codecov.io/gh/py-pdf/PyPDF2/pull/808?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=py-pdf) | Coverage Œî |  | | --- | --- | --- | | [PyPDF2/pdf.py](https://codecov.io/gh/py-pdf/PyPDF2/pull/808/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=py-pdf#diff-UHlQREYyL3BkZi5weQ==) | `81.85% <100.00%> (√∏)` |  |   ---   [Continue to review full report at Codecov](https://codecov.io/gh/py-pdf/PyPDF2/pull/808?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=py-pdf).  **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=py-pdf) `Œî = absolute <relative> (impact)`, `√∏ = not affected`, `? = missing data` Powered by [Codecov](https://codecov.io/gh/py-pdf/PyPDF2/pull/808?src=pr&el=footer&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=py-pdf). Last update [3d65938...699e1ad](https://codecov.io/gh/py-pdf/PyPDF2/pull/808?src=pr&el=lastupdated&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=py-pdf). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=py-pdf). |

All reactions

Sorry, something went wrong.

 [![@dsk7](https://avatars.githubusercontent.com/u/1869156?s=40&u=ad2a7b1f0b222c5953de167861a10405dcced4d1&v=4)](/dsk7)
[dsk7](/dsk7)
[force-pushed](/py-pdf/pypdf/compare/49ed48ade2c17e95d047bf43cf1d5eb2dd3f3638..3be7ec7512081fdfbc18ca079c626935efbd662a)
the
fix-pdf-reader-getting-stuck-on-large-files-without-startxref-marker

branch
from
[`49ed48a`](/py-pdf/pypdf/commit/49ed48ade2c17e95d047bf43cf1d5eb2dd3f3638) to
[`3be7ec7`](/py-pdf/pypdf/commit/3be7ec7512081fdfbc18ca079c626935efbd662a)  [Compare](/py-pdf/pypdf/compare/49ed48ade2c17e95d047bf43cf1d5eb2dd3f3638..3be7ec7512081fdfbc18ca079c626935efbd662a)
[April 23, 2022 15:28](#event-6484327915)

[![@dsk7](https://avatars.githubusercontent.com/u/1869156?s=40&u=ad2a7b1f0b222c5953de167861a10405dcced4d1&v=4)](/dsk7)
[dsk7](/dsk7)
changed the title
~~fix pdf reader getting stuck when trying to read large files wihhout xref marker~~
draft: fix pdf reader getting stuck when trying to read large files wihhout xref marker
[Apr 23, 2022](#event-6484336694)

 [![@dsk7](https://avatars.githubusercontent.com/u/1869156?s=40&u=ad2a7b1f0b222c5953de167861a10405dcced4d1&v=4)](/dsk7)
[dsk7](/dsk7)
[force-pushed](/py-pdf/pypdf/compare/3be7ec7512081fdfbc18ca079c626935efbd662a..e4c4b9ac9a9d62957458fd09fc949487f8355451)
the
fix-pdf-reader-getting-stuck-on-large-files-without-startxref-marker

branch
from
[`3be7ec7`](/py-pdf/pypdf/commit/3be7ec7512081fdfbc18ca079c626935efbd662a) to
[`e4c4b9a`](/py-pdf/pypdf/commit/e4c4b9ac9a9d62957458fd09fc949487f8355451)  [Compare](/py-pdf/pypdf/compare/3be7ec7512081fdfbc18ca079c626935efbd662a..e4c4b9ac9a9d62957458fd09fc949487f8355451)
[April 23, 2022 15:39](#event-6484338960)

[![@dsk7](https://avatars.githubusercontent.com/u/1869156?s=40&v=4)](/dsk7)

`[BUG: fix pdf reader getting stuck when trying to read large files wit‚Ä¶](/py-pdf/pypdf/pull/808/commits/699e1ad0fbdcf28396163f8ae47d0158c6f6eb27 "BUG: fix pdf reader getting stuck when trying to read large files without xref marker")`
 ‚Ä¶

`[699e1ad](/py-pdf/pypdf/pull/808/commits/699e1ad0fbdcf28396163f8ae47d0158c6f6eb27)`

```
‚Ä¶hout xref marker
```

 [![@dsk7](https://avatars.githubusercontent.com/u/1869156?s=40&u=ad2a7b1f0b222c5953de167861a10405dcced4d1&v=4)](/dsk7)
[dsk7](/dsk7)
[force-pushed](/py-pdf/pypdf/compare/e4c4b9ac9a9d62957458fd09fc949487f8355451..699e1ad0fbdcf28396163f8ae47d0158c6f6eb27)
the
fix-pdf-reader-getting-stuck-on-large-files-without-startxref-marker

branch
from
[`e4c4b9a`](/py-pdf/pypdf/commit/e4c4b9ac9a9d62957458fd09fc949487f8355451) to
[`699e1ad`](/py-pdf/pypdf/commit/699e1ad0fbdcf28396163f8ae47d0158c6f6eb27)  [Compare](/py-pdf/pypdf/compare/e4c4b9ac9a9d62957458fd09fc949487f8355451..699e1ad0fbdcf28396163f8ae47d0158c6f6eb27)
[April 23, 2022 15:44](#event-6484343586)

[![@dsk7](https://avatars.githubusercontent.com/u/1869156?s=40&u=ad2a7b1f0b222c5953de167861a10405dcced4d1&v=4)](/dsk7)
[dsk7](/dsk7)
changed the title
~~draft: fix pdf reader getting stuck when trying to read large files wihhout xref marker~~
fix pdf reader getting stuck when trying to read large files wihhout xref marker
[Apr 23, 2022](#event-6484345302)

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)
[MartinThoma](/MartinThoma)
merged commit [`c6c56f5`](/py-pdf/pypdf/commit/c6c56f550bb384e05f0139c796ba1308837d6373)
into
py-pdf:main

[Apr 23, 2022](https://github.com/py-pdf/pypdf/pull/808#event-6484431207)

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=80&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)

Copy link

Member

### **[MartinThoma](/MartinThoma)** commented [Apr 23, 2022](#issuecomment-1107536537)

| [@dsk7](https://github.com/dsk7) Amazing work! I will feature this in the next release notes - I absolutely love it! Thank you for adjusting the PR and for putting in the extra effort of creating a regression test ‚ù§Ô∏è It's people like you who make open source absolutely amazing ü§ó |
| --- |

All reactions

Sorry, something went wrong.

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=80&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)

Copy link

Member

### **[MartinThoma](/MartinThoma)** commented [Apr 23, 2022](#issuecomment-1107537222)

| Trying to give you a little bit of the honor you deserve: <https://twitter.com/_martinthoma/status/1517915519906729985> :-) |
| --- |

All reactions

Sorry, something went wrong.

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)
[MartinThoma](/MartinThoma)
added
the
[nf-performance](/py-pdf/pypdf/labels/nf-performance)
Non-functional change: Performance
label
[Apr 23, 2022](#event-6484436495)

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)
[MartinThoma](/MartinThoma)
mentioned this pull request
[Apr 23, 2022](#ref-pullrequest-184622256)

[fix pdf reader getting stuck on large files without startxref marker
#295](/py-pdf/pypdf/pull/295)
 Closed

[![@Butterfly](https://avatars.githubusercontent.com/u/57623?s=80&u=db795b0c6c31bd4157fe7169fb173055522ffe76&v=4)](/Butterfly)

Copy link

### **[Butterfly](/Butterfly)** commented [Apr 23, 2022](#issuecomment-1107542459)

| [@dsk7](https://github.com/dsk7) Amazing work! I will feature this in the next release notes - I absolutely love it! Thank you for adjusting the PR and for putting in the extra effort of creating a regression test heart It's people like you who make open source absolutely amazing hugs  That's too funny! I JUST tweeted this very thread a few seconds ago myself because it happened to be the one in my face. I'm going to pump your CONTRIBUTORS md out there, too. This Github has been something else to watch the last few weeks. It has turned into such an instantly nice, supportive spot out on the Web here. üëè ü•≥ |
| --- |

 ‚ù§Ô∏è
1
 MartinThoma reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

Sorry, something went wrong.

[MartinThoma](/MartinThoma)
added a commit
that referenced
this pull request
[Apr 24, 2022](#ref-commit-22033d7)
[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)

`[REL: 1.27.9](/py-pdf/pypdf/commit/22033d724e0c8a684c5aca1d390deedb4331a273 "REL: 1.27.9

A change I would like to highlight is the performance improvement for
large PDF files (#808) üéâ

New Features (ENH):
-  Add papersizes (#800)
-  Allow setting permission flags when encrypting (#803)
-  Allow setting form field flags (#802)

Bug Fixes (BUG):
-  TypeError in xmp._converter_date (#813)
-  Improve spacing for text extraction (#806)
-  Fix PDFDocEncoding Character Set (#809)

Robustness (ROB):
-  Use null ID when encrypted but no ID given (#812)
-  Handle recursion error (#804)

Documentation (DOC):
-  CMaps (#811)
-  The PDF Format + commit prefixes (#810)
-  Add compression example (#792)

Developer Experience (DEV):
-  Add Benchmark for Performance Testing (#781)

Maintenance (MAINT):
-  Validate PDF magic byte in strict mode (#814)
-  Make PdfFileMerger.addBookmark() behave life PdfFileWriters\' (#339)
-  Quadratic runtime while parsing reduced to linear  (#808)

Testing (TST):
-  Newlines in text extraction (#807)

Full Changelog: https://github.com/py-pdf/PyPDF2/compare/1.27.8...1.27.9")`
‚Ä¶

`[22033d7](/py-pdf/pypdf/commit/22033d724e0c8a684c5aca1d390deedb4331a273)`

```
A change I would like to highlight is the performance improvement for
large PDF files ([#808](https://github.com/py-pdf/pypdf/pull/808)) üéâ

New Features (ENH):
-  Add papersizes ([#800](https://github.com/py-pdf/pypdf/pull/800))
-  Allow setting permission flags when encrypting ([#803](https://github.com/py-pdf/pypdf/pull/803))
-  Allow setting form field flags ([#802](https://github.com/py-pdf/pypdf/pull/802))

Bug Fixes (BUG):
-  TypeError in xmp._converter_date ([#813](https://github.com/py-pdf/pypdf/pull/813))
-  Improve spacing for text extraction ([#806](https://github.com/py-pdf/pypdf/pull/806))
-  Fix PDFDocEncoding Character Set ([#809](https://github.com/py-pdf/pypdf/pull/809))

Robustness (ROB):
-  Use null ID when encrypted but no ID given ([#812](https://github.com/py-pdf/pypdf/pull/812))
-  Handle recursion error ([#804](https://github.com/py-pdf/pypdf/pull/804))

Documentation (DOC):
-  CMaps ([#811](https://github.com/py-pdf/pypdf/pull/811))
-  The PDF Format + commit prefixes ([#810](https://github.com/py-pdf/pypdf/pull/810))
-  Add compression example ([#792](https://github.com/py-pdf/pypdf/pull/792))

Developer Experience (DEV):
-  Add Benchmark for Performance Testing ([#781](https://github.com/py-pdf/pypdf/pull/781))

Maintenance (MAINT):
-  Validate PDF magic byte in strict mode ([#814](https://github.com/py-pdf/pypdf/pull/814))
-  Make PdfFileMerger.addBookmark() behave life PdfFileWriters\' ([#339](https://github.com/py-pdf/pypdf/pull/339))
-  Quadratic runtime while parsing reduced to linear  ([#808](https://github.com/py-pdf/pypdf/pull/808))

Testing (TST):
-  Newlines in text extraction ([#807](https://github.com/py-pdf/pypdf/pull/807))

Full Changelog: [1.27.8...1.27.9](https://github.com/py-pdf/pypdf/compare/1.27.8...1.27.9)
```

[VictorCarlquist](/VictorCarlquist)
pushed a commit
to VictorCarlquist/PyPDF2
that referenced
this pull request
[Apr 29, 2022](#ref-commit-2003cf3)
[![@dsk7](https://avatars.githubusercontent.com/u/1869156?s=40&u=ad2a7b1f0b222c5953de167861a10405dcced4d1&v=4)](/dsk7) [![@VictorCarlquist](https://avatars.githubusercontent.com/u/871273?s=40&v=4)](/VictorCarlquist)

`[MAINT: Quadratic runtime while parsing reduced to linear (](/VictorCarlquist/PyPDF2/commit/2003cf33303df1feb6e255780840f4055ae6da5f "MAINT: Quadratic runtime while parsing reduced to linear  (#808)

When the PdfFileReader tries to find the xref marker, the readNextEndLine methods builds a so called line by reading byte-for-byte. Every time a new byte is read, it is concatenated with the currently read line. This leads to quadratic runtime O(n¬≤) behavior as Python strings (also byte-strings) are immutable and have to be copied where n is the size of the file.
For files where the xref marker can not be found at the end this takes a enormous amount of time:

* 1mb of zeros at the end: 45.54 seconds
* 2mb of zeros at the end: 357.04 seconds
(measured on a laptop made in 2015)

This pull request changes the relevant section of the code to become linear runtime O(n), leading to a run time of less then a second for both cases mentioned above. Furthermore this PR adds a regression test.")[py-pdf#808](https://github.com/py-pdf/pypdf/pull/808)[)](/VictorCarlquist/PyPDF2/commit/2003cf33303df1feb6e255780840f4055ae6da5f "MAINT: Quadratic runtime while parsing reduced to linear  (#808)

When the PdfFileReader tries to find the xref marker, the readNextEndLine methods builds a so called line by reading byte-for-byte. Every time a new byte is read, it is concatenated with the currently read line. This leads to quadratic runtime O(n¬≤) behavior as Python strings (also byte-strings) are immutable and have to be copied where n is the size of the file.
For files where the xref marker can not be found at the end this takes a enormous amount of time:

* 1mb of zeros at the end: 45.54 seconds
* 2mb of zeros at the end: 357.04 seconds
(measured on a laptop made in 2015)

This pull request changes the relevant section of the code to become linear runtime O(n), leading to a run time of less then a second for both cases mentioned above. Furthermore this PR adds a regression test.")`
‚Ä¶

`[2003cf3](/VictorCarlquist/PyPDF2/commit/2003cf33303df1feb6e255780840f4055ae6da5f)`

```
When the PdfFileReader tries to find the xref marker, the readNextEndLine methods builds a so called line by reading byte-for-byte. Every time a new byte is read, it is concatenated with the currently read line. This leads to quadratic runtime O(n¬≤) behavior as Python strings (also byte-strings) are immutable and have to be copied where n is the size of the file.
For files where the xref marker can not be found at the end this takes a enormous amount of time:

* 1mb of zeros at the end: 45.54 seconds
* 2mb of zeros at the end: 357.04 seconds
(measured on a laptop made in 2015)

This pull request changes the relevant section of the code to become linear runtime O(n), leading to a run time of less then a second for both cases mentioned above. Furthermore this PR adds a regression test.
```

[VictorCarlquist](/VictorCarlquist)
pushed a commit
to VictorCarlquist/PyPDF2
that referenced
this pull request
[Apr 29, 2022](#ref-commit-ed06ebc)
[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma) [![@VictorCarlquist](https://avatars.githubusercontent.com/u/871273?s=40&v=4)](/VictorCarlquist)

`[REL: 1.27.9](/VictorCarlquist/PyPDF2/commit/ed06ebc1a224c49cdfad4d2acd6bb5ccd32d925d "REL: 1.27.9

A change I would like to highlight is the performance improvement for
large PDF files (#808) üéâ

New Features (ENH):
-  Add papersizes (#800)
-  Allow setting permission flags when encrypting (#803)
-  Allow setting form field flags (#802)

Bug Fixes (BUG):
-  TypeError in xmp._converter_date (#813)
-  Improve spacing for text extraction (#806)
-  Fix PDFDocEncoding Character Set (#809)

Robustness (ROB):
-  Use null ID when encrypted but no ID given (#812)
-  Handle recursion error (#804)

Documentation (DOC):
-  CMaps (#811)
-  The PDF Format + commit prefixes (#810)
-  Add compression example (#792)

Developer Experience (DEV):
-  Add Benchmark for Performance Testing (#781)

Maintenance (MAINT):
-  Validate PDF magic byte in strict mode (#814)
-  Make PdfFileMerger.addBookmark() behave life PdfFileWriters\' (#339)
-  Quadratic runtime while parsing reduced to linear  (#808)

Testing (TST):
-  Newlines in text extraction (#807)

Full Changelog: https://github.com/py-pdf/PyPDF2/compare/1.27.8...1.27.9")`
‚Ä¶

`[ed06ebc](/VictorCarlquist/PyPDF2/commit/ed06ebc1a224c49cdfad4d2acd6bb5ccd32d925d)`

```
A change I would like to highlight is the performance improvement for
large PDF files ([py-pdf#808](https://github.com/py-pdf/pypdf/pull/808)) üéâ

New Features (ENH):
-  Add papersizes ([py-pdf#800](https://github.com/py-pdf/pypdf/pull/800))
-  Allow setting permission flags when encrypting ([py-pdf#803](https://github.com/py-pdf/pypdf/pull/803))
-  Allow setting form field flags ([py-pdf#802](https://github.com/py-pdf/pypdf/pull/802))

Bug Fixes (BUG):
-  TypeError in xmp._converter_date ([py-pdf#813](https://github.com/py-pdf/pypdf/pull/813))
-  Improve spacing for text extraction ([py-pdf#806](https://github.com/py-pdf/pypdf/pull/806))
-  Fix PDFDocEncoding Character Set ([py-pdf#809](https://github.com/py-pdf/pypdf/pull/809))

Robustness (ROB):
-  Use null ID when encrypted but no ID given ([py-pdf#812](https://github.com/py-pdf/pypdf/pull/812))
-  Handle recursion error ([py-pdf#804](https://github.com/py-pdf/pypdf/pull/804))

Documentation (DOC):
-  CMaps ([py-pdf#811](https://github.com/py-pdf/pypdf/pull/811))
-  The PDF Format + commit prefixes ([py-pdf#810](https://github.com/py-pdf/pypdf/pull/810))
-  Add compression example ([py-pdf#792](https://github.com/py-pdf/pypdf/pull/792))

Developer Experience (DEV):
-  Add Benchmark for Performance Testing ([py-pdf#781](https://github.com/py-pdf/pypdf/pull/781))

Maintenance (MAINT):
-  Validate PDF magic byte in strict mode ([py-pdf#814](https://github.com/py-pdf/pypdf/pull/814))
-  Make PdfFileMerger.addBookmark() behave life PdfFileWriters\' ([py-pdf#339](https://github.com/py-pdf/pypdf/pull/339))
-  Quadratic runtime while parsing reduced to linear  ([py-pdf#808](https://github.com/py-pdf/pypdf/pull/808))

Testing (TST):
-  Newlines in text extraction ([py-pdf#807](https://github.com/py-pdf/pypdf/pull/807))

Full Changelog: [py-pdf/pypdf@1.27.8...1.27.9](https://github.com/py-pdf/pypdf/compare/1.27.8...1.27.9)
```

[![@dsk7](https://avatars.githubusercontent.com/u/1869156?s=80&u=ad2a7b1f0b222c5953de167861a10405dcced4d1&v=4)](/dsk7)

Copy link

Contributor

Author

### **[dsk7](/dsk7)** commented [May 2, 2022](#issuecomment-1115380296)

| Trying to give you a little bit of the honor you deserve: <https://twitter.com/_martinthoma/status/1517915519906729985> :-)  [@dsk7](https://github.com/dsk7) Amazing work! I will feature this in the next release notes - I absolutely love it! Thank you for adjusting the PR and for putting in the extra effort of creating a regression test heart It's people like you who make open source absolutely amazing hugs  Thanks for your kind words. I'm happy to be able to help this cool project! |
| --- |

All reactions

Sorry, something went wrong.

[![@ztravis](https://avatars.githubusercontent.com/u/164656?s=40&v=4)](/ztravis)
[ztravis](/ztravis)
mentioned this pull request
[Jun 8, 2022](#ref-pullrequest-1054397527)

[Optimize read\_next\_end\_line
#646](/py-pdf/pypdf/pull/646)
 Merged

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)
[MartinThoma](/MartinThoma)
mentioned this pull request
[Nov 1, 2022](#ref-pullrequest-1428870360)

[Use `process_time` instead of just `time` for measuring test performance.
#1413](/py-pdf/pypdf/pull/1413)
 Closed

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)
[MartinThoma](/MartinThoma)
mentioned this pull request
[Jun 30, 2023](#ref-issue-742435553)

[Quadratic runtime with malformed PDF missing xref marker
#582](/py-pdf/pypdf/issues/582)

Closed

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)
[MartinThoma](/MartinThoma)
added
the
[nf-security](/py-pdf/pypdf/labels/nf-security)
Non-functional change: Security
label
[Jun 30, 2023](#event-9687963890)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpy-pdf%2Fpypdf%2Fpull%2F808)

Reviewers

No reviews

Assignees

No one assigned

Labels

[nf-performance](/py-pdf/pypdf/labels/nf-performance)
Non-functional change: Performance
[nf-security](/py-pdf/pypdf/labels/nf-security)
Non-functional change: Security

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@dsk7](https://avatars.githubusercontent.com/u/1869156?s=52&v=4)](/dsk7) [![@codecov-commenter](https://avatars.githubusercontent.com/u/65553080?s=52&v=4)](/codecov-commenter) [![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=52&v=4)](/MartinThoma) [![@Butterfly](https://avatars.githubusercontent.com/u/57623?s=52&v=4)](/Butterfly)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_8ed386d6_20250114_183706.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpy-pdf%2Fpypdf%2Fissues%2F582)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpy-pdf%2Fpypdf%2Fissues%2F582)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=py-pdf%2Fpypdf)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[py-pdf](/py-pdf)
/
**[pypdf](/py-pdf/pypdf)**
Public

* [Notifications](/login?return_to=%2Fpy-pdf%2Fpypdf) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fpy-pdf%2Fpypdf)
* [Star
   8.6k](/login?return_to=%2Fpy-pdf%2Fpypdf)

* [Code](/py-pdf/pypdf)
* [Issues
  75](/py-pdf/pypdf/issues)
* [Pull requests
  22](/py-pdf/pypdf/pulls)
* [Discussions](/py-pdf/pypdf/discussions)
* [Actions](/py-pdf/pypdf/actions)
* [Security](/py-pdf/pypdf/security)
* [Insights](/py-pdf/pypdf/pulse)

Additional navigation options

* [Code](/py-pdf/pypdf)
* [Issues](/py-pdf/pypdf/issues)
* [Pull requests](/py-pdf/pypdf/pulls)
* [Discussions](/py-pdf/pypdf/discussions)
* [Actions](/py-pdf/pypdf/actions)
* [Security](/py-pdf/pypdf/security)
* [Insights](/py-pdf/pypdf/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpy-pdf%2Fpypdf%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpy-pdf%2Fpypdf%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Quadratic runtime with malformed PDF missing xref marker #582

Closed

[Google-Autofuzz](/Google-Autofuzz) opened this issue
Nov 13, 2020
¬∑ 2 comments

Closed

# [Quadratic runtime with malformed PDF missing xref marker](#top) #582

[Google-Autofuzz](/Google-Autofuzz) opened this issue
Nov 13, 2020
¬∑ 2 comments

Labels
[is-bug](/py-pdf/pypdf/labels/is-bug)
From a users perspective, this is a bug - a violation of the expected behavior with a compliant PDF
[is-robustness-issue](/py-pdf/pypdf/labels/is-robustness-issue)
From a users perspective, this is about robustness
[nf-security](/py-pdf/pypdf/labels/nf-security)
Non-functional change: Security

## Comments

[![@Google-Autofuzz](https://avatars.githubusercontent.com/u/27442508?s=80&u=c71a1a8e4e3c46965660ca6a30a052a6472e2860&v=4)](/Google-Autofuzz)

Copy link

### **[Google-Autofuzz](/Google-Autofuzz)** commented [Nov 13, 2020](#issue-742435553) ‚Ä¢ edited by MartinThoma Loading

| When running the following code with `PyPDF2==1.27.8` on the attached input results in 100% CPU consumption for an arbitrary long time. MCVE PDF: [test.pdf](https://github.com/mstamy2/PyPDF2/files/5536876/test.pdf)  ``` from PyPDF2 import PdfFileReader  reader = PdfFileReader("test.pdf") ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@Google-Autofuzz](https://avatars.githubusercontent.com/u/27442508?s=40&u=c71a1a8e4e3c46965660ca6a30a052a6472e2860&v=4)](/Google-Autofuzz)
[Google-Autofuzz](/Google-Autofuzz)
changed the title
~~Inifinite loop with malformed PDF~~
Infinite loop with malformed PDF
[Nov 13, 2020](#event-3993405431)

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)
[MartinThoma](/MartinThoma)
added
[is-bug](/py-pdf/pypdf/labels/is-bug)
From a users perspective, this is a bug - a violation of the expected behavior with a compliant PDF
[is-robustness-issue](/py-pdf/pypdf/labels/is-robustness-issue)
From a users perspective, this is about robustness
labels
[Apr 7, 2022](#event-6390192539)

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=80&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)

Copy link

Member

### **[MartinThoma](/MartinThoma)** commented [Apr 24, 2022](#issuecomment-1107836223) ‚Ä¢ edited Loading

| The PDF is hopelessly broken:  ``` $ cat issue-582.pdf  angÔøΩÔøΩH %s/I\ ±\\\\\\\\\\\\\\\\\\\\\\\\\[\\ùüñ\\\ %EO-254536430 %%EOFFÔøΩ	g eÔøΩ %%EOF%                          ``` Investigating ``` import time import PyPDF2 import traceback  print(PyPDF2.__version__)  t0 = time.time() try:     reader = PyPDF2.PdfFileReader("test.pdf") except Exception as e:     print(traceback.format_exc())     print(e) t1 = time.time() print(f"`PyPDF2=={PyPDF2.__version__}` finished after {t1-t0:.3f}s") ``` Affected Versions  * `PyPDF2==1.20` finished after 24.664s * `PyPDF2==1.25` finished after 29.781s * `PyPDF2==1.26.0` finished after 29.743s * `PyPDF2==1.27.0` finished after 29.611s * `PyPDF2==1.27.8` finished after 34.518s * Fixed in [c6c56f5](https://github.com/py-pdf/pypdf/commit/c6c56f550bb384e05f0139c796ba1308837d6373) via [fix pdf reader getting stuck when trying to read large files wihhout xref marker¬†#808](https://github.com/py-pdf/pypdf/pull/808) * `PyPDF2==1.27.9`: Exception after 0.001 |
| --- |

All reactions

Sorry, something went wrong.

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)
[MartinThoma](/MartinThoma)
closed this as [completed](/py-pdf/pypdf/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Apr 24, 2022](#event-6485824501)

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)
[MartinThoma](/MartinThoma)
added
the
[nf-security](/py-pdf/pypdf/labels/nf-security)
Non-functional change: Security
label
[Jun 30, 2023](#event-9684196220)

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)
[MartinThoma](/MartinThoma)
changed the title
~~Infinite loop with malformed PDF~~
Very long execution time with malformed PDF
[Jun 30, 2023](#event-9684332465)

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)
[MartinThoma](/MartinThoma)
changed the title
~~Very long execution time with malformed PDF~~
Quadratic runtime with malformed PDF
[Jun 30, 2023](#event-9684499311)

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=40&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)
[MartinThoma](/MartinThoma)
changed the title
~~Quadratic runtime with malformed PDF~~
Quadratic runtime with malformed PDF missing xref marker
[Jun 30, 2023](#event-9684502104)

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=80&u=4266f1a009b6ecbb840bbafd57b8cc530ca4fcce&v=4)](/MartinThoma)

Copy link

Member

### **[MartinThoma](/MartinThoma)** commented [Jun 30, 2023](#issuecomment-1614658843)

| Reported publicly via [GHSA-jrm6-h9cq-8gqw](https://github.com/py-pdf/pypdf/security/advisories/GHSA-jrm6-h9cq-8gqw "GHSA-jrm6-h9cq-8gqw") |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpy-pdf%2Fpypdf%2Fissues%2F582)

Assignees

No one assigned

Labels

[is-bug](/py-pdf/pypdf/labels/is-bug)
From a users perspective, this is a bug - a violation of the expected behavior with a compliant PDF
[is-robustness-issue](/py-pdf/pypdf/labels/is-robustness-issue)
From a users perspective, this is about robustness
[nf-security](/py-pdf/pypdf/labels/nf-security)
Non-functional change: Security

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@MartinThoma](https://avatars.githubusercontent.com/u/1658117?s=52&v=4)](/MartinThoma) [![@Google-Autofuzz](https://avatars.githubusercontent.com/u/27442508?s=52&v=4)](/Google-Autofuzz)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_d99b4868_20250114_183708.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpy-pdf%2Fpypdf%2Fsecurity%2Fadvisories%2FGHSA-jrm6-h9cq-8gqw)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpy-pdf%2Fpypdf%2Fsecurity%2Fadvisories%2FGHSA-jrm6-h9cq-8gqw)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=py-pdf%2Fpypdf)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[py-pdf](/py-pdf)
/
**[pypdf](/py-pdf/pypdf)**
Public

* [Notifications](/login?return_to=%2Fpy-pdf%2Fpypdf) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fpy-pdf%2Fpypdf)
* [Star
   8.6k](/login?return_to=%2Fpy-pdf%2Fpypdf)

* [Code](/py-pdf/pypdf)
* [Issues
  75](/py-pdf/pypdf/issues)
* [Pull requests
  22](/py-pdf/pypdf/pulls)
* [Discussions](/py-pdf/pypdf/discussions)
* [Actions](/py-pdf/pypdf/actions)
* [Security](/py-pdf/pypdf/security)
* [Insights](/py-pdf/pypdf/pulse)

Additional navigation options

* [Code](/py-pdf/pypdf)
* [Issues](/py-pdf/pypdf/issues)
* [Pull requests](/py-pdf/pypdf/pulls)
* [Discussions](/py-pdf/pypdf/discussions)
* [Actions](/py-pdf/pypdf/actions)
* [Security](/py-pdf/pypdf/security)
* [Insights](/py-pdf/pypdf/pulse)

# Quadratic runtime with malformed PDF missing xref marker

Moderate

[MartinThoma](/MartinThoma)
published
GHSA-jrm6-h9cq-8gqw
Jun 30, 2023

## Package

pip

PyPDF2
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<=1.27.8

## Patched versions

>=1.27.9

## Description

### Impact

An attacker who uses this vulnerability can craft a PDF which leads to unexpected long runtime.

This quadratic runtime blocks the current process and can utilize a single core of the CPU by 100%. It does not affect memory usage.

### Patches

[#808](https://github.com/py-pdf/pypdf/pull/808)

### Workarounds

*Is there a way for users to fix or remediate the vulnerability without upgrading?*

### References

* [PyPDF2 PR #808](https://github.com/py-pdf/pypdf/pull/808)
* [PyPDF2 Issue #582](https://github.com/py-pdf/pypdf/issues/582)

### Severity

Moderate

6.2

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2023-36810

### Weaknesses

No CWEs

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from lists.debian.org_d994f40c_20250114_183709.html ===


---

[[Date Prev](msg00018.html)][[Date Next](msg00020.html)]
[[Thread Prev](msg00018.html)][[Thread Next](msg00020.html)]
[[Date Index](maillist.html#00019)]
[[Thread Index](threads.html#00019)]

# [SECURITY] [DLA 3497-1] pypdf2 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3497-1] pypdf2 security update
* *From*: Adrian Bunk <bunk@debian.org>
* *Date*: Fri, 14 Jul 2023 23:54:53 +0300
* *Message-id*: <[[üîé]](/msgid-search/ZLG2HTn82tJwbYbF%40localhost)¬†[ZLG2HTn82tJwbYbF@localhost](msg00019.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3497-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Adrian Bunk
July 14, 2023                                 <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : pypdf2
Version        : 1.26.0-2+deb10u2
CVE ID         : CVE-2023-36810

Quadratic runtime with malformed PDFs missing xref marker has been fixed
in PyPDF2, a pure Python PDF library.

For Debian 10 buster, this problem has been fixed in version
1.26.0-2+deb10u2.

We recommend that you upgrade your pypdf2 packages.

For the detailed security status of pypdf2 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/pypdf2>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEOvp1f6xuoR0v9F3wiNJCh6LYmLEFAmSxthkACgkQiNJCh6LY
mLFjvRAApnyrNsqRi2+tFb1HJgqgMj8nmFk+HFleyWTZjP/z6iR1h917B/vQnHz1
byT+IYMknVhXKduf+mOiYItWE5tNGpXMwZtgX3yXnnvYLNcKR/SuN900vWx3OSf/
fIbe2hLJtHuo9CEopv6GxFo4k2aZFD5dqRxXPeyq1BGHL0/T6b6PiZ6bLGIkATiq
ZWcWOMWZuaMX/t1wrJs0EC5LlgbowKs2acvxUsjcKYqX+SyDxHgdSgRvmnCfHlIu
dnW1HtqxozRjgx7uMtCvh6yYsVHr3rozSrS4hODiYmxSJnoe5uSILL7bFni3wWYK
YE13xtlZrVemqEZ1PHojZ3oZ4KSSW2jaBkc06ybI1C6LGoJwmYiJuC6RqaceVtaQ
ZyHWm4d6T8OozEIL48pmHsM+05/DQOcaaTEnJlLQH8d+xELYdd75ZYSJUkDIUPbc
zt/Q9S+dkkDDscqp8o+OgvjAmIeGrIMvIsKB2UDjq43LLUM28zk3fnY0OsoFlUxY
jHCn1JTz4Y1HojgmTbQ2UN2UDZITWTrwJG1m+JhP/Z4YEwT2JQSXQAIQs6zUik5i
QfORKXZ7UyB08FMXQ6yndtyRbbqogjVuZC9ctzm+RzxImE7/vDpkQOne3PPk8oaM
uF13GQBRyRrMj9pIQszHo4JQwkNWWDQoM96wuuVYIlf659G7eZk=
=sBpG
-----END PGP SIGNATURE-----

```

---


