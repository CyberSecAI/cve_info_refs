=== Content from github.com_5b9221d7_20250114_183032.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMonetDB%2FMonetDB%2Fissues%2F7385)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMonetDB%2FMonetDB%2Fissues%2F7385)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=MonetDB%2FMonetDB)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MonetDB](/MonetDB)
/
**[MonetDB](/MonetDB/MonetDB)**
Public

* [Notifications](/login?return_to=%2FMonetDB%2FMonetDB) You must be signed in to change notification settings
* [Fork
  55](/login?return_to=%2FMonetDB%2FMonetDB)
* [Star
   387](/login?return_to=%2FMonetDB%2FMonetDB)

* [Code](/MonetDB/MonetDB)
* [Issues
  50](/MonetDB/MonetDB/issues)
* [Pull requests
  0](/MonetDB/MonetDB/pulls)
* [Actions](/MonetDB/MonetDB/actions)
* [Projects
  4](/MonetDB/MonetDB/projects)
* [Security](/MonetDB/MonetDB/security)
* [Insights](/MonetDB/MonetDB/pulse)

Additional navigation options

* [Code](/MonetDB/MonetDB)
* [Issues](/MonetDB/MonetDB/issues)
* [Pull requests](/MonetDB/MonetDB/pulls)
* [Actions](/MonetDB/MonetDB/actions)
* [Projects](/MonetDB/MonetDB/projects)
* [Security](/MonetDB/MonetDB/security)
* [Insights](/MonetDB/MonetDB/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FMonetDB%2FMonetDB%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FMonetDB%2FMonetDB%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# MonetDB server 11.46.0 crashes in `GDKfree` #7385

Closed

[fuboat](/fuboat) opened this issue
Jun 16, 2023
· 3 comments

Closed

# [MonetDB server 11.46.0 crashes in `GDKfree`](#top) #7385

[fuboat](/fuboat) opened this issue
Jun 16, 2023
· 3 comments

Milestone
[Jun2023](/MonetDB/MonetDB/milestone/21 "Jun2023")

## Comments

[![@fuboat](https://avatars.githubusercontent.com/u/16066116?s=80&v=4)](/fuboat)

Copy link

### **[fuboat](/fuboat)** commented [Jun 16, 2023](#issue-1761134477)

| **Describe the bug** MonetDB server 11.46.0 crashes in `GDKfree` after executing SQL statements through mclient.  **To Reproduce**   1. Use mclient to connect MonetDB server; 2. Try to execute the following SQL statements **multiple times**. Sometimes they will crash the server. (On my machine, the server crashes after repeating executing these SQLs with at most 4 times)  ``` DROP SCHEMA test CASCADE; CREATE SCHEMA test; SET SCHEMA test; CREATE TABLE src (src_c1_pkey INT, c1 VARCHAR(100)); START TRANSACTION; DELETE   FROM src; ALTER TABLE src DROP src_c1_pkey; INSERT INTO src VALUES(1,1),(2,2),(3,3),(4,4),(6,6),(7,7),(8,8),(9,9),(10,10); COMMIT; SET SCHEMA sys; DROP SCHEMA test CASCADE; CREATE SCHEMA test; ```  **Expected behavior** Executing statements successfully or throwing errors, instead of breaking down the whole MonetDB server.  **Backtrace**  ``` #0 0x7f280338000b (gsignal+0xcb) #1 0x7f280335f859 (abort+0x12b) #2 0x7f28033ca26e (__fsetlocking+0x42e) #3 0x7f28033d22fc (pthread_attr_setschedparam+0x54c) #4 0x7f28033d3f6d (pthread_attr_setschedparam+0x21bd) #5 0x7f280414f765 (GDKfree+0x25) #6 0x7f280377af7b (destroy_delta+0x7b) #7 0x7f280377576d (destroy_col+0x2d) #8 0x7f2803745345 (column_destroy+0x45) #9 0x7f2803761ec2 (list_destroy2+0xa2) #10 0x7f2803760d14 (ol_destroy+0x34) #11 0x7f2803745450 (table_destroy+0x90) #12 0x7f280375ec17 (objectversion_destroy+0x77) #13 0x7f280375eb4f (os_destroy+0xcf) #14 0x7f2803750cdc (schema_destroy+0x7c) #15 0x7f280375ec17 (objectversion_destroy+0x77) #16 0x7f280376065d (objectversion_destroy_recursive+0x3d) #17 0x7f2803760345 (tc_gc_objectversion+0x75) #18 0x7f280374a307 (store_pending_changes+0x307) #19 0x7f280374ea87 (sql_trans_commit+0x567) #20 0x7f2803759353 (sql_trans_end+0x83) #21 0x7f280379c10c (mvc_commit+0x4fc) #22 0x7f280369d564 (SQLengine_+0x284) #23 0x7f280369c343 (SQLengine+0x23) #24 0x7f2803a2b6cf (runScenario+0x4f) #25 0x7f2803a2c16c (MSscheduleClient+0x68c) #26 0x7f2803ad3c2b (doChallenge+0xfb) #27 0x7f2804152ba0 (THRstarter+0x100) #28 0x7f28041c2cc4 (thread_starter+0x34) #29 0x7f2803537609 (start_thread+0xd9) #30 0x7f280345c133 (clone+0x43)  ```  **Software versions**   * MonetDB server version: 11.46.0 (hg id: [63a42c2](https://github.com/MonetDB/MonetDB/commit/63a42c2569c6ef1d3c36b161c544d7b1d93fe9a8)) (pulled from the master branch) * MonetDB client version: mclient, version 11.48.0 (hg id: [63a42c2](https://github.com/MonetDB/MonetDB/commit/63a42c2569c6ef1d3c36b161c544d7b1d93fe9a8)) * OS and version: ubuntu 20.04 * Self-installed and compiled. The command line of compilation: `CC=clang-12 CXX=clang++-12 cmake /root/monetdb_master -DCMAKE_BUILD_TYPE=RelWithDebInfo`   **Issue labeling** bug  **Additional context** The MonetDB here runs in-memory database. The command line of starting MonetDB server is `mserver5 --in-memory`.  If the crash cannot be reproduced easily, please tell me. I will try to provide the whole steps to trigger the crash as possible. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@mvdvm](https://avatars.githubusercontent.com/u/81317646?s=80&v=4)](/mvdvm)

Copy link

Contributor

### **[mvdvm](/mvdvm)** commented [Jun 19, 2023](#issuecomment-1597451568)

| Could **not** reproduce the crash with MonetDB 5 server v11.45.17 (Sep2022-SP3). We will add a test case to see if any memory leaks are detected. |
| --- |

All reactions

Sorry, something went wrong.

[![@fuboat](https://avatars.githubusercontent.com/u/16066116?s=80&v=4)](/fuboat)

Copy link

Author

### **[fuboat](/fuboat)** commented [Jun 19, 2023](#issuecomment-1597633047)

| I write a bash script to reproduce. It use the docker image of MonetDB v11.45.17 (Sep2022-SP3). Maybe it can help to reproduce the crash.  ``` #!/bin/bash  ###################################################### ## Build the image of MonetDB and start a container.   ###################################################### docker pull monetdb/monetdb:Sep2022-SP3 docker run -e MDB_DB_ADMIN_PASS=monetdb -d -p 50000:50000 --name monetdb monetdb/monetdb:Sep2022-SP3 docker container restart monetdb  echo -e "user=monetdb\npassword=monetdb" | docker exec -i monetdb tee /root/.monetdb  echo "Waiting the monetdb server to start..." while ! docker exec monetdb mclient monetdb > /dev/null 2> /dev/null do     echo -n "." done  docker exec monetdb dnf install procps-ng -y  ################################################# ## Get current PID of the mserver5 process.  ## as the mserver5 will be restart automatically  ## after crashing in the docker container, ## we check a crash by comparing the PIDs. ################################################# echo -ne "Check PID of mserver5: \033[0;32m\033[1m" docker exec monetdb pidof mserver5 echo -ne "\033[0m" oldPid=$(docker exec monetdb pidof mserver5)  ## Loop the SQL test cases. for (( i=0; i<200; ++i )) do  echo -n "."  echo "DROP SCHEMA test CASCADE; CREATE SCHEMA test; SET SCHEMA test; CREATE TABLE src (src_c1_pkey INT, c1 VARCHAR(100)); START TRANSACTION; DELETE   FROM src; ALTER TABLE src DROP src_c1_pkey; INSERT INTO src VALUES(1,1),(2,2),(3,3),(4,4),(6,6),(7,7),(8,8),(9,9),(10,10); COMMIT; SET SCHEMA sys; DROP SCHEMA test CASCADE; CREATE SCHEMA test; " | docker exec -i monetdb mclient monetdb 2>&1 | grep --color=always "unexpected end of file\|Challenge string is not valid, it is empty" && break  done  ############################################# ## Check whether some errors occurred. ############################################# if ! docker exec monetdb mclient monetdb then     echo "The server or client seems unavailable". else     echo -ne "Check PID of mserver5: \033[0;32m\033[1m"     docker exec monetdb pidof mserver5     echo -ne "\033[0m"     nowPid=$(docker exec monetdb pidof mserver5)          if (( nowPid != oldPid ))     then         echo "Different PIDs. Maybe a crash occurred?"     else         echo "Everything seems ok... Maybe not a bug."     fi fi ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@njnes](https://avatars.githubusercontent.com/u/3414452?s=40&v=4)](/njnes)
[njnes](/njnes)
added this to the [NEXTRELEASE](/MonetDB/MonetDB/milestone/1) milestone
[Jun 19, 2023](#event-9571969484)

[![@njnes](https://avatars.githubusercontent.com/u/3414452?s=80&v=4)](/njnes)

Copy link

Contributor

### **[njnes](/njnes)** commented [Jun 19, 2023](#issuecomment-1597691741)

| fixed in <https://www.monetdb.org/hg/MonetDB/rev/a6ce285fd6a9> Thanks (fuboat for finding al the issues, your tool is great at finding problems). |
| --- |

All reactions

Sorry, something went wrong.

[![@njnes](https://avatars.githubusercontent.com/u/3414452?s=40&v=4)](/njnes)
[njnes](/njnes)
closed this as [completed](/MonetDB/MonetDB/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jun 19, 2023](#event-9571981221)

[![@sjoerdmullender](https://avatars.githubusercontent.com/u/7091529?s=40&u=2819c28f1b744b83393fd35beb9a80d9af19d1e6&v=4)](/sjoerdmullender)
[sjoerdmullender](/sjoerdmullender)
modified the milestones:
[NEXTRELEASE](/MonetDB/MonetDB/milestone/1),
[Jun2023](/MonetDB/MonetDB/milestone/21)
[Sep 18, 2023](#event-10394523181)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FMonetDB%2FMonetDB%2Fissues%2F7385)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**Jun2023**](/MonetDB/MonetDB/milestone/21 "Jun2023")

Development

No branches or pull requests

4 participants

[![@njnes](https://avatars.githubusercontent.com/u/3414452?s=52&v=4)](/njnes) [![@sjoerdmullender](https://avatars.githubusercontent.com/u/7091529?s=52&v=4)](/sjoerdmullender) [![@fuboat](https://avatars.githubusercontent.com/u/16066116?s=52&v=4)](/fuboat) [![@mvdvm](https://avatars.githubusercontent.com/u/81317646?s=52&v=4)](/mvdvm)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


