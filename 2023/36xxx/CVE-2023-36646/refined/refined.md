- **Root cause of vulnerability:** Incorrect user role checking in multiple REST API endpoints. Specifically, the `/users/:userId` REST API endpoint in the AuthService lacks proper authorization checks and input validation.
- **Weaknesses/vulnerabilities present:**
    - **Missing authorization checks:**  Users with minimal privileges can modify user attributes, including role assignments, leading to privilege escalation.
    - **Lack of input validation:** Allows modification of all user attributes, including password, state, immutable flag, and roles.
    - **Data leakage:** The API endpoint returns all user data, including password hashes, upon successful invocation.
- **Impact of exploitation:**
    - **Privilege Escalation:** Low-privileged users can escalate their privileges to administrator level.
    - **Account Takeover:** Attackers can change passwords of any user, including privileged ones.
    - **User Deactivation:** Attackers can deactivate users.
    - **Data Exposure:** Password hashes of all users can be enumerated.
- **Attack vectors:**
    - **REST API endpoint invocation:** Attacker sends crafted HTTP PATCH requests to the `/users/:userId` endpoint.
- **Required attacker capabilities/position:**
    - The attacker needs a valid JWT Bearer Token of a low-privileged user to invoke the vulnerable API endpoints.
    - The attacker must be able to send HTTP requests to the vulnerable server.