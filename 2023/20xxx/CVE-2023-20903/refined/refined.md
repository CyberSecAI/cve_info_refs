Based on the provided content, here's an analysis of CVE-2023-20903:

**Root cause of vulnerability:**

The vulnerability lies in the UAA (User Account and Authentication) component of Cloud Foundry. When an external identity provider (IDP) linked to UAA is deactivated, UAA does not invalidate existing refresh tokens issued on behalf of users from the deactivated IDP.

**Weaknesses/vulnerabilities present:**

-   **Lack of Token Revocation:** UAA fails to revoke refresh tokens associated with deactivated external IDPs.
-   **Continued Token Issuance:** UAA continues to issue access tokens when presented with refresh tokens from deactivated IDPs as if the IDP was still active.

**Impact of exploitation:**

-   **Unauthorized Access:** Clients holding refresh tokens issued before the IDP deactivation can continue to obtain access tokens and access Cloud Foundry resources.
-   **Extended Access:** This unauthorized access persists until the refresh tokens expire, which is 30 days by default.

**Attack vectors:**

- The attack vector is a refresh token that was obtained from an external IDP before the IDP was deactivated on the UAA.

**Required attacker capabilities/position:**

-   An attacker needs a valid refresh token obtained through the now deactivated external identity provider.
-   The attacker must have a client that can utilize the obtained refresh token.
- The attacker needs to present the token to UAA to get access tokens.

**Additional Notes:**

- The vulnerability affects all versions of Cloud Foundry.
- The provided content includes a mitigation strategy that involves manually revoking tokens via the UAA API when deactivating an identity provider.
- The severity is rated as low, with a CVSS score of 2.7, likely due to the temporary nature of the access (until refresh token expiration) and the relatively low impact.
- The issue was reported by Florian Tack (SAP).
- The advisory mentions that the default refresh token lifetime is 30 days.